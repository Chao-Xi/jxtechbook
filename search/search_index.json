{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"34awk_grep_sed/","title":"GREP + AWK + SED Practice","text":"<pre><code>docker run -it --rm bluerdocker/grep-sed-awk:v1 sh\n</code></pre>"},{"location":"34awk_grep_sed/#1-grep","title":"1 GREP","text":"<pre><code>grepexercises\n</code></pre>"},{"location":"34awk_grep_sed/#grep-help","title":"grep help","text":"<pre><code>$ grep --help\nusage: grep [-abcdDEFGHhIiJLlMmnOopqRSsUVvwXxZz] [-A num] [-B num] [-C[num]]\n        [-e pattern] [-f file] [--binary-files=value] [--color=when]\n        [--context[=num]] [--directories=action] [--label] [--line-buffered]\n        [--null] [pattern] [file ...]\n</code></pre>"},{"location":"34awk_grep_sed/#exercises","title":"Exercises","text":"<p>1.Display lines containing <code>an</code> from the <code>sample.txt</code> input file.</p> <ul> <li><code>grep 'an\u2018 sample.txt</code></li> </ul> <p>output:</p> <pre><code>banana\nmango\n</code></pre> <p>2.Display lines containing <code>do</code> as a whole word from the sample.txt input file.</p> <ul> <li><code>grep -w 'do' sample.txt</code><ul> <li>-w: Match whole word</li> </ul> </li> </ul> <p>3.Display lines from sample.txt that satisfy both of these conditions:</p> <ul> <li><code>he</code> matched irrespective of case</li> <li> <p>either <code>World</code> or <code>Hi</code> matched case sensitively </p> </li> <li> <p><code>grep -i 'he' sample. txt | grep -e 'World' -e 'Hi'</code></p> </li> <li><code>grep -i 'he' sample.txt | grep -E 'World|Hi'</code><ul> <li><code>\u2013i</code>: Ignores, case for matching</li> <li><code>-E</code>: Treats pattern as an extended regular expression (ERE)</li> <li><code>-e exp</code>: Specifies expression with this option. Can use multiple times.</li> </ul> </li> </ul> <p>Expected output</p> <pre><code>Hello world\nHi there\n</code></pre> <p>Expected output:</p> <p><code>Just do-it</code></p> <p>4.Display lines from <code>code.txt</code> containing <code>fruit[0]</code> literally,</p> <ul> <li><code>grep -F 'fruit[0]' code.txt</code><ul> <li><code>-f file</code>: Takes patterns from file, one per line.</li> </ul> </li> </ul> <p>code.txt</p> <pre><code>fruit = []\nfruit[0] = 'apple'\ndef fruit():\n    print ('banana')\n</code></pre> <p>Expected output</p> <pre><code>fruit[0] = 'apple'\n</code></pre> <p>5.Display only the first two matching lines containing <code>t</code> from the <code>sample.txt</code> input file.</p> <p><code>grep -m2 't' sample.txt</code></p> <p>Output</p> <pre><code>Hi there\nJust do-it\n</code></pre> <p>6.Display only the first three matching lines that do not contain <code>he</code> from the sample.txt input file.</p> <p><code>grep -m3 -V 'he' sample.txt</code></p> <ul> <li><code>-v</code> : This prints out all the lines that do not matches the pattern</li> </ul> <p>Output</p> <pre><code>Hello World\n\nHow are you\n</code></pre> <p>7.Display lines from <code>sample.txt</code> that contain <code>do</code> along with line number prefix</p> <ul> <li><code>grep -n 'do' sample.txt</code><ul> <li><code>-n</code> Display the matched lines and their line numbers.</li> </ul> </li> </ul> <p>Output</p> <pre><code>6: Just do-it\n13: Much ado about nothing\n</code></pre> <p>8.For the input file <code>sample.txt</code>, count the number of times the string <code>he</code> is present, irrespective of case.</p> <ul> <li><code>grep -io 'he' sample.txt | wc -l</code></li> </ul> <p>Expected output: 5</p> <p>9.For the input file sample.txt, count the number of empty lines.</p> <ul> <li><code>grep -cx '' sample.txt</code><ul> <li><code>-c</code> This prints only a count of the lines that match a pattern</li> <li><code>-x</code>  Match only whole lines.</li> </ul> </li> </ul> <p>Output: 4</p> <p>9.present in the <code>terms.txt</code> file. Results should be prefixed with the corresponding input filename.</p> <p><code>grep -Ff terms.txt sample.txt code.txt</code></p> <pre><code>sample.txt: How are you\nsample. txt: mango\nsample.txt :Much ado about nothing\nsample.txt: Adios amigo\ncode.txt:fruit[o] = 'apple'\n</code></pre> <ul> <li><code>-f</code> file Takes patterns from file, one per line.</li> </ul> <p>10.For the input file <code>sample.txt</code>, display lines containing <code>amigo</code> prefixed by the input filename as well as the line number.</p> <p><code>grep -Hn 'amigo' sample.txt</code></p> <p><code>-n</code> Display the matched lines and their line numbers.</p> <p>Output:</p> <pre><code>sample.txt: 15: Adios amigo\n</code></pre> <p>e You have an Azure AD tenant named contoso.com. You have two external partner organizations named fabrikam.com and litwareinc.com. Fabrikam.com is Cigured as a connected organization. You create an access package as shown in the Access package exhibit. (Click the Access package tab.)</p>"},{"location":"2025/0intro/","title":"0 2025-Intro","text":""},{"location":"2025/0intro/#1introduction","title":"1.Introduction","text":"<p>I\u2019m Jacob. I graduated from Stevens Institute of technology in Hoboken New Jersey. And got my master\u2019s degree of Computer Science. My major was data science and data system.</p> <p>After I graduated, I took a contract job in startup company named Wrevel in New York city, working as backend developer to build the company website with PHP and MYSQL database.</p> <p>And then after one year, I finished my project and made my decision to came back to Shanghai and working as DevOps engineer in Blackboard. The Blackboard is a company which provides online teaching and learning SAAS system for universities and companies. </p> <p>My projects mainly include migrating the old CI/CD tool jenkins servers and jobs from on-premsie servers lab to AWS cloud, include AWS infrastructure and jenkins servers build with AWS Cloudformation and ansible playbook an IAC tool. Move jenkins master from servers to Docker, design and built new pipeline jobs to replace old multi-branch and free-style jobs, convert all old and manually created jenkins jobs to groovy and script code. And I also created and moved part of jenkins servers and jobs from ec2 and dockers to kubernets cluster, try to achieve the dynamic spinning up and removing jenkins agents based on buildout requirement. And beside of this. My daily operation job like covered scheduled release jobs to update client site with Chef cookbook and Jenkins pipeline job.</p> <p>After that I landed my new opportunity in SAP Jam and Workzone team and working as Senior DevOps engineer.</p> <p>Jam is more like company version content management system and social system. Compared to the job before, I have more opportunities to manage and operate on on-premises data centers, we have like more than 30 DCs globally. </p> <p>Our application is build with ruby on rails in Docker, besides writing code and operate our DCs with Chef-solo. My most important project is build our Jam application with Kubernetes on AWS and Azure from scratch and convert part of monolithic services to micro service. </p> <p>The whole procedures like, containerize our infrastructure components like Elasticsearch, RabbitMQ and Haproxy etc. Set up Kubernetes Cluster on Azure via AKS and on AWS with EKS with Terraform Code. Build out Cloud Infrastructure like CDN, S3(Storage account), RDS MySQL, Aurora, or Azure DBs and VNet with Terraform code. </p> <p>Use HELM Chart and kustomise, with GitOps way and ArgoCD as CD tool to deploy all JAM components into Kubernetes Cluster.Use SealedSecret and ArgoCD to encrypt secrets and push into Git Repo to store our encrypted secrets. </p> <p>Monitor Cluster with Prometheus Operator, writing or own ServiceMonitor and Metrics / Exporter and AlertManger to help us collect data from a variety of sources and report alert. </p> <p>Get application log, operational log and audit log by EFK. And I also enabled Service Mesh inside the cluster. Install Istio and enable envoy sidecar inject in our main namespace and track the network tracing with Kiali &amp; Jaeger and enable mutual X509 TLS service call from internal and external.</p> <p>And after that, I\u2019m trying to adopt security as service like hadolint, and apply it to pipeline, mainly help us to do the docker image scan in CI pipeline.</p> <p>When I was wokring new Product called DWZ(Digital Work ZONE). And also trying to move part of our service components from Self maintenance like objectstore, rabbitmq and Log service to SAP BTP platform. </p> <p>And In UBS, I worked in two branch companies.  I worked in AM(Assesst management) team firstly, I mainly work as Cloud archiect, design and setup the hybrid cloud infra for the WIND market data service which helps onboard the service on Azure public cloud as upstram data resource and send the data to on-premise downstream AM trading system. </p> <p>And after that, I was internal transfered to Global Investmen bank research team as Senior Devops Engineer.</p> <p>Woked with global team to migrate global research analyst platform to China region mainly like, setup on-premise datacenter for different envionments like servers, LBers, NAS storage, and deployed middlewares and service like postgres, ES, kafka, nginx, tomcat etc with Gilab-CI as CI pipeline and designed new puppet modules as CD pipeline. To automate all buildout step to avoid any manual jobs</p> <p>And aprart from this project. And now I'm work in gobal team to manage and operate the global systems. Like helped and setup OpenAI service in Azure cloud with terraform code, Azure Devops pipeline to automate the setup process. And Helped setup Azure translate service in HCI AKS cluster for Chinese-Eng translate service specific for China analyst</p> <p>Recently I working on NEW project with Vault, Azure AD and PWM API to help automate password rotaion process to replace any manul jobs to rorate account password in yearly basis</p> <p>Besides these, I passed AWS solutions architect test and azure solution expert test az305 and Certified Istio service mesh and gitlab CICD test, </p> <p>I also create multiple tutorial books for my colleague this year mainly about Azure ,AWS, Elasticsearch, Reddis, Chef &amp; Ansible, Istio So that\u2019s all about me these couple years.</p>"},{"location":"2025/0intro/#quick-version","title":"Quick version","text":"<p>I\u2019m Jacob. I graduated from Stevens Institute of technology in Hoboken New Jersey US. And got my master\u2019s degree of Computer Science. My major was data science and data system.</p> <p>After I graduated, I took a job in startup company named Wrevel in New York city, working as backend developer to build the company website with PHP and MYSQL database.</p> <p>And then after one year, I finished my project and made my decision to came back to Shanghai and working as DevOps engineer in Blackboard. The Blackboard is a company which provides online teaching and learning SAAS system for universities and companies</p> <p>My projects mainly include migrating the old CI/CD tool jenkins servers and jobs from on-premsie servers lab to AWS cloud including AWS infrastructure and jenkins servers build with AWS Cloudformation and ansible playbook. Move jenkins master from servers to Docker, convert all old and manually created jenkins jobs to groovy and script code. And I also created and moved part of jenkins servers and jobs from ec2 and dockers to kubernets cluster, try to achieve the dynamic spinning up and removing jenkins agents based on buildout requirement.</p> <p>After that I landed my new opportunity in SAP Jam and Workzone team and working as Senior DevOps engineer.</p> <p>Our application is build with ruby on rails in Docker, besides writing code and operate our DCs with Chef-solo. My most important project is build our Jam application with Kubernetes on AWS and Azure from scratch and convert part of monolithic services to micro service.</p> <p>The whole procedures like, containerize our infrastructure components like Elasticsearch, RabbitMQ and Haproxy etc. Set up Kubernetes Cluster on Azure via AKS and on AWS with EKS with Terraform Code. Build out Cloud Infrastructure like CDN, S3(Storage account), RDS MySQL with Terraform code.</p> <p>Use HELM Chart and kustomise, with GitOps way and ArgoCD as CD tool to deploy all  components into Kubernetes Cluster.Use SealedSecret and ArgoCD to encrypt and deploy encrypted secrets</p> <p>Monitor Cluster with Prometheus Operator, writing or own ServiceMonitor and Metrics / Exporter and AlertManger to help us collect data from a variety of sources and report alert.</p> <p>And I also enabled Service Mesh inside the cluster. Install Istio and enable envoy sidecar inject in our main namespace and track the network tracing and enable mutual X509 TLS service call from internal and external.</p> <p>When I was wokring new Product called DWZ(Digital Work ZONE). And also trying to move part of our service components from Self maintenance like objectstore, rabbitmq and Log service to SAP BTP platform.</p> <p>And then I came to UBS. In UBS Shanghai I worked in china AM(Assesst management) team firstly, I mainly work as Cloud archiect, work with Wind infra team and Microsoft team. Design and setup the hybrid cloud infra for the WIND market data service which helps onboard the service on Azure public cloud as upstram data resource and send the data to on-premise downstream AM trading system.  </p> <p>And after that, I was internal transfered to Global IB research team as Senior Devops Engineer.</p> <p>Worked with global team to migrate global research analyst platform to China region mainly like, setup on-premise datacenter for different envionments with new designed Gilab-CI as CI pipeline and designed new puppet modules as CD pipeline. To automate all buildout steps</p> <p>And aprart from this project. And now I'm work in gobal team to manage and operate the global systems. Like helped and setup OpenAI service in Azure cloud with terraform code, Azure Devops pipeline to automate the setup process.</p> <p>Recently I completed one PWM project with Vault, With Azure AD and PWM API to help automate password rotation process to replace any manual jobs </p> <p>to rotate account password in yearly basis</p> <p>And right now I'm working with Micsoft azure team to build out Azure congnitive AI translate service in HCI AKS cluster for Chinese-Eng translate service for China analyst</p> <p>Besides these, I passed AWS solutions architect test and azure solution expert test az305 and Certified Istio service mesh and gitlab CICD test, </p> <p>I also create multiple tutorial books for my colleague this year mainly about Azure ,AWS, Elasticsearch, Reddis, Chef &amp; Ansible, Istio So that\u2019s all about me these couple years.</p>"},{"location":"2025/0intro/#why-left-the-current-team","title":"Why left the current team","text":""},{"location":"2025/0intro/#pursue-new-career-path","title":"Pursue New career path","text":"<ul> <li>In the financial company, I dont see my future here. Cause, comparing to new techs, codes or new solutions, they are more concern about procedures. Every day, I spend more times on writing documents, go-through steps, meeting with compliance team than working on my codes and my operations jobs. And I dont' even have any chance to learn new techs here. Thus I feel like I gonna be wasted in this team for longer time. </li> </ul> <p>Second Still is I can say our application is quite heavy service and old setup and the core service is using vendor service. Thus the service is still setting on on-premise data centers. So most of tech stacks are using traditional setup not container. Exp, in next couple years, our most critical project is migrating services from redhat 7 to redhat 8 for all regions. So I hope I can find any opportunity to work on some projects with trendy tech stacks like containerlization, cloud, service mesh etc</p> <p>Thrid I working in a global team, this team actually based in LDN.. And since I'm only one here in Shanghai. all my teammats are based in Pune India and LDN. Although I enjoy my work alone with the my current team, while I'd like to work in more collaborative environments. from what I have more chance to learn from each other here</p> <p>Fourth I saw the JD, this role is quite attractive to me. I can get in touch with multiple projects and provide my cloud expetise. Actucally I do have lots of experience on Azure, Aws, Alicloud even CC cloud. I think I'm perfect for this role </p> <p>So I have to work with them like meetings, discussion, troubleshootings every day late night</p> <ol> <li>After spend 3 years in this financial industry, I have dicovered my passion in financial tech a lot. And I truly belive that there is much more to explore in this industray rather in daily BAU operational job and want to double down on this descision to pursue it further. So I want have more opprtunity to get touch with new projects </li> <li>I always want improve my career into a new level. I think this opportunity at your firm would be more leveled up. and better match what I can bring to the table. I'm looking for new solution architect job</li> </ol> <p>First I already work as devops eng over 8 years. I always want improve my career into a new level. I\u2019m pursuing SRE because I\u2019m quite interesting about reliability engineering. I deeply value my DevOps experience. It especially focus on automation, CI/CD, cloud migration, and new service collaboration. But SRE balances speed with reliability targets (SLIs/SLOs). I\u2019d like to working on designing resilient systems to reducing error budgets, improve service performance, site reability and treating operations as a software problem. </p> <ul> <li>I really enjoyed our  initial conversation learning from company, although I wasn't actively looking for new change at the time,it really felt like this new role entails exciting challenges that I would like to be a part of. i'm truly intrigued by this career development at your firm and believe that my skill set largely align with what you are looking for </li> </ul>"},{"location":"2025/0intro/#common-questions","title":"Common Questions","text":""},{"location":"2025/0intro/#what-do-you-think-of-overtime-work","title":"What do you think of overtime work?","text":"<p>I recognize that overtime can be necessary in certain situations, like urgent deadlines, and I'm committed to supporting the team when it truly adds value.</p> <p>That said, I believe consistent overtime often indicates inefficiencies. My focus is on maximizing productivity during core hours through prioritization, streamlined workflows, and clear planning. </p> <p>This way, I deliver high-quality results efficiently while maintaining sustainable work rhythms.</p>"},{"location":"2025/0intro/#whats-your-main-consideration-in-your-current-job-hunt","title":"What's your main consideration in your current job hunt?","text":"<ol> <li>growth opportunities- I want work that challenges me just beyond my current skills, pushing me to learn (like taking on cross-functional projects or mastering new tools).</li> <li>alignment with the company's mission-I need to see how my role directly contributes to the bigger picture, so my work feels meaningful, not just task-oriented.</li> <li>team culture-a collaborative, supportive environment where feedback flows freely and mistakes are seen as learning chances. These factors help me grow sustainably and stay motivated long-term.</li> </ol>"},{"location":"2025/0intro/#whats-your-biggest-weakness","title":"What's your biggest weakness?","text":"<p>My biggest weakness is the fact that I don't yet have much experience in talking to large groups of people.</p> <p>This is something I'm very keen to improve on, so if any opportunities were to arise in this position to gain experience in this area, I would certainly want to take advantage of that.</p>"},{"location":"2025/0intro/#do-you-have-any-questions-for-us","title":"Do you have any questions for us?","text":"<ol> <li> <p>What's the first thing you will need me to concentrate on in this role if I am successful?</p> </li> <li> <p>What opportunities are there for professional development and growth in this position?</p> </li> </ol> <p>3. Can you please tell me more about the team I would be a part of in this role?</p> <ol> <li> <p>What's the culture like within this organization?</p> </li> <li> <p>What are the biggest challenges your company is facing right now, and what could I do to help you overcome them?</p> </li> <li> <p>What would my success in the position look like in 12 months from now?</p> </li> <li> <p>What is it the top-performing employees do in this company to achieve success?</p> </li> </ol> <p>8. What are the next steps of the selection process, and when can I expect to hear from you?</p>"},{"location":"2025/0intro/#what-do-you-see-in-five-years","title":"What do you see in Five years","text":"<p>1. In five years from now, I will hopefully still be working for you, either in this role or perhaps even having gained advancement to a higher level.</p> <ol> <li>In five years, I will have developed into a trusted, loyal, and committed member of the company who can be relied upon to do a great job for you</li> </ol> <p>3. I feel in five years' time, I will have sufficient experience and expertise to help train up newer members of the organization as and when they join</p>"},{"location":"2025/0intro/#project-blocker-and-resolver","title":"Project blocker and resolver","text":"<p>Actualluy happened in SAP. I introduced, brought in and set up the open-source monitoring tool Prometheus and Grafana as our Kubernetes cluster monitoring and alerting solution. Before it, we are using the traditional monitor tool Zabbix and it was set up by OPS team which only provide basic info like server CPU, memory, network throughout, disk info etcs. </p> <p>We are couple blocked in this project, </p> <p>First no one in our team has experience to set up the whole monitor, view, and alerting system from scratch. </p> <p>Second, most of them do not has faith in open-source solution and they prefer enterprise solutions. like zabbix or datadog</p> <p>However, on cloud native infrastructure, Prometheus solution has more advantages especially it not only can used to monitor the basic infra and it also be easily customized to monitor different services, like cache service, queue service, and search services. Compared to enterprise solution, it\u2019s more flexible, we can have full management privilege, and it\u2019s the most prevalent monitor solution currently. </p> <p>After I give my teams the detail intro for this solution. I started to make proof of concept(POC) on the project, I choose one of our internal test Kubernetes cluster works as my demo environment to test the availability. </p> <p>In the poc part, I also encounter some blocks like I\u2019m not expert for all service, so I need to consult to developer who write the service, and with the help to customize the metrics for services. </p> <p>And after the couple months, the whole system setup, which provide much more stability for our internal tool and we can easily do the troubleshooting and receive the alarm from alert system. Then we adopt the solutions and push this solution to our main production service cluster. Everyone in our team started to learn it and got they own task to write different metrics for the all microservices.</p> <p>And after setup, I also brought in Loki, Grafana, promtail solution as Log aggregrator easiy working together with prometheus solution. More like two birds with one stone</p>"},{"location":"2025/0intro/#2self-description","title":"2.Self Description","text":"<ol> <li>I consider myself as a good leaner, I\u2019m willing to learn all new stuffs. I learn things efficiently and effectively. You can check my github, I push my tech articles into it almost everyday. And every time when I faced a project, there some techs I never touched before. I don\u2019t just jump into this project, I\u2019m willing to spend 2 or 3 days to explore this tech. I can always deliver high quality project</li> <li>I consider myself more extrovert than introvert, I prefer to work in a team rather than work alone. I\u2019d like share my opinion and listen to others' advices on the job.</li> <li>Im pretty good at time management, Im never missed deadline. I don\u2019t like procreations, if the jobs or tickets must be done in a sprint, I\u2019d like do it right way, not holding it back to the due day. So I can alway deliver assigned issues on time no holding back at all</li> </ol>"},{"location":"2025/0intro/#describe-yourself-in-3-words","title":"Describe yourself in 3 words.","text":"<p>resilient, knowledgeable, and adaptable.</p> <ol> <li> <p>I'm resilient because I never get stressed in difficult situations, and I can easily prioritize tasks regardless of how many I have.</p> </li> <li> <p>I am knowledgeable in this industry because I have applicable academic qualifications, and I also have experience in similar job-related roles.</p> </li> <li> <p>Finally, I am adaptable because I am the type of person who will always take on duties outside of my job description, and I will also help out your business at short notice as and when needed. So, for example, if you need me to work extra hours or duties, I will always do that, and I will be prepared to cover the work of co-workers who are ever off work sick.</p> </li> </ol>"},{"location":"2025/0intro/#3what-is-devops-definition","title":"3.What is Devops definition","text":"<p>DevOps is the gray area between development (Dev) and operations (Ops) teams in the product development process. DevOps is a culture that emphasizes communication, integration, and collaboration in the product development cycle.</p> <p>As such, it removes barrier between software development and operations teams, enabling them to integrate and deploy products quickly and continuously.</p> <ul> <li>Accept failure as normal, try to spot it and resolve it on time</li> <li>Reduce the cost of failure, so try to implement gradual changes, like migration, update on system</li> <li>Build automation tool to reduce the uncertainty of manual work, like build the cicd pipeline.</li> <li>Measure everything, build the monitor-tools, log aggregator and alert system to help to supervise whole system</li> <li>Reduce the cost.</li> <li>Reduces the time required to recover from failures on average.</li> <li>Increase the frequency of deployments.</li> <li>Reduce deployment failure rate.</li> </ul>"},{"location":"2025/0intro/#4-well-architected-framework","title":"4 Well-Architected Framework","text":"<ul> <li>Security</li> <li>Reliability</li> <li>Performance Efficiency</li> <li>Cost Optimization</li> <li>Operation</li> </ul>"},{"location":"2025/0intro/#1security","title":"1.Security","text":"<p>Data protection:</p> <ul> <li>Encrypting and protecting your data at rest with encryption algorithm and in transit with ssl</li> <li>Versioning, for example, our most data was stored in S3 bucket in AWS, we use versioning, one data with different version, can protect against accidental overwrites deletes.</li> </ul> <p>Privilege Management</p> <ol> <li>Password Management (such as password rotation policies)</li> <li>Enable Multi-Factor Authentication(MFA) in your account to login into our cloud service, we use DUO on our phone to send notification every time, we want to login into the account.</li> <li>Role Based Access Controls, we give every server like ec2 different role, which can restrict they can only access different resource necessary</li> <li>Access Control Lists (ACLs), different operators, only get temporary access to certain servers only authorized by managers</li> </ol> <p>Infrastructure Protection</p> <p>We set our servers in different VPC, AZ, security group, public subnet, private subnet, and only can access them by jump host/ bastion host</p> <p>Detective Controls</p> <p>We use cloudtrail audit and monitor on all account, you can discover and troubleshoot security and operational issues by capturing a comprehensive history of changes that occurred in your AWS account within a specified period of time.</p> <p>And use cloudwatch and sms to monitor the aws resource and use prometheus and EKF on our clusters</p>"},{"location":"2025/0intro/#2-reliability-everything-turned-to-code","title":"2. Reliability (everything turned to code)","text":"<ul> <li>Automatically recover from failure</li> <li>Scale horizontally</li> </ul> <p>Automatically recover from failure</p> <ul> <li>AWS Servers like EC2, we use cloudformation to put all servers settings into code</li> <li>AWS RDS, We use auto-back and Multi-AZ which can synchronically backup the database into other secondary RDS to protect rds failure</li> <li>other servers like Kubernetes cluster or other virtual machine, we use terraform to put all servers settings into code</li> </ul> <p>Scale horizontally</p> <ul> <li>aws we use auto scaling group for our EC2 servers</li> <li>HPA and deployment for our containers</li> <li>backup all logs into s3 bucket</li> </ul>"},{"location":"2025/0intro/#3-performance-efficiency","title":"3. Performance Efficiency","text":"<ul> <li>Compute= =&gt;. Autoscaling</li> <li>Storage =&gt; type of EBS, SSD HDD storage compare their connections and IOPS</li> <li>Database =&gt; read replicas, dynamodb for web sessions, metadata, Aurora, multiple write and read</li> <li>time-space trade =&gt; ElastiCache(redis) and cache for redis, Direct Connect</li> </ul>"},{"location":"2025/0intro/#4cost-optimization","title":"4.Cost Optimization","text":"<ul> <li>Monitoring usage and spending every month</li> <li>Autoscaling</li> <li>decommission resources that you no longer need, stop resources that are temporarily not needed</li> <li>Merge low used resource, like some rds, we used shared rds instead.</li> </ul>"},{"location":"2025/10prometheus/","title":"10 Prometheus\u9762\u8bd5","text":""},{"location":"2025/10prometheus/#prometheusrule","title":"PrometheusRule\uff1a\u76d1\u63a7\u4e0e\u62a5\u8b66\u7684\u5229\u5668","text":"<p>\u6211\u4eec\u77e5\u9053\u4e4b\u524d\u6211\u4eec\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u65b9\u5f0f\u53ef\u4ee5\u5728 Prometheus \u7684\u914d\u7f6e\u6587\u4ef6\u4e4b\u4e2d\u6307\u5b9a AlertManager \u5b9e\u4f8b\u548c \u62a5\u8b66\u7684 rules \u6587\u4ef6\uff0c\u73b0\u5728\u6211\u4eec\u901a\u8fc7 Operator \u90e8\u7f72\u7684\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u5728 Prometheus Dashboard \u7684 Config \u9875\u9762\u4e0b\u9762\u67e5\u770b\u5173\u4e8e AlertManager \u7684\u914d\u7f6e\uff1a</p> <pre><code>alerting:\n  alert_relabel_configs:\n  - separator: ;\n    regex: prometheus_replica\n    replacement: $1\n    action: labeldrop\n  alertmanagers:\n  - follow_redirects: true\n    enable_http2: true\n    scheme: http\n    path_prefix: /\n    timeout: 10s\n    api_version: v2\n    relabel_configs:\n    - source_labels: [__meta_kubernetes_service_name]\n      separator: ;\n      regex: alertmanager-main\n      replacement: $1\n      action: keep\n    - source_labels: [__meta_kubernetes_endpoint_port_name]\n      separator: ;\n      regex: web\n      replacement: $1\n      action: keep\n    kubernetes_sd_configs:\n    - role: endpoints\n      kubeconfig_file: \"\"\n      follow_redirects: true\n      enable_http2: true\n      namespaces:\n        own_namespace: false\n        names:\n        - monitoring\nrule_files:\n- /etc/prometheus/rules/prometheus-k8s-rulefiles-0/*.yaml\n</code></pre> <p>\u4e0a\u9762 alertmanagers \u7684\u914d\u7f6e\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u662f\u901a\u8fc7 role \u4e3a <code>endpoints</code> \u7684 kubernetes \u7684\u81ea\u52a8\u53d1\u73b0\u673a\u5236\u83b7\u53d6\u7684\uff0c\u5339\u914d\u7684\u662f\u670d\u52a1\u540d\u4e3a <code>alertmanager-main</code>\uff0c\u7aef\u53e3\u540d\u4e3a web \u7684 Service \u670d\u52a1\uff0c\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u4e0b alertmanager-main \u8fd9\u4e2a Service\uff1a</p> <pre><code>$ kubectl describe svc alertmanager-main -n monitoring\nName:              alertmanager-main\nNamespace:         monitoring\nLabels:            app.kubernetes.io/component=alert-router\n                   app.kubernetes.io/instance=main\n                   app.kubernetes.io/name=alertmanager\n                   app.kubernetes.io/part-of=kube-prometheus\n                   app.kubernetes.io/version=0.27.0\nAnnotations:       &lt;none&gt;\nSelector:          app.kubernetes.io/component=alert-router,app.kubernetes.io/instance=main,app.kubernetes.io/name=alertmanager,app.kubernetes.io/part-of=kube-prometheus\nType:              ClusterIP\nIP Family Policy:  SingleStack\nIP Families:       IPv4\nIP:                172.16.29.21\nIPs:               172.16.29.21\nPort:              web  9093/TCP\nTargetPort:        web/TCP\nEndpoints:         192.168.0.173:9093,192.168.0.175:9093,192.168.0.176:9093\nPort:              reloader-web  8080/TCP\nTargetPort:        reloader-web/TCP\nEndpoints:         192.168.0.173:8080,192.168.0.175:8080,192.168.0.176:8080\nSession Affinity:  ClientIP\nEvents:            &lt;none&gt;\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u670d\u52a1\u540d\u6b63\u662f <code>alertmanager-main</code>\uff0cPort \u5b9a\u4e49\u7684\u540d\u79f0\u4e5f\u662f web\uff0c\u7b26\u5408\u4e0a\u9762\u7684\u89c4\u5219\uff0c\u6240\u4ee5 <code>Prometheus</code> \u548c <code>AlertManager</code> \u7ec4\u4ef6\u5c31\u6b63\u786e\u5173\u8054\u4e0a\u4e86\u3002</p> <p>\u800c\u5bf9\u5e94\u7684\u62a5\u8b66\u89c4\u5219\u6587\u4ef6\u4f4d\u4e8e\uff1a<code>/etc/prometheus/rules/prometheus-k8s-rulefiles-0/</code>\u76ee\u5f55\u4e0b\u9762\u6240\u6709\u7684 YAML \u6587\u4ef6\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u8fdb\u5165 Prometheus \u7684 Pod \u4e2d\u9a8c\u8bc1\u4e0b\u8be5\u76ee\u5f55\u4e0b\u9762\u662f\u5426\u6709 YAML \u6587\u4ef6\uff1a</p> <pre><code>kex prometheus-k8s-0 -nmonitoring -- sh\n\n/prometheus $ cd /etc/prometheus/rules/prometheus-k8s-rulefiles-0/\n/etc/prometheus/rules/prometheus-k8s-rulefiles-0 $ ls\nmonitoring-alertmanager-main-rules-b6e33381-7319-4dd3-8b96-6b99ec46bcf3.yaml\nmonitoring-grafana-rules-eedbd431-e04a-4a08-83a0-17cbd96fe942.yaml\nmonitoring-kube-prometheus-rules-0da776fa-e5f4-498e-bcc6-5e310b2995ba.yaml\nmonitoring-kube-state-metrics-rules-2242037f-5eaf-41a7-b122-036d05526c6b.yaml\nmonitoring-kubernetes-monitoring-rules-e31ffca7-ac96-4f9e-bb82-6a37e1ce6500.yaml\nmonitoring-prometheus-k8s-prometheus-rules-55f68dd4-e3f1-45ca-9c5b-bb6b952d2ae4.yaml\nmonitoring-prometheus-operator-rules-6e51dbe0-410b-468e-b4f2-84b32cd32665.yaml\n</code></pre> <p>\u8fd9\u4e2a YAML \u6587\u4ef6\u5b9e\u9645\u4e0a\u5c31\u662f\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u7684\u4e00\u4e2a PrometheusRule \u6587\u4ef6\u5305\u542b\u7684\u5185\u5bb9\uff1a</p> <pre><code>$ cat grafana-prometheusrule.yaml\n\napiVersion: monitoring.coreos.com/v1\nkind: PrometheusRule\nmetadata:\n  labels:\n    app.kubernetes.io/component: grafana\n    app.kubernetes.io/name: grafana\n    app.kubernetes.io/part-of: kube-prometheus\n    app.kubernetes.io/version: 11.4.0\n    prometheus: k8s\n    role: alert-rules\n  name: grafana-rules\n  namespace: monitoring\nspec:\n  groups:\n  - name: GrafanaAlerts\n    rules:\n    - alert: GrafanaRequestsFailing\n      annotations:\n        message: '{{ $labels.namespace }}/{{ $labels.job }}/{{ $labels.handler }} is experiencing {{ $value | humanize }}% errors'\n        runbook_url: https://runbooks.prometheus-operator.dev/runbooks/grafana/grafanarequestsfailing\n      expr: |\n        100 * namespace_job_handler_statuscode:grafana_http_request_duration_seconds_count:rate5m{handler!~\"/api/datasources/proxy/:id.*|/api/ds/query|/api/tsdb/query\", status_code=~\"5..\"}\n        / ignoring (status_code)\n        sum without (status_code) (namespace_job_handler_statuscode:grafana_http_request_duration_seconds_count:rate5m{handler!~\"/api/datasources/proxy/:id.*|/api/ds/query|/api/tsdb/query\"})\n        &gt; 50\n      for: 5m\n      labels:\n        severity: warning\n  - name: grafana_rules\n    rules:\n    - expr: |\n        sum by (namespace, job, handler, status_code) (rate(grafana_http_request_duration_seconds_count[5m]))\n      record: namespace_job_handler_statuscode:grafana_http_request_duration_seconds_count:rate5m\n</code></pre> <p>\u6211\u4eec\u8fd9\u91cc\u7684 <code>PrometheusRule</code> \u7684 name \u4e3a <code>prometheus-k8s-rules</code>\uff0cnamespace \u4e3a monitoring\uff0c\u6211\u4eec\u53ef\u4ee5\u731c\u60f3\u5230\u6211\u4eec\u521b\u5efa\u4e00\u4e2a PrometheusRule \u8d44\u6e90\u5bf9\u8c61\u540e\uff0c\u4f1a\u81ea\u52a8\u5728\u4e0a\u9762\u7684 <code>prometheus-k8s-rulefiles-0</code> \u76ee\u5f55\u4e0b\u9762\u751f\u6210\u4e00\u4e2a\u5bf9\u5e94\u7684 <code>{namespace}-{name}.yaml</code> \u6587\u4ef6\uff0c\u6240\u4ee5\u5982\u679c\u4ee5\u540e\u6211\u4eec\u9700\u8981\u81ea\u5b9a\u4e49\u4e00\u4e2a\u62a5\u8b66\u9009\u9879\u7684\u8bdd\uff0c\u53ea\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a PrometheusRule \u8d44\u6e90\u5bf9\u8c61\u5373\u53ef\u3002</p> <p>\u81f3\u4e8e\u4e3a\u4ec0\u4e48 Prometheus \u80fd\u591f\u8bc6\u522b\u8fd9\u4e2a PrometheusRule \u8d44\u6e90\u5bf9\u8c61\u5462\uff1f</p> <p>\u8fd9\u5c31\u9700\u8981\u67e5\u770b\u6211\u4eec\u521b\u5efa\u7684 prometheus \u8fd9\u4e2a\u8d44\u6e90\u5bf9\u8c61\u4e86\uff0c\u91cc\u9762\u6709\u975e\u5e38\u91cd\u8981\u7684\u4e00\u4e2a\u5c5e\u6027 <code>ruleSelector</code>\uff0c\u7528\u6765\u5339\u914d <code>rule</code> \u89c4\u5219\u7684\u8fc7\u6ee4\u5668\uff0c\u8981\u6c42\u5339\u914d\u5177\u6709 <code>prometheus=k8s</code> \u548c <code>role=alert-rules</code>\u6807\u7b7e\u7684 <code>PrometheusRule</code>\u8d44\u6e90\u5bf9\u8c61</p> <pre><code>ruleSelector:\n  matchLabels:\n    prometheus: k8s\n    role: alert-rules\n</code></pre> <p>\u6dfb\u52a0\u548c\u4e0d\u6dfb\u52a0 ruleSelector \u7684\u4e3b\u8981\u533a\u522b\u5728\u4e8e Prometheus \u5b9e\u4f8b\u5982\u4f55\u9009\u62e9\u5e76\u52a0\u8f7d\u544a\u8b66\u89c4\u5219 (Alerting Rules)\u3002</p>"},{"location":"2025/10prometheus/#ruleselector","title":"\u4ec0\u4e48\u662f ruleSelector","text":"<p>ruleSelector \u662f Prometheus-Operator \u4e2d\u7684\u4e00\u4e2a\u914d\u7f6e\u9009\u9879\uff0c\u5b83\u7528\u4e8e\u6307\u5b9a Prometheus \u5b9e\u4f8b\u52a0\u8f7d\u54ea\u4e9b\u544a\u8b66\u89c4\u5219 (PrometheusRule) \u8d44\u6e90\u3002</p> <p>\u901a\u8fc7\u6807\u7b7e\u5339\u914d\u7684\u65b9\u5f0f\uff0cruleSelector \u5141\u8bb8\u7528\u6237\u7cbe\u786e\u63a7\u5236 Prometheus \u5b9e\u4f8b\u52a0\u8f7d\u7684\u89c4\u5219\u6765\u6e90\u3002</p>"},{"location":"2025/10prometheus/#_1","title":"\u914d\u7f6e\u533a\u522b","text":""},{"location":"2025/10prometheus/#ruleselector_1","title":"\u4e0d\u6dfb\u52a0 ruleSelector","text":"<ul> <li>\u884c\u4e3a\uff1a  Prometheus \u5b9e\u4f8b\u5c06\u4f1a\u5c1d\u8bd5\u52a0\u8f7d\u540c\u4e00\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u6240\u6709 PrometheusRule \u8d44\u6e90\uff08\u6216\u8005\u6839\u636e ruleNamespaceSelector \u7684\u914d\u7f6e\uff0c\u4ece\u5176\u4ed6\u547d\u540d\u7a7a\u95f4\u4e2d\u52a0\u8f7d</li> <li>\u4f18\u70b9\uff1a<ul> <li>\u7b80\u5355\u6613\u7528\uff0c\u4e0d\u9700\u8981\u4e3a\u6bcf\u4e2a PrometheusRule \u8d44\u6e90\u6dfb\u52a0\u6807\u7b7e</li> <li>\u9002\u5408\u5c0f\u89c4\u6a21\u90e8\u7f72\u6216\u5f00\u53d1\u73af\u5883</li> </ul> </li> <li>\u7f3a\u70b9<ul> <li>\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4 Prometheus \u5b9e\u4f8b\u52a0\u8f7d\u4e0d\u76f8\u5173\u7684\u544a\u8b66\u89c4\u5219\uff0c\u589e\u52a0\u8d1f\u62c5\u3002</li> <li>\u5982\u679c\u6709\u591a\u4e2a Prometheus \u5b9e\u4f8b\u8fd0\u884c\uff0c\u5bb9\u6613\u51fa\u73b0\u51b2\u7a81\u6216\u91cd\u590d\u52a0\u8f7d\u3002</li> </ul> </li> </ul>"},{"location":"2025/10prometheus/#ruleselector_2","title":"\u6dfb\u52a0 ruleSelector","text":"<pre><code>ruleSelector:\n  matchLabels:\n    prometheus: k8s\n    role: alert-rules\n</code></pre> <p>\u884c\u4e3a:</p> <p>Prometheus \u5b9e\u4f8b\u53ea\u4f1a\u52a0\u8f7d\u7b26\u5408 ruleSelector \u6307\u5b9a\u6807\u7b7e\u7684 PrometheusRule \u8d44\u6e90\u3002\u4f8b\u5982\uff0c\u53ea\u6709\u540c\u65f6\u62e5\u6709\u4ee5\u4e0b\u6807\u7b7e\u7684 PrometheusRule \u4f1a\u88ab\u52a0\u8f7d</p> <ul> <li><code>prometheus: k8s</code></li> <li><code>role: alert-rules</code></li> </ul> <p>\u4f18\u70b9:</p> <ul> <li>\u7cbe\u786e\u63a7\u5236 Prometheus \u5b9e\u4f8b\u52a0\u8f7d\u7684\u544a\u8b66\u89c4\u5219\uff0c\u907f\u514d\u52a0\u8f7d\u65e0\u5173\u89c4\u5219\u3002</li> <li>\u5728\u591a Prometheus \u5b9e\u4f8b\u573a\u666f\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u6807\u7b7e\u9694\u79bb\u89c4\u5219\u6765\u6e90\u3002</li> <li>\u65b9\u4fbf\u7ba1\u7406\u5927\u89c4\u6a21\u90e8\u7f72\u4e2d\u7684\u89c4\u5219\u96c6</li> </ul> <p>\u7f3a\u70b9</p> <ul> <li>\u9700\u8981\u5728\u6bcf\u4e2a PrometheusRule \u8d44\u6e90\u4e0a\u6dfb\u52a0\u76f8\u5e94\u7684\u6807\u7b7e\u3002</li> <li>\u914d\u7f6e\u7a0d\u663e\u590d\u6742\uff0c\u53ef\u80fd\u5bfc\u81f4\u89c4\u5219\u9057\u6f0f\uff08\u5fd8\u8bb0\u6dfb\u52a0\u6807\u7b7e\uff09\u3002</li> </ul>"},{"location":"2025/10prometheus/#_2","title":"\u5b9e\u9645\u573a\u666f\u4e2d\u7684\u5e94\u7528","text":"<p>\u573a\u666f 1\uff1a\u5355\u5b9e\u4f8b Prometheus</p> <p>\u5982\u679c\u60a8\u7684\u96c6\u7fa4\u4e2d\u53ea\u6709\u4e00\u4e2a Prometheus \u5b9e\u4f8b\uff0c\u53ef\u4ee5\u4e0d\u4f7f\u7528 ruleSelector\uff0c\u8ba9\u5176\u81ea\u52a8\u52a0\u8f7d\u6240\u6709\u89c4\u5219\u3002\u8fd9\u79cd\u65b9\u5f0f\u9002\u5408\u7b80\u5355\u90e8\u7f72\u548c\u6d4b\u8bd5\u73af\u5883\u3002</p> <p>\u573a\u666f 2\uff1a\u591a\u5b9e\u4f8b Prometheus</p> <p>\u5728\u590d\u6742\u73af\u5883\u4e2d\uff08\u4f8b\u5982\u591a\u56e2\u961f\u5171\u4eab\u96c6\u7fa4\u6216\u8de8\u73af\u5883\u76d1\u63a7\uff09\uff0c\u5efa\u8bae\u4f7f\u7528 ruleSelector\uff0c\u4e3a\u6bcf\u4e2a Prometheus \u5b9e\u4f8b\u6307\u5b9a\u7279\u5b9a\u7684\u544a\u8b66\u89c4\u5219\uff1a</p> <ul> <li>\u4e0d\u540c\u56e2\u961f\u7ef4\u62a4\u4e0d\u540c\u7684\u89c4\u5219\uff0c\u901a\u8fc7\u6807\u7b7e\u9694\u79bb\u3002</li> <li> <p>\u5728\u751f\u4ea7\u548c\u6d4b\u8bd5\u73af\u5883\u4e2d\u5206\u522b\u90e8\u7f72 Prometheus\uff0c\u52a0\u8f7d\u4e0d\u540c\u7684\u89c4\u5219\u3002</p> </li> <li> <p>\u4e0d\u6dfb\u52a0 ruleSelector:</p> <ul> <li>\u52a0\u8f7d\u6240\u6709 PrometheusRule \u8d44\u6e90</li> <li>\u8d44\u6e90\u7b80\u5355\u6613\u7528\uff0c\u81ea\u52a8\u52a0\u8f7d\u6240\u6709\u89c4\u5219</li> <li>\u4e0d\u9002\u5408\u5927\u89c4\u6a21\u73af\u5883\uff0c\u89c4\u5219\u7ba1\u7406\u6df7\u4e71</li> </ul> </li> <li> <p>\u6dfb\u52a0 ruleSelector</p> <ul> <li>\u6309\u6807\u7b7e\u7b5b\u9009\u52a0\u8f7d\u7279\u5b9a\u7684 PrometheusRule</li> <li>\u7cbe\u786e\u63a7\u5236\u89c4\u5219\u52a0\u8f7d\uff0c\u907f\u514d\u51b2\u7a81\uff0c\u9002\u5408\u751f\u4ea7\u73af\u5883</li> <li>\u914d\u7f6e\u590d\u6742\uff0c\u9700\u8981\u6b63\u786e\u8bbe\u7f6e\u6807\u7b7e</li> </ul> </li> </ul>"},{"location":"2025/10prometheus/#prometheusrule_1","title":"\u6df1\u5165\u7406\u89e3 PrometheusRule\uff1a\u521b\u5efa\u9ad8\u6548\u7684\u544a\u8b66\u89c4\u5219","text":"<p>PrometheusRule \u662f Prometheus Operator \u63d0\u4f9b\u7684\u4e00\u79cd\u81ea\u5b9a\u4e49\u8d44\u6e90\uff0c\u7528\u4e8e\u5b9a\u4e49\u548c\u7ba1\u7406 Prometheus \u7684\u544a\u8b66\u89c4\u5219\u548c\u8bb0\u5f55\u89c4\u5219\uff08Recording Rules\uff09\u3002\u8fd9\u4e9b\u89c4\u5219\u662f Prometheus \u5728\u76d1\u63a7\u73af\u5883\u4e2d\u53d1\u6325\u544a\u8b66\u548c\u6570\u636e\u5904\u7406\u80fd\u529b\u7684\u5173\u952e\u5de5\u5177\u3002</p> <p>\u672c\u7bc7\u6587\u7ae0\u5c06\u8be6\u7ec6\u8bb2\u89e3 PrometheusRule \u7684\u7ed3\u6784\u3001\u914d\u7f6e\u65b9\u6cd5\u3001\u5e94\u7528\u573a\u666f\uff0c\u4ee5\u53ca\u5982\u4f55\u6839\u636e\u5b9e\u9645\u9700\u6c42\u4f18\u5316\u544a\u8b66\u7b56\u7565\u3002</p>"},{"location":"2025/10prometheus/#prometheusrule_2","title":"PrometheusRule \u7684\u4f5c\u7528","text":"<p>PrometheusRule \u7684\u4e3b\u8981\u4f5c\u7528\u5305\u62ec\uff1a</p> <p>\u544a\u8b66\u89c4\u5219\uff08Alerting Rules\uff09</p> <ul> <li>\u5b9a\u4e49\u76d1\u63a7\u6570\u636e\u7684\u6761\u4ef6\uff0c\u5f53\u8fd9\u4e9b\u6761\u4ef6\u6ee1\u8db3\u65f6\u89e6\u53d1\u544a\u8b66\u3002</li> <li>\u4f8b\u5982\uff0c\u5f53\u67d0\u4e2a\u5e94\u7528\u7684\u8bf7\u6c42\u5ef6\u8fdf\u8d85\u8fc7\u9608\u503c\u65f6\u53d1\u51fa\u8b66\u544a\u3002</li> </ul> <p>\u8bb0\u5f55\u89c4\u5219\uff08Recording Rules\uff09</p> <ul> <li>\u5b9a\u671f\u5c06\u590d\u6742\u7684\u67e5\u8be2\u7ed3\u679c\u5b58\u50a8\u4e3a\u65b0\u7684\u65f6\u95f4\u5e8f\u5217\uff0c\u4ee5\u4f18\u5316\u67e5\u8be2\u6027\u80fd\u3002</li> <li>\u4f8b\u5982\uff0c\u5c06\u4e00\u6bb5\u65f6\u95f4\u5185\u7684\u5e73\u5747 CPU \u4f7f\u7528\u7387\u5b58\u50a8\u4e3a\u4e00\u4e2a\u65b0\u6307\u6807\u3002</li> </ul> <p>\u901a\u8fc7 PrometheusRule\uff0c\u53ef\u4ee5\u5c06\u89c4\u5219\u914d\u7f6e\u4e0e Prometheus \u7684\u7ba1\u7406\u903b\u8f91\u5206\u79bb\uff0c\u5b9e\u73b0\u89c4\u5219\u7684\u7075\u6d3b\u5206\u7ec4\u548c\u7edf\u4e00\u7ba1\u7406\u3002</p>"},{"location":"2025/10prometheus/#prometheusrule_3","title":"PrometheusRule \u7684\u57fa\u7840\u7ed3\u6784","text":"<p>\u4e00\u4e2a PrometheusRule \u8d44\u6e90\u7531\u4ee5\u4e0b\u51e0\u4e2a\u5173\u952e\u90e8\u5206\u7ec4\u6210\uff1a</p> <p>\u5143\u6570\u636e\u90e8\u5206</p> <p>\u5b9a\u4e49 PrometheusRule \u7684\u540d\u79f0\u3001\u547d\u540d\u7a7a\u95f4\u548c\u6807\u7b7e\u4fe1\u606f\u3002</p> <pre><code>metadata:\n  name: example-rules\n  namespace: monitoring\n  labels:\n    app.kubernetes.io/name: prometheus\n</code></pre> <p>spec \u90e8\u5206</p> <p>spec \u5b9a\u4e49\u4e86\u89c4\u5219\u7ec4\uff08groups\uff09\uff0c\u5176\u4e2d\u6bcf\u4e2a\u7ec4\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u89c4\u5219\u3002</p> <p>groups:</p> <ul> <li>name\uff1a\u89c4\u5219\u7ec4\u7684\u540d\u79f0\uff0c\u7528\u4e8e\u903b\u8f91\u5206\u7ec4\u3002</li> <li>rules\uff1a\u89c4\u5219\u5217\u8868\uff0c\u5b9a\u4e49\u5177\u4f53\u7684\u544a\u8b66\u6216\u8bb0\u5f55\u89c4\u5219</li> </ul> <p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u5b8c\u6574\u7684 PrometheusRule \u793a\u4f8b\uff1a</p> <pre><code>apiVersion: monitoring.coreos.com/v1\nkind: PrometheusRule\nmetadata:\n  name: example-rules\n  namespace: monitoring\nspec:\n  groups:\nname: example-group\nrules:\n</code></pre> <p>\u8be6\u89e3\u89c4\u5219\u7684\u5b57\u6bb5</p> <p>Alerting Rules</p> <p>\u544a\u8b66\u89c4\u5219\u7684\u6838\u5fc3\u5b57\u6bb5\u5305\u62ec\uff1a</p> <ul> <li>alert<ul> <li>\u544a\u8b66\u540d\u79f0\uff0c\u7b80\u660e\u63cf\u8ff0\u544a\u8b66\u5185\u5bb9</li> <li>HighRequestLatency.</li> </ul> </li> <li>expr<ul> <li>PromoL \u8868\u8fbe\u5f0f\uff0c\u7528\u4e8e\u5b9a\u4e49\u89e6\u53d1\u544a\u8b66\u7684\u6761\u4ef6</li> <li><code>rate(http_request_duration_seconds_bucket{le=\"0.5\"} &lt; 0.1</code> \u8868\u793a\u8fc7\u53bb 5 \u5206\u949f\u5185\u8bf7\u6c42\u5ef6\u8fdf\u5927\u4e8e 0.5 \u79d2\u7684\u6bd4\u4f8b\u5c0f\u4e8e 10%\u3002</li> </ul> </li> <li>for<ul> <li>\u6301\u7eed\u65f6\u95f4\u3002\u544a\u8b66\u6761\u4ef6\u9700\u8981\u6ee1\u8db3\u591a\u957f\u65f6\u95f4\u540e\u624d\u4f1a\u89e6\u53d1</li> <li>\u4f8b\u5982\uff1a2m \u8868\u793a\u6761\u4ef6\u9700\u6301\u7eed2\u5206\u949f</li> </ul> </li> <li>labels<ul> <li>\u81ea\u5b9a\u4e49\u6807\u7b7e\uff0c\u7528\u4e8e\u5bf9\u544a\u8b66\u8fdb\u884c\u5206\u7c7b\u3002</li> <li><code>severity: warning</code></li> </ul> </li> <li>annotations<ul> <li>\u6ce8\u91ca\u4fe1\u606f\uff0c\u901a\u5e38\u7528\u4e8e\u544a\u8b66\u7684\u8be6\u7ec6\u63cf\u8ff0\uff0c</li> <li>summary:</li> <li>description\uff1a\u8be6\u7ec6\u63cf\u8ff0\uff0c\u53ef\u5305\u542b\u53d8\u91cf\u5360\u4f4d\u7b26\uff08\u5982\u6bd4 {{$labels.instance }}\uff09</li> </ul> </li> </ul>"},{"location":"2025/10prometheus/#_3","title":"\u5e94\u7528\u573a\u666f","text":"<p>\u7cfb\u7edf\u8d44\u6e90\u76d1\u63a7\u544a\u8b66</p> <p>\u76d1\u63a7\u8282\u70b9 CPU \u548c\u5185\u5b58\u7684\u4f7f\u7528\u60c5\u51b5\uff0c\u8bbe\u7f6e\u544a\u8b66\u89c4\u5219\uff1a</p> <pre><code>lert: HighCpuUsage\nexpr: node_cpu_seconds_total{mode=\"idle\"} / node_cpu_seconds_total &lt; 0.2\nfor: 1m\nlabels:\n  severity: critical\nannotations:\n  summary: \"High CPU usage detected\"\n  description: \"Instance {{ $labels.instance }} has high CPU usage.\"\n</code></pre> <p>\u5e94\u7528\u6027\u80fd\u76d1\u63a7\u544a\u8b66</p> <p>\u4f8b\u5982\uff0c\u76d1\u63a7 HTTP \u8bf7\u6c42\u9519\u8bef\u7387</p> <pre><code>alert: HighHttpErrorRate\nexpr: rate(http_requests_total{status=~\"5.*\"}[5m]) / rate(http_requests_total[5m]) &gt; 0.05\nfor: 5m\nlabels:\n  severity: warning\nannotations:\n  summary: \"High HTTP error rate detected\"\n  description: \"Instance {{ $labels.instance }} has an HTTP error rate above 5%.\"\n</code></pre> <p>\u6570\u636e\u805a\u5408\u4e0e\u4f18\u5316</p> <p>\u901a\u8fc7\u8bb0\u5f55\u89c4\u5219\u4f18\u5316\u67e5\u8be2\u6027\u80fd\uff0c\u4f8b\u5982\u8bb0\u5f55\u6bcf\u4e2a\u670d\u52a1\u7684\u603b\u8bf7\u6c42\u6570\uff1a</p> <pre><code>record: job:http_requests:total\nexpr: sum(rate(http_requests_total[5m])) by (job)\n</code></pre>"},{"location":"2025/10prometheus/#_4","title":"\u6269\u5c55","text":"<p>\u6211\u4eec\u8981\u60f3\u81ea\u5b9a\u4e49\u4e00\u4e2a\u62a5\u8b66\u89c4\u5219\uff0c\u53ea\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u5177\u6709 <code>prometheus=k8s</code> \u548c <code>role=alert-rules</code> \u6807\u7b7e\u7684 PrometheusRule \u5bf9\u8c61\u5c31\u884c\u4e86\uff0c\u6211\u8fd9\u91cc\u51c6\u5907\u58f0\u660e\u4e00\u4e2a ArgoCD \u7684 Rule\uff1a</p> <pre><code>apiVersion: monitoring.coreos.com/v1\nkind: PrometheusRule\nmetadata:\n  name: argocd-rules\n  namespace: monitoring\n  labels:\n    prometheus: k8s\n    role: alert-rules\n    app.kubernetes.io/name: argocd\n    app.kubernetes.io/part-of: argocd\nspec:\n  groups:\n  - name: argocd.rules\n    rules:\n    # ArgoCD Application Controller \u9ad8\u5ef6\u8fdf\u544a\u8b66\n    - alert: ArgoCDApplicationControllerHighLatency\n      expr: histogram_quantile(0.95, rate(argocd_app_controller_reconciliation_duration_seconds_bucket[5m])) &gt; 1\n      for: 2m\n      labels:\n        severity: warning\n      annotations:\n        summary: \"ArgoCD Application Controller Reconciliation Latency High ({{ $labels.namespace }})\"\n        description: \"The reconciliation latency for ArgoCD application controller in namespace {{ $labels.namespace }} is over 1 second for more than 2 minutes.\"\n\n    # ArgoCD Server \u9ad8\u8bf7\u6c42\u9519\u8bef\u7387\u544a\u8b66\n    - alert: ArgoCDServerHighRequestErrorRate\n      expr: rate(argocd_server_http_requests_total{status=~\"5.*\"}[5m]) &gt; 0.05\n      for: 2m\n      labels:\n        severity: critical\n      annotations:\n        summary: \"ArgoCD Server High Error Rate ({{ $labels.namespace }})\"\n        description: \"The ArgoCD server in namespace {{ $labels.namespace }} has an HTTP error rate over 5% for the past 5 minutes.\"\n\n    # ArgoCD Repo Server \u540c\u6b65\u5931\u8d25\u544a\u8b66\n    - alert: ArgoCDRepoServerSyncFailed\n      expr: increase(argocd_repo_server_git_request_failures_total[5m]) &gt; 5\n      for: 2m\n      labels:\n        severity: critical\n      annotations:\n        summary: \"ArgoCD Repo Server Sync Failures ({{ $labels.namespace }})\"\n        description: \"ArgoCD Repo Server in namespace {{ $labels.namespace }} has more than 5 sync failures in the last 5 minutes.\"\n\n    # ArgoCD Dex Server \u4e0d\u53ef\u7528\u544a\u8b66\n    - alert: ArgoCDDexServerDown\n      expr: up{job=\"argocd-dex-server\"} == 0\n      for: 1m\n      labels:\n        severity: critical\n      annotations:\n        summary: \"ArgoCD Dex Server Down ({{ $labels.namespace }})\"\n        description: \"The ArgoCD Dex Server in namespace {{ $labels.namespace }} is not running for more than 1 minute.\"\n\n    # ArgoCD Application \u8fd0\u884c\u5931\u8d25\u544a\u8b66\n    - alert: ArgoCDApplicationOutOfSync\n      expr: argocd_app_info{health_status!=\"Healthy\"} &gt; 0\n      for: 5m\n      labels:\n        severity: warning\n      annotations:\n        summary: \"ArgoCD Applications Out of Sync ({{ $labels.namespace }})\"\n        description: \"There are applications in ArgoCD that are not in a healthy state for more than 5 minutes.\"\n</code></pre>"},{"location":"2025/10prometheus/#_5","title":"\u4f18\u5316\u544a\u8b66\u7b56\u7565","text":"<ul> <li>\u907f\u514d\u544a\u8b66\u98ce\u66b4<ul> <li>\u4f7f\u7528 for \u5b57\u6bb5\uff0c\u907f\u514d\u77ed\u65f6\u95f4\u5185\u7684\u6ce2\u52a8\u89e6\u53d1\u5927\u91cf\u544a\u8b66\u3002</li> </ul> </li> <li>\u5206\u7ea7\u544a\u8b66<ul> <li>\u8bbe\u7f6e\u4e0d\u540c\u4e25\u91cd\u7ea7\u522b\uff08\u5982 critical \u548c warning\uff09\u7684\u544a\u8b66\u89c4\u5219\u3002</li> </ul> </li> <li>\u57fa\u4e8e\u5386\u53f2\u6570\u636e\u4f18\u5316\u9608\u503c<ul> <li>\u901a\u8fc7\u67e5\u8be2\u5386\u53f2\u6570\u636e\uff0c\u786e\u5b9a\u5408\u7406\u7684\u544a\u8b66\u89e6\u53d1\u9608\u503c\u3002</li> </ul> </li> <li>\u5b9a\u671f\u56de\u987e\u548c\u4f18\u5316\u89c4\u5219<ul> <li>\u5b9a\u671f\u68c0\u67e5\u89c4\u5219\u7684\u89e6\u53d1\u9891\u7387\u548c\u51c6\u786e\u6027\uff0c\u8c03\u6574\u8868\u8fbe\u5f0f\u6216\u9608\u503c</li> </ul> </li> </ul>"},{"location":"2025/11istio/","title":"\u6df1\u5ea6\u5256\u6790 Istio (2025)","text":""},{"location":"2025/11istio/#1-istio","title":"1 \u4ec0\u4e48\u662f Istio\uff1f\u5b83\u7684\u6838\u5fc3\u7ec4\u4ef6\u6709\u54ea\u4e9b\uff1f","text":"<p>Istio \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u670d\u52a1\u7f51\u683c\u5e73\u53f0\uff0c\u65e8\u5728\u7b80\u5316\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\u7684\u670d\u52a1\u95f4\u901a\u4fe1\uff0c\u63d0\u4f9b\u6d41\u91cf\u7ba1\u7406\u3001\u5b89\u5168\u3001\u76d1\u63a7\u548c\u53ef\u89c2\u5bdf\u6027\u7b49\u529f\u80fd\u3002</p> <p>Istio \u63d0\u4f9b\u4e86\u5bf9\u5206\u5e03\u5f0f\u5e94\u7528\u7684\u6d41\u91cf\u63a7\u5236\u3001\u65e5\u5fd7\u8bb0\u5f55\u3001\u8ba4\u8bc1\u6388\u6743\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u5f3a\u5927\u7684\u80fd\u529b\uff0c\u5c24\u5176\u9002\u7528\u4e8e\u590d\u6742\u7684\u4e91\u539f\u751f\u67b6\u6784\u3002</p> <p>\u6838\u5fc3\u7ec4\u4ef6 \uff1a</p> <ul> <li>Pilot\uff1a\u8d1f\u8d23\u7ba1\u7406\u548c\u914d\u7f6e\u6570\u636e\u5e73\u9762\uff08Envoy \u4ee3\u7406\uff09\u3002<ul> <li>\u5b83\u5c06\u670d\u52a1\u7684\u6d41\u91cf\u8def\u7531\u89c4\u5219\u914d\u7f6e\u5230\u5404\u4e2a Envoy \u4ee3\u7406\uff0c\u5e76\u786e\u4fdd\u6570\u636e\u5e73\u9762\u7684\u7a33\u5b9a\u6027\u548c\u4e00\u81f4\u6027\u3002</li> </ul> </li> <li>Mixer\uff1a\u8d1f\u8d23\u96c6\u6210\u5916\u90e8\u670d\u52a1\uff0c\u6536\u96c6\u6307\u6807\u3001\u65e5\u5fd7\u548c\u4e8b\u4ef6\u6570\u636e\u3002\u5b83\u7528\u4e8e\u5904\u7406\u7b56\u7565\u548c\u9065\u6d4b\u6570\u636e</li> <li>Citadel\uff1a\u63d0\u4f9b\u5f3a\u5927\u7684\u670d\u52a1\u95f4\u8ba4\u8bc1\u4e0e\u52a0\u5bc6\u529f\u80fd\uff0c\u652f\u6301\u81ea\u52a8\u751f\u6210\u8bc1\u4e66\uff0c\u652f\u6301 mTLS\uff08\u53cc\u5411 TLS\uff09\u52a0\u5bc6\u3002</li> <li>Envoy Proxy\uff1aIstio \u7684\u6570\u636e\u5e73\u9762\uff0c<ul> <li>\u901a\u8fc7\u4ee3\u7406\u6240\u6709\u8fdb\u5165\u548c\u79bb\u5f00\u670d\u52a1\u7684\u6d41\u91cf\u6765\u5b9e\u73b0\u6d41\u91cf\u63a7\u5236\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u52a0\u5bc6\u7b49\u529f\u80fd\u3002</li> </ul> </li> <li>Galley\uff1a\u914d\u7f6e\u7ba1\u7406\u548c\u9a8c\u8bc1\u5de5\u5177\uff0c\u8d1f\u8d23\u8bfb\u53d6\u3001\u9a8c\u8bc1\u548c\u5206\u53d1 Istio \u914d\u7f6e\u3002</li> </ul>"},{"location":"2025/11istio/#istio-sidecar","title":"Istio \u4e2d\u7684 Sidecar \u6a21\u5f0f\u662f\u4ec0\u4e48\uff1f","text":"<p>\u5728 Istio \u4e2d\uff0cSidecar \u6a21\u5f0f\u662f\u6307\u5c06\u4ee3\u7406\uff08\u901a\u5e38\u662f Envoy \u4ee3\u7406\uff09\u4f5c\u4e3a\u5bb9\u5668\u7684\u65c1\u8fb9\u8fd0\u884c\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u4e0e\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u96c6\u6210\u3002</p> <p>\u6bcf\u4e2a\u5e94\u7528\u5bb9\u5668\u65c1\u8fb9\u90fd\u6709\u4e00\u4e2a Envoy \u4ee3\u7406\u4f5c\u4e3a sidecar \u5bb9\u5668\u3002\u8fd9\u4e2a\u6a21\u5f0f\u7684\u4e3b\u8981\u4f18\u70b9\u662f</p> <ul> <li>\u900f\u660e\u4ee3\u7406\uff1a\u5e94\u7528\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u4fee\u6539\uff0c\u6240\u6709\u6d41\u91cf\u90fd\u88ab Envoy \u4ee3\u7406\u62e6\u622a\u3002</li> <li>\u89e3\u8026\u6d41\u91cf\u63a7\u5236\uff1aEnvoy \u8d1f\u8d23\u6d41\u91cf\u63a7\u5236\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u5b89\u5168\u6027\u548c\u76d1\u63a7\u7b49\u4efb\u52a1\uff0c\u4ece\u800c\u7b80\u5316\u4e86\u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u53d1\u548c\u8fd0\u7ef4\u5de5\u4f5c\u3002</li> </ul> <p>Sidecar \u6a21\u5f0f\u63d0\u4f9b\u4e86\u6d41\u91cf\u7684\u9ad8\u6548\u7ba1\u7406\u548c\u53ef\u89c2\u5bdf\u6027\uff0c\u540c\u65f6\u4fdd\u6301\u4e86\u5e94\u7528\u7684\u7075\u6d3b\u6027\u548c\u72ec\u7acb\u6027\u3002</p>"},{"location":"2025/11istio/#sidecar","title":"Sidecar \u6a21\u5f0f\u63d0\u4f9b\u4e86\u6d41\u91cf\u7684\u9ad8\u6548\u7ba1\u7406\u548c\u53ef\u89c2\u5bdf\u6027\uff0c\u540c\u65f6\u4fdd\u6301\u4e86\u5e94\u7528\u7684\u7075\u6d3b\u6027\u548c\u72ec\u7acb\u6027\u3002","text":"<p>Istio \u7684\u6d41\u91cf\u7ba1\u7406\u901a\u8fc7\u914d\u7f6e VirtualService \u548c DestinationRule \u7b49\u8d44\u6e90\u6765\u5b9e\u73b0\u6d41\u91cf\u63a7\u5236\u3002\u6d41\u91cf\u7ba1\u7406\u7684\u6838\u5fc3\u601d\u60f3\u662f\u901a\u8fc7\u8bbe\u7f6e\u89c4\u5219\u6765\u63a7\u5236\u670d\u52a1\u4e4b\u95f4\u7684\u6d41\u91cf\u6d41\u52a8\u3002</p> <ul> <li>VirtualService\uff1a\u5b9a\u4e49\u4e86\u5982\u4f55\u8def\u7531\u8bf7\u6c42\u5230\u76ee\u6807\u670d\u52a1\uff0c\u652f\u6301\u8d1f\u8f7d\u5747\u8861\u3001\u6545\u969c\u6062\u590d\u3001\u6d41\u91cf\u62c6\u5206\u7b49\u3002<ul> <li>\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u8def\u7531\u89c4\u5219\uff0c\u5c06 90% \u7684\u6d41\u91cf\u53d1\u9001\u5230\u7248\u672c v1\uff0c10% \u7684\u6d41\u91cf\u53d1\u9001\u5230\u7248\u672c v2\u3002</li> </ul> </li> <li>DestinationRule\uff1a\u5b9a\u4e49\u4e86\u9488\u5bf9\u76ee\u6807\u670d\u52a1\u7684\u914d\u7f6e\uff0c\u4e3b\u8981\u7528\u4e8e\u6307\u5b9a\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u3001\u8fde\u63a5\u6c60\u5927\u5c0f\u3001\u91cd\u8bd5\u7b56\u7565\u7b49\u3002</li> <li>Gateways\uff1a\u7ba1\u7406\u5165\u7ad9\u548c\u51fa\u7ad9\u6d41\u91cf\u7684 API Gateway\uff0c\u901a\u8fc7\u5b9a\u4e49 Gateway \u8d44\u6e90\u6765\u63a7\u5236\u5916\u90e8\u6d41\u91cf\u8fdb\u5165\u96c6\u7fa4\u7684\u65b9\u5f0f\u3002</li> <li>VirtualService + DestinationRule\uff1a\u901a\u8fc7\u7ed3\u5408\u4f7f\u7528 VirtualService \u548c DestinationRule\uff0cIstio \u53ef\u4ee5\u5b9e\u73b0\u7ec6\u7c92\u5ea6\u7684\u6d41\u91cf\u63a7\u5236\uff0c\u5982\u91d1\u4e1d\u96c0\u53d1\u5e03\u3001\u84dd\u7eff\u90e8\u7f72\u3001\u6d41\u91cf\u62c6\u5206\u7b49</li> </ul> <p>\u6d41\u91cf\u7ba1\u7406\u529f\u80fd\uff1a</p> <ul> <li>\u6d41\u91cf\u8def\u7531\uff1a\u6839\u636e\u8bf7\u6c42\u7684\u5c5e\u6027\uff08\u5982 URI\u3001Header\u3001Cookie \u7b49\uff09\u6765\u8def\u7531\u6d41\u91cf\u3002</li> <li>\u8d1f\u8f7d\u5747\u8861\uff1a\u53ef\u4ee5\u5bf9\u591a\u4e2a\u670d\u52a1\u526f\u672c\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\u3002</li> <li>\u6545\u969c\u6062\u590d\uff1a\u652f\u6301\u91cd\u8bd5\u3001\u8d85\u65f6\u548c\u65ad\u8def\u5668\u529f\u80fd\u3002</li> <li>\u6d41\u91cf\u62c6\u5206\uff1a\u53ef\u4ee5\u6309\u6bd4\u4f8b\u62c6\u5206\u6d41\u91cf\uff0c\u5e38\u7528\u4e8e\u91d1\u4e1d\u96c0\u53d1\u5e03\u548c A/B \u6d4b\u8bd5\u3002</li> </ul>"},{"location":"2025/11istio/#istio-destinationrule-virtualservice","title":"\u4ec0\u4e48\u662f Istio \u4e2d\u7684 DestinationRule \u548c VirtualService\uff1f","text":"<p>DestinationRule\uff1a\u5b9a\u4e49\u4e86\u5bf9\u76ee\u6807\u670d\u52a1\u7684\u914d\u7f6e\u3002\u5b83\u7528\u4e8e\u6307\u5b9a\u5982\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u3001\u8fde\u63a5\u6c60\u8bbe\u7f6e\u3001\u8d85\u65f6\u8bbe\u7f6e\u7b49\u3002</p> <p>\u4f8b\u5982\uff0c\u53ef\u4ee5\u5b9a\u4e49\u670d\u52a1\u7684\u591a\u4e2a\u7248\u672c\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u7248\u672c\u8bbe\u7f6e\u4e0d\u540c\u7684\u7b56\u7565\uff08\u5982\u4e0d\u540c\u7684\u8d85\u65f6\u6216\u91cd\u8bd5\u7b56\u7565\uff09\u3002</p> <pre><code>apiVersion: networking.istio.io/v1alpha3\nkind:DestinationRule\nmetadata:\nname:my-service\nspec:\nhost:my-service.default.svc.cluster.local\ntrafficPolicy:\n    loadBalancer:\n      simple:ROUND_ROBIN\n    connectionPool:\n      http:\n        maxRequestsPerConnection: 1\n</code></pre> <p>VirtualService\uff1a\u5b9a\u4e49\u4e86\u5982\u4f55\u8def\u7531\u6d41\u91cf\u5230\u76ee\u6807\u670d\u52a1\uff0c\u652f\u6301\u6839\u636e\u8bf7\u6c42\u7684\u5185\u5bb9\u8fdb\u884c\u6d41\u91cf\u62c6\u5206\u3001\u8def\u7531\u89c4\u5219\u7b49\u3002</p> <p>\u901a\u5e38\u4e0e DestinationRule \u914d\u5408\u4f7f\u7528\uff0c\u63a7\u5236\u6d41\u91cf\u7684\u65b9\u5411</p> <pre><code>apiVersion: networking.istio.io/v1alpha3\nkind:VirtualService\nmetadata:\nname:my-service\nspec:\nhosts:\n    -my-service.default.svc.cluster.local\nhttp:\n    -route:\n        -destination:\n            host:my-service.default.svc.cluster.local\n            port:\n              number:80\n          weight:90\n        -destination:\n            host:my-service-v2.default.svc.cluster.local\n            port:\n              number:80\n          weight: 10\n</code></pre>"},{"location":"2025/11istio/#istio","title":"Istio \u5982\u4f55\u5b9e\u73b0\u5b89\u5168\u6027\uff1f","text":"<p>Istio \u63d0\u4f9b\u4e86\u4e00\u5957\u5b8c\u6574\u7684\u5b89\u5168\u673a\u5236\uff0c\u4e3b\u8981\u4f53\u73b0\u5728\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>mTLS\uff08\u53cc\u5411 TLS \u52a0\u5bc6\uff09\uff1aIstio \u63d0\u4f9b\u4e86\u670d\u52a1\u95f4\u901a\u4fe1\u7684\u52a0\u5bc6\u548c\u8eab\u4efd\u9a8c\u8bc1\u529f\u80fd\u3002\u901a\u8fc7\u81ea\u52a8\u4e3a\u670d\u52a1\u751f\u6210\u8bc1\u4e66\u548c\u542f\u7528\u53cc\u5411 TLS\uff0cIstio \u786e\u4fdd\u4e86\u670d\u52a1\u95f4\u901a\u4fe1\u7684\u5b89\u5168\u6027\u3002<ul> <li>Istio \u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e PeerAuthentication \u548c AuthorizationPolicy \u6765\u5f3a\u5236\u670d\u52a1\u95f4\u901a\u4fe1\u4f7f\u7528 mTLS\u3002</li> </ul> </li> <li>\u670d\u52a1\u95f4\u8ba4\u8bc1\uff1aIstio \u4f7f\u7528 Citadel \u4e3a\u6bcf\u4e2a\u670d\u52a1\u751f\u6210\u5e76\u7ba1\u7406\u8bc1\u4e66\uff0c\u652f\u6301\u81ea\u52a8\u8bc1\u4e66\u8f6e\u6362\u548c\u540a\u9500\u3002</li> <li>\u8bbf\u95ee\u63a7\u5236\uff1a\u901a\u8fc7 AuthorizationPolicy\uff0cIstio \u5b9e\u73b0\u7ec6\u7c92\u5ea6\u7684\u8bbf\u95ee\u63a7\u5236\u3002<ul> <li>\u5b83\u53ef\u4ee5\u57fa\u4e8e\u7528\u6237\u8eab\u4efd\u3001IP \u5730\u5740\u3001\u8bf7\u6c42\u8def\u5f84\u7b49\u63a7\u5236\u670d\u52a1\u7684\u8bbf\u95ee\u6743\u9650\u3002</li> </ul> </li> <li>\u5bc6\u94a5\u7ba1\u7406\uff1aIstio \u4e0e KMS\uff08Key Management Service\uff09 \u96c6\u6210\uff0c\u652f\u6301\u5bc6\u94a5\u548c\u8bc1\u4e66\u7684\u96c6\u4e2d\u7ba1\u7406\u3002</li> </ul>"},{"location":"2025/11istio/#istio-gateway","title":"Istio \u4e2d\u7684 Gateway \u662f\u4ec0\u4e48\uff1f","text":"<p>Istio \u4e2d\u7684 Gateway \u662f\u4e00\u79cd\u914d\u7f6e\u8d44\u6e90\uff0c\u7528\u4e8e\u7ba1\u7406\u96c6\u7fa4\u7684\u5165\u7ad9\u548c\u51fa\u7ad9\u6d41\u91cf\u3002\u5b83\u4e3b\u8981\u7528\u4e8e\u66b4\u9732\u670d\u52a1\u5230\u5916\u90e8\u4e16\u754c\u6216\u63a7\u5236\u5916\u90e8\u6d41\u91cf\u8fdb\u5165\u96c6\u7fa4\u3002</p> <ul> <li>Ingress Gateway\uff1a\u662f\u66b4\u9732\u7ed9\u5916\u90e8\u7684\u5165\u53e3\u6d41\u91cf\u7ba1\u7406\u5668\uff0c\u901a\u5e38\u901a\u8fc7\u8bbe\u7f6e IngressGateway \u6765\u7ba1\u7406 HTTP\u3001HTTPS \u548c TCP \u6d41\u91cf\u3002</li> <li>Egress Gateway\uff1a\u63a7\u5236\u6d41\u91cf\u4ece\u96c6\u7fa4\u5185\u90e8\u6d41\u5411\u5916\u90e8\u7684\u51fa\u7ad9\u6d41\u91cf\u3002</li> </ul> <p>Gateway \u5141\u8bb8\u901a\u8fc7 VirtualService \u548c DestinationRule \u914d\u7f6e\u7075\u6d3b\u7684\u6d41\u91cf\u8def\u7531\uff0c\u5e76\u80fd\u8fdb\u884c\u6d41\u91cf\u76d1\u63a7\u548c\u65e5\u5fd7\u8bb0\u5f55\u3002</p>"},{"location":"2025/11istio/#istio-ab","title":"Istio \u4e2d\u7684\u6d41\u91cf\u7ba1\u7406\u5982\u4f55\u652f\u6301\u91d1\u4e1d\u96c0\u53d1\u5e03\u548c A/B \u6d4b\u8bd5\uff1f","text":"<p>Istio \u901a\u8fc7\u6d41\u91cf\u62c6\u5206\u548c\u7ec6\u7c92\u5ea6\u7684\u6d41\u91cf\u8def\u7531\u89c4\u5219\u652f\u6301\u91d1\u4e1d\u96c0\u53d1\u5e03\u548c A/B \u6d4b\u8bd5\u3002</p> <p>\u91d1\u4e1d\u96c0\u53d1\u5e03\uff1a\u901a\u8fc7 VirtualService \u548c DestinationRule\uff0c\u60a8\u53ef\u4ee5\u5c06\u6d41\u91cf\u6309\u7167\u4e00\u5b9a\u6bd4\u4f8b\u62c6\u5206\u3002\u6bd4\u5982\uff0c\u60a8\u53ef\u4ee5\u5c06 90% \u7684\u6d41\u91cf\u53d1\u9001\u5230\u5f53\u524d\u7248\u672c\uff0c\u5c06 10% \u7684\u6d41\u91cf\u53d1\u9001\u5230\u65b0\u7248\u672c\uff0c\u4ee5\u6b64\u8fdb\u884c\u7070\u5ea6\u53d1\u5e03\u6216\u91d1\u4e1d\u96c0\u53d1\u5e03\u3002</p> <pre><code>apiVersion: networking.istio.io/v1alpha3\nkind:VirtualService\nmetadata:\nname:my-service\nspec:\nhosts:\n    -my-service.default.svc.cluster.local\nhttp:\n    -route:\n        -destination:\n            host:my-service-v1.default.svc.cluster.local\n            weight:90\n        -destination:\n            host:my-service-v2.default.svc.cluster.local\n            weight: 10\n</code></pre> <p>A/B \u6d4b\u8bd5\uff1a\u901a\u8fc7\u6d41\u91cf\u62c6\u5206\uff0c\u60a8\u53ef\u4ee5\u4e3a\u4e0d\u540c\u7684\u7248\u672c\u5206\u914d\u4e0d\u540c\u7684\u6d41\u91cf\u6bd4\u4f8b\uff0c\u7528\u4e8e A/B \u6d4b\u8bd5\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u5c06 50% \u7684\u6d41\u91cf\u53d1\u9001\u5230\u7248\u672c A\uff0c50% \u53d1\u9001\u5230\u7248\u672c B\uff0c\u8fdb\u884c\u4e0d\u540c\u7248\u672c\u7684\u6bd4\u8f83\u548c\u6027\u80fd\u5206\u6790\u3002</p>"},{"location":"2025/11istio/#istio_1","title":"Istio \u5982\u4f55\u8fdb\u884c\u65e5\u5fd7\u548c\u76d1\u63a7\uff1f","text":"<p>Istio \u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u65e5\u5fd7\u8bb0\u5f55\u3001\u6307\u6807\u76d1\u63a7\u548c\u8ffd\u8e2a\u80fd\u529b\uff0c\u5e2e\u52a9\u7528\u6237\u4e86\u89e3\u670d\u52a1\u7684\u6027\u80fd\u548c\u5065\u5eb7\u72b6\u6001\u3002</p> <ul> <li>Istio Proxy\uff08Envoy\uff09\u7684\u65e5\u5fd7\uff1aEnvoy \u4ee3\u7406\u8bb0\u5f55\u6d41\u91cf\u548c\u8bf7\u6c42\u7684\u65e5\u5fd7\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7 Istio Access Log \u914d\u7f6e\u6765\u8bb0\u5f55\u548c\u5206\u6790 HTTP \u8bf7\u6c42\u65e5\u5fd7\u3002</li> <li>Prometheus \u96c6\u6210\uff1aIstio \u4e0e Prometheus \u96c6\u6210\uff0c\u63d0\u4f9b\u5b9e\u65f6\u7684\u670d\u52a1\u7ea7\u522b\u6307\u6807\uff0c\u5982\u8bf7\u6c42\u6570\u3001\u54cd\u5e94\u65f6\u95f4\u3001\u9519\u8bef\u7387\u7b49\u3002</li> <li>Grafana \u96c6\u6210\uff1a\u4e0e Grafana \u96c6\u6210\uff0c\u53ef\u4ee5\u901a\u8fc7\u56fe\u8868\u548c\u4eea\u8868\u677f\u67e5\u770b\u96c6\u7fa4\u548c\u670d\u52a1\u7684\u6027\u80fd\u3002</li> <li>Jaeger / Zipkin \u96c6\u6210\uff1a\u652f\u6301\u5206\u5e03\u5f0f\u8ffd\u8e2a\uff0c\u53ef\u4ee5\u8ddf\u8e2a\u8bf7\u6c42\u4ece\u4e00\u4e2a\u670d\u52a1\u5230\u53e6\u4e00\u4e2a\u670d\u52a1\u7684\u751f\u547d\u5468\u671f\uff0c\u5e2e\u52a9\u8bca\u65ad\u95ee\u9898\u3002</li> </ul> <p>\u901a\u8fc7\u8fd9\u4e9b\u76d1\u63a7\u5de5\u5177\uff0cIstio \u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u53ef\u89c2\u5bdf\u6027\uff0c\u4f7f\u5f97\u5f00\u53d1\u8005\u548c\u8fd0\u7ef4\u4eba\u5458\u53ef\u4ee5\u5b9e\u65f6\u4e86\u89e3\u5e94\u7528\u548c\u670d\u52a1\u7684\u5065\u5eb7\u72b6\u51b5\u3002</p>"},{"location":"2025/11istio/#istio-k8s","title":"\u4f60\u4eec\u516c\u53f8\u7684 Istio \u5bf9\u4e8e k8s \u96c6\u7fa4\u662f\u600e\u4e48\u7ba1\u7406\u7684","text":"<p>Istio \u662f\u4e00\u4e2a\u975e\u5e38\u5f3a\u5927\u7684\u5f00\u6e90\u670d\u52a1\u7f51\u683c\uff0c\u7528\u4e8e\u7ba1\u7406\u5fae\u670d\u52a1\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u901a\u8fc7 Istio\uff0c\u60a8\u53ef\u4ee5\u8f7b\u677e\u5730\u7ba1\u7406\u6d41\u91cf\u3001\u5b9e\u73b0\u670d\u52a1\u53d1\u73b0\u3001\u63a7\u5236\u6d41\u91cf\u8def\u7531\u3001\u5b89\u5168\u7b56\u7565\u3001\u76d1\u63a7\u7b49\u529f\u80fd\u3002</p> <p>\u5bf9\u4e8e Kubernetes \u96c6\u7fa4\uff0cIstio \u901a\u5e38\u7684\u7ba1\u7406\u65b9\u5f0f\u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0b\u51e0\u4e2a\u91cd\u8981\u90e8\u5206\uff1a</p>"},{"location":"2025/11istio/#1-istio-controlplane","title":"1. Istio\u63a7\u5236\u5e73\u9762 (ControlPlane)","text":"<p>Istio \u7684\u63a7\u5236\u5e73\u9762\u7531\u4ee5\u4e0b\u7ec4\u4ef6\u7ec4\u6210\uff1a</p> <ul> <li>Istiod\uff1a\u8fd9\u662f Istio \u7684\u6838\u5fc3\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\uff0c\u8d1f\u8d23\u5904\u7406\u914d\u7f6e\u7ba1\u7406\u3001\u8bc1\u4e66\u7ba1\u7406\u3001\u6d41\u91cf\u7ba1\u7406\u7b56\u7565\u7b49\u4efb\u52a1\u3002<ul> <li>\u5b83\u8fd8\u5904\u7406\u4e0e\u6570\u636e\u5e73\u9762\uff08\u4f8b\u5982 Envoy \u4ee3\u7406\uff09\u7684\u901a\u4fe1\u3002Istiod \u8fd0\u884c\u5728 Kubernetes \u96c6\u7fa4\u4e2d\uff0c\u5e76\u7ba1\u7406 Istio \u7684\u914d\u7f6e\u3002</li> </ul> </li> <li>\u4f8b\u5982\uff0c\u5728 Kubernetes \u4e2d\u90e8\u7f72 Istio \u65f6\uff0cistiod \u4f1a\u4f5c\u4e3a\u4e00\u4e2a\u670d\u52a1\u90e8\u7f72\uff0c\u7528\u4e8e\u534f\u8c03\u6574\u4e2a\u7f51\u683c\u7684\u6240\u6709\u914d\u7f6e\u548c\u7b56\u7565</li> </ul>"},{"location":"2025/11istio/#2istio-dataplane","title":"2.Istio\u6570\u636e\u7247\u9762 (DataPlane)","text":"<p>Istio \u7684\u6570\u636e\u5e73\u9762\u7531\u591a\u4e2a Envoy \u4ee3\u7406 \u7ec4\u6210\uff0c\u6bcf\u4e2a\u670d\u52a1\u5b9e\u4f8b\u7684\u65c1\u8fb9\u90fd\u4f1a\u6709\u4e00\u4e2a Envoy \u4ee3\u7406\u4f5c\u4e3a sidecar \u4ee3\u7406\u3002\u8fd9\u4e9b\u4ee3\u7406\u8d1f\u8d23\u5904\u7406\u4f20\u5165\u548c\u4f20\u51fa\u7684\u6240\u6709\u6d41\u91cf\u3002</p> <ul> <li>Envoy \u4ee3\u7406\u4f1a\u88ab\u90e8\u7f72\u5230\u6bcf\u4e2a\u670d\u52a1\u7684\u5bb9\u5668\u4e2d\uff0c\u5e76\u4e14\u5728\u6240\u6709\u5fae\u670d\u52a1\u4e4b\u95f4\u62e6\u622a\u548c\u7ba1\u7406\u6d41\u91cf\uff0c\u6267\u884c\u6d41\u91cf\u8def\u7531\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u5b89\u5168\u8ba4\u8bc1\u7b49\u64cd\u4f5c\u3002</li> <li>\u5728 Kubernetes \u4e2d\uff0c\u901a\u5e38\u662f\u901a\u8fc7\u81ea\u52a8\u6ce8\u5165 Istio sidecar \u5bb9\u5668\u6765\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0c\u5177\u4f53\u662f\u5728\u90e8\u7f72\u65f6\u4f7f\u7528 <code>istio-injection=enabled</code> \u6807\u7b7e\uff0c\u6216\u8005\u901a\u8fc7\u624b\u52a8\u6ce8\u5165\u3002</li> </ul>"},{"location":"2025/11istio/#3","title":"3.\u914d\u7f6e\u548c\u7ba1\u7406\uff1a","text":"<ul> <li>\u6d41\u91cf\u7ba1\u7406\uff1a\u901a\u8fc7\u5b9a\u4e49 VirtualService \u548c DestinationRule \u7b49\u8d44\u6e90\uff0cIstio \u53ef\u4ee5\u7075\u6d3b\u5730\u63a7\u5236\u6d41\u91cf\u8def\u7531\u3001\u6d41\u91cf\u62c6\u5206\u3001\u91cd\u8bd5\u548c\u8d85\u65f6\u7b49\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u914d\u7f6e\u4e0d\u540c\u7248\u672c\u7684\u670d\u52a1\u4e4b\u95f4\u7684\u6d41\u91cf\u6bd4\u4f8b\uff08\u5982\u84dd\u7eff\u53d1\u5e03\u3001\u91d1\u4e1d\u96c0\u53d1\u5e03\u7b49\uff09\u3002</li> <li>\u5b89\u5168\u6027\uff1aIstio \u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u670d\u52a1\u95f4\u901a\u4fe1\u5b89\u5168\u529f\u80fd\uff0c\u901a\u8fc7 mTLS\uff08\u53cc\u5411 TLS \u52a0\u5bc6\uff09\u6765\u786e\u4fdd\u670d\u52a1\u4e4b\u95f4\u7684\u901a\u4fe1\u662f\u52a0\u5bc6\u548c\u9a8c\u8bc1\u7684\u3002\u540c\u65f6\uff0cIstio \u4e5f\u652f\u6301\u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e PeerAuthentication \u548c AuthorizationPolicy \u6765\u63a7\u5236\u6d41\u91cf\u7684\u8bbf\u95ee\u6743\u9650\u3002</li> <li>\u89c2\u5bdf\u6027\uff1aIstio \u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u89c2\u5bdf\u6027\u529f\u80fd\uff0c\u5305\u62ec\u6d41\u91cf\u7684\u76d1\u63a7\u3001\u65e5\u5fd7\u8bb0\u5f55\u3001\u8ffd\u8e2a\u548c\u6307\u6807\u6536\u96c6\u3002<ul> <li>Istio \u4e0e Prometheus\u3001Grafana\u3001Jaeger \u7b49\u6d41\u884c\u7684\u76d1\u63a7\u5de5\u5177\u96c6\u6210\uff0c\u5e2e\u52a9\u5f00\u53d1\u548c\u8fd0\u7ef4\u56e2\u961f\u5b9e\u65f6\u67e5\u770b\u6d41\u91cf\u72b6\u51b5\u548c\u670d\u52a1\u5065\u5eb7\u3002</li> </ul> </li> </ul>"},{"location":"2025/11istio/#4","title":"4.\u90e8\u7f72\u548c\u7ef4\u62a4","text":"<p>\u5728 Kubernetes \u4e2d\u5b89\u88c5 Istio \u65f6\uff0c\u901a\u5e38\u4f1a\u4f7f\u7528 Helm \u6216 Istio \u5b98\u65b9\u63d0\u4f9b\u7684\u5b89\u88c5\u811a\u672c\u8fdb\u884c\u90e8\u7f72\u3002\u4e0b\u9762\u662f\u5e38\u89c1\u7684\u5b89\u88c5\u6b65\u9aa4\uff1a</p> <ol> <li>\u5b89\u88c5 Istio \u63a7\u5236\u5e73\u9762\uff08istiod\uff09\u548c\u76f8\u5173\u7ec4\u4ef6\u3002</li> <li>\u4f7f\u7528 Istio sidecar \u6ce8\u5165\uff0c\u53ef\u4ee5\u81ea\u52a8\u4e3a\u6bcf\u4e2a\u670d\u52a1\u5bb9\u5668\u6ce8\u5165 Envoy \u4ee3\u7406\uff0c\u6216\u8005\u624b\u52a8\u6ce8\u5165\u3002</li> <li>\u914d\u7f6e\u6d41\u91cf\u7ba1\u7406\u89c4\u5219\u3001\u6743\u9650\u7b56\u7565\u7b49</li> </ol> <p>\u7ba1\u7406\u548c\u5347\u7ea7</p> <ul> <li>Istio \u7684\u7248\u672c\u7ba1\u7406\uff1aIstio \u63d0\u4f9b\u4e86 istioctl \u5de5\u5177\uff0c\u5e2e\u52a9\u7ba1\u7406\u5458\u6267\u884c\u7248\u672c\u7ba1\u7406\u3001\u5347\u7ea7\u64cd\u4f5c\u4ee5\u53ca\u914d\u7f6e\u96c6\u7fa4\u3002</li> <li>\u6269\u5c55\u6027\uff1a\u901a\u8fc7 Istio \u7684\u63d2\u4ef6\u548c\u81ea\u5b9a\u4e49\u8d44\u6e90\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u6269\u5c55\u548c\u5b9a\u5236 Istio</li> </ul> <p>4.\u9ad8\u53ef\u7528\u548c\u6269\u5c55\u6027</p> <p>Istio \u672c\u8eab\u8bbe\u8ba1\u4e3a\u9ad8\u53ef\u7528\uff0c\u5e76\u4e14\u652f\u6301\u5728\u591a\u4e2a Kubernetes \u96c6\u7fa4\u4e4b\u95f4\u8fdb\u884c\u8de8\u96c6\u7fa4\u901a\u4fe1\u548c\u7ba1\u7406\u3002\u60a8\u53ef\u4ee5\u914d\u7f6e Istio \u4ee5\u5b9e\u73b0\u8de8\u533a\u57df\u7684\u670d\u52a1\u901a\u4fe1\u548c\u6d41\u91cf\u7ba1\u7406</p> <p>\u603b\u7ed3</p> <p>\u5728 Kubernetes \u96c6\u7fa4\u4e2d\uff0cIstio \u901a\u8fc7\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\uff08\u5982 istiod\uff09\u548c\u6570\u636e\u5e73\u9762\u7ec4\u4ef6\uff08\u5982 Envoy \u4ee3\u7406\uff09\u5171\u540c\u7ba1\u7406\u670d\u52a1\u95f4\u7684\u6d41\u91cf\u3002\u5b83\u63d0\u4f9b\u6d41\u91cf\u7ba1\u7406\u3001\u5b89\u5168\u3001\u89c2\u5bdf\u6027\u548c\u7b56\u7565\u6267\u884c\u7b49\u5f3a\u5927\u529f\u80fd\uff0c\u5e2e\u52a9\u5f00\u53d1\u548c\u8fd0\u7ef4\u56e2\u961f\u6709\u6548\u7ba1\u7406\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\u7684\u590d\u6742\u6d41\u91cf</p>"},{"location":"2025/11istio/#istio-503","title":"\u5982\u679c Istio \u76f8\u5173\u670d\u52a1\u62a5\u9519\uff1a503\uff0c\u4f60\u8be5\u5982\u4f55\u89e3\u51b3\uff1f","text":"<p>\u5f53 Istio \u76f8\u5173\u670d\u52a1\u8fd4\u56de 503 \u9519\u8bef\u65f6\uff0c\u901a\u5e38\u8868\u793a\u670d\u52a1\u4e0d\u53ef\u7528\uff0c\u6216\u8005\u8bf7\u6c42\u65e0\u6cd5\u88ab\u6210\u529f\u8def\u7531\u3002503 \u9519\u8bef\u901a\u5e38\u662f\u7531\u4e8e\u6d41\u91cf\u65e0\u6cd5\u5230\u8fbe\u76ee\u6807\u670d\u52a1\u3001\u914d\u7f6e\u9519\u8bef\u3001\u6743\u9650\u95ee\u9898\u6216\u73af\u5883\u6545\u969c\u7b49\u539f\u56e0\u5bfc\u81f4\u7684\u3002\u4ee5\u4e0b\u662f\u6392\u67e5 Istio \u670d\u52a1\u8fd4\u56de 503 \u9519\u8bef\u7684\u4e00\u4e9b\u6b65\u9aa4</p>"},{"location":"2025/11istio/#istio_2","title":"Istio \u7ec4\u4ef6\u7684\u65e5\u5fd7","text":"<p>\u9996\u5148\uff0c\u68c0\u67e5 Istio \u7ec4\u4ef6\u7684\u65e5\u5fd7\uff0c\u7279\u522b\u662f Istiod \u548c Envoy \u4ee3\u7406 \u7684\u65e5\u5fd7\u3002\u901a\u8fc7\u65e5\u5fd7\u53ef\u4ee5\u83b7\u53d6\u9519\u8bef\u7684\u8be6\u7ec6\u4fe1\u606f</p>"},{"location":"2025/11istio/#istiod","title":"\u68c0\u67e5Istiod\u7684\u65e5\u5fd7","text":"<pre><code>kubectl logs -n istio-system -l app=istiod -c istiod\n</code></pre> <p>\u68c0\u67e5\u4ee3\u7406\u7684\u65e5\u5fd7</p> <p>\u6bcf\u4e2a\u670d\u52a1\u65c1\u8fb9\u90fd\u6709\u4e00\u4e2a Envoy sidecar \u4ee3\u7406\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u68c0\u67e5\u5177\u4f53\u670d\u52a1\u7684 Envoy \u65e5\u5fd7\uff1a</p> <pre><code>kubectl logs &lt;pod-name&gt; -c istio-proxy\n</code></pre> <p>\u5982\u679c\u670d\u52a1\u4e2d\u6709\u591a\u4e2a\u526f\u672c\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u6240\u6709\u526f\u672c\u7684\u65e5\u5fd7\uff1a</p> <pre><code>kubectl logs -l app=&lt;your-app-name&gt; -c istio-proxy\n</code></pre> <p>\u8fd9\u4e9b\u65e5\u5fd7\u4f1a\u544a\u8bc9\u60a8\u8bf7\u6c42\u5931\u8d25\u7684\u539f\u56e0\uff0c\u5c24\u5176\u662f 503 \u9519\u8bef\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p>"},{"location":"2025/11istio/#2-istio","title":"2 \u68c0\u67e5Istio\u7684\u914d\u7f6e","text":"<p>VirtualService\u914d\u7f6e</p> <p>\u68c0\u67e5\u76f8\u5173\u7684 VirtualService \u662f\u5426\u6b63\u786e\u914d\u7f6e\u4e86\u6d41\u91cf\u8def\u7531\u3002\u786e\u4fdd\u60a8\u7684 VirtualService \u4e2d\u7684\u8def\u7531\u89c4\u5219\u3001\u4e3b\u673a\u3001\u7aef\u53e3\u7b49\u4fe1\u606f\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u5b58\u5728\u914d\u7f6e\u9519\u8bef\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6d41\u91cf\u88ab\u8def\u7531\u5230\u4e0d\u5b58\u5728\u6216\u4e0d\u53ef\u8fbe\u7684\u670d\u52a1</p> <pre><code>kubectl get virtualservice &lt;your-virtualservice&gt; -o yaml\n</code></pre> <p>DestinationRule \u914d\u7f6e</p> <p>DestinationRule \u914d\u7f6e\u7528\u4e8e\u6307\u5b9a\u76ee\u6807\u670d\u52a1\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u3001\u8fde\u63a5\u6c60\u914d\u7f6e\u7b49\u3002\u68c0\u67e5\u662f\u5426\u6709\u914d\u7f6e\u9519\u8bef\uff0c\u7279\u522b\u662f\u662f\u5426\u6b63\u786e\u914d\u7f6e\u4e86 subsets\uff08\u5982\u679c\u4f7f\u7528\u4e86\u7248\u672c\u5316\u670d\u52a1\uff09\u3002</p> <pre><code>kubectl get destinationrule &lt;your-destinationrule&gt; -o yaml\n</code></pre> <p>\u68c0\u67e5\u670d\u52a1\u548c\u7aef\u53e3</p> <p>\u68c0\u67e5\u662f\u5426\u76ee\u6807\u670d\u52a1\u6b63\u5e38\u8fd0\u884c\uff0c\u4ee5\u53ca\u670d\u52a1\u7aef\u53e3\u662f\u5426\u6b63\u786e\u6620\u5c04\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u670d\u52a1\u548c\u7aef\u53e3\u7684\u72b6\u6001\uff1a</p> <pre><code>kubectl get svc -n &lt;namespace&gt;\n</code></pre> <p>\u5982\u679c\u76ee\u6807\u670d\u52a1\u6ca1\u6709\u8fd0\u884c\u6216\u7aef\u53e3\u9519\u8bef\uff0cIstio \u53ef\u80fd\u65e0\u6cd5\u6210\u529f\u8def\u7531\u6d41\u91cf\uff0c\u5bfc\u81f4 503 \u9519\u8bef\u3002</p> <p>Istio \u63d0\u4f9b</p>"},{"location":"2025/11istio/#istio_3","title":"\u68c0\u67e5Istio\u7f51\u683c\u7684\u6d41\u91cf\u8def\u7531","text":"<p>\u4f7f\u7528 Istio \u63d0\u4f9b\u7684\u6d41\u91cf\u7ba1\u7406\u5de5\u5177\uff0c\u68c0\u67e5\u662f\u5426\u5b58\u5728\u6d41\u91cf\u4e22\u5931\u6216\u8def\u7531\u5931\u8d25\u7684\u60c5\u51b5\u3002</p> <p>\u67e5\u770b\u8def\u7531\u8868</p> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u76ee\u6807\u670d\u52a1\u7684\u8def\u7531\u662f\u5426\u6b63\u5e38\uff1a</p> <pre><code>istioctl proxy-status\n</code></pre> <p>\u5982\u679c\u76ee\u6807\u670d\u52a1\u7684\u6d41\u91cf\u6ca1\u6709\u88ab\u6b63\u786e\u8def\u7531\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4 503 \u9519\u8bef\u3002</p>"},{"location":"2025/11istio/#5","title":"5.\u68c0\u67e5\u8bc1\u4e66\u548c\u6743\u9650\u95ee\u9898","text":"<p>Istio \u4f7f\u7528 mTLS \u6765\u52a0\u5bc6\u548c\u9a8c\u8bc1\u670d\u52a1\u95f4\u7684\u901a\u4fe1\u3002\u5982\u679c\u8bc1\u4e66\u51fa\u73b0\u95ee\u9898\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4 503 \u9519\u8bef\u3002\u68c0\u67e5\u662f\u5426\u5b58\u5728\u8bc1\u4e66\u95ee\u9898\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u76f8\u5173\u7684 PeerAuthentication \u548c AuthorizationPolic\uff1a</p> <pre><code>kubectl get peerauthentication -n istio-system -o yaml\n\nkubectl get authorizationpolicy -n istio-system -o yaml\n</code></pre> <p>\u786e\u4fdd\u670d\u52a1\u95f4\u7684 mTLS \u914d\u7f6e\u548c\u6743\u9650\u7b56\u7565\u6ca1\u6709\u95ee\u9898\u3002</p>"},{"location":"2025/11istio/#6","title":"6.\u68c0\u6773\u670d\u52a1\u95f4\u7684\u8fde\u63a5","text":"<p>istioctl proxy-config \u5de5\u5177\u68c0\u67e5\u670d\u52a1\u95f4\u7684\u8fde\u63a5\u914d\u7f6e\uff0c\u4f8b\u5982\u8fde\u63a5\u6c60\u3001 \u91cd\u8bd5\u7b49\uff1a</p> <pre><code>istioctl proxy-config cluster &lt;pod-name&gt; --name &lt;service-name&gt;.&lt;namespace&gt;.svc.cluster.local\n</code></pre>"},{"location":"2025/11istio/#7","title":"7 \u68c0\u67e5\u7f51\u7edc\u8fde\u63a5","text":"<p>\u68c0\u67e5 Kubernetes \u96c6\u7fa4\u5185\u90e8\u662f\u5426\u5b58\u5728\u7f51\u7edc\u95ee\u9898\uff0c\u7279\u522b\u662f\u5728\u8def\u8282\u70b9\u6216\u8de8\u96c6\u7fa4\u7684\u60c5\u51b5\u4e0b\u3002\u4f7f\u7528kubectl exec\u8fdb\u5165\u67d0\u4e2aPod \u4e2d\uff0c\u6d4b\u8bd5\u662f\u5426\u53ef\u4ee5\u6b63\u5e38\u8fde\u63a5\u5230\u76ee\u6807\u670d\u52a1\uff1a</p> <pre><code>kubectl exec -it &lt;pod-name&gt; -- curl &lt;target-service&gt;:&lt;port&gt;\n</code></pre> <p>\u5982\u679c\u662f Envoy \u4ee3\u7406\u5bfc\u81f4\u7684 503 \u9519\u8bef\uff0c\u53ef\u80fd\u662f\u4ee3\u7406\u914d\u7f6e\u95ee\u9898\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 istioctl proxy-config \u6765\u67e5\u770b\u4ee3\u7406\u914d\u7f6e\uff0c\u4f8b\u5982\u8d1f\u8f7d\u5747\u8861\u3001\u8def\u7531\u914d\u7f6e\u7b49</p> <pre><code>istioctl proxy-config routes &lt;pod-name&gt; -o yaml\n</code></pre>"},{"location":"2025/11istio/#8enooy","title":"8.\u68c0\u67e5Enooy\u4ee3\u7406\u7684\u914d\u7f6e","text":"<p>\u5982\u679c\u662f Envoy \u4ee3\u7406\u5bfc\u81f4\u7684503\u9519\u8bef\uff0c\u53ef\u80fd\u662f\u4ee3\u7406\u914d\u7f6e\u95ee\u9898\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528istioctl proxy-config \u6765\u67e5\u770b\u4ee3\u7406\u914d\u7f6e\uff0c\u4f8b\u5982\u8d1f\u8f7d\u5747\u8861\u3001\u8def\u7531\u914d\u7f6e\u7b49</p> <pre><code>istioctl proxy-config routes &lt;pod-name&gt; -o yaml\n</code></pre> <p>\u5728 Envoy \u914d\u7f6e\u4e2d\u68c0\u67e5\u662f\u5426\u5b58\u5728\u914d\u7f6e\u9519\u8bef\u5bfc\u81f4\u6d41\u91cf\u8def\u7531\u5931\u8d25\u3002\u4f8b\u5982\uff0c\u67e5\u770b Listener \u914d\u7f6e\uff1a</p> <pre><code>istioctl proxy-config listeners &lt;pod-name&gt;\n</code></pre>"},{"location":"2025/11istio/#9istio","title":"9.\u8bca\u65adIstio\u73af\u5883","text":"<p>\u4f7f\u7528 lstio \u7684\u8bca\u65ad\u5de5\u5177istioctl\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u68c0\u67e5\u6574\u4e2a\u670d\u52a1\u7f51\u683c\u7684\u5065\u5eb7\u72b6\u6001\uff1a</p> <pre><code>istioctl analyze\n</code></pre> <p>\u8be5\u547d\u4ee4\u4f1a\u68c0\u67e5 Istio \u4e2d\u6240\u6709\u7684\u8d44\u6e90\u914d\u7f6e\uff0c\u5e76\u62a5\u544a\u6f5c\u5728\u7684\u9519\u8bef\u6216\u8b66\u544a\u3002</p> <p>\u8981\u6392\u67e5 Istio \u76f8\u5173\u670d\u52a1\u8fd4\u56de 503 \u9519\u8bef\uff0c\u8bf7\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li>\u67e5\u770b Istio \u548c Envoy \u4ee3\u7406\u7684\u65e5\u5fd7\uff0c\u627e\u51fa\u8bf7\u6c42\u5931\u8d25\u7684\u5177\u4f53\u539f\u56e0\u3002</li> <li>\u68c0\u67e5 VirtualService \u548c DestinationRule \u914d\u7f6e\uff0c\u786e\u8ba4\u6d41\u91cf\u8def\u7531\u662f\u5426\u6b63\u786e\u3002</li> <li>\u786e\u8ba4\u76ee\u6807\u670d\u52a1\u662f\u5426\u6b63\u5e38\u8fd0\u884c\uff0c\u68c0\u67e5\u670d\u52a1\u548c\u7aef\u53e3\u7684\u72b6\u6001\u3002</li> <li>\u4f7f\u7528 Istio \u6d41\u91cf\u7ba1\u7406\u5de5\u5177\u68c0\u67e5\u8def\u7531\u8868\uff0c\u786e\u8ba4\u662f\u5426\u5b58\u5728\u6d41\u91cf\u4e22\u5931\u6216\u5931\u8d25\u3002</li> <li>\u68c0\u67e5\u8bc1\u4e66\u914d\u7f6e\u548c\u6743\u9650\u7b56\u7565\uff0c\u786e\u4fdd\u670d\u52a1\u95f4\u901a\u4fe1\u7684\u5b89\u5168\u6027\u548c\u6743\u9650\u95ee\u9898\u6ca1\u6709\u5bfc\u81f4 503 \u9519\u8bef\u3002</li> <li>\u4f7f\u7528 istioctl \u5de5\u5177\u68c0\u67e5\u7f51\u7edc\u548c\u4ee3\u7406\u914d\u7f6e\uff0c\u786e\u4fdd\u7f51\u7edc\u548c\u4ee3\u7406\u914d\u7f6e\u6b63\u5e38\u3002</li> </ol>"},{"location":"2025/11istio/#istio_4","title":"Istio \u7070\u5ea6\u6545\u969c\u80cc\u540e\u7684\u53ef\u89c2\u6d4b\u6027\u57cb\u70b9\u8bbe\u8ba1\u6709\u54ea\u4e9b\u5751\uff1f","text":"<p>\u67d0\u91d1\u878d\u5e73\u53f0\u4f7f\u7528 Istio 1.20 \u5bf9\u652f\u4ed8\u670d\u52a1\u8fdb\u884c\u7070\u5ea6\u53d1\u5e03\uff0c\u65b0\u7248\u672c payment-service:v2 \u901a\u8fc7 VirtualService \u914d\u7f6e 10% \u6d41\u91cf\u6743\u91cd\u3002\u4e0a\u7ebf\u540e\u89e6\u53d1\u590d\u5408\u578b\u544a\u8b66</p> <pre><code># \u5f02\u5e38\u53e0\u52a0\u573a\u666f\n-**\u4e1a\u52a1\u5c42**\uff1a10%\u7528\u6237\u652f\u4ed8\u5931\u8d25\uff08HTTP500\uff09\uff0c\u9519\u8bef\u96c6\u4e2d\u5728\u8ba2\u5355\u63d0\u4ea4\u63a5\u53e3`/api/v1/pay`\n-**\u4e2d\u95f4\u4ef6\u5c42**\uff1av2PodMySQL\u8fde\u63a5\u6c60\u8fbe\u5230\u4e0a\u9650\uff08100\u8fde\u63a5\uff09\uff0c\u65e5\u5fd7\u62a5\u9519`CannotacquireJDBCconnection`\n-**\u7f51\u7edc\u5c42**\uff1aIngressGateway\u51fa\u73b00.5%\u7684`NO_ROUTE`\u9519\u8bef\uff0c\u90e8\u5206\u8bf7\u6c42\u7ed5\u8fc7Sidecar\u76f4\u8fdePod IP\n</code></pre>"},{"location":"2025/11istio/#15","title":"1\u30015\u5206\u949f\u7cbe\u51c6\u6b62\u8840\uff1a\u591a\u7ef4\u5ea6\u56de\u6eda\u65b9\u6848","text":""},{"location":"2025/11istio/#_1","title":"\u4e09\u7ef4\u5b9a\u4f4d\u6cd5\u5feb\u901f\u6eaf\u6e90","text":"<p>\u8def\u7531\u89c4\u5219\u9a8c\u8bc1</p> <p>\u68c0\u67e5Envoy\u5b9e\u9645\u751f\u6548\u914d\u7f6e\uff08\u5bf9\u6bd4\u58f0\u660e\u5f0f\u914d\u7f6e\uff09</p> <pre><code>istioctl proxy-config routes $(kubectl -n istio-system get pod -l app=istio-ingressgateway -o name) \\\n--name payment-service -o json | jq '.routes[0].route.weightedClusters'\n</code></pre> <p>\u5173\u952e\u9a8c\u8bc1\u70b9\uff1a</p> <ul> <li>\u6743\u91cd\u5206\u5e03\u662f\u5426\u51c6\u786e\uff08v1:90% vs v2:10%\uff09</li> <li>\u662f\u5426\u5b58\u5728\u9690\u85cf\u8def\u7531\u89c4\u5219\u8986\u76d6\uff08\u5982\u7cbe\u786e\u8def\u5f84 <code>/api/v1/pay</code> \u6307\u5411v2\uff09</li> </ul> <p>\u7f51\u7edc\u62d3\u6251\u6d4b\u7ed8</p> <pre><code># \u7ed8\u5236\u670d\u52a1\u4f9d\u8d56\u56fe\u8c31\uff08\u9700\u5b89\u88c5kubectl-neat\uff09\nkubectl get svc,deploy,pod -l app=payment-service -o json | kubectl-neat | jq '.items[] | {name:.metadata.name, labels:.metadata.labels}'\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <pre><code>{\n  \"name\":\"payment-service-v2\",\n\"labels\":{\n    \"app\":\"payment-service\",\n    \"version\":\"v2\",\n    \"istio.io/rev\":\"istio-120\"// \u786e\u8ba4Sidecar\u6ce8\u5165\u7248\u672c\n}\n}\n</code></pre>"},{"location":"2025/11istio/#2","title":"2. \u5206\u7ea7\u7194\u65ad\u7b56\u7565","text":"<p>\u65b9\u6848A\uff1a\u6743\u91cd\u52a8\u6001\u5f52\u96f6\uff08\u4fdd\u7559\u73b0\u573a\uff09</p> <pre><code>kubectl patch virtualservice payment -type=merge -p \\\n'{\"spec\":{\"http\":[{\"route\":[{\"destination\":{\"host\":\"payment-service\",\"subset\":\"v1\"},\"weight\":100}]}]}}'\n</code></pre> <p>\u6548\u679c\u9a8c\u8bc1\uff1a</p> <pre><code>watch -n 1 'kubectl exec -n istio-system deploy/istio-ingressgateway -- curl -s http://localhost:15000/stats | grep v2.upstream_rq_active'\n# \u9884\u671f\u8f93\u51fa\uff1av2.upstream_rq_active 0\n</code></pre> <p>\u65b9\u6848B\uff1a\u7269\u7406\u9694\u79bb\uff08\u6781\u7aef\u573a\u666f\uff09</p> <pre><code># \u901a\u8fc7\u6807\u7b7e\u9a71\u9010v2 Pod\nkubectl label pods -l version=v2 version=quarantine --overwrite\nkubectl scale deploy/payment-service-v2 --replicas=0\n\n# \u6e05\u7406\u6b8b\u7559Endpoint\nkubectl get endpoints payment-service -o json | jq '.subsets[].addresses |= map(select(.targetRef.resourceVersion != \"v2\"))' | kubectl apply -f -\n</code></pre>"},{"location":"2025/11istio/#3_1","title":"3. \u6d41\u91cf\u51c0\u5316\uff08\u9632\u65c1\u8def\u653b\u51fb\uff09","text":"<pre><code># \u5f3a\u5236\u6240\u6709\u6d41\u91cf\u7ecf\u8fc7Sidecar\uff08NetworkPolicy+AuthorizationPolicy\u53cc\u4fdd\u9669\uff09\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: payment-service-strict\nspec:\n  podSelector:\n    matchLabels:\n      app: payment-service\n  policyTypes: [Ingress, Egress]\n  ingress:\n  - from:\n    - podSelector:\n        matchLabels:\n          istio: ingressgateway\n---\napiVersion: security.istio.io/v1beta1\nkind: AuthorizationPolicy\nmetadata:\n  name: payment-service-mesh-only\nspec:\n  selector:\n    matchLabels:\n      app: payment-service\n  rules:\n  - from:\n    - source:\n        principals: [\"cluster.local/ns/istio-system/sa/istio-ingressgateway-service-account\"]\n</code></pre>"},{"location":"2025/11istio/#2_1","title":"2\u3001\u7acb\u4f53\u5316\u73b0\u573a\u4fdd\u7559\uff1a\u53d6\u8bc1\u94fe\u6784\u5efa","text":"<p>1. \u56db\u5c42\u9694\u79bb\u77e9\u9635</p> <p>\u9694\u79bb\u5c42\u7ea7 /  \u6280\u672f\u624b\u6bb5  /  \u53d6\u8bc1\u5f71\u54cd\u57df</p> <ul> <li> <p>\u670d\u52a1\u53d1\u73b0\u5c42 </p> <ul> <li>\u4fee\u6539Pod\u6807\u7b7e\u8131\u79bbService Selector</li> <li>\u4e1a\u52a1\u8bf7\u6c42\u5b8c\u5168\u9694\u79bb</li> </ul> </li> <li> <p>\u7f51\u7edc\u5c42</p> <ul> <li>NetworkPolicy\u9650\u5236\u51fa\u5165\u7ad9\u6d41\u91cf</li> <li>\u9632\u6b62\u5916\u90e8\u5e72\u6270\u4e0e\u6570\u636e\u6c61\u67d3</li> </ul> </li> <li> <p>\u8d44\u6e90\u5c42 </p> <ul> <li>\u6dfb\u52a0 <code>cluster-autoscaler.kubernetes.io/safe-to-evict=\"false\"</code> \u6ce8\u89e3</li> <li>\u9632\u6b62K8s\u81ea\u52a8\u9a71\u9010</li> </ul> </li> <li> <p>\u8fd0\u884c\u65f6\u5c42 </p> <ul> <li>\u901a\u8fc7iptables\u89c4\u5219\u9650\u5236\u5bb9\u5668\u5185\u8fdb\u7a0b\u901a\u4fe1</li> <li>\u7cbe\u7ec6\u5316\u63a7\u5236\u8fdb\u7a0b\u884c\u4e3a</li> </ul> </li> </ul> <pre><code># \u5bb9\u5668\u7ea7\u7f51\u7edc\u9694\u79bb\uff08\u57fa\u4e8ensenter\uff09\n\nkubectl exec payment-service-v2-xxxxx -c istio-proxy -- nsenter -t 1 -n iptables -A OUTPUT -p tcp --dport 3306 -j DROP\n</code></pre>"},{"location":"2025/11istio/#2_2","title":"2. \u5168\u91cf\u6570\u636e\u6355\u83b7\u77e9\u9635","text":"<p>2.1 \u57fa\u7840\u8bbe\u65bd\u5c42</p> <pre><code># \u6293\u53d6\u5bb9\u5668\u542f\u52a8\u53c2\u6570\uff08\u5206\u6790\u8d44\u6e90\u9650\u5236\uff09\nkubectl get pod payment-service-v2-xxxxx -o jsonpath='{.spec.containers[*].resources}' | jq\n\n# \u91c7\u96c6\u5185\u6838\u65e5\u5fd7\uff08\u5b9a\u4f4dOOM\u7b49\u5e95\u5c42\u95ee\u9898\uff09\nkubectl exec payment-service-v2-xxxxx -- dmesg --time-format iso &gt; dmesg.log\n</code></pre> <p>2.2 \u670d\u52a1\u7f51\u683c\u5c42</p> <pre><code># \u5bfc\u51faEnvoy\u5168\u91cf\u914d\u7f6e\uff08\u542b\u52a8\u6001\u66f4\u65b0\u5386\u53f2\uff09\nistioctl proxy-config all payment-service-v2-xxxxx --file envoy_config\n\n# \u5f55\u5236\u6545\u969c\u65f6\u95f4\u7a97\u7684\u8bbf\u95ee\u65e5\u5fd7\uff08JSON\u683c\u5f0f\uff09\nkubectl exec payment-service-v2-xxxxx -c istio-proxy -- curl -X POST http://localhost:15000/logging?level=trace\nkubectl logs payment-service-v2-xxxxx -c istio-proxy --since=10m &gt; envoy_access.log\n</code></pre> <p>2.3 \u5e94\u7528\u8fd0\u884c\u65f6\u5c42</p> <pre><code># Java\u5e94\u7528\u8fde\u7eed\u7ebf\u7a0b\u5feb\u7167\uff08\u95f4\u96945\u79d2\uff09\nfor i in {0..5}; do\n  kubectl exec payment-service-v2-xxxxx -- pgrep -f payment-service | xargs -I {} jstack {} &gt; jstack_$i.log\n  sleep 5\ndone\n\n\n# \u5185\u5b58\u6cc4\u6f0f\u8ffd\u8e2a\uff08\u7ed3\u5408jemalloc\uff09\nkubectl exec payment-service-v2-xxxxx -- env MALLOC_CONF=prof:true,lg_prof_interval:30 java -jar app.jar\nkubectl cp payment-service-v2-xxxxx:/tmp/heap.hprof .\n</code></pre>"},{"location":"2025/11istio/#3_2","title":"3. \u65f6\u7a7a\u5173\u8054\u5206\u6790","text":"<pre><code># \u65f6\u95f4\u8f74\u5bf9\u9f50\u5de5\u5177\uff08\u793a\u4f8b\uff09\nimport pandas as pd\n\nlogs = pd.read_csv('envoy_access.log', parse_dates=['timestamp'])\nmetrics = pd.read_csv('prometheus_metrics.csv', parse_dates=['timestamp'])\njoined = pd.merge_asof(logs, metrics, on='timestamp', tolerance=pd.Timedelta('1s'))\njoined[joined['status_code'] == 500].plot(x='timestamp', y=['cpu_usage', 'active_connections'])\n</code></pre>"},{"location":"2025/12python/","title":"12 Python Interview - Full","text":""},{"location":"2025/12python/#1-python","title":"1 python\u57fa\u7840\u547d\u4ee4","text":""},{"location":"2025/12python/#print","title":"\u6253\u5370\u8f93\u51fa\uff1a<code>print()</code>","text":"<pre><code># \u8f93\u51fa\u7b80\u5355\u7684\u6b22\u8fce\u4fe1\u606f\nprint(\"\u6b22\u8fce\u6765\u5230Python\u7f16\u7a0b\u4e16\u754c\uff01\")\n</code></pre> <p>\u8f93\u51fa\u53d8\u91cf\u503c\uff1a</p> <pre><code>name = \"Alice\"\n# \u8f93\u51fa\u53d8\u91cf\u7684\u503c\uff0c\u4f7f\u7528\u9017\u53f7\u5206\u9694\u4e0d\u540c\u7684\u53c2\u6570\nprint(\"\u4f60\u597d,\", name)\n</code></pre> <p>\u4f7f\u7528f-string\u683c\u5f0f\u5316\u8f93\u51fa\uff1a</p> <pre><code>age = 25\n# \u4f7f\u7528f-string\u5d4c\u5165\u53d8\u91cf\u5230\u5b57\u7b26\u4e32\u4e2d\nprint(f\"\u6211\u4eca\u5e74{age}\u5c81\u4e86\u3002\")\n</code></pre> <p>\u8f93\u51fa\u591a\u4e2a\u53d8\u91cf\uff0c\u7528\u7a7a\u683c\u5206\u9694\uff1a</p> <pre><code>first_name = \"\u5f20\"\nlast_name = \"\u4e09\"\n# \u8f93\u51fa\u591a\u4e2a\u53d8\u91cf\uff0c\u81ea\u52a8\u4ee5\u7a7a\u683c\u5206\u9694\nprint(first_name, last_name)\n</code></pre> <p>\u63a7\u5236\u8f93\u51fa\u4e0d\u6362\u884c\uff1a</p> <pre><code># \u4f7f\u7528end\u53c2\u6570\u63a7\u5236\u8f93\u51fa\u540e\u4e0d\u6362\u884c\uff0c\u9ed8\u8ba4\u662f\u6362\u884c\u7b26'\\n'\nprint(\"\u8fd9\u662f\u7b2c\u4e00\u884c\", end=\" \")\nprint(\"\u8fd9\u662f\u5728\u540c\u4e00\u884c\u7ee7\u7eed\u8f93\u51fa\u7684\u5185\u5bb9\")\n</code></pre>"},{"location":"2025/12python/#_1","title":"\u53d8\u91cf\u5b9a\u4e49\u4e0e\u8d4b\u503c","text":"<p>\u5b9a\u4e49\u5e76\u8d4b\u503c\u4e00\u4e2a\u6574\u6570\u53d8\u91cf\uff1a</p> <pre><code># \u5b9a\u4e49\u4e00\u4e2a\u6574\u6570\u7c7b\u578b\u7684\u53d8\u91cf\nmy_age = 28\nprint(my_age)  # \u8f93\u51fa\u53d8\u91cf\u7684\u503c\n</code></pre>"},{"location":"2025/12python/#2-python","title":"2 \u5982\u4f55\u5728Python\u4e2d\u4f7f\u7528\u9ad8\u7ea7\u6570\u636e\u7ed3\u6784\uff1f","text":""},{"location":"2025/12python/#1-collections","title":"1. collections \u6a21\u5757","text":"<p>collections \u6a21\u5757\u63d0\u4f9b\u4e86\u4e00\u4e9b\u4e13\u95e8\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6bd4\u5982\uff1a</p> <p>Counter: \u7528\u4e8e\u8ba1\u6570\u53ef\u54c8\u5e0c\u5bf9\u8c61\u3002</p> <pre><code>from collections import Counter\nli = [\"Dog\", \"Cat\", \"Mouse\", 42, \"Dog\", 42, \"Cat\", \"Dog\"]\na = Counter(li)\nprint(a)  # \u8f93\u51fa: Counter({'Dog': 3, 42: 2, 'Cat': 2, 'Mouse': 1})\n</code></pre> <p>defaultdict: \u7c7b\u4f3c\u4e8e\u666e\u901a\u7684\u5b57\u5178\uff0c\u4f46\u5728\u8bbf\u95ee\u4e0d\u5b58\u5728\u7684\u952e\u65f6\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u9ed8\u8ba4\u503c\u3002</p> <pre><code>from collections import defaultdict\ns = [('yellow', 1), ('blue', 2), ('yellow', 3), ('blue', 4), ('red', 1)]\n\nfor k, v in s:\n    d[k].append(v)\n\nprint(d)  # \u8f93\u51fa: defaultdict(, {'yellow': [1, 3], 'blue': [2, 4], 'red': [1]})\n</code></pre> <p>deque: \u53cc\u7aef\u961f\u5217\uff0c\u652f\u6301\u4ece\u4e24\u7aef\u5feb\u901f\u6dfb\u52a0\u6216\u79fb\u9664\u5143\u7d20\u3002</p> <pre><code>from collections import deque\nd = deque(\"ghi\")\nd.append('j')\nd.appendleft('f')\nprint(d)  # \u8f93\u51fa: deque(['f', 'g', 'h', 'i', 'j'])\n</code></pre>"},{"location":"2025/12python/#2-heapq","title":"2. heapq \u6a21\u5757","text":"<p>heapq \u63d0\u4f9b\u4e86\u5806\u961f\u5217\u7b97\u6cd5\u7684\u5b9e\u73b0\uff0c\u4e5f\u79f0\u4e3a\u4f18\u5148\u961f\u5217\u7b97\u6cd5\u3002</p> <p>\u6700\u5c0f\u5806\uff1a\u6bcf\u4e2a\u7236\u8282\u70b9\u7684\u503c\u90fd\u5c0f\u4e8e\u6216\u7b49\u4e8e\u5176\u5b50\u8282\u70b9\u7684\u503c\u3002</p> <pre><code>import heapq\nheap = []\nheapq.heappush(heap, (5, 'write code'))\nheapq.heappush(heap, (7, 'release product'))\nheapq.heappush(heap, (1, 'write spec'))\nprint(heapq.heappop(heap))  # \u8f93\u51fa: (1, 'write spec')\n</code></pre>"},{"location":"2025/12python/#3-bisect","title":"3. bisect \u6a21\u5757","text":"<p>bisect \u63d0\u4f9b\u4e86\u5bf9\u5df2\u6392\u5e8f\u5217\u8868\u7684\u652f\u6301\uff0c\u5141\u8bb8\u4f60\u8fdb\u884c\u4e8c\u5206\u67e5\u627e\u548c\u63d2\u5165\u64cd\u4f5c\u3002</p> <p>\u4e8c\u5206\u67e5\u627e\uff1a</p> <pre><code>import bisect\nsorted_list = [1, 2, 4, 5]\nposition = bisect.bisect(sorted_list, 3)\nprint(position)  # \u8f93\u51fa: 2\n</code></pre>"},{"location":"2025/12python/#4-array","title":"4. array \u6a21\u5757","text":"<p>array \u63d0\u4f9b\u4e86\u4e00\u79cd\u6570\u7ec4\u7c7b\u578b\uff0c\u5b83\u6bd4\u5217\u8868\u66f4\u52a0\u7d27\u51d1\uff0c\u4f46\u662f\u53ea\u80fd\u5b58\u50a8\u76f8\u540c\u7c7b\u578b\u7684\u6570\u503c\u3002</p> <p>\u521b\u5efa\u6570\u7ec4\uff1a</p> <pre><code>import array\narr = array.array('i', [1, 2, 3, 4])\nprint(arr)  # \u8f93\u51fa: array('i', [1, 2, 3, 4])\n</code></pre>"},{"location":"2025/12python/#3-python-30","title":"3 python 30\u4e2a\u51fd\u6570\u7684\u9ad8\u7ea7\u7528\u6cd5","text":""},{"location":"2025/12python/#1","title":"1 \u4f7f\u7528\u9ed8\u8ba4\u53c2\u6570\u503c","text":"<pre><code>def greet(name, message=\"\u4f60\u597d\"):\n    # \u6253\u5370\u95ee\u5019\u4fe1\u606f\uff0c\u9ed8\u8ba4\u6d88\u606f\u4e3a\u201c\u4f60\u597d\u201d\n    print(f\"{name}, {message}\")\ngreet(\"\u5f20\u4e09\")  # \u8f93\u51fa: \u5f20\u4e09, \u4f60\u597d\n</code></pre>"},{"location":"2025/12python/#2","title":"2 \u5173\u952e\u5b57\u53c2\u6570\u8c03\u7528\u51fd\u6570","text":"<pre><code>def describe_pet(animal_type, pet_name):\n    # \u63cf\u8ff0\u5ba0\u7269\u7684\u4fe1\u606f\n    print(f\"\\n\u6211\u6709\u4e00\u4e2a{animal_type}\u3002\")\n    print(f\"\u5b83\u7684\u540d\u5b57\u53eb{pet_name.title()}\u3002\")\ndescribe_pet(pet_name='\u54c8\u5947', animal_type='\u72d7')  # \u6307\u5b9a\u53c2\u6570\u540d\u4f20\u53c2\n</code></pre>"},{"location":"2025/12python/#3","title":"3 \u6536\u96c6\u4efb\u610f\u6570\u91cf\u7684\u4f4d\u7f6e\u53c2\u6570","text":"<pre><code>\u6536\u96c6\u4efb\u610f\u6570\u91cf\u7684\u4f4d\u7f6e\u53c2\u6570\n\ndef make_pizza(*toppings):\n    # \u6253\u5370\u6240\u70b9\u62ab\u8428\u7684\u6240\u6709\u914d\u6599\n    print(toppings)\nmake_pizza('pepperoni')\nmake_pizza('mushrooms', 'green peppers', 'extra cheese')\n</code></pre>"},{"location":"2025/12python/#4","title":"4 \u6536\u96c6\u5173\u952e\u5b57\u53c2\u6570","text":"<pre><code>def build_profile(first, last, **user_info):\n    # \u521b\u5efa\u4e00\u4e2a\u5b57\u5178\uff0c\u5305\u542b\u7528\u6237\u4fe1\u606f\n    profile = {'first_name': first, 'last_name': last}\n    profile.update(user_info)\n    return profile\nprint(build_profile('albert', 'einstein', location='princeton', field='physics'))\n</code></pre>"},{"location":"2025/12python/#5-lambda","title":"5 lambda \u8868\u8fbe\u5f0f","text":"<pre><code>add = lambda x, y: x + y  # \u5b9a\u4e49\u4e00\u4e2a\u7b80\u5355\u7684lambda\u51fd\u6570\u7528\u4e8e\u52a0\u6cd5\nprint(add(5, 3))  # \u8f93\u51fa\uff1a8\n</code></pre>"},{"location":"2025/12python/#6","title":"6 \u51fd\u6570\u4f5c\u4e3a\u53e6\u4e00\u4e2a\u51fd\u6570\u7684\u53c2\u6570","text":"<pre><code>\n\u51fd\u6570\u4f5c\u4e3a\u53e6\u4e00\u4e2a\u51fd\u6570\u7684\u53c2\u6570\n\ndef operation(x, y, func):\n    # \u8c03\u7528\u4f20\u9012\u8fdb\u6765\u7684\u51fd\u6570\n    return func(x, y)\nprint(operation(10, 5, lambda a, b: a - b))  # \u8f93\u51fa\uff1a5\n</code></pre>"},{"location":"2025/12python/#7","title":"7 \u4f7f\u7528\u88c5\u9970\u5668","text":"<pre><code>def decorator_function(original_function):\n    # \u5b9a\u4e49\u4e00\u4e2a\u7b80\u5355\u7684\u88c5\u9970\u5668\uff0c\u6dfb\u52a0\u989d\u5916\u529f\u80fd\n    def wrapper_function():\n        print('\u5728\u8c03\u7528\u4e4b\u524d\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c')\n        return original_function()\n    return wrapper_function\n@decorator_function\ndef display():\n    print('display function ran')\ndisplay()  # \u9996\u5148\u8f93\u51fa\u88c5\u9970\u5668\u5185\u7684\u6253\u5370\uff0c\u7136\u540e\u662fdisplay\u51fd\u6570\u7684\u5185\u5bb9\n\n# \u5728\u8c03\u7528\u4e4b\u524d\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\n# display function ran\n</code></pre>"},{"location":"2025/12python/#8","title":"8 \u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668","text":"<pre><code>def prefix_decorator(prefix):\n    def decorator(original_function):\n        def new_function():\n            print(f\"{prefix} \u5728\u539f\u59cb\u51fd\u6570\u524d\u6267\u884c\")\n            return original_function()\n        return new_function\n    return decorator\n@prefix_decorator(\"LOG:\")\ndef say_hello():\n    print(\"Hello!\")\nsay_hello()\n\n# LOG: \u5728\u539f\u59cb\u51fd\u6570\u524d\u6267\u884c\n# Hello!\n</code></pre>"},{"location":"2025/12python/#9","title":"9 \u95ed\u5305","text":"<pre><code>def outer_function(msg):\n    def inner_function():\n        print(msg)  # \u5185\u90e8\u51fd\u6570\u8bbf\u95ee\u5916\u90e8\u51fd\u6570\u7684\u53d8\u91cf\n    return inner_function\nhi_func = outer_function('Hi!')\nbye_func = outer_function('Bye!')\nhi_func()\nbye_func()\n</code></pre> <pre><code>Hi!\nBye!\n</code></pre>"},{"location":"2025/12python/#10-global","title":"10 \u4f7f\u7528 global \u5173\u952e\u5b57","text":"<pre><code>global_var = 0\ndef update_global():\n    global global_var  # \u58f0\u660e\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\n    global_var += 1\nupdate_global()\nprint(global_var)  # \u8f93\u51fa\uff1a1\n</code></pre>"},{"location":"2025/12python/#11-nonlocal","title":"11 \u4f7f\u7528 nonlocal \u5173\u952e\u5b57","text":"<pre><code>def outer():\n    x = \"local\"\n    def inner():\n        nonlocal x  # \u58f0\u660e\u4f7f\u7528\u5916\u90e8\u51fd\u6570\u53d8\u91cf\n        x = 'nonlocal'\n        print(\"inner:\", x)\n    inner()\n    print(\"outer:\", x)\nouter()  # \u8f93\u51fa: inner: nonlocal \\n outer: nonlocal\n</code></pre> <pre><code>inner: nonlocal\nouter: nonlocal\n</code></pre>"},{"location":"2025/12python/#12","title":"12 \u51fd\u6570\u8fd4\u56de\u503c\u4e3a\u53e6\u4e00\u4e2a\u51fd\u6570","text":"<pre><code>def make_multiplier_of(n):\n    # \u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u5c06\u4f20\u5165\u7684\u53c2\u6570\u4e58\u4ee5 n\n    def multiplier(x):\n        return x * n\n    return multiplier\ntimes3 = make_multiplier_of(3)\nprint(times3(9))  # \u8f93\u51fa\uff1a27\n</code></pre>"},{"location":"2025/12python/#13-sorted","title":"13 \u533f\u540d\u51fd\u6570\u4e0e sorted \u7ed3\u5408\u4f7f\u7528","text":"<pre><code>pairs = [(1, 'one'), (2, 'two'), (3, 'three'), (4, 'four')]\nsorted_pairs = sorted(pairs, key=lambda pair: pair[1])  # \u6309\u7b2c\u4e8c\u4e2a\u5143\u7d20\u6392\u5e8f\nprint(sorted_pairs)  # \u8f93\u51fa\uff1a[(4, 'four'), (1, 'one'), (3, 'three'), (2, 'two')]\n</code></pre> <pre><code>[(4, 'four'), (1, 'one'), (3, 'three'), (2, 'two')]\n</code></pre>"},{"location":"2025/12python/#14-functoolspartial","title":"14 \u4f7f\u7528 <code>functools.partial</code> \u56fa\u5b9a\u51fd\u6570\u53c2\u6570","text":"<pre><code>from functools import partial\ndef multiply(a, b):\n    return a * b\ndouble = partial(multiply, 2)\nprint(double(5))  # \u8f93\u51fa\uff1a10\n</code></pre>"},{"location":"2025/12python/#15-inspect","title":"15 \u4f7f\u7528 inspect \u83b7\u53d6\u51fd\u6570\u7b7e\u540d","text":"<pre><code>import inspect\ndef foo(a, b=2, *args, **kwargs):\n    pass\nsig = inspect.signature(foo)\nprint(sig)  # \u8f93\u51fa\uff1a(a, b=2, *args, **kwargs)\n</code></pre>"},{"location":"2025/12python/#16-map","title":"16 \u4f7f\u7528 map \u5e94\u7528\u51fd\u6570\u5230\u5217\u8868","text":"<pre><code>numbers = [1, 2, 3, 4]\nsquared = list(map(lambda x: x**2, numbers))\nprint(squared)  # \u8f93\u51fa\uff1a[1, 4, 9, 16]\n</code></pre>"},{"location":"2025/12python/#17-filter","title":"17 \u4f7f\u7528 filter \u7b5b\u9009\u5217\u8868","text":"<pre><code>even_numbers = list(filter(lambda x: x % 2 == 0, range(10)))\nprint(even_numbers)  # \u8f93\u51fa\uff1a[0, 2, 4, 6, 8]\n</code></pre>"},{"location":"2025/12python/#18-reduce","title":"18 \u4f7f\u7528 reduce \u8fdb\u884c\u7d2f\u79ef\u64cd\u4f5c","text":"<pre><code>def show_locals():\n    x = 1\n    y = 2\n    print(locals())  # \u8f93\u51fa\uff1a{'x': 1, 'y': 2}\nshow_locals()\n</code></pre>"},{"location":"2025/12python/#19-exec","title":"19 \u4f7f\u7528 exec \u52a8\u6001\u6267\u884c\u4ee3\u7801","text":"<pre><code>code = \"a = 5\\nb=6\\nprint('a + b =', a + b)\"\nexec(code)  # \u8f93\u51fa\uff1aa + b = 11\n</code></pre>"},{"location":"2025/12python/#20","title":"20 \u4f7f\u7528\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\u7684\u9ad8\u9636\u51fd\u6570","text":"<pre><code>def apply_function(func, value):\n    # \u63a5\u53d7\u4e00\u4e2a\u51fd\u6570\u548c\u4e00\u4e2a\u503c\uff0c\u7136\u540e\u5e94\u7528\u8be5\u51fd\u6570\u5230\u8fd9\u4e2a\u503c\u4e0a\n    return func(value)\nprint(apply_function(lambda x: x**2, 4))  # \u8f93\u51fa\uff1a16\n</code></pre>"},{"location":"2025/12python/#21","title":"21  \u9012\u5f52\u51fd\u6570\u8ba1\u7b97\u9636\u4e58","text":"<pre><code>def factorial(n):\n    if n == 0:\n        return 1\n    else:\n        return n * factorial(n-1)\nprint(factorial(5))  # \u8f93\u51fa\uff1a120\n</code></pre>"},{"location":"2025/12python/#22","title":"22  \u4f7f\u7528\u5217\u8868\u63a8\u5bfc\u5f0f\u4e0e\u51fd\u6570\u7ed3\u5408","text":"<pre><code>def square(x):\n    return x*x\nnumbers = [1, 2, 3, 4]\nsquares = [square(num) for num in numbers]\nprint(squares)  # \u8f93\u51fa\uff1a[1, 4, 9, 16]\n</code></pre>"},{"location":"2025/12python/#23","title":"23 \u5e26\u6709\u6587\u6863\u5b57\u7b26\u4e32\u7684\u51fd\u6570","text":"<pre><code>def doc_example():\n    \"\"\"\n    \u8fd9\u662f\u4e00\u4e2a\u5e26\u6709\u6587\u6863\u5b57\u7b26\u4e32\u7684\u4f8b\u5b50\u3002\n    \u5b83\u63cf\u8ff0\u4e86\u51fd\u6570\u7684\u529f\u80fd\u3001\u53c2\u6570\u548c\u8fd4\u56de\u503c\u3002\n    \"\"\"\n    pass\nprint(doc_example.__doc__)  # \u8f93\u51fa\u51fd\u6570\u7684\u6587\u6863\u5b57\u7b26\u4e32\n</code></pre>"},{"location":"2025/12python/#24-args-kwargs","title":"24  \u4f7f\u7528<code>*args</code> \u548c <code>**kwargs</code> \u540c\u65f6\u4f20\u9012\u53c2\u6570","text":"<pre><code>def arg_kwarg_example(*args, **kwargs):\n    print(\"Args:\", args)\n    print(\"Kwargs:\", kwargs)\narg_kwarg_example(1, 2, a=3, b=4)\n# \u8f93\u51fa\uff1a\n# Args: (1, 2)\n# Kwargs: {'a': 3, 'b': 4}\n</code></pre>"},{"location":"2025/12python/#25-type-hints","title":"25  \u4f7f\u7528 type hints \u63d0\u4f9b\u7c7b\u578b\u63d0\u793a","text":"<p>\u4f7f\u7528 type hints \u63d0\u4f9b\u7c7b\u578b\u63d0\u793a</p> <pre><code>def greeting(name: str) -&gt; str:\n    return 'Hello, ' + name\nprint(greeting('world'))  # \u8f93\u51fa\uff1aHello, world\n</code></pre>"},{"location":"2025/12python/#26-wraps","title":"26 \u4f7f\u7528 wraps \u88c5\u9970\u5668\u590d\u5236\u539f\u59cb\u51fd\u6570\u5143\u6570\u636e","text":"<pre><code>from functools import wraps\ndef my_decorator(f):\n    @wraps(f)\n    def wrapper(*args, **kwargs):\n        print(\"Calling function.\")\n        return f(*args, **kwargs)\n    return wrapper\n@my_decorator\ndef example():\n    \"\"\"Docstring\"\"\"\n    print(\"Inside example function\")\nprint(example.__name__)  # \u8f93\u51fa\uff1aexample\nprint(example.__doc__)   # \u8f93\u51fa\uff1aDocstring\n</code></pre>"},{"location":"2025/12python/#27-contextlibcontextmanager","title":"27 \u4f7f\u7528 contextlib.contextmanager \u521b\u5efa\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668","text":"<pre><code>from functools import wraps\ndef my_decorator(f):\n    @wraps(f)\n    def wrapper(*args, **kwargs):\n        print(\"Calling function.\")\n        return f(*args, **kwargs)\n    return wrapper\n@my_decorator\ndef example():\n    \"\"\"Docstring\"\"\"\n    print(\"Inside example function\")\nprint(example.__name__)  # \u8f93\u51fa\uff1aexample\nprint(example.__doc__)   # \u8f93\u51fa\uff1aDocstring\n</code></pre>"},{"location":"2025/12python/#28-contextlibcontextmanager","title":"28 \u4f7f\u7528 contextlib.contextmanager \u521b\u5efa\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668","text":"<pre><code>from contextlib import contextmanager\n@contextmanager\ndef tag(name):\n    print(f\"&lt;{name}&gt;\")\n    yield\n    print(f\"\")\nwith tag(\"h1\"):\n    print(\"\u6807\u9898\u6587\u672c\")\n</code></pre>"},{"location":"2025/12python/#29","title":"29 \u52a8\u6001\u521b\u5efa\u51fd\u6570","text":"<p>\u52a8\u6001\u521b\u5efa\u51fd\u6570</p> <pre><code>def create_multiplier(n):\n    def multiplier(x):\n        return x * n\n    return multiplier\ndouble = create_multiplier(2)\ntriple = create_multiplier(3)\nprint(double(4), triple(4))  # \u8f93\u51fa\uff1a8 12\n</code></pre>"},{"location":"2025/12python/#30-operator-lambda","title":"30 \u4f7f\u7528 operator \u6a21\u5757\u4e2d\u7684\u51fd\u6570\u4ee3\u66ff lambda \u8868\u8fbe\u5f0f","text":"<pre><code>import operator\nnumbers = [1, 2, 3, 4]\nsum_result = reduce(operator.add, numbers)\nprint(sum_result)  # \u8f93\u51fa\uff1a10\n</code></pre>"},{"location":"2025/12python/#4-python-os-sys-path","title":"4 \u6df1\u5ea6\u89e3\u6790python os \u6a21\u5757\u3001sys \u6a21\u5757\u3001path \u6a21\u5757","text":""},{"location":"2025/12python/#1-os","title":"1 OS \u6a21\u5757","text":"<p>os\u6a21\u5757\u63d0\u4f9b\u4e86\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u4ea4\u4e92\u7684\u529f\u80fd\u3002\u53ef\u4ee5\u7528\u6765\u8bfb\u53d6\u6216\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3001\u7ba1\u7406\u6587\u4ef6\u76ee\u5f55\u7b49\u3002</p> <p>\u83b7\u53d6\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55</p> <pre><code>import os\n# \u83b7\u53d6\u5f53\u524d\u7684\u5de5\u4f5c\u76ee\u5f55\ncurrent_directory = os.getcwd()\nprint(\"\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55:\", current_directory)\n</code></pre> <pre><code>\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55: /Users/i515190/k8s_test/python/2025\n</code></pre> <p>\u521b\u5efa\u76ee\u5f55</p> <pre><code># \u521b\u5efa\u4e00\u4e2a\u65b0\u76ee\u5f55\nos.mkdir('\u65b0\u5efa\u6587\u4ef6\u5939')\nprint(\"\u5df2\u521b\u5efa\u76ee\u5f55\")\n</code></pre> <p>\u5217\u51fa\u76ee\u5f55\u5185\u5bb9</p> <pre><code># \u5217\u51fa\u6307\u5b9a\u76ee\u5f55\u7684\u5185\u5bb9\nfiles = os.listdir('.')\nprint(\"\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939:\", files)\n</code></pre> <pre><code>\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939: ['test.py']\n</code></pre> <p>\u5220\u9664\u7a7a\u76ee\u5f55</p> <pre><code># \u5220\u9664\u4e4b\u524d\u521b\u5efa\u7684\u76ee\u5f55\nos.rmdir('\u65b0\u5efa\u6587\u4ef6\u5939')\nprint(\"\u76ee\u5f55\u5df2\u5220\u9664\")\n</code></pre> <p>\u6267\u884c\u7cfb\u7edf\u547d\u4ee4</p> <pre><code># \u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5e76\u83b7\u53d6\u7ed3\u679c\nresult = os.system('echo Hello World')\nprint(\"\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u7684\u7ed3\u679c:\", result)\n</code></pre>"},{"location":"2025/12python/#2-sys","title":"2 sys \u6a21\u5757","text":"<p>sys\u6a21\u5757\u63d0\u4f9b\u4e86\u5bf9\u89e3\u91ca\u5668\u4f7f\u7528\u6216\u7ef4\u62a4\u7684\u4e00\u4e9b\u53d8\u91cf\u548c\u51fd\u6570\u7684\u8bbf\u95ee\u3002</p> <p>\u6253\u5370Python\u89e3\u91ca\u5668\u7248\u672c</p> <pre><code>import sys\n# \u6253\u5370Python\u89e3\u91ca\u5668\u7684\u7248\u672c\u4fe1\u606f\nprint(\"Python\u7248\u672c:\", sys.version)\n</code></pre> <pre><code>Python\u7248\u672c: 3.9.0 (default, Oct  5 2023, 20:12:44) \n[Clang 14.0.0 (clang-1400.0.29.202)]\n</code></pre> <p>\u9000\u51fa\u7a0b\u5e8f</p> <pre><code># \u9000\u51faPython\u7a0b\u5e8f\nsys.exit(\"\u7a0b\u5e8f\u6b63\u5e38\u9000\u51fa\")\n</code></pre> <p>\u83b7\u53d6\u547d\u4ee4\u884c\u53c2\u6570</p> <pre><code># \u6253\u5370\u4ece\u547d\u4ee4\u884c\u4f20\u9012\u7ed9\u811a\u672c\u7684\u53c2\u6570\nprint(\"\u547d\u4ee4\u884c\u53c2\u6570:\", sys.argv)\n</code></pre> <p>\u547d\u4ee4\u884c\u53c2\u6570: ['test.py']</p> <p>\u6807\u51c6\u8f93\u5165\u8f93\u51fa\u91cd\u5b9a\u5411</p> <pre><code># \u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\ntemp = sys.stdout\nsys.stdout = open('log.txt', 'w')\nprint(\"\u8fd9\u5c06\u88ab\u5199\u5165log.txt\")\nsys.stdout.close()\nsys.stdout = temp\nprint(\"\u6807\u51c6\u8f93\u51fa\u5df2\u6062\u590d\")\n</code></pre> <p>\u83b7\u53d6\u6700\u5927\u6574\u6570</p> <pre><code># Python\u4e2d\u53ef\u5904\u7406\u7684\u6700\u5927\u6574\u6570\u503c\nprint(\"Python\u652f\u6301\u7684\u6700\u5927\u6574\u6570:\", sys.maxsize)\n</code></pre>"},{"location":"2025/12python/#3-ospath","title":"3 os.path \u6a21\u5757","text":"<p>os.path\u5b50\u6a21\u5757\u63d0\u4f9b\u4e86\u7528\u4e8e\u64cd\u4f5c\u6587\u4ef6\u8def\u5f84\u7684\u5de5\u5177\u3002</p> <p>\u8fde\u63a5\u8def\u5f84</p> <pre><code># \u4f7f\u7528os.path.join()\u5b89\u5168\u5730\u7ec4\u5408\u8def\u5f84\npath = os.path.join('\u7528\u6237', '\u6587\u6863', '\u6587\u4ef6.txt')\nprint(\"\u7ec4\u5408\u540e\u7684\u8def\u5f84:\", path)\n</code></pre> <p>\u68c0\u67e5\u8def\u5f84\u662f\u5426\u5b58\u5728</p> <pre><code># \u68c0\u67e5\u67d0\u4e2a\u8def\u5f84\u662f\u5426\u5b58\u5728\nexists = os.path.exists('.')\nprint(\"\u8def\u5f84\u5b58\u5728\u5417:\", exists)\n</code></pre> <p>\u5224\u65ad\u662f\u5426\u4e3a\u6587\u4ef6</p> <pre><code># \u68c0\u67e5\u8def\u5f84\u662f\u5426\u6307\u5411\u4e00\u4e2a\u6587\u4ef6\nis_file = os.path.isfile('test.py')  # \u5047\u8bbe'test.py'\u662f\u5b58\u5728\u7684\nprint(\"\u8fd9\u662f\u4e00\u4e2a\u6587\u4ef6\u5417:\", is_file)\n</code></pre> <pre><code>\u8fd9\u662f\u4e00\u4e2a\u6587\u4ef6\u5417: True\n</code></pre> <p>\u83b7\u53d6\u6587\u4ef6\u5927\u5c0f</p> <pre><code># \u83b7\u53d6\u6587\u4ef6\u7684\u5927\u5c0f\uff08\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\uff09\nsize = os.path.getsize('test.py')  # \u5047\u8bbe'test.py'\u662f\u5b58\u5728\u7684\nprint(\"\u6587\u4ef6\u5927\u5c0f:\", size, \"\u5b57\u8282\")\n</code></pre> <pre><code>\u6587\u4ef6\u5927\u5c0f: 2816 \u5b57\u8282\n</code></pre> <p>\u83b7\u53d6\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84</p> <pre><code># \u83b7\u53d6\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\nabs_path = os.path.abspath('test.py')  # \u5047\u8bbe'test.py'\u662f\u5b58\u5728\u7684\nprint(\"\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84:\", abs_path)\n</code></pre> <pre><code>\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84: /Users/i515190/k8s_test/python/2025/test.py\n</code></pre>"},{"location":"2025/13tiktok/","title":"2025 \u6700\u65b0\u5b57\u8282\u8df3\u52a8\u8fd0\u7ef4\u4e91\u539f\u751f\u9762\u7ecf\u5206\u4eab","text":""},{"location":"2025/13tiktok/#1-prometheus","title":"1 Prometheus \u9762\u7ecf\u8be6\u89e3","text":""},{"location":"2025/13tiktok/#1-1-prometheus","title":"1-1 Prometheus \u7684\u4fe1\u606f\u91c7\u96c6\u539f\u7406\uff1f","text":"<p>\u56de\u7b54\u601d\u8def\uff1a</p> <p>\u6570\u636e\u6a21\u578b\uff1aPrometheus \u91c7\u7528\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u6a21\u578b\uff0c\u6bcf\u4e2a\u6570\u636e\u70b9\u7531\u4ee5\u4e0b\u90e8\u5206\u7ec4\u6210\uff1a</p> <ul> <li>\u5ea6\u91cf\u540d\u79f0\uff08Metric Name\uff09\uff1a\u6807\u8bc6\u6570\u636e\u7684\u7c7b\u578b\uff08\u5982 <code>http_requests_total</code>\uff09\u3002</li> <li>\u6807\u7b7e\uff08Labels\uff09\uff1a\u952e\u503c\u5bf9\u5f62\u5f0f\u7684\u5143\u6570\u636e\uff0c\u7528\u4e8e\u552f\u4e00\u6807\u8bc6\u6570\u636e\u7684\u6765\u6e90\u548c\u7ef4\u5ea6\uff08\u5982 <code>job=\"api-server\", instance=\"192.168.1.100:9090\"</code>\uff09</li> <li>\u65f6\u95f4\u6233\uff08Timestamp\uff09\uff1a\u8bb0\u5f55\u6570\u636e\u91c7\u96c6\u7684\u65f6\u95f4\u3002</li> <li>\u6570\u503c\uff08Value\uff09\uff1a\u5177\u4f53\u6307\u6807\u503c\uff08\u5982 CPU \u4f7f\u7528\u7387 75%\uff09\u3002</li> </ul> <p>\u6570\u636e\u91c7\u96c6\uff1a</p> <ul> <li>\u62c9\u53d6\u6a21\u5f0f\uff08Pull Model\uff09\uff1aPrometheus \u5b9a\u671f\u4e3b\u52a8\u4ece\u76ee\u6807\uff08Targets\uff09\u62c9\u53d6\u6307\u6807\u6570\u636e\uff0c\u9ed8\u8ba4\u5468\u671f\u4e3a 1 \u5206\u949f\u3002</li> <li>\u63a8\u9001\u6a21\u5f0f\uff08Push Model\uff09\uff1a\u901a\u8fc7\u4e2d\u95f4\u4ef6\uff08\u5982 Pushgateway\uff09\u5c06\u6570\u636e\u63a8\u9001\u5230 Prometheus\uff0c\u9002\u7528\u4e8e\u77ed\u751f\u547d\u5468\u671f\u4efb\u52a1\uff08\u5982\u6279\u5904\u7406\u4f5c\u4e1a\uff09\u3002</li> <li>Service Discovery\uff1a\u652f\u6301\u81ea\u52a8\u53d1\u73b0\u76ee\u6807\u8282\u70b9\uff08\u5982 Kubernetes \u670d\u52a1\u3001Consul \u6ce8\u518c\u4e2d\u5fc3\uff09\uff0c\u51cf\u5c11\u624b\u52a8\u914d\u7f6e\u3002</li> </ul> <p>\u5b58\u50a8\u4e0e\u67e5\u8be2\uff1a</p> <ul> <li>\u6570\u636e\u5b58\u50a8\u4e3a\u65f6\u95f4\u5e8f\u5217\uff0c\u6309\u5ea6\u91cf\u540d\u79f0\u548c\u6807\u7b7e\u5206\u7ec4\uff0c\u652f\u6301\u9ad8\u6548\u67e5\u8be2\u3002</li> <li>PromQL\uff1a\u63d0\u4f9b\u4e30\u5bcc\u7684\u67e5\u8be2\u8bed\u8a00\uff0c\u652f\u6301\u805a\u5408\u8fd0\u7b97\uff08\u5982 avg(), sum()\uff09\u3001\u8303\u56f4\u67e5\u8be2\uff08[5m]\uff09\u3001\u6761\u4ef6\u5224\u65ad\uff08\u5982 &gt; 90\uff09\u7b49</li> </ul> <p>\u4f18\u52bf\u4e0e\u5c40\u9650\u6027\uff1a</p> <ul> <li>\u4f18\u52bf\uff1a\u9ad8\u53ef\u7528\u3001\u5206\u5e03\u5f0f\u3001\u7075\u6d3b\u7684\u6807\u7b7e\u7cfb\u7edf\u3002</li> <li>\u5c40\u9650\u6027\uff1a\u62c9\u53d6\u6a21\u5f0f\u53ef\u80fd\u56e0\u7f51\u7edc\u95ee\u9898\u6f0f\u6570\u636e\uff0c\u5b58\u50a8\u6210\u672c\u8f83\u9ad8</li> </ul>"},{"location":"2025/13tiktok/#1-3-prometheus-k8s","title":"1-3 Prometheus \u91c7\u96c6K8S\u662f\u54ea\u4e2a\u63a5\u53e3\uff1f","text":"<p>Prometheus \u901a\u8fc7 Kubernetes API \u76d1\u63a7\u96c6\u7fa4\u8d44\u6e90\u72b6\u6001\uff08\u5982 Pod\u3001Deployment\u3001Node \u7b49\uff09\uff0c\u9700\u914d\u7f6e <code>kubernetes_sd_config</code> \u8fdb\u884c\u670d\u52a1\u53d1\u73b0\u3002</p> <pre><code>scrape_configs:  \n-job_name:'kubernetes-apiservers'\n    kubernetes_sd_configs:\n      -role:endpoints\n    relabel_configs:\n      -action:keep\n        regex:default\n        source_labels:[__meta_kubernetes_namespace]\n</code></pre> <p>Metrics Server\uff1a</p> <p>\u63d0\u4f9b Pod\u3001Node \u7684\u8d44\u6e90\u4f7f\u7528\u6307\u6807\uff08\u5982 CPU/\u5185\u5b58\u4f7f\u7528\u7387\uff09\uff0c\u9700\u901a\u8fc7 <code>kube-state-metrics</code> \u6216 <code>cAdvisor</code> \u91c7\u96c6\u3002</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>curl http://localhost:8080/api/v1/nodes/{node-name}/metrics  \n</code></pre> <p>\u81ea\u5b9a\u4e49\u63a5\u53e3\uff1a</p> <p>\u5e94\u7528\u9700\u66b4\u9732 <code>/metrics</code> \u7aef\u70b9\uff0c\u683c\u5f0f\u7b26\u5408 Prometheus \u6587\u672c\u683c\u5f0f\uff08\u5982\u901a\u8fc7 <code>prometheus-client-go</code> \u5e93\u5b9e\u73b0\uff09\u3002</p> <p>\u6ce8\u610f\u4e8b\u9879\uff1a</p> <ul> <li>\u9700\u914d\u7f6e RBAC \u6743\u9650\uff0c\u786e\u4fdd Prometheus \u6709\u6743\u9650\u8bbf\u95ee K8S API\u3002</li> <li>\u4f7f\u7528 kube-prometheus-stack Helm Chart \u53ef\u4e00\u952e\u90e8\u7f72\u5b8c\u6574\u76d1\u63a7\u94fe\u3002</li> </ul>"},{"location":"2025/13tiktok/#1-3-prometheus","title":"1-3 Prometheus \u7684\u544a\u8b66\u662f\u600e\u4e48\u914d\u7f6e\u7684\uff1f","text":"<p>\u544a\u8b66\u89c4\u5219\uff08Alert Rules\uff09\uff1a</p> <p>\u5728 <code>prometheus.yml</code>  \u6216\u72ec\u7acb\u7684 <code>.rules</code> \u6587\u4ef6\u4e2d\u5b9a\u4e49\u89c4\u5219\uff0c\u4f8b\u5982\uff1a</p> <pre><code>groups:  \n-name:example\nrules:\n-alert:HighCPUUsage\n    expr:instance:node_cpu_usage:rate1m&gt;0.8\n    for:5m\n    labels:\n      severity:warning\n    annotations:\n      summary:\"Instance {{ $labels.instance }} CPU usage is high\"\n</code></pre> <ul> <li>expr\uff1aPromQL \u8868\u8fbe\u5f0f\uff0c\u5b9a\u4e49\u89e6\u53d1\u6761\u4ef6\u3002</li> <li>for\uff1a\u544a\u8b66\u6301\u7eed\u65f6\u95f4\uff08\u907f\u514d\u77ed\u6682\u6ce2\u52a8\u89e6\u53d1\uff09\u3002</li> <li>labels \u548c annotations\uff1a\u8865\u5145\u544a\u8b66\u5143\u6570\u636e\u548c\u63cf\u8ff0\u3002</li> </ul>"},{"location":"2025/13tiktok/#1-4-alertmanager","title":"1-4 Alertmanager \u914d\u7f6e\uff1a","text":"<p>\u8def\u7531\uff08Routes\uff09\uff1a\u6839\u636e\u6807\u7b7e\uff08\u5982 severity\uff09\u5c06\u544a\u8b66\u5206\u53d1\u5230\u4e0d\u540c\u63a5\u6536\u8005\u3002</p> <pre><code>route:  \ngroup_by:['alertname']\ngroup_wait:30s\ngroup_interval:5m\nreceiver:'team-alerts'\nroutes:\n-match_re:\n      severity:critical\n    receiver:'oncall-team' \n</code></pre> <ul> <li>\u6291\u5236\uff08Inhibit\uff09\uff1a\u9ad8\u4f18\u5148\u7ea7\u544a\u8b66\uff08\u5982 InstanceDown\uff09\u53ef\u6291\u5236\u4f4e\u4f18\u5148\u7ea7\u544a\u8b66\uff08\u5982 HighCPUUsage\uff09\u3002</li> <li>\u63a5\u6536\u5668\uff08Receivers\uff09\uff1a\u652f\u6301\u591a\u79cd\u901a\u77e5\u65b9\u5f0f\uff08\u5982 Slack\u3001PagerDuty\u3001Email\uff09</li> </ul> <p>\u5b9e\u8df5\u5efa\u8bae\uff1a</p> <ul> <li>\u907f\u514d\u201c\u544a\u8b66\u75b2\u52b3\u201d\uff1a\u5408\u7406\u8bbe\u7f6e\u9608\u503c\u548c for \u53c2\u6570\u3002</li> <li>\u9a8c\u8bc1\u544a\u8b66\uff1a\u901a\u8fc7 fire-and-forget \u6a21\u5f0f\u6d4b\u8bd5\u914d\u7f6e</li> </ul>"},{"location":"2025/13tiktok/#1-5-prometheus","title":"1-5 Prometheus \u7684\u544a\u8b66\u662f\u57fa\u4e8e\u54ea\u4e2a\u7ec4\u4ef6\u914d\u7f6e\u7684\uff1f","text":"<p>\u6838\u5fc3\u7ec4\u4ef6\uff1aAlertmanager</p> <ul> <li>\u529f\u80fd\uff1a</li> <li>\u914d\u7f6e\u6587\u4ef6\u793a\u4f8b\uff1a</li> </ul> <pre><code>global:  \nresolve_timeout:5m\nroute:\nreceiver:'team-email'\ngroup_wait:30s\nreceivers:\n-name:'team-email'\nemail_configs:\n-to:'team@example.com'\n</code></pre> <ul> <li>\u63a5\u6536 Prometheus \u53d1\u9001\u7684\u544a\u8b66\u4e8b\u4ef6\u3002</li> <li>\u6839\u636e\u914d\u7f6e\u8def\u7531\u89c4\u5219\u5c06\u544a\u8b66\u5206\u53d1\u7ed9\u63a5\u6536\u8005\uff08\u5982\u56e2\u961f Slack \u9891\u9053\uff09\u3002</li> <li>\u805a\u5408\u76f8\u4f3c\u544a\u8b66\uff0c\u51cf\u5c11\u91cd\u590d\u901a\u77e5\uff08\u5982 <code>group_by</code>\uff09\u3002</li> <li>\u6291\u5236\u5197\u4f59\u544a\u8b66\uff08\u5982\u4e3b\u8282\u70b9\u5b95\u673a\u65f6\u6291\u5236\u5176\u4e0b\u6240\u6709\u670d\u52a1\u7684\u544a\u8b66\uff09\u3002</li> </ul> <p>Prometheus \u96c6\u6210\uff1a</p> <p>\u5728 <code>prometheus.yml</code> \u4e2d\u6307\u5b9a Alertmanager \u5730\u5740\uff1a</p> <pre><code>alerting:  \n  alertmanagers:  \n  - static_configs:  \n    - targets: ['alertmanager:9093']  \n</code></pre> <p>\u6269\u5c55\u80fd\u529b\uff1a</p> <p>\u652f\u6301\u4e0e Grafana\u3001PagerDuty \u7b49\u5de5\u5177\u96c6\u6210\uff0c\u5b9e\u73b0\u66f4\u590d\u6742\u7684\u544a\u8b66\u7ba1\u7406\u3002</p>"},{"location":"2025/13tiktok/#2-cicd","title":"2 CICD \u6d41\u6c34\u7ebf","text":""},{"location":"2025/13tiktok/#2-1-ci","title":"2-1 CI \u6d41\u6c34\u7ebf\u53d1\u73b0\u95ee\u9898\u662f\u600e\u4e48\u6392\u67e5\u89e3\u51b3\u7684\uff1f","text":"<ul> <li>\u68c0\u67e5\u6d41\u6c34\u7ebf YAML \u6587\u4ef6\u4e2d\u7684\u53c2\u6570\u3001\u8def\u5f84\u3001\u5de5\u5177\u7248\u672c\u3002</li> <li>\u786e\u8ba4\u654f\u611f\u4fe1\u606f\uff08\u5982 API \u5bc6\u94a5\uff09\u662f\u5426\u6b63\u786e\u6ce8\u5165\u3002</li> <li>\u590d\u73b0\u95ee\u9898\uff1a\u672c\u5730\u590d\u73b0\u6d41\u6c34\u7ebf\u73af\u5883\uff0c\u9010\u6b65\u8c03\u8bd5\u4ee3\u7801\u3002</li> <li>\u5355\u5143\u6d4b\u8bd5\uff1a\u9488\u5bf9\u53ef\u7591\u4ee3\u7801\u6dfb\u52a0\u6d4b\u8bd5\u7528\u4f8b\u3002</li> <li>\u5b9a\u4f4d\u5230\u5931\u8d25\u6b65\u9aa4\u7684\u65e5\u5fd7\uff0c\u5173\u6ce8\u9519\u8bef\u4ee3\u7801\u3001\u5806\u6808\u4fe1\u606f\u3002</li> <li>\u4f7f\u7528\u65e5\u5fd7\u805a\u5408\u5de5\u5177\uff08\u5982 ELK\u3001Splunk\uff09\u5feb\u901f\u7b5b\u9009\u5173\u952e\u4fe1\u606f\u3002</li> <li>\u68c0\u67e5\u6d41\u6c34\u7ebf\u8fd0\u884c\u7684\u73af\u5883\uff08\u5982 Docker \u955c\u50cf\u3001\u4f9d\u8d56\u7248\u672c\u3001\u7f51\u7edc\u914d\u7f6e\uff09\u3002</li> <li> <p>\u4f7f\u7528 docker inspect \u6216 kubectl describe pod \u67e5\u770b\u5bb9\u5668\u72b6\u6001</p> </li> <li> <p>\u73af\u5883\u5c42\uff1a</p> </li> <li>\u65e5\u5fd7\u5c42\uff1a</li> <li>\u4ee3\u7801\u5c42\uff1a</li> <li> <p>\u914d\u7f6e\u5c42\uff1a</p> </li> <li> <p>GitLab CI/CD\uff1a\u901a\u8fc7 echo \u547d\u4ee4\u8f93\u51fa\u4e2d\u95f4\u53d8\u91cf\uff0c\u6216\u4f7f\u7528 debug \u6a21\u5f0f\u3002</p> </li> <li>Jenkins\uff1a\u4f7f\u7528 Blue Ocean \u63d2\u4ef6\u53ef\u89c6\u5316\u6d41\u6c34\u7ebf\u72b6\u6001\u3002</li> </ul> <p>\u9884\u9632\u63aa\u65bd\uff1a</p> <ul> <li>\u589e\u52a0\u6d41\u6c34\u7ebf\u524d\u7f6e\u68c0\u67e5\uff08\u5982\u4f9d\u8d56\u5e93\u7248\u672c\u6821\u9a8c\uff09\u3002</li> <li>\u5b9e\u65bd\u53d8\u66f4\u7ba1\u7406\u6d41\u7a0b\uff0c\u51cf\u5c11\u73af\u5883\u6f02\u79fb\u3002</li> </ul>"},{"location":"2025/13tiktok/#3","title":"3 \u8bbf\u95ee\u670d\u52a1","text":""},{"location":"2025/13tiktok/#3-1-502","title":"3-1 \u8bbf\u95ee\u670d\u52a1\u51fa\u73b0 502 \u662f\u4ec0\u4e48\u95ee\u9898\uff1f","text":"<p>\u5e38\u89c1\u539f\u56e0\u53ca\u6392\u67e5\u6b65\u9aa4\uff1a</p> <p>\u5982\u679c\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\uff08\u5982 Kubernetes Ingress\uff09\uff0c\u68c0\u67e5\u5065\u5eb7\u68c0\u67e5\u914d\u7f6e\u662f\u5426\u5408\u7406</p> <ul> <li>\u9632\u706b\u5899/\u5b89\u5168\u7ec4\uff1a\u786e\u8ba4\u540e\u7aef\u670d\u52a1\u7aef\u53e3\u662f\u5426\u5f00\u653e\u3002</li> <li>DNS \u89e3\u6790\uff1a\u4f7f\u7528 dig \u6216 nslookup \u9a8c\u8bc1\u57df\u540d\u89e3\u6790\u3002</li> <li>\u670d\u52a1\u672a\u542f\u52a8\uff1a\u68c0\u67e5\u8fdb\u7a0b\u72b6\u6001\uff08<code>ps aux | grep service_name</code>\uff09\u3002</li> <li>\u8d1f\u8f7d\u8fc7\u9ad8\uff1a\u76d1\u63a7 CPU/\u5185\u5b58\u4f7f\u7528\u7387\uff0c\u4f18\u5316\u4ee3\u7801\u6216\u6269\u5bb9\u3002</li> <li>Nginx \u914d\u7f6e\u9519\u8bef\uff1a\u68c0\u67e5 <code>proxy_pass</code> \u662f\u5426\u6307\u5411\u6b63\u786e\u7684\u540e\u7aef\u670d\u52a1\u5730\u5740\u3002</li> <li> <p>\u8d85\u65f6\u8bbe\u7f6e\uff1a\u8c03\u6574 <code>proxy_read_timeout</code> \u6216<code>proxy_connect_timeout</code>\u3002</p> </li> <li> <p>\u53cd\u5411\u4ee3\u7406\u95ee\u9898\uff1a</p> </li> <li>\u540e\u7aef\u670d\u52a1\u95ee\u9898\uff1a</li> <li>\u7f51\u7edc\u95ee\u9898\uff1a</li> <li>\u5065\u5eb7\u68c0\u67e5\u5931\u8d25\uff1a</li> </ul> <p>\u793a\u4f8b\u6392\u67e5\u6d41\u7a0b\uff1a</p> <ol> <li>\u8bbf\u95ee\u65e5\u5fd7\uff1a\u68c0\u67e5 Nginx \u7684 error.log \u4e2d\u7684 502 \u9519\u8bef\u8be6\u60c5\u3002</li> <li>\u6a21\u62df\u8bf7\u6c42\uff1a\u76f4\u63a5\u8bbf\u95ee\u540e\u7aef\u670d\u52a1\uff08\u5982 <code>curl http://backend:8080</code>\uff09\u3002</li> <li>\u67e5\u770b\u540e\u7aef\u65e5\u5fd7\uff1a\u68c0\u67e5\u670d\u52a1\u7aef\u65e5\u5fd7\uff08\u5982 <code>tail -f /var/log/app.log</code></li> </ol> <p>\u89e3\u51b3\u65b9\u6848\uff1a</p> <ul> <li>\u91cd\u542f\u670d\u52a1\u6216\u4ee3\u7406\u3002</li> <li>\u8c03\u6574\u8d85\u65f6\u53c2\u6570\u6216\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u3002</li> <li>\u4f18\u5316\u540e\u7aef\u670d\u52a1\u6027\u80fd\uff08\u5982\u589e\u52a0\u7f13\u5b58\u3001\u5206\u9875\u67e5\u8be2\uff09\u3002</li> </ul>"},{"location":"2025/13tiktok/#3-2-k8s-service","title":"3-2 K8S service \u7684\u670d\u52a1\u7c7b\u578b\u6709\u51e0\u79cd\uff1f","text":"<p>ClusterIP\uff1a</p> <ul> <li>\u9ed8\u8ba4\u7c7b\u578b\uff0c\u4ec5\u5728\u96c6\u7fa4\u5185\u90e8\u901a\u8fc7\u865a\u62df IP\uff08VIP\uff09\u8bbf\u95ee\u3002</li> <li>\u9002\u7528\u573a\u666f\uff1a\u540e\u7aef\u670d\u52a1\u95f4\u901a\u4fe1\uff08\u5982\u6570\u636e\u5e93\u3001API \u670d\u52a1\uff09\u3002</li> </ul> <p>NodePort\uff1a</p> <ul> <li>\u5728\u6bcf\u4e2a Node \u7684 IP \u4e0a\u5f00\u653e\u4e00\u4e2a\u7aef\u53e3\uff08\u9ed8\u8ba4 30000-32767\uff09\uff0c\u5916\u90e8\u53ef\u901a\u8fc7 NodeIP:NodePort \u8bbf\u95ee\u3002</li> <li>\u9002\u7528\u573a\u666f\uff1a\u5f00\u53d1/\u6d4b\u8bd5\u73af\u5883\u66b4\u9732\u670d\u52a1\uff0c\u6216\u9700\u8981\u5feb\u901f\u8bbf\u95ee\u3002</li> </ul> <p>LoadBalancer\uff1a</p> <p>\u5728\u4e91\u5e73\u53f0\uff08\u5982 AWS\u3001GCP\uff09\u521b\u5efa\u4e91\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u6d41\u91cf\u81ea\u52a8\u8f6c\u53d1\u5230 Service\u3002 \u9002\u7528\u573a\u666f\uff1a\u751f\u4ea7\u73af\u5883\u7684\u9ad8\u53ef\u7528\u670d\u52a1\u66b4\u9732\u3002</p> <p>ExternalName\uff1a</p> <p>\u901a\u8fc7 CNAME \u5c06 Service \u6620\u5c04\u5230\u5916\u90e8\u57df\u540d\uff08\u5982 api.example.com\uff09\uff0c\u5e38\u7528\u4e8e\u8de8\u96c6\u7fa4\u8bbf\u95ee\u3002</p> <p>\u9ad8\u7ea7\u573a\u666f\uff1a</p> <ul> <li>\u5934\u4fe1\u606f\u4fee\u6539\uff1a\u901a\u8fc7 externalTrafficPolicy: Local \u63a7\u5236\u6d41\u91cf\u6765\u6e90\u3002</li> <li>Ingress \u63a7\u5236\u5668\uff1a\u7ed3\u5408 Ingress \u8d44\u6e90\u5b9e\u73b0\u57fa\u4e8e\u8def\u5f84\u6216\u57df\u540d\u7684\u8def\u7531\uff08\u5982 Nginx Ingress\uff09\u3002</li> </ul> <p>\u9009\u62e9\u5efa\u8bae\uff1a</p> <ul> <li>\u751f\u4ea7\u73af\u5883\u4f18\u5148\u4f7f\u7528 LoadBalancer \u6216 Ingress\u3002</li> <li>\u907f\u514d\u5728\u751f\u4ea7\u73af\u5883\u4f7f\u7528 NodePort\uff0c\u56e0\u5176\u7aef\u53e3\u51b2\u7a81\u98ce\u9669\u8f83\u9ad8\u3002</li> </ul>"},{"location":"2025/13tiktok/#3-3-head","title":"3-3 \u7ed9\u6587\u4ef6\u7684\u6bcf\u4e00\u4e2a\u524d\u9762\u589e\u52a0head\uff1f","text":"<p>Vim \u7f16\u8f91\u5668\uff1a</p> <p>\u6253\u5f00\u6587\u4ef6\uff1avim filename\u3002 \u8fdb\u5165\u547d\u4ee4\u6a21\u5f0f\uff0c\u8f93\u5165 :<code>%s/^/head /g</code>\uff08\u66ff\u6362\u6bcf\u4e00\u884c\u5f00\u5934\uff09\u3002 \u6216\u4f7f\u7528\u53ef\u89c6\u6a21\u5f0f\uff1aggVG:Ihead \uff08\u5168\u5c40\u63d2\u5165\uff09\u3002</p> <p>sed \u547d\u4ee4\uff1a</p> <pre><code>sed -i 's/^/head /' filename  \n# \u6216\u6279\u91cf\u5904\u7406\u591a\u884c\uff1a  \nsed -i '1i\\head' filename  # \u5728\u6587\u4ef6\u5f00\u5934\u63d2\u5165\uff08\u975e\u6bcf\u884c\uff09  \n</code></pre> <p>awk \u547d\u4ee4\uff1a</p> <pre><code>awk '{print \"head \" $0}' filename &gt; newfile  \n</code></pre> <ul> <li>-i \u53c2\u6570\u4f1a\u76f4\u63a5\u4fee\u6539\u539f\u6587\u4ef6\uff0c\u5efa\u8bae\u5148\u5907\u4efd\u3002</li> <li>\u82e5\u9700\u4fdd\u7559\u539f\u6587\u4ef6\uff0c\u53ef\u91cd\u5b9a\u5411\u8f93\u51fa\uff1aawk ... &gt; newfile\u3002</li> </ul>"},{"location":"2025/13tiktok/#3-4-awk-8","title":"3-4 awk \u63d0\u53d6\u6570\u503c\u4e3a8\u7684\u7b2c\u4e8c\u5217\u7684\u6570\u91cf\uff0c\u5206\u9694\u7b26\u4e3a | \uff0c\u600e\u4e48\u63d0\u53d6\uff1f","text":"<pre><code>awk -F '|' '$2 == 8 {count++} END {print count}' filename  \n</code></pre> <ul> <li><code>-F '|'</code>\uff1a\u8bbe\u7f6e\u5206\u9694\u7b26\u4e3a<code>|</code>\u3002</li> <li><code>$2 == 8</code>\uff1a\u7b5b\u9009\u7b2c\u4e8c\u5217\u503c\u4e3a 8 \u7684\u884c\u3002</li> <li><code>count++</code>\uff1a\u8ba1\u6570\u5668\u81ea\u589e\u3002</li> </ul> <p>\u6269\u5c55\u573a\u666f\uff1a</p> <ul> <li>\u7edf\u8ba1\u8303\u56f4\uff1a<code>$2 &gt; 5 &amp;&amp; $2 &lt; 10</code>\u7edf\u8ba1\u7b2c\u4e8c\u5217\u5728 5~10 \u4e4b\u95f4\u7684\u884c\u6570\u3002</li> <li>\u591a\u6761\u4ef6\u5339\u914d\uff1a</li> </ul> <pre><code>awk -F '|' '$2 == 8 &amp;&amp; $3 ~ /error/ {count++} END {print count}'  \n</code></pre> <p>\u8f93\u51fa\u8be6\u7ec6\u4fe1\u606f\uff1a</p> <pre><code>awk -F '|' '$2 == 8 {print $0}' filename &gt; result.txt  \n</code></pre>"},{"location":"2025/13tiktok/#4-nginx","title":"4 nginx \u7684\u8d1f\u8f7d\u5747\u8861\u600e\u4e48\u914d\u7f6e\uff1f","text":"<p>\u57fa\u7840\u914d\u7f6e\u6b65\u9aa4\uff1a</p> <ul> <li><code>round_robin</code>\uff08\u9ed8\u8ba4\uff09\uff1a\u8f6e\u8be2\u3002</li> <li><code>ip_hash</code>\uff1a\u6839\u636e\u5ba2\u6237\u7aef IP \u5206\u914d\uff0c\u4fdd\u6301\u4f1a\u8bdd\u3002</li> <li><code>least_conn</code>\uff1a\u6700\u5c11\u8fde\u63a5\u6570</li> </ul> <p>\u5b9a\u4e49 upstream \u7ec4\uff1a</p> <pre><code>upstream backend {  \n  server backend1.example.com weight=3;  \n  server backend2.example.com;  # \u6743\u91cd\u9ed8\u8ba41  \n  server backup.example.com backup;  # \u5907\u7528\u8282\u70b9  \n}  \n</code></pre> <p>\u914d\u7f6e server \u548c location\uff1a</p> <pre><code>server {  \n  listen 80;  \n  server_name example.com;  \n  location / {  \n    proxy_pass http://backend;  \n    proxy_next_upstream error timeout invalid_header http_500;  # \u5931\u8d25\u91cd\u8bd5\u7b56\u7565  \n  }  \n</code></pre> <p>\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff1a</p> <p>\u4e3b\u52a8\u5065\u5eb7\u68c0\u67e5\uff08\u9700 Nginx Plus\uff09\uff1a</p> <pre><code>upstream backend {  \n  zone backend 64k;  \n  server backend1.example.com;  \n  health_check;  \n}  \n</code></pre> <p>\u88ab\u52a8\u5065\u5eb7\u68c0\u67e5\uff1a\u901a\u8fc7 <code>proxy_next_upstream</code> \u89c4\u5219\u5254\u9664\u6545\u969c\u8282\u70b9\u3002</p> <p>\u9ad8\u7ea7\u914d\u7f6e\uff1a</p> <ul> <li>\u8d85\u65f6\u8bbe\u7f6e\uff1a<code>proxy_connect_timeout 5s;</code>\u3002</li> <li>\u4f1a\u8bdd\u4fdd\u6301\uff1a\u7ed3\u5408<code>ip_hash</code> \u6216 Cookie\u3002</li> </ul> <p>\u9a8c\u8bc1\u4e0e\u6d4b\u8bd5\uff1a</p> <ul> <li>\u4f7f\u7528 curl -I http://example.com \u68c0\u67e5\u54cd\u5e94\u5934\u7684 <code>X-Forwarded-For</code>\u3002</li> <li>\u6a21\u62df\u8282\u70b9\u6545\u969c\uff0c\u89c2\u5bdf\u6d41\u91cf\u5207\u6362\u662f\u5426\u6b63\u5e38\u3002</li> </ul>"},{"location":"2025/13tiktok/#5-mysql-redis","title":"5 MySQL \u4e3b\u4ece\u67b6\u6784\u548c redis\u54e8\u5175 \u524d\u7aef\u662f\u7528\u4ec0\u4e48\u8fde\u63a5\u7684\u670d\u52a1\uff0c\u8bfb\u53d6\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\uff0c\u5bf9\u6570\u636e\u8fdb\u884c\u4e00\u4e2a\u5e94\u7528\u7684\uff1f","text":"<p>MySQL \u4e3b\u4ece\u67b6\u6784\uff1a</p> <ul> <li>\u4ece\u5e93\u5ef6\u8fdf\u53ef\u80fd\u5bfc\u81f4\u8bfb\u5199\u4e0d\u4e00\u81f4\uff0c\u9700\u901a\u8fc7 <code>read_only</code> \u53c2\u6570\u63a7\u5236\u4ece\u5e93\u5199\u5165\u3002</li> <li>\u4f7f\u7528\u4e2d\u95f4\u4ef6\uff08\u5982 MyCat\uff09\u5b9e\u73b0\u81ea\u52a8\u8def\u7531\u3002</li> <li>\u524d\u7aef\u5e94\u7528\u901a\u8fc7\u4e3b\u8282\u70b9\u5199\u5165\u6570\u636e\uff0c\u901a\u8fc7\u4ece\u8282\u70b9\u8bfb\u53d6\uff08\u8bfb\u5199\u5206\u79bb\uff09\u3002</li> <li> <p>\u4f7f\u7528\u8fde\u63a5\u6c60\uff08\u5982 HikariCP\uff09\u7ba1\u7406\u6570\u636e\u5e93\u8fde\u63a5\u3002</p> </li> <li> <p>\u8fde\u63a5\u65b9\u5f0f\uff1a</p> </li> <li>\u914d\u7f6e\u793a\u4f8b</li> </ul> <pre><code>// Spring Boot \u914d\u7f6e\u4e3b\u4ece\u5206\u79bb  \nspring:  \n  datasource:  \n    master:  \n      url: jdbc:mysql://master:3306/db  \n    slave:  \n      url: jdbc:mysql://slave:3306/db  \n</code></pre> <p>Redis \u54e8\u5175\u6a21\u5f0f\uff1a</p> <ul> <li>\u54e8\u5175\u76d1\u63a7\u4e3b\u8282\u70b9\uff0c\u4e3b\u8282\u70b9\u6545\u969c\u65f6\u81ea\u52a8\u9009\u4e3e\u65b0\u4e3b\u8282\u70b9\u3002</li> <li>\u5ba2\u6237\u7aef\u901a\u8fc7\u54e8\u5175\u83b7\u53d6\u6700\u65b0\u4e3b\u8282\u70b9\u5730\u5740\u3002</li> <li>\u5ba2\u6237\u7aef\u8fde\u63a5\u54e8\u5175\u96c6\u7fa4\uff08\u5982\u901a\u8fc7 JedisSentinelPool\uff09\uff0c\u54e8\u5175\u81ea\u52a8\u53d1\u73b0\u4e3b\u8282\u70b9\u3002</li> </ul> <pre><code>Set&lt;String&gt; sentinels = new HashSet&lt;&gt;(Arrays.asList(\"sentinel1:26379\", \"sentinel2:26379\"));  \nJedisSentinelPool pool = new JedisSentinelPool(\"mymaster\", sentinels);  \n</code></pre> <p>\u5e94\u7528\u5c42\u8bbe\u8ba1\uff1a</p> <ul> <li>MySQL\uff1a\u4e1a\u52a1\u903b\u8f91\u4e2d\u533a\u5206\u8bfb\u5199\u64cd\u4f5c\uff08\u5982 @Transactional \u6ce8\u89e3\u63a7\u5236\uff09\u3002</li> <li>Redis\uff1a\u4f7f\u7528\u8fde\u63a5\u6c60\u81ea\u52a8\u5904\u7406\u4e3b\u4ece\u5207\u6362\uff0c\u907f\u514d\u624b\u52a8\u5e72\u9884\u3002</li> </ul>"},{"location":"2025/13tiktok/#6-linux","title":"6 linux \u7cfb\u7edf\u8c03\u4f18\u662f\u600e\u4e48\u8fdb\u884c\u8c03\u4f18\u7684\uff0c\u5bf9\u5e94\u7b80\u5386\u4e2d\u7684\u6027\u80fd\u662f\u600e\u4e48\u8c03\u4f18\u7684\uff1f","text":"<p>\u6027\u80fd\u76d1\u63a7\u5de5\u5177\uff1a</p> <ul> <li>top/htop\uff1a\u5b9e\u65f6\u67e5\u770b CPU\u3001\u5185\u5b58\u3001\u8fdb\u7a0b\u72b6\u6001\u3002</li> <li>vmstat\uff1a\u76d1\u63a7\u5185\u5b58\u3001swap\u3001IO \u7b49\u3002</li> <li>iostat\uff1a\u5206\u6790\u78c1\u76d8 IO \u6027\u80fd\u3002</li> </ul> <p>\u7f51\u7edc\u76d1\u63a7\uff1anetstat, tcpdump, iftop\u3002</p>"},{"location":"2025/13tiktok/#_1","title":"\u8c03\u4f18\u65b9\u5411","text":"<ul> <li>\u8c03\u6574 net.core.somaxconn \u6269\u5927\u8fde\u63a5\u961f\u5217\u3002</li> <li>\u542f\u7528 TCP BBR \u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u3002</li> <li>\u8c03\u6574 <code>read_ahead</code> \u7f13\u51b2\u533a\u5927\u5c0f\u3002</li> <li>\u4f7f\u7528 noatime \u6302\u8f7d\u9009\u9879\u51cf\u5c11\u78c1\u76d8\u5199\u5165\u3002</li> <li>\u589e\u52a0 <code>vm.max_map_count</code>\uff08\u5982 Elasticsearch \u9700\u8981\uff09\u3002</li> <li>\u4f7f\u7528 <code>oom_score_adj</code> \u9632\u6b62\u5173\u952e\u8fdb\u7a0b\u88ab OOM Killer \u7ec8\u6b62\u3002</li> <li>\u4f18\u5316\u7ebf\u7a0b\u8c03\u5ea6\uff08\u5982 nice \u8c03\u6574\u4f18\u5148\u7ea7\uff09\u3002</li> <li> <p>\u8c03\u6574\u5185\u6838\u53c2\u6570\uff08\u5982 vm.swappiness \u63a7\u5236 swap \u4f7f\u7528\uff09</p> </li> <li> <p>CPU\uff1a</p> </li> <li>\u5185\u5b58\uff1a</li> <li>IO\uff1a</li> <li>\u7f51\u7edc\uff1a</li> </ul>"},{"location":"2025/13tiktok/#_2","title":"\u5b9e\u8df5\u6848\u4f8b\uff1a","text":"<ul> <li>\u573a\u666f\uff1a\u6570\u636e\u5e93\u670d\u52a1\u5668 CPU \u4f7f\u7528\u7387\u6301\u7eed 90%\u3002</li> <li>\u6b65\u9aa4\uff1a</li> <li> <p>\u9a8c\u8bc1\uff1a\u5bf9\u6bd4\u8c03\u4f18\u524d\u540e\u7684 sar \u6570\u636e\uff0c\u786e\u4fdd\u6027\u80fd\u63d0\u5347</p> </li> <li> <p>\u901a\u8fc7 <code>perf top</code> \u5b9a\u4f4d\u70ed\u70b9\u51fd\u6570\u3002</p> </li> <li>\u4f18\u5316 SQL \u67e5\u8be2\uff08\u6dfb\u52a0\u7d22\u5f15\u3001\u51cf\u5c11\u5168\u8868\u626b\u63cf\uff09\u3002</li> <li>\u8c03\u6574 MySQL \u914d\u7f6e\uff08\u5982 <code>innodb_buffer_pool_size</code>\uff09\u3002</li> </ul>"},{"location":"2025/13tiktok/#7-kubernetes","title":"7 Kubernetes","text":""},{"location":"2025/13tiktok/#7-1-pod","title":"7-1. pod \u9891\u7e41\u91cd\u542f","text":"<ol> <li>kubctl describe pod  \u67e5\u770b\u5bb9\u5668\u9000\u51fa\u7801\uff0c\u6839\u636e\u9000\u51fa\u7801\u67e5\u770b\u9000\u51fa\u539f\u56e0</li> <li>POD\u7684\u8d44\u6e90\u9650\u5236 request and limit</li> <li>\u63a2\u9488\u5931\u8d25\uff0c\u914d\u7f6e\u63a2\u9488\u7684\u4e0d\u5408\u7406</li> <li>\u770b\u4e00\u4e0b\u5bbf\u4e3b\u673a\u4e0a\u7684\u8d44\u6e90\u914d\u7f6e\u662f\u5426\u5408\u7406\uff0c\u4ee5\u53ca\u5176\u4ed6pod\u662f\u5426\u91cd\u542f</li> </ol>"},{"location":"2025/14git/","title":"Git Scenario-Based Questions","text":""},{"location":"2025/14git/#basic-git-scenarios","title":"Basic Git Scenarios","text":""},{"location":"2025/14git/#1-accidentally-committed-sensitive-credentials-in-git-how-do-you-remove-them-from-history","title":"1 Accidentally committed sensitive credentials in Git. How do you remove them from history?","text":"<pre><code>Use git filter-branch (deprecated) or git filter-repo, then force push.\n</code></pre>"},{"location":"2025/14git/#2-how-do-you-undo-your-last-commit-without-losing-your-changes","title":"2 How do you undo your last commit without losing your changes?","text":"<p>\u2022 Use <code>git reset --soft HEAD~1</code></p>"},{"location":"2025/14git/#you-need-to-discard-local-changes-in-a-specific-file-how-would-you-do-it","title":"You need to discard local changes in a specific file. How would you do it?","text":"<ul> <li> <p><code>git checkout -- &lt;file&gt;</code></p> </li> <li> <p><code>git restore &lt;file&gt;</code></p> </li> </ul>"},{"location":"2025/14git/#what-happens-if-you-run-git-reset-hard-head1","title":"What happens if you run git reset --hard HEAD~1?","text":"<p>It removes the last commit and all changes permanently.</p>"},{"location":"2025/14git/#how-can-you-recover-a-deleted-branch","title":"How can you recover a deleted branch?","text":"<p>Use git reflog to find the commit and <code>git checkout -b &lt;branch_name&gt; &lt;commit_hash&gt;</code>.</p> <p>Use <code>git checkout &lt;correct_branch&gt;</code>, then <code>git cherry-pick &lt;commit_hash&gt;</code>.</p>"},{"location":"2025/14git/#how-do-you-revert-a-specific-commit-without-affecting-other-changes","title":"How do you revert a specific commit without affecting other changes?","text":"<pre><code>git revert &lt;commit_hash&gt;.\n</code></pre>"},{"location":"2025/14git/#you-cloned-a-repository-but-forgot-to-specify-recurse-submodules-how-do-you-initialize-submodules-afterward","title":"You cloned a repository but forgot to specify <code>--recurse-submodules</code>. How do you initialize submodules afterward?","text":"<pre><code>git submodule update --init --recursive.\n</code></pre>"},{"location":"2025/14git/#how-do-you-rebase-a-feature-branch-onto-the-main-branch","title":"How do you rebase a feature branch onto the main branch?","text":"<pre><code>git checkout feature-branch \n\ngit rebase main\n</code></pre>"},{"location":"2025/14git/#what-is-the-difference-between-git-merge-and-git-rebase","title":"What is the difference between git merge and git rebase?","text":"<p>git merge creates a new merge commit, while git rebase moves commits on top of the latest branch.</p>"},{"location":"2025/14git/#how-do-you-delete-a-remote-branch-that-is-no-longer-needed","title":"How do you delete a remote branch that is no longer needed?","text":"<pre><code>git push origin --delete &lt;branch_name&gt;\n</code></pre>"},{"location":"2025/14git/#your-main-branch-is-ahead-of-your-local-branch-how-do-you-update-your-branch-without-affecting-your-commits","title":"Your main branch is ahead of your local branch. How do you update your branch without affecting your commits?","text":"<p><code>git pull --rebase origin main</code></p> <p>What happens if you try to merge a branch that has already been merged?</p>"},{"location":"2025/14git/#how-do-you-force-push-a-commit-while-ensuring-you-dont-overwrite-other-team-members-work","title":"How do you force push a commit while ensuring you don't overwrite other team members' work","text":"<p><code>git push --force-with-lease</code></p>"},{"location":"2025/14git/#you-need-to-contribute-to-an-open-source-project-what-steps-will-you-take-to-fork-and-create-a-pull-request","title":"You need to contribute to an open-source project. What steps will you take to fork and create a pull request?","text":"<p>Fork repo, clone it, create a feature branch, push changes, and open a PR.</p>"},{"location":"2025/14git/#how-do-you-revert-a-pushed-commit-that-is-causing-issues-in-production","title":"How do you revert a pushed commit that is causing issues in production?","text":"<p>Use <code>git revert &lt;commit_hash&gt;</code>, then push.</p>"},{"location":"2025/14git/#advanced-git-scenarios","title":"Advanced Git Scenarios","text":""},{"location":"2025/14git/#you-need-to-squash-multiple-commits-into-one-before-pushing-how-do-you-do-that","title":"You need to squash multiple commits into one before pushing. How do you do that?","text":"<p>Use <code>git rebase -i HEAD~&lt;n&gt;</code>, then choose squash.</p>"},{"location":"2025/14git/#how-do-you-rewrite-commit-history-to-change-a-commit-message-from-a-few-commits-ago","title":"How do you rewrite commit history to change a commit message from a few commits ago?","text":"<p>Use <code>git rebase -i HEAD~&lt;n&gt;</code> and modify the commit message.</p>"},{"location":"2025/14git/#explain-how-git-cherry-pick-works-and-when-you-would-use-it","title":"Explain how git cherry-pick works and when you would use it.","text":"<p>It applies a specific commit from one branch to another. Useful for selective fixes.</p>"},{"location":"2025/14git/#you-have-diverged-from-the-remote-branch-and-your-local-commits-conflict-with-remote-changes-how-do-you-fix-this","title":"You have diverged from the remote branch, and your local commits conflict with remote changes. How do you fix this?","text":"<pre><code>git pull --rebase and resolve conflicts\n</code></pre>"},{"location":"2025/14git/#how-do-you-temporarily-save-changes-that-are-not-ready-to-be-committed","title":"How do you temporarily save changes that are not ready to be committed?","text":"<p>\u2022 Use git stash.</p>"},{"location":"2025/14git/#your-git-repository-has-become-very-large-how-do-you-reduce-its-size-without-affecting-its-history","title":"Your Git repository has become very large. How do you reduce its size without affecting its history?","text":"<p>Use git gc or git filter-repo.</p>"},{"location":"2025/14git/#explain-the-difference-between-git-revert-and-git-reset-when-would-you-use-each","title":"Explain the difference between git revert and git reset. When would you use each?","text":"<ul> <li> <p><code>git revert</code> undoes a commit safely, </p> </li> <li> <p><code>git reset</code> removes commits. </p> </li> <li> <p>Use revert for public branches and reset for local changes.</p> </li> </ul>"},{"location":"2025/15Apple_SRE_prp/","title":"2025 Apple SRE PRP","text":""},{"location":"2025/15Apple_SRE_prp/#unix-processes","title":"Unix Processes","text":""},{"location":"2025/15Apple_SRE_prp/#_1","title":"\u8fdb\u7a0b\u4e0e\u7ebf\u7a0b\u7684\u533a\u522b\u662f\u4ec0\u4e48\uff1f","text":"<p>\u7ebf\u7a0b\u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u8fdb\u7a0b\u3002</p> <p>\u6bcf\u4e2a\u8fdb\u7a0b\u62e5\u6709\u72ec\u7acb\u7684\u6808\u3001\u4ee3\u7801\u6bb5\u3001\u6570\u636e\u6bb5\u548c\u5806\uff1b</p> <p>\u7ebf\u7a0b\u867d\u62e5\u6709\u81ea\u5df1\u7684\u6808\uff0c\u4f46\u4e0e\u6240\u5c5e\u8fdb\u7a0b\u5171\u4eab\u4ee3\u7801\u6bb5\u3001\u6570\u636e\u6bb5\u548c\u5806\u3002</p> <p>\u5176\u4e2d\uff1a</p> <ul> <li>\u4ee3\u7801\u6bb5 \u6307\u7a0b\u5e8f\u672c\u8eab\u7684\u53ef\u6267\u884c\u6307\u4ee4</li> <li>\u6570\u636e\u6bb5 \u5b58\u50a8\u7a0b\u5e8f\u7684\u8f93\u5165\u6570\u636e</li> <li>\u5806 \u7528\u4e8e\u52a8\u6001\u5206\u914d\u5185\u5b58\uff08\u5b58\u50a8\u6587\u4ef6\u3001\u9501\u3001\u5957\u63a5\u5b57\u7b49\u5bf9\u8c61\uff09</li> </ul>"},{"location":"2025/15Apple_SRE_prp/#_2","title":"\u50f5\u5c38\u8fdb\u7a0b\u662f\u4ec0\u4e48\uff1f","text":"<p>\u50f5\u5c38\u8fdb\u7a0b\u662f\u5df2\u5b8c\u6210\u6267\u884c\u4f46\u4ecd\u5728\u8fdb\u7a0b\u8868\u4e2d\u4fdd\u7559\u8bb0\u5f55\u7684\u8fdb\u7a0b\u3002\u5176\u5b58\u5728\u7684\u610f\u4e49\u662f\u8ba9\u7236\u8fdb\u7a0b\u80fd\u591f\u8bfb\u53d6\u5b50\u8fdb\u7a0b\u7684\u9000\u51fa\u72b6\u6001\u3002\u8fd9\u7c7b\u8fdb\u7a0b\u88ab\u79f0\u4e3a\"\u50f5\u5c38\"\uff0c\u662f\u56e0\u4e3a\u5b83\u867d\u7136\u5df2\u7ecf\"\u6b7b\u4ea1\"\uff0c\u5374\u5c1a\u672a\u88ab\u7236\u8fdb\u7a0b\"\u56de\u6536\"\uff08reaped\uff09\u3002\u7236\u8fdb\u7a0b\u901a\u5e38\u4f1a\u901a\u8fc7 <code>wait</code> \u7cfb\u7edf\u8c03\u7528\u6765\u83b7\u53d6\u5b50\u8fdb\u7a0b\u7684\u9000\u51fa\u72b6\u6001\uff0c\u6b64\u65f6\u50f5\u5c38\u8fdb\u7a0b\u624d\u4f1a\u88ab\u5f7b\u5e95\u79fb\u9664\u3002</p>"},{"location":"2025/15Apple_SRE_prp/#_3","title":"\u5173\u952e\u7279\u6027\uff1a","text":"<ol> <li> <p>\u4e0d\u53ef\u7ec8\u6b62\u6027 <code>kill</code> \u547d\u4ee4\u5bf9\u50f5\u5c38\u8fdb\u7a0b\u65e0\u6548\uff08\u56e0\u5176\u5b9e\u9645\u5df2\u7ec8\u6b62\u8fd0\u884c\uff09</p> </li> <li> <p>\u4fe1\u53f7\u673a\u5236 </p> </li> </ol> <p>\u5b50\u8fdb\u7a0b\u7ec8\u6b62\u65f6\uff0c\u7236\u8fdb\u7a0b\u4f1a\u6536\u5230 <code>SIGCHLD</code> \u4fe1\u53f7</p> <ol> <li>\u8d44\u6e90\u5360\u7528 </li> </ol> <p>\u50f5\u5c38\u8fdb\u7a0b\u51e0\u4e4e\u4e0d\u6d88\u8017\u7cfb\u7edf\u8d44\u6e90\uff0c\u4ec5\u5360\u7528\u8fdb\u7a0b\u8868\u4e2d\u6781\u5c0f\u7684\u8bb0\u5f55\u7a7a\u95f4</p>"},{"location":"2025/15Apple_SRE_prp/#_4","title":"\u672f\u8bed\u5bf9\u7167\u8868","text":"\u82f1\u6587\u672f\u8bed \u4e2d\u6587\u7ffb\u8bd1 \u6280\u672f\u542b\u4e49 Zombie process \u50f5\u5c38\u8fdb\u7a0b \u5df2\u7ec8\u6b62\u4f46\u672a\u88ab\u56de\u6536\u7684\u8fdb\u7a0b Process table \u8fdb\u7a0b\u8868 \u64cd\u4f5c\u7cfb\u7edf\u7ef4\u62a4\u7684\u8fdb\u7a0b\u72b6\u6001\u8bb0\u5f55\u7ed3\u6784 Exit status \u9000\u51fa\u72b6\u6001 \u8fdb\u7a0b\u7ec8\u6b62\u65f6\u8fd4\u56de\u7ed9\u7236\u8fdb\u7a0b\u7684\u72b6\u6001\u4ee3\u7801 wait system call wait\u7cfb\u7edf\u8c03\u7528 \u7236\u8fdb\u7a0b\u56de\u6536\u5b50\u8fdb\u7a0b\u8d44\u6e90\u7684\u963b\u585e\u64cd\u4f5c SIGCHLD signal SIGCHLD\u4fe1\u53f7 \u5b50\u8fdb\u7a0b\u72b6\u6001\u53d8\u66f4\u65f6\u53d1\u9001\u7ed9\u7236\u8fdb\u7a0b\u7684\u4fe1\u53f7"},{"location":"2025/15Apple_SRE_prp/#_5","title":"\u6280\u672f\u5ef6\u4f38\u8bf4\u660e","text":"<ul> <li>\u4e0e\u5b64\u513f\u8fdb\u7a0b\u7684\u533a\u522b\uff1a\u5b64\u513f\u8fdb\u7a0b\u662f\u7236\u8fdb\u7a0b\u5148\u7ec8\u6b62\u7684\u5b50\u8fdb\u7a0b\uff0c\u7531init\u8fdb\u7a0b\u63a5\u7ba1\uff1b\u50f5\u5c38\u8fdb\u7a0b\u5219\u662f\u7236\u8fdb\u7a0b\u672a\u53ca\u65f6\u56de\u6536\u7684\u5b50\u8fdb\u7a0b\u6b8b\u9ab8</li> <li>\u6e05\u9664\u65b9\u5f0f\uff1a  </li> <li>\u6b63\u786e\u505a\u6cd5\uff1a\u7236\u8fdb\u7a0b\u8c03\u7528 <code>wait()</code>/<code>waitpid()</code> </li> <li>\u6781\u7aef\u60c5\u51b5\uff1a\u5f3a\u5236\u7ec8\u6b62\u7236\u8fdb\u7a0b\uff08\u50f5\u5c38\u8fdb\u7a0b\u4f1a\u88abinit\u8fdb\u7a0b\u63a5\u7ba1\u5e76\u56de\u6536\uff09</li> <li>\u7cfb\u7edf\u5f71\u54cd\uff1a\u5927\u91cf\u50f5\u5c38\u8fdb\u7a0b\u53ef\u80fd\u5bfc\u81f4\u8fdb\u7a0b\u8868\u6ea2\u51fa\uff08\u4f46\u73b0\u4ee3\u7cfb\u7edf\u8fdb\u7a0b\u8868\u5bb9\u91cf\u901a\u5e38\u8db3\u591f\u5927\uff09</li> </ul> <p>\u793a\u4f8b\u573a\u666f\uff1a\u5f53\u7236\u8fdb\u7a0b\u672a\u5b9e\u73b0SIGCHLD\u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\uff0c\u6216\u672a\u8c03\u7528wait()\u65f6\uff0c\u5b50\u8fdb\u7a0b\u4f1a\u6301\u7eed\u4fdd\u6301\u50f5\u5c38\u72b6\u6001\u76f4\u81f3\u7236\u8fdb\u7a0b\u7ec8\u6b62\u3002</p> <p>\u8be5\u8bd1\u6587\u4e25\u683c\u9075\u5faa\u64cd\u4f5c\u7cfb\u7edf\u9886\u57df\u672f\u8bed\u89c4\u8303\uff0c\u5e76\u901a\u8fc7\u7ed3\u6784\u5316\u5448\u73b0\u589e\u5f3a\u6280\u672f\u6982\u5ff5\u7684\u6e05\u6670\u5ea6\u3002</p>"},{"location":"2025/15Apple_SRE_prp/#_6","title":"\u4ee5\u4e0b\u662f\u5173\u4e8e\u50f5\u5c38\u8fdb\u7a0b\u6210\u56e0\u53ca\u5b88\u62a4\u8fdb\u7a0b\u521b\u5efa\u7684\u4e13\u4e1a\u4e2d\u6587\u89e3\u6790\uff1a","text":""},{"location":"2025/15Apple_SRE_prp/#_7","title":"\u50f5\u5c38\u8fdb\u7a0b\u7684\u4ea7\u751f\u6761\u4ef6","text":"<p>\u6839\u672c\u539f\u56e0\uff1a\u7236\u8fdb\u7a0b\u672a\u8c03\u7528 <code>wait()</code>/<code>waitpid()</code> \u7cfb\u7edf\u8c03\u7528\u56de\u6536\u5b50\u8fdb\u7a0b \u5178\u578b\u573a\u666f\uff1a  </p> <ol> <li>\u7236\u8fdb\u7a0b\u672a\u6b63\u786e\u5904\u7406 <code>SIGCHLD</code> \u4fe1\u53f7  </li> <li>\u7236\u8fdb\u7a0b\u8bbe\u8ba1\u7f3a\u9677\uff08\u5982\u672a\u5b9e\u73b0\u5b50\u8fdb\u7a0b\u72b6\u6001\u8f6e\u8be2\u673a\u5236\uff09  </li> <li>\u7236\u8fdb\u7a0b\u5d29\u6e83\u524d\u672a\u6e05\u7406\u5df2\u7ec8\u6b62\u7684\u5b50\u8fdb\u7a0b  </li> </ol> <p>\u793a\u4f8b\uff1a\u82e5\u7236\u8fdb\u7a0b\u6267\u884c <code>fork()</code> \u540e\u672a\u8c03\u7528 <code>wait()</code>\uff0c\u5b50\u8fdb\u7a0b\u9000\u51fa\u65f6\u5c06\u6ede\u7559\u4e3a\u50f5\u5c38\u72b6\u6001</p>"},{"location":"2025/15Apple_SRE_prp/#daemon","title":"\u5b88\u62a4\u8fdb\u7a0b\uff08Daemon\uff09\u521b\u5efa\u6b65\u9aa4\u8be6\u89e3","text":"\u6b65\u9aa4 \u7cfb\u7edf\u8c03\u7528/\u64cd\u4f5c \u6280\u672f\u539f\u7406\u8bf4\u660e 1. \u521b\u5efa\u5b50\u8fdb\u7a0b <code>fork()</code> \u751f\u6210\u72ec\u7acb\u4e8e\u7236\u8fdb\u7a0b\u7684\u65b0\u8fdb\u7a0b\uff0c\u7236\u8fdb\u7a0b\u7acb\u5373\u9000\u51fa\uff08\u5b50\u8fdb\u7a0b\u7531init\u63a5\u7ba1\uff09 2. \u8131\u79bb\u63a7\u5236\u7ec8\u7aef <code>setsid()</code> \u521b\u5efa\u65b0\u4f1a\u8bdd\u5e76\u6210\u4e3a\u4f1a\u8bdd\u9886\u5934\u8fdb\u7a0b\uff0c\u5f7b\u5e95\u8131\u79bb\u539f\u7ec8\u7aef\u5173\u8054 3. \u91cd\u7f6e\u6587\u4ef6\u63a9\u7801 <code>umask(0)</code> \u6e05\u9664\u7ee7\u627f\u7684\u6587\u4ef6\u521b\u5efa\u6743\u9650\u63a9\u7801\uff0c\u786e\u4fdd\u5b88\u62a4\u8fdb\u7a0b\u521b\u5efa\u6587\u4ef6\u65f6\u62e5\u6709\u7cbe\u786e\u6743\u9650 4. \u5207\u6362\u5de5\u4f5c\u76ee\u5f55 <code>chdir(\"/\")</code> \u907f\u514d\u5360\u7528\u53ef\u5378\u8f7d\u6587\u4ef6\u7cfb\u7edf\uff08\u5982\u6302\u8f7d\u76ee\u5f55\uff09\uff0c\u901a\u5e38\u5207\u6362\u5230\u6839\u76ee\u5f55 5. \u91cd\u5b9a\u5411\u6807\u51c6\u6d41 \u91cd\u5f00<code>stdin/stdout/stderr</code> \u5173\u95ed\u7ee7\u627f\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u901a\u5e38\u91cd\u5b9a\u5411\u5230 <code>/dev/null</code> \u6216\u65e5\u5fd7\u6587\u4ef6"},{"location":"2025/15Apple_SRE_prp/#_8","title":"\u5173\u952e\u64cd\u4f5c\u4ee3\u7801\u793a\u4f8b","text":"<pre><code>// \u521b\u5efa\u5b88\u62a4\u8fdb\u7a0b\u6838\u5fc3\u903b\u8f91\npid_t pid = fork();\nif (pid &gt; 0) exit(EXIT_SUCCESS); // \u7236\u8fdb\u7a0b\u9000\u51fa\nif (pid &lt; 0) exit(EXIT_FAILURE); // \u9519\u8bef\u5904\u7406\n\nsetsid();                        // \u8131\u79bb\u7ec8\u7aef\u63a7\u5236\numask(0);                        // \u91cd\u7f6e\u6587\u4ef6\u63a9\u7801\nchdir(\"/\");                      // \u5207\u6362\u5de5\u4f5c\u76ee\u5f55\n\n// \u5173\u95ed\u5e76\u91cd\u5b9a\u5411\u6807\u51c6\u6d41\nclose(STDIN_FILENO);\nclose(STDOUT_FILENO);\nclose(STDERR_FILENO);\nopen(\"/dev/null\", O_RDONLY);     // stdin \u2192 /dev/null\nopen(\"/dev/null\", O_WRONLY);     // stdout \u2192 /dev/null\nopen(\"/var/log/daemon.log\", O_WRONLY | O_APPEND); // stderr \u2192 \u65e5\u5fd7\u6587\u4ef6\n</code></pre>"},{"location":"2025/15Apple_SRE_prp/#_9","title":"\u6280\u672f\u8981\u70b9\u8bf4\u660e","text":"<ol> <li>\u50f5\u5c38\u8fdb\u7a0b\u9884\u9632 </li> <li>\u7236\u8fdb\u7a0b\u5fc5\u987b\u5b9e\u73b0 <code>SIGCHLD</code> \u4fe1\u53f7\u5904\u7406\u51fd\u6570\u5e76\u5728\u5176\u4e2d\u8c03\u7528 <code>waitpid()</code> </li> <li> <p>\u4f7f\u7528 <code>WNOHANG</code> \u9009\u9879\u8fdb\u884c\u975e\u963b\u585e\u56de\u6536\uff1a <code>c      while (waitpid(-1, &amp;status, WNOHANG) &gt; 0);</code></p> </li> <li> <p>\u5b88\u62a4\u8fdb\u7a0b\u5fc5\u8981\u6027 </p> </li> <li>\u957f\u671f\u8fd0\u884c\u7684\u670d\u52a1\uff08\u5982Web\u670d\u52a1\u5668/\u6570\u636e\u5e93\uff09\u5fc5\u987b\u8131\u79bb\u7ec8\u7aef  </li> <li>\u907f\u514d\u56e0\u7ec8\u7aef\u5173\u95ed\u5bfc\u81f4\u8fdb\u7a0b\u610f\u5916\u7ec8\u6b62  </li> <li>\u5b9e\u73b0\u540e\u53f0\u670d\u52a1\u81ea\u6cbb\uff08\u65e5\u5fd7\u72ec\u7acb/\u8d44\u6e90\u9694\u79bb\uff09</li> </ol> <p>\u6ce8\u610f\uff1a\u73b0\u4ee3Linux\u7cfb\u7edf\u53ef\u901a\u8fc7 <code>daemon()</code> \u51fd\u6570\uff08\u5c01\u88c5\u4e0a\u8ff0\u6b65\u9aa4\uff09\u76f4\u63a5\u521b\u5efa\u5b88\u62a4\u8fdb\u7a0b\uff0c\u4f46\u7406\u89e3\u5e95\u5c42\u673a\u5236\u4ecd\u81f3\u5173\u91cd\u8981\u3002</p>"},{"location":"2025/15Apple_SRE_prp/#shell","title":"Shell\u6267\u884c\u8fdb\u7a0b\u7684\u5b8c\u6574\u6d41\u7a0b","text":"<p>\u4ee5\u4e0b\u662f\u5bf9Unix Shell\u4e2d\u8fdb\u7a0b\u6267\u884c\u673a\u5236\u7684\u8be6\u7ec6\u8bf4\u660e\uff08\u4ee5<code>/bin/ls</code>\u547d\u4ee4\u4e3a\u4f8b\uff09\uff1a</p>"},{"location":"2025/15Apple_SRE_prp/#shell_1","title":"Shell\u6267\u884c\u8fdb\u7a0b\u7684\u5b8c\u6574\u6d41\u7a0b","text":""},{"location":"2025/15Apple_SRE_prp/#1","title":"1. \u547d\u4ee4\u89e3\u6790\u4e0e\u8def\u5f84\u641c\u7d22","text":"<ul> <li>\u5f53\u7528\u6237\u8f93\u5165<code>ls</code>\u65f6\uff0cShell\u89e3\u6790\u547d\u4ee4\u5e76\u68c0\u7d22PATH\u73af\u5883\u53d8\u91cf </li> <li>\u6309\u8def\u5f84\u987a\u5e8f\uff08\u5982<code>/bin:/usr/bin</code>\uff09\u67e5\u627e\u540d\u4e3a<code>ls</code>\u7684\u53ef\u6267\u884c\u6587\u4ef6  </li> <li>\u5b9a\u4f4d\u5230\u76ee\u6807\u7a0b\u5e8f\u8def\u5f84\uff1a<code>/bin/ls</code></li> </ul>"},{"location":"2025/15Apple_SRE_prp/#2","title":"2. \u521b\u5efa\u5b50\u8fdb\u7a0b\uff08\u5173\u952e\u6b65\u9aa4\uff09","text":"<p><code>c    pid_t child_pid = fork();  // \u7cfb\u7edf\u8c03\u7528\u590d\u5236\u5f53\u524dShell\u8fdb\u7a0b</code>    - \u7236\u8fdb\u7a0b\uff08Shell\uff09\uff1a      - \u4fdd\u7559\u63a7\u5236\u7ec8\u7aef\uff0c\u901a\u8fc7<code>waitpid()</code>\u7b49\u5f85\u5b50\u8fdb\u7a0b\u7ed3\u675f      - \u7ef4\u62a4\u4f5c\u4e1a\u63a7\u5236\uff08\u5982\u540e\u53f0\u8fd0\u884c<code>&amp;</code>\uff09    - \u5b50\u8fdb\u7a0b\uff1a      - \u83b7\u5f97\u7236\u8fdb\u7a0b\u5185\u5b58\u7a7a\u95f4\u7684\u5b8c\u6574\u526f\u672c      - \u62e5\u6709\u72ec\u7acbPID\u4f46\u6682\u65f6\u4e0e\u7236\u8fdb\u7a0b\u6267\u884c\u76f8\u540c\u4ee3\u7801</p>"},{"location":"2025/15Apple_SRE_prp/#3","title":"3. \u8fdb\u7a0b\u6620\u50cf\u66ff\u6362\uff08\u6838\u5fc3\u64cd\u4f5c\uff09","text":"<p><code>c    if (child_pid == 0) {  // \u5b50\u8fdb\u7a0b\u6267\u884c\u6d41        execl(\"/bin/ls\", \"ls\", \"-l\", NULL);  // \u52a0\u8f7d\u76ee\u6807\u7a0b\u5e8f    }</code>    - <code>exec</code>\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528\uff1a      - \u5c06\u5b50\u8fdb\u7a0b\u7684\u5185\u5b58\u6620\u50cf\u5b8c\u5168\u66ff\u6362\u4e3a<code>/bin/ls</code>\u7684\u4ee3\u7801\u6bb5      - \u7ee7\u627f\u7236\u8fdb\u7a0b\u5df2\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08\u9664\u975e\u663e\u5f0f\u5173\u95ed\uff09      - \u547d\u4ee4\u884c\u53c2\u6570\uff08\u5982<code>-l</code>\uff09\u901a\u8fc7<code>exec</code>\u7684\u53c2\u6570\u6570\u7ec4\u4f20\u9012</p>"},{"location":"2025/15Apple_SRE_prp/#4","title":"4. \u6267\u884c\u6743\u9650\u4e0e\u8fdb\u7a0b\u7ec8\u6b62","text":"<ul> <li>\u82e5<code>/bin/ls</code>\u65e0\u6267\u884c\u6743\u9650\uff0c<code>exec</code>\u5931\u8d25 \u2192 \u5b50\u8fdb\u7a0b\u9000\u51fa\u5e76\u8fd4\u56de\u9519\u8bef\u7801  </li> <li>\u6267\u884c\u6210\u529f\u540e\uff1a  <ul> <li><code>ls</code>\u8fdb\u7a0b\u8fd0\u884c\u7ed3\u675f \u2192 \u5411\u7236\u8fdb\u7a0b\u53d1\u9001<code>SIGCHLD</code>\u4fe1\u53f7  </li> <li>Shell\u901a\u8fc7<code>wait()</code>\u56de\u6536\u5b50\u8fdb\u7a0b\u8d44\u6e90\uff0c\u907f\u514d\u50f5\u5c38\u8fdb\u7a0b</li> </ul> </li> </ul>"},{"location":"2025/15Apple_SRE_prp/#_10","title":"\u5173\u952e\u6280\u672f\u56fe\u89e3","text":"<pre><code>graph TD\n    A[Shell\u7236\u8fdb\u7a0b] --&gt;|1. fork()| B[\u5b50\u8fdb\u7a0b Shell\u526f\u672c]\n    B --&gt;|2. exec('/bin/ls')| C[/bin/ls \u8fdb\u7a0b/]\n    C --&gt;|3. \u6267\u884c\u7ed3\u675f| D[\u53d1\u9001SIGCHLD]\n    A --&gt;|4. wait()\u56de\u6536\u8d44\u6e90| D\n</code></pre>"},{"location":"2025/15Apple_SRE_prp/#_11","title":"\u5173\u952e\u7279\u6027\u8bf4\u660e","text":"\u6b65\u9aa4 \u7cfb\u7edf\u8c03\u7528 \u4f5c\u7528 \u8fdb\u7a0b\u590d\u5236 <code>fork()</code> \u521b\u5efa\u4e0e\u539f\u8fdb\u7a0b\u5b8c\u5168\u76f8\u540c\u7684\u526f\u672c\uff08\u5305\u62ec\u6253\u5f00\u7684\u6587\u4ef6/\u73af\u5883\u53d8\u91cf\uff09 \u6620\u50cf\u66ff\u6362 <code>exec()</code> \u5c06\u5f53\u524d\u8fdb\u7a0b\u7684\u4ee3\u7801/\u6570\u636e/\u5806\u6808\u66ff\u6362\u4e3a\u65b0\u7a0b\u5e8f\uff08PID\u4fdd\u6301\u4e0d\u53d8\uff09 \u8d44\u6e90\u56de\u6536 <code>wait()</code> \u7236\u8fdb\u7a0b\u963b\u585e\u7b49\u5f85\u5b50\u8fdb\u7a0b\u7ec8\u6b62\uff0c\u83b7\u53d6\u9000\u51fa\u72b6\u6001\u5e76\u91ca\u653e\u5185\u6838\u8fdb\u7a0b\u8868\u8d44\u6e90 <p>\u6ce8\u610f\uff1aShell\u5185\u7f6e\u547d\u4ee4\uff08\u5982<code>cd</code>/<code>export</code>\uff09\u65e0\u9700<code>fork-exec</code>\uff0c\u7531Shell\u76f4\u63a5\u5904\u7406</p>"},{"location":"2025/15Apple_SRE_prp/#_12","title":"\u5b9e\u9645\u7cfb\u7edf\u8c03\u7528\u89c2\u5bdf","text":"<p>\u4f7f\u7528<code>strace</code>\u5de5\u5177\u8ffd\u8e2a\u547d\u4ee4\u6267\u884c\u8fc7\u7a0b\uff1a</p> <pre><code>$ strace -f -e fork,execve,wait4 bash -c 'ls'\n# \u8f93\u51fa\u793a\u4f8b\uff1a\nfork() = 1234       # \u521b\u5efa\u5b50\u8fdb\u7a0b(PID=1234)\nexecve(\"/bin/ls\", [\"ls\", \"-l\"], [...]) = 0  # \u5b50\u8fdb\u7a0b\u52a0\u8f7dls\u7a0b\u5e8f\nwait4(1234, ...)    # \u7236\u8fdb\u7a0b\u7b49\u5f85\u56de\u6536\n</code></pre> <p>\u6b64\u8fc7\u7a0b\u6e05\u6670\u5c55\u793a\u4e86Unix \"fork-exec-wait\" \u7ecf\u5178\u6267\u884c\u6a21\u578b\u3002</p>"},{"location":"2025/15Apple_SRE_prp/#networking","title":"Networking","text":"<p>\u4ee5\u4e0b\u662f\u5bf9TCP\u6162\u542f\u52a8\uff08Slow Start\uff09\u673a\u5236\u7684\u5b8c\u6574\u89e3\u6790\uff0c\u4e25\u683c\u9075\u5faaRFC 5681\u89c4\u8303\u5e76\u8865\u5145\u5173\u952e\u6280\u672f\u7ec6\u8282\uff1a</p>"},{"location":"2025/15Apple_SRE_prp/#tcp","title":"TCP\u6162\u542f\u52a8\u5b9a\u4e49","text":"<p>\u6838\u5fc3\u673a\u5236\uff1a\u4e00\u79cd\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\uff0c\u901a\u8fc7\u6307\u6570\u7ea7\u589e\u957f\u65b9\u5f0f\u52a8\u6001\u8c03\u6574\u62e5\u585e\u7a97\u53e3\uff08cwnd\uff09\uff0c\u5728\u907f\u514d\u7f51\u7edc\u8fc7\u8f7d\u7684\u540c\u65f6\u6700\u5927\u5316\u541e\u5410\u91cf\u3002 \u89e6\u53d1\u6761\u4ef6\uff1a - \u65b0\u5efaTCP\u8fde\u63a5\u65f6 - \u53d1\u751f\u8d85\u65f6\u91cd\u4f20\uff08RTO\uff09\u540e - \u7a7a\u95f2\u8fde\u63a5\u6062\u590d\u4f20\u8f93\u65f6  </p>"},{"location":"2025/15Apple_SRE_prp/#_13","title":"\u8fd0\u4f5c\u6d41\u7a0b","text":"<pre><code>graph LR\n    A[\u521d\u59cbcwnd=1 MSS] --&gt; B[\u53d1\u90011\u4e2a\u62a5\u6587\u6bb5]\n    B --&gt; C{\u6536\u5230ACK}\n    C --&gt;|\u662f| D[cwnd *= 2]\n    D --&gt; E[\u53d1\u9001cwnd\u4e2a\u62a5\u6587\u6bb5]\n    E --&gt; C\n    C --&gt;|\u5426| F[\u89e6\u53d1\u62e5\u585e\u63a7\u5236]\n</code></pre>"},{"location":"2025/15Apple_SRE_prp/#rfc-5681","title":"RFC 5681 \u5173\u952e\u89c4\u8303\u89e3\u6790","text":""},{"location":"2025/15Apple_SRE_prp/#1-cwnd","title":"1. \u62e5\u585e\u7a97\u53e3\uff08cwnd\uff09","text":"<ul> <li>\u5b9a\u4e49\uff1a\u53d1\u9001\u65b9\u7ef4\u62a4\u7684\u72b6\u6001\u53d8\u91cf\uff0c\u9650\u5236\u672a\u7ecf\u786e\u8ba4\u7684\u5728\u9014\u6570\u636e\u91cf </li> <li>\u7ea6\u675f\u516c\u5f0f\uff1a <code>\u6700\u5927\u53d1\u9001\u5e8f\u53f7 \u2264 \u6700\u9ad8\u5df2\u786e\u8ba4\u5e8f\u53f7 + min(cwnd, rwnd)</code></li> </ul>"},{"location":"2025/15Apple_SRE_prp/#2-rwnd","title":"2. \u63a5\u6536\u7a97\u53e3\uff08rwnd\uff09","text":"<ul> <li>\u5b9a\u4e49\uff1a\u63a5\u6536\u65b9\u901a\u544a\u7684\u5269\u4f59\u7f13\u51b2\u533a\u5927\u5c0f\uff08\u901a\u8fc7TCP\u5934\u90e8\u7684Window\u5b57\u6bb5\u4f20\u9012\uff09  </li> <li>\u4e0ecwnd\u5173\u7cfb\uff1a\u5b9e\u9645\u4f20\u8f93\u91cf\u53d7\u4e8c\u8005\u5171\u540c\u5236\u7ea6\uff1a <code>\u6709\u6548\u7a97\u53e3 = min(cwnd, rwnd)</code></li> </ul>"},{"location":"2025/15Apple_SRE_prp/#3_1","title":"3. \u6162\u542f\u52a8\u6838\u5fc3\u89c4\u5219","text":"\u9636\u6bb5 cwnd\u53d8\u5316\u89c4\u5219 \u7f51\u7edc\u63a2\u6d4b\u76ee\u6807 \u542f\u52a8\u9636\u6bb5 \u6bcf\u6536\u52301\u4e2aACK\uff0ccwnd\u589e\u52a01\u4e2aMSS \u5feb\u901f\u63a2\u6d4b\u53ef\u7528\u5e26\u5bbd \u9000\u51fa\u6761\u4ef6 \u53d1\u751f\u4e22\u5305 \u6216 cwnd \u2265 \u6162\u542f\u52a8\u9608\u503c(ssthresh) \u5207\u6362\u4e3a\u62e5\u585e\u907f\u514d\u6a21\u5f0f \u91cd\u7f6e\u673a\u5236 \u8d85\u65f6\u4e22\u5305\u65f6\uff1assthresh = cwnd/2, cwnd=1 \u7f51\u7edc\u62e5\u585e\u540e\u91cd\u65b0\u6536\u655b"},{"location":"2025/15Apple_SRE_prp/#_14","title":"\u6280\u672f\u7ec6\u8282\u8bf4\u660e","text":"<ol> <li>ACK\u5904\u7406\u673a\u5236 </li> <li>\u6bcf\u6536\u5230\u4e00\u4e2aACK\uff0ccwnd\u589e\u52a0 1\u4e2aMSS\uff08\u6700\u5927\u62a5\u6587\u6bb5\u957f\u5ea6\uff09  </li> <li> <p>\u5b9e\u9645\u6548\u679c\uff1a\u6bcfRTT\uff08\u5f80\u8fd4\u65f6\u95f4\uff09cwnd\u7ffb\u500d \u4f8b\uff1a\u521d\u59cbcwnd=2 \u2192 \u6536\u52302\u4e2aACK \u2192 cwnd=4 \u2192 \u53d1\u90014\u4e2a\u62a5\u6587\u6bb5</p> </li> <li> <p>\u9000\u51fa\u6162\u542f\u52a8\u7684\u9608\u503c </p> </li> <li>\u6162\u542f\u52a8\u9608\u503c\uff08ssthresh\uff09\uff1a\u521d\u59cb\u503c\u901a\u5e38\u4e3a\u63a5\u6536\u65b9\u901a\u544a\u7a97\u53e3\u5927\u5c0f  </li> <li> <p>\u5f53<code>cwnd &gt;= ssthresh</code>\u65f6\uff0c\u5207\u6362\u81f3\u62e5\u585e\u907f\u514d\u9636\u6bb5\uff08\u7ebf\u6027\u589e\u957f\uff09</p> </li> <li> <p>\u4e0e\u5feb\u901f\u91cd\u4f20/\u6062\u590d\u7684\u4ea4\u4e92 </p> </li> <li>\u53d1\u751f\u4e09\u6b21\u91cd\u590dACK\u65f6\uff1a  <ul> <li>\u4e0d\u91cd\u7f6ecwnd\u4e3a1\uff08\u533a\u522b\u4e8e\u8d85\u65f6\u4e22\u5305\uff09  </li> <li>\u6267\u884c\u5feb\u901f\u6062\u590d\uff1a<code>cwnd = cwnd/2 + 3</code>\uff0c\u76f4\u63a5\u8fdb\u5165\u62e5\u585e\u907f\u514d \uff08RFC 6582\u6539\u8fdb\u7b97\u6cd5\uff09</li> </ul> </li> </ol>"},{"location":"2025/15Apple_SRE_prp/#cwnd2-mss","title":"\u5b9e\u4f8b\u6f14\u7b97\uff08\u521d\u59cbcwnd=2 MSS\uff09","text":"RTT\u8f6e\u6b21 \u53d1\u9001\u91cf \u6536\u5230ACK\u91cf cwnd\u53d8\u5316 \u4e0b\u4e00\u8f6e\u53d1\u9001\u91cf 1 2 2 2+2=4 4 2 4 4 4+4=8 8 3 8 8 8+8=16 16 4 16 16 16+16=32 32 ... ... ... \u6307\u6570\u589e\u957f ... <p>\u6ce8\uff1a\u73b0\u4ee3Linux\u9ed8\u8ba4\u521d\u59cbcwnd=10\uff08RFC 6928\uff09\uff0c\u52a0\u901f\u9ad8\u901f\u7f51\u7edc\u4f20\u8f93</p>"},{"location":"2025/15Apple_SRE_prp/#_15","title":"\u8bbe\u8ba1\u54f2\u5b66","text":"<ul> <li>\u8c28\u614e\u542f\u52a8\uff1a\u65b0\u8fde\u63a5\u4ee5\u6700\u5c0f\u8d1f\u8f7d\u8bd5\u63a2\u7f51\u7edc\u72b6\u6001  </li> <li>\u6307\u6570\u63a2\u6d4b\uff1a\u5feb\u901f\u903c\u8fd1\u4f46\u4e0d\u7a81\u7834\u5f53\u524d\u7f51\u7edc\u5bb9\u91cf\u4e0a\u9650  </li> <li>\u62e5\u585e\u4f18\u5148\uff1a\u4efb\u4f55\u4e22\u5305\u4e8b\u4ef6\u89c6\u4e3a\u7f51\u7edc\u8fc7\u8f7d\u7684\u7edd\u5bf9\u4fe1\u53f7  </li> <li>\u516c\u5e73\u6027\uff1a\u901a\u8fc7ssthresh\u8bb0\u5f55\u5386\u53f2\u62e5\u585e\u70b9\uff0c\u907f\u514d\u91cd\u590d\u62e5\u585e  </li> </ul> <p>\u6b64\u673a\u5236\u4e0e\u62e5\u585e\u907f\u514d\uff08AIMD\uff09\u3001\u5feb\u901f\u91cd\u4f20/\u6062\u590d\u5171\u540c\u6784\u6210TCP\u62e5\u585e\u63a7\u5236\u6838\u5fc3\u6846\u67b6\uff08RFC 5681/5682/6582\uff09\u3002</p> <p>\u4ee5\u4e0b\u662fTCP\u8fde\u63a5\u72b6\u6001\u7684\u5b8c\u6574\u5217\u8868\u53ca\u8bf4\u660e\uff08\u4f9d\u636eRFC 793\u89c4\u8303\uff09\uff1a</p>"},{"location":"2025/15Apple_SRE_prp/#tcp_1","title":"TCP\u8fde\u63a5\u72b6\u6001\u8be6\u89e3","text":"\u72b6\u6001 \u89e6\u53d1\u6761\u4ef6 \u5178\u578b\u573a\u666f \u534f\u8bae\u884c\u4e3a 1. LISTEN \u670d\u52a1\u5668\u8c03\u7528<code>listen()</code> Web\u670d\u52a1\u5668\uff08HTTP:80\uff09 \u7b49\u5f85SYN\u8bf7\u6c42 2. SYN-SENT \u5ba2\u6237\u7aef\u53d1\u9001SYN\u540e \u8c03\u7528<code>connect()</code>\u65f6 \u7b49\u5f85SYN-ACK\u54cd\u5e94 3. SYN-RECEIVED \u670d\u52a1\u5668\u6536\u5230SYN\u5e76\u56de\u590dSYN-ACK\u540e \u9ad8\u5e76\u53d1\u8fde\u63a5\u65f6 \u7b49\u5f85\u5ba2\u6237\u7aef\u6700\u7ec8ACK 4. ESTABLISHED \u5b8c\u6210\u4e09\u6b21\u63e1\u624b\u540e \u6570\u636e\u4f20\u8f93\u9636\u6bb5 \u6b63\u5e38\u6536\u53d1\u6570\u636e 5. FIN-WAIT-1 \u4e3b\u52a8\u5173\u95ed\u65b9\u53d1\u9001FIN \u5ba2\u6237\u7aef\u8c03\u7528<code>close()</code> \u7b49\u5f85ACK\u6216\u5bf9\u65b9FIN 6. FIN-WAIT-2 \u6536\u5230FIN\u7684ACK\u540e \u534a\u5173\u95ed\u72b6\u6001 \u7b49\u5f85\u5bf9\u65b9FIN 7. CLOSE-WAIT \u88ab\u52a8\u5173\u95ed\u65b9\u6536\u5230FIN \u670d\u52a1\u5668\u5904\u7406\u5173\u95ed\u8bf7\u6c42 \u7b49\u5f85\u5e94\u7528\u5c42\u8c03\u7528<code>close()</code> 8. LAST-ACK \u88ab\u52a8\u5173\u95ed\u65b9\u53d1\u9001FIN\u540e \u5e94\u7528\u5c42\u5173\u95ed\u5b8c\u6210\u65f6 \u7b49\u5f85\u6700\u7ec8ACK 9. TIME-WAIT \u4e3b\u52a8\u5173\u95ed\u65b9\u6536\u5230\u6700\u7ec8ACK\u540e \u5ba2\u6237\u7aef\u7b49\u5f852MSL \u786e\u4fdd\u5bf9\u65b9\u6536\u5230ACK 10. CLOSED \u8fde\u63a5\u5b8c\u5168\u7ec8\u6b62 \u8d44\u6e90\u91ca\u653e\u540e \u65e0\u72b6\u6001\uff08\u865a\u62df\u72b6\u6001\uff09"},{"location":"2025/15Apple_SRE_prp/#_16","title":"\u5173\u952e\u72b6\u6001\u8f6c\u6362\u56fe","text":"<pre><code>graph LR\n    CLOSED --&gt;|\u4e3b\u52a8\u6253\u5f00| SYN-SENT\n    CLOSED --&gt;|\u88ab\u52a8\u6253\u5f00| LISTEN\n    SYN-SENT --&gt;|\u6536SYN+ACK\u53d1ACK| ESTABLISHED\n    LISTEN --&gt;|\u6536SYN\u53d1SYN+ACK| SYN-RECEIVED\n    SYN-RECEIVED --&gt;|\u6536ACK| ESTABLISHED\n    ESTABLISHED --&gt;|\u4e3b\u52a8\u5173\u95ed\u53d1FIN| FIN-WAIT-1\n    FIN-WAIT-1 --&gt;|\u6536ACK| FIN-WAIT-2\n    FIN-WAIT-2 --&gt;|\u6536FIN\u53d1ACK| TIME-WAIT\n    ESTABLISHED --&gt;|\u6536FIN\u53d1ACK| CLOSE-WAIT\n    CLOSE-WAIT --&gt;|\u53d1FIN| LAST-ACK\n    LAST-ACK --&gt;|\u6536ACK| CLOSED\n    TIME-WAIT --&gt;|2MSL\u8d85\u65f6| CLOSED\n</code></pre>"},{"location":"2025/15Apple_SRE_prp/#_17","title":"\u7279\u6b8a\u72b6\u6001\u8bf4\u660e","text":"<ol> <li>TIME-WAIT\uff082MSL\u7b49\u5f85\uff09 </li> <li>\u76ee\u7684\uff1a\u786e\u4fdd\u6700\u540e\u4e00\u4e2aACK\u5230\u8fbe + \u8ba9\u65e7\u62a5\u6587\u6bb5\u8fc7\u671f  </li> <li>\u65f6\u957f\uff1a2 \u00d7 \u6700\u5927\u62a5\u6587\u6bb5\u751f\u5b58\u65f6\u95f4\uff08\u901a\u5e3860-120\u79d2\uff09  </li> <li> <p>\u7cfb\u7edf\u53c2\u6570\uff1a<code>net.ipv4.tcp_fin_timeout</code>\uff08Linux\u53ef\u8c03\uff09</p> </li> <li> <p>SYN-RECEIVED </p> </li> <li>\u5e38\u89c1\u4e8eSYN Flood\u653b\u51fb\uff1a\u6076\u610f\u5ba2\u6237\u7aef\u4e0d\u56de\u590dACK  </li> <li> <p>\u9632\u62a4\u673a\u5236\uff1aSYN Cookies\uff08<code>net.ipv4.tcp_syncookies=1</code>\uff09</p> </li> <li> <p>CLOSE-WAIT </p> </li> <li>\u98ce\u9669\u70b9\uff1a\u82e5\u5e94\u7528\u672a\u8c03\u7528<code>close()</code>\uff0c\u5bfc\u81f4\u8fde\u63a5\u6c38\u4e45\u6ede\u7559  </li> <li>\u68c0\u6d4b\u547d\u4ee4\uff1a<code>netstat -ant | grep CLOSE_WAIT</code></li> </ol>"},{"location":"2025/15Apple_SRE_prp/#_18","title":"\u72b6\u6001\u89c2\u5bdf\u5de5\u5177","text":"<pre><code># Linux\u67e5\u770bTCP\u72b6\u6001\u7edf\u8ba1\nss -ant | awk 'NR&gt;1 {print $1}' | sort | uniq -c\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n  10 ESTAB\n   2 LISTEN\n   3 TIME-WAIT\n   1 SYN-RECV\n</code></pre> <p>\u6ce8\uff1a\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf\uff08\u5982Linux 3.7+\uff09\u65b0\u589e\u72b6\u6001\uff1a - SYN-SENT-RECOVERY\uff08Fast Open\u8fde\u63a5\u6062\u590d\uff09 - TCP_REPAIR\uff08\u5185\u6838\u7ea7\u8fde\u63a5\u4fee\u590d\u6a21\u5f0f\uff09</p> <p>\u4ee5\u4e0b\u662fTCP\u4e0eUDP\u7684\u6838\u5fc3\u533a\u522b\u5bf9\u6bd4\uff0c\u6db5\u76d6\u534f\u8bae\u672c\u8d28\u3001\u4f20\u8f93\u7279\u6027\u53ca\u9002\u7528\u573a\u666f\uff1a</p>"},{"location":"2025/15Apple_SRE_prp/#_19","title":"\u6838\u5fc3\u5dee\u5f02\u5168\u666f\u56fe","text":"\u7279\u6027 TCP (\u4f20\u8f93\u63a7\u5236\u534f\u8bae) UDP (\u7528\u6237\u6570\u636e\u62a5\u534f\u8bae) \u53ef\u9760\u6027 \u2705 \u53ef\u9760\u4f20\u8f93 (ACK\u786e\u8ba4 + \u91cd\u4f20\u673a\u5236) \u274c \u4e0d\u53ef\u9760 (\u65e0\u786e\u8ba4/\u91cd\u4f20) \u6570\u636e\u987a\u5e8f \u2705 \u4e25\u683c\u4fdd\u5e8f (\u5e8f\u5217\u53f7 + \u91cd\u7ec4\u673a\u5236) \u274c \u4e0d\u4fdd\u8bc1\u987a\u5e8f \u8fde\u63a5\u6a21\u5f0f \u2696\ufe0f \u9762\u5411\u8fde\u63a5 (\u4e09\u6b21\u63e1\u624b/\u56db\u6b21\u6325\u624b) \ud83d\ude80 \u65e0\u8fde\u63a5 (\u76f4\u63a5\u53d1\u9001\u6570\u636e\u62a5) \u534f\u8bae\u5f00\u9500 \ud83d\udd34 \u9ad8\u5f00\u9500 (20-60\u5b57\u8282\u5934\u90e8 + \u6d41\u63a7/\u62e5\u585e\u63a7\u5236) \ud83d\udfe2 \u6781\u4f4e\u5f00\u9500 (\u56fa\u5b9a8\u5b57\u8282\u5934\u90e8) \u4f20\u8f93\u6a21\u5f0f \ud83d\udcdc \u5b57\u8282\u6d41 (\u65e0\u8fb9\u754c\uff0c\u9700\u5e94\u7528\u5c42\u62c6\u5305) \u2709\ufe0f \u6570\u636e\u62a5 (\u4fdd\u7559\u53d1\u9001\u8fb9\u754c) \u901f\u5ea6\u6027\u80fd \u23f1\ufe0f \u8f83\u6162 (\u63e1\u624b/\u786e\u8ba4\u5ef6\u8fdf) \u26a1 \u6781\u5feb (\u65e0\u9700\u5efa\u7acb\u8fde\u63a5) \u62e5\u585e\u63a7\u5236 \ud83d\udea6 \u5b8c\u5907\u673a\u5236 (\u6162\u542f\u52a8/\u62e5\u585e\u907f\u514d/\u5feb\u901f\u91cd\u4f20) \ud83d\udeab \u65e0\u63a7\u5236 (\u53ef\u80fd\u52a0\u5267\u7f51\u7edc\u62e5\u585e) \u5e94\u7528\u573a\u666f \ud83c\udf10 Web/\u90ae\u4ef6/\u6587\u4ef6\u4f20\u8f93 (HTTP/SMTP/FTP) \ud83c\udfa5 \u5b9e\u65f6\u5e94\u7528 (\u89c6\u9891\u6d41/DNS/VoIP)"},{"location":"2025/15Apple_SRE_prp/#_20","title":"\u5173\u952e\u6280\u672f\u7ec6\u8282\u89e3\u6790","text":""},{"location":"2025/15Apple_SRE_prp/#1_1","title":"1. \u5934\u90e8\u7ed3\u6784\u5bf9\u6bd4","text":"<pre><code>! TCP\u5934\u90e8 (\u6700\u5c0f20\u5b57\u8282)\n| \u6e90\u7aef\u53e3(2) | \u76ee\u7684\u7aef\u53e3(2) | \u5e8f\u5217\u53f7(4) | \u786e\u8ba4\u53f7(4) |\n| \u6570\u636e\u504f\u79fb(4) | \u4fdd\u7559(6) | \u63a7\u5236\u4f4d(6) | \u7a97\u53e3\u5927\u5c0f(2) |\n| \u6821\u9a8c\u548c(2) | \u7d27\u6025\u6307\u9488(2) | [\u9009\u9879(0-40)] |\n\n! UDP\u5934\u90e8 (\u56fa\u5b9a8\u5b57\u8282)\n| \u6e90\u7aef\u53e3(2) | \u76ee\u7684\u7aef\u53e3(2) | \u957f\u5ea6(2) | \u6821\u9a8c\u548c(2) |\n</code></pre> <p>\ud83d\udccc \u5173\u952e\u533a\u522b\uff1aTCP\u5934\u90e8\u591a\u51fa\u5e8f\u5217\u53f7/\u786e\u8ba4\u53f7/\u63a7\u5236\u4f4d\u7b49\u5b57\u6bb5\uff0c\u4e3a\u53ef\u9760\u6027\u63d0\u4f9b\u652f\u6491</p>"},{"location":"2025/15Apple_SRE_prp/#2_1","title":"2. \u53ef\u9760\u6027\u673a\u5236\u5b9e\u73b0","text":"<ul> <li>TCP\u53ef\u9760\u6027\u4e09\u89d2\uff1a   <code>mermaid   graph LR       A[\u6570\u636e\u5206\u7247] --&gt; B[\u5e8f\u5217\u53f7\u6807\u8bb0]       B --&gt; C[\u63a5\u6536\u65b9ACK\u786e\u8ba4]       C --&gt;|\u4e22\u5305\u68c0\u6d4b| D[\u8d85\u65f6\u91cd\u4f20]       D --&gt;|\u4e71\u5e8f| E[\u63a5\u6536\u7aef\u91cd\u7ec4]</code></li> <li>UDP\u65e0\u4fdd\u969c\uff1a   \u5e94\u7528\u9700\u81ea\u884c\u5b9e\u73b0\u53ef\u9760\u6027\uff08\u5982QUIC\u534f\u8bae\u5728UDP\u4e0a\u6784\u5efa\u91cd\u4f20\u903b\u8f91\uff09</li> </ul>"},{"location":"2025/15Apple_SRE_prp/#3_2","title":"3. \u4f20\u8f93\u6a21\u5f0f\u672c\u8d28\u5dee\u5f02","text":"TCP\u6d41\u4f20\u8f93 UDP\u6570\u636e\u62a5 \u53d1\u9001\u7aef\uff1a<code>write(\"AAAAABBBBB\")</code> \u53d1\u9001\u7aef\uff1a<code>sendto(\"AAAAA\")</code> + <code>sendto(\"BBBBB\")</code> \u63a5\u6536\u7aef\u53ef\u80fd\u6536\u5230\uff1a<code>\"AAAAABBBBB\"</code> \u6216 \u63a5\u6536\u7aef\u6536\u5230\uff1a<code>\"AAAAA\"</code> \u548c <code>\"BBBBB\"</code> \u72ec\u7acb\u5305 <code>\"AAA\"</code> + <code>\"AABBBBB\"</code>\uff08\u9700\u91cd\u7ec4\uff09 \uff08\u59cb\u7ec8\u4fdd\u7559\u53d1\u9001\u8fb9\u754c\uff09"},{"location":"2025/15Apple_SRE_prp/#_21","title":"\u5178\u578b\u5e94\u7528\u573a\u666f","text":"\u534f\u8bae \u9002\u7528\u573a\u666f \u4ee3\u8868\u5e94\u7528 TCP \u6570\u636e\u5b8c\u6574\u6027 &gt; \u5b9e\u65f6\u6027\u7684\u573a\u666f \u2714\ufe0f \u7f51\u9875\u6d4f\u89c8 (HTTPS) \u2714\ufe0f \u6587\u4ef6\u4f20\u8f93 (FTP/SFTP) \u2714\ufe0f \u7535\u5b50\u90ae\u4ef6 (SMTP/IMAP) UDP \u5b9e\u65f6\u6027 &gt; \u5b8c\u6574\u6027\u7684\u573a\u666f \u2714\ufe0f \u89c6\u9891\u4f1a\u8bae (WebRTC) \u2714\ufe0f \u57df\u540d\u89e3\u6790 (DNS) \u2714\ufe0f \u7269\u8054\u7f51\u4f20\u611f\u6570\u636e (MQTT-SN) \u2714\ufe0f \u591a\u4eba\u6e38\u620f (\u5b9e\u65f6\u4f4d\u7f6e\u540c\u6b65)"},{"location":"2025/15Apple_SRE_prp/#_22","title":"\u534f\u8bae\u9009\u62e9\u51b3\u7b56\u6811","text":"<pre><code>graph TD\n    A[\u9700\u53ef\u9760\u4f20\u8f93\uff1f] --&gt;|\u662f| B[\u9700\u4e25\u683c\u987a\u5e8f\uff1f] --&gt;|\u662f| C[\u9009\u62e9TCP]\n    A --&gt;|\u5426| D[\u4f4e\u5ef6\u8fdf\u4f18\u5148\uff1f] --&gt;|\u662f| E[\u9009\u62e9UDP]\n    B --&gt;|\u5426| F[\u81ea\u5b9a\u4e49\u53ef\u9760\u6027\uff1f] --&gt;|\u662f| E\n    D --&gt;|\u5426| C\n    F --&gt;|\u5426| C\n</code></pre> <p>\ud83d\udca1 \u8bbe\u8ba1\u542f\u793a\uff1a\u73b0\u4ee3\u534f\u8bae\u5e38\u878d\u5408\u4e24\u8005\u4f18\u52bf\uff08\u5982QUIC=UDP+TLS+\u91cd\u4f20\uff09\uff0c\u5728\u4fdd\u6301\u901f\u5ea6\u7684\u540c\u65f6\u63d0\u5347\u53ef\u9760\u6027\u3002</p>"},{"location":"2025/15Apple_SRE_prp/#section-1-postgresql-basics","title":"Section 1: PostgreSQL Basics","text":""},{"location":"2025/15Apple_SRE_prp/#what-are-the-key-features-of-postgresql","title":"What are the key features of PostgreSQL?","text":"<p>ACID compliance, MVCC, support for JSON/BSON, full-text search, custom data types, indexing (GIN, GiST, BRIN), replication, partitioning, logical and physical backups.</p>"},{"location":"2025/15Apple_SRE_prp/#what-are-the-different-data-types-supported-in-postgresql","title":"What are the different data types supported in PostgreSQL?","text":"<p>Numeric, text, date/time, geometric, JSON/JSONB, UUID, arrays, range types, composite types, custom types.</p>"},{"location":"2025/15Apple_SRE_prp/#how-does-mvcc-multi-version-concurrency-control-work-in-postgresql","title":"How does MVCC (Multi-Version Concurrency Control) work in PostgreSQL?","text":"<p>Each transaction sees a snapshot of the database at a certain point in time. </p> <p>Changes are written as new versions, and vacuuming cleans up old versions.</p>"},{"location":"2025/15Apple_SRE_prp/#section-2-administration-and-performance","title":"Section 2: Administration and Performance","text":""},{"location":"2025/15Apple_SRE_prp/#how-do-you-monitor-postgresql-performance","title":"How do you monitor PostgreSQL performance?","text":"<p>Using <code>pg_stat_activity</code>, <code>pg_stat_user_tables</code>, <code>auto_explain</code>, <code>pgBadger</code>, and external tools like Prometheus, Grafana.</p>"},{"location":"2025/15Apple_SRE_prp/#what-is-autovacuum-and-why-is-it-important","title":"What is autovacuum and why is it important?","text":"<p>It automatically removes dead tuples to prevent table bloat and maintain performance.</p>"},{"location":"2025/15Apple_SRE_prp/#how-can-you-check-for-table-bloat","title":"How can you check for table bloat?","text":"<p>Using <code>pg_stat_user_tables</code>, <code>pgstattuple,</code> or tools like <code>pg_bloat_check.</code></p>"},{"location":"2025/15Apple_SRE_prp/#how-do-you-tune-postgresql-for-better-performance","title":"How do you tune PostgreSQL for better performance?","text":"<p>Tune <code>shared_buffers</code>, <code>work_mem</code>, <code>maintenance_work_mem</code>, <code>effective_cache_size</code>, and <code>wal_buffers</code>. Also use indexes effectively and vacuum/analyze regularly.</p>"},{"location":"2025/15Apple_SRE_prp/#what-are-wal-files","title":"What are WAL files?","text":"<p>Write-Ahead Logs: ensure durability by writing changes to disk before applying them to data files.</p>"},{"location":"2025/15Apple_SRE_prp/#section-3-backup-and-restore","title":"Section 3: Backup and Restore","text":""},{"location":"2025/15Apple_SRE_prp/#1-what-are-the-types-of-backups-in-postgresql","title":"1 What are the types of backups in PostgreSQL?","text":"<p>SQL dump (<code>pg_dump</code>), file system level, continuous archiving (WAL), and base backup (<code>pg_basebackup)</code>.</p>"},{"location":"2025/15Apple_SRE_prp/#2-how-do-you-take-a-logical-backup-of-a-database","title":"2 How do you take a logical backup of a database?","text":"<p>Using <code>pg_dump</code>or <code>pg_dumpall</code>.</p>"},{"location":"2025/15Apple_SRE_prp/#3-how-do-you-restore-a-postgresql-database-from-a-dump","title":"3 How do you restore a PostgreSQL database from a dump?","text":"<p>Using <code>psql</code> or <code>pg_restore</code>, depending on the format of the backup.</p>"},{"location":"2025/15Apple_SRE_prp/#what-is-pitr-point-in-time-recovery","title":"What is PITR (Point-In-Time Recovery)?","text":"<p>Restoring the database to a specific point in time using base backup + WAL files.</p>"},{"location":"2025/15Apple_SRE_prp/#how-do-you-set-up-continuous-archiving-for-pitr","title":"How do you set up continuous archiving for PITR?","text":"<p>Set <code>archive_mode = on</code>, and define <code>archive_command</code> to copy WAL files to a secure location.</p>"},{"location":"2025/15Apple_SRE_prp/#section-4-replication-and-high-availability","title":"Section 4: Replication and High Availability","text":""},{"location":"2025/15Apple_SRE_prp/#1-what-is-streaming-replication-in-postgresql","title":"1 What is streaming replication in PostgreSQL?","text":"<p>A method where WALs are sent to replicas in real-time over a network connection.</p>"},{"location":"2025/15Apple_SRE_prp/#2-whats-the-difference-between-physical-and-logical-replication","title":"2 What\u2019s the difference between physical and logical replication?","text":"<p>**Physical replicates byte-level changes (base backup + WALs), **</p> <p>logical replicates at the table level using SQL.</p>"},{"location":"2025/15Apple_SRE_prp/#3-how-do-you-set-up-streaming-replication","title":"3 How do you set up streaming replication?","text":"<p>Use <code>pg_basebackup</code> to copy data directory, configure <code>primary_conninfo</code>, and use replication slots.</p>"},{"location":"2025/15Apple_SRE_prp/#4-what-is-a-replication-slot","title":"4 What is a replication slot?","text":"<p>A mechanism to retain WAL files until they\u2019re consumed by a replica, preventing data loss in async replication.</p>"},{"location":"2025/15Apple_SRE_prp/#5-what-is-pg_hbaconf","title":"5 What is <code>pg_hba.conf</code>?","text":"<p>PostgreSQL\u2019s client authentication configuration file.</p>"},{"location":"2025/15Apple_SRE_prp/#6-how-can-replication-lag-be-monitored","title":"6 How can replication lag be monitored?","text":"<p>A replica acts as a source for another replica.</p>"},{"location":"2025/15Apple_SRE_prp/#7-can-you-replicate-only-certain-tables","title":"7 Can you replicate only certain tables?","text":"<p>Yes, using logical replication and publication/subscription model.</p>"},{"location":"2025/15Apple_SRE_prp/#8-how-do-you-failover-to-a-standby-server","title":"8 How do you failover to a standby server?","text":"<p>Promote the standby using <code>pg_ctl promote</code>, or configure tools like Patroni, repmgr, or Pacemaker.</p>"},{"location":"2025/15Apple_SRE_prp/#9-what-is-repmgr","title":"9 What is repmgr?","text":"<p>A tool for PostgreSQL replication management including automatic failover, monitoring, and administration.</p>"},{"location":"2025/15Apple_SRE_prp/#section-5-multi-data-center-and-distributed-setups","title":"Section 5: Multi-Data Center and Distributed Setups","text":""},{"location":"2025/15Apple_SRE_prp/#1-how-can-postgresql-be-deployed-across-multiple-data-centers","title":"1 How can PostgreSQL be deployed across multiple data centers?","text":"<p>Use asynchronous replication with proper network latency handling. Tools like BDR, Citus, or Bucardo can be used for multi-master or sharded setups.</p>"},{"location":"2025/15Apple_SRE_prp/#2-what-are-the-challenges-with-multi-dc-replication","title":"2 What are the challenges with multi-DC replication?","text":"<p>Network latency, data consistency, failover coordination, and conflict resolution.</p>"},{"location":"2025/15Apple_SRE_prp/#3-what-is-bdr-bi-directional-replication","title":"3 What is BDR (Bi-Directional Replication)?","text":"<p>An extension for PostgreSQL enabling multi-master replication.</p>"},{"location":"2025/15Apple_SRE_prp/#4-how-do-you-deal-with-replication-conflicts","title":"4 How do you deal with replication conflicts?","text":"<p>In logical replication or BDR, conflict resolution rules need to be defined or conflict-free schema must be designed.</p>"},{"location":"2025/15Apple_SRE_prp/#5-how-can-you-ensure-high-availability-in-a-distributed-setup","title":"5 How can you ensure high availability in a distributed setup?","text":"<p>Use a combination of replication, monitoring, failover orchestration, and DNS or proxy-based redirection.</p>"},{"location":"2025/15Apple_SRE_prp/#section-6-security-and-access-control","title":"Section 6: Security and Access Control","text":""},{"location":"2025/15Apple_SRE_prp/#1-how-do-you-manage-user-roles-in-postgresql","title":"1 How do you manage user roles in PostgreSQL?","text":"<p>Using CREATE ROLE, GRANT, REVOKE.</p>"},{"location":"2025/15Apple_SRE_prp/#2-how-does-postgresql-authenticate-users","title":"2 How does PostgreSQL authenticate users?","text":"<p>Using <code>pg_hba.conf</code> with methods like md5, scram-sha-256, peer, trust, or certificate-based.</p>"},{"location":"2025/15Apple_SRE_prp/#3-what-is-row-level-security-rls","title":"3 What is row-level security (RLS)?","text":"<p>Allows control of row access per user using <code>CREATE POLICY</code>.</p>"},{"location":"2025/15Apple_SRE_prp/#4-how-do-you-enable-ssl-connections","title":"4 How do you enable SSL connections?","text":"<p>Configure <code>ssl = on</code>, and provide <code>ssl_cert_file</code> and <code>ssl_key_file</code></p>"},{"location":"2025/15Apple_SRE_prp/#4-how-can-you-audit-postgresql-activity","title":"4 How can you audit PostgreSQL activity?","text":"<p>Using logging (<code>log_statement</code>, <code>log_duration</code>) or extensions like pgAudit.</p>"},{"location":"2025/15Apple_SRE_prp/#section-7-troubleshooting-and-maintenance","title":"Section 7: Troubleshooting and Maintenance","text":""},{"location":"2025/15Apple_SRE_prp/#1-how-do-you-identify-slow-queries","title":"1 How do you identify slow queries?","text":"<p>Use <code>pg_stat_statements</code>, <code>EXPLAIN ANALYZE</code>, <code>auto_explain</code>, or log-based tools.</p>"},{"location":"2025/15Apple_SRE_prp/#2-what-does-vacuum-do","title":"2 What does VACUUM do?","text":"<p>Cleans up dead tuples, frees space. ANALYZE updates statistics for query planning.</p>"},{"location":"2025/15Apple_SRE_prp/#3-what-is-the-difference-between-vacuum-full-and-regular-vacuum","title":"3 What is the difference between VACUUM FULL and regular VACUUM?","text":"<p><code>VACUUM FULL</code> rewrites the table and reclaims disk space; </p> <p>it locks the table.</p>"},{"location":"2025/15Apple_SRE_prp/#4-what-causes-deadlocks-and-how-do-you-prevent-them","title":"4 What causes deadlocks and how do you prevent them?","text":"<p>Two or more transactions waiting on each other. Prevent via consistent locking order and short transactions.</p>"},{"location":"2025/15Apple_SRE_prp/#5-how-do-you-check-current-locks-in-postgresql","title":"5 How do you check current locks in PostgreSQL?","text":"<p>Query <code>pg_locks</code> and join with <code>pg_stat_activity</code>.</p>"},{"location":"2025/15Apple_SRE_prp/#section-8-advanced-topics","title":"Section 8: Advanced Topics","text":""},{"location":"2025/15Apple_SRE_prp/#1-how-does-postgresql-handle-parallel-query-execution","title":"1 How does PostgreSQL handle parallel query execution?","text":"<p>It uses multiple workers for suitable queries based on planner decisions.</p>"},{"location":"2025/15Apple_SRE_prp/#2-what-is-partitioning-in-postgresql","title":"2 What is partitioning in PostgreSQL?","text":"<p>Splitting a large table into smaller pieces using range, list, or hash partitioning.</p>"},{"location":"2025/15Apple_SRE_prp/#3-how-do-you-analyze-and-optimize-a-query","title":"3 How do you analyze and optimize a query?","text":"<p>Use <code>EXPLAIN</code> and <code>EXPLAIN ANALYZE</code>, check indexes, and consider rewriting.</p>"},{"location":"2025/15Apple_SRE_prp/#4-what-are-ctes-and-how-are-they-useful","title":"4 What are CTEs and how are they useful?","text":"<p>Common Table Expressions; useful for readable subqueries and recursive queries.</p> <p>How do you upgrade PostgreSQL?</p> <p>Use <code>pg_upgrade</code> for in-place upgrades or dump/restore method.</p>"},{"location":"2025/15Apple_SRE_prp/#5-how-do-you-upgrade-postgresql","title":"5 How do you upgrade PostgreSQL?","text":"<p>Use <code>pg_upgrade</code> for in-place upgrades or dump/restore method.</p>"},{"location":"2025/15Apple_SRE_prp/#postgresql-sre-focus","title":"\ud83d\udee0\ufe0f PostgreSQL (SRE focus)","text":""},{"location":"2025/15Apple_SRE_prp/#1-how-would-you-design-a-high-availability-postgresql-cluster","title":"1 How would you design a high-availability PostgreSQL cluster?","text":"<p>Explain primary\u2013standby streaming replication, replication slots, synchronous vs asynchronous modes, and automatic failover tools like repmgr, Patroni, or custom automation.</p>"},{"location":"2025/15Apple_SRE_prp/#2-how-do-you-monitor-and-mitigate-replication-lag","title":"2 How do you monitor and mitigate replication lag?","text":"<p>Discuss metrics (<code>pg_stat_replication</code> \u2192 <code>write_lag</code>, <code>replay_lag</code>), alert thresholds, connection tuning, network latency issues between data centers.</p>"},{"location":"2025/15Apple_SRE_prp/#3-explain-how-point-in-time-recovery-pitr-works-in-multi-dc-setups","title":"3 Explain how Point-in-Time Recovery (PITR) works in multi-DC setups.","text":"<p>Base backup + WAL archiving via <code>archive_command</code>, restoring to specific timestamp, network considerations.</p>"},{"location":"2025/15Apple_SRE_prp/#4-how-do-you-handle-schema-changes-eg-adding-columns-or-indexes-on-a-live-db-without-disruption","title":"4 How do you handle schema changes (e.g. adding columns or indexes) on a live DB without disruption?","text":"<p>Use <code>ALTER TABLE ... ADD COLUMN</code> (non-blocking), <code>CREATE INDEX CONCURRENTLY</code>, rolling updates across replicas.</p>"},{"location":"2025/15Apple_SRE_prp/#5-what-strategies-do-you-use-to-prevent-tableindex-bloat","title":"5 What strategies do you use to prevent table/index bloat?","text":"<p>Autovacuum tuning, manual vacuum/analyze runs, monitoring via <code>pg_stat_user_tables</code>, tools like <code>pg_bloat_check</code>.</p>"},{"location":"2025/15Apple_SRE_prp/#6-how-would-you-troubleshoot-a-slow-query-in-production","title":"6 How would you troubleshoot a slow query in production?","text":"<p>Use <code>EXPLAIN ANALYZE</code>, <code>pg_stat_statements</code>, <code>indexing considerations</code>, I/O waits, planner misestimates; suggest logging and analysis strategies.</p>"},{"location":"2025/15Apple_SRE_prp/#7-describe-your-backup-and-disaster-recovery-process","title":"7 Describe your backup and disaster recovery process.","text":"<p>Logical (<code>pg_dump</code>), physical (<code>pg_basebackup</code>), WAL archiving, cross-DC backups, scripts for restore, DR drills.</p>"},{"location":"2025/15Apple_SRE_prp/#8-explain-logical-replication-and-its-value-for-partial-shard-or-multi-schema-setups","title":"8 Explain logical replication and its value for partial-shard or multi-schema setups.","text":"<p>Publications/subscriptions, filtering tables, schema sync implications, use of pglogical or built-in logical replication.</p>"},{"location":"2025/15Apple_SRE_prp/#9-how-do-you-upgrade-postgresql-with-minimal-downtime","title":"9 How do you upgrade PostgreSQL with minimal downtime?","text":"<p>Use <code>pg_upgrade --link</code>, logical upgrade via replication, blue-green deployment using replicas.</p>"},{"location":"2025/15Apple_SRE_prp/#10-what-postgresql-metrics-do-you-monitor-in-prometheusgrafana","title":"10 What PostgreSQL metrics do you monitor in Prometheus/Grafana?","text":"<p>Replication lag, active connections, locks, long-running queries, index usage, disk I/O, <code>pg_stat_connections</code>, <code>pg_stat_bgwriter</code>.</p>"},{"location":"2025/15Apple_SRE_prp/#http-sre-focus","title":"\ud83c\udf10 HTTP (SRE focus)","text":""},{"location":"2025/15Apple_SRE_prp/#explain-the-http-request-lifecycle-from-dns-lookup-to-response","title":"Explain the HTTP request lifecycle from DNS lookup to response.","text":"<p>DNS resolution, TCP handshake, TLS handshake, HTTP request/response, connection teardown or keep-alive.</p>"},{"location":"2025/15Apple_SRE_prp/#what-http-status-codes-are-crucial-for-sres-and-what-do-they-indicate","title":"What HTTP status codes are crucial for SREs and what do they indicate?","text":"<p>2xx (success), 3xx (redirect loops), 4xx (client errors), 5xx (server errors), what triggers alerts.</p>"},{"location":"2025/15Apple_SRE_prp/#what-are-http-keep-alive-and-connection-pooling","title":"What are HTTP keep-alive and connection pooling?","text":"<p>How reusing TCP/TLS connections reduces latency and resource usage; when to disable keep-alive.</p>"},{"location":"2025/15Apple_SRE_prp/#how-do-you-monitor-http-endpoint-performance","title":"How do you monitor HTTP endpoint performance?","text":"<p>Use APM, synthetic checks, real user monitoring, latency percentiles (p95/p99), error budget tracking.</p>"},{"location":"2025/15Apple_SRE_prp/#explain-http2-benefits-and-potential-sre-concerns","title":"Explain HTTP/2 benefits and potential SRE concerns.","text":"<ul> <li> <p>Multiplexing, header compression, server push; </p> </li> <li> <p>watch out for head-of-line blocking and resource prioritization.</p> </li> </ul>"},{"location":"2025/15Apple_SRE_prp/#how-do-you-debug-an-http-performance-regression","title":"How do you debug an HTTP performance regression?","text":"<p>Use request tracing, distributed tracing, slow response logs, waterfall analysis.</p>"},{"location":"2025/15Apple_SRE_prp/#how-do-rest-and-grpc-compare-from-an-sre-perspective","title":"How do REST and gRPC compare from an SRE perspective?","text":"<ul> <li>REST: human-readable, client overhead; </li> <li>gRPC: binary, HTTP/2, tighter contracts; consider performance, tooling, observability.</li> </ul>"},{"location":"2025/15Apple_SRE_prp/#discuss-retries-and-idempotency-in-http","title":"Discuss retries and idempotency in HTTP.","text":"<p>Use of idempotent methods (GET, PUT), safe retries with backoff, handling non-idempotent requests.</p>"},{"location":"2025/15Apple_SRE_prp/#how-do-you-secure-http-traffic-in-production","title":"How do you secure HTTP traffic in production?","text":"<p>TLS termination, HSTS, certificate rotation, vulnerability scanning, HTTP headers (CSP, X-Frame, etc.).</p>"},{"location":"2025/15Apple_SRE_prp/#what-kinds-of-http-level-attacks-do-sres-protect-against","title":"What kinds of HTTP-level attacks do SREs protect against?","text":"<p>DDoS, rate-limiting, throttling, circuit breakers, WAFs, anomaly detection.</p>"},{"location":"2025/15Apple_SRE_prp/#tcpip-sre-focus","title":"\ud83c\udf0e TCP/IP (SRE focus)","text":""},{"location":"2025/15Apple_SRE_prp/#1-describe-the-tcp-three-way-handshake-and-teardown","title":"1 Describe the TCP three-way handshake and teardown.","text":"<ul> <li>SYN, SYN-ACK, ACK; </li> <li>FIN sequence; </li> <li>connection states (<code>TIME_WAIT</code>, <code>CLOSE_WAIT</code>) .</li> </ul>"},{"location":"2025/15Apple_SRE_prp/#2-explain-tcp-vs-udp-and-their-use-cases-in-system-design","title":"2 Explain TCP vs UDP and their use cases in system design.","text":"<p>TCP: reliable, ordered; </p> <p>UDP: low-latency, no guarantee \u2014 use in streaming, metrics, etc. </p>"},{"location":"2025/15Apple_SRE_prp/#3-how-do-you-identify-and-debug-packet-loss-and-network-latency","title":"3 How do you identify and debug packet loss and network latency?","text":"<p>Tools: ping, traceroute, mtr, tcpdump, Wireshark; check retransmissions and RTT variations.</p>"},{"location":"2025/15Apple_SRE_prp/#4-explain-socket-states-and-how-theyre-used-in-troubleshooting","title":"4 Explain socket states and how they\u2019re used in troubleshooting.","text":"<p>ESTABLISHED, LISTEN, <code>CLOSE_WAIT</code>, <code>TIME_WAIT</code>; diagnose leaks or too many open connections.</p>"},{"location":"2025/15Apple_SRE_prp/#5-what-is-a-tcp-port-how-are-ports-managed-and-what-causes-port-exhaustion","title":"5 What is a TCP port, how are ports managed, and what causes port exhaustion?","text":"<p>Ephemeral ports, TCP/IP stack limits, connection reuse, issues in high-traffic services.</p>"},{"location":"2025/15Apple_SRE_prp/#6-how-does-nat-snatdnat-work-in-data-center-networks","title":"6 How does NAT (SNAT/DNAT) work in data center networks?","text":"<ul> <li>SNAT: source translation outbound; </li> <li>DNAT: inbound redirection \u2014 used in load balancers or firewall rules. </li> </ul>"},{"location":"2025/15Apple_SRE_prp/#7-what-is-the-osi-model-where-does-tcpip-fit-and-which-layers-are-sres-responsible-for","title":"7 What is the OSI model? Where does TCP/IP fit, and which layers are SREs responsible for?","text":"<p>IP layer (~3), TCP/UDP (~4), HTTP/AWS (~7); SREs often work across layers 3\u20137 for reliability.</p>"},{"location":"2025/15Apple_SRE_prp/#8-how-do-you-use-netstat-ss-and-ip-for-diagnosing-network-issues","title":"8 How do you use netstat, ss, and ip for diagnosing network issues?","text":"<p>Viewing socket states, interface routes, NAT rules, bandwidth usage, NAT/SNAT.</p>"},{"location":"2025/15Apple_SRE_prp/#9-how-do-you-monitor-network-traffic-in-kubernetes-or-containers","title":"9 How do you monitor network traffic in Kubernetes or containers?","text":"<p>CNI plugins, proxies, service mesh, tools like cilium, calico, conntrack, ebpf.</p>"},{"location":"2025/15Apple_SRE_prp/#how-does-the-pxe-boot-process-work","title":"How does the PXE boot process work?","text":"<p>The PXE (Preboot eXecution Environment) boot process allows a computer to boot from a network server instead of local storage (e.g., HDD/SSD). Here\u2019s a step-by-step breakdown:</p> <ol> <li>PXE-Enabled Client: NIC with PXE firmware (part of UEFI/BIOS).</li> <li>DHCP Server: Assigns IP addresses and directs clients to the TFTP server.</li> <li>TFTP Server: Hosts boot files (e.g., bootloader, kernel).</li> <li>Boot Server: Optional; serves larger files (e.g., OS images) via HTTP, NFS, or SMB.</li> </ol>"},{"location":"2025/1Linux/","title":"1 \u5178\u578bLinux\u9762\u8bd5\u9898 (Greg, wget, curl\uff0cVim)","text":""},{"location":"2025/1Linux/#1","title":"1 \u5982\u4f55\u67e5\u770b\u7cfb\u7edf\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff1f","text":"<pre><code>top             # \u5b9e\u65f6\u663e\u793a\u7cfb\u7edf\u8fd0\u884c\u4fe1\u606f\uff08CPU\u3001\u5185\u5b58\u3001\u8fdb\u7a0b\uff09\nhtop            # top \u7684\u589e\u5f3a\u7248\uff08\u9700\u5b89\u88c5\uff09\nfree -h         # \u67e5\u770b\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\ndf -h           # \u67e5\u770b\u78c1\u76d8\u4f7f\u7528\u7387\ndu -sh *        # \u5f53\u524d\u76ee\u5f55\u4e0b\u6bcf\u4e2a\u6587\u4ef6\u5939\u5360\u7528\u7a7a\u95f4\nvmstat 1 5      # \u663e\u793a\u865a\u62df\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\niostat -x 1     # I/O \u8d1f\u8f7d\uff08\u9700\u5b89\u88c5 sysstat\uff09\nuptime          # \u67e5\u770b\u7cfb\u7edf\u8fd0\u884c\u65f6\u957f\u548c\u5e73\u5747\u8d1f\u8f7d\n</code></pre>"},{"location":"2025/1Linux/#2","title":"2 \u5982\u4f55\u67e5\u770b\u7aef\u53e3\u662f\u5426\u88ab\u5360\u7528\uff1f","text":"<p>\u9762\u8bd5\u5b98\u76ee\u7684\uff1a\u6392\u67e5\u7aef\u53e3\u51b2\u7a81\u6216\u670d\u52a1\u662f\u5426\u6210\u529f\u542f\u52a8\u3002</p> <pre><code>netstat -tulnp | grep :\u7aef\u53e3\u53f7\nss -tulnp | grep :\u7aef\u53e3\u53f7  # \u63a8\u8350\u4f7f\u7528\uff0c\u6548\u7387\u66f4\u9ad8\nlsof -i:\u7aef\u53e3\u53f7            # \u67e5\u770b\u5177\u4f53\u54ea\u4e2a\u7a0b\u5e8f\u5360\u7528\u7aef\u53e3\n</code></pre>"},{"location":"2025/1Linux/#3","title":"3 \u5982\u4f55\u7ed9\u6587\u4ef6\u6dfb\u52a0\u6267\u884c\u6743\u9650\uff1f","text":"<pre><code>chmod +x script.sh         # \u6dfb\u52a0\u6267\u884c\u6743\u9650\nchmod 755 script.sh        # rwxr-xr-x\uff1a\u5e38\u7528\u4e8e\u53ef\u6267\u884c\u811a\u672c\nls -l                      # \u67e5\u770b\u6743\u9650\n\n# chown\u547d\u4ee4\u4fee\u6539\u5c5e\u4e3b\u5c5e\u7ec4\nchown liyb.liyb script.sh  # \u5c06\u811a\u672c\u5c5e\u4e3b\u548c\u5c5e\u7ec4\u4fee\u6539\u4e3aliyb\n\n# -R \u53c2\u6570\u53ef\u4ee5\u5c06\u6743\u9650\u9012\u5f52\n</code></pre>"},{"location":"2025/1Linux/#4","title":"4 \u5982\u4f55\u67e5\u770b\u67d0\u4e2a\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\uff1f","text":"<pre><code>ps aux | grep \u8fdb\u7a0b\u540d           # \u67e5\u627e\u8fdb\u7a0b PID \u548c\u72b6\u6001\n\ntop -p PID                    # \u67e5\u770b\u6307\u5b9a PID \u7684\u52a8\u6001\u8d44\u6e90\u5360\u7528\n\ncat /proc/PID/status          # \u67e5\u770b\u8fdb\u7a0b\u8be6\u7ec6\u72b6\u6001\n\nlsof -p PID                   # \u67e5\u770b\u8fdb\u7a0b\u6253\u5f00\u7684\u6587\u4ef6\n\nstrace -p PID                 # \u8ddf\u8e2a\u7cfb\u7edf\u8c03\u7528\uff08\u6392\u67e5\u5361\u987f\uff09\n</code></pre>"},{"location":"2025/1Linux/#5","title":"5 \u8f6f\u94fe\u63a5\u548c\u786c\u94fe\u63a5\u7684\u533a\u522b\uff1f","text":"<ul> <li>\u8f6f\u94fe\u63a5\uff1a\u7c7b\u4f3c Windows \u5feb\u6377\u65b9\u5f0f\uff0c\u6307\u5411\u6587\u4ef6\u8def\u5f84\u3002</li> <li>\u786c\u94fe\u63a5\uff1a\u6307\u5411\u76f8\u540c\u7684 inode\uff0c\u4e0d\u4f9d\u8d56\u6587\u4ef6\u540d\u3002</li> </ul>"},{"location":"2025/1Linux/#_1","title":"\u533a\u522b\uff1a","text":"<p>\u5220\u9664\u539f\u6587\u4ef6\uff1a\u8f6f\u94fe\u63a5\u5931\u6548\uff0c\u786c\u94fe\u63a5\u4ecd\u7136\u53ef\u7528\u3002</p> <p>\u8de8\u5206\u533a\uff1a\u8f6f\u94fe\u63a5\u53ef\u4ee5\uff0c\u786c\u94fe\u63a5\u4e0d\u884c\u3002</p> <p>\u76ee\u5f55\uff1a\u901a\u5e38\u4e0d\u5141\u8bb8\u521b\u5efa\u786c\u94fe\u63a5</p> <pre><code>ln -s source.txt softlink.txt     # \u521b\u5efa\u8f6f\u94fe\u63a5\nln source.txt hardlink.txt        # \u521b\u5efa\u786c\u94fe\u63a5\n</code></pre>"},{"location":"2025/1Linux/#6-linux","title":"6 Linux \u7cfb\u7edf\u8d1f\u8f7d\u9ad8\u600e\u4e48\u529e\uff1f","text":"<p>\u786e\u8ba4\u8d1f\u8f7d\uff1a</p> <pre><code>uptime     # \u67e5\u770b load average\uff08\u8fc7\u53bb1\u30015\u300115\u5206\u949f\uff09\n\ntop        # \u67e5\u770b CPU\u3001\u5185\u5b58\u5360\u7528\u8fdb\u7a0b\n</code></pre> <p>\u67e5\u770b I/O \u538b\u529b\uff1a</p> <pre><code>iostat -x 1\n\niotop              # \u5b9e\u65f6\u67e5\u770b I/O \u91cd\u7684\u8fdb\u7a0b\n</code></pre> <p>\u5185\u5b58\u68c0\u67e5\uff1a</p> <pre><code>free -m\n\nvmstat 1 5\n</code></pre> <p>\u65e5\u5fd7\u68c0\u67e5\uff1a</p> <pre><code>dmesg | tail       # \u5185\u6838\u9519\u8bef\u4fe1\u606f\n\njournalctl -xe     # \u67e5\u770b\u6700\u8fd1\u7cfb\u7edf\u9519\u8bef\n</code></pre> <p>\u9ad8\u7ea7\u5de5\u5177\uff1a</p> <p>strace\u3001perf top\u3001sar \u7b49\u7528\u4e8e\u6df1\u5165\u6027\u80fd\u5206\u6790</p>"},{"location":"2025/1Linux/#8","title":"8 \u5982\u4f55\u67e5\u770b\u548c\u5206\u6790\u7cfb\u7edf\u65e5\u5fd7\uff1f","text":"<p>\u65e5\u5fd7\u4f4d\u7f6e\uff1a</p> <pre><code>/var/log/messages      # \u7cfb\u7edf\u65e5\u5fd7\uff08\u4f20\u7edf Linux\uff09\n/var/log/syslog        # Debian \u7cfb\n/var/log/dmesg         # \u542f\u52a8\u786c\u4ef6\u65e5\u5fd7\n\njournalctl  -xe             # systemd \u65e5\u5fd7\u67e5\u770b\u5668\n</code></pre> <p>\u6709\u4e9b\u662f\u5e94\u7528\u65e5\u5fd7\uff0c\u9700\u8981\u6839\u636e\u5b9e\u9645\u7684\u914d\u7f6e\u8def\u5f84\u6765\u67e5\u770b\uff0c\u67e5\u770b\u65e5\u5fd7\u65f6\u4e00\u822c\u4f7f\u7528tail -f \u6765\u6301\u7eed\u67e5\u770b\u65e5\u5fd7\u8f93\u51fa</p>"},{"location":"2025/1Linux/#9-linux","title":"9 Linux \u5982\u4f55\u8bbe\u7f6e\u5b9a\u65f6\u4efb\u52a1\uff1f","text":"<pre><code>crontab -e           # \u7f16\u8f91\u5f53\u524d\u7528\u6237\u7684\u5b9a\u65f6\u4efb\u52a1\n\ncrontab -l           # \u67e5\u770b\u5f53\u524d\u4efb\u52a1\n</code></pre> <p>\u8bed\u6cd5\u7ed3\u6784\uff1a</p> <pre><code>* * * * * command_to_run\n\u5206 \u65f6 \u65e5 \u6708 \u661f\u671f \u8981\u6267\u884c\u7684\u547d\u4ee4\n</code></pre> <p>\u793a\u4f8b\uff1a\u6bcf\u5929\u51cc\u6668 3 \u70b9\u6267\u884c\u5907\u4efd\u811a\u672c</p> <pre><code>0 3 * * * /home/user/backup.sh\n</code></pre>"},{"location":"2025/1Linux/#10","title":"10 \u5982\u4f55\u67e5\u627e\u6587\u4ef6\u6216\u5185\u5bb9\uff1f","text":"<pre><code>find /path -name \"*.log\"           # \u6309\u540d\u79f0\u67e5\u627e\nfind / -type f -size +100M         # \u67e5\u627e\u5927\u6587\u4ef6\n</code></pre> <p>\u67e5\u627e\u6587\u4ef6\u5185\u5bb9\uff1a</p> <pre><code>grep \"\u5173\u952e\u8bcd\" \u6587\u4ef6\u540d\ngrep -r \"\u5173\u952e\u8bcd\" ./               # \u9012\u5f52\u67e5\u627e\nfind . -type f | xargs grep \"\u5173\u952e\u8bcd\"\n</code></pre>"},{"location":"2025/1Linux/#12grep","title":"12\u4e2agrep\u547d\u4ee4\u884c\u7ec4\u5408","text":"<p>\u5206\u4eab\u4e00\u4e0bgrep\u5e38\u7528\u7ec4\u5408\u3002\u5728 Linux/Unix \u7684\u65e5\u5e38\u8fd0\u7ef4\u3001\u5f00\u53d1\u8c03\u8bd5\u3001\u65e5\u5fd7\u5206\u6790\u4e2d\uff0cgrep \u662f\u51e0\u4e4e\u4eba\u624b\u5fc5\u5907\u7684\u5de5\u5177\u3002</p>"},{"location":"2025/1Linux/#1_1","title":"1 \u6700\u7b80\u5355\u67e5\u627e","text":"<pre><code>grep \"ERROR\" /var/log/messages\n</code></pre> <p>\u8fd9\u662f\u7cbe\u786e\u67e5\u627e\u65b9\u5f0f\uff0c\u67e5\u627e\u65e5\u5fd7\u91cc\u6240\u6709\u5305\u542b ERROR \u7684\u884c\u3002</p>"},{"location":"2025/1Linux/#2_1","title":"2 \u5ffd\u7565\u5927\u5c0f\u5199","text":"<pre><code>grep -i \"error\" /var/log/messages\n</code></pre> <p>\u8fd9\u662f\u6a21\u7cca\u67e5\u627e\u65b9\u5f0f\uff0c-i\u53c2\u6570\u53ef\u4ee5\u5ffd\u7565\u5927\u5c0f\u5199\u3002\u65e0\u8bba error\u3001Error\u3001ERROR \u90fd\u80fd\u641c\u5230\u3002</p>"},{"location":"2025/1Linux/#3_1","title":"3 \u663e\u793a\u884c\u53f7 + \u9ad8\u4eae","text":"<pre><code>grep -ni --color=auto \"ERROR\" /data/tomcat/logs/catalina.out\n</code></pre> <p>-n\u5e26\u884c\u53f7\u8f93\u51fa\u3001\u5e26\u9ad8\u4eae\uff0c\u5feb\u901f\u5b9a\u4f4d\u95ee\u9898\u884c\u3002</p> <p></p>"},{"location":"2025/1Linux/#4_1","title":"4 \u7edf\u8ba1\u5173\u952e\u5b57\u51fa\u73b0\u6b21\u6570","text":"<pre><code>grep -c \"ERROR\" /var/log/messages\n</code></pre> <p>\u8f93\u51fa\u5339\u914d\u603b\u6b21\u6570\uff0c\u800c\u4e0d\u662f\u5177\u4f53\u5185\u5bb9\u3002</p>"},{"location":"2025/1Linux/#5_1","title":"5 \u6392\u9664\u5e72\u6270\u4fe1\u606f","text":"<pre><code>grep \"ERROR\" /var/log/messages | grep -v \"DEBUG\"\n</code></pre> <p>\u5148\u5339\u914d ERROR\uff0c\u518d\u8fc7\u6ee4\u6389 DEBUG \u884c\u3002 \u5728\u590d\u6742\u65e5\u5fd7\u91cc\u5f88\u5e38\u7528\u3002</p>"},{"location":"2025/1Linux/#6","title":"6 \u591a\u5173\u952e\u5b57\u7ec4\u5408","text":"<pre><code>grep -E \"ERROR|WARN\" /var/log/messages\n</code></pre> <p>\u540c\u65f6\u67e5\u627e ERROR \u6216 WARN\u3002</p>"},{"location":"2025/1Linux/#7","title":"7 \u62bd\u53d6\u5173\u952e\u90e8\u5206","text":"<pre><code>grep -o \"ERROR.*\"  /data/tomcat/logs/catalina.out\n</code></pre> <p>\u53ea\u8f93\u51fa\u5339\u914d\u7247\u6bb5\uff0c\u6bd4\u5982\u63d0\u53d6 ERROR \u5f00\u5934\u7684\u62a5\u9519\u5185\u5bb9\u3002</p> <p></p>"},{"location":"2025/1Linux/#8_1","title":"8 \u641c\u7d22\u6574\u4e2a\u76ee\u5f55","text":"<pre><code>grep -ir \"https://www.liyb.com\" ./logs\n</code></pre> <p>-r \u53c2\u6570\u662f\u904d\u5386\u5f53\u524d\u76ee\u5f55\u53ca\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\uff0c\u5728\u4ee3\u7801\u76ee\u5f55\u91cc\u9012\u5f52\u641c\u7d22 https://www.liyb.com \u6807\u8bb0\u3002</p>"},{"location":"2025/1Linux/#9","title":"9 \u9650\u5b9a\u6587\u4ef6\u7c7b\u578b","text":"<pre><code>grep -ir --include=\"*.log\" \"Logger\" ./logs\n</code></pre> <p>\u53ea\u641c .log \u6587\u4ef6\uff0c\u907f\u514d\u65e0\u5173\u6587\u4ef6\u5e72\u6270\u3002</p>"},{"location":"2025/1Linux/#10_1","title":"10 \u67e5\u770b\u4e0a\u4e0b\u6587","text":"<pre><code>grep -C 3 \"ERROR\" catalina.out\n</code></pre> <p>\u5339\u914d\u7ed3\u679c\u524d\u540e\u5404\u663e\u793a 3 \u884c\u4e0a\u4e0b\u6587\u3002 \u7ec4\u5408\uff1a</p> <ul> <li>-A N \u53ea\u770b\u540e\u9762 N \u884c</li> <li>-B N \u53ea\u770b\u524d\u9762 N \u884c</li> </ul>"},{"location":"2025/1Linux/#11","title":"11. \u5b9e\u65f6\u8fc7\u6ee4\u65e5\u5fd7","text":"<pre><code>tail -f catalina.out | grep \"ERROR\"\n</code></pre> <p>\u751f\u4ea7\u73af\u5883\u5b9e\u65f6\u76ef\u62a5\u9519\u3002 \u7ec4\u5408\u589e\u5f3a\u7248\uff1a</p> <pre><code>tail -f catalina.out | grep -E \"ERROR|WARN\" | grep -v \"DEBUG\"\n</code></pre> <p>\u5b9e\u65f6\u53ea\u770b ERROR/WARN\uff0c\u8fc7\u6ee4\u6389 DEBUG\uff0c\u6e05\u723d\u5f88\u591a\u3002</p>"},{"location":"2025/1Linux/#12-find","title":"12. \u7ed3\u5408 find \u7cbe\u786e\u641c\u7d22","text":"<pre><code>find ./ -name \"*.log\" | xargs grep \"OutOfMemory\"\n</code></pre> <p>\u5728\u6240\u6709 .log \u6587\u4ef6\u91cc\u67e5\u627e OutOfMemory \u62a5\u9519\u3002</p>"},{"location":"2025/1Linux/#3-curlwget","title":"3 curl\u548cwget\u7684\u6b63\u786e\u4f7f\u7528\u59ff\u52bf","text":""},{"location":"2025/1Linux/#1_2","title":"1 \u533a\u522b\uff1a\u5b9a\u4f4d\u4e0d\u540c","text":"<p>wget\uff1a\u4e13\u6ce8\u4e8e\u4e0b\u8f7d\uff0ccurl\uff1a\u4e13\u6ce8\u4e8e\u6570\u636e\u4f20\u8f93</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c\u5982\u679c\u4f60\u60f3\u4e0b\u8f7d\u6587\u4ef6\uff0c\u7528wget\uff1b\u5982\u679c\u4f60\u60f3\u8c03\u8bd5API\u3001\u4f20\u8f93\u590d\u6742\u6570\u636e\uff0c\u7528curl\u3002</p>"},{"location":"2025/1Linux/#2-wget","title":"2 wget\uff1a\u4e13\u4e1a\u7684\u4e0b\u8f7d\u5de5\u5177","text":"<p>2.1 \u6838\u5fc3\u7528\u9014</p> <ul> <li>\u9012\u5f52\u4e0b\u8f7d\u6574\u4e2a\u7f51\u7ad9</li> <li>\u65ad\u70b9\u7eed\u4f20\u5927\u6587\u4ef6</li> <li>\u6279\u91cf\u4e0b\u8f7d\u8d44\u6e90</li> </ul> <p>2.2 \u5e38\u7528\u64cd\u4f5c</p> <pre><code># \u57fa\u672c\u4e0b\u8f7d\uff0c\u540e\u9762\u76f4\u63a5\u52a0URL\nwget https://packages.gitlab.com/gitlab/gitlab-ce/packages/ol/9/gitlab-ce-18.2.8-ce.0.el9.x86_64.rpm\n\n# -c: \u65ad\u70b9\u7eed\u4f20\uff08\u751f\u4ea7\u73af\u5883\u5fc5\u5907\uff01\uff09\nwget -c https://packages.gitlab.com/gitlab/gitlab-ce/packages/ol/9/gitlab-ce-18.2.8-ce.0.el9.x86_64.rpm\n\n# -b\uff1a\u540e\u53f0\u4e0b\u8f7d\nwget -b https://packages.gitlab.com/gitlab/gitlab-ce/packages/ol/9/gitlab-ce-18.2.8-ce.0.el9.x86_64.rpm\n\n# \u9650\u901f\u4e0b\u8f7d\uff08\u907f\u514d\u5f71\u54cd\u4e1a\u52a1\uff09\nwget --limit-rate=200k https://packages.gitlab.com/gitlab/gitlab-ce/packages/ol/9/gitlab-ce-18.2.8-ce.0.el9.x86_64.rpm\n\n# -r\uff1a\u9012\u5f52\u4e0b\u8f7d\u6574\u4e2a\u76ee\u5f55\nwget -r -np -nH https://baidu.com/files/\n\n# \u4e0b\u8f7d\u5e76\u91cd\u547d\u540d\nwget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo\n\n# \u6307\u5b9a\u91cd\u8bd5\u6b21\u6570\nwget -t 5 https://baidu.com/unstable-file.zip\n\n# \u8d85\u65f6\u8bbe\u7f6e\nwget -T 30 https://baidu.com/slow-file.zip\n</code></pre> <p></p>"},{"location":"2025/1Linux/#3-curl","title":"3 curl\uff1a\u5f3a\u5927\u7684\u6570\u636e\u4f20\u8f93\u5de5\u5177","text":"<p>3.1 \u6838\u5fc3\u7528\u9014</p> <ul> <li>API\u8c03\u8bd5\u548c\u6d4b\u8bd5</li> <li>\u590d\u6742HTTP\u8bf7\u6c42</li> <li>\u6587\u4ef6\u4e0a\u4f20</li> <li>\u534f\u8bae\u652f\u6301\u5e7f\u6cdb\uff08\u652f\u630120+\u79cd\u534f\u8bae\uff09</li> </ul> <p>3.2 \u5e38\u7528\u64cd\u4f5c</p> <pre><code># \u57fa\u672c\u8bf7\u6c42\ncurl curl https://ligelinux.com\n\n# \u663e\u793a\u8be6\u7ec6\u8bf7\u6c42\u4fe1\u606f\uff08\u8c03\u8bd5\u795e\u5668\uff09\ncurl -v  https://ligelinux.com/console\n\n# \u53ea\u663e\u793a\u54cd\u5e94\u5934\ncurl -I https://ligelinux.com/console\n\n# \u6307\u5b9a\u8bf7\u6c42\u65b9\u6cd5\ncurl -X POST https://ligelinux.com/console\ncurl -X GET https://ligelinux.com/console\n\n\n# \u53d1\u9001JSON\u6570\u636e\ncurl -X POST \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"name\":\"\u5f20\u4e09\",\"email\":\"zhangsan@example.com\"}' \\\n     https://baidu.com/users\n\n# \u8f93\u51fa\u5230\u6587\u4ef6\ncurl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo\n\n# \u8ddf\u968f\u91cd\u5b9a\u5411\ncurl -L https://ligelinux.com/console\n</code></pre> <p></p>"},{"location":"2025/1Linux/#4_2","title":"4 \u5173\u952e\u533a\u522b\u603b\u7ed3","text":"\u7279\u6027 wget curl \u4e3b\u8981\u5b9a\u4f4d \u4e0b\u8f7d\u5de5\u5177 \u6570\u636e\u4f20\u8f93\u5de5\u5177 \u534f\u8bae\u652f\u6301 HTTP, HTTPS, FTP 20+\u79cd\u534f\u8bae \u9012\u5f52\u4e0b\u8f7d \u539f\u751f\u652f\u6301 \u4e0d\u652f\u6301 \u65ad\u70b9\u7eed\u4f20 \u539f\u751f\u652f\u6301 \u9700\u8981\u7279\u5b9a\u53c2\u6570 API\u8c03\u8bd5 \u6709\u9650 \u975e\u5e38\u5f3a\u5927 \u8f93\u51fa\u9ed8\u8ba4 \u4fdd\u5b58\u5230\u6587\u4ef6 \u8f93\u51fa\u5230stdout"},{"location":"2025/1Linux/#5_2","title":"5 \u5e38\u89c1\u8bef\u533a\u7ea0\u6b63","text":"<p>\u8bef\u533a1\uff1acurl\u4e0d\u80fd\u4e0b\u8f7d\u6587\u4ef6</p> <p>\u9519\u8bef\uff1a\u5f88\u591a\u4eba\u8ba4\u4e3acurl\u53ea\u80fd\u67e5\u770b\u5185\u5bb9\u4e0d\u80fd\u4e0b\u8f7d</p> <p>\u6b63\u786e\uff1acurl\u4e5f\u80fd\u4e0b\u8f7d</p> <pre><code># curl\u4e5f\u53ef\u4ee5\u4e0b\u8f7d\u6587\u4ef6\ncurl -O  https://mirrors.aliyun.com/repo/Centos-7.repo         # \u4fdd\u6301\u539f\u6587\u4ef6\u540d\ncurl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo\n  # \u81ea\u5b9a\u4e49\u6587\u4ef6\u540d\n</code></pre> <p></p> <p>\u8bef\u533a2\uff1awget\u53ef\u4ee5\u5f88\u597d\u5730\u8fdb\u884cAPI\u8c03\u8bd5</p> <p>\u9519\u8bef\uff1a\u7528wget\u6d4b\u8bd5\u590d\u6742API</p> <p>\u6b63\u786e\uff1awget\u9002\u5408\u7b80\u5355\u4e0b\u8f7d\uff0c\u590d\u6742API\u5e94\u8be5\u7528curl</p> <p>\u8bef\u533a3\uff1a\u4e24\u8005\u53ef\u4ee5\u5b8c\u5168\u4e92\u6362</p> <p>\u9519\u8bef\uff1a\u8ba4\u4e3acurl\u548cwget\u529f\u80fd\u76f8\u540c</p> <p>\u6b63\u786e\uff1a\u5404\u6709\u4e13\u957f\uff0c\u6839\u636e\u573a\u666f\u9009\u62e9</p> <p>\u603b\u4e4b\u8bb0\u4f4f\u8fd9\u4e2a\u7b80\u5355\u7684\u539f\u5219\uff1a\u4e0b\u8f7d\u7528wget\uff0c\u8c03\u8bd5\u7528curl\u3002</p>"},{"location":"2025/1Linux/#4-vim","title":"4 Vim","text":"<pre><code>yum install -y vim\n</code></pre> <p>1\u3001\u666e\u901a\u6a21\u5f0f</p> <p>\u9ed8\u8ba4\u7684\u7f16\u8f91\u6a21\u5f0f\u3002\u4ece shell \u7a97\u53e3\u6253\u5f00\u6587\u4ef6\u8fdb\u5165\u7684\u7b2c\u4e00\u4e2a\u6a21\u5f0f\uff0c\u5176\u4ed6\u6a21\u5f0f\u53ef\u4ee5\u901a\u8fc7\u6309 ESC \u952e\u56de\u9000\u5230\u666e\u901a\u6a21\u5f0f\u3002</p> <p>2\u3001\u547d\u4ee4\u6a21\u5f0f</p> <p>\u7528\u4e8e\u6267\u884c\u590d\u6742\u67e5\u8be2\u547d\u4ee4\uff0c\u4ece\u666e\u901a\u6a21\u5f0f\u8f93\u5165\u201c:\u201d\uff0c\u201c/\u201d\u6216\u201c?\u201d\u7b49\u7b26\u53f7\u5373\u53ef\u8fdb\u5165\u547d\u4ee4\u6a21\u5f0f\uff0c\u56de\u8f66\u952e\u8868\u793a\u8f93\u5165\u5b8c\u6210</p> <p>3\u3001\u63d2\u5165\u6a21\u5f0f</p> <p>\u8be5\u6a21\u5f0f\u5c31\u7c7b\u4f3c window \u4e2d\u64cd\u4f5c\u6587\u672c\u6587\u4ef6\uff0c\u666e\u901a\u6a21\u5f0f\u4e0b\u53ef\u901a\u8fc7\u8f93\u5165\u201ci\u201d,\u201co\u201d\u7b49\u5b57\u7b26\u5373\u53ef\u8fdb\u5165\u63d2\u5165\u6a21\u5f0f\u3002\u7f16\u8f91\u5b8c\u6210\u540e\u6309 ESC \u952e\u9000\u51fa\u5230\u666e\u901a\u6a21\u5f0f</p> <p>4\u3001\u53ef\u89c6\u6a21\u5f0f</p> <p>\u7528\u4e8e\u9009\u5b9a\u6587\u672c\u5757\uff1b\u53ef\u4ee5\u5728\u6b63\u5e38\u6a21\u5f0f\u4e0b\u8f93\u5165\u201cv\u201d\uff08\u5c0f\u5199\uff09\u6765\u6309\u5b57\u7b26\u9009\u5b9a\uff0c\u8f93\u5165\u201cV\u201d\uff08\u5927\u5199\uff09\u6765\u6309\u884c\u9009\u5b9a\uff0c\u6216\u8f93\u5165\u201cCtrl-V\u201d\u6765\u6309\u65b9\u5757\u9009\u5b9a\u3002</p>"},{"location":"2025/1Linux/#_2","title":"\u4e09\u3001\u6bcf\u4e2a\u6a21\u5f0f\u7684\u5e38\u7528\u64cd\u4f5c","text":"<p>1\u3001vim \u6253\u5f00\u6587\u4ef6\u65b9\u6cd5</p> <ul> <li>vim filename   \u6b63\u5e38\u6253\u5f00vim\u6587\u4ef6</li> <li>vim + filename \u6253\u5f00\u6587\u4ef6\uff0c\u5e76\u5c06\u5149\u6807\u7f6e\u4e8e\u6700\u540e\u4e00\u884c</li> <li>vim +n filename \u6253\u5f00\u6587\u4ef6\uff0c\u5e76\u5c06\u5149\u6807\u7f6e\u4e8e\u7b2cn\u884c</li> <li>vim +/ssh passwd \u6253\u5f00\u6587\u4ef6\uff0c\u5e76\u5c06\u5149\u6807\u7f6e\u4e8e\u7b2c\u4e00\u4e2a\u4e0essh\u5339\u914d\u7684\u4f4d\u7f6e</li> <li>vim -r filename  \u6062\u590d\u4e0a\u6b21vim\u6253\u5f00\u65f6\u5d29\u6e83\u7684\u6587\u4ef6</li> </ul> <p>2\u3001\u666e\u901a\u6a21\u5f0f</p> <ul> <li>G \u8df3\u5230\u6700\u540e\u4e00\u884c</li> <li>gg \u8df3\u5230\u7b2c\u4e00\u884c</li> <li>5G \u8df3\u5230\u7b2c5\u884c</li> <li>yy \u590d\u5236\u5f53\u524d\u884c</li> <li>5yy \u590d\u5236\u4ece\u5f53\u524d\u884c\u5f80\u540e\u76845\u884c</li> <li>p \u7c98\u8d34\u5df2\u590d\u5236\u7684\u884c\u5230\u5149\u6807\u540e</li> <li>P \u7c98\u8d34\u5df2\u590d\u5236\u7684\u884c\u5230\u5149\u6807\u524d</li> <li>dd (1)\u526a\u5207\u5f53\u524d\u884c\uff0c\u4ee5p\u7c98\u8d34\uff1b(2)\u5220\u9664\u5f53\u524d\u884c</li> <li>5dd \u5220\u96645\u884c</li> <li>dG \u4ece\u5f53\u524d\u884c\u5220\u5230\u6700\u540e\u4e00\u884c</li> <li>D \u4ece\u5149\u6807\u5904\u5220\u9664\u5230\u884c\u5c3e</li> <li>5dG \u4ece\u5f53\u524d\u884c\u5220\u5230\u7b2c\u4e94\u884c</li> <li>x \u5220\u9664\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u7684\u5b57\u7b26</li> <li>5x \u5220\u9664\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u7684\u5b57\u7b26\u53ca\u5f80\u540e\u76845\u4e2a\u5b57\u7b26</li> <li>X \u5220\u9664\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u7684\u524d\u4e00\u4e2a\u5b57\u7b26</li> <li>u \u64a4\u9500\u4e4b\u524d\u7684\u64cd\u4f5c</li> <li>Ctrl + r \u53cd\u64a4\u9500\uff08\u6062\u590d\u64a4\u9500\uff09</li> <li>\u6570\u5b570\u6216\u8005^  \u5c06\u5149\u6807\u79fb\u52a8\u5230\u5f53\u524d\u884c\u7684\u884c\u9996</li> <li>$ \u5c06\u5149\u6807\u79fb\u52a8\u5230\u5f53\u524d\u884c\u7684\u884c\u5c3e</li> <li>ctrl +f \u5411\u4e0b\u7ffb\u9875</li> <li>ctrl +b \u5411\u4e0a\u7ffb\u9875</li> <li>N \u67e5\u627e\u4e0b\u4e00\u4e2a\u76f8\u540c\u7684\u5b57\u7b26</li> <li>N \u67e5\u627e\u4e0a\u4e00\u4e2a\u76f8\u540c\u7684\u5b57\u7b26</li> <li>r\u66ff\u6362\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u7684\u5b57\u7b26</li> <li>R \u4ece\u5149\u6807\u5f53\u524d\u4f4d\u7f6e\u5f00\u59cb\u66ff\u6362\u5b57\u7b26\uff0c\u8f93\u5165\u5185\u5bb9\u4f1a\u8986\u76d6\u540e\u9762\u7b49\u957f\u7684\u5185\u5bb9\uff0c\u6309\u201cEsc\u201d\u7ed3\u675f\u8f93\u5165</li> <li>h\u5411\u5de6\u79fb\u52a8\u5149\u6807</li> <li>j\u5411\u4e0b\u79fb\u52a8\u5149\u6807</li> <li>k\u5411\u4e0a\u79fb\u52a8\u5149\u6807</li> <li>l\u5411\u53f3\u79fb\u52a8\u5149\u6807</li> </ul>"},{"location":"2025/1Linux/#3_2","title":"3\u3001\u547d\u4ee4\u6a21\u5f0f\u5e38\u7528\u547d\u4ee4","text":"<ul> <li>:wq \u4fdd\u5b58\u9000\u51fa</li> <li>:wq! \u5f3a\u5236\u4fdd\u5b58\u9000\u51fa</li> <li>:q \u4e0d\u4fdd\u5b58\u9000\u51fa</li> <li>:q! \u5f3a\u5236\u9000\u51fa\uff0c\u4e00\u822c\u5df2\u7ecf\u5bf9\u6587\u4ef6\u5185\u5bb9\u5df2\u7ecf\u8fdb\u884c\u4e86\u4fee\u6539\uff0c\u4e0d\u4fdd\u5b58\u5f3a\u5236\u9000\u51fa\u7684\u60c5\u51b5\u4f7f\u7528</li> <li>:set nu \u8bbe\u7f6e\u884c\u53f7\u663e\u793a</li> <li>:set nonu \u53d6\u6d88\u884c\u53f7</li> <li>:set list \u53d6\u6d88\u884c\u53f7</li> <li>set paste \u542f\u7528\u7c98\u8d34\u6a21\u5f0f</li> <li>set nopaste \u5173\u95ed\u7c98\u8d34\u6a21\u5f0f</li> <li>:s/a/b/g \u5c06\u5f53\u524d\u5149\u6807\u6240\u5728\u884c\u4e2d\u6240\u6709a\u66ff\u6362\u6210b</li> <li>:2,5s/a/b/g \u5c062-5\u884c\u4e2d\u6240\u6709a\u66ff\u6362\u6210b</li> <li>:%s/a/b/g \u5c06\u6587\u4ef6\u6240\u6709\u7684a\u66ff\u6362\u6210b</li> <li>/word \u4ece\u6587\u672c\u67e5\u627e\u5b57\u7b26\u4e32\uff0c\u6309\u201cn\u201d\u53ef\u4ee5\u67e5\u770b\u4e0b\u4e00\u4e2a\u76f8\u540c\u5b57\u7b26 .\u6ce8\u610f\uff1a\u67e5\u627e\u4f1a\u533a\u5206\u5927\u5c0f\u5199</li> <li>/^word \u67e5\u8be2\u4ee5work\u5f00\u5934\u7684\u884c</li> <li>/work$ \u67e5\u8be2\u4ee5work\u7ed3\u5c3e</li> <li>\uff1fwork \u4ece\u6587\u672c\u67e5\u627e\u5b57\u7b26\u4e32\uff0c\u6309\u201cn\u201d\u53ef\u4ee5\u67e5\u770b\u4e0a\u4e00\u4e2a\u76f8\u540c\u5b57\u7b26</li> </ul>"},{"location":"2025/1Linux/#4_3","title":"4\u3001\u8fdb\u5165\u63d2\u5165\u6a21\u5f0f\u65b9\u6cd5","text":"<ul> <li>i\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u63d2\u5165</li> <li>I\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u884c\u9996\u63d2\u5165</li> <li>o\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u4e0b\u4e00\u884c\u63d2\u5165</li> <li>O\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u4e0a\u4e00\u884c\u63d2\u5165</li> <li>a\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u4e0b\u4e00\u4e2a\u5b57\u7b26\u7684\u4f4d\u7f6e\u63d2\u5165</li> <li>A\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u884c\u5c3e\u63d2</li> </ul> <p>\u8fdb\u5165\u5230\u63d2\u5165\u6a21\u5f0f\u540e\u5c31\u5982\u540c\u8fdb\u5165\u4e00\u4e2a\u6587\u6863\u6587\u4ef6\uff0c\u6309ESC\u952e\u9000\u51fa\u5230\u666e\u901a\u6a21\u5f0f</p>"},{"location":"2025/1Linux/#5_3","title":"5\u3001\u53ef\u89c6\u5316\u6a21\u5f0f\u5e38\u7528\u64cd\u4f5c","text":"<ul> <li>v \u5b57\u7b26\u9009\u62e9\u6a21\u5f0f\uff0c\u9009\u4e2d\u5149\u6807\u7ecf\u8fc7\u7684\u6240\u6709\u5b57\u7b26</li> <li>V \u884c\u9009\u62e9\u6a21\u5f0f\uff0c\u9009\u62e9\u5149\u6807\u7ecf\u8fc7\u7684\u6240\u6709\u884c</li> </ul>"},{"location":"2025/1SRE/","title":"1 SRE Interview Questions and Answers","text":""},{"location":"2025/1SRE/#1-what-is-the-difference-between-sre-and-devops","title":"1. What is the difference between SRE and DevOps?","text":"<p>DevOps is a set of cultural philosophies and practices that aims to unify software development (Dev) and software operation (Ops). </p> <p>Its goal is to shorten the system development life cycle and provide continuous delivery with high software quality</p> <p>SRE, coined by Google, applies software engineering to infrastructure and operations problems. </p> <p>It enforces reliability using measurable Service Level Objectives (SLOs), focuses on toil reduction, automation, and balancing reliability with feature velocity using error budgets.</p>"},{"location":"2025/1SRE/#sre","title":"SRE","text":"<ul> <li>Origin:  Introduced by Google</li> <li>Focus: Reliability, automation, monitoring</li> <li>Core Principles SLOs, SLIs, Error Budget</li> <li>Tooling Uses software engineering tools</li> </ul>"},{"location":"2025/1SRE/#devops","title":"DevOps","text":"<ul> <li>Cultural movement</li> <li>CI/CD, collaboration</li> <li>Automation, culture, shared responsibility</li> <li>Emphasis on CI/CD pipelines, version control</li> </ul>"},{"location":"2025/1SRE/#2-what-are-slis-slos-and-slas-how-do-they-relate","title":"2. What are SLIs, SLOs, and SLAs? How do they relate?","text":"<ul> <li>SLI (Service Level Indicator): A quantitative measure of a service's performance. </li> </ul> <p>Example: latency, uptime, request success rate.</p> <ul> <li>SLO (Service Level Objective): A target value for an SLI. </li> </ul> <p>Example: \u201c99.9% of requests  should succeed in a 30-day window.\u201d</p> <ul> <li>SLA (Service Level Agreement): A formal agreement between service providers and customers, including penalties for failing to meet the SLOs.</li> </ul> <p>Relationship:</p> <ul> <li>SLIs \u2192 Used to measure service behavior</li> <li>SLOs \u2192 Targets based on SLIs</li> <li>SLAs \u2192 Contracts based on SLOs</li> </ul>"},{"location":"2025/1SRE/#3-what-is-an-error-budget-and-how-do-you-use-it","title":"3. What is an Error Budget and how do you use it?","text":"<p>An Error Budget is the allowable amount of downtime or failures a system can have without breaching the SLO. </p> <p>It represents the balance between innovation and reliability.</p> <p>If your SLO is 99.9% uptime over 30 days:</p> <ul> <li>Total minutes = 43,200</li> <li>Downtime allowed = 0.1% of 43,200 = 43.2 minutes</li> </ul> <p>Usage:</p> <ul> <li>If the error budget is used up \u2192 halt feature releases, focus on reliability.</li> <li>If not used \u2192 can afford to take more risk (release features, experiments).</li> </ul> <p>It enables data-driven decision making between ops and dev.</p>"},{"location":"2025/1SRE/#4-how-do-you-implement-monitoring-for-a-distributed-system","title":"4. How do you implement monitoring for a distributed system?","text":"<p>Monitoring a distributed system involves collecting metrics, logs, and traces across services, components, and hosts. Implementation includes:</p> <ol> <li>Metric Collection: Use tools like Prometheus, Datadog, or CloudWatch to gather CPU, memory, latency, etc.</li> <li>Logging: Centralize logs with ELK (Elasticsearch, Logstash, Kibana), Fluentd, or Loki.</li> <li>Tracing: Implement distributed tracing using OpenTelemetry, Jaeger, or Zipkin.</li> <li>Dashboards: Visualize key metrics using Grafana or Datadog dashboards.</li> <li>Alerting: Set up alerts for SLO breaches, resource exhaustion, or abnormal behavior</li> </ol> <p>Best Practices</p> <ul> <li>Define key SLIs (latency, availability)</li> <li>Use black-box and white-box monitoring</li> <li>Alert on symptoms, not causes</li> </ul>"},{"location":"2025/1SRE/#5-what-are-some-common-causes-of-high-latency-in-web-applications-and-how-can-you-troubleshoot-them","title":"5. What are some common causes of high latency in web applications and how can you  troubleshoot them?","text":"<p>Common Causes</p> <ul> <li>Database slow queries</li> <li>Application-level bottlenecks (e.g., loops, locking)</li> <li>Network issues (packet loss, congestion)</li> <li>Service dependency delays (e.g., upstream APIs)</li> </ul> <p>Troubleshooting Steps:</p> <ol> <li>Use APM tools: Detect slow endpoints/functions.</li> <li>Check logs: Look for timeouts or retries.</li> <li>Query DB slow logs: Identify problematic SQL.</li> <li>Network diagnostics: Use traceroute, ping, mtr.</li> <li>Load testing: Use tools like JMeter, Locust to simulate traffic.</li> </ol> <p>Fixes might include:</p> <ul> <li>Caching results (e.g., Redis)</li> <li>DB indexing</li> <li>Optimizing code</li> <li>Load balancing traffic</li> </ul>"},{"location":"2025/1SRE/#6-describe-a-runbook-what-should-be-included-in-a-good-runbook","title":"6. Describe a runbook. What should be included in a good runbook?","text":"<p>A runbook is a documented set of procedures for handling known operations or incidents.</p> <p>Should Include:</p> <ul> <li>Description of the problem</li> <li>Preconditions or triggers</li> <li>Step-by-step resolution actions</li> <li>Validation steps post-fix</li> <li>Rollback plan</li> <li>Owner/team to escalate to</li> </ul> <p>Example:</p> <p>Runbook for \u201cDisk Full on Web Server\u201d</p> <ul> <li>Step 1: SSH into the server</li> <li>Step 2: Identify large files (<code>du -sh *</code>)</li> <li>Step 3: Archive or delete logs</li> <li>Step 4: Verify disk space</li> </ul> <p>Benefits: </p> <ul> <li>Faster MTTR (Mean Time To Recovery)</li> <li>Reduces need for on-call escalation</li> <li>Ensures consistency</li> </ul>"},{"location":"2025/1SRE/#7-what-is-toil-in-sre-and-how-can-it-be-eliminated","title":"7. What is toil in SRE, and how can it be eliminated?","text":"<p>Toil is repetitive, manual, automatable, and non-value-add work that doesn't require human judgment.</p> <p>Examples: </p> <ul> <li>Restarting failed services</li> <li>Manually rotating logs</li> <li>Handling routine tickets</li> </ul> <p>Elimination Techniques:</p> <ul> <li>Automation: Write scripts, use Ansible/Terraform</li> <li>Self-healing: Use Kubernetes probes and auto-restart</li> <li>Better alerting: Suppress noise with smart alerts</li> <li>Bots: Use Slack bots for common actions</li> </ul> <p>Goal is to keep toil &lt; 50% of SRE workload</p>"},{"location":"2025/1SRE/#8-how-would-you-design-a-high-availability-architecture-in-a-cloud-environment","title":"8. How would you design a high-availability architecture in a cloud environment?","text":"<p>Core Principles:</p> <ul> <li>Multi-Zone: Use multiple availability zones (AZs)</li> <li>Load Balancers: Distribute traffic across instances</li> <li>Auto-scaling: Maintain performance under load</li> <li>Stateless services: Easier to replicate</li> <li>Managed DBs: Use HA RDS, CosmosDB, etc.</li> <li>Health checks: Auto-restart failed nodes</li> </ul> <p>Example in AWS:</p> <ul> <li>ALB \u2192 Auto Scaling Group with EC2 across 3 AZs</li> <li>Aurora DB with cross-AZ failover</li> <li>Route53 for multi-region DNS</li> </ul> <p>Design should be resilient, scalable, and self-healing.</p>"},{"location":"2025/1SRE/#9-what-are-the-differences-between-horizontal-and-vertical-scaling-when-would-you-use-each","title":"9. What are the differences between horizontal and vertical scaling? When would you use each?","text":"<p>Horizontal scaling is preferred in cloud environments because it\u2019s more fault-tolerant and supports auto-scaling.</p> <p>Vertical scaling is used when application architecture doesn\u2019t support clustering or sharding.</p>"},{"location":"2025/1SRE/#10-explain-blue-green-deployment-and-its-benefits","title":"10. Explain blue-green deployment and its benefits.","text":"<p>Blue-Green Deployment is a strategy where two environments (Blue = current, Green = new) are used.</p> <ol> <li>Deploy new version to Green.</li> <li>Test internally.</li> <li>Switch traffic from Blue to Green.</li> <li>Rollback by redirecting traffic back to Blue if needed.</li> </ol> <p>Benefits:</p> <ul> <li>Zero downtime</li> <li>Easy rollback</li> <li>Safe experimentation</li> </ul> <p>Used in CI/CD pipelines for risk mitigation during production releases</p>"},{"location":"2025/1SRE/#11-how-do-you-ensure-fault-tolerance-in-a-microservices-architecture","title":"11. How do you ensure fault tolerance in a microservices architecture?","text":"<p>Fault tolerance ensures that the system continues functioning even if components fail.</p> <p>Techniques:</p> <ul> <li>Retries with exponential backoff</li> <li>Circuit Breakers (e.g., Hystrix, Resilience4j)</li> <li>Bulkheads: Isolate failures to specific service components</li> <li>Fallback mechanisms: Return default values or cached data</li> <li>Health checks: Remove unhealthy instances from service mesh/load balancer</li> </ul> <p>Best Practices:</p> <ul> <li>Monitor each microservice independently</li> <li>Use service meshes (like Istio) for traffic management</li> <li>Container orchestration (like Kubernetes) for resilience</li> </ul>"},{"location":"2025/1SRE/#12-what-is-chaos-engineering-and-why-is-it-important","title":"12. What is chaos engineering, and why is it important?","text":"<p>Chaos engineering is the practice of intentionally injecting faults into a system to test its resilience.</p> <p>Tools: Chaos Monkey, Gremlin, Litmus</p> <p>Purpose:</p> <ul> <li>Identify weak points</li> <li>Validate alerting and monitoring</li> <li>Build confidence in production readines</li> </ul> <p>Example Scenarios:</p> <ul> <li>Terminate instances randomly</li> <li>Block network between services</li> <li>Increase latency to simulate real-world conditions</li> </ul> <p>Outcome: More resilient systems through proactive failure discovery</p>"},{"location":"2025/1SRE/#13-how-do-you-handle-noisy-alerts","title":"13. How do you handle noisy alerts?","text":"<p>Noisy alerts overwhelm engineers and lead to alert fatigue.</p> <p>Solutions:</p> <ul> <li>Use deduplication and rate-limiting</li> <li>Apply threshold tuning on alerts</li> <li>Categorize alerts: P1 (urgent), P2 (important), etc.</li> <li>Implement alert silencing during maintenance</li> <li>Use machine learning-based anomaly detection for smarter alerting</li> <li>Only alert on symptoms, not causes</li> </ul>"},{"location":"2025/1SRE/#14-how-does-sre-measure-the-reliability-of-a-system","title":"14. How does SRE measure the reliability of a system?","text":"<p>Reliability is measured through SLIs and SLOs, often based on:</p> <ul> <li>Availability (uptime): e.g., 99.99%</li> <li>Latency: e.g., 95% of requests &lt; 200ms</li> <li>Durability: e.g., no data loss</li> <li>Error rate: e.g., &lt; 0.1% failed requests</li> </ul> <p>Metrics Tools:</p> <ul> <li>Prometheus</li> <li>CloudWatch</li> <li>New Relic</li> <li>Datadog</li> </ul> <p>Reliability Score = How closely your system meets its SLOs.</p>"},{"location":"2025/1SRE/#15-what-is-mttr-mtbf-and-mttd-why-are-they-important","title":"15. What is MTTR, MTBF, and MTTD? Why are they important?","text":"<ul> <li>MTTR (Mean Time to Repair): Time to fix a failure.</li> <li>MTBF (Mean Time Between Failures): Average uptime between failures.</li> <li>MTTD (Mean Time to Detect): Time to detect an issue after it occurs</li> </ul> <p>Importance</p> <ul> <li>Helps track operational efficiency</li> <li>Indicates reliability trends</li> <li>Guides incident response planning</li> </ul> <p>Lower MTTR and MTTD \u2192 faster recovery. Higher MTBF \u2192 fewer outages.</p>"},{"location":"2025/1SRE/#16-what-is-the-difference-between-canary-and-rolling-deployment","title":"16. What is the difference between canary and rolling deployment?","text":"<p>Canary is better for risk detection.</p> <p>Rolling is suitable for stable environments with minor changes.</p>"},{"location":"2025/1SRE/#17-how-does-kubernetes-help-in-sre","title":"17. How does Kubernetes help in SRE?","text":"<p>Kubernetes simplifies operations and enables reliability through:</p> <ul> <li>Auto-scaling: Horizontal and vertical</li> <li>Self-healing: Restart failed pods</li> <li>Rolling updates: Minimal downtime deployments</li> <li>Health checks: Liveness and readiness probes</li> <li>Namespaces &amp; RBAC: Better isolation and security</li> </ul> <p>SREs leverage Kubernetes to automate deployments, monitor workloads, and maintain service uptime efficiently.</p>"},{"location":"2025/1SRE/#18-what-is-a-blameless-postmortem-and-why-is-it-important","title":"18. What is a blameless postmortem, and why is it important?","text":"<p>A blameless postmortem focuses on learning from incidents without attributing fault to individuals.</p> <ul> <li>Encourages transparency</li> <li>Builds psychological safety</li> <li>Uncovers systemic weaknesses</li> </ul> <p>Postmortem Includes:</p> <ul> <li>Summary of the incident</li> <li>Timeline</li> <li>Root cause analysis</li> <li>Action items</li> <li>Lessons learned</li> </ul>"},{"location":"2025/1SRE/#19-how-do-you-handle-database-scaling-in-high-traffic-systems","title":"19. How do you handle database scaling in high-traffic systems?","text":"<p>Vertical Scaling: </p> <p>Add more CPU/RAM to DB server (limited scalability)</p> <p>Horizontal Scaling: </p> <ul> <li>Sharding: Split data across nodes</li> <li>Read Replicas: Distribute read traffic</li> <li>Caching: Use Redis/Memcached for frequent reads</li> <li>Connection pooling: Optimize database connections</li> </ul> <p>Use proxy layers (like ProxySQL) and managed DB services (like Amazon Aurora) for easier scaling.</p>"},{"location":"2025/1SRE/#20-what-is-service-mesh-and-how-does-it-help-in-observability","title":"20. What is service mesh, and how does it help in observability?","text":"<p>A service mesh is an infrastructure layer that manages service-to-service communication.</p> <p>Examples: Istio, Linkerd, Consul</p> <ul> <li>Traffic management (routing, retries)</li> <li>Security (mTLS)</li> <li>Observability (metrics, traces)</li> <li>Fault injection (chaos testing)</li> </ul> <p>In Observability:</p> <ul> <li>Automatically collects telemetry data (latency, errors)</li> <li>Integrates with tracing and logging tools</li> <li>Enables fine-grained metrics per service</li> </ul>"},{"location":"2025/1SRE/#21-how-do-you-reduce-mean-time-to-recovery-mttr","title":"21. How do you reduce Mean Time to Recovery (MTTR)?","text":"<p>MTTR can be reduced by:</p> <ul> <li>Robust monitoring: Real-time alerts to catch issues quickly</li> <li>Runbooks: Fast, documented response</li> <li>Auto-remediation: Scripts to self-heal (e.g., restart services)</li> <li>Incident drills: Prepare responders via simulations</li> <li>CI/CD rollback: Enable rapid reversion to last known good state</li> </ul> <p>Tooling: PagerDuty, Opsgenie, Lambda/Functions for automation</p>"},{"location":"2025/1SRE/#22-describe-a-typical-sre-on-call-process","title":"22. Describe a typical SRE on-call process.","text":"<ol> <li>Alerting system (Prometheus, CloudWatch) detects an issue</li> <li>Notification sent to on-call engineer via PagerDuty, Opsgenie</li> <li>Engineer assesses logs, dashboards</li> <li>Mitigation: Hotfix, restart, or scale-out</li> <li>Escalate if necessary</li> <li>After issue \u2192 Postmortem created</li> </ol> <p>Goals: fast detection, minimal downtime, documented</p>"},{"location":"2025/1SRE/#23-how-do-you-handle-secret-management-in-production-systems","title":"23. How do you handle secret management in production systems?","text":"<ul> <li>HashiCorp Vault</li> <li>AWS Secrets Manager</li> <li>Azure Key Vault</li> <li>Kubernetes Secrets</li> </ul> <p>Practices:</p> <ul> <li>Encrypt secrets at rest and in transit</li> <li>Rotate secrets regularly</li> <li>Use IAM for controlled access</li> <li>Never hardcode secrets in code or CI/CD</li> </ul>"},{"location":"2025/1SRE/#25-how-do-you-conduct-capacity-planning","title":"25. How do you conduct capacity planning?","text":"<ol> <li>Gather metrics: CPU, memory, disk, traffic trends</li> <li>Forecast usage: Based on historical data and business growth</li> <li>Test scalability: Stress/load tests</li> <li>Plan buffer: Typically 30% headroom</li> <li>Reassess periodically</li> </ol> <p>Tools: Grafana, CloudWatch, Datadog</p>"},{"location":"2025/1SRE/#26-what-is-observability-how-is-it-different-from-monitoring","title":"26. What is observability? How is it different from monitoring?","text":"<p>Monitoring: Predefined metrics and alerts</p> <p>Observability: Ability to understand internal system state from outputs (metrics, logs, traces)</p> <p>3 Pillars of Observability:</p> <ol> <li>Metrics (quantitative)</li> <li>Logs (textual)</li> <li>Traces (request flows)</li> </ol> <p>Observability helps debug unknown unknowns. Monitoring detects known issues.</p>"},{"location":"2025/1SRE/#27-how-do-you-ensure-zero-downtime-deployments","title":"27. How do you ensure zero-downtime deployments?","text":"<ul> <li>Blue-Green or Canary deployments</li> <li>Load balancer health checks</li> <li>Readiness/liveness probes</li> <li>Preload containers before switching traffic</li> <li>Use rolling updates with maxSurge and maxUnavailable</li> </ul> <p>Kubernetes and service meshes help manage zero-downtime rollouts.</p>"},{"location":"2025/1SRE/#28-what-is-infrastructure-as-code-iac-and-how-does-it-benefit-sres","title":"28. What is infrastructure as code (IaC), and how does it benefit SREs?","text":"<p>IaC is managing infrastructure using code (declarative/imperative).</p> <p>Tools: Terraform, Pulumi, AWS CDK, Ansible</p> <p>Benefits</p> <ul> <li>Version control for infra</li> <li>Reproducibility and audit trails</li> <li>Easier testing and rollback</li> <li>Automation of provisioning</li> </ul> <p>Enables GitOps workflows for environment management.</p>"},{"location":"2025/1SRE/#29-what-is-gitops-and-how-is-it-applied-in-sre-workflows","title":"29. What is GitOps and how is it applied in SRE workflows?","text":"<p>GitOps uses Git as a single source of truth for infra and app config.</p> <p>Process:</p> <ul> <li>Desired state in Git</li> <li>Git triggers deployment via agents (e.g., ArgoCD, Flux)</li> <li>Reconciliation loops correct drift</li> </ul> <p>Benefits:</p> <ul> <li>Auditable changes</li> <li>Easy rollback</li> <li>Consistency across environments</li> </ul>"},{"location":"2025/1SRE/#30-how-do-you-test-disaster-recovery-in-cloud-systems","title":"30. How do you test disaster recovery in cloud systems?","text":"<p>Plan:</p> <ul> <li>Define RPO (Recovery Point Objective)</li> <li>Define RTO (Recovery Time Objective)</li> </ul> <p>Testing:</p> <ul> <li>Simulate region outage</li> <li>Practice DB failovers</li> <li>Validate backup restores</li> <li>Chaos engineering for DR</li> </ul>"},{"location":"2025/1SRE/#31-explain-rate-limiting-and-why-its-important","title":"31. Explain rate limiting and why it\u2019s important.","text":"<p>Rate limiting restricts number of requests per client/service to prevent abuse or overload</p> <p>Types: </p> <ul> <li>IP-based</li> <li>User-based</li> <li>Token-bucket algorithms</li> </ul> <p>Tools: NGINX, Envoy, API Gateway</p> <p>Prevents:</p> <ul> <li>DDoS</li> <li>API overuse</li> <li>Resource exhaustion</li> </ul>"},{"location":"2025/1SRE/#32-how-do-you-ensure-security-in-cicd-pipelines","title":"32. How do you ensure security in CI/CD pipelines?","text":"<p>Steps:</p> <ul> <li>Use static analysis tools (e.g., SonarQube, Checkov)</li> <li>Scan for secrets (e.g., truffleHog)</li> <li>Sign artifacts (e.g., Cosign)</li> <li>Use least privilege for CI/CD tokens</li> <li>Enable multi-factor authentication (MFA)</li> </ul>"},{"location":"2025/1SRE/#33-whats-the-difference-between-a-symptom-based-and-cause-based-alert","title":"33. What\u2019s the difference between a symptom-based and cause-based alert?","text":"<ul> <li>Symptom-based Alerts on impact (e.g., high latency)</li> <li>Cause-based Alerts on root issue (e.g., CPU spike)</li> </ul>"},{"location":"2025/1SRE/#34-how-do-you-handle-cascading-failures","title":"34. How do you handle cascading failures?","text":"<p>Cascading failures spread from one service to another</p> <p>Prevention:</p> <ul> <li>Implement circuit breakers</li> <li>Add timeouts and retries</li> <li>Use bulkheads to isolate services</li> <li>Monitor dependency health</li> </ul> <p>Service meshes can enforce limits to prevent overload</p>"},{"location":"2025/1SRE/#35-how-does-load-shedding-work","title":"35. How does load shedding work?","text":"<p>Load shedding drops low-priority traffic during high load to protect the system</p> <p>Methods: </p> <ul> <li>Reject requests with 503</li> <li>Queue overflow handling</li> <li>Prioritize traffic tiers (e.g., VIP vs free users)</li> </ul> <p>Preserves system availability under stress.</p>"},{"location":"2025/1SRE/#36-what-is-distributed-tracing-and-how-do-you-use-it","title":"36. What is distributed tracing and how do you use it?","text":"<p>Distributed tracing tracks requests across microservices</p> <p>Tooling: OpenTelemetry, Jaeger, Zipkin</p> <p>Use Case</p> <ul> <li>Find latency bottlenecks</li> <li>Diagnose service dependencies</li> <li>Correlate logs and spans</li> </ul> <p>Output: Span trees with timestamps and service names</p>"},{"location":"2025/1SRE/#37-what-is-the-principle-of-least-privilege-in-access-control","title":"37. What is the principle of least privilege in access control?","text":"<p>Only give access necessary for a user/app to perform their task.</p> <p>Applies to:</p> <ul> <li>IAM roles</li> <li>Kubernetes RBAC</li> <li>API keys and credentials</li> </ul> <p>Improves security and reduces breach impact.</p>"},{"location":"2025/1SRE/#38-how-do-you-track-configuration-drift","title":"38. How do you track configuration drift?","text":"<p>Configuration drift occurs when systems diverge from declared state.</p> <p>Solutions:</p> <ul> <li>IaC enforcement (Terraform, Ansible)</li> <li>GitOps reconciliation loops</li> <li>Drift detection tools (e.g., Terraform Plan)</li> </ul> <p>Automated alerts and enforcement reduce risk.</p>"},{"location":"2025/1SRE/#39-what-is-alert-fatigue-and-how-do-you-combat-it","title":"39. What is alert fatigue and how do you combat it?","text":"<p>Alert fatigue happens when engineers receive too many irrelevant alerts.</p> <p>Solutions:</p> <ul> <li>Triage alerts into severity levels</li> <li>Silence non-critical alerts</li> <li>Use better thresholds and anomaly detection</li> <li>Run weekly alert review meetings</li> </ul> <p>Keep alerts actionable and minimal.</p>"},{"location":"2025/1SRE/#40-describe-the-incident-lifecycle","title":"40. Describe the incident lifecycle.","text":"<ol> <li>Detection (monitoring/alerts)</li> <li>Response (triage, mitigation)</li> <li>Resolution (restore service)</li> <li>Postmortem (blameless, documented)</li> <li>Action Items (to prevent recurrence)</li> </ol> <p>Tools: PagerDuty, Slack, Statuspage</p>"},{"location":"2025/1SRE/#41-how-do-you-design-a-high-availability-system","title":"41. How do you design a high-availability system?","text":"<p>High availability (HA) ensures minimal downtime. Key components:</p> <ul> <li>Redundancy: Use multiple instances/load balancers</li> <li>Failover mechanisms: Auto switch on failure</li> <li>Health checks: Remove unhealthy nodes</li> <li>Geographic distribution: Multi-region or zone setup</li> <li>Stateless design: Easier failover</li> </ul> <p>Use services like AWS ALB, Azure Availability Zones, or Kubernetes with anti-affinity rules.</p>"},{"location":"2025/1SRE/#43-how-do-you-scale-systems-to-handle-sudden-traffic-spikes","title":"43. How do you scale systems to handle sudden traffic spikes?","text":"<p>Strategies:</p> <ul> <li>Auto-scaling groups (AWS ASG, K8s HPA)</li> <li>Queueing mechanisms (SQS, RabbitMQ)</li> <li>CDN offloading (Cloudflare, Akamai)</li> <li>Caching (Redis, Varnish)</li> <li>Pre-warm critical services (Lambda provisioned concurrency)</li> </ul> <p>Plan ahead with load testing and scale limit</p>"},{"location":"2025/1SRE/#44-whats-the-purpose-of-an-error-budget-and-how-do-you-enforce-it","title":"44. What\u2019s the purpose of an error budget, and how do you enforce it?","text":"<p>Error budget = 100% - SLO target (e.g., 99.9% SLO \u2192 0.1% budget for failure)</p> <p>Usage</p> <ul> <li>Track system reliability</li> <li>Pause deployments if budget exhausted</li> <li>Encourage balance between innovation and reliability</li> </ul> <p>Monitored via dashboards; decisions tied to deployment frequency</p>"},{"location":"2025/1SRE/#45-how-do-you-handle-ephemeral-environments-for-testing","title":"45. How do you handle ephemeral environments for testing?","text":"<p>Ephemeral environments are temporary, disposable staging/test setups.</p> <p>Tools: </p> <ul> <li>Terraform with short TTL</li> <li>Preview environments via CI (e.g., GitHub Actions, GitLab)</li> <li>Use Kubernetes namespaces per PR</li> </ul> <p>Benefits: consistent testing, cost efficiency, no long-lived test infra</p>"},{"location":"2025/1SRE/#46-how-do-you-monitor-service-dependencies-in-microservices","title":"46. How do you monitor service dependencies in microservices?","text":"<ul> <li>Distributed tracing (OpenTelemetry, Jaeger)</li> <li>Service mesh observability (Istio, Linkerd)</li> <li>Dependency graphs (e.g., Dynatrace, New Relic)</li> </ul>"},{"location":"2025/1SRE/#49-what-is-auto-remediation-and-give-examples","title":"49. What is auto-remediation, and give examples.","text":"<p>Auto-remediation automates incident response without human intervention.</p> <p>Examples: </p> <ul> <li>Restart a crashed pod via K8s liveness probe</li> <li>Auto scale on high CPU usage</li> <li>Replace failed EC2 instance using ASG</li> <li>Lambda function to restart service on failure alert</li> </ul> <p>Helps reduce MTTR and improve uptime.</p>"},{"location":"2025/1SRE/#50-how-do-you-prepare-for-major-product-launches-from-an-sre-perspective","title":"50. How do you prepare for major product launches from an SRE perspective?","text":"<ul> <li>Load testing: Predict traffic behavior</li> <li>Chaos drills: Validate resilience</li> <li>Capacity planning: Scale resources ahead</li> <li>Rollback plan: Tested and ready</li> <li>Observability checks: Dashboards, alerts verified</li> <li>On-call rotation: Adjusted for event</li> </ul>"},{"location":"2025/1SRE/#sre-incident-response-troubleshooting","title":"SRE Incident Response &amp; Troubleshooting","text":""},{"location":"2025/1SRE/#1-you-discover-that-a-recent-config-change-was-deployed-without-proper-testing-the-system-is-unstable-how-do-you-respond","title":"1 You discover that a recent config change was deployed without proper testing. The system is unstable. How do you respond?","text":"<p>First, identify the change using version control or deployment logs to understand what was altered. Communicate with stakeholders immediately to inform them of the issue. Attempt a rollback if the change is reversible and known to be the cause. </p> <p>If rollback is not feasible, deploy a hotfix to stabilize the system. Implement a temporary mitigation to reduce impact while a permanent fix is developed. </p> <p>After the incident, conduct a post-mortem to reinforce pre-deployment validation, code reviews, and automated testing policies</p>"},{"location":"2025/1SRE/#2-your-service-is-intermittently-returning-403-errors-to-authenticated-users-how-do-you-debug-and-resolve-this","title":"2 Your service is intermittently returning 403 errors to authenticated users. How do you debug and resolve this?","text":"<p>Start by verifying authentication and authorization systems: </p> <ul> <li>check if access tokens are valid and haven't expired.</li> <li>Review logs for 403 errors and identify affected users.</li> <li>Inspect access control logic in code or policies to ensure correct permissions are applied.</li> <li>Investigate recent changes in IAM roles, reverse proxy configurations, and WAF rules.</li> <li>Use A/B testing or rollback to validate if a recent change caused the issue.</li> </ul>"},{"location":"2025/1SRE/#3-a-traffic-spike-is-causing-cascading-failures-in-your-microservices-how-do-you-stabilize-the-system","title":"3 A traffic spike is causing cascading failures in your microservices. How do you stabilize the system?","text":"<ul> <li>Begin by activating rate limiting to control incoming traffic and avoid overloading services.</li> <li>Enable circuit breakers to prevent overworked services from impacting others. </li> <li>Temporarily scale up critical services or use caching/CDNs to offload traffic. </li> <li>Use a load balancer to shed non-essential load. </li> <li>Once stabilized, perform root cause analysis and implement auto-scaling rules and service isolation to prevent recurrence</li> </ul>"},{"location":"2025/1SRE/#4-you-receive-alerts-during-a-region-wide-cloud-provider-outage-whats-your-course-of-action","title":"4 You receive alerts during a region-wide cloud provider outage. What\u2019s your course of action?","text":"<ul> <li>Immediately verify the extent of the outage via status pages and logs. </li> <li>If multi-region support is in place, initiate failover to an unaffected region. </li> <li>Communicate with customers about the outage and mitigation steps. </li> <li>Update DNS configurations or use traffic director services to reroute traffic. </li> <li>After restoration, audit disaster recovery plans and ensure better redundancy.</li> </ul>"},{"location":"2025/1SRE/#5-a-rollback-didnt-resolve-a-production-issue-whats-your-next-step","title":"5 A rollback didn\u2019t resolve a production issue. What\u2019s your next step?","text":"<ul> <li>Validate that the rollback was successful and all related components were included.</li> <li>Investigate logs for any new or persisting errors. </li> <li>Consider non-code causes like corrupted data, environment mismatches, or background jobs. </li> </ul> <p>Escalate the incident with a war room approach, involving cross-functional teams.  Use observability tools to trace the problem and plan a new remediation strategy.</p>"},{"location":"2025/1SRE/#6-your-cdn-is-returning-stale-content-after-a-deployment-how-do-you-troubleshoot","title":"6 Your CDN is returning stale content after a deployment. How do you troubleshoot?","text":"<ul> <li>Purge the CDN cache manually or via its API. </li> <li>Review cache-control headers and ensure they are correctly configured. </li> <li>Verify if content versioning is used; if not, implement it using file hashes or query strings. </li> <li>Monitor the CDN for cache hit/miss rates to validate the fix.</li> </ul>"},{"location":"2025/1SRE/#7-an-internal-service-has-exceeded-its-api-rate-limits-how-do-you-resolve-it-and-prevent-recurrence","title":"7 An internal service has exceeded its API rate limits. How do you resolve it and prevent recurrence?","text":"<ul> <li>Throttle or queue requests to reduce load on the API.</li> <li>If external, contact the API provider for temporary relief.</li> <li>Implement exponential backoff and retry logic.</li> <li>Monitor usage patterns and apply quotas to internal clients.</li> <li>Long-term, work on optimizing request frequency and introducing caching where possible.</li> </ul>"},{"location":"2025/1SRE/#8-a-monitoring-tool-itself-has-gone-down-how-do-you-ensure-visibility-during-the-incident","title":"8 A monitoring tool itself has gone down. How do you ensure visibility during the incident?","text":"<ul> <li>Fallback to alternative monitoring like cloud-native metrics, system logs, or backup observability stacks. </li> <li>Deploy lightweight agents that push logs/metrics to a temporary dashboard. </li> <li>Prioritize restoring the main monitoring system and ensure its future availability by setting up redundancy and health checks.</li> </ul>"},{"location":"2025/1SRE/#9-your-application-suddenly-has-a-spike-in-retries-and-timeouts-whats-your-investigative-strategy","title":"9 Your application suddenly has a spike in retries and timeouts. What\u2019s your investigative strategy?","text":"<ul> <li>Start by analyzing metrics and logs to pinpoint where the timeouts occur. </li> <li>Use distributed tracing to identify slow or failing dependencies. </li> <li>Validate network performance and DNS resolution.</li> <li>Check if retries are causing a feedback loop.</li> <li>Investigate recent deployments or changes that could be affecting latency.</li> </ul>"},{"location":"2025/1SRE/#2-reliability-performance-optimization","title":"2 Reliability &amp; Performance Optimization","text":""},{"location":"2025/1SRE/#1-your-system-is-hitting-database-connection-pool-limits-how-do-you-investigate-and-mitigate","title":"1 Your system is hitting database connection pool limits. How do you investigate and mitigate?","text":"<ul> <li>Start by examining application logs and DB metrics to confirm connection exhaustion. </li> <li>Use connection pool monitoring tools to identify connection leaks or long-running queries.</li> <li>Optimize queries and database indexing. If appropriate, increase pool size, and introduce caching to reduce load. </li> <li>Consider horizontal scaling (read replicas) to distribute read traffic</li> </ul>"},{"location":"2025/1SRE/#2-a-regional-failover-succeeded-but-users-reported-increased-latency-what-improvements-would-you-make","title":"2 A regional failover succeeded, but users reported increased latency. What improvements would you make?","text":"<ul> <li>Review DNS TTLs and global routing policies. </li> <li>Evaluate whether the backup region\u2019s infrastructure is warm or cold-start. </li> <li>Pre-warm instances, replicate caches, and sync data to reduce failover time. </li> <li>Implement geo-based routing or anycast to serve users from the nearest healthy location.</li> </ul>"},{"location":"2025/1SRE/#3-a-memory-intensive-process-is-causing-gc-thrashing-how-would-you-fix-this","title":"3 A memory-intensive process is causing GC thrashing. How would you fix this?","text":"<ul> <li>Use profiling tools to analyze heap usage and identify memory leaks or excessive object creation. </li> <li>Tune JVM/GC parameters or experiment with different garbage collectors.</li> <li>Refactor the code to reduce memory pressure and optimize object lifecycle management</li> </ul>"},{"location":"2025/1SRE/#4-your-app-needs-to-support-zero-downtime-deployments-but-users-experience-brief-disruptions-how-do-you-fix-that","title":"4 Your app needs to support zero-downtime deployments, but users experience brief disruptions. How do you fix that?","text":"<ul> <li>Switch to deployment strategies like blue-green or canary releases. </li> <li>Ensure proper load balancer configuration to drain connections before shutting down old instances. </li> <li>Configure readiness and liveness probes to avoid routing traffic to unhealthy pods/instances during rollout.</li> </ul>"},{"location":"2025/1SRE/#5-how-would-you-introduce-chaos-testing-into-a-mission-critical-environment","title":"5 How would you introduce chaos testing into a mission-critical environment?","text":"<ul> <li>Begin in non-production environments to validate resilience. Use tools like Chaos Mesh or Gremlin. </li> <li>Start with basic failure scenarios like network latency or service termination. </li> <li>Gain stakeholder buy-in, then gradually expand chaos coverage in production with strict guardrails and observability.</li> </ul>"},{"location":"2025/1SRE/#6-you-need-to-migrate-a-high-availability-service-to-a-new-cloud-provider-whats-your-plan","title":"6 You need to migrate a high-availability service to a new cloud provider. What\u2019s your plan?","text":"<ul> <li>Plan a phased migration starting with infrastructure setup in the new provider. </li> <li>Use tools for data replication and live sync. Validate performance and failover readiness before DNS cutover. </li> <li>Ensure rollback mechanisms are in place. </li> <li>Use blue-green or shadow traffic testing to validate live behavior before the switch.</li> </ul>"},{"location":"2025/1SRE/#7-a-background-job-is-starving-the-main-thread-of-resources-how-do-you-diagnose-and-resolve-it","title":"7 A background job is starving the main thread of resources. How do you diagnose and resolve it?","text":"<ul> <li>Use performance profilers to inspect thread and CPU usage. </li> <li>Isolate the background job to a separate process or thread pool. </li> <li>Throttle its execution or reduce its priority. </li> <li>Optimize its resource consumption to prevent interference with critical user-facing processes.</li> </ul>"},{"location":"2025/1SRE/#8-your-system-is-slow-under-load-but-resource-metrics-look-fine-whats-your-next-move","title":"8 Your system is slow under load, but resource metrics look fine. What\u2019s your next move?","text":"<ul> <li>Investigate lock contention, thread starvation, or database queuing using profiling tools. </li> <li>Use APM to trace slow transactions and measure application-level bottlenecks. </li> <li>Consider synthetic load tests to simulate real traffic and identify bottlenecks not visible via CPU or memory metrics.</li> </ul>"},{"location":"2025/1SRE/#9-your-application-caches-are-not-invalidating-properly-how-do-you-handle-cache-staleness","title":"9 Your application caches are not invalidating properly. How do you handle cache staleness?","text":"<ul> <li>Check if the cache keys and TTLs are correctly defined. </li> <li>Use cache versioning or add event-based invalidation via message queues. </li> <li>Monitor cache hit/miss ratio and design fallbacks for stale data scenarios. </li> <li>Use distributed cache tools that support advanced eviction strategies.</li> </ul>"},{"location":"2025/1SRE/#10-monitoring-observability-automation","title":"10 Monitoring, Observability &amp; Automation","text":""},{"location":"2025/1SRE/#1-your-alerts-are-not-capturing-a-slow-memory-leak-that-causes-a-crash-after-days-of-uptime-how-do-you-refine-observability","title":"1 Your alerts are not capturing a slow memory leak that causes a crash after days of uptime. How do you refine observability?","text":"<ul> <li>Introduce trend-based alerting by analyzing memory usage over long time windows.</li> <li>Increase metric collection granularity. Capture heap snapshots and perform differential</li> <li>analysis. Consider integrating continuous profiling tools to detect leaks early.</li> </ul>"},{"location":"2025/1SRE/#2-you-need-to-create-slos-for-a-service-with-varying-usage-patterns-how-do-you-define-them","title":"2 You need to create SLOs for a service with varying usage patterns. How do you define them?","text":"<ul> <li>Segment the user base or request types and define custom SLOs for each segment. </li> <li>Use percentile-based metrics like p95/p99 latency.</li> <li>Calculate error budgets aligned with business priorities. </li> <li>Regularly revisit SLOs based on evolving usage patterns</li> </ul>"},{"location":"2025/1SRE/#3-a-team-reports-inconsistent-metrics-between-dashboards-how-do-you-validate-data-sources","title":"3 A team reports inconsistent metrics between dashboards. How do you validate data sources?","text":"<ul> <li>Audit the data collection agents, aggregation intervals, and label configurations. </li> <li>Verify if the dashboards use the same queries and time windows. </li> <li>Compare metrics directly from source (e.g., Prometheus) to rule out UI-related issues.</li> </ul>"},{"location":"2025/1cicd/","title":"1 CI/CD \u4e4b\u8def &amp; GitOps \u9762\u8bd5\u9898\u5408\u96c6","text":""},{"location":"2025/1cicd/#1-cicd","title":"1 CI/CD \u4e4b\u8def","text":""},{"location":"2025/1cicd/#1-cicd-cd-vs-vs","title":"1. \u89e3\u91ca CI\u3001CD \u548c CD \u7684\u533a\u522b\uff08\u6301\u7eed\u96c6\u6210 vs. \u6301\u7eed\u4ea4\u4ed8 vs. \u6301\u7eed\u90e8\u7f72\uff09","text":"<ul> <li>\u6301\u7eed\u96c6\u6210\uff08CI\uff09\uff1a\u9891\u7e41\u5c06\u4ee3\u7801\u53d8\u66f4\u5408\u5e76\u5230\u4e3b\u5e72\u5206\u652f\uff0c\u901a\u8fc7\u81ea\u52a8\u5316\u6d4b\u8bd5\u5feb\u901f\u53d1\u73b0\u9519\u8bef\u3002</li> <li>\u6301\u7eed\u4ea4\u4ed8\uff08CD\uff09\uff1a\u5728 CI \u57fa\u7840\u4e0a\uff0c\u786e\u4fdd\u4ee3\u7801\u59cb\u7ec8\u5904\u4e8e\u53ef\u90e8\u7f72\u72b6\u6001\uff0c\u4f46\u9700\u624b\u52a8\u89e6\u53d1\u90e8\u7f72</li> <li>\u6301\u7eed\u90e8\u7f72\uff08CD\uff09\uff1a\u5b8c\u5168\u81ea\u52a8\u5316\uff0c\u4ee3\u7801\u901a\u8fc7\u6d4b\u8bd5\u540e\u81ea\u52a8\u90e8\u7f72\u5230\u751f\u4ea7\u73af\u5883</li> </ul>"},{"location":"2025/1cicd/#2-cicd","title":"2. CI/CD \u7684\u6838\u5fc3\u4ef7\u503c\u662f\u4ec0\u4e48\uff1f\u5982\u4f55\u8861\u91cf\u5176\u6210\u529f\uff1f","text":"<p>\u6838\u5fc3\u4ef7\u503c\uff1a</p> <ul> <li>\u5feb\u901f\u53cd\u9988\uff0c\u51cf\u5c11\u96c6\u6210\u98ce\u9669\u3002</li> <li>\u7f29\u77ed\u4ea4\u4ed8\u5468\u671f\uff0c\u63d0\u5347\u8f6f\u4ef6\u8d28\u91cf\u3002</li> </ul> <p>\u8861\u91cf\u6307\u6807\uff1a</p> <ul> <li>\u6784\u5efa\u6210\u529f\u7387\u3001\u6d4b\u8bd5\u8986\u76d6\u7387\u3001\u90e8\u7f72\u9891\u7387\u3001\u5e73\u5747\u6062\u590d\u65f6\u95f4\uff08MTTR\uff09\u3002</li> </ul>"},{"location":"2025/1cicd/#3-cicd-jenkinsgitlab-ci-github-actions","title":"3. \u5217\u4e3e\u5e38\u89c1\u7684 CI/CD \u5de5\u5177\uff0c\u5e76\u6bd4\u8f83 Jenkins\u3001GitLab CI \u548c GitHub Actions \u7684\u4f18\u7f3a\u70b9","text":"<p>Jenkins\uff1a</p> <ul> <li>\u4f18\u70b9\uff1a\u63d2\u4ef6\u751f\u6001\u4e30\u5bcc\uff0c\u9ad8\u5ea6\u53ef\u5b9a\u5236\u3002</li> <li>\u7f3a\u70b9\uff1a\u914d\u7f6e\u590d\u6742\uff0c\u9700\u81ea\u884c\u7ef4\u62a4\u670d\u52a1\u5668\u3002</li> </ul> <p>GitLab CI\uff1a</p> <ul> <li>\u4f18\u70b9\uff1a\u4e0e GitLab \u6df1\u5ea6\u96c6\u6210\uff0cYAML \u914d\u7f6e\u7b80\u6d01\u3002</li> <li>\u7f3a\u70b9\uff1a\u591a\u4e91\u652f\u6301\u8f83\u5f31\u3002</li> </ul> <p>GitHub Actions\uff1a</p> <ul> <li>\u4f18\u70b9\uff1a\u539f\u751f\u96c6\u6210 GitHub\uff0c\u5e02\u573a\u5171\u4eab Action \u4e30\u5bcc\u3002</li> <li>\u7f3a\u70b9\uff1a\u5bf9\u79c1\u6709\u4ed3\u5e93\u6709\u9650\u5236\uff0c\u6210\u672c\u8f83\u9ad8\u3002</li> </ul>"},{"location":"2025/1cicd/#4-cicd","title":"4. \u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a CI/CD \u6d41\u6c34\u7ebf\uff1f\u5173\u952e\u9636\u6bb5\u6709\u54ea\u4e9b\uff1f","text":"<p>\u9636\u6bb5\u8bbe\u8ba1\uff1a</p> <ol> <li>\u4ee3\u7801\u63d0\u4ea4\u4e0e\u89e6\u53d1\uff08\u5982 Git Hook\uff09\u3002</li> <li>\u4ee3\u7801\u9759\u6001\u68c0\u67e5\uff08SonarQube\u3001ESLint\uff09\u3002</li> <li>\u6784\u5efa\u4e0e\u6253\u5305\uff08Maven\u3001Docker\uff09\u3002</li> <li>\u81ea\u52a8\u5316\u6d4b\u8bd5\uff08\u5355\u5143\u6d4b\u8bd5\u3001\u96c6\u6210\u6d4b\u8bd5\uff09\u3002</li> <li>\u90e8\u7f72\u5230\u9884\u53d1\u5e03\u73af\u5883\uff08\u5982 Kubernetes\uff09\u3002</li> <li>\u4eba\u5de5\u5ba1\u6279\uff08\u6301\u7eed\u4ea4\u4ed8\uff09\u6216\u81ea\u52a8\u53d1\u5e03\uff08\u6301\u7eed\u90e8\u7f72\uff09\u3002</li> <li>\u76d1\u63a7\u4e0e\u56de\u6eda\uff08Prometheus\u3001Rollback \u7b56\u7565\uff09\u3002</li> </ol>"},{"location":"2025/1cicd/#5-cicd","title":"5. \u5982\u4f55\u4f18\u5316 CI/CD \u6d41\u6c34\u7ebf\u7684\u6267\u884c\u901f\u5ea6\uff1f","text":"<ul> <li>\u5e76\u884c\u5316\u4efb\u52a1\uff1a\u62c6\u5206\u6d4b\u8bd5\u7528\u4f8b\u5230\u591a\u4e2a Job \u5e76\u884c\u6267\u884c\u3002</li> <li>\u7f13\u5b58\u4f9d\u8d56\uff1a\u7f13\u5b58 Maven/Gradle \u4f9d\u8d56\u3001Docker \u955c\u50cf\u5c42\u3002</li> <li>\u589e\u91cf\u6784\u5efa\uff1a\u4ec5\u6784\u5efa\u53d8\u66f4\u6a21\u5757\uff08\u5982 monorepo \u7b56\u7565\uff09\u3002</li> <li>\u4f7f\u7528\u66f4\u5feb\u7684\u786c\u4ef6\uff1a\u5982\u4e13\u7528\u6784\u5efa\u670d\u52a1\u5668\u6216\u4e91\u6258\u7ba1 Runner\u3002</li> </ul>"},{"location":"2025/1cicd/#6","title":"6. \u5982\u4f55\u5904\u7406\u6d41\u6c34\u7ebf\u4e2d\u7684\u201c\u6784\u5efa\u6210\u529f\u4f46\u90e8\u7f72\u5931\u8d25\u201d\u95ee\u9898\uff1f","text":"<ol> <li>\u65e5\u5fd7\u5206\u6790\uff1a\u68c0\u67e5\u90e8\u7f72\u9636\u6bb5\u65e5\u5fd7\uff08\u5982 Kubernetes Pod \u4e8b\u4ef6\uff09\u3002</li> <li>\u73af\u5883\u4e00\u81f4\u6027\uff1a\u786e\u4fdd\u9884\u53d1\u5e03\u4e0e\u751f\u4ea7\u73af\u5883\u914d\u7f6e\u4e00\u81f4\u3002</li> <li>\u56de\u6eda\u673a\u5236\uff1a\u81ea\u52a8\u56de\u6eda\u5230\u4e0a\u4e00\u4e2a\u7a33\u5b9a\u7248\u672c\u3002</li> <li>\u5065\u5eb7\u68c0\u67e5\uff1a\u90e8\u7f72\u540e\u9a8c\u8bc1\u670d\u52a1\u5065\u5eb7\u72b6\u6001\uff08\u5982 HTTP \u63a2\u9488\uff09</li> </ol>"},{"location":"2025/1cicd/#7-cicd-shift-left-security","title":"7. \u5982\u4f55\u5728 CI/CD \u4e2d\u5b9e\u73b0\u5b89\u5168\u5de6\u79fb\uff08Shift Left Security\uff09\uff1f","text":"<p>\u9636\u6bb5\u96c6\u6210 \uff1a</p> <ul> <li>\u4ee3\u7801\u626b\u63cf\uff1aSAST \u5de5\u5177\uff08\u5982 Snyk\u3001Checkmarx\uff09\u3002</li> <li>\u4f9d\u8d56\u68c0\u67e5\uff1aSCA \u5de5\u5177\uff08\u5982 OWASP Dependency-Check\uff09\u3002</li> <li>\u955c\u50cf\u626b\u63cf\uff1aTrivy \u68c0\u67e5 Docker \u955c\u50cf\u6f0f\u6d1e\u3002</li> <li>\u5bc6\u94a5\u7ba1\u7406\uff1a\u4f7f\u7528 Vault \u6216 Secrets Manager \u6ce8\u5165\u654f\u611f\u4fe1\u606f\u3002</li> </ul>"},{"location":"2025/1cicd/#8-cicd","title":"8. \u5728\u591a\u4e91\u73af\u5883\u4e2d\u5982\u4f55\u8bbe\u8ba1 CI/CD \u6d41\u7a0b\uff1f","text":"<ul> <li>\u62bd\u8c61\u5316\u90e8\u7f72\uff1a\u901a\u8fc7 Terraform \u6216 Crossplane \u7edf\u4e00\u591a\u4e91\u8d44\u6e90\u7f16\u6392\u3002</li> <li>\u5de5\u5177\u4e2d\u7acb\u6027\uff1a\u9009\u62e9\u652f\u6301\u591a\u4e91\u7684 CI/CD \u5de5\u5177\uff08\u5982 Argo CD\uff09\u3002</li> <li>\u73af\u5883\u9694\u79bb\uff1a\u4e3a\u6bcf\u4e2a\u4e91\u73af\u5883\u914d\u7f6e\u72ec\u7acb\u7684\u6d41\u6c34\u7ebf\u9636\u6bb5</li> </ul>"},{"location":"2025/1cicd/#9-cicd","title":"9. \u5982\u4f55\u5904\u7406 CI/CD \u4e2d\u7684\u5931\u8d25\u6784\u5efa\u6216\u90e8\u7f72\uff1f","text":"<p>\u5904\u7406\u5931\u8d25\u6784\u5efa\u6216\u90e8\u7f72\u7684\u5173\u952e\u662f\u5feb\u901f\u8bca\u65ad\u5e76\u6062\u590d\u7cfb\u7edf\uff1a</p> <ul> <li>\u6784\u5efa\u5931\u8d25\uff1a\u68c0\u67e5\u6784\u5efa\u65e5\u5fd7\uff0c\u786e\u8ba4\u5931\u8d25\u7684\u539f\u56e0\uff08\u5982\u4ee3\u7801\u9519\u8bef\u3001\u4f9d\u8d56\u95ee\u9898\uff09\u3002\u5982\u679c\u662f\u4ee3\u7801\u95ee\u9898\uff0c\u5f00\u53d1\u4eba\u5458\u4fee\u590d\u5e76\u91cd\u65b0\u63d0\u4ea4\u3002\u82e5\u662f\u4f9d\u8d56\u95ee\u9898\uff0c\u786e\u4fdd\u4f9d\u8d56\u5e93\u7684\u7248\u672c\u6b63\u786e\u3002</li> <li>\u90e8\u7f72\u5931\u8d25\uff1a\u67e5\u770b\u90e8\u7f72\u65e5\u5fd7\uff0c\u786e\u8ba4\u90e8\u7f72\u5931\u8d25\u7684\u5177\u4f53\u539f\u56e0\uff08\u5982\u8d44\u6e90\u4e0d\u8db3\u3001\u914d\u7f6e\u9519\u8bef\uff09\u3002\u901a\u8fc7\u56de\u6eda\u64cd\u4f5c\u6062\u590d\u5230\u4e0a\u4e00\u4e2a\u7a33\u5b9a\u7248\u672c\uff0c\u5e76\u89e3\u51b3\u95ee\u9898\u540e\u91cd\u65b0\u90e8\u7f72\u3002</li> </ul>"},{"location":"2025/1cicd/#10-cicd","title":"10. CI/CD \u6d41\u7a0b\u4e2d\u5982\u4f55\u5b9e\u73b0\u5e76\u53d1\u6784\u5efa\u6216\u90e8\u7f72\uff1f","text":"<p>\u4e3a\u4e86\u63d0\u9ad8 CI/CD \u6d41\u7a0b\u7684\u6548\u7387\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5e76\u53d1\u6784\u5efa\u6216\u90e8\u7f72\uff1a</p> <ul> <li>\u5e76\u53d1\u6784\u5efa\uff1a\u5728 CI \u5de5\u5177\u4e2d\u914d\u7f6e\u5e76\u53d1\u6784\u5efa\uff08\u5982 Jenkins \u5e76\u53d1\u6267\u884c\u591a\u4e2a\u6784\u5efa\u4efb\u52a1\uff09\uff0c\u4f7f\u7528\u8d44\u6e90\u6c60\u5e76\u884c\u6784\u5efa\u4e0d\u540c\u7684\u5206\u652f\u6216\u7248\u672c\u3002</li> <li>\u5e76\u53d1\u90e8\u7f72\uff1a\u4f7f\u7528\u84dd\u7eff\u90e8\u7f72\u3001\u6eda\u52a8\u90e8\u7f72\u7b49\u7b56\u7565\uff0c\u53ef\u4ee5\u5728\u4e0d\u5f71\u54cd\u73b0\u6709\u73af\u5883\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u5e76\u53d1\u90e8\u7f72\u3002</li> </ul>"},{"location":"2025/1cicd/#11-cicd","title":"11: \u8bbe\u8ba1\u4e00\u4e2a\u652f\u6301\u767e\u4e07\u7ea7\u7528\u6237\u7cfb\u7edf\u7684 CI/CD \u67b6\u6784","text":"<ul> <li>\u5206\u5e03\u5f0f\u6784\u5efa\uff1a\u4f7f\u7528 Jenkins \u96c6\u7fa4\u6216 Tekton \u6a2a\u5411\u6269\u5c55\u3002</li> <li>\u84dd\u7eff\u90e8\u7f72\uff1a\u901a\u8fc7 Istio \u6216 Kubernetes \u5b9e\u73b0\u96f6\u505c\u673a\u53d1\u5e03\u3002</li> <li>\u6df7\u6c8c\u5de5\u7a0b\uff1a\u96c6\u6210 Chaos Monkey \u9a8c\u8bc1\u7cfb\u7edf\u5bb9\u9519\u6027\u3002</li> </ul>"},{"location":"2025/1cicd/#12-cicd-progressive-delivery","title":"12: \u5982\u4f55\u5b9e\u73b0 CI/CD \u4e2d\u7684\u6e10\u8fdb\u5f0f\u4ea4\u4ed8\uff08Progressive Delivery\uff09\uff1f","text":"<ul> <li>\u91d1\u4e1d\u96c0\u53d1\u5e03\uff1a\u9010\u6b65\u5c06\u6d41\u91cf\u5207\u5230\u65b0\u7248\u672c\uff08\u5982 Flagger\uff09\u3002</li> <li>\u529f\u80fd\u5f00\u5173\uff08Feature Flags\uff09\uff1a\u901a\u8fc7 LaunchDarkly \u63a7\u5236\u529f\u80fd\u7070\u5ea6\u3002</li> <li>A/B \u6d4b\u8bd5\uff1a\u7ed3\u5408\u6570\u636e\u5206\u6790\u9a8c\u8bc1\u7248\u672c\u6548\u679c\u3002</li> </ul>"},{"location":"2025/1cicd/#13-cicd","title":"13. \u4ec0\u4e48\u662f CI/CD\uff0c\u4e3a\u4ec0\u4e48\u5b83\u4eec\u5bf9\u5f00\u53d1\u6d41\u7a0b\u5f88\u91cd\u8981\uff1f","text":"<p>CI/CD \u4ee3\u8868 \u6301\u7eed\u96c6\u6210\uff08Continuous Integration\uff09\u548c \u6301\u7eed\u4ea4\u4ed8\uff08Continuous Delivery\uff09\u3002</p> <ul> <li>\u6301\u7eed\u96c6\u6210 \u662f\u6307\u5f00\u53d1\u4eba\u5458\u9891\u7e41\u5c06\u4ee3\u7801\u96c6\u6210\u5230\u4e3b\u5e72\u4e2d\uff0c\u901a\u5e38\u6bcf\u5929\u591a\u6b21\u3002CI \u901a\u8fc7\u81ea\u52a8\u5316\u6d4b\u8bd5\u548c\u6784\u5efa\u8fc7\u7a0b\uff0c\u786e\u4fdd\u96c6\u6210\u540e\u7684\u4ee3\u7801\u8d28\u91cf\u5e76\u51cf\u5c11\u96c6\u6210\u95ee\u9898\u3002</li> <li>\u6301\u7eed\u4ea4\u4ed8 \u662f\u6307\u5c06\u7ecf\u8fc7\u81ea\u52a8\u5316\u6d4b\u8bd5\u7684\u4ee3\u7801\u81ea\u52a8\u90e8\u7f72\u5230\u751f\u4ea7\u73af\u5883\u7684\u51c6\u5907\u72b6\u6001\uff0c\u4f7f\u5f97\u4ee3\u7801\u80fd\u591f\u968f\u65f6\u4ea4\u4ed8\u7ed9\u7528\u6237</li> </ul> <p>CI/CD \u63d0\u9ad8\u4e86\u8f6f\u4ef6\u5f00\u53d1\u7684\u6548\u7387\uff0c\u51cf\u5c11\u4e86\u4eba\u4e3a\u9519\u8bef\uff0c\u786e\u4fdd\u66f4\u9ad8\u8d28\u91cf\u7684\u4ee3\u7801\uff0c\u5e76\u4f7f\u5f97\u53d1\u5e03\u66f4\u9891\u7e41\u3001\u53ef\u9760\u3002</p>"},{"location":"2025/1cicd/#14-ci-cd","title":"14. CI \u548c CD \u6709\u4ec0\u4e48\u533a\u522b\uff1f","text":"<p>CI\uff08\u6301\u7eed\u96c6\u6210\uff09\uff1a\u5f00\u53d1\u4eba\u5458\u5c06\u4ee3\u7801\u9891\u7e41\u5730\u96c6\u6210\u5230\u4e3b\u5e72\u4e2d\uff0c\u901a\u5e38\u6bcf\u5929\u591a\u6b21\u3002\u6bcf\u6b21\u63d0\u4ea4\u65f6\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u6267\u884c\u6784\u5efa\u548c\u6d4b\u8bd5\uff0c\u4ee5\u786e\u4fdd\u4ee3\u7801\u6ca1\u6709\u7834\u574f\u73b0\u6709\u529f\u80fd\u3002</p> <p>CD\uff08\u6301\u7eed\u4ea4\u4ed8\uff09\uff1a\u662f\u6307\u81ea\u52a8\u5c06\u7ecf\u8fc7 CI \u6d41\u7a0b\u9a8c\u8bc1\u7684\u4ee3\u7801\u90e8\u7f72\u5230\u751f\u4ea7\u73af\u5883\uff0c\u786e\u4fdd\u4ee3\u7801\u968f\u65f6\u53ef\u4ee5\u53d1\u5e03\u3002\u6301\u7eed\u4ea4\u4ed8\u901a\u5e38\u5728 CI \u4e4b\u540e\u81ea\u52a8\u5316\u6267\u884c\uff0c\u4e5f\u53ef\u4ee5\u6307\u6301\u7eed\u90e8\u7f72\uff08\u81ea\u52a8\u5c06\u4ee3\u7801\u53d1\u5e03\u5230\u751f\u4ea7\u73af\u5883\uff09\u3002</p>"},{"location":"2025/1cicd/#15-cicd","title":"15. \u5728 CI/CD \u4e2d\uff0c\u81ea\u52a8\u5316\u6d4b\u8bd5\u7684\u4f5c\u7528\u662f\u4ec0\u4e48\uff1f","text":"<p>\u81ea\u52a8\u5316\u6d4b\u8bd5\u662f CI/CD \u6d41\u7a0b\u4e2d\u7684\u5173\u952e\u7ec4\u6210\u90e8\u5206\u3002\u5b83\u901a\u8fc7\u786e\u4fdd\u6bcf\u6b21\u63d0\u4ea4\u7684\u4ee3\u7801\u90fd\u901a\u8fc7\u81ea\u52a8\u5316\u6d4b\u8bd5\uff08\u5355\u5143\u6d4b\u8bd5\u3001\u96c6\u6210\u6d4b\u8bd5\u7b49\uff09\uff0c\u4ece\u800c\u63d0\u9ad8\u4ee3\u7801\u8d28\u91cf\uff0c\u51cf\u5c11\u96c6\u6210\u65f6\u7684\u9519\u8bef\u3002</p> <p>\u81ea\u52a8\u5316\u6d4b\u8bd5\u6709\u52a9\u4e8e\u53d1\u73b0\u6f5c\u5728\u7684 bug \u548c\u56de\u5f52\u95ee\u9898\uff0c\u786e\u4fdd\u6bcf\u4e2a\u7248\u672c\u90fd\u80fd\u5728\u53d1\u5e03\u4e4b\u524d\u901a\u8fc7\u5168\u9762\u7684\u9a8c\u8bc1\u3002</p>"},{"location":"2025/1cicd/#16-cicd","title":"16. \u4f60\u5e38\u7528\u54ea\u4e9b CI/CD \u5de5\u5177\uff1f\u5b83\u4eec\u6709\u4ec0\u4e48\u4f18\u7f3a\u70b9\uff1f","text":"<p>\u5e38\u7528\u7684 CI/CD \u5de5\u5177\u5305\u62ec\uff1a</p> <ul> <li>Jenkins\uff1a\u5f00\u6e90\u3001\u63d2\u4ef6\u4e30\u5bcc\uff0c\u652f\u6301\u81ea\u52a8\u5316\u6784\u5efa\u548c\u90e8\u7f72\u3002\u7f3a\u70b9\u662f\u9700\u8981\u624b\u52a8\u914d\u7f6e\u548c\u7ef4\u62a4\uff0c\u521d\u5b66\u8005\u53ef\u80fd\u4e0a\u624b\u8f83\u96be\u3002</li> <li>GitLab CI/CD\uff1a\u5185\u5efa\u4e8e GitLab \u4e2d\uff0c\u6613\u4e8e\u96c6\u6210\uff0c\u9002\u5408\u4e0e GitLab \u914d\u5408\u4f7f\u7528\u3002\u652f\u6301\u5f3a\u5927\u7684 DevOps \u6d41\u7a0b\uff0c\u4f46\u5bf9\u4e8e\u975e GitLab \u7528\u6237\u53ef\u80fd\u4e0d\u591f\u7075\u6d3b\u3002</li> <li>CircleCI\uff1a\u6613\u4e8e\u4f7f\u7528\uff0c\u5feb\u901f\u8bbe\u7f6e\uff0c\u652f\u6301\u4e0e GitHub\u3001Bitbucket \u96c6\u6210\uff0c\u9002\u5408\u5c0f\u56e2\u961f\u5feb\u901f\u5b9e\u73b0 CI/CD\u3002</li> <li>Travis CI\uff1a\u4e0e GitHub \u96c6\u6210\uff0c\u63d0\u4f9b\u7b80\u5355\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4f46\u53ef\u80fd\u5728\u5927\u9879\u76ee\u4e2d\u8868\u73b0\u4e0d\u5982\u5176\u4ed6\u5de5\u5177\u3002</li> <li>Azure DevOps\uff1a\u9002\u5408\u4f01\u4e1a\u7ea7\u5e94\u7528\uff0c\u96c6\u6210\u4e86\u5b8c\u6574\u7684\u5f00\u53d1\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002\u9002\u5408\u5fae\u8f6f\u4ea7\u54c1\u7684\u73af\u5883\uff0c\u529f\u80fd\u4e30\u5bcc\u4f46\u53ef\u80fd\u590d\u6742\u3002</li> </ul>"},{"location":"2025/1cicd/#17","title":"17. \u89e3\u91ca\u4ec0\u4e48\u662f\u201c\u84dd\u7eff\u90e8\u7f72\u201d\u548c\u201c\u6eda\u52a8\u90e8\u7f72\u201d\uff1f","text":"<ul> <li>\u84dd\u7eff\u90e8\u7f72\uff1a\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u7ef4\u62a4\u4e24\u4e2a\u76f8\u540c\u7684\u73af\u5883\uff0c\u84dd\u8272\u73af\u5883\u662f\u5f53\u524d\u8fd0\u884c\u7684\u751f\u4ea7\u7248\u672c\uff0c\u7eff\u8272\u73af\u5883\u662f\u51c6\u5907\u597d\u63a5\u6536\u65b0\u7248\u672c\u7684\u73af\u5883\u3002\u5728\u53d1\u5e03\u65b0\u7248\u672c\u65f6\uff0c\u9996\u5148\u5c06\u5e94\u7528\u90e8\u7f72\u5230\u7eff\u8272\u73af\u5883\uff0c\u4e00\u65e6\u9a8c\u8bc1\u6210\u529f\uff0c\u901a\u8fc7\u5207\u6362\u6d41\u91cf\u5b9e\u73b0\u65e0\u7f1d\u8fc7\u6e21\u3002</li> <li>\u6eda\u52a8\u90e8\u7f72\uff1a\u9010\u6b65\u66f4\u65b0\u73b0\u6709\u7684\u751f\u4ea7\u73af\u5883\uff0c\u5c06\u65b0\u7248\u672c\u9010\u6b65\u63a8\u9001\u5230\u751f\u4ea7\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u3002\u6eda\u52a8\u90e8\u7f72\u53ef\u4ee5\u51cf\u5c11\u5355\u70b9\u6545\u969c\u7684\u98ce\u9669\uff0c\u4f46\u53ef\u80fd\u9700\u8981\u66f4\u957f\u65f6\u95f4\u5b8c\u6210\u66f4\u65b0\u3002</li> </ul>"},{"location":"2025/1cicd/#18-cicd","title":"18. \u4ec0\u4e48\u662f\u201c\u56de\u6eda\u201d\u64cd\u4f5c\uff0c\u5728 CI/CD \u4e2d\u5982\u4f55\u5b9e\u73b0\uff1f","text":"<p>\u56de\u6eda\u662f\u6307\u5c06\u7cfb\u7edf\u6062\u590d\u5230\u4e0a\u4e00\u4e2a\u7a33\u5b9a\u7248\u672c\u7684\u8fc7\u7a0b\uff0c\u901a\u5e38\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u51fa\u73b0\u91cd\u5927\u9519\u8bef\u65f6\u6267\u884c\u3002</p> <p>\u5728 CI/CD \u6d41\u7a0b\u4e2d\uff0c\u56de\u6eda\u901a\u5e38\u901a\u8fc7\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u6216\u90e8\u7f72\u5de5\u5177\u5b9e\u73b0\u3002\u5927\u591a\u6570 CI/CD \u5de5\u5177\u90fd\u63d0\u4f9b\u56de\u6eda\u529f\u80fd\uff0c\u53ef\u4ee5\u5e2e\u52a9\u81ea\u52a8\u6062\u590d\u5230\u5148\u524d\u7684\u7248\u672c\uff0c\u786e\u4fdd\u7cfb\u7edf\u5feb\u901f\u6062\u590d</p>"},{"location":"2025/1cicd/#19-cd","title":"19. \u5982\u4f55\u5b9e\u73b0\u6301\u7eed\u4ea4\u4ed8\uff08CD\uff09\u7684\u81ea\u52a8\u5316\u90e8\u7f72\uff1f","text":"<ul> <li>\u4ee3\u7801\u63d0\u4ea4\uff1a\u5f00\u53d1\u4eba\u5458\u63d0\u4ea4\u4ee3\u7801\u5230\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u3002</li> <li>CI \u6784\u5efa\uff1a\u81ea\u52a8\u89e6\u53d1 CI \u6d41\u7a0b\uff0c\u8fdb\u884c\u4ee3\u7801\u6784\u5efa\u3001\u6d4b\u8bd5\u7b49\u3002</li> <li>Artifact \u751f\u6210\uff1a\u901a\u8fc7 CI \u5de5\u5177\u751f\u6210\u6784\u5efa\u7684\u4ea7\u7269\uff08\u5982 Docker \u955c\u50cf\u3001JAR \u6587\u4ef6\u7b49\uff09\u3002</li> <li>\u81ea\u52a8\u5316\u90e8\u7f72\uff1a\u901a\u8fc7 CI/CD \u5de5\u5177\uff08\u5982 Jenkins\u3001GitLab CI\u3001CircleCI \u7b49\uff09\u5c06\u6784\u5efa\u7684\u4ea7\u7269\u90e8\u7f72\u5230\u751f\u4ea7\u6216\u6d4b\u8bd5\u73af\u5883\u4e2d\uff0c\u5e76\u786e\u4fdd\u6574\u4e2a\u6d41\u7a0b\u53ef\u81ea\u52a8\u6267\u884c\u3002</li> <li>\u9a8c\u8bc1\u548c\u76d1\u63a7\uff1a\u81ea\u52a8\u5316\u90e8\u7f72\u540e\uff0c\u4f7f\u7528\u76d1\u63a7\u5de5\u5177\u786e\u4fdd\u90e8\u7f72\u6210\u529f\uff0c\u5e76\u901a\u8fc7\u81ea\u52a8\u5316\u6d4b\u8bd5\u9a8c\u8bc1\u90e8\u7f72\u662f\u5426\u6210\u529f\u3002</li> </ul>"},{"location":"2025/1cicd/#20-cicd","title":"20. \u5982\u4f55\u4fdd\u8bc1 CI/CD \u6d41\u7a0b\u4e2d\u7684\u5b89\u5168\u6027\uff1f","text":"<ul> <li>\u5bc6\u94a5\u7ba1\u7406\uff1a\u4f7f\u7528\u5b89\u5168\u7684\u5bc6\u94a5\u7ba1\u7406\u5de5\u5177\uff08\u5982 HashiCorp Vault\uff09\u6765\u7ba1\u7406\u654f\u611f\u4fe1\u606f\u548c\u5bc6\u94a5\uff0c\u907f\u514d\u5c06\u5bc6\u94a5\u786c\u7f16\u7801\u5728\u4ee3\u7801\u4e2d\u3002</li> <li>\u9759\u6001\u4ee3\u7801\u5206\u6790\uff1a\u96c6\u6210\u9759\u6001\u4ee3\u7801\u5206\u6790\u5de5\u5177\u6765\u68c0\u6d4b\u6f5c\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\uff08\u5982 SonarQube\uff09\u3002</li> <li>\u5bb9\u5668\u5b89\u5168\uff1a\u786e\u4fdd\u5bb9\u5668\u7684\u955c\u50cf\u6ca1\u6709\u5df2\u77e5\u7684\u6f0f\u6d1e\uff0c\u4f7f\u7528\u5de5\u5177\uff08\u5982 Clair\u3001Anchore\uff09\u626b\u63cf\u5bb9\u5668\u955c\u50cf\u3002</li> <li>\u4f9d\u8d56\u7ba1\u7406\uff1a\u786e\u4fdd\u7b2c\u4e09\u65b9\u4f9d\u8d56\u5305\u548c\u5e93\u7684\u5b89\u5168\u6027\uff0c\u4f7f\u7528\u5de5\u5177\uff08\u5982 Snyk\u3001OWASP Dependency-Check\uff09\u68c0\u67e5\u5df2\u77e5\u6f0f\u6d1e\u3002</li> </ul>"},{"location":"2025/1cicd/#21-cicd","title":"21. \u63cf\u8ff0\u4e00\u4e2a\u4f60\u901a\u8fc7 CI/CD \u89e3\u51b3\u590d\u6742\u95ee\u9898\u7684\u6848\u4f8b","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u901a\u8fc7 CI/CD \u89e3\u51b3\u590d\u6742\u95ee\u9898\u7684\u771f\u5b9e\u6848\u4f8b\uff1a</p> <ul> <li>\u90e8\u7f72\u9891\u7e41\u5931\u8d25\uff1a\u6bcf\u6b21\u90e8\u7f72\u524d\u540e\u9700\u8981\u624b\u52a8\u68c0\u67e5\u4f9d\u8d56\u548c\u914d\u7f6e\uff0c\u5bfc\u81f4\u751f\u4ea7\u73af\u5883\u4e0d\u7a33\u5b9a\u3002</li> <li>\u56de\u6eda\u56f0\u96be\uff1a\u7531\u4e8e\u90e8\u7f72\u8fc7\u7a0b\u4e2d\u6ca1\u6709\u81ea\u52a8\u5316\u56de\u6eda\u673a\u5236\uff0c\u51fa\u73b0\u95ee\u9898\u65f6\u53ea\u80fd\u901a\u8fc7\u624b\u52a8\u4fee\u590d\u6216\u91cd\u65b0\u90e8\u7f72\u3002</li> <li> <p>\u957f\u65f6\u95f4\u7684\u96c6\u6210\u5468\u671f\uff1a\u5f00\u53d1\u4eba\u5458\u9891\u7e41\u63d0\u4ea4\u4ee3\u7801\uff0c\u4f46\u6784\u5efa\u548c\u6d4b\u8bd5\u5468\u671f\u5f88\u957f\uff0c\u5f71\u54cd\u5f00\u53d1\u6548\u7387\u3002</p> </li> <li> <p>\u95ee\u9898\u548c\u6311\u6218\uff1a</p> </li> </ul> <p>\u6211\u4eec\u9047\u5230\u7684\u95ee\u9898\u662f\uff0c\u4ee3\u7801\u7684\u8d28\u91cf\u548c\u7a33\u5b9a\u6027\u65e0\u6cd5\u5f97\u5230\u5feb\u901f\u9a8c\u8bc1\u3002\u6bcf\u6b21\u63d0\u4ea4\u540e\uff0c\u6784\u5efa\u548c\u6d4b\u8bd5\u8fc7\u7a0b\u5e38\u5e38\u5931\u8d25\uff0c\u5bfc\u81f4\u5f00\u53d1\u4eba\u5458\u7684\u8fdb\u5ea6\u88ab\u5ef6\u8fdf\u3002\u6b64\u5916\uff0c\u624b\u52a8\u90e8\u7f72\u548c\u914d\u7f6e\u7ba1\u7406\u4e5f\u5bfc\u81f4\u4e86\u9891\u7e41\u7684\u751f\u4ea7\u73af\u5883\u6545\u969c\u548c\u670d\u52a1\u95f4\u7684\u4f9d\u8d56\u95ee\u9898\u3002</p> <p>\u89e3\u51b3\u65b9\u68481\uff1a\u5b9e\u65bdCI/CD\u6d41\u7a0b</p> <p>\u6211\u4eec\u51b3\u5b9a\u5f15\u5165 CI/CD \u5de5\u5177\u94fe\uff0c\u89e3\u51b3\u6784\u5efa\u3001\u6d4b\u8bd5\u3001\u90e8\u7f72\u7b49\u73af\u8282\u7684\u81ea\u52a8\u5316\uff0c\u5e76\u901a\u8fc7\u8fd9\u4e2a\u6d41\u7a0b\u6765\u51cf\u5c11\u4eba\u4e3a\u5e72\u9884\u3002</p> <p>\u6211\u4eec\u4f7f\u7528\u4e86 Jenkins \u4f5c\u4e3a CI \u5de5\u5177\u3002\u6bcf\u5f53\u5f00\u53d1\u4eba\u5458\u63d0\u4ea4\u4ee3\u7801\u5230 Git \u4ed3\u5e93\u65f6\uff0cJenkins \u81ea\u52a8\u89e6\u53d1\u6784\u5efa\u4efb\u52a1\uff1a</p> <ol> <li>\u81ea\u52a8\u6784\u5efa\uff1aJenkins \u81ea\u52a8\u62c9\u53d6\u6700\u65b0\u7684\u4ee3\u7801\uff0c\u6267\u884c\u6784\u5efa\u8fc7\u7a0b\uff08\u4f8b\u5982\u4f7f\u7528 Docker \u6784\u5efa\u955c\u50cf\uff09\u3002</li> <li>\u81ea\u52a8\u5316\u5355\u5143\u6d4b\u8bd5\uff1a\u6bcf\u6b21\u6784\u5efa\u540e\uff0cJenkins \u4f1a\u81ea\u52a8\u8fd0\u884c\u6240\u6709\u7684\u5355\u5143\u6d4b\u8bd5\u548c\u96c6\u6210\u6d4b\u8bd5\uff0c\u786e\u4fdd\u4ee3\u7801\u63d0\u4ea4\u4e0d\u4f1a\u7834\u574f\u73b0\u6709\u529f\u80fd\u3002</li> <li>\u4ee3\u7801\u8d28\u91cf\u68c0\u67e5\uff1a\u96c6\u6210 SonarQube \u8fdb\u884c\u9759\u6001\u4ee3\u7801\u5206\u6790\uff0c\u81ea\u52a8\u68c0\u67e5\u4ee3\u7801\u8d28\u91cf\uff0c\u53d1\u73b0\u6f5c\u5728\u7684 bug \u548c\u5b89\u5168\u6f0f\u6d1e\u3002</li> </ol> <p>\u6b65\u9aa42\uff1a\u81ea\u52a8\u5316\u90e8\u7f72\u4e0e\u53d1\u5e03</p> <p>\u4e3a\u4e86\u7b80\u5316\u90e8\u7f72\uff0c\u6211\u4eec\u91c7\u7528\u4e86 Kubernetes \u4f5c\u4e3a\u5bb9\u5668\u7f16\u6392\u5e73\u53f0\uff0c\u5e76\u7ed3\u5408 Helm \u6765\u7ba1\u7406\u90e8\u7f72\uff1a</p> <ul> <li>\u81ea\u52a8\u5316\u90e8\u7f72\uff1a\u901a\u8fc7 Jenkins \u4e0e Kubernetes \u96c6\u6210\uff0c\u6210\u529f\u5b9e\u73b0\u4e86\u81ea\u52a8\u5316\u90e8\u7f72\u6d41\u7a0b\u3002\u6bcf\u6b21\u6784\u5efa\u5b8c\u6210\u540e\uff0c\u65b0\u7684 Docker \u955c\u50cf\u4f1a\u81ea\u52a8\u63a8\u9001\u5230 Docker Hub\uff0c\u5e76\u901a\u8fc7 Helm \u81ea\u52a8\u66f4\u65b0 Kubernetes \u96c6\u7fa4\u4e2d\u7684\u670d\u52a1\u3002</li> <li>\u84dd\u7eff\u90e8\u7f72\u7b56\u7565\uff1a\u4e3a\u4e86\u786e\u4fdd\u65b0\u7248\u672c\u4e0d\u4f1a\u5f71\u54cd\u5230\u73b0\u6709\u670d\u52a1\uff0c\u6211\u4eec\u91c7\u7528\u4e86\u84dd\u7eff\u90e8\u7f72\u7b56\u7565\u3002\u901a\u8fc7\u84dd\u7eff\u90e8\u7f72\uff0c\u6211\u4eec\u80fd\u591f\u5e73\u6ed1\u5730\u5207\u6362\u7248\u672c\uff0c\u4e14\u80fd\u591f\u5feb\u901f\u56de\u6eda\u5230\u4e0a\u4e00\u4e2a\u7248\u672c</li> </ul> <p>\u6b65\u9aa43\uff1a\u81ea\u52a8\u5316\u56de\u6eda</p> <p>\u4e3a\u4e86\u5e94\u5bf9\u751f\u4ea7\u73af\u5883\u4e2d\u53ef\u80fd\u51fa\u73b0\u7684\u6545\u969c\uff0c\u6211\u4eec\u8bbe\u7f6e\u4e86 \u81ea\u52a8\u5316\u56de\u6eda\u673a\u5236\uff1a</p> <ul> <li>\u5065\u5eb7\u68c0\u67e5\u4e0e\u76d1\u63a7\uff1a\u5728\u90e8\u7f72\u65b0\u7248\u672c\u540e\uff0cKubernetes \u4f1a\u8fdb\u884c\u5065\u5eb7\u68c0\u67e5\uff0c\u5982\u679c\u65b0\u7248\u672c\u7684\u670d\u52a1\u672a\u901a\u8fc7\u68c0\u67e5\uff0c\u5b83\u4f1a\u81ea\u52a8\u5c06\u6d41\u91cf\u5207\u6362\u56de\u65e7\u7248\u672c\u3002\u6211\u4eec\u8fd8\u96c6\u6210\u4e86 Prometheus \u548c Grafana \u7528\u4e8e\u5b9e\u65f6\u76d1\u63a7\u670d\u52a1\u7684\u5065\u5eb7\u72b6\u51b5\u3002</li> <li>\u81ea\u52a8\u56de\u6eda\uff1a\u5f53\u51fa\u73b0\u6545\u969c\u65f6\uff0cKubernetes \u4f1a\u81ea\u52a8\u89e6\u53d1\u56de\u6eda\u64cd\u4f5c\uff0c\u5c06\u6d41\u91cf\u5207\u6362\u56de\u4e0a\u4e00\u4e2a\u5065\u5eb7\u7684\u7248\u672c\uff0c\u6781\u5927\u5730\u51cf\u5c11\u4e86\u4eba\u5de5\u5e72\u9884\u548c\u4fee\u590d\u65f6\u95f4</li> </ul> <p>\u6b65\u9aa44\uff1a\u6301\u7eed\u4ea4\u4ed8\u4e0e\u6301\u7eed\u53cd\u9988</p> <p>\u901a\u8fc7 CI/CD \u6d41\u7a0b\uff0c\u6211\u4eec\u5b9e\u73b0\u4e86 \u6301\u7eed\u4ea4\u4ed8\uff1a</p> <ul> <li>\u9891\u7e41\u53d1\u5e03\uff1a\u6bcf\u6b21\u901a\u8fc7 Jenkins \u7684\u81ea\u52a8\u5316\u6d4b\u8bd5\u540e\uff0c\u4ee3\u7801\u90fd\u4f1a\u88ab\u81ea\u52a8\u90e8\u7f72\u5230\u751f\u4ea7\u73af\u5883\u6216\u8005\u9884\u751f\u4ea7\u73af\u5883\u4e2d\u3002\u8fd9\u6837\uff0c\u56e2\u961f\u53ef\u4ee5\u9891\u7e41\u5730\u53d1\u5e03\u5c0f\u7248\u672c\uff0c\u51cf\u5c11\u4e86\u5927\u7248\u672c\u53d1\u5e03\u5e26\u6765\u7684\u98ce\u9669\u3002</li> <li>\u6301\u7eed\u53cd\u9988\uff1a\u5f00\u53d1\u56e2\u961f\u80fd\u591f\u5373\u65f6\u6536\u5230\u6784\u5efa\u3001\u6d4b\u8bd5\u548c\u90e8\u7f72\u7684\u53cd\u9988\uff0c\u5feb\u901f\u4fee\u590d\u95ee\u9898\uff0c\u786e\u4fdd\u7cfb\u7edf\u7a33\u5b9a\u8fd0\u884c\u3002</li> </ul> <p>\u901a\u8fc7\u5f15\u5165 CI/CD \u6d41\u7a0b\uff0c\u6211\u4eec\u6210\u529f\u89e3\u51b3\u4e86\u4ee5\u4e0b\u95ee\u9898\uff1a</p> <ul> <li>\u63d0\u9ad8\u4e86\u6784\u5efa\u6548\u7387\uff1a\u5f00\u53d1\u4eba\u5458\u63d0\u4ea4\u7684\u4ee3\u7801\u80fd\u591f\u5728\u51e0\u5206\u949f\u5185\u901a\u8fc7\u6784\u5efa\u548c\u6d4b\u8bd5\u73af\u8282\uff0c\u6781\u5927\u7f29\u77ed\u4e86\u5f00\u53d1\u5468\u671f\u3002</li> <li>\u63d0\u5347\u4e86\u4ee3\u7801\u8d28\u91cf\uff1a\u81ea\u52a8\u5316\u7684\u6d4b\u8bd5\u548c\u4ee3\u7801\u8d28\u91cf\u68c0\u67e5\u786e\u4fdd\u4e86\u65b0\u529f\u80fd\u548c\u4fee\u590d\u4e0d\u5f71\u54cd\u73b0\u6709\u7cfb\u7edf\uff0c\u51cf\u5c11\u4e86\u751f\u4ea7\u73af\u5883\u4e2d\u7684 bug\u3002</li> <li>\u964d\u4f4e\u4e86\u90e8\u7f72\u98ce\u9669\uff1a\u81ea\u52a8\u5316\u90e8\u7f72\u548c\u84dd\u7eff\u90e8\u7f72\u7b56\u7565\u8ba9\u6211\u4eec\u80fd\u591f\u66f4\u5b89\u5168\u5730\u53d1\u5e03\u65b0\u7248\u672c\uff0c\u540c\u65f6\u81ea\u52a8\u56de\u6eda\u673a\u5236\u786e\u4fdd\u4e86\u6545\u969c\u80fd\u5feb\u901f\u6062\u590d\u3002</li> <li>\u52a0\u5feb\u4e86\u53d1\u5e03\u9891\u7387\uff1a\u6211\u4eec\u80fd\u591f\u6bcf\u5468\u751a\u81f3\u6bcf\u5929\u53d1\u5e03\u65b0\u529f\u80fd\uff0c\u800c\u4e0d\u9700\u8981\u62c5\u5fc3\u53d1\u5e03\u8fc7\u7a0b\u4e2d\u7684\u590d\u6742\u6027\u548c\u51fa\u9519\u7387\u3002</li> </ul>"},{"location":"2025/1cicd/#2-gitops","title":"2 GitOps \u9762\u8bd5\u9898\u5408\u96c6","text":""},{"location":"2025/1cicd/#1-gitops","title":"1. \u4ec0\u4e48\u662f GitOps\uff1f","text":"<p>GitOps \u662f\u4e00\u79cd\u57fa\u4e8e Git \u7684\u64cd\u4f5c\u65b9\u6cd5\uff0c\u5229\u7528 Git \u4f5c\u4e3a Kubernetes \u548c\u5176\u4ed6\u57fa\u7840\u8bbe\u65bd\u7684\u5355\u4e00\u771f\u5b9e\u6765\u6e90\uff08Single Source of Truth\uff09\u3002</p> <p>\u901a\u8fc7 Git \u4ed3\u5e93\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\uff0cGitOps \u5de5\u5177\u81ea\u52a8\u5316\u5730\u7ba1\u7406\u548c\u90e8\u7f72\u5e94\u7528\u7a0b\u5e8f\u548c\u57fa\u7840\u8bbe\u65bd\u3002</p> <p>GitOps \u5b9e\u73b0\u4e86\u6301\u7eed\u4ea4\u4ed8\uff08CD\uff09\u548c\u57fa\u7840\u8bbe\u65bd\u5373\u4ee3\u7801\uff08IaC\uff09\uff0c\u786e\u4fdd\u5e94\u7528\u548c\u57fa\u7840\u8bbe\u65bd\u7684\u72b6\u6001\u59cb\u7ec8\u4e0e Git \u4ed3\u5e93\u4e2d\u7684\u5b9a\u4e49\u4e00\u81f4</p>"},{"location":"2025/1cicd/#2-gitops_1","title":"2. GitOps \u7684\u6838\u5fc3\u539f\u5219\u662f\u4ec0\u4e48\uff1f","text":"<ul> <li>Git \u4f5c\u4e3a\u552f\u4e00\u7684\u771f\u5b9e\u6765\u6e90\uff08SSOT\uff09\uff1a \u6240\u6709\u57fa\u7840\u8bbe\u65bd\u548c\u5e94\u7528\u7a0b\u5e8f\u7684\u914d\u7f6e\u5b58\u50a8\u5728 Git \u4ed3\u5e93\u4e2d\uff0c\u786e\u4fdd\u914d\u7f6e\u7248\u672c\u63a7\u5236\u548c\u5ba1\u8ba1\u3002</li> <li>\u58f0\u660e\u5f0f\u914d\u7f6e\uff1a \u901a\u8fc7\u58f0\u660e\u5f0f\u7684\u914d\u7f6e\uff08\u5982 YAML \u6587\u4ef6\uff09\uff0c\u5b9a\u4e49\u5e94\u7528\u548c\u57fa\u7840\u8bbe\u65bd\u7684\u671f\u671b\u72b6\u6001\u3002</li> <li>\u81ea\u52a8\u5316\u540c\u6b65\uff1a \u4f7f\u7528\u81ea\u52a8\u5316\u5de5\u5177\uff08\u5982 ArgoCD\u3001Flux\uff09\u76d1\u63a7 Git \u4ed3\u5e93\u7684\u53d8\u66f4\uff0c\u5e76\u5c06\u53d8\u66f4\u540c\u6b65\u5230 Kubernetes \u96c6\u7fa4\u6216\u5176\u4ed6\u57fa\u7840\u8bbe\u65bd\u3002</li> <li>\u53ef\u5ba1\u8ba1\u6027\u548c\u53ef\u56de\u6eda\u6027\uff1a \u6240\u6709\u53d8\u66f4\u90fd\u901a\u8fc7 Git \u63d0\u4ea4\u548c\u63a8\u9001\u8bb0\u5f55\uff0c\u53ef\u4ee5\u968f\u65f6\u56de\u6eda\u5230\u5148\u524d\u7684\u72b6\u6001\u3002</li> </ul>"},{"location":"2025/1cicd/#3-gitops-cicd","title":"3. GitOps \u4e0e\u4f20\u7edf\u7684\u6301\u7eed\u96c6\u6210\uff08CI\uff09/\u6301\u7eed\u4ea4\u4ed8\uff08CD\uff09\u6709\u4f55\u4e0d\u540c\uff1f","text":"<p>GitOps \u662f\u6301\u7eed\u4ea4\u4ed8\uff08CD\uff09\u7684\u4e00\u4e2a\u5b50\u96c6\uff0c\u4f46\u4e0e\u4f20\u7edf\u7684 CI/CD \u4e0d\u540c\uff1a</p> <ul> <li>\u5728\u4f20\u7edf\u7684 CD \u6d41\u7a0b\u4e2d\uff0c\u5e94\u7528\u548c\u57fa\u7840\u8bbe\u65bd\u7684\u914d\u7f6e\u901a\u5e38\u662f\u901a\u8fc7 CI/CD \u5de5\u5177\u76f4\u63a5\u66f4\u65b0\u5230\u76ee\u6807\u73af\u5883\u4e2d\uff0c\u53ef\u80fd\u6d89\u53ca\u624b\u52a8\u64cd\u4f5c\u6216\u811a\u672c\u3002</li> <li>\u5728 GitOps \u4e2d\uff0c\u6240\u6709\u7684\u64cd\u4f5c\u548c\u914d\u7f6e\u53d8\u66f4\u90fd\u901a\u8fc7 Git \u4ed3\u5e93\u8fdb\u884c\u7ba1\u7406\uff0c\u6240\u6709\u57fa\u7840\u8bbe\u65bd\u548c\u5e94\u7528\u7684\u72b6\u6001\u90fd\u7531 Git \u4ed3\u5e93\u4e2d\u7684\u914d\u7f6e\u5b9a\u4e49\uff0c\u5e76\u81ea\u52a8\u540c\u6b65\u5230\u73af\u5883\u4e2d</li> </ul> <p>GitOps \u63d0\u4f9b\u4e86\u66f4\u9ad8\u7684\u53ef\u5ba1\u8ba1\u6027\u3001\u56de\u6eda\u80fd\u529b\uff0c\u5e76\u4e14\u901a\u8fc7\u58f0\u660e\u5f0f\u914d\u7f6e\u7b80\u5316\u4e86\u6d41\u7a0b</p>"},{"location":"2025/1cicd/#4-gitops-kubernetes","title":"4 GitOps \u5982\u4f55\u4e0e Kubernetes \u96c6\u6210\uff1f","text":"<p>GitOps \u4e0e Kubernetes \u7d27\u5bc6\u96c6\u6210\uff0c\u901a\u5e38\u4f7f\u7528 Git \u4ed3\u5e93\u4f5c\u4e3a\u552f\u4e00\u7684\u771f\u5b9e\u6765\u6e90\uff08SSOT\uff09\u6765\u7ba1\u7406 Kubernetes \u96c6\u7fa4\u4e2d\u7684\u914d\u7f6e\u3002</p> <p>GitOps \u5de5\u5177\uff08\u5982 ArgoCD \u6216 Flux\uff09\u4f1a\u76d1\u63a7 Git \u4ed3\u5e93\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u5c06\u5176\u540c\u6b65\u5230 Kubernetes \u96c6\u7fa4\u4e2d\u3002\u8fd9</p> <p>\u4e9b\u5de5\u5177\u901a\u8fc7 Kubernetes API \u4e0e\u96c6\u7fa4\u8fdb\u884c\u4ea4\u4e92\uff0c\u81ea\u52a8\u90e8\u7f72\u548c\u66f4\u65b0\u5e94\u7528</p>"},{"location":"2025/1cicd/#5-gitops","title":"5 GitOps \u7684\u4e3b\u8981\u5de5\u5177\u6709\u54ea\u4e9b","text":"<ul> <li>ArgoCD\uff1a \u4e00\u4e2a\u5e7f\u6cdb\u4f7f\u7528\u7684 GitOps \u5de5\u5177\uff0c\u652f\u6301 Git \u4ed3\u5e93\u4e0e Kubernetes \u96c6\u7fa4\u4e4b\u95f4\u7684\u81ea\u52a8\u540c\u6b65\u548c\u90e8\u7f72\u3002</li> <li>Flux\uff1a \u53e6\u4e00\u4e2a GitOps \u5de5\u5177\uff0c\u652f\u6301 Git \u4ed3\u5e93\u4e0e Kubernetes \u7684\u96c6\u6210\uff0c\u5141\u8bb8\u81ea\u52a8\u540c\u6b65\u548c\u7ba1\u7406 Kubernetes \u5e94\u7528\u3002</li> <li>Helm\uff1a \u867d\u7136\u4e0d\u662f\u4e13\u95e8\u7684 GitOps \u5de5\u5177\uff0c\u4f46\u5728 GitOps \u5de5\u4f5c\u6d41\u4e2d\u7ecf\u5e38\u4e0e ArgoCD \u6216 Flux \u4e00\u8d77\u4f7f\u7528\uff0c\u7528\u4e8e\u90e8\u7f72\u548c\u7ba1\u7406 Helm charts</li> </ul>"},{"location":"2025/1cicd/#6-gitops","title":"6 GitOps \u5982\u4f55\u5b9e\u73b0\u56de\u6eda\uff1f","text":"<p>GitOps \u4e2d\u7684\u56de\u6eda\u975e\u5e38\u7b80\u5355\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u5e94\u7528\u548c\u57fa\u7840\u8bbe\u65bd\u914d\u7f6e\u90fd\u5b58\u50a8\u5728 Git \u4ed3\u5e93\u4e2d\u3002\u5982\u679c\u53d1\u751f\u9519\u8bef\u6216\u9700\u8981\u56de\u6eda\uff0c\u53ea\u9700\u5c06 Git \u4ed3\u5e93\u4e2d\u7684\u914d\u7f6e\u6062\u590d\u5230\u4ee5\u524d\u7684\u7248\u672c\uff0c\u5e76\u89e6\u53d1\u540c\u6b65\u5de5\u5177\uff08\u5982 ArgoCD \u6216 Flux\uff09\u5c06\u96c6\u7fa4\u6062\u590d\u5230\u8fd9\u4e2a\u7248\u672c\u3002</p> <p>Git \u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u7248\u672c\u63a7\u5236\u548c\u5ba1\u8ba1\u80fd\u529b\uff0c\u4f7f\u56de\u6eda\u6210\u4e3a\u4e00\u79cd\u5feb\u901f\u3001\u53ef\u9760\u7684\u64cd\u4f5c</p>"},{"location":"2025/1cicd/#7-gitops-cicd","title":"7 GitOps \u4e0e CI/CD \u5de5\u5177\u7684\u534f\u4f5c\u65b9\u5f0f\u662f\u4ec0\u4e48\uff1f","text":"<p>GitOps \u4e0e CI/CD \u5de5\u5177\u53ef\u4ee5\u5f88\u597d\u5730\u534f\u4f5c\u3002\u5728 CI/CD \u6d41\u7a0b\u4e2d\uff0cCI \u5de5\u5177\uff08\u5982 Jenkins\u3001GitLab CI\u3001CircleCI\uff09\u8d1f\u8d23\u6784\u5efa\u548c\u6d4b\u8bd5\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u3001\u751f\u6210\u955c\u50cf\u7b49\u3002</p> <p>\u7136\u540e\uff0cGitOps \u5de5\u5177\uff08\u5982 ArgoCD \u6216 Flux\uff09\u901a\u8fc7\u4ece Git \u4ed3\u5e93\u4e2d\u83b7\u53d6\u914d\u7f6e\u548c\u7248\u672c\u4fe1\u606f\u6765\u540c\u6b65\u548c\u90e8\u7f72\u8fd9\u4e9b\u5e94\u7528\u3002 \u5177\u4f53\u5de5\u4f5c\u6d41\u7a0b</p> <ol> <li>\u5f00\u53d1\u4eba\u5458\u63d0\u4ea4\u4ee3\u7801\u5230 Git \u4ed3\u5e93\u3002</li> <li>CI \u5de5\u5177\u6784\u5efa\u3001\u6d4b\u8bd5\u5e76\u5c06\u65b0\u7248\u672c\u7684 Docker \u955c\u50cf\u63a8\u9001\u5230\u955c\u50cf\u4ed3\u5e93\u3002</li> <li>Git \u4ed3\u5e93\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u88ab\u66f4\u65b0\uff08\u4f8b\u5982\u66f4\u65b0 Helm chart \u6216 Kubernetes YAML \u6587\u4ef6\uff09\u3002</li> <li>GitOps \u5de5\u5177\u76d1\u63a7 Git \u4ed3\u5e93\u5e76\u81ea\u52a8\u5c06\u8fd9\u4e9b\u914d\u7f6e\u540c\u6b65\u5230 Kubernetes \u96c6\u7fa4</li> </ol>"},{"location":"2025/1cicd/#8-gitops-secrets","title":"8 \u5982\u4f55\u5728 GitOps \u4e2d\u5904\u7406\u673a\u5bc6\uff08Secrets\uff09\u7ba1\u7406\uff1f","text":"<p>\u5728 GitOps \u4e2d\u5904\u7406\u673a\u5bc6\uff08Secrets\uff09\u901a\u5e38\u9700\u8981\u989d\u5916\u7684\u5de5\u5177\u548c\u65b9\u6cd5\uff0c\u56e0\u4e3a Git \u4ed3\u5e93\u4e0d\u5e94\u8be5\u5b58\u50a8\u654f\u611f\u6570\u636e\u3002\u5e38\u89c1\u7684\u5904\u7406\u65b9\u6cd5\u5305\u62ec</p> <ul> <li>\u4f7f\u7528 Kubernetes Secrets\uff1a \u5c06\u654f\u611f\u6570\u636e\u5b58\u50a8\u5728 Kubernetes \u7684 Secret \u4e2d\uff0c\u5e76\u786e\u4fdd\u901a\u8fc7 GitOps \u5de5\u5177\u4e0e Git \u4ed3\u5e93\u4e2d\u7684\u975e\u654f\u611f\u914d\u7f6e\u540c\u6b65\u3002</li> <li>\u4f7f\u7528\u5916\u90e8\u79d8\u5bc6\u7ba1\u7406\u5de5\u5177\uff1a \u5982 HashiCorp Vault\uff0c\u5b83\u53ef\u4ee5\u96c6\u6210\u5230 GitOps \u5de5\u4f5c\u6d41\u4e2d\uff0c\u901a\u8fc7\u52a8\u6001\u52a0\u8f7d\u673a\u5bc6\u4fe1\u606f\u3002</li> <li>\u4f7f\u7528 SealedSecrets\uff1a \u4e00\u4e2a\u5de5\u5177\uff0c\u5141\u8bb8\u52a0\u5bc6 Kubernetes Secrets\uff0c\u786e\u4fdd\u5b83\u4eec\u53ef\u4ee5\u5b89\u5168\u5730\u5b58\u50a8\u5728 Git \u4ed3\u5e93\u4e2d\uff0c\u5e76\u4e14\u53ea\u6709\u6388\u6743\u7528\u6237\u53ef\u4ee5\u89e3\u5bc6</li> </ul>"},{"location":"2025/1cicd/#9-gitops","title":"9 GitOps \u5982\u4f55\u4e0e\u591a\u96c6\u7fa4\u73af\u5883\u5de5\u4f5c\uff1f","text":"<p>GitOps \u53ef\u4ee5\u975e\u5e38\u5bb9\u6613\u5730\u6269\u5c55\u5230\u591a\u4e2a Kubernetes \u96c6\u7fa4\u4e2d\u3002\u901a\u8fc7\u4f7f\u7528 ArgoCD \u6216 Flux \u7b49\u5de5\u5177\uff0c\u53ef\u4ee5\u5728\u591a\u4e2a\u96c6\u7fa4\u4e2d\u521b\u5efa\u548c\u540c\u6b65\u5e94\u7528\u3002\u6bcf\u4e2a\u96c6\u7fa4\u90fd\u53ef\u4ee5\u6709\u4e00\u4e2a\u72ec\u7acb\u7684 GitOps \u7ba1\u9053\uff0c\u901a\u8fc7 Git \u4ed3\u5e93\u4e2d\u7684\u4e0d\u540c\u914d\u7f6e\u6216\u5206\u652f\u7ba1\u7406\u591a\u4e2a\u96c6\u7fa4\u7684\u5e94\u7528\u3002</p> <ul> <li>ArgoCD \u652f\u6301\u8de8\u591a\u4e2a\u96c6\u7fa4\u8fdb\u884c\u540c\u6b65\uff0c\u5141\u8bb8\u901a\u8fc7\u4e0d\u540c\u7684\u5e94\u7528\u5b9a\u4e49\u7ba1\u7406\u6bcf\u4e2a\u96c6\u7fa4\u7684\u914d\u7f6e\u3002</li> <li>Flux \u4e5f\u652f\u6301\u591a\u4e2a\u96c6\u7fa4\uff0c\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u6765\u7ba1\u7406\u548c\u540c\u6b65\u591a\u4e2a\u96c6\u7fa4\u7684\u72b6\u6001\u3002</li> </ul>"},{"location":"2025/1cicd/#10-gitops-devops","title":"10 GitOps \u5982\u4f55\u63d0\u9ad8 DevOps \u7684\u6548\u7387\uff1f","text":"<p>GitOps \u63d0\u4f9b\u4e86\u4ee5\u4e0b\u4f18\u52bf\uff0c\u80fd\u663e\u8457\u63d0\u9ad8 DevOps \u7684\u6548\u7387\uff1a</p> <ul> <li>\u81ea\u52a8\u5316\u548c\u4e00\u81f4\u6027\uff1a \u901a\u8fc7 GitOps \u5de5\u5177\uff0c\u5f00\u53d1\u4eba\u5458\u4e0d\u518d\u9700\u8981\u624b\u52a8\u64cd\u4f5c Kubernetes \u96c6\u7fa4\uff0c\u800c\u662f\u901a\u8fc7 Git \u63d0\u4ea4\u81ea\u52a8\u90e8\u7f72\u548c\u66f4\u65b0\u5e94\u7528\u3002</li> <li>\u7248\u672c\u63a7\u5236\u548c\u5ba1\u8ba1\uff1a \u6240\u6709\u7684\u53d8\u66f4\u90fd\u901a\u8fc7 Git \u4ed3\u5e93\u8fdb\u884c\u7248\u672c\u63a7\u5236\uff0c\u6240\u6709\u64cd\u4f5c\u90fd\u662f\u53ef\u8ffd\u6eaf\u7684\uff0c\u4fbf\u4e8e\u56de\u6eda\u548c\u5ba1\u8ba1\u3002</li> <li>\u7b80\u5316\u7684\u56de\u6eda\uff1a GitOps \u4f7f\u5f97\u56de\u6eda\u53d8\u5f97\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u6062\u590d Git \u4e2d\u7684\u914d\u7f6e\u5e76\u81ea\u52a8\u540c\u6b65\u5230\u96c6\u7fa4\u5373\u53ef\u3002</li> <li>\u51cf\u5c11\u4eba\u4e3a\u9519\u8bef\uff1a \u901a\u8fc7\u81ea\u52a8\u5316\u6d41\u7a0b\uff0c\u51cf\u5c11\u4e86\u624b\u52a8\u914d\u7f6e\u548c\u64cd\u4f5c\u7684\u98ce\u9669\uff0c\u907f\u514d\u4e86\u4e0d\u4e00\u81f4\u548c\u914d\u7f6e\u6f02\u79fb\u3002</li> </ul>"},{"location":"2025/1cicd/#11-gitops","title":"11 GitOps \u662f\u5426\u9002\u7528\u4e8e\u6240\u6709\u7c7b\u578b\u7684\u5e94\u7528\u548c\u57fa\u7840\u8bbe\u65bd\uff1f","text":"<p>GitOps \u6700\u9002\u5408\u7528\u4e8e\u57fa\u4e8e\u5bb9\u5668\u7684\u5e94\u7528\uff0c\u7279\u522b\u662f\u5728 Kubernetes \u7b49\u5bb9\u5668\u7f16\u6392\u5e73\u53f0\u4e0a\u3002\u867d\u7136 GitOps \u7684\u6838\u5fc3\u7406\u5ff5\u53ef\u4ee5\u5e94\u7528\u4e8e\u8bb8\u591a\u57fa\u7840\u8bbe\u65bd\uff08\u5982\u865a\u62df\u673a\u3001\u7f51\u7edc\u914d\u7f6e\u7b49\uff09\uff0c\u4f46\u5176\u6700\u5927\u4f18\u52bf\u4f53\u73b0\u5728\u5bb9\u5668\u5316\u73af\u5883\u4e2d\uff0c\u56e0\u4e3a Kubernetes \u672c\u8eab\u662f\u4e00\u4e2a\u58f0\u660e\u5f0f\u7684\u7cfb\u7edf\uff0cGitOps \u53ef\u4ee5\u4e0e\u4e4b\u65e0\u7f1d\u96c6\u6210\u3002</p> <p>\u7136\u800c\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u4f20\u7edf\u7684\u3001\u975e\u5bb9\u5668\u5316\u7684\u5e94\u7528\uff0cGitOps \u53ef\u80fd\u5e76\u4e0d\u9002\u7528\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u4f9d\u8d56 Git \u4ed3\u5e93\u4f5c\u4e3a\u914d\u7f6e\u6e90\uff0c\u5e76\u4e14\u4f9d\u8d56\u4e8e\u81ea\u52a8\u5316\u5de5\u5177\u6765\u540c\u6b65\u5e94\u7528\u72b6\u6001\u3002</p>"},{"location":"2025/1cicd/#12-gitops","title":"12 GitOps \u662f\u5982\u4f55\u5904\u7406\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u548c\u57fa\u7840\u8bbe\u65bd\u7684\uff1f","text":"<p>GitOps \u901a\u8fc7\u5c06\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u548c\u57fa\u7840\u8bbe\u65bd\u72b6\u6001\u5b58\u50a8\u5728 Git \u4ed3\u5e93\u4e2d\u6765\u5b9e\u73b0\u81ea\u52a8\u5316\u7ba1\u7406\u3002\u914d\u7f6e\u6587\u4ef6\u901a\u5e38\u662f\u58f0\u660e\u5f0f\u7684\uff0c\u63cf\u8ff0\u4e86\u5e94\u7528\u7a0b\u5e8f\u7684\u671f\u671b\u72b6\u6001\u3002</p> <p>\u4f8b\u5982\uff0c\u5728 Kubernetes \u73af\u5883\u4e2d\uff0c\u5e94\u7528\u7a0b\u5e8f\u7684\u914d\u7f6e\u53ef\u4ee5\u662f YAML \u6587\u4ef6\uff0c\u5b9a\u4e49\u4e86\u90e8\u7f72\u3001\u670d\u52a1\u3001Ingress \u7b49\u8d44\u6e90\u3002GitOps \u5de5\u5177\uff08\u5982 ArgoCD\u3001Flux\uff09\u901a\u8fc7\u6301\u7eed\u76d1\u63a7 Git \u4ed3\u5e93\u4e2d\u7684\u53d8\u66f4\uff0c\u5e76\u81ea\u52a8\u5c06\u8fd9\u4e9b\u53d8\u66f4\u540c\u6b65\u5230 Kubernetes \u96c6\u7fa4\u6216\u5176\u4ed6\u57fa\u7840\u8bbe\u65bd\u4e2d\u3002\u8fd9\u6837\u505a\u53ef\u4ee5\u786e\u4fdd\u96c6\u7fa4\u7684\u72b6\u6001\u59cb\u7ec8\u4e0e Git \u4e2d\u7684\u914d\u7f6e\u4fdd\u6301\u4e00\u81f4\u3002</p>"},{"location":"2025/1cicd/#13-gitops-kubernetes-self-healing","title":"13 GitOps \u5982\u4f55\u652f\u6301 Kubernetes \u96c6\u7fa4\u4e2d\u7684\u81ea\u52a8\u6062\u590d\uff08Self-Healing\uff09\uff1f","text":"<p>GitOps \u652f\u6301\u81ea\u52a8\u6062\u590d\uff08Self-Healing\uff09\u529f\u80fd\uff0c\u786e\u4fdd Kubernetes \u96c6\u7fa4\u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u59cb\u7ec8\u4fdd\u6301\u4e0e Git \u4ed3\u5e93\u4e2d\u7684\u58f0\u660e\u4e00\u81f4\u3002</p> <p>ArgoCD \u548c Flux \u7b49 GitOps \u5de5\u5177\u4f1a\u6301\u7eed\u76d1\u63a7\u5e94\u7528\u7a0b\u5e8f\u7684\u72b6\u6001\uff0c\u5e76\u5728\u53d1\u73b0\u5e94\u7528\u72b6\u6001\u4e0e Git \u4ed3\u5e93\u4e2d\u5b9a\u4e49\u7684\u4e0d\u4e00\u81f4\u65f6\uff0c\u81ea\u52a8\u5c06\u96c6\u7fa4\u4e2d\u7684\u914d\u7f6e\u540c\u6b65\u56de\u671f\u671b\u7684\u72b6\u6001\u3002\u8fd9\u5305\u62ec</p> <ul> <li>\u81ea\u52a8\u4fee\u590d\uff1a \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u5d29\u6e83\u6216\u672a\u8fd0\u884c\uff0cGitOps \u5de5\u5177\u4f1a\u901a\u8fc7\u540c\u6b65 Git \u4e2d\u7684\u914d\u7f6e\u6765\u6062\u590d\u5e94\u7528\u3002</li> <li>\u81ea\u52a8\u56de\u6eda\uff1a \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u66f4\u65b0\u5931\u8d25\uff0cGitOps \u5de5\u5177\u4f1a\u6839\u636e Git \u4ed3\u5e93\u7684\u5386\u53f2\u8bb0\u5f55\u56de\u6eda\u5230\u5148\u524d\u7684\u7a33\u5b9a\u7248\u672c\u3002</li> </ul>"},{"location":"2025/1cicd/#14-gitops-pull-based-push-based","title":"14 GitOps \u4e2d\u7684 \"pull-based\" \u548c \"push-based\" \u6a21\u578b\u6709\u4f55\u4e0d\u540c\uff1f","text":"<p>GitOps \u4e2d\u7684\u540c\u6b65\u673a\u5236\u6709\u4e24\u79cd\u6a21\u578b\uff1aPull-based \u548c Push-based\u3002</p> <ul> <li>Pull-based\uff1a \u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0cGitOps \u5de5\u5177\uff08\u5982 ArgoCD\u3001Flux\uff09\u5b9a\u671f\u4ece Git \u4ed3\u5e93\u4e2d\u62c9\u53d6\u914d\u7f6e\u5e76\u5e94\u7528\u5230 Kubernetes \u96c6\u7fa4\u3002<ul> <li>\u5de5\u5177\u4e3b\u52a8\u68c0\u67e5\u4ed3\u5e93\u4e2d\u7684\u53d8\u66f4\uff0c\u5e76\u5c06\u5b83\u4eec\u540c\u6b65\u5230\u96c6\u7fa4\u4e2d\u3002\u8fd9\u79cd\u65b9\u5f0f\u80fd\u591f\u786e\u4fdd\u96c6\u7fa4\u59cb\u7ec8\u53cd\u6620 Git \u4e2d\u7684\u914d\u7f6e\u3002</li> </ul> </li> <li>Push-based\uff1a \u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0cGit \u4ed3\u5e93\u6216\u5916\u90e8\u5de5\u5177\uff08\u5982 CI \u7cfb\u7edf\uff09\u5c06\u53d8\u66f4\u76f4\u63a5\u63a8\u9001\u5230\u96c6\u7fa4\u4e2d\u3002<ul> <li>\u63a8\u9001\u64cd\u4f5c\u901a\u5e38\u7531\u5916\u90e8\u89e6\u53d1\uff0cGit \u4ed3\u5e93\u4e2d\u7684\u53d8\u66f4\u4f1a\u901a\u8fc7 Webhook \u6216\u5176\u4ed6\u65b9\u5f0f\u81ea\u52a8\u90e8\u7f72\u3002</li> </ul> </li> </ul> <p>\u5728 GitOps \u4e2d\uff0cPull-based \u6a21\u578b\u662f\u66f4\u5e38\u89c1\u7684\uff0c\u56e0\u4e3a\u5b83\u80fd\u591f\u63d0\u4f9b\u66f4\u9ad8\u7684\u5b89\u5168\u6027\u548c\u7a33\u5b9a\u6027\u3002</p>"},{"location":"2025/1cicd/#15-gitops","title":"15 \u5728 GitOps \u4e2d\uff0c\u5982\u4f55\u5904\u7406\u5e94\u7528\u7248\u672c\u548c\u53d1\u5e03\u7ba1\u7406\uff1f","text":"<p>\u5728 GitOps \u4e2d\uff0c\u5e94\u7528\u7248\u672c\u901a\u5e38\u7531 Git \u4ed3\u5e93\u4e2d\u7684\u6807\u7b7e\uff08Tag\uff09\u6216\u5206\u652f\uff08Branch\uff09\u6765\u7ba1\u7406\u3002\u901a\u8fc7\u4f7f\u7528 Git \u4ed3\u5e93\u4e2d\u7684\u5206\u652f\u548c\u6807\u7b7e\uff0c\u53ef\u4ee5\u6e05\u6670\u5730\u63a7\u5236\u4e0d\u540c\u7248\u672c\u7684\u5e94\u7528\u3002GitOps \u5de5\u5177\u4f1a\u6839\u636e\u8fd9\u4e9b\u7248\u672c\u5c06\u914d\u7f6e\u540c\u6b65\u5230 Kubernetes \u96c6\u7fa4\u3002</p> <ul> <li>\u6807\u7b7e\uff1a \u901a\u8fc7 Git \u6807\u7b7e\uff0c\u53ef\u4ee5\u6307\u5b9a\u67d0\u4e2a\u5e94\u7528\u7684\u7279\u5b9a\u7248\u672c\u5e76\u5c06\u5176\u90e8\u7f72\u5230\u96c6\u7fa4\u4e2d\u3002</li> <li>\u5206\u652f\uff1a \u4f7f\u7528\u5206\u652f\u6765\u7ba1\u7406\u4e0d\u540c\u73af\u5883\u7684\u5e94\u7528\u7248\u672c\uff0c\u5982\u5f00\u53d1\u3001\u6d4b\u8bd5\u3001\u751f\u4ea7\u73af\u5883\u3002</li> </ul> <p>\u5f53\u4ee3\u7801\u548c\u914d\u7f6e\u53d1\u751f\u53d8\u5316\u65f6\uff0cGit \u4ed3\u5e93\u4e2d\u7684\u6807\u7b7e\u6216\u5206\u652f\u4f1a\u66f4\u65b0\uff0cGitOps \u5de5\u5177\uff08\u5982 ArgoCD\u3001Flux\uff09\u4f1a\u81ea\u52a8\u68c0\u6d4b\u5230\u8fd9\u4e9b\u53d8\u5316\u5e76\u5c06\u65b0\u7248\u672c\u540c\u6b65\u5230 Kubernetes \u96c6\u7fa4</p>"},{"location":"2025/1cicd/#16-gitops","title":"16 GitOps \u5982\u4f55\u5904\u7406\u57fa\u7840\u8bbe\u65bd\u53d8\u66f4\uff08\u5982\u7f51\u7edc\u3001\u5b58\u50a8\u7b49\uff09\uff1f","text":"<p>GitOps \u4e0d\u4ec5\u53ef\u4ee5\u7ba1\u7406\u5e94\u7528\u7a0b\u5e8f\u7684\u914d\u7f6e\uff0c\u8fd8\u53ef\u4ee5\u7ba1\u7406\u57fa\u7840\u8bbe\u65bd\u7684\u914d\u7f6e\u3002\u901a\u8fc7\u5c06\u57fa\u7840\u8bbe\u65bd\u7684\u58f0\u660e\u5f0f\u914d\u7f6e\uff08\u5982\u7f51\u7edc\u3001\u5b58\u50a8\u7b49\uff09\u5b58\u50a8\u5728 Git \u4ed3\u5e93\u4e2d\uff0cGitOps \u5de5\u5177\u53ef\u4ee5\u81ea\u52a8\u540c\u6b65\u8fd9\u4e9b\u53d8\u66f4\u5230\u76ee\u6807\u73af\u5883\u3002\u5e38\u89c1\u7684\u57fa\u7840\u8bbe\u65bd\u7ba1\u7406\u65b9\u6cd5\u5305\u62ec</p> <ul> <li>Kubernetes \u914d\u7f6e\uff1a \u901a\u8fc7 Kubernetes \u7684 YAML \u6587\u4ef6\u5b9a\u4e49\u5e94\u7528\u548c\u8d44\u6e90\uff0c\u5982 Deployments\u3001Services\u3001PVC\uff08Persistent Volume Claim\uff09\u3001Ingress \u7b49\u3002</li> <li>\u57fa\u7840\u8bbe\u65bd\u5373\u4ee3\u7801\uff08IaC\uff09\u5de5\u5177\uff1a GitOps \u53ef\u4ee5\u4e0e\u57fa\u7840\u8bbe\u65bd\u5de5\u5177\uff08\u5982 Terraform\u3001CloudFormation\uff09\u96c6\u6210\uff0c\u81ea\u52a8\u5e94\u7528\u57fa\u7840\u8bbe\u65bd\u7684\u53d8\u66f4\u3002</li> <li>\u7f51\u7edc\u548c\u5b58\u50a8\uff1a \u901a\u8fc7 Git \u7ba1\u7406 Kubernetes \u7f51\u7edc\u914d\u7f6e\uff08\u5982 CNI \u63d2\u4ef6\u914d\u7f6e\uff09\u3001\u5b58\u50a8\u8d44\u6e90\uff08\u5982 PVC \u548c StorageClass\uff09\u7b49</li> </ul>"},{"location":"2025/1cicd/#17-gitops","title":"17. \u5982\u4f55\u786e\u4fdd GitOps \u6d41\u7a0b\u4e2d\u7684\u5b89\u5168\u6027\uff1f","text":"<p>GitOps \u4f9d\u8d56\u4e8e Git \u4ed3\u5e93\u4f5c\u4e3a\u914d\u7f6e\u548c\u72b6\u6001\u7684\u6765\u6e90\uff0c\u56e0\u6b64\u5176\u5b89\u5168\u6027\u81f3\u5173\u91cd\u8981\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u63d0\u9ad8 GitOps \u5b89\u5168\u6027\u7684\u65b9\u6cd5\uff1a</p> <ul> <li>\u8bbf\u95ee\u63a7\u5236\uff1a \u786e\u4fdd\u53ea\u6709\u6388\u6743\u7684\u4eba\u5458\u53ef\u4ee5\u8bbf\u95ee\u548c\u4fee\u6539 Git \u4ed3\u5e93\u4e2d\u7684\u914d\u7f6e\u3002\u53ef\u4ee5\u4f7f\u7528 Git \u4ed3\u5e93\u7684\u6743\u9650\u7ba1\u7406\uff08\u5982 GitHub\u3001GitLab \u7684\u6743\u9650\u63a7\u5236\uff09\u6765\u5b9e\u73b0\u8fd9\u4e00\u70b9\u3002</li> <li>\u673a\u5bc6\u7ba1\u7406\uff1a \u907f\u514d\u5c06\u654f\u611f\u6570\u636e\uff08\u5982 API \u5bc6\u94a5\u3001\u6570\u636e\u5e93\u5bc6\u7801\u7b49\uff09\u5b58\u50a8\u5728 Git \u4ed3\u5e93\u4e2d\u3002\u4f7f\u7528 Kubernetes Secrets\u3001HashiCorp Vault \u7b49\u5de5\u5177\u6765\u5b89\u5168\u5730\u5b58\u50a8\u548c\u8bbf\u95ee\u673a\u5bc6\u3002</li> <li>\u5ba1\u8ba1\u548c\u65e5\u5fd7\uff1a \u901a\u8fc7\u542f\u7528 Git \u4ed3\u5e93\u548c GitOps \u5de5\u5177\u7684\u5ba1\u8ba1\u65e5\u5fd7\uff0c\u8ddf\u8e2a\u6240\u6709\u7684\u64cd\u4f5c\u548c\u914d\u7f6e\u53d8\u66f4\u3002\u8fd9\u6709\u52a9\u4e8e\u53d1\u73b0\u5e76\u54cd\u5e94\u6f5c\u5728\u7684\u5b89\u5168\u5a01\u80c1\u3002</li> <li>\u591a\u56e0\u7d20\u8ba4\u8bc1\uff08MFA\uff09\uff1a \u5bf9 Git \u4ed3\u5e93\u7684\u8bbf\u95ee\u542f\u7528\u591a\u56e0\u7d20\u8ba4\u8bc1\uff08MFA\uff09\uff0c\u63d0\u9ad8\u5b89\u5168\u6027</li> </ul>"},{"location":"2025/1cicd/#18-gitops","title":"18 GitOps \u5982\u4f55\u5904\u7406\u6545\u969c\u548c\u6062\u590d\uff1f","text":"<p>GitOps \u63d0\u4f9b\u4e86\u5185\u5efa\u7684\u6545\u969c\u6062\u590d\u80fd\u529b\uff0c\u4e3b\u8981\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u5b9e\u73b0\uff1a</p> <ul> <li>\u58f0\u660e\u5f0f\u7ba1\u7406\uff1a GitOps \u5de5\u5177\uff08\u5982 ArgoCD \u548c Flux\uff09\u5c06\u5e94\u7528\u7684\u914d\u7f6e\u5b58\u50a8\u5728 Git \u4ed3\u5e93\u4e2d\u3002\u5982\u679c Kubernetes \u96c6\u7fa4\u4e2d\u7684\u67d0\u4e2a\u5e94\u7528\u6216\u8d44\u6e90\u51fa\u73b0\u6545\u969c\uff0cGitOps \u5de5\u5177\u4f1a\u5c06\u96c6\u7fa4\u6062\u590d\u5230 Git \u4ed3\u5e93\u4e2d\u7684\u58f0\u660e\u72b6\u6001\uff0c\u4ece\u800c\u5b9e\u73b0\u81ea\u52a8\u6062\u590d\u3002</li> <li>\u81ea\u52a8\u56de\u6eda\uff1a \u5982\u679c\u67d0\u4e2a\u66f4\u65b0\u5931\u8d25\uff0cGitOps \u5de5\u5177\u4f1a\u81ea\u52a8\u56de\u6eda\u5230\u4e4b\u524d\u7684\u7248\u672c\uff0c\u786e\u4fdd\u5e94\u7528\u6062\u590d\u5230\u7a33\u5b9a\u7684\u72b6\u6001\u3002</li> <li>\u5065\u5eb7\u68c0\u67e5\uff1a GitOps \u5de5\u5177\u901a\u5e38\u4f1a\u96c6\u6210\u5065\u5eb7\u68c0\u67e5\u529f\u80fd\uff0c\u76d1\u63a7\u5e94\u7528\u548c\u96c6\u7fa4\u7684\u5065\u5eb7\u72b6\u6001\uff0c\u786e\u4fdd\u5728\u95ee\u9898\u51fa\u73b0\u65f6\u80fd\u591f\u81ea\u52a8\u6062\u590d\u3002</li> </ul>"},{"location":"2025/1cicd/#19-gitops-iac","title":"19 GitOps \u4e0e\u57fa\u7840\u8bbe\u65bd\u4f5c\u4e3a\u4ee3\u7801\uff08IaC\uff09\u6709\u4f55\u533a\u522b\uff1f\u5b83\u4eec\u662f\u5982\u4f55\u96c6\u6210\u7684\uff1f","text":"<ul> <li>GitOps \u4e3b\u8981\u5173\u6ce8\u6301\u7eed\u4ea4\u4ed8\uff08CD\uff09\uff0c\u5e76\u901a\u8fc7 Git \u4ed3\u5e93\u7ba1\u7406\u5e94\u7528\u7a0b\u5e8f\u7684\u58f0\u660e\u5f0f\u914d\u7f6e\u3002GitOps \u5de5\u5177\uff08\u5982 ArgoCD \u6216 Flux\uff09\u81ea\u52a8\u5c06 Git \u4ed3\u5e93\u4e2d\u7684\u53d8\u66f4\u540c\u6b65\u5230\u76ee\u6807\u73af\u5883\uff0c\u786e\u4fdd Kubernetes \u96c6\u7fa4\u4e2d\u7684\u5e94\u7528\u548c\u914d\u7f6e\u4e0e Git \u4e2d\u7684\u58f0\u660e\u72b6\u6001\u4e00\u81f4\u3002</li> <li>\u57fa\u7840\u8bbe\u65bd\u5373\u4ee3\u7801\uff08IaC\uff09 \u662f\u4e00\u79cd\u901a\u8fc7\u4ee3\u7801\u6765\u7ba1\u7406\u57fa\u7840\u8bbe\u65bd\u7684\u65b9\u5f0f\uff0c\u5b83\u4fa7\u91cd\u4e8e\u5b9a\u4e49\u548c\u81ea\u52a8\u5316\u6574\u4e2a\u57fa\u7840\u8bbe\u65bd\uff08\u4f8b\u5982\u7f51\u7edc\u3001\u5b58\u50a8\u3001\u8ba1\u7b97\u8d44\u6e90\u7b49\uff09\u7684\u521b\u5efa\u548c\u7ba1\u7406\u3002\u5e38\u7528\u7684 IaC \u5de5\u5177\u6709 Terraform\u3001Ansible\u3001CloudFormation \u7b49</li> </ul>"},{"location":"2025/1cicd/#20-gitops","title":"20 \u5982\u4f55\u786e\u4fdd GitOps \u5de5\u4f5c\u6d41\u7684\u5b89\u5168\u6027\uff0c\u5c24\u5176\u662f\u673a\u5bc6\u7ba1\u7406\u548c\u8bbf\u95ee\u63a7\u5236\uff1f","text":"<ul> <li>Kubernetes Secrets\uff1a GitOps \u4e0d\u5e94\u76f4\u63a5\u5b58\u50a8\u654f\u611f\u4fe1\u606f\u5728 Git \u4ed3\u5e93\u4e2d\u3002\u53ef\u4ee5\u5229\u7528 Kubernetes Secrets \u548c SealedSecrets\uff0c\u540e\u8005\u901a\u8fc7\u52a0\u5bc6 Secrets \u4f7f\u5176\u53ef\u4ee5\u5b89\u5168\u5730\u5b58\u50a8\u5728 Git \u4ed3\u5e93\u4e2d\uff0c\u5e76\u901a\u8fc7 ArgoCD \u6216 Flux \u81ea\u52a8\u89e3\u5bc6\u3002</li> <li>Vault \u96c6\u6210\uff1a GitOps \u5de5\u5177\uff08\u5982 ArgoCD\uff09\u53ef\u4ee5\u4e0e HashiCorp Vault \u7b49\u673a\u5bc6\u7ba1\u7406\u5de5\u5177\u96c6\u6210\uff0c\u52a8\u6001\u83b7\u53d6\u673a\u5bc6\u5e76\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u3002\u8fd9\u53ef\u4ee5\u907f\u514d\u5c06\u654f\u611f\u6570\u636e\u76f4\u63a5\u653e\u5165 Git \u4ed3\u5e93\u3002</li> <li>\u73af\u5883\u9694\u79bb\uff1a \u901a\u8fc7\u73af\u5883\u9694\u79bb\u6765\u7ba1\u7406\u4e0d\u540c\u73af\u5883\u4e2d\u7684\u673a\u5bc6\u6570\u636e\uff0c\u4f8b\u5982\u5f00\u53d1\u73af\u5883\u548c\u751f\u4ea7\u73af\u5883\u4f7f\u7528\u4e0d\u540c\u7684\u673a\u5bc6\u5b58\u50a8\u548c\u8bbf\u95ee\u6743\u9650\u3002</li> </ul> <p>\u8bbf\u95ee\u63a7\u5236\uff1a</p> <ul> <li>\u4f7f\u7528 RBAC\uff08\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236\uff09 \u7ba1\u7406\u5bf9 Git \u4ed3\u5e93\u3001GitOps \u5de5\u5177\u548c Kubernetes \u96c6\u7fa4\u7684\u8bbf\u95ee\u6743\u9650\u3002</li> <li>\u914d\u7f6e Git \u4ed3\u5e93\u8bbf\u95ee\u63a7\u5236\uff0c\u53ea\u5141\u8bb8\u6388\u6743\u7528\u6237\u63d0\u4ea4\u914d\u7f6e\u53d8\u66f4\u3002</li> <li>\u591a\u56e0\u7d20\u8ba4\u8bc1\uff08MFA\uff09\uff1a \u4f7f\u7528\u591a\u56e0\u7d20\u8ba4\u8bc1\uff08MFA\uff09\u5bf9 Git \u4ed3\u5e93\u548c GitOps \u5de5\u5177\u7684\u8bbf\u95ee\u8fdb\u884c\u52a0\u5f3a\u3002</li> <li>\u5ba1\u8ba1\u65e5\u5fd7\uff1a \u542f\u7528 GitOps \u5de5\u5177\uff08\u5982 ArgoCD\uff09\u7684\u5ba1\u8ba1\u65e5\u5fd7\u529f\u80fd\uff0c\u8bb0\u5f55\u6240\u6709\u64cd\u4f5c\u5386\u53f2\uff0c\u4ee5\u4fbf\u4e8e\u8ffd\u8e2a\u548c\u5206\u6790\u6f5c\u5728\u7684\u5b89\u5168\u95ee\u9898\u3002</li> </ul>"},{"location":"2025/1cicd/#21-gitops","title":"21 \u5982\u4f55\u5728 GitOps \u4e2d\u5b9e\u73b0\u81ea\u52a8\u5316\u7684\u56de\u6eda\u548c\u6545\u969c\u6062\u590d\uff1f","text":"<ul> <li>\u81ea\u52a8\u56de\u6eda\uff1a \u5f53\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u53d1\u751f\u9519\u8bef\u6216\u66f4\u65b0\u5931\u8d25\u65f6\uff0cGitOps \u5de5\u5177\u4f1a\u6839\u636e Git \u4ed3\u5e93\u4e2d\u7684\u5386\u53f2\u8bb0\u5f55\u81ea\u52a8\u56de\u6eda\u5230\u4e0a\u4e00\u4e2a\u5065\u5eb7\u7684\u7248\u672c\u3002\u4f8b\u5982\uff0cArgoCD \u4f1a\u81ea\u52a8\u5c06\u96c6\u7fa4\u72b6\u6001\u6062\u590d\u4e3a Git \u4e2d\u7684\u5148\u524d\u63d0\u4ea4\u7684\u914d\u7f6e\u3002</li> <li>\u5065\u5eb7\u68c0\u67e5\u4e0e\u81ea\u6108\uff1a GitOps \u5de5\u5177\u652f\u6301\u96c6\u6210 Kubernetes \u7684\u5065\u5eb7\u68c0\u67e5\u529f\u80fd\uff0c\u5982 livenessProbe \u548c readinessProbe\uff0c\u786e\u4fdd\u5e94\u7528\u7684\u5065\u5eb7\u72b6\u6001\u3002\u5982\u679c\u68c0\u6d4b\u5230\u5e94\u7528\u7684\u72b6\u6001\u4e0d\u5065\u5eb7\uff0cGitOps \u5de5\u5177\u53ef\u4ee5\u81ea\u52a8\u6267\u884c\u56de\u6eda\u64cd\u4f5c\u4ee5\u6062\u590d\u6b63\u5e38\u3002</li> <li>\u84dd\u7eff\u90e8\u7f72\uff1a GitOps \u5de5\u5177\u4e0e Kubernetes \u7684\u84dd\u7eff\u90e8\u7f72\u6216\u6eda\u52a8\u66f4\u65b0\u7b56\u7565\u7ed3\u5408\uff0c\u786e\u4fdd\u5e94\u7528\u66f4\u65b0\u4e0d\u4f1a\u5bfc\u81f4\u6545\u969c\u3002\u65b0\u7248\u672c\u7684\u5e94\u7528\u4f1a\u5148\u90e8\u7f72\u5230\u84dd\u8272\u73af\u5883\u4e2d\uff0c\u7136\u540e\u9010\u6b65\u5207\u6362\u6d41\u91cf\u3002\u5982\u679c\u65b0\u7248\u672c\u5931\u8d25\uff0c\u6d41\u91cf\u4f1a\u81ea\u52a8\u5207\u6362\u56de\u7eff\u8272\u73af\u5883\uff0c\u4ece\u800c\u6062\u590d\u5230\u7a33\u5b9a\u72b6\u6001\u3002</li> <li>\u58f0\u660e\u5f0f\u540c\u6b65\uff1a GitOps \u5de5\u5177\u901a\u8fc7\u6301\u7eed\u5bf9\u6bd4 Git \u4ed3\u5e93\u4e2d\u7684\u58f0\u660e\u914d\u7f6e\u548c\u96c6\u7fa4\u4e2d\u7684\u5b9e\u9645\u72b6\u6001\uff0c\u5982\u679c\u96c6\u7fa4\u4e2d\u7684\u72b6\u6001\u4e0e Git \u4e2d\u7684\u914d\u7f6e\u4e0d\u4e00\u81f4\uff0cGitOps \u5de5\u5177\u4f1a\u81ea\u52a8\u4fee\u590d\u8fd9\u79cd\u4e0d\u4e00\u81f4\uff0c\u6062\u590d\u5e94\u7528\u5230\u6240\u9700\u7684\u7248\u672c\u3002</li> </ul>"},{"location":"2025/1cicd/#22-gitops","title":"22 GitOps \u5728\u591a\u4e91\u73af\u5883\u4e0b\u5982\u4f55\u5de5\u4f5c\uff1f","text":"<p>\u5728\u591a\u4e91\u73af\u5883\u4e2d\uff0cGitOps \u7684\u57fa\u672c\u539f\u7406\u4f9d\u7136\u9002\u7528\uff0c\u4f46\u4f1a\u9762\u4e34\u4e00\u4e9b\u989d\u5916\u7684\u6311\u6218\u548c\u590d\u6742\u6027\uff1a</p> <ul> <li>\u591a\u4e91\u96c6\u7fa4\u7ba1\u7406\uff1a GitOps \u5de5\u5177\uff08\u5982 ArgoCD\uff09\u53ef\u4ee5\u7ba1\u7406\u591a\u4e2a Kubernetes \u96c6\u7fa4\uff0c\u65e0\u8bba\u8fd9\u4e9b\u96c6\u7fa4\u4f4d\u4e8e\u516c\u6709\u4e91\uff08\u5982 AWS\u3001Azure\u3001Google Cloud\uff09\u8fd8\u662f\u79c1\u6709\u4e91\u4e2d\u3002\u6bcf\u4e2a\u96c6\u7fa4\u53ef\u4ee5\u6709\u72ec\u7acb\u7684 Git \u4ed3\u5e93\u6216\u5206\u652f/\u76ee\u5f55\u6765\u8fdb\u884c\u914d\u7f6e\u7ba1\u7406\u3002</li> <li>\u8de8\u4e91\u8d44\u6e90\u7684\u7ba1\u7406\uff1a \u9664\u4e86 Kubernetes \u96c6\u7fa4\u5916\uff0cGitOps \u53ef\u4ee5\u4e0e\u5176\u4ed6\u57fa\u7840\u8bbe\u65bd\u7ba1\u7406\u5de5\u5177\uff08\u5982 Terraform\uff09\u7ed3\u5408\uff0c\u7ba1\u7406\u8de8\u4e91\u7684\u57fa\u7840\u8bbe\u65bd\u8d44\u6e90\uff08\u4f8b\u5982\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u3001\u5b58\u50a8\u3001\u7f51\u7edc\u7b49\uff09\u3002</li> <li>\u7edf\u4e00\u914d\u7f6e\u548c\u7b56\u7565\uff1a \u4e3a\u4e86\u786e\u4fdd\u8de8\u4e91\u7684\u4e00\u81f4\u6027\uff0cGitOps \u914d\u7f6e\u5e94\u4fdd\u6301\u4e00\u81f4\u3002\u901a\u5e38\uff0c\u901a\u8fc7\u914d\u7f6e\u7ba1\u7406\u548c\u73af\u5883\u914d\u7f6e\u6587\u4ef6\uff08\u4f8b\u5982 Helm charts \u548c Terraform\uff09\u6765\u7ba1\u7406\u591a\u4e91\u73af\u5883\u4e2d\u7684\u57fa\u7840\u8bbe\u65bd\u548c\u5e94</li> </ul> <p>GitOps \u5de5\u5177\u5728\u591a\u4e91\u73af\u5883\u4e2d\u7684\u534f\u4f5c\u65b9\u5f0f\u7c7b\u4f3c\u4e8e\u5355\u96c6\u7fa4\u7ba1\u7406\uff0c\u4f46\u9700\u8981\u5904\u7406\u591a\u4e2a\u96c6\u7fa4\u7684\u914d\u7f6e\u540c\u6b65\u3001\u7f51\u7edc\u8bbf\u95ee\u6743\u9650\u7b49\u95ee\u9898</p>"},{"location":"2025/1interview2025/","title":"2025 interview","text":""},{"location":"2025/1interview2025/#1-what-are-all-the-types-of-applications-you-have-deployed","title":"1. What are all the types of applications you have deployed?","text":"<ul> <li>Web applications (e.g., Java Spring Boot, Node.js),</li> <li>microservices architectures, </li> <li>databases (e.g., MySQL, MongoDB), </li> <li>message brokers (e.g., Apache Kafka), </li> <li>monitoring tools (e.g., Prometheus, Grafana), </li> <li>CI/CD pipelines (e.g., Jenkins), </li> <li>Containerized applications using Docker and Kubernetes</li> </ul>"},{"location":"2025/1interview2025/#2-how-have-you-injected-the-secrets-in-configmaps","title":"2 How have you injected the secrets in ConfigMaps","text":"<ul> <li>Secrets should not be injected in ConfigMaps as ConfigMaps are not designed for  sensitive data. </li> <li>Instead, Kubernetes Secrets should be used. Secrets can be injected into pods via environment variables or mounted as files.</li> </ul>"},{"location":"2025/1interview2025/#3-how-do-you-find-which-pod-is-taking-more-system-resources-across-nodes-using-kubectl","title":"3 How do you find which pod is taking more system resources across nodes using kubectl?","text":"<p>Use </p> <pre><code>kubectl top pod --all-namespaces\n</code></pre> <p>to list resource usage by pods. </p> <p>Combine it with <code>kubectl describe pod &lt;pod-name&gt;</code> to get detailed resource usage</p>"},{"location":"2025/1interview2025/#4-how-do-you-know-which-worker-node-is-consuming-more-resources-across-the-clusters-using-kubectl","title":"4 How do you know which worker node is consuming more resources across the clusters using kubectl?","text":"<p>Use <code>kubectl top nodes</code> to see resource consumption across nodes. </p> <p>This will show CPU and memory usage on each node.</p>"},{"location":"2025/1interview2025/#5-what-are-the-steps-for-configuring-prometheus-and-grafana-for-monitoring-kubernetes-clusters","title":"5. What are the steps for configuring Prometheus and Grafana for monitoring  Kubernetes clusters?","text":"<ol> <li>Deploy Prometheus using Helm or a custom YAML configuration.</li> <li>Set up Kubernetes service discovery for Prometheus.</li> <li>Deploy Grafana and configure it to use Prometheus as a data source.</li> <li>Import Kubernetes monitoring dashboards in Grafana.</li> <li>Set up alerting rules in Prometheus as needed.</li> </ol>"},{"location":"2025/1interview2025/#6-if-20-pods-are-running-how-do-you-visualize-the-metrics-of-these-pods-in-grafana","title":"6. If 20 pods are running, how do you visualize the metrics of these pods in  Grafana?","text":"<p>Configure Grafana to use Prometheus as the data source. Use existing Kubernetes dashboards or create custom dashboards to visualize metrics for all pods.</p>"},{"location":"2025/1interview2025/#7-what-is-apache-kafka","title":"7 What is Apache Kafka?","text":"<p>Apache Kafka is a distributed event streaming platform used for building real-time  data pipelines and streaming applications. It\u2019s designed to handle large volumes of data in a  distributed, fault-tolerant manner.</p>"},{"location":"2025/1interview2025/#8-how-do-you-set-up-a-docker-hub-private-registry-and-integrate-it-with-a-cicd-pipeline-what-is-the-procedure","title":"8. How do you set up a Docker Hub private registry and integrate it with a CI/CD  pipeline? What is the procedure?","text":"<ol> <li>Create a private repository on Docker Hub.</li> <li>Configure CI/CD pipeline to authenticate with Docker Hub using credentials.</li> <li>Build Docker images in CI pipeline and push them to the private repository.</li> <li>Pull images from the private registry during the CD process</li> </ol>"},{"location":"2025/1interview2025/#9-what-is-the-difference-between-a-hard-link-and-a-soft-link","title":"9. What is the difference between a hard link and a soft link?","text":"<ul> <li> <p>Hard Link: A direct reference to the file\u2019s data on the disk. </p> <ul> <li>Deleting the original file does not affect the hard link.</li> </ul> </li> <li> <p>Soft Link (Symbolic Link): A pointer to the original file\u2019s path.</p> <ul> <li>If the original file is deleted, the soft link becomes broken.</li> </ul> </li> </ul>"},{"location":"2025/1interview2025/#10-what-is-the-use-of-the-break-command-in-shell-scripting-in-what-scenarios-have-you-used-it","title":"10. What is the use of the break command in shell scripting? In what scenarios have you used it?","text":"<p>The <code>break</code> command is used to exit a loop prematurely. It is commonly used when a specific condition is met, and you no longer need to continue the loop</p>"},{"location":"2025/1interview2025/#11-how-do-you-count-the-number-of-devops-words-in-15-html-files","title":"11. How do you count the number of \"devops\" words in 15 HTML files?","text":"<p>To count the number of times the word \"devops\" appears across 15 HTML files, you can use the  following shell command:</p> <pre><code>grep -o -i \"devops\" *.html | wc -l\n</code></pre> <ul> <li><code>grep -o -i \"devops\" *.html</code>: Searches for the word \"devops\" (case-insensitive due to -i) in all HTML files and outputs each occurrence on a new line (-o).</li> <li><code>wc -l</code>: Counts the number of lines output by grep, which corresponds to the number of occurrences of \"devops\". </li> </ul>"},{"location":"2025/1interview2025/#12-what-is-the-terraform-taint-command","title":"12. What is the <code>terraform taint</code> command?","text":"<p>The <code>terraform taint</code> command is used to manually mark a specific resource for recreation during the next <code>terraform apply</code>. </p> <p>When a resource is tainted, Terraform will destroy it and create a new instance of it on the next apply.</p> <p>This is useful when you know a resource needs to be replaced but Terraform hasn't automatically determined that it should be</p> <pre><code>Syntax: terraform taint &lt;resource_address&gt;\nExample: terraform taint aws_instance.example\n</code></pre>"},{"location":"2025/1interview2025/#13-what-are-the-possible-ways-to-secure-a-state-file-in-terraform","title":"13. What are the possible ways to secure a state file in Terraform?","text":"<ol> <li>Encrypt the State File: Store the state file in an encrypted format using tools like AWS S3  bucket encryption, Azure Blob encryption, or Google Cloud Storage encryption.</li> <li>Use Remote Backends with Security Controls: Use a remote backend like AWS S3 with IAM roles and policies, HashiCorp Consul with ACLs, or Terraform Cloud, which manages access  control and encryption.</li> <li>Enable Versioning: Use versioning on the state file storage to recover from any unintended  changes or deletions.</li> <li>Access Control: Restrict access to the state file using IAM policies, RBAC (Role-Based Access Control), or similar mechanisms.</li> <li>Use Backend Locking: Use state locking mechanisms provided by backends like S3 with DynamoDB or Consul to prevent concurrent operations from corrupting the state file.</li> </ol>"},{"location":"2025/1interview2025/#14-if-you-provision-100-servers-and-someone-deletes-50-vms-manually-what-happens-if-you-apply-the-terraform-apply-command","title":"14. If you provision 100 servers and someone deletes 50 VMs manually, what happens if you apply the <code>terraform apply</code> command?","text":"<p>When you run <code>terraform apply</code>, Terraform will compare the state file with the actual infrastructure. </p> <p>It will notice that 50 VMs are missing and will attempt to recreate those missing VMs to match the state defined in your configuration. </p> <p>The end result will be 100 VMs again.</p>"},{"location":"2025/1interview2025/#15-what-is-the-syntax-for-for_each-in-terraform","title":"15. What is the syntax for <code>for_each</code> in Terraform?","text":"<p>The <code>for_each</code> meta-argument in Terraform allows you to create multiple instances of a resource or  module based on the items in a map or set. </p> <p>The syntax is as follows:</p> <pre><code>resource \"aws_instance\" \"example\" {\n    for_each = var.instances\n    ami = each.value[\"ami\"]\n    instance_type = each.value[\"instance_type\"]\n    tags = {\n        Name = each.key\n    }\n }\n</code></pre> <p>In this example, </p> <p>var.instances is a map, and each.key refers to the current key in the map,  while each.value refers to the associated value.</p>"},{"location":"2025/1interview2025/#16-what-are-the-advantages-and-disadvantages-of-multi-stage-builds-in-docker","title":"16. What are the advantages and disadvantages of multi-stage builds in  Docker?","text":""},{"location":"2025/1interview2025/#advantages","title":"Advantages","text":"<ul> <li>Smaller Image Size: By separating the build environment from the runtime environment, only the necessary components are included in the final image, leading to smaller image sizes.</li> <li>Improved Security: Reduces the attack surface by excluding build tools and other unnecessary components from the final image.</li> <li>Better Caching: Allows for more efficient use of Docker\u2019s caching mechanism, potentially speeding up the build process.</li> <li>Separation of Concerns: Different stages can focus on specific tasks, making the Dockerfile more organized and easier to maintain.</li> </ul>"},{"location":"2025/1interview2025/#disadvantages","title":"Disadvantages","text":"<ul> <li>Complexity: Multi-stage Dockerfiles can be more complex and harder to understand, especially for those new to Docker.</li> <li>Longer Build Times: In some cases, the use of multiple stages may lead to longer build  times due to additional steps and transitions between stages.</li> <li>Troubleshooting: Debugging and troubleshooting can be more challenging because intermediate stages are not preserved by default.</li> </ul>"},{"location":"2025/1interview2025/#17-how-do-you-deploy-containers-on-different-hosts-not-the-same-host-within-a-docker-cluster","title":"17. How do you deploy containers on different hosts, not the same host, within a Docker cluster?","text":"<p>To deploy containers on different hosts within a Docker cluster, you can use Docker Swarm or Kubernetes</p> <p>Docker Swarm: Use Docker Swarm\u2019s built-in orchestration capabilities. </p> <p>When deploying a service, Swarm will automatically distribute the containers across different nodes in the  cluster. You can influence this behavior using placement constraints.</p> <p>Example</p> <pre><code>docker service create --name myservice --replicas 2 --constraint 'node.role == worker' myimage\n</code></pre> <p>Kubernetes: Use Kubernetes, which will schedule pods on different nodes based on the available resources and any specified node selectors or affinities</p>"},{"location":"2025/1interview2025/#18-if-you-have-a-docker-compose-setup-how-do-you-deploy-the-web-container-on-one-host-and-the-db-container-on-another-host","title":"18. If you have a Docker Compose setup, how do you deploy the web container on one host and the DB container on another host?","text":"<p>To deploy the web container on one host and the DB container on another using Docker Compose,  you can:</p> <ol> <li>Use Docker Swarm: Convert the Compose file into a stack file, and deploy it with docker  stack deploy. Docker Swarm will distribute services across nodes.</li> <li>Manual Placement: Use placement constraints in your docker-compose.yml file to specify which containers should run on which nodes.</li> </ol> <pre><code>version: '3.7'\nservices:\n web:\n image: my-web-image\n deploy:\n  placement:\n  constraints: [node.hostname == web-node]\n\n db:\n image: my-db-image\n deploy:\n    placement:\n    constraints: [node.hostname == db-node]\n</code></pre>"},{"location":"2025/1interview2025/#19-what-is-the-difference-between-bridge-networking-and-host-networking-in-docker","title":"19. What is the difference between bridge networking and host networking in Docker","text":"<ul> <li>Bridge Networking: The default Docker network driver. <ul> <li>Containers connected to the same bridge network can communicate with each other. </li> <li>Each container gets its own IP address  and is isolated from the host network. You can expose ports to the host using the <code>-p</code> option.</li> </ul> </li> <li>Host Networking: The container shares the host's network stack, <ul> <li>meaning it doesn\u2019t get its own IP address, and the container's network is the same as the host's network. </li> <li>This can lead to performance improvements but reduces isolation between the host and the container.</li> </ul> </li> </ul>"},{"location":"2025/1interview2025/#20-how-do-you-resolve-merge-conflicts","title":"20. How do you resolve merge conflicts","text":"<p>To resolve merge conflicts, follow these steps:</p> <ol> <li>Identify the Conflict: Git will mark the conflicting areas in the files with conflict markers  (&lt;&lt;&lt;&lt;&lt;&lt;&lt;, =======, and &gt;&gt;&gt;&gt;&gt;&gt;&gt;).</li> <li>Manually Resolve: Open the conflicting file and decide how to combine the changes. Remove the conflict markers and modify the content to resolve the conflict.</li> <li>Stage the Resolved Files: Once resolved, stage the files using <code>git add</code>.</li> <li>Commit the Changes: Commit the resolved conflicts with <code>git commit</code>. If you were in the middle of a merge, this will complete the merge process.</li> <li>Test: Run tests to ensure that the merge didn\u2019t introduce any issues.</li> </ol> <p>Example:</p> <pre><code>git add &lt;resolved-files&gt;\ngit commit -m \"Resolved merge conflicts in X, Y, Z files\n</code></pre>"},{"location":"2025/1interview2025/#21-what-command-do-you-use-to-change-the-existing-commit-message","title":"21. What command do you use to change the existing commit message?","text":"<p>To change the most recent commit message, you can use the following Git command</p> <pre><code>git commit --amend -m \"New commit message\"\n</code></pre> <p>If you have already pushed the commit to a remote repository, you will need to force push the  changes:</p> <pre><code>git push --force\n</code></pre>"},{"location":"2025/1interview2025/#22-what-is-session-affinity","title":"22. What is session affinity?","text":"<p>Session affinity, also known as sticky sessions, is a concept in load balancing where requests from a  particular user are consistently directed to the same server (or pod) in a multi-server environment. </p> <p>This ensures that the user's session data, which might be stored locally on the server, remains  accessible throughout the session.</p>"},{"location":"2025/1interview2025/#23-what-is-pod-affinity-and-its-use-case","title":"23. What is pod affinity and its use case?","text":"<p>Pod affinity is a feature in Kubernetes that allows you to specify rules for scheduling pods to run on  nodes that have other specified pods running on them. </p> <p>This can be useful when you want certain  pods to be located together due to factors like data locality, network latency, or shared resources.</p> <p>Use Case: An application where the frontend and backend services communicate frequently might  use pod affinity to ensure that both are scheduled on the same node to reduce network latency</p>"},{"location":"2025/1interview2025/#24-what-is-the-difference-between-pod-affinity-and-pod-anti-affinity","title":"24. What is the difference between pod affinity and pod anti-affinity?","text":"<ul> <li>Pod Affinity: Ensures that pods are scheduled on the same node or in proximity to each other.</li> <li>Pod Anti-Affinity: Ensures that pods are not scheduled on the same node or are placed far </li> <li>apart from each other.</li> </ul> <p>Example Use Case:</p> <ul> <li>Pod Affinity: Running frontend and backend on the same node for low-latency communication.</li> <li>Pod Anti-Affinity: Ensuring replicas of the same application are spread across different nodes to increase availability and fault tolerance.</li> </ul>"},{"location":"2025/1interview2025/#25-what-are-readiness-and-liveness-probes","title":"25. What are readiness and liveness probes?","text":"<ul> <li>Readiness Probe: Used to determine when a pod is ready to start accepting traffic. If the  readiness probe fails, the pod will be removed from the service endpoints, ensuring it does not receive traffic until it's ready.</li> <li>Liveness Probe: Used to determine if a pod is still running. If the liveness probe fails, Kubernetes will restart the pod, assuming it's in a failed state.</li> </ul>"},{"location":"2025/1interview2025/#26-write-a-simple-groovy-pipeline-for-a-java-spring-boot-application-that-waits-for-user-input-for-approval-to-move-to-the-next-stage-with-stages-for-checkout-build-push-and-deploy","title":"26. Write a simple Groovy pipeline for a Java Spring Boot application that waits for user input for approval to move to the next stage, with stages for checkout,  build, push, and deploy","text":"<pre><code>pipeline {\n agent any\n\n stages {\n    stage('Checkout') {\n        steps {\n        git 'https://github.com/your-repo/java-spring-boot-app.git'\n    }\n }\n\n stage('Build') {\n    steps {\n        sh './mvnw clean package'\n    }\n }\n\n stage('Push') {\n    steps {\n        sh 'docker build -t your-docker-repo/java-spring-boot-app .'\n        sh 'docker push your-docker-repo/java-spring-boot-app'\n    }\n }\n\n stage('Approval') {\n    steps {\n        input 'Do you want to deploy to production?'\n    }\n }\n\n stage('Deploy') {\n    steps {\n        sh 'kubectl apply -f deployment.yaml'\n        }\n    }\n } \n}\n</code></pre>"},{"location":"2025/1interview2025/#27-how-do-you-export-test-reports-in-jenkins","title":"27. How do you export test reports in Jenkins?","text":"<p>To export test reports in Jenkins:</p> <ol> <li>Ensure that your tests generate reports in a standard format like JUnit XML or HTML.</li> <li>Use the Publish JUnit test result report post-build action to archive test reports.</li> <li>You can also use the Archive the artifacts post-build action to store other types of reports.</li> <li>The test reports can then be accessed and downloaded from the Jenkins build page</li> </ol>"},{"location":"2025/1interview2025/#28-if-5-pods-are-running-how-do-you-scale-the-number-of-pods-to-10-using-the-command-line-in-kubernetes","title":"28. If 5 pods are running, how do you scale the number of pods to 10 using the  command line in Kubernetes?","text":"<p>To scale the number of pods from 5 to 10, use the following command:</p> <pre><code>kubectl scale --replicas=10 deployment/&lt;your-deployment-name&gt;\n</code></pre>"},{"location":"2025/1interview2025/#29-can-you-explain-the-usage-of-the-terraform-import-command","title":"29. Can you explain the usage of the terraform import command?","text":"<p>The terraform import command is used to import existing infrastructure resources into Terraform's state file, allowing Terraform to manage them. </p> <p>This is particularly useful when you want to bring existing infrastructure under Terraform management without having to recreate resources.</p> <pre><code>terraform import &lt;resource_type&gt;.&lt;resource_name&gt; &lt;resource_id&gt;\n</code></pre> <pre><code>terraform import aws_instance.my_instance i-1234567890abcdef0\n</code></pre>"},{"location":"2025/1interview2025/#30-in-aws-where-do-you-store-the-state-file-and-how-do-you-manage-it","title":"30. In AWS, where do you store the state file, and how do you manage it?","text":"<p>In AWS, Terraform state files are typically stored in an S3 bucket, and the state can be managed using a combination of S3 and DynamoDB for locking.</p> <p>Example Configuration:</p> <pre><code>terraform {\n backend \"s3\" {\n bucket = \"my-terraform-state-bucket\"\n key = \"path/to/my/terraform.tfstate\"\n region = \"us-west-2\"\n dynamodb_table = \"terraform-lock-table\"\n encrypt = true\n }}\n</code></pre> <p>Management</p> <ul> <li>S3: Stores the state file securely, supports versioning, and can be encrypted.</li> <li>DynamoDB: Provides locking to prevent multiple simultaneous operations on the same state file, avoiding conflicts.</li> </ul> <p>This setup ensures that your Terraform state is stored securely and is protected from simultaneous  access issues</p>"},{"location":"2025/1interview2025/#31-what-is-the-biggest-issue-you-have-faced-with-terraform-and-how-did-you-resolve-it","title":"31. What is the biggest issue you have faced with Terraform, and how did you resolve it?","text":"<p>One significant issue I faced was managing Terraform state when multiple teams were working on the same infrastructure. </p> <p>This was resolved by organizing the infrastructure into separate modules and using remote state management with proper locking mechanisms</p>"},{"location":"2025/1interview2025/#32-what-are-the-types-of-storage-accounts-in-aws-s3","title":"32. What are the types of storage accounts in AWS S3?","text":"<p>In AWS S3, the different storage classes include:</p> <ul> <li>S3 Standard</li> <li>S3 Intelligent-Tiering</li> <li>S3 Standard-IA (Infrequent Access)</li> <li>S3 One Zone-IA</li> <li>S3 Glacier</li> <li>S3 Glacier Deep Archive</li> </ul>"},{"location":"2025/1interview2025/#33-are-you-familiar-with-lifecycle-management-in-s3-buckets-how-do-you-set-up-lifecycle-policies","title":"33. Are you familiar with lifecycle management in S3 buckets? How do you set up lifecycle  policies?","text":"<p>Yes, lifecycle management in S3 allows you to define rules to transition objects between different storage classes or delete them after a certain period. </p> <p>Lifecycle policies can be set up using the S3 Management Console, AWS CLI, or Terraform by specifying the transitions and expiration actions in a JSON configuration file.</p>"},{"location":"2025/1interview2025/#34-what-are-the-differences-between-load-balancers-and-why-do-we-need-them","title":"34. What are the differences between load balancers, and why do we need them?","text":"<p>Load balancers distribute incoming network traffic across multiple servers. The main types are:</p> <ul> <li>Application Load Balancer (ALB): Operates at the application layer (Layer 7), and is used for HTTP/HTTPS traffic with advanced routing capabilities.</li> <li>Network Load Balancer (NLB): Operates at the transport layer (Layer 4) and is used for ultra-low latency TCP/UDP traffic.</li> <li>Classic Load Balancer (CLB): Supports both Layer 4 and Layer 7, but is now mostly deprecated in favor of ALB and NLB</li> </ul> <p>Load balancers improve fault tolerance, scalability, and ensure high availability.</p>"},{"location":"2025/1interview2025/#35-have-you-worked-with-auto-scaling-groups-asg","title":"35. Have you worked with Auto Scaling Groups (ASG)","text":"<p>Yes, I have worked with ASGs to automatically scale the number of instances in response to demand. </p> <p>ASGs are configured with policies that adjust the desired capacity based on metrics such as CPU utilization, helping to maintain application performance and optimize costs.</p>"},{"location":"2025/1interview2025/#36-can-you-write-a-simple-dockerfile","title":"36. Can you write a simple Dockerfile?","text":"<p>Yes, here is a simple example of a Dockerfile for a Node.js application:</p> <p>Dockerfile</p> <pre><code>FROM node: 14\nWORKDIR /app\nCopy package.json\nRUN npm install\nCOPY . .\nEXPOSE 3000\nCMD [ \"npm\", \"start\"]\n</code></pre>"},{"location":"2025/1interview2025/#37-if-you-want-to-expose-your-application-to-the-public-internet-or-access-your-application-within-a-cluster-how-would-you-do-that-in-kubernetes","title":"37. If you want to expose your application to the public internet or access your application within a cluster, how would you do that in Kubernetes?","text":"<p>To expose your application to the public internet, you can use a Kubernetes Service of type LoadBalancer or NodePort. </p> <p>For internal access within the cluster, you can use a ClusterIP service. Additionally, you might use an Ingress controller for more advanced routing.</p>"},{"location":"2025/1interview2025/#38-why-do-we-need-a-configmap-in-kubernetes","title":"38. Why do we need a ConfigMap in Kubernetes?","text":"<p>A ConfigMap is used to store non-confidential configuration data in key-value pairs. </p> <p>It allows you to decouple configuration artifacts from image content, enabling you to modify application settings without rebuilding your container images</p>"},{"location":"2025/1interview2025/#39-which-aws-services-do-you-consider-when-setting-up-a-cicd-pipeline-for-a-microservices-application","title":"39. Which AWS services do you consider when setting up a CI/CD pipeline for a microservices application?","text":"<p>For a CI/CD pipeline, I would consider using:</p> <ul> <li>AWS CodeCommit for source control.</li> <li>AWS CodeBuild for building and testing.</li> <li>AWS CodeDeploy or Amazon EKS for deployment.</li> <li>AWS CodePipeline to orchestrate the CI/CD process.</li> <li>Amazon S3 for artifact storage.</li> <li>AWS Lambda for any custom automation tasks.</li> </ul>"},{"location":"2025/1interview2025/#40-on-a-day-with-unusually-high-traffic-for-an-e-commerce-application-how-would-you-as-a-cloud-engineer-manage-the-current-setup-to-handle-the-load-smoothly","title":"40. On a day with unusually high traffic for an e-commerce application, how would you, as a cloud engineer, manage the current setup to handle the load smoothly","text":"<p>I would ensure that Auto Scaling Groups are properly configured to handle the increased demand by automatically adding more instances. </p> <p>I'd also verify that the load balancers are evenly distributing traffic and consider enabling caching (e.g., using Amazon CloudFront) to reduce the load on backend servers. Monitoring tools like CloudWatch would be used to  track performance metrics and adjust resources in real-time</p> <p>Strategies:</p> <ul> <li>Auto Scaling: Scale up instances automatically to handle the increased load.</li> <li>Caching: Use a caching layer to reduce the load on your application servers.</li> <li>Load Balancing: Distribute traffic evenly across available instances.</li> <li>Database Optimization: Ensure your database is properly configured and optimized for performance.</li> <li>Monitoring: Closely monitor system metrics to identify bottlenecks and adjust resources accordingly</li> </ul>"},{"location":"2025/1interview2025/#41-if-traffic-is-currently-handled-on-a-single-instance-how-would-you-upgrade-for-high-availability-in-aws","title":"41. If traffic is currently handled on a single instance, how would you upgrade for high availability  in AWS?","text":"<ul> <li>To upgrade for high availability, I would:<ul> <li>Deploy multiple instances across different Availability Zones (AZs) using an Auto Scaling Group.</li> <li>Set up a Load Balancer (ALB or NLB) to distribute traffic across these instances.</li> <li>Configure health checks to ensure traffic is only routed to healthy instances.</li> <li>Use Multi-AZ deployments for databases like RDS to ensure data availability</li> </ul> </li> </ul>"},{"location":"2025/1interview2025/#42-when-auto-scaling-instances-how-do-you-manage-the-backend-rds-database","title":"42. When auto-scaling instances, how do you manage the backend RDS database?","text":"<ul> <li>To manage the backend RDS database during auto-scaling:<ul> <li>Enable Multi-AZ for high availability and automatic failover.</li> <li>Use RDS Read Replicas to handle read-heavy traffic, reducing the load on the primary database.</li> <li>Scale RDS vertically (instance size) or horizontally (read replicas) based on the database workload.</li> <li>Monitor performance using Amazon CloudWatch and adjust as necessary</li> </ul> </li> </ul>"},{"location":"2025/1interview2025/#43-have-you-ever-set-up-cross-account-access-for-s3-for-example-if-the-qa-team-needs-access-to-the-production-database","title":"43. Have you ever set up cross-account access for S3? For example, if the QA team needs access to the production database.","text":"<p>Yes, I've set up cross-account access by:</p> <ul> <li>Creating an IAM role in the production account with the necessary S3 permissions.</li> <li>Establishing a trust relationship to allow the QA account to assume that role.</li> <li>Using S3 bucket policies to grant access from the QA account.<ul> <li>QA team members can then assume the role using AWS STS (Security Token Service) to access the production S3 bucket.</li> </ul> </li> </ul>"},{"location":"2025/1interview2025/#44-how-can-an-s3-account-in-account-a-access-an-s3-account-in-account-b","title":"44. How can an S3 account in Account A access an S3 account in Account B?","text":"<p>Account A can access Account B\u2019s S3 bucket by:</p> <ul> <li>Setting up a bucket policy in Account B that grants Account A the necessary permissions.</li> <li>Creating an IAM role in Account B with permissions for S3 and allowing Account A to assume that role via a trust policy.</li> <li>Using AWS STS to assume the role from Account A and access the S3 bucket in Account B.</li> </ul>"},{"location":"2025/1interview2025/#45-can-you-differentiate-between-iam-policies-and-iam-roles","title":"45. Can you differentiate between IAM policies and IAM roles?","text":"<p>IAM Policies: These are sets of permissions attached to users, groups, or roles, defining what actions are allowed or denied</p> <p>IAM Roles: These are identities with specific permissions that can be assumed by entities like users, applications, or AWS services. Roles are often used for temporary access or cross-account access.</p>"},{"location":"2025/1interview2025/#46-can-you-explain-the-sts-assume-role-policy","title":"46. Can you explain the STS assume role policy?","text":"<p>The STS (Security Token Service) AssumeRole policy allows a user or service to assume a role in a different account or within the same account. </p> <p>This provides temporary security credentials with the permissions associated with the assumed role, enabling cross-account access or delegation of permissions</p>"},{"location":"2025/1interview2025/#47-have-you-experienced-any-challenging-issues-or-incidents-in-your-project-how-did-you-and-your-team-identify-and-resolve-them","title":"47. Have you experienced any challenging issues or incidents in your project? How did you and  your team identify and resolve them?","text":"<p>Yes, one challenge was a sudden traffic spike causing performance degradation. </p> <p>We identified the issue using CloudWatch metrics and logs, pinpointing the bottleneck in the database.</p> <p>The resolution involved scaling the database vertically and adding read replicas to distribute the load, along with optimizing slow-running queries.</p>"},{"location":"2025/1interview2025/#48-what-is-the-difference-between-cmd-and-entrypoint-in-docker","title":"48. What is the difference between CMD and ENTRYPOINT in Docker?","text":"<ul> <li>CMD: Provides default arguments for the entrypoint or the command to run if no other  command is provided.</li> <li>ENTRYPOINT: Defines the executable that will always run, with CMD as its default  arguments. ENTRYPOINT is useful when you want your container to behave like a specific  executable.</li> <li>Example: <code>ENTRYPOINT [\"python\", \"app.py\"]</code> ensures app.py is always executed, while CMD allows passing different arguments.</li> </ul>"},{"location":"2025/1interview2025/#49-have-you-ever-managed-an-application-single-handedly","title":"49. Have you ever managed an application single-handedly?","text":"<p>Yes, I have managed applications single-handedly, handling tasks such as deployment, monitoring, troubleshooting, and scaling. </p> <p>This involved setting up the infrastructure, CI/CD  pipelines, and ensuring high availability and security</p>"},{"location":"2025/1interview2025/#50-what-are-the-benefits-of-infrastructure-as-code-iac","title":"50. What are the benefits of Infrastructure as Code (IaC)?","text":"<ul> <li>Consistency: Ensures consistent environments by automating the provisioning process.</li> <li>Version Control: Infrastructure can be versioned and tracked, enabling rollbacks and audits.</li> <li>Automation: Reduces manual intervention, minimizing errors and speeding up deployments.</li> <li>Scalability: Allows easy scaling and management of resources through scripts.</li> <li>Collaboration: Teams can collaborate more effectively using code reviews and version control systems.</li> </ul>"},{"location":"2025/1interview2025/#51-what-are-the-different-ways-to-create-infrastructure-as-code","title":"51. What are the different ways to create infrastructure as code?","text":"<ul> <li>Terraform: A popular open-source tool that allows you to define infrastructure as code using a declarative configuration language. It works with various cloud providers.</li> <li>AWS CloudFormation: A service provided by AWS that enables you to define AWS resources  using JSON or YAML templates.</li> <li>Azure Resource Manager (ARM) Templates: Azure's solution for infrastructure as code, allowing you to define resources in JSON.</li> <li>Google Cloud Deployment Manager: Google's infrastructure as code tool that uses YAML to define resources.</li> <li>Ansible: Although primarily a configuration management tool, it can also be used to provision infrastructure using playbooks written in YAML</li> <li>Pulumi: A modern infrastructure as code tool that supports multiple programming languages  like Python, JavaScript, and Go</li> </ul>"},{"location":"2025/1interview2025/#52-what-is-the-difference-between-public-and-private-networking","title":"52. What is the difference between public and private networking?","text":"<ul> <li>Public Networking: Refers to networks that are accessible from the internet. Public IP  addresses are used, and resources are exposed to external access.</li> <li>Private Networking: Refers to networks that are isolated from the public internet. <ul> <li>Resources within a private network communicate with each other securely using private IP addresses,  and access from outside is typically restricted.</li> </ul> </li> </ul>"},{"location":"2025/1interview2025/#53-what-is-a-docker-registry-and-why-do-we-need-it","title":"53. What is a Docker registry and why do we need it?","text":"<ul> <li>Docker Registry: A storage and distribution system for Docker images. It allows you to store, share, and manage Docker container images. Docker Hub is a popular public registry, but you can also set up private registries.</li> <li>Why We Need It: Docker registries allow teams to version, share, and deploy Docker images easily. They support CI/CD pipelines by enabling automated builds and deployments.</li> </ul>"},{"location":"2025/1interview2025/#54-what-is-a-secrets-manager","title":"54. What is a secrets manager?","text":"<ul> <li>Secrets Manager: A tool or service that securely stores and manages sensitive information such as API keys, passwords, certificates, and tokens. Examples include AWS Secrets Manager, HashiCorp Vault, and Azure Key Vault.</li> <li>Purpose: To securely store and access secrets without hardcoding them into application code or configuration files</li> </ul>"},{"location":"2025/1interview2025/#55-what-is-the-secure-way-to-manage-sensitive-information","title":"55. What is the secure way to manage sensitive information?","text":"<ul> <li>Use a Secrets Manager: Store secrets in a dedicated service like AWS Secrets Manager,  Azure Key Vault, or HashiCorp Vault.</li> <li>Environment Variables: Use environment variables to inject secrets at runtime rather than storing them in code.</li> <li>Encrypted Storage: Store sensitive data in encrypted databases or files, ensuring that encryption keys are managed securely.</li> <li>Access Control: Implement strict access controls and auditing to ensure that only authorized personnel and applications can access sensitive information.</li> </ul>"},{"location":"2025/1interview2025/#56-have-you-worked-with-kubernetes-k8s","title":"56. Have you worked with Kubernetes (K8s)?","text":"<p>If you have experience with Kubernetes, you might discuss:</p> <ul> <li>Deploying and managing containerized applications using Kubernetes.</li> <li>Configuring Kubernetes clusters and using tools like kubectl.</li> <li>Managing services, ingress, and networking in Kubernetes.</li> <li>Using Helm charts for packaging and deploying applications.</li> </ul>"},{"location":"2025/1interview2025/#57-what-is-the-difference-between-docker-and-kubernetes","title":"57. What is the difference between Docker and Kubernetes?","text":"<ul> <li>Docker: A platform for developing, shipping, and running applications inside containers. It simplifies the process of managing application dependencies and environment consistency.</li> <li>Kubernetes: An open-source orchestration system for automating the deployment, scaling, and management of containerized applications. Kubernetes manages multiple containers across a cluster, providing features like load balancing, scaling, and self-healing.</li> </ul>"},{"location":"2025/1interview2025/#58-can-you-explain-an-end-to-end-deployment-for-an-application","title":"58. Can you explain an end-to-end deployment for an application?","text":"<p>An end-to-end deployment process might involve the following steps:</p> <ol> <li>Code Commit: Developers push code changes to a version control system like Git.</li> <li>CI/CD Pipeline: A continuous integration pipeline builds the code, runs tests, and creates a  Docker image.</li> <li>Image Storage: The Docker image is pushed to a Docker registry.</li> <li>Deployment: The image is pulled from the registry by Kubernetes, Docker Swarm, or another  orchestration tool, and deployed to a staging or production environment.</li> <li>Monitoring &amp; Logging: The application is monitored for performance and errors, with logs  collected and analyzed.</li> <li>Scaling &amp; Updates: The application is scaled based on demand, and updates are rolled out  using a strategy like blue-green or canary deployment</li> </ol>"},{"location":"2025/1interview2025/#59-if-you-want-to-use-kubernetes-instead-of-ec2-instances-how-would-you-do-it-have-you-used-helm-charts-or-other-cd-tools-how-would-you-handle-a-project-with-multiple-microservices-on-kubernetes","title":"59. If you want to use Kubernetes instead of EC2 instances, how would  you do it? Have you used Helm charts or other CD tools? How would you handle a project with multiple microservices on Kubernetes?","text":"<ul> <li>Using Kubernetes Instead of EC2: You would deploy your applications on a Kubernetes  cluster rather than directly on EC2 instances. This involves setting up an EKS (Elastic  Kubernetes Service) cluster in AWS or using another managed Kubernetes service.</li> <li>Helm Charts: Helm is a package manager for Kubernetes that helps you manage Kubernetes  applications. You can use Helm charts to deploy and manage multiple microservices in a consistent and repeatable manner.</li> <li>Handling Multiple Microservices: Use Kubernetes namespaces to isolate microservices, and manage their deployment using Helm charts or a CI/CD tool like Jenkins, ArgoCD, or GitLab CI/CD. Implement service discovery, networking, and security policies to ensure seamless communication between microservices.</li> </ul>"},{"location":"2025/1interview2025/#60-how-do-you-connect-a-bastion-host-to-a-private-network-can-you-explain-vpc-and-vpc-peering","title":"60. How do you connect a bastion host to a private network? Can you explain VPC and VPC peering?","text":"<p>Connecting a Bastion Host: A bastion host is typically set up in a public subnet of a Virtual Private Cloud (VPC) with access to the private network. </p> <p>Users connect to the bastion host via SSH, and from there, they can access resources in the private subnet.</p> <p>VPC (Virtual Private Cloud): A logically isolated section of a cloud provider's network where  you can launch and manage resources. It allows you to define IP ranges, subnets, route tables, and network gateways.</p> <p>VPC Peering: A network connection between two VPCs that allows traffic to be routed between them using private IP addresses. This is useful for connecting resources across different VPCs without going over the public internet.</p>"},{"location":"2025/1interview2025/#61-have-you-configured-a-system-where-code-is-automatically-merged-and-published-upon-a-developer-completing-a-ticket-in-jira-what-exactly-have-you-managed","title":"61. Have you configured a system where code is automatically merged and published upon a developer completing a ticket in Jira? What exactly have you managed","text":"<p>Yes, I have set up a CI/CD pipeline where code is automatically merged and published once a  developer completes a ticket in Jira. This process typically involves:</p> <ul> <li>Integration with Jira: Configuring Jira to trigger CI/CD pipelines when a ticket is marked as \"Done\" or moved to a specific workflow stage.</li> <li>Code Merging: Using tools like GitLab CI, GitHub Actions, or Jenkins to automatically merge feature branches into the main branch after passing tests.</li> <li>Automated Testing: Running unit, integration, and end-to-end tests to ensure the quality of the code before merging.</li> <li>Deployment: Using deployment tools like Kubernetes, Helm, or Docker Swarm to automatically deploy the merged code to staging or production environments.</li> </ul>"},{"location":"2025/1interview2025/#62-how-do-you-set-up-nginx-on-a-server","title":"62. How do you set up Nginx on a server?","text":"<p>Setting up Nginx on a server involves:</p> <p>1. Installation:</p> <ul> <li>For Ubuntu/Debian: <code>sudo apt-get update &amp;&amp; sudo apt-get install</code>  nginx</li> <li>For CentOS/RHEL: <code>sudo yum install nginx</code></li> </ul> <p>2. Configuration:</p> <ul> <li>Edit the configuration file located at <code>/etc/nginx/nginx.conf</code> or individual site  configurations in <code>/etc/nginx/sites-available/</code>. </li> <li>Define server blocks (virtual hosts) to specify different sites and their root  directories. Configure reverse proxy, load balancing, SSL/TLS certificates, and caching as  needed.</li> </ul> <p>3. Start and Enable Nginx: </p> <ul> <li>Start the service: <code>sudo systemctl start nginx</code></li> <li>Enable it to start on boot: <code>sudo systemctl enable nginx</code></li> </ul> <p>4. Testing: </p> <ul> <li>Test the configuration: <code>sudo nginx -t</code></li> <li>Ensure Nginx is running and properly serving content.</li> </ul>"},{"location":"2025/1interview2025/#63-what-is-a-load-balancer-and-its-benefits-what-is-cloud-nat","title":"63. What is a load balancer and its benefits? What is Cloud NAT?","text":"<p>Load Balancer: A load balancer distributes incoming network traffic across multiple servers or services to ensure reliability, scalability, and high availability. Benefits include:</p> <ul> <li>Increased Fault Tolerance: Distributes traffic to prevent overload on a single server.</li> <li>Scalability: Easily manage increased traffic by adding more servers.</li> <li>Improved Performance: Balances load based on performance metrics, reducing latency.</li> </ul> <p>Cloud NAT: Network Address Translation (NAT) service in cloud environments like Google  Cloud. </p> <p>It allows instances in private subnets to connect to the internet without exposing  them to inbound internet traffic, maintaining security while enabling outbound connectivity</p>"},{"location":"2025/1interview2025/#64-what-is-the-difference-between-a-load-balancer-and-a-cloud-nat-gateway","title":"64. What is the difference between a load balancer and a Cloud NAT gateway?","text":"<p>**Load Balancer: **</p> <ul> <li>Distributes incoming traffic across multiple servers or services.</li> <li>Primarily used for load distribution, redundancy, and high availability.</li> <li>Works at various layers (L4 for TCP, L7 for HTTP/HTTPS).</li> </ul> <p>Cloud NAT Gateway:</p> <ul> <li>Provides outbound internet access for instances in a private network without exposing them to inbound traffic.</li> <li>Used for secure, private instances that need internet access without being directly accessible from the internet.</li> </ul>"},{"location":"2025/1interview2025/#65-how-do-you-see-yourself-fitting-into-this-particular-role","title":"65. How do you see yourself fitting into this particular role?","text":"<p>I see myself fitting into this role by leveraging my technical expertise in infrastructure management, automation, and cloud technologies. </p> <p>My experience in setting up CI/CD pipelines, managing deployments, and optimizing resource allocation aligns with the responsibilities of this role. I also bring problem-solving skills and a proactive approach to ensuring system reliability, which will contribute to the success of the team and organization.</p> <p>In a previous project, I noticed that our cloud infrastructure was over-provisioned, leading to unnecessary costs. </p> <p>I implemented auto-scaling based on actual usage metrics and utilized spot instances for non-critical workloads. </p> <p>Additionally, I restructured the storage solution by moving infrequently accessed data to lower-cost storage classes. </p> <p>These changes resulted in asignificant reduction in our monthly cloud expenses without compromising performance</p>"},{"location":"2025/1interview2025/#67-describe-a-situation-where-the-entire-production-instance-crashed-and-you-had-to-fix-it-quickly-have-you-experienced-such-a-scenario","title":"67. Describe a situation where the entire production instance crashed, and you had to fix it quickly. Have you experienced such a scenario?","text":"<p>Yes, I have experienced such a scenario. In one instance, our production server crashed due to a memory leak in the application. </p> <p>I quickly identified the issue using monitoring tools like Prometheus and logs from ELK Stack. </p> <p>To resolve it, I restarted the affected services and temporarily scaled up the infrastructure to handle the load. I then worked with the development team to identify and fix the memory leak, ensuring it didn\u2019t happen again</p>"},{"location":"2025/1interview2025/#68-what-is-blue-green-deployment-and-why-is-it-needed","title":"68. What is blue-green deployment and why is it needed?","text":"<p>Blue-Green Deployment: </p> <ul> <li>A deployment strategy where two identical environments (Blue and Green) are maintained. </li> <li>The Blue environment is the active production environment, while the Green is the idle one. During deployment, the new version is deployed to the Green environment. </li> <li>After testing, traffic is switched to Green, making it the new production environment.</li> </ul> <p>Why Needed: </p> <ul> <li>Minimal Downtime: Reduces downtime as the switch between environments is  instantaneous.</li> <li>Easy Rollback: If issues arise, switching back to the Blue environment is straightforward.</li> <li>Improved Reliability: Reduces the risk of deployment failures affecting users.</li> </ul>"},{"location":"2025/1interview2025/#69-what-other-deployment-strategies-do-you-know","title":"69. What other deployment strategies do you know?","text":"<ul> <li>Canary Deployment: Gradually rolling out the new version to a small subset of users before a full deployment.</li> <li>Rolling Deployment: Incrementally updating instances or servers with the new version,  ensuring at least some instances are always running the old version.</li> <li>A/B Testing: Similar to blue-green, but used for comparing different versions/features with live user traffic to determine which performs better.</li> <li>Feature Toggles: Allows features to be turned on/off dynamically, enabling deployment of  incomplete features without impacting the user.</li> </ul>"},{"location":"2025/1interview2025/#70-what-advanced-aws-resource-types-have-you-worked-with-and-utilized","title":"70. What advanced AWS resource types have you worked with and utilized?","text":"<ul> <li>AWS Lambda: Serverless computing for running code in response to events without  managing servers.</li> <li>AWS Fargate: Serverless compute engine for containers, allowing the deployment of  containerized applications without managing the underlying infrastructure.</li> <li>Amazon RDS: Managed database service for relational databases, including features like  automated backups, scaling, and multi-AZ deployments.</li> <li>AWS CloudFormation: Infrastructure as Code (IaC) tool for automating resource provisioning and management.</li> <li>Amazon VPC Peering and Transit Gateway: For creating complex network architectures  across multiple VPCs and accounts.</li> <li>AWS Step Functions: Orchestration service for combining AWS Lambda functions and other  services into serverless workflows.</li> </ul>"},{"location":"2025/1interview2025/#71-how-are-hosted-modules-like-aiml-deployed-customized-and-scaled-as-per-different-frontendbackend-requirements-in-aws-with-the-help-of-a-devops-engineer-deploying-customizing-and-scaling-hosted-modules-in-aws","title":"71. How are hosted modules (like AI/ML) deployed, customized, and scaled as per different frontend/backend requirements in AWS with the help of a DevOps engineer? Deploying, Customizing, and Scaling Hosted Modules in AWS","text":"<p>Deployment: DevOps engineers use tools like AWS CodePipeline to automate the deployment of  hosted AI/ML modules. This involves:</p> <ul> <li>Containerization: Packaging the modules into Docker containers for portability.</li> <li>Infrastructure Provisioning: Using IaC (e.g., CloudFormation) to set up the necessary  AWS resources (EC2 instances, S3 buckets, etc.).</li> <li>Deployment Automation: Using tools like AWS CodeDeploy to deploy the containers to  the provisioned infrastructure.</li> </ul> <p>Customization: Customization often involves:</p> <ul> <li>Configuration Management: Using tools like Ansible or Puppet to configure the modules  based on specific requirements.</li> <li>Environment Variables: Using environment variables to inject different configurations for different environments (development, testing, production).</li> </ul> <p>Scaling: DevOps engineers leverage AWS services like:</p> <ul> <li>Auto Scaling Groups: Automatically adjust the number of instances based on load.</li> <li>Elastic Load Balancing: Distribute traffic across multiple instances for high availability.</li> <li>Serverless Computing: Using services like AWS Lambda to scale AI/ML workloads  dynamically</li> </ul>"},{"location":"2025/1interview2025/#72-can-you-describe-a-technology-you-had-not-heard-of-before-but-managed-to-learn-and-use-on-your-own-learning-a-new-technology","title":"72. Can you describe a technology you had not heard of before but managed to learn and use on your  own?  Learning a New Technology","text":"<p>Example: I recently learned about Apache Kafka, a distributed streaming platform. I was initially  unfamiliar with its concepts but was intrigued by its potential for real-time data processing</p> <p>Learning Process: I started by reading documentation, watching tutorials, and experimenting with Kafka on my own. I also joined online communities and forums to connect with other users and  learn from their experiences.</p> <p>Application: I successfully implemented Kafka in a project to handle high-volume event streams, improving data processing efficiency and real-time insights</p>"},{"location":"2025/1interview2025/#73-what-challenges-have-you-faced-as-a-devops-engineer-devops-engineer-challenges","title":"73. What challenges have you faced as a DevOps engineer? DevOps Engineer Challenges","text":"<ul> <li>Complexity: Managing complex cloud environments with multiple services and dependencies.</li> <li>Automation: Finding the right balance between automation and manual intervention.</li> <li>Security: Ensuring the security of cloud infrastructure and applications.</li> <li>Collaboration: Working effectively with developers, operations teams, and other stakeholders.</li> <li>Continuous Learning: Keeping up with the rapid pace of change in the cloud computing  landscape</li> </ul>"},{"location":"2025/1interview2025/#76-during-data-loss-what-strategy-do-you-use-to-ensure-no-data-loss-especially-in-critical-applications-like-banking","title":"76. During data loss, what strategy do you use to ensure no data loss, especially in critical applications like banking","text":"<p>Data Loss Prevention Strategy</p> <p>Strategy: For critical applications like banking, a multi-layered approach is essential:</p> <ul> <li>Redundancy: Use multiple data centers or cloud regions for replication and failover.</li> <li>Backups: Implement frequent and automated backups to multiple locations.</li> <li>Version Control: Track changes to data and maintain historical versions.</li> <li>Monitoring: Monitor database health and performance to detect potential issues early.</li> <li>Disaster Recovery Plan: Develop a comprehensive disaster recovery plan to restore data and services in case of an outage.</li> </ul>"},{"location":"2025/1interview2025/#77have-you-faced-any-cyberattacks-on-systems-you-built-and-implemented-what-precautions-do-you-take","title":"77.Have you faced any cyberattacks on systems you built and implemented? What precautions do you take?","text":"<p>Cyberattacks and Precautions</p> <p>Experience: I've encountered security incidents like brute-force attacks and attempts to exploit vulnerabilities.</p> <p>Precautions:</p> <ul> <li>Security Best Practices: Implement strong passwords, multi-factor authentication, and  least privilege access.</li> <li>Vulnerability Scanning: Regularly scan systems for vulnerabilities and patch them  promptly.</li> <li>Security Monitoring: Use security information and event management (SIEM) tools to  monitor for suspicious activity.</li> <li>Incident Response Plan: Develop a plan to respond to security incidents effectively.</li> </ul>"},{"location":"2025/1interview2025/#78-what-are-the-networking-setup-rules-you-follow","title":"78. What are the networking setup rules you follow?","text":"<p>Networking Setup Rules</p> <p>Rules:</p> <ul> <li>Security Groups: Use security groups to control inbound and outbound traffic to instances.</li> <li>Network Segmentation: Divide the network into smaller segments to isolate resources and limit the impact of security breaches.</li> <li>Firewall Rules: Implement firewall rules to block unauthorized access.</li> <li>VPN and Tunneling: Use VPNs and tunnels to secure communication between networks.</li> <li>Network Monitoring: Monitor network traffic and performance to identify potential issues.</li> </ul>"},{"location":"2025/1interview2025/#79-what-are-your-daily-responsibilities-as-a-devops-engineer","title":"79. What are your daily responsibilities as a DevOps engineer?","text":"<p>Daily Responsibilities</p> <ul> <li>Monitoring: Monitor system health, performance, and security.</li> <li>Automation: Automate tasks like deployments, infrastructure provisioning, and backups.</li> <li>Troubleshooting: Resolve issues and incidents.</li> <li>Collaboration: Work with developers, operations teams, and other stakeholders.</li> <li>Continuous Improvement: Identify areas for improvement and implement changes to enhance efficiency and reliability.</li> </ul>"},{"location":"2025/1interview2025/#80-which-devops-tools-are-you-proficient-with","title":"80. Which DevOps tools are you proficient with?","text":"<p>DevOps Tools Proficiency</p> <ul> <li>Infrastructure as Code: Terraform, CloudFormation, Ansible, Puppet.</li> <li>Containerization: Docker, Kubernetes.</li> <li>CI/CD: Jenkins, GitLab CI/CD, AWS CodePipeline.</li> <li>Monitoring and Logging: Prometheus, Grafana, ELK Stack.</li> <li>Configuration Management: Ansible, Puppet, Chef.</li> <li>Version Control: Git.</li> </ul>"},{"location":"2025/1interview2025/#81-can-you-describe-the-cicd-workflow-in-your-project","title":"81. Can you describe the CI/CD workflow in your project?","text":"<p>CI/CD Workflow Description</p> <p>Example: In a recent project, our CI/CD workflow involved:</p> <ol> <li>Code Commit: Developers commit code changes to a Git repository.</li> <li>Build and Test: A CI server (e.g., Jenkins, GitLab CI) automatically builds the application, runs unit tests, and performs code quality checks.</li> <li>Artifact Storage: Successful builds are stored as artifacts in a repository (e.g., S3).</li> <li>Deployment: The CD server (e.g., AWS CodeDeploy) deploys the artifact to the target  environment (development, testing, production).</li> <li>Monitoring: Continuous monitoring tools (e.g., Prometheus, Grafana) track application  health and performance.</li> </ol>"},{"location":"2025/1interview2025/#82-how-do-you-handle-the-continuous-delivery-cd-aspect-in-your-projects","title":"82. How do you handle the continuous delivery (CD) aspect in your projects?","text":"<p>Continuous Delivery (CD) Handling</p> <p>Methods:</p> <ul> <li>Automated Deployments: Use tools like AWS CodeDeploy to automate deployments to different environments.</li> <li>Blue-Green Deployments: Deploy new versions of the application alongside the existing version, allowing for seamless switchover.</li> <li>Canary Deployments: Gradually roll out new versions to a small subset of users, monitoring for issues before full deployment.</li> <li>Feature Flags: Use feature flags to enable or disable features in the application without code changes, allowing for controlled releases.</li> </ul>"},{"location":"2025/1interview2025/#83-what-methods-do-you-use-to-check-for-code-vulnerabilities","title":"83. What methods do you use to check for code vulnerabilities?","text":"<p>Code Vulnerability Checks</p> <p>Methods:</p> <ul> <li>Static Code Analysis: Use tools like SonarQube or Snyk to analyze code for vulnerabilities and security issues.</li> <li>Dynamic Code Analysis: Use tools like Burp Suite or ZAP to test the application in  runtime for vulnerabilities.</li> <li>Security Scanning: Use tools like AWS Inspector or Qualys to scan infrastructure and  applications for vulnerabilities.</li> </ul>"},{"location":"2025/1interview2025/#84-what-aws-services-are-you-proficient-in","title":"84. What AWS services are you proficient in?","text":"<p>AWS Service Proficiency</p> <p>Services:</p> <ul> <li>Compute: EC2, Lambda, ECS, EKS.</li> <li>Storage: S3, EBS, EFS.</li> <li>Networking: VPC, Route S3, Load Balancers.</li> <li>Database: RDS, DynamoDB, Redshift.</li> <li>CI/CD: CodePipeline, CodeBuild, CodeDeploy.</li> <li>Security: IAM, Security Groups, KMS</li> <li>Monitoring: CloudWatch,</li> </ul>"},{"location":"2025/1interview2025/#85-how-would-you-access-data-in-an-s3-bucket-from-account-a-when-your-application-is-running-on-an-ec2-instance-in-account-b","title":"85. How would you access data in an S3 bucket from Account A when your application is running on an  EC2 instance in Account B?","text":"<p>Accessing S3 from Account B</p> <p>Method: Use IAM roles and cross-account permissions:</p> <ol> <li>Create Role: In Account A, create an IAM role with permissions to access the S3 bucket.</li> <li>Assume Role: In Account B, configure the EC2 instance to assume the role created in  Account A.</li> <li>Access S3: The EC2 instance can now access the S3 bucket using the assumed role's  credentials.</li> </ol>"},{"location":"2025/1interview2025/#86-how-do-you-provide-access-to-an-s3-bucket-and-what-permissions-need-to-be-set-on-the-bucket-side-s3-bucket-access-and-permissions","title":"86. How do you provide access to an S3 bucket, and what permissions need to be set on the bucket side? S3 Bucket Access and Permissions","text":"<p>Access: You can provide access to an S3 bucket using:</p> <ul> <li>IAM Policies: Attach policies to users, groups, or roles to grant specific permissions.</li> <li>Bucket Policies: Define access control rules directly on the bucket.</li> </ul> <p>Permissions: Common permissions include:</p> <ul> <li>Read: Allows users to read objects from the bucket.</li> <li>Write: Allows users to write objects to the bucket.</li> <li>Delete: Allows users to delete objects from the bucket.</li> <li>List: Allows users to list objects in the bucket.</li> </ul> <p>87.How can Instance 2, with a static IP, communicate with Instance 1, which is in a private subnet and  mapped to a multi-AZ load balancer? Instance Communication with Private Subnet</p> <ul> <li>Method: Use a NAT gateway or a bastion host<ul> <li>NAT Gateway: A managed service that provides internet access for instances in a private subnet.</li> <li>Bastion Host: A secure server in a public subnet that allows access to private instances.</li> </ul> </li> </ul> <p>88.For an EC2 instance in a private subnet, how can it verify and download required packages from the  internet without using a NAT gateway or bastion host? Are there any other AWS services that can  facilitate this?</p> <p>EC2 Instance in Private Subnet Accessing Internet</p> <p>Method: Use a private DNS hostname:</p> <ol> <li>Private DNS: Configure a private DNS zone within your VPC.</li> <li>Private Hostname: Assign a private hostname to the EC2 instance.</li> <li>DNS Resolution: The EC2 instance can resolve the private hostname to access internet  resources.</li> </ol> <p>89.What is the typical latency for a load balancer, and if you encounter high latency, what monitoring steps would you take?</p> <p>Load Balancer Latency and Monitoring</p> <p>Typical Latency: Load balancer latency typically ranges from a few milliseconds to a few hundred  milliseconds, depending on factors like network conditions and load.</p> <p>Monitoring Steps:</p> <ul> <li>CloudWatch Metrics: Monitor load balancer latency using CloudWatch metrics.</li> <li>Network Tracing: Use tools like AWS X-Ray to trace requests through the load balancer  and identify bottlenecks.</li> <li>Performance Testing: Run load tests to simulate real-world traffic and identify  performance issues.</li> </ul> <p>90.If your application is hosted in S3 and users are in different geographic locations, how can you reduce  latency?</p> <p>Reducing Latency for S3 Hosted Application</p> <p>Methods:</p> <ul> <li>Edge Locations: Use AWS CloudFront to cache content at edge locations closer to users,  reducing latency.</li> <li>Regional Buckets: Store data in S3 buckets in the same region as the users, minimizing  network hops.</li> <li>Content Delivery Networks (CDNs): Use a CDN to distribute content across multiple  locations, reducing latency for users worldwide.</li> <li>Which services can be integrated with a CDN (Content Delivery Network)?</li> </ul>"},{"location":"2025/1interview2025/#91-which-services-can-be-integrated-with-a-cdn-content-delivery-network","title":"91. Which services can be integrated with a CDN (Content Delivery Network)?","text":"<p>CDN Integration</p> <p>Services: CDNs can integrate with various services, including:</p> <ul> <li>Web Servers: Apache, Nginx, IIS.</li> <li>Content Management Systems (CMS): WordPress, Drupal, Joomla.</li> <li>Cloud Storage: AWS S3, Google Cloud Storage, Azure Blob Storage.</li> <li>Streaming Services: Netflix, YouTube, Twitch.</li> <li>API Gateways: AWS API Gateway, Google Cloud Endpoints.</li> </ul>"},{"location":"2025/1interview2025/#92how-do-you-dynamically-retrieve-vpc-details-from-aws-to-create-an-ec2-instance-using-iac","title":"92.How do you dynamically retrieve VPC details from AWS to create an EC2 instance using IaC?","text":"<p>Dynamically Retrieving VPC Details</p> <p>Method: Use Terraform's data sources:</p> <ol> <li><code>aws_vpc</code> Data Source: Retrieve details of a specific VPC by its ID or name.</li> <li><code>aws_subnet</code> Data Source: Retrieve details of subnets within a VPC.</li> <li><code>aws_security_group</code> Data Source: Retrieve details of security groups associated with a  VPC.</li> <li><code>aws_instance</code> Data Source: Retrieve details of existing EC2 instances within a VPC</li> </ol>"},{"location":"2025/1interview2025/#93-managing-unmanaged-resources-in-terraform","title":"93. Managing Unmanaged Resources in Terraform","text":"<p>Approach: Use Terraform import command to bring existing unmanaged resources under  Terraform's control. This allows you to manage them alongside your IaC code</p>"},{"location":"2025/1interview2025/#94-passing-arguments-to-vpc-during-import","title":"94. Passing Arguments to VPC During Import","text":"<p>Method: Use the <code>--var</code> flag with the terraform import command to pass arguments:</p> <pre><code>terraform import aws_vpc.example \"vpc-1234567890abcdef0\" --\nvar=\"cidr_block=10.0.0.0/16\"\n</code></pre>"},{"location":"2025/1interview2025/#95-what-is-the-master-slave-architecture-in-jenkins","title":"95. What is the master-slave architecture in Jenkins?","text":"<p>A master-slave architecture in Jenkins allows you to distribute build tasks across multiple nodes (slaves). This provides:</p> <ul> <li>Parallel Execution: Run builds concurrently on multiple nodes, reducing build times.</li> <li>Resource Optimization: Utilize different hardware configurations for different build tasks.</li> <li>Scalability: Scale your Jenkins infrastructure by adding more slave nodes</li> </ul>"},{"location":"2025/1interview2025/#96-how-do-you-integrate-ldap-with-aws-and-jenkins","title":"96. How do you integrate LDAP with AWS and Jenkins?","text":"<p>A: You can integrate LDAP with AWS and Jenkins by:</p> <ol> <li>Configuring LDAP: Set up an LDAP server and configure it to authenticate users.</li> <li>AWS IAM: Create an IAM role with permissions to access the LDAP server.</li> <li>Jenkins Configuration: Configure Jenkins to use the LDAP server for authentication</li> </ol>"},{"location":"2025/1interview2025/#97-what-are-some-key-features-of-github","title":"97. What are some key features of GitHub?","text":"<ul> <li>\u25cf Version Control: Track changes to code over time.</li> <li>\u25cf Collaboration: Facilitate collaboration among developers.</li> <li>\u25cf Pull Requests: Enable code reviews and approvals.</li> <li>\u25cf Issues: Track bugs, feature requests, and other tasks.</li> <li>\u25cf Projects: Organize and manage work items.</li> </ul>"},{"location":"2025/1interview2025/#98-what-are-some-key-features-of-jenkins","title":"98. What are some key features of Jenkins?","text":"<ul> <li>\u25cf Continuous Integration (CI): Automate build, test, and deployment processes.</li> <li>\u25cf Continuous Delivery (CD): Deploy applications to different environments.</li> <li>\u25cf Pipeline as Code: Define pipelines using code (Jenkinsfile).</li> <li>\u25cf Plugins: Extend Jenkins functionality with a wide range of plugins.</li> <li>\u25cf Master-Slave Architecture: Distribute build tasks across multiple nodes.</li> </ul>"},{"location":"2025/1interview2025/#99-what-are-the-benefits-and-uses-of-cicd","title":"99.  What are the benefits and uses of CI/CD?","text":"<ul> <li>Faster Delivery: Reduce the time it takes to deliver new features and updates.</li> <li>Improved Quality: Catch bugs and errors early in the development process.</li> <li>Increased Efficiency: Automate repetitive tasks, freeing up developers to focus on innovation.</li> <li>Reduced Risk: Deploy changes more frequently and with less risk</li> </ul> <p>Uses of CI/CD:</p> <ul> <li>Software Development: Automate build, test, and deployment processes.</li> <li>Infrastructure Management: Provision and configure infrastructure automatically.</li> <li>Data Pipelines: Automate data processing and analysis tasks</li> </ul>"},{"location":"2025/1interview2025/#100-what-is-a-github-workflow-and-how-is-it-used","title":"100. What is a GitHub workflow, and how is it used?","text":"<p>A: A GitHub workflow is a set of automated tasks that are triggered by events in a GitHub repository. You  use workflows to:</p> <ul> <li>Build and Test Code: Automate build and test processes.</li> <li>Deploy Applications: Deploy applications to different environments.</li> <li>Run Code Analysis: Perform code quality checks and security scans</li> </ul>"},{"location":"2025/1interview2025/#101-how-do-you-handle-merge-conflicts-in-git","title":"101 How do you handle merge conflicts in Git?","text":"<ol> <li>Identifying Conflicts: Git will identify conflicts when merging branches.</li> <li>Resolving Conflicts: Manually resolve conflicts by editing the affected files.</li> <li>Staging Changes: Stage the resolved files using git add.</li> <li>Committing Changes: Commit the changes with a descriptive message using git commit</li> </ol>"},{"location":"2025/1interview2025/#102-what-steps-do-you-take-when-a-build-fails-in-jenkins","title":"102. What steps do you take when a build fails in Jenkins?","text":"<p>A: When a build fails in Jenkins, you should:</p> <ol> <li>Analyze Logs: Review the build logs to identify the cause of the failure.</li> <li>Troubleshoot: Investigate the issue and try to resolve it.</li> <li>Fix Code: If the failure is due to a code error, fix the code and rebuild.</li> <li>Update Configuration: If the failure is due to a configuration issue, update the Jenkins  configuration.</li> <li>Rollback: If necessary, roll back to a previous working version of the application</li> </ol>"},{"location":"2025/1interview2025/#103-how-do-you-execute-jobs-in-aws","title":"103 How do you execute jobs in AWS?","text":"<p>A: You can execute jobs in AWS using:</p> <ul> <li>AWS Batch: A fully managed batch computing service for running large-scale, compute-intensive jobs.</li> <li>AWS Lambda: A serverless computing service for running code in response to events.</li> <li>AWS ECS: A container orchestration service for deploying and managing containerized applications.</li> </ul>"},{"location":"2025/1interview2025/#104-what-are-ansible-roles-and-how-do-you-use-them","title":"104. What are Ansible roles, and how do you use them?","text":"<p>A: Ansible roles are a way to organize and reuse Ansible playbooks. </p> <p>They encapsulate tasks, variables, and dependencies related to a specific component or service. You use roles to</p> <ul> <li>Modularize Playbooks: Break down complex playbooks into smaller, reusable units.</li> <li>Simplify Deployment: Deploy multiple components or services with a single role.</li> <li>Improve Maintainability: Make it easier to manage and update Ansible configurations.</li> </ul>"},{"location":"2025/1interview2025/#105-how-do-you-ensure-data-persistence-with-docker-volumes","title":"105  How do you ensure data persistence with Docker volumes?","text":"<p>A: Use Docker volumes to persist data outside the container:</p> <ul> <li>Named Volumes: Create named volumes that can be shared between containers.</li> <li>Data Volumes: Mount data volumes from the host machine into the container.</li> <li>Bind Mounts: Mount directories from the host machine into the container.</li> </ul>"},{"location":"2025/1interview2025/#106-what-are-the-key-differences-between-docker-and-kubernetes","title":"106 What are the key differences between Docker and Kubernetes?","text":"<ul> <li>Scope: Docker focuses on containerization, while Kubernetes focuses on container orchestration.</li> <li>Management: Docker manages individual containers, while Kubernetes manages clusters of containers.</li> <li>Scalability: Kubernetes provides advanced features for scaling and managing large-scale  deployments.</li> <li>Networking: Kubernetes offers more sophisticated networking capabilities for container communication</li> </ul>"},{"location":"2025/1interview2025/#107-how-do-you-securely-store-credentials-in-github","title":"107 How do you securely store credentials in GitHub?","text":"<p>A: You can securely store credentials in GitHub using:</p> <ul> <li>GitHub Secrets: Use GitHub Secrets to store sensitive information securely.</li> <li>Environment Variables: Set environment variables in your GitHub workflow to access credentials.</li> <li>GitHub Actions: Use GitHub Actions to manage credentials and access them within your workflow.</li> </ul>"},{"location":"2025/1interview2025/#108-where-is-the-jenkinsfile-typically-stored","title":"108  Where is the Jenkinsfile typically stored?","text":"<ul> <li>GitHub Secrets: Use GitHub Secrets to store sensitive information securely.</li> <li>Environment Variables: Set environment variables in your GitHub workflow to access credentials.</li> <li>GitHub Actions: Use GitHub Actions to manage credentials and access them within your workflow.</li> </ul>"},{"location":"2025/1interview2025/#109-where-is-the-jenkinsfile-typically-stored","title":"109 Where is the Jenkinsfile typically stored?","text":"<p>A: The Jenkinsfile is typically stored in the root directory of your Git repository</p>"},{"location":"2025/1interview2025/#110-how-do-you-execute-a-shell-script-within-a-python-script","title":"110 How do you execute a shell script within a Python script?","text":"<p>Use the subprocess module:</p> <pre><code>import subprocess\n\nsubprocess.run([\"/path/to/script.sh\"])\n</code></pre>"},{"location":"2025/1interview2025/#111-how-do-you-communicate-with-a-jenkins-server-and-a-kubernetes-cluster","title":"111 How do you communicate with a Jenkins server and a Kubernetes cluster?","text":"<p>A: You can communicate with a Jenkins server and a Kubernetes cluster using:</p> <ul> <li>Jenkins Plugins: Use Jenkins plugins like the Kubernetes plugin to interact with a Kubernetes  cluster.</li> <li>API Calls: Use the Kubernetes API to interact with the cluster programmatically.</li> <li>kubectl: Use kubectl commands from within Jenkins to manage Kubernetes resources</li> </ul>"},{"location":"2025/1interview2025/#112-do-you-only-update-docker-images-in-kubernetes-or-do-you-also-update-replicas-storage-levels-and-cpu-allocation","title":"112 Do you only update Docker images in Kubernetes, or do you also update replicas, storage levels, and CPU allocation?","text":"<p>A: You can update various Kubernetes resources, including:</p> <ul> <li>\u25cf Docker Images: Update the container image used by a deployment.</li> <li>\u25cf Replicas: Scale up or down the number of replicas for a deployment.</li> <li>\u25cf Storage Levels: Adjust storage capacity for persistent volumes.</li> <li>\u25cf CPU Allocation: Modify CPU and memory resource requests and limits for containers.</li> </ul>"},{"location":"2025/1interview2025/#113-can-you-define-environment-variables-inside-your-jenkins-pipeline","title":"113. Can you define environment variables inside your Jenkins pipeline?","text":"<p>A: Yes, you can define environment variables inside your Jenkins pipeline using:</p> <ul> <li>Pipeline Script: Use the environment directive within your Jenkinsfile to define environment variables. </li> <li>Global Variables: Configure global environment variables in Jenkins settings.</li> <li>Credentials: Store sensitive information as credentials and access them within the pipeline</li> </ul>"},{"location":"2025/1interview2025/#114-what-is-the-role-of-artifacts-in-jenkins-and-why-do-we-need-to-push-them-to-nexus-instead-of-building-and-storing-them-locally","title":"114 What is the role of artifacts in Jenkins, and why do we need to push them to Nexus instead of building and storing them locally?","text":"<p>A: Artifacts are the output of a build process, such as compiled code, container images, or test reports.  Pushing artifacts to Nexus (a repository manager) provides:</p> <ul> <li>Version Control: Track different versions of artifacts.</li> <li>Dependency Management: Manage dependencies between projects.</li> <li>Security: Control access to artifacts and ensure their integrity</li> </ul> <p>115. If you\u2019re developing a Python-based application, how do you separate the packages needed for your  local deployment to avoid interfering with globally installed packages</p> <p>A: Use virtual environments:</p> <ol> <li>Create Virtual Environment: Use <code>python -m venv &lt;env_name&gt;</code> to create a virtual environment.</li> <li>Activate Environment: Activate the environment using <code>source &lt;env_name&gt;/bin/activate</code>.</li> <li>Install Packages: Install packages specific to your project using <code>pip install &lt;package_name&gt;</code>.</li> </ol>"},{"location":"2025/1interview2025/#116-what-are-the-prerequisites-before-importing-a-vpc-in-terraform","title":"116 What are the prerequisites before importing a VPC in Terraform?","text":"<p>A: Before importing a VPC, you need:</p> <ul> <li>Terraform Configuration: A Terraform configuration file defining the VPC resource you want to import.</li> <li>Resource ID: The unique identifier (ID) of the VPC in AWS.</li> <li>Resource Type: The correct Terraform resource type (e.g., <code>aws_vpc</code>)</li> </ul>"},{"location":"2025/1interview2025/#117-if-an-s3-bucket-was-created-through-terraform-but-someone-manually-added-a-policy-to-it-how-do-you-handle-this-situation-using-iac","title":"117. If an S3 bucket was created through Terraform but someone manually added a policy to it, how do you handle this situation using IaC?","text":"<p>A: You can use Terraform's terraform plan command to detect differences between the current state of  the S3 bucket and your IaC configuration. This will highlight the manually added policy. You can then:</p> <ul> <li>Update IaC: Modify your Terraform configuration to include the manually added policy, ensuring  consistency.</li> <li>Ignore: If the policy is acceptable, use the ignore_changes option in Terraform to exclude it from  future plans.</li> </ul>"},{"location":"2025/2Ansible/","title":"1 Ansible Interview Question","text":""},{"location":"2025/2Ansible/#1-what-is-ansible-and-how-does-it-work","title":"1. What is Ansible and how does it work?","text":"<p>Ansible is an open-source configuration management, application deployment, and task automation tool. </p> <p>It works by connecting to nodes over SSH (or WinRM for Windows), pushing small programs called 'modules' to these nodes, and executing them. </p> <p>The modules are removed once the task is complete. Ansible uses YAML-based playbooks for automation.</p>"},{"location":"2025/2Ansible/#2-how-can-you-make-ansible-idempotent","title":"2. How can you make Ansible idempotent?","text":"<p>Ansible modules are designed to be idempotent by default, meaning running the same playbook multiple times won't change the system unless there is a change in configuration.</p> <p>To ensure idempotence, avoid using shell or command modules unless absolutely necessary and rely on modules like <code>yum</code>, <code>copy</code>, <code>file</code>, <code>service</code>, etc</p>"},{"location":"2025/2Ansible/#3-scenario-you-need-to-deploy-a-web-application-to-100-servers-but-20-are-not-reachable-how-do-you-handle-this-in-ansible","title":"3. Scenario: You need to deploy a web application to 100 servers, but 20 are not reachable. How do you handle this in Ansible?","text":"<p>Use <code>serial</code> in the playbook to limit the number of servers deployed at a time and handle unreachable hosts gracefully:</p> <pre><code>- hosts: web_servers\n  serial: 10\n  ignore_unreachable: yes\n  tasks:\n  - name: Deploy web app\n    include_role:\n    name: web_app\n</code></pre> <p>You can also use <code>--limit</code> and <code>--start-at-task</code> to resume deployments.</p>"},{"location":"2025/2Ansible/#4-what-are-ansible-roles-and-how-do-they-help-in-playbook-structuring","title":"4. What are Ansible roles and how do they help in playbook structuring?","text":"<ul> <li>Roles are a way to organize playbooks into reusable components. </li> <li>Each role has a specific structure with directories like tasks, handlers, templates, files, vars, and defaults.</li> <li>Roles promote reusability, modularity, and clean separation of concerns in complex environments.</li> </ul>"},{"location":"2025/2Ansible/#5-how-does-ansible-differ-from-other-configuration-management-tools-like-puppet-or-chef","title":"5. How does Ansible differ from other configuration management tools like Puppet or Chef?","text":"<ul> <li>Ansible is agentless and uses YAML for playbook definitions, making it easier to learn and use. </li> <li>Puppet and Chef require agents and use Ruby DSL.</li> <li>Ansible's push-based model over SSH contrasts with Puppet\u2019s pull model</li> </ul>"},{"location":"2025/2Ansible/#6-scenario-how-would-you-implement-dynamic-inventory-in-ansible-for-aws-ec2-instances","title":"6. Scenario: How would you implement dynamic inventory in Ansible for AWS EC2 instances","text":"<p>Use the <code>ec2.py</code> dynamic inventory script or the <code>amazon.aws.aws_ec2</code> inventory plugin. </p> <p>Set up the required AWS credentials and use filters to dynamically target specific instances.</p> <p>Example in <code>ansible.cfg</code></p> <pre><code>[inventory]\nenable_plugins = aws_ec2\n</code></pre> <p>Then configure the plugin in <code>aws_ec2.yaml</code>.</p>"},{"location":"2025/2Ansible/#7-how-do-you-handle-secret-variables-in-ansible","title":"7. How do you handle secret variables in Ansible?","text":"<p>Use <code>ansible-vault</code> to encrypt secrets like passwords, API keys, etc. </p> <p>Create an encrypted file using: <code>ansible-vault create secrets.yml</code></p> <p>Decrypt with <code>--ask-vault-pass</code> or use a vault password file. Secrets can also be encrypted inline using <code>!vault</code></p>"},{"location":"2025/2Ansible/#8-what-are-ansible-facts-and-how-are-they-used-in-playbooks","title":"8. What are Ansible facts and how are they used in playbooks?","text":"<p>Facts are system properties collected by the <code>setup</code> module. </p> <p>They include details like OS, IP, memory, etc., and are accessible via <code>hostvars</code> or directly as variables (e.g.,<code>ansible_os_family</code>).</p> <p>You can disable them using <code>gather_facts: no</code>.</p>"},{"location":"2025/2Ansible/#9-scenario-you-need-to-execute-a-task-only-if-a-specific-file-exists-on-the-target-host-how-do-you-do-it","title":"9. Scenario: You need to execute a task only if a specific file exists on the target host. How do you do it?","text":"<p>Use a conditional with the <code>stat</code> module to check file existence:</p> <pre><code>- name: Check if config file exists\n  stat:\n    path: /etc/myapp/config.ini\n    register: config_file\n\n- name: Run task if file exists\n  command: /usr/local/bin/apply_config\n  when: config_file.stat.exists\n</code></pre>"},{"location":"2025/2Ansible/#10-what-are-callback-plugins-in-ansible","title":"10. What are callback plugins in Ansible?","text":"<p>Callback plugins control how Ansible displays output. </p> <p>Examples include <code>default</code>, <code>json</code>,<code>yaml</code>, and <code>minimal</code>. You can also write custom plugins to log or process events in custom formats.</p>"},{"location":"2025/2Ansible/#11-how-can-you-optimize-playbook-performance","title":"11. How can you optimize playbook performance?","text":"<p>Use strategies like:</p> <ul> <li>Reducing unnecessary fact gathering</li> <li>Using <code>block</code> and <code>when</code> to avoid unneeded tasks</li> <li>Limiting hosts with <code>--limit</code></li> <li>Running tasks in parallel with <code>forks</code></li> <li>Using <code>async</code> for long tasks</li> <li>Leveraging <code>free</code> strategy for non-blocking execution</li> </ul>"},{"location":"2025/2Ansible/#12-scenario-you-want-to-restart-a-service-only-when-its-configuration-file-changes-how-do-you-do-that","title":"12. Scenario: You want to restart a service only when its configuration file changes. How do you do that?","text":"<p>Use handlers triggered by tasks. Example:</p> <pre><code>- name: Copy config file\n  template:\n    src: app.conf.j2\n    dest: /etc/app/app.conf\n  notify: Restart app\n\nhandlers:\n- name: Restart app\n  service:\n    name: app\n    state: restarted\n</code></pre>"},{"location":"2025/2Ansible/#13-what-is-the-difference-between-include-and-import-in-ansible","title":"13. What is the difference between <code>include</code> and <code>import</code> in Ansible?","text":"<p><code>import_tasks</code> and <code>import_playbook</code> are static, evaluated at playbook parse time.</p> <p><code>include_tasks</code> and <code>include_playbook</code> are dynamic, evaluated at runtime. Use <code>include</code> when you need conditionals or loops around task files.</p>"},{"location":"2025/2Ansible/#14-how-do-you-use-jinja2-templates-in-ansible","title":"14. How do you use Jinja2 templates in Ansible?","text":"<p>Templates are used for dynamically generating configuration files. They use <code>.j2</code> extension and allow variables, loops, and conditionals. Example:</p> <p><code>{{ ansible_hostname }} - {{ inventory_hostname }}</code></p>"},{"location":"2025/2Ansible/#15-scenario-you-need-to-run-different-tasks-on-rhel-and-ubuntu-systems-how-would-you-handle-it","title":"15. Scenario: You need to run different tasks on RHEL and Ubuntu systems. How would you handle it?","text":"<p>Use conditionals based on <code>ansible_os_family</code>:</p> <pre><code>- name: Install package\nyum:\nname: httpd\nstate: present\nwhen: ansible_os_family == 'RedHat'\n\n- name: Install package\napt:\nname: apache2\nstate: present\nwhen: ansible_os_family == 'Debian'\n</code></pre>"},{"location":"2025/2Ansible/#16-how-does-ansible-tower-differ-from-ansible-core","title":"16. How does Ansible Tower differ from Ansible Core?","text":"<p>Ansible Tower (now part of Red Hat Automation Platform) is a web UI and REST API interface for Ansible Core. </p> <p>It adds features like RBAC, job scheduling, logging, credentials management, and workflow support</p>"},{"location":"2025/2Ansible/#18-what-is-a-vault-id-and-why-is-it-useful","title":"18. What is a vault ID and why is it useful?","text":"<p>Vault ID allows multiple vault passwords to be used in a single playbook run, useful when encrypting different variables with different keys. </p> <p>Command: <code>--vault-id dev@prompt --vault-id prod@prompt</code></p>"},{"location":"2025/2Ansible/#19-what-is-the-difference-between-delegate_to-and-local_action","title":"19. What is the difference between <code>delegate_to</code> and <code>local_action</code>?","text":"<p><code>delegate_to</code> runs a task on another host (can be remote or localhost), while <code>local_action</code> is shorthand to run on localhost. </p> <p>Use <code>delegate_to</code> when you want remote delegation.</p>"},{"location":"2025/2docker/","title":"2 Docker\u9762\u8bd510\u5927\u5fc5\u8003\u9898","text":""},{"location":"2025/2docker/#1-dockervm","title":"1. \u4ec0\u4e48\u662f Docker\uff1f\u5b83\u4e0e\u865a\u62df\u673a\uff08VM\uff09\u6709\u4f55\u533a\u522b\uff1f","text":"<p>Docker\uff1a \u8f7b\u91cf\u7ea7\u5bb9\u5668\u5316\u5e73\u53f0\uff0c\u57fa\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7ea7\u865a\u62df\u5316\uff0c\u5171\u4eab\u5bbf\u4e3b\u5185\u6838\uff0c\u542f\u52a8\u5feb\u3001\u8d44\u6e90\u5360\u7528\u4f4e\u3002</p> <p>\u533a\u522b\uff1a</p> <ul> <li> <p>\u8d44\u6e90\u5360\u7528\uff1a</p> <ul> <li>Docker \u5bb9\u5668\u5171\u4eab\u5bbf\u4e3b\u673a\u5185\u6838\uff0c</li> <li>VM \u9700\u8981\u72ec\u7acb\u5185\u6838\u548c\u5b8c\u6574\u64cd\u4f5c\u7cfb\u7edf\u3002</li> </ul> </li> <li> <p>\u542f\u52a8\u901f\u5ea6\uff1a</p> <ul> <li>\u5bb9\u5668\u79d2\u7ea7\u542f\u52a8\uff0c</li> <li>VM \u5206\u949f\u7ea7\u542f\u52a8\u3002</li> </ul> </li> <li>\u9694\u79bb\u6027<ul> <li>VM \u63d0\u4f9b\u66f4\u5f3a\u7684\u9694\u79bb\u6027\uff0c</li> <li>\u5bb9\u5668\u901a\u8fc7\u547d\u540d\u7a7a\u95f4\u548c Cgroups \u5b9e\u73b0\u8f7b\u91cf\u9694\u79bb\u3002</li> </ul> </li> </ul>"},{"location":"2025/2docker/#2-docker","title":"2. \u89e3\u91ca Docker \u955c\u50cf\u3001\u5bb9\u5668\u548c\u4ed3\u5e93\u7684\u4f5c\u7528\u3002","text":"<ul> <li>\u955c\u50cf\uff08Image\uff09\uff1a \u53ea\u8bfb\u6a21\u677f\uff0c\u5305\u542b\u8fd0\u884c\u5e94\u7528\u6240\u9700\u7684\u4ee3\u7801\u3001\u5e93\u548c\u73af\u5883\u3002</li> <li>\u5bb9\u5668\uff08Container\uff09\uff1a \u955c\u50cf\u7684\u8fd0\u884c\u5b9e\u4f8b\uff0c\u5177\u6709\u53ef\u5199\u5c42\uff0c\u751f\u547d\u5468\u671f\u72ec\u7acb\u3002</li> <li>\u4ed3\u5e93\uff08Registry\uff09\uff1a \u5b58\u50a8\u548c\u5206\u53d1\u955c\u50cf\u7684\u5e73\u53f0\uff08\u5982 Docker Hub\u3001\u79c1\u6709\u4ed3\u5e93\uff09</li> </ul>"},{"location":"2025/2docker/#3-docker","title":"3. \u5982\u4f55\u4ece Docker \u955c\u50cf\u542f\u52a8\u4e00\u4e2a\u5bb9\u5668\uff1f","text":"<pre><code>docker run -d --name my_container -p 8080:80 nginx:alpine\n</code></pre> <ul> <li><code>-d</code>\uff1a \u540e\u53f0\u8fd0\u884c</li> <li><code>--name</code>\uff1a \u6307\u5b9a\u5bb9\u5668\u540d\u79f0</li> <li><code>-p</code>\uff1a \u7aef\u53e3\u6620\u5c04\uff08\u5bbf\u4e3b\u673a\u7aef\u53e3:\u5bb9\u5668\u7aef\u53e3\uff09</li> </ul>"},{"location":"2025/2docker/#4-docker-multi-stage-builds","title":"4. \u4ec0\u4e48\u662f Docker \u7684\u591a\u9636\u6bb5\u6784\u5efa\uff08Multi-stage Builds\uff09\uff1f","text":"<p>\u591a\u9636\u6bb5\u6784\u5efa\u662f Dockerfile \u7684\u4e00\u79cd\u4f18\u5316\u6280\u5de7\uff0c\u53ef\u4ee5\u51cf\u5c11\u955c\u50cf\u7684\u5927\u5c0f\u3002</p> <p>\u5728\u591a\u9636\u6bb5\u6784\u5efa\u4e2d\uff0c\u591a\u4e2a FROM \u8bed\u53e5\u7528\u4e8e\u5728\u4e0d\u540c\u9636\u6bb5\u6784\u5efa\u955c\u50cf\u3002</p> <p>\u4f60\u53ef\u4ee5\u5728\u524d\u4e00\u4e2a\u9636\u6bb5\u4e2d\u6267\u884c\u590d\u6742\u7684\u6784\u5efa\u548c\u5b89\u88c5\u64cd\u4f5c\uff0c\u800c\u5728\u540e\u4e00\u4e2a\u9636\u6bb5\u4e2d\u53ea\u590d\u5236\u6240\u9700\u7684\u6587\u4ef6\u5230\u6700\u7ec8\u7684\u955c\u50cf\u4e2d\u3002</p> <pre><code>\u7b2c\u4e00\u9636\u6bb5\uff1a\u6784\u5efa\u5e94\u7528\nFROM golang:1.16 AS builder\nWORKDIR /app\nCOPY . .\nRUN go build -o myapp\n\u7b2c\u4e8c\u9636\u6bb5\uff1a\u8fd0\u884c\u5e94\u7528\nFROM alpine:latest\nWORKDIR /root/\nCOPY --from=builder /app/myapp .\nCMD [\"./myapp\"]\n</code></pre> <p>\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u7b2c\u4e00\u9636\u6bb5\u4f7f\u7528\u4e86 golang \u955c\u50cf\u6765\u7f16\u8bd1 Go \u5e94\u7528\uff0c\u7b2c\u4e8c\u9636\u6bb5\u53ea\u5305\u542b\u4e00\u4e2a\u66f4\u5c0f\u7684 alpine \u955c\u50cf\uff0c\u5e76\u4ece\u7b2c\u4e00\u9636\u6bb5\u590d\u5236\u7f16\u8bd1\u540e\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002</p>"},{"location":"2025/2docker/#5","title":"5. \u5982\u4f55\u67e5\u770b\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u65e5\u5fd7\uff1f","text":"<pre><code>docker logs -f my_container  # \u5b9e\u65f6\u67e5\u770b\u65e5\u5fd7\n\ndocker logs --tail 100 my_container  # \u67e5\u770b\u6700\u540e 100 \u884c\u65e5\u5fd7\n</code></pre>"},{"location":"2025/2docker/#6-docker","title":"6 Docker \u6570\u636e\u6301\u4e45\u5316\u7684\u65b9\u5f0f\u6709\u54ea\u4e9b\uff1f","text":"<p>Bind Mount\uff1a \u5c06\u5bbf\u4e3b\u673a\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u3002</p> <pre><code>docker run -v /host/path:/container/path nginx\n</code></pre> <p>Volume\uff1a \u7531 Docker \u7ba1\u7406\u7684\u6301\u4e45\u5316\u5b58\u50a8\u5377\u3002</p> <pre><code>docker volume create my_vol\ndocker run -v my_vol:/container/path nginx\n</code></pre> <p>tmpfs Mount\uff1a \u4ec5\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff08\u4e34\u65f6\u6570\u636e\uff09</p>"},{"location":"2025/2docker/#7","title":"7 \u5982\u4f55\u914d\u7f6e\u5bb9\u5668\u95f4\u7684\u7f51\u7edc\u901a\u4fe1\uff1f","text":"<p>\u9ed8\u8ba4\u7f51\u7edc\uff1a \u5bb9\u5668\u901a\u8fc7 docker network \u521b\u5efa\u7684\u9ed8\u8ba4\u6865\u63a5\u7f51\u7edc\u901a\u4fe1\u3002</p> <p>\u81ea\u5b9a\u4e49\u7f51\u7edc\uff1a</p> <pre><code>docker network create my_net\ndocker run --network my_net --name app1 my_image\ndocker run --network my_net --name app2 my_image\n</code></pre> <p>\u76f4\u63a5\u901a\u8fc7\u5bb9\u5668\u540d\u901a\u4fe1\uff1a \u5728\u81ea\u5b9a\u4e49\u7f51\u7edc\u4e2d\uff0c\u5bb9\u5668\u53ef\u901a\u8fc7\u540d\u79f0\u4e92\u76f8\u8bbf\u95ee\uff08\u5982 ping app1\uff09\u3002</p>"},{"location":"2025/2docker/#8-cpu","title":"8 \u5982\u4f55\u9650\u5236\u5bb9\u5668\u7684 CPU \u548c\u5185\u5b58\u4f7f\u7528\uff1f","text":"<pre><code>docker run --cpus=2 --memory=512m my_image  # \u9650\u5236 2 \u6838 CPU \u548c 512MB \u5185\u5b58\n</code></pre>"},{"location":"2025/2docker/#9","title":"9 \u5982\u4f55\u8c03\u8bd5\u5bb9\u5668\u542f\u52a8\u5931\u8d25\u7684\u95ee\u9898\uff1f","text":"<p>\u67e5\u770b\u5bb9\u5668\u65e5\u5fd7\uff1a<code>docker logs &lt;container_id&gt;</code></p> <p>\u4ee5\u4ea4\u4e92\u6a21\u5f0f\u542f\u52a8\u5bb9\u5668\uff1a</p> <pre><code>docker run -it --entrypoint /bin/sh my_image  # \u624b\u52a8\u6267\u884c\u547d\u4ee4\u6392\u67e5\n</code></pre> <p>\u68c0\u67e5\u5bb9\u5668\u72b6\u6001\uff1a<code>docker inspect &lt;container_id&gt;</code></p>"},{"location":"2025/2docker/#10-docker-compose-docker-composeyml","title":"10 Docker Compose \u7684\u4f5c\u7528\u662f\u4ec0\u4e48\uff1f\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684 <code>docker-compose.yml</code>","text":"<p>\u4f5c\u7528\uff1a \u5b9a\u4e49\u548c\u8fd0\u884c\u591a\u5bb9\u5668\u5e94\u7528\uff0c\u7b80\u5316\u5bb9\u5668\u7f16\u6392\u3002</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>version: '3'\nservices:\n  web:\n    image: nginx:alpine\n    ports:\n      - \"8080:80\"\n  db:\n    image: mysql:5.7\n    environment:\n      MYSQL_ROOT_PASSWORD: secret\n</code></pre>"},{"location":"2025/2docker/#11-root","title":"11. \u5982\u4f55\u4ee5\u975e root \u7528\u6237\u8fd0\u884c\u5bb9\u5668\uff1f","text":"<p>\u5728 Dockerfile \u4e2d\u6307\u5b9a\u7528\u6237\uff1a</p> <pre><code>FROM alpine\nRUN adduser -D myuser\nUSER myuser\nCMD [\"sleep\", \"infinity\"]\n</code></pre> <p><code>RUN adduser -D myuser</code></p>"},{"location":"2025/2docker/#12-docker","title":"12 \u5982\u4f55\u907f\u514d Docker \u955c\u50cf\u4e2d\u7684\u654f\u611f\u4fe1\u606f\u6cc4\u9732\uff1f","text":"<ul> <li>\u4f7f\u7528 <code>.dockerignore</code> \u6587\u4ef6\u6392\u9664\u654f\u611f\u6587\u4ef6\uff08\u5982\u5bc6\u94a5\u3001\u914d\u7f6e\u6587\u4ef6\uff09\u3002</li> <li>\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u4f20\u9012\u654f\u611f\u4fe1\u606f\uff08\u5982 <code>-e MYSQL_PASSWORD=xxx</code>\uff09\u3002</li> <li>\u4f7f\u7528 <code>Docker Secrets</code> \u6216 <code>Kubernetes Secrets</code> \u7ba1\u7406\u654f\u611f\u6570\u636e\u3002</li> </ul>"},{"location":"2025/2docker/#13-docker-cgroups-namespace","title":"13 \u89e3\u91ca Docker \u7684 Cgroups \u548c Namespace \u7684\u4f5c\u7528\u3002","text":"<ul> <li>Cgroups\uff1a \u9650\u5236\u5bb9\u5668\u8d44\u6e90\u4f7f\u7528\uff08CPU\u3001\u5185\u5b58\u3001\u78c1\u76d8 I/O\uff09\u3002</li> <li>Namespace\uff1a \u5b9e\u73b0\u8fdb\u7a0b\u3001\u7f51\u7edc\u3001\u6587\u4ef6\u7cfb\u7edf\u7b49\u8d44\u6e90\u7684\u9694\u79bb\uff08PID\u3001Network\u3001Mount \u7b49\uff09\u3002</li> </ul>"},{"location":"2025/2docker/#14-docker-swarm-kubernetes","title":"14 Docker Swarm \u548c Kubernetes \u6709\u4ec0\u4e48\u533a\u522b\uff1f","text":"<ul> <li>Docker Swarm \u662f Docker \u5b98\u65b9\u63d0\u4f9b\u7684\u539f\u751f\u5bb9\u5668\u7f16\u6392\u5de5\u5177\uff0c\u652f\u6301\u5bb9\u5668\u7684\u90e8\u7f72\u3001\u6269\u5c55\u548c\u8d1f\u8f7d\u5747\u8861\u3002\u5b83\u7684\u4f18\u70b9\u662f\u8bbe\u7f6e\u548c\u4f7f\u7528\u7b80\u5355\uff0c\u9002\u5408\u5c0f\u578b\u6216\u4e2d\u578b\u5e94\u7528\uff0c\u4f46\u7f3a\u4e4f\u4e00\u4e9b\u9ad8\u7ea7\u529f\u80fd\uff0c\u5982\u81ea\u52a8\u5316\u5bb9\u5668\u5065\u5eb7\u68c0\u67e5\u7b49\u3002</li> <li>Kubernetes \u662f\u4e00\u4e2a\u66f4\u4e3a\u590d\u6742\u4e14\u529f\u80fd\u5f3a\u5927\u7684\u5bb9\u5668\u7f16\u6392\u5e73\u53f0\uff0c\u5e7f\u6cdb\u7528\u4e8e\u5927\u89c4\u6a21\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u7ba1\u7406\u3002\u5b83\u652f\u6301\u81ea\u52a8\u5316\u90e8\u7f72\u3001\u6269\u5c55\u3001\u7ba1\u7406\u548c\u670d\u52a1\u53d1\u73b0\u3002Kubernetes \u63d0\u4f9b\u66f4\u5f3a\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u81ea\u52a8\u6269\u7f29\u5bb9\u3001\u81ea\u52a8\u8d1f\u8f7d\u5747\u8861\u3001\u5bb9\u5668\u5065\u5eb7\u68c0\u67e5\u3001\u6545\u969c\u6062\u590d\u7b49\u3002</li> </ul>"},{"location":"2025/2docker/#15-docker","title":"15 \u5982\u4f55\u4f18\u5316 Docker \u955c\u50cf\u7684\u5927\u5c0f\uff1f","text":"<ul> <li>\u4f7f\u7528\u5c0f\u7684\u57fa\u7840\u955c\u50cf\uff1a \u5982\u4f7f\u7528 alpine \u955c\u50cf\u4ee3\u66ff ubuntu \u6216 debian\uff0c\u56e0\u4e3a alpine \u955c\u50cf\u975e\u5e38\u5c0f\u3002</li> <li>\u51cf\u5c11\u5c42\u6570\uff1a \u6bcf\u4e2a RUN \u547d\u4ee4\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u955c\u50cf\u5c42\uff0c\u56e0\u6b64\u5e94\u5408\u5e76\u547d\u4ee4\u4ee5\u51cf\u5c11\u955c\u50cf\u5c42\u6570\uff0c\u4f8b\u5982\u5c06\u591a\u4e2a RUN \u547d\u4ee4\u5408\u5e76\u4e3a\u4e00\u4e2a\u3002</li> <li>\u6e05\u7406\u7f13\u5b58\uff1a \u5728 Dockerfile \u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>RUN apt-get clean</code> \u6216 <code>rm -rf /var/lib/apt/lists/*</code> \u7b49\u547d\u4ee4\u6765\u6e05\u7406\u4e34\u65f6\u6587\u4ef6\u548c\u7f13\u5b58\uff0c\u907f\u514d\u5c06\u5176\u5305\u542b\u5728\u955c\u50cf\u4e2d\u3002</li> <li>\u590d\u5236\u6240\u9700\u6587\u4ef6\uff1a \u4ec5\u5c06\u5fc5\u8981\u7684\u6587\u4ef6\u590d\u5236\u5230\u955c\u50cf\u4e2d\uff0c\u907f\u514d\u5c06\u4e0d\u9700\u8981\u7684\u6587\u4ef6\uff08\u5982\u5f00\u53d1\u5de5\u5177\u3001\u6587\u6863\u7b49\uff09\u590d\u5236\u5230\u955c\u50cf\u4e2d\u3002</li> <li>\u591a\u9636\u6bb5\u6784\u5efa\uff1a \u4f7f\u7528\u591a\u9636\u6bb5\u6784\u5efa\uff0c\u5c06\u7f16\u8bd1\u3001\u6784\u5efa\u7b49\u8fc7\u7a0b\u653e\u5728\u4e34\u65f6\u955c\u50cf\u4e2d\uff0c\u6700\u7ec8\u7684\u751f\u4ea7\u955c\u50cf\u53ea\u5305\u542b\u8fd0\u884c\u6240\u9700\u7684\u6587\u4ef6</li> </ul>"},{"location":"2025/2docker/#16-docker","title":"16  \u5982\u4f55\u5904\u7406 Docker \u4e2d\u7684\u5b89\u5168\u6027\u95ee\u9898\uff1f","text":"<ul> <li>\u9650\u5236\u5bb9\u5668\u7684\u6743\u9650\uff1a \u907f\u514d\u5bb9\u5668\u8fd0\u884c\u5728 root \u7528\u6237\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528 USER \u6307\u4ee4\u6307\u5b9a\u975e\u7279\u6743\u7528\u6237\u3002</li> <li>\u4f7f\u7528 Docker \u5ba1\u8ba1\u65e5\u5fd7\uff1a \u542f\u7528 Docker \u5ba1\u8ba1\u65e5\u5fd7\u6765\u76d1\u63a7\u5bb9\u5668\u548c\u955c\u50cf\u7684\u6d3b\u52a8</li> <li>\u955c\u50cf\u5b89\u5168\uff1a \u4ece\u53ef\u4fe1\u7684\u955c\u50cf\u6e90\u62c9\u53d6\u955c\u50cf\uff0c\u907f\u514d\u4f7f\u7528\u4e0d\u660e\u6765\u6e90\u7684\u955c\u50cf\uff0c\u5b9a\u671f\u626b\u63cf\u955c\u50cf\u662f\u5426\u5305\u542b\u5df2\u77e5\u7684\u5b89\u5168\u6f0f\u6d1e\u3002</li> <li>\u7f51\u7edc\u9694\u79bb\uff1a \u901a\u8fc7\u521b\u5efa\u7528\u6237\u81ea\u5b9a\u4e49\u7f51\u7edc\u548c\u9694\u79bb\u7f51\u7edc\u6765\u9650\u5236\u5bb9\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u3002</li> <li>\u9650\u5236\u5bb9\u5668\u8d44\u6e90\uff1a \u4e3a\u5bb9\u5668\u8bbe\u7f6e\u8d44\u6e90\u9650\u5236\uff08\u5982 CPU\u3001\u5185\u5b58\u7b49\uff09\uff0c\u907f\u514d\u8d44\u6e90\u8fc7\u5ea6\u5360\u7528\uff0c\u5f71\u54cd\u5176\u4ed6\u5bb9\u5668\u6216\u5bbf\u4e3b\u673a\u3002</li> <li>\u4f7f\u7528 seccomp \u548c AppArmor\uff1a Docker \u652f\u6301 seccomp \u548c AppArmor \u5b89\u5168\u6a21\u5757\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u9650\u5236\u5bb9\u5668\u7684\u7cfb\u7edf\u8c03\u7528\uff0c\u589e\u52a0\u5bb9\u5668\u7684\u5b89\u5168\u6027\u3002</li> </ul>"},{"location":"2025/2docker/#17-docker","title":"17. \u5982\u4f55\u5728 Docker \u4e2d\u914d\u7f6e\u5bb9\u5668\u95f4\u7684\u901a\u4fe1\uff1f","text":"<ul> <li>\u4f7f\u7528 Docker \u7f51\u7edc\uff1a \u5bb9\u5668\u9ed8\u8ba4\u4f1a\u8fde\u63a5\u5230\u4e00\u4e2a\u540d\u4e3a bridge \u7684\u7f51\u7edc\uff0c\u4f46\u4f60\u4e5f\u53ef\u4ee5\u521b\u5efa\u81ea\u5b9a\u4e49\u7f51\u7edc\uff0c\u901a\u8fc7\u521b\u5efa\u7528\u6237\u81ea\u5b9a\u4e49\u7684 bridge \u7f51\u7edc\u6216 overlay \u7f51\u7edc\uff08\u9002\u7528\u4e8e Docker Swarm \u73af\u5883\uff09\u6765\u8ba9\u5bb9\u5668\u8fdb\u884c\u66f4\u7075\u6d3b\u7684\u901a\u4fe1\u3002</li> <li>\u7aef\u53e3\u6620\u5c04\uff1a \u53ef\u4ee5\u901a\u8fc7 <code>docker run -p &lt;host_port&gt;:&lt;container_port&gt;</code>\u547d\u4ee4\u5c06\u5bb9\u5668\u5185\u90e8\u7684\u7aef\u53e3\u6620\u5c04\u5230\u5bbf\u4e3b\u673a\u7684\u7aef\u53e3\uff0c\u4ee5\u4fbf\u5916\u90e8\u53ef\u4ee5\u8bbf\u95ee\u5bb9\u5668\u5185\u7684\u670d\u52a1\u3002</li> <li>\u5bb9\u5668\u95f4\u901a\u4fe1\uff1a \u5728\u540c\u4e00\u7f51\u7edc\u4e2d\u7684\u5bb9\u5668\u53ef\u4ee5\u901a\u8fc7\u5bb9\u5668\u540d\u79f0\u6765\u76f8\u4e92\u901a\u4fe1\u3002\u5bb9\u5668\u7684 DNS \u4f1a\u81ea\u52a8\u89e3\u6790\u5176\u4ed6\u5bb9\u5668\u7684\u540d\u79f0\u3002</li> </ul>"},{"location":"2025/2docker/#18-docker","title":"18 \u5982\u4f55\u5728 Docker \u4e2d\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff1f","text":"<p>\u5728 Dockerfile \u4e2d\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff1a \u4f7f\u7528 ENV \u6307\u4ee4\u6765\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3002\u4f8b\u5982\uff1a</p> <pre><code>ENV ENV_VAR_NAME value\n</code></pre> <p>\u5728\u8fd0\u884c\u5bb9\u5668\u65f6\u4f20\u9012\u73af\u5883\u53d8\u91cf\uff1a \u4f7f\u7528 <code>-e</code> \u6216 <code>--env</code> \u53c2\u6570\u4f20\u9012\u73af\u5883\u53d8\u91cf\u3002\u4f8b\u5982\uff1a</p> <pre><code>docker run -e ENV_VAR_NAME=value my_image\n</code></pre> <p>\u5728 Docker Compose \u6587\u4ef6\u4e2d\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff1a \u4f7f\u7528 environment \u914d\u7f6e\u9879\u6765\u4e3a\u670d\u52a1\u6307\u5b9a\u73af\u5883\u53d8\u91cf\u3002\u4f8b\u5982\uff1a</p> <pre><code>version: '3'\nservices:\n  web:\n    image: my_image\n    environment:\n      - ENV_VAR_NAME=value\n</code></pre>"},{"location":"2025/2docker/#19-docker","title":"19 \u5982\u4f55\u76d1\u63a7 Docker \u5bb9\u5668\u7684\u6027\u80fd\uff1f","text":"<ul> <li>Docker Stats\uff1a \u4f7f\u7528 docker stats \u547d\u4ee4\u67e5\u770b\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u7684\u5b9e\u65f6\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff0c\u5305\u62ec CPU \u4f7f\u7528\u7387\u3001\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\u3001\u7f51\u7edc I/O \u548c\u78c1\u76d8 I/O \u7b49\u3002</li> <li>Prometheus \u548c Grafana\uff1a \u4f7f\u7528 Prometheus \u6536\u96c6 Docker \u5bb9\u5668\u7684\u6307\u6807\u6570\u636e\uff0c\u5e76\u901a\u8fc7 Grafana \u53ef\u89c6\u5316\u5c55\u793a\u3002</li> <li>cAdvisor\uff1a Google \u63d0\u4f9b\u7684 cAdvisor\uff08Container Advisor\uff09\u53ef\u4ee5\u76d1\u63a7 Docker \u5bb9\u5668\u7684\u6027\u80fd\uff0c\u63d0\u4f9b CPU\u3001\u5185\u5b58\u3001\u7f51\u7edc\u7b49\u65b9\u9762\u7684\u6307\u6807\u3002</li> <li>Docker API\uff1a \u901a\u8fc7 Docker API \u83b7\u53d6\u5bb9\u5668\u7684\u6027\u80fd\u6570\u636e\uff0c\u53ef\u4ee5\u96c6\u6210\u5230\u81ea\u5b9a\u4e49\u7684\u76d1\u63a7\u7cfb\u7edf\u4e2d\u3002</li> </ul>"},{"location":"2025/2docker/#20-docker-ha","title":"20. \u5982\u4f55\u5728 Docker \u4e2d\u5b9e\u73b0\u9ad8\u53ef\u7528\u6027\uff08HA\uff09\uff1f","text":"<p>\u5b9e\u73b0 Docker \u7684\u9ad8\u53ef\u7528\u6027\uff08HA\uff09\u901a\u5e38\u6d89\u53ca\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>Docker Swarm / Kubernetes\uff1a \u4f7f\u7528 Docker Swarm \u6216 Kubernetes \u6765\u7ba1\u7406\u5bb9\u5668\u7684\u96c6\u7fa4\uff0c\u8fd9\u4e24\u4e2a\u5de5\u5177\u90fd\u652f\u6301\u9ad8\u53ef\u7528\u6027\u3002\u5b83\u4eec\u53ef\u4ee5\u5728\u5bb9\u5668\u6216\u8282\u70b9\u5931\u8d25\u65f6\u81ea\u52a8\u8c03\u5ea6\u548c\u91cd\u542f\u5bb9\u5668\uff0c\u786e\u4fdd\u5e94\u7528\u7684\u53ef\u7528\u6027\u3002</li> <li>\u670d\u52a1\u526f\u672c\uff1a \u901a\u8fc7\u5728 Docker Swarm \u6216 Kubernetes \u4e2d\u914d\u7f6e\u591a\u4e2a\u526f\u672c\uff0c\u786e\u4fdd\u670d\u52a1\u7684\u9ad8\u53ef\u7528\u6027\u3002\u82e5\u67d0\u4e2a\u5bb9\u5668\u6216\u8282\u70b9\u53d1\u751f\u6545\u969c\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u91cd\u65b0\u8c03\u5ea6\u6216\u91cd\u542f\u526f\u672c\u5bb9\u5668\u3002</li> <li>\u8d1f\u8f7d\u5747\u8861\uff1a \u914d\u7f6e\u8d1f\u8f7d\u5747\u8861\u5668\uff08\u5982 HAProxy\u3001Traefik\u3001Nginx\uff09\u6765\u5c06\u6d41\u91cf\u5206\u53d1\u5230\u4e0d\u540c\u7684\u5bb9\u5668\u5b9e\u4f8b\uff0c\u786e\u4fdd\u8bf7\u6c42\u7684\u5206\u914d\u5747\u5300\uff0c\u4ece\u800c\u63d0\u9ad8\u53ef\u7528\u6027\u3002</li> <li>\u5b58\u50a8\u548c\u6570\u636e\u6301\u4e45\u5316\uff1a \u4f7f\u7528\u5206\u5e03\u5f0f\u5b58\u50a8\u7cfb\u7edf\uff08\u5982 Ceph \u6216 GlusterFS\uff09\u6765\u4fdd\u8bc1\u5bb9\u5668\u4e2d\u7684\u6570\u636e\u4e0d\u4e22\u5931\uff0c\u5373\u4f7f\u5bb9\u5668\u8fc1\u79fb\u6216\u91cd\u542f\u3002</li> <li>\u5065\u5eb7\u68c0\u67e5\uff1a \u914d\u7f6e\u5bb9\u5668\u5065\u5eb7\u68c0\u67e5\uff08HEALTHCHECK\uff09\u6307\u4ee4\uff0c\u786e\u4fdd\u5bb9\u5668\u5065\u5eb7\uff0c\u5931\u8d25\u65f6\u81ea\u52a8\u91cd\u542f\u5bb9\u5668\u3002</li> </ul>"},{"location":"2025/2docker/#21-docker","title":"21. \u5982\u4f55\u5904\u7406 Docker \u7684\u5bb9\u5668\u95f4\u670d\u52a1\u53d1\u73b0\uff1f","text":"<p>\u5bb9\u5668\u95f4\u670d\u52a1\u53d1\u73b0\u662f\u786e\u4fdd\u5bb9\u5668\u5728\u4e0d\u540c\u73af\u5883\u4e2d\u80fd\u591f\u4e92\u76f8\u901a\u4fe1\u7684\u5173\u952e\u3002Docker \u63d0\u4f9b\u4e86\u51e0\u79cd\u65b9\u5f0f\u6765\u5b9e\u73b0\u670d\u52a1\u53d1\u73b0\uff1a</p> <ul> <li>Docker \u9ed8\u8ba4\u7684 DNS \u89e3\u6790\uff1a \u5728 Docker \u4e2d\uff0c\u5bb9\u5668\u901a\u8fc7\u540d\u79f0\u8fdb\u884c\u901a\u4fe1\u3002\u5f53\u5bb9\u5668\u8fde\u63a5\u5230\u540c\u4e00\u7f51\u7edc\u65f6\uff0cDocker \u4f1a\u81ea\u52a8\u4e3a\u6bcf\u4e2a\u5bb9\u5668\u5206\u914d\u4e00\u4e2a DNS \u540d\u79f0\uff0c\u5bb9\u5668\u53ef\u4ee5\u901a\u8fc7\u8be5\u540d\u79f0\u8bbf\u95ee\u5176\u4ed6\u5bb9\u5668\u3002\u4f8b\u5982\uff0c\u5bb9\u5668 web \u53ef\u4ee5\u901a\u8fc7 http://db:3306 \u8bbf\u95ee\u5bb9\u5668 db\uff0c\u524d\u63d0\u662f\u5b83\u4eec\u5728\u540c\u4e00\u4e2a\u7f51\u7edc\u4e2d\u3002</li> <li>Docker Compose\uff1a \u5728\u4f7f\u7528 Docker Compose \u65f6\uff0c\u6bcf\u4e2a\u670d\u52a1\u4f1a\u81ea\u52a8\u6210\u4e3a\u7f51\u7edc\u7684\u4e00\u90e8\u5206\uff0c\u5e76\u4e14 Compose \u4f1a\u81ea\u52a8\u914d\u7f6e\u670d\u52a1\u540d\u79f0\u7684 DNS \u89e3\u6790\u3002\u670d\u52a1\u53ef\u4ee5\u901a\u8fc7\u5176\u540d\u79f0\u4e92\u76f8\u53d1\u73b0\uff0c\u4f8b\u5982 web \u670d\u52a1\u53ef\u4ee5\u901a\u8fc7 db \u670d\u52a1\u540d\u8bbf\u95ee\u6570\u636e\u5e93\u3002</li> <li>Consul \u6216 Etcd\uff1a \u5bf9\u4e8e\u66f4\u590d\u6742\u7684\u5e94\u7528\uff0c\u4f7f\u7528\u5de5\u5177\u5982 Consul \u6216 Etcd \u6765\u8fdb\u884c\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0\u3002\u8fd9\u4e9b\u5de5\u5177\u53ef\u4ee5\u4e3a\u5bb9\u5668\u63d0\u4f9b\u52a8\u6001\u7684\u670d\u52a1\u53d1\u73b0\u673a\u5236\u3002</li> <li>Kubernetes DNS\uff1a Kubernetes \u63d0\u4f9b\u4e86\u81ea\u52a8\u7684\u670d\u52a1\u53d1\u73b0\u673a\u5236\uff0cPods \u4e4b\u95f4\u53ef\u4ee5\u901a\u8fc7\u670d\u52a1\u540d\u79f0\uff08\u5982 my-service.default.svc.cluster.local\uff09\u8fdb\u884c\u901a\u4fe1\u3002</li> </ul>"},{"location":"2025/2docker/#22-docker","title":"22. Docker \u5bb9\u5668\u7684\u8d44\u6e90\u9650\u5236\u5982\u4f55\u5de5\u4f5c\uff1f","text":"<p>Docker \u63d0\u4f9b\u4e86\u591a\u79cd\u65b9\u5f0f\u6765\u9650\u5236\u5bb9\u5668\u7684\u8d44\u6e90\u4f7f\u7528\uff0c\u4ee5\u786e\u4fdd\u5bb9\u5668\u4e0d\u4f1a\u6d88\u8017\u8fc7\u591a\u7684\u7cfb\u7edf\u8d44\u6e90\u3002\u5e38\u89c1\u7684\u8d44\u6e90\u9650\u5236\u5305\u62ec</p> <p>CPU \u9650\u5236</p> <ul> <li>--cpus : \u9650\u5236\u5bb9\u5668\u7684 CPU \u4f7f\u7528\u91cf\u3002\u4f8b\u5982\uff0c<code>--cpus=\"1.5\"</code> \u9650\u5236\u5bb9\u5668\u4f7f\u7528\u6700\u591a 1.5 \u4e2a CPU \u6838\u5fc3</li> <li>--cpu-shares\uff1a \u4e3a\u5bb9\u5668\u6307\u5b9a CPU \u6743\u91cd\uff0c\u9ed8\u8ba4\u503c\u662f 1024\u3002\u9ad8\u6743\u91cd\u7684\u5bb9\u5668\u5c06\u83b7\u5f97\u66f4\u591a\u7684 CPU \u65f6\u95f4</li> <li><code>--cpuset-cpus</code>:  \u9650\u5236\u5bb9\u5668\u53ea\u80fd\u4f7f\u7528\u6307\u5b9a\u7684 CPU \u6838\u5fc3\u3002\u4f8b\u5982\uff0c--cpuset-cpus=\"0.1\" \u9650\u5236\u5bb9\u5668\u53ea\u5728 CPU 0 \u548c 1 \u4e0a\u8fd0\u884c\u3002 </li> </ul> <p>\u5185\u5b58\u9650\u5236</p> <ul> <li><code>--memory</code>\uff1a\u9650\u5236\u5bb9\u5668\u7684\u6700\u5927\u5185\u5b58\u4f7f\u7528\u91cf\u3002\u4f8b\u5982\uff0c<code>--memory=\"512m\"</code> \u9650\u5236\u5bb9\u5668\u6700\u591a\u4f7f\u7528 512MB \u5185\u5b58\u3002</li> <li><code>--memory-swap</code>: \u8bbe\u7f6e\u5bb9\u5668\u7684\u6700\u5927\u4ea4\u6362\u5185\u5b58\u3002\u6b64\u503c\u5e94\u8be5\u5927\u4e8e <code>--memory</code>\uff0c\u5426\u5219 Docker \u4f1a\u7981\u6b62\u4ea4\u6362\u3002</li> </ul> <p>\u78c1\u76d8 I/O \u9650\u5236\uff1a</p> <ul> <li><code>--blokio-weight</code>:  \u8bbe\u7f6e\u5bb9\u5668\u7684\u78c1\u76d8 I/O \u6743\u91cd\uff0c\u503c\u8303\u56f4\u662f 10 \u5230 1000\uff0c\u9ed8\u8ba4\u503c\u662f 500\u3002</li> <li><code>--device-read-bps</code> \\ <code>--device-write-bps</code> :\u5206\u522b\u9650\u5236\u5bb9\u5668\u7684\u8bfb\u5199\u901f\u7387\u3002</li> </ul> <p>\u7f51\u7edc\u5e26\u5bbd\u9650\u5236\uff1a</p> <p><code>--network</code>: \u914d\u7f6e\u5bb9\u5668\u7684\u7f51\u7edc\u8bbe\u7f6e\u5e76\u9650\u5236\u5e26\u5bbd\u3002</p>"},{"location":"2025/2docker/#23-docker","title":"23. Docker \u955c\u50cf\u7684\u591a\u9636\u6bb5\u6784\u5efa\u6709\u4ec0\u4e48\u4f18\u52bf\uff1f","text":"<p>\u591a\u9636\u6bb5\u6784\u5efa\u53ef\u4ee5\u5927\u5927\u4f18\u5316 Docker \u955c\u50cf\u7684\u5927\u5c0f\u548c\u6784\u5efa\u6548\u7387\uff0c\u4e3b\u8981\u4f18\u52bf\u5982\u4e0b\uff1a</p> <ul> <li>\u51cf\u5c11\u955c\u50cf\u5927\u5c0f\uff1a \u591a\u9636\u6bb5\u6784\u5efa\u5141\u8bb8\u5728\u4e00\u4e2a Dockerfile \u4e2d\u8fdb\u884c\u4e0d\u540c\u9636\u6bb5\u7684\u6784\u5efa\uff0c\u6700\u7ec8\u53ea\u5c06\u751f\u4ea7\u73af\u5883\u6240\u9700\u7684\u6587\u4ef6\u590d\u5236\u5230\u6700\u7ec8\u7684\u955c\u50cf\u4e2d\u3002\u8fd9\u79cd\u65b9\u5f0f\u907f\u514d\u4e86\u5c06\u4e0d\u5fc5\u8981\u7684\u5de5\u5177\u3001\u7f16\u8bd1\u5668\u7b49\u5305\u542b\u5728\u6700\u7ec8\u955c\u50cf\u4e2d\uff0c\u4ece\u800c\u51cf\u5c11\u955c\u50cf\u7684\u5927\u5c0f\u3002</li> <li>\u5206\u79bb\u6784\u5efa\u548c\u8fd0\u884c\u73af\u5883\uff1a \u5728\u7b2c\u4e00\u4e2a\u9636\u6bb5\u4e2d\u53ef\u4ee5\u4f7f\u7528\u91cd\u7684\u5f00\u53d1\u73af\u5883\uff0c\u5982\u6784\u5efa\u5de5\u5177\u548c\u4f9d\u8d56\uff0c\u7136\u540e\u5728\u7b2c\u4e8c\u9636\u6bb5\u4e2d\u4f7f\u7528\u7cbe\u7b80\u7684\u57fa\u7840\u955c\u50cf\uff08\u5982 alpine\uff09\uff0c\u4ec5\u5305\u542b\u6700\u7ec8\u5e94\u7528\u6240\u9700\u7684\u8fd0\u884c\u65f6\u73af\u5883\u3002</li> <li>\u52a0\u901f\u6784\u5efa\uff1a \u53ef\u4ee5\u901a\u8fc7\u7f13\u5b58\u673a\u5236\u52a0\u901f\u6784\u5efa\u8fc7\u7a0b\uff0c\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u6b65\u9aa4\u548c\u91cd\u590d\u64cd\u4f5c\uff0c\u5c24\u5176\u662f\u5728\u4f7f\u7528 CI/CD \u5de5\u5177\u94fe\u65f6\u3002</li> </ul> <p>Dockerfile</p> <pre><code>\u7b2c\u4e00\u9636\u6bb5\uff1a\u6784\u5efa\nFROM golang:1.16 AS builder\nWORKDIR /app\nCOPY . .\nRUN go build -o myapp\n\u7b2c\u4e8c\u9636\u6bb5\uff1a\u8fd0\u884c\nFROM alpine:latest\nWORKDIR /root/\nCOPY --from=builder /app/myapp .\nCMD [\"./myapp\"]\n</code></pre>"},{"location":"2025/2docker/#24-docker","title":"24. \u5982\u4f55\u5904\u7406 Docker \u5bb9\u5668\u4e2d\u7684\u65e5\u5fd7\u7ba1\u7406\uff1f","text":"<p>Docker \u63d0\u4f9b\u4e86\u51e0\u79cd\u65b9\u5f0f\u6765\u5904\u7406\u548c\u7ba1\u7406\u5bb9\u5668\u7684\u65e5\u5fd7\uff1a</p> <p>Docker \u9ed8\u8ba4\u65e5\u5fd7\u9a71\u52a8\uff1a </p> <p>Docker \u4f7f\u7528\u4e0d\u540c\u7684\u65e5\u5fd7\u9a71\u52a8\uff08\u5982json-file\u3001journald\u3001syslog \u7b49\uff09\u3002\u9ed8\u8ba4\u65e5\u5fd7\u9a71\u52a8\u662f<code>json-file</code>\uff0c\u5bb9\u5668\u7684\u65e5\u5fd7\u88ab\u5b58\u50a8\u5728\u5bbf\u4e3b\u673a\u7684 <code>/var/lib/docker/containers/&lt;container-id&gt;/</code> \u76ee\u5f55\u4e0b</p> <p>\u914d\u7f6e\u65e5\u5fd7\u9a71\u52a8\uff1a</p> <p>\u901a\u8fc7 <code>--log-driver</code> \u9009\u9879\u6307\u5b9a\u5176\u4ed6\u65e5\u5fd7\u9a71\u52a8\uff08\u5982 syslog\u3001fluentd\u3001awslogs \u7b49\uff09\u4ee5\u5c06\u65e5\u5fd7\u53d1\u9001\u5230\u5916\u90e8\u7cfb\u7edf\u3002</p> <p>Docker logs \u547d\u4ee4</p> <p>\u901a\u8fc7 <code>docker logs &lt;container-id&gt;</code> \u547d\u4ee4\u67e5\u770b\u5bb9\u5668\u7684\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u65e5\u5fd7</p> <p>\u96c6\u4e2d\u5f0f\u65e5\u5fd7\u7ba1\u7406\uff1a </p> <p>\u5bf9\u4e8e\u751f\u4ea7\u73af\u5883\uff0c\u4f7f\u7528\u96c6\u4e2d\u5f0f\u65e5\u5fd7\u7ba1\u7406\u5de5\u5177\uff0c\u5982 ELK\uff08Elasticsearch, Logstash, Kibana\uff09 \u5806\u6808\u3001Fluentd\u3001Graylog \u7b49\uff0c\u5c06\u5bb9\u5668\u65e5\u5fd7\u96c6\u4e2d\u6536\u96c6\u548c\u5206\u6790\u3002</p> <p>\u65e5\u5fd7\u8f6e\u8f6c\uff1a </p> <p>\u4e3a\u9632\u6b62\u65e5\u5fd7\u6587\u4ef6\u8fc7\u5927\uff0c\u53ef\u4ee5\u914d\u7f6e\u65e5\u5fd7\u8f6e\u8f6c\u3002Docker \u652f\u6301 <code>max-size</code> \u548c <code>max-file</code> \u9009\u9879\u6765\u8bbe\u7f6e\u65e5\u5fd7\u8f6e\u8f6c\u548c\u4fdd\u7559\u65e5\u5fd7\u6587\u4ef6\u7684\u6570\u91cf</p>"},{"location":"2025/2docker/#25-docker","title":"25. \u5982\u4f55\u5728 Docker \u4e2d\u8c03\u4f18\u6027\u80fd\uff1f","text":"<p>Docker \u5bb9\u5668\u7684\u6027\u80fd\u4f18\u5316\u4e3b\u8981\u6d89\u53ca\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u955c\u50cf\u4f18\u5316\uff1a \u4f7f\u7528\u8f7b\u91cf\u7ea7\u7684\u57fa\u7840\u955c\u50cf\uff08\u5982 alpine\uff09\u4ee5\u51cf\u5c11\u955c\u50cf\u7684\u5927\u5c0f\uff0c\u5e76\u4e14\u53ea\u5305\u542b\u8fd0\u884c\u65f6\u6240\u9700\u7684\u4f9d\u8d56\u3002</li> <li>\u5bb9\u5668\u8d44\u6e90\u9650\u5236\uff1a \u5408\u7406\u9650\u5236 CPU\u3001\u5185\u5b58\u3001I/O \u7b49\u8d44\u6e90\uff0c\u786e\u4fdd\u5bb9\u5668\u4e0d\u4f1a\u6d88\u8017\u8fc7\u591a\u7684\u8d44\u6e90\uff0c\u5f71\u54cd\u5176\u4ed6\u5bb9\u5668\u6216\u5bbf\u4e3b\u673a\u3002</li> <li>\u5408\u5e76 Dockerfile \u5c42\uff1a \u901a\u8fc7\u51cf\u5c11 Dockerfile \u4e2d\u7684 RUN\u3001COPY \u7b49\u547d\u4ee4\u7684\u6570\u91cf\uff0c\u51cf\u5c11\u955c\u50cf\u5c42\u6570\uff0c\u4f18\u5316\u6784\u5efa\u65f6\u95f4\u3002</li> <li>\u4f7f\u7528\u5171\u4eab\u5185\u5b58\uff1a \u901a\u8fc7\u4f7f\u7528 <code>--shm-size</code> \u53c2\u6570\u4e3a\u5bb9\u5668\u8bbe\u7f6e\u9002\u5f53\u7684\u5171\u4eab\u5185\u5b58\u5927\u5c0f\uff0c\u907f\u514d\u5185\u5b58\u4e0d\u8db3\u5bfc\u81f4\u6027\u80fd\u74f6\u9888\u3002</li> <li>\u6027\u80fd\u76d1\u63a7\uff1a \u4f7f\u7528 Docker \u5185\u5efa\u7684 docker stats \u547d\u4ee4\u6216 Prometheus + Grafana \u7b49\u5de5\u5177\u6765\u76d1\u63a7\u5bb9\u5668\u6027\u80fd\uff0c\u8bc6\u522b\u74f6\u9888\u3002</li> <li>\u65e5\u5fd7\u4f18\u5316\uff1a \u907f\u514d\u5c06\u65e5\u5fd7\u5199\u5165\u5bb9\u5668\u5185\u7684\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\uff0c\u5c24\u5176\u662f\u5728\u9ad8\u8d1f\u8f7d\u73af\u5883\u4e0b\u3002\u4f7f\u7528\u5916\u90e8\u65e5\u5fd7\u7ba1\u7406\u7cfb\u7edf</li> </ul>"},{"location":"2025/2docker/#26-docker","title":"26 \u5982\u4f55\u5728 Docker \u4e2d\u5904\u7406\u5bb9\u5668\u7684\u9ad8\u6548\u7f51\u7edc\u901a\u4fe1\uff1f","text":"<ul> <li>\u7528\u6237\u5b9a\u4e49\u7f51\u7edc\uff1a \u901a\u8fc7\u521b\u5efa\u7528\u6237\u5b9a\u4e49\u7684 bridge \u7f51\u7edc\u6216 overlay \u7f51\u7edc\uff0c\u4f7f\u5bb9\u5668\u80fd\u591f\u901a\u8fc7\u540d\u79f0\u76f8\u4e92\u901a\u4fe1\uff0c\u4e14\u6027\u80fd\u66f4\u4f18\u3002</li> <li>Docker \u7f51\u7edc\u6a21\u5f0f\uff1a Docker \u652f\u6301\u4e0d\u540c\u7684\u7f51\u7edc\u6a21\u5f0f\uff0c\u5982 host\u3001bridge\u3001overlay\u3001none\u3002\u9009\u62e9\u5408\u9002\u7684\u7f51\u7edc\u6a21\u5f0f\u6765\u786e\u4fdd\u5bb9\u5668\u95f4\u9ad8\u6548\u901a\u4fe1\u3002</li> <li>\u5bb9\u5668\u8fde\u63a5\u5230\u591a\u4e2a\u7f51\u7edc\uff1a \u4e00\u4e2a\u5bb9\u5668\u53ef\u4ee5\u8fde\u63a5\u5230\u591a\u4e2a\u7f51\u7edc\uff0c\u8fd9\u6837\u53ef\u4ee5\u540c\u65f6\u4eab\u53d7\u4e0d\u540c\u7f51\u7edc\u914d\u7f6e\u5e26\u6765\u7684\u4f18\u52bf\u3002</li> <li>\u7f51\u7edc I/O \u6027\u80fd\u8c03\u4f18\uff1a \u901a\u8fc7\u8bbe\u7f6e\u7f51\u7edc\u5e26\u5bbd\u9650\u5236\u3001\u4f18\u5316\u7f51\u7edc\u63a5\u53e3\u7684\u914d\u7f6e\uff0c</li> </ul>"},{"location":"2025/2docker/#docker","title":"\u5982\u4f55\u6784\u5efa Docker \u955c\u50cf","text":""},{"location":"2025/2docker/#dockerfile","title":"Dockerfile \u8be6\u89e3","text":"<p>\u4e00\u4e2a Docker \u955c\u50cf\u6700\u57fa\u7840\u7684\u5efa\u7b51\u5757\u662f\u4e00\u4e2a Dockerfile\u3002</p> <p>\u4e00\u4e2a Dockerfile \u662f\u4e00\u4e2a\u5e26\u6709\u6307\u4ee4\u548c\u53c2\u6570\u7684\u7b80\u6613\u7684\u6587\u672c\u6587\u4ef6\u3002Docker \u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6\u8fd9\u4e9b\u5728 Dockerfile \u91cc\u7ed9\u51fa\u7684\u6307\u4ee4\u81ea\u52a8\u6784\u5efa\u955c\u50cf\u3002</p> <p>\u5728\u4e00\u4e2a Dockerfile \u91cc\uff0c\u5728\u5de6\u8fb9\u7684\u4e00\u5207\u90fd\u662f\u6307\u4ee4(Instruction)\uff0c\u800c\u5728\u53f3\u8fb9\u7684\u4e00\u5207\u90fd\u662f\u8d4b\u4e88\u7ed9\u6307\u4ee4\u7684\u53c2\u6570(Argement)\u3002\u8fd8\u6709\uff0c\u8981\u8bb0\u7740\u8fd9\u4e2a\u6587\u4ef6\u540d\u79f0\u662f Dockerfile \u5b83\u4e0d\u9700\u8981\u4efb\u4f55\u7684\u6269\u5c55\u540d</p> <p></p> <p>\u4ee5\u4e0b\u7684\u8868\u683c\u4e2d\u5305\u542b\u4e86\u91cd\u8981\u7684 Dockerfile \u6307\u4ee4\u548c\u5b83\u4eec\u7684\u89e3\u91ca\u3002</p> Dockerfile \u6307\u4ee4 \u89e3\u91ca FROM \u53ef\u4ee5\u4ece\u5bb9\u5668\u6ce8\u518c\u8868\u62c9\u53d6\u7684\u57fa\u7840\u955c\u50cf ( Docker hub, GCR, Quay, ECR, \u7b49\u7b49) RUN \u5728\u955c\u50cf\u6784\u5efa\u8fc7\u7a0b\u4e2d\u6267\u884c\u7684\u547d\u4ee4 ENV \u5728\u955c\u50cf\u4e2d\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3002\u5b83\u662f\u6784\u5efa\u8fc7\u7a0b\u4e2d\u662f\u53ef\u7528\u7684\uff0c\u540c\u6837\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u4e2d\u4e5f\u662f\u3002\u5982\u679c\u60a8\u53ea\u60f3\u8981\u5728\u6784\u5efa\u65f6\u95f4\u4e2d\u4f7f\u7528\u5b83\uff0c\u8bf7\u4f7f\u7528 ARG \u6307\u4ee4 COPY \u62f7\u8d1d\u672c\u5730\u6587\u4ef6\u548c\u76ee\u5f55\u5230\u955c\u50cf\u4e2d EXPOSE \u4e3a Docker \u5bb9\u5668\u6307\u5b9a\u7279\u5b9a\u7684\u8981\u66b4\u9732\u7684\u7aef\u53e3 ADD \u5b83\u662f COPY \u6307\u4ee4\u7684\u529f\u80fd\u66f4\u4e30\u5bcc\u7684\u7248\u672c\u3002\u5b83\u8fd8\u5141\u8bb8\u4ece\u6e90 URL \u590d\u5236\u5e76\u5c06 tar \u6587\u4ef6\u81ea\u52a8\u63d0\u53d6\u5230\u955c\u50cf\u4e2d\u3002\u4f46\u662f\uff0c\u5efa\u8bae\u4f7f\u7528 COPY \u547d\u4ee4\u800c\u4e0d\u662f ADD\u3002\u5982\u679c\u8981\u4e0b\u8f7d\u8fdc\u7a0b\u6587\u4ef6\uff0c\u8bf7\u4f7f\u7528 curl \u6216\u4f7f\u7528 RUN \u83b7\u53d6 WORKDIR \u8bbe\u7f6e\u5f53\u524d\u7684\u5de5\u4f5c\u76ee\u5f55\u3002\u60a8\u53ef\u4ee5\u5728\u4e00\u4e2a Dockerfile \u91cc\u9762\u91cd\u590d\u4f7f\u7528\u8fd9\u4e2a\u6307\u4ee4\u53bb\u8bbe\u7f6e\u4e00\u4e2a\u4e0d\u540c\u7684\u5de5\u4f5c\u76ee\u5f55\u3002\u5982\u679c\u60a8\u8bbe\u7f6e\u4e86 ENTRYPOINT\uff0c\u50cf RUN\uff0cCMD\uff0cADD\uff0cCOPY\uff0c\u6216\u8005 ENTRYPOINT \u8fd9\u6837\u7684\u6307\u4ee4\u5c31\u4f1a\u5728\u4f60\u7684\u8fd9\u4e2a\u76ee\u5f55\u91cc\u6267\u884c VOLUME \u5b83\u662f\u7528\u4e8e\u521b\u5efa\u6216\u8005\u6302\u8f7d\u5377\u5230 Docker \u5bb9\u5668 USER \u5f53\u8fd0\u884c\u5bb9\u5668\u65f6\uff0c\u8bbe\u7f6e\u7528\u6237\u540d\u79f0\u548c UID \u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u6307\u4ee4\u53bb\u8bbe\u7f6e\u4e00\u4e2a\u975e root \u7684\u5bb9\u5668\u7528\u6237 LABEL \u5b83\u662f\u53bb\u6307\u5b9a Docker \u955c\u50cf\u7684 metadata \u4fe1\u606f ARG \u8bbe\u7f6e\u6784\u5efa\u65f6\uff0c\u5e26\u6709 Key \u548c Value \u7684\u53d8\u91cf\u3002\u5f53\u5bb9\u5668\u8fd0\u884c\u65f6\uff0cARG \u53d8\u91cf\u5c06\u4e0d\u53ef\u7528\u3002\u5982\u679c\u4f60\u575a\u6301\u60f3\u8981\u5728\u4e00\u4e2a\u8fd0\u884c\u7684\u5bb9\u5668\u4e2d\u4f7f\u7528\u4e00\u4e2a\u53d8\u91cf\uff0c\u8bf7\u4f7f\u7528 ENV SHELL \u5b83\u88ab\u7528\u4e8e\u4e3a\u4e86\u7ed9\u5176\u540e\u7684 RUN\uff0cCMD \u548c ENTRYPOINT \u53bb\u8bbe\u7f6e shell \u9009\u9879\u548c\u9ed8\u8ba4 shell \u3002 CMD \u5b83\u7528\u4e8e\u5728\u4e00\u4e2a\u8fd0\u884c\u7684\u5bb9\u5668\u4e2d\u6267\u884c\u4e00\u6761\u547d\u4ee4\u3002\u8fd9\u91cc\u53ea\u80fd\u6709\u4e00\u4e2a CMD\uff0c \u5982\u679c\u6709\u591a\u4e2a\uff0c\u5b83\u53ea\u8ba9\u6700\u540e\u4e00\u4e2a\u6267\u884c\u3002\u5b83\u8fd8\u53ef\u4ee5\u88ab Docker CLI \u8986\u76d6 ENTRYPOINT \u5f53\u5bb9\u5668\u542f\u52a8\u65f6\uff0c\u6307\u5b9a\u7684\u547d\u4ee4\u5c06\u4f1a\u6267\u884c\u3002\u5982\u679c\u60a8\u4e0d\u6307\u5b9a\u4efb\u4f55 ENTRYPOINT\uff0c\u5b83\u9ed8\u8ba4\u4f1a\u662f <code>/bin/sh -c</code>\u3002\u60a8\u8fd8\u53ef\u4ee5\u4f7f\u7528 CLI \u7684 <code>--entrypoint</code> \u8986\u76d6 ENTRYPOINT\u3002"},{"location":"2025/2docker/#dockerfile-docker","title":"\u4f7f\u7528 Dockerfile \u6784\u5efa Docker \u955c\u50cf","text":"<p>\u5728\u8fd9\u4e00\u8282\uff0c\u60a8\u5c06\u4f1a\u5b66\u4e60\u4f7f\u7528\u4e00\u4e2a\u5728\u73b0\u5b9e\u5de5\u4f5c\u4e2d\u4f7f\u7528\u7684\u6848\u4f8b\u53bb\u6784\u5efa\u4e00\u4e2a Docker \u955c\u50cf\u3002\u6211\u4eec\u5c06\u4f1a\u4ece\u5934\u4f7f\u7528\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684 Index \u9875\u9762\u53bb\u521b\u5efa\u4e00\u4e2a Nginx Docker \u955c\u50cf\u3002</p> <p>\u4ee5\u4e0b\u7684\u7167\u7247\u5c55\u793a\u4e86\u955c\u50cf\u6784\u5efa\u8fc7\u7a0b\u7684\u5de5\u4f5c\u6d41\u3002</p> <p></p> <p>\u6b65\u9aa4 1: \u521b\u5efa\u4e00\u4e2a\u5fc5\u987b\u7684\u6587\u4ef6\u548c\u6587\u6863</p> <p>\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a nginx-image \u548c\u4e00\u4e2a\u540d\u4e3a files \u7684\u6587\u4ef6\u5939</p> <pre><code>mkdir nginx-image &amp;&amp; cd nginx-image\nmkdir files\n</code></pre> <p>\u521b\u5efa\u4e00\u4e2a <code>.dockerignore</code> \u6587\u4ef6</p> <pre><code>touch .dockerignore\n</code></pre> <p>\u6b65\u9aa4 2: \u521b\u5efa\u4e00\u4e2a\u6a21\u677f HTML \u6587\u4ef6\u548c config \u6587\u4ef6</p> <p>\u5f53\u60a8\u6784\u5efa\u4e00\u4e2a\u4e3a\u5b9e\u65f6\u9879\u76ee\u7684 Docker \u955c\u50cf\u65f6\uff0c\u5b83\u5305\u542b\u4e86\u4ee3\u7801\u6216\u8005\u5e94\u7528\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>\u7528\u4e8e\u6f14\u793a\u76ee\u7684\uff0c\u6211\u4eec\u5c06\u8981\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684 HTML \u6587\u4ef6\u548c config \u6587\u4ef6\u4f5c\u4e3a\u6211\u4eec\u7684 app \u4ee3\u7801\uff0c\u518d\u4f7f\u7528 Docker \u6253\u5305\u3002</p> <p>\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684 index.html \u6587\u4ef6\u3002\u5982\u679c\u60a8\u613f\u610f\uff0c\u60a8\u53ef\u4ee5\u521b\u5efa\u60a8\u81ea\u5df1\u559c\u6b22\u7684\u3002</p> <p>cd \u8fdb\u5165\u6587\u4ef6\u5939</p> <pre><code>cd files\n</code></pre> <p>\u521b\u5efa\u4e00\u4e2a index.html \u6587\u4ef6</p> <pre><code>vim index.html\n</code></pre> <p>\u590d\u5236\u4ee5\u4e0b\u7684\u5185\u5bb9\u5230 index.html \u518d\u4fdd\u5b58\u8fd9\u4e2a\u6587\u4ef6</p> <pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;Dockerfile&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div class=\"container\"&gt;\n      &lt;h1&gt;My App&lt;/h1&gt;\n      &lt;h2&gt;This is my first app&lt;/h2&gt;\n      &lt;p&gt;Hello everyone, This is running via Docker container&lt;/p&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u521b\u5efa\u4e00\u4e2a\u540d\u5b57\u4e3a default \u7684\u6587\u4ef6</p> <pre><code>vim default\n</code></pre> <p>\u590d\u5236\u4ee5\u4e0b\u7684\u7684\u5185\u5bb9\u5230 default \u6587\u4ef6</p> <pre><code>server {\n    listen 80 default_server;\n    listen [::]:80 default_server;\n\n    root /usr/share/nginx/html;\n    index index.html index.htm;\n\n    server_name _;\n    location / {\n        try_files $uri $uri/ =404;\n    }\n}\n</code></pre> <p>\u6b65\u9aa4 3: \u9009\u62e9\u4e00\u4e2a\u57fa\u7840\u955c\u50cf</p> <p>\u6211\u4eec\u5728 Dockerfile \u4e2d\u4f7f\u7528 FROM \u547d\u4ee4\uff0c\u8be5\u547d\u4ee4\u6307\u793a Docker \u6839\u636e Docker \u4e2d\u5fc3\u6216\u4efb\u4f55\u4f7f\u7528 Docker \u914d\u7f6e\u7684\u5bb9\u5668\u6ce8\u518c\u8868\u4e0a\u53ef\u7528\u7684\u955c\u50cf\u521b\u5efa\u955c\u50cf\u3002 \u6211\u4eec\u79f0\u5b83\u4e3a\u4e00\u4e2a\u57fa\u7840\u955c\u50cf\u3002</p> <p>\u5b83\u662f\u548c\u6211\u4eec\u5728\u4e91\u4e0a\u5982\u4f55\u4ece\u4e00\u4e2a\u865a\u62df\u673a\u955c\u50cf\u521b\u5efa\u4e00\u4e2a\u865a\u62df\u673a\u662f\u76f8\u4f3c\u7684\u3002</p> <p>\u9009\u62e9\u4e00\u4e2a\u57fa\u7840\u955c\u50cf\u53d6\u51b3\u4e8e\u6211\u4eec\u7684\u5e94\u7528\u548c\u9009\u62e9\u7684 OS \u5e73\u53f0\u3002\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u9009\u62e9 ubuntu:18.04 \u57fa\u7840\u955c\u50cf\u3002</p> <p>\u6b65\u9aa4 4: \u521b\u5efa\u4e00\u4e2a Dockerfile</p> <p>\u5728 nginx-image \u6587\u4ef6\u5939\u4e2d\u521b\u5efa\u4e00\u4e2a Dockerfile\u3002</p> <pre><code>vim Dockerfile\n</code></pre> <p>\u8fd9\u91cc\u662f\u4e00\u4efd\u7b80\u5355\u7684 Dockerfile \u4e3a\u4e86\u6211\u4eec\u80fd\u591f\u597d\u7684\u7ee7\u7eed\u3002\u7136\u540e\u628a\u8fd9\u4e9b\u6dfb\u52a0\u5230\u6211\u4eec\u7684 Dockerfile\u3002</p> <pre><code>FROM ubuntu:18.04  \nLABEL maintainer=\"contact@devopscube.com\" \nRUN  apt-get -y update &amp;&amp; apt-get -y install nginx\nCOPY files/default /etc/nginx/sites-available/default\nCOPY files/index.html /usr/share/nginx/html/index.html\nEXPOSE 80\nCMD [\"/usr/sbin/nginx\", \"-g\", \"daemon off;\"]\n</code></pre> <p>\u8fd9\u91cc\u662f\u6bcf\u4e00\u6b65\u7684\u89e3\u91ca\uff1a</p> <ol> <li>\u4f7f\u7528 LABEL \u6307\u4ee4, \u6211\u4eec\u6dfb\u52a0\u4e86\u5173\u4e8e\u7ef4\u62a4\u8005\u7684 \u4e00\u4e9b\u4fe1\u606f\u3002\u4ed6\u4e0d\u662f\u5fc5\u987b\u7684\u6307\u4ee4\u54c8\u3002</li> <li>FROM \u6307\u4ee4\u5c06\u4f1a\u4ece Docker hub \u62c9\u53d6 Ubuntu 18.04 \u7248\u672c\u7684\u955c\u50cf\uff0c\u5728\u7b2c\u4e09\u884c\uff0c\u6211\u4eec\u6b63\u5728\u5b89\u88c5 Nginx \u3002</li> <li>\u7136\u540e\uff0c\u6211\u4eec\u5c06 Nginx \u7684\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\u4ece\u672c\u5730\u6587\u4ef6\u76ee\u5f55\u62f7\u8d1d\u5230\u76ee\u6807\u955c\u50cf\u76ee\u5f55\u3002</li> <li>\u4e0b\u4e00\u6b65\uff0c\u6211\u4eec\u5c06 Index.html \u6587\u4ef6\u4ece\u672c\u5730\u76ee\u5f55\u62f7\u8d1d\u8fdb\u76ee\u6807\u955c\u50cf\u76ee\u5f55\u3002\u5b83\u5c06\u4f1a\u8986\u76d6\u5728 Nginx \u5b89\u88c5\u8fc7\u7a0b\u4e2d\u88ab\u521b\u5efa\u7684\u9ed8\u8ba4\u7684 Index.html \u6587\u4ef6\u3002</li> <li>\u6211\u4eec\u66b4\u9732\u4e86 80 \u7aef\u53e3\uff0c\u4f5c\u4e3a Nginx \u670d\u52a1\u76d1\u542c\u7684 80 \u7aef\u53e3\u3002</li> <li>\u6700\u7ec8\uff0c\u5f53 Docker \u955c\u50cf\u542f\u52a8\uff0c\u6211\u4eec\u7684 Nginx \u670d\u52a1\u4f1a\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u4f7f\u7528 CMD \u6307\u4ee4\u3002</li> </ol> <p>\u5728Docker \u5bb9\u5668\uff0c \u8fd9\u4e2a daemon off; \u6307\u4ee4\u4f1a\u544a\u8bc9 Nginx \u505c\u7559\u5728\u524d\u7aef\u3002\u8fd9\u5c31\u610f\u5473\u7740 Nginx \u8fdb\u7a0b\u8fdb\u4f1a\u4fdd\u6301\u8fd0\u884c\u4e0d\u4f1a\u505c\u6b62\uff0c\u76f4\u5230\u4f60\u81ea\u5df1\u505c\u6b62\u8fd9\u4e2a\u5bb9\u5668\u3002\u5b83\u4e0d\u5141\u8bb8 Nginx \u7684 \u81ea\u5b88\u62a4\u8fdb\u7a0b\u884c\u4e3a\u3002-g \u9009\u9879\u6307\u5b9a\u4e86\u4e00\u4e2a\u6307\u4ee4\u7ed9 Nginx \u3002</p> <p>\u6211\u4eec\u5728\u524d\u53f0\u8fd0\u884c\u8be5\u8fdb\u7a0b\u7684\u539f\u56e0\u662f\u5c06\u63a7\u5236\u53f0\u8fdb\u7a0b\u9644\u52a0\u5230\u6807\u51c6\u8f93\u5165\u3001\u8f93\u51fa\u548c\u9519\u8bef\u3002\u8fd9\u610f\u5473\u7740\u60a8\u53ef\u4ee5\u770b\u5230\u6765\u81ea Nginx \u8fdb\u7a0b\u7684\u65e5\u5fd7\u6216\u6d88\u606f\u3002</p> <p>\u6b65\u9aa4 4: \u6784\u5efa\u4f60\u7684\u7b2c\u4e00\u4e2a Docker \u955c\u50cf</p> <p>\u6700\u7ec8\u7684\u6587\u4ef6\u5939\u548c\u6587\u4ef6\u7ed3\u6784\u770b\u8d77\u6765\u50cf\u4ee5\u4e0b\u5185\u5bb9\u3002</p> <pre><code>nginx-image\n\u251c\u2500\u2500 Dockerfile\n\u2514\u2500\u2500 files\n    \u251c\u2500\u2500 default\n    \u2514\u2500\u2500 index.html\n</code></pre> <p>\u73b0\u5728\uff0c\u6211\u4eec\u8981\u4f7f\u7528 Docker \u547d\u4ee4\u6784\u5efa\u6211\u4eec\u7684\u955c\u50cf\u3002\u4ee5\u4e0b\u7684\u547d\u4ee4\u4f1a\u4ece\u76f8\u540c\u7684\u76ee\u5f55\u4f7f\u7528 Dockerfile \u6784\u5efa\u955c\u50cf\u3002</p> <pre><code>docker build -t nginx:1.0 .\n</code></pre> <ol> <li><code>-t</code> \u662f\u4e3a\u4e86\u7ed9\u8fd9\u4e2a\u955c\u50cf\u8d77\u4e2a\u540d\u5b57\u548c\u6307\u5b9a\u4f60\u7684\u6807\u7b7e</li> <li>nginx \u662f\u8fd9\u4e2a\u955c\u50cf\u7684\u540d\u5b57</li> <li>1.0 \u662f\u8fd9\u4e2a\u6807\u7b7e\u540d\u79f0\u3002\u5982\u679c\u4f60\u4e0d\u6dfb\u52a0\u4efb\u4f55\u6807\u7b7e\uff0c\u5b83\u9ed8\u8ba4\u7684\u6807\u7b7e\u540d\u79f0\u4e3a Latest</li> <li>. \u5728\u672b\u5c3e\u7684 . \u610f\u5473\u7740\u6211\u4eec\u4f1a\u53c2\u8003 Dokerfile \u4f4d\u7f6e\u4f5c\u4e3a\u6211\u4eec\u7684 Docker \u6784\u5efa\u4e0a\u4e0b\u6587\u3002\u4e5f\u5c31\u662f\u6211\u4eec\u73b0\u5728\u7684\u76ee\u5f55</li> </ol> <p></p> <p>\u5982\u679c Dockerfile \u5728\u53e6\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u90a3\u4e48\u4f60\u9700\u8981\u660e\u786e\u7684\u628a\u5b83\u6307\u5b9a\u51fa\u6765\uff0c\u5426\u5219\u4f1a\u627e\u4e0d\u5230</p> <pre><code>docker build -t nginx /path/to/folder \n\ndocker images\n</code></pre> <pre><code>vagrant@ubuntu-focal:~$ docker images\nREPOSITORY TAG IMAGE ID CREATED SIZE\nnginx 1.0 45e69895763f 23 minutes ago 166MB\nnginx latest 45e69895763f 23 minutes ago 166MB\nubuntu latest 216c552ea5ba 6 days ago 77.8MB\nubuntu 18.04 71cb16d32be4 6 days ago 63.1MB\n</code></pre> <p>\u6211\u4eec\u5728\u8fd9\u91cc\u53ef\u4ee5\u770b\u89c1\u6807\u7b7e\u662f1.0\u3002 \u5982\u679c\u6211\u4eec\u60f3\u8981\u5f04\u4e00\u4e2a\u6307\u5b9a\u7684\u6807\u7b7e\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5199 image-name:[tag] \u3002\u8fd8\u662f\u90a3\u53e5\u8bdd\uff0c\u5982\u679c\u4f60\u4e0d\u6307\u5b9a\u4efb\u4f55\u6807\u7b7e\uff0c\u9ed8\u8ba4\u4f1a\u662f Latest \u3002</p> <pre><code>docker build -t nginx:2.0 .\n</code></pre> <p>\u4e00\u4e2a\u5355\u4e00\u7684\u955c\u50cf\u53ef\u4ee5\u6709\u591a\u4e2a\u6807\u7b7e\u3002\u8fd9\u91cc\u6709\u4e24\u79cd\u6211\u4eec\u666e\u904d\u8ba4\u540c\u7684\u7ed9\u955c\u50cf\u6253\u6807\u7b7e\u7684\u65b9\u6cd5\uff1a</p> <ol> <li> <p>\u7a33\u5b9a\u7684 Tags \u2013 \u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u62c9\u53d6\u6211\u4eec\u6307\u5b9a\u7684\u6807\u7b7e\uff0c\u5b83\u4f1a\u7ee7\u7eed\u83b7\u5f97\u66f4\u65b0\u3002\u6807\u7b7e\u603b\u662f\u4e0d\u53d8\u7684\uff0c\u4f46\u662f\u955c\u50cf\u7684\u5185\u5bb9\u53ef\u4ee5\u6539\u53d8\u3002</p> </li> <li> <p>\u552f\u4e00\u7684 Tags \u2013 \u6211\u4eec\u4e3a\u6bcf\u4e00\u4e2a\u955c\u50cf\u4f7f\u7528\u4e00\u4e2a\u4e0d\u540c\u548c\u552f\u4e00\u7684\u6807\u7b7e\u3002\u6709\u591a\u79cd\u65b9\u5f0f\u53ef\u4ee5\u63d0\u4f9b\u552f\u4e00\u6807\u7b7e\uff0c\u4f8b\u5982\u65e5\u671f\u65f6\u95f4\u6233\u3001\u6784\u5efa\u7f16\u53f7\u3001\u63d0\u4ea4 ID \u7b49\u3002</p> </li> </ol> <p>\u6b65\u9aa4 5: \u6d4b\u8bd5\u4f60\u7684 Docker \u955c\u50cf</p> <p>\u73b0\u5728\uff0c\u6784\u5efa\u8fc7\u955c\u50cf\u4e4b\u540e\uff0c\u6211\u4eec\u5c06\u4f1a\u8fd0\u884c\u8fd9\u4e2a Docker \u955c\u50cf\u3002\u8fd9\u4e2a\u547d\u4ee4\u662f\uff1a</p> <pre><code>docker run -d -p 9090:80 --name webserver nginx:1.0\n</code></pre> <p>\u8fd9\u91cc</p> <ol> <li><code>-d</code> \u8fd9\u4e2a\u8868\u793a\u8ba9\u5bb9\u5668\u5728\u540e\u53f0\u8fd0\u884c</li> <li><code>-p</code> \u8fd9\u4e2a\u4e3a\u4e86\u6307\u5b9a\u7aef\u53e3\uff0c\u683c\u5f0f\u4e3a \u672c\u5730\u7aef\u53e3:\u5bb9\u5668\u7aef\u53e3</li> <li><code>--name</code> \u6307\u5b9a\u5bb9\u5668\u7684\u540d\u79f0\uff0cwebserver \u662f\u6211\u4eec\u7684\u540d\u79f0</li> </ol> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u7684\u547d\u4ee4\u68c0\u67e5\u8fd9\u4e2a\u5bb9\u5668</p> <pre><code>docker ps\n</code></pre> <p></p> <p>\u73b0\u5728\u5728\u6d4f\u89c8\u5668\u4e2d\uff0c\u5982\u679c\u4f60\u53bb\u5230 http://[host-ip]:9090\uff0c\u60a8\u53ef\u4ee5\u770b\u5230\u7d22\u5f15\u9875\uff0c\u5176\u4e2d\u663e\u793a\u4e86\u6211\u4eec\u6dfb\u52a0\u5230 docker \u955c\u50cf\u4e2d\u7684\u81ea\u5b9a\u4e49 HTML \u9875\u9762\u4e2d\u7684\u5185\u5bb9\u3002</p> <p></p>"},{"location":"2025/2docker/#docker-docker-hub","title":"\u63a8\u9001 Docker \u955c\u50cf\u5230 Docker Hub","text":"<p>\u63a8\u9001\u6211\u4eec\u7684 Docker \u955c\u50cf\u5230 Docker hub\uff0c\u6211\u4eec\u9700\u8981\u5728 Docker hub \u521b\u5efa\u4e00\u4e2a\u5e10\u53f7\u3002</p> <p>\u4ece\u7ec8\u7aef\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u767b\u5f55\u3002\u5b83\u5c06\u4f1a\u8981\u6c42\u8f93\u5165\u4e00\u4e2a\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002\u4e5f\u652f\u6301 Docker hub \u51ed\u8bc1\u3002</p> <pre><code>docker login\n\ndocker tag nginx:1.0 &lt;username&gt;/&lt;image-name&gt;:tag\n\ndocker tag nginx:1.0 devopscube/nginx:1.0\n</code></pre> <p>\u518d\u6b21\u8fd0\u884c docker images \u547d\u4ee4\uff0c\u68c0\u67e5\u88ab\u6253\u4e86\u6807\u7b7e\u7684\u955c\u50cf\u5c06\u4f1a\u663e\u793a\u5728\u8fd9\u91cc\u3002</p> <p></p> <p>\u73b0\u5728\uff0c\u6211\u4eec\u4f7f\u7528\u4ee5\u4e0b\u7684\u547d\u4ee4\u63a8\u9001\u6211\u4eec\u7684\u955c\u50cf\u5230 Docker hub \u3002</p> <pre><code>docker push devopscube/nginx:1.0\n</code></pre> <p></p>"},{"location":"2025/2docker/#dockerfile-heredoc","title":"\u5728 Dockerfile \u4e2d\u4f7f\u7528 heredoc","text":"<pre><code>RUN &lt;&lt;EOF\napt-get update\napt-get upgrade -y\napt-get install -y nginx\nEOF\n</code></pre> <p>\u8fd8\u6709\uff0c \u8ba9\u6211\u4eec\u804a\u804a\u4f60\u60f3\u8981\u4ece Dockerfile \u6267\u884c\u7684\u4e00\u4e2a Python \u811a\u672c\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u7684\u7684\u8bed\u6cd5\u3002</p> <pre><code>RUN python3 &lt;&lt;EOF\nwith open(\"/hello\", \"w\") as f:\n    print(\"Hello\", file=f)\n    print(\"World\", file=f)\nEOF\n</code></pre> <p>\u4f60\u8fd8\u53ef\u4ee5\u4f7f\u7528 heredoc \u8bed\u6cd5\u53bb\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff0c\u8fd9\u91cc\u662f\u4e00\u4e2a Nginx \u4f8b\u5b50\u3002</p> <pre><code>FROM nginx\n\nCOPY &lt;&lt;EOF /usr/share/nginx/html/index.html\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;Dockerfile&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div class=\"container\"&gt;\n      &lt;h1&gt;My App&lt;/h1&gt;\n      &lt;h2&gt;This is my first app&lt;/h2&gt;\n      &lt;p&gt;Hello everyone, This is running via Docker container&lt;/p&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"2025/2docker/#dockerfile_1","title":"Dockerfile \u7684\u6700\u597d\u5b9e\u8df5","text":"<p>\u8fd9\u91cc\u662f\u4e00\u4e9b\u6211\u4eec\u5e94\u8be5\u9075\u5faa Dockerfile \u7684\u901a\u5e38\u505a\u6cd5\uff1a</p> <ol> <li>\u4f7f\u7528\u4e00\u4e2a <code>.dockerignore</code> \u6587\u4ef6\u53bb\u6392\u9664\u4e0d\u5fc5\u8981\u7684\u6587\u4ef6\u548c\u76ee\u5f55\uff0c\u597d\u589e\u5f3a\u6211\u4eec\u7684\u6784\u5efa\u6027\u80fd\u3002</li> <li>\u53ea\u4f7f\u7528\u88ab\u4fe1\u4efb\u7684\u57fa\u7840\u955c\u50cf\uff0c\u8fdb\u884c\u5b9a\u671f\u66f4\u65b0\u7684\u955c\u50cf\u3002</li> <li>\u5728 Dockerfile \u6bcf\u4e00\u4e2a\u6307\u4ee4\u90fd\u5411 Docker \u955c\u50cf\u6dfb\u52a0\u4e86\u989d\u5916\u7684\u4e00\u5c42\u3002\u901a\u8fc7\u628a\u6307\u4ee4\u5408\u5e76\uff0c\u8ba9\u955c\u50cf\u5c42\u5c3d\u91cf\u4ee5\u6700\u5c11\u7684\u5c42\u53bb\u6784\u5efa\uff0c\u6709\u52a9\u4e8e\u589e\u5f3a\u6784\u5efa\u6027\u80fd\u548c\u65f6\u95f4\u3002</li> <li>\u4ee5\u4e00\u4e2a\u975e ROOT \u7528\u6237\u53bb\u8fd0\u884c\uff0c\u6709\u52a9\u4e8e\u66f4\u52a0\u5b89\u5168\u3002</li> <li>\u628a\u955c\u50cf\u4f53\u79ef\u4fdd\u6301\u4e3a\u6700\u5c0f\uff1a\u5728\u4f60\u7684\u955c\u50cf\u4e2d\uff0c\u4e3a\u4e86\u66f4\u5feb\u7684\u90e8\u7f72\uff0c \u8981\u907f\u514d\u5b89\u88c5\u4e0d\u5fc5\u8981\u7684\u5de5\u5177\uff0c\u4ee5\u51cf\u5c11\u955c\u50cf\u7684\u5927\u5c0f\u3002\u4f7f\u7528\u5c3d\u53ef\u80fd\u5c0f\u7684\u955c\u50cf\u4e3a\u4e86\u51cf\u5c11\u653b\u51fb\u9762\u3002</li> <li>\u4f7f\u7528\u7279\u5b9a\u6807\u7b7e\u8986\u76d6\u955c\u50cf\u7684\u6700\u65b0\u6807\u7b7e\uff0c\u4ee5\u907f\u514d\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u53d1\u751f\u91cd\u5927\u53d8\u5316\u3002</li> <li>\u5f53\u521b\u5efa\u591a\u4e2a\u7f13\u5b58\u7684\u5c42\u65f6\uff0c\u5b83\u901a\u5e38\u4f1a\u5f71\u54cd\u5230\u6784\u5efa\u8fc7\u7a0b\u7684\u6548\u7387\uff0c\u6240\u4ee5\u5e94\u907f\u514d\u4f7f\u7528\u591a\u4e2a RUN \u547d\u4ee4\u3002</li> <li>\u6c38\u8fdc\u4e0d\u8981\u5f80\u4f60\u7684 Dockerfile \u4e2d\u5171\u4eab\u548c\u62f7\u8d1d\u5e94\u7528\u7a0b\u5e8f\u7684\u51ed\u8bc1\u6216\u8005\u4efb\u4f55\u654f\u611f\u7684\u4fe1\u606f\u3002\u5982\u679c\u4f60\u4f7f\u7528\u4e86\u5b83\uff0c\u8bf7\u5c06\u5176\u6dfb\u52a0\u5b83\u5230 .dockerignore\u3002</li> <li>\u5c3d\u53ef\u80fd\u5728\u672b\u5c3e\u4e2d\u4f7f\u7528 EXPOSE \u548c ENV \u547d\u4ee4\u3002</li> <li>\u4f7f\u7528\u4e00\u4e2a linter: \u4f7f\u7528\u4e00\u4e2a\u50cf hadolint \u7684 linter \u53bb\u68c0\u67e5\u4f60\u7684 Dockerfile\uff0c\u8fd9\u662f\u4e3a\u4e86\u5e38\u89c1\u7684\u95ee\u9898\u548c\u6700\u597d\u7684\u5b9e\u8df5\u3002</li> <li>\u6bcf\u4e00\u4e2a\u5bb9\u5668\u53ea\u4f7f\u7528\u4e00\u4e2a\u5355\u72ec\u8fdb\u7a0b: \u6bcf\u4e00\u4e2a\u5bb9\u5668\u5e94\u8be5\u53ea\u8fd0\u884c\u4e00\u4e2a\u5355\u72ec\u7684\u8fdb\u7a0b\u3002\u8fd9\u662f\u4e3a\u4e86\u8ba9\u5b83\u66f4\u5bb9\u6613\u53bb\u7ba1\u7406\u548c\u76d1\u63a7\u5bb9\u5668\uff0c\u8fd8\u6709\u5e2e\u52a9\u6211\u4eec\u4fdd\u6301\u5bb9\u5668\u662f\u8f7b\u91cf\u7684\u3002</li> <li>\u4f7f\u7528\u591a\u9636\u6bb5\u6784\u5efa\uff1a\u4f7f\u7528\u591a\u9636\u6bb5\u6784\u5efa\u53bb\u521b\u5efa\u66f4\u5c0f\u548c\u66f4\u6709\u6548\u7387\u7684\u955c\u50cf\u3002</li> </ol>"},{"location":"2025/2docker/#docker_1","title":"\u6f5c\u5728\u7684 Docker \u6784\u5efa\u95ee\u9898","text":"<ol> <li>\u5982\u679c\u5728 Dockerfile \u91cc\u9762\u6709\u4e00\u4e2a\u8bed\u6cd5\u9519\u8bef\u6216\u8005\u4e00\u4e2a\u65e0\u6548\u7684\u53c2\u6570\uff0cDocker build \u547d\u4ee4\u5c06\u4f1a\u6709\u4e00\u4e2a\u9519\u8bef\u4fe1\u606f\u7684\u5931\u8d25\u3002\u53ef\u4ee5\u68c0\u67e5\u8bed\u6cd5\u53bb\u89e3\u51b3\u8fd9\u4e2a\u3002</li> <li>\u59cb\u7ec8\u5c1d\u8bd5\u4f7f\u7528 docker run \u547d\u4ee4\u4e3a\u5bb9\u5668\u547d\u540d\u3002\u5982\u679c\u4e0d\u6307\u5b9a\u540d\u79f0\uff0cDocker \u4f1a\u81ea\u52a8\u5206\u914d\u4e00\u4e2a\u968f\u673a\u540d\u79f0\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u95ee\u9898\u3002</li> <li>\u7aef\u53e3\u51b2\u7a81\u95ee\u9898\uff1a\u6709\u65f6\u4f1a\u9047\u5230\u7c7b\u4f3c Bind for 0.0.0.0:8080 failed: port is already allocated \u7684\u9519\u8bef\uff0c\u8fd9\u662f\u56e0\u4e3a\u5176\u4ed6\u8f6f\u4ef6\u6216\u670d\u52a1\u6b63\u5728\u4f7f\u7528\u8be5\u7aef\u53e3\u3002\u53ef\u4ee5\u901a\u8fc7 netstat \u6216 ss \u547d\u4ee4\u68c0\u67e5\u7aef\u53e3\u5360\u7528\u60c5\u51b5\uff0c\u7136\u540e\u9009\u62e9\u4f7f\u7528\u5176\u4ed6\u7aef\u53e3\u6216\u505c\u6b62\u5360\u7528\u7aef\u53e3\u7684\u670d\u52a1\u6765\u89e3\u51b3\u6b64\u95ee\u9898\u3002</li> <li>\u4f9d\u8d56\u5305\u4e0b\u8f7d\u5931\u8d25\uff1a\u6709\u65f6 Docker \u4f1a\u62a5\u9519 Failed to download package [package-name]\uff0c\u8fd9\u901a\u5e38\u662f\u56e0\u4e3a\u5bb9\u5668\u65e0\u6cd5\u8bbf\u95ee\u4e92\u8054\u7f51\u6216\u5b58\u5728\u5176\u4ed6\u4f9d\u8d56\u95ee\u9898</li> </ol>"},{"location":"2025/2docker/#docker-image-vs-containers","title":"Docker Image vs. Containers","text":"<p>Docker \u955c\u50cf\u662f\u6587\u4ef6\u7cfb\u7edf\u548c\u5e94\u7528\u4f9d\u8d56\u7684\u5feb\u7167\u3002</p> <p>\u5b83\u662f\u4e00\u4e2a\u53ef\u6267\u884c\u7684\u8f6f\u4ef6\u5305\uff0c\u5305\u542b\u4e86\u8fd0\u884c\u5e94\u7528\u6240\u9700\u7684\u4e00\u5207\uff0c\u6bd4\u5982\u5e94\u7528\u4ee3\u7801\u3001\u5e93\u3001\u5de5\u5177\u3001\u4f9d\u8d56\u9879\u548c\u5176\u4ed6\u6587\u4ef6\u3002\u4f60\u53ef\u4ee5\u5c06\u5176\u7c7b\u6bd4\u4e3a\u865a\u62df\u673a\u7684\u9ec4\u91d1\u955c\u50cf\u3002</p> <p>Docker \u955c\u50cf\u4ee5\u5806\u53e0\u5728\u4e00\u8d77\u7684\u53ea\u8bfb\u5c42\u5f62\u5f0f\u7ec4\u7ec7\u3002</p> <p>Docker \u5bb9\u5668\u662f Docker \u955c\u50cf\u7684\u8fd0\u884c\u5b9e\u4f8b\u3002\u5c31\u50cf\u4ece\u865a\u62df\u673a\u955c\u50cf\u521b\u5efa\u865a\u62df\u673a\u4e00\u6837\uff0c\u6211\u4eec\u4ece\u5bb9\u5668\u955c\u50cf\u521b\u5efa\u5bb9\u5668\u3002\u5f53\u4f60\u4ece Docker \u955c\u50cf\u521b\u5efa\u5bb9\u5668\u65f6\uff0c\u4f1a\u5728\u73b0\u6709\u955c\u50cf\u5c42\u4e4b\u4e0a\u521b\u5efa\u4e00\u4e2a\u53ef\u5199\u5c42\u3002</p> <p>Docker \u955c\u50cf\u548c\u5bb9\u5668\u4e4b\u95f4\u7684\u4e3b\u8981\u533a\u522b\u5728\u4e8e\u5bb9\u5668\u9876\u90e8\u7684\u53ef\u5199\u5c42\u3002\u8fd9\u610f\u5473\u7740\uff0c\u5982\u679c\u4f60\u4ece\u4e00\u4e2a\u955c\u50cf\u8fd0\u884c\u4e86\u4e94\u4e2a\u5bb9\u5668\uff0c\u6240\u6709\u5bb9\u5668\u90fd\u4f1a\u5171\u4eab\u955c\u50cf\u4e2d\u7684\u76f8\u540c\u53ea\u8bfb\u5c42\uff0c\u800c\u9876\u90e8\u7684\u53ef\u5199\u5c42\u5bf9\u6bcf\u4e2a\u5bb9\u5668\u6765\u8bf4\u662f\u72ec\u7acb\u7684\u3002</p> <p>\u955c\u50cf\u53ef\u4ee5\u72ec\u7acb\u4e8e\u5bb9\u5668\u5b58\u5728\uff0c\u800c\u5bb9\u5668\u9700\u8981\u955c\u50cf\u624d\u80fd\u8fd0\u884c\u3002\u6211\u4eec\u53ef\u4ee5\u4ece\u540c\u4e00\u4e2a\u955c\u50cf\u521b\u5efa\u591a\u4e2a\u5bb9\u5668\uff0c\u6bcf\u4e2a\u5bb9\u5668\u90fd\u6709\u81ea\u5df1\u72ec\u7acb\u7684\u6570\u636e\u548c\u72b6\u6001\u3002</p> <p></p>"},{"location":"2025/3kubernetes/","title":"Kubernetes \u9762\u8bd5\u9898\u7cbe\u89e3\uff1a\u4ece\u5165\u95e8\u5230\u8fdb\u9636(2025) - \u5fc5\u770b","text":""},{"location":"2025/3kubernetes/#1-kubernetes","title":"1 Kubernetes \u9762\u8bd5\u9898\u7cbe\u89e3\uff1a\u4ece\u5165\u95e8\u5230\u8fdb\u9636","text":"<p>Kubernetes \u4e2d\u7684 Pod \u662f\u6700\u5c0f\u7684\u8c03\u5ea6\u5355\u5143\uff0c\u901a\u5e38\u7528\u4e8e\u8fd0\u884c\u4e00\u4e2a\u6216\u591a\u4e2a\u5bb9\u5668\u3002Pod \u7684\u521b\u5efa\u548c\u9500\u6bc1\u662f Kubernetes \u96c6\u7fa4\u4e2d\u91cd\u8981\u7684\u64cd\u4f5c\uff0c\u6d89\u53ca\u5230\u591a\u4e2a\u7ec4\u4ef6\u7684\u4ea4\u4e92\u548c\u72b6\u6001\u53d8\u66f4\u3002\u4e0b\u9762\u662f\u5bf9 Pod \u521b\u5efa \u548c Pod \u9500\u6bc1 \u8fc7\u7a0b\u7684\u8be6\u7ec6\u63cf\u8ff0</p>"},{"location":"2025/3kubernetes/#1-pod","title":"1. Pod\u7684\u521b\u5efa\u8fc7\u7a0b","text":""},{"location":"2025/3kubernetes/#1-kubectlapi","title":"\u6b65\u9aa41\uff1a\u7528\u6237\u63d0\u4ea4\u8bf7\u6c42 (kubectl\u6216API)","text":"<ul> <li>\u7528\u6237\u901a\u8fc7 kubectl \u6216\u8005\u76f4\u63a5\u901a\u8fc7 Kubernetes API \u63d0\u4ea4\u521b\u5efa Pod \u7684\u8bf7\u6c42\u3002\u8fd9\u901a\u5e38\u662f\u901a\u8fc7 kubectl run\u3001kubectl apply \u7b49\u547d\u4ee4\uff0c\u6216\u8005\u901a\u8fc7\u7f16\u5199\u4e00\u4e2a YAML \u6587\u4ef6\u63cf\u8ff0 Pod \u7684\u914d\u7f6e\u5e76\u5c06\u5176\u63d0\u4ea4\u5230\u96c6\u7fa4\u3002</li> <li>\u8bf7\u6c42\u5305\u542b Pod \u7684\u914d\u7f6e\uff0c\u901a\u5e38\u5305\u62ec\u5bb9\u5668\u7684\u955c\u50cf\u3001\u8d44\u6e90\u9650\u5236\u3001\u73af\u5883\u53d8\u91cf\u3001\u5377\u3001\u7aef\u53e3\u7b49\u4fe1\u606f</li> </ul>"},{"location":"2025/3kubernetes/#2-apiserver","title":"2. APIServer\u5904\u7406\u8bf7\u6c42","text":"<p>Kubernetes \u7684 API Server \u662f\u6574\u4e2a\u96c6\u7fa4\u7684\u63a5\u53e3\uff0c\u5904\u7406\u6240\u6709\u7684 HTTP \u8bf7\u6c42\u3002\u6536\u5230 Pod \u521b\u5efa\u8bf7\u6c42\u540e\uff0cAPI Server \u4f1a\u5bf9\u8bf7\u6c42\u8fdb\u884c\u9a8c\u8bc1\u548c\u6388\u6743\uff08\u57fa\u4e8e RBAC \u548c\u5176\u4ed6\u7b56\u7565\uff09</p> <ul> <li>\u9a8c\u8bc1\uff1a\u68c0\u67e5\u8bf7\u6c42\u662f\u5426\u7b26\u5408 Kubernetes \u7684 API \u89c4\u8303\uff08\u4f8b\u5982\uff0cPod \u914d\u7f6e\u7684\u8bed\u6cd5\u3001\u5b57\u6bb5\u662f\u5426\u6b63\u786e\u7b49\uff09\u3002</li> <li>\u6388\u6743\uff1a\u786e\u4fdd\u53d1\u8d77\u8bf7\u6c42\u7684\u7528\u6237\u6709\u8db3\u591f\u7684\u6743\u9650\u6765\u521b\u5efa Pod\u3002</li> </ul> <p>\u5982\u679c\u8bf7\u6c42\u901a\u8fc7\u9a8c\u8bc1\u548c\u6388\u6743\uff0cAPI Server \u4f1a\u5c06 Pod \u914d\u7f6e\u4fdd\u5b58\u5230 Etcd \u4e2d\u3002Etcd \u662f\u4e00\u4e2a\u5f3a\u4e00\u81f4\u6027\u7684\u6570\u636e\u5e93\uff0c\u7528\u4e8e\u5b58\u50a8 Kubernetes \u96c6\u7fa4\u7684\u6240\u6709\u72b6\u6001\u4fe1\u606f</p>"},{"location":"2025/3kubernetes/#3-scheduler","title":"\u6b65\u9aa43\uff1a\u8c03\u5ea6\u5668\u9009\u62e9\u8282\u70b9 (Scheduler)","text":"<p>Kubernetes Scheduler \u4f1a\u76d1\u63a7 Etcd \u4e2d\u7684 Pod \u72b6\u6001\uff0c\u5e76\u9009\u62e9\u9002\u5408\u7684\u8282\u70b9\u6765\u8fd0\u884c\u8be5 Pod\u3002\u8c03\u5ea6\u5668\u4f1a\u6839\u636e\u4ee5\u4e0b\u56e0\u7d20\u505a\u51fa\u51b3\u7b56</p> <ul> <li>\u8d44\u6e90\u8bf7\u6c42\uff1aPod \u8bf7\u6c42\u7684 CPU \u548c\u5185\u5b58\u8d44\u6e90\u3002</li> <li>\u8282\u70b9\u8d44\u6e90\uff1a\u8282\u70b9\u7684\u5f53\u524d\u8d1f\u8f7d\u548c\u53ef\u7528\u8d44\u6e90\u3002</li> <li>\u4eb2\u548c\u6027/\u53cd\u4eb2\u548c\u6027\uff1aPod \u5bf9\u8282\u70b9\u7684\u4eb2\u548c\u6027\u6216\u53cd\u4eb2\u548c\u6027\u89c4\u5219\uff08\u4f8b\u5982\uff0c\u67d0\u4e9b Pod \u5fc5\u987b\u4e00\u8d77\u8fd0\u884c\uff0c\u6216\u8005\u4e0d\u80fd\u4e0e\u5176\u4ed6 Pod \u4e00\u8d77\u8fd0\u884c\uff09\u3002</li> <li>\u6c61\u70b9\u548c\u5bb9\u5fcd\uff1a\u8282\u70b9\u662f\u5426\u6709\u6c61\u70b9\uff0c\u5e76\u4e14 Pod \u662f\u5426\u5bb9\u5fcd\u8fd9\u4e9b\u6c61\u70b9</li> </ul> <p>\u8c03\u5ea6\u5668\u9009\u62e9\u7684\u8282\u70b9\u4f1a\u66f4\u65b0 Pod \u7684\u914d\u7f6e\uff0c\u6307\u5b9a\u8be5 Pod \u5c06\u8fd0\u884c\u5728\u9009\u5b9a\u7684\u8282\u70b9\u4e0a\u3002</p>"},{"location":"2025/3kubernetes/#4kubelet","title":"\u6b65\u9aa44\uff1aKubelet\u542f\u52a8\u5bb9\u5668","text":"<p>Kubelet \u662f\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7684\u4ee3\u7406\uff0c\u5b83\u8d1f\u8d23\u786e\u4fdd\u5bb9\u5668\u5728\u8282\u70b9\u4e0a\u8fd0\u884c\u3002\u5f53\u8c03\u5ea6\u5668\u786e\u5b9a Pod \u5c06\u8fd0\u884c\u5728\u67d0\u4e2a\u8282\u70b9\u4e0a\u65f6\uff0cKubelet \u4f1a\u63a5\u6536\u5230\u8be5\u8282\u70b9\u4e0a Pod \u7684\u4fe1\u606f</p> <p>Kubelet \u4f1a\u6839\u636e Pod \u914d\u7f6e\u542f\u52a8\u5bb9\u5668\uff0c\u786e\u4fdd\u5bb9\u5668\u6309\u9884\u671f\u542f\u52a8\u3002\u5b83\u4f1a\uff1a</p> <ul> <li>\u4e0b\u8f7d\u6240\u9700\u7684\u5bb9\u5668\u955c\u50cf\uff08\u5982\u679c\u955c\u50cf\u4e0d\u5b58\u5728\u4e8e\u8282\u70b9\u4e0a\uff09\u3002</li> <li>\u6839\u636e Pod \u914d\u7f6e\u542f\u52a8\u5bb9\u5668\u3002</li> <li>\u5982\u679c\u4f7f\u7528\u4e86\u5377\uff0cKubelet \u4f1a\u6302\u8f7d\u76f8\u5e94\u7684\u5b58\u50a8\u8d44\u6e90\u5230\u5bb9\u5668\u4e2d\u3002</li> </ul> <p>Kubelet \u542f\u52a8\u5bb9\u5668\u540e\uff0c\u5bb9\u5668\u8fd0\u884c\u7684\u72b6\u6001\u4f1a\u5b9a\u671f\u62a5\u544a\u7ed9 API Server\uff0c\u786e\u4fdd Pod \u7684\u72b6\u6001\u662f\u5065\u5eb7\u7684\u3002</p>"},{"location":"2025/3kubernetes/#5","title":"\u6b65\u9aa45\uff1a\u670d\u52a1\u53d1\u73b0\u548c\u7f51\u7edc\u914d\u7f6e","text":"<ul> <li>Kube Proxy \u4f1a\u4e3a Pod \u914d\u7f6e\u7f51\u7edc\u89c4\u5219\uff0c\u786e\u4fdd\u670d\u52a1\u80fd\u591f\u627e\u5230\u8fd9\u4e2a Pod\u3002</li> <li>\u5982\u679c Pod \u662f\u901a\u8fc7 Service \u66b4\u9732\u7684\uff0cKube Proxy \u4f1a\u66f4\u65b0 Service \u7684\u540e\u7aef\u5217\u8868\uff0c\u5305\u542b\u65b0\u521b\u5efa\u7684 Pod\u3002</li> <li>Kubernetes \u7684 DNS \u670d\u52a1\u4f1a\u4e3a Pod \u5206\u914d\u4e00\u4e2a DNS \u540d\u79f0\uff0c\u4f7f\u5176\u53ef\u4ee5\u901a\u8fc7 DNS \u89e3\u6790\u8bbf\u95ee\u3002</li> </ul>"},{"location":"2025/3kubernetes/#6pod","title":"\u6b65\u9aa46\uff1aPod\u72b6\u6001\u66f4\u65b0","text":"<p>\u5728 Pod \u88ab\u6210\u529f\u8c03\u5ea6\u5e76\u542f\u52a8\u540e\uff0cKubernetes API Server \u4f1a\u5c06 Pod \u7684\u72b6\u6001\u66f4\u65b0\u4e3a Running\uff0c\u5e76\u5c06\u72b6\u6001\u4fe1\u606f\u4fdd\u5b58\u5728 Etcd \u4e2d\u3002Pod \u7684 IP \u5730\u5740\u548c\u5176\u4ed6\u5143\u6570\u636e\u4e5f\u4f1a\u5728\u8fd9\u4e2a\u9636\u6bb5\u66f4\u65b0\u3002</p>"},{"location":"2025/3kubernetes/#2pod","title":"2.Pod\u9500\u6bc1\u8fc7\u7a0b","text":""},{"location":"2025/3kubernetes/#1","title":"\u6b65\u9aa41\uff1a\u7528\u6237\u6216\u63a7\u5236\u5668\u53d1\u8d77\u5220\u9664\u8bf7\u6c42","text":"<ul> <li>Pod \u7684\u9500\u6bc1\u901a\u5e38\u7531\u7528\u6237\u901a\u8fc7 <code>kubectl delete pod &lt;pod_name&gt;</code> \u547d\u4ee4\uff0c\u6216\u8005\u7531\u63a7\u5236\u5668\uff08\u5982 Deployment\u3001StatefulSet \u7b49\uff09\u53d1\u8d77\u3002</li> <li>\u5f53\u63a7\u5236\u5668\u7684\u671f\u671b\u72b6\u6001\u4e0e\u5b9e\u9645\u72b6\u6001\u4e0d\u4e00\u81f4\u65f6\uff0c\u63a7\u5236\u5668\u4f1a\u53d1\u8d77\u5220\u9664 Pod \u7684\u8bf7\u6c42\u3002\u6bd4\u5982\uff0cDeployment \u4e2d\u7684 Pod \u526f\u672c\u6570\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u63a7\u5236\u5668\u4f1a\u5220\u9664\u4e0d\u9700\u8981\u7684 Pod</li> </ul>"},{"location":"2025/3kubernetes/#2-apiserver_1","title":"2 APIServer \u5904\u7406\u5220\u9664\u8bf7\u6c42","text":"<ul> <li>API Server \u63a5\u6536\u5230\u5220\u9664\u8bf7\u6c42\u540e\uff0c\u9996\u5148\u4f1a\u9a8c\u8bc1\u8bf7\u6c42\u7684\u5408\u6cd5\u6027\u3002</li> <li>API Server \u4f1a\u5c06\u5220\u9664\u8bf7\u6c42\u7684\u72b6\u6001\u4fdd\u5b58\u5230 Etcd \u4e2d\uff0c\u66f4\u65b0 Pod \u7684\u72b6\u6001\u4e3a Terminating\u3002</li> </ul>"},{"location":"2025/3kubernetes/#3-kubelet","title":"3 Kubelet \u505c\u6b62\u670d\u52a1","text":"<p>Kubelet \u53d1\u73b0 Pod \u88ab\u6807\u8bb0\u4e3a Terminating \u540e\uff0c\u4f1a\u542f\u52a8\u5bb9\u5668\u7684\u7ec8\u6b62\u8fc7\u7a0b\u3002Kubelet \u4f1a\uff1a</p> <ul> <li>\u53d1\u9001\u7ec8\u6b62\u4fe1\u53f7\uff08\u5982 SIGTERM\uff09\u7ed9 Pod \u4e2d\u7684\u5bb9\u5668\u3002</li> <li>\u7b49\u5f85\u4e00\u5b9a\u7684\u65f6\u95f4\uff08Grace Period\uff09\uff0c\u5141\u8bb8\u5bb9\u5668\u4f18\u96c5\u5730\u5173\u95ed\u3002</li> <li>\u5982\u679c\u5bb9\u5668\u6ca1\u6709\u5728\u89c4\u5b9a\u65f6\u95f4\u5185\u9000\u51fa\uff0cKubelet \u4f1a\u53d1\u9001\u5f3a\u5236\u7ec8\u6b62\u4fe1\u53f7\uff08\u5982 SIGKILL\uff09\u3002</li> </ul>"},{"location":"2025/3kubernetes/#4","title":"4 \u6e05\u7406\u5bb9\u5668\u8d44\u6e90","text":"<p>Kubelet \u4f1a\u6e05\u7406\u5bb9\u5668\u548c\u4e0e Pod \u76f8\u5173\u7684\u8d44\u6e90\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>\u5220\u9664\u5bb9\u5668\u7684\u8fd0\u884c\u65f6\u8d44\u6e90\u3002</li> <li>\u5982\u679c Pod \u4f7f\u7528\u4e86\u5377\uff0cKubelet \u4f1a\u91ca\u653e\u548c\u5378\u8f7d\u5377\u8d44\u6e90\u3002</li> <li>\u5220\u9664\u5bb9\u5668\u7f51\u7edc\u8bbe\u7f6e\u3002</li> </ul>"},{"location":"2025/3kubernetes/#5-kubernetes","title":"5 Kubernetes\u96c6\u7fa4\u72b6\u6001\u66f4\u65b0","text":"<ul> <li>Kubernetes API Server \u4f1a\u66f4\u65b0 Pod \u7684\u72b6\u6001\u4e3a Deleted\uff0c\u5e76\u4ece Etcd \u4e2d\u5220\u9664 Pod \u7684\u76f8\u5173\u6570\u636e\u3002</li> <li>\u5982\u679c Pod \u662f\u7531\u63a7\u5236\u5668\uff08\u5982 Deployment\uff09\u7ba1\u7406\u7684\uff0c\u63a7\u5236\u5668\u4f1a\u6839\u636e\u65b0\u7684\u72b6\u6001\u542f\u52a8\u65b0\u7684 Pod\uff0c\u4ee5\u7ef4\u6301\u671f\u671b\u7684\u526f\u672c\u6570\u3002</li> </ul>"},{"location":"2025/3kubernetes/#6","title":"6\uff1a\u6e05\u7406\u7f51\u7edc\u8d44\u6e90","text":"<p>Kube Proxy \u4f1a\u66f4\u65b0\u670d\u52a1\u7684\u540e\u7aef\u5217\u8868\uff0c\u79fb\u9664\u5df2\u5220\u9664 Pod \u7684 IP \u5730\u5740\uff0c\u786e\u4fdd\u6d41\u91cf\u4e0d\u518d\u8def\u7531\u5230\u8be5 Pod\u3002</p> <ul> <li>Pod \u521b\u5efa\u8fc7\u7a0b\uff1a\u4ece\u7528\u6237\u63d0\u4ea4\u8bf7\u6c42\u5230 API Server\uff0c\u518d\u5230\u8c03\u5ea6\u5668\u9009\u62e9\u8282\u70b9\uff0cKubelet \u542f\u52a8\u5bb9\u5668\uff0c\u6700\u540e\u66f4\u65b0\u72b6\u6001\u5e76\u66b4\u9732\u670d\u52a1\u3002</li> <li>Pod \u9500\u6bc1\u8fc7\u7a0b\uff1a\u4ece\u7528\u6237\u6216\u63a7\u5236\u5668\u53d1\u8d77\u5220\u9664\u8bf7\u6c42\uff0c\u5230 API Server \u6807\u8bb0 Pod \u4e3a Terminating\uff0cKubelet \u4f18\u96c5\u5730\u7ec8\u6b62\u5bb9\u5668\uff0c\u6700\u7ec8\u6e05\u7406\u8d44\u6e90\u5e76\u66f4\u65b0\u72b6\u6001\u3002</li> </ul>"},{"location":"2025/3kubernetes/#2-kubernetes","title":"2 Kubernetes \u7684\u7cbe\u901a","text":""},{"location":"2025/3kubernetes/#2-1-kbernetes","title":"2-1 Kbernetes\u67b6\u6784\uff1a","text":"<ul> <li>Kubernetes \u6838\u5fc3\u7ec4\u4ef6\uff1a\u5982 API Server\u3001Scheduler\u3001Controller Manager\u3001Kubelet\u3001Kube Proxy \u7b49\u7684\u5de5\u4f5c\u539f\u7406\u548c\u4ea4\u4e92\u65b9\u5f0f\u3002</li> <li>Pod\u3001Deployment\u3001ReplicaSet\u3001StatefulSet\u3001DaemonSet\u3001Job\u3001CronJob \u7b49 Kubernetes \u8d44\u6e90\u5bf9\u8c61\u7684\u8be6\u7ec6\u7406\u89e3\uff0c\u5e76\u80fd\u5408\u7406\u9009\u62e9\u4f7f\u7528\u573a\u666f\u3002</li> <li>Master \u8282\u70b9\u548c Worker \u8282\u70b9\u7684\u89d2\u8272\u548c\u529f\u80fd\uff0c\u5982\u4f55\u7ba1\u7406\u548c\u8c03\u5ea6\u5bb9\u5668\u5316\u5e94\u7528</li> </ul>"},{"location":"2025/3kubernetes/#2-2","title":"2-2 \u5bb9\u5668\u5316\u5e94\u7528\u7684\u90e8\u7f72\u4e0e\u7ba1\u7406","text":"<ul> <li>\u9ad8\u6548\u7684\u5e94\u7528\u90e8\u7f72\uff1a\u80fd\u719f\u7ec3\u4f7f\u7528 Helm\u3001Kustomize \u7b49\u5de5\u5177\uff0c\u7b80\u5316\u548c\u81ea\u52a8\u5316 Kubernetes \u4e0a\u7684\u5e94\u7528\u90e8\u7f72\u3002</li> <li>\u6eda\u52a8\u66f4\u65b0\u4e0e\u56de\u6eda\uff1a\u80fd\u591f\u5728 Kubernetes \u4e2d\u5b9e\u73b0\u65e0\u505c\u673a\u66f4\u65b0\uff0c\u5e76\u80fd\u5feb\u901f\u5e94\u5bf9\u6545\u969c\u8fdb\u884c\u56de\u6eda\u3002</li> <li>\u591a\u73af\u5883\u7ba1\u7406\uff1a\u719f\u6089\u5982\u4f55\u5728\u4e0d\u540c\u7684\u73af\u5883\u4e2d\uff08\u5982\u5f00\u53d1\u3001\u6d4b\u8bd5\u3001\u751f\u4ea7\uff09\u7ba1\u7406\u548c\u914d\u7f6e Kubernetes \u96c6\u7fa4\u3002</li> </ul>"},{"location":"2025/3kubernetes/#2-3","title":"2-3.\u670d\u52a1\u53d1\u73b0\u4e0e\u8d1f\u8f7d\u5747\u8861","text":"<ul> <li>\u5185\u90e8\u548c\u5916\u90e8\u670d\u52a1\u66b4\u9732\uff1a\u719f\u7ec3\u4f7f\u7528 Kubernetes \u7684 Service \u8d44\u6e90\uff0c\u652f\u6301\u8d1f\u8f7d\u5747\u8861\u3001DNS \u89e3\u6790\u548c\u7aef\u53e3\u6620\u5c04\u3002</li> <li>Ingress \u63a7\u5236\u5668\uff1a\u80fd\u591f\u914d\u7f6e\u548c\u7ba1\u7406 Ingress \u63a7\u5236\u5668\uff0c\u63a7\u5236\u5916\u90e8\u6d41\u91cf\u7684\u8bbf\u95ee\u3002</li> <li>Service Mesh\uff08\u5982 Istio\uff09\uff1a\u7406\u89e3\u5e76\u80fd\u5e94\u7528 Service Mesh \u5b9e\u73b0\u5fae\u670d\u52a1\u95f4\u7684\u901a\u4fe1\u3001\u76d1\u63a7\u548c\u5b89\u5168\u6027\u63a7\u5236</li> </ul>"},{"location":"2025/3kubernetes/#2-4","title":"2-4. \u5b58\u50a8\u4e0e\u6301\u4e45\u5316","text":"<ul> <li>Volume \u548c Persistent Volume (PV)\uff1a\u7406\u89e3 Kubernetes \u4e2d\u7684\u5b58\u50a8\u4f53\u7cfb\uff0c\u80fd\u591f\u6839\u636e\u5e94\u7528\u7684\u9700\u8981\u9009\u62e9\u5408\u9002\u7684\u5b58\u50a8\u7c7b\u578b\uff08\u5982 NFS\u3001GlusterFS\u3001Ceph\u3001\u4e91\u5b58\u50a8\u7b49\uff09\u3002</li> <li>StatefulSet \u4e0e\u6301\u4e45\u5316\u5b58\u50a8\uff1a\u80fd\u591f\u6709\u6548\u5730\u4e3a\u6709\u72b6\u6001\u7684\u5e94\u7528\uff08\u5982\u6570\u636e\u5e93\uff09\u914d\u7f6e\u6301\u4e45\u5316\u5b58\u50a8\u3002</li> <li>StorageClass \u548c\u52a8\u6001\u4f9b\u5e94\uff1a\u4f7f\u7528 StorageClass \u914d\u7f6e\u52a8\u6001\u5377\u4f9b\u5e94\uff0c\u6ee1\u8db3\u9ad8\u6548\u3001\u7075\u6d3b\u7684\u5b58\u50a8\u9700\u6c42</li> </ul>"},{"location":"2025/3kubernetes/#2-5","title":"2-5.\u5b89\u5168\u6027\u7ba1\u7406\uff1a","text":"<ul> <li>RBAC\uff08\u89d2\u8272\u548c\u6743\u9650\u63a7\u5236\uff09\uff1a\u719f\u7ec3\u4f7f\u7528 Kubernetes \u7684\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236\uff08RBAC\uff09\u6765\u63a7\u5236\u96c6\u7fa4\u8bbf\u95ee\u6743\u9650\u3002</li> <li>NetworkPolicy\uff1a\u80fd\u591f\u4e3a\u4e0d\u540c\u7684 Pod \u548c\u670d\u52a1\u914d\u7f6e\u7f51\u7edc\u7b56\u7565\uff0c\u4fdd\u8bc1\u96c6\u7fa4\u5185\u5916\u7684\u5b89\u5168\u6027\u3002</li> <li>\u5bc6\u94a5\u548c\u51ed\u8bc1\u7ba1\u7406\uff1a\u4f7f\u7528 Kubernetes Secret \u7ba1\u7406\u654f\u611f\u4fe1\u606f\uff0c\u786e\u4fdd\u5e94\u7528\u7684\u5b89\u5168\u914d\u7f6e\u3002</li> </ul>"},{"location":"2025/3kubernetes/#2-6","title":"2-6.\u96c6\u7fa4\u76d1\u63a7\u4e0e\u65e5\u5fd7\u7ba1\u7406","text":"<ul> <li>\u76d1\u63a7\u7cfb\u7edf\uff1a\u719f\u7ec3\u4f7f\u7528 Prometheus\u3001Grafana \u7b49\u5de5\u5177\u5bf9\u96c6\u7fa4\u548c\u5e94\u7528\u8fdb\u884c\u5b9e\u65f6\u76d1\u63a7\uff0c\u8bbe\u7f6e\u544a\u8b66\u673a\u5236\u3002</li> <li>\u65e5\u5fd7\u7ba1\u7406\uff1a\u4f7f\u7528 ELK Stack\u3001Fluentd\u3001EFK \u7b49\u65e5\u5fd7\u6536\u96c6\u548c\u5206\u6790\u5de5\u5177\u8fdb\u884c\u96c6\u7fa4\u65e5\u5fd7\u7ba1\u7406\u548c\u6545\u969c\u6392\u67e5\u3002</li> </ul>"},{"location":"2025/3kubernetes/#2-7","title":"2-7 \u6027\u80fd\u4f18\u5316\u4e0e\u6545\u969c\u6392\u9664\uff1a","text":"<ul> <li>\u6027\u80fd\u8c03\u4f18\uff1a\u80fd\u591f\u6839\u636e\u5de5\u4f5c\u8d1f\u8f7d\u7684\u9700\u6c42\u4f18\u5316\u96c6\u7fa4\u8d44\u6e90\u914d\u7f6e\uff0c\u5982\u5408\u7406\u8bbe\u7f6e CPU \u548c\u5185\u5b58\u8d44\u6e90\u8bf7\u6c42\u4e0e\u9650\u5236\u3002</li> <li>\u6545\u969c\u6392\u67e5\uff1a\u80fd\u591f\u901a\u8fc7 kubectl \u547d\u4ee4\u3001\u65e5\u5fd7\u3001\u76d1\u63a7\u5de5\u5177\u548c\u4e8b\u4ef6\u5206\u6790\uff0c\u8fc5\u901f\u8bca\u65ad\u548c\u89e3\u51b3\u96c6\u7fa4\u4e2d\u7684\u5404\u79cd\u95ee\u9898\u3002</li> <li>\u96c6\u7fa4\u9ad8\u53ef\u7528\u6027\u548c\u707e\u96be\u6062\u590d\uff1a\u80fd\u591f\u914d\u7f6e\u548c\u7ba1\u7406\u9ad8\u53ef\u7528\u7684 Kubernetes \u96c6\u7fa4\uff0c\u786e\u4fdd\u96c6\u7fa4\u5728\u9762\u4e34\u5355\u70b9\u6545\u969c\u65f6\u4ecd\u80fd\u7a33\u5b9a\u8fd0\u884c\u3002</li> </ul>"},{"location":"2025/3kubernetes/#2-8","title":"2-8.\u81ea\u5b9a\u4e49\u4e0e\u6269\u5c55\uff1a","text":"<ul> <li>\u81ea\u5b9a\u4e49\u8d44\u6e90\u548c\u63a7\u5236\u5668\uff1a\u80fd\u591f\u4f7f\u7528 CRD\uff08Custom Resource Definition\uff09\u6269\u5c55 Kubernetes\uff0c\u521b\u5efa\u548c\u7ba1\u7406\u81ea\u5b9a\u4e49\u8d44\u6e90\u5bf9\u8c61\u3002</li> <li>Operator \u6a21\u5f0f\uff1a\u7406\u89e3\u5e76\u80fd\u5b9e\u73b0 Kubernetes Operator\uff0c\u4ee5\u81ea\u52a8\u5316\u7ba1\u7406\u590d\u6742\u7684\u3001\u6709\u72b6\u6001\u7684\u5e94\u7528</li> </ul>"},{"location":"2025/3kubernetes/#2-9cicd","title":"2-9.CI/CD\u96c6\u6210\u4e0e\u81ea\u52a8\u5316\uff1a","text":"<ul> <li>\u96c6\u6210 Jenkins/GitLab CI/CD\uff1a\u80fd\u591f\u5c06 Kubernetes \u4e0e CI/CD \u5de5\u5177\u96c6\u6210\uff0c\u5b9e\u73b0\u81ea\u52a8\u5316\u6784\u5efa\u3001\u6d4b\u8bd5\u548c\u90e8\u7f72\u3002</li> <li>GitOps \u6d41\u7a0b\uff1a\u80fd\u591f\u4f7f\u7528 Argo CD\u3001Flux \u7b49\u5de5\u5177\u5b9e\u73b0\u57fa\u4e8e GitOps \u7684\u6301\u7eed\u4ea4\u4ed8\u3002</li> </ul>"},{"location":"2025/3kubernetes/#2-10","title":"2-10.\u591a\u96c6\u7fa4\u7ba1\u7406\u4e0e\u670d\u52a1\u7f51\u683c\uff1a","text":"<ul> <li>\u8de8\u96c6\u7fa4\u901a\u4fe1\u548c\u7ba1\u7406\uff1a\u4e86\u89e3\u5982\u4f55\u7ba1\u7406\u591a\u4e2a Kubernetes \u96c6\u7fa4\u4ee5\u53ca\u5b83\u4eec\u4e4b\u95f4\u7684\u670d\u52a1\u53d1\u73b0\u4e0e\u901a\u4fe1\u3002</li> <li>Service Mesh\uff1a\u719f\u7ec3\u4f7f\u7528 Service Mesh \u6280\u672f\uff08\u5982 Istio\uff09\u6765\u5904\u7406\u8de8\u670d\u52a1\u7684\u6d41\u91cf\u7ba1\u7406\u3001\u5b89\u5168\u63a7\u5236\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u95ee\u9898\u3002</li> </ul>"},{"location":"2025/3kubernetes/#3","title":"3 \u5bf9\u4e8e\u50cf\u5bb9\u5668\u4e4b\u7c7b\u7684\u670d\u52a1\uff0c\u51fa\u73b0\u4e86\u6545\u969c","text":"<p>\u4f60\u7684\u6392\u67e5\u601d\u8def\u662f\u4ec0\u4e48\u5462\uff1f</p>"},{"location":"2025/3kubernetes/#1_1","title":"1. \u68c0\u67e5\u5bb9\u5668\u72b6\u6001\u548c\u65e5\u5fd7","text":"<p>\u68c0\u67e5\u5bb9\u5668\u7684\u72b6\u6001\uff1a</p> <ul> <li>\u4f7f\u7528 docker ps\uff08\u5bf9\u4e8e Docker\uff09\u6216\u8005 kubectl get pods\uff08\u5bf9\u4e8e Kubernetes\uff09\u67e5\u770b\u5bb9\u5668\u6216 Pod \u662f\u5426\u5904\u4e8e\u6b63\u5e38\u8fd0\u884c\u72b6\u6001\u3002\u5982\u679c\u5bb9\u5668\u5904\u4e8e \"CrashLoopBackOff\" \u6216 \"Error\" \u72b6\u6001\uff0c\u53ef\u80fd\u662f\u5bb9\u5668\u542f\u52a8\u5931\u8d25\u6216\u5d29\u6e83\u3002</li> </ul> <p>\u67e5\u770b\u5bb9\u5668\u65e5\u5fd7\uff1a</p> <ul> <li>\u4f7f\u7528 docker logs \uff08Docker\uff09\u6216 kubectl logs \uff08Kubernetes\uff09\u67e5\u770b\u5bb9\u5668\u7684\u65e5\u5fd7\u8f93\u51fa\u3002\u8fd9\u901a\u5e38\u80fd\u63d0\u4f9b\u5173\u4e8e\u5bb9\u5668\u5185\u53d1\u751f\u9519\u8bef\u7684\u76f4\u63a5\u4fe1\u606f\uff0c\u5982\u5e94\u7528\u5d29\u6e83\u3001\u4f9d\u8d56\u7f3a\u5931\u7b49\u3002</li> </ul> <p>\u68c0\u67e5\u5e94\u7528\u65e5\u5fd7\uff1a</p> <ul> <li>\u5982\u679c\u5bb9\u5668\u5185\u8fd0\u884c\u7684\u662f\u5e94\u7528\u7a0b\u5e8f\uff0c\u67e5\u770b\u5e94\u7528\u7684\u65e5\u5fd7\uff0c\u4e86\u89e3\u662f\u5426\u6709\u4e1a\u52a1\u903b\u8f91\u9519\u8bef\u3001\u5f02\u5e38\u6216\u6570\u636e\u5e93\u8fde\u63a5\u95ee\u9898\u7b49</li> </ul>"},{"location":"2025/3kubernetes/#2","title":"2. \u8d44\u6e90\u95ee\u9898\u6392\u67e5","text":"<p>\u5185\u5b58\u548cCPU\u8d44\u6e90\uff1a</p> <p>\u5bb9\u5668\u5982\u679c\u56e0\u4e3a\u8d44\u6e90\u4e0d\u8db3\u800c\u5d29\u6e83\uff0c\u53ef\u4ee5\u4f7f\u7528 docker stats \u6216 kubectl top pod \u67e5\u770b\u8d44\u6e90\u7684\u4f7f\u7528\u60c5\u51b5\u3002\u5982\u679c\u53d1\u73b0\u67d0\u4e2a\u5bb9\u5668\u8d85\u51fa\u4e86\u5176\u8d44\u6e90\u9650\u5236\uff08\u5982 CPU \u6216\u5185\u5b58\uff09\uff0c\u5219\u9700\u8981\u589e\u52a0\u8d44\u6e90\u9650\u5236\u6216\u4f18\u5316\u5e94\u7528\u3002</p> <p>\u78c1\u76d8\u7a7a\u95f4\uff1a</p> <p>\u786e\u8ba4\u5bbf\u4e3b\u673a\u6216 Kubernetes \u8282\u70b9\u7684\u78c1\u76d8\u7a7a\u95f4\u662f\u5426\u8db3\u591f\uff0c\u7279\u522b\u662f /var/lib/docker \u6216\u8005\u7c7b\u4f3c\u5b58\u50a8\u5bb9\u5668\u955c\u50cf\u548c\u65e5\u5fd7\u7684\u8def\u5f84\uff0c\u7a7a\u95f4\u4e0d\u8db3\u53ef\u80fd\u5bfc\u81f4\u5bb9\u5668\u8fd0\u884c\u5931\u8d25</p>"},{"location":"2025/3kubernetes/#3_1","title":"3. \u7f51\u7edc\u95ee\u9898\u6392\u67e5","text":"<p>\u7f51\u7edc\u8fde\u63a5\uff1a</p> <p>\u68c0\u67e5\u5bb9\u5668\u662f\u5426\u80fd\u6b63\u5e38\u8bbf\u95ee\u5176\u4ed6\u670d\u52a1\uff08\u4f8b\u5982\u6570\u636e\u5e93\u3001\u5916\u90e8 API \u7b49\uff09\u3002</p> <p>\u4f7f\u7528 <code>docker exec ping [target]</code> \u6216 <code>kubectl exec [pod_name] -- ping [target]</code> \u6d4b\u8bd5\u7f51\u7edc\u8fde\u901a\u6027\u3002</p> <p>DNS \u914d\u7f6e\u95ee\u9898\uff1a \u5bb9\u5668\u5185\u7684 DNS \u914d\u7f6e\u53ef\u80fd\u5b58\u5728\u95ee\u9898\uff0c\u5bfc\u81f4\u65e0\u6cd5\u89e3\u6790\u57df\u540d\u3002\u67e5\u770b\u5bb9\u5668\u4e2d\u7684 /etc/resolv.conf \u6587\u4ef6\uff0c\u786e\u8ba4 DNS \u914d\u7f6e\u662f\u5426\u6b63\u786e\u3002</p> <p>\u9632\u706b\u5899\u6216\u5b89\u5168\u7ec4\uff1a</p> <p>\u68c0\u67e5\u5bbf\u4e3b\u673a\u6216\u4e91\u5e73\u53f0\u7684\u9632\u706b\u5899\u6216\u5b89\u5168\u7ec4\u8bbe\u7f6e\uff0c\u786e\u4fdd\u6ca1\u6709\u963b\u6b62\u5bb9\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u6216\u5916\u90e8\u8bbf\u95ee\u3002</p>"},{"location":"2025/3kubernetes/#4_1","title":"4. \u914d\u7f6e\u9519\u8bef","text":"<p>\u73af\u5883\u53d8\u91cf\uff1a</p> <p>\u786e\u4fdd\u5bb9\u5668\u4e2d\u8bbe\u7f6e\u7684\u73af\u5883\u53d8\u91cf\u6b63\u786e\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u8fde\u63a5\u5b57\u7b26\u4e32\u3001API \u5bc6\u94a5\u7b49\u3002\u5982\u679c\u73af\u5883\u53d8\u91cf\u7f3a\u5931\u6216\u9519\u8bef\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u65e0\u6cd5\u6b63\u5e38\u542f\u52a8\u6216\u8fde\u63a5\u5230\u5916\u90e8\u670d\u52a1\u3002</p> <p>\u914d\u7f6e\u6587\u4ef6\uff1a</p> <p>\u5bb9\u5668\u7684\u914d\u7f6e\u6587\u4ef6\u53ef\u80fd\u88ab\u9519\u8bef\u4fee\u6539\uff0c\u5bfc\u81f4\u5e94\u7528\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002\u786e\u4fdd\u914d\u7f6e\u6587\u4ef6\u7684\u8def\u5f84\u548c\u5185\u5bb9\u6b63\u786e\uff0c\u5c24\u5176\u662f\u5728 Kubernetes \u4e2d\u4f7f\u7528 ConfigMap \u6216 Secret \u65f6</p>"},{"location":"2025/3kubernetes/#5_1","title":"5. \u5bb9\u5668\u955c\u50cf\u95ee\u9898","text":"<p>\u955c\u50cf\u62c9\u53d6\u5931\u8d25\uff1a</p> <p>\u2022 \u5982\u679c\u5bb9\u5668\u65e0\u6cd5\u542f\u52a8\uff0c\u68c0\u67e5\u955c\u50cf\u662f\u5426\u6210\u529f\u62c9\u53d6\u3002\u5728 Docker \u4e2d\u53ef\u4ee5\u4f7f\u7528 docker pull \u547d\u4ee4\u68c0\u67e5\u955c\u50cf\u662f\u5426\u53ef\u7528\uff1b\u5728 Kubernetes \u4e2d\u4f7f\u7528 kubectl describe pod \u67e5\u770b\u8be6\u7ec6\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u770b\u770b\u662f\u5426\u5b58\u5728\u955c\u50cf\u62c9\u53d6\u5931\u8d25\u7684\u60c5\u51b5\u3002</p> <p>\u955c\u50cf\u7248\u672c\u95ee\u9898\uff1a</p> <p>\u786e\u8ba4\u5bb9\u5668\u8fd0\u884c\u7684\u955c\u50cf\u7248\u672c\u662f\u5426\u6b63\u786e\u3002\u5982\u679c\u5e94\u7528\u4f9d\u8d56\u7279\u5b9a\u7248\u672c\u7684\u955c\u50cf\uff0c\u786e\u4fdd\u7248\u672c\u53f7\u548c\u6807\u7b7e\u5339\u914d\uff0c\u4e14\u6ca1\u6709\u4f7f\u7528\u8fc7\u65f6\u6216\u9519\u8bef\u7684\u955c\u50cf\u3002</p>"},{"location":"2025/3kubernetes/#6_1","title":"6. \u4f9d\u8d56\u670d\u52a1\u95ee\u9898","text":"<p>\u6570\u636e\u5e93/\u5916\u90e8\u670d\u52a1\u4e0d\u53ef\u7528\uff1a</p> <p>\u2022 \u68c0\u67e5\u5bb9\u5668\u662f\u5426\u80fd\u8bbf\u95ee\u5176\u4f9d\u8d56\u7684\u6570\u636e\u5e93\u6216\u5916\u90e8\u670d\u52a1\u3002\u4f7f\u7528 docker exec \u6216 kubectl exec \u8fdb\u5165\u5bb9\u5668\uff0c\u624b\u52a8\u5c1d\u8bd5\u8fde\u63a5\u6570\u636e\u5e93\u6216\u5916\u90e8\u670d\u52a1\uff0c\u786e\u8ba4\u5176\u53ef\u8fbe\u6027\u3002</p> <p>\u4f9d\u8d56\u7684\u670d\u52a1\u662f\u5426\u6b63\u5e38\u8fd0\u884c\uff1a</p> <p>\u2022 \u786e\u4fdd\u5bb9\u5668\u4f9d\u8d56\u7684\u5176\u4ed6\u670d\u52a1\uff08\u5982 Redis\u3001Kafka\u3001API \u670d\u52a1\u7b49\uff09\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\u3002\u68c0\u67e5\u8fd9\u4e9b\u670d\u52a1\u7684\u72b6\u6001\uff0c\u67e5\u770b\u662f\u5426\u6709\u6545\u969c\u3002</p>"},{"location":"2025/3kubernetes/#7","title":"7. \u5bb9\u5668\u7684\u5065\u5eb7\u68c0\u67e5","text":"<p>Kubernetes \u5065\u5eb7\u68c0\u67e5\uff1a</p> <p>\u5982\u679c\u5728 Kubernetes \u4e2d\u4f7f\u7528\u4e86 livenessProbe \u548c readinessProbe\uff0c\u68c0\u67e5\u5065\u5eb7\u68c0\u67e5\u662f\u5426\u914d\u7f6e\u6b63\u786e\uff0c\u5bb9\u5668\u662f\u5426\u88ab\u9519\u8bef\u5730\u6807\u8bb0\u4e3a\u4e0d\u5065\u5eb7\u6216\u4e0d\u53ef\u7528\u3002\u67e5\u770b kubectl describe pod \u4e2d\u5173\u4e8e\u63a2\u9488\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> <p>Docker \u5065\u5eb7\u68c0\u67e5\uff1a</p> <p>\u2022 \u5bf9\u4e8e Docker\uff0c\u53ef\u4ee5\u4f7f\u7528 docker inspect \u68c0\u67e5\u5bb9\u5668\u7684\u5065\u5eb7\u72b6\u6001\u3002\u5982\u679c\u5bb9\u5668\u4f7f\u7528\u4e86 HEALTHCHECK \u6307\u4ee4\uff0c\u67e5\u770b\u5065\u5eb7\u68c0\u67e5\u7684\u7ed3\u679c\u3002</p>"},{"location":"2025/3kubernetes/#8","title":"8. \u96c6\u7fa4\u548c\u5bb9\u5668\u7f16\u6392\u5e73\u53f0\u95ee\u9898","text":"<p>Kubernetes \u96c6\u7fa4\u95ee\u9898\uff1a</p> <p>\u5982\u679c\u662f Kubernetes \u96c6\u7fa4\u4e2d\u7684\u5bb9\u5668\u6545\u969c\uff0c\u68c0\u67e5\u96c6\u7fa4\u7684\u72b6\u6001\u662f\u5426\u6b63\u5e38\uff0c\u4f7f\u7528 kubectl get nodes \u67e5\u770b\u8282\u70b9\u72b6\u6001\uff0c\u786e\u4fdd\u96c6\u7fa4\u4e2d\u6ca1\u6709\u4e0d\u53ef\u7528\u7684\u8282\u70b9\u3002</p> <p>\u8d44\u6e90\u8c03\u5ea6\u95ee\u9898\uff1a</p> <p>\u68c0\u67e5 Kubernetes \u7684\u8c03\u5ea6\u5668\u662f\u5426\u6709\u95ee\u9898\uff0c\u5bfc\u81f4\u67d0\u4e9b\u5bb9\u5668\u65e0\u6cd5\u8c03\u5ea6\u5230\u5408\u9002\u7684\u8282\u70b9\u3002\u53ef\u4ee5\u67e5\u770b\u8c03\u5ea6\u5668\u7684\u65e5\u5fd7\uff08kubectl logs -n kube-system \uff09\u4e86\u89e3\u8be6\u7ec6\u60c5\u51b5\u3002</p>"},{"location":"2025/3kubernetes/#9","title":"9. \u67e5\u770b\u4e8b\u4ef6\u548c\u8b66\u544a","text":"<p>Kubernetes \u4e8b\u4ef6\uff1a</p> <p>\u4f7f\u7528 kubectl get events \u67e5\u770b\u4e0e\u5bb9\u5668\u6216 Pod \u76f8\u5173\u7684\u4e8b\u4ef6\u3002\u8fd9\u4e9b\u4e8b\u4ef6\u53ef\u4ee5\u63d0\u4f9b\u5f88\u591a\u6709\u7528\u7684\u4fe1\u606f\uff0c\u5982\u5bb9\u5668\u542f\u52a8\u5931\u8d25\u3001\u8d44\u6e90\u4e0d\u8db3\u3001\u8c03\u5ea6\u5931\u8d25\u7b49\u3002</p> <p>\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u8b66\u544a\u548c\u9519\u8bef\uff1a</p> <p>\u67e5\u770b Docker \u6216 Kubernetes \u8fd0\u884c\u65f6\u7684\u65e5\u5fd7\uff08\u5982 journalctl \u6216 /var/log/docker.log\uff09\uff0c\u53ef\u80fd\u4f1a\u63d0\u4f9b\u989d\u5916\u7684\u8b66\u544a\u4fe1\u606f\u6216\u9519\u8bef\u539f\u56e0\u3002</p>"},{"location":"2025/3kubernetes/#3-k8s","title":"3 k8s\u91cd\u8981\u7ec4\u4ef6","text":"<p>Kubernetes\uff08K8s\uff09\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u5bb9\u5668\u7f16\u6392\u5e73\u53f0\uff0c\u65e8\u5728\u81ea\u52a8\u5316\u5e94\u7528\u7a0b\u5e8f\u5bb9\u5668\u7684\u90e8\u7f72\u3001\u6269\u5c55\u548c\u7ba1\u7406\u3002\u5b83\u7531\u591a\u4e2a\u7ec4\u4ef6\u7ec4\u6210\uff0c\u6bcf\u4e2a\u7ec4\u4ef6\u5728\u6574\u4e2a Kubernetes \u7cfb\u7edf\u4e2d\u53d1\u6325\u7740\u91cd\u8981\u4f5c\u7528\u3002\u4ee5\u4e0b\u662f\u5bf9 Kubernetes \u6bcf\u4e2a\u5173\u952e\u7ec4\u4ef6\u7684\u7406\u89e3</p>"},{"location":"2025/3kubernetes/#0","title":"0 \u6838\u5fc3\u7ec4\u4ef6","text":"<ul> <li><code>etcd</code>\u4fdd\u5b58\u4e86\u6574\u4e2a\u96c6\u7fa4\u7684\u72b6\u6001;</li> <li><code>apiserver</code>\u63d0\u4f9b\u4e86\u8d44\u6e90\u64cd\u4f5c\u7684\u552f\u4e00\u5165\u53e3\uff0c\u5e76\u63d0\u4f9b\u8ba4\u8bc1\u3001\u6388\u6743\u3001\u8bbf\u95ee\u63a7\u5236\u3001API\u6ce8\u518c\u548c\u53d1\u73b0\u7b49\u673a\u5236;</li> <li><code>controller manager</code>\u8d1f\u8d23\u7ef4\u62a4\u96c6\u7fa4\u7684\u72b6\u6001\uff0c\u6bd4\u5982\u6545\u969c\u68c0\u6d4b\u3001\u81ea\u52a8\u6269\u5c55\u3001\u6eda\u52a8\u66f4\u65b0\u7b49</li> <li><code>scheduler</code>\u8d1f\u8d23\u8d44\u6e90\u7684\u8c03\u5ea6\uff0c\u6309\u7167\u9884\u5b9a\u7684\u8c03\u5ea6\u7b56\u7565\u5c06Pod\u8c03\u5ea6\u5230\u76f8\u5e94\u7684\u673a\u5668\u4e0a</li> <li><code>kubelet</code>\u8d1f\u8d23\u7ef4\u6301\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\uff0c\u540c\u65f6\u4e5f\u8d1f\u8d23<code>Volume(CVI)</code>\u548c\u7f51\u7edc<code>(CNI)</code>\u7684\u7ba1\u7406;</li> <li><code>Container runtime</code>\u8d1f\u8d23\u955c\u50cf\u7ba1\u7406\u4ee5\u53caPod\u548c\u5bb9\u5668\u7684\u771f\u6b63\u8fd0\u884c(CRI);</li> <li><code>kube-proxy</code>\u8d1f\u8d23\u4e3a<code>Service</code>\u63d0\u4f9b<code>cluster</code>\u5185\u90e8\u7684\u670d\u52a1\u53d1\u73b0\u548c\u8d1f\u8f7d\u5747\u8861;</li> <li><code>Flannel</code> \u7f51\u7edc\u4fdd\u8bc1\uff0c\u96c6\u7fa4\u5185\u5404\u8282\u70b9\u80fd\u901a\u8fc7<code>Pod</code>\u7f51\u6bb5\u4e92\u8054\u4e92\u901a</li> </ul>"},{"location":"2025/3kubernetes/#1-apiserver","title":"1. APIServer","text":"<ul> <li>\u4f5c\u7528\uff1aAPI Server \u662f Kubernetes \u63a7\u5236\u5e73\u9762\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u5b83\u4f5c\u4e3a\u6240\u6709\u7528\u6237\u8bf7\u6c42\u7684\u5165\u53e3\uff0c\u8d1f\u8d23\u63a5\u6536\u548c\u5904\u7406\u5916\u90e8\u8bf7\u6c42\uff08\u5982 kubectl \u547d\u4ee4\uff09\u4ee5\u53ca\u96c6\u7fa4\u5185\u5404\u7ec4\u4ef6\u7684\u5185\u90e8\u8bf7\u6c42\u3002API Server \u63d0\u4f9b RESTful API \u63a5\u53e3\uff0c\u4f9b\u7528\u6237\u548c Kubernetes \u63a7\u5236\u5e73\u9762\u7684\u5176\u4ed6\u7ec4\u4ef6\u4ea4\u4e92\u3002</li> <li>\u5de5\u4f5c\u539f\u7406\uff1aAPI Server \u5c06\u8bf7\u6c42\u9a8c\u8bc1\u3001\u8ba4\u8bc1\uff0c\u5e76\u6839\u636e\u8bf7\u6c42\u7c7b\u578b\uff08\u5982 GET\u3001POST\u3001PUT \u7b49\uff09\u4e0e Etcd \u5b58\u50a8\u4ea4\u4e92\u3002\u5b83\u8fd8\u4f1a\u901a\u8fc7\u6388\u6743\uff08RBAC\uff09\u548c\u51c6\u5165\u63a7\u5236\u5668\uff08Admission Controller\uff09\u6765\u786e\u4fdd\u8bf7\u6c42\u7b26\u5408\u6743\u9650\u548c\u7b56\u7565\u3002</li> </ul>"},{"location":"2025/3kubernetes/#2-etcd","title":"2. ETCD \u914d\u7f6e\u7ba1\u7406\u6570\u636e\u5e93","text":"<ul> <li>\u4f5c\u7528\uff1aEtcd \u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u952e\u503c\u5b58\u50a8\uff0c\u7528\u4e8e\u5b58\u50a8 Kubernetes \u96c6\u7fa4\u7684\u6240\u6709\u914d\u7f6e\u4fe1\u606f\u548c\u72b6\u6001\u6570\u636e\uff08\u5982\u96c6\u7fa4\u914d\u7f6e\u3001Pod \u72b6\u6001\u3001\u8282\u70b9\u4fe1\u606f\u7b49\uff09\u3002</li> <li>\u5de5\u4f5c\u539f\u7406\uff1aEtcd \u901a\u8fc7\u5f3a\u4e00\u81f4\u6027\u4fdd\u8bc1\u96c6\u7fa4\u6570\u636e\u7684\u4e00\u81f4\u6027\u3002Kubernetes \u4e2d\u7684\u6240\u6709\u72b6\u6001\u4fe1\u606f\uff08\u5982 Pod\u3001Service\u3001ConfigMap\u3001Secret \u7b49\uff09\u90fd\u4f1a\u5b58\u50a8\u5728 Etcd \u4e2d\uff0c\u5b83\u652f\u6301\u6570\u636e\u7684\u9ad8\u53ef\u7528\u6027\u548c\u707e\u96be\u6062\u590d\u3002</li> </ul>"},{"location":"2025/3kubernetes/#3-scheduler_1","title":"3. Scheduler (\u8c03\u5ea6\u5668\uff09","text":"<ul> <li>\u4f5c\u7528\uff1aScheduler \u8d1f\u8d23\u5c06\u6ca1\u6709\u6307\u5b9a\u8282\u70b9\u7684 Pod \u8c03\u5ea6\u5230\u9002\u5f53\u7684\u8282\u70b9\u4e0a\u3002\u5b83\u4f1a\u6839\u636e\u8d44\u6e90\u9700\u6c42\u3001\u4eb2\u548c\u6027\u3001\u53cd\u4eb2\u548c\u6027\u3001\u6c61\u70b9\u548c\u5bb9\u5fcd\u7b49\u89c4\u5219\u6765\u505a\u51fa\u8c03\u5ea6\u51b3\u7b56\u3002</li> <li>\u5de5\u4f5c\u539f\u7406\uff1aScheduler \u4ece API Server \u83b7\u53d6\u5f85\u8c03\u5ea6\u7684 Pod \u5217\u8868\uff0c\u5e76\u6839\u636e\u96c6\u7fa4\u4e2d\u5404\u8282\u70b9\u7684\u8d44\u6e90\u72b6\u51b5\uff08\u5982 CPU\u3001\u5185\u5b58\u3001\u78c1\u76d8\u7b49\uff09\u51b3\u5b9a\u5c06 Pod \u5b89\u6392\u5728\u54ea\u4e2a\u8282\u70b9\u4e0a\u3002\u5b83\u4f1a\u8003\u8651\u8282\u70b9\u7684\u8d1f\u8f7d\u3001\u7ea6\u675f\u6761\u4ef6\uff08\u5982\u8282\u70b9\u9009\u62e9\u5668\u3001\u4eb2\u548c\u6027\u7b49\uff09\u4ee5\u53ca\u5176\u4ed6\u8c03\u5ea6\u7b56\u7565</li> </ul>"},{"location":"2025/3kubernetes/#4-controllermanager","title":"4. ControllerManager  \uff08\u63a7\u5236\u5668\u7ba1\u7406\u5668\uff09","text":"<ul> <li>\u4f5c\u7528\uff1aController Manager \u8fd0\u884c\u63a7\u5236\u5668\uff0c\u8d1f\u8d23 Kubernetes \u96c6\u7fa4\u72b6\u6001\u7684\u7ef4\u62a4\u3002\u63a7\u5236\u5668\u662f\u4e00\u4e2a\u5faa\u73af\u63a7\u5236\u7cfb\u7edf\uff0c\u786e\u4fdd\u96c6\u7fa4\u4e2d\u7684\u5b9e\u9645\u72b6\u6001\u7b26\u5408\u671f\u671b\u72b6\u6001\u3002</li> <li>\u5de5\u4f5c\u539f\u7406\uff1aController Manager \u5305\u542b\u591a\u4e2a\u63a7\u5236\u5668\uff08\u5982 Replication Controller\u3001Deployment Controller\u3001StatefulSet Controller \u7b49\uff09\uff0c\u6bcf\u4e2a\u63a7\u5236\u5668\u76d1\u89c6\u96c6\u7fa4\u7684\u67d0\u4e2a\u65b9\u9762\uff0c\u5e76\u786e\u4fdd\u7cfb\u7edf\u72b6\u6001\u59cb\u7ec8\u4fdd\u6301\u4e00\u81f4\u3002\u4f8b\u5982\uff0cDeployment Controller \u4f1a\u786e\u4fdd\u90e8\u7f72\u7684 Pod \u6570\u91cf\u4e0e\u671f\u671b\u7684\u526f\u672c\u6570\u4e00\u81f4\uff0cPod \u7684\u5065\u5eb7\u68c0\u67e5\u5931\u8d25\u65f6\u4f1a\u81ea\u52a8\u91cd\u65b0\u521b\u5efa Pod\u3002</li> </ul>"},{"location":"2025/3kubernetes/#5-kubelet","title":"5. Kubelet\uff08\u8282\u70b9\u7ba1\u7406\u4ee3\u7406\uff09","text":"<ul> <li>\u4f5c\u7528\uff1aKubelet \u662f Kubernetes \u4e2d\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7684\u4ee3\u7406\uff0c\u5b83\u8d1f\u8d23\u7ba1\u7406\u8282\u70b9\u4e0a\u7684\u5bb9\u5668\uff0c\u5e76\u786e\u4fdd\u5bb9\u5668\u5728\u8282\u70b9\u4e0a\u6b63\u5e38\u8fd0\u884c\u3002</li> <li>\u5de5\u4f5c\u539f\u7406\uff1aKubelet \u4f1a\u5b9a\u671f\u5411 API Server \u6c47\u62a5\u8282\u70b9\u548c\u5bb9\u5668\u7684\u72b6\u6001\uff0c\u5e76\u4e14\u786e\u4fdd\u672c\u5730\u7684 Pod \u548c\u5bb9\u5668\u4e0e API Server \u4e2d\u7684\u671f\u671b\u72b6\u6001\u4e00\u81f4\u3002\u5982\u679c\u5bb9\u5668\u5d29\u6e83\u6216\u9700\u8981\u91cd\u65b0\u542f\u52a8\uff0cKubelet \u4f1a\u5904\u7406\u5bb9\u5668\u7684\u542f\u52a8\u548c\u91cd\u542f\u3002</li> </ul>"},{"location":"2025/3kubernetes/#6-kubeproxy","title":"6. KubeProxy (\u670d\u52a1\u4ee3\u7406)","text":"<ul> <li>\u4f5c\u7528\uff1aKube Proxy \u8d1f\u8d23\u96c6\u7fa4\u5185\u7684\u7f51\u7edc\u4ee3\u7406\u548c\u8d1f\u8f7d\u5747\u8861\u3002\u5b83\u7ba1\u7406 Kubernetes \u4e2d\u670d\u52a1\u7684\u8bbf\u95ee\uff0c\u901a\u8fc7\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u5c06\u6d41\u91cf\u5206\u53d1\u5230\u96c6\u7fa4\u4e2d\u7684\u5404\u4e2a Pod\u3002</li> <li>\u5de5\u4f5c\u539f\u7406\uff1aKube Proxy \u4f1a\u76d1\u542c Kubernetes \u670d\u52a1\u8d44\u6e90\u7684\u53d8\u5316\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u670d\u52a1\u521b\u5efa\u8d1f\u8f7d\u5747\u8861\u89c4\u5219\u3002\u5b83\u652f\u6301\u4e09\u79cd\u8d1f\u8f7d\u5747\u8861\u6a21\u5f0f\uff1a\u57fa\u4e8e iptables\u3001\u57fa\u4e8e IPVS \u548c\u57fa\u4e8e\u7528\u6237\u7a7a\u95f4\u7684\u4ee3\u7406\u3002Kube Proxy \u786e\u4fdd\u7528\u6237\u548c\u5916\u90e8\u6d41\u91cf\u80fd\u591f\u6b63\u786e\u5730\u8bbf\u95ee\u96c6\u7fa4\u5185\u7684\u670d\u52a1\uff0c\u5e76\u6839\u636e\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230\u76f8\u5e94\u7684 Pod\u3002</li> </ul>"},{"location":"2025/3kubernetes/#7-ingresscontroller-ingress","title":"7. IngressController (Ingress\u63a7\u5236\u5668)","text":"<ul> <li>\u4f5c\u7528\uff1aIngress Controller \u662f\u8d1f\u8d23\u5904\u7406\u96c6\u7fa4\u5916\u90e8 HTTP \u548c HTTPS \u6d41\u91cf\u7684\u7ec4\u4ef6\u3002\u5b83\u57fa\u4e8e Ingress \u8d44\u6e90\uff0c\u63d0\u4f9b HTTP \u8def\u7531\u3001SSL/TLS \u7ec8\u7aef\u7b49\u529f\u80fd\u3002</li> <li>\u5de5\u4f5c\u539f\u7406\uff1aIngress \u8d44\u6e90\u5b9a\u4e49\u4e86\u5916\u90e8\u8bbf\u95ee\u670d\u52a1\u7684\u89c4\u5219\uff0c\u800c Ingress Controller \u4f1a\u6839\u636e\u8fd9\u4e9b\u89c4\u5219\u914d\u7f6e\u5916\u90e8\u8bbf\u95ee\u7684\u8def\u7531\u548c\u8d1f\u8f7d\u5747\u8861\u3002\u5b83\u5141\u8bb8\u5c06\u591a\u4e2a\u670d\u52a1\u66b4\u9732\u5728\u540c\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u4e0a\uff0c\u5e76\u6839\u636e\u8bf7\u6c42\u7684\u8def\u5f84\u6216\u4e3b\u673a\u540d\u5c06\u6d41\u91cf\u8f6c\u53d1\u5230\u4e0d\u540c\u7684\u540e\u7aef\u670d\u52a1\u3002</li> </ul>"},{"location":"2025/3kubernetes/#8-namespace","title":"8. Namespace(\u547d\u540d\u7a7a\u95f4)","text":"<ul> <li>\u4f5c\u7528\uff1aNamespace \u662f Kubernetes \u4e2d\u7684\u4e00\u79cd\u8d44\u6e90\u9694\u79bb\u673a\u5236\uff0c\u5141\u8bb8\u5728\u540c\u4e00\u4e2a\u96c6\u7fa4\u4e2d\u521b\u5efa\u591a\u4e2a\u865a\u62df\u96c6\u7fa4\u3002\u6bcf\u4e2a\u547d\u540d\u7a7a\u95f4\u5185\u7684\u8d44\u6e90\uff08\u5982 Pod\u3001Service\u3001ConfigMap \u7b49\uff09\u662f\u72ec\u7acb\u7684\u3002</li> <li>\u5de5\u4f5c\u539f\u7406\uff1a\u547d\u540d\u7a7a\u95f4\u7528\u4e8e\u7ec4\u7ec7\u96c6\u7fa4\u4e2d\u7684\u8d44\u6e90\uff0c\u5e76\u5728\u5927\u89c4\u6a21\u96c6\u7fa4\u4e2d\u63d0\u4f9b\u9694\u79bb\u3002\u5728\u591a\u79df\u6237\u73af\u5883\u4e2d\uff0c\u4e0d\u540c\u7684\u56e2\u961f\u6216\u9879\u76ee\u53ef\u4ee5\u5728\u5404\u81ea\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\u7ba1\u7406\u8d44\u6e90\uff0c\u4ece\u800c\u907f\u514d\u8d44\u6e90\u51b2\u7a81\u3002</li> </ul>"},{"location":"2025/3kubernetes/#9-volume","title":"9. Volume (\u5b58\u50a8\u5377)","text":"<ul> <li>\u4f5c\u7528\uff1aVolume \u662f Kubernetes \u63d0\u4f9b\u7684\u4e00\u79cd\u6301\u4e45\u5316\u5b58\u50a8\u89e3\u51b3\u65b9\u6848\uff0c\u5bb9\u5668\u5185\u7684\u6570\u636e\u53ef\u4ee5\u5b58\u50a8\u5728 Volume \u4e2d\uff0c\u4ee5\u4fbf\u5bb9\u5668\u91cd\u542f\u6216\u8fc1\u79fb\u540e\u6570\u636e\u4ecd\u7136\u53ef\u7528\u3002</li> <li>\u5de5\u4f5c\u539f\u7406\uff1aVolume \u662f\u4e0e Pod \u751f\u547d\u5468\u671f\u7ed1\u5b9a\u7684\uff0c\u53ef\u4ee5\u6302\u8f7d\u5230 Pod \u4e2d\u7684\u5bb9\u5668\u4e0a\u3002Kubernetes \u652f\u6301\u591a\u79cd\u7c7b\u578b\u7684 Volume\uff08\u5982 HostPath\u3001NFS\u3001Ceph\u3001Cloud Provider \u7684\u5b58\u50a8\u670d\u52a1\u7b49\uff09\uff0c\u5e76\u4e14\u901a\u8fc7 Persistent Volume\uff08PV\uff09\u548c Persistent Volume Claim\uff08PVC\uff09\u6765\u52a8\u6001\u7ba1\u7406\u5b58\u50a8\u8d44\u6e90</li> </ul>"},{"location":"2025/3kubernetes/#10service","title":"10.Service (\u670d\u52a1)","text":"<ul> <li>\u4f5c\u7528\uff1aService \u662f Kubernetes \u4e2d\u7684\u4e00\u4e2a\u62bd\u8c61\u5c42\uff0c\u7528\u4e8e\u5b9a\u4e49\u4e00\u7ec4 Pod \u7684\u8bbf\u95ee\u65b9\u5f0f\uff0c\u901a\u5e38\u662f\u901a\u8fc7\u8d1f\u8f7d\u5747\u8861\u5668\u6765\u63d0\u4f9b\u7a33\u5b9a\u7684\u7f51\u7edc\u8bbf\u95ee\u3002</li> <li>\u5de5\u4f5c\u539f\u7406\uff1aService \u63d0\u4f9b\u4e86\u4e00\u79cd\u8bbf\u95ee Pod \u7684\u65b9\u6cd5\uff0c\u5b83\u4f1a\u81ea\u52a8\u53d1\u73b0\u5e76\u8d1f\u8f7d\u5747\u8861\u6240\u6709\u540e\u7aef Pod \u7684\u6d41\u91cf\u3002\u901a\u8fc7 ClusterIP\u3001NodePort\u3001LoadBalancer \u7b49\u4e0d\u540c\u7c7b\u578b\u7684 Service\uff0c\u7528\u6237\u53ef\u4ee5\u5b9a\u4e49\u4e0d\u540c\u7684\u8bbf\u95ee\u65b9\u5f0f\u548c\u7b56\u7565\u3002</li> </ul>"},{"location":"2025/3kubernetes/#11configmap","title":"11.ConfigMap\u548c\u673a\u5bc6\u7ba1\u7406","text":"<ul> <li>\u4f5c\u7528\uff1aConfigMap \u548c Secret \u662f\u7528\u4e8e\u7ba1\u7406\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u548c\u654f\u611f\u4fe1\u606f\u7684\u8d44\u6e90\u5bf9\u8c61\u3002ConfigMap \u5b58\u50a8\u975e\u654f\u611f\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u800c Secret \u5b58\u50a8\u673a\u5bc6\u4fe1\u606f\uff0c\u5982\u6570\u636e\u5e93\u5bc6\u7801\u3001API \u5bc6\u94a5\u7b49\u3002</li> <li>\u5de5\u4f5c\u539f\u7406\uff1aConfigMap \u548c Secret \u5141\u8bb8\u5728\u5bb9\u5668\u4e2d\u4ee5\u73af\u5883\u53d8\u91cf\u3001\u547d\u4ee4\u884c\u53c2\u6570\u6216\u6302\u8f7d\u6587\u4ef6\u7684\u65b9\u5f0f\u63d0\u4f9b\u914d\u7f6e\u4fe1\u606f\u3002\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u5728 Pod \u4e2d\u4ee5\u52a8\u6001\u7684\u65b9\u5f0f\u8fdb\u884c\u66f4\u65b0\uff0c\u4ece\u800c\u51cf\u5c11\u5e94\u7528\u7a0b\u5e8f\u7684\u786c\u7f16\u7801\u914d\u7f6e</li> </ul>"},{"location":"2025/3kubernetes/#4-k8s","title":"4 k8s \u91cc\u9762\u7684\u8d44\u6e90\u8c03\u5ea6\u5427","text":"<p>Kubernetes \u4e2d\u7684 \u8d44\u6e90\u8c03\u5ea6 \u662f\u6307\u5c06\u5bb9\u5668\u5316\u7684\u5e94\u7528\u7a0b\u5e8f\uff08\u901a\u5e38\u662f Pod\uff09\u5206\u914d\u5230\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u4e0a\u7684\u8fc7\u7a0b\u3002Kubernetes \u7684\u8c03\u5ea6\u7cfb\u7edf\u51b3\u5b9a\u4e86\u54ea\u4e9b Pod \u8fd0\u884c\u5728\u96c6\u7fa4\u4e2d\u7684\u54ea\u4e9b\u8282\u70b9\u4e0a\uff0c\u4ee5\u786e\u4fdd\u96c6\u7fa4\u8d44\u6e90\u7684\u6709\u6548\u5229\u7528\u548c\u8d1f\u8f7d\u5747\u8861</p> <p>Kubernetes \u8d44\u6e90\u8c03\u5ea6\u7684\u57fa\u672c\u6982\u5ff5</p> <ol> <li>Pod\uff1aKubernetes \u4e2d\u7684\u6700\u5c0f\u8c03\u5ea6\u5355\u5143\uff0c\u4e00\u4e2a Pod \u53ef\u4ee5\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u5bb9\u5668\u3002</li> <li>\u8282\u70b9\uff1aKubernetes \u96c6\u7fa4\u4e2d\u7684\u673a\u5668\uff0c\u901a\u5e38\u662f\u865a\u62df\u673a\u6216\u7269\u7406\u673a\uff0c\u8d1f\u8d23\u627f\u8f7d\u548c\u8fd0\u884c Pod\u3002</li> <li>\u8c03\u5ea6\u5668\uff1aKubernetes \u7684\u8c03\u5ea6\u5668\uff08Scheduler\uff09\u8d1f\u8d23\u5c06\u6ca1\u6709\u6307\u5b9a\u8282\u70b9\u7684 Pod \u8c03\u5ea6\u5230\u5408\u9002\u7684\u8282\u70b9\u4e0a</li> </ol>"},{"location":"2025/3kubernetes/#1-scheduler","title":"1 \u8c03\u5ea6\u5668\uff08scheduler\uff09","text":"<p>\u8c03\u5ea6\u5668\u662f Kubernetes \u4e2d\u8d1f\u8d23\u505a\u51fa Pod \u8c03\u5ea6\u51b3\u7b56\u7684\u7ec4\u4ef6\u3002\u5b83\u6839\u636e\u4ee5\u4e0b\u51e0\u4e2a\u56e0\u7d20\u6765\u9009\u62e9\u6700\u5408\u9002\u7684\u8282\u70b9\uff1a</p> <ul> <li>\u8d44\u6e90\u9700\u6c42\uff1aPod \u6240\u8bf7\u6c42\u7684 CPU\u3001\u5185\u5b58\u548c\u5b58\u50a8\u7b49\u8d44\u6e90\u3002</li> <li>\u8282\u70b9\u8d44\u6e90\uff1a\u8282\u70b9\u4e0a\u7684\u53ef\u7528\u8d44\u6e90\uff0c\u8c03\u5ea6\u5668\u4f1a\u68c0\u67e5\u5404\u8282\u70b9\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff0c\u9009\u62e9\u6700\u5408\u9002\u7684\u8282\u70b9\u3002</li> <li>\u8c03\u5ea6\u7b56\u7565\uff1a\u8c03\u5ea6\u5668\u8fd8\u4f1a\u6839\u636e\u9884\u5b9a\u4e49\u7684\u8c03\u5ea6\u7b56\u7565\uff08\u5982\u4eb2\u548c\u6027\u3001\u53cd\u4eb2\u548c\u6027\u3001\u6c61\u70b9\u548c\u5bb9\u5fcd\u7b49\uff09\u6765\u8fdb\u4e00\u6b65\u7b5b\u9009\u8282\u70b9</li> </ul>"},{"location":"2025/3kubernetes/#2_1","title":"2 \u8282\u70b9\u9009\u62e9","text":"<p>\u8c03\u5ea6\u5668\u57fa\u4e8e\u591a\u79cd\u56e0\u7d20\uff0c\u9009\u62e9\u9002\u5408\u7684\u8282\u70b9\u6765\u8fd0\u884c Pod\u3002\u8c03\u5ea6\u5668\u4f1a\u8003\u8651\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <p>\u8d44\u6e90\u8bf7\u6c42\u548c\u9650\u5236\uff1a</p> <p>\u6bcf\u4e2a Pod \u90fd\u53ef\u4ee5\u6307\u5b9a CPU \u548c\u5185\u5b58\u7684\u8bf7\u6c42\uff08request\uff09\u4e0e\u9650\u5236\uff08limit\uff09\u3002\u8c03\u5ea6\u5668\u4f1a\u6839\u636e\u8fd9\u4e9b\u9700\u6c42\u6765\u9009\u62e9\u8282\u70b9\u3002\u5982\u679c\u67d0\u4e2a\u8282\u70b9\u7684\u8d44\u6e90\u8db3\u591f\u6ee1\u8db3 Pod \u7684\u8bf7\u6c42\uff0c\u8c03\u5ea6\u5668\u5c31\u4f1a\u9009\u62e9\u8fd9\u4e2a\u8282\u70b9\u3002</p> <p>\u8282\u70b9\u4eb2\u548c\u6027\uff08Node Affinity\uff09\uff1a</p> <p>\u8282\u70b9\u4eb2\u548c\u6027\u5141\u8bb8\u4f60\u5c06 Pod \u8c03\u5ea6\u5230\u7279\u5b9a\u7684\u8282\u70b9\u4e0a\uff0c\u57fa\u4e8e\u8282\u70b9\u7684\u6807\u7b7e\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u5c06\u67d0\u4e9b Pod \u8c03\u5ea6\u5230\u5177\u6709\u7279\u5b9a\u6807\u7b7e\uff08\u5982 zone=us-west-1\uff09\u7684\u8282\u70b9\u4e0a</p> <p>Pod \u4eb2\u548c\u6027\u548c\u53cd\u4eb2\u548c\u6027\uff08Pod Affinity and Anti-Affinity\uff09\uff1a</p> <p>Pod \u4eb2\u548c\u6027\u7528\u4e8e\u63a7\u5236 Pod \u7684\u8c03\u5ea6\u89c4\u5219\uff0c\u4ee5\u4fbf\u5c06\u67d0\u4e9b Pod \u5b89\u6392\u5728\u4e00\u8d77\uff08\u4f8b\u5982\uff0c\u67d0\u4e9b Pod \u5e94\u8be5\u8fd0\u884c\u5728\u4e00\u8d77\uff0c\u6216\u8005\u5728\u540c\u4e00\u8282\u70b9\u4e0a\u5171\u4eab\u8d44\u6e90\uff09\u3002Pod \u53cd\u4eb2\u548c\u6027\u7528\u4e8e\u786e\u4fdd\u67d0\u4e9b Pod \u4e0d\u4f1a\u8c03\u5ea6\u5230\u4e00\u8d77\uff0c\u907f\u514d\u5171\u4eab\u8d44\u6e90\u8fc7\u591a\u5bfc\u81f4\u6027\u80fd\u95ee\u9898</p> <p>\u6c61\u70b9\u548c\u5bb9\u5fcd\uff08Taints and Tolerations\uff09\uff1a</p> <p>\u6c61\u70b9\u548c\u5bb9\u5fcd\u662f\u4e00\u79cd\u673a\u5236\uff0c\u7528\u4e8e\u5c06\u67d0\u4e9b\u8282\u70b9\u6807\u8bb0\u4e3a\u201c\u4e0d\u9002\u5408\u201d\u8fd0\u884c\u67d0\u4e9b Pod\u3002\u6c61\u70b9\u662f\u4e00\u4e2a\u8282\u70b9\u7684\u6807\u8bb0\uff0c\u8868\u793a\u8be5\u8282\u70b9\u4e0d\u9002\u5408\u8fd0\u884c\u67d0\u4e9b\u7c7b\u578b\u7684 Pod\uff0c\u9664\u975e\u8fd9\u4e9b Pod \u6709\u76f8\u5e94\u7684\u5bb9\u5fcd\uff08Toleration\uff09\u3002\u8fd9\u79cd\u673a\u5236\u5e38\u7528\u4e8e\u5c06\u8282\u70b9\u6807\u8bb0\u4e3a\u53ea\u80fd\u8fd0\u884c\u7279\u5b9a\u7c7b\u578b\u7684 Pod\uff0c\u4f8b\u5982\u4e13\u7528\u7684\u786c\u4ef6\u8282\u70b9\uff08\u5982 GPU\uff09\u3002</p> <p>\u8d1f\u8f7d\u5747\u8861\uff1a</p> <p>\u8c03\u5ea6\u5668\u4f1a\u6839\u636e\u96c6\u7fa4\u4e2d\u8282\u70b9\u7684\u8d1f\u8f7d\u60c5\u51b5\u6765\u5747\u8861\u8c03\u5ea6 Pod\u3002\u5982\u679c\u67d0\u4e2a\u8282\u70b9\u7684\u8d44\u6e90\u5df2\u7ecf\u63a5\u8fd1\u9971\u548c\uff0c\u8c03\u5ea6\u5668\u4f1a\u9009\u62e9\u4e00\u4e2a\u8d44\u6e90\u6bd4\u8f83\u7a7a\u95f2\u7684\u8282\u70b9\u6765\u8c03\u5ea6\u65b0\u7684 Pod\u3002</p>"},{"location":"2025/3kubernetes/#3_2","title":"3 \u8c03\u5ea6\u7b97\u6cd5\u548c\u4f18\u5148\u7ea7","text":"<p>\u8c03\u5ea6\u5668\u4f1a\u6839\u636e\u4e0d\u540c\u7684\u4f18\u5148\u7ea7\u548c\u7b97\u6cd5\u6765\u51b3\u5b9a\u54ea\u4e2a\u8282\u70b9\u6700\u9002\u5408\u8fd0\u884c\u67d0\u4e2a Pod\u3002Kubernetes \u8c03\u5ea6\u5668\u4f7f\u7528\u4ee5\u4e0b\u673a\u5236\u6765\u51b3\u7b56\uff1a</p> <ul> <li>Filter\uff08\u8fc7\u6ee4\uff09\uff1a\u8c03\u5ea6\u5668\u9996\u5148\u4f1a\u8fdb\u884c\u8fc7\u6ee4\uff0c<ul> <li>\u5254\u9664\u4e0d\u7b26\u5408\u6761\u4ef6\u7684\u8282\u70b9\u3002: \u4f8b\u5982\uff0c\u5982\u679c\u67d0\u4e2a\u8282\u70b9\u7684\u8d44\u6e90\u65e0\u6cd5\u6ee1\u8db3 Pod \u7684\u8bf7\u6c42\uff0c\u6216\u8005\u8be5\u8282\u70b9\u4e0a\u8fd0\u884c\u7740\u4e0d\u5141\u8bb8\u8be5 Pod \u8fd0\u884c\u7684\u670d\u52a1\uff0c\u90a3\u4e48\u8be5\u8282\u70b9\u4f1a\u88ab\u6392\u9664\u3002</li> </ul> </li> <li>Score\uff08\u6253\u5206\uff09\uff1a\u5728\u5269\u4f59\u7684\u5019\u9009\u8282\u70b9\u4e2d\uff0c\u8c03\u5ea6\u5668\u4f1a\u6839\u636e\u5404\u8282\u70b9\u7684\u6761\u4ef6\u548c\u7b56\u7565\u8fdb\u884c\u6253\u5206\uff0c\u9009\u62e9\u5f97\u5206\u6700\u9ad8\u7684\u8282\u70b9\u3002</li> <li>\u4f18\u5148\u7ea7\uff1aKubernetes \u5141\u8bb8\u6839\u636e\u4e0d\u540c\u7684\u8c03\u5ea6\u7b56\u7565\u8bbe\u7f6e\u4f18\u5148\u7ea7\u3002\u4f8b\u5982\uff0c\u4f18\u5148\u9009\u62e9\u8d44\u6e90\u7a7a\u95f2\u7684\u8282\u70b9\uff0c\u6216\u6839\u636e\u8282\u70b9\u6807\u7b7e\u3001\u786c\u4ef6\u7279\u6027\uff08\u5982 GPU \u652f\u6301\uff09\u6765\u9009\u62e9\u8282\u70b9\u3002</li> </ul>"},{"location":"2025/3kubernetes/#4_2","title":"4 \u5bb9\u5668\u8c03\u5ea6\u4e2d\u7684\u8d44\u6e90\u7ba1\u7406","text":""},{"location":"2025/3kubernetes/#requestlimit","title":"\u8bf7\u6c42\uff08Request\uff09\u4e0e\u9650\u5236\uff08Limit\uff09","text":"<ul> <li> <p>\u8bf7\u6c42\u662f\u5bb9\u5668\u542f\u52a8\u65f6\u6240\u9700\u7684\u6700\u5c0f\u8d44\u6e90\uff08\u5982 CPU \u548c\u5185\u5b58\uff09\u3002\u8c03\u5ea6\u5668\u4f1a\u57fa\u4e8e\u8bf7\u6c42\u6765\u8bc4\u4f30\u662f\u5426\u6709\u8db3\u591f\u8d44\u6e90\u7684\u8282\u70b9\u6765\u8fd0\u884c Pod\u3002</p> </li> <li> <p>\u9650\u5236\u662f\u5bb9\u5668\u7684\u6700\u5927\u8d44\u6e90\u4f7f\u7528\u9650\u5236\u3002\u5982\u679c\u5bb9\u5668\u8d85\u8fc7\u9650\u5236\uff0cKubernetes \u4f1a\u91c7\u53d6\u63aa\u65bd\uff08\u5982\u6740\u6389\u5bb9\u5668\uff09\u6765\u9650\u5236\u8d44\u6e90\u7684\u4f7f\u7528\u3002\u8bf7\u6c42\u548c\u9650\u5236\u7684\u5408\u7406\u914d\u7f6e\u53ef\u4ee5\u786e\u4fdd\u5bb9\u5668\u7684\u8d44\u6e90\u5f97\u5230\u6709\u6548\u5206\u914d\uff0c\u907f\u514d\u8282\u70b9\u8d44\u6e90\u8fc7\u8f7d</p> </li> </ul>"},{"location":"2025/3kubernetes/#resource-quotas","title":"Resource Quotas\uff08\u8d44\u6e90\u914d\u989d\uff09\uff1a","text":"<p>Kubernetes \u652f\u6301\u5728\u547d\u540d\u7a7a\u95f4\u7ea7\u522b\u8bbe\u7f6e\u8d44\u6e90\u914d\u989d\uff0c\u9650\u5236\u6bcf\u4e2a\u547d\u540d\u7a7a\u95f4\u4e2d\u53ef\u4ee5\u4f7f\u7528\u7684\u8d44\u6e90\u603b\u91cf\u3002\u8d44\u6e90\u914d\u989d\u7528\u4e8e\u63a7\u5236\u4e0d\u540c\u56e2\u961f\u6216\u670d\u52a1\u5bf9\u8d44\u6e90\u7684\u5360\u7528\uff0c\u907f\u514d\u5355\u4e2a\u5e94\u7528\u5360\u7528\u8fc7\u591a\u7684\u96c6\u7fa4\u8d44\u6e90\u3002</p>"},{"location":"2025/3kubernetes/#_1","title":"\u8c03\u5ea6\u5668\u7684\u6269\u5c55\u6027","text":"<p>\u81ea\u5b9a\u4e49\u8c03\u5ea6\u5668\uff1a</p> <ul> <li>Kubernetes \u5141\u8bb8\u7528\u6237\u81ea\u5b9a\u4e49\u8c03\u5ea6\u5668\uff0c\u9488\u5bf9\u7279\u5b9a\u9700\u6c42\uff08\u5982\u6027\u80fd\u4f18\u5316\u3001\u7279\u5b9a\u786c\u4ef6\u9700\u6c42\u7b49\uff09\u8bbe\u8ba1\u81ea\u5df1\u7684\u8c03\u5ea6\u7b56\u7565\u3002</li> <li>\u4f8b\u5982\uff0cKubernetes \u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u591a\u4e2a\u8c03\u5ea6\u5668\uff0c\u6765\u652f\u6301\u66f4\u590d\u6742\u7684\u8c03\u5ea6\u9700\u6c42\uff1a\u4f8b\u5982\u9488\u5bf9\u67d0\u4e9b\u7279\u6b8a\u786c\u4ef6\uff08\u5982 GPU\uff09\u4f7f\u7528\u81ea\u5b9a\u4e49\u8c03\u5ea6\u5668\uff0c\u5176\u4ed6\u5de5\u4f5c\u8d1f\u8f7d\u4f7f\u7528\u9ed8\u8ba4\u8c03\u5ea6\u5668\u3002</li> </ul>"},{"location":"2025/3kubernetes/#pod","title":"pod \u7684\u751f\u547d\u5468\u671f\u7ba1\u7406","text":"<p>Pod \u7ba1\u7406\u63a7\u5236\u5668\uff1a\u5982 Deployment\u3001StatefulSet\u3001DaemonSet\u3001ReplicaSet \u7b49\u63a7\u5236\u5668\u4f1a\u786e\u4fdd Pod \u6301\u7eed\u6309\u7167\u671f\u671b\u72b6\u6001\u8fd0\u884c\u3002\u8c03\u5ea6\u5668\u4e0e\u8fd9\u4e9b\u63a7\u5236\u5668\u7d27\u5bc6\u914d\u5408\uff0c\u786e\u4fdd Pod \u80fd\u591f\u6b63\u786e\u5730\u8c03\u5ea6\u5e76\u6309\u9700\u6269\u5c55</p> <p>\u603b\u7ed3\uff1a</p> <p>Kubernetes \u7684\u8d44\u6e90\u8c03\u5ea6\u662f\u4e00\u4e2a\u590d\u6742\u7684\u8fc7\u7a0b\uff0c\u6d89\u53ca\u5bf9\u8282\u70b9\u8d44\u6e90\u7684\u7ec6\u7c92\u5ea6\u7ba1\u7406\u3001\u4e0d\u540c\u7b56\u7565\u7684\u5e94\u7528\u4ee5\u53ca\u4f18\u5148\u7ea7\u7684\u5224\u65ad\u3002\u8c03\u5ea6\u5668\u5728\u96c6\u7fa4\u8d44\u6e90\u7684\u5206\u914d\u4e2d\u8d77\u7740\u81f3\u5173\u91cd\u8981\u7684\u4f5c\u7528\uff0c\u786e\u4fdd\u5bb9\u5668\u80fd\u591f\u6839\u636e\u8d44\u6e90\u8bf7\u6c42\u3001\u4eb2\u548c\u6027\u3001\u6c61\u70b9\u548c\u5bb9\u5fcd\u7b49\u89c4\u5219\u9ad8\u6548\u3001\u53ef\u9760\u5730\u8fd0\u884c\u5728\u9002\u5f53\u7684\u8282\u70b9\u4e0a\u3002\u8c03\u5ea6\u5668\u8fd8\u652f\u6301\u9ad8\u5ea6\u7684\u53ef\u6269\u5c55\u6027\u548c\u81ea\u5b9a\u4e49\u529f\u80fd\uff0c\u4f7f\u5f97 Kubernetes \u53ef\u4ee5\u9002\u5e94\u5404\u79cd\u4e0d\u540c\u7684\u4f7f\u7528\u573a\u666f\u548c\u8d1f\u8f7d\u8981\u6c42\u3002</p>"},{"location":"2025/3kubernetes/#4-cni","title":"4 CNI \u5e76\u4e14\u63cf\u8ff0\u4e0b\u5b83\u4eec\u4e4b\u95f4\u7684\u533a\u522b","text":"<p>\u5728 Kubernetes \u73af\u5883\u4e2d\uff0cCNI (Container Network Interface) \u63d2\u4ef6\u7528\u4e8e\u63d0\u4f9b\u548c\u7ba1\u7406\u5bb9\u5668\u4e4b\u95f4\u7684\u7f51\u7edc\u8fde\u63a5\u3002\u4e0d\u540c\u7684 CNI \u63d2\u4ef6\u5177\u6709\u4e0d\u540c\u7684\u7f51\u7edc\u67b6\u6784\u3001\u6027\u80fd\u3001\u529f\u80fd\u548c\u9002\u7528\u573a\u666f\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u89c1\u7684 CNI \u63d2\u4ef6\u53ca\u5176\u533a\u522b\uff1a</p>"},{"location":"2025/3kubernetes/#flannel","title":"Flannel","text":"<p>Flannel \u662f\u6700\u65e9\u7684 Kubernetes \u7f51\u7edc\u63d2\u4ef6\u4e4b\u4e00\uff0c\u7b80\u5355\u6613\u7528\uff0c\u5e7f\u6cdb\u5e94\u7528\u4e8e\u751f\u4ea7\u73af\u5883\u3002</p> <p>\u7279\u70b9\uff1a</p> <ul> <li>\u7b80\u5355\u6027\uff1aFlannel \u975e\u5e38\u5bb9\u6613\u8bbe\u7f6e\uff0c\u4e3b\u8981\u7528\u4e8e\u4e3a Pod \u63d0\u4f9b\u7f51\u7edc\u5730\u5740\u5206\u914d\u3002</li> <li>\u652f\u6301\u591a\u79cd\u540e\u7aef\uff1aFlannel \u652f\u6301\u591a\u79cd\u540e\u7aef\u5b9e\u73b0\uff0c\u5305\u62ec VXLAN\u3001host-gw\u3001AWS VPC \u7b49\u3002\u6700\u5e38\u89c1\u7684\u662f VXLAN \u6a21\u5f0f\uff0c\u5b83\u5c01\u88c5\u5bb9\u5668\u6d41\u91cf\u5e76\u901a\u8fc7 UDP \u901a\u9053\u4f20\u8f93\u3002</li> <li>\u5355\u4e00\u7f51\u7edc\u6a21\u578b\uff1aFlannel \u63d0\u4f9b\u7684\u7f51\u7edc\u6a21\u578b\u4e0d\u652f\u6301\u591a\u79df\u6237\u529f\u80fd\u3002Flannel \u4ec5\u63d0\u4f9b\u4e86\u6bcf\u4e2a\u8282\u70b9\u7684 IP \u5730\u5740\u6c60\uff0c\u652f\u6301 Pod \u4e4b\u95f4\u7684\u76f4\u63a5\u901a\u4fe1\u3002</li> </ul> <p>\u4f18\u70b9\uff1a</p> <ul> <li>\u7b80\u5355\u6613\u7528\uff0c\u9002\u5408\u5c0f\u578b\u548c\u4e2d\u578b\u96c6\u7fa4\u3002</li> <li>\u4e0d\u4f9d\u8d56\u5916\u90e8\u670d\u52a1\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u4ec5\u652f\u6301\u5e73\u9762\u7f51\u7edc\uff08\u6ca1\u6709\u9ad8\u7ea7\u7684\u7f51\u7edc\u7b56\u7565\u548c QoS\uff09\u3002</li> <li>\u7f51\u7edc\u9694\u79bb\u6027\u5dee\uff0c\u9002\u5408\u7b80\u5355\u7684\u573a\u666f\uff0c\u6269\u5c55\u6027\u8f83\u5f31</li> </ul>"},{"location":"2025/3kubernetes/#calico","title":"Calico","text":"<p>Calico \u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u7f51\u7edc\u63d2\u4ef6\uff0c\u652f\u6301\u9ad8\u6027\u80fd\u7684\u5bb9\u5668\u7f51\u7edc\u3001\u7f51\u7edc\u7b56\u7565\u548c\u591a\u4e91\u73af\u5883</p> <p>\u7279\u70b9\uff1a</p> <ul> <li>\u7f51\u7edc\u7b56\u7565\uff1aCalico \u662f Kubernetes \u4e2d\u6700\u6d41\u884c\u7684 CNI \u63d2\u4ef6\u4e4b\u4e00\uff0c\u63d0\u4f9b\u5f3a\u5927\u7684 \u7f51\u7edc\u7b56\u7565\uff0c\u53ef\u4ee5\u5bf9\u6d41\u91cf\u8fdb\u884c\u7ec6\u7c92\u5ea6\u63a7\u5236\uff0c\u5305\u62ec Ingress \u548c Egress \u7b56\u7565\u3002</li> <li>\u652f\u6301 BGP \u8def\u7531\uff1aCalico \u4f7f\u7528 BGP \u534f\u8bae\u6765\u63d0\u4f9b\u8de8\u8282\u70b9\u7684\u8def\u7531\u4fe1\u606f\uff0c\u5b83\u4e5f\u652f\u6301 IP-in-IP \u6a21\u5f0f\u6765\u5c01\u88c5\u6d41\u91cf\u3002</li> <li>\u6027\u80fd\u4f18\u8d8a\uff1aCalico \u76f4\u63a5\u4f7f\u7528 Linux \u5185\u6838\u7684\u8def\u7531\u529f\u80fd\uff0c\u63d0\u4f9b\u975e\u5e38\u9ad8\u7684\u6027\u80fd\u3002</li> <li>\u652f\u6301\u7f51\u7edc\u9694\u79bb\uff1a\u901a\u8fc7 NetworkPolicy\uff0c\u53ef\u4ee5\u5bf9\u4e0d\u540c\u7684\u5e94\u7528\u548c\u79df\u6237\u8fdb\u884c\u6d41\u91cf\u63a7\u5236\u548c\u9694\u79bb</li> </ul> <p>\u4f18\u70b9</p> <p>\u2022 \u63d0\u4f9b\u9ad8\u6027\u80fd\uff0c\u9002\u7528\u4e8e\u5927\u89c4\u6a21\u751f\u4ea7\u73af\u5883\u3002 \u2022 \u63d0\u4f9b\u5b8c\u6574\u7684\u7f51\u7edc\u7b56\u7565\u529f\u80fd\uff0c\u652f\u6301\u8de8\u4e91\u73af\u5883\u548c\u6df7\u5408\u4e91\u3002 \u2022 \u9ad8\u5ea6\u53ef\u5b9a\u5236\u5316\uff0c\u652f\u6301\u591a\u79cd\u540e\u7aef\uff08BGP\u3001VXLAN\u3001IP-in-IP\uff09\u3002</p> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u914d\u7f6e\u548c\u7ef4\u62a4\u76f8\u5bf9\u590d\u6742\u3002</li> <li>\u5bf9\u67d0\u4e9b\u73af\u5883\u53ef\u80fd\u9700\u8981\u989d\u5916\u7684\u7f51\u7edc\u786c\u4ef6\u652f\u6301\uff08\u5982 BGP \u8def\u7531\uff09\u3002</li> </ul>"},{"location":"2025/3kubernetes/#cilium","title":"Cilium","text":"<p>Cilium \u57fa\u4e8e eBPF\uff08extended Berkeley Packet Filter\uff09\u6280\u672f\uff0c\u5b83\u63d0\u4f9b\u9ad8\u6027\u80fd\u3001\u9ad8\u7075\u6d3b\u6027\u548c\u5f3a\u5927\u7684\u7f51\u7edc\u5b89\u5168\u80fd\u529b\uff0c\u5c24\u5176\u9002\u5408\u73b0\u4ee3\u4e91\u539f\u751f\u67b6\u6784</p> <p>\u7279\u70b9</p> <ul> <li>eBPF\uff1aCilium \u4f7f\u7528 eBPF \u6765\u8fdb\u884c\u5185\u6838\u7ea7\u6d41\u91cf\u63a7\u5236\uff0c\u63d0\u4f9b\u6bd4\u4f20\u7edf\u7f51\u7edc\u63d2\u4ef6\u66f4\u4f4e\u7684\u5ef6\u8fdf\u548c\u66f4\u9ad8\u7684\u541e\u5410\u91cf\u3002</li> <li>\u7f51\u7edc\u5b89\u5168\uff1a\u63d0\u4f9b\u9ad8\u7ea7\u7684 L7\uff08\u5e94\u7528\u5c42\uff09\u7f51\u7edc\u7b56\u7565\uff0c\u652f\u6301\u57fa\u4e8e HTTP\u3001gRPC \u7b49\u534f\u8bae\u7684\u7ec6\u7c92\u5ea6\u6d41\u91cf\u63a7\u5236\u3002</li> <li>\u591a\u79df\u6237\u652f\u6301\uff1a\u652f\u6301\u5bb9\u5668\u7f51\u7edc\u7684\u7ec6\u7c92\u5ea6\u9694\u79bb\uff0c\u9002\u5408\u591a\u79df\u6237\u548c\u5fae\u670d\u52a1\u67b6\u6784\u3002</li> <li>\u6027\u80fd\u4f18\u5316\uff1a\u7531\u4e8e eBPF \u53ef\u4ee5\u76f4\u63a5\u64cd\u4f5c Linux \u5185\u6838\uff0c\u56e0\u6b64\u5176\u6027\u80fd\u975e\u5e38\u9ad8</li> </ul> <p>\u4f18\u70b9</p> <ul> <li>\u57fa\u4e8e eBPF \u63d0\u4f9b\u6781\u4f4e\u7684\u5ef6\u8fdf\u548c\u9ad8\u541e\u5410\u91cf\u3002</li> <li>\u63d0\u4f9b L7 \u7f51\u7edc\u7b56\u7565\u652f\u6301\uff0c\u589e\u5f3a\u7f51\u7edc\u5b89\u5168\u3002</li> <li>\u53ef\u4ee5\u5728\u4e91\u539f\u751f\u73af\u5883\u4e2d\u4f7f\u7528\uff0c\u652f\u6301\u5fae\u670d\u52a1\u548c\u591a\u79df\u6237\u9694\u79bb\u3002</li> <li>\u66f4\u597d\u5730\u4e0e\u5bb9\u5668\u5b89\u5168\u548c\u76d1\u63a7\u5de5\u5177\u96c6\u6210</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u6027\u80fd\u76f8\u5bf9\u8f83\u4f4e\uff0c\u4e0d\u9002\u5408\u9ad8\u6027\u80fd\u7f51\u7edc\u9700\u6c42\u7684\u573a\u666f\u3002</li> <li>\u76f8\u6bd4\u4e8e Calico\uff0c\u7f51\u7edc\u7b56\u7565\u529f\u80fd\u8f83\u5f31\uff0c\u6269\u5c55\u6027\u6709\u9650\u3002</li> </ul>"},{"location":"2025/3kubernetes/#canal","title":"Canal","text":"<p>Canal \u662f Calico \u548c Flannel \u7684\u7ed3\u5408\uff0c\u5b83\u5229\u7528 Flannel \u6765\u5904\u7406\u7f51\u7edc\u548c IP \u5730\u5740\u7ba1\u7406\uff0c\u5229\u7528 Calico \u6765\u63d0\u4f9b\u7f51\u7edc\u7b56\u7565\u529f</p> <p>\u7279\u70b9\uff1a</p> <ul> <li>\u7ec4\u5408\u4f18\u52bf\uff1a\u7ed3\u5408\u4e86 Flannel \u7684\u7b80\u6613\u6027\u548c Calico \u7684\u5f3a\u5927\u529f\u80fd\uff0c\u63d0\u4f9b\u4e86\u7b80\u5355\u7684\u7f51\u7edc\u90e8\u7f72\u548c\u5f3a\u5927\u7684\u7f51\u7edc\u7b56\u7565\u652f\u6301\u3002</li> <li>\u53ef\u6269\u5c55\u6027\uff1a\u652f\u6301 IP-in-IP\u3001VXLAN \u548c BGP \u7b49\u591a\u79cd\u7f51\u7edc\u6a21\u5f0f\uff0c\u9002\u5e94\u4e0d\u540c\u89c4\u6a21\u7684\u96c6\u7fa4\u9700\u6c42\u3002</li> </ul> <p>\u4f18\u70b9\uff1a</p> <p>\u2022 \u65e2\u63d0\u4f9b\u4e86\u7b80\u5355\u7684 Flannel \u7f51\u7edc\u529f\u80fd\uff0c\u53c8\u652f\u6301 Calico \u7f51\u7edc\u7b56\u7565\u3002 \u2022 \u9002\u5408\u90a3\u4e9b\u9700\u8981\u7b80\u5355\u914d\u7f6e\u4f46\u53c8\u60f3\u8981\u652f\u6301\u7f51\u7edc\u7b56\u7565\u7684\u73af\u5883</p> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u914d\u7f6e\u548c\u7ef4\u62a4\u76f8\u6bd4\u7eaf\u7cb9\u7684 Calico \u6216 Flannel \u66f4\u52a0\u590d\u6742\u3002</li> <li>\u5bf9\u4e8e\u4e00\u4e9b\u590d\u6742\u573a\u666f\uff0c\u53ef\u80fd\u9700\u8981\u66f4\u591a\u7684\u8d44\u6e90\u8fdb\u884c\u8c03\u4f18</li> </ul>"},{"location":"2025/3kubernetes/#kube-router","title":"Kube-router","text":"<p>Kube-router \u662f\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684 CNI \u63d2\u4ef6\uff0c\u65e8\u5728\u7b80\u5316 Kubernetes \u7f51\u7edc\u529f\u80fd\uff0c\u5e76\u4e14\u53ef\u4ee5\u63d0\u4f9b\u9ad8\u6548\u7684\u7f51\u7edc\u8def\u7531\u3001\u8d1f\u8f7d\u5747\u8861\u548c\u7f51\u7edc\u7b56\u7565\u529f\u80fd</p> <p>\u7279\u70b9\uff1a</p> <ul> <li>\u7b80\u5316\u8bbe\u8ba1\uff1aKube-router \u65e8\u5728\u51cf\u5c11 Kubernetes \u7f51\u7edc\u7684\u590d\u6742\u6027\uff0c\u63d0\u4f9b\u4e00\u4e2a\u96c6\u4e2d\u5316\u7684\u7f51\u7edc\u6a21\u578b\u3002</li> <li>\u652f\u6301 BGP \u548c\u8def\u7531\uff1a\u901a\u8fc7 BGP \u8fdb\u884c\u8de8\u8282\u70b9\u8def\u7531\u914d\u7f6e\uff0c\u652f\u6301\u591a\u79df\u6237\u7684\u6d41\u91cf\u9694\u79bb\u3002 \u2022 \u5185\u7f6e\u8d1f\u8f7d\u5747\u8861\uff1aKube-router \u63d0\u4f9b\u4e86\u670d\u52a1\u548c Pod \u7684\u5185\u7f6e\u8d1f\u8f7d\u5747\u8861\u529f\u80fd\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u76f8\u6bd4\u4e8e Calico \u548c Cilium\uff0c\u529f\u80fd\u53ef\u80fd\u7565\u663e\u7b80\u5316\uff0c\u4e0d\u652f\u6301 L7 \u7f51\u7edc\u7b56\u7565\u3002</li> <li>\u4e0d\u5982 Calico \u90a3\u6837\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u793e\u533a\u652f\u6301\u8f83\u5c11\u3002</li> </ul>"},{"location":"2025/3kubernetes/#cni","title":"\u9009\u62e9CNI\u63d2\u4ef6\u65f6\u7684\u8003\u8651\u56e0\u7d20","text":"<ul> <li>\u96c6\u7fa4\u89c4\u6a21\uff1a\u5bf9\u4e8e\u5c0f\u89c4\u6a21\u96c6\u7fa4\uff0cFlannel \u6216 Weave Net \u53ef\u80fd\u5df2\u7ecf\u8db3\u591f\uff1b\u5bf9\u4e8e\u5927\u89c4\u6a21\u548c\u9ad8\u6027\u80fd\u9700\u6c42\u7684\u96c6\u7fa4\uff0cCalico \u6216 Cilium \u66f4\u5408\u9002\u3002</li> <li>\u5b89\u5168\u6027\uff1a\u5982\u679c\u9700\u8981\u9ad8\u7ea7\u7684\u5b89\u5168\u529f\u80fd\u548c\u7f51\u7edc\u7b56\u7565\uff0c\u5efa\u8bae\u9009\u62e9 Calico \u6216 Cilium\u3002</li> <li>\u7f51\u7edc\u6027\u80fd\uff1a\u5bf9\u4e8e\u8981\u6c42\u9ad8\u6027\u80fd\u3001\u4f4e\u5ef6\u8fdf\u7684\u7f51\u7edc\uff0cCilium \u548c Calico\uff08\u4f7f\u7528 BGP\uff09\u662f\u66f4\u597d\u7684\u9009\u62e9\u3002</li> <li>\u7b80\u5355\u6027\uff1a\u5982\u679c\u7b80\u5316\u914d\u7f6e\u548c\u5feb\u901f\u90e8\u7f72\u662f\u60a8\u7684\u9996\u8981\u76ee\u6807\uff0cFlannel \u6216 Weave Net \u53ef\u80fd\u662f\u66f4\u597d\u7684\u9009\u62e9\u3002</li> </ul>"},{"location":"2025/3kubernetes/#5-liveness-probereadiness-probestartup-probe","title":"5 \u5b58\u6d3b\u63a2\u9488\uff08Liveness Probe\uff09\u3001\u5c31\u7eea\u63a2\u9488\uff08Readiness Probe\uff09\u3001\u542f\u52a8\u63a2\u9488\uff08Startup Probe\uff09\u7684\u533a\u522b\u53ca\u9002\u7528\u573a\u666f\uff1f","text":""},{"location":"2025/3kubernetes/#1-liveness-probe","title":"1. \u5b58\u6d3b\u63a2\u9488\uff08Liveness Probe\uff09","text":"<p>\u76ee\u7684\uff1a\u68c0\u6d4b\u5bb9\u5668\u662f\u5426\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\uff0c\u82e5\u5931\u8d25\u5219\u91cd\u542f\u5bb9\u5668\u3002</p> <p>\u9002\u7528\u573a\u666f\uff1a</p> <ul> <li>\u5e94\u7528\u7a0b\u5e8f\u56e0\u6b7b\u9501\u6216\u6b7b\u5faa\u73af\u65e0\u6cd5\u54cd\u5e94\u8bf7\u6c42\u65f6\u81ea\u52a8\u6062\u590d\u3002</li> <li>\u4f8b\u5982\uff1aWeb \u670d\u52a1\u957f\u65f6\u95f4\u65e0\u54cd\u5e94\u9700\u5f3a\u5236\u91cd\u542f\u3002</li> </ul> <p>\u914d\u7f6e\u793a\u4f8b</p> <pre><code>livenessProbe:\n  httpGet:\n    path: /healthz\n    port: 8080\n  initialDelaySeconds: 5\n  periodSeconds: 10\n</code></pre> <p>\u53ef\u4ee5\u6839\u636e\u7528\u6237\u81ea\u5b9a\u4e49\u89c4\u5219\u6765\u5224\u5b9apod\u662f\u5426\u5065\u5eb7\uff0c\u5982\u679clivenessProbe\u63a2\u9488\u63a2\u6d4b\u5230\u5bb9\u5668\u4e0d\u5065\u5eb7\uff0c\u5219kubelet\u4f1a\u6839\u636e\u5176\u91cd\u542f\u7b56\u7565\u6765\u51b3\u5b9a\u662f\u5426\u91cd\u542f\uff0c\u5982\u679c\u4e00\u4e2a\u5bb9\u5668\u4e0d\u5305\u542blivenessProbe\u63a2\u9488\uff0c\u5219kubelet\u4f1a\u8ba4\u4e3a\u5bb9\u5668\u7684livenessProbe\u63a2\u9488\u7684\u8fd4\u56de\u503c\u6c38\u8fdc\u6210\u529f\u3002</p>"},{"location":"2025/3kubernetes/#2-readiness-probe","title":"2. \u5c31\u7eea\u63a2\u9488\uff08Readiness Probe\uff09","text":"<p>\u76ee\u7684\uff1a\u68c0\u6d4b\u5bb9\u5668\u662f\u5426\u51c6\u5907\u597d\u63a5\u6536\u6d41\u91cf\uff0c\u82e5\u5931\u8d25\u5219\u4ece Service \u7684 Endpoints \u4e2d\u79fb\u9664\u3002</p> <p>\u9002\u7528\u573a\u666f\uff1a</p> <ul> <li>\u5e94\u7528\u542f\u52a8\u65f6\u9700\u8981\u52a0\u8f7d\u5927\u91cf\u6570\u636e\uff08\u5982\u7f13\u5b58\u9884\u70ed\uff09\u3002</li> <li>\u4f9d\u8d56\u5916\u90e8\u670d\u52a1\uff08\u5982\u6570\u636e\u5e93\uff09\u521d\u59cb\u5316\u5b8c\u6210\u540e\u624d\u53ef\u63d0\u4f9b\u670d\u52a1\u3002</li> </ul> <p>\u914d\u7f6e\u793a\u4f8b</p> <pre><code>readinessProbe:\n  exec:\n    command: [\"/bin/check-db-connection.sh\"]\n  initialDelaySeconds: 10\n  periodSeconds: 5\n</code></pre> <p>\u540c\u6837\u662f\u53ef\u4ee5\u6839\u636e\u7528\u6237\u81ea\u5b9a\u4e49\u89c4\u5219\u6765\u5224\u65adpod\u662f\u5426\u5065\u5eb7\uff0c\u5982\u679c\u63a2\u6d4b\u5931\u8d25\uff0c\u63a7\u5236\u5668\u4f1a\u5c06\u6b64pod\u4ece\u5bf9\u5e94service\u7684endpoint\u5217\u8868\u4e2d\u79fb\u9664\uff0c\u4ece\u6b64\u4e0d\u518d\u5c06\u4efb\u4f55\u8bf7\u6c42\u8c03\u5ea6\u5230\u6b64Pod\u4e0a\uff0c\u76f4\u5230\u4e0b\u6b21\u63a2\u6d4b\u6210\u529f\u3002</p>"},{"location":"2025/3kubernetes/#3-startup-probe","title":"3. \u542f\u52a8\u63a2\u9488\uff08Startup Probe\uff09","text":"<p>\u76ee\u7684\uff1a\u5ef6\u8fdf\u5176\u4ed6\u63a2\u9488\u7684\u542f\u52a8\uff0c\u76f4\u5230\u5bb9\u5668\u6210\u529f\u542f\u52a8\u3002</p> <p>\u9002\u7528\u573a\u666f\uff1a</p> <ul> <li>\u65e7\u5e94\u7528\u542f\u52a8\u65f6\u95f4\u8f83\u957f\uff08\u5982 Java \u5e94\u7528\u9700\u6570\u5206\u949f\u521d\u59cb\u5316\uff09\u3002</li> <li>\u907f\u514d\u5b58\u6d3b/\u5c31\u7eea\u63a2\u9488\u5728\u542f\u52a8\u9636\u6bb5\u8bef\u5224\u5bfc\u81f4\u5bb9\u5668\u91cd\u542f</li> </ul> <p>\u914d\u7f6e\u793a\u4f8b</p> <pre><code>startupProbe:\n  httpGet:\n    path: /startup\n    port: 8080\n  failureThreshold: 30  # \u6700\u957f\u7b49\u5f85 30*5=150 \u79d2\n  periodSeconds: 5\n</code></pre> <p>\u542f\u52a8\u68c0\u67e5\u673a\u5236\uff0c\u5e94\u7528\u4e00\u4e9b\u542f\u52a8\u7f13\u6162\u7684\u4e1a\u52a1\uff0c\u907f\u514d\u4e1a\u52a1\u957f\u65f6\u95f4\u542f\u52a8\u800c\u88ab\u4e0a\u9762\u4e24\u7c7b\u63a2\u9488kill\u6389\uff0c\u8fd9\u4e2a\u95ee\u9898\u4e5f\u53ef\u4ee5\u6362\u53e6\u4e00\u79cd\u65b9\u5f0f\u89e3\u51b3\uff0c\u5c31\u662f\u5b9a\u4e49\u4e0a\u9762\u4e24\u7c7b\u63a2\u9488\u673a\u5236\u65f6\uff0c\u521d\u59cb\u5316\u65f6\u95f4\u5b9a\u4e49\u7684\u957f\u4e00\u4e9b\u5373\u53ef\u3002</p> <ul> <li><code>initialDelaySeconds</code>\uff1a\u521d\u59cb\u7b2c\u4e00\u6b21\u63a2\u6d4b\u95f4\u9694\uff0c\u7528\u4e8e\u5e94\u7528\u542f\u52a8\u7684\u65f6\u95f4\uff0c\u9632\u6b62\u5e94\u7528\u8fd8\u6ca1\u542f\u52a8\u800c\u5065\u5eb7\u68c0\u67e5\u5931\u8d25</li> <li><code>periodSeconds</code>\uff1a\u68c0\u67e5\u95f4\u9694\uff0c\u591a\u4e45\u6267\u884cprobe\u68c0\u67e5\uff0c\u9ed8\u8ba4\u4e3a10s\uff1b</li> <li><code>timeoutSeconds</code>\uff1a\u68c0\u67e5\u8d85\u65f6\u65f6\u957f\uff0c\u63a2\u6d4b\u5e94\u7528timeout\u540e\u4e3a\u5931\u8d25\uff1b</li> <li><code>successThreshold</code>\uff1a\u6210\u529f\u63a2\u6d4b\u9608\u503c\uff0c\u8868\u793a\u63a2\u6d4b\u591a\u5c11\u6b21\u4e3a\u5065\u5eb7\u6b63\u5e38\uff0c\u9ed8\u8ba4\u63a2\u6d4b1\u6b21\u3002</li> </ul> <p>1\uff09Exec\uff1a \u901a\u8fc7\u6267\u884c\u547d\u4ee4\u7684\u65b9\u5f0f\u6765\u68c0\u67e5\u670d\u52a1\u662f\u5426\u6b63\u5e38\uff0c\u6bd4\u5982\u4f7f\u7528<code>cat</code>\u547d\u4ee4\u67e5\u770b<code>pod</code>\u4e2d\u7684\u67d0\u4e2a\u91cd\u8981\u914d\u7f6e\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff0c\u82e5\u5b58\u5728\uff0c\u5219\u8868\u793apod\u5065\u5eb7\u3002\u53cd\u4e4b\u5f02\u5e38\u3002</p> <p>2\uff09Httpget\uff1a \u901a\u8fc7\u53d1\u9001http/htps\u8bf7\u6c42\u68c0\u67e5\u670d\u52a1\u662f\u5426\u6b63\u5e38\uff0c\u8fd4\u56de\u7684\u72b6\u6001\u7801\u4e3a200-399\u5219\u8868\u793a\u5bb9\u5668\u5065\u5eb7\uff08\u6ce8http get\u7c7b\u4f3c\u4e8e\u547d\u4ee4curl -I\uff09\u3002</p> <p>3\uff09tcpSocket\uff1a \u901a\u8fc7\u5bb9\u5668\u7684IP\u548cPort\u6267\u884cTCP\u68c0\u67e5\uff0c\u5982\u679c\u80fd\u591f\u5efa\u7acbTCP\u8fde\u63a5\uff0c\u5219\u8868\u660e\u5bb9\u5668\u5065\u5eb7\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4e0eHTTPget\u7684\u63a2\u6d4b\u673a\u5236\u6709\u4e9b\u7c7b\u4f3c\uff0ctcpsocket\u5065\u5eb7\u68c0\u67e5\u9002\u7528\u4e8eTCP\u4e1a\u52a1\u3002</p>"},{"location":"2025/3kubernetes/#2-kubernetes-qos-guaranteedburstablebesteffort","title":"2: Kubernetes \u7684 QoS \u5206\u7c7b\uff08Guaranteed\u3001Burstable\u3001BestEffort\uff09\u53ca\u5176\u8d44\u6e90\u7ba1\u7406\u7b56\u7565\uff1f","text":""},{"location":"2025/3kubernetes/#1-guaranteed","title":"1. Guaranteed","text":"<p>\u6761\u4ef6\uff1a\u6240\u6709\u5bb9\u5668\u7684 CPU/Memory \u5747\u8bbe\u7f6e limits=requests\u3002</p> <p>\u8d44\u6e90\u4fdd\u969c\uff1a</p> <ul> <li>\u4e25\u683c\u4fdd\u8bc1\u8d44\u6e90\u5206\u914d\uff0c\u9002\u7528\u4e8e\u6838\u5fc3\u670d\u52a1\uff08\u5982\u6570\u636e\u5e93\uff09\u3002</li> <li>OOM \u4f18\u5148\u7ea7\u6700\u4f4e\uff0c\u4e0d\u6613\u88ab\u6740\u6b7b</li> </ul>"},{"location":"2025/3kubernetes/#2-burstable","title":"2. Burstable","text":"<ul> <li>\u6761\u4ef6\uff1a\u81f3\u5c11\u4e00\u4e2a\u5bb9\u5668\u8bbe\u7f6e\u4e86 requests \u4f46\u672a\u6ee1\u8db3 limits=requests\u3002</li> <li>\u8d44\u6e90\u5f39\u6027\uff1a<ul> <li>\u5141\u8bb8\u7a81\u53d1\u4f7f\u7528\u8d44\u6e90\uff0c\u9002\u7528\u4e8e\u591a\u6570\u5e94\u7528\uff08\u5982 Web \u670d\u52a1\uff09\u3002</li> <li>OOM \u4f18\u5148\u7ea7\u9ad8\u4e8e Guaranteed\u3002</li> </ul> </li> </ul>"},{"location":"2025/3kubernetes/#3-besteffort","title":"3. BestEffort","text":"<p>\u6761\u4ef6\uff1a\u6240\u6709\u5bb9\u5668\u5747\u672a\u8bbe\u7f6e requests \u548c limits\u3002</p> <p>\u8d44\u6e90\u7ade\u4e89\uff1a</p> <ul> <li>\u8d44\u6e90\u4e0d\u8db3\u65f6\u4f18\u5148\u88ab\u7ec8\u6b62\uff0c\u9002\u7528\u4e8e\u975e\u5173\u952e\u4efb\u52a1\uff08\u5982\u6279\u5904\u7406\u4f5c\u4e1a\uff09</li> <li>OOM \u4f18\u5148\u7ea7\u6700\u9ad8\u3002</li> </ul>"},{"location":"2025/3kubernetes/#4-pod-qos","title":"4 \u5982\u4f55\u4e3a Pod \u914d\u7f6e QoS \u7b56\u7565\uff1f\u4e3e\u4f8b\u8bf4\u660e\u4e0d\u540c\u573a\u666f\u7684\u9009\u62e9\u3002","text":"<p>\u914d\u7f6e\u65b9\u6cd5\uff1a\u901a\u8fc7 resources.requests \u548c resources.limits \u5b9a\u4e49\u8d44\u6e90\u9700\u6c42\u3002</p> <p>\u573a\u666f\u793a\u4f8b\uff1a</p>"},{"location":"2025/3kubernetes/#1-guaranteed_1","title":"1. Guaranteed","text":"<pre><code>containers:\n- name: redis\n  resources:\n    requests:\n      cpu: \"1\"\n      memory: \"2Gi\"\n    limits:\n      cpu: \"1\"\n      memory: \"2Gi\"\n</code></pre> <p>\u9002\u7528\u573a\u666f\uff1aMySQL\u3001Redis \u7b49\u9700\u8981\u7a33\u5b9a\u8d44\u6e90\u7684\u670d\u52a1\u3002</p>"},{"location":"2025/3kubernetes/#2-burstable_1","title":"2. Burstable","text":"<pre><code>containers:\n- name: web\n  resources:\n    requests:\n      cpu: \"0.5\"\n      memory: \"1Gi\"\n    limits:\n      cpu: \"2\"\n      memory: \"4Gi\"\n</code></pre> <p>\u9002\u7528\u573a\u666f\uff1aWeb \u5e94\u7528\u9700\u5e94\u5bf9\u6d41\u91cf\u9ad8\u5cf0\u3002</p>"},{"location":"2025/3kubernetes/#3-besteffort_1","title":"3. BestEffort","text":"<pre><code>containers:\n- name: batch-job\n  resources: {} \n</code></pre> <p>\u9002\u7528\u573a\u666f\uff1a\u65e5\u5fd7\u6e05\u7406\u3001\u4e34\u65f6\u6570\u636e\u5206\u6790\u4efb\u52a1\u3002</p>"},{"location":"2025/3kubernetes/#5-pod-qos","title":"5 \u5982\u679c\u4e00\u4e2a Pod \u9891\u7e41\u91cd\u542f\uff0c\u5982\u4f55\u901a\u8fc7\u63a2\u9488\u548c QoS \u7b56\u7565\u6392\u67e5\u95ee\u9898\uff1f","text":""},{"location":"2025/3kubernetes/#1_2","title":"1. \u68c0\u67e5\u63a2\u9488\u914d\u7f6e","text":"<ul> <li>\u786e\u8ba4\u5b58\u6d3b\u63a2\u9488\u662f\u5426\u8fc7\u4e8e\u654f\u611f\uff08\u5982\u68c0\u6d4b\u95f4\u9694 periodSeconds \u8fc7\u77ed\uff09\u3002</li> <li>\u67e5\u770b\u65e5\u5fd7\u786e\u8ba4\u63a2\u9488\u5931\u8d25\u539f\u56e0\uff08\u5982 <code>/healthz</code> \u63a5\u53e3\u8d85\u65f6\uff09\u3002</li> </ul>"},{"location":"2025/3kubernetes/#2_2","title":"2. \u5206\u6790\u8d44\u6e90\u9650\u5236","text":"<ul> <li>\u68c0\u67e5 Pod \u7684 QoS \u7c7b\u522b\u662f\u5426\u4e3a BestEffort\uff0c\u5bfc\u81f4\u8d44\u6e90\u4e0d\u8db3\u88ab OOMKill\u3002</li> <li>\u8c03\u6574 requests/limits \u4e3a Burstable \u6216 Guaranteed\u3002</li> </ul>"},{"location":"2025/3kubernetes/#3_3","title":"3. \u67e5\u770b\u4e8b\u4ef6\u65e5\u5fd7","text":"<pre><code>kubectl describe pod &lt;pod-name&gt;\n</code></pre> <p>\u786e\u8ba4\u662f\u5426\u56e0\u8d44\u6e90\u4e0d\u8db3\uff08OutOfMemory\uff09\u6216\u63a2\u9488\u5931\u8d25\uff08Liveness probe failed\uff09\u89e6\u53d1\u91cd\u542f\u3002</p>"},{"location":"2025/3kubernetes/#6-qos","title":"6 \u5982\u4f55\u901a\u8fc7 QoS \u548c\u63a2\u9488\u4f18\u5316\u9ad8\u5bc6\u5ea6\u96c6\u7fa4\u7684\u8d44\u6e90\u5229\u7528\u7387\uff1f","text":"<p>\u7b56\u7565\uff1a</p> <ol> <li>\u4f18\u5148\u7ea7\u8c03\u5ea6\uff1a\u6838\u5fc3\u670d\u52a1\u8bbe\u4e3a Guaranteed\uff0c\u62a2\u5360\u8d44\u6e90\u80fd\u529b\u4f4e\u4f46\u7a33\u5b9a\u6027\u9ad8\u3002</li> <li>\u52a8\u6001\u8c03\u6574\uff1a\u4f7f\u7528 Vertical Pod Autoscaler\uff08VPA\uff09\u81ea\u52a8\u4f18\u5316 requests/limits\u3002</li> <li>\u63a2\u9488\u7cbe\u7ec6\u5316\uff1a<ul> <li>\u542f\u52a8\u63a2\u9488\u907f\u514d\u8fc7\u65e9\u68c0\u6d4b\u5bfc\u81f4\u91cd\u542f\u3002</li> <li>\u5c31\u7eea\u63a2\u9488\u786e\u4fdd\u4f9d\u8d56\u670d\u52a1\u5c31\u7eea\u540e\u518d\u63a5\u6536\u6d41\u91cf\u3002</li> </ul> </li> </ol>"},{"location":"2025/3kubernetes/#6-kubernetes","title":"6. \u5728 Kubernetes \u4e2d\uff0c\u5982\u4f55\u914d\u7f6e\u8d44\u6e90\u8bf7\u6c42\u548c\u9650\u5236\uff1f","text":"<p>\u8d44\u6e90\u8bf7\u6c42\u548c\u9650\u5236\u53ef\u4ee5\u5728 Pod \u7684\u5b9a\u4e49\u6587\u4ef6\u4e2d\u901a\u8fc7 resources \u5b57\u6bb5\u8fdb\u884c\u914d\u7f6e\u3002\u5b83\u5305\u62ec\u4e24\u90e8\u5206\uff1a</p> <ul> <li>\u8bf7\u6c42\uff08request\uff09\uff1a\u5bb9\u5668\u542f\u52a8\u65f6\u6240\u9700\u7684\u6700\u4f4e\u8d44\u6e90\u3002Kubernetes \u4f7f\u7528\u8bf7\u6c42\u6765\u51b3\u5b9a Pod \u8c03\u5ea6\u5230\u54ea\u4e2a\u8282\u70b9\u3002</li> <li>\u9650\u5236\uff08limit\uff09\uff1a\u5bb9\u5668\u80fd\u591f\u4f7f\u7528\u7684\u6700\u5927\u8d44\u6e90\u3002\u5f53\u5bb9\u5668\u8d85\u8fc7\u8fd9\u4e2a\u9650\u5236\u65f6\uff0cKubernetes \u4f1a\u9650\u5236\u5176\u8d44\u6e90\u4f7f\u7528\uff0c\u907f\u514d\u5f71\u54cd\u5176\u4ed6\u5bb9\u5668\u7684\u8fd0\u884c\u3002</li> </ul> <p>\u4f8b\u5982\uff1a</p> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: mypod\nspec:\n  containers:\n  - name: mycontainer\n    image: myimage\n    resources:\n      requests:\n        memory: \"64Mi\"\n        cpu: \"250m\"\n      limits:\n        memory: \"128Mi\"\n        cpu: \"500m\"\n</code></pre>"},{"location":"2025/3kubernetes/#7-kubernetes-horizontal-pod-autoscalerhpa","title":"7. Kubernetes \u4e2d\u7684 Horizontal Pod Autoscaler\uff08HPA\uff09\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff1f","text":"<p>Horizontal Pod Autoscaler\uff08HPA\uff09\u6839\u636e Pod \u7684 CPU \u4f7f\u7528\u7387\u6216\u5176\u4ed6\u81ea\u5b9a\u4e49\u6307\u6807\uff0c\u81ea\u52a8\u8c03\u6574 Pod \u7684\u526f\u672c\u6570\u3002</p> <p>HPA \u901a\u8fc7\u6301\u7eed\u76d1\u63a7\u6307\u6807\uff0c\u5e76\u6839\u636e\u8bbe\u5b9a\u7684\u9608\u503c\uff08\u5982 CPU \u6216\u5185\u5b58\uff09\u6765\u81ea\u52a8\u6269\u5c55\u6216\u7f29\u51cf Pod \u6570\u91cf\u3002</p> <p>\u914d\u7f6e HPA \u65f6\uff0c\u9700\u8981\u6307\u5b9a\u6700\u5c0f\u526f\u672c\u6570\u3001\u6700\u5927\u526f\u672c\u6570\u548c\u76ee\u6807\u6307\u6807\u3002</p> <p>\u4f8b\u5982\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a\u57fa\u4e8e CPU \u4f7f\u7528\u7387\u7684 HPA \u914d\u7f6e\u793a\u4f8b\uff1a</p> <pre><code>apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: myapp-hpa\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: myapp\n  minReplicas: 1\n  maxReplicas: 10\n  metrics:\ntype: Resource\nresource:\n  name: cpu\n  target:\n    type: Utilization\n    averageUtilization: 50\n</code></pre>"},{"location":"2025/3kubernetes/#kubernetes-pod","title":"Kubernetes \u4e2d\u5982\u4f55\u8fdb\u884c Pod \u5f39\u6027\u4f38\u7f29","text":"<p>Pod \u5f39\u6027\u4f38\u7f29\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u5b9e\u73b0\uff1a</p> <ul> <li>Horizontal Pod Autoscaler\uff08HPA\uff09\uff1a\u6839\u636e CPU\u3001\u5185\u5b58\u6216\u81ea\u5b9a\u4e49\u6307\u6807\u6765\u52a8\u6001\u589e\u52a0\u6216\u51cf\u5c11 Pod \u7684\u526f\u672c\u6570\u3002</li> <li>Vertical Pod Autoscaler\uff08VPA\uff09\uff1a\u6839\u636e Pod \u4f7f\u7528\u7684\u8d44\u6e90\u81ea\u52a8\u8c03\u6574\u5176 CPU \u548c\u5185\u5b58\u7684\u8bf7\u6c42\u548c\u9650\u5236\u3002</li> <li>Cluster Autoscaler\uff1a\u81ea\u52a8\u8c03\u6574\u96c6\u7fa4\u7684\u89c4\u6a21\uff0c\u6839\u636e\u8282\u70b9\u7684\u8d44\u6e90\u9700\u6c42\u81ea\u52a8\u589e\u52a0\u6216\u51cf\u5c11\u8282\u70b9\u7684\u6570\u91cf\u3002</li> </ul>"},{"location":"2025/3kubernetes/#kuernetes","title":"Kuernetes \u4e2d\u7684\u8d44\u6e90\u9650\u5236\u548c\u8bf7\u6c42\u8bbe\u7f6e\u4e3a\u4ec0\u4e48\u91cd\u8981\uff1f","text":"<p>\u8bbe\u7f6e\u8d44\u6e90\u8bf7\u6c42\u548c\u9650\u5236\u5bf9\u4e8e\u786e\u4fdd\u96c6\u7fa4\u8d44\u6e90\u5408\u7406\u5206\u914d\u975e\u5e38\u91cd\u8981</p> <ul> <li>\u8d44\u6e90\u8bf7\u6c42\uff1a\u786e\u4fdd\u6bcf\u4e2a\u5bb9\u5668\u5728\u8282\u70b9\u4e0a\u83b7\u5f97\u8db3\u591f\u7684\u8d44\u6e90\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u5e94\u7528\u7684\u6b63\u5e38\u8fd0\u884c\u3002</li> <li>\u8d44\u6e90\u9650\u5236\uff1a\u9632\u6b62\u5bb9\u5668\u4f7f\u7528\u8fc7\u591a\u8d44\u6e90\uff0c\u5f71\u54cd\u5176\u4ed6\u5bb9\u5668\u7684\u6b63\u5e38\u8fd0\u884c\u3002\u7279\u522b\u662f\u5728\u9ad8\u8d1f\u8f7d\u573a\u666f\u4e2d\uff0c\u5408\u7406\u8bbe\u7f6e\u8d44\u6e90\u9650\u5236\u53ef\u4ee5\u907f\u514d\u8d44\u6e90\u7ade\u4e89\uff0c\u4fdd\u8bc1\u6574\u4e2a\u7cfb\u7edf\u7684\u7a33\u5b9a\u6027\u3002</li> </ul>"},{"location":"2025/3kubernetes/#8-kubernetes","title":"8 \u5982\u4f55\u4f7f\u7528 Kubernetes \u8fdb\u884c\u8d44\u6e90\u9694\u79bb\uff1f","text":"<p>Kubernetes \u63d0\u4f9b\u4e86\u591a\u79cd\u65b9\u5f0f\u6765\u5b9e\u73b0\u8d44\u6e90\u9694\u79bb\uff1a</p> <ul> <li>Namespace\uff1a\u7528\u4e8e\u5c06\u96c6\u7fa4\u4e2d\u7684\u8d44\u6e90\u5212\u5206\u4e3a\u4e0d\u540c\u7684\u865a\u62df\u96c6\u7fa4\uff0c\u4e0d\u540c\u7684\u56e2\u961f\u6216\u5e94\u7528\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\u5de5\u4f5c\uff0c\u4e92\u4e0d\u5e72\u6270\u3002</li> <li>Resource Requests and Limits\uff1a\u901a\u8fc7\u8d44\u6e90\u8bf7\u6c42\u548c\u9650\u5236\u6765\u786e\u4fdd\u6bcf\u4e2a\u5bb9\u5668\u6709\u8db3\u591f\u7684\u8d44\u6e90\uff0c\u5e76\u9632\u6b62\u8d44\u6e90\u4e89\u593a\u3002</li> <li>Node Affinity and Taints/Tolerations\uff1a\u901a\u8fc7\u8282\u70b9\u4eb2\u548c\u6027\u3001\u6c61\u70b9\u548c\u5bb9\u5fcd\u5ea6\u6765\u9650\u5236\u67d0\u4e9b Pod \u53ea\u80fd\u5728\u7279\u5b9a\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u4ece\u800c\u5b9e\u73b0\u66f4\u7ec6\u7c92\u5ea6\u7684\u8d44\u6e90\u9694\u79bb\u3002</li> </ul>"},{"location":"2025/3kubernetes/#9-kubernetes-pod","title":"9. Kubernetes \u4e2d\u5982\u4f55\u5b9e\u73b0 Pod \u7684\u9ad8\u53ef\u7528\u6027\uff1f","text":"<p>Kubernetes \u63d0\u4f9b\u4e86\u591a\u79cd\u65b9\u5f0f\u6765\u786e\u4fdd Pod \u7684\u9ad8\u53ef\u7528\u6027\uff1a</p> <ul> <li>\u526f\u672c\u96c6\uff08ReplicaSet\uff09\uff1a\u901a\u8fc7 ReplicaSet \u6765\u786e\u4fdd\u67d0\u4e2a Pod \u7684\u526f\u672c\u6570\u59cb\u7ec8\u4fdd\u6301\u5728\u6307\u5b9a\u6570\u91cf\u3002ReplicaSet \u53ef\u4ee5\u81ea\u52a8\u521b\u5efa\u548c\u5220\u9664 Pod\uff0c\u4ee5\u786e\u4fdd\u6240\u9700\u6570\u91cf\u7684 Pod \u59cb\u7ec8\u8fd0\u884c\u3002</li> <li>\u90e8\u7f72\uff08Deployment\uff09\uff1aDeployment \u662f\u4e00\u79cd\u7ba1\u7406 Pod \u526f\u672c\u96c6\u7684\u63a7\u5236\u5668\uff0c\u652f\u6301\u6eda\u52a8\u66f4\u65b0\u548c\u56de\u6eda\uff0c\u786e\u4fdd\u670d\u52a1\u53ef\u7528\u3002</li> <li>Pod Disruption Budgets\uff08PDB\uff09\uff1a\u901a\u8fc7 Pod Disruption Budgets \u6765\u9650\u5236\u53ef\u4ee5\u540c\u65f6\u88ab\u4e2d\u65ad\u7684 Pod \u6570\u91cf\uff0c\u786e\u4fdd\u5728\u5347\u7ea7\u6216\u7ef4\u62a4\u65f6\uff0c\u81f3\u5c11\u6709\u4e00\u5b9a\u6570\u91cf\u7684 Pod \u5728\u8fd0\u884c\u3002</li> <li>\u591a\u8282\u70b9\u8c03\u5ea6\uff1a\u901a\u8fc7\u5206\u5e03\u5f0f\u8c03\u5ea6\u548c Affinity \u7b56\u7565\uff0c\u5c06 Pod \u8c03\u5ea6\u5230\u591a\u4e2a\u7269\u7406\u8282\u70b9\u4e0a\uff0c\u907f\u514d\u5355\u70b9\u6545\u969c\u3002</li> </ul>"},{"location":"2025/3kubernetes/#10-kubernetes","title":"10 Kubernetes \u5982\u4f55\u5904\u7406\u7f51\u7edc\u901a\u4fe1\uff1f","text":"<p>Kubernetes \u4f7f\u7528 CNI\uff08\u5bb9\u5668\u7f51\u7edc\u63a5\u53e3\uff09 \u6765\u5904\u7406\u7f51\u7edc\u901a\u4fe1\u3002\u4ee5\u4e0b\u662f Kubernetes \u7f51\u7edc\u7684\u5173\u952e\u6982\u5ff5\uff1a</p> <ul> <li>Pod \u7f51\u7edc\uff1a\u6bcf\u4e2a Pod \u5728\u96c6\u7fa4\u4e2d\u90fd\u6709\u81ea\u5df1\u7684 IP \u5730\u5740\uff0c\u6240\u6709 Pod \u90fd\u53ef\u4ee5\u76f4\u63a5\u76f8\u4e92\u901a\u4fe1\uff0c\u65e0\u9700 NAT\u3002Kubernetes \u901a\u8fc7 CNI \u63d2\u4ef6\uff08\u5982 Calico\u3001Flannel\u3001Weave\uff09\u5b9e\u73b0 Pod \u7f51\u7edc\u3002</li> <li>\u670d\u52a1\uff08Service\uff09\uff1aKubernetes \u4e2d\u7684\u670d\u52a1\u63d0\u4f9b\u4e86\u5bf9\u5916\u66b4\u9732\u5e94\u7528\u7684\u65b9\u5f0f\uff0c\u4f7f\u7528\u670d\u52a1\u7684 ClusterIP\u3001NodePort \u6216 LoadBalancer \u7c7b\u578b\uff0c\u53ef\u4ee5\u4f7f Pod \u5bf9\u5916\u53ef\u8bbf\u95ee\u3002</li> <li>DNS\uff1aKubernetes \u96c6\u7fa4\u5185\u81ea\u52a8\u4e3a\u6bcf\u4e2a\u670d\u52a1\u5206\u914d\u4e00\u4e2a DNS \u540d\u79f0\uff0c\u4f7f\u5f97 Pod \u901a\u8fc7 DNS \u8fdb\u884c\u670d\u52a1\u53d1\u73b0\u548c\u901a\u4fe1</li> </ul>"},{"location":"2025/3kubernetes/#11-kubernetes-resource-quota","title":"11 Kubernetes \u4e2d\u5982\u4f55\u8fdb\u884c\u8d44\u6e90\u7684\u9650\u989d\u7ba1\u7406\uff08Resource Quota\uff09","text":"<p>\u8d44\u6e90\u914d\u989d\uff08ResourceQuota\uff09\u7528\u4e8e\u9650\u5236\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u4e2d\u53ef\u4ee5\u4f7f\u7528\u7684\u8d44\u6e90\u91cf\uff0c\u907f\u514d\u5355\u4e2a\u56e2\u961f\u6216\u5e94\u7528\u6d88\u8017\u8fc7\u591a\u8d44\u6e90\uff0c\u5f71\u54cd\u96c6\u7fa4\u7684\u7a33\u5b9a\u6027\u3002\u901a\u8fc7\u5b9a\u4e49\u8d44\u6e90\u914d\u989d\u6765\u7ba1\u7406 CPU\u3001\u5185\u5b58\u3001Pod \u6570\u91cf\u7b49</p> <p>\u4f8b\u5982\uff1a</p> <pre><code>apiVersion: v1\nkind: ResourceQuota\nmetadata:\n  name: example-quota\nspec:\n  hard:\n    cpu: \"10\"\n    memory: 50Gi\n    pods: \"10\"\n</code></pre>"},{"location":"2025/3kubernetes/#12-kubernetes-taints-tolerations","title":"12. Kubernetes \u4e2d\u7684 Taints \u548c Tolerations \u5982\u4f55\u5de5\u4f5c\uff1f","text":"<p>Taints \u548c Tolerations \u662f Kubernetes \u7528\u6765\u63a7\u5236 Pod \u8c03\u5ea6\u7684\u673a\u5236\uff1a</p> <ul> <li>Taints\uff1a\u662f\u8282\u70b9\u4e0a\u8bbe\u7f6e\u7684\u6807\u8bb0\uff0c\u8868\u793a\u67d0\u4e9b Pod \u4e0d\u5e94\u8be5\u8c03\u5ea6\u5230\u8be5\u8282\u70b9\uff0c\u9664\u975e\u5b83\u4eec\u80fd\u591f\u5bb9\u5fcd\u8fd9\u4e2a taint\u3002Taints \u5b9a\u4e49\u4e86\u8282\u70b9\u7684\u201c\u6c61\u70b9\u201d\u3002</li> <li>Tolerations\uff1a\u662f Pod \u4e0a\u8bbe\u7f6e\u7684\u6807\u8bb0\uff0c\u8868\u793a\u8be5 Pod \u53ef\u4ee5\u5bb9\u5fcd\u67d0\u4e9b\u8282\u70b9\u4e0a\u7684 Taints\u3002\u53ea\u6709\u5f53 Pod \u80fd\u591f\u5bb9\u5fcd\u8282\u70b9\u4e0a\u7684 Taints \u65f6\uff0c\u624d\u80fd\u8c03\u5ea6\u5230\u8be5\u8282\u70b9\u3002</li> </ul> <p>\u901a\u8fc7 Taints \u548c Tolerations\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5bf9\u7279\u5b9a\u8282\u70b9\u7684\u8c03\u5ea6\u63a7\u5236\uff0c\u5982\u907f\u514d\u5c06\u67d0\u4e9b Pod \u8c03\u5ea6\u5230\u8d44\u6e90\u7d27\u5f20\u6216\u4e0d\u5408\u9002\u7684\u8282\u70b9\u4e0a\u3002</p>"},{"location":"2025/3kubernetes/#13-kubernetes-service-discovery","title":"13 Kubernetes \u4e2d\u5982\u4f55\u5b9e\u73b0\u670d\u52a1\u53d1\u73b0\uff08Service Discovery\uff09\uff1f","text":"<p>DNS \u6765\u5b9e\u73b0\u670d\u52a1\u53d1\u73b0\uff0c\u6bcf\u4e2a\u670d\u52a1\u90fd\u4f1a\u81ea\u52a8\u5206\u914d\u4e00\u4e2a DNS \u540d\u79f0\uff0c\u5176\u4ed6 Pod \u53ef\u4ee5\u901a\u8fc7\u8be5\u540d\u79f0\u8bbf\u95ee\u8be5\u670d\u52a1\u3002\u4f8b\u5982\uff0c\u5982\u679c\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3a myapp \u7684\u670d\u52a1\uff0c\u5b83\u4f1a\u81ea\u52a8\u5728 DNS \u4e2d\u5206\u914d\u4e00\u4e2a myapp.default.svc.cluster.local \u7684\u5730\u5740\uff0c\u96c6\u7fa4\u5185\u7684\u5176\u4ed6 Pod \u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u5730\u5740\u8bbf\u95ee\u8be5\u670d\u52a1\u3002</p>"},{"location":"2025/3kubernetes/#14-kubernetes-pod","title":"14. Kubernetes \u7684 Pod \u751f\u547d\u5468\u671f\u662f\u5982\u4f55\u7ba1\u7406\u7684\uff1f","text":"<p>Kubernetes Pod \u7684\u751f\u547d\u5468\u671f\u5305\u62ec\u4ee5\u4e0b\u51e0\u4e2a\u9636\u6bb5\uff1a</p> <ul> <li>Pending\uff1aPod \u5df2\u88ab\u8c03\u5ea6\u5230\u8282\u70b9\uff0c\u4f46\u5bb9\u5668\u8fd8\u6ca1\u6709\u542f\u52a8\u3002</li> <li>Running\uff1aPod \u7684\u5bb9\u5668\u5df2\u7ecf\u542f\u52a8\u5e76\u6b63\u5728\u8fd0\u884c\u3002</li> <li>Succeeded\uff1aPod \u4e2d\u7684\u6240\u6709\u5bb9\u5668\u90fd\u6210\u529f\u7ec8\u6b62\u5e76\u5b8c\u6210\u4efb\u52a1\u3002</li> <li>Failed\uff1aPod \u4e2d\u7684\u5bb9\u5668\u5df2\u7ec8\u6b62\u4e14\u5931\u8d25\uff0c\u65e0\u6cd5\u91cd\u65b0\u542f\u52a8\u3002</li> <li>Unknown\uff1aKubernetes \u65e0\u6cd5\u786e\u5b9a Pod \u7684\u72b6\u6001\uff0c\u901a\u5e38\u662f\u7531\u4e8e\u4e0e\u8282\u70b9\u7684\u901a\u4fe1\u5931\u8d25\u3002</li> </ul> <p>Kubernetes \u901a\u8fc7\u63a7\u5236\u5668\uff08\u5982 Deployment\u3001StatefulSet \u7b49\uff09\u6765\u7ba1\u7406 Pod \u7684\u751f\u547d\u5468\u671f\uff0c\u786e\u4fdd\u5728 Pod \u5931\u8d25\u6216\u88ab\u5220\u9664\u65f6\uff0c\u53ef\u4ee5\u81ea\u52a8\u6062\u590d\u6216\u521b\u5efa\u65b0\u7684 Pod\u3002</p>"},{"location":"2025/3kubernetes/#15-kubernetes-networkpolicy","title":"15. Kubernetes \u4e2d\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u7b56\u7565\uff08NetworkPolicy\uff09\uff1f","text":"<p>NetworkPolicy \u7528\u4e8e\u63a7\u5236 Pod \u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u901a\u8fc7\u5b9a\u4e49\u89c4\u5219\u6765\u9650\u5236\u6216\u5141\u8bb8\u6d41\u91cf\u3002\u524d\u63d0\u662f\u4f60\u7684 CNI \u652f\u6301 NetworkPolicy\uff0c\u6bd4\u5982 Calico \u5c31\u652f\u6301</p> <p>\u5b83\u53ef\u4ee5\u57fa\u4e8e Pod \u6807\u7b7e\u3001\u547d\u540d\u7a7a\u95f4\u3001IP \u5730\u5740\u7b49\u8fdb\u884c\u8bbf\u95ee\u63a7\u5236\u3002\u5b83\u652f\u6301 Ingress\uff08\u6d41\u5165\uff09\u548c Egress\uff08\u6d41\u51fa\uff09\u89c4\u5219\u3002 </p> <p>\u4f8b\u5982\uff0c\u5141\u8bb8\u53ea\u6709\u6807\u7b7e\u4e3a role=frontend \u7684 Pod \u53ef\u4ee5\u8bbf\u95ee\u6807\u7b7e\u4e3a role=backend \u7684 Pod</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: allow-frontend-to-backend\nspec:\n  podSelector:\n    matchLabels:\n      role: backend\n  ingress:\n  - from:\n    - podSelector:\n        matchLabels:\n          role: frontend\n</code></pre>"},{"location":"2025/3kubernetes/#16-kubernetes","title":"16 Kubernetes \u4e2d\u5982\u4f55\u5904\u7406\u8282\u70b9\u6545\u969c\uff1f","text":"<p>Kubernetes \u4f7f\u7528\u8282\u70b9\u76d1\u63a7\u548c\u8c03\u5ea6\u7b56\u7565\u6765\u5904\u7406\u8282\u70b9\u6545\u969c\uff1a</p> <ul> <li>\u8282\u70b9\u76d1\u63a7\uff1aKubernetes \u7684 kubelet \u7ec4\u4ef6\u5b9a\u671f\u5411 master \u8282\u70b9\u62a5\u544a\u8282\u70b9\u72b6\u6001\uff0c\u5982\u679c\u67d0\u4e2a\u8282\u70b9\u957f\u65f6\u95f4\u65e0\u6cd5\u4e0e master \u8282\u70b9\u901a\u4fe1\uff0cKubernetes \u4f1a\u6807\u8bb0\u8be5\u8282\u70b9\u4e3a\u4e0d\u53ef\u7528\uff08NotReady\uff09\u3002</li> <li>Pod \u91cd\u65b0\u8c03\u5ea6\uff1a\u5f53\u8282\u70b9\u53d1\u751f\u6545\u969c\uff0c\u8c03\u5ea6\u5668\u4f1a\u91cd\u65b0\u5c06 Pod \u8c03\u5ea6\u5230\u5176\u4ed6\u5065\u5eb7\u8282\u70b9\u4e0a\u3002\u4e3a\u4e86\u4fdd\u8bc1 Pod \u9ad8\u53ef\u7528\uff0c\u53ef\u4ee5\u914d\u7f6e PodDisruptionBudget \u548c ReplicaSet\uff0c\u786e\u4fdd Pod \u53ef\u4ee5\u5728\u5176\u4ed6\u8282\u70b9\u4e0a\u8fd0\u884c\u3002</li> </ul>"},{"location":"2025/3kubernetes/#17-kubernetes-statefulset-deployment","title":"17. Kubernetes \u4e2d\u7684 StatefulSet \u4e0e Deployment \u6709\u4ec0\u4e48\u533a\u522b\uff1f","text":"<p>StatefulSet \u548c Deployment \u90fd\u662f\u7528\u4e8e\u7ba1\u7406 Pod \u7684\u63a7\u5236\u5668\uff0c\u4f46\u5b83\u4eec\u9002\u7528\u4e8e\u4e0d\u540c\u7c7b\u578b\u7684\u5e94\u7528\uff1a</p> <ul> <li>Deployment\uff1a\u9002\u7528\u4e8e\u65e0\u72b6\u6001\u5e94\u7528\uff0cPod \u7684\u526f\u672c\u53ef\u4ee5\u76f8\u4e92\u66ff\u6362\uff0cPod \u7684\u540d\u5b57\u548c\u987a\u5e8f\u6ca1\u6709\u91cd\u8981\u610f\u4e49\u3002</li> <li>StatefulSet\uff1a\u9002\u7528\u4e8e\u6709\u72b6\u6001\u5e94\u7528\uff0c<ul> <li>\u9700\u8981\u4fdd\u6301 Pod \u7684\u552f\u4e00\u6807\u8bc6\u548c\u987a\u5e8f\u3002StatefulSet \u4f1a\u4e3a\u6bcf\u4e2a Pod \u63d0\u4f9b\u4e00\u4e2a\u7a33\u5b9a\u7684\u6301\u4e45\u5b58\u50a8\u548c\u7f51\u7edc\u6807\u8bc6\u3002</li> </ul> </li> </ul>"},{"location":"2025/3kubernetes/#18-kubernetes-persistentvolumepv-persistentvolumeclaimpvc","title":"18 Kubernetes \u4e2d\u7684 PersistentVolume\uff08PV\uff09\u548c PersistentVolumeClaim\uff08PVC\uff09\u662f\u4ec0\u4e48\uff1f\u5b83\u4eec\u5982\u4f55\u5de5\u4f5c\uff1f","text":"<p>Kubernetes \u4e2d\u7684 PersistentVolume\uff08PV\uff09 \u548c PersistentVolumeClaim\uff08PVC\uff09 \u662f\u7528\u4e8e\u7ba1\u7406\u6301\u4e45\u5b58\u50a8\u7684\u8d44\u6e90\uff1a</p> <ul> <li>PersistentVolume\uff08PV\uff09\uff1a\u662f\u96c6\u7fa4\u4e2d\u7684\u4e00\u4e2a\u5b58\u50a8\u8d44\u6e90\uff0c\u5b83\u8868\u793a\u4e00\u4e2a\u5177\u4f53\u7684\u5b58\u50a8\u8bbe\u5907\uff0c\u53ef\u80fd\u662f\u4e00\u4e2a NFS \u5b58\u50a8\u3001\u4e91\u5b58\u50a8\uff08\u5982 AWS EBS\uff09\u6216\u672c\u5730\u78c1\u76d8\u7b49\u3002</li> <li>PersistentVolumeClaim\uff08PVC\uff09\uff1a\u662f\u7528\u6237\u5411 Kubernetes \u7533\u8bf7\u6301\u4e45\u5b58\u50a8\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5b83\u5b9a\u4e49\u4e86\u6240\u9700\u5b58\u50a8\u7684\u5927\u5c0f\u3001\u8bbf\u95ee\u6a21\u5f0f\u7b49\u8981\u6c42\u3002Kubernetes \u6839\u636e PVC \u81ea\u52a8\u7ed1\u5b9a\u9002\u5f53\u7684 PV\u3002</li> </ul>"},{"location":"2025/3kubernetes/#19-kubernetes","title":"19. Kubernetes \u4e2d\u7684\u76d1\u63a7\u548c\u65e5\u5fd7\u5982\u4f55\u7ed3\u5408\u4f7f\u7528\uff1f","text":"<p>Kubernetes \u7684\u76d1\u63a7\u548c\u65e5\u5fd7\u7ed3\u5408\u4f7f\u7528\u53ef\u4ee5\u5e2e\u52a9\u5f00\u53d1\u548c\u8fd0\u7ef4\u4eba\u5458\u66f4\u597d\u5730\u638c\u63e1\u96c6\u7fa4\u72b6\u6001\u548c\u6545\u969c\u6392\u67e5\uff1a</p> <ul> <li>\u76d1\u63a7\uff1a\u4f7f\u7528 Prometheus \u6765\u6536\u96c6\u96c6\u7fa4\u548c\u5e94\u7528\u7684\u6307\u6807\uff08\u5982 CPU\u3001\u5185\u5b58\u3001\u7f51\u7edc\u6d41\u91cf\u7b49\uff09\uff0c\u901a\u8fc7 Grafana \u53ef\u89c6\u5316\u5c55\u793a\u3002</li> <li>\u65e5\u5fd7\u7ba1\u7406\uff1a\u4f7f\u7528 ELK Stack\uff08Elasticsearch\u3001Logstash\u3001Kibana\uff09\u6765\u96c6\u4e2d\u7ba1\u7406\u548c\u67e5\u8be2 Kubernetes \u7684\u65e5\u5fd7\u3002</li> <li>\u96c6\u6210\uff1a\u5c06 Prometheus \u548c Grafana \u4e0e\u65e5\u5fd7\u7ba1\u7406\u5de5\u5177\uff08\u5982 Fluentd \u6216 Filebeat\uff09\u96c6\u6210\uff0c\u901a\u8fc7\u7edf\u4e00\u7684\u9762\u677f\u548c\u62a5\u8b66\u7cfb\u7edf\uff0c\u63d0\u9ad8\u76d1\u63a7\u548c\u65e5\u5fd7\u7684\u54cd\u5e94\u6548\u7387</li> </ul>"},{"location":"2025/3kubernetes/#20-kubernetes","title":"20. Kubernetes \u4e2d\u5982\u4f55\u5904\u7406\u5b58\u50a8\u8d44\u6e90\u7684\u52a8\u6001\u4f9b\u7ed9\uff1f","text":"<p>Kubernetes \u901a\u8fc7 StorageClass \u548c \u52a8\u6001\u5b58\u50a8\u4f9b\u7ed9\uff08Dynamic Provisioning\uff09 \u5b9e\u73b0\u5b58\u50a8\u8d44\u6e90\u7684\u81ea\u52a8\u5316\u7ba1\u7406\u3002\u901a\u8fc7\u5b9a\u4e49 StorageClass\uff0c\u7528\u6237\u53ef\u4ee5\u81ea\u52a8\u4e3a PVC \u7533\u8bf7\u5408\u9002\u7684\u5b58\u50a8\u7c7b\u578b\uff08\u5982 SSD\u3001HDD \u6216\u4e91\u5b58\u50a8\uff09\u3002</p> <p>\u4f7f\u7528 StorageClass\uff0c\u53ef\u4ee5\u5b9a\u4e49\u4e0d\u540c\u5b58\u50a8\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5e76\u5728 PVC \u4e2d\u6307\u5b9a\u8be5 StorageClass\uff0cKubernetes \u4f1a\u6839\u636e\u8be5\u914d\u7f6e\u81ea\u52a8\u521b\u5efa\u548c\u7ed1\u5b9a PV\u3002</p>"},{"location":"2025/3kubernetes/#21-kubernetes-affinity-anti-affinity","title":"21. Kubernetes \u4e2d\u7684 Affinity \u548c Anti-Affinity \u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff1f","text":"<p>Kubernetes \u4e2d\u7684 Affinity \u548c Anti-Affinity \u662f\u63a7\u5236 Pod \u8c03\u5ea6\u7b56\u7565\u7684\u673a\u5236\uff0c\u7528\u4e8e\u6307\u5b9a Pod \u5728\u8282\u70b9\u4e0a\u7684\u8c03\u5ea6\u89c4\u5219\uff1a</p> <ul> <li>Affinity\uff1a\u5141\u8bb8\u6307\u5b9a Pod \u5728\u76f8\u540c\u8282\u70b9\u4e0a\u8c03\u5ea6\uff0c\u6216\u5728\u7279\u5b9a\u6761\u4ef6\u4e0b\u4e0e\u5176\u4ed6 Pod \u8c03\u5ea6\u5728\u4e00\u8d77\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u4f7f\u7528 nodeAffinity \u8ba9 Pod \u53ea\u8c03\u5ea6\u5230\u7279\u5b9a\u6807\u7b7e\u7684\u8282\u70b9\u4e0a\u3002</li> <li>Anti-Affinity\uff1a\u7528\u4e8e\u786e\u4fdd Pod \u4e0d\u4e0e\u5176\u4ed6\u6307\u5b9a\u7684 Pod \u8c03\u5ea6\u5728\u540c\u4e00\u8282\u70b9\u6216\u540c\u4e00\u53ef\u7528\u533a\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u786e\u4fdd\u67d0\u4e9b Pod \u5728\u4e0d\u540c\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u4ee5\u907f\u514d\u5355\u70b9\u6545\u969c\u3002</li> </ul>"},{"location":"2025/3kubernetes/#22-kubernetes-pod","title":"22 Kubernetes \u4e2d\u5982\u4f55\u5904\u7406 Pod \u7684\u4f18\u5148\u7ea7\u548c\u62a2\u5360\uff1f","text":"<p>Kubernetes \u652f\u6301\u901a\u8fc7 PodPriority \u548c PriorityClass \u6765\u8bbe\u7f6e Pod \u7684\u4f18\u5148\u7ea7\u3002\u9ad8\u4f18\u5148\u7ea7\u7684 Pod \u53ef\u4ee5\u62a2\u5360\u4f4e\u4f18\u5148\u7ea7\u7684 Pod \u8d44\u6e90\uff0c\u786e\u4fdd\u5173\u952e\u670d\u52a1\u4f18\u5148\u8fd0\u884c</p> <ul> <li>PriorityClass\uff1a\u901a\u8fc7\u4e3a Pod \u8bbe\u7f6e\u4e0d\u540c\u7684\u4f18\u5148\u7ea7\uff0c\u63a7\u5236 Pod \u5728\u8d44\u6e90\u4e89\u593a\u65f6\u7684\u8c03\u5ea6\u987a\u5e8f\u3002</li> <li>Pod\u62a2\u5360\uff1a\u5982\u679c\u96c6\u7fa4\u8d44\u6e90\u7d27\u5f20\uff0cKubernetes \u4f1a\u7ec8\u6b62\u4f18\u5148\u7ea7\u8f83\u4f4e\u7684 Pod \u6765\u4e3a\u9ad8\u4f18\u5148\u7ea7\u7684 Pod \u63d0\u4f9b\u8d44\u6e90</li> </ul>"},{"location":"2025/3kubernetes/#23-kubernetes-ingress-egress","title":"23 Kubernetes \u4e2d\u7684 Ingress \u548c Egress \u662f\u5982\u4f55\u63a7\u5236\u6d41\u91cf\u7684\uff1f","text":"<p>Kubernetes \u63d0\u4f9b\u4e86 Ingress \u548c Egress \u63a7\u5236\u6d41\u91cf\u8fdb\u51fa\u96c6\u7fa4\u7684\u65b9\u5f0f\uff1a</p> <ul> <li>Ingress\uff1a\u662f\u4e00\u79cd API \u8d44\u6e90\uff0c\u5141\u8bb8\u5916\u90e8\u6d41\u91cf\u901a\u8fc7 HTTP/HTTPS \u8bbf\u95ee Kubernetes \u5185\u90e8\u670d\u52a1\u3002Ingress \u901a\u5e38\u7531 Ingress Controller \u5b9e\u73b0\uff08\u5982 Nginx Ingress Controller\uff09\u3002</li> <li>Egress\uff1a\u662f\u96c6\u7fa4\u5185\u7684 Pod \u53d1\u8d77\u7684\u6d41\u91cf\u8bbf\u95ee\u5916\u90e8\u7f51\u7edc\u3002\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e NetworkPolicy \u6765\u63a7\u5236 Pod \u7684\u51fa\u7ad9\u6d41\u91cf\uff0c\u9650\u5236\u54ea\u4e9b Pod \u53ef\u4ee5\u8bbf\u95ee\u5916\u90e8\u670d\u52a1\u3002</li> </ul>"},{"location":"2025/3kubernetes/#24-kubernetes-rbacrole-based-access-control","title":"24 Kubernetes \u4e2d\u7684 RBAC\uff08Role-Based Access Control\uff09\u5982\u4f55\u63a7\u5236\u6743\u9650\uff1f","text":"<p>RBAC \u662f Kubernetes \u4e2d\u7684\u6743\u9650\u7ba1\u7406\u7cfb\u7edf\uff0c\u7528\u4e8e\u63a7\u5236\u7528\u6237\u6216\u670d\u52a1\u8d26\u6237\u5728\u96c6\u7fa4\u4e2d\u7684\u64cd\u4f5c\u6743\u9650\u3002RBAC \u901a\u8fc7\u5b9a\u4e49 Role \u548c RoleBinding \u6765\u6388\u4e88\u6743\u9650</p> <ul> <li>Role\uff1a\u5b9a\u4e49\u5728\u67d0\u4e2a\u547d\u540d\u7a7a\u95f4\u5185\u7684\u6743\u9650\uff0c\u5982\u8bbf\u95ee\u8d44\u6e90\u7684\u6743\u9650\uff08Pods\u3001Services \u7b49\uff09\u3002</li> <li>ClusterRole\uff1a\u5b9a\u4e49\u96c6\u7fa4\u8303\u56f4\u5185\u7684\u6743\u9650\u3002</li> <li>RoleBinding \u548c ClusterRoleBinding\uff1a\u5c06 Role \u6216 ClusterRole \u7ed1\u5b9a\u5230\u7279\u5b9a\u7684\u7528\u6237\u6216\u670d\u52a1\u8d26\u6237</li> </ul>"},{"location":"2025/3kubernetes/#25-kubernetes","title":"25. Kubernetes \u4e2d\u5982\u4f55\u5904\u7406\u4e8b\u4ef6\u65e5\u5fd7\uff1f","text":"<p>Kubernetes \u4e2d\u7684\u4e8b\u4ef6\u65e5\u5fd7\u7528\u4e8e\u8bb0\u5f55\u96c6\u7fa4\u72b6\u6001\u548c\u5404\u7c7b\u4e8b\u4ef6\uff0c\u5982 Pod \u542f\u52a8\u3001\u5bb9\u5668\u91cd\u542f\u3001\u8d44\u6e90\u9650\u5236\u7b49\u3002\u53ef\u4ee5\u4f7f\u7528 kubectl get events \u547d\u4ee4\u67e5\u770b\u4e8b\u4ef6\u65e5\u5fd7\u3002</p> <ul> <li>Kubernetes \u4e2d\u7684\u4e8b\u4ef6\u662f\u7531 Kubelet\u3001Controller Manager \u7b49\u7ec4\u4ef6\u751f\u6210\u7684\u3002</li> <li>\u96c6\u6210\u65e5\u5fd7\u7ba1\u7406\uff1a\u53ef\u4ee5\u4f7f\u7528 Fluentd\u3001Elasticsearch \u548c Kibana\uff08ELK Stack\uff09 \u7b49\u5de5\u5177\u6765\u96c6\u4e2d\u7ba1\u7406\u548c\u5206\u6790 Kubernetes \u4e8b\u4ef6\u65e5\u5fd7\u3002</li> </ul>"},{"location":"2025/3kubernetes/#26-kubernetes-poddisruptionbudgetpdb","title":"26. Kubernetes \u4e2d\u7684 PodDisruptionBudget\uff08PDB\uff09\u662f\u4ec0\u4e48\uff1f\u5982\u4f55\u4f7f\u7528\uff1f","text":"<p>PodDisruptionBudget\uff08PDB\uff09</p> <p>\u7528\u4e8e\u63a7\u5236 Pod \u7684\u53ef\u4e2d\u65ad\u6027\uff0c\u786e\u4fdd\u5728\u5347\u7ea7\u6216\u7ef4\u62a4\u65f6\u81f3\u5c11\u6709\u4e00\u5b9a\u6570\u91cf\u7684 Pod \u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u3002</p> <p>PDB \u901a\u8fc7\u5b9a\u4e49 maxUnavailable \u6216 minAvailable \u6765\u4fdd\u8bc1\u5728\u5141\u8bb8\u7684\u8303\u56f4\u5185\uff0cPod \u53ef\u4ee5\u88ab\u4e2d\u65ad\u3002</p> <p>\u4f8b\u5982\uff0c\u8bbe\u7f6e\u4e00\u4e2a PDB\uff0c\u786e\u4fdd\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a Pod \u88ab\u4e2d\u65ad\uff1a</p> <pre><code>apiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: myapp-pdb\nspec:\n  minAvailable: 2\n  selector:\n    matchLabels:\n      app: myapp\n</code></pre>"},{"location":"2025/3kubernetes/#27-kubernetes-resource-manager","title":"27 Kubernetes \u4e2d\u7684\u8d44\u6e90\u7ba1\u7406\u5668\uff08Resource Manager\uff09\u5982\u4f55\u786e\u4fdd\u96c6\u7fa4\u8d44\u6e90\u7684\u516c\u5e73\u5206\u914d\uff1f","text":"<p>Kubernetes \u7684\u8d44\u6e90\u7ba1\u7406\u5668\uff08Scheduler\uff09 \u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u786e\u4fdd\u8d44\u6e90\u7684\u516c\u5e73\u5206\u914d\uff1a</p> <ul> <li>\u8d44\u6e90\u8bf7\u6c42\u548c\u9650\u5236\uff1a\u6bcf\u4e2a Pod \u5728\u8c03\u5ea6\u65f6\uff0cKubernetes \u4f1a\u6839\u636e\u8d44\u6e90\u8bf7\u6c42\u548c\u9650\u5236\u6765\u9009\u62e9\u6700\u5408\u9002\u7684\u8282\u70b9\u3002</li> <li>QoS \u7b56\u7565\uff1a\u901a\u8fc7 QoS \u7c7b\u522b\uff08Guaranteed\u3001Burstable\u3001BestEffort\uff09\u6765\u7ba1\u7406 Pod \u7684\u4f18\u5148\u7ea7\u548c\u8d44\u6e90\u5206\u914d\u3002</li> <li>\u8c03\u5ea6\u7b56\u7565\uff1a\u5982\u8d44\u6e90\u4eb2\u548c\u6027\u3001\u8282\u70b9\u4eb2\u548c\u6027\u7b49\uff0c\u5e2e\u52a9\u5728\u8d44\u6e90\u6709\u9650\u7684\u60c5\u51b5\u4e0b\uff0c\u505a\u51fa\u6700\u5408\u9002\u7684\u8d44\u6e90\u8c03\u5ea6\u51b3\u7b56\u3002</li> </ul>"},{"location":"2025/3kubernetes/#28-four-types-of-k8s-services","title":"28 Four types of k8s services","text":"<p>\u6211\u4eec\u5728\u5b9a\u4e49<code>Service</code>\u7684\u65f6\u5019\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u81ea\u5df1\u9700\u8981\u7684\u7c7b\u578b\u7684<code>Service</code>\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\u7684\u8bdd\u9ed8\u8ba4\u662f<code>ClusterIP</code>\u7c7b\u578b\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7684\u670d\u52a1\u7c7b\u578b\u5982\u4e0b\uff1a</p> <ul> <li><code>ClusterIP</code>\uff1a\u901a\u8fc7\u96c6\u7fa4\u7684\u5185\u90e8 IP \u66b4\u9732\u670d\u52a1\uff0c\u9009\u62e9\u8be5\u503c\uff0c\u670d\u52a1\u53ea\u80fd\u591f\u5728\u96c6\u7fa4\u5185\u90e8\u53ef\u4ee5\u8bbf\u95ee\uff0c\u8fd9\u4e5f\u662f\u9ed8\u8ba4\u7684<code>ServiceType</code>\u3002</li> <li><code>NodePort</code>\uff1a\u901a\u8fc7\u6bcf\u4e2a <code>Node\u8282\u70b9\u4e0a\u7684IP</code> \u548c <code>\u9759\u6001\u7aef\u53e3\uff08NodePort\uff09</code> \u66b4\u9732\u670d\u52a1\u3002NodePort \u670d\u52a1\u4f1a\u8def\u7531\u5230 ClusterIP \u670d\u52a1\uff0c\u8fd9\u4e2a ClusterIP \u670d\u52a1\u4f1a\u81ea\u52a8\u521b\u5efa\u3002\u901a\u8fc7\u8bf7\u6c42 : \u53ef\u4ee5\u4ece\u96c6\u7fa4\u7684\u5916\u90e8\u8bbf\u95ee\u4e00\u4e2a NodePort \u670d\u52a1\u3002</li> <li><code>LoadBalancer</code>\uff1a\u4f7f\u7528\u4e91\u63d0\u4f9b\u5546\u7684\u8d1f\u8f7d\u5c40\u8861\u5668\uff0c\u53ef\u4ee5\u5411\u5916\u90e8\u66b4\u9732\u670d\u52a1\u3002\u5916\u90e8\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u53ef\u4ee5\u8def\u7531\u5230 <code>NodePort</code> \u670d\u52a1\u548c <code>ClusterIP</code> \u670d\u52a1\uff0c\u8fd9\u4e2a\u9700\u8981\u7ed3\u5408\u5177\u4f53\u7684\u4e91\u5382\u5546\u8fdb\u884c\u64cd\u4f5c\u3002</li> <li><code>ExternalName</code>\uff1a\u901a\u8fc7\u8fd4\u56de CNAME \u548c\u5b83\u7684\u503c\uff0c\u53ef\u4ee5\u5c06\u670d\u52a1\u6620\u5c04\u5230 <code>externalName</code> \u5b57\u6bb5\u7684\u5185\u5bb9\uff08\u4f8b\u5982\uff0c <code>foo.bar.example.com</code>\uff09\u3002\u6ca1\u6709\u4efb\u4f55\u7c7b\u578b\u4ee3\u7406\u88ab\u521b\u5efa\uff0c\u8fd9\u53ea\u6709 Kubernetes 1.7 \u6216\u66f4\u9ad8\u7248\u672c\u7684 kube-dns \u624d\u652f\u6301\u3002</li> </ul>"},{"location":"2025/3kubernetes/#29-k8s-service-ependpoints","title":"29 k8s \u7684 <code>service</code> \u548c <code>ep(endpoints)</code> \u662f\u5982\u4f55\u5173\u8054\u548c\u76f8\u4e92\u5f71\u54cd\u7684\u3002","text":"<p><code>Service</code>\u662f\u5bf9\u4e00\u7ec4\u63d0\u4f9b\u76f8\u540c\u529f\u80fd\u7684<code>Pods</code>\u7684\u62bd\u8c61\uff0c\u5e76\u4e3a\u5b83\u4eec\u63d0\u4f9b\u4e00\u4e2a\u7edf\u4e00\u7684\u5165\u53e3\u3002</p> <p>\u501f\u52a9Service\uff0c\u5e94\u7528\u53ef\u4ee5\u65b9\u4fbf\u7684\u5b9e\u73b0\u670d\u52a1\u53d1\u73b0\u4e0e\u8d1f\u8f7d\u5747\u8861\uff0c\u5e76\u5b9e\u73b0\u5e94\u7528\u7684\u96f6\u5b95\u673a\u5347\u7ea7\u3002</p> <ul> <li><code>Service</code>\u901a\u8fc7\u6807\u7b7e\u6765\u9009\u53d6\u670d\u52a1\u540e\u7aef\uff0c\u4e00\u822c\u914d\u5408<code>Replication Controller</code> \u6216\u8005<code>Deployment</code>\u6765\u4fdd\u8bc1\u540e\u7aef\u5bb9\u5668\u7684\u6b63\u5e38\u8fd0\u884c\u3002</li> <li>\u8fd9\u4e9b\u5339\u914d\u6807\u7b7e\u7684<code>Pod IP</code>\u548c<code>\u7aef\u53e3\u5217\u8868</code>\u7ec4\u6210<code>endpoints</code>\uff0c\u7531<code>kube-proxy</code>\u8d1f\u8d23\u5c06\u670d\u52a1IP\u8d1f\u8f7d\u5747\u8861\u5230\u8fd9\u4e9b<code>endpoints</code>\u4e0a\u3002</li> </ul> <p><code>Service</code>\u540c\u6837\u662f\u6839\u636e<code>Label Selector</code>\u6765\u5237\u9009<code>Pod</code>\u8fdb\u884c\u5173\u8054\u7684\uff0c\u5b9e\u9645\u4e0ak8s\u5728<code>Service</code>\u548c<code>Pod</code>\u4e4b\u95f4\u901a\u8fc7<code>Endpoint</code>\u8854\u63a5\uff0c<code>Endpoints</code>\u540c<code>Service</code>\u5173\u8054\u7684<code>Pod</code>\uff1b\u76f8\u5bf9\u5e94\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u662f<code>Service</code>\u7684\u670d\u52a1\u4ee3\u7406\u540e\u7aef\uff0c<code>k8s</code>\u4f1a\u6839\u636e<code>Service</code>\u5173\u8054\u5230<code>Pod</code>\u7684<code>Pod IP</code> \u4fe1\u606f\u7ec4\u5408\u6210\u4e00\u4e2a<code>Endpoints</code>\u3002</p>"},{"location":"2025/3kubernetes/#30-deploymentrs","title":"30 <code>deployment/rs</code>\u6709\u4ec0\u4e48\u533a\u522b\u3002\u5176\u4f7f\u7528\u65b9\u5f0f\u3001\u4f7f\u7528\u6761\u4ef6\u548c\u539f\u7406\u662f\u4ec0\u4e48\u3002","text":"<p><code>Deployment</code>\u7ee7\u627f\u4e86<code>rc</code>\u7684\u5168\u90e8\u529f\u80fd\u5916\uff0c</p> <p>\u8fd8\u53ef\u4ee5\u67e5\u770b\u5347\u7ea7\u8be6\u7ec6\u8fdb\u5ea6\u548c\u72b6\u6001. \u5f53\u5347\u7ea7\u51fa\u73b0\u95ee\u9898\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u56de\u6eda\u64cd\u4f5c, \u56de\u6eda\u5230\u6307\u5b9a\u7684\u7248\u672c\uff0c\u6bcf\u4e00\u6b21\u5bf9<code>Deployment</code>\u7684\u64cd\u4f5c\uff0c\u90fd\u4f1a\u4fdd\u5b58\u4e0b\u6765\uff0c\u53d8\u80fd\u65b9\u4fbf\u7684\u8fdb\u884c\u56de\u6eda\u64cd\u4f5c\u4e86\uff0c\u53e6\u5916\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u5347\u7ea7\u90fd\u53ef\u4ee5\u968f\u65f6\u6682\u505c\u548c\u542f\u52a8</p>"},{"location":"2025/3kubernetes/#_2","title":"\u62e5\u6709\u591a\u79cd\u5347\u7ea7\u65b9\u6848\uff1a","text":"<ul> <li><code>Recreate</code>\u5220\u9664\u73b0\u5728\u7684<code>Pod</code>\uff0c</li> <li>\u91cd\u65b0\u521b\u5efa\uff1b<code>RollingUpdate</code>\u6eda\u52a8\u5347\u7ea7\uff0c\u9010\u6b65\u66ff\u6362\u73b0\u6709<code>Pod</code>\uff0c\u5bf9\u4e8e\u751f\u4ea7\u73af\u5883\u7684\u670d\u52a1\u5347\u7ea7\uff0c\u663e\u7136\u8fd9\u662f\u4e00\u79cd\u6700\u597d\u7684\u65b9\u5f0f</li> </ul> <p>\u4e00\u4e2a<code>Deployment</code>\u62e5\u6709\u591a\u4e2a<code>Replica Set</code>\uff0c\u800c\u4e00\u4e2a<code>Replica Set</code>\u62e5\u6709\u4e00\u4e2a\u6216\u591a\u4e2a<code>Pod</code>\u3002</p> <p>\u4e00\u4e2a<code>Deployment</code>\u63a7\u5236\u591a\u4e2a<code>rs</code>\u4e3b\u8981\u662f\u4e3a\u4e86\u652f\u6301\u56de\u6eda\u673a\u5236\uff0c\u6bcf\u5f53<code>Deployment</code>\u64cd\u4f5c\u65f6\uff0c<code>Kubernetrs</code>\u4f1a\u91cd\u65b0\u751f\u6210\u4e00\u4e2a<code>Replica Set</code>\u5e76\u4fdd\u7559\uff0c\u4ee5\u540e\u6709\u9700\u8981\u7684\u8bdd\u5c31\u53ef\u4ee5\u56de\u6eda\u81f3\u4e4b\u524d\u7684\u72b6\u6001</p>"},{"location":"2025/3kubernetes/#_3","title":"\u4f7f\u7528\u65b9\u5f0f:","text":"<ul> <li>\u6eda\u52a8\u5347\u7ea7<code>Deployment</code></li> </ul> <pre><code>spec:\n  minReadySeconds: 5\n  strategy:\n    # indicate which strategy we want for rolling update\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n</code></pre> <ul> <li><code>rollout</code>\u6eda\u52a8\u5347\u7ea7<code>Deployment</code></li> </ul> <pre><code># check\n$ kubectl rollout status deployment/nginx-deploy\n\n# pause\n$ kubectl rollout pause deployment &lt;deployment&gt;\n\n# resume\n$ kubectl rollout resume deployment &lt;deployment&gt;\n</code></pre> <ul> <li><code>rollback</code>\u6eda\u52a8\u5347\u7ea7<code>Deployment</code></li> </ul> <pre><code># check history\n$ kubectl rollout history deployment nginx-deploy\ndeployments \"nginx-deploy\"\nREVISION  CHANGE-CAUSE\n1         &lt;none&gt;\n2         &lt;none&gt;\n\n# roll back with specific history\n$ kubectl rollout history deployment nginx-deploy --revision=2\n\n# roll back last one directly\n$ kubectl rollout undo deployment nginx-deploy\n\n# roll back to version x directly\n$ kubectl rollout undo deployment nginx-deploy --to-revision=2\n</code></pre>"},{"location":"2025/3kubernetes/#31-statefulsetdeployment","title":"31 StatefulSet\u548cDeployment\u7684\u533a\u522b","text":"<p>\u201cDeployment\u7528\u4e8e\u90e8\u7f72\u65e0\u72b6\u6001\u670d\u52a1\uff0cStatefulSet\u7528\u6765\u90e8\u7f72\u6709\u72b6\u6001\u670d\u52a1\u201d\u3002</p>"},{"location":"2025/3kubernetes/#_4","title":"\u65e0\u72b6\u6001\u7684\u5e94\u7528","text":"<ul> <li>pod\u4e4b\u95f4\u6ca1\u6709\u987a\u5e8f</li> <li>\u6240\u6709pod\u5171\u4eab\u5b58\u50a8</li> <li>pod\u540d\u5b57\u5305\u542b\u968f\u673a\u6570\u5b57</li> <li>service\u90fd\u6709<code>ClusterIP</code>,\u53ef\u4ee5\u8d1f\u8f7d\u5747\u8861</li> </ul>"},{"location":"2025/3kubernetes/#_5","title":"\u6709\u72b6\u6001\u7684\u5e94\u7528","text":"<ul> <li>\u90e8\u7f72\u3001\u6269\u5c55\u3001\u66f4\u65b0\u3001\u5220\u9664\u90fd\u8981\u6709\u987a\u5e8f</li> <li>\u6bcf\u4e2apod\u90fd\u6709\u81ea\u5df1\u5b58\u50a8\uff0c\u6240\u4ee5\u90fd\u7528volumeClaimTemplates\uff0c\u4e3a\u6bcf\u4e2apod\u90fd\u751f\u6210\u4e00\u4e2a\u81ea\u5df1\u7684\u5b58\u50a8\uff0c\u4fdd\u5b58\u81ea\u5df1\u7684\u72b6\u6001</li> <li>pod\u540d\u5b57\u59cb\u7ec8\u662f\u56fa\u5b9a\u7684</li> <li>service\u6ca1\u6709ClusterIP\uff0c\u662f<code>headlessservice</code>\uff0c\u6240\u4ee5\u65e0\u6cd5\u8d1f\u8f7d\u5747\u8861\uff0c\u8fd4\u56de\u7684\u90fd\u662fpod\u540d\uff0c\u6240\u4ee5pod\u540d\u5b57\u90fd\u5fc5\u987b\u56fa\u5b9a\uff0c<ul> <li><code>StatefulSet</code>\u5728<code>Headless Service</code>\u7684\u57fa\u7840\u4e0a\u53c8\u4e3aStatefulSet\u63a7\u5236\u7684\u6bcf\u4e2aPod\u526f\u672c\u521b\u5efa\u4e86\u4e00\u4e2aDNS\u57df\u540d:<code>$(podname).(headless server name).namespace.svc.cluster.local</code></li> </ul> </li> </ul>"},{"location":"2025/3kubernetes/#32-daemonset","title":"32\u3001 DaemonSet\u8d44\u6e90\u5bf9\u8c61\u7684\u7279\u6027\uff1f","text":"<p>DaemonSet\u8fd9\u79cd\u8d44\u6e90\u5bf9\u8c61\u4f1a\u5728\u6bcf\u4e2ak8s\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u5e76\u4e14\u6bcf\u4e2a\u8282\u70b9\u53ea\u80fd\u8fd0\u884c\u4e00\u4e2apod\uff0c\u8fd9\u662f\u5b83\u548cdeployment\u8d44\u6e90\u5bf9\u8c61\u7684\u6700\u5927\u4e5f\u662f\u552f\u4e00\u7684\u533a\u522b\u3002\u6240\u4ee5\uff0c\u5728\u5176yaml\u6587\u4ef6\u4e2d\uff0c\u4e0d\u652f\u6301\u5b9a\u4e49replicas\uff0c\u9664\u6b64\u4e4b\u5916\uff0c\u4e0eDeployment\u3001RS\u7b49\u8d44\u6e90\u5bf9\u8c61\u7684\u5199\u6cd5\u76f8\u540c\u3002</p> <p>\u5b83\u7684\u4e00\u822c\u4f7f\u7528\u573a\u666f\u5982\u4e0b\uff1a</p> <ul> <li>\u5728\u53bb\u505a\u6bcf\u4e2a\u8282\u70b9\u7684\u65e5\u5fd7\u6536\u96c6\u5de5\u4f5c\uff1b</li> <li>\u76d1\u63a7\u6bcf\u4e2a\u8282\u70b9\u7684\u7684\u8fd0\u884c\u72b6\u6001\uff1b</li> </ul>"},{"location":"2025/3kubernetes/#33-pod","title":"33\u3001 \u521b\u5efa\u4e00\u4e2apod\u7684\u6d41\u7a0b\u662f\u4ec0\u4e48\uff1f","text":"<ul> <li>\u5ba2\u6237\u7aef\u63d0\u4ea4Pod\u7684\u914d\u7f6e\u4fe1\u606f\uff08\u53ef\u4ee5\u662fyaml\u6587\u4ef6\u5b9a\u4e49\u597d\u7684\u4fe1\u606f\uff09\u5230<code>kube-apiserver</code>\uff1b</li> <li><code>Apiserver</code>\u6536\u5230\u6307\u4ee4\u540e\uff0c\u901a\u77e5\u7ed9controller-manager\u521b\u5efa\u4e00\u4e2a\u8d44\u6e90\u5bf9\u8c61\uff1b</li> <li><code>Controller-manager</code>\u901a\u8fc7<code>api-server</code>\u5c06pod\u7684\u914d\u7f6e\u4fe1\u606f\u5b58\u50a8\u5230ETCD\u6570\u636e\u4e2d\u5fc3\u4e2d\uff1b</li> <li>Kube-scheduler\u68c0\u6d4b\u5230pod\u4fe1\u606f\u4f1a\u5f00\u59cb\u8c03\u5ea6\u9884\u9009\uff0c\u4f1a\u5148\u8fc7\u6ee4\u6389\u4e0d\u7b26\u5408Pod\u8d44\u6e90\u914d\u7f6e\u8981\u6c42\u7684\u8282\u70b9\uff0c\u7136\u540e\u5f00\u59cb\u8c03\u5ea6\u8c03\u4f18\uff0c\u4e3b\u8981\u662f\u6311\u9009\u51fa\u66f4\u9002\u5408\u8fd0\u884cpod\u7684\u8282\u70b9\uff0c\u7136\u540e\u5c06pod\u7684\u8d44\u6e90\u914d\u7f6e\u5355\u53d1\u9001\u5230node\u8282\u70b9\u4e0a\u7684kubelet\u7ec4\u4ef6\u4e0a\u3002</li> <li>Kubelet\u6839\u636escheduler\u53d1\u6765\u7684\u8d44\u6e90\u914d\u7f6e\u5355\u8fd0\u884cpod\uff0c\u8fd0\u884c\u6210\u529f\u540e\uff0c\u5c06pod\u7684\u8fd0\u884c\u4fe1\u606f\u8fd4\u56de\u7ed9scheduler\uff0cscheduler\u5c06\u8fd4\u56de\u7684pod\u8fd0\u884c\u72b6\u51b5\u7684\u4fe1\u606f\u5b58\u50a8\u5230etcd\u6570\u636e\u4e2d\u5fc3\u3002</li> </ul>"},{"location":"2025/3kubernetes/#34-pod","title":"34\u3001 \u5220\u9664\u4e00\u4e2aPod\u4f1a\u53d1\u751f\u4ec0\u4e48\u4e8b\u60c5\uff1f","text":"<p>\u7b54\uff1aKube-apiserver\u4f1a\u63a5\u53d7\u5230\u7528\u6237\u7684\u5220\u9664\u6307\u4ee4\uff0c\u9ed8\u8ba4\u670930\u79d2\u65f6\u95f4\u7b49\u5f85\u4f18\u96c5\u9000\u51fa\uff0c\u8d85\u8fc730\u79d2\u4f1a\u88ab\u6807\u8bb0\u4e3a\u6b7b\u4ea1\u72b6\u6001\uff0c\u6b64\u65f6Pod\u7684\u72b6\u6001Terminating\uff0ckubelet\u770b\u5230pod\u6807\u8bb0\u4e3aTerminating\u5c31\u5f00\u59cb\u4e86\u5173\u95edPod\u7684\u5de5\u4f5c\uff1b</p> <p>\u5173\u95ed\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>pod\u4eceservice\u7684endpoint\u5217\u8868\u4e2d\u88ab\u79fb\u9664\uff1b</li> <li>\u5982\u679c\u8be5pod\u5b9a\u4e49\u4e86\u4e00\u4e2a\u505c\u6b62\u524d\u7684\u94a9\u5b50\uff0c\u5176\u4f1a\u5728pod\u5185\u90e8\u88ab\u8c03\u7528\uff0c\u505c\u6b62\u94a9\u5b50\u4e00\u822c\u5b9a\u4e49\u4e86\u5982\u4f55\u4f18\u96c5\u7684\u7ed3\u675f\u8fdb\u7a0b\uff1b</li> <li>\u8fdb\u7a0b\u88ab\u53d1\u9001TERM\u4fe1\u53f7\uff08kill -14\uff09</li> <li>\u5f53\u8d85\u8fc7\u4f18\u96c5\u9000\u51fa\u7684\u65f6\u95f4\u540e\uff0cPod\u4e2d\u7684\u6240\u6709\u8fdb\u7a0b\u90fd\u4f1a\u88ab\u53d1\u9001SIGKILL\u4fe1\u53f7<code>\uff08kill -9\uff09</code>\u3002</li> </ul>"},{"location":"2025/3kubernetes/#kubernetesk8s-kubectl","title":"Kubernetes(k8s)-\u5e38\u7528\u547d\u4ee4(kubectl\u547d\u4ee4)","text":""},{"location":"2025/3kubernetes/#_6","title":"\u83b7\u53d6\u8d44\u6e90\u4fe1\u606f","text":"<pre><code>Kubectl get &lt;resource&gt;: \n\n\u5217\u51fa\u67d0\u79cd\u7c7b\u578b\u7684\u6240\u6709\u8d44\u6e90\u3002\u4f8b\u5982\uff0ckubectl get pods \u4f1a\u5217\u51fa\u9ed8\u8ba4\u547d\u540d\u7a7a\u95f4\u6240\u6709\u7684 Pods\u3002\n</code></pre> <p>\u5f53\u7136\u8fd9\u4e2a\u67e5\u8be2\u53ea\u80fd\u67e5\u8be2\u5230\u6700\u4e00\u4e9b\u540d\u5b57\uff0c\u65f6\u95f4\u7b49\u6bd4\u8f83\u7b80\u5355\u7684\u4fe1\u606f\u3002\u5982\u679c\u60f3\u8981\u67e5\u8be2\u6bd4\u8f83\u8be6\u7ec6\u7684\u4fe1\u606f\u5219\u53ef\u4ee5\u4f7f\u7528 <code>-o yaml\uff08\u4e5f\u53ef\u4ee5\u662fjson\uff09 \u53c2\u6570</code>\uff0c\u6211\u4eec\u524d\u9762\u8bb2\u8fc7\u7684\u5907\u4efd\u4e5f\u662f\u901a\u8fc7\u8fd9\u4e2a\u53c2\u6570\u3002</p> <pre><code>kubectl get pod  etcd-master01 -n kube-system  -o yaml\n</code></pre> <p>\u6211\u4eec\u5728\u67e5\u8be2Pod\u7684\u65f6\u5019\uff0c\u6709\u7684\u65f6\u5019\u5e76\u77e5\u9053\u4ed6\u5728\u54ea\u4e2a\u547d\u540d\u7a7a\u95f4\uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528-A\u53c2\u6570(\u65e9\u671f\u7684\u7248\u672c\u8fd8\u9700\u8981\u5fc5\u987b\u4f7f\u7528<code>--all-namespaces</code>\u53c2\u6570)\uff0c\u7136\u540e\u4f7f\u7528grep\u65b9\u5f0f\u8fdb\u884c\u8fc7\u6ee4\u3002</p> <pre><code>kubectl get pod -A |grep apiserver\n</code></pre> <p>\u8fd8\u6709\u7684\u662f\u9700\u8981\u786e\u5b9aPod\u5bf9\u5e94\u7684\u8282\u70b9\u7b49\u4fe1\u606f\uff0c\u53ef\u4ee5\u6dfb\u52a0<code>-o wide</code>\u53c2\u6570\u3002</p> <pre><code>kubectl get pod -o wide\n</code></pre> <p><code>kubectl describe &lt;resource&gt; &lt;name&gt;</code>\uff1a\u663e\u793a\u67d0\u4e2a\u5177\u4f53\u8d44\u6e90\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> <p>\u4f8b\u5982\uff0c<code>kubectl describe pod my-pod</code>\u3002\u8fd9\u4e2a\u4e3b\u8981\u7528\u4e8e\u67e5\u8be2\u8d44\u6e90\u7684event\u4e8b\u4ef6\uff0c\u8fdb\u884c\u68c0\u67e5\u8d44\u6e90\u72b6\u6001</p> <p>\u4ee5\u4e0a\u65e0\u8bba\u662fget\u8fd8\u662fdescribe\uff0c\u540e\u9762\u7684\u8d44\u6e90\u7c7b\u578b\u6211\u4eec\u524d\u9762\u8bb2\u8fc7\u7684\u5927\u90e8\u5206\u8d44\u6e90\u90fd\u53ef\u4ee5\u4f7f\u7528\u3002\u5177\u4f53\u54ea\u4e9b\u8d44\u6e90\u53ef\u4ee5\u4f7f\u7528 kubectl api-resources\u83b7\u53d6\u3002</p>"},{"location":"2025/3kubernetes/#_7","title":"\u521b\u5efa\u548c\u66f4\u65b0\u8d44\u6e90","text":"<pre><code>kubectl apply -f &lt;file&gt;: \u6839\u636e\u6307\u5b9a\u7684 YAML \u6216 JSON \u6587\u4ef6\u521b\u5efa\u6216\u66f4\u65b0\u8d44\u6e90\u3002\n</code></pre> <p>\u4f8b\u5982\uff0c<code>kubectl apply -f deployment.yaml</code>\uff0c\u53ef\u7528\u4e8e\u521b\u5efa\u548c\u66f4\u65b0\u3002</p> <p><code>kubectl create -f &lt;file&gt;</code>: \u6839\u636e\u6307\u5b9a\u7684 YAML \u6216 JSON \u6587\u4ef6\u521b\u5efa\u8d44\u6e90\u3002\u4e0e apply \u4e0d\u540c\uff0ccreate \u4ec5\u7528\u4e8e\u521b\u5efa\u64cd\u4f5c\u3002</p> <p><code>kubectl edit &lt;resource&gt; &lt;name&gt;:</code> \u7f16\u8f91\u96c6\u7fa4\u4e2d\u7684\u8d44\u6e90\u3002</p> <p>\u8fd9\u5c06\u6253\u5f00\u4e00\u4e2a\u6587\u672c\u7f16\u8f91\u5668\u4f9b\u60a8\u4fee\u6539\u5f53\u524d\u8d44\u6e90\u7684\u914d\u7f6e\u3002</p> <p><code>kubectl patch &lt;resource&gt; &lt;name&gt;</code>\uff1a</p> <p>\u66f4\u65b0\u67d0\u90e8\u5206\u8d44\u6e90\uff0c\u8fd9\u91cc\u7684\u8d44\u6e90\u4e00\u822c\u662f\u8fd9\u4e2a\u66f4\u65b0\u8fd9\u4e2a\u8d44\u6e90\u7684\u5c40\u90e8\u4fe1\u606f\uff0c\u6bd4\u5982\u66f4\u65b0\u526f\u672c\u6570\u91cf\uff1a</p> <pre><code>kubectl patch deployment/my-deployment --type='merge' -p '{\"spec\":{\"replicas\":3}}'\n</code></pre> <p>\u5220\u9664\u8d44\u6e90</p> <p><code>kubectl delete &lt;resource&gt; &lt;name&gt;:</code> \u5220\u9664\u67d0\u4e2a\u5177\u4f53\u8d44\u6e90\u3002</p> <p>\u4f8b\u5982\uff0c<code>kubectl delete pod my-pod</code></p> <p><code>kubectl delete -f &lt;file&gt;</code>: \u6839\u636e\u6307\u5b9a\u7684 YAML \u6216 JSON \u6587\u4ef6\u5220\u9664\u8d44\u6e90\u3002</p> <p>\u4e0e Pod \u548c\u5bb9\u5668\u4ea4\u4e92</p> <pre><code>kubectl exec &lt;pod&gt; -- &lt;command&gt;: \u5728\u6307\u5b9a\u7684 Pod \u4e2d\u6267\u884c\u547d\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528bash\u8fdb\u5165\u5bb9\u5668\u3002\n</code></pre> <p>\u4f8b\u5982\uff0c<code>kubectl exec my-pod -- ls /</code>\u4f1a\u5728 my-pod \u4e2d\u6267\u884c <code>ls /</code>\u3002</p> <p><code>kubectl logs &lt;pod&gt;</code>: \u83b7\u53d6 Pod \u4e2d\u5bb9\u5668\u7684\u65e5\u5fd7\u3002\u5982\u679c Pod \u6709\u591a\u4e2a\u5bb9\u5668\uff0c\u5219\u9700\u4f7f\u7528 <code>-c &lt;container&gt;</code> \u6307\u5b9a\u5bb9\u5668\u3002</p> <p><code>kubectl attach &lt;pod&gt;</code>: \u9644\u52a0\u5230\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u4ee5\u67e5\u770b\u8f93\u51fa\u6d41\u6216\u4ea4\u4e91\u63a7\u5236\u53f0\u3002</p> <p><code>kubectl port-forward &lt;pod&gt; &lt;local-port&gt;:&lt;pod-port&gt;</code>: \u5c06\u672c\u5730\u7aef\u53e3\u8f6c\u53d1\u5230 Pod \u4e2d\u7684\u7aef\u53e3\u3002</p> <p>\u7ba1\u7406\u96c6\u7fa4</p> <ul> <li><code>kubectl config view</code>: \u67e5\u770b kubectl \u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5305\u62ec\u96c6\u7fa4\u3001\u7528\u6237\u548c\u4e0a\u4e0b\u6587\u3002</li> <li><code>kubectl top &lt;node|pod&gt;</code>: \u663e\u793a\u8282\u70b9\u6216 Pod \u7684 CPU \u548c\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\uff0c\u9700\u8981\u5b89\u88c5\u76d1\u63a7\u7ec4\u4ef6\u624d\u53ef\u4ee5\u7528\u3002</li> </ul> <p>\u7ba1\u7406\u8282\u70b9</p> <p><code>kubectl cordon</code>\uff1a\u9694\u79bb\u8282\u70b9\uff0c\u907f\u514d\u65b0Pod\u8c03\u5ea6\u8fc7\u6765\uff0c\u7528\u4e8e\u7ef4\u62a4\u670d\u52a1\u5668\u524d\u51c6\u5907\u5de5\u4f5c\u3002</p> <p><code>kubectl uncordon</code>\uff1a\u53d6\u6d88\u9694\u79bb\uff0c\u91cd\u65b0\u5f00\u653e\u8c03\u5ea6\uff0c\u7ef4\u62a4\u7ed3\u675f\u4ee5\u540e\u6062\u590d\u670d\u52a1\u5668\u3002</p> <p><code>kubectl drain</code>\uff1a\u9a71\u9010Pod\uff0c\u7528\u4e8e\u79fb\u9664\u5f53\u524d\u8282\u70b9\u7684Pod\uff0c\u624d\u80fd\u5bf9\u8282\u70b9\u8fdb\u884c\u64cd\u4f5c\u5177\u4f53\u7684\u7ef4\u62a4\u64cd\u4f5c\u3002</p> <p><code>kubectl taint</code>\uff1a\u6c61\u70b9\u64cd\u4f5c\uff0c\u7528\u4e8e\u63a7\u5236\u8282\u70b9\u7684\u6c61\u70b9\u6dfb\u52a0\u4e0e\u5220\u9664\uff0c\u5408\u7406\u7684\u8fdb\u884c\u8c03\u5ea6\u3002</p> <p><code>kubeclt label</code>\uff1a\u6807\u7b7e\u64cd\u4f5c\uff0c\u7528\u4e8e\u64cd\u4f5c\u8d44\u6e90\u7684\u6807\u7b7e\u6dfb\u52a0\u6216\u8005\u5220\u9664</p> <pre><code>#\u6dfb\u52a0\u6807\u7b7e\nkubectl label &lt;resource-type&gt; &lt;resource-name&gt; &lt;label-key&gt;=&lt;label-value&gt;\n\n#\u5220\u9664\u6807\u7b7e\nkubectl label &lt;resource-type&gt; &lt;resource-name&gt; &lt;label-key&gt;-\n</code></pre> <p>\u5176\u4ed6\u547d\u4ee4</p> <pre><code>kubectl rollout status &lt;resource&gt;/&lt;name&gt;: \u67e5\u770b\u8d44\u6e90\u7684\u90e8\u7f72\u72b6\u6001\u3002\n\n\u4f8b\u5982\uff0ckubectl rollout status deployment/my-deployment\u3002\n\nkubectl rollout undo &lt;resource&gt;/&lt;name&gt;: \u56de\u6eda\u8d44\u6e90\u5230\u4e4b\u524d\u7684\u72b6\u6001\u3002\n\n\u4f8b\u5982\uff0ckubectl rollout undo deployment/my-deployment\u3002\n\nkubectl scale &lt;resource&gt;/&lt;name&gt; --replicas=&lt;num&gt;: \u7f29\u653e\u8d44\u6e90\u7684\u526f\u672c\u6570\u3002\n\u4f8b\u5982\uff0ckubectl scale deployment/my-deployment --replicas=3\u3002\n</code></pre> <pre><code>#\u66f4\u65b0\u955c\u50cf\uff0c\u4f7f\u7528\u8f83\u591a\u7684\u547d\u4ee4\nkubectl set image &lt;resource&gt;/&lt;name&gt; &lt;container_name&gt;=&lt;new_image&gt;:&lt;tag&gt;\nkubectl set image deployment/my-deployment my-container=nginx:1.19\n</code></pre> <pre><code>kubectl\nkubectl controls the Kubernetes cluster manager.\n\n Find more information at: https://kubernetes.io/docs/reference/kubectl/\n\nBasic Commands (Beginner):\n  create          Create a resource from a file or from stdin\n  expose          Take a replication controller, service, deployment or pod and expose it as a new\nKubernetes service\n  run             Run a particular image on the cluster\n  set             Set specific features on objects\n\nBasic Commands (Intermediate):\n  explain         Get documentation for a resource\n  get             Display one or many resources\n  edit            Edit a resource on the server\n  delete          Delete resources by file names, stdin, resources and names, or by resources and\nlabel selector\n\nDeploy Commands:\n  rollout         Manage the rollout of a resource\n  scale           Set a new size for a deployment, replica set, or replication controller\n  autoscale       Auto-scale a deployment, replica set, stateful set, or replication controller\n\nCluster Management Commands:\n  certificate     Modify certificate resources\n  cluster-info    Display cluster information\n  top             Display resource (CPU/memory) usage\n  cordon          Mark node as unschedulable\n  uncordon        Mark node as schedulable\n  drain           Drain node in preparation for maintenance\n  taint           Update the taints on one or more nodes\n\nTroubleshooting and Debugging Commands:\n  describe        Show details of a specific resource or group of resources\n  logs            Print the logs for a container in a pod\n  attach          Attach to a running container\n  exec            Execute a command in a container\n  port-forward    Forward one or more local ports to a pod\n  proxy           Run a proxy to the Kubernetes API server\n  cp              Copy files and directories to and from containers\n  auth            Inspect authorization\n  debug           Create debugging sessions for troubleshooting workloads and nodes\n  events          List events\n\nAdvanced Commands:\n  diff            Diff the live version against a would-be applied version\n  apply           Apply a configuration to a resource by file name or stdin\n  patch           Update fields of a resource\n  replace         Replace a resource by file name or stdin\n  wait            Experimental: Wait for a specific condition on one or many resources\n  kustomize       Build a kustomization target from a directory or URL\n\nSettings Commands:\n  label           Update the labels on a resource\n  annotate        Update the annotations on a resource\n  completion      Output shell completion code for the specified shell (bash, zsh, fish, or\npowershell)\n\nSubcommands provided by plugins:\n\nOther Commands:\n  api-resources   Print the supported API resources on the server\n  api-versions    Print the supported API versions on the server, in the form of \"group/version\"\n  config          Modify kubeconfig files\n  plugin          Provides utilities for interacting with plugins\n  version         Print the client and server version information\n\nUsage:\n  kubectl [flags] [options]\n</code></pre>"},{"location":"2025/3kubernetes/#vpa-vs-qos","title":"VPA vs QOS","text":""},{"location":"2025/3kubernetes/#how-vpa-works","title":"How VPA Works","text":"<p>1. Resource Recommendations:</p> <ul> <li>VPA monitors the resource usage (CPU and memory) of Pods over time.</li> <li>It provides recommendations for adjusting the resource requests (and optionally limits) of Pods to better match their actual usage.</li> </ul> <p>2.Pod Updates:</p> <ul> <li>VPA can automatically update the Pod's resource requests by recreating the Pod with the new values.</li> <li>Alternatively, it can provide recommendations that you manually apply.</li> </ul>"},{"location":"2025/3kubernetes/#impact-on-qos-classes","title":"Impact on QoS Classes","text":"<p>Kubernetes assigns a QoS class to each Pod based on its resource requests and limits:</p> <p>Guaranteed:</p> <p>Both CPU and memory requests and limits are set, and they are equal.</p> <p>Highest priority.</p> <p>Burstable:</p> <p>At least one resource (CPU or memory) has a request set, but the request and limit are not equal.</p> <p>Medium priority.</p> <p>BestEffort:</p> <p>No resource requests or limits are set.</p> <p>Lowest priority.</p>"},{"location":"2025/3kubernetes/#how-vpa-affects-qos","title":"How VPA Affects QoS","text":"<ul> <li> <p>Changing Requests:</p> <ul> <li>VPA modifies the resource requests of Pods based on usage.</li> <li>If VPA increases or decreases the requests, it can change the Pod's QoS class:<ul> <li>A Pod might move from Burstable to Guaranteed if VPA sets equal requests and limits.</li> <li>A Pod might move from Guaranteed to Burstable if VPA adjusts requests to be different from limits.</li> </ul> </li> </ul> </li> <li> <p>Changing Limits:</p> <ul> <li>If VPA is configured to update limits (not just requests), it can also affect the QoS class.</li> <li>For example, if VPA sets limits equal to requests, the Pod will move to Guaranteed.</li> </ul> </li> <li> <p>BestEffort Pods:</p> <ul> <li>VPA does not directly affect BestEffort Pods because they have no resource requests or limits.</li> <li>However, if VPA adds requests to a BestEffort Pod, it will transition to Burstable.</li> </ul> </li> </ul>"},{"location":"2025/3kubernetes/#key-considerations","title":"Key Considerations","text":"<p>QoS Class Changes:</p> <ul> <li> <p>If VPA modifies resource requests or limits, the Pod's QoS class might change, which can affect its scheduling and eviction behavior.</p> </li> <li> <p>For example, Guaranteed Pods are less likely to be evicted under resource pressure compared to Burstable or BestEffort Pods.</p> </li> </ul> <p>Pod Restarts:</p> <p>VPA typically recreates Pods to apply new resource requests or limits. This can cause temporary downtime.</p> <p>Resource Limits:</p> <p>By default, VPA only adjusts requests. If you want it to adjust limits, you need to enable the <code>--vpa-update-mode=Auto</code> or <code>--vpa-update-mode=Recreate</code> flag and configure it accordingly.</p> <p>Performance Impact:</p> <ul> <li>If VPA reduces resource requests too aggressively, Pods might experience resource contention or throttling.</li> <li>If VPA increases resource requests, it might lead to over-provisioning and higher cluster costs</li> </ul>"},{"location":"2025/3kubernetes/#example-scenario","title":"Example Scenario","text":"<p>Suppose you have a Pod with the following resource configuration:</p> <pre><code>resources:\n  requests:\n    cpu: \"100m\"\n    memory: \"128Mi\"\n  limits:\n    cpu: \"200m\"\n    memory: \"256Mi\"\n</code></pre> <p>This Pod is classified as Burstable because the requests and limits are not equal.</p> <p>If VPA adjusts the requests to:</p> <pre><code>resources:\n  requests:\n    cpu: \"200m\"\n    memory: \"256Mi\"\n  limits:\n    cpu: \"200m\"\n    memory: \"256Mi\"\n</code></pre> <p>The Pod will now be classified as Guaranteed because the requests and limits are equal.</p>"},{"location":"2025/3kubernetes/#best-practices","title":"Best Practices","text":"<p>Monitor QoS Changes:</p> <p>Keep an eye on the QoS class of your Pods after VPA adjustments to ensure they align with your performance and reliability requirements.</p> <p>Use VPA with Caution:</p> <ul> <li> <p>Test VPA in a non-production environment before enabling it in production.</p> </li> <li> <p>Use the <code>--vpa-update-mode=Off</code> flag to get recommendations without automatically applying them.</p> </li> </ul> <p>Set Resource Limits:</p> <p>Explicitly set resource limits to prevent VPA from over-provisioning resources.</p> <p>Combine with HPA:</p> <p>Use VPA in conjunction with the Horizontal Pod Autoscaler (HPA) for a more comprehensive scaling strategy.</p> <p>Yes, VPA can affect the QoS class of Pods by modifying their resource requests and limits. This can change the Pod's priority and behavior under resource pressure. To avoid unexpected issues, carefully monitor VPA's recommendations and test its impact on your workloads. </p>"},{"location":"2025/3kubernetes/#k8s","title":"K8s \u6545\u969c\u89e3\u51b3","text":""},{"location":"2025/3kubernetes/#1_3","title":"1\u3001\u95ee\u9898\u73b0\u8c61\u4e0e\u80cc\u666f","text":"<p>\u67d0\u7535\u5546\u5e73\u53f0\u751f\u4ea7\u73af\u5883\u7684Kubernetes\u96c6\u7fa4\u5728\u4fc3\u9500\u6d3b\u52a8\u671f\u95f4\u7a81\u53d1\u5927\u89c4\u6a21Pod\u9a71\u9010\uff0c\u5177\u4f53\u8868\u73b0\u5982\u4e0b\uff1a</p> <ol> <li>Pod\u9891\u7e41\u91cd\u542f\uff1a\u8d85\u8fc730%\u7684Pod\u8fdb\u5165Evicted\u72b6\u6001\uff0c\u6838\u5fc3\u670d\u52a1\uff08\u5982\u8ba2\u5355\u652f\u4ed8\u3001\u8d2d\u7269\u8f66\uff09\u7684Pod\u88ab\u53cd\u590d\u9a71</li> <li>\u8282\u70b9\u8d44\u6e90\u8017\u5c3d\uff1a\u591a\u4e2aWorker\u8282\u70b9\u7684\u5185\u5b58\u4f7f\u7528\u7387\u8d85\u8fc795%\uff0ckubelet\u65e5\u5fd7\u6301\u7eed\u8f93\u51faMemoryPressure\u8b66\u544a\u3002</li> <li>\u76d1\u63a7\u544a\u8b66\uff1a<ul> <li>Prometheus\u89e6\u53d1<code>node_memory_available_bytes &lt; 10%</code>\u544a\u8b66\u3002 </li> <li>Grafana\u9762\u677f\u663e\u793a\u90e8\u5206\u8282\u70b9\u7684<code>kubelet_evictions</code>\u6307\u6807\u98d9\u5347\u3002</li> </ul> </li> <li>Grafana\u9762\u677f\u663e\u793a\u90e8\u5206\u8282\u70b9\u7684<code>kubelet_evictions</code>\u6307\u6807\u98d9\u5347\u3002</li> </ol>"},{"location":"2025/3kubernetes/#2_3","title":"2\u3001\u95ee\u9898\u6839\u56e0\u5206\u6790","text":"<ul> <li>1. \u521d\u6b65\u6392\u67e5\uff1a\u8282\u70b9\u4e0ePod\u72b6\u6001</li> </ul> <pre><code># \u67e5\u770b\u8282\u70b9\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff08\u6309\u5185\u5b58\u6392\u5e8f\uff09\nkubectl top nodes --sort-by=memory\n\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\nNAME           CPU(cores)  CPU%   MEMORY(bytes)  MEMORY%\nworker-node-1  5800m       72%    6143Mi         98%\nworker-node-2  4200m       52%    5892Mi         95%\nworker-node-3  3800m       47%    4321Mi         70%\n\n# \u68c0\u67e5\u88ab\u9a71\u9010\u7684Pod\nkubectl get pods -A -o wide | grep Evicted | wc -l  # \u8f93\u51fa\uff1a47\n\n# \u67e5\u770b\u67d0\u4e2a\u88ab\u9a71\u9010Pod\u7684\u8be6\u7ec6\u4e8b\u4ef6\nkubectl describe pod payment-service-abcde -n production\n</code></pre> <p>\u5173\u952e\u65e5\u5fd7\uff1a</p> <pre><code>Events:\n  Type     Reason     Age   From               Message\n  ----     ------     ----  ----               -------\n  Warning  Evicted    2m    kubelet            The node was low on resource: memory.\n  Normal   Killing    2m    kubelet            Stopping container payment-service\n</code></pre> <p>\u7ed3\u8bba\uff1a\u8282\u70b9\u5185\u5b58\u4e0d\u8db3\u89e6\u53d1kubelet\u7684\u4e3b\u52a8\u9a71\u9010\u673a\u5236\u3002</p> <ul> <li>2. \u6df1\u5165\u5b9a\u4f4d\uff1a\u8d44\u6e90\u6d88\u8017\u6765\u6e90</li> </ul> <p>\u6b65\u9aa41\uff1a\u8bc6\u522b\u9ad8\u5185\u5b58\u6d88\u8017Pod</p> <pre><code># \u6309\u5185\u5b58\u4f7f\u7528\u91cf\u6392\u5e8f\u6240\u6709Pod\nkubectl top pods -A --sort-by=memory --use-protocol-buffers\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\nNAMESPACE    POD_NAME                     MEMORY(Mi)\nproduction   recommendation-service-xyz   1024\nproduction   payment-service-abc          896\nlogging      fluentd-7k8jh                512\n</code></pre> <p>\u53d1\u73b0\uff1a<code>recommendation-service</code>\u7684Pod\u5185\u5b58\u5360\u7528\u5f02\u5e38\u9ad8\u3002</p> <p>\u6b65\u9aa42\uff1a\u68c0\u67e5Pod\u8d44\u6e90\u9650\u5236\u914d\u7f6e</p> <pre><code>kubectl get pod recommendation-service-xyz -n production -o yaml | grep -A 5 resources\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\nresources:\n  requests:\n    cpu: \"500m\"\n  limits:\n    cpu: \"1000m\"\n</code></pre> <p>\u95ee\u9898\uff1a\u8be5Pod\u672a\u8bbe\u7f6e\u5185\u5b58\u9650\u5236\uff08<code>limits.memory</code>\u7f3a\u5931\uff09\uff0c\u5bfc\u81f4\u5185\u5b58\u6cc4\u6f0f\u65f6\u65e0\u7ea6\u675f\u3002</p> <p>\u6b65\u9aa43\uff1a\u5206\u6790\u5bb9\u5668\u5185\u5b58\u4f7f\u7528</p> <pre><code># \u8fdb\u5165\u8282\u70b9\u67e5\u770b\u5bb9\u5668\u7ea7\u5185\u5b58\u5360\u7528\uff08\u9700SSH\u767b\u5f55\u8282\u70b9\uff09\ndocker stats --format \"table {{.Container}}\\t{{.Name}}\\t{{.MemUsage}}\"\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\nCONTAINER   NAME                      MEM USAGE\na1b2c3d4    recommendation-service    1.2GiB / 1.2GiB\n</code></pre> <p>\u53d1\u73b0\uff1a\u5bb9\u5668\u5185\u5b58\u5360\u7528\u5df2\u7a81\u78341GiB\uff0c\u4f46\u672a\u914d\u7f6e<code>limits.memory</code>\uff0c\u5bfc\u81f4\u8282\u70b9\u5185\u5b58\u8017\u5c3d\u3002</p>"},{"location":"2025/3kubernetes/#3_4","title":"3\u3001\u7d27\u6025\u5904\u7406\u63aa\u65bd","text":""},{"location":"2025/3kubernetes/#1_4","title":"1. \u5feb\u901f\u6269\u5bb9\u4e0e\u8d1f\u8f7d\u5206\u6d41","text":"<p>\u6a2a\u5411\u6269\u5c55\u8282\u70b9\uff1a</p> <pre><code># \u4f7f\u7528Cluster Autoscaler\u81ea\u52a8\u6269\u5bb9\uff08\u5047\u8bbe\u914d\u7f6e\u4e86\u8282\u70b9\u7ec4\uff09\nkubectl scale deployment cluster-autoscaler --replicas=3 -n kube-system\n</code></pre>"},{"location":"2025/3kubernetes/#2-pod","title":"2 \u4e34\u65f6\u8c03\u6574Pod\u526f\u672c\u6570\uff1a","text":"<pre><code># \u51cf\u5c11\u975e\u6838\u5fc3\u670d\u52a1\u526f\u672c\u6570\uff0c\u91ca\u653e\u8d44\u6e90\nkubectl scale deployment batch-job-processor --replicas=0 -n background\n\n# \u589e\u52a0\u6838\u5fc3\u670d\u52a1\u526f\u672c\u6570\uff0c\u5206\u6563\u8d1f\u8f7d\nkubectl scale deployment payment-service --replicas=10 -n production\n</code></pre>"},{"location":"2025/3kubernetes/#2-pod_1","title":"2. \u624b\u52a8\u9a71\u9010\u95ee\u9898Pod","text":"<pre><code># \u5f3a\u5236\u5220\u9664\u9ad8\u5185\u5b58\u5360\u7528\u7684Pod\uff08\u89e6\u53d1\u91cd\u65b0\u8c03\u5ea6\uff09\nkubectl delete pod recommendation-service-xyz -n production --force --grace-period=0\n\n# \u89c2\u5bdfPod\u91cd\u5efa\u540e\u7684\u5185\u5b58\u4f7f\u7528\nwatch -n 1 \"kubectl top pods -n production | grep recommendation-service\"\n</code></pre>"},{"location":"2025/3kubernetes/#3-kubelet_1","title":"3. \u52a8\u6001\u8c03\u6574kubelet\u9a71\u9010\u9608\u503c","text":"<pre><code># \u4e34\u65f6\u4fee\u6539kubelet\u914d\u7f6e\uff08\u907f\u514d\u66f4\u591aPod\u88ab\u9a71\u9010\uff09\nsudo vi /etc/kubernetes/kubelet.conf\n# \u6dfb\u52a0\u53c2\u6570\uff1a\nevictionHard:\n  memory.available: \"10%\"\n  nodefs.available: \"5%\"\n\n# \u91cd\u542fkubelet\nsudo systemctl restart kubelet\n</code></pre>"},{"location":"2025/3kubernetes/#2_4","title":"2\u3001\u6839\u56e0\u4fee\u590d\u4e0e\u957f\u671f\u4f18\u5316","text":""},{"location":"2025/3kubernetes/#1_5","title":"1. \u8d44\u6e90\u914d\u989d\u89c4\u8303\u5316","text":"<p>\u4e3a\u6240\u6709Pod\u6dfb\u52a0\u5185\u5b58\u9650\u5236\uff1a</p> <pre><code># deployment.yaml\u793a\u4f8b\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: recommendation-service\nspec:\n  template:\n    spec:\n      containers:\n      - name: app\n        resources:\n          requests:\n            memory: \"512Mi\"\n            cpu: \"500m\"\n          limits:\n            memory: \"1024Mi\"  # \u786c\u6027\u9650\u5236\u5185\u5b58\u4e0a\u9650\n            cpu: \"2000m\"\n</code></pre>"},{"location":"2025/3kubernetes/#resourcequota","title":"\u542f\u7528\u547d\u540d\u7a7a\u95f4\u7ea7ResourceQuota\uff1a","text":"<pre><code>apiVersion: v1\nkind: ResourceQuota\nmetadata:\n  name: production-quota\n  namespace: production\nspec:\n  hard:\n    requests.memory: \"100Gi\"\n    limits.memory: \"200Gi\"\n    pods: \"200\"\n</code></pre>"},{"location":"2025/3kubernetes/#2_5","title":"2. \u81ea\u52a8\u5316\u5f39\u6027\u4f38\u7f29","text":""},{"location":"2025/3kubernetes/#hpa","title":"\u914d\u7f6eHPA\uff08\u57fa\u4e8e\u5185\u5b58\uff09","text":"<pre><code>kubectl autoscale deployment recommendation-service -n production \\\n  --cpu-percent=70 \\\n  --memory-percent=80 \\\n  --min=3 \\\n  --max=20\n</code></pre>"},{"location":"2025/3kubernetes/#vpa","title":"\u4f7f\u7528VPA\uff08\u5782\u76f4\u6269\u7f29\u5bb9)","text":"<pre><code>apiVersion: autoscaling.k8s.io/v1\nkind: VerticalPodAutoscaler\nmetadata:\n  name: recommendation-service-vpa\nspec:\n  targetRef:\n    apiVersion: \"apps/v1\"\n    kind: Deployment\n    name: recommendation-service\n  updatePolicy:\n    updateMode: \"Auto\"\n</code></pre>"},{"location":"2025/3kubernetes/#3_5","title":"3. \u5185\u5b58\u6cc4\u6f0f\u6839\u6cbb","text":"<p>\u4f7f\u7528pprof\u8fdb\u884c\u5806\u5206\u6790\uff08\u4ee5Go\u670d\u52a1\u4e3a\u4f8b\uff09\uff1a</p> <pre><code>import _ \"net/http/pprof\"\n\nfunc main() {\n  go func() {\n    log.Println(http.ListenAndServe(\":6060\", nil))\n  }()\n  // \u4e1a\u52a1\u4ee3\u7801\n}\n</code></pre> <pre><code>import _ \"net/http/pprof\"\n\nfunc main() {\n  go func() {\n    log.Println(http.ListenAndServe(\":6060\", nil))\n  }()\n  // \u4e1a\u52a1\u4ee3\u7801\n}\n</code></pre> <p>\u4f18\u5316\u4ee3\u7801\u903b\u8f91\uff1a\u4fee\u590d\u5faa\u73af\u5f15\u7528\u3001\u7f13\u5b58\u672a\u91ca\u653e\u7b49\u95ee\u9898\u3002</p>"},{"location":"2025/3kubernetes/#5_2","title":"5\u3001\u76d1\u63a7\u4e0e\u544a\u8b66\u4f53\u7cfb\u5347\u7ea7","text":""},{"location":"2025/3kubernetes/#1-prometheus","title":"1. Prometheus\u76d1\u63a7\u89c4\u5219","text":"<pre><code># prometheus-rules.yaml\ngroups:\n- name: Kubernetes-Resource\n  rules:\n  - alert: NodeMemoryPressure\n    expr: (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 &gt; 85\n    for: 5m\n    labels:\n      severity: critical\n    annotations:\n      summary: \"\u8282\u70b9\u5185\u5b58\u4e0d\u8db3 ({{ $labels.instance }})\"\n      description: \"\u8282\u70b9 {{ $labels.instance }} \u5185\u5b58\u4f7f\u7528\u7387\u8d85\u8fc785%\uff0c\u5f53\u524d\u503c {{ $value }}%\"\n\n  - alert: PodEvictionRateHigh\n    expr: rate(kube_pod_status_evicted[1h]) &gt; 0\n    for: 10m\n    labels:\n      severity: warning\n</code></pre> <p>2. Grafana\u53ef\u89c6\u5316\u9762\u677f</p> <p>\u5173\u952e\u9762\u677f\u914d\u7f6e\uff1a</p> <ul> <li>\u8282\u70b9\u8d44\u6e90\u89c6\u56fe\uff1a<code>node_memory_available_bytes\u3001node_cpu_usage</code></li> <li>Pod\u9a71\u9010\u7edf\u8ba1\uff1a<code>sum(kube_pod_status_evicted) by (namespace)</code></li> <li>HPA\u4f38\u7f29\u5386\u53f2\uff1a<code>kube_horizontalpodautoscaler_status_current_replicas</code></li> </ul> <p>3. \u65e5\u5fd7\u805a\u5408\u5206\u6790</p> <p>Fluentd + Elasticsearch\u914d\u7f6e\uff1a</p> <pre><code>&lt;match kube.**&gt;\n  @type elasticsearch\n  host elasticsearch.production.svc\n  port 9200\n  logstash_format true\n  logstash_prefix k8s\n&lt;/match&gt;\n</code></pre> <p>\u5173\u952e\u65e5\u5fd7\u7b5b\u9009\uff1a</p> <pre><code># Kibana\u67e5\u8be2\u88ab\u9a71\u9010Pod\u7684\u65e5\u5fd7\nkubernetes.labels.app: \"payment-service\" AND message: \"Evicted\"\n</code></pre>"},{"location":"2025/3kubernetes/#6_2","title":"6\u3001\u9884\u9632\u4e0e\u5bb9\u707e\u6f14\u7ec3","text":""},{"location":"2025/3kubernetes/#1_6","title":"1. \u6df7\u6c8c\u5de5\u7a0b\u5b9e\u8df5","text":"<p>\u6a21\u62df\u8282\u70b9\u6545\u969c\uff08\u4f7f\u7528Chaos Mesh\uff09\uff1a</p> <pre><code>apiVersion: chaos-mesh.org/v1alpha1\nkind: NodeFailure\nmetadata:\n  name: node-failure-test\nspec:\n  action: shutdown\n  duration: \"10m\"\n  selector:\n    nodes:\n    - worker-node-1\n</code></pre> <p>\u9a8c\u8bc1\u96c6\u7fa4\u81ea\u6108\u80fd\u529b\uff1a</p> <ul> <li>\u89c2\u5bdfPod\u662f\u5426\u81ea\u52a8\u8fc1\u79fb\u5230\u5065\u5eb7\u8282\u70b9\u3002</li> <li>\u68c0\u67e5HPA\u662f\u5426\u6309\u8d1f\u8f7d\u81ea\u52a8\u6269\u5c55\u3002</li> </ul>"},{"location":"2025/3kubernetes/#2_6","title":"2. \u5b9a\u671f\u538b\u529b\u6d4b\u8bd5","text":"<p>\u4f7f\u7528Locust\u6a21\u62df\u6d41\u91cf\u9ad8\u5cf0</p> <pre><code>from locust import HttpUser, task\n\nclass PaymentUser(HttpUser):\n    @task\n    def create_order(self):\n        self.client.post(\"/api/order\", json={\"items\": [...]})\n</code></pre> <pre><code>locust -f load_test.py --headless -u 1000 -r 100\n</code></pre>"},{"location":"2025/3kubernetes/#3_6","title":"3. \u67b6\u6784\u4f18\u5316","text":"<p>\u670d\u52a1\u7f51\u683c\u5316\uff1a\u901a\u8fc7Istio\u5b9e\u73b0\u7194\u65ad\u548c\u964d\u7ea7\u3002</p> <pre><code>apiVersion: networking.istio.io/v1alpha3\nkind: DestinationRule\nmetadata:\n  name: payment-service\nspec:\n  host: payment-service.production.svc.cluster.local\n  trafficPolicy:\n    outlierDetection:\n      consecutiveErrors: 5\n      interval: 1m\n      baseEjectionTime: 3m\n</code></pre> <p>\u89e3\u51b3\u6548\u679c\uff1a</p> <ul> <li>\u7d27\u6025\u63aa\u65bd\u572830\u5206\u949f\u5185\u6062\u590d\u6838\u5fc3\u670d\u52a1\uff0cPod\u9a71\u9010\u7387\u964d\u81f30\u3002</li> <li>\u901a\u8fc7\u5185\u5b58\u9650\u5236\u548cHPA\u914d\u7f6e\uff0c\u96c6\u7fa4\u8d44\u6e90\u5229\u7528\u7387\u7a33\u5b9a\u572870%-80%\u3002</li> <li>\u540e\u7eed3\u4e2a\u6708\u672a\u53d1\u751f\u7c7b\u4f3c\u4e8b\u4ef6\uff0c\u6545\u969cMTTR\uff08\u5e73\u5747\u4fee\u590d\u65f6\u95f4\uff09\u4ece4\u5c0f\u65f6\u7f29\u77ed\u81f315\u5206\u949f\u3002</li> </ul> <p>\u5173\u952e\u7ecf\u9a8c\uff1a</p> <ol> <li>\u9632\u5fa1\u6027\u7f16\u7801\uff1a\u6240\u6709\u670d\u52a1\u5fc5\u987b\u8bbe\u7f6e\u8d44\u6e90limits\uff0c\u5e76\u5728CI/CD\u6d41\u6c34\u7ebf\u4e2d\u5f3a\u5236\u68c0\u67e5\u3002</li> <li>\u76d1\u63a7\u5168\u8986\u76d6\uff1a\u4ece\u8282\u70b9\u5230Pod\u5c42\u7ea7\u7684\u8d44\u6e90\u76d1\u63a7\u9700\u5b9e\u73b0100%\u8986\u76d6\u3002</li> <li>\u81ea\u52a8\u5316\u4f18\u5148\uff1a\u4f9d\u8d56Cluster Autoscaler\u3001HPA\u7b49\u81ea\u52a8\u5316\u5de5\u5177\uff0c\u51cf\u5c11\u4eba\u5de5\u5e72\u9884\u3002</li> <li>\u5b9a\u671f\u6f14\u7ec3\uff1a\u901a\u8fc7\u6df7\u6c8c\u5de5\u7a0b\u66b4\u9732\u7cfb\u7edf\u8106\u5f31\u70b9\uff0c\u6301\u7eed\u4f18\u5316\u67b6\u6784\u97e7\u6027\u3002</li> </ol>"},{"location":"2025/3kubernetes_sre/","title":"5 Kubernetes SRE part1","text":""},{"location":"2025/3kubernetes_sre/#1-what-is-the-difference-between-a-deployment-and-a-statefulset-in-kubernetes","title":"1. What is the difference between a Deployment and a StatefulSet in Kubernetes?","text":"<p>A Deployment is used for stateless applications where the state of the application does not need to be preserved. </p> <p>It manages replica sets and ensures that the desired number of pod replicas are running.</p> <p>A StatefulSet, on the other hand, is used for stateful applications where each pod needs to be uniquely identified and must retain its state even after rescheduling.</p> <p>It assigns a stable identity (DNS name and persistent volume) to each pod</p> <p>Key differences:</p> <ul> <li>Pod Identity: StatefulSet pods have stable hostnames (e.g., web-0, web-1) while Deployment pods do not</li> <li>Storage: StatefulSets are typically used with persistent volume claims (PVCs) that are retained even when pods are deleted.</li> <li>Scaling behavior: StatefulSets create/delete pods in order, while Deployments do it in parallel.</li> </ul> <p>Example Use Case:</p> <ul> <li>Deployment: Web servers, microservices.</li> <li>StatefulSet: Databases like MySQL, MongoDB, Kafka</li> </ul> <p>Deployment</p> <ul> <li>Pods are anonymous</li> <li>Pods don't have stable storage</li> <li>Easy scaling (add/remove pods)</li> <li>Stateless applications</li> </ul> <p>StatefulSet</p> <ul> <li>Each pod has a unique identity (pod-0, pod-1)</li> <li>Each pod has its own persistent volume</li> <li>Scaling pods is more controlled with stable identities</li> <li>Stateful applications (e.g., databases)</li> </ul>"},{"location":"2025/3kubernetes_sre/#2-explain-how-kubernetes-handles-rolling-updates-and-rollbacks","title":"2. Explain how Kubernetes handles rolling updates and rollbacks.","text":"<p>Kubernetes supports rolling updates using the Deployment controller. </p> <p>It updates pods in a controlled fashion to minimize downtime. </p> <p>The process gradually replaces old pods with new ones, ensuring that some pods are always running</p> <p>RollingUpdate Strategy: Default update strategy in Deployments.</p> <ul> <li>maxUnavailable: How many pods can be unavailable during the update.</li> <li>maxSurge: How many extra pods can be created during the update.</li> </ul> <p>Rollback:</p> <p>If a rollout fails or a bug is introduced, Kubernetes allows you to rollback to the previous version</p> <pre><code>kubectl rollout undo deployment &lt;deployment-name&gt;\n\nkubectl rollout status deployment my-deployment\n\nkubectl rollout history deployment my-deployment\n\nkubectl rollout undo deployment my-deployment\n</code></pre> <p>Benefits:</p> <ul> <li>Zero-downtime deployment.</li> <li>Version tracking of rollouts.</li> <li>Fast recovery from bad deployments.</li> </ul>"},{"location":"2025/3kubernetes_sre/#3-what-are-kubernetes-daemonsets-and-give-a-real-world-use-case","title":"3. What are Kubernetes DaemonSets and give a real-world use case?","text":"<p>A DaemonSet ensures that a copy of a pod runs on every node (or a subset of nodes) in the cluster</p> <p>Use Cases:</p> <ul> <li>Running a node-level monitoring agent (e.g., Prometheus Node Exporter).</li> <li>Running a log collector (e.g., Fluentd, Filebeat).</li> <li>Running a storage driver or system daemon.</li> </ul> <p>When a new node is added to the cluster, the DaemonSet controller automatically schedules the pod on the new node.</p>"},{"location":"2025/3kubernetes_sre/#4-what-are-the-differences-between-configmap-and-secret-in-kubernetes","title":"4. What are the differences between ConfigMap and Secret in Kubernetes?","text":"<p>Both ConfigMap and Secret are used to inject configuration into pods, but they serve different purposes</p> <p>ConfigMap</p> <ul> <li>Store non-sensitive config data</li> <li>Plain text</li> <li>Not encrypted</li> <li>Yes</li> </ul> <p>Secret</p> <ul> <li>Store sensitive data (passwords, tokens)</li> <li>Base64 encoded</li> <li>Can be encrypted at rest (KMS)</li> <li>Yes</li> </ul>"},{"location":"2025/3kubernetes_sre/#5-what-is-the-role-of-etcd-in-a-kubernetes-cluster","title":"5. What is the role of etcd in a Kubernetes cluster?","text":"<p>etcd is a distributed key-value store used by Kubernetes to store all cluster data. </p> <p>It acts as the source of truth for the Kubernetes control plane.</p> <p>Responsibilities:</p> <ul> <li>Stores configuration data, cluster state, secrets, and service discovery info.</li> <li>Supports consistent reads and writes across the cluster.</li> </ul> <p>Key Features:</p> <ul> <li>Highly available and distributed.</li> <li>Uses Raft consensus algorithm for leader election and consistency.</li> <li>Requires backup and disaster recovery strategy.</li> </ul> <p>Security Considerations:</p> <ul> <li>TLS encryption.</li> <li>Authentication and access control.</li> </ul> <pre><code>To view keys in etcd (if directly accessing):\n\nETCDCTL_API=3 etcdctl get \"\" --prefix --keys-only\n</code></pre>"},{"location":"2025/3kubernetes_sre/#6-how-does-kubernetes-networking-work-explain-the-pod-to-pod-communication","title":"6. How does Kubernetes networking work? Explain the Pod-to-Pod communication.","text":"<p>Kubernetes networking is based on a flat network model, where all pods can communicate with each other without NAT (Network Address Translation), regardless of the node they\u2019re on.</p> <p>Core Networking Rules:</p> <ol> <li>Every pod gets its own IP address.</li> <li>All pods can reach each other directly via IP.</li> <li>Containers within a pod share the same network namespace (localhost).</li> <li>Communication between pods across nodes is handled by CNI plugins (e.g., Calico,Flannel, Cilium).</li> </ol> <p>Pod-to-Pod Communication Steps:</p> <ul> <li>Pod A wants to reach Pod B using Pod B\u2019s IP.</li> <li>If both pods are on the same node: traffic stays local.</li> <li>If on different nodes: the packet is routed via virtual network interfaces provided by the CNI plugin.</li> </ul> <pre><code>kubectl exec -it pod-a -- curl &lt;pod-b-ip&gt;:&lt;port&gt;\n</code></pre>"},{"location":"2025/3kubernetes_sre/#7-what-are-kubernetes-network-policies-and-how-do-they-work","title":"7. What are Kubernetes Network Policies and how do they work?","text":"<p>A NetworkPolicy in Kubernetes is a resource used to control traffic flow at the IP address or port level between pods</p> <p>Default Behavior:</p> <p>By default, all pods can communicate with all other pods. NetworkPolicies restrict this.</p> <p>Features:</p> <ul> <li>*Allow/deny ingress (incoming) or egress (outgoing) traffic.</li> <li>Based on labels, namespaces, and IP blocks.</li> <li>Require a CNI plugin that supports NetworkPolicy (e.g., Calico, Cilium)</li> </ul> <p>Example: Allow ingress traffic to pods with label app=db only from app=web:</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n name: allow-web-to-db\nspec:\n  podSelector:\n    matchLabels:\n      app: db\ningress:\n- from:\n  - podSelector:\n     matchLabels:\n       app: web\n</code></pre> <p>Note: NetworkPolicies are additive \u2014 start from \"deny all\" and explicitly allow traffic.</p> <p>Network Policies control the communication between pods and services in a Kubernetes cluster, based on IP addresses or labels. These policies are used to enforce security rules, isolating applications and reducing the attack surface</p> <p>Key Features:</p> <ul> <li>Can restrict incoming and outgoing traffic to/from pods.</li> <li>Works by defining ingress (incoming) and egress (outgoing) rules.</li> <li>Can target specific pod selectors or namespaces.</li> </ul> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n    name: allow-frontend\nspec:\n    podSelector:\n        matchLabels:\n            app: frontend\ningress:\n- from:\n    - podSelector:\n        matchLabels:\n            app: backend\nports:\n- protocol: TCP\n    port: 80\n</code></pre>"},{"location":"2025/3kubernetes_sre/#8-explain-the-kubernetes-control-plane-components-and-their-responsibilities","title":"8. Explain the Kubernetes control plane components and their responsibilities","text":"<p>The Kubernetes control plane is the brain of the cluster and consists of several components:</p> <ol> <li>kube-apiserver: Entry point for all REST API requests. Validates and processes requests.</li> <li>etcd: Stores all cluster state and configuration data.</li> <li>kube-scheduler: Assigns pods to nodes based on resource availability and constraints.</li> <li>kube-controller-manager: Runs all controllers (e.g., Node, Deployment, ReplicaSet controllers) to ensure the desired state.</li> <li>cloud-controller-manager: Manages cloud provider-specific control loops (like load balancers, volumes)</li> </ol> <p>Workflow Example:</p> <ul> <li>You apply a deployment YAML.</li> <li>kube-apiserver receives it.</li> <li>etcd stores the desired state.</li> <li>kube-controller-manager ensures replicas match.</li> <li>kube-scheduler assigns pods to nodes.</li> </ul> <p>This architecture allows scalability, self-healing, and declarative infrastructure.</p>"},{"location":"2025/3kubernetes_sre/#9-what-is-the-role-of-kubernetes-ingress-and-how-does-it-differ-from-a-service","title":"9. What is the role of Kubernetes Ingress and how does it differ from a Service?","text":"<p>An Ingress is a Kubernetes resource that manages external access to services, typically HTTP/HTTPS traffic. </p> <p>It acts as a Layer 7 (application layer) reverse proxy.</p> <p>Service</p> <p>L4 (TCP/UDP) / Expose internal or external service / Yes / TLS Support Manually via Service/LoadBalance</p> <p>Ingress</p> <p>L7 (HTTP/HTTPS) / Expose multiple services under a single IP / No (path/host-based rules) / Built-in SSL termination</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: web-ingress\nspec:\n rules:\n - host: example.com\n http:\n  paths:\n  - path: /app1\n    pathType: Prefix\n    backend:\n      service:\n        name: app1-service\n        port:\n          number: 80\n</code></pre> <p>Ingress Controllers(e.g., NGINX, Traefik) are required to implement ingress rules.</p>"},{"location":"2025/3kubernetes_sre/#10-how-do-you-perform-debugging-in-kubernetes-when-a-pod-is-not-starting","title":"10. How do you perform debugging in Kubernetes when a pod is not starting?","text":"<p>1. Describe the pod:</p> <pre><code>kubectl describe pod &lt;pod-name&gt;\n</code></pre> <p>Check events at the bottom \u2014 look for image pull errors, scheduling issues, resource limits.</p> <p>2. Check logs:</p> <pre><code>kubectl logs &lt;pod-name&gt;\n\nIf multiple containers:\nkubectl logs &lt;pod-name&gt; -c &lt;container-name&gt;\n</code></pre> <p>3. Check status</p> <pre><code>kubectl get pods\n</code></pre> <p>Look for status like CrashLoopBackOff, ImagePullBackOff, Pending.</p> <p>4. Exec into container (if running):</p> <pre><code>kubectl exec -it &lt;pod-name&gt; -- /bin/sh\n</code></pre> <p>5. Use ephemeral debug containers:</p> <pre><code>kubectl debug -it &lt;pod-name&gt; --image=busybox\n</code></pre> <p>6.Check node status:</p> <pre><code>kubectl get nodes\nkubectl describe node &lt;node-name&gt;\n</code></pre> <p>Common Issues:</p> <ul> <li>Missing ConfigMap/Secret</li> <li>Insufficient resources</li> <li>Incorrect image or tag</li> <li>Network policy restrictions</li> <li>Node taints or affinity rules</li> </ul>"},{"location":"2025/3kubernetes_sre/#11-what-is-a-kubernetes-job-and-how-does-it-differ-from-a-deployment","title":"11. What is a Kubernetes Job and how does it differ from a Deployment?","text":"<p>A Job in Kubernetes is used to run one-time or batch tasks that terminate once completed successfully. It ensures that a pod runs to completion (success or failure) and can be retried if it fails.</p> <p>A Deployment, by contrast, is used for long-running, stateless applications that must be kept running continuously.</p> <p>Use Cases for Job:</p> <ul> <li>Database migrations</li> <li>Sending notification emails</li> <li>Data backups</li> </ul> <p>Types of Jobs:</p> <ul> <li>One-off Job: Runs a pod to completion once.</li> <li>Parallel Job: Runs multiple pods in parallel.</li> <li>Completions &amp; Parallelism: Controls number of successful completions and concurrent pods.</li> </ul>"},{"location":"2025/3kubernetes_sre/#12-what-are-init-containers-in-kubernetes-and-why-are-they-used","title":"12. What are Init Containers in Kubernetes and why are they used?","text":"<p>Init Containers are specialized containers that run before the main application container in a pod. They are used to perform setup tasks such as:</p> <ul> <li>Waiting for a service to become available</li> <li>Cloning a git repository</li> <li>Setting environment preconditions</li> </ul> <p>Features:</p> <ul> <li>Run sequentially before app containers.</li> <li>Must complete successfully before main containers start.</li> <li>Support different images and tools than main containers</li> </ul> <pre><code>initContainers:\n- name: wait-for-db\n  image: busybox\n  command: ['sh', '-c', 'until nslookup mydb; do echo waiting; sleep 2; done']\n</code></pre> <p>Benefits:</p> <ul> <li>Separation of concerns.</li> <li>Improved modularity and debugging.</li> <li>Retry logic before main workload runs.</li> </ul>"},{"location":"2025/3kubernetes_sre/#13-what-are-taints-and-tolerations-in-kubernetes","title":"13. What are taints and tolerations in Kubernetes?","text":"<p>Taints are applied to nodes to prevent pods from being scheduled on them unless the pod has a matching toleration</p> <pre><code>kubectl taint nodes &lt;node-name&gt; key=value:NoSchedule\n</code></pre> <p>Taint Effects:</p> <ul> <li>NoSchedule: Pod will not be scheduled unless it tolerates the taint.</li> <li>PreferNoSchedule: Avoid scheduling if possible.</li> <li>NoExecute: Pod is evicted if already running.</li> </ul> <p>Use Cases:</p> <ul> <li>Reserve nodes for specific workloads (e.g., GPU jobs).</li> <li>Ensure critical workloads get priority on dedicated nodes.</li> </ul>"},{"location":"2025/3kubernetes_sre/#15-what-are-sidecar-containers-and-how-are-they-used-in-kubernetes","title":"15. What are sidecar containers and how are they used in Kubernetes?","text":"<p>A sidecar container is a helper container that runs in the same pod as the main application and provides supporting functionality.</p> <p>Common Use Cases:</p> <ul> <li>Logging agents (e.g., Filebeat)</li> <li>Proxies (e.g., Envoy in Istio)</li> <li>Data synchronization tools</li> <li>Service mesh communication</li> </ul> <pre><code>containers:\n- name: app\n  image: myapp\n- name: sidecar\n  image: busybox\ncommand: [\"tail\", \"-f\", \"/dev/null\"]\n</code></pre> <ul> <li>\u2022 Shares the same network namespace and volumes.</li> <li>\u2022 Can start and stop independently of the main container.</li> <li>\u2022 Promotes modularity and separation of concerns.</li> </ul>"},{"location":"2025/3kubernetes_sre/#16-what-are-kubernetes-volumes-and-how-do-they-differ-from-docker-volumes","title":"16. What are Kubernetes Volumes and how do they differ from Docker volumes?","text":"<p>In Kubernetes, a Volume is a directory accessible to containers in a pod that is preserved across container restarts.</p> <p>Differences from Docker Volumes:</p> <ul> <li>Kubernetes volumes are tied to the pod's lifecycle, not the container.</li> <li>Kubernetes supports different volume types (e.g., hostPath, emptyDir, configMap, persistentVolumeClaim).</li> </ul> <p>Common Volume Types:</p> <ul> <li>emptyDir: Temporary storage shared between containers.</li> <li>hostPath: Maps a file/directory from the host node.</li> <li>persistentVolumeClaim: For persistent storage (e.g., AWS EBS, NFS).</li> </ul> <pre><code>volumes:\n- name: data\n  emptyDir: {}\n</code></pre> <ul> <li>Share data between containers.</li> <li>Preserve logs or cache.</li> <li>Mount external storage (persistent).</li> </ul>"},{"location":"2025/3kubernetes_sre/#17-explain-kubernetes-persistentvolumes-pv-and-persistentvolumeclaims-pvc","title":"17. Explain Kubernetes PersistentVolumes (PV) and PersistentVolumeClaims (PVC).","text":"<ol> <li>Admin creates a PV or defines a StorageClass.</li> <li>User creates a PVC.</li> <li>Kubernetes binds a matching PV to the PVC.</li> <li>Pod mounts the PVC.</li> </ol> <p>Access Modes:</p> <ul> <li>\u2022 ReadWriteOnce \u2014 one node read/write.</li> <li>\u2022 ReadOnlyMany \u2014 multiple nodes read-only.</li> <li>\u2022 ReadWriteMany \u2014 multiple nodes read/write.</li> </ul>"},{"location":"2025/3kubernetes_sre/#18-what-is-a-kubernetes-serviceaccount-and-when-do-you-use-it","title":"18. What is a Kubernetes ServiceAccount and when do you use it?","text":"<p>A ServiceAccount provides an identity for pods to access the Kubernetes API or external</p> <p>Default Behavior:</p> <ul> <li>\u2022 Every pod is associated with a default service account in its namespace.</li> <li>\u2022 Tokens are automatically mounted into pods via /var/run/secrets/....</li> </ul> <p>Use Cases:</p> <ul> <li>\u2022 Granting fine-grained API permissions via RBAC.</li> <li>\u2022 Interacting with cloud provider APIs (e.g., via Workload Identity).</li> </ul> <pre><code>apiVersion: v1\nkind: ServiceAccount\nmetadata:\nname: read-only\n\n\nMounting in Pod:\n\nspec:\nserviceAccountName: read-only\n\n\nRBAC Binding Example:\n\nkind: RoleBinding\nroleRef:\n kind: Role\n name: pod-reader\n apiGroup: rbac.authorization.k8s.io\nsubjects:\n- kind: ServiceAccount\n  name: read-only\n</code></pre>"},{"location":"2025/3kubernetes_sre/#20-what-is-a-kubernetes-horizontal-pod-autoscaler-hpa-and-how-does-it-work","title":"20. What is a Kubernetes Horizontal Pod Autoscaler (HPA) and how does it work?","text":"<p>The Horizontal Pod Autoscaler (HPA) automatically scales the number of pods in a deployment, replication controller, or statefulset based on CPU/memory usage or custom metrics.</p> <p>How it Works:</p> <ul> <li>\u2022 Monitors pod metrics via the Metrics Server.</li> <li>\u2022 If usage exceeds target thresholds, it increases replicas.</li> <li>\u2022 If usage drops, it scales down.</li> </ul> <pre><code>kubectl autoscale deployment myapp --cpu-percent=50 --min=2 --max=10\n</code></pre> <pre><code>apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nspec:\n minReplicas: 2\n maxReplicas: 10\n metrics:\n - type: Resource\n   resource:\n    name: cpu\n    target:\n     type: Utilization\n     averageUtilization: 50\n</code></pre> <p>Dependencies:</p> <ul> <li>\u2022 Metrics Server must be installed.</li> <li>\u2022 Works with custom metrics (Prometheus Adapter) in v2.</li> </ul>"},{"location":"2025/3kubernetes_sre/#24-what-are-kubernetes-admission-controllers","title":"24. What are Kubernetes Admission Controllers?","text":"<p>Admission Controllers are plugins that intercept requests to the Kubernetes API after authentication and authorization but before persistence.</p> <p>Two Types:</p> <ul> <li>\u2022 Validating Admission Controllers: Validate the request (e.g., resource quota).</li> <li>\u2022 Mutating Admission Controllers: Modify the request (e.g., inject sidecar).</li> </ul> <p>Examples:</p> <ul> <li>\u2022 NamespaceLifecycle: Prevents deletion of system namespaces.</li> <li> <p>\u2022 LimitRanger: Enforces resource limits.</p> </li> <li> <p>\u2022 MutatingAdmissionWebhook: Used by Istio, Linkerd to inject proxies.</p> </li> <li>\u2022 ValidatingAdmissionWebhook: Used for custom validations.</li> </ul> <p>Use Case:</p> <p>Injecting a monitoring agent in all pods using a Mutating Admission Webhook.</p>"},{"location":"2025/3kubernetes_sre/#30-what-is-kubernetes-pod-disruption-budget-pdb","title":"30. What is Kubernetes Pod Disruption Budget (PDB)?","text":"<p>A PodDisruptionBudget ensures that a minimum number or percentage of pods in a deployment/statefulset remain available during voluntary disruptions, such as:</p> <ul> <li>Node drain</li> <li>Rolling updates</li> <li>Maintenance tasks</li> </ul> <p>PDB Example:</p> <pre><code>apiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: myapp-pdb\nspec:\nminAvailable: 2\nselector:\n matchLabels:\n app: myapp\n</code></pre> <p>Key Parameters:</p> <ul> <li>minAvailable: Minimum pods that must be running.</li> <li>maxUnavailable: Maximum pods that can be down.</li> </ul> <p>PDB does not apply to involuntary disruptions (e.g., hardware failure).</p>"},{"location":"2025/3kubernetes_sre/#33-what-is-a-kubernetes-replicaset-and-how-does-it-differ-from-a-deployment","title":"33. What is a Kubernetes ReplicaSet and how does it differ from a Deployment?","text":"<p>A ReplicaSet ensures that a specified number of pod replicas are running at all times. It is primarily used to maintain pod availability and redundancy.</p> <p>Differences with Deployment:</p> <ul> <li>A Deployment is a higher-level controller that manages ReplicaSets and provides rolling updates, rollbacks, and more.</li> <li>A ReplicaSet is responsible for maintaining the desired pod count but does not manage deployments, upgrades, or rollbacks.</li> </ul>"},{"location":"2025/3kubernetes_sre/#34-how-does-kubernetes-handle-pod-scheduling","title":"34. How does Kubernetes handle pod scheduling?","text":"<p>Kubernetes uses the Scheduler to assign pods to nodes in the cluster based on resource availability, constraints, and other scheduling policies</p> <p>Scheduling Steps:</p> <ol> <li>Predicate Phase: Filters nodes that don't meet pod requirements (e.g., resource requests, taints).</li> <li>Priority Phase: Prioritizes nodes based on constraints like affinity and anti-affinity rules, resource usage, etc</li> <li>Binding Phase: Assigns the pod to the selected node.</li> </ol> <p>Types of Scheduling Constraints:</p> <ul> <li>\u2022 Node Affinity: Scheduling based on node labels.</li> <li>\u2022 Taints and Tolerations: Restricting pod scheduling on specific nodes.</li> <li>\u2022 Pod Affinity/Anti-Affinity: Scheduling based on other pods in the cluster.</li> </ul> <pre><code>affinity:\n  nodeAffinity:\n    requiredDuringSchedulingIgnoredDuringExecution:\n     nodeSelectorTerms:\n     - matchExpressions:\n      - key: \"kubernetes.io/hostname\"\n        operator: In\n        values:\n        - node1\n</code></pre>"},{"location":"2025/3kubernetes_sre/#35-what-is-the-kubernetes-api-server-and-its-role","title":"35. What is the Kubernetes API Server and its role?","text":"<p>The Kubernetes API Server is the central control plane component that exposes the </p> <p>Kubernetes API and handles all requests to the cluster.</p> <p>Role:</p> <ul> <li>\u2022 Receives and validates API requests.</li> <li>\u2022 Acts as the interface between clients (kubectl, controllers, etc.) and the cluster.</li> <li>\u2022 Stores resource state in etcd.</li> <li>\u2022 Communicates with other components (e.g., Scheduler, Controller Manager).</li> </ul>"},{"location":"2025/3kubernetes_sre/#36-what-is-kubernetes-ingress-and-how-does-it-differ-from-a-service","title":"36. What is Kubernetes Ingress and how does it differ from a Service?","text":"<p>Ingress is a set of rules that allow inbound connections to reach the services in a Kubernetes cluster, often managing HTTP/HTTPS traffic.</p> <p>Differences from Service:</p> <p>Service provides a stable endpoint for accessing a set of pods, generally used for internal communication.</p> <p>Ingress manages external access, typically for HTTP/S traffic, by defining routing rules based on URL paths, hostnames, etc.</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: my-ingress\nspec:\n  rules:\n  - host: www.example.com\n    http:\n     paths:\n     - path: /foo\n       pathType: Prefix\n       backend:\n        service:\n          name: foo-service\n        port:\n         number: 80\n</code></pre> <p>Benefits:</p> <ul> <li>URL path-based routing.</li> <li>SSL termination.</li> <li>Load balancing and reverse proxy features.</li> </ul>"},{"location":"2025/3kubernetes_sre/#37-how-does-kubernetes-handle-cluster-upgrades","title":"37. How does Kubernetes handle cluster upgrades?","text":"<p>Kubernetes handles cluster upgrades in a rolling fashion to minimize downtime. The upgrade process includes:</p> <p>1. Control Plane Upgrades:</p> <p>Upgrade kube-apiserver, kube-controller-manager, kube-scheduler first. Ensure backward compatibility with existing nodes.</p> <p>3. Node Upgrades:</p> <ul> <li>Upgrade nodes one at a time to avoid disrupting the entire cluster.</li> <li>Use kubectl drain to evict pods and kubectl uncordon to bring nodes back online.</li> </ul> <p>Best Practices:</p> <ul> <li>Test the upgrade in a non-production environment.</li> <li>Upgrade kubelet and kubectl to the matching version after upgrading the control plane.</li> </ul>"},{"location":"2025/3kubernetes_sre/#38-what-is-kubernetes-horizontal-pod-autoscaler-hpa-and-how-is-it-configured","title":"38. What is Kubernetes Horizontal Pod Autoscaler (HPA) and how is it configured?","text":"<p>The Horizontal Pod Autoscaler (HPA) automatically adjusts the number of replicas of a pod based on observed metrics (e.g., CPU, memory, custom metrics).</p> <p>How it works:</p> <p>HPA monitors the metrics (usually from the Metrics Server) and adjusts pod replicas to meet the target utilization.</p> <p>Configuration Example:</p> <pre><code>kubectl autoscale deployment myapp --cpu-percent=50 --min=1 --max=10\n</code></pre> <p>Custom Metrics:</p> <p>To scale based on custom metrics, you need to use an adapter like the Prometheus Adapter.</p> <pre><code>apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n    name: myapp-hpa\nspec:\n    minReplicas: 2\n    maxReplicas: 10\nmetrics:\n - type: Resource\n   resource:\n    name: cpu\n    target:\n        type: Utilization\n        averageUtilization: 50\n</code></pre>"},{"location":"2025/3kubernetes_sre/#39-what-is-kubernetes-serviceaccount-and-how-is-it-used-for-api-access","title":"39. What is Kubernetes ServiceAccount and how is it used for API access?","text":"<p>A ServiceAccount provides an identity for pods to interact with the Kubernetes API.</p> <p>Key Features:</p> <ul> <li>Service accounts are used for API authentication.</li> <li>They allow fine-grained RBAC policies to control access.</li> <li>A default service account is automatically created in each namespace.</li> </ul>"},{"location":"2025/3kubernetes_sre/#42-how-does-kubernetes-handle-high-availability-ha-for-control-plane-components","title":"42. How does Kubernetes handle high availability (HA) for control plane components?","text":"<p>To achieve high availability for the Kubernetes control plane:</p> <ol> <li>Multiple API Servers: Deploy multiple kube-apiserver instances behind a load balancer.</li> <li>Etcd Cluster: Set up a distributed etcd cluster with an odd number of nodes (3, 5, etc.) to ensure quorum.</li> <li>Control Plane Pods: Deploy multiple replicas of components like kube-scheduler and kube-controller-manager.</li> </ol>"},{"location":"2025/3kubernetes_sre/#44-what-is-the-purpose-of-kubelet-in-kubernetes","title":"44. What is the purpose of kubelet in Kubernetes?","text":"<p>The kubelet is an agent that runs on each node in the cluster and ensures the containers in the pods are running as expected.</p> <p>Responsibilities:</p> <ul> <li>\u2022 Watches the API server for pod specifications and ensures the desired state is met on the node.</li> <li>\u2022 Monitors containers and restarts them if necessary (e.g., if they crash).</li> <li>\u2022 Reports node health to the API server.</li> </ul>"},{"location":"2025/3kubernetes_sre/#49-what-are-kubernetes-endpoints-and-how-are-they-related-to-services","title":"49. What are Kubernetes Endpoints and how are they related to Services?","text":"<p>Endpoints are objects that represent the IP addresses of the pods that back a Kubernetes Service.</p> <p>When a Service is created, Kubernetes automatically creates Endpoints objects that match the pods selected by the Service's label selector.</p> <p>How They Work:</p> <ul> <li>\u2022 The Service proxy forwards requests to the endpoints associated with the service.</li> <li>\u2022 When a pod is added or removed, the list of endpoints is updated.</li> </ul>"},{"location":"2025/3kubernetes_sre/#50-what-is-the-purpose-of-kubectl-drain-and-kubectl-cordon","title":"50. What is the purpose of kubectl drain and kubectl cordon?","text":"<p>These commands are used for node maintenance.</p> <ul> <li>kubectl cordon: Marks a node as unschedulable, preventing new pods from being scheduled on it.</li> <li>kubectl drain: Evicts all pods from the node, marking the node as unschedulable and preparing it for maintenance.</li> </ul> <pre><code>kubectl cordon node1\nkubectl drain node1 --ignore-daemonsets\n</code></pre> <ul> <li>Draining a node before maintenance (e.g., upgrading hardware or OS).</li> <li>Temporarily isolating a node from the cluster.</li> </ul>"},{"location":"2025/3kubernetes_sre2/","title":"6 Kubernetes SRE part2","text":""},{"location":"2025/3kubernetes_sre2/#part-1","title":"Part 1","text":""},{"location":"2025/3kubernetes_sre2/#1-statefulset-pods-restart-with-different-hostnames","title":"1. StatefulSet Pods Restart with Different Hostnames","text":"<p>Issue: StatefulSet guarantees stable network identities. </p> <p>If pods restart with different hostnames, it indicates the StatefulSet configuration might have been deleted and recreated, losing persistent identity.</p> <p>Root Cause</p> <ul> <li>PVCs or StatefulSet might have been deleted without volumeClaimTemplates.</li> <li>Misconfigured storage class or persistent volume reclaim policy.</li> </ul> <p>Fix:</p> <ul> <li>Ensure StatefulSet uses volumeClaimTemplates.</li> <li>Avoid deleting the StatefulSet; use kubectl apply or kubectl rollout.</li> <li>Validate persistentVolumeReclaimPolicy is Retain to keep PVCs.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#2-504-gateway-timeout-in-microservices","title":"2. 504 Gateway Timeout in Microservices","text":"<p>Root Cause:</p> <ul> <li>Readiness probes failing.</li> <li>Inter-service networking issues.</li> <li>Ingress timeout or service selector misconfiguration.</li> </ul> <p>Resolution:</p> <ul> <li>Check readiness probes: <code>kubectl describe pod &lt;pod&gt;</code>.</li> <li>Inspect Ingress controller logs.</li> <li>Increase timeout values in NGINX/HAProxy config.</li> <li>Use kubectl port-forward to debug services locally.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#3-zero-downtime-application-upgrade-strategy","title":"3. Zero Downtime Application Upgrade Strategy","text":"<p>Recommended Strategy:</p> <ul> <li>Use rolling updates with appropriate maxUnavailable=0.</li> <li>Configure readiness probes to delay traffic routing until the new pod is ready.</li> <li>Use PodDisruptionBudgets to control pod availability.</li> <li>For mission-critical services, consider Blue/Green or Canary deployments using Argo Rollouts or Flagger.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#4-namespace-overusing-cpu","title":"4. Namespace Overusing CPU","text":"<p>Detection:</p> <ul> <li>Monitor CPU usage: <code>kubectl top pods -n &lt;namespace&gt;</code>.</li> <li>Use Prometheus/Grafana dashboards.</li> </ul> <p>Prevention:</p> <ul> <li>Set ResourceQuota for namespaces.</li> <li>Apply LimitRange to define default CPU/memory limits per pod.</li> </ul> <pre><code>apiVersion: v1\nkind: ResourceQuota\nmetadata:\n  name: cpu-quota\n  namespace: &lt;namespace&gt;\nspec:\n  hard:\n   requests.cpu: \"2\"\n   limits.cpu: \"4\"\n</code></pre>"},{"location":"2025/3kubernetes_sre2/#5-deployment-rollout-stuck-progressdeadlineexceeded","title":"5. Deployment Rollout Stuck: ProgressDeadlineExceeded","text":"<p>Root Cause:</p> <ul> <li>New pods fail readiness probes.</li> <li>ImagePull errors or misconfigurations.</li> </ul> <p>Steps to Troubleshoot:</p> <ul> <li><code>kubectl rollout status deployment &lt;name&gt;</code></li> <li><code>kubectl describe pod &lt;pod&gt;</code> \u2013 check for probe errors or crash loops.</li> <li>Check events: <code>kubectl get events</code></li> </ul> <p>Fix</p> <ul> <li>Correct the readiness/liveness probes.</li> <li>Reapply deployment or rollback: <code>kubectl rollout undo</code></li> </ul>"},{"location":"2025/3kubernetes_sre2/#6-intermittent-coredns-dns-resolution-issues","title":"6. Intermittent CoreDNS DNS Resolution Issues","text":"<p>Troubleshooting Steps:</p> <ul> <li>Check CoreDNS logs: <code>kubectl logs -n kube-system -l k8s-app=kube-dns</code></li> <li>Use <code>kubectl exec -it &lt;pod&gt; -- nslookup &lt;svc-name&gt;</code></li> <li>Validate if nodes have DNS issues (<code>/etc/resolv.conf</code>).</li> </ul> <p>Fix:</p> <ul> <li>Increase CoreDNS memory/CPU.</li> <li>Add more CoreDNS replicas.</li> <li>Upgrade CoreDNS if bug-related.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#7-application-killed-with-oomkilled","title":"7. Application Killed with OOMKilled","text":"<p>Troubleshooting:</p> <ul> <li>Check pod description: <code>kubectl describe pod &lt;pod&gt;</code></li> <li>Inspect container logs for memory usage pattern.</li> </ul> <p>Solution:</p> <ul> <li>Set appropriate resource requests/limits.</li> <li>Use a memory profiler (Valgrind, pprof) inside containers.</li> <li>Use HPA to scale pods if high usage is expected.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#8-bluegreen-or-canary-deployment-with-rollback","title":"8. Blue/Green or Canary Deployment with Rollback","text":"<ul> <li>Use separate deployments for Blue and Green.</li> <li>Switch service selector after verification.</li> </ul> <p>For Canary:</p> <ul> <li>Use Argo Rollouts or Flagger with progressive traffic shifting.</li> </ul> <p>Rollback:</p> <p>Use <code>kubectl rollout undo deployment &lt;name&gt;</code> or switch service back to stable deployment.</p>"},{"location":"2025/3kubernetes_sre2/#9-secure-secrets-management","title":"9. Secure Secrets Management","text":"<p>Best Practices:</p> <ul> <li>Mount Secrets as volumes instead of env vars.</li> <li>Use tools like HashiCorp Vault or Sealed Secrets for encryption at rest and access control.</li> <li>Avoid logging secrets by configuring applications and log scrapers carefully</li> </ul>"},{"location":"2025/3kubernetes_sre2/#10-pods-being-frequently-rescheduled","title":"10. Pods Being Frequently Rescheduled","text":"<p>Diagnosis:</p> <ul> <li><code>kubectl describe node &lt;node&gt;</code> \u2013 check for disk pressure, memory pressure.</li> <li>Check taints, node auto-scaling events.</li> </ul> <p>Fix:</p> <ul> <li>Increase node resources.</li> <li>Implement podAntiAffinity or nodeSelector to control pod placement.</li> <li>Set priorityClassName to prevent eviction of critical pods.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#11-helm-chart-upgrade-breaks-production","title":"11. Helm Chart Upgrade Breaks Production","text":"<p>Diagnosis:</p> <p>Run <code>helm history &lt;release&gt;</code> to inspect changes. Use <code>helm diff</code> upgrade plugin for visibility.</p> <p>Rollback:</p> <p><code>Run helm rollback &lt;release&gt; &lt;revision&gt;</code> to revert to the previous working version.</p>"},{"location":"2025/3kubernetes_sre2/#12-hpa-not-scaling-with-high-cpu-usage","title":"12. HPA Not Scaling with High CPU Usage","text":"<p>Checkpoints:</p> <p>Metrics Server installed and running. Run <code>kubectl get --raw /apis/metrics.k8s.io/v1beta1/nodes</code>.</p> <p>Fix:</p> <ul> <li>Deploy Metrics Server if missing.</li> <li>Define proper resource requests and limits.</li> <li>Use this HPA config:</li> </ul> <pre><code>apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nspec:\nmetrics:\n- type: Resource\n resource:\n  name: cpu\n  target:\n   averageUtilization: 70\n   type: Utilization\n</code></pre>"},{"location":"2025/3kubernetes_sre2/#13-node-joins-but-schedules-no-pods","title":"13. Node Joins but Schedules No Pods","text":"<p>Possible Issues:</p> <ul> <li>Node is tainted (NoSchedule).</li> <li>Node status is NotReady.</li> <li>kubelet or networking misconfigured.</li> </ul> <p>Fix:</p> <ul> <li>Check taints: <code>kubectl describe node &lt;node&gt;</code></li> <li>Validate kubelet logs and network plugin.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#14-network-policy-blocking-traffic","title":"14. Network Policy Blocking Traffic","text":"<p>Debug Steps:</p> <ul> <li>Use <code>kubectl get networkpolicies -n &lt;ns&gt;</code></li> <li>Check if egress/ingress rules block unintended pods.</li> <li>Use netshoot or busybox pods to test connectivity.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#15-legacy-app-requiring-persistent-ip","title":"15. Legacy App Requiring Persistent IP","text":"<p>Solution:</p> <ul> <li>Use a Service with type=ClusterIP + static pod hostname.</li> <li>For external access, use LoadBalancer with ExternalIP or HostPort on dedicated node.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#17-secure-multi-tenant-cluster","title":"17. Secure Multi-Tenant Cluster","text":"<p>Controls:</p> <ul> <li>Use RBAC to restrict access per namespace.</li> <li>Apply Network Policies to isolate traffic.</li> <li>Use PodSecurityPolicies or OPA Gatekeeper.</li> <li>Enable audit logging and monitor activity per namespace.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#18-ingress-stops-routing-traffic","title":"18. Ingress Stops Routing Traffic","text":"<p>Debug:</p> <p>Check Ingress controller logs. Validate service endpoints: <code>kubectl get endpoints &lt;svc&gt;</code> Look for cert or path issues in annotations.</p> <p>Fix:</p> <ul> <li>Redeploy Ingress or check IngressClass.</li> <li>Ensure backend service is healthy and matches selector.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#20-securely-inject-rotate-db-credentials","title":"20. Securely Inject &amp; Rotate DB Credentials","text":"<p>Best Practices:</p> <ul> <li>Store credentials in Kubernetes Secrets.</li> <li>Use external secret managers like AWS Secrets Manager or HashiCorp Vault.</li> <li>Rotate credentials using a sidecar or sync controller (e.g., External Secrets Operator).</li> </ul>"},{"location":"2025/3kubernetes_sre2/#part-2","title":"Part 2","text":""},{"location":"2025/3kubernetes_sre2/#1-what-is-the-difference-between-clusterip-and-externalname-service-types","title":"1. What is the difference between ClusterIP and ExternalName service types?","text":"<ul> <li>*ClusterIP (default): Exposes the service on an internal IP, accessible only within the cluster.</li> <li>ExternalName: Maps a service to an external DNS name via CNAME, no internal proxying.</li> </ul> <pre><code>apiVersion: v1\nkind: Service\nmetadata:\n    name: external-service\nspec:\n type: ExternalName\n externalName: api.external.com\n</code></pre> <p>Use when you want to reference external services (e.g., AWS RDS) via DNS.</p>"},{"location":"2025/3kubernetes_sre2/#2-how-does-kubernetes-handle-failed-liveness-probes-over-time","title":"2. How does Kubernetes handle failed liveness probes over time?","text":"<p>Kubernetes uses liveness probes to check if a container is healthy. If the probe fails for a number of attempts (failureThreshold), it restarts the container.</p> <pre><code>livenessProbe:\n  httpGet:\n   path: /healthz\n   port: 8080\ninitialDelaySeconds: 10\nperiodSeconds: 5\nfailureThreshold: 3\n</code></pre> <p>If the container fails 3 checks (over 15 seconds), it will be restarted automatically.</p>"},{"location":"2025/3kubernetes_sre2/#3-how-do-you-set-up-pod-anti-affinity-rules","title":"3. How do you set up Pod Anti-Affinity rules?","text":"<p>Use anti-affinity to avoid scheduling similar pods on the same node for high availability.</p> <pre><code>affinity:\n  podAntiAffinity:\n  requiredDuringSchedulingIgnoredDuringExecution:\n  - labelSelector:\n      matchExpressions:\n      - key: app\n        operator: In\n        values:\n        - frontend\ntopologyKey: \"kubernetes.io/hostname\"\n</code></pre>"},{"location":"2025/3kubernetes_sre2/#4-explain-how-kubernetes-rbac-integrates-with-third-party-identity-providers","title":"4. Explain how Kubernetes RBAC integrates with third-party identity providers.","text":"<p>Use OIDC (OpenID Connect) integration with identity providers like Google, Azure AD, or Okta.</p> <p>1. Enable OIDC in the API server:</p> <pre><code>--oidc-issuer-url=https://accounts.google.com \\\n--oidc-client-id=your-client-id\n</code></pre>"},{"location":"2025/3kubernetes_sre2/#5-how-does-kubernetes-handle-node-scaling-with-cluster-autoscaler","title":"5. How does Kubernetes handle node scaling with Cluster Autoscaler?","text":"<p>Cluster Autoscaler (CA) automatically scales node groups in cloud environments (e.g., AWS ASG, GKE node pools).</p> <pre><code>helm repo add autoscaler https://kubernetes.github.io/autoscaler\n helm install cluster-autoscaler autoscaler/cluster-autoscaler \\\n --set autoDiscovery.clusterName=&lt;your-cluster&gt; \\\n --set awsRegion=&lt;region&gt;\n</code></pre> <p>CA monitors unschedulable pods and scales nodes up/down accordingly.</p>"},{"location":"2025/3kubernetes_sre2/#10-how-do-you-handle-stuck-finalizers-during-resource-deletion","title":"10. How do you handle stuck finalizers during resource deletion?","text":"<p>Resources with finalizers won't delete until cleanup logic runs.</p> <p>View the finalizers:</p> <p><code>kubectl get &lt;resource&gt; -o json</code></p> <p>Remove finalizers (carefully):</p> <pre><code>kubectl patch &lt;resource&gt; --type merge -p '{\"metadata\":{\"finalizers\":[]}}'\n</code></pre> <p>Only use this when the cleanup controller is failing</p>"},{"location":"2025/3kubernetes_sre2/#11-what-are-ephemeral-containers-and-how-do-you-use-them-for-debugging","title":"11. What are ephemeral containers and how do you use them for debugging?","text":"<p>Ephemeral containers are temporary containers added to a running pod for debugging without affecting the original container\u2019s state or lifecycle.</p> <p>Use Case: Debugging a crashed pod or an image without debugging tools.</p> <pre><code>kubectl debug -it &lt;pod-name&gt; --image=busybox --target=&lt;container-name&gt;\n</code></pre> <p>Note: Requires Kubernetes v1.18+ and EphemeralContainers feature enabled.</p>"},{"location":"2025/3kubernetes_sre2/#12-explain-the-role-of-kube-dns-or-coredns-in-service-discovery","title":"12. Explain the role of kube-dns or CoreDNS in service discovery.","text":"<ul> <li>CoreDNS is the default DNS service for Kubernetes.</li> <li>It resolves internal service names like <code>my-service.my-namespace.svc.cluster.local</code> to ClusterIP.</li> <li>Uses /etc/resolv.conf in pods, pointing to kube-dns or coredns.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#14-what-are-some-potential-performance-bottlenecks-in-kubernetes-workloads","title":"14. What are some potential performance bottlenecks in Kubernetes workloads?","text":"<ul> <li>CPU/Memory limits too low (throttling or OOMKilled)</li> <li>Disk I/O bottlenecks (especially for stateful apps)</li> <li>Network bottlenecks</li> <li>Node pressure (insufficient resources)</li> <li>High API server load due to misconfigured controllers or operators</li> </ul> <p>Monitor with: \uf0b7  - Prometheus + Grafana - kubectl top pod, top node</p>"},{"location":"2025/3kubernetes_sre2/#15-how-do-you-handle-network-segmentation-in-a-multi-tenant-kubernetes-cluster","title":"15. How do you handle network segmentation in a multi-tenant Kubernetes cluster?","text":"<ul> <li>Namespaces for logical isolation.</li> <li>Network Policies to control traffic.</li> </ul> <pre><code>kind: NetworkPolicy\nspec:\n  podSelector: \n  matchLabels: \n    role: \n      backend\ningress:\n- from:\n  - podSelector:\n      matchLabels: \n       role: \n         frontend\n</code></pre> <ul> <li>Use Calico/Cilium for advanced segmentation.</li> <li>Use RBAC to restrict access to namespace resource</li> </ul>"},{"location":"2025/3kubernetes_sre2/#16-what-is-the-difference-between-ephemeral-volumes-and-persistent-volumes","title":"16. What is the difference between ephemeral volumes and persistent volumes?","text":"<ul> <li>Ephemeral Tied to the pod lifecycle. Data lost after pod restarts.</li> <li>Persistent Backed by PersistentVolume, survives pod restarts.</li> </ul> <p>Ephemeral Volume Example:</p> <pre><code>volumes:\n- name: temp-storage\n  emptyDir: {}\n</code></pre> <p>Persistent Volume Example:</p> <pre><code>volumeMounts:\n - mountPath: /data\n   name: data-storage\nvolumes:\n - name: data-storage\n    persistentVolumeClaim:\n      claimName: my-pv\n</code></pre>"},{"location":"2025/3kubernetes_sre2/#17-how-do-you-manage-dynamic-secrets-in-kubernetes-for-applications","title":"17. How do you manage dynamic secrets in Kubernetes for applications?","text":"<ul> <li>HashiCorp Vault with Vault Agent Injector.</li> <li>AWS Secrets Manager + CSI Driver</li> <li>External Secrets Operator</li> </ul> <p>Vault injects secrets into pods using sidecar.</p> <ul> <li>Vault injects secrets into pods using sidecar.</li> <li>Use annotations:</li> </ul> <pre><code>annotations:\n  vault.hashicorp.com/agent-inject: \"true\"\n  vault.hashicorp.com/role: \"my-app\"\n</code></pre>"},{"location":"2025/3kubernetes_sre2/#18-how-would-you-perform-a-rolling-update-of-a-configmap-without-downtime","title":"18. How would you perform a rolling update of a ConfigMap without downtime?","text":"<p>ConfigMaps are not automatically updated in running pods.</p> <p>Use a checksum annotation to trigger rollout:</p> <pre><code>annotations:\n  configmap-checksum: \"{{ sha256sum .Values.configmap | trunc 63 }}\"\n</code></pre> <p>Process:</p> <ol> <li>Update ConfigMap.</li> <li>Re-deploy Deployment with new annotation.</li> <li>Kubernetes rolls pods gracefully.</li> </ol>"},{"location":"2025/3kubernetes_sre2/#19-what-is-kubectl-kustomize-and-how-does-it-compare-with-helm","title":"19. What is kubectl kustomize and how does it compare with Helm?","text":"<p>Kustomize: Template-free customization of Kubernetes YAML.</p> <p>Helm: Uses Go templates. Supports packaging, versioning, and dependencies.</p>"},{"location":"2025/3kubernetes_sre2/#20-how-would-you-detect-and-recover-from-node-pressure-scenarios-automatically","title":"20. How would you detect and recover from node pressure scenarios automatically?","text":"<p>Monitor node conditions:</p> <pre><code>kubectl describe node &lt;node&gt; | grep -A5 Conditions\n</code></pre> <p>Recover strategies:</p> <p>Enable Eviction Thresholds in kubelet:</p> <pre><code>--eviction-hard=memory.available&lt;500Mi,nodefs.available&lt;10%\n</code></pre> <ul> <li>Use Cluster Autoscaler to add more nodes.</li> <li>Alert on NodePressure, DiskPressure, MemoryPressure via Prometheus.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#21-how-do-poddisruptionbudgets-pdbs-interact-with-cluster-upgrades","title":"21. How do PodDisruptionBudgets (PDBs) interact with cluster upgrades?","text":"<p>PDBs limit how many pods can be unavailable during voluntary disruptions (e.g., upgrades).</p> <pre><code>spec:\n  minAvailable: 80%\n</code></pre> <ul> <li>During kubectl drain, nodes won't evict pods beyond the PDB limits, delaying upgrade.</li> <li>Adjust or temporarily remove PDBs for smooth upgrades.</li> </ul>"},{"location":"2025/3kubernetes_sre2/#23-how-would-you-migrate-workloads-between-clusters","title":"23. How would you migrate workloads between clusters?","text":"<ol> <li>Backup workloads:</li> </ol> <pre><code>kubectl get all --export -n &lt;ns&gt; -o yaml &gt; backup.yaml\n</code></pre> <ol> <li>Backup PVs (via Velero or cloud snapshots).</li> <li>Restore in new cluster:</li> </ol> <pre><code>kubectl apply -f backup.yaml\n</code></pre> <p>Tools: Velero, Heptio Ark, Cluster API, GitOps tools (e.g., ArgoCD).</p>"},{"location":"2025/3kubernetes_sre2/#24-how-do-you-detect-pod-level-dns-issues","title":"24. How do you detect pod-level DNS issues?","text":"<ol> <li>Use nslookup or dig inside pod:</li> </ol> <pre><code>kubectl exec -it &lt;pod&gt; -- nslookup myservice\n</code></pre> <ol> <li>Check CoreDNS logs:</li> </ol> <pre><code>kubectl logs -n kube-system -l k8s-app=kube-dns\n</code></pre> <ol> <li>Validate /etc/resolv.conf inside the pod.</li> </ol>"},{"location":"2025/3kubernetes_sre2/#25-how-does-container-resource-throttling-work-in-kubernetes","title":"25. How does container resource throttling work in Kubernetes?","text":"<ul> <li>Throttling occurs when CPU usage exceeds the CPU limit.</li> <li>Memory is not throttled; instead, container gets OOMKilled.</li> </ul> <pre><code>kubectl top pod &lt;pod&gt;\nkubectl describe pod &lt;pod&gt;\n</code></pre> <ul> <li>Set proper CPU/memory requests and limits.</li> <li>Monitor with Prometheus/Node Exporter.</li> </ul> <pre><code>helm diff upgrade my-release ./chart\n\n\uf0b7 Use Helm test hooks to verify deployments.\n\uf0b7 Run in staging first, then promote to production using GitOps.\n</code></pre>"},{"location":"2025/3linux/","title":"250 Linux Scenario Based Interview","text":"<p>Q1: How would you find all files larger than 100MB in a directory and its subdirectories?</p> <p><code>find /path/to/directory -type f -size +100M</code></p> <ul> <li><code>-type f</code>: Finds only files.</li> <li><code>-size +100M</code>: Specifies files larger than 100MB.</li> </ul> <p>Q3: How do you recursively delete all .log files in a directory?</p> <pre><code>find /path/to/directory -name \"*.log\" -type f -delete\n</code></pre> <ul> <li><code>-name \"*.log\u201d</code> : Matches files with .log extension.</li> <li><code>-type f</code>: Targets only files.</li> <li><code>-delete</code>: Deletes the files found.</li> </ul> <p>Q4: How do you create a tarball of /var/log and compress it with gzip?</p> <pre><code>tar -czvf logs.tar.gz /var/log\n</code></pre> <ul> <li>-c: Creates a tarball.</li> <li>-z: Compresses using gzip.</li> <li>-v: Verbose output.</li> <li>-f logs.tar.gz: Specifies the tarball file name.</li> </ul> <p>Q5: Test specific port availability:</p> <p><code>nc -zv &lt;server_ip&gt; &lt;port&gt;</code></p> <p>Q6: How do you permanently assign an IP address in Linux?</p> <p>Edit the network configuration file:</p> <p><code>vi /etc/sysconfig/network-scripts/ifcfg-eth0</code></p> <pre><code>IPADDR=192.168.1.100\nNETMASK=255.255.255.0\nGATEWAY=192.168.1.1\n</code></pre> <p><code>sudo systemctl restart network</code></p> <p>Q7: How do you identify a process consuming high CPU?</p> <pre><code>ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%cpu | head\n</code></pre> <p>Q8: How do you monitor disk I/O in real-time?</p> <p><code>iostat -x 2</code></p> <ul> <li>-x: Shows extended statistics.</li> <li>2: Refreshes every 2 seconds.</li> </ul> <p>Q9: How do you kill a process by its name?</p> <pre><code>pkill &lt;process_name&gt;\n\n\npgrep &lt;process_name&gt;\n\n</code></pre> <p>Q11: How do you set up a basic firewall rule to allow SSH traffic?</p> <pre><code>sudo ufw allow ssh\n\nsudo ufw status\n</code></pre>"},{"location":"2025/3linux/#how-do-you-check-for-unauthorized-access-attempts-on-your-server","title":"How do you check for unauthorized access attempts on your server?","text":"<pre><code>sudo cat /var/log/auth.log | grep \"Failed password\"\n</code></pre>"},{"location":"2025/3linux/#write-a-script-to-check-if-a-file-exists-and-display-its-permissions","title":"Write a script to check if a file exists and display its permissions.","text":"<pre><code>#!/bin/\nFILE=$1\nif [ -e \"$FILE\" ]; then\n echo \"File exists.\"\n ls -l \"$FILE\" | awk '{print $1}'\nelse\n echo \"File does not exist.\"\nfi\n</code></pre> <p>./script.sh filename</p>"},{"location":"2025/3linux/#how-would-you-write-a-script-to-archive-logs-older-than-7-days","title":"How would you write a script to archive logs older than 7 days?","text":"<pre><code>#!/bin/\nfind /var/log -type f -mtime +7 -exec tar -rvf old_logs.tar {} \\; -exec rm {} \\;\n</code></pre> <ul> <li><code>-mtime +7</code>: Finds files older than 7 days.</li> <li><code>-exec</code>: Executes tar to archive and rm to delete</li> </ul>"},{"location":"2025/3linux/#how-do-you-add-a-new-user-with-a-specific-home-directory","title":"How do you add a new user with a specific home directory?","text":"<pre><code>sudo useradd -m -d /custom/home/username username\n</code></pre> <ul> <li><code>-m</code>: Creates the home directory.</li> <li><code>-d</code>: Specifies the custom directory.</li> </ul> <p>How do you change the default shell for a user?</p> <pre><code>sudo usermod -s /bin/ username\n\ncat /etc/passwd | grep username\n</code></pre> <p>Inspect running processes:</p> <pre><code>ps aux --sort=-%cpu | head\n\n# Check I/O operations:\niostat -x 2\n\n# Verify memory usage:\nfree -m\n</code></pre>"},{"location":"2025/3linux/#how-do-you-extend-a-mounted-lvm-partition","title":"How do you extend a mounted LVM partition?","text":"<pre><code>sudo lvextend -L +10G /dev/mapper/vol_group-lv_name\n\nsudo resize2fs /dev/mapper/vol_group-lv_name\n</code></pre>"},{"location":"2025/3linux/#how-do-you-find-the-top-10-largest-files-in-a-directory","title":"How do you find the top 10 largest files in a directory?","text":"<pre><code>find /path/to/dir -type f -exec du -h {} + | sort -rh | head -n 10\n</code></pre>"},{"location":"2025/3linux/#how-do-you-back-up-a-directory-using-rsync","title":"How do you back up a directory using rsync?","text":"<pre><code>rsync -av /source/directory /destination/director\n</code></pre> <ul> <li>-a: Archive mode.</li> <li>-v: Verbose output</li> </ul>"},{"location":"2025/3linux/#how-do-you-restore-files-from-a-tar-backup","title":"How do you restore files from a tar backup?","text":"<p>Use logrotate:</p> <pre><code>sudo logrotate /etc/logrotate.conf --force\n</code></pre>"},{"location":"2025/3linux/#how-do-you-view-the-last-50-lines-of-a-log-file","title":"How do you view the last 50 lines of a log file?","text":"<pre><code>tail -n 50 /var/log/syslog\n</code></pre>"},{"location":"2025/3linux/#how-do-you-check-the-groups-a-user-belongs-to","title":"How do you check the groups a user belongs to?","text":"<pre><code>groups username\n</code></pre>"},{"location":"2025/4Linux_tb/","title":"4 Linux \u7cfb\u7edf\u6545\u969c\u65f6","text":""},{"location":"2025/4Linux_tb/#_1","title":"\u7b80\u4ecb","text":""},{"location":"2025/4Linux_tb/#1-cpu","title":"1 CPU \u6027\u80fd\u5206\u6790","text":"<ul> <li>top\uff1a \u5b9e\u65f6\u663e\u793a\u7cfb\u7edf\u7684 CPU\u3001\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\uff0c\u4ee5\u53ca\u5404\u4e2a\u8fdb\u7a0b\u7684\u8d44\u6e90\u6d88\u8017\u3002</li> <li>htop\uff1a top \u547d\u4ee4\u7684\u589e\u5f3a\u7248\uff0c\u754c\u9762\u66f4\u53cb\u597d\uff0c\u652f\u6301\u9f20\u6807\u64cd\u4f5c\uff0c\u53ef\u4ee5\u66f4\u52a0\u65b9\u4fbf\u5730\u67e5\u770b\u548c\u7ba1\u7406\u8fdb\u7a0b\u3002</li> <li>mpstat\uff1a \u663e\u793a\u5404\u4e2a CPU \u6838\u5fc3\u7684\u4f7f\u7528\u60c5\u51b5\uff0c\u5206\u6790\u591a\u6838\u7cfb\u7edf\u4e2d\u7684 CPU \u8d1f\u8f7d\u3002</li> <li>sar\uff1a \u7cfb\u7edf\u6d3b\u52a8\u62a5\u544a\u5de5\u5177\uff0c\u53ef\u4ee5\u76d1\u63a7 CPU\u3001\u5185\u5b58\u3001I/O \u7b49\u7cfb\u7edf\u8d44\u6e90\u7684\u4f7f\u7528\u60c5\u51b5\u3002\u5b83\u53ef\u4ee5\u5728\u957f\u65f6\u95f4\u5185\u8fdb\u884c\u7cfb\u7edf\u6027\u80fd\u7684\u6570\u636e\u91c7\u96c6\u3002</li> <li>vmstat\uff1a \u67e5\u770b CPU\u3001\u5185\u5b58\u3001\u4ea4\u6362\u5206\u533a\u7684\u6027\u80fd\uff0c\u80fd\u591f\u68c0\u6d4b CPU \u7684\u7b49\u5f85\u65f6\u95f4\u548c\u7cfb\u7edf\u74f6\u9888</li> </ul>"},{"location":"2025/4Linux_tb/#2","title":"2 \u5185\u5b58\u6027\u80fd\u5206\u6790","text":"<ul> <li>free\uff1a \u663e\u793a\u7cfb\u7edf\u5f53\u524d\u7684\u5185\u5b58\u548c\u4ea4\u6362\u5206\u533a\u4f7f\u7528\u60c5\u51b5\u3002 </li> <li>*vmstat\uff1a \u663e\u793a\u5185\u5b58\u3001\u8fdb\u7a0b\u3001I/O \u7cfb\u7edf\u7684\u6027\u80fd\u72b6\u6001\u3002\u53ef\u4ee5\u5e2e\u52a9\u5206\u6790\u5185\u5b58\u7684\u4f7f\u7528\u60c5\u51b5\u3002</li> <li>smem\uff1a \u8be6\u7ec6\u5217\u51fa\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u5185\u5b58\u6d88\u8017\u60c5\u51b5\u3002</li> <li>top / htop\uff1a \u53ef\u4ee5\u67e5\u770b\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5</li> <li>slabtop\uff1a \u663e\u793a\u5185\u6838 slab \u7f13\u5b58\u7684\u4f7f\u7528\u60c5\u51b5\uff0c\u6709\u52a9\u4e8e\u4e86\u89e3\u5185\u5b58\u4e2d\u7f13\u5b58\u6570\u636e\u5757\u7684\u5206\u5e03\u3002</li> </ul>"},{"location":"2025/4Linux_tb/#3-io","title":"3 \u78c1\u76d8IO\u6027\u80fd\u5206\u6790","text":"<ul> <li>iostat\uff1a \u663e\u793a\u78c1\u76d8 I/O \u7684\u6027\u80fd\u7edf\u8ba1\u4fe1\u606f\uff0c\u5c24\u5176\u662f\u5728\u5206\u6790\u78c1\u76d8\u8bfb\u5199\u6027\u80fd\u65f6\u975e\u5e38\u6709\u7528\u3002</li> <li>iotop\uff1a \u7c7b\u4f3c\u4e8e top\uff0c\u4f46\u4e13\u6ce8\u4e8e\u78c1\u76d8 I/O\uff0c\u80fd\u591f\u6309\u8fdb\u7a0b\u663e\u793a\u5b9e\u65f6 I/O \u6d3b\u52a8\u3002</li> <li>df\uff1a \u663e\u793a\u6587\u4ef6\u7cfb\u7edf\u7684\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5</li> <li>du\uff1a \u663e\u793a\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528\u60c5\u51b5\u3002</li> <li>lsblk\uff1a \u5217\u51fa\u6240\u6709\u5b58\u50a8\u8bbe\u5907\u548c\u5206\u533a\u4fe1\u606f\u3002</li> <li>blktrace\uff1a \u5bf9\u5757\u8bbe\u5907\u8fdb\u884c\u8be6\u7ec6\u7684 I/O \u8ddf\u8e2a\u5206\u6790\u3002</li> </ul>"},{"location":"2025/4Linux_tb/#4","title":"4 \u7f51\u7edc\u6027\u80fd\u5206\u6790","text":"<ul> <li>ifconfig / ip\uff1a \u663e\u793a\u548c\u914d\u7f6e\u7f51\u7edc\u63a5\u53e3\u7684\u4fe1\u606f\u3002</li> <li>netstat\uff1a \u67e5\u770b\u7f51\u7edc\u8fde\u63a5\u3001\u8def\u7531\u8868\u3001\u63a5\u53e3\u72b6\u6001\u3001\u534f\u8bae\u7edf\u8ba1\u7b49\u3002</li> <li>ss\uff1a \u66ff\u4ee3 netstat \u7684\u5de5\u5177\uff0c\u529f\u80fd\u66f4\u5f3a\u5927\uff0c\u901f\u5ea6\u66f4\u5feb\uff0c\u5206\u6790\u7f51\u7edc\u8fde\u63a5\u548c\u5957\u63a5\u5b57\u3002</li> <li>iftop\uff1a \u5b9e\u65f6\u76d1\u63a7\u7f51\u7edc\u5e26\u5bbd\u4f7f\u7528\u60c5\u51b5\uff0c\u663e\u793a\u6bcf\u4e2a\u7f51\u7edc\u8fde\u63a5\u7684\u5b9e\u65f6\u6d41\u91cf\u3002</li> <li>nload\uff1a \u5b9e\u65f6\u67e5\u770b\u7f51\u7edc\u6d41\u91cf\u7684\u5de5\u5177\uff0c\u80fd\u591f\u663e\u793a\u51fa\u5165\u53e3\u548c\u51fa\u53e3\u7684\u5e26\u5bbd\u4f7f\u7528\u60c5\u51b5\u3002</li> <li>ping\uff1a \u6d4b\u8bd5\u4e0e\u8fdc\u7a0b\u4e3b\u673a\u7684\u7f51\u7edc\u8fde\u901a\u6027\uff0c\u6d4b\u91cf\u7f51\u7edc\u5ef6\u8fdf\u3002</li> <li>traceroute\uff1a \u67e5\u770b\u6570\u636e\u5305\u4ece\u672c\u5730\u4e3b\u673a\u5230\u76ee\u6807\u4e3b\u673a\u7ecf\u8fc7\u7684\u8def\u7531\u4fe1\u606f\u3002</li> <li>tcpdump\uff1a \u5f3a\u5927\u7684\u7f51\u7edc\u6293\u5305\u5de5\u5177\uff0c\u80fd\u591f\u6355\u83b7\u548c\u5206\u6790\u7f51\u7edc\u6570\u636e\u5305\u3002</li> <li>nmap\uff1a \u7f51\u7edc\u626b\u63cf\u5de5\u5177\uff0c\u68c0\u67e5\u5f00\u653e\u7aef\u53e3\u3001\u4e3b\u673a\u53d1\u73b0\u548c\u7f51\u7edc\u670d\u52a1</li> </ul>"},{"location":"2025/4Linux_tb/#5","title":"5 \u8fdb\u7a0b\u7ba1\u7406","text":"<ul> <li>ps\uff1a \u5217\u51fa\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\u3002</li> <li>top / htop\uff1a \u67e5\u770b\u5b9e\u65f6\u8fdb\u7a0b\u8d44\u6e90\u6d88\u8017\u60c5\u51b5\u3002</li> <li>pstree\uff1a \u4ee5\u6811\u5f62\u7ed3\u6784\u5c55\u793a\u8fdb\u7a0b\u5173\u7cfb\u3002</li> <li>kill\uff1a \u7ec8\u6b62\u7279\u5b9a\u7684\u8fdb\u7a0b\u3002</li> <li>strace\uff1a \u8ddf\u8e2a\u7cfb\u7edf\u8c03\u7528\u548c\u4fe1\u53f7\uff0c\u5206\u6790\u8fdb\u7a0b\u6267\u884c\u7684\u7cfb\u7edf\u8c03\u7528\uff0c\u975e\u5e38\u9002\u5408\u8c03\u8bd5\u548c\u8ddf\u8e2a\u8fdb\u7a0b\u7684\u8fd0\u884c\u72b6\u6001\u3002</li> </ul>"},{"location":"2025/4Linux_tb/#6","title":"6 \u7efc\u5408\u6027\u80fd\u5206\u6790","text":"<ul> <li>dstat\uff1a \u7ed3\u5408 vmstat\u3001iostat\u3001netstat \u7b49\u5de5\u5177\u7684\u529f\u80fd\uff0c\u5b9e\u65f6\u663e\u793a CPU\u3001\u5185\u5b58\u3001\u78c1\u76d8 I/O\u3001\u7f51\u7edc\u7b49\u8d44\u6e90\u7684\u4f7f\u7528\u60c5\u51b5\u3002</li> <li>perf\uff1a \u5185\u6838\u63d0\u4f9b\u7684\u5f3a\u5927\u6027\u80fd\u5206\u6790\u5de5\u5177\uff0c\u652f\u6301\u91c7\u6837\u3001\u8ddf\u8e2a\u548c\u6027\u80fd\u5206\u6790\uff0c\u9002\u5408\u5f00\u53d1\u4eba\u5458\u548c\u9ad8\u7ea7\u7528\u6237\u8fdb\u884c\u6df1\u5165\u7684\u6027\u80fd\u8c03\u4f18\u3002</li> <li>sar\uff1a \u7cfb\u7edf\u76d1\u63a7\u548c\u62a5\u544a\u5de5\u5177\uff0c\u53ef\u4ee5\u8be6\u7ec6\u8bb0\u5f55 CPU\u3001\u5185\u5b58\u3001\u7f51\u7edc\u3001I/O \u7b49\u5404\u65b9\u9762\u7684\u6027\u80fd\u3002</li> <li>sysstat\uff1a \u5305\u542b iostat\u3001mpstat\u3001sar \u7b49\u591a\u79cd\u5de5\u5177\u7684\u7efc\u5408\u5de5\u5177\u5305\u3002</li> <li>glances\uff1a \u7c7b\u4f3c\u4e8e htop \u548c dstat \u7684\u7ed3\u5408\uff0c\u5b9e\u65f6\u76d1\u63a7 CPU\u3001\u5185\u5b58\u3001\u78c1\u76d8\u3001\u7f51\u7edc\u3001\u8fdb\u7a0b\u7b49\u591a\u9879\u7cfb\u7edf\u6027\u80fd\u6307\u6807</li> </ul>"},{"location":"2025/4Linux_tb/#_2","title":"\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"2025/4Linux_tb/#1-cpu_1","title":"1 CPU\u6027\u80fd\u5206\u6790","text":""},{"location":"2025/4Linux_tb/#1-top","title":"1. top","text":"<ul> <li>\u7528\u9014\uff1a \u5b9e\u65f6\u76d1\u63a7 CPU\u3001\u5185\u5b58\u53ca\u8fdb\u7a0b\u8d44\u6e90\u6d88\u8017\u3002</li> </ul> <pre><code>top -c  # \u663e\u793a\u5b8c\u6574\u8fdb\u7a0b\u547d\u4ee4\u884c\n</code></pre> <p>htop / mpstat</p> <ul> <li>mpstat \u7528\u9014\uff1a \u76d1\u63a7\u591a\u6838 CPU \u5404\u6838\u5fc3\u5229\u7528\u7387\u3002</li> <li>htop \u589e\u5f3a\u7248 top\uff0c\u652f\u6301\u9f20\u6807\u64cd\u4f5c\u3001\u591a\u6838\u8d1f\u8f7d\u53ef\u89c6\u5316\u3002</li> <li>perf: \u6df1\u5165\u5206\u6790 CPU \u6027\u80fd\u4e8b\u4ef6\uff08\u5982\u51fd\u6570\u70ed\u70b9\u3001\u7f13\u5b58\u547d\u4e2d\u7387\uff09\u3002</li> </ul> <pre><code>mpstat -P ALL 1  # \u6bcf\u79d2\u5237\u65b0\u6240\u6709\u6838\u5fc3\u72b6\u6001\n</code></pre> <pre><code>perf top       # \u5b9e\u65f6\u67e5\u770b CPU \u70ed\u70b9\nperf record -g # \u751f\u6210\u706b\u7130\u56fe\u6570\u636e\n</code></pre>"},{"location":"2025/4Linux_tb/#2_1","title":"2 \u5185\u5b58\u6027\u80fd\u5206\u6790","text":"<p>1. free</p> <p>\u7528\u9014\uff1a \u5feb\u901f\u67e5\u770b\u5185\u5b58\u548c Swap \u4f7f\u7528\u91cf\u3002</p> <pre><code>free -h  # \u4ee5 GB/MB \u663e\u793a\n</code></pre> <p>2. vmstat</p> <ul> <li>\u7528\u9014\uff1a \u7efc\u5408\u76d1\u63a7\u5185\u5b58\u3001Swap\u3001\u8fdb\u7a0b\u961f\u5217\u548c I/O\u3002</li> <li>\u793a\u4f8b\uff1a</li> </ul> <pre><code>vmstat 1  # \u6bcf\u79d2\u5237\u65b0\u4e00\u6b21\n</code></pre>"},{"location":"2025/4Linux_tb/#3-io_1","title":"3 \u78c1\u76d8IO\u6027\u80fd\u5206\u6790","text":"<p>1 iostat\uff08\u9700\u5b89\u88c5 sysstat\uff09</p> <p>\u7528\u9014\uff1a \u76d1\u63a7\u78c1\u76d8\u541e\u5410\u91cf\u3001\u5ef6\u8fdf\u548c\u5229\u7528\u7387\u3002</p> <pre><code>iostat -xz 1  # \u67e5\u770b\u8be6\u7ec6 I/O \u7edf\u8ba1\n</code></pre>"},{"location":"2025/4Linux_tb/#4_1","title":"4 \u7f51\u7edc\u6027\u80fd\u5206\u6790","text":""},{"location":"2025/4Linux_tb/#1-ss","title":"1 ss","text":"<p>\u7528\u9014\uff1a \u66ff\u4ee3 netstat\uff0c\u5feb\u901f\u67e5\u770b\u8fde\u63a5\u548c\u7aef\u53e3\u72b6\u6001</p> <pre><code>ss -tunlp  # \u663e\u793a\u6240\u6709 TCP/UDP \u8fde\u63a5\u53ca\u8fdb\u7a0b\n</code></pre>"},{"location":"2025/4Linux_tb/#2-tcpdump","title":"2 tcpdump","text":"<p>\u7528\u9014\uff1a \u6293\u5305\u5206\u6790\u7f51\u7edc\u6d41\u91cf\uff08\u9700 root \u6743\u9650\uff09\u3002</p> <pre><code>tcpdump -i eth0 port 80  # \u6293\u53d6 HTTP \u6d41\u91cf\n</code></pre>"},{"location":"2025/4Linux_tb/#5_1","title":"5 \u8fdb\u7a0b\u7ea7\u5206\u6790","text":"<p>1.pidstat\uff08\u9700\u5b89\u88c5 sysstat \uff09</p> <p>\u7528\u9014\uff1a \u76d1\u63a7\u8fdb\u7a0b\u7684 CPU\u3001\u5185\u5b58\u3001I/O\u3002</p> <pre><code>pidstat -d -p 1234 1  # \u76d1\u63a7 PID 1234 \u7684\u78c1\u76d8 I/O\n</code></pre> <p>2.strace</p> <p>\u7528\u9014\uff1a \u8ddf\u8e2a\u8fdb\u7a0b\u7684\u7cfb\u7edf\u8c03\u7528\u548c\u4fe1\u53f7\u3002</p> <pre><code>strace -p 1234 -T  # \u8ddf\u8e2a PID 1234 \u7684\u8c03\u7528\u8017\u65f6\n</code></pre>"},{"location":"2025/4Linux_tb/#5_2","title":"5 \u9ad8\u9891\u573a\u666f\u901f\u67e5","text":""},{"location":"2025/4Linux_tb/#_3","title":"\u7cfb\u7edf\u5361\u987f\uff1a","text":"<pre><code>top \u2192 vmstat 1 \u2192 iostat 1 \u2192 pidstat 1  # \u9010\u5c42\u5b9a\u4f4d\u74f6\u9888\n</code></pre>"},{"location":"2025/4Linux_tb/#_4","title":"\u7f51\u7edc\u5ef6\u8fdf\uff1a","text":"<pre><code>ping 8.8.8.8 \u2192 traceroute google.com \u2192 tcpdump -i eth0  # \u9010\u6b65\u6392\u67e5\n</code></pre>"},{"location":"2025/4Linux_tb/#_5","title":"\u8fdb\u7a0b\u5f02\u5e38\uff1a","text":"<pre><code>strace -p &lt;PID&gt; \u2192 perf record -g -p &lt;PID&gt;  # \u5206\u6790\u7cfb\u7edf\u8c03\u7528\u548c CPU \u70ed\u70b9\n</code></pre>"},{"location":"2025/4Linux_tb/#6_1","title":"6 \u5b9e\u7528\u7ec4\u5408\u547d\u4ee4","text":"<p>\u67e5\u627e CPU/\u5185\u5b58\u5360\u7528 Top \u8fdb\u7a0b\uff1a</p> <pre><code>ps aux --sort=-%cpu | head -10  # Top 10 CPU \u8fdb\u7a0b\nps aux --sort=-%mem | head -10  # Top 10 \u5185\u5b58\u8fdb\u7a0b\n</code></pre> <p>\u6301\u7eed\u76d1\u63a7\u78c1\u76d8\u7a7a\u95f4\uff1a</p> <pre><code>watch -n 1 'df -h'  # \u6bcf\u79d2\u5237\u65b0\u78c1\u76d8\u4f7f\u7528\n</code></pre>"},{"location":"2025/4Linux_tb/#7","title":"7 \u4f7f\u7528\u573a\u666f\u603b\u7ed3","text":"<ul> <li>\u7cfb\u7edf\u53d8\u6162\uff1a \u5148\u7528 top \u6216 htop \u67e5\u770b\u6574\u4f53\u8d1f\u8f7d\uff0c\u518d\u7528 vmstat/iostat \u5b9a\u4f4d CPU\u3001\u78c1\u76d8\u6216\u5185\u5b58\u74f6\u9888\u3002</li> <li>\u7f51\u7edc\u5ef6\u8fdf\uff1a iftop \u6216 nethogs \u67e5\u770b\u6d41\u91cf\uff0ctcpdump \u6293\u5305\u5206\u6790\u3002</li> <li>\u8fdb\u7a0b\u5361\u6b7b\uff1a strace \u8ddf\u8e2a\u7cfb\u7edf\u8c03\u7528\uff0cperf \u5206\u6790 CPU \u70ed\u70b9</li> </ul>"},{"location":"2025/4Linux_tb/#8-vmstat","title":"8 vmstat","text":"<p>vmstat \u547d\u4ee4\u663e\u793a\u4e86 \u7cfb\u7edf\u8d44\u6e90\u7684\u5b9e\u65f6\u72b6\u6001\uff0c\u5e2e\u52a9\u4f60\u76d1\u63a7 CPU\u3001\u5185\u5b58\u3001IO\u3001\u8fdb\u7a0b\u7b49\u8d44\u6e90\u7684\u4f7f\u7528\u60c5\u51b5</p> <p>1.procs\uff08\u8fdb\u7a0b\u76f8\u5173\uff09</p> <ul> <li>r\uff1a\u8fd0\u884c\u961f\u5217\u4e2d\u7b49\u5f85 CPU \u7684\u8fdb\u7a0b\u6570\u3002\u5982\u679c\u8fd9\u4e2a\u6570\u503c\u5927\u4e8e CPU \u6838\u5fc3\u6570\u91cf\uff0c\u8bf4\u660e\u7cfb\u7edf CPU \u8d44\u6e90\u4e0d\u8db3\u3002</li> <li>b\uff1a\u4e0d\u53ef\u4e2d\u65ad\u7761\u7720\u7684\u8fdb\u7a0b\u6570\uff08\u4e00\u822c\u662f\u7b49\u5f851/O \u7684\u8fdb\u7a0b</li> </ul> <p>2.memory\uff08\u5185\u5b58\u76f8\u5173\uff09</p> <ul> <li>swpd\uff1a\u4f7f\u7528\u7684swap \u7a7a\u95f4\uff08\u5355\u4f4d\uff1aKB\uff09\u3002\u5982\u679c\u975e0\uff0c\u8868\u793a\u7cfb\u7edf\u5df2\u7ecf\u5728\u4f7f\u7528swap \u5206\u533a\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u6027\u80fd\u3002</li> <li>free\uff1a\u7a7a\u95f2\u5185\u5b58\uff08\u5355\u4f4d\uff1aKB\uff09\u3002</li> <li>buff\uff1a\u7528\u4e8e\u7f13\u51b2\u533a\u7684\u5185\u5b58\uff08\u5355\u4f4d\uff1aKB\uff09\uff0c\u7528\u4e8e\u5b58\u50a8\u6587\u4ef6\u7cfb\u7edf\u7684\u5143\u6570\u636e\u3002</li> <li>cache\uff1a\u7528\u4e8e\u7f13\u5b58\u7684\u5185\u5b58\uff08\u5355\u4f4d\uff1aKB\uff09\uff0c\u52a0\u901f\u6570\u636e\u8bfb\u53d6\u3002\u5982\u679c\u7f13\u5b58\u547d\u4e2d\u7387\u9ad8\uff0c\u4f1a\u51cf\u5c111/O \u538b\u529b\u3002</li> </ul> <p>3 swap\uff08\u4ea4\u6362\u5206\u533a\u76f8\u5173\uff09</p> <ul> <li>si \uff08swap in\uff09\uff1a\u4eceswap \u5206\u533a\u4ea4\u6362\u5230\u5185\u5b58\u7684\u5927\u5c0f\uff08\u5355\u4f4d\uff1aKB/\u79d2\uff09\u3002</li> <li>so \uff08swap out\uff09\uff1a\u4ece\u5185\u5b58\u4ea4\u6362\u5230 swap \u5206\u533a\u7684\u5927\u5c0f\uff08\u5355\u4f4d\uff1aKB/\u79d2\uff09\u3002</li> <li>\u5982\u679csi \u548cso\u503c\u8f83\u5927\uff0c\u8bf4\u660e\u7cfb\u7edf\u5185\u5b58\u4e0d\u8db3\uff0c\u9700\u8981\u9891\u7e41\u4f7f\u7528swap\uff0c\u8fd9\u4f1a\u964d\u4f4e\u6027\u80fd\u3002</li> </ul> <p>4.i0 \uff08I/O\u76f8\u5173\uff09</p> <ul> <li>bi \uff08block in\uff09\uff1a\u4ece\u5757\u8bbe\u5907\uff08\u5982\u78c1\u76d8\uff09\u8bfb\u53d6\u7684\u6570\u636e\u91cf\uff08\u5355\u4f4d\uff1a\u5757/\u79d2\uff09\u3002</li> <li>bo \uff08block out\uff09\uff1a\u5199\u5165\u5757\u8bbe\u5907\uff08\u5982\u78c1\u76d8\uff09\u7684\u6570\u636e\u91cf\uff08\u5355\u4f4d\uff1a\u5757/\u79d2\uff09\u3002</li> <li>\u8fd9\u4e24\u4e2a\u503c\u9ad8\u65f6\uff0c\u8bf4\u660e\u78c1\u76d8 I/O \u6d3b\u52a8\u9891\u7e41\uff0c\u53ef\u80fd\u4f1a\u6210\u4e3a\u7cfb\u7edf\u74f6\u9888\u3002</li> </ul> <p>5. \u7cfb\u7edf\u76f8\u5173</p> <ul> <li>in\uff1a \u6bcf\u79d2\u4e2d\u65ad\u6b21\u6570\uff0c\u5305\u62ec\u786c\u4ef6\u548c\u7cfb\u7edf\u65f6\u949f\u4e2d\u65ad\u3002</li> <li>cs\uff08context switches\uff09\uff1a \u6bcf\u79d2\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\u3002\u4e0a\u4e0b\u6587\u5207\u6362\u591a\u8bf4\u660e\u8fdb\u7a0b\u9891\u7e41\u5207\u6362\uff0c\u53ef\u80fd\u5f71\u54cd\u6027\u80fd\u3002</li> </ul> <p>6 CPU</p> <ul> <li>us\uff08user time\uff09\uff1a CPU \u82b1\u8d39\u5728\u7528\u6237\u8fdb\u7a0b\u4e0a\u7684\u65f6\u95f4\u767e\u5206\u6bd4\u3002\u7528\u6237\u8fdb\u7a0b\u662f\u6307\u975e\u5185\u6838\u7684\u5e94\u7528\u7a0b\u5e8f\u3002</li> <li>sy\uff08system time\uff09\uff1a CPU \u82b1\u8d39\u5728\u7cfb\u7edf\u5185\u6838\u8fdb\u7a0b\u4e0a\u7684\u65f6\u95f4\u767e\u5206\u6bd4\u3002</li> <li>id\uff08idle time\uff09\uff1a CPU \u7684\u7a7a\u95f2\u65f6\u95f4\u767e\u5206\u6bd4\u3002\u5982\u679c\u503c\u5f88\u9ad8\uff0c\u8bf4\u660e CPU \u6bd4\u8f83\u7a7a\u95f2\u3002</li> <li>wa\uff08wait time\uff09\uff1a CPU \u7b49\u5f85 I/O \u7684\u65f6\u95f4\u767e\u5206\u6bd4\u3002\u5982\u679c\u503c\u9ad8\uff0c\u8bf4\u660e I/O \u6210\u4e3a\u7cfb\u7edf\u74f6\u9888\u3002</li> <li>st\uff08steal time\uff09\uff1a \u865a\u62df\u673a\u4e2d\uff0cCPU \u88ab\u5176\u4ed6\u865a\u62df\u673a\u5360\u7528\u7684\u65f6\u95f4\u767e\u5206\u6bd4\u3002\u5982\u679c\u503c\u9ad8\uff0c\u8bf4\u660e\u865a\u62df\u5316\u8d44\u6e90\u4e0d\u8db3</li> </ul> <p>\u5982\u4f55\u5206\u6790\u56fe\u4e2d\u7684\u6570\u636e</p> <ul> <li>r \u4e3a 0\uff1a \u6ca1\u6709\u7b49\u5f85 CPU \u7684\u8fdb\u7a0b\uff0cCPU \u8d44\u6e90\u5145\u8db3\u3002</li> <li>id \u9ad8\u8fbe 98-97%\uff1a CPU \u57fa\u672c\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001\uff0c\u7cfb\u7edf\u8d1f\u8f7d\u5f88\u4f4e\u3002</li> <li>wa \u4e3a 0%\uff1a \u6ca1\u6709 CPU \u7b49\u5f85 I/O\uff0cI/O \u6027\u80fd\u6b63\u5e38\u3002</li> <li>si \u548c so \u4e3a 0\uff1a \u7cfb\u7edf\u6ca1\u6709\u4f7f\u7528 swap\uff0c\u5185\u5b58\u5145\u8db3\u3002</li> <li>bi \u548c bo \u8f83\u4f4e\uff1a \u78c1\u76d8 I/O \u538b\u529b\u4e0d\u5927\u3002</li> </ul> <p>\u4ece\u622a\u56fe\u6765\u770b\uff0c\u7cfb\u7edf\u6574\u4f53\u8fd0\u884c\u72b6\u6001\u975e\u5e38\u826f\u597d\uff1a</p> <ul> <li>CPU \u57fa\u672c\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001\uff08id \u5f88\u9ad8\uff09\u3002</li> <li>\u6ca1\u6709\u4f7f\u7528 swap\uff08swpd\u3001si\u3001so \u90fd\u662f 0\uff09\u3002</li> <li>\u6ca1\u6709\u7b49\u5f85 CPU \u6216 I/O \u7684\u8fdb\u7a0b\uff08r\u3001b \u548c wa \u90fd\u63a5\u8fd1 0\uff09\u3002</li> </ul>"},{"location":"2025/4python/","title":"13 Python","text":""},{"location":"2025/4python/#basic-data-types","title":"Basic Data types","text":""},{"location":"2025/4python/#q1-what-are-the-basic-data-types-in-python","title":"Q.1 What are the basic data types in Python","text":"<p>Ans: The basic data types in Python are:</p> <ul> <li>Integer: represents whole numbers.</li> <li>Float: represents decimal numbers.</li> <li>String: represents a sequence of characters.</li> <li>Boolean: represents either True or False.</li> <li>List: represents an ordered collection of elements.</li> </ul>"},{"location":"2025/4python/#q2-how-do-you-convert-a-string-to-an-integer-in-python","title":"Q.2 How do you convert a string to an integer in Python?","text":"<p>You can use the int() function to convert a string to an integer. For example:</p> <pre><code>num_str = \"10\"\nnum_int = int(num_str)\n</code></pre>"},{"location":"2025/4python/#q3-how-do-you-check-the-data-type-of-a-variable-in-python","title":"Q.3 How do you check the data type of a variable in Python?","text":"<p>You can use the <code>\"type ()\"</code> function to check the data type of a variable. For example:</p> <pre><code>num = 10\nprint(type(num)) # Output: \u2039class 'int'\u203a\n</code></pre>"},{"location":"2025/4python/#q4-what-is-the-difference-between-a-list-and-a-tuple-in","title":"Q.4 What is the difference between a list and a tuple in","text":"<p>A list is mutable, which means you can modify its elements, while a tuple is immutable, meaning its elements cannot be changed after creation.</p>"},{"location":"2025/4python/#q5-how-do-you-create-an-empty-dictionary-in-python","title":"Q.5 How do you create an empty dictionary in Python?","text":"<p>You can create an empty dictionary using either the curly braces {} or the dict() function. For</p> <p>example:</p> <pre><code>empty_dict = {}\nempty_dict = dict()\n</code></pre>"},{"location":"2025/4python/#topic-2-oops-concept-in-python","title":"Topic 2 OOPS concept in Python:","text":""},{"location":"2025/4python/#q1-what-is-oops-and-how-is-it-implemented-in-python","title":"Q.1 What is OOPS and how is it implemented in Python?","text":"<p>Object-Oriented Programming (OOPS) is a programming paradigm that uses objects to represent real-world entities. </p> <p>In Python, OOPS is implemented through classes and objects. Classes are blueprints for creating objects, and objects are instances of a class.</p>"},{"location":"2025/4python/#q2-what-are-the-four-principles-of-oops","title":"Q.2 What are the four principles of OOPS?","text":"<p>Ans: The four principles of OOPS are:</p> <ul> <li>\u2022 Encapsulation: bundling of data and methods that operate on that data within a single unit (class).</li> <li>\u2022 Inheritance: ability of a class to inherit properties and methods from its parent class.</li> <li>\u2022 Polymorphism: ability of an object to take on different forms or behaviors based on the context.</li> <li>\u2022 Abstraction: representing essential features and hiding unnecessary details to simplify the complexity.</li> </ul> <p>\u4ee5\u4e0b\u662f Python \u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\uff08Object-Oriented Programming\uff09\u7279\u6027\u7684\u4e2d\u6587\u7ffb\u8bd1\uff1a</p> <ul> <li>\u5c01\u88c5\uff08Encapsulation\uff09\uff1a\u5c06\u6570\u636e\u53ca\u64cd\u4f5c\u6570\u636e\u7684\u65b9\u6cd5\u6346\u7ed1\u5728\u5355\u4e00\u5355\u5143\uff08\u7c7b\uff09\u4e2d\u3002</li> <li>\u7ee7\u627f\uff08Inheritance\uff09\uff1a\u5b50\u7c7b\u7ee7\u627f\u7236\u7c7b\u5c5e\u6027\u548c\u65b9\u6cd5\u7684\u80fd\u529b\u3002</li> <li>\u591a\u6001\uff08Polymorphism\uff09\uff1a\u5bf9\u8c61\u6839\u636e\u4e0a\u4e0b\u6587\u5448\u73b0\u4e0d\u540c\u5f62\u5f0f\u6216\u884c\u4e3a\u7684\u80fd\u529b\u3002</li> <li>\u62bd\u8c61\uff08Abstraction\uff09\uff1a\u901a\u8fc7\u5c55\u73b0\u6838\u5fc3\u7279\u5f81\u5e76\u9690\u85cf\u975e\u5fc5\u8981\u7ec6\u8282\u6765\u7b80\u5316\u590d\u6742\u6027\u3002</li> </ul> <p>\u5c01\u88c5\uff1a \u5f3a\u8c03\u6570\u636e\u4e0e\u65b9\u6cd5\u7684\u6574\u5408\uff0c\u901a\u8fc7\u8bbf\u95ee\u63a7\u5236\uff08\u5982\u79c1\u6709\u53d8\u91cf <code>_var</code>\uff09\u5b9e\u73b0\u4fe1\u606f\u9690\u85cf</p> <p>\u7ee7\u627f: \u5b50\u7c7b\u590d\u7528\u7236\u7c7b\u903b\u8f91\uff08<code>class Child(Parent)</code>\uff09\uff0c\u652f\u6301\u591a\u5c42\u7ee7\u627f\u548c\u65b9\u6cd5\u91cd\u5199</p> <p>\u591a\u6001</p> <ul> <li>\u65b9\u6cd5\u91cd\u5199\uff08\u5b50\u7c7b\u8986\u5199\u7236\u7c7b\u65b9\u6cd5\uff09</li> <li>\u9e2d\u5b50\u7c7b\u578b\uff08\u4e0d\u540c\u5bf9\u8c61\u5b9e\u73b0\u76f8\u540c\u65b9\u6cd5\u540d\uff09</li> </ul> <pre><code>class Dog:\n    def speak(self): print(\"\u6c6a\u6c6a\")\n\nclass Cat:\n    def speak(self): print(\"\u55b5\u55b5\")\n\ndef animal_sound(obj):  # \u591a\u6001\u8c03\u7528\n    obj.speak()\n</code></pre> <p>\u62bd\u8c61</p> <p>\u901a\u8fc7\u62bd\u8c61\u57fa\u7c7b\uff08ABC\uff09\u6216\u63a5\u53e3\u8bbe\u8ba1\uff0c\u805a\u7126\u6838\u5fc3\u529f\u80fd\uff1a</p> <pre><code>from abc import ABC, abstractmethod\nclass Shape(ABC):\n    @abstractmethod\n    def area(self):  # \u5f3a\u5236\u5b50\u7c7b\u5b9e\u73b0\u6838\u5fc3\u903b\u8f91\n        pass\n</code></pre>"},{"location":"2025/4python/#q5-what-is-the-difference-between-a-class-method-and-an-instance-method-in-python","title":"Q.5 What is the difference between a class method and an instance method in Python?","text":"<p>Ans: A class method is a method bound to the class and not the instance of the class. </p> <p>It is defined using the @classmethod decorator and can access only class-level variables. </p> <p>On the other hand, an instance method is bound to the instance of the class and can access both instance and class-level</p>"},{"location":"2025/4python/#topic-3-string-handling-functions","title":"Topic 3 String handling functions","text":""},{"location":"2025/4python/#q1-how-do-you-concatenate-two-strings-in-python","title":"Q.1 How do you concatenate two strings in Python?","text":"<p>You can concatenate two strings using the + operator. For example:</p> <pre><code>str1 = \"Hello\"\nstr2 = \"World\"\nresult = stri + str2 # Output: \"HelloWorld\":\n</code></pre>"},{"location":"2025/4python/#q2-how-do-you-find-the-length-of-a-string-in-python","title":"Q.2 How do you find the length of a string in Python?","text":"<p>You can use the len() function to find the length of a string. For example:</p> <pre><code>str1 = \"Hello World\"\nlength = len(str1) # Output:\n</code></pre>"},{"location":"2025/4python/#q3-how-do-you-convert-a-string-to-uppercase-in-python","title":"Q.3 How do you convert a string to uppercase in Python?","text":"<p>Ans: You can use the upper) method to convert a string to uppercase. For example:</p> <pre><code>str1 = \"hello\"\nuppercase_str = str1. upper) # Output: \"HELLO\"\n</code></pre>"},{"location":"2025/4python/#q4-how-do-you-split-a-string-into-a-list-of-substrings-in-python","title":"Q.4 How do you split a string into a list of substrings in Python?","text":"<p>You can use the <code>split\uff08)</code> method to split a string into a list of substrings based on a delimiter. For example:</p> <pre><code>str1 = \"Hello,World\"\nsubstrings = str1.split(\",\")\n\n# Output: [\"Hello\",World\"]\n</code></pre>"},{"location":"2025/4python/#q5-how-do-you-check-if-a-string-contains-a-specific-substring-in-python","title":"Q.5 How do you check if a string contains a specific substring in Python?","text":"<p>You can use the in keyword to check if a substring is present in a string. For example:</p> <pre><code>str1 = \"Hello World\"\nis_present = \"World\" in str1 # Output: True\n</code></pre>"},{"location":"2025/4python/#topic-4-control-statements-functions-in-python","title":"Topic 4 Control statements, functions in Python:","text":"<pre><code>if condition:\n# Code block executed if the condition is\n\nTrue else:\n# Code block executed if the condition is\nFalse\n</code></pre>"},{"location":"2025/4python/#q3-how-do-you-define-a-function-in-python","title":"Q.3 How do you define a function in Python?","text":"<p>A function in Python is defined using the def keyword. For example:</p> <pre><code>def greet():\n    print(\"Hello, world!\")\n</code></pre>"},{"location":"2025/4python/#q4-how-do-you-pass-arguments-to-a-function-in-python","title":"Q.4 How do you pass arguments to a function in Python?","text":"<pre><code>def greet (name):\n    print(\"Hello,\" + name + \"!\")\n</code></pre>"},{"location":"2025/4python/#q5-how-do-you-return-a-value-from-a-function-in-python","title":"Q.5 How do you return a value from a function in Python?","text":"<pre><code>def add (a, b):\n return a + b\n</code></pre>"},{"location":"2025/4python/#topic-5-special-data-types-in-python","title":"Topic 5 Special data types in Python:","text":"<p>Q.1 What is a set in Python?</p> <p>A set in Python is an unordered collection of unique elements.</p> <pre><code>my_set =  {1,2,3} #Output: {1,2,3}\n</code></pre> <p>Q.2 What is a dictionary in Python?</p> <pre><code>my_dict = {\"name\": \"John\", \"age\": 25}\n</code></pre> <p>Q.3 How do you access values in a dictionary in Python?</p> <p>You can access values in a dictionary by using the corresponding key. For example:</p> <pre><code>my_dict = {\"name\": \"John\", \"age\": 25}\nprint(my_dict[\"name\"]) # Output: \"John\"\n</code></pre> <p>Q.4 What is a tuple in Python?</p> <p>A tuple in Python is an ordered and immutable collection of elements. It is defined using parentheses <code>() or the tuple()</code> constructor. For example:</p> <pre><code>my_tuple = (1, 2, 3) # Output: (1, 2, 3)\n</code></pre> <p>Q.5 How do you swap the values of two variables in Python?</p> <pre><code>a = 5\nb = 10\na, b = b, a\nprint(a, b) # Output: 10, 5\n</code></pre>"},{"location":"2025/4python/#3-lambda-functions-list-comprehension","title":"3 Lambda functions\uff0c list comprehension:","text":""},{"location":"2025/4python/#q1-what-is-a-lambda-function-in-python","title":"Q.1 What is a lambda function in Python?","text":"<p>A lambda function is an anonymous function defined using the lambda keyword. It is typically used for short, one-line functions. For example:</p> <pre><code>square = lambda x: x**2\nprint (square (3)) # Output: 9\n</code></pre>"},{"location":"2025/4python/#q2-what-is-list-comprehension-in-python","title":"Q.2 What is list comprehension in Python?","text":"<p>List comprehension is a concise way to create lists in Python based on existing lists or other iterables. It combines the creation of a new list with a loop and optional conditional statements. For example:</p> <pre><code>numbers = [1, 2, 3, 5]\nsquared_numbers = [x**2 for x in numbers]\nprint(squared_numbers)\n\n# Output: [1, 4, 9, 16, 25]\n</code></pre>"},{"location":"2025/4python/#q3-how-do-you-filter-elements-in-a-list-using-list","title":"Q.3 How do you filter elements in a list using list","text":"<p>You can filter elements in a list using list comprehension by adding a conditional statement.</p> <p>For example, to filter even numbers:</p> <pre><code>numbers = [1, 2, 3,4, 5]\neven_numbers = Ix for x in numbers if x % 2 == 0]\nprint (even_numbers) # Output: [2, 4]\n</code></pre>"},{"location":"2025/4python/#q4-can-you-have-multiple-if-conditions-in-list-comprehension","title":"Q.4 Can you have multiple if conditions in list comprehension?","text":"<p>Yes, you can have multiple if conditions in list comprehension by chaining them using the and or or operators. </p> <pre><code>numbers = [1, 2, 3, 4, 5]\nfiltered_numbers = [x for x in numbers if x % 2==0 and x &gt; 2]\nprint(filtered_numbers) \n\n# Output: [4]\n</code></pre>"},{"location":"2025/4python/#q5-how-do-you-create-a-dictionary-using-list-comprehension-in-python","title":"Q.5 How do you create a dictionary using list comprehension in Python?","text":"<p>Ans: You can create a dictionary using list comprehension by specifying key-value pairs within curly braces <code>{}</code>.</p> <p>For example:</p> <pre><code>keys = ['a', 'b', 'c']\nvalues = [1, 2, 3]\nmy_dict = {k: v for k, v in zip(keys, values)}\nprint(my_dict) \n\n# Output: {'a': 1, 'b': 2, 'c': 3}\n</code></pre>"},{"location":"2025/5aws/","title":"5 AWS \u9762\u8bd5","text":""},{"location":"2025/5aws/#1-ec2","title":"1. \u4ec0\u4e48\u662f EC2 \u5b9e\u4f8b\u7c7b\u578b\uff1f","text":"<p>Amazon EC2 \u5b9e\u4f8b\u7c7b\u578b\u662f\u6839\u636e\u8ba1\u7b97\u3001\u5185\u5b58\u3001\u5b58\u50a8\u548c\u7f51\u7edc\u9700\u6c42\u63d0\u4f9b\u7684\u4e0d\u540c\u914d\u7f6e\u3002AWS \u63d0\u4f9b\u591a\u79cd\u5b9e\u4f8b\u7c7b\u578b\uff0c\u4ee5\u6ee1\u8db3\u4e0d\u540c\u7684\u5de5\u4f5c\u8d1f\u8f7d\u9700\u6c42</p> <ul> <li>\u8ba1\u7b97\u4f18\u5316\u5b9e\u4f8b\uff1a \u9002\u7528\u4e8e\u9700\u8981\u5f3a\u5927\u8ba1\u7b97\u80fd\u529b\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u4f8b\u5982\uff0cC \u7cfb\u5217\u5b9e\u4f8b\u3002</li> <li>\u5185\u5b58\u4f18\u5316\u5b9e\u4f8b\uff1a \u9002\u7528\u4e8e\u9700\u8981\u5927\u91cf\u5185\u5b58\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u4f8b\u5982\uff0cR \u7cfb\u5217\u5b9e\u4f8b\u3002</li> <li>\u5b58\u50a8\u4f18\u5316\u5b9e\u4f8b\uff1a \u9002\u7528\u4e8e\u9700\u8981\u9ad8\u901f\u3001\u4f4e\u5ef6\u8fdf\u5b58\u50a8\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u4f8b\u5982\uff0cI \u7cfb\u5217\u5b9e\u4f8b\u3002</li> <li>\u901a\u7528\u578b\u5b9e\u4f8b\uff1a \u9002\u7528\u4e8e\u5e73\u8861\u7684\u8ba1\u7b97\u3001\u5185\u5b58\u548c\u7f51\u7edc\u9700\u6c42\u3002\u4f8b\u5982\uff0cT \u7cfb\u5217\uff08\u9002\u5408\u77ed\u671f\u7a81\u53d1\u7684\u8ba1\u7b97\u8d1f\u8f7d\uff09\u548c M \u7cfb\u5217\u3002</li> <li>\u52a0\u901f\u8ba1\u7b97\u5b9e\u4f8b\uff1a \u9002\u7528\u4e8e GPU \u8ba1\u7b97\u7684\u5e94\u7528\u3002\u4f8b\u5982\uff0cP \u7cfb\u5217\u3001G \u7cfb\u5217\u5b9e\u4f8b\u3002</li> </ul>"},{"location":"2025/5aws/#2-s3simple-storage-service-ebselastic-block-store","title":"2. \u89e3\u91ca S3\uff08Simple Storage Service\uff09\u548c EBS\uff08Elastic Block Store\uff09\u7684\u533a\u522b","text":"<ul> <li>S3 \u662f\u4e00\u4e2a\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\uff0c\u9002\u7528\u4e8e\u5b58\u50a8\u9759\u6001\u6587\u4ef6\uff08\u5982\u56fe\u7247\u3001\u89c6\u9891\u3001\u5907\u4efd\u6587\u4ef6\u7b49\uff09\u3002\u5b83\u901a\u8fc7 URL \u8bbf\u95ee\uff0c\u5e76\u5177\u6709\u9ad8\u53ef\u6269\u5c55\u6027\u548c\u53ef\u7528\u6027\u3002</li> <li>EBS \u662f\u5757\u5b58\u50a8\u670d\u52a1\uff0c\u9002\u7528\u4e8e EC2 \u5b9e\u4f8b\uff0c\u9700\u8981\u6302\u8f7d\u5728\u5b9e\u4f8b\u4e0a\u624d\u80fd\u4f7f\u7528\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u6570\u636e\u5e93\u3001\u6587\u4ef6\u7cfb\u7edf\u7b49\u9700\u8981\u4f4e\u5ef6\u8fdf\u3001\u6301\u7eed\u6027\u5b58\u50a8\u7684\u573a\u666f</li> </ul>"},{"location":"2025/5aws/#3-aws-vpc","title":"3. \u4ec0\u4e48\u662f AWS VPC\uff1f","text":"<p>AWS VPC\uff08Virtual Private Cloud \u662f Amazon Web Services \u63d0\u4f9b\u7684\u4e00\u9879\u670d\u52a1\uff0c\u5141\u8bb8\u7528\u6237\u5728 AWS \u4e91\u4e2d\u521b\u5efa\u4e00\u4e2a\u9694\u79bb\u7684\u7f51\u7edc\u73af\u5883\u3002</p> <p>VPC \u4f7f\u5f97\u60a8\u53ef\u4ee5\u81ea\u5b9a\u4e49 IP \u5730\u5740\u8303\u56f4\u3001\u5b50\u7f51\u3001\u8def\u7531\u8868\u3001\u7f51\u7edc\u7f51\u5173\u7b49\u3002</p> <ul> <li>\u5b50\u7f51\uff1a \u5728 VPC \u4e2d\uff0c\u60a8\u53ef\u4ee5\u5212\u5206\u5b50\u7f51\uff08Subnet\uff09\uff0c\u6bcf\u4e2a\u5b50\u7f51\u53ef\u4ee5\u662f\u516c\u6709\u6216\u79c1\u6709\u7684\u3002\u516c\u6709\u5b50\u7f51\u53ef\u4ee5\u901a\u8fc7 Internet Gateway \u8bbf\u95ee\u4e92\u8054\u7f51\uff0c\u79c1\u6709\u5b50\u7f51\u5219\u901a\u5e38\u7528\u4e8e\u6ca1\u6709\u76f4\u63a5\u8bbf\u95ee\u4e92\u8054\u7f51\u7684\u8d44\u6e90\u3002</li> <li>Internet Gateway\uff1a \u5141\u8bb8\u4e0e\u4e92\u8054\u7f51\u901a\u4fe1\u3002</li> <li>NAT Gateway/Instance\uff1a \u5728\u79c1\u6709\u5b50\u7f51\u4e2d\u8fd0\u884c\u7684\u5b9e\u4f8b\u901a\u8fc7 NAT \u7f51\u5173\u6216\u5b9e\u4f8b\u8bbf\u95ee\u4e92\u8054\u7f51\u3002</li> <li>\u8def\u7531\u8868\uff1a \u63a7\u5236\u6d41\u91cf\u5982\u4f55\u5728\u5b50\u7f51\u4e4b\u95f4\u3001\u5b50\u7f51\u4e0e\u5916\u90e8\u4e4b\u95f4\u6d41\u52a8</li> </ul>"},{"location":"2025/5aws/#4-security-groups-network-acls","title":"4 \u89e3\u91ca Security Groups \u548c Network ACLs \u7684\u533a\u522b","text":"<p>Security Groups \u662f AWS \u5b9e\u4f8b\u7ea7\u522b\u7684\u9632\u706b\u5899\uff0c\u5b83\u4eec\u662f\u6709\u72b6\u6001\u7684\uff0c\u610f\u5473\u7740\u5982\u679c\u4f60\u5141\u8bb8\u67d0\u4e2a\u6d41\u91cf\u8fdb\u6765\uff0c\u5b83\u4f1a\u81ea\u52a8\u5141\u8bb8\u76f8\u5173\u7684\u54cd\u5e94\u6d41\u91cf\u51fa\u53bb</p> <p>Network ACLs \u662f\u5b50\u7f51\u7ea7\u522b\u7684\u9632\u706b\u5899\uff0c\u652f\u6301\u5165\u7ad9\u548c\u51fa\u7ad9\u89c4\u5219\u3002\u5b83\u662f\u65e0\u72b6\u6001\u7684\uff0c\u5373\u4f60\u9700\u8981\u663e\u5f0f\u914d\u7f6e\u5141\u8bb8\u7684\u5165\u7ad9\u548c\u51fa\u7ad9\u89c4\u5219\u3002Network ACLs \u66f4\u5e38\u7528\u4e8e\u5b9e\u73b0\u66f4\u7ec6\u7c92\u5ea6\u7684\u7f51\u7edc\u8bbf\u95ee\u63a7\u5236\u3002</p>"},{"location":"2025/5aws/#5-aws-shield-ddos","title":"5 \u4ec0\u4e48\u662f AWS Shield\uff1f\u5b83\u5982\u4f55\u4fdd\u62a4\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u514d\u53d7 DDoS \u653b\u51fb\uff1f","text":"<p>AWS Shield \u662f AWS \u63d0\u4f9b\u7684 DDoS \u9632\u62a4\u670d\u52a1\uff0c\u5206\u4e3a\u4e24\u79cd\uff1aShield Standard \u548c Shield Advanced\u3002</p> <ul> <li> <p>Shield Standard \u9ed8\u8ba4\u542f\u7528\uff0c\u63d0\u4f9b\u57fa\u7840 DDoS \u9632\u62a4\uff1b</p> </li> <li> <p>\u800c Shield Advanced \u63d0\u4f9b\u66f4\u5f3a\u7684\u9632\u62a4\uff0c\u5e76\u80fd\u591f\u81ea\u52a8\u54cd\u5e94\u5927\u89c4\u6a21\u7684 DDoS \u653b\u51fb\uff0c\u5e2e\u52a9\u4fdd\u62a4\u5e94\u7528\u7a0b\u5e8f\u514d\u53d7\u6d41\u91cf\u6df9\u6ca1\u3001\u7f51\u7edc\u5c42\u653b\u51fb\u7b49\u5a01\u80c1</p> </li> </ul>"},{"location":"2025/5aws/#6","title":"6. \u4f60\u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u9ad8\u53ef\u7528\u548c\u5bb9\u9519\u7684\u67b6\u6784\u6765\u5904\u7406\u5927\u91cf\u7528\u6237\u8bf7\u6c42\uff1f","text":"<p>\u4e3a\u4e86\u8bbe\u8ba1\u4e00\u4e2a\u9ad8\u53ef\u7528\u548c\u5bb9\u9519\u7684\u67b6\u6784\uff0c\u9996\u5148\u8981\u786e\u4fdd\u5e94\u7528\u7a0b\u5e8f\u8de8\u591a\u4e2a Availability Zones \u90e8\u7f72\uff0c\u5e76\u4f7f\u7528 Elastic Load Balancer\uff08ELB\uff09\u5206\u53d1\u6d41\u91cf\u3002</p> <p>\u63a5\u7740\uff0c\u53ef\u4ee5\u5229\u7528 Auto Scaling \u81ea\u52a8\u589e\u52a0\u6216\u51cf\u5c11\u5b9e\u4f8b\u6570\u91cf\u4ee5\u5e94\u5bf9\u6d41\u91cf\u6ce2\u52a8\u3002</p> <p>\u6570\u636e\u5e93\u65b9\u9762\uff0c\u53ef\u4ee5\u4f7f\u7528 RDS Multi-AZ \u6216 DynamoDB \u63d0\u4f9b\u9ad8\u53ef\u7528\u6027\u548c\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u3002\u4e3a\u4e86\u907f\u514d\u5355\u70b9\u6545\u969c\uff0c\u53ef\u4ee5\u8003\u8651\u4f7f\u7528 Route 53 \u914d\u5408\u5065\u5eb7\u68c0\u67e5\u5b9e\u73b0\u6d41\u91cf\u7684\u667a\u80fd\u8def\u7531\u3002</p>"},{"location":"2025/5aws/#7-auto-scaling-load-balancer","title":"7. \u4f60\u5982\u4f55\u4f7f\u7528 Auto Scaling \u548c Load Balancer \u6765\u4fdd\u8bc1\u5e94\u7528\u7684\u53ef\u4f38\u7f29\u6027\u548c\u9ad8\u53ef\u7528\u6027\uff1f","text":"<p>\u901a\u8fc7 Auto Scaling\uff0c\u53ef\u4ee5\u6839\u636e\u8bbe\u5b9a\u7684\u6307\u6807\uff08\u5982 CPU \u4f7f\u7528\u7387\u3001\u5185\u5b58\u3001\u7f51\u7edc\u6d41\u91cf\u7b49\uff09\u81ea\u52a8\u8c03\u6574 EC2 \u5b9e\u4f8b\u7684\u6570\u91cf\uff0c\u786e\u4fdd\u5728\u6d41\u91cf\u9ad8\u5cf0\u65f6\u523b\u5e94\u7528\u80fd\u591f\u81ea\u52a8\u6269\u5c55\uff0c\u6d41\u91cf\u8f83\u4f4e\u65f6\u523b\u5219\u51cf\u5c11\u5b9e\u4f8b\u6570\u4ee5\u8282\u7701\u6210\u672c\u3002</p> <p>\u540c\u65f6\uff0cElastic Load Balancer\uff08ELB\uff09\u4f1a\u5747\u5300\u5730\u5206\u914d\u6d41\u91cf\u5230\u5065\u5eb7\u7684 EC2 \u5b9e\u4f8b\u4e0a\uff0c\u4fdd\u8bc1\u5373\u4f7f\u67d0\u4e2a\u5b9e\u4f8b\u6545\u969c\uff0c\u4e5f\u80fd\u7ee7\u7eed\u4fdd\u6301\u5e94\u7528\u7684\u9ad8\u53ef\u7528\u6027</p>"},{"location":"2025/5aws/#8-aws-aws","title":"8. \u4ec0\u4e48\u662f AWS \u5b9a\u4ef7\u6a21\u578b\uff1f\u5982\u4f55\u4f18\u5316 AWS \u6210\u672c","text":"<p>AWS \u63d0\u4f9b\u51e0\u79cd\u5b9a\u4ef7\u6a21\u578b\uff1a</p> <ul> <li>\u6309\u9700\u5b9a\u4ef7\uff08On-Demand\uff09\uff1a \u6839\u636e\u5b9e\u9645\u4f7f\u7528\u7684\u8ba1\u7b97\u80fd\u529b\u6309\u5c0f\u65f6\u6216\u79d2\u8ba1\u8d39\u3002</li> <li>\u9884\u7559\u5b9e\u4f8b\uff08Reserved Instances\uff09\uff1a \u4e3a\u957f\u671f\u4f7f\u7528\u7684\u5b9e\u4f8b\u9884\u5148\u652f\u4ed8\uff0c\u4eab\u53d7\u6298\u6263\u3002</li> <li>\u73b0\u8d27\u5b9e\u4f8b\uff08Spot Instances\uff09\uff1a \u57fa\u4e8e\u7a7a\u95f2\u8ba1\u7b97\u80fd\u529b\uff0c\u4ee5\u8f83\u4f4e\u7684\u4ef7\u683c\u7ade\u62cd\u5b9e\u4f8b\uff0c\u4f46\u53ef\u80fd\u4f1a\u88ab\u4e2d\u65ad\u3002</li> <li>\u6309\u91cf\u8ba1\u8d39\uff08Pay-As-You-Go\uff09\uff1a \u6839\u636e\u4f7f\u7528\u7684\u5b58\u50a8\u3001\u6d41\u91cf\u7b49\u8d44\u6e90\u6309\u91cf\u6536\u8d39\u3002</li> </ul> <p>\u4e3a\u4e86\u4f18\u5316\u6210\u672c\uff0c\u53ef\u4ee5\u9009\u62e9\u5408\u9002\u7684\u5b9a\u4ef7\u6a21\u578b\uff0c\u4f8b\u5982\u4f7f\u7528\u73b0\u8d27\u5b9e\u4f8b\u6765\u5904\u7406\u975e\u5173\u952e\u4efb\u52a1\uff0c\u9884\u7559\u5b9e\u4f8b\u6765\u5904\u7406\u957f\u671f\u8d1f\u8f7d\uff0c\u5e76\u5229\u7528 AWS Trusted Advisor \u548c Cost Explorer \u5206\u6790\u548c\u4f18\u5316\u8d44\u6e90\u4f7f\u7528\u3002</p>"},{"location":"2025/5aws/#9-aws-cost-explorer","title":"9. \u4f60\u5982\u4f55\u4f7f\u7528 AWS Cost Explorer \u6765\u76d1\u63a7\u548c\u7ba1\u7406\u6210\u672c\uff1f","text":"<p>AWS Cost Explorer \u5141\u8bb8\u4f60\u67e5\u770b\u548c\u5206\u6790 AWS \u670d\u52a1\u7684\u8d39\u7528\u6570\u636e\u3002</p> <p>\u4f60\u53ef\u4ee5\u67e5\u770b\u4e0d\u540c\u670d\u52a1\u7684\u8d39\u7528\u62a5\u544a\u3001\u6309\u670d\u52a1\u5206\u7ec4\u3001\u6309\u65f6\u95f4\u533a\u95f4\u8fdb\u884c\u6bd4\u8f83\uff0c\u751a\u81f3\u8bbe\u7f6e\u9884\u7b97\u8b66\u62a5\uff0c\u63d0\u9192\u4f60\u8d39\u7528\u8d85\u51fa\u9884\u671f\u3002\u901a\u8fc7\u5b9a\u671f\u68c0\u67e5\u548c\u5206\u6790\u4f7f\u7528\u60c5\u51b5\uff0c\u53ef\u4ee5\u8bc6\u522b\u4e0d\u5fc5\u8981\u7684\u8d44\u6e90\uff0c\u53ca\u65f6\u8c03\u6574\u67b6\u6784\uff0c\u4ee5\u964d\u4f4e\u6210\u672c\u3002</p> <p>AWS Cost Explorer \u5141\u8bb8\u4f60\u67e5\u770b\u548c\u5206\u6790 AWS \u670d\u52a1\u7684\u8d39\u7528\u6570\u636e\u3002\u4f60\u53ef\u4ee5\u67e5\u770b\u4e0d\u540c\u670d\u52a1\u7684\u8d39\u7528\u62a5\u544a\u3001\u6309\u670d\u52a1\u5206\u7ec4\u3001\u6309\u65f6\u95f4\u533a\u95f4\u8fdb\u884c\u6bd4\u8f83\uff0c\u751a\u81f3\u8bbe\u7f6e\u9884\u7b97\u8b66\u62a5\uff0c\u63d0\u9192\u4f60\u8d39\u7528\u8d85\u51fa\u9884\u671f\u3002\u901a\u8fc7\u5b9a\u671f\u68c0\u67e5\u548c\u5206\u6790\u4f7f\u7528\u60c5\u51b5\uff0c\u53ef\u4ee5\u8bc6\u522b\u4e0d\u5fc5\u8981\u7684\u8d44\u6e90\uff0c\u53ca\u65f6\u8c03\u6574\u67b6\u6784\uff0c\u4ee5\u964d\u4f4e\u6210\u672c\u3002</p>"},{"location":"2025/5aws/#10-ec2","title":"10. \u95ee\u9898\uff1a\u5982\u4f55\u6392\u67e5 EC2 \u5b9e\u4f8b\u542f\u52a8\u5931\u8d25\u7684\u95ee\u9898\uff1f","text":"<p>\u9996\u5148\uff0c\u68c0\u67e5\u5b9e\u4f8b\u7684 \u7cfb\u7edf\u65e5\u5fd7\uff0c\u67e5\u770b\u662f\u5426\u6709\u542f\u52a8\u8fc7\u7a0b\u4e2d\u7684\u9519\u8bef\u4fe1\u606f\u3002</p> <p>\u5176\u6b21\uff0c\u786e\u4fdd\u5b9e\u4f8b\u7684 \u5b89\u5168\u7ec4 \u548c \u7f51\u7edc ACLs \u914d\u7f6e\u6b63\u786e\uff0c\u786e\u4fdd\u5141\u8bb8\u6b63\u786e\u7684\u5165\u7ad9\u548c\u51fa\u7ad9\u6d41\u91cf\u3002</p> <p>\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7 AWS EC2 Instance Status Checks \u6765\u67e5\u770b\u5b9e\u4f8b\u7684\u5065\u5eb7\u72b6\u51b5\u3002\u5982\u679c\u5b9e\u4f8b\u7684\u542f\u52a8\u5931\u8d25\u662f\u56e0\u4e3a\u67d0\u4e9b\u542f\u52a8\u811a\u672c\u9519\u8bef\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 EC2 User Data \u8fdb\u884c\u8c03\u8bd5\u3002</p>"},{"location":"2025/5aws/#11-aws","title":"11. \u5982\u679c\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u5728 AWS \u4e0a\u53d8\u5f97\u975e\u5e38\u6162\uff0c\u4f60\u4f1a\u5982\u4f55\u8fdb\u884c\u6027\u80fd\u8c03\u4f18","text":"<p>\u9996\u5148\uff0c\u901a\u8fc7 CloudWatch \u76d1\u63a7\u5e94\u7528\u7a0b\u5e8f\u7684 CPU \u4f7f\u7528\u7387\u3001\u5185\u5b58\u3001\u7f51\u7edc\u6d41\u91cf\u7b49\u6027\u80fd\u6307\u6807\uff0c\u627e\u51fa\u74f6\u9888\u6240\u5728\u3002</p> <p>\u5982\u679c\u662f\u8ba1\u7b97\u8d44\u6e90\u9650\u5236\uff0c\u53ef\u4ee5\u8003\u8651\u589e\u52a0 EC2 \u5b9e\u4f8b\u7684\u89c4\u683c\u6216\u4f7f\u7528 Auto Scaling \u6765\u52a8\u6001\u6269\u5c55\u5b9e\u4f8b\u3002</p> <p>\u5982\u679c\u662f\u6570\u636e\u5e93\u95ee\u9898\uff0c\u53ef\u4ee5\u8003\u8651\u4f18\u5316 RDS \u67e5\u8be2\uff0c\u4f7f\u7528\u7f13\u5b58\u673a\u5236\uff08\u5982 ElastiCache\uff09\u6765\u51cf\u5c11\u6570\u636e\u5e93\u7684\u8d1f\u62c5\u3002\u6b64\u5916\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528 CloudFront \u52a0\u901f\u5185\u5bb9\u5206\u53d1\uff0c\u63d0\u5347\u7528\u6237\u4f53\u9a8c\u3002</p>"},{"location":"2025/5aws/#12-aws","title":"12. \u5982\u4f55\u5b9e\u73b0\u8de8\u591a\u4e2a AWS \u533a\u57df\u7684\u6570\u636e\u540c\u6b65\uff1f","text":"<p>\u53ef\u4ee5\u4f7f\u7528 Amazon S3 Cross-Region Replication (CRR) \u5b9e\u73b0\u8de8\u533a\u57df\u7684\u6570\u636e\u540c\u6b65\u3002CRR \u5141\u8bb8\u4f60\u81ea\u52a8\u5c06\u4e00\u4e2a\u533a\u57df\u7684 S3 \u5b58\u50a8\u6876\u4e2d\u7684\u6570\u636e\u590d\u5236\u5230\u53e6\u4e00\u4e2a\u533a\u57df\u3002</p> <p>\u5bf9\u4e8e RDS \u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528 Read Replicas \u6216 Cross-Region Replication \u6765\u540c\u6b65\u6570\u636e\u3002</p> <p>\u5bf9\u4e8e DynamoDB\uff0c\u53ef\u4ee5\u901a\u8fc7\u542f\u7528 DynamoDB Global Tables \u6765\u5b9e\u73b0\u591a\u533a\u57df\u6570\u636e\u590d\u5236</p>"},{"location":"2025/5aws/#13-aws","title":"13. \u4f60\u5982\u4f55\u786e\u4fdd AWS \u4e0a\u7684\u9ad8\u53ef\u7528\u6027\uff1f","text":"<p>\u8981\u786e\u4fdd\u9ad8\u53ef\u7528\u6027\uff0c\u53ef\u4ee5\u91c7\u53d6\u4ee5\u4e0b\u63aa\u65bd\uff1a</p> <ul> <li>\u5c06\u5e94\u7528\u90e8\u7f72\u5728\u591a\u4e2a Availability Zones \u4e2d\uff0c\u8fd9\u6837\u5373\u4f7f\u67d0\u4e2a\u533a\u57df\u53d1\u751f\u6545\u969c\uff0c\u5176\u4ed6\u533a\u57df\u7684\u670d\u52a1\u4ecd\u7136\u53ef\u7528\u3002</li> <li>\u4f7f\u7528 Elastic Load Balancer (ELB) \u5728\u591a\u4e2a EC2 \u5b9e\u4f8b\u95f4\u5747\u8861\u8d1f\u8f7d\uff0c\u786e\u4fdd\u6d41\u91cf\u5206\u914d\u5230\u5065\u5eb7\u5b9e\u4f8b\u3002</li> <li>\u914d\u7f6e Auto Scaling \u6765\u81ea\u52a8\u589e\u52a0\u6216\u51cf\u5c11 EC2 \u5b9e\u4f8b\u7684\u6570\u91cf\uff0c\u4ee5\u5e94\u5bf9\u6d41\u91cf\u7684\u53d8\u5316\u3002</li> <li>\u5bf9\u6570\u636e\u5e93\u4f7f\u7528 Multi-AZ RDS \u6216 Aurora \u4ee5\u786e\u4fdd\u6570\u636e\u5e93\u7684\u9ad8\u53ef\u7528\u6027\u548c\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u3002</li> <li>\u4f7f\u7528 Route 53 \u548c\u5065\u5eb7\u68c0\u67e5\u6765\u5b9e\u73b0\u667a\u80fd DNS \u8def\u7531\uff0c\u786e\u4fdd\u6d41\u91cf\u80fd\u591f\u6b63\u786e\u5730\u8def\u7531\u5230\u5065\u5eb7\u7684\u8d44\u6e90</li> </ul>"},{"location":"2025/5aws/#14-auto-scaling-load-balancer","title":"14. \u4f60\u5982\u4f55\u4f7f\u7528 Auto Scaling \u548c Load Balancer \u6765\u4fdd\u8bc1\u5e94\u7528\u7684\u53ef\u4f38\u7f29\u6027\u548c\u9ad8\u53ef\u7528\u6027\uff1f","text":"<p>\u901a\u8fc7 Auto Scaling\uff0c\u53ef\u4ee5\u6839\u636e\u8bbe\u5b9a\u7684\u6307\u6807\uff08\u5982 CPU \u4f7f\u7528\u7387\u3001\u5185\u5b58\u3001\u7f51\u7edc\u6d41\u91cf\u7b49\uff09\u81ea\u52a8\u8c03\u6574 EC2 \u5b9e\u4f8b\u7684\u6570\u91cf\uff0c\u786e\u4fdd\u5728\u6d41\u91cf\u9ad8\u5cf0\u65f6\u523b\u5e94\u7528\u80fd\u591f\u81ea\u52a8\u6269\u5c55\uff0c\u6d41\u91cf\u8f83\u4f4e\u65f6\u523b\u5219\u51cf\u5c11\u5b9e\u4f8b\u6570\u4ee5\u8282\u7701\u6210\u672c\u3002</p> <p>\u540c\u65f6\uff0cElastic Load Balancer\uff08ELB\uff09 \u4f1a\u5747\u5300\u5730\u5206\u914d\u6d41\u91cf\u5230\u5065\u5eb7\u7684 EC2 \u5b9e\u4f8b\u4e0a\uff0c\u4fdd\u8bc1\u5373\u4f7f\u67d0\u4e2a\u5b9e\u4f8b\u6545\u969c\uff0c\u4e5f\u80fd\u7ee7\u7eed\u4fdd\u6301\u5e94\u7528\u7684\u9ad8\u53ef\u7528\u6027</p>"},{"location":"2025/5aws/#15-aws","title":"15. AWS \u4e0a\u5982\u4f55\u5b9e\u73b0\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff1f","text":"<p>AWS \u63d0\u4f9b\u4e86 Amazon EFS (Elastic File System)\uff0c\u5b83\u662f\u4e00\u4e2a\u53ef\u6269\u5c55\u7684\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff0c\u9002\u7528\u4e8e\u5171\u4eab\u6587\u4ef6\u5b58\u50a8\uff0c\u53ef\u4ee5\u8de8\u591a\u4e2a EC2 \u5b9e\u4f8b\u8fdb\u884c\u8bbf\u95ee\u3002</p> <p>\u5b83\u652f\u6301 NFS \u534f\u8bae\uff0c\u9002\u7528\u4e8e\u5927\u591a\u6570 Linux \u670d\u52a1\u5668\u5e94\u7528\u3002\u540c\u65f6\uff0cAmazon FSx \u63d0\u4f9b\u4e86 Windows \u6587\u4ef6\u670d\u52a1\u5668\u7684\u652f\u6301\uff0c\u9002\u5408 Windows \u73af\u5883\u4e2d\u7684\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf</p>"},{"location":"2025/5aws/#16-aws","title":"16. \u5982\u4f55\u4f7f\u7528 AWS \u63d0\u4f9b\u7684\u6570\u636e\u5e93\u670d\u52a1\u5904\u7406\u9ad8\u5e76\u53d1\u573a\u666f\uff1f","text":"<ul> <li>Amazon RDS\uff08Relational Database Service\uff09\uff1a \u5bf9\u4e8e\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u9009\u62e9 Multi-AZ \u90e8\u7f72\uff0c\u8fd9\u6837\u53ef\u4ee5\u5728\u4e3b\u6570\u636e\u5e93\u5b9e\u4f8b\u53d1\u751f\u6545\u969c\u65f6\u81ea\u52a8\u5207\u6362\u5230\u5907\u4efd\u5b9e\u4f8b\uff0c\u4fdd\u8bc1\u9ad8\u53ef\u7528\u6027\u3002\u540c\u65f6\uff0c\u4f7f\u7528 Read Replicas \u6765\u5206\u62c5\u8bfb\u53d6\u8d1f\u8f7d\uff0c\u63d0\u9ad8\u8bfb\u6027\u80fd\u3002</li> <li>Amazon DynamoDB\uff1a \u5bf9\u4e8e\u9ad8\u541e\u5410\u91cf\u8981\u6c42\u7684 NoSQL \u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528 DynamoDB\uff0c\u5b83\u662f\u4e00\u4e2a\u5b8c\u5168\u6258\u7ba1\u7684\u3001\u65e0\u670d\u52a1\u5668\u7684\u6570\u636e\u5e93\uff0c\u80fd\u591f\u81ea\u52a8\u6269\u5c55\u4ee5\u5e94\u5bf9\u9ad8\u5e76\u53d1\u6d41\u91cf\u3002</li> <li>Amazon Aurora\uff1a Aurora \u662f\u517c\u5bb9 MySQL \u548c PostgreSQL \u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u5b83\u63d0\u4f9b\u9ad8\u6027\u80fd\uff0c\u5e76\u80fd\u81ea\u52a8\u6269\u5c55\uff0c\u9002\u5408\u5927\u89c4\u6a21\u3001\u9ad8\u5e76\u53d1\u7684\u5e94\u7528\u573a\u666f\u3002</li> </ul>"},{"location":"2025/5aws/#17-aws","title":"17.\u5982\u4f55\u4f7f\u7528 AWS \u5b9e\u73b0\u5e94\u7528\u7a0b\u5e8f\u7684\u65e5\u5fd7\u8bb0\u5f55\u548c\u76d1\u63a7\uff1f","text":"<p>AWS \u63d0\u4f9b\u4e86\u591a\u4e2a\u670d\u52a1\u6765\u5b9e\u73b0\u65e5\u5fd7\u8bb0\u5f55\u548c\u76d1\u63a7\uff1a</p> <ul> <li>Amazon CloudWatch\uff1a \u7528\u4e8e\u76d1\u63a7 AWS \u8d44\u6e90\u548c\u5e94\u7528\u7a0b\u5e8f\u7684\u6027\u80fd\u3002\u4f60\u53ef\u4ee5\u521b\u5efa\u81ea\u5b9a\u4e49\u6307\u6807\uff0c\u8bbe\u7f6e\u9608\u503c\uff0c\u5e76\u901a\u8fc7 CloudWatch Alarm \u53d1\u9001\u8b66\u62a5\u3002</li> <li>AWS CloudTrail\uff1a \u7528\u4e8e\u8bb0\u5f55 AWS \u8d26\u6237\u7684 API \u8c03\u7528\uff0c\u5e2e\u52a9\u4f60\u76d1\u63a7\u548c\u5ba1\u8ba1\u6240\u6709\u7528\u6237\u64cd\u4f5c\u548c AWS \u670d\u52a1\u7684\u53d8\u5316\u3002</li> <li>Amazon CloudWatch Logs\uff1a \u7528\u4e8e\u6536\u96c6\u548c\u5b58\u50a8\u65e5\u5fd7\u6587\u4ef6\u3002<ul> <li>\u4f60\u53ef\u4ee5\u5c06\u5e94\u7528\u7a0b\u5e8f\u7684\u65e5\u5fd7\u53d1\u9001\u5230 CloudWatch Logs \u8fdb\u884c\u5b58\u50a8\uff0c\u5e76\u4f7f\u7528\u5b83\u8fdb\u884c\u6545\u969c\u6392\u67e5\u548c\u5206\u6790\u3002</li> </ul> </li> <li>AWS X-Ray\uff1a \u7528\u4e8e\u5206\u6790\u548c\u8c03\u8bd5\u5206\u5e03\u5f0f\u5e94\u7528\uff0c\u5e2e\u52a9\u8bc6\u522b\u6027\u80fd\u74f6\u9888\u548c\u9519\u8bef\u3002</li> </ul>"},{"location":"2025/5aws/#18-aws","title":"18. \u5982\u4f55\u5728 AWS \u4e0a\u8fdb\u884c\u81ea\u52a8\u5316\u8fd0\u7ef4\u548c\u914d\u7f6e\u7ba1\u7406\uff1f","text":"<ul> <li>AWS Systems Manager\uff1a AWS Systems Manager \u63d0\u4f9b\u4e86\u96c6\u4e2d\u7ba1\u7406\u548c\u81ea\u52a8\u5316\u7684\u80fd\u529b\uff0c\u53ef\u4ee5\u7528\u4e8e\u7ba1\u7406 EC2 \u5b9e\u4f8b\u3001\u81ea\u52a8\u5316\u8865\u4e01\u7ba1\u7406\u3001\u8f6f\u4ef6\u914d\u7f6e\u7b49\u3002</li> <li>AWS CloudFormation\uff1a \u7528\u4e8e\u901a\u8fc7\u58f0\u660e\u5f0f\u6a21\u677f\u81ea\u52a8\u5316\u8d44\u6e90\u7684\u90e8\u7f72\u548c\u7ba1\u7406\uff0c\u652f\u6301\u57fa\u7840\u8bbe\u65bd\u5373\u4ee3\u7801\uff08IaC\uff09\u3002</li> <li>AWS OpsWorks\uff1a \u57fa\u4e8e Chef \u548c Puppet\uff0c\u63d0\u4f9b\u4e86\u914d\u7f6e\u7ba1\u7406\u670d\u52a1\uff0c\u53ef\u4ee5\u7528\u4e8e\u81ea\u52a8\u5316\u7ba1\u7406\u670d\u52a1\u5668\u548c\u5e94\u7528\u7a0b\u5e8f\u7684\u914d\u7f6e\u3002</li> <li>AWS Lambda\uff1a \u53ef\u7528\u4e8e\u81ea\u52a8\u5316\u65e0\u670d\u52a1\u5668\u67b6\u6784\u4e2d\u7684\u4efb\u52a1\uff0c\u4f8b\u5982\u81ea\u52a8\u5316\u7684\u8d44\u6e90\u542f\u52a8\u3001\u505c\u6b62\u7b49\u64cd\u4f5c\u3002</li> </ul>"},{"location":"2025/5aws/#19-aws","title":"19.\u5982\u4f55\u4f18\u5316 AWS \u6210\u672c\uff1f","text":"<ul> <li>\u9009\u62e9\u5408\u9002\u7684\u5b9e\u4f8b\u7c7b\u578b\uff1a \u4f7f\u7528\u9002\u5408\u5de5\u4f5c\u8d1f\u8f7d\u7684 EC2 \u5b9e\u4f8b\u7c7b\u578b\uff0c\u4f8b\u5982\u8ba1\u7b97\u4f18\u5316\u3001\u5185\u5b58\u4f18\u5316\u6216\u5b58\u50a8\u4f18\u5316\u5b9e\u4f8b\u3002\u53ef\u4ee5\u4f7f\u7528 AWS Compute Optimizer \u6765\u63a8\u8350\u6700\u9002\u5408\u7684\u5b9e\u4f8b\u7c7b\u578b\u3002</li> <li>\u4f7f\u7528\u9884\u7559\u5b9e\u4f8b\uff08Reserved Instances\uff09\uff1a \u5bf9\u4e8e\u957f\u671f\u7a33\u5b9a\u7684\u8d1f\u8f7d\uff0c\u53ef\u4ee5\u9009\u62e9\u9884\u7559\u5b9e\u4f8b\uff0c\u4eab\u53d7\u6298\u6263\u3002</li> <li>\u4f7f\u7528\u73b0\u8d27\u5b9e\u4f8b\uff08Spot Instances\uff09\uff1a \u5bf9\u4e8e\u5f39\u6027\u5f3a\u3001\u4e0d\u9700\u8981 24/7 \u8fd0\u884c\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u53ef\u4ee5\u4f7f\u7528\u73b0\u8d27\u5b9e\u4f8b\u6765\u5927\u5e45\u964d\u4f4e\u8ba1\u7b97\u6210\u672c\u3002</li> <li>\u5229\u7528 Auto Scaling\uff1a \u6839\u636e\u5b9e\u9645\u6d41\u91cf\u81ea\u52a8\u8c03\u6574 EC2 \u5b9e\u4f8b\u7684\u6570\u91cf\uff0c\u907f\u514d\u8d44\u6e90\u6d6a\u8d39\u3002</li> <li>\u5220\u9664\u672a\u4f7f\u7528\u7684\u8d44\u6e90\uff1a \u5b9a\u671f\u5ba1\u67e5 AWS \u73af\u5883\uff0c\u5220\u9664\u672a\u4f7f\u7528\u7684 EBS \u5377\u3001\u672a\u5173\u8054\u7684 Elastic IP \u7b49\u8d44\u6e90\u3002</li> <li>\u4f7f\u7528 AWS Trusted Advisor\uff1a \u5b83\u63d0\u4f9b\u4e86\u9488\u5bf9\u6210\u672c\u3001\u6027\u80fd\u3001\u5b89\u5168\u6027\u7b49\u65b9\u9762\u7684\u4f18\u5316\u5efa\u8bae\u3002</li> </ul>"},{"location":"2025/5aws/#20-aws","title":"20. \u4f60\u5982\u4f55\u5728 AWS \u4e2d\u5b9e\u73b0\u707e\u96be\u6062\u590d\uff1f","text":"<p>\u5728 AWS \u4e2d\uff0c\u53ef\u4ee5\u91c7\u7528\u4ee5\u4e0b\u7b56\u7565\u6765\u5b9e\u73b0\u707e\u96be\u6062\u590d\uff1a</p> <ul> <li>\u591a\u533a\u57df\u90e8\u7f72\uff1a \u5c06\u5e94\u7528\u548c\u6570\u636e\u8de8\u591a\u4e2a AWS \u533a\u57df\u90e8\u7f72\uff0c\u786e\u4fdd\u5373\u4f7f\u67d0\u4e2a\u533a\u57df\u53d1\u751f\u6545\u969c\uff0c\u5176\u4ed6\u533a\u57df\u4ecd\u7136\u53ef\u7528\u3002</li> <li>\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\uff1a \u4f7f\u7528 Amazon Route 53 \u914d\u5408\u5065\u5eb7\u68c0\u67e5\uff0c\u81ea\u52a8\u5c06\u6d41\u91cf\u5207\u6362\u5230\u5065\u5eb7\u7684\u533a\u57df\u6216\u5b9e\u4f8b\u3002</li> <li>\u8de8\u533a\u57df\u5907\u4efd\uff1a \u4f7f\u7528 Amazon S3 \u8de8\u533a\u57df\u590d\u5236\u529f\u80fd\uff0c\u786e\u4fdd\u6570\u636e\u7684\u5b89\u5168\u6027\u3002\u5bf9\u4e8e\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528 RDS Cross-Region Replication \u6765\u5b9e\u73b0\u5907\u4efd\u548c\u6545\u969c\u8f6c\u79fb\u3002</li> <li>\u5b9a\u671f\u5907\u4efd\uff1a \u4f7f\u7528 AWS Backup \u81ea\u52a8\u6267\u884c Amazon EBS\u3001RDS\u3001DynamoDB\u3001EFS \u7b49\u8d44\u6e90\u7684\u5b9a\u671f\u5907\u4efd</li> </ul>"},{"location":"2025/5aws/#21-aws-cloudwatch","title":"21. \u4ec0\u4e48\u662f AWS CloudWatch\uff1f","text":"<p>AWS CloudWatch \u662f\u4e00\u79cd\u76d1\u63a7\u548c\u65e5\u5fd7\u8bb0\u5f55\u670d\u52a1\uff0c\u53ef\u4ee5\u63d0\u4f9b AWS \u8d44\u6e90\u548c\u5e94\u7528\u7a0b\u5e8f\u7684\u5b9e\u65f6\u6307\u6807\u3001\u65e5\u5fd7\u548c\u62a5\u8b66\u529f\u80fd\u3002</p> <ul> <li>\u76d1\u63a7\u6307\u6807\uff1a CloudWatch \u53ef\u7528\u4e8e\u76d1\u63a7 EC2\u3001RDS\u3001Lambda\u3001S3\u3001EBS \u7b49 AWS \u8d44\u6e90\u7684\u6027\u80fd\u3002</li> <li>\u65e5\u5fd7\u6536\u96c6\uff1a \u901a\u8fc7 CloudWatch Logs \u6536\u96c6\u5e76\u5206\u6790\u6765\u81ea\u5e94\u7528\u7a0b\u5e8f\u3001\u64cd\u4f5c\u7cfb\u7edf\u548c\u5176\u4ed6\u8d44\u6e90\u7684\u65e5\u5fd7\u3002</li> <li>\u62a5\u8b66\u8bbe\u7f6e\uff1a \u53ef\u4ee5\u8bbe\u7f6e\u9608\u503c\u62a5\u8b66\uff0c\u5f53\u67d0\u4e9b\u6307\u6807\u8d85\u8fc7\u8bbe\u5b9a\u503c\u65f6\u89e6\u53d1\u62a5\u8b66\u3002</li> <li>\u81ea\u52a8\u5316\u54cd\u5e94\uff1a \u57fa\u4e8e CloudWatch \u7684\u76d1\u63a7\u548c\u62a5\u8b66\uff0c\u53ef\u4ee5\u81ea\u52a8\u89e6\u53d1 AWS Lambda \u51fd\u6570\u6216 Auto Scaling \u64cd\u4f5c\u3002</li> </ul>"},{"location":"2025/5aws/#22-aws","title":"22. \u5982\u4f55\u9009\u62e9\u5408\u9002\u7684 AWS \u5b58\u50a8\u670d\u52a1\uff1f","text":"<p>AWS \u63d0\u4f9b\u591a\u79cd\u5b58\u50a8\u670d\u52a1\uff0c\u9002\u7528\u4e8e\u4e0d\u540c\u7684\u7528\u4f8b\u3002\u9009\u62e9\u5408\u9002\u7684\u5b58\u50a8\u670d\u52a1\u65f6\u9700\u8981\u8003\u8651\u4ee5\u4e0b\u56e0\u7d20\uff1a</p> <ul> <li>Amazon S3\uff1a \u9002\u7528\u4e8e\u5b58\u50a8\u9759\u6001\u6587\u4ef6\u3001\u5907\u4efd\u548c\u5f52\u6863\u3002</li> <li>EBS\uff1a \u9002\u7528\u4e8e\u9700\u8981\u6301\u4e45\u5b58\u50a8\u7684 EC2 \u5b9e\u4f8b\u3002</li> <li>EFS\uff1a \u9002\u7528\u4e8e\u9700\u8981\u5171\u4eab\u6587\u4ef6\u5b58\u50a8\u7684\u5e94\u7528\uff0c\u652f\u6301\u591a\u4e2a\u5b9e\u4f8b\u5e76\u53d1\u8bbf\u95ee\u3002</li> <li>Glacier\uff1a \u9002\u7528\u4e8e\u957f\u671f\u5b58\u50a8\u548c\u5f52\u6863\u6570\u636e\u3002</li> <li>DynamoDB\uff1a \u9002\u7528\u4e8e\u4f4e\u5ef6\u8fdf\u3001\u9ad8\u541e\u5410\u91cf\u7684 NoSQL \u6570\u636e\u5b58\u50a8\u3002</li> <li>RDS\uff1a \u9002\u7528\u4e8e\u6258\u7ba1\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u652f\u6301\u81ea\u52a8\u5907\u4efd\u548c\u9ad8\u53ef\u7528\u6027\u914d\u7f6e\u3002</li> </ul> <p>\u6839\u636e\u6570\u636e\u8bbf\u95ee\u9891\u7387\u3001\u6570\u636e\u7c7b\u578b\u548c\u6210\u672c\u8981\u6c42\u9009\u62e9\u5408\u9002\u7684\u5b58\u50a8\u89e3\u51b3\u65b9\u6848\u3002</p>"},{"location":"2025/5aws/#23-aws-iamidentity-and-access-management","title":"23. \u89e3\u91ca AWS IAM\uff08Identity and Access Management\uff09\u53ca\u5176\u7ec4\u4ef6","text":"<p>AWS IAM \u662f\u4e00\u79cd Web \u670d\u52a1\uff0c\u5b83\u5e2e\u52a9\u60a8\u7ba1\u7406\u5bf9 AWS \u670d\u52a1\u548c\u8d44\u6e90\u7684\u8bbf\u95ee\u6743\u9650\u3002\u5b83\u5305\u62ec\u4ee5\u4e0b\u5173\u952e\u7ec4\u4ef6\uff1a</p> <ul> <li>\u7528\u6237\uff08User\uff09\uff1a \u4ee3\u8868\u4e00\u4e2a AWS \u8d26\u6237\u4e2d\u7684\u4e2a\u4eba\u7528\u6237\uff0c\u53ef\u4ee5\u4e3a\u5176\u5206\u914d\u8bbf\u95ee\u6743\u9650\u3002</li> <li>\u7ec4\uff08Group\uff09\uff1a \u5c06\u591a\u4e2a\u7528\u6237\u8fdb\u884c\u5206\u7ec4\uff0c\u7b80\u5316\u6743\u9650\u7ba1\u7406\u3002\u7528\u6237\u7ec4\u4e0e\u6743\u9650\u7b56\u7565\u7ed3\u5408\u4f7f\u7528\u3002</li> <li>\u89d2\u8272\uff08Role\uff09\uff1a \u89d2\u8272\u4e0e\u7528\u6237\u4e0d\u540c\uff0c\u89d2\u8272\u4e0d\u76f4\u63a5\u5173\u8054\u5230\u5355\u4e2a\u7528\u6237\uff0c\u800c\u662f\u4f9b AWS \u670d\u52a1\u6216\u5176\u4ed6\u8d26\u6237\u7684\u8eab\u4efd\u4e34\u65f6\u4f7f\u7528\u3002</li> <li>\u6743\u9650\u7b56\u7565\uff08Policy\uff09\uff1a \u6743\u9650\u7b56\u7565\u662f \u00b7 \u683c\u5f0f\u7684\u6587\u6863\uff0c\u5b9a\u4e49\u4e86\u54ea\u4e9b\u8d44\u6e90\u53ef\u4ee5\u88ab\u54ea\u4e9b\u4e3b\u4f53\u8bbf\u95ee\u3002</li> <li>\u591a\u56e0\u7d20\u8ba4\u8bc1\uff08MFA\uff09\uff1a \u4e00\u79cd\u5b89\u5168\u673a\u5236\uff0c\u9700\u8981\u7528\u6237\u63d0\u4f9b\u4e24\u79cd\u8eab\u4efd\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u589e\u52a0\u8bbf\u95ee AWS \u8d44\u6e90\u7684\u5b89\u5168\u6027\u3002</li> </ul>"},{"location":"2025/5aws/#24-s3","title":"24. S3 \u7684\u5b58\u50a8\u7c7b\u6709\u54ea\u4e9b\uff1f\u5982\u4f55\u9009\u62e9\u5408\u9002\u7684\u5b58\u50a8\u7c7b\uff1f","text":"<p>Amazon S3 \u63d0\u4f9b\u591a\u79cd\u5b58\u50a8\u7c7b\uff0c\u7528\u4e8e\u4f18\u5316\u6210\u672c\u548c\u8bbf\u95ee\u9700\u6c42\uff1a</p> <ul> <li>\u6807\u51c6\u5b58\u50a8\uff08Standard\uff09\uff1a \u9002\u7528\u4e8e\u9891\u7e41\u8bbf\u95ee\u7684\u5bf9\u8c61\uff0c\u5177\u6709\u4f4e\u5ef6\u8fdf\u548c\u9ad8\u541e\u5410\u91cf\u3002</li> <li>\u6807\u51c6-\u4f4e\u9891\u5b58\u50a8\uff08Standard-IA\uff09\uff1a \u9002\u7528\u4e8e\u4e0d\u5e38\u8bbf\u95ee\u7684\u5bf9\u8c61\uff0c\u4f46\u9700\u8981\u9ad8\u53ef\u7528\u6027\u3002\u8f83\u4fbf\u5b9c\uff0c\u4f46\u6570\u636e\u68c0\u7d22\u8d39\u7528\u8f83\u9ad8\u3002</li> <li>\u4e00\u65f6\u8bbf\u95ee\uff08One Zone-IA\uff09\uff1a \u9002\u7528\u4e8e\u4e0d\u5e38\u8bbf\u95ee\u7684\u6570\u636e\uff0c\u4f46\u53ef\u4ee5\u5bb9\u5fcd\u4e22\u5931\u7684\u60c5\u51b5\u3002\u5b58\u50a8\u5728\u5355\u4e2a\u53ef\u7528\u533a\uff0c\u6210\u672c\u66f4\u4f4e\u3002</li> <li>\u5f52\u6863\u5b58\u50a8\uff08Glacier\uff09\uff1a \u9002\u7528\u4e8e\u9700\u8981\u957f\u671f\u5b58\u50a8\u4e14\u8bbf\u95ee\u9891\u7387\u6781\u4f4e\u7684\u5bf9\u8c61\uff0c\u68c0\u7d22\u6210\u672c\u8f83\u9ad8\uff0c\u68c0\u7d22\u65f6\u95f4\u8f83\u957f\u3002</li> <li>\u6df1\u5ea6\u5f52\u6863\u5b58\u50a8\uff08Glacier Deep Archive\uff09\uff1a \u6bd4 Glacier \u66f4\u4fbf\u5b9c\uff0c\u9002\u7528\u4e8e\u957f\u671f\u5f52\u6863\u6570\u636e\u3002</li> </ul> <p>\u9009\u62e9\u5b58\u50a8\u7c7b\u7684\u4f9d\u636e\u901a\u5e38\u662f\u8bbf\u95ee\u9891\u7387\u3001\u6570\u636e\u7684\u91cd\u8981\u6027\u4ee5\u53ca\u5b58\u50a8\u6210\u672c\u3002\u9ad8\u9891\u8bbf\u95ee\u7684\u6570\u636e\u9002\u5408\u4f7f\u7528\u6807\u51c6\u5b58\u50a8\uff0c\u800c\u4f4e\u9891\u8bbf\u95ee\u7684\u6570\u636e\u53ef\u4ee5\u4f7f\u7528\u6807\u51c6-\u4f4e\u9891\u5b58\u50a8\u6216\u5f52\u6863\u5b58\u50a8\u6765\u8282\u7701\u6210\u672c\u3002</p>"},{"location":"2025/5aws/#25-amazon-rds","title":"25. \u4ec0\u4e48\u662f Amazon RDS\uff1f\u5b83\u7684\u4f18\u52bf\u662f\u4ec0\u4e48\uff1f","text":"<p>Amazon RDS\uff08Relational Database Service\uff09\u662f AWS \u63d0\u4f9b\u7684\u6258\u7ba1\u5173\u7cfb\u6570\u636e\u5e93\u670d\u52a1\uff0c\u652f\u6301\u591a\u79cd\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5305\u62ec MySQL\u3001PostgreSQL\u3001SQL Server\u3001MariaDB \u548c Oracle\u3002</p> <p>\u4f18\u52bf</p> <ul> <li>\u6613\u4e8e\u4f7f\u7528\uff1a \u63d0\u4f9b\u6570\u636e\u5e93\u5b9e\u4f8b\u7684\u81ea\u52a8\u5316\u7ba1\u7406\uff0c\u60a8\u65e0\u9700\u5173\u5fc3\u5e95\u5c42\u786c\u4ef6\u548c\u6570\u636e\u5e93\u7ba1\u7406\u3002</li> <li>\u81ea\u52a8\u5316\u5907\u4efd\uff1a \u652f\u6301\u81ea\u52a8\u5907\u4efd\u548c\u5feb\u7167\uff0c\u786e\u4fdd\u6570\u636e\u5b89\u5168\u3002</li> <li>\u9ad8\u53ef\u7528\u6027\uff1a \u53ef\u4ee5\u914d\u7f6e\u591a\u53ef\u7528\u533a\u90e8\u7f72\uff08Multi-AZ\uff09\uff0c\u63d0\u4f9b\u6570\u636e\u5e93\u7684\u9ad8\u53ef\u7528\u6027\u548c\u707e\u96be\u6062\u590d\u3002</li> <li>\u81ea\u52a8\u6269\u5c55\uff1a \u53ef\u4ee5\u6839\u636e\u8d1f\u8f7d\u81ea\u52a8\u6269\u5c55\u5b58\u50a8\u548c\u8ba1\u7b97\u8d44\u6e90\u3002</li> <li>\u5b89\u5168\u6027\uff1a \u96c6\u6210 IAM\u3001VPC\u3001\u5b89\u5168\u7ec4\u3001\u52a0\u5bc6\u7b49\u591a\u79cd\u5b89\u5168\u529f\u80fd\u3002</li> <li>\u6027\u80fd\u4f18\u5316\uff1a \u652f\u6301\u591a\u79cd\u5b58\u50a8\u7c7b\u578b\uff0c\u5982\u901a\u7528 SSD\uff08gp2\uff09\u3001\u9884\u914d\u7f6e IOPS\uff08io1\uff09\uff0c\u5e76\u652f\u6301\u8bfb\u5199\u5206\u79bb</li> </ul>"},{"location":"2025/5aws/#26-aws-lambda","title":"26. \u4ec0\u4e48\u662f AWS Lambda\uff1f\u5b83\u7684\u4e3b\u8981\u7528\u9014\u662f\u4ec0\u4e48\uff1f","text":"<p>AWS Lambda \u662f AWS \u63d0\u4f9b\u7684\u65e0\u670d\u52a1\u5668\u8ba1\u7b97\u670d\u52a1\uff0c\u4f7f\u5f00\u53d1\u4eba\u5458\u80fd\u591f\u8fd0\u884c\u4ee3\u7801\u800c\u65e0\u9700\u7ba1\u7406\u670d\u52a1\u5668\u3002\u60a8\u53ea\u9700\u4e0a\u4f20\u4ee3\u7801\u5e76\u914d\u7f6e\u89e6\u53d1\u4e8b\u4ef6\uff0cLambda \u4f1a\u81ea\u52a8\u5904\u7406\u6240\u6709\u8d44\u6e90\u7684\u5206\u914d\u3001\u4f38\u7f29\u548c\u7ba1\u7406</p> <p>\u4e3b\u8981\u7528\u9014\uff1a</p> <ul> <li>\u4e8b\u4ef6\u9a71\u52a8\u7684\u8ba1\u7b97\uff1a AWS Lambda \u53ef\u4ee5\u4e0e\u5176\u4ed6 AWS \u670d\u52a1\uff08\u5982 S3\u3001DynamoDB\u3001SNS\u3001CloudWatch\uff09\u96c6\u6210\uff0c\u54cd\u5e94\u4e8b\u4ef6\u89e6\u53d1\u4ee3\u7801\u3002</li> <li>\u6309\u9700\u8ba1\u7b97\uff1a \u6839\u636e\u8bf7\u6c42\u6570\u548c\u6301\u7eed\u65f6\u95f4\u6309\u9700\u8ba1\u8d39\uff0c\u65e0\u9700\u9884\u5148\u914d\u7f6e\u6216\u7ba1\u7406\u670d\u52a1\u5668\u3002</li> <li>\u81ea\u52a8\u4f38\u7f29\uff1a Lambda \u81ea\u52a8\u6839\u636e\u8bf7\u6c42\u91cf\u4f38\u7f29\uff0c\u9002\u5408\u9ad8\u5e76\u53d1\u7684\u5e94\u7528\u3002</li> <li>\u7b80\u5316\u67b6\u6784\uff1a \u65e0\u9700\u5173\u5fc3\u5e95\u5c42\u57fa\u7840\u8bbe\u65bd\u7684\u7ba1\u7406\uff0c\u51cf\u5c11\u8fd0\u7ef4\u8d1f\u62c5</li> </ul> <p>Lambda \u9002\u7528\u4e8e\u8bf8\u5982\u6587\u4ef6\u5904\u7406\u3001\u6570\u636e\u5904\u7406\u3001\u5b9e\u65f6\u5206\u6790\u3001API \u540e\u7aef\u670d\u52a1\u7b49\u5e94\u7528\u573a\u666f\u3002</p>"},{"location":"2025/5aws/#27-auto-scaling","title":"27. \u4ec0\u4e48\u662f Auto Scaling\uff1f\u5b83\u5982\u4f55\u5de5\u4f5c\uff1f","text":"<p>Auto Scaling \u662f AWS \u63d0\u4f9b\u7684\u81ea\u52a8\u4f38\u7f29\u670d\u52a1\uff0c\u7528\u4e8e\u6839\u636e\u5e94\u7528\u9700\u6c42\u81ea\u52a8\u8c03\u6574\u8ba1\u7b97\u8d44\u6e90\u7684\u6570\u91cf\u3002</p> <p>\u5b83\u4e3b\u8981\u7528\u4e8e EC2 \u5b9e\u4f8b\u3001\u8d1f\u8f7d\u5747\u8861\u5668\u548c\u6570\u636e\u5e93\u7684\u81ea\u52a8\u6269\u5c55\u3002</p> <p>Auto Scaling \u662f AWS \u63d0\u4f9b\u7684\u81ea\u52a8\u4f38\u7f29\u670d\u52a1\uff0c\u7528\u4e8e\u6839\u636e\u5e94\u7528\u9700\u6c42\u81ea\u52a8\u8c03\u6574\u8ba1\u7b97\u8d44\u6e90\u7684\u6570\u91cf\u3002\u5b83\u4e3b\u8981\u7528\u4e8e EC2 \u5b9e\u4f8b\u3001\u8d1f\u8f7d\u5747\u8861\u5668\u548c\u6570\u636e\u5e93\u7684\u81ea\u52a8\u6269\u5c55\u3002</p> <p>\u5de5\u4f5c\u539f\u7406\uff1a</p> <ol> <li>\u8bbe\u7f6e\u6269\u5c55\u7b56\u7565\uff1a \u60a8\u53ef\u4ee5\u8bbe\u7f6e\u6700\u5c0f\u5b9e\u4f8b\u6570\u3001\u6700\u5927\u5b9e\u4f8b\u6570\u548c\u671f\u671b\u7684\u5b9e\u4f8b\u6570\u3002</li> <li>\u5b9a\u4e49\u89e6\u53d1\u6761\u4ef6\uff1a Auto Scaling \u6839\u636e\u8d1f\u8f7d\uff08\u5982 CPU \u4f7f\u7528\u7387\u3001\u5185\u5b58\u3001\u8bf7\u6c42\u6570\u7b49\uff09\u81ea\u52a8\u8fdb\u884c\u6269\u5c55\u548c\u6536\u7f29\u3002</li> <li>\u52a8\u6001\u8c03\u6574\uff1a \u5f53\u8d1f\u8f7d\u589e\u52a0\u65f6\uff0cAuto Scaling \u4f1a\u81ea\u52a8\u542f\u52a8\u65b0\u7684\u5b9e\u4f8b\uff1b\u5f53\u8d1f\u8f7d\u51cf\u5c11\u65f6\uff0c\u5b83\u4f1a\u7ec8\u6b62\u4e0d\u5fc5\u8981\u7684\u5b9e\u4f8b\u3002</li> <li>\u8d1f\u8f7d\u5747\u8861\uff1a Auto Scaling \u4e0e Elastic Load Balancer\uff08ELB\uff09\u96c6\u6210\uff0c\u786e\u4fdd\u6d41\u91cf\u5747\u5300\u5206\u914d\u5230\u5404\u4e2a\u5b9e\u4f8b\u3002</li> </ol> <p>\u4f18\u52bf\uff1a</p> <ul> <li>\u9ad8\u53ef\u7528\u6027\uff1a \u901a\u8fc7\u81ea\u52a8\u6269\u5c55\u548c\u6536\u7f29\uff0c\u786e\u4fdd\u5e94\u7528\u59cb\u7ec8\u5177\u6709\u8db3\u591f\u7684\u8d44\u6e90\u6765\u5e94\u5bf9\u8d1f\u8f7d\u53d8\u5316\u3002</li> <li>\u6210\u672c\u4f18\u5316\uff1a \u4ec5\u5728\u9700\u8981\u65f6\u8fd0\u884c\u66f4\u591a\u5b9e\u4f8b\uff0c\u964d\u4f4e\u4e86\u6210\u672c</li> </ul>"},{"location":"2025/5aws/#28-aws-cloudformation","title":"28. \u4ec0\u4e48\u662f AWS CloudFormation\uff1f","text":"<p>AWS CloudFormation \u662f AWS \u63d0\u4f9b\u7684\u57fa\u7840\u8bbe\u65bd\u5373\u4ee3\u7801\u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7\u6a21\u677f\u6765\u5b9a\u4e49 AWS \u57fa\u7840\u8bbe\u65bd\u8d44\u6e90\u5e76\u81ea\u52a8\u5316\u5176\u521b\u5efa\u548c\u7ba1\u7406\u3002</p> <p>CloudFormation \u5141\u8bb8\u60a8\u4f7f\u7528 JSON \u6216 YAML \u683c\u5f0f\u7f16\u5199\u6a21\u677f\uff0c\u63cf\u8ff0\u6240\u9700\u7684 AWS \u8d44\u6e90\uff0c\u81ea\u52a8\u5316\u90e8\u7f72\u548c\u66f4\u65b0\u3002</p> <p>\u4f18\u52bf\uff1a</p> <ul> <li>\u53ef\u91cd\u590d\u6027\uff1a \u901a\u8fc7\u6a21\u677f\uff0c\u60a8\u53ef\u4ee5\u4e00\u952e\u521b\u5efa\u76f8\u540c\u7684\u8d44\u6e90\u914d\u7f6e\u3002</li> <li>\u7248\u672c\u63a7\u5236\uff1a \u6a21\u677f\u53ef\u4ee5\u88ab\u7248\u672c\u5316\uff0c\u8ddf\u8e2a\u57fa\u7840\u8bbe\u65bd\u7684\u66f4\u6539\u3002</li> <li>\u81ea\u52a8\u5316\u7ba1\u7406\uff1a \u53ef\u4ee5\u81ea\u52a8\u5316\u8d44\u6e90\u7684\u521b\u5efa\u3001\u66f4\u65b0\u3001\u5220\u9664\u7b49\u7ba1\u7406\u4efb\u52a1\u3002</li> <li>\u8de8\u533a\u57df\u3001\u8de8\u8d26\u6237\u652f\u6301\uff1a \u53ef\u4ee5\u901a\u8fc7\u540c\u4e00\u4e2a\u6a21\u677f\u5728\u4e0d\u540c\u533a\u57df\u548c\u8d26\u6237\u4e2d\u7ba1\u7406\u8d44\u6e90\u3002</li> </ul>"},{"location":"2025/5aws/#29-aws-lb","title":"29. AWS \u4e2d\u7684 LB \u6709\u51e0\u79cd\u7c7b\u578b","text":"<p>\u5728 AWS \u4e2d\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\uff08LB\uff09 \u6709\u4e09\u79cd\u4e3b\u8981\u7c7b\u578b\uff0c\u6bcf\u79cd\u7c7b\u578b\u9002\u7528\u4e8e\u4e0d\u540c\u7684\u4f7f\u7528\u573a\u666f\uff1a</p>"},{"location":"2025/5aws/#1-alb-application-load-balancer","title":"1. \u5e94\u7528\u8d1f\u8f7d\u5747\u8861\u5668\uff08ALB - Application Load Balancer\uff09","text":"<ul> <li>\u9002\u7528\u5c42\u6b21\uff1a \u7b2c 7 \u5c42\uff08\u5e94\u7528\u5c42\uff09\u3002</li> <li>\u529f\u80fd\uff1a ALB \u7528\u4e8e HTTP \u548c HTTPS \u6d41\u91cf\u7684\u8d1f\u8f7d\u5747\u8861\uff0c\u80fd\u591f\u57fa\u4e8e\u8bf7\u6c42\u7684\u5185\u5bb9\uff08\u5982 URL \u8def\u5f84\u3001\u4e3b\u673a\u540d\u3001HTTP \u5934\u7b49\uff09\u8fdb\u884c\u667a\u80fd\u8def\u7531\u3002\u5b83\u975e\u5e38\u9002\u5408\u5fae\u670d\u52a1\u67b6\u6784\u548c\u5bb9\u5668\u5316\u5e94\u7528\u7684\u9700\u6c42\u3002</li> <li>\u7279\u70b9\uff1a<ul> <li>\u652f\u6301\u5185\u5bb9\u611f\u77e5\u8def\u7531\uff08\u57fa\u4e8e URL \u8def\u5f84\u3001\u67e5\u8be2\u5b57\u7b26\u4e32\u3001\u8bf7\u6c42\u5934\u7b49\uff09\u3002</li> <li>\u652f\u6301 WebSocket \u548c HTTP/2\u3002</li> <li>\u9002\u7528\u4e8e\u590d\u6742\u7684\u8def\u7531\u89c4\u5219\u548c\u57fa\u4e8e\u8bf7\u6c42\u5185\u5bb9\u7684\u8d1f\u8f7d\u5747\u8861\u3002</li> <li>\u652f\u6301\u4e0e AWS ECS\u3001EKS \u7b49\u670d\u52a1\u7684\u96c6\u6210\u3002</li> </ul> </li> </ul>"},{"location":"2025/5aws/#2-nlb-network-load-balancer","title":"2. \u7f51\u7edc\u8d1f\u8f7d\u5747\u8861\u5668\uff08NLB - Network Load Balancer\uff09","text":"<ul> <li>\u9002\u7528\u5c42\u6b21\uff1a \u7b2c 4 \u5c42\uff08\u4f20\u8f93\u5c42\uff09</li> <li>\u529f\u80fd\uff1a NLB \u9002\u7528\u4e8e\u9700\u8981\u6781\u9ad8\u6027\u80fd\u548c\u4f4e\u5ef6\u8fdf\u7684\u5e94\u7528\uff0c\u7279\u522b\u662f\u5904\u7406 TCP \u548c UDP \u6d41\u91cf\u7684\u573a\u666f\u3002NLB \u80fd\u591f\u5904\u7406\u6570\u767e\u4e07\u4e2a\u8bf7\u6c42\uff0c\u540c\u65f6\u4fdd\u6301\u975e\u5e38\u4f4e\u7684\u5ef6\u8fdf\u3002</li> <li>\u7279\u70b9\uff1a<ul> <li>\u9002\u7528\u4e8e\u9ad8\u541e\u5410\u91cf\u3001\u4f4e\u5ef6\u8fdf\u7684\u7f51\u7edc\u5c42\u6d41\u91cf\uff08TCP/UDP\uff09\u3002</li> <li>\u652f\u6301\u9759\u6001 IP \u548c\u5f39\u6027 IP\u3002</li> <li>\u81ea\u52a8\u6269\u5c55\uff0c\u652f\u6301\u5bb9\u9519\u548c\u9ad8\u53ef\u7528\u6027\u3002</li> <li>\u652f\u6301\u8d1f\u8f7d\u5747\u8861\u5230 EC2 \u5b9e\u4f8b\u3001\u5bb9\u5668\u4ee5\u53ca\u57fa\u4e8e IP \u5730\u5740\u7684\u76ee\u6807\u3002</li> </ul> </li> </ul>"},{"location":"2025/5aws/#3-clb-classic-load-balancer","title":"3. \u7ecf\u5178\u8d1f\u8f7d\u5747\u8861\u5668\uff08CLB - Classic Load Balancer\uff09","text":"<ul> <li>\u9002\u7528\u5c42\u6b21\uff1a \u7b2c 4 \u5c42\uff08\u4f20\u8f93\u5c42\uff09\u548c\u7b2c 7 \u5c42\uff08\u5e94\u7528\u5c42</li> <li>\u529f\u80fd\uff1a CLB \u662f\u6700\u65e9\u7684 AWS \u8d1f\u8f7d\u5747\u8861\u5668\u7c7b\u578b\uff0c\u9002\u7528\u4e8e\u4f20\u7edf\u7684 EC2 \u5b9e\u4f8b\uff0c\u652f\u6301 HTTP\u3001HTTPS \u548c TCP \u6d41\u91cf\u3002\u5b83\u63d0\u4f9b\u4e86\u57fa\u672c\u7684\u8d1f\u8f7d\u5747\u8861\u529f\u80fd\uff0c\u4f46\u4e0d\u5177\u5907 ALB \u548c NLB \u7684\u9ad8\u7ea7\u529f\u80fd\u3002</li> <li>\u7279\u70b9\uff1a<ul> <li>\u9002\u7528\u4e8e\u8f83\u4e3a\u7b80\u5355\u7684\u8d1f\u8f7d\u5747\u8861\u9700\u6c42\u3002</li> <li>\u652f\u6301 HTTP\u3001HTTPS \u548c TCP \u534f\u8bae\u3002</li> <li>\u4e0d\u652f\u6301\u57fa\u4e8e\u5185\u5bb9\u7684\u8def\u7531\u548c HTTP/2\u3002</li> <li>\u76ee\u524d AWS \u5efa\u8bae\u7528\u6237\u8fc1\u79fb\u5230 ALB \u6216 NLB\u3002</li> </ul> </li> </ul> <p>\u603b\u7ed3\uff1a</p> <ul> <li>ALB\uff1a \u9002\u7528\u4e8e\u9700\u8981\u57fa\u4e8e\u5185\u5bb9\u8fdb\u884c\u8def\u7531\u7684 HTTP/HTTPS \u6d41\u91cf\uff0c\u7279\u522b\u9002\u7528\u4e8e\u5fae\u670d\u52a1\u548c\u5bb9\u5668\u5316\u5e94\u7528\u3002</li> <li>NLB\uff1a \u9002\u7528\u4e8e\u9ad8\u6027\u80fd\u3001\u4f4e\u5ef6\u8fdf\u7684 TCP/UDP \u6d41\u91cf\uff0c\u9002\u5408\u5927\u89c4\u6a21\u7684\u7f51\u7edc\u6d41\u91cf\u5904\u7406\u3002</li> <li>CLB\uff1a \u9002\u7528\u4e8e\u4f20\u7edf\u5e94\u7528\u548c\u8f83\u7b80\u5355\u7684\u8d1f\u8f7d\u5747\u8861\u9700\u6c42\uff0cAWS \u5efa\u8bae\u9010\u6b65\u8fc7\u6e21\u5230 ALB \u6216 NLB\u3002</li> </ul> <p>\u9009\u62e9\u5408\u9002\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u7c7b\u578b\uff0c\u53d6\u51b3\u4e8e\u60a8\u7684\u5e94\u7528\u573a\u666f\u548c\u6027\u80fd\u8981\u6c42\u3002</p>"},{"location":"2025/5aws/#30-aws-k8s-test-pre-prod","title":"30. \u5728 AWS \u4e2d\u5982\u4f55\u4e3a k8s \u89c4\u5212 Test \u73af\u5883\uff0cPre \u73af\u5883\u548c Prod \u73af\u5883\u5462","text":"<p>\u5728 AWS \u4e2d\u4e3a Kubernetes \u96c6\u7fa4\uff08K8s\uff09\u89c4\u5212\u6d4b\u8bd5\u73af\u5883\uff08test\uff09\u3001\u9884\u53d1\u5e03\u73af\u5883\uff08pre\uff09\u3001\u751f\u4ea7\u73af\u5883\uff08prod\uff09\u65f6\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u4e0d\u540c\u7684\u9700\u6c42\u4f7f\u7528\u4e0d\u540c\u7684 AWS \u670d\u52a1\u548c Kubernetes \u96c6\u7fa4\u914d\u7f6e\u3002\u4e3a\u4e86\u5b9e\u73b0\u73af\u5883\u9694\u79bb\u3001\u7ba1\u7406\u548c\u6269\u5c55\u6027\uff0c\u4ee5\u4e0b\u662f\u51e0\u79cd\u63a8\u8350\u7684\u65b9\u6cd5\u6765\u89c4\u5212\u548c\u7ba1\u7406\u8fd9\u4e9b\u73af\u5883\u3002</p>"},{"location":"2025/5aws/#1-kubernetes","title":"1. \u4f7f\u7528\u591a\u4e2a Kubernetes \u96c6\u7fa4","text":"<p>\u5728 AWS \u4e0a\uff0c\u60a8\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u73af\u5883\u521b\u5efa\u72ec\u7acb\u7684 Kubernetes \u96c6\u7fa4\uff0c\u8fd9\u6837\u53ef\u4ee5\u6709\u6548\u5730\u9694\u79bb\u4e0d\u540c\u7684\u73af\u5883\u3002\u6bcf\u4e2a\u96c6\u7fa4\u53ef\u4ee5\u8fd0\u884c\u5728\u4e0d\u540c\u7684 VPC\uff08\u865a\u62df\u79c1\u6709\u4e91\uff09\u4e2d\uff0c\u63d0\u4f9b\u66f4\u9ad8\u7684\u5b89\u5168\u6027\u548c\u7f51\u7edc\u9694\u79bb\u3002</p> <p>\u521b\u5efa\u591a\u4e2a VPC \u6216\u5b50\u7f51</p> <p>\u4e3a\u4e86\u786e\u4fdd\u4e0d\u540c\u73af\u5883\u7684\u9694\u79bb\uff0c\u60a8\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u73af\u5883\u521b\u5efa\u72ec\u7acb\u7684 VPC\uff0c\u6216\u8005\u81f3\u5c11\u5728\u540c\u4e00 VPC \u4e2d\u4f7f\u7528\u4e0d\u540c\u7684\u5b50\u7f51\u8fdb\u884c\u73af\u5883\u9694\u79bb</p> <ul> <li>Test \u73af\u5883\uff1a \u53ef\u4ee5\u914d\u7f6e\u4e3a\u5f00\u53d1/\u6d4b\u8bd5\u73af\u5883\uff0c\u89c4\u6a21\u8f83\u5c0f\uff0c\u4f7f\u7528\u5c11\u91cf\u8282\u70b9\u548c\u8d44\u6e90\u3002</li> <li>Pre \u73af\u5883\uff1a \u63a5\u8fd1\u751f\u4ea7\u73af\u5883\uff0c\u4f7f\u7528\u66f4\u591a\u7684\u8282\u70b9\uff0c\u5e76\u5305\u542b\u4e0e\u751f\u4ea7\u73af\u5883\u76f8\u4f3c\u7684\u914d\u7f6e\u548c\u670d\u52a1\u3002</li> <li>Prod \u73af\u5883\uff1a \u5b8c\u5168\u9694\u79bb\u7684\u751f\u4ea7\u73af\u5883\uff0c\u5177\u6709\u9ad8\u53ef\u7528\u6027\u3001\u8d1f\u8f7d\u5747\u8861\u5668\u3001\u81ea\u52a8\u6269\u5c55\u7ec4\u7b49\uff0c\u4ee5\u786e\u4fdd\u53ef\u9760\u6027\u548c\u6027\u80fd\u3002</li> </ul>"},{"location":"2025/5aws/#amazon-eks","title":"\u521b\u5efa\u96c6\u7fa4\u5e76\u4f7f\u7528 Amazon EKS","text":"<p>Amazon Elastic Kubernetes Service\uff08EKS\uff09\u662f AWS \u4e0a\u6258\u7ba1\u7684 Kubernetes \u670d\u52a1\uff0c\u5b83\u5141\u8bb8\u60a8\u5feb\u901f\u90e8\u7f72\u3001\u7ba1\u7406\u548c\u6269\u5c55 Kubernetes \u96c6\u7fa4\u3002</p> <ul> <li>\u6bcf\u4e2a\u73af\u5883\u521b\u5efa\u72ec\u7acb\u7684 EKS \u96c6\u7fa4\uff0c\u5982 eks-test-cluster, eks-pre-cluster, eks-prod-cluster\u3002</li> <li>\u4f7f\u7528 EKS \u96c6\u7fa4\u7ba1\u7406\u5de5\u5177\uff08\u5982 eksctl\uff09\u6765\u521b\u5efa\u548c\u7ba1\u7406\u96c6\u7fa4\u3002</li> </ul> <p>\u793a\u4f8b\u547d\u4ee4\u521b\u5efa EKS \u96c6\u7fa4\uff08\u4f7f\u7528 eksctl\uff09\uff1a</p> <pre><code>eksctl create cluster --name test-cluster --region us-west-2 --nodegroup-name test-nodes --node-type t3.medium --nodes 2\neksctl create cluster --name pre-cluster --region us-west-2 --nodegroup-name pre-nodes --node-type t3.medium --nodes 3\neksctl create cluster --name prod-cluster --region us-west-2 --nodegroup-name prod-nodes --node-type t3.large --nodes 5\n</code></pre>"},{"location":"2025/5aws/#2-kubernetes","title":"2. \u4f7f\u7528 Kubernetes \u547d\u540d\u7a7a\u95f4\u8fdb\u884c\u73af\u5883\u9694\u79bb","text":"<p>\u5982\u679c\u4e0d\u5e0c\u671b\u4e3a\u6bcf\u4e2a\u73af\u5883\u521b\u5efa\u5355\u72ec\u7684 Kubernetes \u96c6\u7fa4\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 \u547d\u540d\u7a7a\u95f4\uff08namespace\uff09 \u6765\u5728\u540c\u4e00\u4e2a\u96c6\u7fa4\u4e2d\u9694\u79bb\u4e0d\u540c\u7684\u73af\u5883\u3002\u8fd9\u5bf9\u4e8e\u8f83\u5c0f\u7684\u9879\u76ee\u6216\u8d44\u6e90\u4f7f\u7528\u8f83\u4f4e\u7684\u73af\u5883\u662f\u53ef\u884c\u7684\u3002</p> <ul> <li>Test \u73af\u5883\uff1a \u521b\u5efa\u4e00\u4e2a test \u547d\u540d\u7a7a\u95f4\u3002</li> <li>Pre \u73af\u5883\uff1a \u521b\u5efa\u4e00\u4e2a pre \u547d\u540d\u7a7a\u95f4\u3002</li> <li>Prod \u73af\u5883\uff1a \u521b\u5efa\u4e00\u4e2a prod \u547d\u540d\u7a7a\u95f4\u3002</li> </ul> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u4ecd\u7136\u53ea\u9700\u8981\u4e00\u4e2a Kubernetes \u96c6\u7fa4\uff0c\u4f46\u6bcf\u4e2a\u73af\u5883\u6709\u81ea\u5df1\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u4ee5\u786e\u4fdd\u5b83\u4eec\u76f8\u4e92\u9694\u79bb\u3002</p> <p>\u793a\u4f8b\u547d\u4ee4\u521b\u5efa\u547d\u540d\u7a7a\u95f4\uff1a</p> <pre><code>kubectl create namespace test\nkubectl create namespace pre\nkubectl create namespace prod\n</code></pre>"},{"location":"2025/5aws/#3-aws-iam","title":"3. \u914d\u7f6e AWS IAM \u89d2\u8272\u548c\u7b56\u7565","text":"<p>\u4e3a\u4e86\u786e\u4fdd\u4e0d\u540c\u73af\u5883\u7684\u5b89\u5168\u6027\u548c\u8bbf\u95ee\u63a7\u5236\uff0c\u60a8\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u73af\u5883\u914d\u7f6e AWS IAM\uff08\u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406\uff09\u89d2\u8272\u548c\u7b56\u7565\uff0c\u5e76\u9650\u5236\u6bcf\u4e2a\u73af\u5883\u7684\u8bbf\u95ee\u6743\u9650</p> <ul> <li>\u521b\u5efa IAM \u89d2\u8272\uff1a \u4e3a\u6bcf\u4e2a\u73af\u5883\u521b\u5efa\u72ec\u7acb\u7684 IAM \u89d2\u8272\uff0c\u4f8b\u5982 test-role, pre-role, prod-role\u3002</li> <li>\u5b9a\u4e49 IAM \u7b56\u7565\uff1a \u4e3a\u6bcf\u4e2a\u73af\u5883\u5b9a\u4e49\u7ec6\u7c92\u5ea6\u7684\u8bbf\u95ee\u63a7\u5236\u7b56\u7565\uff0c\u786e\u4fdd\u7528\u6237\u6216\u670d\u52a1\u4ec5\u80fd\u8bbf\u95ee\u5176\u76f8\u5e94\u73af\u5883\u7684\u8d44\u6e90\u3002</li> </ul>"},{"location":"2025/5aws/#4-cicd","title":"4. \u914d\u7f6e CI/CD \u7ba1\u9053","text":"<p>\u60a8\u53ef\u4ee5\u914d\u7f6e CI/CD \u7ba1\u9053\u6765\u81ea\u52a8\u5316\u5e94\u7528\u7a0b\u5e8f\u7684\u90e8\u7f72\u548c\u66f4\u65b0\uff0c\u786e\u4fdd\u6bcf\u4e2a\u73af\u5883\u7684\u7248\u672c\u63a7\u5236\u548c\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002</p> <p>\u4f7f\u7528 AWS CodePipeline \u548c CodeBuild</p> <ul> <li>Test \u73af\u5883\uff1a CI/CD \u6d41\u6c34\u7ebf\u53ef\u4ee5\u5728 test \u73af\u5883\u4e2d\u81ea\u52a8\u6784\u5efa\u548c\u90e8\u7f72\u5e94\u7528\u3002</li> <li>Pre \u73af\u5883\uff1a \u5e94\u7528\u5148\u90e8\u7f72\u5230 pre \u73af\u5883\u8fdb\u884c\u96c6\u6210\u6d4b\u8bd5\u3002</li> <li>Prod \u73af\u5883\uff1a \u6700\u7ec8\u5c06\u5e94\u7528\u90e8\u7f72\u5230 prod \u73af\u5883\uff0c\u8fdb\u884c\u84dd\u7eff\u90e8\u7f72\u6216\u6eda\u52a8\u66f4\u65b0</li> </ul> <p>\u4f7f\u7528 GitOps \u7ba1\u7406</p> <p>\u5982\u679c\u4f7f\u7528 GitOps \u65b9\u6cd5\uff08\u5982 ArgoCD \u6216 Flux\uff09\uff0c\u60a8\u53ef\u4ee5\u5c06\u6bcf\u4e2a\u73af\u5883\u7684\u914d\u7f6e\u548c\u90e8\u7f72\u8fc7\u7a0b\u7ba1\u7406\u4e3a Git \u4ed3\u5e93\u4e2d\u7684\u4ee3\u7801\u548c\u914d\u7f6e\u3002\u6839\u636e\u73af\u5883\u5206\u522b\u7ef4\u62a4\u4e0d\u540c\u7684\u5206\u652f\u6216\u76ee\u5f55</p> <p>GitOps \u90e8\u7f72\u793a\u4f8b\uff1a</p> <ul> <li>main \u5206\u652f\u90e8\u7f72\u5230 prod \u73af\u5883\u3002</li> <li>staging \u5206\u652f\u90e8\u7f72\u5230 pre \u73af\u5883\u3002</li> <li>dev \u5206\u652f\u90e8\u7f72\u5230 test \u73af\u5883\u3002</li> </ul>"},{"location":"2025/5aws/#5-aws-vpcsubnets-security-groups","title":"5. \u914d\u7f6e AWS VPC\u3001Subnets \u548c Security Groups","text":"<p>\u4e3a\u786e\u4fdd\u73af\u5883\u7684\u9694\u79bb\u6027\uff0c\u60a8\u53ef\u4ee5\u5728\u4e0d\u540c\u7684 VPC \u4e2d\u4e3a\u6bcf\u4e2a\u73af\u5883\u63d0\u4f9b\u7f51\u7edc\u9694\u79bb\u3002\u4f8b\u5982\uff0cprod \u73af\u5883\u53ef\u80fd\u9700\u8981\u66f4\u4e25\u683c\u7684\u5b89\u5168\u89c4\u5219\u548c\u7f51\u7edc\u9694\u79bb\uff0c\u800c test \u548c pre \u73af\u5883\u53ef\u4ee5\u4f7f\u7528\u8f83\u5bbd\u677e\u7684\u914d\u7f6e\u3002</p> <ul> <li>VPC \u548c\u5b50\u7f51\uff1a \u6bcf\u4e2a\u73af\u5883\u6709\u81ea\u5df1\u7684 VPC \u6216\u81f3\u5c11\u5728\u540c\u4e00 VPC \u4e0b\u7684\u4e0d\u540c\u5b50\u7f51\u3002</li> <li>\u5b89\u5168\u7ec4\uff1a \u4e3a\u6bcf\u4e2a\u73af\u5883\u914d\u7f6e\u4e0d\u540c\u7684\u5b89\u5168\u7ec4\uff0c\u4ee5\u63a7\u5236\u5bf9 Kubernetes API \u670d\u52a1\u5668\u7684\u8bbf\u95ee\u3001Pod \u7684\u7f51\u7edc\u8bbf\u95ee\u7b49\u3002</li> </ul>"},{"location":"2025/5aws/#6_1","title":"6. \u914d\u7f6e\u81ea\u52a8\u5316\u4f38\u7f29\u548c\u8d44\u6e90\u7ba1\u7406","text":"<p>\u4e3a\u4e86\u786e\u4fdd\u4e0d\u540c\u73af\u5883\u5177\u6709\u5408\u7406\u7684\u8d44\u6e90\u5229\u7528\u7387\u548c\u6210\u672c\u63a7\u5236\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 AWS \u7684 \u81ea\u52a8\u4f38\u7f29\u7ec4 \u548c Kubernetes \u7684 \u8d44\u6e90\u9650\u5236 \u6765\u4e3a\u6bcf\u4e2a\u73af\u5883\u5206\u914d\u9002\u5f53\u7684\u8ba1\u7b97\u8d44\u6e90\u3002</p> <ul> <li>Test \u73af\u5883\uff1a \u901a\u5e38\u8f83\u5c0f\uff0c\u9002\u5408\u4f7f\u7528\u5c0f\u578b\u5b9e\u4f8b\u6216\u8f83\u5c11\u7684\u8282\u70b9\u3002</li> <li>Pre \u73af\u5883\uff1a \u4e0e\u751f\u4ea7\u73af\u5883\u7c7b\u4f3c\uff0c\u4f46\u53ef\u4ee5\u6309\u9700\u8c03\u6574\u3002</li> <li>Prod \u73af\u5883\uff1a \u9700\u8981\u9ad8\u53ef\u7528\u6027\u548c\u6269\u5c55\u6027\uff0c\u9002\u5408\u4f7f\u7528\u66f4\u5f3a\u5927\u7684\u5b9e\u4f8b\u3001\u81ea\u52a8\u4f38\u7f29\u7ec4\u7b49\u3002</li> </ul>"},{"location":"2025/5aws/#7","title":"7. \u76d1\u63a7\u548c\u65e5\u5fd7","text":"<p>\u4f7f\u7528 AWS CloudWatch \u548c Prometheus/Grafana \u96c6\u6210\u6765\u76d1\u63a7\u4e0d\u540c\u73af\u5883\u7684\u8d44\u6e90\u548c\u5e94\u7528\u6027\u80fd\u3002\u786e\u4fdd\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u542f\u7528\u66f4\u4e25\u683c\u7684\u65e5\u5fd7\u8bb0\u5f55\u548c\u76d1\u63a7\u3002</p> <p>\u914d\u7f6e\u73af\u5883\u6307\u6807</p> <ul> <li>Test \u73af\u5883\uff1a \u76d1\u63a7\u6d4b\u8bd5\u7528\u4f8b\u3001\u6784\u5efa\u8fc7\u7a0b\u7b49\u3002</li> <li>Pre \u73af\u5883\uff1a \u76d1\u63a7\u96c6\u6210\u6d4b\u8bd5\u3001\u90e8\u7f72\u6d41\u7a0b\u7b49\u3002</li> <li>Prod \u73af\u5883\uff1a \u76d1\u63a7\u4e1a\u52a1\u6d41\u91cf\u3001\u5e94\u7528\u6027\u80fd\u3001\u81ea\u52a8\u6269\u7f29\u7b49\u3002</li> </ul> <p>\u603b\u7ed3\uff1a\u5982\u4f55\u89c4\u5212 K8s \u96c6\u7fa4\u7684\u4e0d\u540c\u73af\u5883</p> <ul> <li>\u521b\u5efa\u591a\u4e2a\u72ec\u7acb\u7684 EKS \u96c6\u7fa4\uff1a \u4e3a test\u3001pre \u548c prod \u73af\u5883\u5206\u522b\u521b\u5efa\u72ec\u7acb\u7684 EKS \u96c6\u7fa4\uff0c\u786e\u4fdd\u5b8c\u5168\u9694\u79bb\u3002</li> <li>\u4f7f\u7528 Kubernetes \u547d\u540d\u7a7a\u95f4\uff1a \u5982\u679c\u60a8\u4e0d\u9700\u8981\u5b8c\u5168\u9694\u79bb\u96c6\u7fa4\uff0c\u53ef\u4ee5\u5728\u540c\u4e00\u96c6\u7fa4\u4e2d\u4f7f\u7528\u547d\u540d\u7a7a\u95f4\u6765\u5212\u5206\u4e0d\u540c\u7684\u73af\u5883\u3002</li> <li>\u7f51\u7edc\u9694\u79bb\uff1a \u4f7f\u7528 AWS VPC \u548c\u5b50\u7f51\u6765\u786e\u4fdd\u6bcf\u4e2a\u73af\u5883\u7684\u7f51\u7edc\u9694\u79bb\uff0c\u907f\u514d\u4ea4\u53c9\u8bbf\u95ee\u3002</li> <li>CI/CD \u7ba1\u9053\uff1a \u901a\u8fc7 AWS CodePipeline\u3001Jenkins \u6216 GitOps \u6765\u81ea\u52a8\u5316\u90e8\u7f72\u548c\u7248\u672c\u63a7\u5236\u3002</li> <li>\u5b89\u5168\u548c\u6743\u9650\uff1a \u4e3a\u6bcf\u4e2a\u73af\u5883\u914d\u7f6e\u4e0d\u540c\u7684 AWS IAM \u89d2\u8272\u548c\u7b56\u7565\uff0c\u4ee5\u786e\u4fdd\u8bbf\u95ee\u63a7\u5236\u3002</li> <li>\u76d1\u63a7\u548c\u65e5\u5fd7\uff1a \u4f7f\u7528 AWS CloudWatch\u3001Prometheus \u548c Grafana \u7b49\u5de5\u5177\u76d1\u63a7\u4e0d\u540c\u73af\u5883\u7684\u5065\u5eb7\u72b6\u51b5\u548c\u6027\u80fd\u3002</li> </ul>"},{"location":"2025/5aws/#31-aws-vpc","title":"31. \u5982\u4f55\u5728 AWS \u4e2d\u521b\u5efa VPC \u5462\uff1f","text":"<p>\u5728 AWS \u4e2d\u521b\u5efa VPC\uff08\u865a\u62df\u79c1\u6709\u4e91\uff09\u662f\u4e3a\u4e86\u63d0\u4f9b\u4e00\u4e2a\u903b\u8f91\u4e0a\u9694\u79bb\u7684\u7f51\u7edc\u73af\u5883\uff0c\u60a8\u53ef\u4ee5\u5728\u5176\u4e2d\u8fd0\u884c EC2 \u5b9e\u4f8b\u3001\u5bb9\u5668\u3001\u6570\u636e\u5e93\u7b49\u3002\u4ee5\u4e0b\u662f\u5982\u4f55\u5728 AWS \u4e2d\u521b\u5efa VPC \u7684\u6b65\u9aa4\u3002</p>"},{"location":"2025/5aws/#1-aws","title":"\u65b9\u6cd5 1\uff1a\u4f7f\u7528 AWS \u7ba1\u7406\u63a7\u5236\u53f0","text":"<p>\u6b65\u9aa4 1\uff1a\u767b\u5f55\u5230 AWS \u7ba1\u7406\u63a7\u5236\u53f0</p> <ol> <li>\u6253\u5f00 AWS \u7ba1\u7406\u63a7\u5236\u53f0\u3002</li> <li>\u767b\u5f55\u60a8\u7684 AWS \u5e10\u53f7\u3002</li> </ol>"},{"location":"2025/5aws/#2-vpc","title":"\u6b65\u9aa4 2\uff1a\u6253\u5f00 VPC \u63a7\u5236\u53f0","text":"<ol> <li>\u5728\u63a7\u5236\u53f0\u7684\u641c\u7d22\u680f\u4e2d\uff0c\u8f93\u5165 VPC \u5e76\u9009\u62e9 VPC \u670d\u52a1\u3002</li> <li>\u70b9\u51fb\u5de6\u4fa7\u7684 \"Your VPCs\"\uff08\u60a8\u7684 VPC\uff09\u3002</li> </ol>"},{"location":"2025/5aws/#3-vpc","title":"\u6b65\u9aa4 3\uff1a\u521b\u5efa VPC","text":"<ol> <li>\u5728 VPC \u9762\u677f\u4e2d\uff0c\u70b9\u51fb Create VPC\uff08\u521b\u5efa VPC\uff09\u6309\u94ae\u3002</li> <li>\u586b\u5199\u6240\u9700\u7684\u914d\u7f6e\u9879\uff1a<ul> <li>Name tag\uff08\u540d\u79f0\u6807\u7b7e\uff09\uff1a \u4e3a\u60a8\u7684 VPC \u8d77\u4e00\u4e2a\u540d\u79f0\uff08\u5982\uff1amy-vpc\uff09\u3002</li> <li>IPv4 CIDR block\uff1a \u9009\u62e9\u4e00\u4e2a IP \u5730\u5740\u5757\uff0c\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528 10.0.0.0/16\uff08\u4ee3\u8868 65536 \u4e2a IP \u5730\u5740\uff09\uff0c\u6216\u8005 192.168.0.0/16 \u7b49\u3002</li> <li>IPv6 CIDR block\uff08\u53ef\u9009\uff09\uff1a \u5982\u679c\u9700\u8981 IPv6 \u652f\u6301\uff0c\u53ef\u4ee5\u9009\u62e9\u542f\u7528\u5e76\u5206\u914d\u4e00\u4e2a IPv6 \u5730\u5740\u5757\u3002</li> <li>Tenancy\uff1a \u9009\u62e9 \"default\"\uff08\u9ed8\u8ba4\uff09\u6216 \"dedicated\"\uff08\u4e13\u7528\uff09\u7528\u4e8e\u5b9e\u4f8b\u7684\u6258\u7ba1\u3002</li> </ul> </li> <li>\u70b9\u51fb Create\uff08\u521b\u5efa\uff09\u6309\u94ae\u3002</li> </ol>"},{"location":"2025/5aws/#4","title":"\u6b65\u9aa4 4\uff1a\u521b\u5efa\u5b50\u7f51","text":"<ol> <li>\u521b\u5efa\u5b8c VPC \u540e\uff0c\u70b9\u51fb\u5de6\u4fa7\u7684 Subnets\uff08\u5b50\u7f51\uff09\u3002</li> <li>\u70b9\u51fb Create subnet\uff08\u521b\u5efa\u5b50\u7f51\uff09\u6309\u94ae\u3002</li> <li>\u586b\u5199\u5b50\u7f51\u4fe1\u606f\uff1a<ul> <li>VPC\uff1a \u9009\u62e9\u521a\u624d\u521b\u5efa\u7684 VPC\u3002</li> <li>Subnet name\uff08\u5b50\u7f51\u540d\u79f0\uff09\uff1a \u4e3a\u5b50\u7f51\u547d\u540d\uff08\u4f8b\u5982\uff1asubnet-1\uff09\u3002</li> <li>Availability Zone\uff08\u53ef\u7528\u533a\uff09\uff1a \u9009\u62e9\u4e00\u4e2a\u53ef\u7528\u533a\uff08\u4f8b\u5982\uff1aus-west-2a\uff09\u3002</li> <li>IPv4 CIDR block\uff1a \u4e3a\u5b50\u7f51\u5206\u914d\u4e00\u4e2a\u5b50\u7f51 IP \u5730\u5740\u5757\uff08\u4f8b\u5982\uff1a10.0.1.0/24\uff09\u3002</li> </ul> </li> <li>\u70b9\u51fb Create\uff08\u521b\u5efa\uff09\u3002</li> </ol>"},{"location":"2025/5aws/#5-internet-gateway","title":"\u6b65\u9aa4 5\uff1a\u521b\u5efa Internet Gateway","text":"<ol> <li>\u5728\u5de6\u4fa7\u5bfc\u822a\u680f\u4e2d\uff0c\u9009\u62e9 Internet Gateways\u3002</li> <li>\u70b9\u51fb Create internet gateway\uff08\u521b\u5efa Internet \u7f51\u5173\uff09\u3002</li> <li>\u8f93\u5165\u4e00\u4e2a\u540d\u79f0\uff08\u4f8b\u5982\uff1amy-igw\uff09\u5e76\u70b9\u51fb Create\uff08\u521b\u5efa\uff09\u3002</li> <li>\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u9009\u62e9\u60a8\u521a\u521b\u5efa\u7684 Internet \u7f51\u5173\uff0c\u5e76\u70b9\u51fb Attach to VPC\uff08\u9644\u52a0\u5230 VPC\uff09\u3002</li> <li>\u9009\u62e9\u60a8\u4e4b\u524d\u521b\u5efa\u7684 VPC \u5e76\u70b9\u51fb Attach\uff08\u9644\u52a0\uff09\u3002</li> </ol>"},{"location":"2025/5aws/#6_2","title":"\u6b65\u9aa4 6\uff1a\u914d\u7f6e\u8def\u7531\u8868","text":"<ol> <li>\u5728 VPC \u63a7\u5236\u53f0\u7684\u5de6\u4fa7\uff0c\u70b9\u51fb Route Tables\uff08\u8def\u7531\u8868\uff09\u3002</li> <li>\u9009\u62e9\u4e00\u4e2a\u9ed8\u8ba4\u7684\u8def\u7531\u8868\u5e76\u70b9\u51fb Edit routes\uff08\u7f16\u8f91\u8def\u7531\uff09\u3002</li> <li>\u5728 Routes \u90e8\u5206\uff0c\u70b9\u51fb Add route\uff08\u6dfb\u52a0\u8def\u7531\uff09\u3002<ul> <li>Destination\uff08\u76ee\u6807\uff09\uff1a 0.0.0.0/0\uff08\u8fd9\u8868\u793a\u6240\u6709\u6d41\u91cf\uff09\u3002</li> <li>Target\uff08\u76ee\u6807\uff09\uff1a \u9009\u62e9\u60a8\u521a\u521b\u5efa\u7684 Internet \u7f51\u5173\u3002</li> </ul> </li> <li>\u70b9\u51fb Save routes\uff08\u4fdd\u5b58\u8def\u7531\uff09\u3002</li> </ol>"},{"location":"2025/5aws/#7acl","title":"\u6b65\u9aa4 7\uff1a\u914d\u7f6e\u5b89\u5168\u7ec4\u548c\u7f51\u7edcACL","text":"<ol> <li>\u5b89\u5168\u7ec4\uff1a \u5b89\u5168\u7ec4\u662f\u5b9e\u4f8b\u7684\u865a\u62df\u9632\u706b\u5899\uff0c\u53ef\u4ee5\u914d\u7f6e\u5165\u7ad9\u548c\u51fa\u7ad9\u89c4\u5219\u3002<ul> <li>\u5728\u5de6\u4fa7\u5bfc\u822a\u680f\u4e2d\uff0c\u9009\u62e9 Security Groups\uff08\u5b89\u5168\u7ec4\uff09\uff0c\u7136\u540e\u70b9\u51fb Create security group\uff08\u521b\u5efa\u5b89\u5168\u7ec4\uff09\u3002</li> <li>\u914d\u7f6e\u5b89\u5168\u7ec4\u89c4\u5219\uff08\u4f8b\u5982\uff1a\u5141\u8bb8 SSH \u8bbf\u95ee\u7aef\u53e3 22\uff0cHTTP \u8bbf\u95ee\u7aef\u53e3 80\uff0cHTTPS \u8bbf\u95ee\u7aef\u53e3 443 \u7b49\uff09\u3002</li> </ul> </li> <li>\u7f51\u7edc ACL\uff1a \u7f51\u7edc ACL\uff08\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff09\u7528\u4e8e\u63a7\u5236\u5b50\u7f51\u7ea7\u522b\u7684\u6d41\u91cf\u3002<ul> <li>\u5728\u5de6\u4fa7\u5bfc\u822a\u680f\u4e2d\uff0c\u9009\u62e9 Network ACLs\uff08\u7f51\u7edc ACL\uff09\uff0c\u7136\u540e\u70b9\u51fb Create network ACL\uff08\u521b\u5efa\u7f51\u7edc ACL\uff09\u3002</li> <li>\u7f6e\u5165\u7ad9\u548c\u51fa\u7ad9\u89c4\u5219\u3002</li> </ul> </li> </ol>"},{"location":"2025/5aws/#2-aws-cli-vpc","title":"\u65b9\u6cd5 2\uff1a\u4f7f\u7528 AWS CLI \u521b\u5efa VPC","text":"<p>\u60a8\u8fd8\u53ef\u4ee5\u4f7f\u7528 AWS CLI \u6765\u521b\u5efa\u548c\u7ba1\u7406 VPC\u3002\u4ee5\u4e0b\u662f\u4f7f\u7528 CLI \u521b\u5efa VPC \u7684\u547d\u4ee4\u793a\u4f8b\u3002</p> <pre><code>aws configure\n</code></pre> <p>\u6b65\u9aa4 2\uff1a\u521b\u5efa VPC</p> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 VPC\uff1a</p> <pre><code>aws ec2 create-vpc --cidr-block 10.0.0.0/16 --region us-west-2\n</code></pre> <p>\u8fd9\u5c06\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 VPC\uff0cCIDR \u5757\u4e3a <code>10.0.0.0/16</code>\uff0c\u5e76\u5728 us-west-2 \u533a\u57df\u521b\u5efa\u3002</p> <p>\u6b65\u9aa4 3\uff1a\u521b\u5efa\u5b50\u7f51</p> <p>\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4e3a VPC \u521b\u5efa\u5b50\u7f51</p> <pre><code>aws ec2 create-subnet --vpc-id vpc-xxxxxxxx --cidr-block 10.0.1.0/24 --availability-zone us-west-2a\n</code></pre> <p>\u6b65\u9aa4 4\uff1a\u521b\u5efa Internet \u7f51\u5173</p> <p>\u521b\u5efa\u4e00\u4e2a Internet \u7f51\u5173\u5e76\u5c06\u5176\u9644\u52a0\u5230 VPC\uff1a</p> <pre><code>aws ec2 create-internet-gateway\naws ec2 attach-internet-gateway --vpc-id vpc-xxxxxxxx --internet-gateway-id igw-xxxxxxxx\n</code></pre> <p>\u6b65\u9aa4 5\uff1a\u914d\u7f6e\u8def\u7531\u8868</p> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6dfb\u52a0\u8def\u7531</p> <pre><code>aws ec2 create-route-table --vpc-id vpc-xxxxxxxx\naws ec2 create-route --route-table-id rtb-xxxxxxxx --destination-cidr-block 0.0.0.0/0 --gateway-id igw-xxxxxxxx\n</code></pre> <p>\u603b\u7ed3</p> <ol> <li>\u4f7f\u7528 AWS \u7ba1\u7406\u63a7\u5236\u53f0\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u56fe\u5f62\u754c\u9762\u8f7b\u677e\u521b\u5efa VPC\uff0c\u5e76\u8fdb\u884c\u540e\u7eed\u7684\u5b50\u7f51\u3001Internet \u7f51\u5173\u3001\u8def\u7531\u8868\u7b49\u914d\u7f6e\u3002</li> <li>\u4f7f\u7528 AWS CLI\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u884c\u5feb\u901f\u521b\u5efa VPC\uff0c\u5e76\u4e3a\u5176\u914d\u7f6e\u5b50\u7f51\u3001\u8def\u7531\u8868\u7b49\u3002</li> </ol> <p>\u65e0\u8bba\u54ea\u79cd\u65b9\u5f0f\uff0c\u90fd\u53ef\u4ee5\u6839\u636e\u60a8\u7684\u5177\u4f53\u9700\u6c42\u5728 AWS \u4e2d\u521b\u5efa\u4e00\u4e2a\u9694\u79bb\u7684 VPC\uff0c\u4ee5\u4f9b Kubernetes \u6216\u5176\u4ed6\u670d\u52a1\u4f7f\u7528\u3002</p>"},{"location":"2025/5aws/#32-ssh-ec2","title":"32. \u4f60\u6b63\u5728\u5c1d\u8bd5\u901a\u8fc7 SSH \u8fde\u63a5\u5230\u4e00\u4e2a EC2 \u5b9e\u4f8b\uff0c\u4f46\u8fde\u63a5\u5931\u8d25\u3002","text":"<p>\u5f53\u4f60\u5c1d\u8bd5\u901a\u8fc7 SSH \u8fde\u63a5\u5230\u4e00\u4e2a EC2 \u5b9e\u4f8b\u65f6\uff0c\u5982\u679c\u8fde\u63a5\u5931\u8d25\uff0c\u53ef\u4ee5\u4ece\u4ee5\u4e0b\u51e0\u4e2a\u5e38\u89c1\u7684\u539f\u56e0\u7740\u624b\u6392\u67e5\uff1a</p> <p>1. \u68c0\u67e5\u5b89\u5168\u7ec4\u914d\u7f6e</p> <p>\u786e\u4fdd EC2 \u5b9e\u4f8b\u5173\u8054\u7684 \u5b89\u5168\u7ec4\uff08Security Group\uff09\u5141\u8bb8 SSH \u8fde\u63a5\u3002</p> <p>\u786e\u4fdd\u5141\u8bb8\u7aef\u53e3 22\uff1a EC2 \u5b9e\u4f8b\u7684\u5b89\u5168\u7ec4\u5e94\u8be5\u5141\u8bb8\u6765\u81ea\u4f60\u672c\u5730 IP \u7684 22 \u7aef\u53e3\uff08SSH\uff09\u7684\u6d41\u91cf\u3002</p> <p>\u5728 AWS \u63a7\u5236\u53f0\uff0c\u9009\u62e9 EC2 \u5b9e\u4f8b &gt; \u5b89\u5168\u7ec4 &gt; \u5165\u7ad9\u89c4\u5219 &gt; \u786e\u4fdd\u6709\u4e00\u6761\u89c4\u5219\u5141\u8bb8\u7aef\u53e3 22\uff08SSH\uff09\uff0c\u5e76\u4e14\u6765\u6e90\u8bbe\u7f6e\u4e3a \u4f60\u7684IP \u6216 0.0.0.0/0\uff08\u5168\u5f00\u653e\uff0c\u4f46\u98ce\u9669\u8f83\u5927\uff09</p> <p>2. \u68c0\u67e5\u5bc6\u94a5\u5bf9\uff08Key Pair\uff09</p> <p>\u786e\u4fdd\u4f60\u4f7f\u7528\u4e86\u6b63\u786e\u7684 \u5bc6\u94a5\u5bf9\uff08.pem \u6587\u4ef6\uff09\u6765\u8fdb\u884c SSH \u8fde\u63a5\uff0c\u5e76\u4e14\u5bc6\u94a5\u6587\u4ef6\u7684\u6743\u9650\u8bbe\u7f6e\u6b63\u786e\u3002</p> <p>\u5bc6\u94a5\u6743\u9650\uff1a \u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u786e\u4fdd .pem \u6587\u4ef6\u7684\u6743\u9650\u8bbe\u7f6e\u4e3a\u53ea\u8bfb\uff1a</p> <pre><code>chmod 400 your-key.pem\n</code></pre> <p>\u6b63\u786e\u7684\u5bc6\u94a5\u6587\u4ef6\uff1a \u4f60\u5728\u8fde\u63a5\u65f6\u9700\u8981\u6307\u5b9a\u6b63\u786e\u7684\u5bc6\u94a5\u6587\u4ef6\uff08.pem\uff09\uff0c\u5e76\u4e14\u8be5\u5bc6\u94a5\u5fc5\u987b\u4e0e\u4f60\u521b\u5efa EC2 \u5b9e\u4f8b\u65f6\u6240\u9009\u7684\u5bc6\u94a5\u5bf9\u76f8\u5339\u914d</p> <p>3. \u68c0\u67e5\u5b9e\u4f8b\u72b6\u6001</p> <p>\u786e\u4fdd\u5b9e\u4f8b\u5904\u4e8e running \u72b6\u6001\u5e76\u4e14\u80fd\u591f\u63a5\u53d7 SSH \u8fde\u63a5\u3002</p> <p>\u2022 \u5728 AWS \u63a7\u5236\u53f0\u4e0a\u68c0\u67e5\u5b9e\u4f8b\u7684\u72b6\u6001\uff0c\u786e\u4fdd\u5b83\u6ca1\u6709\u505c\u6b62\u6216\u6b63\u5728\u521d\u59cb\u5316\u3002</p> <p>4. \u68c0\u67e5 EC2 \u5b9e\u4f8b\u7684\u516c\u6709 IP \u6216 DNS \u540d\u79f0</p> <p>\u786e\u8ba4\u4f60\u4f7f\u7528\u7684\u662f\u6b63\u786e\u7684 \u516c\u6709 IP \u5730\u5740 \u6216 \u516c\u6709 DNS \u540d\u79f0 \u6765\u8fde\u63a5 EC2 \u5b9e\u4f8b\u3002\u4f60\u53ef\u4ee5\u5728 EC2 \u63a7\u5236\u53f0\u7684\u5b9e\u4f8b\u8be6\u60c5\u9875\u9762\u627e\u5230\u8fd9\u4e00\u4fe1\u606f\u3002</p> <p>5. \u68c0\u67e5\u7f51\u7edc ACL \u548c\u8def\u7531\u8868</p> <p>\u786e\u4fdd\u5b9e\u4f8b\u6240\u5728\u7684 VPC \u4e2d\u7684\u7f51\u7edc ACL \u548c\u8def\u7531\u8868\u6ca1\u6709\u963b\u6b62\u6765\u81ea\u4f60 IP \u7684\u6d41\u91cf\u3002</p> <ul> <li>\u7f51\u7edc ACL\uff08\u7f51\u7edc\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff09\u5e94\u5141\u8bb8\u6240\u6709\u8fdb\u51fa\u6d41\u91cf\uff0c\u6216\u8005\u81f3\u5c11\u5141\u8bb8\u7aef\u53e3 22 \u7684\u6d41\u91cf\u3002</li> <li>\u8def\u7531\u8868\u5e94\u8be5\u786e\u4fdd EC2 \u5b9e\u4f8b\u80fd\u591f\u4e0e\u4e92\u8054\u7f51\u8fdb\u884c\u901a\u4fe1\uff08\u5982\u679c\u662f\u516c\u6709\u5b50\u7f51\uff0c\u8def\u7531\u8868\u5e94\u8be5\u6307\u5411\u4e00\u4e2a Internet \u7f51\u5173\uff09\u3002</li> </ul> <p>6. \u68c0\u67e5\u5b9e\u4f8b\u7684\u5bc6\u94a5\u662f\u5426\u6b63\u786e</p> <p>\u786e\u4fdd\u4f60\u4f7f\u7528\u7684\u5bc6\u94a5\u5bf9\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f EC2 Instance Connect \u6216\u8005\u5176\u4ed6\u7684\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u8bf7\u786e\u4fdd\u914d\u7f6e\u6b63\u786e\u3002</p> <p>7. \u4f7f\u7528\u5b9e\u4f8b\u8fde\u63a5\u5de5\u5177\uff08EC2 Instance Connect\uff09</p> <p>\u5982\u679c SSH \u8fde\u63a5\u5931\u8d25\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528 EC2 Instance Connect \u6765\u8fde\u63a5\u5b9e\u4f8b\u3002\u5b83\u5141\u8bb8\u4f60\u901a\u8fc7\u6d4f\u89c8\u5668\u76f4\u63a5\u8fde\u63a5\u5230 EC2 \u5b9e\u4f8b\uff0c\u800c\u4e0d\u9700\u8981\u4f7f\u7528\u672c\u5730 SSH \u5ba2\u6237\u7aef\u3002</p> <p>\u5728 AWS \u63a7\u5236\u53f0\u7684 EC2 \u5b9e\u4f8b\u9875\u9762\u4e0a\uff0c\u9009\u62e9\u5b9e\u4f8b\u5e76\u70b9\u51fb Connect \u6309\u94ae\uff0c\u9009\u62e9 EC2 Instance Connect\u3002</p> <p>8. VPC \u548c\u5b50\u7f51\u7684\u914d\u7f6e</p> <p>\u786e\u4fdd\u5b9e\u4f8b\u6240\u5728\u7684 VPC \u548c\u5b50\u7f51\u7684 \u8def\u7531\u8868 \u548c NAT \u7f51\u5173 \u914d\u7f6e\u6b63\u786e\uff0c\u5c24\u5176\u662f\u5728\u4f7f\u7528\u79c1\u6709\u5b50\u7f51\u65f6\u3002\u79c1\u6709\u5b50\u7f51\u4e2d\u7684\u5b9e\u4f8b\u901a\u5e38\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95ee\u4e92\u8054\u7f51\uff0c\u60a8\u9700\u8981\u914d\u7f6e NAT \u7f51\u5173 \u6765\u5141\u8bb8 SSH \u8fde\u63a5\u3002</p> <p>9. \u7cfb\u7edf\u65e5\u5fd7\u548c\u5b9e\u4f8b\u63a7\u5236\u53f0</p> <p>\u5982\u679c\u4f60\u6ca1\u6709\u6210\u529f\u8fde\u63a5\u5e76\u4e14\u6000\u7591\u5b9e\u4f8b\u914d\u7f6e\u95ee\u9898\uff0c\u53ef\u4ee5\u67e5\u770b \u5b9e\u4f8b\u7684\u7cfb\u7edf\u65e5\u5fd7\uff1a</p> <p>\u5728 EC2 \u63a7\u5236\u53f0\uff0c\u9009\u62e9\u5b9e\u4f8b &gt; Actions &gt; Monitor and troubleshoot &gt; Get system log\uff0c\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\u662f\u5426\u6709\u4efb\u4f55\u9519\u8bef\u4fe1\u606f\u3002</p> <p>10. \u4f7f\u7528 -vvv \u9009\u9879\u8c03\u8bd5 SSH \u8fde\u63a5</p> <p>\u5728\u547d\u4ee4\u884c\u4e2d\uff0c\u589e\u52a0<code>-vvv</code> \u9009\u9879\u6765\u542f\u7528 SSH \u7684\u8be6\u7ec6\u8f93\u51fa\uff0c\u6709\u52a9\u4e8e\u8c03\u8bd5\u8fde\u63a5\u95ee\u9898\uff1a</p> <pre><code>ssh -i your-key.pem ec2-user@&lt;instance-public-ip&gt; -vvv\n</code></pre> <p>\u603b\u7ed3</p> <ol> <li>\u5b89\u5168\u7ec4\uff1a \u786e\u4fdd\u7aef\u53e3 22 \u5f00\u653e\uff0c\u5141\u8bb8\u4f60\u7684 IP\u3002</li> <li>\u5bc6\u94a5\u6587\u4ef6\uff1a \u786e\u8ba4\u4f60\u4f7f\u7528\u4e86\u6b63\u786e\u7684 .pem \u6587\u4ef6\uff0c\u5e76\u8bbe\u7f6e\u4e86\u6b63\u786e\u7684\u6743\u9650\u3002</li> <li>\u5b9e\u4f8b\u72b6\u6001\uff1a \u786e\u4fdd\u5b9e\u4f8b\u8fd0\u884c\u5e76\u6709\u516c\u6709 IP \u6216 DNS\u3002</li> <li>\u7f51\u7edc\u914d\u7f6e\uff1a \u68c0\u67e5\u7f51\u7edc ACL\u3001\u8def\u7531\u8868\u3001\u5b50\u7f51\u914d\u7f6e\uff0c\u786e\u4fdd\u6d41\u91cf\u53ef\u4ee5\u5230\u8fbe\u5b9e\u4f8b</li> </ol>"},{"location":"2025/5jenkins/","title":"Jenkins Interview Questions","text":""},{"location":"2025/5jenkins/#1-what-are-the-advantages-of-jenkins-why-we-use-jenkins","title":"1 What are the advantages of Jenkins? Why we use Jenkins?","text":"<p>Answer: Jenkins is used to continuously monitor the large code base in real-time. </p> <p>It enables developers to find bugs in their code and fix them. Email notifications are made to the developers regarding their check-ins as a post-build action</p> <ul> <li>Build failures are cached during the integration stage.</li> <li>Notifies the developers about build report status using LDAP (Lightweight Directory Access Protocol) mail server.</li> <li>Maven release project is automated with simple steps.</li> <li>Easy bug tracking.</li> <li>Automatic changes get updated in the build report with notification.</li> <li>Supports Continuous Integration in agile development and test-driven development.</li> </ul>"},{"location":"2025/5jenkins/#2-mention-some-of-the-important-plugins-in-jenkins","title":"2 Mention some of the important plugins in Jenkins?","text":"<p>Gits / Maven 2 Project / HTML Publisher / Copy Artcraft / Join / Green Balls / Amazon EC2</p>"},{"location":"2025/5jenkins/#3-what-is-continuous-integration-in-jenkins","title":"3 What is Continuous Integration in Jenkins?","text":"<p>Continuous Integration comprises of:</p> <ul> <li>Development and Compilation</li> <li>Database Integration</li> <li>Unit Testing</li> <li>Production Deployment</li> <li>Code Labeling</li> <li>Functional Testing</li> <li>Generating and Analyzing Reports</li> </ul>"},{"location":"2025/5jenkins/#4-what-is-the-difference-between-continuous-integration-continuous-delivery-and-continuous-deployment","title":"4  What is the difference between Continuous Integration, Continuous Delivery, and Continuous Deployment?","text":"<p>Continuous Integration:  involves keeping the latest copy of the source code at a commonly shared hub where all the developers can check to fetch out the latest change in order to avoid conflict</p> <ul> <li>*Continuous Delivery:</li> </ul> <p>Manual Deployment to Production. It does not involve every change to be deployed.</p> <ul> <li>Continuous Deployment</li> </ul> <p>Automated Deployment to Production. Involves every change to be deployed automatically</p> <p> </p>"},{"location":"2025/5jenkins/#5-what-is-jenkins-pipeline-what-is-a-ci-cd-pipeline","title":"5  What is Jenkins Pipeline? What is a CI CD pipeline?","text":"<p>The pipeline can be defined as the suite of plugins supporting the implementation and integration of continuous delivery pipelines in Jenkins.</p> <p>Continuous integration or continuous delivery pipeline consists of build, deploy, test, release pipeline. </p> <ul> <li>The pipeline feature saves a lot of time and error in maintaining the builds.</li> <li>Basically, a pipeline is a group of build jobs that are chained and integrated in sequence.</li> </ul>"},{"location":"2025/5jenkins/#what-are-scripted-pipelines-in-jenkins","title":"What are Scripted Pipelines in Jenkins?","text":"<p>Scripted Pipeline follows Groovy Syntax as given below:</p> <pre><code>Node {\n\n}\n</code></pre> <p>In the above syntax, the node is a part of the Jenkins distributed mode architecture, where there are two types of node, Master which handle all the tasks in the development environment and the Agent is being used to handle multiple tasks individually.</p>"},{"location":"2025/5jenkins/#what-are-declarative-pipelines-in-jenkins","title":"What are Declarative Pipelines in Jenkins?","text":"<p>Declarative Pipelines are the newest additions to Jenkins that simplify the groovy syntax of Jenkins pipelines (top-level pipeline) with some exceptions, such as: No semicolon to be used as a statement separator. The top-level pipeline should be enclosed within block viz</p> <pre><code>pipeline {\n\n/* Declarative Pipeline */\n\n}\n</code></pre> <p>Blocks must contain Sections, Directives, steps or assignments.</p> <pre><code>pipeline {\n  agent any\n  stages {\n    stage(\u2018Build\u2019) \n    {\nsteps \n    {\n    // Statements\u2026\n  }\n}\n\nstage (\u2018Test\u2019) \n    {\n    steps {\n    // Statements\u2026\n     }\n   }\n }\n}\n</code></pre> <p>The above code has 3 major elements \uf0b7 - Pipeline: The block of script contents. - Agent: Defines where the pipeline will start running from. - Stage: The pipelines contain several steps enclosed in the block called Stage</p>"},{"location":"2025/5jenkins/#what-is-scm-which-scm-tools-are-supported-in-jenkins","title":"What is SCM? Which SCM tools are supported in Jenkins?","text":"<ul> <li>SCM stands for Source Control Management.</li> <li>SCM module specifies the source code location.</li> <li>The entry point to SCM is being specified as <code>jenkins_jobs.scm</code>.</li> <li>The job specified with \u2018scm\u2019 attribute accepts multiple numbers of SCM definitions</li> </ul> <pre><code>scm:\n    name: eloc \u2013 scm\nscm:\n    git:\n    url: ssh://Jenkins.org/eloc.git\n</code></pre> <p>Jenkins supported SCM tools include:</p> <p>CVS / Git /\uf0b7 Perforce / AccuRev / Subversion / Clearcase</p>"},{"location":"2025/5jenkins/#which-commands-can-be-used-to-start-jenkins-manually","title":"Which commands can be used to start Jenkins manually?","text":"<ul> <li><code>(Jenkins_url)/restart</code>: To force restart without waiting for build completion.</li> <li><code>(Jenkin_url)/safeRestart</code>: Waits until all the build gets completed before restarting.</li> </ul> <p>What are Triggers?</p> <p>Answer: Trigger in Jenkins defines the way in which the pipeline should be executed frequently. PollSCM, Cron, etc are the currently available Triggers</p>"},{"location":"2025/5jenkins/#what-is-the-difference-between-maven-ant-and-jenkins","title":"What is the difference between Maven, Ant, and Jenkins?","text":"<p>Maven is a build tool like Ant. It consists of a pom.xml file which is specified in Jenkins to run the code. </p> <p>Whereas, Jenkins is used as a continuous integration tool and automates the deployment process. The reports of the builds can be used to set a mark for continuous delivery as well.</p>"},{"location":"2025/5jenkins/#how-will-you-define-post-in-jenkins","title":"How will you define Post in Jenkins?","text":"<p>Post is a section that contains several additional steps that might execute after the completion of the pipeline. The execution of all the steps within the condition block depends upon the completion status of the pipeline.</p> <p>The condition block includes the following conditions \u2013 changed success, always, failure, unstable and aborted.</p>"},{"location":"2025/5jenkins/#how-can-you-secure-jenkins","title":"How can you secure Jenkins?","text":"<p>Answer: Securing Jenkins is a little lengthy process, and there are two aspects of securing Jenkins:</p> <p>i) Access Control which includes authenticating users and giving them an appropriate set of permissions, which can be done in 2 ways.</p> <ul> <li>*Security Realm determines a security Realm determines a user or a group of users with their passwords.</li> <li>Authorization Strategy defines what should be accessible to which user. In this case, there might be different types of security based on the permissions granted to the user such as Quick and simple security with easy setup, Standard security setup, Apache front-end security, etc</li> </ul> <p>(ii) Protecting Jenkins users from outside threats.</p>"},{"location":"2025/5jenkins/#how-to-create-a-backup-and-copy-files-in-jenkins","title":"How to create a backup and copy files in Jenkins?","text":"<p>**In Jenkins, all the settings, build logs and configurations are stored in the <code>JENKINS_HOME</code> directory. **</p> <p>Whenever you want to create a backup of your Jenkins you can back up <code>JENKINS_HOME</code> directory frequently.</p> <p>It consists of all the job configurations and slave node configurations. Hence, regularly copying this directory allows us to keep a backup of Jenkins.</p>"},{"location":"2025/5jenkins/#what-are-the-various-ways-in-which-the-build-can-be-scheduled-in-jenkins","title":"What are the various ways in which the build can be scheduled in Jenkins?","text":"<ol> <li>After the completion of other builds.</li> <li>By source code management (modifications) commit.</li> <li>At a specific time.</li> <li>By requesting manual builds.</li> </ol>"},{"location":"2025/5jenkins/#give-any-simple-example-of-jenkins-script","title":"Give any simple example of Jenkins script.","text":"<pre><code>agent\n stages {\n  stage('Building your first asset') {\n  agent\n   steps {\n    echo 'Build asset'\n  }\n}\nstage('Test') {\n  agent\n   steps {\n    echo 'Building project 1'\n    }\n  }\n  }\n}\n</code></pre>"},{"location":"2025/5jenkins/#why-is-jenkins-called-a-continuous-delivery-tool","title":"Why is Jenkins called a Continuous Delivery Tool?","text":""},{"location":"2025/6monitor/","title":"6 \u76d1\u63a7\u751f\u6001\u9762\u8bd5\u901a\u5173\u79d8\u7c4d","text":""},{"location":"2025/6monitor/#1-prometheus","title":"1. \u4ec0\u4e48\u662f Prometheus\uff1f\u5b83\u7684\u4e3b\u8981\u529f\u80fd\u662f\u4ec0\u4e48\uff1f","text":"<p>Prometheus \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u7cfb\u7edf\u76d1\u63a7\u548c\u62a5\u8b66\u5de5\u5177\uff0c\u4e3b\u8981\u7528\u4e8e\u6536\u96c6\u548c\u5b58\u50a8\u65f6\u5e8f\u6570\u636e\uff08metrics\uff09\uff0c\u5e76\u4e14\u63d0\u4f9b\u67e5\u8be2\u8bed\u8a00\uff08PromQL\uff09\u6765\u652f\u6301\u7075\u6d3b\u7684\u67e5\u8be2\u3002</p> <p>\u5b83\u5177\u6709\u5f3a\u5927\u7684\u53ef\u6269\u5c55\u6027\u548c\u7075\u6d3b\u6027\uff0c\u5e7f\u6cdb\u7528\u4e8e\u76d1\u63a7\u5fae\u670d\u52a1\u3001\u5bb9\u5668\u548c\u4e91\u539f\u751f\u5e94\u7528\u3002</p> <p>\u4e3b\u8981\u529f\u80fd\uff1a</p> <ul> <li>\u6570\u636e\u91c7\u96c6\uff1a \u901a\u8fc7 Pull \u6a21\u578b\u5b9a\u671f\u4ece\u76ee\u6807\u670d\u52a1\u62c9\u53d6\u6570\u636e\u3002</li> <li>\u65f6\u5e8f\u6570\u636e\u5b58\u50a8\uff1a \u9ad8\u6548\u5730\u5b58\u50a8\u65f6\u5e8f\u6570\u636e\uff0c\u5e76\u652f\u6301\u9ad8\u541e\u5410\u91cf\u3002</li> <li>\u67e5\u8be2\u548c\u62a5\u8b66\uff1a \u4f7f\u7528 PromQL \u8fdb\u884c\u6570\u636e\u67e5\u8be2\uff0c\u5e76\u901a\u8fc7 Alertmanager \u914d\u7f6e\u62a5\u8b66\u3002</li> <li>\u81ea\u52a8\u53d1\u73b0\uff1a \u901a\u8fc7\u914d\u7f6e\u81ea\u52a8\u53d1\u73b0\u673a\u5236\uff08\u5982 Kubernetes\u3001Consul\uff09\u6765\u53d1\u73b0\u76d1\u63a7\u76ee\u6807\u3002</li> </ul>"},{"location":"2025/6monitor/#2-prometheus","title":"2. Prometheus \u4e2d\u7684\u65f6\u5e8f\u6570\u636e\u662f\u4ec0\u4e48\uff1f\u5b83\u7684\u5b58\u50a8\u65b9\u5f0f\u662f\u4ec0\u4e48\uff1f","text":"<p>Prometheus \u4e3b\u8981\u7528\u4e8e\u5b58\u50a8 \u65f6\u5e8f\u6570\u636e\uff0c\u5373\u65f6\u95f4\u4e0e\u67d0\u4e9b\u6307\u6807\u503c\u7684\u6620\u5c04\u3002</p> <p>\u6bcf\u4e2a\u6570\u636e\u70b9\u5305\u542b\u4e86\u4e00\u4e2a\u65f6\u95f4\u6233\u3001\u4e00\u4e2a\u503c\u548c\u4e00\u4e2a\u65f6\u95f4\u5e8f\u5217\u6807\u8bc6\u7b26\u3002\u65f6\u5e8f\u6570\u636e\u5b58\u50a8\u5728 Prometheus \u81ea\u5e26\u7684\u65f6\u5e8f\u6570\u636e\u5e93\u4e2d\uff0c\u6570\u636e\u5e93\u4f7f\u7528 \u5217\u5f0f\u5b58\u50a8\uff0c\u6bcf\u4e2a\u65f6\u5e8f\u6570\u636e\u88ab\u6309\u6807\u7b7e\uff08Label\uff09\u8fdb\u884c\u7d22\u5f15\uff0c\u5e76\u5b58\u50a8\u5728\u9ad8\u6548\u7684\u65f6\u95f4\u5e8f\u5217\u683c\u5f0f\u4e2d\u3002</p>"},{"location":"2025/6monitor/#3-prometheus","title":"3. Prometheus \u5982\u4f55\u6293\u53d6\u6570\u636e\uff1f","text":"<p>Prometheus \u901a\u8fc7 pull \u6a21\u578b \u5b9a\u671f\u4ece\u88ab\u76d1\u63a7\u7684\u76ee\u6807\uff08\u4f8b\u5982\uff0c\u5e94\u7528\u7a0b\u5e8f\u6216\u670d\u52a1\u7684\u7aef\u70b9\uff09\u6293\u53d6\u6307\u6807\u6570\u636e</p> <p>\u6bcf\u4e2a\u76ee\u6807\u9700\u8981\u66b4\u9732\u4e00\u4e2a HTTP \u7aef\u70b9\uff0c\u901a\u5e38\u662f <code>/metrics</code> \u8def\u5f84\uff0cPrometheus \u4f1a\u5b9a\u671f\u8bbf\u95ee\u8fd9\u4e2a\u7aef\u70b9\u83b7\u53d6\u6570\u636e\u3002</p> <p>\u5982\u679c\u76ee\u6807\u4e0d\u652f\u6301\u66b4\u9732 <code>/metrics</code>\uff0c\u53ef\u4ee5\u4f7f\u7528 exporter \u5de5\u5177\uff08\u5982 node_exporter\u3001blackbox_exporter\uff09\u5c06\u6307\u6807\u6570\u636e\u66b4\u9732\u51fa\u6765\u3002</p>"},{"location":"2025/6monitor/#4-prometheus-targets","title":"4. Prometheus \u4e2d\u7684\u76ee\u6807\uff08Targets\uff09\u662f\u4ec0\u4e48\uff1f\u5982\u4f55\u914d\u7f6e\uff1f","text":"<p>\u5728 Prometheus \u4e2d\uff0c\u76ee\u6807 \u662f\u6307 Prometheus \u7528\u6765\u6293\u53d6\u6307\u6807\u6570\u636e\u7684\u5916\u90e8\u7cfb\u7edf\u6216\u670d\u52a1\u3002\u76ee\u6807\u901a\u5e38\u662f\u901a\u8fc7 \u9759\u6001\u914d\u7f6e \u6216 \u670d\u52a1\u53d1\u73b0 \u6765\u6307\u5b9a\u3002</p> <p>\u5728 <code>prometheus.yml</code> \u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u914d\u7f6e\u9759\u6001\u76ee\u6807\u6216\u901a\u8fc7 Kubernetes\u3001Consul\u3001EC2 \u7b49\u8fdb\u884c\u670d\u52a1\u53d1\u73b0\u3002\u76ee\u6807\u914d\u7f6e\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>scrape_configs:\njob_name: 'node'\nstatic_configs:\n</code></pre>"},{"location":"2025/6monitor/#5-prometheus","title":"5. Prometheus \u7684\u91c7\u96c6\u5468\u671f\u662f\u5982\u4f55\u5b9a\u4e49\u7684\uff1f","text":"<p>Prometheus \u4f1a\u5b9a\u671f\u4ece\u914d\u7f6e\u4e2d\u7684\u76ee\u6807\u6293\u53d6\u6570\u636e\uff0c\u9ed8\u8ba4\u6293\u53d6\u5468\u671f\u662f 15 \u79d2\uff08<code>scrape_interval: 15s</code>\uff09\u3002</p> <p>\u53ef\u4ee5\u5728 Prometheus \u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u8c03\u6574\uff0c\u8bbe\u7f6e\u4e0d\u540c\u7684 <code>scrape_interval</code> \u548c <code>scrape_timeout</code>\u3002</p> <p>\u4f8b\u5982\uff0c\u8bbe\u7f6e\u66f4\u77ed\u7684\u6293\u53d6\u5468\u671f\u53ef\u4ee5\u83b7\u53d6\u66f4\u5b9e\u65f6\u7684\u6307\u6807\u6570\u636e\uff0c\u4f46\u4f1a\u589e\u52a0 Prometheus \u7684\u8d1f\u62c5\u3002</p>"},{"location":"2025/6monitor/#6-prometheus","title":"6. Prometheus \u5982\u4f55\u8fdb\u884c\u6570\u636e\u67e5\u8be2\uff1f","text":"<p>Prometheus \u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f3a\u5927\u7684\u67e5\u8be2\u8bed\u8a00 PromQL\uff0c\u7528\u4e8e\u4ece\u65f6\u5e8f\u6570\u636e\u5e93\u4e2d\u67e5\u8be2\u548c\u64cd\u4f5c\u6570\u636e\u3002\u901a\u8fc7 PromQL\uff0c\u7528\u6237\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u805a\u5408\u3001\u8ba1\u7b97\u3001\u8fc7\u6ee4\u7b49\u64cd\u4f5c\u3002\u5e38\u89c1\u7684\u67e5\u8be2\u65b9\u5f0f\u5305\u62ec\uff1a</p> <ul> <li>\u83b7\u53d6\u5355\u4e2a\u65f6\u5e8f\u6570\u636e\uff1a <code>http_requests_total{status=\"200\"}</code></li> <li>\u8ba1\u7b97\u805a\u5408\u503c\uff1a <code>avg(http_requests_total{status=\"200\"})</code></li> <li>\u65f6\u95f4\u8303\u56f4\u9009\u62e9\uff1a <code>http_requests_total[5m]</code> \u83b7\u53d6\u8fc7\u53bb 5 \u5206\u949f\u7684\u6570\u636e</li> </ul>"},{"location":"2025/6monitor/#7-prometheus","title":"7. Prometheus \u5982\u4f55\u8fdb\u884c\u544a\u8b66\u7ba1\u7406\uff1f","text":"<p>Prometheus \u4f7f\u7528 Alertmanager \u8fdb\u884c\u544a\u8b66\u7ba1\u7406\u3002</p> <p>Alertmanager \u8d1f\u8d23\u63a5\u6536 Prometheus \u4e2d\u89e6\u53d1\u7684\u544a\u8b66\u5e76\u5c06\u5b83\u4eec\u8f6c\u53d1\u5230\u4e0d\u540c\u7684\u901a\u77e5\u6e20\u9053\uff0c\u5982\u7535\u5b50\u90ae\u4ef6\u3001Slack\u3001PagerDuty \u7b49\u3002</p> <p>\u544a\u8b66\u89c4\u5219\u5728 prometheus.yml \u914d\u7f6e\u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u544a\u8b66\u6761\u4ef6\u53ef\u4ee5\u57fa\u4e8e PromQL \u67e5\u8be2\u7ed3\u679c\u8bbe\u5b9a\u3002\u4f8b\u5982\uff1a</p> <pre><code>alerting:\n  alertmanagers:\n    -static_configs:\n      -targets: ['localhost:9093']\nrule_files:\n\"alert.rules\"\nalerts:\nalert:HighCpuUsage\nexpr:avg(rate(cpu_usage[5m]))&gt;0.9\nfor:1m\nannotations:\nsummary: \"CPU usage is high\"\n</code></pre>"},{"location":"2025/6monitor/#8-prometheus-labels","title":"8. \u5982\u4f55\u5728 Prometheus \u4e2d\u4f7f\u7528\u6807\u7b7e\uff08Labels\uff09\uff1f","text":"<p>\u6807\u7b7e\u662f Prometheus \u7528\u6765\u533a\u5206\u540c\u4e00\u65f6\u95f4\u5e8f\u5217\u4e0d\u540c\u7ef4\u5ea6\u7684\u6807\u8bc6\u7b26\u3002\u6bcf\u4e2a\u65f6\u95f4\u5e8f\u5217\u53ef\u4ee5\u6709\u591a\u4e2a\u6807\u7b7e\uff0c\u6807\u7b7e\u952e\u503c\u5bf9\u53ef\u4ee5\u5e2e\u52a9\u7528\u6237\u533a\u5206\u4e0d\u540c\u7684\u8d44\u6e90\u548c\u7ef4\u5ea6\u3002</p> <p>\u4f8b\u5982\uff0c<code>http_requests_total{status=\"200\", method=\"GET\"}</code>\uff0c\u5176\u4e2d status \u548c method \u662f\u6807\u7b7e\u952e\uff0c\u5206\u522b\u8868\u793a HTTP \u72b6\u6001\u548c\u8bf7\u6c42\u65b9\u6cd5\u3002\u6807\u7b7e\u4f7f\u5f97 Prometheus \u80fd\u591f\u6267\u884c\u9ad8\u6548\u7684\u7ef4\u5ea6\u67e5\u8be2\u3002</p>"},{"location":"2025/6monitor/#9-prometheus","title":"9. \u5982\u4f55\u6269\u5c55 Prometheus\uff1f","text":"<ul> <li>Prometheus Federation\uff1a \u901a\u8fc7 Prometheus \u8054\u90a6\u673a\u5236\uff0c\u5c06\u591a\u4e2a Prometheus \u5b9e\u4f8b\u805a\u5408\u5728\u4e00\u8d77\uff0c\u63d0\u4f9b\u66f4\u5927\u7684\u6570\u636e\u5904\u7406\u80fd\u529b\u3002</li> <li>\u5206\u5e03\u5f0f\u5b58\u50a8\uff1a \u901a\u8fc7\u5916\u90e8\u5b58\u50a8\u540e\u7aef\uff08\u5982 Cortex\u3001Thanos\u3001 GreptimeDB \u7b49\u7b49\uff09\u5b9e\u73b0 Prometheus \u6570\u636e\u7684\u957f\u671f\u5b58\u50a8\u548c\u6269\u5c55\u3002</li> <li>\u4f7f\u7528\u591a\u4e2a Prometheus \u5b9e\u4f8b\uff1a \u9488\u5bf9\u4e0d\u540c\u7684\u76d1\u63a7\u76ee\u6807\uff0c\u4f7f\u7528\u591a\u4e2a Prometheus \u5b9e\u4f8b\u5206\u62c5\u6570\u636e\u6293\u53d6\u4efb\u52a1\uff0c\u7136\u540e\u901a\u8fc7\u805a\u5408\u548c\u67e5\u8be2\u591a\u4e2a\u5b9e\u4f8b\u7684\u6570\u636e\u6765\u63d0\u9ad8\u6027\u80fd\u3002</li> </ul>"},{"location":"2025/6monitor/#10-prometheus-kubernetes","title":"10. Prometheus \u5982\u4f55\u4e0e Kubernetes \u96c6\u6210\uff1f","text":"<p>Prometheus \u4e0e Kubernetes \u7684\u96c6\u6210\u901a\u5e38\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u5b9e\u73b0\uff1a</p> <p>\u670d\u52a1\u53d1\u73b0\uff1a Prometheus \u4f7f\u7528 Kubernetes API \u8fdb\u884c\u670d\u52a1\u53d1\u73b0\uff0c\u81ea\u52a8\u53d1\u73b0 Kubernetes \u96c6\u7fa4\u4e2d\u7684 Pod \u548c\u670d\u52a1\u3002</p> <p>Kubernetes Exporter\uff1a \u5982 kube-state-metrics\u3001node-exporter \u7b49 Exporter \u7528\u4e8e\u66b4\u9732 Kubernetes \u96c6\u7fa4\u7684\u5404\u79cd\u76d1\u63a7\u6307\u6807\uff08\u5982 Pod \u72b6\u6001\u3001\u8282\u70b9\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u7b49\uff09\u3002</p> <p>Prometheus Operator\uff1a \u4e00\u4e2a Kubernetes \u539f\u751f\u7684 Prometheus \u914d\u7f6e\u548c\u7ba1\u7406\u5de5\u5177\uff0c\u7b80\u5316 Prometheus \u7684\u90e8\u7f72\u3001\u914d\u7f6e\u548c\u7ef4\u62a4\u3002</p>"},{"location":"2025/6monitor/#11-prometheus-grafanaalertmanager","title":"11. Prometheus \u5982\u4f55\u4e0e\u5176\u4ed6\u5de5\u5177\uff08\u5982 Grafana\u3001Alertmanager\uff09\u534f\u4f5c\uff1f","text":"<p>Prometheus \u4f5c\u4e3a\u65f6\u5e8f\u6570\u636e\u6536\u96c6\u548c\u5b58\u50a8\u5de5\u5177\uff0c\u901a\u5e38\u4e0e\u5176\u4ed6\u751f\u6001\u5de5\u5177\u534f\u4f5c\uff0c\u4ee5\u5b9e\u73b0\u5168\u9762\u7684\u76d1\u63a7\u89e3\u51b3\u65b9\u6848\u3002</p> <p>Grafana\uff1a \u7528\u4e8e\u6570\u636e\u7684\u53ef\u89c6\u5316\u3002Prometheus \u63d0\u4f9b\u7684\u65f6\u5e8f\u6570\u636e\u53ef\u4ee5\u901a\u8fc7 Grafana \u8fdb\u884c\u56fe\u8868\u5316\u5c55\u793a\uff0cGrafana \u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u4eea\u8868\u677f\u548c\u81ea\u5b9a\u4e49\u89c6\u56fe\uff0c\u7528\u4e8e\u5b9e\u65f6\u76d1\u63a7\u6570\u636e</p> <p>\u96c6\u6210\u65b9\u5f0f\uff1a Grafana \u53ef\u4ee5\u4f5c\u4e3a Prometheus \u7684\u6570\u636e\u6e90\uff0c\u4f7f\u7528 PromQL \u67e5\u8be2 Prometheus \u5b58\u50a8\u7684\u65f6\u5e8f\u6570\u636e\u5e76\u8fdb\u884c\u53ef\u89c6\u5316</p> <p>Alertmanager\uff1a \u8d1f\u8d23 Prometheus \u751f\u6210\u7684\u8b66\u62a5\u3002Alertmanager \u53ef\u4ee5\u5bf9\u544a\u8b66\u8fdb\u884c\u805a\u5408\u3001\u5206\u7ec4\u3001\u6291\u5236\u7b49\u64cd\u4f5c\uff0c\u5e76\u53d1\u9001\u901a\u77e5\uff08\u5982\u901a\u8fc7\u90ae\u4ef6\u3001Slack\u3001PagerDuty \u7b49</p> <p>\u96c6\u6210\u65b9\u5f0f\uff1a Prometheus \u5c06\u89e6\u53d1\u7684\u62a5\u8b66\u53d1\u9001\u5230 Alertmanager\uff0cAlertmanager \u8fdb\u4e00\u6b65\u5904\u7406\u5e76\u901a\u77e5\u7528\u6237\u3002</p>"},{"location":"2025/6monitor/#12-prometheus","title":"12 \u4ec0\u4e48\u662f Prometheus \u7684\u6570\u636e\u6a21\u578b\uff1f","text":"<p>Prometheus \u7684\u6570\u636e\u6a21\u578b\u662f\u4ee5 \u65f6\u5e8f\u6570\u636e\uff08Time Series\uff09\u4e3a\u6838\u5fc3\u7684\u3002\u65f6\u5e8f\u6570\u636e\u7531 \u6307\u6807\uff08Metric\uff09\u548c\u65f6\u95f4\u6233\u7ec4\u6210\uff0c\u6bcf\u4e2a\u6307\u6807\u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u7684\u540d\u79f0\u548c\u76f8\u5173\u7684\u6807\u7b7e\uff08labels\uff09</p> <ul> <li>Metric\uff08\u6307\u6807\uff09\uff1a \u4e00\u4e2a\u6570\u636e\u70b9\uff0c\u8868\u793a\u67d0\u4e2a\u65f6\u95f4\u70b9\u7684\u67d0\u79cd\u5ea6\u91cf\uff08\u5982 CPU \u4f7f\u7528\u7387\u3001\u5185\u5b58\u5360\u7528\uff09\u3002</li> <li>Labels\uff08\u6807\u7b7e\uff09\uff1a \u7528\u6765\u533a\u5206\u4e0d\u540c\u7ef4\u5ea6\u7684\u6307\u6807\u3002\u4f8b\u5982\uff0cinstance=\"localhost\" \u6216 job=\"nginx\" \u53ef\u4ee5\u4f5c\u4e3a\u6807\u7b7e\u6765\u63cf\u8ff0\u4e0d\u540c\u7684\u5ea6\u91cf\u6765\u6e90\u3002</li> <li>Time Series\uff08\u65f6\u5e8f\u6570\u636e\uff09\uff1a \u7531\u6307\u6807\u540d\u79f0\u548c\u6807\u7b7e\u7ec4\u5408\u6807\u8bc6\uff0c\u6bcf\u4e2a\u65f6\u5e8f\u6570\u636e\u70b9\u90fd\u6709\u4e00\u4e2a\u65f6\u95f4\u6233\u548c\u6570\u503c\u3002</li> </ul>"},{"location":"2025/6monitor/#13-prometheus-scraping","title":"13. Prometheus \u7684\u6570\u636e\u6293\u53d6\uff08Scraping\uff09\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff1f","text":"<p>Prometheus \u4f7f\u7528 Pull \u6a21\u578b \u6765\u6293\u53d6\u6570\u636e\uff0c\u5b83\u5b9a\u671f\u4ece\u914d\u7f6e\u597d\u7684\u76ee\u6807\uff08\u5982\u5e94\u7528\u7a0b\u5e8f\u3001\u4e3b\u673a\u6216\u5bb9\u5668\uff09\u62c9\u53d6\u65f6\u5e8f\u6570\u636e\u3002\u6570\u636e\u6293\u53d6\u7684\u6d41\u7a0b\u5982\u4e0b</p> <ol> <li>\u914d\u7f6e\u76ee\u6807\uff1a \u901a\u8fc7\u914d\u7f6e\u6587\u4ef6 prometheus.yml\uff0c\u5b9a\u4e49\u9700\u8981\u6293\u53d6\u6570\u636e\u7684\u76ee\u6807\uff08\u4f8b\u5982\uff0c\u5e94\u7528\u7a0b\u5e8f\u7684\u7aef\u70b9\u3001Node Exporter\u3001Kubernetes \u7b49\uff09\u3002</li> <li>Scraping\uff1a Prometheus \u4f1a\u6309\u7167\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\uff08\u901a\u5e38\u4e3a\u6bcf 15 \u79d2\uff09\u5b9a\u671f\u8bbf\u95ee\u8fd9\u4e9b\u76ee\u6807\u7684 /metrics \u7aef\u70b9\uff0c\u62c9\u53d6\u6700\u65b0\u7684\u6307\u6807\u6570\u636e\u3002</li> <li>\u6570\u636e\u5b58\u50a8\uff1a \u62c9\u53d6\u7684\u6570\u636e\u88ab\u5b58\u50a8\u5728 Prometheus \u7684\u672c\u5730\u65f6\u5e8f\u6570\u636e\u5e93\u4e2d\uff0c\u5e76\u6309\u65f6\u95f4\u6233\u3001\u6307\u6807\u540d\u79f0\u548c\u6807\u7b7e\u7d22\u5f15</li> </ol>"},{"location":"2025/6monitor/#14-promql","title":"14. \u4ec0\u4e48\u662f PromQL\uff1f\u5b83\u7684\u4e3b\u8981\u7528\u9014\u662f\u4ec0\u4e48\uff1f","text":"<p>PromQL\uff08Prometheus Query Language\uff09\u662f Prometheus \u63d0\u4f9b\u7684\u67e5\u8be2\u8bed\u8a00\uff0c\u7528\u4e8e\u4ece\u65f6\u5e8f\u6570\u636e\u5e93\u4e2d\u63d0\u53d6\u548c\u5904\u7406\u6570\u636e\u3002</p> <p>\u4e3b\u8981\u7528\u9014\uff1a</p> <ul> <li>\u6570\u636e\u67e5\u8be2\uff1a PromQL \u5141\u8bb8\u7528\u6237\u57fa\u4e8e\u6307\u6807\u540d\u79f0\u3001\u6807\u7b7e\u3001\u65f6\u95f4\u533a\u95f4\u7b49\u6761\u4ef6\u8fdb\u884c\u7075\u6d3b\u7684\u67e5\u8be2\u3002</li> <li>\u805a\u5408\u548c\u8ba1\u7b97\uff1a \u652f\u6301\u5bf9\u67e5\u8be2\u7ed3\u679c\u8fdb\u884c\u805a\u5408\uff08\u5982\u6c42\u548c\u3001\u5e73\u5747\u3001\u6700\u5927\u503c\u3001\u6700\u5c0f\u503c\uff09\u4ee5\u53ca\u8ba1\u7b97\uff08\u5982\u6bd4\u7387\u3001\u53d8\u5316\u7387\u7b49\uff09\u3002</li> <li>\u6570\u636e\u53ef\u89c6\u5316\uff1a PromQL \u67e5\u8be2\u7ed3\u679c\u53ef\u7528\u4e8e\u751f\u6210\u56fe\u8868\uff0c\u6216\u8005\u901a\u8fc7 Grafana \u8fdb\u884c\u5c55\u793a\u3002</li> <li>\u62a5\u8b66\u89c4\u5219\uff1a \u5728 Prometheus \u4e2d\uff0c\u62a5\u8b66\u89c4\u5219\u662f\u57fa\u4e8e PromQL \u7f16\u5199\u7684\uff0c\u544a\u8b66\u4f1a\u5728\u6ee1\u8db3\u67e5\u8be2\u6761\u4ef6\u65f6\u89e6\u53d1\u3002</li> </ul>"},{"location":"2025/6monitor/#15-prometheus","title":"15 Prometheus \u5982\u4f55\u5904\u7406\u9ad8\u53ef\u7528\u6027\uff1f","text":"<p>Prometheus \u672c\u8eab\u5e76\u4e0d\u5185\u7f6e\u9ad8\u53ef\u7528\u6027\u673a\u5236\uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u5b9e\u73b0\u9ad8\u53ef\u7528\u6027\uff1a</p> <ul> <li>\u591a\u5b9e\u4f8b\u914d\u7f6e\uff1a \u901a\u8fc7\u90e8\u7f72\u591a\u4e2a Prometheus \u5b9e\u4f8b\uff0c\u6bcf\u4e2a\u5b9e\u4f8b\u90fd\u6293\u53d6\u76f8\u540c\u7684\u6570\u636e\u6e90\u3002\u4e3a\u4e86\u907f\u514d\u91cd\u590d\u62a5\u8b66\u548c\u5b58\u50a8\u6570\u636e\uff0c\u53ef\u4ee5\u914d\u7f6e Prometheus \u7684 federation\uff08\u8054\u90a6\uff09\u548c Alertmanager \u6765\u6574\u5408\u591a\u4e2a\u5b9e\u4f8b\u7684\u6570\u636e\u548c\u8b66\u62a5\u3002</li> <li>\u8de8\u533a\u57df\u5197\u4f59\uff1a \u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u90e8\u7f72\u591a\u4e2a Prometheus \u5b9e\u4f8b\uff0c\u5c06\u4e0d\u540c\u533a\u57df\u7684\u6307\u6807\u805a\u5408\u5230\u4e00\u4e2a\u4e3b Prometheus \u5b9e\u4f8b\u4e2d\u3002</li> <li>\u6570\u636e\u5907\u4efd\uff1a \u901a\u8fc7\u5907\u4efd\u548c\u6062\u590d\u7b56\u7565\uff0c\u786e\u4fdd Prometheus \u6570\u636e\u7684\u5b89\u5168\u3002</li> </ul>"},{"location":"2025/6monitor/#16-prometheus","title":"16. \u5982\u4f55\u4f18\u5316 Prometheus \u7684\u6027\u80fd\uff0c\u7279\u522b\u662f\u5728\u5904\u7406\u5927\u91cf\u6307\u6807\u65f6\uff1f","text":"<p>\u4f18\u5316 Prometheus \u6027\u80fd\u65f6\uff0c\u53ef\u4ee5\u4ece\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u5165\u624b\uff1a</p> <ul> <li>\u6570\u636e\u538b\u7f29\uff1a Prometheus \u5bf9\u5b58\u50a8\u7684\u6570\u636e\u8fdb\u884c\u538b\u7f29\uff0c\u53ef\u4ee5\u8282\u7701\u5b58\u50a8\u7a7a\u95f4\u5e76\u63d0\u9ad8\u5b58\u53d6\u6548\u7387\u3002</li> <li>\u5408\u7406\u914d\u7f6e\u6293\u53d6\u9891\u7387\uff1a \u6839\u636e\u9700\u6c42\u5408\u7406\u914d\u7f6e\u6293\u53d6\u9891\u7387\u3002\u5982\u679c\u67d0\u4e9b\u6570\u636e\u4e0d\u9700\u8981\u9891\u7e41\u91c7\u96c6\uff0c\u53ef\u4ee5\u5c06\u91c7\u96c6\u9891\u7387\u964d\u4f4e\uff0c\u51cf\u5c11\u7cfb\u7edf\u8d1f\u8f7d\u3002</li> <li>\u5b58\u50a8\u5206\u533a\u548c\u9650\u5236\u6570\u636e\u4fdd\u7559\uff1a \u901a\u8fc7\u914d\u7f6e Prometheus \u7684\u5b58\u50a8\u7b56\u7565\uff08\u5982\u6570\u636e\u4fdd\u7559\u65f6\u95f4\u3001\u5b58\u50a8\u6587\u4ef6\u5927\u5c0f\uff09\u6765\u9650\u5236\u4e0d\u5fc5\u8981\u7684\u8001\u65e7\u6570\u636e\u5360\u7528\u5b58\u50a8\u7a7a\u95f4\u3002</li> <li>\u5916\u90e8\u5b58\u50a8\u89e3\u51b3\u65b9\u6848\uff1a \u5bf9\u4e8e\u957f\u671f\u5b58\u50a8\u548c\u9ad8\u5bb9\u91cf\u6570\u636e\uff0c\u53ef\u4ee5\u5c06\u6570\u636e\u8fc1\u79fb\u5230\u5916\u90e8\u5b58\u50a8\u7cfb\u7edf\uff08\u5982 Thanos\u3001Cortex\u3001 GreptimeDB \u7b49\u7b49\uff09\uff0c\u8fd9\u53ef\u4ee5\u63d0\u9ad8 Prometheus \u7684\u53ef\u6269\u5c55\u6027</li> </ul>"},{"location":"2025/6monitor/#17-prometheus-nagios-zabbix","title":"17. Prometheus \u4e0e\u5176\u4ed6\u76d1\u63a7\u5de5\u5177\uff08\u5982 Nagios \u6216 Zabbix\uff09\u6709\u4f55\u4e0d\u540c\uff1f","text":"<ul> <li>\u67b6\u6784\uff1a Prometheus \u57fa\u4e8e Pull \u6a21\u5f0f\uff08\u4e3b\u52a8\u62c9\u53d6\u6570\u636e\uff09\uff0c\u800c Nagios \u548c Zabbix \u901a\u5e38\u57fa\u4e8e Push \u6a21\u5f0f\uff08\u88ab\u52a8\u63a5\u6536\u6570\u636e\uff09\u3002</li> <li>\u6570\u636e\u5b58\u50a8\uff1a Prometheus \u4f7f\u7528\u65f6\u5e8f\u6570\u636e\u5e93\u6765\u5b58\u50a8\u6570\u636e\uff0c\u7279\u522b\u9002\u5408\u76d1\u63a7\u548c\u5206\u6790\u6307\u6807\u6570\u636e\uff0c\u800c Nagios \u548c Zabbix \u4f7f\u7528\u4f20\u7edf\u7684\u6570\u636e\u5e93\u7ba1\u7406\u6570\u636e\u3002</li> <li>\u7075\u6d3b\u6027\uff1a Prometheus \u63d0\u4f9b\u5f3a\u5927\u7684\u67e5\u8be2\u8bed\u8a00 PromQL\uff0c\u80fd\u591f\u8fdb\u884c\u590d\u6742\u7684\u6570\u636e\u805a\u5408\u548c\u5206\u6790\uff0c\u800c Nagios \u548c Zabbix \u66f4\u4fa7\u91cd\u4e8e\u544a\u8b66\u7ba1\u7406\u548c\u4e8b\u4ef6\u5904\u7406\u3002</li> <li>\u6269\u5c55\u6027\uff1a Prometheus \u8bbe\u8ba1\u4e0a\u66f4\u9002\u5408\u4e91\u539f\u751f\u548c\u5fae\u670d\u52a1\u67b6\u6784\uff0c\u652f\u6301\u591a\u79cd\u63d2\u4ef6\u548c\u4e0e Kubernetes\u3001Docker \u7b49\u5de5\u5177\u7684\u96c6\u6210\uff0c\u800c Nagios \u548c Zabbix \u66f4\u9002\u5408\u4f20\u7edf\u7684 IT \u57fa\u7840\u8bbe\u65bd\u3002</li> </ul>"},{"location":"2025/6monitor/#18-prometheus-exporters","title":"18. \u4ec0\u4e48\u662f Prometheus \u7684 Exporters\uff1f","text":"<p>Exporters \u662f\u7528\u4e8e\u66b4\u9732\u5e94\u7528\u7a0b\u5e8f\u6216\u57fa\u7840\u8bbe\u65bd\u7684\u76d1\u63a7\u6307\u6807\u7684\u7ec4\u4ef6\u3002Prometheus \u901a\u8fc7 Scraping \u6765\u83b7\u53d6\u8fd9\u4e9b Exporters \u66b4\u9732\u7684\u6307\u6807\u6570\u636e</p> <p>\u5e38\u89c1 Exporters\uff1a</p> <ul> <li>Node Exporter\uff1a \u7528\u4e8e\u66b4\u9732 Linux \u4e3b\u673a\u7684\u786c\u4ef6\u548c\u64cd\u4f5c\u7cfb\u7edf\u6307\u6807\uff0c\u5982 CPU\u3001\u5185\u5b58\u3001\u78c1\u76d8\u3001\u7f51\u7edc\u7b49\u3002</li> <li>Blackbox Exporter\uff1a \u7528\u4e8e\u5bf9\u5916\u90e8\u670d\u52a1\u8fdb\u884c\u53ef\u7528\u6027\u76d1\u63a7\uff0c\u5982 HTTP\u3001TCP\u3001DNS \u7b49\u534f\u8bae\u3002</li> <li>MySQL Exporter\uff1a \u7528\u4e8e\u66b4\u9732 MySQL \u6570\u636e\u5e93\u7684\u6307\u6807\uff0c\u5982\u67e5\u8be2\u6570\u3001\u8fde\u63a5\u6570\u3001\u7f13\u5b58\u547d\u4e2d\u7387\u7b49\u3002</li> <li>Docker Exporter\uff1a \u7528\u4e8e\u66b4\u9732 Docker \u5bb9\u5668\u7684\u76d1\u63a7\u6307\u6807</li> </ul> <p>Exporters \u63d0\u4f9b\u4e86\u4e0e Prometheus \u517c\u5bb9\u7684 /metrics \u7aef\u70b9\uff0cPrometheus \u4f1a\u5b9a\u671f\u6293\u53d6\u8fd9\u4e9b\u7aef\u70b9\u5e76\u6536\u96c6\u6570\u636e\u3002</p>"},{"location":"2025/6monitor/#19-prometheus","title":"19. Prometheus \u751f\u6001\u7cfb\u7edf\u5305\u62ec\u54ea\u4e9b\u5de5\u5177\uff1f\u5b83\u4eec\u7684\u4f5c\u7528\u662f\u4ec0\u4e48\uff1f","text":"<p>Prometheus \u751f\u6001\u7cfb\u7edf\u5305\u62ec\u591a\u4e2a\u5de5\u5177\uff0c\u6bcf\u4e2a\u5de5\u5177\u8d1f\u8d23\u76d1\u63a7\u3001\u5b58\u50a8\u3001\u544a\u8b66\u3001\u53ef\u89c6\u5316\u7b49\u4e0d\u540c\u4efb\u52a1\u3002\u5e38\u89c1\u7684\u5de5\u5177\u5305\u62ec\uff1a</p> <ul> <li>Prometheus\uff1a \u7528\u4e8e\u6570\u636e\u6536\u96c6\u548c\u5b58\u50a8\uff0c\u4e13\u6ce8\u4e8e\u65f6\u5e8f\u6570\u636e\u3002</li> <li>Grafana\uff1a \u7528\u4e8e\u6570\u636e\u53ef\u89c6\u5316\uff0c\u5c55\u793a Prometheus \u6536\u96c6\u7684\u6307\u6807\u6570\u636e\uff0c\u521b\u5efa\u81ea\u5b9a\u4e49\u4eea\u8868\u76d8\u3002</li> <li>Alertmanager\uff1a \u7ba1\u7406 Prometheus \u4e2d\u7684\u544a\u8b66\uff0c\u63d0\u4f9b\u544a\u8b66\u53bb\u91cd\u3001\u6291\u5236\u3001\u901a\u77e5\u7b49\u529f\u80fd\u3002</li> <li>Prometheus Exporters\uff1a \u7528\u4e8e\u5c06\u7279\u5b9a\u5e94\u7528\u6216\u786c\u4ef6\u7684\u6307\u6807\u66b4\u9732\u7ed9 Prometheus\u3002<ul> <li>\u4f8b\u5982\uff0c<code>node_exporter</code>\u7528\u4e8e\u66b4\u9732\u64cd\u4f5c\u7cfb\u7edf\u6307\u6807\uff0c</li> <li><code>blackbox_exporter</code> \u7528\u4e8e\u670d\u52a1\u53ef\u7528\u6027\u76d1\u63a7\u3002</li> </ul> </li> <li>Thanos\uff1a \u63d0\u4f9b Prometheus \u6570\u636e\u7684\u957f\u671f\u5b58\u50a8\u548c\u9ad8\u53ef\u7528\u6027\u652f\u6301\uff0c\u6269\u5c55 Prometheus \u7684\u5b58\u50a8\u80fd\u529b\u3002</li> <li>Cortex\uff1a \u4e00\u4e2a\u5206\u5e03\u5f0f Prometheus \u540e\u7aef\uff0c\u652f\u6301 Prometheus \u6570\u636e\u7684\u957f\u671f\u5b58\u50a8\u548c\u67e5\u8be2\u3002</li> <li>Alertmanager\uff1a \u8d1f\u8d23\u63a5\u6536 Prometheus \u7684\u544a\u8b66\u5e76\u5c06\u5176\u8f6c\u53d1\u5230\u901a\u77e5\u7cfb\u7edf\uff08\u5982\u90ae\u4ef6\u3001Slack\u3001PagerDuty \u7b49\uff09\u3002</li> </ul>"},{"location":"2025/6monitor/#20-prometheus-thanos-cortex","title":"20. Prometheus \u4e0e Thanos \u548c Cortex \u7684\u5173\u7cfb\u662f\u4ec0\u4e48\uff1f","text":"<p>Thanos \u548c Cortex \u90fd\u662f Prometheus \u7684\u6269\u5c55\u5de5\u5177\uff0c\u4e3b\u8981\u7528\u4e8e\u89e3\u51b3 Prometheus \u7684\u957f\u671f\u5b58\u50a8 \u548c \u591a\u96c6\u7fa4\u67e5\u8be2 \u95ee\u9898\u3002</p> <ul> <li>Thanos\uff1a \u901a\u8fc7\u5c06\u591a\u4e2a Prometheus \u5b9e\u4f8b\u7684\u6570\u636e\u96c6\u4e2d\u5b58\u50a8\uff0c\u63d0\u4f9b\u4e86 \u5168\u7403\u67e5\u8be2\u3001\u6301\u4e45\u5316\u5b58\u50a8 \u548c \u9ad8\u53ef\u7528\u6027 \u652f\u6301\u3002\u5b83\u5141\u8bb8\u7528\u6237\u67e5\u8be2\u8de8\u591a\u4e2a Prometheus \u5b9e\u4f8b\u7684\u5386\u53f2\u6570\u636e\uff0c\u5e76\u5c06 Prometheus \u7684\u6570\u636e\u5b58\u50a8\u80fd\u529b\u6269\u5c55\u5230\u957f\u671f\u5b58\u50a8\u3002</li> <li>Cortex\uff1a \u662f\u4e00\u4e2a\u5206\u5e03\u5f0f Prometheus \u540e\u7aef\uff0c\u652f\u6301\u8de8\u591a\u4e2a\u96c6\u7fa4\u5b58\u50a8\u548c\u67e5\u8be2 Prometheus \u6570\u636e\u3002<ul> <li>\u5b83\u5b9e\u73b0\u4e86 Prometheus \u7684 \u591a\u79df\u6237\u652f\u6301 \u548c \u53ef\u6269\u5c55\u6027\uff0c\u9002\u7528\u4e8e\u5927\u89c4\u6a21\u7684\u4e91\u539f\u751f\u73af\u5883\u3002</li> </ul> </li> </ul>"},{"location":"2025/6monitor/#21-prometheus-labels","title":"21. Prometheus \u4e2d\u7684\u6807\u7b7e\uff08Labels\uff09\u6709\u4ec0\u4e48\u4f5c\u7528\uff1f","text":"<p>\u6807\u7b7e\u662f Prometheus \u7528\u4e8e\u533a\u5206\u540c\u4e00\u65f6\u5e8f\u6570\u636e\u4e0d\u540c\u7ef4\u5ea6\u7684\u6807\u8bc6\u7b26\u3002\u6bcf\u4e2a\u65f6\u5e8f\u6570\u636e\u90fd\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u6807\u7b7e\uff0c\u6807\u7b7e\u53ef\u4ee5\u7528\u6765\u533a\u5206\u76f8\u540c\u6307\u6807\u7684\u4e0d\u540c\u5b9e\u4f8b\uff0c\u4f8b\u5982\uff1a</p> <ul> <li><code>http_requests_total{method=\"GET\", status=\"200\"}</code> \u8868\u793a HTTP \u8bf7\u6c42\u603b\u6570\uff0c\u5176\u4e2d method \u548c status \u662f\u6807\u7b7e\uff0c\u7528\u4e8e\u533a\u5206\u4e0d\u540c\u7684\u8bf7\u6c42\u7c7b\u578b\u3002</li> <li>\u6807\u7b7e\u53ef\u4ee5\u5e2e\u52a9\u7528\u6237\u6839\u636e\u4e0d\u540c\u7ef4\u5ea6\u7b5b\u9009\u548c\u805a\u5408\u6570\u636e\uff0c\u8fdb\u884c\u66f4\u7cbe\u786e\u7684\u76d1\u63a7\u548c\u5206\u6790</li> </ul>"},{"location":"2025/6monitor/#22-prometheus","title":"22. Prometheus \u652f\u6301\u54ea\u4e9b\u6570\u636e\u5b58\u50a8\u540e\u7aef\uff1f","text":"<p>Prometheus \u9ed8\u8ba4\u4f7f\u7528\u672c\u5730\u5b58\u50a8\u6765\u5b58\u50a8\u65f6\u5e8f\u6570\u636e\u3002\u7136\u800c\uff0c\u5bf9\u4e8e\u957f\u671f\u5b58\u50a8\u6216\u9ad8\u53ef\u7528\u6027\u7684\u9700\u6c42\uff0cPrometheus \u652f\u6301\u901a\u8fc7\u4ee5\u4e0b\u540e\u7aef\u6269\u5c55</p> <ul> <li>Thanos\uff1a \u63d0\u4f9b\u6301\u4e45\u5316\u5b58\u50a8\u548c\u9ad8\u53ef\u7528\u6027\u652f\u6301\uff0c\u9002\u5408\u5927\u89c4\u6a21\u5206\u5e03\u5f0f\u7cfb\u7edf\u3002</li> <li>Cortex\uff1a \u5206\u5e03\u5f0f\u7684 Prometheus \u5b58\u50a8\u89e3\u51b3\u65b9\u6848\uff0c\u652f\u6301\u8de8\u591a\u4e2a\u96c6\u7fa4\u7684\u6570\u636e\u5b58\u50a8\u548c\u67e5\u8be2\u3002</li> <li>InfluxDB\uff1a \u53ef\u4ee5\u5c06 Prometheus \u7684\u65f6\u5e8f\u6570\u636e\u63a8\u9001\u5230 InfluxDB \u8fdb\u884c\u957f\u671f\u5b58\u50a8\u3002</li> <li>GreptimeDB\uff1a \u4e00\u4e2a\u65b0\u5174\u7684\u4e91\u539f\u751f\u65f6\u5e8f\u6570\u636e\u5e93\uff0c\u5927\u5bb6\u53ef\u4ee5\u5c1d\u8bd5\u4e0b\uff0c\u5f88\u4e0d\u9519\u3002</li> </ul>"},{"location":"2025/6monitor/#23-prometheus-promql","title":"23. \u4ec0\u4e48\u662f Prometheus \u67e5\u8be2\u8bed\u8a00\uff08PromQL\uff09\uff1f\u4e3e\u4f8b\u8bf4\u660e\u3002","text":"<p>PromQL \u662f Prometheus \u7684\u67e5\u8be2\u8bed\u8a00\uff0c\u7528\u4e8e\u4ece\u65f6\u5e8f\u6570\u636e\u5e93\u4e2d\u63d0\u53d6\u3001\u805a\u5408\u3001\u8fc7\u6ee4\u6570\u636e\u3002\u5b83\u652f\u6301\u57fa\u672c\u7684\u6570\u5b66\u8fd0\u7b97\u3001\u805a\u5408\u51fd\u6570\u548c\u65f6\u95f4\u8303\u56f4\u9009\u62e9\u3002</p> <p>\u793a\u4f8b\uff1a</p> <ul> <li>\u67e5\u8be2\u8fc7\u53bb 5 \u5206\u949f\u5185 <code>http_requests_total</code> \u6307\u6807\u7684\u5e73\u5747\u503c\uff1a<code>avg(http_requests_total[5m])</code> \u2022 \u67e5\u8be2\u72b6\u6001\u4e3a 200 \u7684\u8bf7\u6c42\u603b\u6570\uff1a<code>http_requests_total{status=\"200\"}</code> \u2022 \u67e5\u8be2 1 \u5206\u949f\u5185 <code>cpu_usage</code> \u7684 rate\uff1a<code>rate(cpu_usage[1m])</code></li> </ul>"},{"location":"2025/6monitor/#24","title":"24. \u5982\u4f55\u907f\u514d\u544a\u8b66\u98ce\u66b4\uff1f","text":"<ul> <li>\u5206\u7ec4\uff08Grouping\uff09\uff1a \u5408\u5e76\u76f8\u4f3c\u544a\u8b66\uff08\u5982\u6309\u670d\u52a1\u5206\u7ec4\uff09\u3002</li> <li>\u6291\u5236\uff08Inhibition\uff09\uff1a \u4e3b\u544a\u8b66\u89e6\u53d1\u65f6\u6291\u5236\u76f8\u5173\u5b50\u544a\u8b66\u3002</li> <li>\u9759\u9ed8\uff08Silences\uff09\uff1a \u4e34\u65f6\u5c4f\u853d\u9884\u671f\u5185\u7684\u544a\u8b66\uff08\u5982\u7ef4\u62a4\u7a97\u53e3\uff09\u3002</li> </ul>"},{"location":"2025/6monitor/#25-prometheus","title":"25. Prometheus \u5b58\u50a8\u6570\u636e\u6709\u54ea\u4e9b\u4f18\u5316\u7b56\u7565\uff1f","text":"<ul> <li>\u538b\u7f29\uff08Compaction\uff09\uff1a \u5408\u5e76\u5c0f\u5757\u6570\u636e\u4e3a\u66f4\u5927\u5757\uff0c\u51cf\u5c11\u67e5\u8be2\u5f00\u9500\u3002</li> <li>\u964d\u91c7\u6837\uff08Downsampling\uff09\uff1a \u957f\u671f\u6570\u636e\u4fdd\u7559\u4f4e\u7cbe\u5ea6\u6837\u672c\uff08\u5982 1 \u5c0f\u65f6\u7c92\u5ea6\uff09\u3002</li> <li>\u8c03\u6574\u4fdd\u7559\u65f6\u95f4\uff1a \u6839\u636e\u9700\u6c42\u8bbe\u7f6e <code>--storage.tsdb.retention.time</code>\uff08\u9ed8\u8ba4 15 \u5929\uff09\u3002</li> </ul>"},{"location":"2025/6monitor/#26-prometheus-pull-push","title":"26. Prometheus \u7684 Pull \u6a21\u578b\u4e0e Push \u6a21\u578b\u6709\u4f55\u533a\u522b\uff1f\u9002\u7528\u573a\u666f\u662f\u4ec0\u4e48\uff1f","text":"<ul> <li>Pull\uff1a Prometheus \u4e3b\u52a8\u62c9\u53d6\u76ee\u6807\u66b4\u9732\u7684\u6307\u6807\uff08\u9ed8\u8ba4\u65b9\u5f0f\uff09\uff0c\u9002\u5408\u53ef\u63a7\u5185\u7f51\u73af\u5883\u3002</li> <li>Push\uff1a \u5e94\u7528\u4e3b\u52a8\u63a8\u9001\u6307\u6807\u5230 Pushgateway\uff08\u5982\u77ed\u6682\u4efb\u52a1\uff09\uff0c\u53ef\u80fd\u5f15\u5165\u5355\u70b9\u74f6\u9888\u3002</li> </ul>"},{"location":"2025/6monitor/#27-thanos-prometheus","title":"27 Thanos \u5982\u4f55\u89e3\u51b3 Prometheus \u7684\u957f\u671f\u5b58\u50a8\u95ee\u9898\uff1f","text":"<ul> <li>\u90e8\u7f72 DCGM Exporter \u6216 NVIDIA GPU Operator\uff0c\u66b4\u9732 GPU \u6307\u6807\u3002</li> <li>Prometheus \u6293\u53d6\u5bf9\u5e94\u6307\u6807\u5e76\u914d\u7f6e\u544a\u8b66\u89c4\u5219\u3002</li> </ul>"},{"location":"2025/6monitor/#28-prometheus-rate-irate","title":"28 \u89e3\u91ca Prometheus \u7684 <code>rate()</code> \u548c<code>irate()</code>\u51fd\u6570\u7684\u533a\u522b","text":"<ul> <li><code>rate()</code>\uff1a \u8ba1\u7b97\u65f6\u95f4\u8303\u56f4\u5185\u6bcf\u79d2\u5e73\u5747\u589e\u957f\u7387\uff08\u9002\u5408\u7f13\u6162\u53d8\u5316\u8ba1\u6570\u5668\uff09\u3002</li> <li><code>irate()</code>\uff1a \u57fa\u4e8e\u6700\u540e\u4e24\u4e2a\u6837\u672c\u8ba1\u7b97\u77ac\u65f6\u589e\u957f\u7387\uff08\u9002\u5408\u5feb\u901f\u53d8\u5316\u4f46\u53ef\u80fd\u4e22\u5931\u5cf0\u503c\uff09\u3002</li> </ul>"},{"location":"2025/6monitor/#29-prometheus-up-0","title":"29 Prometheus \u7684 up \u6307\u6807\u4e3a 0\uff0c\u5982\u4f55\u6392\u67e5\uff1f","text":"<ul> <li>\u68c0\u67e5\u76ee\u6807\u72b6\u6001\uff1a \u76ee\u6807\u670d\u52a1\u662f\u5426\u5b58\u6d3b\uff0c\u7aef\u53e3\u662f\u5426\u5f00\u653e\u3002</li> <li>\u7f51\u7edc\u8fde\u901a\u6027\uff1a Prometheus \u662f\u5426\u80fd\u8bbf\u95ee\u76ee\u6807\uff08\u9632\u706b\u5899\u3001DNS \u89e3\u6790\uff09\u3002</li> <li>\u6307\u6807\u8def\u5f84\uff1a \u68c0\u67e5 <code>metrics_path</code> \u914d\u7f6e\u662f\u5426\u6b63</li> </ul>"},{"location":"2025/6monitor/#30-alertmanager","title":"30 Alertmanager \u5982\u4f55\u5904\u7406\u544a\u8b66\uff1f\u652f\u6301\u54ea\u4e9b\u901a\u77e5\u65b9\u5f0f\uff1f","text":"<ul> <li>\u6d41\u7a0b\uff1a \u544a\u8b66\u89e6\u53d1 \u2192 \u5206\u7ec4 \u2192 \u6291\u5236 \u2192 \u9759\u9ed8 \u2192 \u53d1\u9001\u901a\u77e5\u3002</li> <li>\u652f\u6301\u65b9\u5f0f\uff1a Email\u3001Slack\u3001PagerDuty\u3001Webhook \u7b49\u3002</li> </ul>"},{"location":"2025/6monitor/#31-java","title":"31 \u5982\u4f55\u76d1\u63a7\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684 Java \u5e94\u7528\uff1f","text":"<ul> <li>\u66b4\u9732\u6307\u6807\uff1a \u96c6\u6210 Prometheus \u5ba2\u6237\u7aef\u5e93\uff08\u5982 micrometer\uff09\u66b4\u9732 <code>/actuator/prometheus</code> \u7aef\u70b9\u3002</li> <li>\u914d\u7f6e\u6293\u53d6\uff1a \u5728 Prometheus \u4e2d\u6dfb\u52a0\u5bf9\u5e94 Job\u3002</li> </ul>"},{"location":"2025/6monitor/#32-prometheus","title":"32. Prometheus \u7684\u5c40\u9650\u6027\u662f\u4ec0\u4e48\uff1f\u5982\u4f55\u5728\u5927\u89c4\u6a21\u573a\u666f\u4e0b\u66ff\u4ee3\u6216\u589e\u5f3a\uff1f","text":"<ul> <li>\u5c40\u9650\u6027\uff1a \u5355\u673a\u5b58\u50a8\u9650\u5236\u3001\u65e0\u539f\u751f\u957f\u671f\u5b58\u50a8\u3001\u9ad8\u57fa\u6570\u95ee\u9898\u3002</li> <li>\u589e\u5f3a\u65b9\u6848\uff1a Thanos/Cortex/GreptimeDB \u5b9e\u73b0\u6c34\u5e73\u6269\u5c55\uff0cVictoriaMetrics \u4f18\u5316\u5b58\u50a8\u6548\u7387\u3002</li> </ul>"},{"location":"2025/7cri/","title":"7 \u4ece\u5bb9\u5668\u5230\u8c03\u5ea6\uff1a\u51c6\u5907\u597d\u8fd9\u4e9b CRI \u9762\u8bd5\u9898","text":""},{"location":"2025/7cri/#1-cricontainer-runtime-interface","title":"1. \u4ec0\u4e48\u662f CRI\uff08Container Runtime Interface\uff09\uff1f","text":"<p>CRI\uff08Container Runtime Interface\uff09\u662f Kubernetes \u5b9a\u4e49\u7684\u4e00\u4e2a\u63a5\u53e3\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u5b9e\u73b0\u5bb9\u5668\u7684\u8fd0\u884c\u65f6\u62bd\u8c61\uff0c\u4f7f\u5f97 Kubernetes \u80fd\u591f\u652f\u6301\u591a\u79cd\u4e0d\u540c\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff08\u5982 Docker\u3001containerd\u3001CRI-O \u7b49\uff09\u3002</p> <p>CRI \u662f Kubernetes \u7684\u4e00\u4e2a\u5173\u952e\u7ec4\u4ef6\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u79cd\u6807\u51c6\u5316\u7684\u65b9\u5f0f\u6765\u8ba9 Kubernetes \u4e0e\u4e0d\u540c\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\u4ea4\u4e92\u3002</p> <ul> <li>\u5bb9\u5668\u8fd0\u884c\u65f6\uff08Container Runtime\uff09\uff1a \u8d1f\u8d23\u521b\u5efa\u548c\u7ba1\u7406\u5bb9\u5668\u7684\u7ec4\u4ef6\uff0c\u5b83\u76f4\u63a5\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u4ea4\u4e92\uff0c\u6267\u884c\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002</li> <li>CRI \u7684\u4f5c\u7528\uff1a \u901a\u8fc7\u5b9a\u4e49\u4e00\u4e2a\u7edf\u4e00\u7684\u63a5\u53e3\uff0c\u5141\u8bb8 Kubernetes \u4e0e\u5bb9\u5668\u8fd0\u884c\u65f6\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\u548c\u4ea4\u4e92\uff0c\u4ece\u800c\u652f\u6301\u4e0d\u540c\u7c7b\u578b\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\u3002</li> </ul>"},{"location":"2025/7cri/#2-cri","title":"2. CRI \u7684\u5e38\u89c1\u5b9e\u73b0\u6709\u54ea\u4e9b\uff1f","text":"<p>\u5e38\u89c1\u7684CRI\u5b9e\u73b0\u5305\u62ec\uff1a</p> <p>Docker\uff1a \u867d\u7136 Docker \u5728 Kubernetes \u4e2d\u88ab\u9010\u6e10\u66ff\u4ee3\uff0c\u4f46\u5b83\u66fe\u662f\u6700\u5e38\u7528\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\u4e4b\u4e00\u3002Docker \u652f\u6301\u901a\u8fc7 dockershim \u5b9e\u73b0\u4e0e Kubernetes \u7684 CRI \u517c\u5bb9\u3002</p> <p>containerd\uff1a \u8fd9\u662f\u4e00\u4e2a\u7531 Docker \u63d0\u4f9b\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u540e\u6210\u4e3a\u72ec\u7acb\u9879\u76ee\uff0c\u5e76\u6210\u4e3a Kubernetes \u63a8\u8350\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\u4e4b\u4e00\u3002\u5b83\u63d0\u4f9b\u4e86\u57fa\u7840\u7684\u5bb9\u5668\u751f\u547d\u5468\u671f\u7ba1\u7406\u529f\u80fd\uff0c\u5982\u5bb9\u5668\u7684\u521b\u5efa\u3001\u542f\u52a8\u3001\u505c\u6b62\u7b49</p> <p>CRI-O\uff1a \u8fd9\u662f\u4e00\u4e2a\u4e13\u95e8\u4e3a Kubernetes \u8bbe\u8ba1\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u9075\u5faa CRI \u89c4\u8303\u3002CRI-O \u901a\u8fc7\u63d0\u4f9b\u4e0e Kubernetes \u7684\u76f4\u63a5\u96c6\u6210\uff0c\u7b80\u5316\u4e86\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u529f\u80fd\uff0c\u53bb\u9664\u4e86 Docker \u4e2d\u7684\u8bb8\u591a\u975e\u5fc5\u9700\u529f\u80fd\u3002</p> <p>Frakti\uff1a \u8fd9\u662f\u4e00\u4e2a\u4e3a Kubernetes \u63d0\u4f9b\u5bb9\u5668\u548c\u865a\u62df\u673a\u652f\u6301\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u901a\u8fc7 KVM \u63d0\u4f9b\u865a\u62df\u5316\u652f\u6301\u3002</p>"},{"location":"2025/7cri/#3-cri-docker","title":"3. CRI \u4e0e Docker \u4e4b\u95f4\u7684\u5173\u7cfb\u662f\u4ec0\u4e48\uff1f","text":"<p>\u5728 Kubernetes \u4e2d\uff0cDocker \u4ee5\u524d\u901a\u8fc7 dockershim \u63d0\u4f9b\u4e86\u5bf9 CRI \u7684\u652f\u6301\uff0c\u4f46\u968f\u7740 Kubernetes 1.20 \u7248\u672c\u7684\u53d1\u5e03\uff0cDocker \u652f\u6301\u9010\u6e10\u88ab\u5f03\u7528\u3002</p> <p>\u539f\u56e0\u662f Docker \u4e0d\u5b8c\u5168\u7b26\u5408 Kubernetes \u5bf9\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u8981\u6c42\uff0c\u5c24\u5176\u662f\u5728\u6027\u80fd\u548c\u8d44\u6e90\u7ba1\u7406\u65b9\u9762\u7684\u7075\u6d3b\u6027\u3002Kubernetes \u63a8\u8350\u4f7f\u7528 containerd \u6216 CRI-O \u6765\u4f5c\u4e3a\u5bb9\u5668\u8fd0\u884c\u65f6\u3002</p> <p>dockershim\uff1a Kubernetes \u4f7f\u7528 dockershim \u5c06 Docker \u4e0e Kubernetes \u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u4f7f\u5f97 Kubernetes \u80fd\u591f\u901a\u8fc7 CRI \u4e0e Docker \u8fdb\u884c\u901a\u4fe1\u3002</p> <p>\u7136\u800c\uff0cdockershim \u5728 Kubernetes 1.24 \u4e2d\u88ab\u5b8c\u5168\u79fb\u9664\uff0c\u56e0\u6b64 Kubernetes \u73b0\u5728\u4e0d\u518d\u76f4\u63a5\u652f\u6301 Docker \u4f5c\u4e3a\u5bb9\u5668\u8fd0\u884c\u65f6\u3002</p> <p>containerd \u548c CRI-O\uff1a \u8fd9\u4e24\u4e2a\u5bb9\u5668\u8fd0\u884c\u65f6\u7b26\u5408 CRI \u89c4\u8303\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u4e0e Kubernetes \u8fdb\u884c\u96c6\u6210\u5e76\u4f5c\u4e3a\u5bb9\u5668\u8fd0\u884c\u65f6\u4f7f\u7528\u3002</p>"},{"location":"2025/7cri/#4-cri","title":"4. CRI \u7684\u5de5\u4f5c\u6d41\u7a0b\u662f\u600e\u6837\u7684\uff1f","text":"<ol> <li>Kubernetes \u8bf7\u6c42\u5bb9\u5668\u8fd0\u884c\u65f6\uff1a Kubernetes \u5411 CRI \u53d1\u51fa\u8bf7\u6c42\uff0c\u901a\u8fc7 CRI \u8c03\u7528\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u63a5\u53e3\uff08\u5982\u521b\u5efa\u3001\u542f\u52a8\u3001\u505c\u6b62\u5bb9\u5668\u7b49\uff09\u3002</li> <li>CRI \u8c03\u7528\u5bb9\u5668\u8fd0\u884c\u65f6 API\uff1a CRI \u901a\u8fc7\u5bb9\u5668\u8fd0\u884c\u65f6\u7684 API \u4e0e\u5bb9\u5668\u8fd0\u884c\u65f6\uff08\u5982 containerd \u6216 CRI-O\uff09\u8fdb\u884c\u4ea4\u4e92\uff0c\u7ba1\u7406\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\u3002</li> <li>\u5bb9\u5668\u8fd0\u884c\u65f6\u64cd\u4f5c\u7cfb\u7edf\uff1a \u5bb9\u5668\u8fd0\u884c\u65f6\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u6838\u8fdb\u884c\u4ea4\u4e92\uff0c\u76f4\u63a5\u7ba1\u7406\u5bb9\u5668\u7684\u8fdb\u7a0b\u548c\u8d44\u6e90\uff0c\u542f\u52a8\u548c\u505c\u6b62\u5bb9\u5668\u3002</li> <li>\u8fd4\u56de\u7ed3\u679c\u7ed9 Kubernetes\uff1a \u5bb9\u5668\u8fd0\u884c\u65f6\u5b8c\u6210\u4efb\u52a1\u540e\uff0c\u8fd4\u56de\u72b6\u6001\u6216\u6267\u884c\u7ed3\u679c\u7ed9 Kubernetes</li> </ol> <p>\u8fd9\u4e2a\u6d41\u7a0b\u786e\u4fdd\u4e86 Kubernetes \u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\u4e4b\u95f4\u8fdb\u884c\u65e0\u7f1d\u5207\u6362\u3002</p>"},{"location":"2025/7cri/#5-kubernetes-cri","title":"5. Kubernetes \u901a\u8fc7 CRI \u542f\u52a8\u5bb9\u5668\u65f6\uff0c\u54ea\u4e9b\u4fe1\u606f\u662f\u5fc5\u9700\u7684\uff1f","text":"<p>\u5f53 Kubernetes \u901a\u8fc7 CRI \u542f\u52a8\u5bb9\u5668\u65f6\uff0c\u5fc5\u987b\u63d0\u4f9b\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <ul> <li>\u5bb9\u5668\u955c\u50cf\uff1a \u5bb9\u5668\u8fd0\u884c\u65f6\u9700\u8981\u77e5\u9053\u8981\u62c9\u53d6\u5e76\u4f7f\u7528\u54ea\u4e2a\u955c\u50cf\u3002</li> <li>\u5bb9\u5668\u7684\u8d44\u6e90\u9700\u6c42\uff1a \u5305\u62ec CPU\u3001\u5185\u5b58\u7b49\u8d44\u6e90\u7684\u9650\u5236\u3002</li> <li>\u7f51\u7edc\u914d\u7f6e\uff1a \u5982\u5bb9\u5668\u7684 IP \u5730\u5740\u3001\u7aef\u53e3\u6620\u5c04\u7b49\u3002</li> <li>\u5b58\u50a8\u5377\uff1a \u5bb9\u5668\u53ef\u80fd\u9700\u8981\u6302\u8f7d\u4e00\u4e9b\u6301\u4e45\u5316\u5b58\u50a8\u5377\u3002</li> <li>\u547d\u4ee4\u548c\u53c2\u6570\uff1a \u5bb9\u5668\u542f\u52a8\u65f6\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\u548c\u53c2\u6570\u3002</li> <li>\u5bb9\u5668\u8fd0\u884c\u65f6\u914d\u7f6e\uff1a \u5982\u73af\u5883\u53d8\u91cf\u3001\u65e5\u5fd7\u3001PID \u63a7\u5236\u7b49\u914d\u7f6e\u9879\u3002</li> </ul>"},{"location":"2025/7cri/#6-cri","title":"6. CRI \u7684\u63a5\u53e3\u5305\u62ec\u54ea\u4e9b\u4e3b\u8981\u7684\u529f\u80fd\uff1f","text":"<p>CRI \u63d0\u4f9b\u4e86\u591a\u4e2a\u529f\u80fd\u63a5\u53e3\uff0c\u4e3b\u8981\u5305\u62ec</p> <p>\u5bb9\u5668\u521b\u5efa\u548c\u542f\u52a8\uff1a</p> <ul> <li>CreateContainer\uff1a\u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\u3002</li> <li>StartContainer\uff1a\u542f\u52a8\u4e00\u4e2a\u5df2\u7ecf\u521b\u5efa\u7684\u5bb9\u5668\u3002</li> </ul> <p>\u5bb9\u5668\u7ba1\u7406\uff1a</p> <ul> <li>StopContainer:  \u505c\u6b62\u4e00\u4e2a\u5bb9\u5668\u3002</li> <li>RemoveContainer: \u5220\u9664\u4e00\u4e2a\u5bb9\u5668\u3002</li> </ul> <p>\u5bb9\u5668\u72b6\u6001\u67e5\u8be2\uff1a</p> <ul> <li>ContainerStatus\uff1a \u83b7\u53d6\u5bb9\u5668\u7684\u5f53\u524d\u72b6\u6001</li> <li>ListContainers\uff1a\u5217\u51fa\u5f53\u524d\u6240\u6709\u8fd0\u884c\u7684\u5bb9\u5668\u3002</li> </ul> <p>\u5bb9\u5668\u65e5\u5fd7\uff1a</p> <p>ContainerLogs\uff1a\u83b7\u53d6\u5bb9\u5668\u7684\u65e5\u5fd7\u3002</p> <p>\u5bb9\u5668\u7684\u5065\u5eb7\u68c0\u67e5\uff1a</p> <ul> <li>UpdateContainerResources: \u66f4\u65b0\u5bb9\u5668\u7684\u8d44\u6e90\u914d\u7f6e\u3002</li> <li>ContainerStats\uff1a\u83b7\u53d6\u5bb9\u5668\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff0c\u5982CPU\u3001\u5185\u5b58\u3001\u78c1\u76d8\u7b49\u3002</li> </ul>"},{"location":"2025/7cri/#7-kubernetes","title":"7. Kubernetes \u652f\u6301\u54ea\u4e9b\u5bb9\u5668\u8fd0\u884c\u65f6\uff1f","text":"<p>Kubernetes \u652f\u6301\u591a\u79cd\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u4e3b\u8981\u5305\u62ec\uff1a</p> <ul> <li>Docker\uff08\u901a\u8fc7 dockershim\uff0c\u5df2\u9010\u6b65\u5f03\u7528\uff09</li> <li>containerd</li> <li>CRI-O</li> <li>Frakti\uff08\u652f\u6301\u865a\u62df\u673a\u5bb9\u5668\uff09</li> <li>gVisor\uff08\u63d0\u4f9b\u989d\u5916\u7684\u5b89\u5168\u6027\uff0c\u7c7b\u4f3c\u6c99\u7bb1\uff09</li> <li>Kata Containers\uff08\u901a\u8fc7\u865a\u62df\u5316\u5b9e\u73b0\u5bb9\u5668\uff09</li> </ul> <p>\u4ece Kubernetes 1.24 \u7248\u672c\u5f00\u59cb\uff0cDocker \u652f\u6301\u9010\u6e10\u88ab\u79fb\u9664\uff0cKubernetes \u63a8\u8350\u4f7f\u7528 containerd \u6216 CRI-O \u4f5c\u4e3a\u5bb9\u5668\u8fd0\u884c\u65f6\u3002</p>"},{"location":"2025/7cri/#8-kubernetes-docker","title":"8. \u4e3a\u4ec0\u4e48 Kubernetes \u4e0d\u518d\u63a8\u8350\u4f7f\u7528 Docker \u4f5c\u4e3a\u5bb9\u5668\u8fd0\u884c\u65f6\uff1f","text":"<p>Kubernetes \u4e0d\u518d\u63a8\u8350\u4f7f\u7528 Docker \u4f5c\u4e3a\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u4e3b\u8981\u539f\u56e0\u6709\uff1a</p> <ul> <li>\u6027\u80fd\u95ee\u9898\uff1a Docker \u5305\u542b\u4e86\u5f88\u591a\u4e0d\u5fc5\u8981\u7684\u529f\u80fd\uff0cKubernetes \u53ea\u9700\u8981\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u57fa\u7840\u529f\u80fd\uff0c\u5982\u5bb9\u5668\u7684\u521b\u5efa\u3001\u8fd0\u884c\u548c\u505c\u6b62\uff0c\u800c Docker \u63d0\u4f9b\u4e86\u5f88\u591a\u989d\u5916\u7684\u529f\u80fd\uff08\u5982\u6784\u5efa\u955c\u50cf\u3001\u7f51\u7edc\u914d\u7f6e\u7b49\uff09\uff0c\u8fd9\u589e\u52a0\u4e86 Kubernetes \u7684\u590d\u6742\u6027\u3002</li> <li>\u590d\u6742\u6027\uff1a Docker \u672c\u8eab\u5305\u542b\u5f88\u591a\u4e0e Kubernetes \u65e0\u5173\u7684\u7ec4\u4ef6\uff0c\u5982\u955c\u50cf\u6784\u5efa\u3001Docker CLI \u7b49\uff0cKubernetes \u53ea\u9700\u8981\u4e0e\u5bb9\u5668\u8fd0\u884c\u65f6\u4ea4\u4e92\u3002containerd \u548c CRI-O \u662f\u66f4\u52a0\u8f7b\u91cf\u548c\u4e13\u6ce8\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u5b83\u4eec\u53bb\u9664\u4e86\u4e0e\u5bb9\u5668\u7f16\u6392\u65e0\u5173\u7684\u90e8\u5206\uff0c\u66f4\u9002\u5408 Kubernetes \u7684\u9700\u6c42\u3002</li> <li>\u7ef4\u62a4\u95ee\u9898\uff1a Docker \u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u5bb9\u5668\u5e73\u53f0\uff0c\u5305\u542b\u4e86\u4ece\u6784\u5efa\u5230\u8fd0\u884c\u7684\u5b8c\u6574\u751f\u547d\u5468\u671f\uff0c\u800c containerd \u548c CRI-O \u4ec5\u4e13\u6ce8\u4e8e\u5bb9\u5668\u7684\u8fd0\u884c\u65f6\u90e8\u5206\uff0c\u907f\u514d\u4e86\u4e0d\u5fc5\u8981\u7684\u590d\u6742\u6027\u548c\u4f9d\u8d56</li> </ul>"},{"location":"2025/7cri/#9-cri-kubernetes-kubelet","title":"9. CRI \u662f\u5982\u4f55\u4e0e Kubernetes \u4e2d\u7684 kubelet \u4ea4\u4e92\u7684\uff1f","text":"<p>kubelet \u662f Kubernetes \u7684\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u8d1f\u8d23\u4e0e\u5bb9\u5668\u8fd0\u884c\u65f6\u4ea4\u4e92\uff0c\u786e\u4fdd\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002kubelet \u901a\u8fc7 CRI \u4e0e\u5bb9\u5668\u8fd0\u884c\u65f6\u8fdb\u884c\u901a\u4fe1\uff0c\u4ee5\u4e0b\u662f\u4ea4\u4e92\u8fc7\u7a0b\uff1a</p> <ol> <li>\u521b\u5efa\u5bb9\u5668\uff1a kubelet \u5411 CRI \u53d1\u8d77\u8bf7\u6c42\uff0c\u8981\u6c42\u521b\u5efa\u5bb9\u5668\u3002</li> <li>\u542f\u52a8\u5bb9\u5668\uff1a kubelet \u901a\u8fc7 CRI \u542f\u52a8\u5bb9\u5668\u5e76\u8fdb\u884c\u7ba1\u7406\u3002</li> <li>\u76d1\u63a7\u5bb9\u5668\uff1a kubelet \u901a\u8fc7 CRI \u83b7\u53d6\u5bb9\u5668\u7684\u72b6\u6001\u3001\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u7b49\u4fe1\u606f\u3002</li> <li>\u5bb9\u5668\u5065\u5eb7\u68c0\u67e5\uff1a kubelet \u53ef\u4ee5\u5b9a\u671f\u5411\u5bb9\u5668\u8fd0\u884c\u65f6\u8bf7\u6c42\u5bb9\u5668\u7684\u5065\u5eb7\u68c0\u67e5\u4fe1\u606f\uff0c\u5e76\u5728\u5bb9\u5668\u5931\u8d25\u65f6\u91c7\u53d6\u6062\u590d\u64cd\u4f5c\u3002</li> </ol> <p>kubelet \u4f5c\u4e3a Kubernetes \u8282\u70b9\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u5229\u7528 CRI \u6765\u5b9e\u73b0\u5bb9\u5668\u7684\u9ad8\u6548\u7ba1\u7406\u4e0e\u8c03\u5ea6\u3002</p>"},{"location":"2025/7cri/#10-cri-kubernetes-pod","title":"10. CRI \u662f\u5982\u4f55\u4e0e Kubernetes \u4e2d\u7684 Pod \u548c\u5bb9\u5668\u751f\u547d\u5468\u671f\u7ba1\u7406\u4ea4\u4e92\u7684\uff1f","text":"<p>CRI\uff08Container Runtime Interface\uff09\u4e0e Kubernetes \u4e2d\u7684 Pod \u548c\u5bb9\u5668\u751f\u547d\u5468\u671f\u7ba1\u7406\u7d27\u5bc6\u7ed3\u5408\u3002Kubernetes \u7684 kubelet \u901a\u8fc7 CRI \u4e0e\u5bb9\u5668\u8fd0\u884c\u65f6\u8fdb\u884c\u4ea4\u4e92\u6765\u7ba1\u7406\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\u3002\u4e3b\u8981\u4ea4\u4e92\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ul> <li>Pod \u521b\u5efa\uff1a kubelet \u901a\u8fc7 CRI \u8bf7\u6c42\u5bb9\u5668\u8fd0\u884c\u65f6\u521b\u5efa\u5bb9\u5668\u3002\u5bb9\u5668\u8fd0\u884c\u65f6\u4f1a\u6839\u636e Pod \u7684\u914d\u7f6e\u6587\u4ef6\uff08\u5982\u5bb9\u5668\u955c\u50cf\u3001\u8d44\u6e90\u9650\u5236\u7b49\uff09\u542f\u52a8\u5bb9\u5668\u3002</li> <li>\u5bb9\u5668\u542f\u52a8\uff1a \u4e00\u65e6 Pod \u88ab\u8c03\u5ea6\u5230\u8282\u70b9\uff0ckubelet \u4f1a\u8c03\u7528 CRI \u4e2d\u7684 CreateContainer \u548c StartContainer \u63a5\u53e3\u6765\u542f\u52a8\u5bb9\u5668\u3002</li> <li>\u8d44\u6e90\u7ba1\u7406\uff1a kubelet \u4f1a\u901a\u8fc7 CRI \u83b7\u53d6\u5bb9\u5668\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff08\u5982 CPU\u3001\u5185\u5b58\u7b49\uff09\uff0c\u5e76\u6839\u636e Pod \u7684\u8d44\u6e90\u8bf7\u6c42\u8fdb\u884c\u8c03\u5ea6\u548c\u9650\u5236\u3002</li> <li>\u5bb9\u5668\u505c\u6b62\u548c\u5220\u9664\uff1a kubelet \u4f1a\u901a\u8fc7 CRI \u8c03\u7528\u5bb9\u5668\u8fd0\u884c\u65f6\u7684 StopContainer \u548c RemoveContainer \u63a5\u53e3\uff0c\u505c\u6b62\u5e76\u5220\u9664\u5bb9\u5668\u3002</li> <li>\u5065\u5eb7\u68c0\u67e5\uff1a kubelet \u4f7f\u7528 CRI \u63a5\u53e3\u4e2d\u7684 ContainerStatus \u548c ContainerLogs \u6765\u83b7\u53d6\u5bb9\u5668\u7684\u5065\u5eb7\u72b6\u6001\uff0c\u5e76\u8fdb\u884c\u6545\u969c\u6062\u590d\u64cd\u4f5c\u3002</li> </ul>"},{"location":"2025/7cri/#11-cri-o-containerd-kubernetes","title":"11. CRI-O \u4e0e containerd \u4e4b\u95f4\u6709\u4ec0\u4e48\u533a\u522b\uff0c\u4e3a\u4ec0\u4e48 Kubernetes \u63a8\u8350\u4f7f\u7528\u5b83\u4eec\uff1f","text":"<p>CRI-O \u548c containerd \u90fd\u662f\u7b26\u5408 CRI \u89c4\u8303\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u5e38\u7528\u4e8e Kubernetes \u96c6\u7fa4\u4e2d\u3002\u5b83\u4eec\u7684\u4e3b\u8981\u533a\u522b\u548c Kubernetes \u63a8\u8350\u4f7f\u7528\u5b83\u4eec\u7684\u539f\u56e0\u5982\u4e0b</p>"},{"location":"2025/7cri/#cri-o","title":"CRI-O","text":"<ul> <li>\u4e13\u4e3a Kubernetes \u8bbe\u8ba1\uff0c\u9075\u5faa CRI \u6807\u51c6\u3002</li> <li>\u63d0\u4f9b\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u53bb\u9664\u4e86 Docker \u4e2d\u7684\u8bb8\u591a\u4e0d\u5fc5\u8981\u7684\u529f\u80fd\uff08\u5982\u6784\u5efa\u955c\u50cf\u3001\u7f51\u7edc\u8bbe\u7f6e\u7b49\uff09\u3002</li> <li>\u91cd\u70b9\u662f\u4e0e Kubernetes \u96c6\u6210\uff0c\u4fdd\u8bc1\u4e0e Kubernetes \u7684\u517c\u5bb9\u6027\u3002</li> </ul>"},{"location":"2025/7cri/#containerd","title":"containerd","text":"<ul> <li>\u7531 Docker \u63d0\u4f9b\u5e76\u6700\u521d\u662f Docker \u7684\u4e00\u90e8\u5206\uff0c\u540e\u6765\u6210\u4e3a\u72ec\u7acb\u7684\u9879\u76ee\u3002</li> <li>\u652f\u6301\u66f4\u591a\u7684\u529f\u80fd\uff0c\u5982\u955c\u50cf\u7ba1\u7406\u3001\u5bb9\u5668\u7ba1\u7406\u3001\u4efb\u52a1\u8c03\u5ea6\u7b49\uff0c\u652f\u6301\u5e7f\u6cdb\u7684\u5bb9\u5668\u5de5\u4f5c\u8d1f\u8f7d\u3002</li> <li>\u5bf9 Kubernetes \u4e5f\u6709\u826f\u597d\u7684\u652f\u6301\uff0c\u5e76\u4e14\u5728 Kubernetes 1.20 \u7248\u672c\u4e2d\uff0ccontainerd \u88ab\u63a8\u8350\u4f5c\u4e3a\u9ed8\u8ba4\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\u3002</li> </ul>"},{"location":"2025/7cri/#cri","title":"\u5e38\u89c1\u7684CRI\u5b9e\u73b0\u5305\u62ec\uff1a","text":"<ul> <li>\u8f7b\u91cf\u7ea7\uff1a \u8fd9\u4e24\u4e2a\u5bb9\u5668\u8fd0\u884c\u65f6\u90fd\u4e13\u6ce8\u4e8e\u5bb9\u5668\u7684\u521b\u5efa\u3001\u7ba1\u7406\u548c\u9500\u6bc1\uff0c\u4e0d\u50cf Docker \u90a3\u6837\u6709\u8fc7\u591a\u7684\u989d\u5916\u529f\u80fd\uff0c\u56e0\u6b64\u9002\u5408 Kubernetes \u8fd9\u79cd\u9ad8\u5ea6\u96c6\u6210\u7684\u7cfb\u7edf\u3002</li> <li>\u9ad8\u6548\u6027\uff1a \u5b83\u4eec\u6bd4 Docker \u66f4\u8f7b\u91cf\uff0c\u51cf\u5c11\u4e86 Kubernetes \u5bf9\u8d44\u6e90\u7684\u6d88\u8017\uff0c\u5e76\u4e14\u5bf9\u5bb9\u5668\u7684\u542f\u52a8\u548c\u7ba1\u7406\u66f4\u52a0\u9ad8\u6548\u3002</li> <li>\u7a33\u5b9a\u6027\u4e0e\u652f\u6301\uff1a containerd \u548c CRI-O \u90fd\u6709\u6d3b\u8dc3\u7684\u793e\u533a\u652f\u6301\uff0c\u5e76\u4e14\u5728 Kubernetes \u4e2d\u5f97\u5230\u4e86\u5e7f\u6cdb\u7684\u4f7f\u7528\u548c\u9a8c\u8bc1\u3002</li> </ul>"},{"location":"2025/7cri/#12-kubernetes-cri-o","title":"12. \u5982\u4f55\u914d\u7f6e Kubernetes \u4f7f\u7528 CRI-O \u4f5c\u4e3a\u5bb9\u5668\u8fd0\u884c\u65f6\uff1f","text":"<p>\u8981\u5c06 Kubernetes \u914d\u7f6e\u4e3a\u4f7f\u7528 CRI-O \u4f5c\u4e3a\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u901a\u5e38\u9700\u8981\u8fdb\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li>\u5b89\u88c5 CRI-O\uff1a\u5b89\u88c5 CRI-O \u5e76\u786e\u4fdd\u5b83\u5728 Kubernetes \u8282\u70b9\u4e0a\u8fd0\u884c\u3002\u53ef\u4ee5\u4f7f\u7528\u53d1\u884c\u7248\u7684\u5305\u7ba1\u7406\u5de5\u5177\uff08\u5982 apt\u3001yum\uff09\u6216\u76f4\u63a5\u4ece GitHub \u4e0a\u5b89\u88c5\u9884\u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</li> <li>\u5b89\u88c5 CRI-O \u4e4b\u540e\uff0c\u542f\u52a8\u5e76\u786e\u4fdd\u5b83\u8fd0\u884c\u6b63\u5e38</li> </ol> <pre><code>systemctl start crio\nsystemctl enable crio\n</code></pre> <p>3.\u914d\u7f6e Kubernetes \u4f7f\u7528 CRI-O\uff1a Kubernetes \u7684 kubelet \u901a\u8fc7 <code>--container-runtime</code> \u53c2\u6570\u6307\u5b9a\u5bb9\u5668\u8fd0\u884c\u65f6\u3002\u5982\u679c\u8981\u4f7f\u7528 CRI-O\uff0c\u53ef\u4ee5\u5728 kubelet \u914d\u7f6e\u4e2d\u8bbe\u7f6e\u4e3a cri-o\uff1a 4.\u7f16\u8f91 kubelet \u7684\u542f\u52a8\u914d\u7f6e\u6587\u4ef6\uff08\u5982 <code>/etc/default/kubelet</code>\uff09\uff1a</p> <pre><code>KUBELET_EXTRA_ARGS=\"--container-runtime=remote --container-runtime-endpoint=/var/run/crio/crio.sock\"\n</code></pre> <p>5.\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f kubeadm \u6765\u5b89\u88c5 Kubernetes\uff0c\u53ef\u4ee5\u901a\u8fc7 kubeadm \u7684\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e\uff1a</p> <pre><code>apiServer:\n  extraArgs:\n    container-runtime: remote\n    container-runtime-endpoint: /var/run/crio/crio.sock\n</code></pre> <p>6.\u91cd\u542f kubelet \u670d\u52a1\uff1a \u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u91cd\u542f kubelet \u670d\u52a1\uff0c\u4f7f\u5176\u4f7f\u7528 CRI-O \u4f5c\u4e3a\u5bb9\u5668\u8fd0\u884c\u65f6\uff1a</p> <pre><code>systemctl restart kubelet\n</code></pre> <p>7.\u9a8c\u8bc1\u914d\u7f6e\uff1a \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u9a8c\u8bc1\u5bb9\u5668\u8fd0\u884c\u65f6\u914d\u7f6e\u662f\u5426\u6b63\u786e\uff1a</p> <pre><code>kubectl get nodes -o wide\n</code></pre> <p>8.\u5982\u679c\u914d\u7f6e\u6210\u529f\uff0ckubelet \u4f1a\u4f7f\u7528 CRI-O \u6765\u7ba1\u7406\u5bb9\u5668\u3002</p>"},{"location":"2025/7cri/#13-cri","title":"13. CRI \u5728\u5bb9\u5668\u8c03\u5ea6\u4e2d\u7684\u4f5c\u7528\u662f\u4ec0\u4e48\uff1f","text":"<p>CRI \u5728 Kubernetes \u4e2d\u7684\u5bb9\u5668\u8c03\u5ea6\u8fc7\u7a0b\u4e2d\u8d77\u5230\u4e86\u4ee5\u4e0b\u4f5c\u7528\uff1a</p> <ul> <li> <ul> <li>\u5bb9\u5668\u751f\u547d\u5468\u671f\u7ba1\u7406\uff1a CRI \u8d1f\u8d23\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406\uff0c\u5305\u62ec\u5bb9\u5668\u7684\u521b\u5efa\u3001\u542f\u52a8\u3001\u505c\u6b62\u548c\u5220\u9664\u7b49\u3002\u5f53 Kubernetes \u8c03\u5ea6\u4e00\u4e2a Pod \u5230\u67d0\u4e2a\u8282\u70b9\u65f6\uff0ckubelet \u4f1a\u901a\u8fc7 CRI \u542f\u52a8\u5bb9\u5668\uff0c\u5e76\u76d1\u63a7\u5176\u5065\u5eb7\u72b6\u6001\u3002</li> </ul> </li> <li>\u5bb9\u5668\u72b6\u6001\u76d1\u63a7\uff1a \u901a\u8fc7 CRI\uff0ckubelet \u80fd\u591f\u83b7\u53d6\u5bb9\u5668\u7684\u72b6\u6001\u548c\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff08\u5982 CPU\u3001\u5185\u5b58\u7b49\uff09\uff0c\u5e76\u5c06\u8fd9\u4e9b\u4fe1\u606f\u53cd\u9988\u7ed9 Kubernetes\uff0c\u4ee5\u4fbf\u8fdb\u884c\u8c03\u5ea6\u51b3\u7b56\u3002</li> <li>\u8d44\u6e90\u5206\u914d\u4e0e\u9650\u5236\uff1a CRI \u534f\u8c03\u5bb9\u5668\u8d44\u6e90\uff08\u5982\u5185\u5b58\u3001CPU\u3001\u5b58\u50a8\u7b49\uff09\u7684\u5206\u914d\u548c\u9650\u5236\u3002kubelet \u4f1a\u901a\u8fc7 CRI \u6765\u786e\u4fdd\u5bb9\u5668\u4e0d\u4f1a\u8d85\u51fa\u8282\u70b9\u7684\u8d44\u6e90\u914d\u989d\u3002</li> <li>\u5bb9\u5668\u5065\u5eb7\u68c0\u67e5\uff1a CRI \u63d0\u4f9b\u4e86\u5bb9\u5668\u5065\u5eb7\u68c0\u67e5\u63a5\u53e3\uff0ckubelet \u53ef\u4ee5\u5b9a\u671f\u68c0\u67e5\u5bb9\u5668\u7684\u5065\u5eb7\u72b6\u6001\uff0c\u5e76\u5728\u5bb9\u5668\u5931\u8d25\u65f6\u8fdb\u884c\u91cd\u542f\u6216\u8fc1\u79fb\u3002</li> </ul>"},{"location":"2025/7cri/#14-kubernetes-kubelet-cri","title":"14. \u4ec0\u4e48\u662f Kubernetes \u4e2d\u7684 kubelet \u4e0e CRI \u7684\u4ea4\u4e92\u65b9\u5f0f\uff1f","text":"<p>\u5728 Kubernetes \u4e2d\uff0ckubelet \u662f\u7ba1\u7406\u5bb9\u5668\u751f\u547d\u5468\u671f\u7684\u5173\u952e\u7ec4\u4ef6\uff0c\u5b83\u4e0e CRI \u5bb9\u5668\u8fd0\u884c\u65f6\u63a5\u53e3\u76f4\u63a5\u4ea4\u4e92\uff0c\u786e\u4fdd\u5bb9\u5668\u7684\u542f\u52a8\u3001\u7ba1\u7406\u548c\u505c\u6b62\u7b49\u64cd\u4f5c\u3002kubelet \u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u4e0e CRI \u8fdb\u884c\u4ea4\u4e92\uff1a</p> <ol> <li>\u5bb9\u5668\u521b\u5efa\u548c\u542f\u52a8\uff1a kubelet \u4f1a\u5411 CRI \u8bf7\u6c42\u521b\u5efa\u548c\u542f\u52a8\u5bb9\u5668\u3002\u5b83\u5c06 Pod \u7684\u89c4\u8303\uff08\u5982\u5bb9\u5668\u955c\u50cf\u3001\u8d44\u6e90\u8981\u6c42\u7b49\uff09\u4f20\u9012\u7ed9 CRI\uff0cCRI \u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\u542f\u52a8\u5bb9\u5668\u3002</li> <li>\u5bb9\u5668\u76d1\u63a7\uff1a kubelet \u4f1a\u5b9a\u671f\u901a\u8fc7 CRI \u83b7\u53d6\u5bb9\u5668\u7684\u72b6\u6001\u3001\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u548c\u5065\u5eb7\u72b6\u51b5\u3002\u57fa\u4e8e\u8fd9\u4e9b\u6570\u636e\uff0ckubelet \u4f1a\u5224\u65ad\u5bb9\u5668\u662f\u5426\u9700\u8981\u91cd\u542f\u3001\u505c\u6b62\u6216\u5220\u9664\u3002</li> <li>\u5bb9\u5668\u65e5\u5fd7\uff1a kubelet \u53ef\u4ee5\u901a\u8fc7 CRI \u83b7\u53d6\u5bb9\u5668\u7684\u65e5\u5fd7\u4fe1\u606f\uff0c\u5e76\u5c06\u65e5\u5fd7\u8bb0\u5f55\u5728 Kubernetes \u7684\u65e5\u5fd7\u7cfb\u7edf\u4e2d\uff0c\u4f9b\u7528\u6237\u8c03\u8bd5\u548c\u76d1\u63a7\u3002</li> <li>\u5065\u5eb7\u68c0\u67e5\uff1a kubelet \u4f7f\u7528 CRI \u7684\u5065\u5eb7\u68c0\u67e5\u529f\u80fd\u6765\u68c0\u6d4b\u5bb9\u5668\u7684\u5065\u5eb7\u72b6\u6001\uff0c\u5e76\u6839\u636e\u7ed3\u679c\u51b3\u5b9a\u662f\u5426\u9700\u8981\u91cd\u65b0\u8c03\u5ea6\u5bb9\u5668\u3002</li> <li>\u5bb9\u5668\u505c\u6b62\u4e0e\u5220\u9664\uff1a kubelet \u4f1a\u5728\u5bb9\u5668\u8fd0\u884c\u5b8c\u6210\u540e\uff0c\u901a\u8fc7 CRI \u8bf7\u6c42\u505c\u6b62\u5e76\u5220\u9664\u5bb9\u5668\uff0c\u91ca\u653e\u8d44\u6e90\u3002</li> </ol>"},{"location":"2025/7cri/#15-kubernetes-qosquality-of-service","title":"15. \u5982\u4f55\u5728 Kubernetes \u4e2d\u5b9e\u73b0\u5bb9\u5668\u7684\u8d44\u6e90\u9650\u5236\u548c QoS\uff08Quality of Service\uff09\uff1f","text":"<p>\u5728 Kubernetes \u4e2d\uff0c\u5bb9\u5668\u7684\u8d44\u6e90\u9650\u5236\u662f\u901a\u8fc7 Pod \u7684\u8d44\u6e90\u8bf7\u6c42\u548c\u9650\u5236\u6765\u5b9e\u73b0\u7684\u3002\u8d44\u6e90\u8bf7\u6c42\u548c\u9650\u5236\u4f1a\u5f71\u54cd\u5bb9\u5668\u7684 QoS \u7ea7\u522b\uff0c\u5177\u4f53\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ol> <li> <p>\u8d44\u6e90\u8bf7\u6c42\u4e0e\u9650\u5236\uff1a Kubernetes \u5141\u8bb8\u7528\u6237\u4e3a\u6bcf\u4e2a\u5bb9\u5668\u6307\u5b9a \u8bf7\u6c42\uff08requests\uff09 \u548c \u9650\u5236\uff08limits\uff09\uff1a</p> </li> <li> <p>requests\uff1a \u5bb9\u5668\u542f\u52a8\u65f6\uff0cKubernetes \u4e3a\u5bb9\u5668\u5206\u914d\u7684\u6700\u5c0f\u8d44\u6e90\u91cf\u3002\u5982\u679c\u5bb9\u5668\u4f7f\u7528\u7684\u8d44\u6e90\u4f4e\u4e8e\u8bf7\u6c42\uff0cKubernetes \u4f1a\u4e3a\u5176\u4fdd\u7559\u8d44\u6e90</p> </li> <li> <p>limits : \u5bb9\u5668\u4f7f\u7528\u7684\u6700\u5927\u8d44\u6e90\u91cf\uff0c\u8d85\u8fc7\u8be5\u9650\u5236\uff0c\u5bb9\u5668\u4f1a\u88ab OOM\uff08Out of Memory\uff09\u6740\u6b7b\u6216\u88ab\u6682\u505c\u3002</p> </li> <li> <p>QoS\uff08\u8d28\u91cf\u670d\u52a1\uff09\uff1a \u6839\u636e\u5bb9\u5668\u7684\u8bf7\u6c42\u548c\u9650\u5236\uff0cKubernetes \u4f1a\u4e3a\u5bb9\u5668\u5206\u914d\u4e0d\u540c\u7684 QoS \u7ea7\u522b\uff1a</p> </li> <li> <p>Guaranteed \uff1a \u5f53\u8bf7\u6c42\u548c\u9650\u5236\u76f8\u7b49\u65f6\uff0c\u5bb9\u5668\u4f1a\u88ab\u5206\u914d Guaranteed QoS\uff0c\u610f\u5473\u7740\u5bb9\u5668\u7684\u8d44\u6e90\u59cb\u7ec8\u53d7\u5230\u4fdd\u8bc1\u3002</p> </li> <li>Burstable\u5f53\u8bf7\u6c42\u5c0f\u4e8e\u9650\u5236\u65f6\uff0c\u5bb9\u5668\u5c5e\u4e8e Burstable QoS\uff0c\u610f\u5473\u7740\u5b83\u53ef\u4ee5\u5728\u9700\u8981\u65f6\u83b7\u5f97\u66f4\u591a\u8d44\u6e90\uff0c\u4f46\u5982\u679c\u8d44\u6e90\u4e0d\u8db3\u65f6\uff0cKubernetes \u4f1a\u4f18\u5148\u4fdd\u8bc1\u5176\u4ed6\u5bb9\u5668\u7684\u8d44\u6e90\u3002</li> <li>BestEffort\uff1a \u5f53\u5bb9\u5668\u6ca1\u6709\u8bbe\u7f6e\u8bf7\u6c42\u548c\u9650\u5236\u65f6\uff0c\u5b83\u5c5e\u4e8e BestEffort QoS\uff0c\u5bb9\u5668\u7684\u8d44\u6e90\u4e0d\u53d7\u4fdd\u8bc1\uff0c\u53ef\u80fd\u4f1a\u88ab\u4f18\u5148\u9a71\u9010\u3002</li> </ol> <p>\u901a\u8fc7 CRI\uff0ckubelet \u6839\u636e\u8fd9\u4e9b\u914d\u7f6e\u6765\u7ba1\u7406\u5bb9\u5668\u7684\u8d44\u6e90\u5206\u914d\uff0c\u786e\u4fdd\u5bb9\u5668\u7684\u8d44\u6e90\u4f7f\u7528\u5728\u5408\u7406\u8303\u56f4\u5185\u3002</p>"},{"location":"2025/7cri/#16-cri-kubernetes-scheduler","title":"16. \u5982\u4f55\u5b9e\u73b0 CRI \u4e0e Kubernetes \u4e2d\u7684\u8c03\u5ea6\u5668\uff08Scheduler\uff09\u7684\u9ad8\u6548\u96c6\u6210\uff1f","text":"<p>\u4e3a\u4e86\u786e\u4fdd CRI \u4e0e Kubernetes \u8c03\u5ea6\u5668\uff08Scheduler\uff09\u9ad8\u6548\u96c6\u6210\uff0c\u6d89\u53ca\u591a\u4e2a\u65b9\u9762\u7684\u914d\u7f6e\u548c\u4f18\u5316\uff1a</p> <p>\u8d44\u6e90\u8bf7\u6c42\u4e0e\u8c03\u5ea6\u4f18\u5316</p> <ul> <li>Kubernetes \u8c03\u5ea6\u5668\u57fa\u4e8e\u5bb9\u5668\u7684\u8d44\u6e90\u8bf7\u6c42\uff08\u5982 CPU\u3001\u5185\u5b58\uff09\u6765\u8fdb\u884c\u8c03\u5ea6\u3002CRI \u9700\u8981\u5411 kubelet \u63d0\u4f9b\u5bb9\u5668\u7684\u8d44\u6e90\u8bf7\u6c42\u4fe1\u606f\uff0c\u8c03\u5ea6\u5668\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\u5c06\u5bb9\u5668\u8c03\u5ea6\u5230\u9002\u5408\u7684\u8282\u70b9\u4e0a\u3002</li> <li>\u4e3a\u4e86\u5b9e\u73b0\u9ad8\u6548\u8c03\u5ea6\uff0c\u5bb9\u5668\u8fd0\u884c\u65f6\uff08\u5982 CRI-O \u6216 containerd\uff09\u9700\u8981\u4e0e kubelet \u7d27\u5bc6\u534f\u4f5c\uff0c\u786e\u4fdd\u5bb9\u5668\u7684\u8d44\u6e90\u9650\u5236\u4e0e\u8bf7\u6c42\u6b63\u786e\u5730\u4f20\u9012\u7ed9\u8c03\u5ea6\u5668\u3002</li> </ul> <p>Pod Affinity/Anti-Affinity</p> <p>\u5728\u8c03\u5ea6 Pod \u65f6\uff0c\u4f7f\u7528 Pod Affinity \u548c Anti-Affinity \u914d\u7f6e\u6765\u786e\u4fdd\u76f8\u5173\u5bb9\u5668\u8fd0\u884c\u5728\u76f8\u540c\u8282\u70b9\u6216\u4e0d\u540c\u8282\u70b9\u4e0a\u3002\u5bb9\u5668\u8fd0\u884c\u65f6\u901a\u8fc7\u652f\u6301\u8282\u70b9\u4eb2\u548c\u6027\u548c\u62d3\u6251\u914d\u7f6e\uff0c\u5e2e\u52a9\u8c03\u5ea6\u5668\u505a\u51fa\u9ad8\u6548\u7684\u51b3\u7b56</p> <p>\u8c03\u5ea6\u7b56\u7565\u4e0e QoS\uff08Quality of Service\uff09</p> <ul> <li>Kubernetes \u4e2d\u7684 QoS \u7ea7\u522b\uff08\u5982 Guaranteed\u3001Burstable\u3001BestEffort\uff09\u76f4\u63a5\u5f71\u54cd\u5bb9\u5668\u7684\u4f18\u5148\u7ea7\u3002CRI \u9700\u8981\u6839\u636e\u5bb9\u5668\u7684 QoS \u914d\u7f6e\u6765\u4f18\u5316\u8d44\u6e90\u7684\u5206\u914d\u548c\u7ba1\u7406\u3002</li> <li>\u5bf9\u4e8e\u5173\u952e\u4e1a\u52a1\u670d\u52a1\uff0c\u5bb9\u5668\u8fd0\u884c\u65f6\u5e94\u652f\u6301\u8d44\u6e90\u4f18\u5148\u7ea7\u7684\u914d\u7f6e\uff0c\u786e\u4fdd\u8fd9\u4e9b\u5bb9\u5668\u80fd\u591f\u4f18\u5148\u83b7\u5f97\u8d44\u6e90</li> </ul> <p>\u52a8\u6001\u8d44\u6e90\u8c03\u6574\u4e0e Pod \u91cd\u65b0\u8c03\u5ea6</p> <ul> <li>Kubernetes \u652f\u6301\u57fa\u4e8e\u8d44\u6e90\u4f7f\u7528\u7684\u52a8\u6001\u8c03\u5ea6\uff0c\u5bb9\u5668\u8fd0\u884c\u65f6\u901a\u8fc7 CRI \u63a5\u53e3\u63d0\u4f9b\u5bb9\u5668\u7684\u5b9e\u65f6\u8d44\u6e90\u4f7f\u7528\u6570\u636e\uff0c\u5e2e\u52a9\u8c03\u5ea6\u5668\u6839\u636e\u96c6\u7fa4\u7684\u8d1f\u8f7d\u52a8\u6001\u8c03\u6574\u5bb9\u5668\u8c03\u5ea6\u3002</li> <li>\u4f8b\u5982\uff0ccontainerd \u548c CRI-O \u53ef\u4ee5\u63d0\u4f9b\u5bb9\u5668\u7684\u5b9e\u65f6\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff0c\u901a\u8fc7 CRI \u63a5\u53e3\u5c06\u5176\u53cd\u9988\u7ed9 kubelet \u548c\u8c03\u5ea6\u5668\uff0c\u8fdb\u800c\u6267\u884c\u5bb9\u5668\u7684\u8fc1\u79fb\u6216\u91cd\u8c03\u5ea6\u3002</li> </ul>"},{"location":"2025/7cri/#17-cri-ha","title":"17. \u5982\u4f55\u5728 CRI \u4e2d\u5b9e\u73b0\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u9ad8\u53ef\u7528\u6027\uff08HA\uff09\uff1f","text":"<ul> <li>\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u591a\u8282\u70b9\u90e8\u7f72</li> <li>\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u72b6\u6001\u540c\u6b65<ul> <li>\u5bb9\u5668\u8fd0\u884c\u65f6\u5e94\u652f\u6301\u8de8\u8282\u70b9\u7684\u72b6\u6001\u540c\u6b65\u3002\u4f8b\u5982\uff0ccontainerd \u63d0\u4f9b\u4e86\u5bf9\u5206\u5e03\u5f0f\u5b58\u50a8\u7684\u652f\u6301\uff0c\u786e\u4fdd\u591a\u4e2a\u8282\u70b9\u4e0a\u5bb9\u5668\u7684\u72b6\u6001\u4fe1\u606f\u4e00\u81f4\uff0c\u4ee5\u4fbf\u5728\u8282\u70b9\u53d1\u751f\u6545\u969c\u65f6\u80fd\u591f\u6062\u590d\u5bb9\u5668\u7684\u8fd0\u884c\u72b6\u6001\u3002</li> <li>\u914d\u7f6e\u5171\u4eab\u5b58\u50a8\u5377\uff08\u5982 NFS\u3001Ceph\uff09\uff0c\u786e\u4fdd\u5bb9\u5668\u7684\u6301\u4e45\u5316\u6570\u636e\u5728\u8282\u70b9\u6545\u969c\u65f6\u80fd\u591f\u6062\u590d</li> </ul> </li> <li>\u6545\u969c\u6062\u590d\u4e0e\u81ea\u52a8\u91cd\u542f<ul> <li>CRI \u8fd0\u884c\u65f6\u53ef\u4ee5\u901a\u8fc7\u652f\u6301\u5bb9\u5668\u7684\u5065\u5eb7\u68c0\u67e5\u548c\u81ea\u52a8\u91cd\u542f\u673a\u5236\u6765\u63d0\u9ad8\u5bb9\u5668\u7684\u53ef\u7528\u6027\u3002kubelet \u4f1a\u76d1\u63a7\u5bb9\u5668\u72b6\u6001\uff0c\u901a\u8fc7 CRI \u63a5\u53e3\u83b7\u53d6\u5bb9\u5668\u5065\u5eb7\u72b6\u51b5\uff0c\u81ea\u52a8\u91cd\u542f\u5931\u8d25\u7684\u5bb9\u5668\u3002</li> <li>\u914d\u7f6e\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u6545\u969c\u68c0\u6d4b\u673a\u5236\uff0c\u5f53\u5bb9\u5668\u51fa\u73b0\u6545\u969c\u6216\u4e0d\u53ef\u7528\u65f6\uff0c\u53ca\u65f6\u91cd\u542f\u5bb9\u5668\u5e76\u5c06\u5176\u6062\u590d\u5230\u9884\u671f\u72b6\u6001</li> </ul> </li> <li>\u52a8\u6001\u5bb9\u5668\u8c03\u5ea6\u4e0e\u8282\u70b9\u6269\u5c55<ul> <li>\u914d\u7f6e Kubernetes \u7684\u81ea\u52a8\u6269\u5bb9\u529f\u80fd\uff0c\u7ed3\u5408\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u9ad8\u53ef\u7528\u6027\u8bbe\u7f6e\uff0c\u5f53\u96c6\u7fa4\u8d44\u6e90\u7d27\u5f20\u65f6\uff0c\u81ea\u52a8\u6269\u5c55\u8282\u70b9\u5e76\u5c06\u8d1f\u8f7d\u5747\u8861\u5230\u65b0\u8282\u70b9\u4e0a\u3002</li> <li>\u5728\u5bb9\u5668\u8fd0\u884c\u65f6\u652f\u6301\u5bb9\u5668\u7684\u52a8\u6001\u8fc1\u79fb\u548c\u8c03\u5ea6\uff0c\u786e\u4fdd\u5bb9\u5668\u5728\u96c6\u7fa4\u4e2d\u6545\u969c\u6062\u590d\u65f6\u80fd\u591f\u5feb\u901f\u8fc1\u79fb\u5230\u5176\u4ed6\u8282\u70b9\u3002</li> </ul> </li> </ul>"},{"location":"2025/7cri/#18-cri-io","title":"18. \u5982\u4f55\u4f18\u5316 CRI \u4e2d\u5bb9\u5668\u8fd0\u884c\u65f6\u7684 I/O \u6027\u80fd\uff1f","text":"<p>\u4f18\u5316\u5bb9\u5668\u8fd0\u884c\u65f6\u7684 I/O \u6027\u80fd\u53ef\u4ee5\u4ece\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u7740\u624b\uff1a</p> <p>\u6587\u4ef6\u7cfb\u7edf\u9009\u62e9</p> <ul> <li>\u9009\u62e9\u9ad8\u6027\u80fd\u7684\u5b58\u50a8\u9a71\u52a8\uff0c\u5982 overlay2\uff0c\u8be5\u9a71\u52a8\u63d0\u4f9b\u4e86\u8f83\u9ad8\u7684\u6587\u4ef6\u7cfb\u7edf\u6027\u80fd\uff0c\u7279\u522b\u662f\u5728\u5bb9\u5668\u955c\u50cf\u548c\u5bb9\u5668\u6570\u636e\u7684 I/O \u64cd\u4f5c\u65f6\u3002</li> <li>\u4f7f\u7528\u652f\u6301\u9ad8\u6027\u80fd I/O \u64cd\u4f5c\u7684\u5b58\u50a8\u63d2\u4ef6\uff0c\u5982 device-mapper \u548c btrfs\u3002</li> </ul> <p>\u5b58\u50a8\u5377\u4f18\u5316</p> <ul> <li>\u5bf9\u4e8e\u9700\u8981\u9ad8\u6027\u80fd\u5b58\u50a8\u7684\u5bb9\u5668\uff0c\u4f7f\u7528\u672c\u5730\u5b58\u50a8\u5377\uff08\u5982 local \u5b58\u50a8\u63d2\u4ef6\uff09\u53ef\u4ee5\u51cf\u5c11 I/O \u5ef6\u8fdf\uff0c\u63d0\u4f9b\u66f4\u9ad8\u7684\u541e\u5410\u91cf\u3002</li> <li>\u914d\u7f6e\u9002\u5f53\u7684\u5377\u7c7b\u578b\uff0c\u4f8b\u5982\u4f7f\u7528 NFS \u534f\u8bae\u7684\u8fdc\u7a0b\u5b58\u50a8\u7cfb\u7edf\u6765\u652f\u6301\u5171\u4eab\u5b58\u50a8\u9700\u6c42\u3002</li> </ul> <p>\u5bb9\u5668\u78c1\u76d8\u914d\u989d\u4e0e\u5206\u914d</p> <ul> <li>\u914d\u7f6e\u78c1\u76d8 I/O \u9650\u5236\uff08\u5982 <code>--blkio-weight</code>\uff09\u6765\u786e\u4fdd\u5bb9\u5668\u4e0d\u4f1a\u56e0 I/O \u64cd\u4f5c\u8fc7\u591a\u800c\u5f71\u54cd\u5176\u4ed6\u5bb9\u5668\u7684\u6027\u80fd\u3002</li> <li>\u4f7f\u7528 \u78c1\u76d8\u914d\u989d \u6765\u5206\u914d\u6bcf\u4e2a\u5bb9\u5668\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u907f\u514d\u78c1\u76d8\u8d44\u6e90\u8fc7\u5ea6\u5360\u7528\u3002</li> <li>\u4f18\u5316\u65e5\u5fd7\u5904\u7406</li> </ul> <p>\u2022 \u5bf9\u5bb9\u5668\u65e5\u5fd7\u8fdb\u884c\u4f18\u5316\uff0c\u907f\u514d\u8fc7\u591a\u7684\u65e5\u5fd7\u5199\u5165\u5f71\u54cd\u5bb9\u5668\u6027\u80fd\u3002\u4f7f\u7528\u5916\u90e8\u65e5\u5fd7\u5904\u7406\u7cfb\u7edf\uff08\u5982 Fluentd\u3001ELK\uff09\u6765\u96c6\u4e2d\u7ba1\u7406\u5bb9\u5668\u65e5\u5fd7\u3002</p> <p>\u5bb9\u5668\u78c1\u76d8\u914d\u989d\u4e0e\u5206\u914d</p> <ul> <li>\u914d\u7f6e\u78c1\u76d8 I/O \u9650\u5236\uff08\u5982 --blkio-weight\uff09\u6765\u786e\u4fdd\u5bb9\u5668\u4e0d\u4f1a\u56e0 I/O \u64cd\u4f5c\u8fc7\u591a\u800c\u5f71\u54cd\u5176\u4ed6\u5bb9\u5668\u7684\u6027\u80fd\u3002</li> <li>\u4f7f\u7528 \u78c1\u76d8\u914d\u989d \u6765\u5206\u914d\u6bcf\u4e2a\u5bb9\u5668\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u907f\u514d\u78c1\u76d8\u8d44\u6e90\u8fc7\u5ea6\u5360\u7528</li> </ul> <p>\u5bb9\u5668\u78c1\u76d8\u914d\u989d\u4e0e\u5206\u914d</p> <ul> <li>\u914d\u7f6e\u78c1\u76d8 I/O \u9650\u5236\uff08\u5982 <code>--blkio-weight</code>\uff09\u6765\u786e\u4fdd\u5bb9\u5668\u4e0d\u4f1a\u56e0 I/O \u64cd\u4f5c\u8fc7\u591a\u800c\u5f71\u54cd\u5176\u4ed6\u5bb9\u5668\u7684\u6027\u80fd\u3002</li> <li>\u4f7f\u7528 \u78c1\u76d8\u914d\u989d \u6765\u5206\u914d\u6bcf\u4e2a\u5bb9\u5668\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u907f\u514d\u78c1\u76d8\u8d44\u6e90\u8fc7\u5ea6\u5360\u7528</li> </ul> <p>\u4f18\u5316\u65e5\u5fd7\u5904\u7406</p> <p>\u5bf9\u5bb9\u5668\u65e5\u5fd7\u8fdb\u884c\u4f18\u5316\uff0c\u907f\u514d\u8fc7\u591a\u7684\u65e5\u5fd7\u5199\u5165\u5f71\u54cd\u5bb9\u5668\u6027\u80fd\u3002\u4f7f\u7528\u5916\u90e8\u65e5\u5fd7\u5904\u7406\u7cfb\u7edf\uff08\u5982 Fluentd\u3001ELK\uff09\u6765\u96c6\u4e2d\u7ba1\u7406\u5bb9\u5668\u65e5\u5fd7\u3002</p>"},{"location":"2025/7cri/#19-cri","title":"19 CRI \u7684\u914d\u7f6e\u6587\u4ef6\u901a\u5e38\u4f4d\u4e8e\u54ea\u91cc\uff1f\u5982\u4f55\u4fee\u6539\u5176\u53c2\u6570\uff1f","text":"<ul> <li>\u8def\u5f84\uff1a <code>/etc/containerd/config.toml\uff08containerd\uff09</code>\u6216 <code>/etc/crio/crio.conf\uff08CRI-O\uff09</code>\u3002</li> <li>\u4fee\u6539\u540e\u91cd\u542f\u670d\u52a1\uff1a</li> </ul> <pre><code>systemctl restart containerd  # \u6216 crio\u3001\n</code></pre>"},{"location":"2025/7cri/#20-kubernetes-124-dockershim-docker","title":"20. Kubernetes 1.24 \u79fb\u9664\u4e86 dockershim\uff0c\u5982\u4f55\u786e\u4fdd\u65e7\u96c6\u7fa4\u517c\u5bb9 Docker\uff1f","text":"<p>\u65b9\u6848\uff1a</p> <p>\u4f7f\u7528 Mirantis Container Runtime\uff08\u66ff\u4ee3 dockershim\uff09\u3002  \u8fc1\u79fb\u5230 containerd\uff0c\u5e76\u786e\u4fdd Docker \u5bb9\u5668\u955c\u50cf\u517c\u5bb9\u3002</p>"},{"location":"2025/7cri/#21-cri","title":"21 \u5982\u4f55\u901a\u8fc7 CRI \u67e5\u770b\u5bb9\u5668\u7684\u5e95\u5c42\u65e5\u5fd7\uff1f","text":"<p>containerd</p> <pre><code>ctr --namespace=k8s.io containers ls  # \u5217\u51fa\u5bb9\u5668\nctr --namespace=k8s.io logs &lt;\u5bb9\u5668ID&gt;\n</code></pre> <p>cri-o</p> <pre><code>crictl logs &lt;\u5bb9\u5668ID&gt;\n</code></pre>"},{"location":"2025/7cri/#22-cpu","title":"22 \u5982\u4f55\u9650\u5236\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u8d44\u6e90\u4f7f\u7528\uff08\u5982 CPU\u3001\u5185\u5b58\uff09\uff1f","text":"<ul> <li>Kubernetes \u5c42\u9762\uff1a \u901a\u8fc7 Pod \u7684 resources \u5b57\u6bb5\u9650\u5236\u3002</li> <li>CRI \u5c42\u9762\uff1a \u914d\u7f6e\u5bb9\u5668\u8fd0\u884c\u65f6\u7684 Cgroups \u53c2\u6570\uff08\u5982 containerd \u7684 config.toml\uff09\u3002</li> </ul>"},{"location":"2025/7cri/#23-containerd","title":"23. \u5982\u4f55\u914d\u7f6e containerd \u4f7f\u7528\u79c1\u6709\u955c\u50cf\u4ed3\u5e93\uff1f","text":"<p>\u4fee\u6539 config.toml\uff1a</p> <pre><code>[plugins.\"io.containerd.grpc.v1.cri\".registry]\n  [plugins.\"io.containerd.grpc.v1.cri\".registry.mirrors]\n    [plugins.\"io.containerd.grpc.v1.cri\".registry.mirrors.\"my-registry.com\"]\n      endpoint = [\"https://my-registry.com\"]\n  [plugins.\"io.containerd.grpc.v1.cri\".registry.configs]\n    [plugins.\"io.containerd.grpc.v1.cri\".registry.configs.\"my-registry.com\".tls]\n      insecure_skip_verify = true  # \u8df3\u8fc7 TLS \u9a8c\u8bc1\uff08\u53ef\u9009\uff09\n</code></pre>"},{"location":"2025/7cri/#24-cri-ociopen-container-initiative","title":"24. CRI \u4e0e OCI\uff08Open Container Initiative\uff09\u7684\u5173\u7cfb\u662f\u4ec0\u4e48\uff1f","text":"<ul> <li>CRI\uff1a \u5b9a\u4e49 Kubernetes \u4e0e\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u4ea4\u4e92\u63a5\u53e3\u3002</li> <li>OCI\uff1a \u5b9a\u4e49\u5bb9\u5668\u955c\u50cf\u548c\u8fd0\u884c\u65f6\u7684\u6807\u51c6\uff08\u5982\u955c\u50cf\u683c\u5f0f\u3001\u8fd0\u884c\u65f6\u89c4\u8303 runc\uff09\u3002</li> <li>\u5173\u7cfb\uff1a CRI \u517c\u5bb9\u7684\u8fd0\u884c\u65f6\uff08\u5982 containerd\uff09\u901a\u8fc7 OCI \u6807\u51c6\u7ba1\u7406\u5bb9\u5668\u751f\u547d\u5468\u671f\u3002</li> </ul>"},{"location":"2025/7cri/#25-cri","title":"25. \u5982\u4f55\u4f18\u5316 CRI \u7684\u6027\u80fd\u4ee5\u652f\u6301\u9ad8\u5bc6\u5ea6\u5bb9\u5668\u90e8\u7f72\uff1f","text":"<ul> <li>\u542f\u7528\u5bb9\u5668\u8fd0\u884c\u65f6\u7f13\u5b58\uff08\u5982 containerd \u7684\u5feb\u7167\u673a\u5236\uff09\u3002</li> <li>\u8c03\u6574\u5e76\u53d1\u62c9\u53d6\u955c\u50cf\u7684\u7ebf\u7a0b\u6570\uff08<code>max_concurrent_downloads</code>\uff09\u3002</li> <li>\u4f7f\u7528\u9ad8\u6027\u80fd\u5b58\u50a8\u9a71\u52a8\uff08\u5982 overlay2\uff09</li> </ul>"},{"location":"2025/8sap/","title":"8 SAP\u9762\u8bd5","text":""},{"location":"2025/8sap/#1-configmap-reloader","title":"1. Configmap reloader","text":"<p>Configmap\u6216Secret\u4f7f\u7528\u6709\u4e24\u79cd\u65b9\u5f0f\uff0c</p> <ul> <li>\u4e00\u79cd\u662f<code>env</code>\u7cfb\u7edf\u53d8\u91cf\u8d4b\u503c\uff0c\u4e00\u79cd\u662f<code>volume</code>\u6302\u8f7d\u8d4b\u503c</li> <li> <p><code>env</code>\u5199\u5165\u7cfb\u7edf\u7684<code>configmap</code>\u662f\u4e0d\u4f1a\u70ed\u66f4\u65b0\u7684\uff0c\u800c<code>volume</code>\u5199\u5165\u7684\u65b9\u5f0f\u652f\u6301\u70ed\u66f4\u65b0\uff01</p> </li> <li> <p>\u5bf9\u4e8eenv\u73af\u5883\u7684\uff0c\u5fc5\u987b\u8981\u6eda\u52a8\u66f4\u65b0pod\u624d\u80fd\u751f\u6548\uff0c\u4e5f\u5c31\u662f\u5220\u9664\u8001\u7684pod\uff0c\u91cd\u65b0\u4f7f\u7528\u955c\u50cf\u62c9\u8d77\u65b0pod\u52a0\u8f7d\u73af\u5883\u53d8\u91cf\u624d\u80fd\u751f\u6548\u3002</p> </li> <li>\u5bf9\u4e8evolume\u7684\u65b9\u5f0f\uff0c\u867d\u7136\u5185\u5bb9\u53d8\u4e86\uff0c\u4f46\u662f\u9700\u8981\u6211\u4eec\u7684\u5e94\u7528\u76f4\u63a5\u76d1\u63a7configmap\u7684\u53d8\u52a8\uff0c\u6216\u8005\u4e00\u76f4\u53bb\u66f4\u65b0\u73af\u5883\u53d8\u91cf\u624d\u80fd\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u8fbe\u5230\u70ed\u66f4\u65b0\u7684\u76ee\u7684\u3002</li> </ul> <p>\u5e94\u7528\u4e0d\u652f\u6301\u70ed\u66f4\u65b0\uff0c\u53ef\u4ee5\u5728\u4e1a\u52a1\u5bb9\u5668\u4e2d\u542f\u52a8\u4e00\u4e2asidercar\u5bb9\u5668\uff0c\u76d1\u63a7configmap\u7684\u53d8\u52a8\uff0c\u66f4\u65b0\u914d\u7f6e\u6587\u4ef6\uff0c\u6216\u8005\u4e5f\u6eda\u52a8\u66f4\u65b0pod\u8fbe\u5230\u66f4\u65b0\u914d\u7f6e\u7684\u6548\u679c\u3002</p>"},{"location":"2025/8sap/#_1","title":"\u89e3\u51b3\u65b9\u6848","text":"<p>ConfigMap \u548c Secret \u662f Kubernetes \u5e38\u7528\u7684\u4fdd\u5b58\u914d\u7f6e\u6570\u636e\u7684\u5bf9\u8c61\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u9700\u8981\u9009\u62e9\u5408\u9002\u7684\u5bf9\u8c61\u5b58\u50a8\u6570\u636e\u3002\u901a\u8fc7 Volume \u65b9\u5f0f\u6302\u8f7d\u5230 Pod \u5185\u7684\uff0ckubelet \u90fd\u4f1a\u5b9a\u671f\u8fdb\u884c\u66f4\u65b0\u3002\u4f46\u662f\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u6ce8\u5165\u5230\u5bb9\u5668\u4e2d\uff0c\u8fd9\u6837\u65e0\u6cd5\u611f\u77e5\u5230 ConfigMap \u6216 Secret \u7684\u5185\u5bb9\u66f4\u65b0\u3002</p> <p>\u76ee\u524d\u5982\u4f55\u8ba9 Pod \u5185\u7684\u4e1a\u52a1\u611f\u77e5\u5230 ConfigMap \u6216 Secret \u7684\u53d8\u5316\uff0c\u8fd8\u662f\u4e00\u4e2a\u5f85\u89e3\u51b3\u7684\u95ee\u9898\u3002\u4f46\u662f\u6211\u4eec\u8fd8\u662f\u6709\u4e00\u4e9b Workaround \u7684\u3002</p> <p>\u5982\u679c\u4e1a\u52a1\u81ea\u8eab\u652f\u6301 reload \u914d\u7f6e\u7684\u8bdd\uff0c\u6bd4\u5982nginx -s reload\uff0c\u53ef\u4ee5\u901a\u8fc7 inotify \u611f\u77e5\u5230\u6587\u4ef6\u66f4\u65b0\uff0c\u6216\u8005\u76f4\u63a5\u5b9a\u671f\u8fdb\u884c reload\uff08\u8fd9\u91cc\u53ef\u4ee5\u914d\u5408\u6211\u4eec\u7684 readinessProbe \u4e00\u8d77\u4f7f\u7528\uff09\u3002</p> <p>Configmap\u6216Secret\u4f7f\u7528\u6709\u4e24\u79cd\u65b9\u5f0f\uff0c\u4e00\u79cd\u662f<code>env</code>\u7cfb\u7edf\u53d8\u91cf\u8d4b\u503c\uff0c\u4e00\u79cd\u662f<code>volume</code>\u6302\u8f7d\u8d4b\u503c\uff0c<code>env</code>\u5199\u5165\u7cfb\u7edf\u7684<code>configmap</code>\u662f\u4e0d\u4f1a\u70ed\u66f4\u65b0\u7684\uff0c\u800c<code>volume</code>\u5199\u5165\u7684\u65b9\u5f0f\u652f\u6301\u70ed\u66f4\u65b0\uff01</p>"},{"location":"2025/8sap/#_2","title":"\u81ea\u52a8\u66f4\u65b0","text":"<p><code>reloader.stakater.com/search</code> \u548c <code>reloader.stakater.com/auto</code>\u5e76\u4e0d\u5728\u4e00\u8d77\u5de5\u4f5c\u3002</p> <p>\u5982\u679c\u4f60\u5728\u4f60\u7684\u90e8\u7f72\u4e0a\u6709\u4e00\u4e2a <code>reloader.stakater.com/auto : \"true\"</code>\u7684\u6ce8\u91ca\uff0c\u8be5\u8d44\u6e90\u5bf9\u8c61\u5f15\u7528\u7684\u6240\u6709configmap\u6216\u8fd9secret\u7684\u6539\u53d8\u90fd\u4f1a\u91cd\u542f\u8be5\u8d44\u6e90\uff0c\u4e0d\u7ba1\u4ed6\u4eec\u662f\u5426\u6709 <code>reloader.stakater.com/match : \"true\"</code>\u7684\u6ce8\u91ca\u3002</p> <pre><code>kind: Deployment\nmetadata:\n  annotations:\n    reloader.stakater.com/auto: \"true\"\nspec:\n  template: metadata:\n</code></pre>"},{"location":"2025/8sap/#_3","title":"\u5236\u5b9a\u66f4\u65b0","text":"<p>\u6307\u5b9a\u4e00\u4e2a\u7279\u5b9a\u7684configmap\u6216\u8005secret\uff0c\u53ea\u6709\u5728\u6211\u4eec\u6307\u5b9a\u7684\u914d\u7f6e\u56fe\u6216\u79d8\u5bc6\u88ab\u6539\u53d8\u65f6\u624d\u4f1a\u89e6\u53d1\u6eda\u52a8\u5347\u7ea7\uff0c\u8fd9\u6837\uff0c\u5b83\u4e0d\u4f1a\u89e6\u53d1\u6eda\u52a8\u5347\u7ea7\u6240\u6709\u914d\u7f6e\u56fe\u6216\u79d8\u5bc6\u5728\u90e8\u7f72\uff0c\u540e\u53f0\u767b\u5f55\u6216\u72b6\u6001\u8bbe\u7f6e\u4e2d\u4f7f\u7528\u3002</p> <p>\u4e00\u4e2a\u5236\u5b9a<code>deployment</code>\u8d44\u6e90\u5bf9\u8c61\uff0c\u5728\u5f15\u7528\u7684<code>configmap</code>\u6216\u8005<code>secret</code>\u79cd\uff0c\u53ea\u6709<code>reloader.stakater.com/match: \"true\"</code>\u4e3a<code>true</code>\u624d\u4f1a\u51fa\u53d1\u66f4\u65b0\uff0c\u4e3a<code>false</code>\u6216\u8005\u4e0d\u8fdb\u884c\u6807\u8bb0\uff0c\u8be5\u8d44\u6e90\u5bf9\u8c61\u90fd\u4e0d\u4f1a\u76d1\u89c6\u914d\u7f6e\u7684\u53d8\u5316\u800c\u91cd\u542f\u3002</p> <pre><code>kind: Deployment\nmetadata:\n  annotations:\n    reloader.stakater.com/search: \"true\"\nspec:\n  template:\n</code></pre>"},{"location":"2025/8sap/#cm","title":"\u6307\u5b9acm","text":"<p>\u4f8b\u5982\uff1a\u4e00\u4e2adeploy\u6709\u6302\u8f7d<code>nginx-cm1</code>\u548c<code>nginx-cm2</code>\u4e24\u4e2a<code>configmap</code>\uff0c\u53ea\u60f3<code>nginx-cm1</code>\u66f4\u65b0\u7684\u65f6\u5019deploy\u624d\u53d1\u751f\u6eda\u52a8\u66f4\u65b0\uff0c\u6b64\u65f6\u65e0\u9700\u5728\u4e24\u4e2acm\u4e2d\u914d\u7f6e\u6ce8\u89e3\uff0c\u53ea\u9700\u8981\u5728deploy\u4e2d\u5199\u5165<code>configmap.reloader.stakater.com/reload:nginx-cm1</code>\uff0c\u5176\u4e2d<code>nginx-cm1</code>\u5982\u679c\u53d1\u751f\u66f4\u65b0\uff0c<code>deploy</code>\u5c31\u4f1a\u89e6\u53d1\u6eda\u52a8\u66f4\u65b0\u3002</p> <p>\u5982\u679c\u591a\u4e2acm\u76f4\u63a5\u7528\u9017\u53f7\u9694\u5f00</p> <pre><code># configmap\u5bf9\u8c61\nkind: Deployment\nmetadata:\n  annotations:\n    configmap.reloader.stakater.com/reload: \"nginx-cm1\"\nspec:\n  template: metadata:\n</code></pre> <pre><code># secret\u5bf9\u8c61\nkind: Deployment\nmetadata:\n  annotations:\n    secret.reloader.stakater.com/reload: \"foo-secret\"\nspec:\n  template: metadata:\n</code></pre> <p>\u4e3a\u4e86\u964d\u4f4e <code>kube-apiserver</code> \u7684\u8d1f\u62c5\uff0cKubernetes \u4ece v1.19 \u5f00\u59cb\u81ea\u52a8\u5f00\u542f\u4e86 <code>ImmutableEphemeralVolumes</code> \u7279\u6027\uff0c\u5f00\u542f\u540e\u7981\u6b62 Secret \u548c ConfigMap \u7684\u81ea\u52a8\u66f4\u65b0</p> <p>\u8fd9\u4e9b\u914d\u7f6e\u901a\u5e38\u53ef\u4ee5\u5206\u4e3a\u4e24\u7c7b\uff1a\u4e00\u7c7b\u662f\u8bf8\u5982\u8fd0\u884c\u73af\u5883\u548c\u5916\u90e8\u4f9d\u8d56\u7b49\u975e\u654f\u611f\u914d\u7f6e\uff0c\u53e6\u4e00\u7c7b\u662f\u8bf8\u5982\u5bc6\u94a5\u548c SSH \u8bc1\u4e66\u7b49\u654f\u611f\u914d\u7f6e\u3002</p> <p>\u5bf9 Kubernetes \u5e94\u7528\u6765\u8bf4\uff0c\u654f\u611f\u914d\u7f6e\u63a8\u8350\u653e\u5230 Secret \u4e2d\uff0c\u800c\u975e\u654f\u611f\u914d\u7f6e\u63a8\u8350\u653e\u5230 ConfigMap\u4e2d \u3002</p> <p>Secret \u76f8\u5bf9\u4e8e ConfigMap \u6765\u8bf4\uff0c\u63d0\u4f9b\u4e86\u66f4\u591a\u7684\u6570\u636e\u5b89\u5168\u4fdd\u8bc1\u673a\u5236\u4ece\u800c\u66f4\u9002\u5408\u654f\u611f\u6570\u636e\u914d\u7f6e\uff1a</p> <p>Pod \u53ef\u4ee5\u901a\u8fc7 Volume \u548c\u73af\u5883\u53d8\u91cf\u4e24\u79cd\u65b9\u5f0f\u5f15\u7528 ConfigMap \u548c Secret\uff0c\u5e76\u4e14\u4ee5 Volume \u5f62\u5f0f\u6302\u8f7d\u540e\u8fd8\u652f\u6301\u70ed\u66f4\u65b0\u3002\u8fd9\u79cd\u70ed\u66f4\u65b0\u673a\u5236\u770b\u8d77\u6765\u975e\u5e38\u597d\uff0c\u4f46\u5728\u5b9e\u9645 DevOps \u6d41\u7a0b\u4e2d\u5b9e\u9645\u4e0a\u4e5f\u6709\u4e0d\u5c11\u7684\u95ee\u9898\uff0c\u9700\u8981\u4f7f\u7528\u7684\u65f6\u5019\u7279\u522b\u6ce8\u610f\u3002</p>"},{"location":"2025/8sap/#kubernetes","title":"Kubernetes\u70ed\u66f4\u65b0","text":"<p>\u4f7f\u7528 Secret \u548c ConfigMap \u6700\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u4ee5 Volume \u5f62\u5f0f\u6302\u8f7d\u5230 Pod \u4e2d\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4e5f\u652f\u6301\u81ea\u52a8\u66f4\u65b0\u3002</p> <p>\u4e0d\u8fc7\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u6302\u8f7d\u65f6\u4e0d\u8981\u4f7f\u7528 <code>subPath</code>\uff0c\u56e0\u4e3a\u4f7f\u7528 <code>subPath</code> \u4e4b\u540e\u5c31\u4e0d\u652f\u6301\u81ea\u52a8\u66f4\u65b0\u4e86\u3002</p> <p>\u4e3a\u4e86\u964d\u4f4e kube-apiserver \u7684\u8d1f\u62c5\uff0cKubernetes \u4ece v1.19 \u5f00\u59cb\u81ea\u52a8\u5f00\u542f\u4e86 ImmutableEphemeralVolumes \u7279\u6027\uff0c\u5f00\u542f\u540e\u7981\u6b62 Secret \u548c ConfigMap \u7684\u81ea\u52a8\u66f4\u65b0\uff1a</p> <p>\u56e0\u4e3a\u662f\u6587\u4ef6\u7684\u66f4\u65b0\uff0c\u5bb9\u5668\u5e94\u7528\u53ef\u4ee5\u7528 inotify \u673a\u5236\u76d1\u63a7\u6587\u4ef6\u7684\u53d8\u5316\u60c5\u51b5\uff0c\u8fdb\u800c\u518d\u52a0\u8f7d\u65b0\u914d\u7f6e\u3002\u6bd4\u5982\uff0c\u5bf9\u4e8e Go \u5e94\u7528\u6765\u8bf4\uff0c\u53ef\u4ee5\u4f7f\u7528 fsnotify \u5e93\u3002</p> <p>\u5f53\u7136\uff0c\u8fd9\u79cd\u65b9\u6cd5\u6709\u5f88\u591a\u9650\u5236\uff1a</p> <ul> <li>\u5927\u91cf ConfigMap \u548c Secret \u7684 watch \u8bf7\u6c42\u4f1a\u52a0\u91cd kube-apiserver \u7684\u8d1f\u8f7d\uff0c\u5f71\u54cd kube-apiserver \u7684\u6027\u80fd\u3002</li> <li> <ul> <li>\u4e0d\u652f\u6301\u6eda\u52a8\u66f4\u65b0\uff0c\u53ea\u8981 Secret \u548c ConfigMap \u66f4\u65b0\u4e86\uff0c\u6240\u6709\u4f7f\u7528\u4ed6\u4eec\u7684\u5bb9\u5668\u90fd\u4f1a\u5168\u90e8\u66f4\u65b0\u3002\u8fd9\u4f1a\u5bfc\u81f4\u914d\u7f6e\u9519\u8bef\u4e00\u4e0b\u5b50\u66f4\u65b0\u5230\u6240\u6709\u5bb9\u5668\uff0c\u800c\u4e0d\u662f\u6eda\u52a8\u66f4\u65b0\uff0c\u65e0\u6cd5\u5b9e\u73b0\u7b2c\u4e00\u4e2a Pod \u53d1\u73b0\u9519\u8bef\u65f6\u505c\u6b62\u540e\u7eed\u7684\u66f4\u65b0\u3002</li> </ul> </li> </ul> <pre><code>kind: Deployment\nmetadata:\n  annotations:\n    configmap.reloader.stakater.com/reload: \"foo-configmap\"\n     secret.reloader.stakater.com/reload: \"foo-secret\"\nspec:\n  template: metadata:\n</code></pre>"},{"location":"2025/8sap/#2-subpath-vs-path","title":"2. Subpath vs Path","text":"<p>Path refers to the absolute location within the container's filesystem where a volume or file will be mounted.</p> <p>It defines the destination directory or file path inside the container.</p> <pre><code>volumeMounts:\n  - name: my-volume\n    mountPath: /app/data\n</code></pre> <p>Here, the contents of the volume my-volume will be mounted at /app/data in the container.</p>"},{"location":"2025/8sap/#subpath","title":"Subpath","text":"<p>Subpath is used to mount a specific file or subdirectory from a volume into a container, rather than mounting the entire volume.</p> <p>It allows you to selectively mount a portion of the volume into the container.</p> <pre><code>volumeMounts:\n  - name: my-volume\n    mountPath: /app/config/file.txt\n    subPath: config/file.txt\n</code></pre> <p>Here, only the file <code>config/file.txt</code> from the volume my-volume is mounted at <code>/app/config/file.txt</code> in the container.</p> <p>Key Differences</p> Feature Path Subpath Purpose Defines the mount location in the container. Selectively mounts a specific file or subdirectory from the volume Scope Mounts the entire volume. Mounts only a part of the volume. Use Case When you want to mount the entire volume. When you need to mount a specific file or directory from the volume. <p>Suppose you have a volume with the following structure:</p> <pre><code>my-volume/\n  \u251c\u2500\u2500 config/\n  \u2502   \u2514\u2500\u2500 file.txt\n  \u2514\u2500\u2500 data/\n      \u2514\u2500\u2500 datafile.txt\n</code></pre> <p>Using path:</p> <pre><code>volumeMounts:\n  - name: my-volume\n    mountPath: /app\n</code></pre> <p>This will mount the entire my-volume (including <code>config/</code> and <code>data/</code>) to <code>/app</code> in the container.</p> <p>Using subpath:</p> <pre><code>volumeMounts:\n  - name: my-volume\n    mountPath: /app/config/file.txt\n    subPath: config/file.txt\n</code></pre> <p>This will mount only <code>config/file.txt</code> from my-volume to <code>/app/config/file.txt</code> in the container.</p>"},{"location":"2025/8sap/#3-configmap-change-at-the-same-time","title":"3. Configmap change at the same time","text":"<p>Can Multiple People Change a ConfigMap?</p> <p>Yes, multiple users or processes with the appropriate permissions can modify a ConfigMap. Kubernetes does not inherently restrict the number of users who can edit a ConfigMap, as long as they have the necessary RBAC (Role-Based Access Control) permissions.</p> <p>How Changes to a ConfigMap Affect Pods</p> <p>The behavior of a Pod when its associated ConfigMap is updated depends on how the ConfigMap is used:</p> <p>1 ConfigMap Mounted as a Volume:</p> <ul> <li> <p>If the ConfigMap is mounted as a volume into a Pod, changes to the ConfigMap are eventually propagated to the Pod.</p> </li> <li> <p>The update delay depends on the kubelet sync interval (default is ~1 minute).</p> </li> <li> <p>The Pod will see the updated ConfigMap data, but existing processes inside the container will not automatically restart unless explicitly configured to do so (e.g., using a sidecar or custom logic).</p> </li> </ul> <p>2.ConfigMap Used as Environment Variables</p> <ul> <li>If the ConfigMap is used to populate environment variables in a Pod, changes to the ConfigMap will not affect the Pod.</li> <li>Environment variables are injected into the Pod at creation time and are not updated dynamically.</li> </ul> <p>3.ConfigMap Used in subPath Mounts</p> <p>If a ConfigMap is mounted using subPath, </p> <ul> <li>changes to the ConfigMap will not be propagated to the Pod. </li> <li>This is because subPath mounts are treated as static files at the time of Pod creation.</li> </ul>"},{"location":"2025/8sap/#1-concurrent-updates","title":"1 Concurrent Updates:","text":"<p>Kubernetes uses an optimistic concurrency control mechanism for resources like ConfigMaps.</p> <p>When multiple users try to update the same ConfigMap at the same time, Kubernetes will process the updates one at a time.</p> <p>The first update will succeed, and subsequent updates will need to rebase their changes on the latest version of the ConfigMap.</p>"},{"location":"2025/8sap/#2-conflict-resolution","title":"2 Conflict Resolution:","text":"<p>If two users try to update the same ConfigMap simultaneously, the second user's update will fail unless they explicitly handle conflicts.</p> <p>Kubernetes uses a resource version field to track changes. If the resource version in the update request does not match the current version in the cluster, the update will be rejected with a conflict error.</p>"},{"location":"2025/8sap/#3-example-of-a-conflict","title":"3 Example of a Conflict:","text":"<ul> <li>User A fetches ConfigMap app-config with resource version 123.</li> <li>User B fetches ConfigMap app-config with resource version 123. </li> <li>User A updates the ConfigMap, and the resource version becomes 124.</li> <li>User B tries to update the ConfigMap but provides the old resource version (123). Kubernetes rejects the update with a conflict error.</li> </ul>"},{"location":"2025/8sap/#4-how-to-handle-concurrent-updates","title":"4 How to Handle Concurrent Updates","text":"<p>Retry Mechanism:</p> <p>If a user's update fails due to a conflict, they can:</p> <ul> <li>Fetch the latest version of the ConfigMap.</li> <li>Reapply their changes.</li> <li>Retry the update.</li> </ul> <p>Patch Instead of Replace:</p> <p>Instead of replacing the entire ConfigMap, use a patch operation to update only specific fields. This reduces the likelihood of conflicts.</p> <pre><code>kubectl patch configmap app-config --patch '{\"data\":{\"key\":\"new-value\"}}'\n</code></pre>"},{"location":"2025/8sap/#impact-on-pods","title":"Impact on Pods","text":"<p>If multiple users successfully update the ConfigMap, the changes will propagate to the Pods depending on how the ConfigMap is used:</p> <ul> <li> <p>Volume Mounts: Changes will eventually propagate to the Pod (after the kubelet sync interval).</p> </li> <li> <p>Environment Variables: Changes will not affect the Pod unless it is restarted.</p> </li> <li> <p>SubPath Mounts: Changes will not affect the Pod.</p> </li> </ul> <p>Yes, multiple users can attempt to change a ConfigMap at the same time, but Kubernetes will process the updates sequentially to avoid conflicts. If conflicts occur, users need to handle them by fetching the latest version and retrying their updates. Proper coordination and conflict resolution mechanisms are essential when multiple users are working with the same ConfigMap. Let me know if you need further clarification!</p>"},{"location":"2025/9db_interview/","title":"9 \u6570\u636e\u5e93\u9762\u8bd5","text":""},{"location":"2025/9db_interview/#1","title":"1 \u6570\u636e\u5e93\u6162\u67e5\u8be2\u6fc0\u589e\u600e\u4e48\u529e","text":""},{"location":"2025/9db_interview/#1_1","title":"1\u3001\u95ee\u9898\u5b9a\u4f4d\uff1a\u4ece\u544a\u8b66\u5230\u6839\u56e0\u7684\u7cbe\u51c6\u72d9\u51fb","text":"<p>1. \u5feb\u901f\u6b62\u8840\uff1a\u5efa\u7acb\u5e94\u6025\u54cd\u5e94\u673a\u5236</p> <p>\u901a\u8fc7\u76d1\u63a7\u5e73\u53f0\uff08\u5982Prometheus + Grafana\uff09\u6355\u83b7\u6570\u636e\u5e93QPS\u7a81\u589e\u3001CPU\u4f7f\u7528\u7387\u8d85\u9608\u503c\uff08&gt;80%\uff09\u3001\u6162\u67e5\u8be2\u6570\u91cf\u6fc0\u589e\uff08\u5982MySQL <code>Slow_queries</code>\u6bcf\u5206\u949f\u8d85\u8fc7100\u6b21\uff09</p> <pre><code>-- \u5b9e\u65f6\u76d1\u63a7\u6162\u67e5\u8be2\u6570\u91cf\nSHOW GLOBAL STATUS LIKE 'Slow_queries';\n</code></pre> <p>\u7d27\u6025\u9650\u6d41</p> <p>\u7acb\u5373\u9650\u5236\u9ad8\u5371\u64cd\u4f5c\u7684\u5e76\u53d1\u91cf\uff0c\u9632\u6b62\u96ea\u5d29\u6548\u5e94\uff1a</p> <pre><code>-- \u52a8\u6001\u9650\u5236\u6700\u5927\u8fde\u63a5\u6570\uff08\u4e34\u65f6\u964d\u4f4e\u81f3200\uff09\nSET GLOBAL max_connections = 200;\n\n-- \u4f7f\u7528pt-kill\u7ec8\u6b62\u8017\u65f6\u8d85\u8fc710\u79d2\u7684\u67e5\u8be2\npt-kill --busy-time 10 --kill --victims all --print h=127.0.0.1\n</code></pre>"},{"location":"2025/9db_interview/#2","title":"2. \u6839\u56e0\u5206\u6790\uff1a\u5de5\u5177\u94fe\u7ec4\u5408\u62f3","text":"<p>\u6162\u65e5\u5fd7\u5206\u6790</p> <p>\u63d0\u53d6Top 10\u6162\u67e5\u8be2\uff0c\u5b9a\u4f4d\u95ee\u9898SQL\uff1a</p> <pre><code># \u6309\u603b\u8017\u65f6\u6392\u5e8f\u6162\u67e5\u8be2\nmysqldumpslow -s t -t 10 /var/log/mysql/slow.log\n</code></pre> <pre><code>Count: 200  Time=5.12s (1024s)  Lock=0.00s (0s)  Rows=100.0 (20000), user@host\n  SELECT * FROM orders WHERE status='pending' AND create_time &gt; '2023-01-01';\n</code></pre> <p>\u6267\u884c\u8ba1\u5212\u89e3\u8bfb</p> <p>\u4f7f\u7528EXPLAIN\u5206\u6790\u7d22\u5f15\u6709\u6548\u6027</p> <pre><code>EXPLAIN SELECT * FROM orders WHERE status='pending';\n</code></pre> <p>\u5173\u952e\u6307\u6807\uff1a</p> <ul> <li>type: ALL \u2192 \u5168\u8868\u626b\u63cf\uff0c\u9700\u6dfb\u52a0\u7d22\u5f15</li> <li>Extra: Using filesort \u2192 \u6392\u5e8f\u903b\u8f91\u9700\u4f18\u5316</li> </ul> <p>\u8d44\u6e90\u74f6\u9888\u5b9a\u4f4d</p> <p>\u6392\u67e5\u670d\u52a1\u5668\u8d44\u6e90\u662f\u5426\u8fc7\u8f7d\uff1a</p> <pre><code>top -c           # \u67e5\u770bCPU\u5360\u7528\u6700\u9ad8\u7684\u8fdb\u7a0b\niostat -x 1     # \u76d1\u63a7\u78c1\u76d8I/O\uff08%util &gt; 90%\u8868\u793a\u74f6\u9888\uff09\ndstat --tcp      # \u68c0\u67e5\u7f51\u7edc\u8fde\u63a5\u6570\u6fc0\u589e\n</code></pre>"},{"location":"2025/9db_interview/#2_1","title":"2\u3001\u95ee\u9898\u89e3\u51b3\uff1a\u7cbe\u51c6\u4f18\u5316\u4e0e\u67b6\u6784\u5347\u7ea7","text":""},{"location":"2025/9db_interview/#1-sql","title":"1. SQL\u4e0e\u7d22\u5f15\u4f18\u5316","text":"<pre><code>ALTER TABLE orders ADD INDEX idx_status_create_time (status, create_time);\n</code></pre> <p>\u7d22\u5f15\u5931\u6548\u6848\u4f8b</p> <ul> <li>\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\uff1a<code>WHERE user_id = '123'</code>\uff08user_id\u4e3aINT\uff09 \u2192 \u79fb\u9664\u5f15\u53f7</li> <li>\u7d22\u5f15\u5217\u8fd0\u7b97\uff1a<code>WHERE YEAR(create_time) = 2023</code> \u2192 \u6539\u5199\u4e3a\u8303\u56f4\u67e5\u8be2</li> </ul> <p>SQL\u91cd\u5199\u6280\u5de7</p> <p>\u4f18\u5316\u590d\u6742\u5b50\u67e5\u8be2\u4e3aJOIN\u64cd\u4f5c\uff1a</p> <pre><code>-- \u539f\u8bed\u53e5\uff08\u8017\u65f65s\uff09\nSELECT * FROM orders WHERE status IN (SELECT status FROM config WHERE type='order');\n\n-- \u4f18\u5316\u4e3aJOIN\uff08\u8017\u65f60.2s\uff09\nSELECT o.* FROM orders o \nJOIN config c ON o.status = c.status \nWHERE c.type='order'\n</code></pre>"},{"location":"2025/9db_interview/#2_2","title":"2. \u6570\u636e\u5e93\u53c2\u6570\u8c03\u4f18","text":"<p>InnoDB\u5f15\u64ce\u4f18\u5316</p> <pre><code># my.cnf\u8c03\u6574\u793a\u4f8b\ninnodb_buffer_pool_size = 80G       # \u7269\u7406\u5185\u5b58\u768470%~80%\ninnodb_flush_log_at_trx_commit = 2  # \u5e73\u8861\u6027\u80fd\u4e0e\u6301\u4e45\u5316\n</code></pre> <p>\u8fde\u63a5\u6c60\u914d\u7f6e</p> <pre><code># \u5e94\u7528\u7aef\u914d\u7f6e\uff08HikariCP\uff09\nmaximumPoolSize: 100\nconnectionTimeout: 3000\n</code></pre>"},{"location":"2025/9db_interview/#3","title":"3. \u67b6\u6784\u7ea7\u89e3\u51b3\u65b9\u6848","text":"<p>\u8bfb\u5199\u5206\u79bb</p> <pre><code>App \u2192 ProxySQL \u2192 MySQL Master\uff08\u5199\uff09\n                  \u2198 MySQL Replica1\uff08\u8bfb\uff09\n                  \u2198 MySQL Replica2\uff08\u8bfb\uff09\n</code></pre> <p>\u5206\u5e93\u5206\u8868</p> <ul> <li>\u5782\u76f4\u62c6\u5206\uff1a\u6309\u4e1a\u52a1\u6a21\u5757\u62c6\u5206\uff08\u8ba2\u5355\u5e93\u3001\u7528\u6237\u5e93\uff09</li> <li>\u6c34\u5e73\u62c6\u5206\uff1a\u6309\u65f6\u95f4\u6216ID\u8303\u56f4\u5206\u7247\uff08<code>orders_2023</code>\u3001<code>orders_2024</code>\uff09</li> </ul>"},{"location":"2025/9db_interview/#3_1","title":"3\u3001\u56e2\u961f\u534f\u4f5c\uff1a\u4ece\u6545\u969c\u5230\u9884\u9632\u7684\u95ed\u73af","text":"<p>1. \u6545\u969c\u590d\u76d8\u6a21\u677f</p> <p>\u9636\u6bb5  \u5173\u952e\u52a8\u4f5c  \u8f93\u51fa\u7269</p> <ul> <li>\u5e94\u6025 |  \u9650\u6d41\u3001\u56de\u6eda\u3001\u6269\u5bb9 | \u6545\u969c\u65f6\u95f4\u7ebf\u8bb0\u5f55</li> <li>\u6839\u56e0 |   SQL\u5206\u6790\u3001\u8d44\u6e90\u76d1\u63a7\u3001\u4ee3\u7801Review |  \u6839\u56e0\u5206\u6790\u62a5\u544a</li> <li>\u6539\u8fdb |   \u7d22\u5f15\u4f18\u5316\u3001\u53c2\u6570\u8c03\u6574\u3001\u67b6\u6784\u5347\u7ea7 | \u6280\u672f\u65b9\u6848PRD</li> <li>\u9884\u9632 | \u6162\u67e5\u8be2\u65e5\u62a5\u3001\u538b\u6d4b\u6d41\u7a0b\u3001\u5de1\u68c0\u81ea\u52a8\u5316 | \u5de1\u68c0\u811a\u672c+\u76d1\u63a7\u770b\u677f</li> </ul> <p>2. \u957f\u6548\u9884\u9632\u673a\u5236</p> <pre><code>-- \u751f\u6210\u6bcf\u65e5\u6162\u67e5\u8be2TOP 10\npt-query-digest /var/log/mysql/slow.log --filter '$event-&gt;{arg} =~ m/WHERE/' --limit 10\n</code></pre> <p>\u81ea\u52a8\u5316\u5de1\u68c0</p> <pre><code># \u4f2a\u4ee3\u7801\uff1a\u68c0\u67e5\u7f3a\u5931\u7d22\u5f15\nfor table in get_all_tables():\n    if not has_index(table, 'status'):\n        send_alert(f\"\u8868 {table} \u7f3a\u5c11status\u5b57\u6bb5\u7d22\u5f15\")\n</code></pre>"},{"location":"2025/sre/0interview/","title":"1 SRE \u9762\u8bd5","text":""},{"location":"2025/sre/0interview/#1-linux","title":"1 Linux \u5982\u4f55\u67e5\u770b\u548c\u6740\u6b7b\u8fdb\u7a0b","text":"<pre><code>ps -aux \nps -ef\n\n# pid \u7236\u8fdb\u7a0bpid, \u8fdb\u7a0b\u542f\u52a8\u65f6\u95f4\uff0c \u8c01\u542f\u52a8\u8fd9\u4e2a\u8fdb\u7a0b\n\ntop  #\u5b9e\u65f6\u4fe1\u606f\n\nkill / kill -9\n</code></pre>"},{"location":"2025/sre/0interview/#2-and","title":"2 \u786c\u94fe\u63a5and\u8f6f\u8fde\u63a5","text":"<ul> <li> <p>\u786c\u94fe\u63a5 \u662f\u540c\u4e00\u4e2a\u6587\u4ef6\u4e0d\u540c\u7684\u8bbf\u95ee\u5165\u53e3 \u6240\u6709\u7684\u94fe\u63a5\u90fd\u5171\u4eab\u4e00\u4e2ainode \u548c\u540c\u4e00\u4e2a\u6570\u636e\u5757</p> </li> <li> <p>\u8f6f\u8fde\u63a5\u66f4\u50cf\u4e00\u4e2a\u6587\u4ef6\u7684\u5feb\u6377\u8bbf\u95ee\uff0c\u5b58\u50a8\u6e90\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u4e00\u65e6\u6e90\u6587\u4ef6\u5220\u6389\uff0c\u8f6f\u8fde\u63a5\u5c31\u5931\u6548</p> </li> </ul>"},{"location":"2025/sre/0interview/#3-linux","title":"3 \u5e38\u7528\u7684Linux \u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b","text":"<p>\u4e3b\u8981\u6709\u4e24\u4e2a</p> <ul> <li>1 EXT4 \u6700\u5927\u652f\u63011EB\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c16TB\u7684\u6587\u4ef6\u5927\u5c0f\uff0c \u7279\u70b9\u662f\u5ef6\u8fdf\u5206\u914d\uff0c\u6709\u6570\u636e\u5199\u5165\u624d\u4f1a\u5206\u914d\u4e00\u5757\u7a7a\u95f4</li> <li>2 XFS \u9ad8\u6027\u80fd\u6587\u4ef6\u7cfb\u7edf\uff0c\u80fd\u591f\u5904\u7406\u975e\u5e38\u9ad8\u5e76\u53d1\u7684\u9540\u9521\u64cd\u4f5c</li> </ul>"},{"location":"2025/sre/0interview/#4-linux","title":"4 Linux\u4e2d\u914d\u7f6e\u7a0b\u5e8f\u5f00\u673a\u81ea\u542f\u52a8","text":"<p>1 rc.local \u6587\u4ef6\u91cc\u9762\u52a0\u5165 \u811a\u672c\u542f\u52a8\u7684\u547d\u4ee4 \u5f00\u673a\u8fc7\u7a0b\u4e2d\uff0c\u7cfb\u7edf\u4f1a\u9ed8\u8ba4\u52a0\u8f7d\u8fd9\u4e2a\u7cfb\u7edf</p> <p>2 \u628a\u811a\u672c\u505a\u51fa\u7cfb\u7edf\u670d\u52a1\uff0c \u521b\u5efa\u4e00\u4e2aservice \u6587\u4ef6\uff0c\u628a\u542f\u52a8\u811a\u672c\u7684\u4e00\u4e9b\u547d\u4ee4\u5199\u8fdb\u53bb</p> <p>Systeml enable \u6765\u8bbe\u7f6e\u5b83\u7684\u5f00\u673a\u81ea\u542f\u52a8</p>"},{"location":"2025/sre/0interview/#5-cpu","title":"5 CPU \u7a81\u7136\u98d9\u5347","text":"<ol> <li>Top \u6240\u6709\u8fdb\u7a0b\u7684\u8be6\u7ec6\u60c5\u51b5\uff0c\u627e\u5230CPU\u5360\u7528\u7387\u9ad8\u7684\u8fdb\u7a0b\uff0c\u8fdb\u5165\u8fdb\u7a0b\u6240\u5728\u7684\u76ee\u5f55</li> <li>\u67e5\u770b\u65e5\u5fd7 \u7ed3\u5408 strce -p pid /  perf top -p pid</li> <li>\u7b2c\u4e09\u65b9\u7a0b\u5e8f\uff0c kill</li> </ol>"},{"location":"2025/sre/0interview/#6","title":"6 \u7f51\u7ad9\u8bbf\u95ee\u6162","text":"<ol> <li>\u7f51\u7edc\u8d44\u6e90  ping \u5916\u7f51</li> <li>\u670d\u52a1\u5668\u786c\u4ef6\u8d44\u6e90 top</li> <li>\u8f6f\u4ef6\u672c\u8eab \u65e5\u5fd7\u67e5\u770b</li> <li>\u6570\u636e\u5757\u67e5\u8be2\u6162 \u6570\u636e\u5757\u6027\u80fd\u67e5\u8be2\u5de5\u5177</li> </ol>"},{"location":"2025/sre/0interview/#7-nginx","title":"7 Nginx \u8d1f\u8f7d\u6a21\u5f0f","text":"<p>\u8f6e\u8be2 / \u52a0\u6743\u8f6e\u8be2 / ip hash / \u6700\u5c11\u94fe\u63a5 / \u52a0\u6743\u6700\u5c11\u94fe\u63a5</p>"},{"location":"2025/sre/0interview/#8-keepalived","title":"8 keepalived \u5de5\u4f5c\u539f\u7406","text":"<p>VRRP \u534f\u8bae\u9009\u4e3e\u51fa\u6765\u4e00\u4e2amaster \u4e3b\u8282\u70b9\u548c\u591a\u4e2abackup\u8282\u70b9</p> <p>\u4e3b\u8282\u70b9\u8d1f\u8d23\u6d41\u91cf\u5206\u914d \u540c\u65f6\u7ed9\u4e0b\u9762\u7684backup\u8282\u70b9\u53d1\u9001vrrp \u534f\u8bae\u52a0\u5bc6\u901a\u544a\u4fe1\u606f</p> <p>\u5f53backup\u8282\u70b9\u641c\u4e0d\u5230\u901a\u544a\u4fe1\u606f\uff0c\u5c31\u8ba4\u4e3amater \u8282\u70b9\u4e0d\u53ef\u7528\uff0c \u4f18\u5148\u7ea7\u6700\u9ad8\u7684backup \u8282\u70b9\u5c31\u4f1a\u6210\u4e3a\u65b0\u7684master</p>"},{"location":"2025/sre/0interview/#9-lvs-vs-nginx-vs-haproxy","title":"9 LVS vs Nginx vs Haproxy","text":"<p>LVS: \u56db\u5c42\u8f6c\u53d1\uff0c url \u4e0d\u53ef\u8f6c\u53d1</p> <p>Haproxy \u4e03\u5c42\u8f6c\u53d1 \u4e13\u4e1a\u4ee3\u7406\u670d\u52a1\u5668</p> <p>Nginx web \u670d\u52a1\u5668 \uff0c\u652f\u6301 4+7\u5c42\u8f6c\u53d1</p>"},{"location":"2025/sre/0interview/#10-mysql","title":"10 \u63d0\u9ad8Mysql\u7684\u5b89\u5168\u6027","text":"<ol> <li>\u4fee\u6539mysql\u9ed8\u8ba4\u7aef\u53e3\uff0c\u4e0d\u4f7f\u75283306</li> <li>\u8bbe\u7f6e\u8bbf\u95eeip\u767d\u540d\u5355\uff0c\u5355\u53f0\u670d\u52a1\u5668\u53ea\u5141\u8bb8127\u8bbf\u95ee</li> <li> <p>\u8bbe\u7f6emysql root\u7528\u6237\u4e3a\u5f3a\u5bc6\u7801\uff0c\u4e14\u53ea\u5141\u8bb8\u901a\u8fc7\u672c\u5730\u8fde\u63a5</p> </li> <li> <p>\u4e3a\u5e94\u7528\u6570\u636e\u5e93\u8bbe\u7f6e\u72ec\u7acb\u7684\u94fe\u63a5\u8d26\u53f7\uff0c\u4e14\u4ee5\u6700\u5c0f\u6743\u9650\u539f\u5219\u8fdb\u884c\u6743\u9650\u914d\u7f6e\uff0c\u4ec5\u5141\u8bb8\u64cd\u4f5c\u81ea\u5df1\u5e94\u7528\u76f8\u5173\u7684\u6570\u636e</p> </li> <li> <p>\u5728\u670d\u52a1\u7a0b\u5e8f\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u4e0d\u5141\u8bb8\u4f7f\u7528\u660e\u6587\u914d\u7f6e mysql \u5bc6\u7801\uff0c\uff08\u6211\u4eec\u4e00\u822c\u7528aes \u7b97\u6cd5 \u914d\u7f6e\u6587\u4ef6\u91cc\u9762\u5b58\u5bc6\u6587\uff09</p> </li> <li> <p>\u5173\u6ce8 \u6570\u636e\u5e93\u76f8\u5173cve\u6f0f\u6d1e\u4fe1\u606f\uff0c\u5bf9\u51fa\u73b0\u7684\u5b89\u5168\u95ee\u9898\u8fdb\u884c\u53ca\u65f6\u5904\u7406\u3002</p> </li> <li> <p>\u82e5\u6570\u636e\u5e93\u94fe\u63a5\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\uff0c\u5219\u9700\u8981\u914d\u7f6e ssl \u52a0\u5bc6\u4f20\u8f93</p> </li> </ol>"},{"location":"2025/sre/0interview/#11","title":"11 \u6808\u5185\u5b58\u548c\u5806\u5185\u5b58\u7684\u533a\u522b","text":"<p>\u6808\u5185\u5b58\u5b58\u50a8\u6bd4\u8f83\u5c0f\u7684\u4e1c\u897f\uff0clike\u8c03\u5165\u4e00\u4e2a\u51fd\u6570\uff0c\u628a\u51fd\u6570\u7684\u53c2\u6570\u4fe1\u606f\u653e\u5728\u6808\u5185\u5b58\uff0c\u5f53\u51fd\u6570\u8c03\u7528\u7ed3\u675f\uff0c\u6808\u5185\u5b58\u4f1a\u88ab\u91ca\u653e\u6389</p> <p>\u9012\u5f52\u51fd\u6570\u4e00\u76f4\u88ab\u8c03\u7528\uff0c\u4f1a\u5bfc\u81f4\u6808\u5185\u5b58\u7684\u6ea2\u51fa\uff0c </p> <p>\u5806\u5185\u5b58\u5b58\u50a8\u4e00\u822c\u6bd4\u8f83\u5927\u7684\u7684\u6570\u636e\uff0c\u6216\u8005\u4e0d\u786e\u5b9a\u5927\u5c0f\u7684\u6570\u636e\u3002\u65b0\u5efa\u4e00\u4e2a\u5bf9\u8c61\u7528\u6765\u5b58\u50a8\u6570\u636e\u7684\u94fe\u8868</p>"},{"location":"2025/sre/0interview/#12-raid","title":"12 RAID \u662f\u4ec0\u4e48","text":"<p>\u5b58\u50a8\u865a\u62df\u5316\u7684\u6280\u672f\uff0c\u591a\u4e2a\u7269\u7406\u78c1\u76d8\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u5f62\u6210\u4e00\u4e2a\u903b\u8f91\u4e0a\u5b58\u50a8\u5355\u5143\uff0c\u5b58\u50a8\u91cf\u53d8\u5927\uff0c\u5b89\u5168\u6027\u63d0\u9ad8</p> <p>RAID0 \u628a\u6570\u636e\u5206\u6563\u5230\u4e0d\u540c\u7684\u786c\u76d8\u4e2d\uff0c\u63d0\u9ad8\u6027\u80fd\uff0c\u4f46\u662f\u5b89\u5168\u6027\u4e0d\u9ad8 \u67d0\u4e00\u5757\u574f\u4e86\uff0c\u6570\u636e\u4e22\u5931</p> <p>RAID1 \u6570\u636e\u5b8c\u6574\u7684\u5728\u590d\u5236\u4e00\u4efd\uff0c\u5b58\u4e0b\u6765\uff0c\u5bf9\u4e8e\u5927\u7684\u903b\u8f91\u786c\u76d8\u6bcf\u4e2a\u6570\u636e\u662f\u5b58\u4e86\u4e24\u4efd  \u5229\u7528\u738750%</p> <p>RAID5 \u5947\u5076\u6821\u9a8c\u548c\u6570\u636e\u4fe1\u606f\uff0c \u90fd\u4f1a\u4f1a\u5b58\u5728\u591a\u4e2a\u786c\u76d8\u5f53\u4e2d\uff0c\u4e00\u5757\u574f\u4e86\uff0c\u4e5f\u80fd\u6839\u636e\u5947\u5076\u6821\u9a8c\u4fe1\u606f\u6062\u590d</p>"},{"location":"2025/sre/0interview/#13-du-vs-df","title":"13 du vs df","text":"<p>Du \u67e5\u770b\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\u3002 \u4fbf\u5229\u4e00\u4e2a\u76ee\u5f55\u5730\u4e0b\u6240\u6709\u7684\u6587\u4ef6\u3002 \u8ba1\u7b97\u7edf\u8ba1\u8fd9\u4e9b\u4e1c\u897f\uff0c\u6240\u6709\u52a0\u5728\u4e00\u8d77\uff0c\u5360\u4e86\u591a\u5c11\u7a7a\u95f4</p> <p>Df \u663e\u793a\u6587\u4ef6\u7cfb\u7edf\u6240\u6709\u7684\u603b\u7a7a\u95f4\uff0c \u5df2\u7ecf\u4f7f\u7528\u7684\u7a7a\u95f4\u548c\u5269\u4f59\u7684\u7a7a\u95f4\u3002 \u57fa\u4e8e\u6587\u4ef6\u7cfb\u7edf\u7684\u5143\u6570\u636e\uff0c \u6765\u8ba1\u7b97\u78c1\u76d8\u7a7a\u95f4\u7684\u3002</p> <p>\u5f53\u6587\u4ef6\u6709\u591a\u4e2a\u786c\u94fe\u63a5\uff0cdu\u4f1a\u8ba1\u7b97\u5f88\u591a\u6b21\uff0cdf \u53ea\u8ba1\u7b97\u4e00\u6b21</p> <p>\u6587\u4ef6\u88ab\u5220\u9664\uff0c du \u5224\u65ad\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u5b58\u5728\u4e86\uff0c \u7a7a\u95f4\u4e0d\u4f1a\u88ab\u8ba1\u7b97  df \u6574\u4e2a\u7cfb\u7edf\u5c42\u9762\u6765\u8ba1\u7b97\uff0c\u5b83\u8ba4\u4e3a\u8fd9\u4e2a\u7a7a\u95f4\u88ab\u5360\u7528\u4e86</p>"},{"location":"2025/sre/0interview/#14","title":"14 \u8fdb\u7a0b\u4f18\u5148\u7ea7","text":"<p>\u9759\u6001\u7684 \u8bbe\u7f6e\u4f18\u5148\u7ea7 nice </p> <p>\u6b63\u5728\u8fd0\u884c\u7684renice -n nice -p pid </p>"},{"location":"2025/sre/0interview/#15-mysql","title":"15 Mysql\u4e3b\u4ece","text":"<p>\u6570\u636e\u540c\u6b65\u65b9\u5f0f </p> <p>Master \u8bb0\u5f55\u6240\u6709\u7684\u64cd\u4f5c\u65b9\u5f0f\uff0c\u4fdd\u5b58\u5728binlog \u65e5\u5fd7\u91cc\u9762\uff0c\u4e00\u4e2a\u4e8c\u8fdb\u5236\u7684\u6587\u4ef6</p> <p>\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u4f1a\u628a\u4e8c\u8fdb\u5236\u6587\u4ef6\u4f20\u7ed9slave. Slave \u8bfb\u53d6\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u628a\u4fe1\u606f\u8bb0\u5f55\u4e0b\u6765\uff0c\u4fdd\u8bc1\u4e86master\u8282\u70b9\u548cslave \u8282\u70b9\u4fe1\u606f\u7684\u4e00\u81f4</p>"},{"location":"2025/sre/0interview/#16-pdo-pending","title":"16 PDO pending \u7684\u539f\u56e0","text":"<ol> <li>\u786c\u4ef6\u8d44\u6e90\u4e0d\u8db3</li> <li>\u955c\u50cf\u83b7\u53d6\u5931\u8d25</li> <li>\u7f51\u7edc\u63d2\u4ef6\u7684\u539f\u56e0\uff0c\u7f51\u7edc\u65e0\u6cd5\u94fe\u63a5</li> <li>pod\u9700\u8981\u7ed1\u5b9a\u4e00\u4e2aPVC\uff0c \u4f46\u662f\u73b0\u5728\u6ca1\u6709\u53ef\u7528\u7684\u3002Pod\u521b\u5efa\u7684\u8bf7\u6c42\uff0cscheduler \u6ca1\u6709\u6765\u5f97\u53ca\u53bb\u5904\u7406\u5b83\uff0c\u6ca1\u6709\u627e\u5230\u5408\u9002\u8d44\u6e90\u548cnode</li> </ol>"},{"location":"2025/sre/0interview/#17-shell","title":"17 shell\u7684\u4e09\u5251\u5ba2","text":"<p>1 grep -&gt; \u641c\u7d22</p> <pre><code>grep \u201cerror\u201d app.log\n</code></pre> <p>2 sed -&gt; \u52a0\u8f7d\u6570\u636e\u548c\u5220\u9664\uff0c\u66ff\u6362</p> <pre><code># A\u66ff\u6362\u6210B\nsed -i 's/A/B/g' app.txt\n\n# \u628aC\u5220\u9664\nsed -i /s/C//g' app.txt\n</code></pre> <p>2 awk -&gt; \u628a\u6587\u4ef6\u6309\u884c\u7684\u5f62\u5f0f\u5168\u90e8\u8bfb\u53d6\u51fa\u6765</p> <ul> <li>\u9ed8\u8ba4\u7a7a\u683c\u8fdb\u884c\u5207\u8fb9</li> <li>-F \u53c2\u6570\u6307\u5b9a\u4e00\u4e2a\u5206\u9694\u7b26<ul> <li>if \u5224\u65ad</li> <li>begin end</li> </ul> </li> </ul>"},{"location":"2025/sre/0interview/#18-top","title":"18 top \u5c55\u793a\u90a3\u4e9b\u4fe1\u606f","text":"<p>Top \u5c55\u793a\u7cfb\u7edf\u7684\u662f\u5b9e\u4f53\u4fe1\u606f</p> <ol> <li>\u65f6\u95f4\uff0c\u7528\u6237\uff0c\u8d1f\u8f7d</li> <li>\u8fdb\u7a0b</li> <li>CPU</li> <li>\u5185\u5b58</li> <li>\u4ea4\u6362\u533a</li> <li>\u5177\u4f53\u8fdb\u7a0b\u7684\u72b6\u6001 \uff08\u4f18\u5148\u7ea7\uff0c PID)</li> </ol>"},{"location":"2025/sre/0interview/#19-proc","title":"19 proc \u76ee\u5f55","text":"<p>\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u5b58\u50a8\u7cfb\u7edf\u5f53\u65f6\u8fd0\u884c\u7684\u4e00\u4e2a\u72b6\u6001</p>"},{"location":"2025/sre/0interview/#20-pod","title":"20 pod\u7684\u72b6\u6001","text":"<p>Pending  running succeeded Failed Unknown</p>"},{"location":"2025/sre/0interview/#21-pod","title":"21 pod\u5982\u4f55\u901a\u4fe1","text":"<p>1.\u4e0d\u540c\u7684pod\u540c\u4e00\u4e2a\u8282\u70b9\u4e2d</p> <ul> <li>\u901a\u8fc7Node\u8282\u70b9\u7684\u672c\u5730\u7f51\u7edc\u8fdb\u884c\u901a\u4fe1</li> <li>pod\u7684IP\u5730\u5740\u8fdb\u884c\u901a\u4fe1</li> </ul> <p>1.\u4e0d\u540c\u7684pod\u5728\u4e0d\u540c\u7684\u8282\u70b9\uff08Node)</p> <ul> <li>pod\u7684IP\u5730\u5740\u8fdb\u884c\u901a\u4fe1</li> <li>\u901a\u8fc7service \u901a\u4fe1</li> <li>\u8de8\u8282\u70b9\u7684\u7f51\u7edc\u63d2\u4ef6</li> <li>k8s\u96c6\u7fa4\u4e2d\u5fe7\u6709\u4e00\u4e2a\u8def\u7531\u8868</li> </ul>"},{"location":"2025/sre/0interview/#21-scheduler","title":"21 Scheduler \u8c03\u5ea6\u6d41\u7a0b","text":"<p>Scheduler \u6301\u7eed\u76d1\u542cAPI server \u7684\u5b9e\u7269\u72b6\u6001</p> <p>\u4e00\u65e6\u6709\u4e00\u4e2a\u88ab\u8c03\u5ea6\u7684pod\u6216\u8005\u6b63\u5728\u8fd0\u884c\u7684pod\u9700\u8981\u88ab\u8c03\u5ea6</p> <ol> <li>\u7b5b\u9009Node,\u7b5b\u9009Node, \u96f6\u5bb9\u5fcd\uff0c\u5b58\u50a8\u7b49\u4e0b\u65b0 =\u300b \u7b5b\u9009\u96c6</li> <li>\u6839\u636e\u7b56\u7565\u5339\u914dNode\uff0c\u786e\u5b9anode\u8282\u70b9\u4e4b\u540e\u3002pod\u4fe1\u606f\u548cNode\u8282\u70b9\u8fdb\u884c\u7ed1\u5b9a\u5199\u5165Etcd\u4e2d</li> </ol>"},{"location":"2025/sre/0interview/#22-nginx-ip","title":"22 Nginx \u5982\u4f55\u627e\u51fa\u8bbf\u95ee\u6b21\u6570\u6700\u591a\u7684IP","text":"<p>Nginx \u7684 access.log \u6bcf\u6b21\u8bbf\u95ee\u90fd\u4f1a\u8bb0\u5f55\u4e00\u6761\u6570\u636e</p> <p><code>awk uniq -c</code> \u5faa\u73af\u7684\u53bb\u7edf\u8ba1\u6bcf\u4e00\u4e2aIP\u7684\u8bbf\u95ee\u6b21\u6570  \uff0c <code>sort -nr</code> \u8fdb\u884c\u6392\u5e8f</p> <p><code>head -n 1</code> \u547d\u4ee4\u8f93\u51fa\u7b2c\u4e00\u884c IP\u8bbf\u95ee\u6700\u9ad8\u7684\u5730\u5740</p>"},{"location":"2025/sre/0interview/#23-mysql","title":"23 Mysql \u4e3b\u4ece\u6709\u5ef6\u8fdf\u600e\u4e48\u529e","text":"<ol> <li>\u5bf9\u6bd4\u4e3b\u4ece\u670d\u52a1\u5668\u7684\u786c\u4ef6\u914d\u7f6e\uff0c\u4e3b\u670d\u52a1\u5668\u7684\u8d1f\u8f7d\u60c5\u51b5\uff0c\u8d1f\u8f7d\u91cf\u6bd4\u8f83\u5927\u3002 Binlog \u65e5\u5fd7\u5199\u5165\u4f1a\u6709\u5ef6\u8fdf</li> <li>\u6570\u636e\u5e93\u7684\u6027\u80fd\u76d1\u63a7\u5de5\u5177\uff0c\u662f\u5426\u5b58\u5728\u5f88\u591a\u6162SQL</li> <li>\u4ece\u7f51\u7edc\u5c42\u9762\uff0c\u662f\u5426\u5fe7\u7f51\u7edc\u5ef6\u8fdf</li> <li>\u4e3b\u4ece\u670d\u52a1\u65f6\u95f4\u4e0d\u4e00\u81f4</li> </ol>"},{"location":"2025/sre/0interview/#23-tcp-time_wait","title":"23 TCP TIME_WAIT","text":"<p>TCP \u5efa\u7acb\u94fe\u63a5\u4e4b\u540e\uff0c\u5982\u679c\u6709\u4e00\u65b9\uff0c\u53d1\u8d77\u4e86\u65ad\u5f00\u8fde\u63a5\u7684\u8bf7\u6c42\u3002 \u4e3b\u52a8\u5173\u95ed\u7684\u4e00\u65b9\u4f1a\u8fdb\u5165<code>time_wait</code></p>"},{"location":"2025/sre/0interview/#24-lsof","title":"24 lsof","text":"<p>\u6253\u5f00\u7cfb\u7edf\u4e2d\u5df2\u7ecf\u6253\u5f00\u7684\u6587\u4ef6\u548c\u76f8\u5173\u7684\u8fdb\u7a0b</p> <ol> <li>\u5f53\u524d\u6253\u5f00\u7684\u6587\u4ef6\u88ab\u54ea\u4e00\u4e2a\u8fdb\u7a0b\u6240\u6253\u5f00</li> <li>\u67d0\u4e00\u4e2a\u8fdb\u7a0b\u6253\u5f00\u4e86\u90a3\u4e9b\u6587\u4ef6</li> <li>\u7aef\u53e3\u88ab\u90a3\u4e2a\u8fdb\u7a0b\u5360\u7528</li> <li>\u5217\u51fa\u6240\u6709tcp udp \u7684\u94fe\u63a5\u72b6\u6001</li> <li>\u5f53\u524d\u7528\u6237\u6253\u5f00\u4e86\u90a3\u4e9b\u6587\u4ef6</li> </ol>"},{"location":"2025/sre/0interview/#25-linux","title":"25 Linux \u6267\u884c\u547d\u4ee4\u5f88\u6162","text":"<p>\u4e3b\u8981\u539f\u56e0\u662f\u7f13\u5b58\u7684\u539f\u56e0</p> <p>1 lscpu \u770b\u4e00\u4e0bCPU \u7684\u7f13\u5b58</p> <p>2 <code>free -mh</code> \u7cfb\u7edf\u78c1\u76d8\u6587\u4ef6\u7684\u7f13\u5b58\u72b6\u6001</p>"},{"location":"2025/sre/0interview/#26","title":"26 \u4e8c\u4e09\u5c42\u4ea4\u6362\u673a\u7684\u533a\u522b","text":"<p>2\u5c42\u4ea4\u6362\u673a \u4f7f\u7528Mac\u7684\u5bfb\u5740\uff0c \u91c7\u7528\u7684\u5b58\u50a8\uff0c\u8f6c\u53d1\u7684\u65b9\u5f0f\u8fdb\u884c\u6570\u636e\u7684\u8f6c\u5316</p> <p>3\u5c42\u4ea4\u6362\u673a \u4ed6\u662f\u5177\u5907\u7684\u8def\u7531\u7684\u8f6c\u53d1\u529f\u80fd\uff0c\u5b83\u80fd\u591f\u8fde\u63a5\u5916\u7f51\uff0c\u540c\u65f6\u8fd8\u53ef\u4ee5\u9009\u62e9\u8def\u7531\u8f6c\u53d1\u7684\u7ebf\u8def</p>"},{"location":"2025/sre/0interview/#27-mysql","title":"27 MySQL \u7684\u8bfb\u5199\u5206\u79bb","text":"<p>\u6570\u636e\u5927\u7684\u8bfb\u53d6\u548c\u6570\u636e\u7684\u5199\u5165\u653e\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u8fdb\u884c</p> <ul> <li>1 \u6570\u636e\u540c\u6b65\uff0c master\u4e0a\u9762\u7684\u64cd\u4f5c\u8981\u5199\u5165\u5230binlog \u65e5\u5fd7\uff0c binlog \u65e5\u5fd7\u4e0eSlave\u8282\u70b9\uff0c\u6765\u540c\u6b65\u8fdb\u884c\u5199\u5165</li> <li>2 master \u4f5c\u4e3a\u5199\u5165\u8282\u70b9\uff0c slave \u8282\u70b9\u4f5c\u4e3a\u8bfb\u53d6\u8282\u70b9</li> </ul> <p>ACID </p> <ul> <li>\u6301\u4e45\u6027 \u6570\u636e\u4e00\u65e6\u6539\u53d8\u662f\u6301\u4e45\u7684</li> <li>\u539f\u5b50\u6027 \u4e8b\u52a1\u8981\u4e0d\u5168\u9762\u88ab\u6267\u884c\uff0c\u8981\u4e0d\u4e0d\u6267\u884c</li> <li>\u4e00\u81f4\u6027 \u5b9e\u7269\u5f00\u542f\u4e4b\u540e\uff0c \u6570\u636e\u5e93\u5927\u7684\u5b8c\u6574\u6027\u6ca1\u6709\u88ab\u7834\u574f</li> <li>\u9694\u79bb\u6027 \u540c\u4e00\u4e2a\u4e8b\u52a1\uff0c\u53ea\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\uff0c \u4e0d\u540c\u4e8b\u52a1\u4e0d\u540c\u7684\u8bf7\u6c42</li> </ul>"},{"location":"2025/sre/0interview/#28-docker","title":"28 Docker \u7aef\u53e3\u7684\u6620\u5c04\u673a\u5236","text":"<p>\u5c06docker \u5bb9\u5668\u7684\u5185\u90e8\u7aef\u53e3\uff0c\u6620\u5c04\u5230\u4e3b\u673a\u7684\u7aef\u53e3</p> <p><code>docker run -p 1234:56 test</code></p> <p>\u5bb9\u5668\u768456\u7aef\u53e3\u6620\u5c04\u5230\u4e3b\u673a\u76841234\u7aef\u53e3</p>"},{"location":"2025/sre/0interview/#29-docker","title":"29 docker \u7684\u955c\u50cf\u6587\u4ef6\u5b58\u5728\u54ea\u91cc","text":"<p>/var/lib/docker \u76ee\u5f55\u4e0b\u9762</p>"},{"location":"2025/sre/0interview/#30-docker","title":"30 \u5982\u4f55\u4f18\u5316docker\u955c\u50cf","text":"<ol> <li>\u4f7f\u7528\u66f4\u8f7b\u91cf\u7684\u57fa\u7840\u955c\u50cf</li> <li>\u5c3d\u91cf\u51cf\u5c11\u955c\u50cf\u7684\u5c42\u6570\uff0c \u547d\u4ee4\u8fdb\u884c\u5408\u5e76</li> <li>\u5bf9\u4e8e\u96f6\u65f6\u548c\u591a\u4f59\u6587\u4ef6\u5220\u9664</li> </ol>"},{"location":"2025/sre/0interview/#31","title":"31 \u9ad8\u53ef\u7528\u67b6\u6784","text":"<ol> <li>\u8d1f\u8f7d\u5747\u8861\uff0c Nginx \u6216\u8005 HAPROXY \u4e91\u5e73\u53f0\u7684\u989dLB</li> <li>\u96c6\u7fa4\u5316\u7684\u7ba1\u7406 k8s</li> <li>\u6570\u636e\u5757\u7684\u9ad8\u53ef\u7528</li> <li>\u5b58\u50a8\u7684\u9ad8\u53ef\u7528  \u78c1\u76d8 RAID5, \u5206\u5e03\u5f0f\u5b58\u50a8</li> <li>\u6545\u969c\u8f6c\u79fb keepalived</li> </ol>"},{"location":"2025/sre/0interview/#32","title":"32 \u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3","text":"<ul> <li><code>du -sh</code> \u67d0\u4e9b\u7a7a\u95f4\u5360\u7528\u6bd4\u8f83\u5927\u7684\u6587\u4ef6, \u5f52\u6863\u6216\u8005log\u6587\u4ef6\u53ef\u4ee5\u5220\u9664\u6216\u8005\u8f6c\u79fb</li> <li>df -h \u78c1\u76d8\u6302\u8f7d\u60c5\u51b5</li> <li>yum clean all</li> </ul>"},{"location":"2025/sre/0interview/#32-k8s","title":"32 \u4f18\u5316K8S\u96c6\u7fa4\u6027\u80fd","text":"<ol> <li>pod\u8bbe\u7f6eCPU\u548c\u5185\u5b58\u6765\u505a\u8d44\u6e90\u9650\u5236</li> <li>\u8282\u70b9\u7684\u4eb2\u548c\u548c\u53cd\u4eb2\u548c\uff0c\u4f18\u5316\u8c03\u5ea6</li> <li>\u9ad8\u65b0\u80fd\u7684\u786c\u4ef6\u5b58\u50a8</li> <li>\u7f51\u7edc\u63d2\u4ef6\u8fdb\u884c\u4f18\u5316</li> <li>Prometheus \u548c  Grafana \u5bf9\u6574\u4e2a\u96c6\u7fa4\u8fdb\u884c\u76d1\u63a7</li> </ol>"},{"location":"2025/sre/0interview/#33","title":"33 \u7a81\u53d1\u6d41\u91cf\u9ad8\u5cf0","text":"<ol> <li>\u9650\u6d41\uff1a API \u7f51\u5173\u548cNginx\u8fdb\u884c\u9650\u6d41</li> <li>\u9759\u6001\u8d44\u6e90\u7528CDN\u5206\u914d</li> <li>\u70ed\u70b9\u8d44\u6e90\u7528Redis \u7f13\u5b58\u4e0b\u6765</li> <li>\u4e91\u5e73\u53f0\u7684\u81ea\u52a8\u6269\u5c55\u529f\u80fd</li> </ol>"},{"location":"2025/sre/0interview/#34-ssl","title":"34 SSL\u8bc1\u4e66\u7684\u95ee\u9898","text":"<ol> <li>Openssl \u67e5\u770b \u8bc1\u4e66\u7684\u5185\u5bb9\uff0c\u786e\u8ba4\u8bc1\u4e66\u662f\u5426\u8fc7\u671f</li> <li>\u68c0\u67e5web\u670d\u52a1\u5668 Nginx \u5bf9\u4e8eSSL \u914d\u7f6e\u7684</li> <li>SSL \u7684\u6d4b\u8bd5\u5de5\u5177\uff0c\u6d4b\u8bd5\u4e00\u4e0b\u8bc1\u4e66\u7684\u914d\u7f6e</li> </ol>"},{"location":"2025/sre/0interview/#35-mysql","title":"35 \u4f18\u5316MYSQL\u6570\u636e\u5e93\u7684\u6027\u80fd","text":"<ol> <li>\u7d22\u5f15\uff0c\u5bf9\u5e38\u7528\u7684\u67e5\u8be2\u5b57\u6bb5\u52a0\u4e0a\u7d22\u5f15</li> <li>\u6162\u67e5\u8be2\u7528explain\u8fdb\u884c\u5206\u6790\uff0c\u5b83\u7684\u6267\u884c\u8ba1\u5212</li> <li>\u5927\u7684\u8868\u5206\u5e93\u5206\u8868</li> <li>\u7f13\u51b2\u6c60\u7684\u5927\u5c0f\u8fdb\u884c\u8c03\u6574</li> <li>\u67e5\u8be2\u70ed\u5ea6\u9ad8\u7684\u6570\u636e\uff0c\u7528redis \u8fdb\u884c\u67e5\u8be2</li> </ol>"},{"location":"2025/sre/0interview/#36-redis","title":"36 Redis\u7684\u4f18\u5316","text":"<ul> <li>\u9650\u5236redis\u5bf9\u4e8e\u5185\u5b58\u7684\u4f7f\u7528</li> <li>redis\u6570\u636e\u8fdb\u884c\u6301\u4e45\u5316</li> <li>\u96c6\u7fa4 redis cluster , \u6765\u505a\u5206\u5e03\u5f0f</li> <li>redis \u7f13\u5b58\u8bbe\u7f6e\u5408\u7406\u7684\u8fc7\u671f\u65f6\u95f4</li> <li>\u76d1\u63a7redis \u7684\u72b6\u6001</li> </ul>"},{"location":"2025/sre/0interview/#37-redis","title":"37  Redis\u5185\u5b58\u66b4\u589e\u600e\u4e48\u529e","text":"<ol> <li>Rediscli \u67e5\u627e\u5927key\u6216\u8005\u70ed\u70b9key</li> <li>\u5206\u6790\u5185\u5b58\u788e\u7247\u7387</li> <li>\u662f\u5426\u5f00\u542fmaxmemory, \u6dd8\u6c70\u7b56\u7565</li> <li>\u5927key\u62c6\u5206\uff0c \u5f00\u542f\u6dd8\u6c70\u7b56\u7565</li> </ol>"},{"location":"2025/sre/0interview/#38-mongdb","title":"38 MongDB\u7684\u67e5\u8be2\u53d8\u6162","text":"<ol> <li>\u5206\u6790\u4e00\u4e0b\u6162\u67e5\u8be2</li> <li>\u6dfb\u52a0\u7d22\u5f15</li> <li>\u5206\u6790\u4e00\u4e0b\u6162\u67e5\u8be2</li> <li>\u5206\u7247\u6570\u636e\u8fdb\u884c\u5e73\u8861</li> <li>\u68c0\u67e5\u5206\u7247\u952e\u7684\u9009\u62e9\u662f\u5426\u5408\u7406</li> </ol>"},{"location":"2025/sre/0interview/#39-es-too-many-open-files","title":"39 ES\u62a5\u9519 too many open files","text":"<ol> <li>ES\u65e5\u5fd7</li> <li>\u7cfb\u7edf\u5bf9\u6587\u4ef6\u6253\u5f00\u6570\u91cf\u7684\u9650\u5236 ulimit -a</li> <li>Limits.conf</li> <li>\u4fee\u6539ES\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u628a\u7cfb\u7edf\u53c2\u6570\u8c03\u592765535</li> </ol>"},{"location":"2025/sre/0interview/#40-cicd","title":"40 CICD\u5927\u7684\u5b89\u5168","text":"<ol> <li>\u6d4b\u8bd5\uff0c\u751f\u4ea7\uff0c\u5f00\u53d1\u73af\u5883\u5206\u79bb</li> <li>\u4ee3\u7801\u6253\u5305\u8fdb\u884c\u5b89\u5168\u6f0f\u6d1e\u7684\u626b\u63cf</li> <li>\u5bf9\u4e0d\u540c\u8d26\u53f7\u89d2\u8272\u5206\u914d\u6700\u5c0f\u7684\u6743\u9650</li> <li>\u4fdd\u8bc1\u6b63\u5e38\u7684\u4f7f\u7528\uff0c \u5bf9\u65e5\u5e38\u64cd\u4f5c\u7684\u65e5\u5fd7\u5168\u90e8\u4fdd\u7559\u4e0b\u6765\uff0c\u5b9a\u671f\u5ba1\u8ba1</li> </ol>"},{"location":"2025/sre/0interview/#a-kubernetes-pod-is-not-starting-up-and-is-going-in-a-pending-state-how-will-you-troubleshoot-this","title":"A Kubernetes pod is not starting up and is going in a pending state, how will you troubleshoot this?","text":"<p>1. Check Pod Events &amp; Details</p> <pre><code>kubectl describe pod &lt;pod-name&gt; -n &lt;namespace&gt;\n</code></pre> <p>Focus on the Events section. Common causes include:</p> <ul> <li>Insufficient CPU/Memory: \"0/X nodes available: Insufficient cpu/memory\"</li> <li>Node Selector Mismatch: \"node(s) didn't match Pod's node affinity\"</li> <li>Taints/Tolerations: \"node(s) had untolerated taint {taint-key}\"</li> <li>PVC Issues: \"waiting for persistentvolumeclaim  to be bound\" <p>2. Verify Node Availability</p> <pre><code>kubectl get nodes\n</code></pre> <p>Ensure nodes are Ready. If not:</p> <ul> <li>Check node status: <code>kubectl describe node &lt;node-name&gt;</code></li> <li>Investigate node issues (e.g., disk pressure, network errors, kubelet failures).</li> </ul> <p>3. Check Resource Quotas</p> <pre><code>kubectl get resourcequotas -n &lt;namespace&gt;\nkubectl describe resourcequota &lt;quota-name&gt; -n &lt;namespace&gt;\n</code></pre> <p>Ensure the pod isn't blocked by CPU/memory/storage quotas.</p> <p>4. Inspect Persistent Volume Claims (PVCs)</p> <pre><code>kubectl get pvc -n &lt;namespace&gt;\nkubectl describe pvc &lt;pvc-name&gt; -n &lt;namespace&gt;\n</code></pre> <ul> <li>If PVC is Pending, check storage class/provisioner issues.</li> <li>Verify sufficient storage capacity.</li> </ul> <p>5. Validate Node Affinity/Taints</p> <ul> <li> <p>Node Selector/Affinity:</p> <ul> <li>Match pod's nodeSelector/affinity rules to node labels.</li> </ul> </li> <li> <p>Taints &amp; Tolerations:</p> <ul> <li>Ensure pod tolerations match node taints (e.g., for dedicated nodes).</li> </ul> </li> </ul> <p>6. Check Resource Requests/Limits</p> <pre><code>kubectl get pod &lt;pod-name&gt; -o yaml -n &lt;namespace&gt;\n</code></pre> <p>Verify CPU/memory requests aren\u2019t exceeding node capacity.</p> <p>Compare pod requests to node allocatable resources:</p> <pre><code>kubectl describe node &lt;node-name&gt; | grep -A 10 \"Allocated resources\"\n</code></pre> <p>7. Review Scheduler Logs</p> <p>Access scheduler logs for scheduling errors:</p> <pre><code>kubectl logs -n kube-system &lt;kube-scheduler-pod-name&gt;\n</code></pre> <p>Look for warnings like:</p> <ul> <li>PodFitsResources failed \u2192 Resource starvation.</li> <li>PodFitsHostPorts \u2192 Port conflict.</li> </ul> <p>8. Check for Cluster Autoscaler Issues</p> <p>If using autoscaling (e.g., AWS/GCP), verify:</p> <ul> <li>Autoscaler pod is running: kubectl get pods -n kube-system</li> <li>Cluster has capacity to scale (e.g., max nodes not reached).</li> </ul> <p>9. Validate Pod Security Policies (PSP) or Admission Controllers</p> <ul> <li>If PSP is enabled, ensure the pod has necessary permissions.</li> <li>Check for admission controller errors in scheduler logs.</li> </ul> <p>10. Debug with Ephemeral Containers (Kubernetes \u2265v1.23)</p> <p>Attach a debug container to inspect the pod's environment:</p> <pre><code>kubectl debug -it &lt;pod-name&gt; --image=busybox --target=&lt;container-name&gt;\n</code></pre> <p>Common Solutions:</p> <ul> <li>Resource Starvation: Scale nodes, reduce pod requests, or free up resources.</li> <li>Taints/Tolerations: Add tolerations to pod spec or remove node taint.</li> <li>PVC Stuck: Delete/recreate PVC, verify storage class exists.</li> <li>Node Selector Mismatch: Adjust pod\u2019s nodeSelector or label nodes properly.</li> <li>Scheduler Issues: Restart kube-scheduler if logs indicate crashes</li> </ul> <p>Final Checks:</p> <ul> <li>Kubernetes Version: Check for known bugs in your version.</li> <li>Events Are Your Friend: Always start with kubectl describe pod.</li> </ul> <p>By systematically addressing these areas, you\u2019ll resolve 95% of Pending pod issues. Start with pod events \u2192 resources \u2192 PVCs \u2192 scheduling constraints.</p> <p>\u597d\u7684\uff0c\u8fd9\u662f\u60a8\u63d0\u4f9b\u7684 Kubernetes Pod \u5904\u4e8e Pending \u72b6\u6001\u6392\u67e5\u6307\u5357\u7684\u4e2d\u6587\u7ffb\u8bd1\uff1a</p> <p>\u8981\u6392\u67e5 Kubernetes Pod \u5361\u5728 Pending \u72b6\u6001\u7684\u95ee\u9898\uff0c\u8bf7\u9075\u5faa\u4ee5\u4e0b\u7ed3\u6784\u5316\u6b65\u9aa4\uff1a</p>"},{"location":"2025/sre/0interview/#1-pod","title":"1. \u68c0\u67e5 Pod \u4e8b\u4ef6\u548c\u8be6\u60c5","text":"<p><code>bash    kubectl describe pod &lt;pod\u540d\u79f0&gt; -n &lt;\u547d\u540d\u7a7a\u95f4&gt;</code> \u91cd\u70b9\u5173\u6ce8 <code>Events</code> \u4e8b\u4ef6\u90e8\u5206\u3002\u5e38\u89c1\u539f\u56e0\u5305\u62ec\uff1a    - CPU/\u5185\u5b58\u4e0d\u8db3: \"0/X nodes available: Insufficient cpu/memory\" (0/X \u4e2a\u8282\u70b9\u53ef\u7528\uff1aCPU/\u5185\u5b58\u4e0d\u8db3)    - \u8282\u70b9\u9009\u62e9\u5668\u4e0d\u5339\u914d: \"node(s) didn't match Pod's node affinity\" (\u8282\u70b9\u4e0e Pod \u7684\u8282\u70b9\u4eb2\u548c\u6027\u4e0d\u5339\u914d)    - \u6c61\u70b9/\u5bb9\u5fcd\u5ea6\u95ee\u9898: \"node(s) had untolerated taint {\u6c61\u70b9\u952e}\" (\u8282\u70b9\u5b58\u5728\u672a\u88ab Pod \u5bb9\u5fcd\u7684\u6c61\u70b9)    - PVC (\u6301\u4e45\u5377\u58f0\u660e) \u95ee\u9898: \"waiting for persistentvolumeclaim  to be bound\" (\u7b49\u5f85\u6301\u4e45\u5377\u58f0\u660e  \u5b8c\u6210\u7ed1\u5b9a)"},{"location":"2025/sre/0interview/#2","title":"2. \u9a8c\u8bc1\u8282\u70b9\u53ef\u7528\u6027","text":"<p><code>bash    kubectl get nodes</code>    \u786e\u4fdd\u6240\u6709\u8282\u70b9\u72b6\u6001\u4e3a Ready (\u5c31\u7eea)\u3002\u5982\u679c\u4e0d\u662f\uff1a    - \u68c0\u67e5\u8282\u70b9\u72b6\u6001\u8be6\u60c5\uff1a<code>kubectl describe node &lt;\u8282\u70b9\u540d\u79f0&gt;</code>    - \u8c03\u67e5\u8282\u70b9\u95ee\u9898\uff08\u5982\u78c1\u76d8\u538b\u529b\u3001\u7f51\u7edc\u9519\u8bef\u3001kubelet \u6545\u969c\uff09\u3002</p>"},{"location":"2025/sre/0interview/#3-resource-quotas","title":"3. \u68c0\u67e5\u8d44\u6e90\u914d\u989d (Resource Quotas)","text":"<p><code>bash    kubectl get resourcequotas -n &lt;\u547d\u540d\u7a7a\u95f4&gt;    kubectl describe resourcequota &lt;\u914d\u989d\u540d\u79f0&gt; -n &lt;\u547d\u540d\u7a7a\u95f4&gt;</code>    \u786e\u4fdd Pod \u6ca1\u6709\u88ab\u547d\u540d\u7a7a\u95f4\u7684 CPU/\u5185\u5b58/\u5b58\u50a8\u914d\u989d\u6240\u9650\u5236\u3002</p>"},{"location":"2025/sre/0interview/#4-pvcs","title":"4. \u68c0\u67e5\u6301\u4e45\u5377\u58f0\u660e (PVCs)","text":"<p><code>bash    kubectl get pvc -n &lt;\u547d\u540d\u7a7a\u95f4&gt;    kubectl describe pvc &lt;pvc\u540d\u79f0&gt; -n &lt;\u547d\u540d\u7a7a\u95f4&gt;</code>    - \u5982\u679c PVC \u72b6\u6001\u4e3a Pending\uff0c\u68c0\u67e5\u5b58\u50a8\u7c7b (StorageClass) \u6216\u5b58\u50a8\u4f9b\u5e94\u5668 (Provisioner) \u95ee\u9898\u3002    - \u9a8c\u8bc1\u5b58\u50a8\u5bb9\u91cf\u662f\u5426\u5145\u8db3\u3002</p>"},{"location":"2025/sre/0interview/#5-affinity-taints","title":"5. \u9a8c\u8bc1\u8282\u70b9\u4eb2\u548c\u6027 (Affinity)/\u6c61\u70b9 (Taints)","text":"<ul> <li>\u8282\u70b9\u9009\u62e9\u5668/\u4eb2\u548c\u6027 (Node Selector/Affinity):      \u68c0\u67e5 Pod \u7684 <code>nodeSelector</code> \u6216 <code>affinity</code> \u89c4\u5219\u662f\u5426\u4e0e\u8282\u70b9\u6807\u7b7e\u5339\u914d\u3002</li> <li>\u6c61\u70b9\u4e0e\u5bb9\u5fcd\u5ea6 (Taints &amp; Tolerations):      \u786e\u4fdd Pod \u7684\u5bb9\u5fcd\u5ea6 (<code>tolerations</code>) \u80fd\u591f\u5339\u914d\u8282\u70b9\u7684\u6c61\u70b9 (\u4f8b\u5982\u4e13\u7528\u8282\u70b9\u4e0a\u7684\u6c61\u70b9)\u3002</li> </ul>"},{"location":"2025/sre/0interview/#6-requestslimits","title":"6. \u68c0\u67e5\u8d44\u6e90\u8bf7\u6c42/\u9650\u5236 (Requests/Limits)","text":"<p><code>bash    kubectl get pod &lt;pod\u540d\u79f0&gt; -o yaml -n &lt;\u547d\u540d\u7a7a\u95f4&gt;</code>    - \u9a8c\u8bc1 Pod \u7684 CPU/\u5185\u5b58 <code>requests</code> (\u8bf7\u6c42\u503c) \u662f\u5426\u8d85\u8fc7\u4e86\u8282\u70b9\u5bb9\u91cf\u3002    - \u5c06 Pod \u7684\u8d44\u6e90\u8bf7\u6c42\u4e0e\u8282\u70b9\u7684\u53ef\u5206\u914d\u8d44\u6e90\u8fdb\u884c\u6bd4\u8f83\uff1a      <code>bash      kubectl describe node &lt;\u8282\u70b9\u540d\u79f0&gt; | grep -A 10 \"Allocated resources\" (\u5df2\u5206\u914d\u8d44\u6e90)</code></p>"},{"location":"2025/sre/0interview/#7-scheduler-logs","title":"7. \u67e5\u770b\u8c03\u5ea6\u5668\u65e5\u5fd7 (Scheduler Logs)","text":"<p>\u8bbf\u95ee Kubernetes \u8c03\u5ea6\u5668\u65e5\u5fd7\u4ee5\u67e5\u627e\u8c03\u5ea6\u9519\u8bef\u4fe1\u606f\uff1a    <code>bash    kubectl logs -n kube-system &lt;kube-scheduler-pod\u540d\u79f0&gt;</code>    \u67e5\u627e\u7c7b\u4f3c\u5982\u4e0b\u7684\u8b66\u544a\uff1a    - <code>PodFitsResources failed</code> \u2192 \u8d44\u6e90\u4e0d\u8db3\u3002    - <code>PodFitsHostPorts</code> \u2192 \u7aef\u53e3\u51b2\u7a81\u3002</p>"},{"location":"2025/sre/0interview/#8-cluster-autoscaler","title":"8. \u68c0\u67e5\u96c6\u7fa4\u81ea\u52a8\u4f38\u7f29\u5668 (Cluster Autoscaler) \u95ee\u9898","text":"<ul> <li>\u5982\u679c\u542f\u7528\u4e86\u96c6\u7fa4\u81ea\u52a8\u4f38\u7f29 (\u4f8b\u5982 AWS/GCP)\uff0c\u8bf7\u9a8c\u8bc1\uff1a<ul> <li>\u81ea\u52a8\u4f38\u7f29\u5668 Pod \u662f\u5426\u5728\u8fd0\u884c\uff1a<code>kubectl get pods -n kube-system</code></li> <li>\u96c6\u7fa4\u662f\u5426\u6709\u5bb9\u91cf\u8fdb\u884c\u6269\u5c55\uff08\u4f8b\u5982\uff0c\u672a\u8fbe\u5230\u6700\u5927\u8282\u70b9\u6570\uff09\u3002</li> </ul> </li> </ul>"},{"location":"2025/sre/0interview/#9-pod-psp-admission-controllers","title":"9. \u9a8c\u8bc1 Pod \u5b89\u5168\u7b56\u7565 (PSP) \u6216\u51c6\u5165\u63a7\u5236\u5668 (Admission Controllers)","text":"<ul> <li>\u5982\u679c\u542f\u7528\u4e86 PSP (Pod Security Policies)\uff0c\u786e\u4fdd Pod \u5177\u6709\u5fc5\u8981\u7684\u6743\u9650\u3002</li> <li>\u5728\u8c03\u5ea6\u5668\u65e5\u5fd7\u4e2d\u68c0\u67e5\u51c6\u5165\u63a7\u5236\u5668\u76f8\u5173\u7684\u9519\u8bef\u3002</li> </ul>"},{"location":"2025/sre/0interview/#10-kubernetes-v123","title":"10. \u4f7f\u7528\u4e34\u65f6\u5bb9\u5668\u8c03\u8bd5 (Kubernetes \u2265v1.23)","text":"<p>\u9644\u52a0\u4e00\u4e2a\u8c03\u8bd5\u5bb9\u5668\u6765\u68c0\u67e5 Pod \u7684\u73af\u5883\uff1a    <code>bash    kubectl debug -it &lt;pod\u540d\u79f0&gt; --image=busybox --target=&lt;\u5bb9\u5668\u540d\u79f0&gt;</code></p>"},{"location":"2025/sre/0interview/#_1","title":"\u5e38\u89c1\u89e3\u51b3\u65b9\u6848\uff1a","text":"<ul> <li>\u8d44\u6e90\u4e0d\u8db3 (Resource Starvation): \u6269\u5c55\u8282\u70b9\u6570\u91cf\u3001\u964d\u4f4e Pod \u7684\u8d44\u6e90\u8bf7\u6c42\u3001\u6216\u91ca\u653e\u73b0\u6709\u8d44\u6e90\u3002</li> <li>\u6c61\u70b9/\u5bb9\u5fcd\u5ea6 (Taints/Tolerations): \u5728 Pod \u89c4\u7ea6\u4e2d\u6dfb\u52a0\u5bb9\u5fcd\u5ea6 (<code>tolerations</code>) \u6216\u79fb\u9664\u8282\u70b9\u7684\u6c61\u70b9 (<code>taint</code>)\u3002</li> <li>PVC \u5361\u4f4f (PVC Stuck): \u5220\u9664\u5e76\u91cd\u65b0\u521b\u5efa PVC\uff0c\u786e\u4fdd\u5f15\u7528\u7684\u5b58\u50a8\u7c7b (<code>StorageClass</code>) \u5b58\u5728\u4e14\u53ef\u7528\u3002</li> <li>\u8282\u70b9\u9009\u62e9\u5668\u4e0d\u5339\u914d (Node Selector Mismatch): \u8c03\u6574 Pod \u7684 <code>nodeSelector</code> \u6216\u6b63\u786e\u5730\u4e3a\u8282\u70b9\u6253\u6807\u7b7e\u3002</li> <li>\u8c03\u5ea6\u5668\u95ee\u9898 (Scheduler Issues): \u5982\u679c\u65e5\u5fd7\u663e\u793a\u8c03\u5ea6\u5668\u5d29\u6e83\uff0c\u5c1d\u8bd5\u91cd\u542f kube-scheduler Pod\u3002</li> </ul>"},{"location":"2025/sre/0interview/#_2","title":"\u6700\u540e\u8981\u70b9\uff1a","text":"<ul> <li>Kubernetes \u7248\u672c: \u68c0\u67e5\u60a8\u4f7f\u7528\u7684\u7248\u672c\u662f\u5426\u5b58\u5728\u5df2\u77e5\u7684\u76f8\u5173 Bug\u3002</li> <li>\u4e8b\u4ef6\u662f\u5173\u952e: <code>kubectl describe pod</code> \u547d\u4ee4\u8f93\u51fa\u7684\u4e8b\u4ef6 (<code>Events</code>) \u59cb\u7ec8\u662f\u6700\u91cd\u8981\u7684\u8d77\u70b9\u3002</li> </ul> <p>\u901a\u8fc7\u7cfb\u7edf\u5730\u6392\u67e5\u8fd9\u4e9b\u65b9\u9762\uff0c\u60a8\u5c06\u80fd\u89e3\u51b3 95% \u7684 Pod \u5361\u5728 Pending \u72b6\u6001\u7684\u95ee\u9898\u3002\u6392\u67e5\u987a\u5e8f\u5efa\u8bae\uff1aPod \u4e8b\u4ef6 \u2192 \u8d44\u6e90\u95ee\u9898 \u2192 PVC \u95ee\u9898 \u2192 \u8c03\u5ea6\u7ea6\u675f\u3002</p>"},{"location":"2025/sre/0interview/#postgresql","title":"\u7b2c\u4e00\u90e8\u5206\uff1aPostgreSQL \u57fa\u7840","text":""},{"location":"2025/sre/0interview/#1-postgresql","title":"1 PostgreSQL \u7684\u5173\u952e\u7279\u6027\u6709\u54ea\u4e9b\uff1f","text":"<p>ACID \u5408\u89c4\u6027\u3001MVCC\uff08\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236\uff09\u3001JSON/BSON \u652f\u6301\u3001\u5168\u6587\u641c\u7d22\u3001\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u3001\u7d22\u5f15\uff08GIN, GiST, BRIN\uff09\u3001\u590d\u5236\u3001\u5206\u533a\u3001\u903b\u8f91\u4e0e\u7269\u7406\u5907\u4efd\u3002</p>"},{"location":"2025/sre/0interview/#2-postgresql","title":"2 PostgreSQL \u652f\u6301\u54ea\u4e9b\u6570\u636e\u7c7b\u578b\uff1f","text":"<p>\u6570\u503c\u578b\u3001\u6587\u672c\u578b\u3001\u65e5\u671f/\u65f6\u95f4\u578b\u3001\u51e0\u4f55\u578b\u3001JSON/JSONB\u3001UUID\u3001\u6570\u7ec4\u3001\u8303\u56f4\u7c7b\u578b\u3001\u590d\u5408\u7c7b\u578b\u3001\u81ea\u5b9a\u4e49\u7c7b\u578b\u3002</p>"},{"location":"2025/sre/0interview/#3-postgresql-mvcc","title":"3 PostgreSQL \u4e2d\u7684 MVCC \u5982\u4f55\u5de5\u4f5c\uff1f","text":"<ul> <li>\u6bcf\u4e2a\u4e8b\u52a1\u770b\u5230\u6570\u636e\u5e93\u5728\u7279\u5b9a\u65f6\u95f4\u70b9\u7684\u5feb\u7167\u3002</li> <li>\u4fee\u6539\u4f1a\u5199\u5165\u65b0\u7248\u672c\uff0cVacuum \u8fdb\u7a0b\u8d1f\u8d23\u6e05\u7406\u65e7\u7248\u672c\u3002</li> </ul>"},{"location":"2025/sre/0interview/#_3","title":"\u7b2c\u4e8c\u90e8\u5206\uff1a\u7ba1\u7406\u4e0e\u6027\u80fd","text":""},{"location":"2025/sre/0interview/#1-postgresql_1","title":"1 \u5982\u4f55\u76d1\u63a7 PostgreSQL \u6027\u80fd\uff1f","text":"<p>\u4f7f\u7528 <code>pg_stat_activity</code>\u3001<code>pg_stat_user_tables</code>\u3001<code>auto_explain</code>\u3001<code>pgBadger</code> \u53ca\u5916\u90e8\u5de5\u5177\u5982 Prometheus\u3001Grafana\u3002</p>"},{"location":"2025/sre/0interview/#2-autovacuum","title":"2 \u4ec0\u4e48\u662f Autovacuum\uff1f\u4e3a\u4f55\u91cd\u8981\uff1f","text":"<p>\u81ea\u52a8\u6e05\u7406\u6b7b\u5143\u7ec4\uff08Dead Tuples\uff09\uff0c\u9632\u6b62\u8868\u81a8\u80c0\u5e76\u7ef4\u6301\u6027\u80fd\u3002</p>"},{"location":"2025/sre/0interview/#3","title":"3 \u5982\u4f55\u68c0\u67e5\u8868\u81a8\u80c0\uff1f","text":"<p>\u4f7f\u7528 <code>pg_stat_user_tables</code>\u3001<code>pgstattuple</code> \u6216\u5de5\u5177\u5982 <code>pg_bloat_check</code>\u3002</p>"},{"location":"2025/sre/0interview/#4-postgresql","title":"4 \u5982\u4f55\u4f18\u5316 PostgreSQL \u6027\u80fd\uff1f","text":"<p>\u8c03\u6574 <code>shared_buffers</code>\u3001<code>work_mem</code>\u3001<code>maintenance_work_mem</code>\u3001<code>effective_cache_size</code> \u548c <code>wal_buffers</code>\u3002</p> <p>\u6709\u6548\u4f7f\u7528\u7d22\u5f15\u5e76\u5b9a\u671f\u6267\u884c VACUUM/ANALYZE\u3002</p>"},{"location":"2025/sre/0interview/#5-wal","title":"5 \u4ec0\u4e48\u662f WAL \u6587\u4ef6\uff1f","text":"<p>\u9884\u5199\u65e5\u5fd7\uff08Write-Ahead Logs\uff09\uff1a\u901a\u8fc7\u5148\u5c06\u66f4\u6539\u5199\u5165\u78c1\u76d8\u518d\u5e94\u7528\u5230\u6570\u636e\u6587\u4ef6\uff0c\u786e\u4fdd\u6570\u636e\u6301\u4e45\u6027\u3002</p>"},{"location":"2025/sre/0interview/#_4","title":"\u7b2c\u4e09\u90e8\u5206\uff1a\u5907\u4efd\u4e0e\u6062\u590d","text":""},{"location":"2025/sre/0interview/#1-postgresql_2","title":"1 PostgreSQL \u7684\u5907\u4efd\u7c7b\u578b\u6709\u54ea\u4e9b\uff1f","text":"<p>SQL \u8f6c\u50a8\uff08<code>pg_dump</code>\uff09\u3001\u6587\u4ef6\u7cfb\u7edf\u7ea7\u5907\u4efd\u3001\u6301\u7eed\u5f52\u6863\uff08WAL\uff09\u3001\u57fa\u7840\u5907\u4efd\uff08<code>pg_basebackup</code>\uff09\u3002</p>"},{"location":"2025/sre/0interview/#2_1","title":"2. \u5982\u4f55\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u903b\u8f91\u5907\u4efd\uff1f","text":"<p>\u4f7f\u7528 <code>pg_dump</code> \u6216 <code>pg_dumpall</code>\u3002</p>"},{"location":"2025/sre/0interview/#3_1","title":"3. \u5982\u4f55\u4ece\u8f6c\u50a8\u6587\u4ef6\u6062\u590d\u6570\u636e\u5e93\uff1f","text":"<p>\u4f7f\u7528 psql \u6216 <code>pg_restore</code>\uff08\u53d6\u51b3\u4e8e\u5907\u4efd\u683c\u5f0f\uff09</p>"},{"location":"2025/sre/0interview/#4-pitr","title":"4 \u4ec0\u4e48\u662f PITR\uff08\u65f6\u95f4\u70b9\u6062\u590d\uff09\uff1f","text":"<p>\u4f7f\u7528\u57fa\u7840\u5907\u4efd + WAL \u6587\u4ef6\u5c06\u6570\u636e\u5e93\u6062\u590d\u5230\u7279\u5b9a\u65f6\u95f4\u70b9\u3002</p>"},{"location":"2025/sre/0interview/#5-pitr","title":"5 \u5982\u4f55\u8bbe\u7f6e PITR \u7684\u6301\u7eed\u5f52\u6863\uff1f","text":"<p>\u542f\u7528 <code>archive_mode = on</code>\uff0c\u5e76\u914d\u7f6e <code>archive_command</code> \u5c06 WAL \u6587\u4ef6\u590d\u5236\u5230\u5b89\u5168\u4f4d\u7f6e\u3002</p>"},{"location":"2025/sre/0interview/#_5","title":"\u7b2c\u56db\u90e8\u5206\uff1a\u590d\u5236\u4e0e\u9ad8\u53ef\u7528","text":""},{"location":"2025/sre/0interview/#1","title":"1. \u4ec0\u4e48\u662f\u6d41\u590d\u5236\uff1f","text":"<p>\u4e00\u79cd\u901a\u8fc7\u7f51\u7edc\u8fde\u63a5\u5c06 WAL \u5b9e\u65f6\u53d1\u9001\u5230\u526f\u672c\u7684\u65b9\u6cd5\u3002</p>"},{"location":"2025/sre/0interview/#2_2","title":"2. \u7269\u7406\u590d\u5236\u4e0e\u903b\u8f91\u590d\u5236\u7684\u533a\u522b\uff1f","text":"<ul> <li>\u7269\u7406\u590d\u5236\u5b57\u8282\u7ea7\u53d8\u66f4\uff08\u57fa\u7840\u5907\u4efd + WAL\uff09\uff0c</li> <li>\u903b\u8f91\u590d\u5236\u5728\u8868\u7ea7\u522b\u4f7f\u7528 SQL \u8bed\u53e5\u590d\u5236\u53d8\u66f4\u3002</li> </ul>"},{"location":"2025/sre/0interview/#3_2","title":"3. \u5982\u4f55\u8bbe\u7f6e\u6d41\u590d\u5236\uff1f","text":"<p>\u4f7f\u7528 <code>pg_basebackup</code> \u590d\u5236\u6570\u636e\u76ee\u5f55\uff0c\u914d\u7f6e<code>primary_conninfo</code> \u5e76\u4f7f\u7528\u590d\u5236\u69fd\u3002</p>"},{"location":"2025/sre/0interview/#4","title":"4. \u4ec0\u4e48\u662f\u590d\u5236\u69fd\uff1f","text":"<p>\u4e00\u79cd\u4fdd\u7559 WAL \u6587\u4ef6\u76f4\u5230\u88ab\u526f\u672c\u6d88\u8d39\u7684\u673a\u5236\uff0c\u9632\u6b62\u5f02\u6b65\u590d\u5236\u4e2d\u7684\u6570\u636e\u4e22\u5931\u3002</p>"},{"location":"2025/sre/0interview/#5-pg_hbaconf","title":"5. \u4ec0\u4e48\u662f pg_hba.conf\uff1f","text":"<p>PostgreSQL \u7684\u5ba2\u6237\u7aef\u8ba4\u8bc1\u914d\u7f6e\u6587\u4ef6\u3002</p>"},{"location":"2025/sre/0interview/#6_1","title":"6. \u5982\u4f55\u76d1\u63a7\u590d\u5236\u5ef6\u8fdf\uff1f","text":"<p>\u901a\u8fc7\u67e5\u8be2 <code>pg_stat_replication</code> \u89c6\u56fe\uff08\u5982 <code>write_lag</code>, <code>replay_lag</code> \u5b57\u6bb5\uff09\u3002</p>"},{"location":"2025/sre/0interview/#7","title":"7. \u80fd\u5426\u4ec5\u590d\u5236\u7279\u5b9a\u8868\uff1f","text":"<p>\u53ef\u4ee5\uff0c\u4f7f\u7528\u903b\u8f91\u590d\u5236\u53ca\u53d1\u5e03/\u8ba2\u9605\u6a21\u578b\u3002</p>"},{"location":"2025/sre/0interview/#8","title":"8. \u5982\u4f55\u6545\u969c\u8f6c\u79fb\u5230\u5907\u5e93\uff1f","text":"<p>\u4f7f\u7528 pg_ctl promote \u63d0\u5347\u5907\u5e93\uff0c\u6216\u901a\u8fc7 Patroni\u3001repmgr\u3001Pacemaker \u7b49\u5de5\u5177\u914d\u7f6e\u3002</p>"},{"location":"2025/sre/0interview/#9-repmgr","title":"9. \u4ec0\u4e48\u662f repmgr\uff1f","text":"<p>\u7528\u4e8e PostgreSQL \u590d\u5236\u7ba1\u7406\u7684\u5de5\u5177\uff0c\u652f\u6301\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u3001\u76d1\u63a7\u548c\u7ba1\u7406\u3002</p>"},{"location":"2025/sre/0interview/#_6","title":"\u7b2c\u4e94\u90e8\u5206\uff1a\u591a\u6570\u636e\u4e2d\u5fc3\u4e0e\u5206\u5e03\u5f0f\u90e8\u7f72","text":""},{"location":"2025/sre/0interview/#1-postgresql_3","title":"1. \u5982\u4f55\u8de8\u6570\u636e\u4e2d\u5fc3\u90e8\u7f72 PostgreSQL\uff1f","text":"<p>\u4f7f\u7528\u5f02\u6b65\u590d\u5236\u5e76\u5904\u7406\u7f51\u7edc\u5ef6\u8fdf\u3002\u5de5\u5177\u5982 BDR\u3001Citus \u6216 Bucardo \u53ef\u7528\u4e8e\u591a\u4e3b\u6216\u5206\u7247\u67b6\u6784\u3002</p>"},{"location":"2025/sre/0interview/#2_3","title":"2. \u591a\u6570\u636e\u4e2d\u5fc3\u590d\u5236\u7684\u6311\u6218\uff1f","text":"<p>\u7f51\u7edc\u5ef6\u8fdf\u3001\u6570\u636e\u4e00\u81f4\u6027\u3001\u6545\u969c\u8f6c\u79fb\u534f\u8c03\u4e0e\u51b2\u7a81\u89e3\u51b3\u3002</p>"},{"location":"2025/sre/0interview/#3-bdr","title":"3. \u4ec0\u4e48\u662f BDR\uff08\u53cc\u5411\u590d\u5236\uff09\uff1f","text":"<p>\u652f\u6301 PostgreSQL \u591a\u4e3b\u590d\u5236\u7684\u6269\u5c55\u3002</p>"},{"location":"2025/sre/0interview/#5","title":"5. \u5982\u4f55\u5904\u7406\u590d\u5236\u51b2\u7a81\uff1f","text":"<p>\u5728\u903b\u8f91\u590d\u5236\u6216 BDR \u4e2d\u9700\u5b9a\u4e49\u51b2\u7a81\u89e3\u51b3\u89c4\u5219\uff0c\u6216\u8bbe\u8ba1\u65e0\u51b2\u7a81\u6a21\u5f0f\u3002</p>"},{"location":"2025/sre/0interview/#6_2","title":"6. \u5982\u4f55\u786e\u4fdd\u5206\u5e03\u5f0f\u67b6\u6784\u7684\u9ad8\u53ef\u7528\uff1f","text":"<p>\u7ed3\u5408\u590d\u5236\u3001\u76d1\u63a7\u3001\u6545\u969c\u8f6c\u79fb\u7f16\u6392\u53ca\u57fa\u4e8e DNS \u6216\u4ee3\u7406\u7684\u91cd\u5b9a\u5411\u3002</p>"},{"location":"2025/sre/0interview/#_7","title":"\u7b2c\u516d\u90e8\u5206\uff1a\u5b89\u5168\u4e0e\u8bbf\u95ee\u63a7\u5236","text":""},{"location":"2025/sre/0interview/#1_1","title":"1. \u5982\u4f55\u7ba1\u7406\u7528\u6237\u89d2\u8272\uff1f","text":"<p>\u4f7f\u7528 CREATE ROLE\u3001GRANT\u3001REVOKE \u547d\u4ee4\u3002</p>"},{"location":"2025/sre/0interview/#2_4","title":"2. \u5982\u4f55\u8fdb\u884c\u7528\u6237\u8ba4\u8bc1\uff1f","text":"<p>\u901a\u8fc7 <code>pg_hba.conf</code> \u914d\u7f6e\u8ba4\u8bc1\u65b9\u5f0f\uff08\u5982 md5, scram-sha-256, peer, trust, \u8bc1\u4e66\u8ba4\u8bc1\uff09\u3002</p>"},{"location":"2025/sre/0interview/#3-rls","title":"3. \u4ec0\u4e48\u662f\u884c\u7ea7\u5b89\u5168\uff08RLS\uff09\uff1f","text":"<p>\u901a\u8fc7 CREATE POLICY \u63a7\u5236\u7528\u6237\u5bf9\u884c\u7684\u8bbf\u95ee\u6743\u9650\u3002</p>"},{"location":"2025/sre/0interview/#5-ssl","title":"5. \u5982\u4f55\u542f\u7528 SSL \u8fde\u63a5\uff1f","text":"<p>\u914d\u7f6e <code>ssl = on</code>\uff0c\u5e76\u63d0\u4f9b <code>ssl_cert_file</code> \u548c <code>ssl_key_file</code>\u3002</p>"},{"location":"2025/sre/0interview/#6_3","title":"6. \u5982\u4f55\u5ba1\u8ba1\u6570\u636e\u5e93\u6d3b\u52a8\uff1f","text":"<p>\u4f7f\u7528\u65e5\u5fd7\uff08<code>log_statement, log_duration</code>\uff09\u6216\u6269\u5c55\u5982 pgAudit\u3002</p>"},{"location":"2025/sre/0interview/#_8","title":"\u7b2c\u4e03\u90e8\u5206\uff1a\u6545\u969c\u6392\u67e5\u4e0e\u7ef4\u62a4","text":""},{"location":"2025/sre/0interview/#1_2","title":"1. \u5982\u4f55\u8bc6\u522b\u6162\u67e5\u8be2\uff1f","text":"<p>\u4f7f\u7528 <code>pg_stat_statements\u3001EXPLAIN ANALYZE\u3001auto_explain</code> \u6216\u65e5\u5fd7\u5de5\u5177\u3002</p>"},{"location":"2025/sre/0interview/#2-vacuum","title":"2. VACUUM \u7684\u4f5c\u7528\uff1f","text":"<p>\u6e05\u7406\u6b7b\u5143\u7ec4\u5e76\u91ca\u653e\u7a7a\u95f4\u3002ANALYZE \u66f4\u65b0\u67e5\u8be2\u8ba1\u5212\u7684\u7edf\u8ba1\u4fe1\u606f\u3002</p>"},{"location":"2025/sre/0interview/#3-vacuum-full-vacuum","title":"3. VACUUM FULL \u4e0e\u5e38\u89c4 VACUUM \u7684\u533a\u522b\uff1f","text":"<p>VACUUM FULL \u91cd\u5199\u8868\u5e76\u56de\u6536\u78c1\u76d8\u7a7a\u95f4\uff0c\u4f46\u4f1a\u9501\u8868\u3002</p>"},{"location":"2025/sre/0interview/#4_1","title":"4. \u6b7b\u9501\u7684\u6210\u56e0\u4e0e\u9884\u9632\uff1f","text":"<p>\u591a\u4e2a\u4e8b\u52a1\u76f8\u4e92\u7b49\u5f85\u8d44\u6e90\u3002\u901a\u8fc7\u4e00\u81f4\u7684\u9501\u987a\u5e8f\u548c\u77ed\u4e8b\u52a1\u9884\u9632\u3002</p>"},{"location":"2025/sre/0interview/#7_1","title":"7. \u5982\u4f55\u67e5\u770b\u5f53\u524d\u9501\uff1f","text":"<p>\u67e5\u8be2 <code>pg_locks</code> \u5e76\u4e0e <code>pg_stat_activity</code> \u5173\u8054\u3002</p>"},{"location":"2025/sre/0interview/#_9","title":"\u7b2c\u516b\u90e8\u5206\uff1a\u9ad8\u7ea7\u4e3b\u9898","text":""},{"location":"2025/sre/0interview/#1_3","title":"1. \u5982\u4f55\u5b9e\u73b0\u5e76\u884c\u67e5\u8be2\uff1f","text":"<p>\u5bf9\u9002\u7528\u67e5\u8be2\u4f7f\u7528\u591a\u5de5\u4f5c\u8fdb\u7a0b\uff08\u57fa\u4e8e\u4f18\u5316\u5668\u51b3\u7b56\uff09\u3002</p>"},{"location":"2025/sre/0interview/#2_5","title":"2. \u4ec0\u4e48\u662f\u5206\u533a\uff1f","text":"<p>\u6309\u8303\u56f4/\u5217\u8868/\u54c8\u5e0c\u89c4\u5219\u5c06\u5927\u8868\u62c6\u5206\u4e3a\u5c0f\u8868\u3002</p>"},{"location":"2025/sre/0interview/#3_3","title":"3. \u5982\u4f55\u5206\u6790\u4e0e\u4f18\u5316\u67e5\u8be2\uff1f","text":"<p>\u4f7f\u7528 EXPLAIN \u548c EXPLAIN ANALYZE\uff0c\u68c0\u67e5\u7d22\u5f15\u5e76\u8003\u8651\u91cd\u5199\u3002</p>"},{"location":"2025/sre/0interview/#4-cte","title":"4. \u4ec0\u4e48\u662f CTE\uff1f\u6709\u4f55\u4f5c\u7528\uff1f","text":"<p>\u516c\u5171\u8868\u8868\u8fbe\u5f0f\uff08Common Table Expressions\uff09\uff1b\u7528\u4e8e\u7f16\u5199\u53ef\u8bfb\u7684\u5b50\u67e5\u8be2\u548c\u9012\u5f52\u67e5\u8be2\u3002</p>"},{"location":"2025/sre/0interview/#5-postgresql","title":"5. \u5982\u4f55\u5347\u7ea7 PostgreSQL\uff1f","text":"<p>\u4f7f\u7528 <code>pg_upgrade</code> \u539f\u5730\u5347\u7ea7\uff0c\u6216\u901a\u8fc7\u8f6c\u50a8/\u6062\u590d\u8fc1\u79fb\u3002</p>"},{"location":"2025/sre/0interview/#postgresqlsre","title":"\ud83d\udee0\ufe0f PostgreSQL\uff08SRE \u4e13\u9879\uff09","text":""},{"location":"2025/sre/0interview/#1_4","title":"1. \u5982\u4f55\u8bbe\u8ba1\u9ad8\u53ef\u7528\u96c6\u7fa4\uff1f","text":"<p>\u8bf4\u660e\u4e3b-\u5907\u6d41\u590d\u5236\u3001\u590d\u5236\u69fd\u3001\u540c\u6b65/\u5f02\u6b65\u6a21\u5f0f\u53ca\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u5de5\u5177\uff08\u5982 repmgr\u3001Patroni \u6216\u81ea\u5b9a\u4e49\u811a\u672c\uff09\u3002</p>"},{"location":"2025/sre/0interview/#2_6","title":"2. \u5982\u4f55\u76d1\u63a7\u548c\u7f13\u89e3\u590d\u5236\u5ef6\u8fdf\uff1f","text":"<p>\u76d1\u63a7\u6307\u6807\uff08<code>pg_stat_replication</code> \u2192 <code>write_lag</code>, <code>replay_lag</code>\uff09\u3001\u544a\u8b66\u9608\u503c\u3001\u8fde\u63a5\u4f18\u5316\u3001\u8de8\u6570\u636e\u4e2d\u5fc3\u7f51\u7edc\u5ef6\u8fdf\u3002</p>"},{"location":"2025/sre/0interview/#3-pitr","title":"3. \u591a\u6570\u636e\u4e2d\u5fc3\u5982\u4f55\u5b9e\u73b0 PITR\uff1f","text":"<p>\u57fa\u7840\u5907\u4efd + \u901a\u8fc7 <code>archive_command</code> \u5f52\u6863 WAL\uff0c\u6309\u65f6\u95f4\u6233\u6062\u590d\uff0c\u8003\u8651\u7f51\u7edc\u56e0\u7d20\u3002</p>"},{"location":"2025/sre/0interview/#4_2","title":"4. \u5982\u4f55\u5728\u7ebf\u53d8\u66f4\u8868\u7ed3\u6784\uff08\u5982\u52a0\u5217/\u7d22\u5f15\uff09\uff1f","text":"<p>\u4f7f\u7528\u975e\u963b\u585e\u64cd\u4f5c\uff1a<code>ALTER TABLE ... ADD COLUMN</code>\u3001<code>CREATE INDEX CONCURRENTLY</code>\uff0c\u5e76\u5728\u526f\u672c\u6eda\u52a8\u66f4\u65b0\u3002</p>"},{"location":"2025/sre/0interview/#5_1","title":"5. \u5982\u4f55\u9884\u9632\u8868/\u7d22\u5f15\u81a8\u80c0\uff1f","text":"<p>\u8c03\u4f18 Autovacuum\u3001\u624b\u52a8\u6267\u884c VACUUM/ANALYZE\u3001\u901a\u8fc7 <code>pg_stat_user_tables</code> \u76d1\u63a7\u3001\u4f7f\u7528 <code>pg_bloat_check</code> \u5de5\u5177\u3002</p>"},{"location":"2025/sre/0interview/#6_4","title":"6. \u5982\u4f55\u6392\u67e5\u751f\u4ea7\u73af\u5883\u6162\u67e5\u8be2\uff1f","text":"<p>\u4f7f\u7528 <code>EXPLAIN ANALYZE</code>\u3001<code>pg_stat_statements</code>\u3001\u68c0\u67e5\u7d22\u5f15\u3001I/O \u7b49\u5f85\u3001\u4f18\u5316\u5668\u8bef\u5224\uff1b\u5efa\u8bae\u65e5\u5fd7\u8bb0\u5f55\u4e0e\u5206\u6790\u7b56\u7565\u3002</p>"},{"location":"2025/sre/0interview/#7_2","title":"7. \u63cf\u8ff0\u5907\u4efd\u4e0e\u707e\u96be\u6062\u590d\u6d41\u7a0b","text":"<p>\u903b\u8f91\u5907\u4efd\uff08<code>pg_dump</code>\uff09\u3001\u7269\u7406\u5907\u4efd\uff08<code>pg_basebackup</code>\uff09\u3001WAL \u5f52\u6863\u3001\u8de8\u6570\u636e\u4e2d\u5fc3\u5907\u4efd\u3001\u6062\u590d\u811a\u672c\u3001\u707e\u5907\u6f14\u7ec3\u3002</p>"},{"location":"2025/sre/0interview/#8_1","title":"8. \u903b\u8f91\u590d\u5236\u7684\u4ef7\u503c\uff1f\u5982\u4f55\u7528\u4e8e\u5206\u7247\uff1f","text":"<p>\u53d1\u5e03/\u8ba2\u9605\u6a21\u578b\u3001\u8868\u8fc7\u6ee4\u3001\u6a21\u5f0f\u540c\u6b65\u5f71\u54cd\uff0c\u4f7f\u7528 pglogical \u6216\u5185\u7f6e\u903b\u8f91\u590d\u5236\u3002</p>"},{"location":"2025/sre/0interview/#9","title":"9 \u5982\u4f55\u6700\u5c0f\u5316\u505c\u673a\u5347\u7ea7\uff1f","text":"<p>\u4f7f\u7528 <code>pg_upgrade --link</code>\u3001\u901a\u8fc7\u590d\u5236\u903b\u8f91\u5347\u7ea7\u3001\u6216\u57fa\u4e8e\u526f\u672c\u7684\u84dd\u7eff\u90e8\u7f72\u3002</p>"},{"location":"2025/sre/0interview/#10-prometheusgrafana","title":"10. Prometheus/Grafana \u76d1\u63a7\u54ea\u4e9b\u6307\u6807\uff1f","text":"<p>\u590d\u5236\u5ef6\u8fdf\u3001\u6d3b\u8dc3\u8fde\u63a5\u6570\u3001\u9501\u3001\u957f\u67e5\u8be2\u3001\u7d22\u5f15\u4f7f\u7528\u7387\u3001\u78c1\u76d8 I/O\u3001<code>pg_stat_connections</code>\u3001<code>pg_stat_bgwriter</code>\u3002</p>"},{"location":"2025/sre/0interview/#httpsre","title":"\ud83c\udf10 HTTP\uff08SRE \u4e13\u9879\uff09","text":""},{"location":"2025/sre/0interview/#http","title":"HTTP \u8bf7\u6c42\u7684\u751f\u547d\u5468\u671f\uff1f","text":"<p>DNS \u89e3\u6790 \u2192 TCP \u63e1\u624b \u2192 TLS \u63e1\u624b \u2192 HTTP \u8bf7\u6c42/\u54cd\u5e94 \u2192 \u8fde\u63a5\u5173\u95ed\u6216\u4fdd\u6301\uff08Keep-Alive\uff09\u3002</p>"},{"location":"2025/sre/0interview/#sre-http","title":"SRE \u9700\u5173\u6ce8\u7684 HTTP \u72b6\u6001\u7801\uff1f","text":"<p>2xx\uff08\u6210\u529f\uff09\u30013xx\uff08\u91cd\u5b9a\u5411\u5faa\u73af\uff09\u30014xx\uff08\u5ba2\u6237\u7aef\u9519\u8bef\uff09\u30015xx\uff08\u670d\u52a1\u7aef\u9519\u8bef\uff09\uff0c\u53ca\u5176\u89e6\u53d1\u6761\u4ef6\u3002</p>"},{"location":"2025/sre/0interview/#http-keep-alive","title":"HTTP Keep-Alive \u4e0e\u8fde\u63a5\u6c60\u7684\u4f5c\u7528\uff1f","text":"<p>\u590d\u7528 TCP/TLS \u8fde\u63a5\u964d\u4f4e\u5ef6\u8fdf\u4e0e\u8d44\u6e90\u6d88\u8017\uff1b\u7981\u7528 Keep-Alive \u7684\u573a\u666f\u3002</p>"},{"location":"2025/sre/0interview/#http_1","title":"\u5982\u4f55\u76d1\u63a7 HTTP \u7aef\u70b9\u6027\u80fd\uff1f","text":"<p>\u4f7f\u7528 APM\u3001\u5408\u6210\u76d1\u63a7\u3001\u771f\u5b9e\u7528\u6237\u76d1\u63a7\u3001\u5ef6\u8fdf\u767e\u5206\u4f4d\uff08p95/p99\uff09\u3001\u9519\u8bef\u9884\u7b97\u8ddf\u8e2a\u3002</p>"},{"location":"2025/sre/0interview/#http2-sre","title":"HTTP/2 \u7684\u4f18\u52bf\u4e0e SRE \u5173\u6ce8\u70b9\uff1f","text":"<p>\u591a\u8def\u590d\u7528\u3001\u5934\u90e8\u538b\u7f29\u3001\u670d\u52a1\u7aef\u63a8\u9001\uff1b</p> <p>\u9700\u8b66\u60d5\u961f\u5934\u963b\u585e\uff08HOL blocking\uff09\u548c\u8d44\u6e90\u4f18\u5148\u7ea7\u95ee\u9898\u3002</p>"},{"location":"2025/sre/0interview/#http_2","title":"\u5982\u4f55\u8c03\u8bd5 HTTP \u6027\u80fd\u9000\u5316\uff1f","text":"<p>\u4f7f\u7528\u8bf7\u6c42\u8ffd\u8e2a\u3001\u5206\u5e03\u5f0f\u8ffd\u8e2a\u3001\u6162\u54cd\u5e94\u65e5\u5fd7\u3001\u7011\u5e03\u6d41\u5206\u6790\u3002</p>"},{"location":"2025/sre/0interview/#rest-grpc-sre","title":"REST \u4e0e gRPC \u7684 SRE \u89c6\u89d2\u5bf9\u6bd4\uff1f","text":"<p>REST\uff1a\u4eba\u7c7b\u53ef\u8bfb\u3001\u5ba2\u6237\u7aef\u5f00\u9500\u5927\uff1b</p> <p>gRPC\uff1a\u4e8c\u8fdb\u5236\u4f20\u8f93\u3001\u57fa\u4e8e HTTP/2\u3001\u5f3a\u5951\u7ea6\uff1b\u9700\u6743\u8861\u6027\u80fd\u3001\u5de5\u5177\u94fe\u548c\u53ef\u89c2\u6d4b\u6027\u3002</p>"},{"location":"2025/sre/0interview/#http_3","title":"HTTP \u7684\u91cd\u8bd5\u4e0e\u5e42\u7b49\u6027\uff1f","text":"<p>\u5e42\u7b49\u65b9\u6cd5\uff08GET/PUT\uff09\u7684\u5b89\u5168\u91cd\u8bd5\uff08\u542b\u9000\u907f\u673a\u5236\uff09\uff0c\u975e\u5e42\u7b49\u8bf7\u6c42\u7684\u5904\u7406\u7b56\u7565\u3002</p>"},{"location":"2025/sre/0interview/#http_4","title":"\u5982\u4f55\u4fdd\u62a4\u751f\u4ea7\u73af\u5883 HTTP \u6d41\u91cf\uff1f","text":"<p>TLS \u7ec8\u6b62\u3001HSTS \u7b56\u7565\u3001\u8bc1\u4e66\u8f6e\u6362\u3001\u6f0f\u6d1e\u626b\u63cf\u3001\u5b89\u5168\u5934\u90e8\uff08CSP, X-Frame-Options \u7b49\uff09\u3002</p>"},{"location":"2025/sre/0interview/#sre-http_1","title":"SRE \u9700\u9632\u5fa1\u54ea\u4e9b HTTP \u5c42\u653b\u51fb\uff1f","text":"<p>DDoS \u653b\u51fb\u3001\u901f\u7387\u9650\u5236\u3001\u6d41\u91cf\u6574\u5f62\u3001\u7194\u65ad\u673a\u5236\u3001WAF\uff08Web \u5e94\u7528\u9632\u706b\u5899\uff09\u3001\u5f02\u5e38\u68c0\u6d4b\u3002</p>"},{"location":"2025/sre/0interview/#jenkins","title":"Jenkins","text":""},{"location":"2025/sre/0interview/#01-jenkins","title":"01 Jenkins\u662f\u4ec0\u4e48\uff0c\u5176\u4e3b\u8981\u529f\u80fd\u662f\u4ec0\u4e48\uff1f","text":"<p>Jenkins\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u6301\u7eed\u96c6\u6210\u548c\u6301\u7eed\u4ea4\u4ed8\u5de5\u5177\u3002\u5b83\u7684\u4e3b\u8981\u529f\u80fd\u662f\u81ea\u52a8\u5316\u6784\u5efa\u3001\u6d4b\u8bd5\u548c\u90e8\u7f72\u8f6f\u4ef6\u9879\u76ee\u3002</p>"},{"location":"2025/sre/0interview/#02-jenkins","title":"02 Jenkins\u5982\u4f55\u5b9e\u73b0\u6301\u7eed\u96c6\u6210\uff1f","text":"<p>Jenkins\u901a\u8fc7\u4e0d\u65ad\u76d1\u6d4b\u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff08\u5982Git\u3001Subversion\u7b49\uff09\u4e2d\u7684\u4ee3\u7801\u53d8\u5316\uff0c\u89e6\u53d1\u6784\u5efa\u8fc7\u7a0b\uff0c\u5e76\u8fdb\u884c\u81ea\u52a8\u5316\u7684\u7f16\u8bd1\u3001\u6d4b\u8bd5\u548c\u90e8\u7f72\uff0c\u4ece\u800c\u5b9e\u73b0\u6301\u7eed\u96c6\u6210\u3002</p>"},{"location":"2025/sre/0interview/#03-jenkins","title":"03 Jenkins\u7684\u5de5\u4f5c\u539f\u7406\u662f\u4ec0\u4e48\uff1f","text":"<p>Jenkins\u91c7\u7528\u4e3b\u4ece\u67b6\u6784\uff0c\u4e3b\u8282\u70b9\u8d1f\u8d23\u4efb\u52a1\u8c03\u5ea6\u548c\u5206\u53d1\uff0c\u4ece\u8282\u70b9\u8d1f\u8d23\u5177\u4f53\u7684\u6784\u5efa\u4efb\u52a1\u3002</p> <p>\u5b83\u76d1\u542c\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u7684\u53d8\u5316\uff0c\u89e6\u53d1\u6784\u5efa\u8fc7\u7a0b\uff0c\u5e76\u63d0\u4f9b\u4e30\u5bcc\u7684\u63d2\u4ef6\u548c\u6269\u5c55\u673a\u5236\u6765\u652f\u6301\u5404\u79cd\u5f00\u53d1\u548c\u90e8\u7f72\u9700\u6c42\u3002</p>"},{"location":"2025/sre/0interview/#04-jenkins","title":"04 Jenkins\u7684\u4e3b\u8981\u7ec4\u4ef6\u6709\u54ea\u4e9b\uff1f","text":"<p>Jenkins\u7684\u4e3b\u8981\u7ec4\u4ef6\u5305\u62ec\u4e3b\u8282\u70b9\uff08Master\uff09\u3001\u4ece\u8282\u70b9\uff08Slave/Agent\uff09\u3001\u4efb\u52a1\uff08Job\uff09\u3001\u6784\u5efa\uff08Build\uff09\u3001\u63d2\u4ef6\uff08Plugin\uff09</p>"},{"location":"2025/sre/0interview/#06-jenkins","title":"06 Jenkins\u7684\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u662f\u4ec0\u7d1a\uff1f","text":"<p>Jenkins\u7684\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u662fconfig.xml\uff0c\u5176\u4e2d\u5305\u542b\u4e86Jenkins\u7684\u5168\u5c40\u914d\u7f6e\u4fe1\u606f\uff0c\u5982\u90ae\u4ef6\u901a\u77e5\u3001\u6743\u9650\u7ba1\u7406\u3001\u8282\u70b9\u914d\u7f6e\u7b49\u3002</p>"},{"location":"2025/sre/0interview/#07-jenkins","title":"07 Jenkins\u6784\u5efa\u8fc7\u7a0b\u4e2d\u5e38\u89c1\u7684\u95ee\u9898\u6709\u54ea\u4e9b\uff1f","text":"<p>\u6784\u5efa\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u9047\u5230\u5404\u79cd\u95ee\u9898\uff0c\u5982\u6784\u5efa\u5931\u8d25\u3001\u6743\u9650\u4e0d\u8db3\u3001\u4ee3\u7801\u62c9\u53d6\u5931\u8d25\u7b49\u3002\u5177\u4f53\u95ee\u9898\u53ef\u80fd\u56e0\u9879\u76ee\u548c\u73af\u5883\u800c\u5f02\u3002</p>"},{"location":"2025/sre/0interview/#08-jenkins","title":"08 \u5982\u4f55\u914d\u7f6eJenkins\u5b9e\u73b0\u5b9a\u65f6\u6784\u5efa\uff1f","text":"<p>\u53ef\u4ee5\u5728\u4efb\u52a1\u7684\u914d\u7f6e\u9875\u9762\u4e2d\uff0c\u901a\u8fc7\u201cBuild Triggers\u201d\u9009\u9879\u914d\u7f6e\u5b9a\u65f6\u6784\u5efa\u3002\u4f7f\u7528Cron\u8868\u8fbe\u5f0f\u6216\u7b80\u5355\u7684\u5b9a\u65f6\u89c4\u5219\u6765\u6307\u5b9a\u6784\u5efa\u7684\u89e6\u53d1\u65f6\u95f4\u3002</p>"},{"location":"2025/sre/0interview/#11-jenkins","title":"11 Jenkins\u5982\u4f55\u4e0e\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u96c6\u6210\uff1f","text":"<p>Jenkins\u652f\u6301\u591a\u79cd\u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff0c\u5982Git\u3001SVN\u7b49\u3002\u5728Jenkins\u7684\u4efb\u52a1\u914d\u7f6e\u9875\u9762\u4e2d\uff0c\u901a\u8fc7 \u201cSource Code Management\"\u9009\u9879\u53ef\u4ee5\u914d\u7f6e\u4e0e\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u7684\u96c6\u6210\u3002\u9700\u8981\u8bbe\u7f6e\u4ee3\u7801\u4ed3\u5e93\u5730\u5740\u3001\u8ba4\u8bc1\u4fe1\u606f\u7b49\uff0c\u4ee5\u4fbfJenkins\u80fd\u591f\u62c9\u53d6\u4ee3\u7801\u8fdb\u884c\u6784</p>"},{"location":"2025/sre/0interview/#12-jenkinsjob","title":"12 \u5982\u4f55\u521b\u5efa\u4e00\u4e2aJenkins\u4efb\u52a1\uff08Job\uff09\uff1f","text":"<p>\u53ef\u4ee5\u901a\u8fc7Jenkins\u7684Web\u754c\u9762\uff0c\u9009\u62e9\u201cNew Item\"\u6765\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4efb\u52a1\u3002\u5728\u4efb\u52a1\u914d\u7f6e\u9875\u9762\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4efb\u52a1\u7684\u540d\u79f0\u3001\u89e6\u53d1\u5668\uff08\u5982\u5b9a\u65f6\u6784\u5efa\u3001\u8f6e\u8be2SCM\u7b49\uff09\u3001\u6784\u5efa\u6b65\u9aa4\uff08\u5982\u6267\u884cShell\u547d\u4ee4\u3001\u8c03\u7528Maven\u6784\u5efa\u7b49\uff09\u4ee5\u53ca\u6784\u5efa\u540e\u7684\u64cd\u4f5c\uff08\u5982\u53d1\u9001\u90ae\u4ef6\u901a\u77e5\u3001\u53d1\u5e03\u6784\u5efa\u4ea7\u7269\u7b49\uff09</p>"},{"location":"2025/sre/0interview/#13-jenkins","title":"13 Jenkins\u7684\u6784\u5efa\u8fc7\u7a0b\u662f\u600e\u6837\u7684\uff1f","text":"<p>Jenkins\u7684\u6784\u5efa\u8fc7\u7a0b\u901a\u5e38\u5305\u62ec\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a</p> <ul> <li>\u4ee3\u7801\u62c9\u53d6\uff08\u4ece\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u62c9\u53d6\u4ee3\u7801\uff09\u3001</li> <li>\u7f16\u8bd1\uff08\u6267\u884c\u7f16\u8bd1\u547d\u4ee4\uff0c\u5982Maven\u7684mvn clean install\uff09\u3001</li> <li>\u6d4b\u8bd5\uff08\u6267\u884c\u6d4b\u8bd5\u811a\u672c\uff0c\u751f\u6210\u6d4b\u8bd5\u62a5\u544a\uff09\u3001</li> <li>\u6253\u5305\uff08\u5c06\u6784\u5efa\u4ea7\u7269\u6253\u5305\u6210\u53ef\u53d1\u5e03\u7684\u683c\u5f0f\uff0c\u5982JAR\u3001WAR\u7b49\uff09</li> <li>\u4ee5\u53ca\u90e8\u7f72\uff08\u5c06\u6784\u5efa\u4ea7\u7269\u90e8\u7f72\u5230\u76ee\u6807\u73af\u5883</li> </ul>"},{"location":"2025/sre/1linux/","title":"2 SRE Linux All","text":""},{"location":"2025/sre/1linux/#linux","title":"Linux\u5e38\u7528\u547d\u4ee4\u4e4b\u6587\u4ef6\u7ba1\u7406","text":""},{"location":"2025/sre/1linux/#1ls","title":"1\u3001ls\u547d\u4ee4","text":"<pre><code>ls  [\u9009\u9879] [\u6587\u4ef6]\n\n\n\n\"-a\" \uff1a\u663e\u793a\u6240\u6709\u6587\u4ef6\u548c\u76ee\u5f55\uff08.\u5f00\u5934\u7684\u9690\u85cf\u6587\u4ef6\u4e5f\u4f1a\u5217\u51fa\uff09\n\n\"-l\" \uff1a\u663e\u793a\u5f53\u524d\u76ee\u5f55\u4e0b\u6587\u4ef6\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\n\n\"-d\" \uff1a\u663e\u793a\u76ee\u5f55\u672c\u8eab\uff0c\u4e00\u822c\u7ed3\u5408-l\u4f7f\u7528\n\n\"-i\"  \uff1a\u663e\u793a\u6587\u4ef6\u65f6\uff0c\u540c\u65f6\u663e\u793a\u6587\u4ef6\u7684\u7d22\u5f15\u8282\u70b9\n\n\"-r\"  \uff1a\u5012\u5e8f\u663e\u793a\u6587\u4ef6\n\n\"-h\" \uff1a\u4ee5\u4eba\u4eec\u53ef\u8bfb\u7684\u65b9\u5f0f\u663e\u793a\u6587\u4ef6\u5927\u5c0f\uff0c\u6bd4\u59821k,200M\uff0c2G\u7b49\uff09\n</code></pre> <p>\u5e38\u7528\u64cd\u4f5c\uff1a</p> <pre><code>ls               //\u67e5\u770b\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u76ee\u5f55\u548c\u6587\u4ef6\n\nls -a            //\u67e5\u770b\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u7684\u76ee\u5f55\u548c\u6587\u4ef6\uff08\u5305\u542b\u9690\u85cf\u6587\u4ef6\uff09\n\nls -l            // \u5217\u8868\u67e5\u770b\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u76ee\u5f55\u548c\u6587\u4ef6\uff0c\u4e0e\u201cll\u201d\u6548\u679c\u4e00\u6837\n\nls /             //  \u67e5\u770b\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u76ee\u5f55\u548c\u6587\u4ef6\n</code></pre>"},{"location":"2025/sre/1linux/#2cp","title":"2\u3001cp\u547d\u4ee4","text":"<pre><code>cp  [\u9009\u9879]   \u6e90\u6587\u4ef6   \u76ee\u6807\u6587\u4ef6\n\n\n\"-r\"  \uff1a\u9012\u5f52\u590d\u5236\uff0c\u7528\u4e8e\u590d\u5236\u76ee\u5f55\n\n\"-i\" \uff1a\u8be2\u95ee\uff0c\u5982\u679c\u76ee\u6807\u6587\u4ef6\u5df2\u7ecf\u5b58\u5728\uff0c\u5219\u4f1a\u8be2\u95ee\u662f\u5426\u8986\u76d6\u3002\u9ed8\u8ba4\u8bbe\u7f6e\n\n\"-d\" \uff1a\u5982\u679c\u6e90\u6587\u4ef6\u4e3a\u8f6f\u94fe\u63a5\uff08\u5bf9\u786c\u94fe\u63a5\u65e0\u6548\uff09\uff0c\u5219\u590d\u5236\u51fa\u7684\u76ee\u6807\u6587\u4ef6\u4e5f\u4e3a\u8f6f\u94fe\u63a5\n\n\"-p\"\uff1a\u590d\u5236\u540e\u76ee\u6807\u6587\u4ef6\u4fdd\u7559\u6e90\u6587\u4ef6\u7684\u5c5e\u6027\uff08\u5305\u62ec\u6240\u6709\u8005\uff0c\u6240\u5c5e\u7ec4\uff0c\u6743\u9650\u548c\u65f6\u95f4\uff09\n\n\"-a\" \uff1a\u76f8\u5f53\u4e8e-d\u3001-p\u3001-r\u9009\u9879\u7684\u96c6\u5408\u3002\n</code></pre> <p>\u5e38\u7528\u64cd\u4f5c\uff1a</p> <pre><code>cp  /tmp/tool   /opt         //\u5c06/tmp/tool\u76ee\u5f55\u590d\u5236\u5230/opt\u76ee\u5f55\u4e0b\ncp  /tmp/tool/*  /opt       //\u5c06/tmp/tool\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u590d\u5236\u5230/opt\u76ee\u5f55\u4e0b\ncp -r /tmp/tool/ /opt       //\u5c06/tmp/tool\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u53ca\u76ee\u5f55\u590d\u5236\u5230/opt\u76ee\u5f55\u4e0b\n</code></pre>"},{"location":"2025/sre/1linux/#4mkdir","title":"4\u3001mkdir\u547d\u4ee4","text":"<pre><code>mkdir  [\u9009\u9879]  \u76ee\u5f55..\n\n\"-p\"  \uff1a\u521b\u5efa\u591a\u7ea7\u76ee\u5f55\n\n\nmkdir  dir                       // \u521b\u5efa\u76ee\u5f55dir\nmkdir  -p  dir/dir1/dir2         //\u521b\u5efa\u591a\u7ea7\u76ee\u5f55\n</code></pre>"},{"location":"2025/sre/1linux/#5mv","title":"5\u3001mv\u547d\u4ee4","text":"<pre><code>mv  file1   file2    //\u79fb\u52a8file1\u5230file2\u4e2d\uff0c\u5982\u679c\u4e0d\u5b58\u5728file2\uff0c\u76f8\u5f53\u4e8e\u91cd\u547d\u540dfile1\uff0c\u540c\u6837\u9002\u7528\u4e8e\u76ee\u5f55\u3002\nmv  /opt/*    /tmp   //\u5c06/opt\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u79fb\u52a8\u5230/tmp\u76ee\u5f55\u4e0b\n</code></pre>"},{"location":"2025/sre/1linux/#6rm","title":"6\u3001rm\u547d\u4ee4","text":"<pre><code>\n\"-i\" \uff1a\u5220\u9664\u4e4b\u524d\u9700\u8981\u786e\u5b9a\n\n\"-r\" \uff1a\u9012\u5f52\u5220\u9664\uff0c\u7528\u4e8e\u5220\u9664\u76ee\u5f55\n\n\"-f\" \uff1a\u5f3a\u5236\u5220\u9664\uff0c\u4e0d\u9700\u8981\u786e\u8ba4\n\n\nrm   file1               //\u5220\u9664\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\nrm -f  file1             //\u5f3a\u5236\u5220\u9664\u6587\u4ef6\nrm  -rf  dir            //\u5f3a\u5236\u5220\u9664dir\u76ee\u5f55\u53cadir\u76ee\u5f55\u91cc\u7684\u6240\u6709\u76ee\u5f55\u548c\u6587\u4ef6\nrm -rf  *                //\u5220\u9664\u5f53\u524d\u76ee\u5f55\u7684\u6240\u6709\u76ee\u5f55\u548c\u6587\u4ef6\uff0c\u614e\u7528\nrm -rf  /*              //\u614e\u7528\uff0c\u8dd1\u8def\u547d\u4ee4\u3002\n</code></pre>"},{"location":"2025/sre/1linux/#7ln","title":"7\u3001ln\u547d\u4ee4","text":"<p>\u8bed\u6cd5\uff1a</p> <pre><code>ln  [\u9009\u9879]   \u6e90\u6587\u4ef6   \u94fe\u63a5\u6587\u4ef6\n\n\n\n\"-s\"  \uff1a\u521b\u5efa\u7b26\u53f7\u94fe\u63a5\n\n\"-f\"  \uff1a\u5f3a\u5236\u6267\u884c\uff0c\u8986\u76d6\u73b0\u6709\u6587\u4ef6\n\n\nln  test.txt   hard_link       //\u521b\u5efa\u4e00\u4e2a\u786c\u94fe\u63a5\uff0c\u5220\u9664\u4e86\u6e90\u6587\u4ef6\uff0c\u94fe\u63a5\u6587\u4ef6\u4ecd\u7136\u53ef\u7528\n\nln -s  test.txt   soft_link    // \u521b\u5efa\u4e00\u4e2a\u8f6f\u94fe\u63a5\uff0c\u5220\u9664\u4e86\u6e90\u6587\u4ef6\uff0c\u94fe\u63a5\u6587\u4ef6\u4e0d\u53ef\u7528\uff0c\u76f8\u5f53\u4e8ewindow\u7684\u5feb\u6377\u65b9\u5f0f\u3002\n</code></pre>"},{"location":"2025/sre/1linux/#9chown","title":"9\u3001chown\u547d\u4ee4","text":"<pre><code>chown  [\u9009\u9879]  \u5c5e\u4e3b\u6743\u9650.\u7ec4\u6743\u9650  \u6587\u4ef6/\u76ee\u5f55\n\n\nchown -R rudy.rudy   /tmp       # \u5c06/tmp\u7684\u5c5e\u4e3b\u548c\u5c5e\u7ec4\u4fee\u6539\u4e3arudy\u6743\u9650\u3002\n\n</code></pre>"},{"location":"2025/sre/1linux/#10chattr","title":"10\u3001chattr\u547d\u4ee4","text":"<pre><code>chattr [-RV][-v&lt;\u7248\u672c\u7f16\u53f7&gt;][+/-/=&lt;\u5c5e\u6027&gt;][\u6587\u4ef6\u6216\u76ee\u5f55...]\n\n\n\n-R \u9012\u5f52\u5904\u7406\uff0c\u5c06\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u53ca\u5b50\u76ee\u5f55\u4e00\u5e76\u5904\u7406\u3002\n-V \u663e\u793a\u6307\u4ee4\u6267\u884c\u8fc7\u7a0b\u3002\n\u3000\u3000+&lt;\u5c5e\u6027&gt; \u5f00\u542f\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u8be5\u9879\u5c5e\u6027\u3002\n\u3000\u3000-&lt;\u5c5e\u6027&gt; \u5173\u95ed\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u8be5\u9879\u5c5e\u6027\u3002\n\u3000\u3000=&lt;\u5c5e\u6027&gt; \u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u8be5\u9879\u5c5e\u6027\u3002\n\n\u5c5e\u6027\uff1a\n\na\uff1a\u8ba9\u6587\u4ef6\u6216\u76ee\u5f55\u4ec5\u4f9b\u9644\u52a0\u7528\u9014\u3002\nc\uff1a\u5c06\u6587\u4ef6\u6216\u76ee\u5f55\u538b\u7f29\u540e\u5b58\u653e\u3002\ni\uff1a\u4e0d\u5f97\u4efb\u610f\u66f4\u52a8\u6587\u4ef6\u6216\u76ee\u5f55\u3002\nu\uff1a\u9884\u9632\u610f\u5916\u5220\u9664\u3002\n\n\n[root@localhost ~]# chattr +a /etc/passwd     //\u53ea\u80fd\u5411\u6587\u4ef6\u4e2d\u6dfb\u52a0\u6570\u636e\uff0c\u800c\u4e0d\u80fd\u5220\u9664\uff0c\u591a\u7528\u4e8e\u670d\u52a1\u5668\u65e5\u5fd7\u6587\u4ef6\u5b89\u5168 \u3002   -a  \u53ef\u53bb\u6389\u8be5\u5c5e\u6027\n[root@localhost ~]# chattr +i /etc/passwd     //\u8bbe\u5b9a\u6587\u4ef6\u4e0d\u80fd\u88ab\u5220\u9664\u3001\u6539\u540d\u3001\u5199\u5165\u6216\u65b0\u589e\u5185\u5bb9   -i  \u53ef\u53bb\u6389\u8be5\u5c5e\u6027\n</code></pre>"},{"location":"2025/sre/1linux/#11lsattr","title":"11\u3001lsattr\u547d\u4ee4","text":"<pre><code>\n[root@localhost ~]# lsattr /etc/passwd    //\u67e5\u770b\u6587\u4ef6\u6269\u5c55\u5c5e\u6027\n----ia---------- /etc/passwd\n</code></pre>"},{"location":"2025/sre/1linux/#12xargs","title":"12\u3001xargs\u547d\u4ee4","text":"<p>\u4f5c\u7528\uff1a\u5c06\u6807\u51c6\u8f93\u5165\u8f6c\u6362\u6210\u547d\u4ee4\u884c\u53c2\u6570</p> <pre><code>\"-n\"    \uff1a\u6307\u5b9a\u6bcf\u884c\u7684\u6700\u5927\u53c2\u6570\u91cf\n\"-i\"    \uff1a\u4ee5{}\u66ff\u4ee3\u524d\u9762\u7684\u7ed3\u679c\n\n\nxargs -n  3   &lt;   test.txt     //\u6bcf\u884c\u6700\u591a\u8f93\u51fa\u4e09\u4e2a\u5b57\u7b26\n\nxargs    \uff1a\u6240\u6709\u8f93\u51fa\u90fd\u53d8\u4e3a\u4e00\u884c\n\n\nfind  /  -name  \"*.log\" | xargs -i  mv  {}  dir1  //\u5c06\u4ee5.log\u7ed3\u5c3e\u7684\u6240\u6709\u6587\u4ef6\u79fb\u52a8\u5230dir1\u76ee\u5f55\u4e0b\nfind  /   -name  \"*.log\"  | xargs rm -rf          //\u5c06\u4ee5.log\u7ed3\u5c3e\u7684\u6240\u6709\u6587\u4ef6\u5220\u9664\u3002\u7b49\u540c\u4e8efind  / -name  \"*.log\" -exec rm -rf {} \\;\n</code></pre>"},{"location":"2025/sre/1linux/#file","title":"file\uff1a\u663e\u793a\u6587\u4ef6\u7684\u7c7b\u578b","text":"<pre><code>\n[root@localhost ~]# file anaconda-ks.cfg \nanaconda-ks.cfg: ASCII text\n</code></pre> <p>Linux\u6587\u4ef6\u7c7b\u578b\u8bf4\u660e\uff1a</p> <p>\u666e\u901a\u6587\u4ef6\u7c7b\u578b\uff1aLinux\u4e2d\u6700\u591a\u7684\u4e00\u79cd\u6587\u4ef6\u7c7b\u578b, \u5305\u62ec \u7eaf\u6587\u672c\u6587\u4ef6(ASCII)\uff1b\u4e8c\u8fdb\u5236\u6587\u4ef6(binary)\uff1b\u6570\u636e\u683c\u5f0f\u7684\u6587\u4ef6(data);\u5404\u79cd\u538b\u7f29\u6587\u4ef6.\u7b2c\u4e00\u4e2a\u5c5e\u6027\u4e3a [-]</p> <p>\u76ee\u5f55\u6587\u4ef6\uff1a \u80fd\u7528 # cd \u547d\u4ee4\u8fdb\u5165\u7684\u3002\u7b2c\u4e00\u4e2a\u5c5e\u6027\u4e3a [d]\uff0c\u4f8b\u5982 [drwxrwxrwx]</p> <p>\u5757\u8bbe\u5907\u6587\u4ef6 \uff1a\u5c31\u662f\u5b58\u50a8\u6570\u636e\u4ee5\u4f9b\u7cfb\u7edf\u5b58\u53d6\u7684\u63a5\u53e3\u8bbe\u5907\uff0c\u7b80\u5355\u800c\u8a00\u5c31\u662f\u786c\u76d8\u3002\u4f8b\u5982\u4e00\u53f7\u786c\u76d8\u7684\u4ee3\u7801\u662f /dev/hda1\u7b49\u6587\u4ef6\u3002\u7b2c\u4e00\u4e2a\u5c5e\u6027\u4e3a [b]</p> <p>\u5b57\u7b26\u8bbe\u5907\u6587\u4ef6\uff1a\u5373\u4e32\u884c\u7aef\u53e3\u7684\u63a5\u53e3\u8bbe\u5907\uff0c\u4f8b\u5982\u952e\u76d8\u3001\u9f20\u6807\u7b49\u7b49\u3002\u7b2c\u4e00\u4e2a\u5c5e\u6027\u4e3a [c]</p> <p>\u5957\u63a5\u5b57\u6587\u4ef6\uff1a\u8fd9\u7c7b\u6587\u4ef6\u901a\u5e38\u7528\u5728\u7f51\u7edc\u6570\u636e\u8fde\u63a5\u3002\u53ef\u4ee5\u542f\u52a8\u4e00\u4e2a\u7a0b\u5e8f\u6765\u76d1\u542c\u5ba2\u6237\u7aef\u7684\u8981\u6c42\uff0c\u5ba2\u6237\u7aef\u5c31\u53ef\u4ee5\u901a\u8fc7\u5957\u63a5\u5b57\u6765\u8fdb\u884c\u6570\u636e\u901a\u4fe1\u3002\u7b2c\u4e00\u4e2a\u5c5e\u6027\u4e3a [s]\uff0c\u6700\u5e38\u5728 /var/run\u76ee\u5f55\u4e2d\u770b\u5230\u8fd9\u79cd\u6587\u4ef6\u7c7b\u578b</p> <p>\u7ba1\u9053\u6587\u4ef6\uff1aFIFO\u4e5f\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6587\u4ef6\u7c7b\u578b\uff0c\u5b83\u4e3b\u8981\u7684\u76ee\u7684\u662f\uff0c\u89e3\u51b3\u591a\u4e2a\u7a0b\u5e8f\u540c\u65f6\u5b58\u53d6\u4e00\u4e2a\u6587\u4ef6\u6240\u9020\u6210\u7684\u9519\u8bef\u3002FIFO\u662ffirst-in-first-out(\u5148\u8fdb\u5148\u51fa)\u7684\u7f29\u5199\u3002\u7b2c\u4e00\u4e2a\u5c5e\u6027\u4e3a [p]</p> <p>\u94fe\u63a5\u6587\u4ef6\uff1a\u5206\u7c7b\u786c\u94fe\u63a5\u548c\u8f6f\u8fde\u63a5\uff0c\u7c7b\u4f3cWindows\u4e0b\u9762\u7684\u5feb\u6377\u65b9\u5f0f\u3002\u7b2c\u4e00\u4e2a\u5c5e\u6027\u4e3a [l]\uff0c\u4f8b\u5982 [lrwxrwxrwx]</p>"},{"location":"2025/sre/1linux/#md5summd5","title":"md5sum\uff1a\u8ba1\u7b97\u548c\u6821\u9a8c\u6587\u4ef6\u7684MD5\u503c","text":"<pre><code>\n\u9009\u9879\uff1a -c                 //\u4ece\u6307\u5b9a\u6587\u4ef6\u4e2d\u8bfb\u53d6MD5\u6821\u9a8c\u503c\uff0c\u5e76\u8fdb\u884c\u6821\u9a8c \n\n[root@localhost ~]# md5sum anaconda-ks.cfg    //\u8f93\u51fa\u4e24\u90e8\u5206\uff0c\u7b2c\u4e00\u90e8\u5206\u662fmd5\u503c\uff0c\u540e\u9762\u662f\u6587\u4ef6\u540d\n\nd862f17d783eaf1abcf4f376b5c85527  anaconda-ks.cfg \n\n[root@localhost ~]# md5sum anaconda-ks.cfg &gt;md5.log   //\u751f\u6210\u6821\u9a8c\u6587\u4ef6\n\n[root@localhost ~]# md5sum -c md5.log      //\u4f7f\u7528-c\u53c2\u6570\u68c0\u67e5\uff0c\u7ed3\u679cOK\u8868\u793a\u6587\u4ef6\u6ca1\u6709\u53d8\u5316\nanaconda-ks.cfg: OK\n</code></pre>"},{"location":"2025/sre/1linux/#linux_1","title":"Linux\u5e38\u7528\u547d\u4ee4\u4e4b\u6587\u4ef6\u5904\u7406","text":""},{"location":"2025/sre/1linux/#cat","title":"cat\u547d\u4ee4\u2014\u2014\u67e5\u770b\u6587\u4ef6\u5185\u5bb9","text":"<pre><code>\n[root@localhost ~]# cat /etc/passwd     //\u67e5\u770b\u6587\u4ef6\u5185\u5bb9\nroot:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/sbin/nologin\n\n\n[root@localhost ~]# cat &gt;&gt; /etc/fstab &lt;&lt; EOF     //\u8ffd\u52a0\u5185\u5bb9\u5230\u6587\u4ef6\u5c3e\u90e8\n&gt; /dev/sdb  /data    xfs defaults   0 0\n&gt; EOF\n\n\n\n[root@localhost ~]# cat  /dev/null  &gt; file.txt      //\u6e05\u7a7a\u6587\u4ef6\u5185\u5bb9\n</code></pre>"},{"location":"2025/sre/1linux/#more","title":"more\u547d\u4ee4\u2014\u2014\u5206\u9875\u663e\u793a\u6587\u4ef6\u5185\u5bb9","text":"<p>cat\u547d\u4ee4\u662f\u67e5\u770b\u6240\u6709\u5185\u5bb9\uff0c\u5bf9\u4e8e\u5185\u5bb9\u8f83\u957f\u7684\u6587\u4ef6\u65e0\u6cd5\u4e00\u5c4f\u663e\u793a\u6240\u6709\u5185\u5bb9\uff0c\u6240\u4ee5\u5c31\u9700\u8981\u5206\u9875\u663e\u793a\u5185\u5bb9\uff0cmore\u547d\u4ee4\u5c31\u6709\u8fd9\u79cd\u5206\u9875\u663e\u793a\u529f\u80fd\u3002</p> <pre><code>[root@localhost ~]# more /var/log/messages      //\u5206\u9875\u67e5\u770b\n\n\n\u7a7a\u683c\u952e    \u67e5\u770b\u4e0b\u4e00\u9875\n\u56de\u8f66\u952e    \u67e5\u770b\u4e0b\u4e00\u884c\nb\u952e      \u67e5\u770b\u524d\u4e00\u9875\nq\u952e      \u9000\u51fa\u67e5\u770b\u9875\u9762\n/file   \u67e5\u770b\u5305\u542bfile\u7684\u5185\u5bb9\n</code></pre>"},{"location":"2025/sre/1linux/#less","title":"less\u547d\u4ee4\u2014\u2014\u5206\u9875\u663e\u793a\u6587\u4ef6\u5185\u5bb9","text":"<pre><code>[root@localhost ~]# less /var/log/messages      //\u5206\u9875\u67e5\u770b\n\n\n\u7a7a\u683c\u952e   \u67e5\u770b\u4e0b\u4e00\u9875\n\u56de\u8f66\u952e   \u67e5\u770b\u4e0b\u4e00\u884c\nb\u952e     \u67e5\u770b\u524d\u4e00\u9875\nq\u952e     \u9000\u51fa\u67e5\u770b\u9875\u9762\n/\u5b57\u7b26\u4e32   \u5411\u4e0b\u67e5\u770b\u5305\u542bfile\u7684\u5185\u5bb9\n?\u5b57\u7b26\u4e32   \u5411\u4e0a\u641c\u7d22\u5185\u5bb9\nn        \u5411\u540e\u67e5\u627e\u4e0b\u4e00\u4e2a\u5339\u914d\u7684\u6587\u672c\ng       \u79fb\u52a8\u5230\u7b2c\u4e00\u884c\nG      \u79fb\u52a8\u5230\u6700\u540e\u4e00\u884c\n</code></pre> <p>\u603b\u7ed3\u4e0bmore \u548c less\u7684\u533a\u522b:</p> <ul> <li> <p>less\u53ef\u4ee5\u6309\u952e\u76d8\u4e0a\u4e0b\u65b9\u5411\u952e\u663e\u793a\u4e0a\u4e0b\u5185\u5bb9,more\u4e0d\u80fd\u901a\u8fc7\u4e0a\u4e0b\u65b9\u5411\u952e\u63a7\u5236\u663e\u793a</p> </li> <li> <p>less\u4e0d\u5fc5\u8bfb\u6574\u4e2a\u6587\u4ef6\uff0c\u52a0\u8f7d\u901f\u5ea6\u4f1a\u6bd4more\u66f4\u5feb</p> </li> <li> <p>less\u9000\u51fa\u540eshell\u4e0d\u4f1a\u7559\u4e0b\u521a\u663e\u793a\u7684\u5185\u5bb9,\u800cmore\u9000\u51fa\u540e\u4f1a\u5728shell\u4e0a\u7559\u4e0b\u521a\u663e\u793a\u7684\u5185\u5bb9</p> </li> </ul>"},{"location":"2025/sre/1linux/#head","title":"head\u547d\u4ee4\u2014\u2014\u663e\u793a\u6587\u4ef6\u5185\u5bb9\u5934\u90e8","text":"<pre><code>[root@localhost ~]# head /etc/passwd    //\u9ed8\u8ba4\u663e\u793a\u6587\u4ef610\u884c\n[root@localhost ~]# head -n 20 /etc/passwd  //\u663e\u793a\u6587\u4ef6\u7684\u524d20\u884c\n</code></pre>"},{"location":"2025/sre/1linux/#tail","title":"tail\u547d\u4ee4\u2014\u2014\u663e\u793a\u6587\u4ef6\u5185\u5bb9\u5c3e\u90e8","text":"<pre><code>root@localhost ~]# tail -n 20 /var/log/messages    //\u663e\u793a\u6587\u4ef6\u7684\u6700\u540e20\u884c\n\n\n[root@localhost ~]# tail -f /var/log/messages         //\u52a8\u6001\u8ffd\u8e2a\u65e5\u5fd7\u4fe1\u606f\n</code></pre>"},{"location":"2025/sre/1linux/#cut","title":"cut\u547d\u4ee4\u2014\u2014\u4ece\u6587\u4ef6\u4e2d\u63d0\u53d6\u4e00\u6bb5\u6587\u5b57\u5e76\u8f93\u51fa","text":"<ul> <li>-c    \u4ee5\u5b57\u7b26\u4e3a\u5355\u4f4d\u8fdb\u884c\u5206\u5272</li> <li>-d \u81ea\u5b9a\u4e49\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4ee5tab\u952e\u4e3a\u5206\u9694\u7b26</li> <li>-f \u6307\u5b9a\u663e\u793a\u54ea\u4e2a\u533a\u57df\uff0c\u5e38\u548c-d\u4f7f\u7528</li> </ul> <pre><code>cut -c 2-10 test.txt   //\u526a\u5207\u6bcf\u884c2-10\u4f4d\u7f6e\u7684\u5b57\u7b26\n\n\ncut -d :  -f  1  /etc/passwd     //\u6307\u5b9a\u4ee5\uff1a\u4f5c\u4e3a\u5206\u5272\u7b26\uff0c-f\u6307\u5b9a\u663e\u793a\u7b2c\u4e00\u4e2a\u533a\u57df\n</code></pre>"},{"location":"2025/sre/1linux/#split","title":"split\u547d\u4ee4\u2014\u2014\u5206\u5272\u6587\u4ef6","text":"<pre><code>split -l  10  test.txt   new_         //\u6bcf10\u884c\u5206\u5272\u4e00\u6b21\uff0c\u5206\u5272\u7684\u6587\u4ef6\u540d\u4ee5new_\u5f00\u5934\n\nsplit -l  10  -d  test.txt   new_     //\u53c2\u6570-d\u4f7f\u7528\u6570\u5b57\u540e\u7f00\n\nsplit -b 500M -d   test.txt   new_    //\u6bcf500M\u5206\u5272\u4e00\u6b21\n</code></pre>"},{"location":"2025/sre/1linux/#sort","title":"sort\u547d\u4ee4\u2014\u2014\u6587\u4ef6\u6392\u5e8f","text":"<ul> <li>-n  \u4f9d\u7167\u6570\u503c\u5927\u5c0f\u8fdb\u884c\u6392\u5e8f</li> <li>-r    \u5012\u5e8f\u6392\u5e8f</li> <li>-t  \u6307\u5b9a\u5206\u9694\u7b26</li> <li>-k    \u6309\u6307\u5b9a\u533a\u95f4\u6392\u5e8f</li> </ul> <pre><code>sort -n test.txt        //\u6309\u7167\u6570\u503c\u5927\u5c0f\u8fdb\u884c\u6392\u5e8f\n\nsort -nr  test.txt     //sort\u9ed8\u8ba4\u6309\u7167\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u4f7f\u7528-r\u9009\u9879\u5c31\u53ef\u4ee5\u5b9e\u73b0\u4ece\u5927\u5230\u5c0f\n\nsort -t \" \" -k2   test.txt     //\u4ee5\u7a7a\u683c\u4e3a\u5206\u9694\u7b26\uff0c\u6309\u7167\u7b2c\u4e8c\u5217\u8fdb\u884c\u6392\u5e8f\n</code></pre>"},{"location":"2025/sre/1linux/#uniq","title":"uniq\u547d\u4ee4\u2014\u2014\u53bb\u9664\u91cd\u590d\u884c","text":"<ul> <li>-c    \u53bb\u9664\u91cd\u590d\u884c\uff0c\u5e76\u8ba1\u7b97\u6bcf\u884c\u51fa\u73b0\u7684\u6b21\u6570</li> </ul> <pre><code>uniq -c test.txt             \n\nsort -n test.txt | uniq -c   //\u7ed3\u5408sort\u4f7f\u7528\uff0c\u5148\u6392\u5e8f\u540e\u53bb\u91cd\n</code></pre>"},{"location":"2025/sre/1linux/#wc","title":"wc\u547d\u4ee4\u2014\u2014\u7edf\u8ba1\u6587\u4ef6\u7684\u884c\u6570\u3001\u5355\u8bcd\u6216\u5b57\u8282\u6570","text":"<ul> <li>-l   \u7edf\u8ba1\u884c\u6570</li> <li>-c   \u7edf\u8ba1\u5b57\u8282\u6570</li> <li>-w   \u7edf\u8ba1\u5355\u8bcd\u6570</li> <li>-L   \u6253\u5370\u6700\u957f\u884c\u7684\u957f\u5ea6</li> </ul> <pre><code>\n[root@localhost ~]# wc /etc/passwd   //\u4e0d\u52a0\u4efb\u4f55\u53c2\u6570\u4f1a\u6253\u5370\u51fa\u884c\u6570\uff0c\u5355\u8bcd\u6570\u636e\uff0c\u5b57\u8282\u6570\u7b49\u4e09\u4e2a\u53c2\u6570\n20  28 901 /etc/passwd\n\n[root@localhost ~]# cat /var/log/messages |wc -l   //\u901a\u8fc7\u7ba1\u9053\u7b26\u6765\u7edf\u8ba1\u6587\u4ef6\u7684\u884c\u6570\n</code></pre>"},{"location":"2025/sre/1linux/#tee","title":"tee\u547d\u4ee4\u2014\u2014\u591a\u91cd\u5b9a\u5411","text":"<p>\u7528\u4e8e\u5c06\u6570\u636e\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\uff0c\u540c\u65f6\u63d0\u4f9b\u4e00\u4efd\u91cd\u5b9a\u5411\u6570\u636e\u7684\u526f\u672c\u8f93\u51fa\u5230\u5c4f\u5e55\u4e0a</p> <pre><code>ls   | tee -a  ls.txt     //\u5c06\u8f93\u51fa\u5185\u5bb9\u8bb0\u5f55\u5230ls.txt\u6587\u4ef6\u4e2d\uff0c\u5e76\u8f93\u51fa\u5230\u5c4f\u5e55\u4e0a\n</code></pre>"},{"location":"2025/sre/1linux/#3-linux","title":"3 Linux\u5e38\u7528\u547d\u4ee4\u4e4b\u4fe1\u606f\u663e\u793a","text":""},{"location":"2025/sre/1linux/#uname","title":"uname\u547d\u4ee4\u2014\u2014\u663e\u793a\u7cfb\u7edf\u4fe1\u606f","text":"<ul> <li>-a  \u663e\u793a\u7cfb\u7edf\u6240\u6709\u76f8\u5173\u7684\u4fe1\u606f</li> <li>-m    \u663e\u793a\u8ba1\u7b97\u673a\u786c\u4ef6\u67b6\u6784</li> <li>-n    \u663e\u793a\u4e3b\u673a\u540d\u79f0</li> <li>-r    \u663e\u793a\u5185\u6838\u53d1\u884c\u7248\u672c\u53f7</li> <li>-s    \u663e\u793a\u5185\u6838\u540d\u79f0</li> <li>-v  \u663e\u793a\u5185\u6838\u7248\u672c</li> <li>-o  \u663e\u793a\u64cd\u4f5c\u7cfb\u7edf\u540d\u79f0</li> </ul> <pre><code>[root@localhost ~]# uname -a    //\u663e\u793a\u7cfb\u7edf\u6240\u6709\u76f8\u5173\u7684\u4fe1\u606f\nLinux localhost.localdomain 3.10.0-1160.el7.x86_64 #1 SMP Mon Oct 19 16:18:59 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\n\n\n[root@localhost ~]# uname -r    //\u663e\u793a\u5185\u6838\u53d1\u884c\u7248\u672c\n3.10.0-1160.el7.x86_64\n\n[root@localhost ~]# uname -v\n#1 SMP Mon Oct 19 16:18:59 UTC 2020\n</code></pre>"},{"location":"2025/sre/1linux/#hostname","title":"hostname\u547d\u4ee4\u2014\u2014\u663e\u793a\u6216\u8bbe\u7f6e\u7cfb\u7edf\u7684\u4e3b\u673a\u540d","text":"<p>/etc/hosts   \uff1a\u914d\u7f6e\u57df\u540d\u7684\u6587\u4ef6</p> <p>/etc/hostname  \uff1acentos7\u4fee\u6539\u4e3b\u673a\u540d\u7684\u6587\u4ef6</p> <p>/etc/sysconfig/network \uff1acentos6\u4fee\u6539\u4e3b\u673a\u540d\u7684\u6587\u4ef6</p> <pre><code>\n[root@localhost ~]# hostname liyongbin     //\u4e34\u65f6\u8bbe\u7f6e\u6587\u4ef6\u540d\uff0c\u91cd\u542f\u540e\u5931\u6548\n\n[root@localhost ~]# hostname   //\u67e5\u770b\u4e3b\u673a\u540d\nliyongbin\n\n[root@localhost ~]# hostnamectl set-hostname rudy   //\u6c38\u4e45\u4fee\u6539\u6587\u4ef6\u540d\uff0c\u91cd\u542f\u4e0d\u5931\u6548\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539/etc/hostname\u6587\u4ef6\n\n[root@localhost ~]# hostname \nrudy\n\n[root@localhost ~]# hostname -I  //\u663e\u793a\u4e3b\u673a\u7684\u6240\u6709IP\u5730\u5740\uff0c\u4e0d\u4f9d\u8d56DNS\u89e3\u6790\uff0c\u6709\u591a\u5c11\u5757\u7f51\u5361\u5c31\u6709\u591a\u5c11\u4e2aIP\u5730\u5740\n10.13.2.13\n</code></pre>"},{"location":"2025/sre/1linux/#dmesg","title":"dmesg\u547d\u4ee4\u2014\u2014\u7cfb\u7edf\u542f\u52a8\u5f02\u5e38\u8bca\u65ad","text":"<p>dmesg\u7528\u4e8e\u663e\u793a\u5185\u6838\u73af\u5f62\u7f13\u51b2\u533a\uff08kernel-ring  buffer\uff09\u7684\u5185\u5bb9\u3002\u4fdd\u5b58\u5728/var/log\u76ee\u5f55\u4e0b</p> <pre><code>\n[root@localhost ~]# dmesg |grep -i error     //\u67e5\u770b\u7cfb\u7edf\u542f\u52a8\u8fc7\u7a0b\u4e2d\u7684\u9519\u8bef\u4fe1\u606f\n[    0.955079] BERT: Boot Error Record Table support is disabled. Enable it by using bert_enable as kernel parameter.\n</code></pre>"},{"location":"2025/sre/1linux/#du","title":"du\u547d\u4ee4\u2014\u2014\u663e\u793a\u76ee\u5f55\u6216\u6587\u4ef6\u6240\u5360\u7528\u7684\u78c1\u76d8\u7a7a\u95f4","text":"<ul> <li>-s    \u663e\u793a\u603b\u8ba1\u5bb9\u91cf</li> <li>-h  \u4ee5\u4eba\u4e3a\u53ef\u8bfb\u7684\u5f62\u5f0f\u663e\u793a\uff0c\u4ee5K\uff0cM\uff0cG\u4e3a\u5355\u4f4d</li> <li>-m   \u4ee5MB\u4e3a\u5355\u4f4d</li> <li>--exclude=&lt;\u76ee\u5f55\u6216\u6587\u4ef6\u300b  \u5ffd\u7565\u6307\u5b9a\u7684\u76ee\u5f55\u6216\u6587\u4ef6</li> </ul> <pre><code>\n[root@localhost ~]# du -sh *   //\u67e5\u770b\u5f53\u524d\u76ee\u5f55\u6240\u6709\u5b50\u76ee\u5f55\u548c\u6587\u4ef6\u7684\u5927\u5c0f\n\n0  anaconda-ks.cfg\n\n4.0K  md5.log\n4.0K  test.txt\n[root@localhost ~]# du -sh md5.log         //\u67e5\u770bhosts\u6587\u4ef6\u5927\u5c0f\n4.0K  md5.log\n</code></pre>"},{"location":"2025/sre/1linux/#date","title":"date\u547d\u4ee4\u2014\u2014\u663e\u793a\u548c\u8bbe\u7f6e\u65f6\u95f4","text":"<pre><code>\n-d   \u663e\u793a\u5b57\u7b26\u4e32\u6240\u6307\u7684\u65e5\u671f\u4e0e\u65f6\u95f4\n-s   \u6307\u5b9a\u5f53\u524d\u7cfb\u7edf\u65f6\u95f4\n-u   \u6253\u5370\u6216\u8bbe\u7f6e\u534f\u8c03\u4e16\u754c\u65f6\uff08UTC\n\n\n%F  \u663e\u793a\u5e74\u6708\u65e5\n%T  \u663e\u793a\u65f6\u5206\u79d2\n%Y  \u663e\u793a\u5e74\u4efd\n%m  \u663e\u793a\u6708\u4efd\n%d  \u663e\u793a\u4e00\u4e2a\u6708\u7684\u7b2c\u51e0\u5929\n%H  \u663e\u793a\u65f6\n%M  \u663e\u793a\u5206\n%S  \u663e\u793a\u79d2\n%w  \u663e\u793a\u661f\u671f\u51e0\n\n\n\n[root@localhost ~]# date       //\u663e\u793a\u5f53\u524d\u65f6\u95f4\n2023\u5e74 10\u6708 22\u65e5 \u661f\u671f\u65e5 15:29:40 CST\n\n[root@localhost ~]# date +%F         //\u663e\u793a\u5e74\u6708\u65e5\n2023-10-22\n\n[root@localhost ~]# date +%T         //\u663e\u793a\u65f6\u5206\u79d2\n15:33:35\n\n[root@localhost ~]# date -s \"2024-10-22 15:30:00\"     //\u8bbe\u7f6e\u6307\u5b9a\u65f6\u95f4\n2024\u5e74 10\u6708 22\u65e5 \u661f\u671f\u4e8c 15:30:00 CST\n\n[root@localhost ~]# date \n2024\u5e74 10\u6708 22\u65e5 \u661f\u671f\u4e8c 15:30:06 CST\n\n[root@localhost ~]# date +%F -d \"100day\"       //\u663e\u793a100\u5929\u540e\u7684\u65f6\u95f4\n2024-01-30\n\n[root@localhost ~]# date +%F -d \"-100day\"    //\u663e\u793a100\u5929\u524d\u7684\u65f6\u95f4\n2023-07-14\n\n[root@localhost ~]# date +\"%Y-%m-%d %H:%M:%S\"   //\u6307\u5b9a\u683c\u5f0f\u663e\u793a\u5f53\u524d\u65f6\u95f4\n2023-10-22 15:37:24\n</code></pre>"},{"location":"2025/sre/1linux/#echo","title":"echo\u547d\u4ee4\u2014\u2014\u663e\u793a\u4e00\u884c\u6587\u672c","text":"<pre><code>[root@localhost ~]# echo $PATH       //\u6253\u5370\u73af\u5883\u53d8\u91cf\n/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin\n\n[root@localhost ~]# echo manager &gt; test.sh    //\u5c06\u6253\u5370\u5b57\u7b26\u91cd\u5b9a\u5411\u5230\u6587\u672c\u4e2d\n\n[root@localhost ~]# cat test.sh \nmanager\n\n[root@localhost ~]# echo manager |passwd --stdin root   //\u4fee\u6539\u5bc6\u7801\n\u66f4\u6539\u7528\u6237 root \u7684\u5bc6\u7801 \u3002\npasswd\uff1a\u6240\u6709\u7684\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u5df2\u7ecf\u6210\u529f\u66f4\u65b0\u3002\n</code></pre>"},{"location":"2025/sre/1linux/#watch","title":"watch\u547d\u4ee4\u2014\u2014\u76d1\u89c6\u547d\u4ee4\u6267\u884c\u60c5\u51b5","text":"<p>watch \u547d\u4ee4\u4ee5\u5468\u671f\u6027\u7684\u65b9\u5f0f\u6267\u884c\u7ed9\u5b9a\u7684\u547d\u4ee4\uff0c\u5e76\u5168\u5c4f\u663e\u793a\u6267\u884c\u7ed3\u679c\u3002watch \u53ef\u4ee5\u5e2e\u52a9\u76d1\u6d4b\u4e00\u4e2a\u547d\u4ee4\u7684\u8fd0\u884c\u7ed3\u679c\uff0c\u7701\u5f97\u6211\u4eec\u4e00\u904d\u904d\u5730\u624b\u52a8\u8fd0\u884c\u3002</p> <p>-n   \u6307\u5b9a\u76d1\u6d4b\u95f4\u9694\uff0c\u5355\u4f4d\u79d2\u3002\u9ed8\u8ba4 2s\uff0c\u4e0d\u80fd\u4f4e\u4e8e 0.1s -d  \u9ad8\u4eae\u663e\u793a\u6700\u8fd1\u4e24\u6b21\u66f4\u65b0\u4e4b\u540e\u7684\u5dee\u5f02</p> <pre><code>\n[root@localhost ~]# watch -n 1 -d netstat -lntup  //\u6bcf\u9694 1s \u9ad8\u4eae\u663e\u793a\u7f51\u7edc\u8fde\u63a5\u6570\u7684\u53d8\u5316\u60c5\u51b5\u3002\n[root@localhost ~]# watch uptime   //\u6bcf2s\u663e\u793a\u8d1f\u8f7d\u60c5\u51b5\n\nCtrl+C\u9000\u51fawatch\u547d\u4ee4\u754c\u9762\n</code></pre>"},{"location":"2025/sre/1linux/#which","title":"which\u547d\u4ee4\u2014\u2014\u663e\u793a\u547d\u4ee4\u7684\u5168\u8def\u5f84","text":"<pre><code>\n[root@localhost ~]# which   date     //\u67e5\u770bdate\u547d\u4ee4\u7684\u5168\u8def\u5f84\n/usr/bin/date\n\n[root@localhost ~]# which which     //\u5982\u679c\u8bbe\u7f6e\u4e86\u522b\u540d\uff0c\u90a3\u4e48\u4f7f\u7528which\u529f\u80fd\u8fd8\u5c06\u4f1a\u663e\u793a\u522b\u540d\nalias which='alias | /usr/bin/which --tty-only --read-alias --show-dot --show-tilde'\n  /usr/bin/alias\n  /usr/bin/which\n\n\n[root@localhost ~]# which shutdown poweroff    //\u540c\u65f6\u663e\u793a\u591a\u4e2a\n/usr/sbin/shutdown\n/usr/sbin/poweroff\n</code></pre>"},{"location":"2025/sre/1linux/#binsbinusrsbinusrbin","title":"\u8be6\u89e3/bin,/sbin,/usr/sbin,/usr/bin \u76ee\u5f55\u533a\u522b\u3001","text":"<p>/sbin \u548c/bin</p> <ol> <li>\u4ece\u547d\u4ee4\u529f\u80fd\u533a\u5206</li> </ol> <p>/sbin \u4e0b\u7684\u547d\u4ee4\u5c5e\u4e8e\u57fa\u672c\u7684\u7cfb\u7edf\u547d\u4ee4\uff0c\u5982shutdown\uff0creboot\uff0c\u7528\u4e8e\u542f\u52a8\u7cfb\u7edf\uff0c\u4fee\u590d\u7cfb\u7edf</p> <p>/bin\u4e0b\u5b58\u653e\u4e00\u4e9b\u666e\u901a\u7684\u57fa\u672c\u547d\u4ee4\uff0c\u5982ls,chmod\u7b49\uff0c\u8fd9\u4e9b\u547d\u4ee4\u5728Linux\u7cfb\u7edf\u91cc\u7684\u914d\u7f6e\u6587\u4ef6\u811a\u672c\u91cc\u7ecf\u5e38\u7528\u5230</p> <ol> <li>\u4ece\u7528\u6237\u6743\u9650\u89d2\u5ea6\u533a\u5206</li> </ol> <p>/sbin\u76ee\u5f55\u4e0b\u7684\u547d\u4ee4\u901a\u5e38\u53ea\u6709\u7ba1\u7406\u5458\u624d\u53ef\u4ee5\u8fd0\u884c</p> <p>/bin\u4e0b\u7684\u547d\u4ee4\u7ba1\u7406\u5458\u548c\u4e00\u822c\u7684\u7528\u6237\u90fd\u53ef\u4ee5\u4f7f\u7528\u3002</p> <p>/bin\u662f\u7cfb\u7edf\u7684\u4e00\u4e9b\u6307\u4ee4\uff0c\u4e3b\u8981\u653e\u7f6e\u4e00\u4e9b\u7cfb\u7edf\u7684\u5fc5\u5907\u6267\u884c\u547d\u4ee4</p> <pre><code>cat\u3001cp\u3001chmod df\u3001dmesg\u3001gzip\u3001kill\u3001ls\u3001mkdir\u3001more\u3001mount\u3001rm\u3001su\u3001tar\u7b49\n</code></pre> <p>/sbin\u4e00\u822c\u662f\u6307\u8d85\u7ea7\u7528\u6237\u6307\u4ee4\u3002\u4e3b\u8981\u653e\u7f6e\u4e00\u4e9b\u7cfb\u7edf\u7ba1\u7406\u7684\u5fc5\u5907\u7a0b\u5f0f</p> <pre><code>dump\u3001fdisk\u3001halt\u3001ifconfig\u3001ifup\u3001 ifdown\u3001init\u3001insmod \uff0clsmod\u3001reboot\u3001shutdown \u7b49\u3002\n</code></pre>"},{"location":"2025/sre/1linux/#4-linux","title":"4 Linux\u5e38\u7528\u547d\u4ee4\u4e4b\u6587\u4ef6\u5907\u4efd\u548c\u538b\u7f29","text":""},{"location":"2025/sre/1linux/#tar","title":"tar\u547d\u4ee4\u2014\u2014\u538b\u7f29\u5907\u4efd","text":"<p>tar\u547d\u4ee4\u662flinux\u975e\u5e38\u4f7f\u7528\u9891\u7387\u975e\u5e38\u9ad8\u7684\u4e00\u4e2a\u547d\u4ee4\u3002\u6253\u5305\u662f\u6307\u5c06\u4e00\u5927\u5806\u6587\u4ef6\u6216\u76ee\u5f55\u53d8\u6210\u4e00\u4e2a\u603b\u7684\u6587\u4ef6\uff0c\u538b\u7f29\u5219\u662f\u5c06\u4e00\u4e2a\u5927\u7684\u6587\u4ef6\u901a\u8fc7\u4e00\u4e9b\u538b\u7f29\u7b97\u6cd5\u53d8\u6210\u4e00\u4e2a\u5c0f\u6587\u4ef6\u3002</p> <pre><code>\n-c \u521b\u5efa\u4e00\u4e2a\u65b0\u7684tar\u538b\u7f29\u5305\n-x \u89e3\u538btar\u5305\n-t \u67e5\u770b\u538b\u7f29\u5305\u7684\u5185\u5bb9\n-C \u6307\u5b9a\u89e3\u538b\u8def\u5f84\n-f \u6307\u5b9a\u8981\u5904\u7406\u7684\u6587\u4ef6\u540d\n-j \u4f7f\u7528bzip2\u65b9\u5f0f\u8fdb\u884c\u538b\u7f29\u6216\u89e3\u538b\n-z \u4f7f\u7528gzip\u65b9\u5f0f\u8fdb\u884c\u538b\u7f29\u6216\u89e3\u538b\n--exclude=PATHERN   \u6253\u5305\u65f6\u6392\u9664\u4e0d\u9700\u8981\u5904\u7406\u7684\u6587\u4ef6\u6216\u76ee\u5f55\n-v \u663e\u793a\u8be6\u7ec6\u8fc7\u7a0b\n</code></pre> <pre><code>\n1\u3001 \u89e3\u538b\u7f29\u5305\u5230\u6307\u5b9a\u4f4d\u7f6e\n\n[root@localhost ~]# tar -zxvf jdk-8u202-linux-x64.tar.gz -C /data  \n[root@localhost ~]# ll /data\n\u603b\u7528\u91cf 0\ndrwxr-xr-x 7 10 143 245 12\u6708 16 2018 jdk1.8.0_202\n\n2\u3001 \u538b\u7f29\u6587\u4ef6\n\n[root@localhost data]# tar -zcvf jdk8.tar.gz jdk1.8.0_202/\n[root@localhost data]# ll\n\u603b\u7528\u91cf 189500\ndrwxr-xr-x 7   10  143       245 12\u6708 16 2018 jdk1.8.0_202\n-rw-r--r-- 1 root root 194045097 10\u6708 22 20:26 jdk8.tar.gz\n\n3\u3001 \u67e5\u770b\u538b\u7f29\u5305\u5185\u5bb9\n[root@localhost data]# tar -tf jdk8.tar.gz\n</code></pre>"},{"location":"2025/sre/1linux/#gzip","title":"gzip\u547d\u4ee4\u2014\u2014\u538b\u7f29\u6216\u89e3\u538b\u6587\u4ef6","text":"<p>gzip\u547d\u4ee4\u7528\u4e8e\u5c06\u4e00\u4e2a\u5927\u7684\u6587\u4ef6\u901a\u8fc7\u538b\u7f29\u7b97\u6cd5\u53d8\u6210\u4e00\u4e2a\u5c0f\u7684\u6587\u4ef6\u3002gzip\u547d\u4ee4\u4e0d\u80fd\u76f4\u63a5\u538b\u7f29\u76ee\u5f55\uff0c\u56e0\u6b64\u76ee\u5f55\u9700\u8981\u5148\u7528tar\u6253\u5305\u6210\u4e00\u4e2a\u6587\u4ef6\uff0c\u7136\u540etar\u518d\u8c03\u7528gzip\u8fdb\u884c\u538b\u7f29\u3002</p> <pre><code>-d    \u89e3\u5f00\u538b\u7f29\u6587\u4ef6\n-v   \u663e\u793a\u6267\u884c\u8fc7\u7a0b\n-c   \u5c06\u5185\u5bb9\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u4e0d\u6539\u53d8\u539f\u59cb\u6587\u4ef6\n</code></pre> <p>\u5e38\u7528\u64cd\u4f5c\uff1a</p> <pre><code>1\u3001\u538b\u7f29\u6587\u4ef6\uff0c\u9ed8\u8ba4\u4e0d\u4fdd\u7559\u6e90\u6587\u4ef6\uff0c\u5c06\u6e90\u6587\u4ef6\u505a\u6210.gz\u538b\u7f29\u5305\n[root@localhost ~]# gzip hosts    \n[root@localhost ~]# ll\n\u603b\u7528\u91cf 8\n-rw------- 1 root root 1506 3\u6708  13 2022 anaconda-ks.cfg\n-rw-r--r-- 1 root root   94 10\u6708 22 20:36 hosts.gz\ndrwxr-xr-x 2 root root    6 10\u6708 22 20:36 test\n\n2\u3001\u89e3\u5f00\u538b\u7f29\u5305\n[root@localhost ~]# gzip -d hosts.gz \n[root@localhost ~]# ll\n\u603b\u7528\u91cf 8\n-rw------- 1 root root 1506 3\u6708  13 2022 anaconda-ks.cfg\n-rw-r--r-- 1 root root  177 10\u6708 22 20:36 hosts\ndrwxr-xr-x 2 root root    6 10\u6708 22 20:36 test\n\n3\u3001\u538b\u7f29\u76ee\u5f55\uff08\u538b\u7f29\u5931\u8d25\uff0c\u53ea\u80fd\u538b\u7f29\u6587\u4ef6\uff0c\u4e0d\u53ef\u538b\u7f29\u76ee\u5f55\uff09\n[root@localhost ~]# gzip test/\ngzip: test/ is a directory -- ignored\n\n4\u3001\u4fdd\u7559\u6e90\u6587\u4ef6\u538b\u7f29\n[root@localhost ~]# gzip -c hosts &gt;hosts.gz\n[root@localhost ~]# ll\n\u603b\u7528\u91cf 12\n-rw------- 1 root root 1506 3\u6708  13 2022 anaconda-ks.cfg\n-rw-r--r-- 1 root root  177 10\u6708 22 20:36 hosts\n-rw-r--r-- 1 root root   94 10\u6708 22 20:44 hosts.gz\n</code></pre>"},{"location":"2025/sre/1linux/#zip","title":"zip\u547d\u4ee4\u2014\u2014\u6253\u5305\u548c\u538b\u7f29\u6587\u4ef6","text":"<p>zip\u538b\u7f29\u683c\u5f0f\u662fWindows\u4e0eLinux\u7b49\u591a\u5e73\u53f0\u901a\u7528\u7684\u538b\u7f29\u683c\u5f0f\u3002\u548cgzip\u547d\u4ee4\u76f8\u6bd4\uff0czip\u547d\u4ee4\u538b\u7f29\u6587\u4ef6\u4e0d\u4ec5\u4e0d\u4f1a\u5220\u9664\u6e90\u6587\u4ef6\uff0c\u800c\u4e14\u8fd8\u53ef\u4ee5\u538b\u7f29\u76ee\u5f55\u3002</p> <pre><code>\n-r   \u9012\u5f52\u538b\u7f29\u76ee\u5f55\u548c\u6587\u4ef6\n-x   \u538b\u7f29\u6587\u4ef6\u65f6\u6392\u9664\u67d0\u4e2a\u6587\u4ef6\n</code></pre> <pre><code>\u3001\u538b\u7f29\u6587\u4ef6\n[root@localhost ~]# cp /etc/services .\n\n\n[root@localhost ~]# ll\n\u603b\u7528\u91cf 660\n-rw------- 1 root root   1506 3\u6708  13 2022 anaconda-ks.cfg\n-rw-r--r-- 1 root root 670293 10\u6708 22 20:50 services\n[root@localhost ~]# zip services.zip ./services \n  adding: services (deflated 80%)\n\n\n[root@localhost ~]# ll\n\u603b\u7528\u91cf 796\n-rw------- 1 root root   1506 3\u6708  13 2022 anaconda-ks.cfg\n-rw-r--r-- 1 root root 670293 10\u6708 22 20:50 services\n-rw-r--r-- 1 root root 136227 10\u6708 22 20:50 services.zip\n\n\n2\u3001\u538b\u7f29\u76ee\u5f55\n[root@localhost data]# zip jdk.zip ./jdk1.8.0_202/    //\u6ca1\u6709\u538b\u7f29\nupdating: jdk1.8.0_202/ (stored 0%)\n[root@localhost data]# zip -r jdk.zip ./jdk1.8.0_202/    \n[root@localhost data]# ll\n\u603b\u7528\u91cf 192112\ndrwxr-xr-x 7   10  143       245 12\u6708 16 2018 jdk1.8.0_202\n-rw-r--r-- 1 root root 196719566 10\u6708 22 20:53 jdk.zip\n</code></pre>"},{"location":"2025/sre/1linux/#unzipzip","title":"unzip\u547d\u4ee4\u2014\u2014\u89e3\u538bzip\u547d\u4ee4\u538b\u7f29\u7684\u6587\u4ef6","text":"<ul> <li>-d \u6307\u5b9a\u89e3\u538b\u7684\u8def\u5f84</li> <li>-v \u663e\u793a\u89e3\u538b\u8be6\u7ec6\u8fc7\u7a0b\uff0c\u9ed8\u8ba4\u9009\u9879</li> <li>-o \u89e3\u538b\u65f6\u4e0d\u63d0\u793a\u662f\u5426\u8986\u76d6\u6587\u4ef6</li> </ul> <pre><code>1\u3001\u9ed8\u8ba4\u89e3\u538b\u5230\u5f53\u524d\u76ee\u5f55\n[root@localhost data]# unzip jdk.zip\n[root@localhost data]# ll\n\u603b\u7528\u91cf 192112\ndrwxr-xr-x 7 root root       245 12\u6708 16 2018 jdk1.8.0_202\n-rw-r--r-- 1 root root 196719566 10\u6708 22 20:53 jdk.zip\n\n2\u3001\u89e3\u538b\u5230\u6307\u5b9a\u76ee\u5f55\n[root@localhost data]# unzip -d /root jdk.zip   //\u89e3\u538b\u5230/root\u76ee\u5f55\n[root@localhost data]# ll /root/\n\u603b\u7528\u91cf 4\n-rw------- 1 root root 1506 3\u6708  13 2022 anaconda-ks.cfg\ndrwxr-xr-x 7 root root  245 12\u6708 16 2018 jdk1.8.0_202\n\n3\u3001\u518d\u6b21\u89e3\u538b\u4e0d\u63d0\u793a\uff0c\u76f4\u63a5\u8986\u76d6\n[root@localhost data]# unzip -d /root jdk.zip    //\u518d\u6b21\u6267\u884c\u4f1a\u63d0\u793a\u662f\u5426\u8986\u76d6\nArchive:  jdk.zip\nreplace /root/jdk1.8.0_202/javafx-src.zip? [y]es, [n]o, [A]ll, [N]one, [r]ename: \nerror:  invalid response [{ENTER}]\nreplace /root/jdk1.8.0_202/javafx-src.zip? [y]es, [n]o, [A]ll, [N]one, [r]ename: ^C[root@localhost data]# \n[root@localhost data]# unzip -o -d /root jdk.zip   //\u6dfb\u52a0-o\u64cd\u4f5c\u540e\u5c31\u4e0d\u4f1a\u8be2\u95ee\u662f\u5426\u8986\u76d6\u3002\n</code></pre>"},{"location":"2025/sre/1linux/#scp","title":"scp\u547d\u4ee4\u2014\u2014\u8fdc\u7a0b\u590d\u5236\u6587\u4ef6","text":"<p>scp\u4f7f\u7528\u7684\u662fssh\u534f\u8bae\u3002\u6bcf\u6b21\u90fd\u662f\u5168\u91cf\u590d\u5236\u3002\u9002\u5408\u7b2c\u4e00\u6b21\u590d\u5236\u3002</p> <pre><code>-r    \u9012\u5f52\u590d\u5236\n-p    \u4fdd\u7559\u6587\u4ef6\u539f\u59cb\u5c5e\u6027\n-P    \u7aef\u53e3\u53f7  \u6307\u5b9a\u4f20\u8f93\u7684\u7aef\u53e3\u53f7\n-q    \u4e0d\u663e\u793a\u4f20\u8f93\u8fdb\u5ea6\n</code></pre> <pre><code>1\u3001\u5c06\u672c\u673a\u7684\u6587\u4ef6\u590d\u5236\u5230\u8fdc\u7aef\u4e3b\u673a\uff0c\u9700\u8981\u77e5\u9053\u8fdc\u7aef\u7684\u670d\u52a1\u5668\u5bc6\u7801\n scp -rp jdk1.8.0_202/ root@10.10.10.3:/data  \n\nroot\u662f\u8fdc\u7aef\u7528\u6237\uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u666e\u901a\u7528\u6237\n10.10.10.3\u662f\u8fdc\u7aefIP\u5730\u5740\n/data\u662f\u8fdc\u7aef\u670d\u52a1\u5668\u7684\u76ee\u5f55\uff0c\u8981\u5199\u7edd\u5bf9\u8def\u5f84\n\n2\u3001\u5c06\u8fdc\u7aef\u4e3b\u673a\u6587\u4ef6\u590d\u5236\u5230\u672c\u673a\u3002\n[root@localhost data]# scp root@10.10.10.3:/etc/services /data\nroot@10.10.10.3's password:       //\u8f93\u5165\u8fdc\u7aef\u4e3b\u673a\u5bc6\u7801\nservices         100%  655KB  64.4MB/s   00:00 \n\n3\u3001\u6307\u5b9a\u7aef\u53e3\u590d\u5236\uff0c\u6709\u4e9b\u4e0d\u662f\u5e38\u89c4\u7aef\u53e3\u65f6\u5c31\u9700\u8981\u6307\u5b9a\n[root@localhost data]# scp -P 22 root@10.10.10.3:/etc/hosts /data\nroot@10.10.10.3's password: \nhosts              100%  158   110.7KB/s   00:00\n</code></pre>"},{"location":"2025/sre/1linux/#rsync","title":"rsync\u547d\u4ee4\u2014\u2014\u6587\u4ef6\u540c\u6b65\u5de5\u5177","text":"<p>rsync\u5177\u6709\u53ef\u4f7f\u672c\u5730\u548c\u8fdc\u7a0b\u4e24\u53f0\u4e3b\u673a\u4e4b\u95f4\u7684\u6570\u636e\u5feb\u901f\u590d\u5236\u540c\u6b65\u955c\u50cf\u3001\u8fdc\u7a0b\u5907\u4efd\u7684\u529f\u80fd\uff0c\u8fd9\u4e2a\u529f\u80fd\u7c7b\u4f3c\u4e8essh\u5e26\u7684scp\u547d\u4ee4\uff0c\u4f46\u662f\u53c8\u4f18\u4e8escp\u547d\u4ee4\u7684\u529f\u80fd\uff0cscp\u6bcf\u6b21\u90fd\u662f\u5168\u91cf\u62f7\u8d1d\uff0c\u800crsync\u53ef\u4ee5\u589e\u91cf\u62f7\u8d1d\u3002</p> <pre><code>\n-z  \u4f20\u8f93\u65f6\u8fdb\u884c\u538b\u7f29\n-a  \u4ee5\u9012\u5f52\u65b9\u5f0f\u4f20\u8f93\u6587\u4ef6\uff0c\u5e76\u4fdd\u6301\u539f\u6709\u5c5e\u6027\uff0c\u76f8\u5f53\u4e8e-rtopgDI\n-r  \u9012\u5f52\u590d\u5236\u4f20\u8f93\n-t  \u4fdd\u6301\u6587\u4ef6\u7684\u65f6\u95f4\u4fe1\u606f\n\n-o  \u4fdd\u7559\u6587\u4ef6\u7684\u5c5e\u4e3b\u4fe1\u606f\n-p  \u4fdd\u7559\u6587\u4ef6\u7684\u6743\u9650\n-g  \u4fdd\u7559\u6587\u4ef6\u7684\u5c5e\u7ec4\u4fe1\u606f\n-D  \u4fdd\u7559\u8bbe\u5907\u6587\u4ef6\u4fe1\u606f\n-l  \u4fdd\u7559\u8f6f\u94fe\u63a5\n--exclude-from=file  \u6392\u9664\u6307\u5b9a\u7684\u6587\u4ef6\u4e0d\u9700\u8981\u4f20\u8f93\n--delete   \u4f7f\u76ee\u6807\u76ee\u5f55\u5185\u5bb9\u548c\u6e90\u4fdd\u6301\u76ee\u5f55\u4e00\u76f4\uff0c\u5220\u9664\u4e0d\u540c\u7684\u6587\u4ef6\n</code></pre> <p>1\u3001\u672c\u5730\u6a21\u5f0f\uff1a\u7528\u4e8e\u672c\u673a\u4f20\u8f93\u6587\u4ef6\uff0c\u76f8\u5f53\u4e8ecp\u547d\u4ee4</p> <pre><code>\nrsync   \u9009\u9879    \u6e90\u6587\u4ef6   \u76ee\u6807\u6587\u4ef6\n\n[root@localhost ~]# rsync -av /etc/hosts  /tmp\nsending incremental file list\nhosts\n\n\nsent 267 bytes  received 35 bytes  604.00 bytes/sec\ntotal size is 177  speedup is 0.59\n[root@localhost ~]# ll /tmp\n\u603b\u7528\u91cf 4\n-rw-r--r-- 1 root root 177 5\u6708   6 2022 hosts\n\n</code></pre> <p>2\u3001\u8fdc\u7a0b\u8bbf\u95ee\u6a21\u5f0f\uff1a\u5c06\u6587\u4ef6\u4f20\u8f93\u7ed9\u8fdc\u7aef\u4e3b\u673a\u6216\u62c9\u53bb\u8fdc\u7aef\u4e3b\u673a\u7684\u6587\u4ef6</p> <pre><code>\u62c9\u53d6\uff1arsync  \u9009\u9879   \u7528\u6237@\u4e3b\u673a\uff1a\u6e90\u6587\u4ef6   \u76ee\u6807\u6587\u4ef6\n\n\u63a8\u9001\uff1arsync  \u9009\u9879  \u6e90\u6587\u4ef6  \u7528\u6237@\u4e3b\u673a:\u76ee\u6807\u6587\u4ef6\n\n1\u3001\u62c9\u53d6\u8fdc\u7a0b\u6587\u4ef6\n[root@localhost ~]# rsync -avz root@10.10.10.3:/etc/hostname ./ \n2\u3001\u62c9\u53d6\u8fdc\u7a0b\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\n[root@localhost ~]# rsync -avz root@10.10.10.3:/root/  /data/   \n3\u3001\u672c\u5730\u6587\u4ef6\u63a8\u9001\u7ed9\u8fdc\u7a0b\u76ee\u5f55\n[root@localhost ~]# rsync -avz /data  root@10.10.10.3:/tmp/\n</code></pre>"},{"location":"2025/sre/1linux/#linux_2","title":"Linux\u5e38\u7528\u547d\u4ee4\u4e4b\u7528\u6237\u7ba1\u7406","text":"<ul> <li>useradd\u547d\u4ee4\u2014\u2014\u521b\u5efa\u7528\u6237</li> </ul> <pre><code>\n// \u521b\u5efa\u7528\u6237\u7684\u540c\u65f6\u8fd8\u4f1a\u521b\u5efa\u4e00\u4e2a\u4e0e\u7528\u6237\u540d\u76f8\u540c\u7684\u7528\u6237\u7ec4\nuseradd  test  \n\n// \u521b\u5efa\u7528\u6237rudy\uff0c\u5c5e\u4e8emysql\u7ec4\uff0cuid\u4e3a1002 \nuseradd -g mysql  -u 1002  rudy   \n\n// \u521b\u5efa\u7981\u6b62\u767b\u9646\u7684\u7528\u6237 \uff0c/sbin/nologin\u8868\u793a\u7981\u6b62\u767b\u5f55\nuseradd -M -s  /sbin/nologin   rudy\n</code></pre> <ul> <li>usermod\u547d\u4ee4\u2014\u2014\u4fee\u6539\u7528\u6237\u4fe1\u606f</li> </ul> <pre><code>\n// \u4fee\u6539\u5bb6\u76ee\u5f55\u548cuid\nusermod -d /dataroot/rudy -u 1002 rudy\n\n// \u5c06rudy\u7528\u6237\u540d\u79f0\u66f4\u6539\u4e3azhangsan\nusermod -l zhangsan  rudy\n\n// \u5c06rudy\u6dfb\u52a0\u5230\u8fd9\u4e9b\u7ec4\u91cc\u9762\nusermod -G public,wangluo rudy\n\n</code></pre> <ul> <li>userdel\u547d\u4ee4\u2014\u2014\u5220\u9664\u7528\u6237\u53ca\u8be5\u7528\u6237\u76f8\u5173\u7684\u6587\u4ef6</li> </ul> <pre><code>\n// \u4e0d\u52a0\u53c2\u6570\u5220\u9664\u7528\u6237\uff0c\u5bb6\u76ee\u5f55\u8fd8\u5b58\u5728\nuserdel rudy\n\n// \u52a0-r\u53c2\u6570\u5220\u9664\u7528\u6237\uff0c\u8fde\u540c\u5bb6\u76ee\u5f55\u4e00\u8d77\u5220\u9664\nuserdel -r rudy\n\n// \u5f3a\u5236\u5220\u9664\u7528\u6237\nuserdel -l -r  rudy\n</code></pre> <p>\u5728\u5b9e\u9645\u5de5\u4f5c\u4e2d\u5c3d\u91cf\u4e0d\u8981\u4f7f\u7528userdel\u5220\u9664\u7528\u6237\uff0c\u800c\u662f\u91c7\u7528\u5728/etc/passwd\u91cc\u6ce8\u91ca\u7528\u6237\u7684\u65b9\u6cd5\uff0c\u9632\u6b62\u7528\u6237\u8bef\u5220\u5e26\u6765\u7684\u7cfb\u7edf\u53ca\u670d\u52a1\u4e0d\u6b63\u5e38\u3002</p> <ul> <li>groupadd\u547d\u4ee4\u2014\u2014\u521b\u5efa\u65b0\u7684\u7528\u6237\u7ec4</li> </ul> <p>groupadd\u547d\u4ee4\u7684\u7528\u9014\u4e00\u822c\u4e0d\u5927\uff0c\u56e0\u4e3auseradd\u547d\u4ee4\u5728\u521b\u5efa\u7528\u6237\u7684\u540c\u65f6\u8fd8\u4f1a\u521b\u5efa\u4e0e\u7528\u6237\u540c\u540d\u7684\u7528\u6237\u7ec4\u3002</p> <pre><code>\n\u6dfb\u52a0GID\u4e3a1020\u7684rudy\u7ec4\ngroupadd -g 1020  rudy\n</code></pre> <ul> <li>groupdel\u547d\u4ee4\u2014\u2014\u5220\u9664\u7528\u6237\u7ec4</li> </ul> <pre><code>groupdel rudy\n</code></pre> <ul> <li>passwd\u547d\u4ee4\u2014\u2014\u4fee\u6539\u7528\u6237\u5bc6\u7801</li> </ul> <pre><code>\n1\u3001\u4fee\u6539\u81ea\u8eab\u5bc6\u7801\n[root@localhost ~]# passwd root\n\u66f4\u6539\u7528\u6237 root \u7684\u5bc6\u7801 \u3002\n\u65b0\u7684 \u5bc6\u7801\uff1a\n\u91cd\u65b0\u8f93\u5165\u65b0\u7684 \u5bc6\u7801\uff1a\npasswd\uff1a\u6240\u6709\u7684\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u5df2\u7ecf\u6210\u529f\u66f4\u65b0\u3002\n\n\n2\u3001\u4e00\u6761\u547d\u4ee4\u4fee\u6539\u5bc6\u7801\uff0c\u4f46\u4e0d\u5b89\u5168\u3002\n[root@localhost ~]# echo manager |passwd --stdin root\n\u66f4\u6539\u7528\u6237 root \u7684\u5bc6\u7801 \u3002\npasswd\uff1a\u6240\u6709\u7684\u8eab\u4efd\u9a8c\u8bc1\u4ee4\u724c\u5df2\u7ecf\u6210\u529f\u66f4\u65b0\n</code></pre> <ul> <li>su\u547d\u4ee4\u2014\u2014\u5207\u6362\u7528\u6237</li> </ul> <pre><code># \u53ea\u5207\u6362\u7528\u6237\uff0c\u4e0d\u5207\u6362\u5bb6\u76ee\u5f55\nsu liyb  \n\n# \u5207\u6362\u5bb6\u76ee\u5f55\uff0c\nsu - root\n# \u8ba9\u7cfb\u7edf\u6bcf\u4e00\u6b21\u5f00\u673a\u65f6\u80fd\u81ea\u52a8\u4ee5\u666e\u901a\u7528\u6237\u542f\u52a8\u6307\u5b9a\u7684\u670d\u52a1\u811a\u672c\ncat  /etc/rc.local\nsu - liyb -c '/bin/sh  /data/scripts/install.sh'\n</code></pre> <ul> <li>last\u547d\u4ee4\u2014\u2014\u663e\u793a\u7528\u6237\u767b\u5f55\u5217\u8868</li> </ul> <pre><code>[root@harbor ~]# last\nroot     pts/0        172.16.1.203     Fri Dec 29 11:36   still logged in\nroot     pts/0        172.16.1.203     Thu Dec 28 13:58 - 14:09  (00:11)\nroot     pts/0        172.16.1.203     Thu Dec 28 13:06 - 13:11  (00:05)\nroot     pts/0        172.16.1.203     Thu Dec 28 11:47 - 12:07  (00:19)\nroot     pts/0        172.16.1.203     Thu Dec 28 10:23 - 10:38  (00:14)\nroot     pts/0        172.16.1.203     Thu Dec 28 10:12 - 10:17  (00:05)\n</code></pre> <ul> <li>lastb\u547d\u4ee4\u2014\u2014\u663e\u793a\u7528\u6237\u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55</li> </ul> <p>lastb\u547d\u4ee4\u53ef\u4ee5\u4ece\u65e5\u5fd7\u6587\u4ef6/var/log/btmp\u4e2d\u8bfb\u53d6\u4fe1\u606f\uff0c\u5e76\u663e\u793a\u7528\u6237\u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff0c\u7528\u4e8e\u53d1\u73b0\u7cfb\u7edf\u767b\u5f55\u5f02\u5e38</p> <pre><code>[root@harbor ~]# lastb\nrudyli   pts/0                         Fri Dec 29 12:46 - 12:46  (00:00)\nAdminist ssh:notty    172.16.1.203     Thu Dec 28 13:58 - 13:58  (00:00)\nAdminist ssh:notty    172.16.1.203     Thu Dec 28 11:47 - 11:47  (00:00)\nAdminist ssh:notty    172.16.1.203     Mon Dec 25 11:19 - 11:19  (00:00)\nAdminist ssh:notty    172.16.1.203     Mon Dec 25 11:19 - 11:19  (00:00)\nAdminist ssh:notty    172.16.1.203     Mon Dec 25 11:19 - 11:19  (00:00)\n</code></pre> <ul> <li>lastlog\u547d\u4ee4\uff1a\u663e\u793a\u6240\u6709\u7528\u6237\u7684\u6700\u8fd1\u767b\u5f55\u8bb0\u5f55</li> </ul> <p>\u4ece\u65e5\u5fd7\u6587\u4ef6/var/log/lastlog\u4e2d\u8bfb\u53d6\u4fe1\u606f\uff0c\u5e76\u663e\u793a\u6240\u6709\u7528\u6237\u7684\u6700\u8fd1\u767b\u5f55\u8bb0\u5f55\uff0c\u7528\u4e8e\u67e5\u770b\u7cfb\u7edf\u662f\u5426\u6709\u5f02\u5e38\u767b\u5f55</p>"},{"location":"2025/sre/1linux/#2-linux","title":"2 Linux\u5e38\u7528\u547d\u4ee4\u4e4b\u8fdb\u7a0b\u7ba1\u7406","text":""},{"location":"2025/sre/1linux/#1-ps","title":"1 ps\u547d\u4ee4\u2014\u2014\u67e5\u770b\u8fdb\u7a0b","text":"<p>\u9009\u9879</p> <pre><code>a   \u663e\u793a\u4e0e\u7ec8\u7aef\u76f8\u5173\u7684\u6240\u6709\u8fdb\u7a0b\uff0c\u5305\u542b\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u5b8c\u6574\u8def\u5f84\nu   \u663e\u793a\u8fdb\u7a0b\u7684\u7528\u6237\u4fe1\u606f\nx   \u663e\u793a\u4e0e\u7ec8\u7aef\u65e0\u5173\u7684\u6240\u6709\u8fdb\u7a0b\n-e  \u663e\u793a\u6240\u6709\u8fdb\u7a0b\n-f  \u989d\u5916\u663e\u793aUID\uff0cPPID\uff0cSTIME\u680f\u4f4d\u4fe1\u606f\u3002\n-u  \u663e\u793a\u6307\u5b9a\u7528\u6237\u76f8\u5173\u7684\u8fdb\u7a0b\u4fe1\u606f\n</code></pre> <p>1\u3001\u8f93\u51fa\u6bcf\u4e2a\u8fdb\u7a0b\u4fe1\u606f</p> <pre><code>[root@harbor ~]# ps -ef\nUID         PID   PPID  C STIME TTY          TIME CMD\nroot          1      0  0 12\u670825 ?      00:00:57 /usr/lib/systemd/systemd --switched-root --system --deserialize 22\nroot          2      0  0 12\u670825 ?      00:00:00 [kthreadd]\nroot          4      2  0 12\u670825 ?      00:00:00 [kworker/0:0H]\n\n2\u3001\u67e5\u770b\u7279\u5b9a\u8fdb\u7a0b\u4fe1\u606f\n[root@harbor ~]# ps -ef |grep nginx\n\n3\u3001BSD\u8bed\u6cd5\u663e\u793a\u6bcf\u4e2a\u8fdb\u7a0b\u4fe1\u606f\n[root@harbor ~]# ps aux\n</code></pre> <p>\u8f93\u51fa\u8bf4\u660e\uff1a</p> <pre><code>USER\uff1a\u8be5\u8fdb\u7a0b\u5c5e\u4e8e\u7684\u7528\u6237\u3002\nPID\uff1a\u8be5\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7\u3002\n%CPU\uff1a\u8be5\u8fdb\u7a0b\u4f7f\u7528\u6389\u7684CPU\u8d44\u6e90\u767e\u5206\u6bd4\u3002\n%MEM\uff1a\u8be5\u8fdb\u7a0b\u6240\u5360\u7528\u7684\u7269\u7406\u5185\u5b58\u767e\u5206\u6bd4\u3002\nVSZ\uff1a\u8be5\u8fdb\u7a0b\u4f7f\u7528\u6389\u7684\u865a\u62df\u5185\u5b58\u91cf\uff08\u5355\u4f4d\u4e3aKbytes\uff09\u3002\nRSS\uff1a\u8be5\u8fdb\u7a0b\u5360\u7528\u7684\u56fa\u5b9a\u7684\u5185\u5b58\u91cf\uff08\u5355\u4f4d\u4e3aKbytes\uff09\u3002\nTTY\uff1a\u8be5\u8fdb\u7a0b\u662f\u5728\u54ea\u4e2a\u7ec8\u7aef\u673a\u4e0a\u9762\u8fd0\u4f5c\u7684\uff0c\u82e5\u4e0e\u7ec8\u7aef\u673a\u65e0\u5173\uff0c\u5219\u663e\u793a\u201c?\u201d\uff0c\n\u53e6\u5916\uff0ctty1-tty6\u662f\u672c\u673a\u4e0a\u9762\u7684\u767b\u5165\u8005\u8fdb\u7a0b\uff0c\u82e5\u4e3apts/0\u7b49\uff0c\u5219\u8868\u793a\u4e3a\u7531\u7f51\u7edc\u8fde\u63a5\u8fdb\u4e3b\u673a\u7684\u8fdb\u7a0b\u3002\nSTAT\uff1a\u8be5\u8fdb\u7a0b\u76ee\u524d\u7684\u72b6\u6001\uff0c\u4e3b\u8981\u7684\u72b6\u6001\u5305\u62ec\u5982\u4e0b\u51e0\u79cd\u3002\nR\uff1a\u6b63\u5728\u8fd0\u884c\uff0c\u6216\u8005\u662f\u53ef\u4ee5\u8fd0\u884c\u3002\nS\uff1a\u6b63\u5728\u4e2d\u65ad\u7761\u7720\u4e2d\uff0c\u53ef\u4ee5\u7531\u67d0\u4e9b\u4fe1\u53f7\uff08signal\uff09\u5524\u9192\u3002\nD\uff1a\u4e0d\u53ef\u4e2d\u65ad\u7761\u7720\u3002\u00b7T\uff1a\u6b63\u5728\u4fa6\u6d4b\u6216\u8005\u662f\u505c\u6b62\u4e86\u3002\nZ\uff1a\u5df2\u7ecf\u7ec8\u6b62\uff0c\u4f46\u662f\u5176\u7236\u8fdb\u7a0b\u65e0\u6cd5\u6b63\u5e38\u7ec8\u6b62\u5b83\uff0c\u4ece\u800c\u53d8\u6210zombie\uff08\u50f5\u5c38\uff09\u8fdb\u7a0b\u7684\u72b6\u6001\u3002\n+\uff1a\u524d\u53f0\u8fdb\u7a0b\u3002\nl\uff1a\u591a\u7ebf\u7a0b\u8fdb\u7a0b\u3002\nN\uff1a\u4f4e\u4f18\u5148\u7ea7\u8fdb\u7a0b\u3002\n&lt;\uff1a\u9ad8\u4f18\u5148\u7ea7\u8fdb\u7a0b\u3002\ns\uff1a\u8fdb\u7a0b\u9886\u5bfc\u8005\u3002\nL\uff1a\u5df2\u5c06\u9875\u9762\u9501\u5b9a\u5230\u5185\u5b58\u4e2d\u3002\nSTART\uff1a\u8be5\u8fdb\u7a0b\u88ab\u89e6\u53d1\u542f\u52a8\u7684\u65f6\u95f4\u3002\nTIME\uff1a\u8be5\u8fdb\u7a0b\u5b9e\u9645\u4f7f\u7528CPU\u8fd0\u4f5c\u7684\u65f6\u95f4\u3002\nCOMMAND\uff1a\u8be5\u8fdb\u7a0b\u7684\u5b9e\u9645\u547d\u4ee4\u3002\n</code></pre>"},{"location":"2025/sre/1linux/#kill","title":"kill\u547d\u4ee4\u2014\u2014\u7ec8\u6b62\u8fdb\u7a0b","text":"<p>\u80fd\u4e2d\u6b62\u4f60\u5e0c\u671b\u505c\u6b62\u7684\u8fdb\u7a0b</p> <pre><code>-l  \u5217\u51fa\u5168\u90e8\u7684\u4fe1\u53f7\u540d\u79f0\n-s \u6307\u5b9a\u8981\u53d1\u9001\u7684\u4fe1\u53f7\n</code></pre> <p>\u663e\u793a\u7cfb\u7edf\u7684\u6240\u6709\u4fe1\u53f7</p> <pre><code>[root@localhost ~]# kill -l\n 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP\n 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1\n11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM\n16) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP\n21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ\n26) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR\n31) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3\n38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8\n43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13\n48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12\n53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7\n58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62)\n</code></pre> <p>kill\u547d\u4ee4\u9ed8\u8ba4\u53d1\u9001\u7684\u4fe1\u53f7\u662f15\uff0c\u7528\u4e8e\u7ed3\u675f\u8fdb\u7a0b\u3002\u4f7f\u7528\u4fe1\u53f79\u53ef\u4ee5\u5f3a\u5236\u7ec8\u6b62\u8fdb\u7a0b\u3002</p> <pre><code>\n[root@localhost ~]# netstat -lntup\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1353/sshd           \ntcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1473/master         \ntcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      945/rpcbind \n\n[root@localhost ~]# kill -9  1473\n\n[root@localhost ~]# netstat -lntup   #\u518d\u6b21\u67e5\u770b\u6ca1\u6709\u8fdb\u7a0b\u53f7\u4e3a1473\u7684\u8fdb\u7a0b\u3002\n\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1353/sshd           \ntcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      945/rpcbind         \n[root@localhost ~]#\n</code></pre>"},{"location":"2025/sre/1linux/#top","title":"top\u547d\u4ee4\u2014\u2014\u52a8\u6001\u663e\u793a\u5404\u4e2a\u8fdb\u7a0b\u7684\u8d44\u6e90\u5360\u7528\u60c5\u51b5","text":"<p>top\u7528\u4e8e\u5b9e\u65f6\u5730\u5bf9\u7cfb\u7edf\u8d44\u6e90\u8fdb\u884c\u76d1\u63a7\uff0c\u8f93\u51fa\u5404\u4e2a\u8fdb\u7a0b\u7684\u8d44\u6e90\u5360\u7528\u60c5\u51b5\u3002\u540c\u65f6top\u547d\u4ee4\u4e5f\u662f\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u547d\u4ee4\u3002</p> <p>\u4ea4\u4e92\u5f0f\u9009\u9879</p> <pre><code>\n\u4ea4\u4e92\u5f0f\u547d\u4ee4   \u542b\u4e49\nh\u6216\uff1f       \u663e\u793a\u5e2e\u52a9\u4fe1\u606f\uff0c\u7ed9\u51fa\u4ea4\u4e92\u5f0f\u547d\u4ee4\u7684\u4e00\u4e9b\u8bf4\u660e\u603b\u7ed3\nm          \u4ee5\u5185\u5b58\u6392\u5e8f\u663e\u793a\nz          \u6253\u5f00/\u5173\u95ed\u989c\u8272\u663e\u793a\nn\u6216#       \u8bbe\u7f6e\u663e\u793a\u505a\u5927\u8fdb\u7a0b\u884c\u6570\nq         \u9000\u51fatop\n</code></pre>"},{"location":"2025/sre/1linux/#nohup","title":"nohup\u547d\u4ee4\u2014\u2014\u540e\u53f0\u8fd0\u884c\u8fdb\u7a0b","text":"<p>nohup\u547d\u4ee4\u53ef\u4ee5\u5c06\u7a0b\u5e8f\u4ee5\u540e\u53f0\u65b9\u5f0f\u8fd0\u884c\uff0c\u88ab\u8fd0\u884c\u7a0b\u5e8f\u7684\u8f93\u51fa\u4fe1\u606f\u5c06\u4e0d\u4f1a\u663e\u793a\u5230\u7ec8\u7aef\u3002</p> <p>\u65e0\u8bba\u662f\u5426\u5c06nohup\u547d\u4ee4\u7684\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u7ec8\u7aef\uff0c\u8f93\u51fa\u90fd\u5c06\u5199\u5165\u5230\u5f53\u524d\u76ee\u5f55\u7684nohup.out\u6587\u4ef6\u4e2d\u3002\u5982\u679c\u5f53\u524d\u76ee\u5f55\u7684nohup.out\u6587\u4ef6\u4e0d\u53ef\u5199\uff0c\u5219\u8f93\u51fa\u91cd\u5b9a\u5411\u5230$HOME/nohup.out\u6587\u4ef6\u4e2d\u3002</p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u7528\u6237\u9000\u51fa\u767b\u5f55\u6216\u4f1a\u8bdd\u7ec8\u6b62\uff0c\u5219\u7528\u6237\u6b63\u5728\u6267\u884c\u5e76\u53ef\u6301\u7eed\u4e00\u6bb5\u65f6\u95f4\u7684\u547d\u4ee4\uff08\u975e\u5b88\u62a4\u8fdb\u7a0b\uff09\u5c06\u81ea\u52a8\u7ec8\u6b62</p> <p>\u5b9e\u9645\u5de5\u4f5c\u4e2d\uff0c\u6211\u4eec\u4e00\u822c\u4f1a\u548c&amp;\u4e00\u8d77\u4f7f\u7528\uff0c\u8ba9\u7a0b\u5e8f\u76f4\u63a5\u5728\u540e\u53f0\u8fd0\u884c\u3002</p> <pre><code>\n[root@localhost ~]# nohup ping 172.16.1.20 &amp;\n[2] 109057\n[root@localhost ~]# nohup: \u5ffd\u7565\u8f93\u5165\u5e76\u628a\u8f93\u51fa\u8ffd\u52a0\u5230\"nohup.out\"\n\n\n[root@localhost ~]# ps -ef |grep ping\nroot     109057  93226  0 10:45 pts/0    00:00:00 ping 172.16.1.20\nroot     109329  93226  0 10:45 pts/0    00:00:00 grep --color=auto ping\n\n\u6ce8\u610f\uff1a\u4ee5\u4e0a\u793a\u4f8b\u662f\u4e3a\u4e86\u6d4b\u8bd5\uff0c\u6d4b\u8bd5\u5b8c\u540e\u8981kill\u6389\uff0c\u4e0d\u7136\u4e00\u76f4\u751f\u6210\u65e5\u5fd7,\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u3002\n\n[root@localhost ~]# kill -9 109057\n</code></pre>"},{"location":"2025/sre/1linux/#runlevel","title":"runlevel\u547d\u4ee4\u2014\u2014\u8f93\u51fa\u5f53\u524d\u8fd0\u884c\u7ea7\u522b","text":"<pre><code>[root@localhost ~]# runlevel\nN 3\n# \u663e\u793a\u5f53\u524d\u8fd0\u884c\u754c\u522b\u4e3a3\uff0c\u5373\u4e3a\u547d\u4ee4\u884c\u591a\u7528\u6237\u6a21\u5f0f\n</code></pre> <p>\u7ea7\u522b</p> <ul> <li>0 \u505c\u673a</li> <li>1   \u5355\u7528\u6237\u6a21\u5f0f</li> <li>2   \u65e0\u7f51\u7edc\u7684\u591a\u7528\u6237\u6a21\u5f0f</li> <li>3   \u591a\u7528\u6237\u6a21\u5f0f</li> <li>4   \u672a\u4f7f\u7528</li> <li>5   \u56fe\u5f62\u754c\u9762\u591a\u7528\u6237\u6a21\u5f0f</li> <li>6   \u91cd\u542f</li> </ul>"},{"location":"2025/sre/1linux/#init","title":"init\u547d\u4ee4\u2014\u2014\u8fdb\u7a0b\u521d\u59cb\u5316\u5de5\u5177","text":"<p>init\u547d\u4ee4\u662fLinux\u4e0b\u7684\u8fdb\u7a0b\u521d\u59cb\u5316\u5de5\u5177\uff0cinit\u8fdb\u7a0b\u662f\u6240\u6709Linux\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\uff0c\u5b83\u7684\u8fdb\u7a0b\u53f7\u4e3a1</p> <p>\u5207\u6362\u8fd0\u884c\u754c\u522b</p> <pre><code># \u5173\u673a\n[root@localhost ~]# init 0   \n\n# \u91cd\u542f \n[root@localhost ~]# init 6\n</code></pre>"},{"location":"2025/sre/1linux/#service","title":"service\u547d\u4ee4\u2014\u2014\u7ba1\u7406\u7cfb\u7edf\u670d\u52a1","text":"<p>service\u547d\u4ee4\u7528\u4e8ecentos6\u4ee5\u53ca\u524d\u9762\u7248\u672c\u3002centos7\u540e\u4f7f\u7528systemd\u7ba1\u7406\u7cfb\u7edf\u670d\u52a1\u3002</p> <p>service\u547d\u4ee4\u7528\u4e8e\u5bf9\u7cfb\u7edf\u670d\u52a1\u8fdb\u7a0b\u7ba1\u7406\uff0c\u53ef\u4ee5\u5bf9\u670d\u52a1\u8fdb\u884c\u542f\u52a8\uff0c\u505c\u6b62\uff0c\u91cd\u542f\uff0c\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\uff0c\u67e5\u770b\u72b6\u6001\u7b49\u64cd\u4f5c\u3002</p> <pre><code>\n# \u542f\u52a8\u670d\u52a1\nservice chronyd start\n\n# \u505c\u6b62\u670d\u52a1\nservice chronyd stop\n\n# \u91cd\u542f\u670d\u52a1\nservice chronyd restart\n\n# \u5e73\u6ed1\u91cd\u542f\u670d\u52a1\nservice chronyd reload\n\n# \u67e5\u770b\u670d\u52a1\u72b6\u6001\nservice chronyd status\n\n</code></pre>"},{"location":"2025/sre/1linux/#systemctl","title":"systemctl\u547d\u4ee4\u2014\u2014\u7ba1\u7406\u7cfb\u7edf\u670d\u52a1","text":"<pre><code>\n# \u542f\u52a8\u670d\u52a1\nsystemctl start chronyd\n\n# \u505c\u6b62\u670d\u52a1\nsystemctl stop chronyd\n\n# \u91cd\u542f\u670d\u52a1\nsystemctl restart chronyd\n\n# \u5e73\u6ed1\u91cd\u542f\u670d\u52a1\nsystemctl restart chronyd\n\n # \u67e5\u770b\u670d\u52a1\u72b6\u6001\nsystemctl restart chronyd\n\n# \u5217\u51fa\u5df2\u5b89\u88c5\u7684unit\nsystemctl list-unit-files\n\n #  \u5217\u51fa\u7c7b\u578b\u4e3aservice\u7684\u9879\u76ee\nsystemctl list-units --type=service\n\n # \u8f93\u51fa\u4e3b\u673a\u5f53\u524d\u7684\u8fd0\u884c\u6a21\u5f0f\nsystemctl get-default  \n\n# \u8bbe\u7f6e\u4e3b\u673a\u7684\u8fd0\u884c\u6a21\u5f0f\uff0c\u5173\u95ed\u56fe\u5f62\u754c\u9762\uff0c\u4f7f\u7528\u547d\u4ee4\u884c\u6a21\u5f0f\nsystemctl isolate multi-user.target \n\n#\u5c06\u76ee\u524d\u7684\u64cd\u4f5c\u73af\u5883\u6539\u4e3a\u56fe\u5f62\u754c\u9762\nsystemctl isolate graphical.target  \n\n #\u7cfb\u7edf\u5173\u673a\nsystemctl poweroff  \n\n#\u91cd\u65b0\u5f00\u673a \nsystemctl reboot   \n\n#\u8fdb\u5165\u6682\u505c\u6a21\u5f0f \nsystemctl suspend   \n\n#\u5f3a\u5236\u8fdb\u5165\u6551\u63f4\u6a21\u5f0f \nsystemctl rescue   \n\n#\u7981\u7528\u67d0\u4e2a\u670d\u52a1\nsystemctl mask etcd.service   \n\n#\u89e3\u9664\u7981\u7528\u67d0\u4e2a\u670d\u52a1\nsystemctl unmask etcd.service   \n</code></pre>"},{"location":"2025/sre/1linux/#linux_3","title":"Linux\u5e38\u7528\u547d\u4ee4\u4e4b\u78c1\u76d8\u7ba1\u7406","text":""},{"location":"2025/sre/1linux/#fdisk","title":"fdisk\u547d\u4ee4\u2014\u2014\u78c1\u76d8\u5206\u533a\u5de5\u5177","text":"<p>fdisk\u662fLinux\u7cfb\u7edf\u4e0b\u5e38\u7528\u7684\u5206\u533a\u5de5\u5177\u3002\u53d7mbr\u5206\u533a\u8868\u7684\u9650\u5236\uff0cfdisk\u5de5\u5177\u53ea\u80fd\u7ed9\u5c0f\u4e8e2TB\u7684\u78c1\u76d8\u5212\u5206\u5206\u533a\u3002\u5982\u679c\u5927\u4e8e2TB\uff0c\u65e0\u6cd5\u8bc6\u522b\u8d85\u8fc72TB\u90a3\u90e8\u5206\u5bb9\u91cf\u3002\u5982\u679c\u78c1\u76d8\u5927\u4e8e2TB\u6700\u597d\u4f7f\u7528parted\u5206\u533a\u5de5\u5177\u3002</p> <ul> <li>-l  \u663e\u793a\u6240\u6709\u78c1\u76d8\u5206\u533a\u7684\u4fe1\u606f</li> </ul> <pre><code>\n[root@localhost ~]# fdisk -l\n\u78c1\u76d8 /dev/vda\uff1a107.4 GB, 107374182400 \u5b57\u8282\uff0c209715200 \u4e2a\u6247\u533a\nUnits = \u6247\u533a of 1 * 512 = 512 bytes\n\u6247\u533a\u5927\u5c0f(\u903b\u8f91/\u7269\u7406)\uff1a512 \u5b57\u8282 / 512 \u5b57\u8282\nI/O \u5927\u5c0f(\u6700\u5c0f/\u6700\u4f73)\uff1a512 \u5b57\u8282 / 512 \u5b57\u8282\n\u78c1\u76d8\u6807\u7b7e\u7c7b\u578b\uff1ados\n\u78c1\u76d8\u6807\u8bc6\u7b26\uff1a0x000a4dca\n\n   \u8bbe\u5907 Boot      Start         End      Blocks   Id  System\n/dev/vda1            2048        6143        2048   83  Linux\n/dev/vda2   *        6144     4200447     2097152   83  Linux\n/dev/vda3         4200448   209715199   102757376   83  Linux\n\n\n\u78c1\u76d8 /dev/vdb\uff1a214.7 GB, 214748364800 \u5b57\u8282\uff0c419430400 \u4e2a\u6247\u533a\nUnits = \u6247\u533a of 1 * 512 = 512 bytes\n\u6247\u533a\u5927\u5c0f(\u903b\u8f91/\u7269\u7406)\uff1a512 \u5b57\u8282 / 512 \u5b57\u8282\nI/O \u5927\u5c0f(\u6700\u5c0f/\u6700\u4f73)\uff1a512 \u5b57\u8282 / 512 \u5b57\u8282\n\n\n\u78c1\u76d8 /dev/vdc\uff1a107.4 GB, 107374182400 \u5b57\u8282\uff0c209715200 \u4e2a\u6247\u533a\nUnits = \u6247\u533a of 1 * 512 = 512 bytes\n\u6247\u533a\u5927\u5c0f(\u903b\u8f91/\u7269\u7406)\uff1a512 \u5b57\u8282 / 512 \u5b57\u8282\nI/O \u5927\u5c0f(\u6700\u5c0f/\u6700\u4f73)\uff1a512 \u5b57\u8282 / 512 \u5b57\u8282\n\n[root@localhost ~]# fdisk /dev/vdc\n\u6b22\u8fce\u4f7f\u7528 fdisk (util-linux 2.23.2)\u3002\n\n\u66f4\u6539\u5c06\u505c\u7559\u5728\u5185\u5b58\u4e2d\uff0c\u76f4\u5230\u60a8\u51b3\u5b9a\u5c06\u66f4\u6539\u5199\u5165\u78c1\u76d8\u3002\n\u4f7f\u7528\u5199\u5165\u547d\u4ee4\u524d\u8bf7\u4e09\u601d\u3002\n\nDevice does not contain a recognized partition table\n\u4f7f\u7528\u78c1\u76d8\u6807\u8bc6\u7b26 0x5eb87e6d \u521b\u5efa\u65b0\u7684 DOS \u78c1\u76d8\u6807\u7b7e\u3002\n\n\u547d\u4ee4(\u8f93\u5165 m \u83b7\u53d6\u5e2e\u52a9)\uff1am\n\u547d\u4ee4\u64cd\u4f5c\n   a   toggle a bootable flag\n   b   edit bsd disklabel\n   c   toggle the dos compatibility flag\n   d   delete a partition\n   g   create a new empty GPT partition table\n   G   create an IRIX (SGI) partition table\n   l   list known partition types\n   m   print this menu\n   n   add a new partition\n   o   create a new empty DOS partition table\n   p   print the partition table\n   q   quit without saving changes\n   s   create a new empty Sun disklabel\n   t   change a partition's system id\n   u   change display/entry units\n   v   verify the partition table\n   w   write table to disk and exit\n   x   extra functionality (experts only)\n\n\n\u547d\u4ee4(\u8f93\u5165 m \u83b7\u53d6\u5e2e\u52a9)\uff1an    # \u65b0\u589e\u52a0\u4e00\u4e2a\u5206\u533a\nPartition type:\n   p   primary (0 primary, 0 extended, 4 free)\n   e   extended\nSelect (default p): p   # \u65b0\u589e\u4e00\u4e2a\u4e3b\u5206\u533a\n\u5206\u533a\u53f7 (1-4\uff0c\u9ed8\u8ba4 1)\uff1a1\n\u8d77\u59cb \u6247\u533a (2048-209715199\uff0c\u9ed8\u8ba4\u4e3a 2048)\uff1a\n\u5c06\u4f7f\u7528\u9ed8\u8ba4\u503c 2048\nLast \u6247\u533a, +\u6247\u533a or +size{K,M,G} (2048-209715199\uff0c\u9ed8\u8ba4\u4e3a 209715199)\uff1a+10G\n\u5206\u533a 1 \u5df2\u8bbe\u7f6e\u4e3a Linux \u7c7b\u578b\uff0c\u5927\u5c0f\u8bbe\u4e3a 10 GiB\n\n\n\u547d\u4ee4(\u8f93\u5165 m \u83b7\u53d6\u5e2e\u52a9)\uff1ap   # \u6253\u5370\u5206\u533a\u8868\n\n\n\u78c1\u76d8 /dev/vdc\uff1a107.4 GB, 107374182400 \u5b57\u8282\uff0c209715200 \u4e2a\u6247\u533a\nUnits = \u6247\u533a of 1 * 512 = 512 bytes\n\u6247\u533a\u5927\u5c0f(\u903b\u8f91/\u7269\u7406)\uff1a512 \u5b57\u8282 / 512 \u5b57\u8282\nI/O \u5927\u5c0f(\u6700\u5c0f/\u6700\u4f73)\uff1a512 \u5b57\u8282 / 512 \u5b57\u8282\n\u78c1\u76d8\u6807\u7b7e\u7c7b\u578b\uff1ados\n\u78c1\u76d8\u6807\u8bc6\u7b26\uff1a0x5eb87e6d\n\n   \u8bbe\u5907 Boot      Start         End      Blocks   Id  System\n/dev/vdc1            2048    20973567    10485760   83  Linux\n\n\n\u547d\u4ee4(\u8f93\u5165 m \u83b7\u53d6\u5e2e\u52a9)\uff1at   # \u66f4\u6362\u5206\u533a\u683c\u5f0f\n\u5df2\u9009\u62e9\u5206\u533a 1\nHex \u4ee3\u7801(\u8f93\u5165 L \u5217\u51fa\u6240\u6709\u4ee3\u7801)\uff1aL\n\nHex \u4ee3\u7801(\u8f93\u5165 L \u5217\u51fa\u6240\u6709\u4ee3\u7801)\uff1a8e\n\u5df2\u5c06\u5206\u533a\u201cLinux\u201d\u7684\u7c7b\u578b\u66f4\u6539\u4e3a\u201cLinux LVM\u201d\n\n\u547d\u4ee4(\u8f93\u5165 m \u83b7\u53d6\u5e2e\u52a9)\uff1ap   # \u67e5\u770b\n\n\u78c1\u76d8 /dev/vdc\uff1a107.4 GB, 107374182400 \u5b57\u8282\uff0c209715200 \u4e2a\u6247\u533a\nUnits = \u6247\u533a of 1 * 512 = 512 bytes\n\u6247\u533a\u5927\u5c0f(\u903b\u8f91/\u7269\u7406)\uff1a512 \u5b57\u8282 / 512 \u5b57\u8282\nI/O \u5927\u5c0f(\u6700\u5c0f/\u6700\u4f73)\uff1a512 \u5b57\u8282 / 512 \u5b57\u8282\n\u78c1\u76d8\u6807\u7b7e\u7c7b\u578b\uff1ados\n\u78c1\u76d8\u6807\u8bc6\u7b26\uff1a0x5eb87e6d\n\n   \u8bbe\u5907 Boot      Start         End      Blocks   Id  System\n/dev/vdc1            2048    20973567    10485760   8e  Linux LVM\n\n\u547d\u4ee4(\u8f93\u5165 m \u83b7\u53d6\u5e2e\u52a9)\uff1aw\nThe partition table has been altered!\n\nCalling ioctl() to re-read partition table.\n\u6b63\u5728\u540c\u6b65\u78c1\u76d8\u3002\n\n[root@localhost ~]# lsblk    # \u67e5\u770b\u5206\u533a\u60c5\u51b5\nNAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT\nsr0     11:0    1  9.5G  0 rom\nvda    253:0    0  100G  0 disk\n\u251c\u2500vda1 253:1    0    2M  0 part\n\u251c\u2500vda2 253:2    0    2G  0 part /boot\n\u2514\u2500vda3 253:3    0   98G  0 part /\nvdb    253:16   0  200G  0 disk /data\nvdc    253:32   0  100G  0 disk\n\u2514\u2500vdc1 253:33   0   10G  0 part\n</code></pre>"},{"location":"2025/sre/1linux/#mkfs","title":"mkfs\u547d\u4ee4\u2014\u2014\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf","text":"<p>mkfs\u547d\u4ee4\u7528\u4e8e\u5728\u6307\u5b9a\u7684\u8bbe\u5907\uff08\u6216\u78c1\u76d8\u5206\u533a\uff09\u4e0a\u521b\u5efa\u683c\u5f0f\u5316\u5e76\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf\u3002\u521b\u5efa\u5206\u533a\u540e\u5e76\u4e0d\u80fd\u4f7f\u7528\u5206\u533a\uff0c\u9700\u8981\u5bf9\u5206\u533a\u8fdb\u884c\u683c\u5f0f\u5316\u4e3a\u7279\u5b9a\u6587\u4ef6\u7cfb\u7edf\u540e\u624d\u80fd\u7528\u6765\u5b58\u53d6\u6570\u636e\u3002</p> <p>mkfs\u53ea\u662f\u4e00\u4e2a\u524d\u7aef\u547d\u4ee4\uff0c\u5b83\u901a\u8fc7-t\u53c2\u6570\u6307\u5b9a\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\u540e\u4f1a\u8c03\u7528\u76f8\u5e94\u7684\u547d\u4ee4mkfs.fstype\u3002\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528mkfs.ext4\u8fd9\u4e2a\u547d\u4ee4\u521b\u5efaext4\u6587\u4ef6\u7cfb\u7edf</p> <pre><code>\n# \u5c06/dev/vdc1\u683c\u5f0f\u5316\u4e3axfs\u6587\u4ef6\u7cfb\u7edf\n[root@localhost ~]# mkfs.xfs /dev/vdc1\n\n# \u5c06/dev/vdc2\u683c\u5f0f\u5316\u4e3aext4\u7cfb\u7edf\n[root@localhost ~]# mkfs -t ext4 /dev/vdc2\n</code></pre>"},{"location":"2025/sre/1linux/#fscklinux","title":"fsck\u547d\u4ee4\u2014\u2014\u68c0\u67e5\u5e76\u4fee\u590dLinux\u6587\u4ef6\u7cfb\u7edf","text":"<p>fsck\u547d\u4ee4\u7528\u4e8e\u68c0\u67e5\u5e76\u4fee\u590d\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u9519\u8bef\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a\u6587\u4ef6\u7cfb\u7edf\u5fc5\u987b\u662f\u5378\u8f7d\u72b6\u6001\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u51fa\u73b0\u6545\u969c\uff1b\u4e0d\u8981\u5bf9\u6b63\u5e38\u7684\u5206\u533a\u4f7f\u7528fsck\uff0cfsck\u4f1a\u6839\u636e/etc/fstab\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u68c0\u67e5\u3002</p> <p>\u53ea\u6709\u5f53\u7cfb\u7edf\u5f00\u673a\u663e\u793a\u78c1\u76d8\u9519\u8bef\u65f6\uff0c\u624d\u9700\u8981\u6267\u884c\u3002</p> <pre><code>[root@localhost ~]# fsck -A\n</code></pre>"},{"location":"2025/sre/1linux/#monut","title":"monut\u547d\u4ee4\u2014\u2014\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf","text":"<p>\u4e00\u4e2a\u5206\u533a\u88ab\u683c\u5f0f\u5316\u540e\u5e76\u4e0d\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u8fd8\u9700\u8981\u5c06\u5176\u6302\u8f7d\u5230\u6307\u5b9a\u7684\u6302\u8f7d\u70b9\u4e0a\u624d\u53ef\u4ee5\u88ab\u8bbf\u95ee\u3002</p> <pre><code>-l   \u663e\u793a\u5df2\u7ecf\u6302\u8f7d\u7684\u8bbe\u5907\u76f8\u5173\u4fe1\u606f\n-a   \u6302\u8f7d/etc/fstab\u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u4fe1\u606f\n-t   \u6307\u5b9a\u6302\u8f7d\u7684\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\u3002\u5982nfs\uff0ciso9660\uff08\u5149\u76d8\uff09\n-o   \u540e\u63a5\u4e00\u4e9b\u6302\u8f7d\u9009\u9879\u3002\n</code></pre> <pre><code>\n# \u663e\u793a\u7cfb\u7edf\u7684\u6302\u8f7d\u4fe1\u606f\n\n[root@localhost ~]# mount\n/dev/vda3 on / type xfs (rw,relatime,seclabel,attr2,inode64,noquota)\nselinuxfs on /sys/fs/selinux type selinuxfs (rw,relatime)\nnfsd on /proc/fs/nfsd type nfsd (rw,relatime)\n/dev/vdb on /data type xfs (rw,relatime,seclabel,attr2,inode64,noquota)\n/dev/vda2 on /boot type xfs (rw,relatime,seclabel,attr2,inode64,noquota)\n\n\n# \u6302\u8f7d\u5149\u76d8\u5149\u9a71\uff0c\u524d\u63d0\u662f\u6709\u5149\u9a71\u955c\u50cf\n\n[root@localhost ~]# mount  /dev/cdrom /media\n\n[root@localhost ~]# ll   /media\n\n# \u6302\u8f7dnfs\u6587\u4ef6\u7cfb\u7edf\n[root@localhost ~]# mount -t nfs   -o nodev,noatime  172.16.1.27:/data   /data\n\n\n\u6c38\u4e45\u6302\u8f7d\u8981\u5199\u5165\u5230/etc/fstab\u4e2d\n[root@localhost ~]# cat  &gt;&gt; /etc/fstab  &lt;&lt;EOF\n172.16.1.27:/data   /data   nfs    nodev,noatime   0 0\nEOF\n\n# \u6587\u4ef6\u7cfb\u7edf\u53ea\u8bfb\u65f6\uff0c\u9700\u8981\u91cd\u65b0\u6302\u8f7d\u6839\u76ee\u5f55\u4e3a\u8bfb\u5199\u6a21\u5f0f\u3002\n[root@localhost ~]# mount  -o remount,rw  /\n\n# \u786e\u8ba4fstab\u6587\u4ef6\u4e2d\u914d\u7f6e\u6b63\u786e\uff0c\u907f\u514d\u91cd\u542f\u5931\u8d25\n[root@localhost ~]# mount -a\n</code></pre> <p>\u6c38\u4e45\u6027\u6302\u8f7d\u7684\u78c1\u76d8\u90fd\u9700\u8981\u5199\u5165/etc/fstab\u6587\u4ef6\u4e2d\uff0c\u82e5\u8fd9\u4e2a\u6587\u4ef6\u914d\u7f6e\u6709\u9519\u8bef\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u91cd\u542f\u65e0\u6cd5\u6b63\u5e38\u8fdb\u5165\u7cfb\u7edf\u3002\u53ef\u4ee5\u4f7f\u7528mount -a\u8fdb\u884c\u6302\u8f7d\u6d4b\u8bd5\uff0c\u5982\u679c\u80fd\u6302\u8f7d\u6210\u529f\uff0c\u91cd\u542f\u4e00\u822c\u4f1a\u6b63\u5e38\u3002</p>"},{"location":"2025/sre/1linux/#umount","title":"umount\u547d\u4ee4\u2014\u2014\u5378\u8f7d\u5df2\u6302\u8f7d\u7684\u6587\u4ef6\u7cfb\u7edf","text":"<p>umount\u5378\u8f7d\u53ef\u4ee5\u63a5\u6302\u8f7d\u70b9\u76ee\u5f55\uff0c\u4e5f\u53ef\u4ee5\u63a5\u8bbe\u5907\u6587\u4ef6\u3002</p> <p>\u9009\u9879</p> <ul> <li>-f    \u5f3a\u5236\u5378\u8f7d</li> <li>-l \u5c06\u6587\u4ef6\u7cfb\u7edf\u4ece\u6587\u4ef6\u7cfb\u7edf\u5c42\u6b21\u7ed3\u6784\u4e2d\u5206\u79bb\u51fa\u6765\uff0c\u5e76\u6e05\u9664\u6211\u5bf9\u6587\u4ef6\u7cfb\u7edf\u7684\u6240\u6709\u5f15\u7528</li> </ul> <pre><code>\n# \u5378\u8f7d\u6302\u8f7d\u70b9/media\n[root@localhost ~]# umount  /media\n# \u5f3a\u5236\u5220\u9664\n\n[root@localhost ~]# cd /media/\n\n[root@localhost media]# umount /media    # \u5982\u679c\u5904\u4e8e\u6302\u8f7d\u70b9\u4e2d\uff0c\u5219\u65e0\u6cd5\u5378\u8f7d\uff0c\u53ef\u4ee5\u9000\u51fa\u6302\u8f7d\u70b9\u518d\u5378\u8f7d\u6216\u5f3a\u5236\u5378\u8f7d\numount: /media\uff1a\u76ee\u6807\u5fd9\u3002\n        (\u6709\u4e9b\u60c5\u51b5\u4e0b\u901a\u8fc7 lsof(8) \u6216 fuser(1) \u53ef\u4ee5\n         \u627e\u5230\u6709\u5173\u4f7f\u7528\u8be5\u8bbe\u5907\u7684\u8fdb\u7a0b\u7684\u6709\u7528\u4fe1\u606f)\n[root@localhost media]# umount -lf /media\n</code></pre>"},{"location":"2025/sre/1linux/#sync","title":"sync\u547d\u4ee4\u2014\u2014\u5237\u65b0\u6587\u4ef6\u7cfb\u7edf\u7f13\u5b58\u533a","text":"<p>sync\u547d\u4ee4\u4f1a\u5c06\u5185\u5b58\u7f13\u51b2\u533a\u7684\u6570\u636e\u5f3a\u5236\u5237\u65b0\u5230\u78c1\u76d8\u3002</p> <pre><code>\u64cd\u4f5c\uff1a\n# \u624b\u52a8\u5c06\u6570\u636e\u4ece\u7f13\u51b2\u533a\u5237\u5230\u78c1\u76d8\u4e2d\u5e76\u91cd\u542f\u7cfb\u7edf\nsync\nsync\nreboot\n</code></pre>"},{"location":"2025/sre/1linux/#linux_4","title":"Linux\u5e38\u7528\u547d\u4ee4\u4e4b\u7f51\u7edc\u7ba1\u7406","text":""},{"location":"2025/sre/1linux/#ifconfig","title":"ifconfig\u547d\u4ee4\u2014\u2014\u914d\u7f6e\u6216\u663e\u793a\u7f51\u7edc\u63a5\u53e3\u4fe1\u606f","text":"<p>ifconfig\u547d\u4ee4\u7528\u4e8e\u914d\u7f6e\u7f51\u5361IP\u5730\u5740\u7b49\u7f51\u7edc\u53c2\u6570\u6216\u663e\u793a\u5f53\u524d\u7f51\u7edc\u7684\u63a5\u53e3\u72b6\u6001\uff0c\u9700\u8981\u4ee5root\u7528\u6237\u7684\u8eab\u4efd\u6765\u6267\u884c\u3002</p> <p>\u5982\u679c\u547d\u4ee4\u4e0d\u5b58\u5728\u5219\u5b89\u88c5</p> <pre><code>yum install -y net-tools\n\n</code></pre> <p>\u4f7f\u7528ifconfig\u547d\u4ee4\u914d\u7f6e\u7f51\u5361\u4fe1\u606f\u4ec5\u4f1a\u4e34\u65f6\u751f\u6548\uff0c\u91cd\u542f\u7f51\u7edc\u6216\u670d\u52a1\u5668\u5c31\u4f1a\u5931\u6548\u3002</p> <p>\u9009\u9879\uff1a</p> <ul> <li>Up    \u6fc0\u6d3b\u6307\u5b9a\u7684\u7f51\u7edc\u63a5\u53e3</li> <li>down  \u5173\u95ed\u6307\u5b9a\u7684\u7f51\u7edc\u63a5\u53e3</li> <li>Hw    \u8bbe\u7f6e\u7f51\u5361\u7684MAC\u5730\u5740</li> </ul> <pre><code>\n# \u67e5\u770b\u6240\u6709\u5df2\u542f\u52a8\u7684\u7f51\u5361\u4fe1\u606f\n ifconfig\n\n# \u67e5\u770beth0\u7f51\u5361\u4fe1\u606f\nifconfig eth0\n\n# \u67e5\u770b\u6240\u6709\u7f51\u5361\u4fe1\u606f\uff08\u5305\u62ec\u672a\u5f00\u542f\u7684\uff09\nifconfig -a\n\n# \u542f\u52a8eth1\u7f51\u5361\nifconfig eth1 up\n\n# \u5173\u95edeth1\u7f51\u5361\nifconfig eth1 down\n\n# \u4e3a\u7f51\u5361\u914d\u7f6e\u4fe1\u606f\nifconfig eth0 172.16.1.30\n\n\n# \u4e3a\u7f51\u5361\u914d\u7f6e\u591a\u4e2aIP\nifconfig eth0:0 172.16.1.28 netmask 255.255.255.0  up\n\nifconfig\n\neth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 172.16.1.27  netmask 255.255.255.0  broadcast 172.16.1.255\n        inet6 fe80::ffaa:cae4:9cc0:3250  prefixlen 64  scopeid 0x20&lt;link&gt;\n        inet6 fe80::eb49:7220:1bb9:df4f  prefixlen 64  scopeid 0x20&lt;link&gt;\n        inet6 fe80::21b6:b00:310a:19d3  prefixlen 64  scopeid 0x20&lt;link&gt;\n        ether 28:6e:d4:89:b3:85  txqueuelen 1000  (Ethernet)\n        RX packets 5035132  bytes 609739285 (581.4 MiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 2070630  bytes 384120838 (366.3 MiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\neth0:0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 172.16.1.28  netmask 255.255.255.0  broadcast 172.16.1.255\n        ether 28:6e:d4:89:b3:85  txqueuelen 1000  (Ethernet)\n</code></pre> <p>\u7f51\u5361\u7684\u914d\u7f6e\u6587\u4ef6\u5728<code>/etc/sysconfig/network-scriprts/</code>\u76ee\u5f55\u4e0b\u3002eth0\u5bf9\u5e94\u7684\u662fifcfg-eth0\u6587\u4ef6\u3002</p>"},{"location":"2025/sre/1linux/#ifup","title":"ifup\u547d\u4ee4\u2014\u2014\u6fc0\u6d3b\u7f51\u7edc\u63a5\u53e3","text":"<p>ifup\u547d\u4ee4\u53ef\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6<code>/etc/sysconfig/network</code>\u548c<code>/etc/sysconfig/network-scripts/ifcfg-&lt;configuration&gt;</code>\u5bf9\u7f51\u7edc\u63a5\u53e3\u8fdb\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\u3002</p> <pre><code>\n# \u6fc0\u6d3beth0\u7f51\u7edc\u63a5\u53e3\uff0c\u7b49\u540c\u4e8eifconfig eth0 up\nifup eth0   \n\n# \u67e5\u770beth0\u7f51\u7edc\u63a5\u53e3\u72b6\u6001\nifconfig eth0\n</code></pre>"},{"location":"2025/sre/1linux/#ifdown","title":"ifdown\u547d\u4ee4\u2014\u2014\u7528\u4e8e\u7981\u7528\u6307\u5b9a\u7684\u7f51\u7edc\u63a5\u53e3\u3002","text":"<pre><code># \u5173\u95edeth0\u7f51\u5361\u63a5\u53e3\uff0c\u8be5\u64cd\u4f5c\u5bfc\u81f4\u65ad\u5f00SSH\u8fde\u63a5\uff0c\u8c28\u614e\u64cd\u4f5c\nifdown eth0\n\n# \u91cd\u542f\u7f51\u5361\nifdown eth0 &amp;&amp; ifup eth0\n</code></pre>"},{"location":"2025/sre/1linux/#route","title":"route\u547d\u4ee4\u2014\u2014\u7ba1\u7406\u8def\u7531\u8868","text":"<p>route\u547d\u4ee4\u53ef\u4ee5\u4e3a\u670d\u52a1\u5668\u8bbe\u7f6e\u9759\u6001\u8def\u7531\u3002</p> <pre><code>-n  \u67e5\u770b\u8def\u7531\u4fe1\u606f\n-ee  \u663e\u793a\u66f4\u8be6\u7ec6\u7684\u8def\u7531\u4fe1\u606f\nadd  \u6dfb\u52a0\u8def\u7531\u4fe1\u606f\ndel  \u5220\u9664\u8def\u7531\u4fe1\u606f\n-net  \u5230\u4e00\u4e2a\u7f51\u7edc\u7684\u8def\u7531\uff0c\u540e\u9762\u63a5\u7f51\u7edc\u53f7\u5730\u5740\n-host  \u5230\u4e00\u4e2a\u4e3b\u673a\u7684\u8def\u7531\uff0c\u540e\u9762\u63a5\u4e00\u4e2a\u4e3b\u673a\u5730\u5740\nnetmask  \u6dfb\u52a0\u5b50\u7f51\u63a9\u7801\ngw  \u6307\u5b9a\u7f51\u5173\ndev If  \u6307\u5b9a\u7531\u54ea\u4e2a\u7f51\u5361\u51fa\u53bb\uff0c\u5982eth0\n</code></pre> <pre><code>\n# \u67e5\u770b\u7cfb\u7edf\u8def\u7531\u4fe1\u606f\nroute -n \n\n# \u5220\u9664\u8def\u7531\u4fe1\u606f\nroute del default   //\u5220\u9664\u9ed8\u8ba4\u7f51\u5173\nroute del default gw 172.16.1.254 \nroute del default  gw 172.16.1.254 dev eth0\n\n# \u6dfb\u52a0\u8def\u7531\u4fe1\u606f\nroute add default gw 172.16.1.254\nroute add default gw 172.16.1.254 dev eth0\n\n# \u914d\u7f6e\u53bb\u5f80\u67d0\u4e00\u7f51\u7edc\u6216\u7f51\u6bb5\u7684\u8def\u7531\n\n172\u7f51\u6bb5\u4e3b\u673a\u8bbf\u95ee192\u7f51\u6bb5\u7684\u4e3b\u673a\u3002\nroute add -net 192.168.4.0/24 gw 172.16.1.254\nroute add -net 192.168.4.0/24 netmask 255.255.255.0 dev eth1\n\n\u5220\u9664\u8def\u7531\nroute del -net 192.168.4.0/24 dev eth1\n\n# \u914d\u7f6e\u53bb\u5f80\u67d0\u4e2a\u4e3b\u673a\u7684\u8def\u7531\nroute add -host 172.16.2.250 dev eth0\n\n\u5220\u9664\u8def\u7531\uff1a\nroute del -host 172.16.2.250 dev eth0\n</code></pre> <p>\u4ee5\u4e0a\u914d\u7f6e\u5728\u91cd\u542f\u7f51\u7edc\u65f6\u90fd\u4f1a\u5931\u6548\u9700\u8981\u5199\u5230\u914d\u7f6e\u4e2d\u3002</p> <p>\u9700\u8981\u5199\u5230<code>/etc/sysconfig/network-scripts/route-eth*\u6216/etc/rc.local</code>\u6587\u4ef6\u4e2d\uff0c\u91cd\u542f\u4f1a\u91cd\u65b0\u52a0\u8f7d\u3002</p> <pre><code>192.168.4.0/24 via 172.16.1.254\n</code></pre>"},{"location":"2025/sre/1linux/#arparp","title":"arp\u547d\u4ee4\u2014\u2014\u7ba1\u7406\u7cfb\u7edf\u7684arp\u7f13\u5b58","text":"<p>arp\u662f\u5730\u5740\u89e3\u6790\u534f\u8bae\uff0c\u4e3b\u8981\u662f\u6839\u636eIP\u5730\u5740\u83b7\u53d6\u7269\u7406\u5730\u5740\u3002arp\u53ef\u4ee5\u663e\u793a\u7f13\u5b58\u533a\u4e2d\u7684\u6240\u6709\u6761\u76ee\u3001\u5220\u9664\u6307\u5b9a\u7684\u6761\u76ee\u6216\u8005\u6dfb\u52a0\u9759\u6001\u7684IP\u5730\u5740\u4e0eMAC\u5730\u5740\u7684\u5bf9\u5e94\u5173\u7cfb\u3002</p> <pre><code>-n  \u663e\u793aIP\u5730\u5740\u5bf9\u5e94\u7684MAC\u5730\u5740\u4fe1\u606f\n\n\n-s &lt;\u4e3b\u673a&gt;&lt;MAC&gt;   \u6307\u5b9a\u4e3b\u673a\u7684IP\u5730\u5740\u4e0eMAC\u5730\u5740\u7684\u9759\u6001\u6620\u5c04\n\n-d &lt;\u4e3b\u673a&gt;  \u5220\u9664\u5236\u5b9a\u4e3b\u673a\u7684arp\u6761\u76ee\n\n\n# \u663e\u793aarp\u7f13\u5b58\u533a\u7684\u6240\u6709\u6761\u76ee\n[root@localhost ~]# arp -n\nAddress                  HWtype  HWaddress           Flags Mask            Iface\n172.16.1.20              ether   28:6e:d4:8a:02:c0   C                     eth0\n172.16.1.25              ether   28:6e:d4:8a:15:61   C                     eth0\n172.18.0.9               ether   02:42:ac:12:00:09   C                     br-7f15bb750845\n172.16.1.254                     (incomplete)                              eth0\n172.16.1.22              ether   28:6e:d4:89:e0:09   C                     eth0\n172.16.1.24              ether   28:6e:d4:88:eb:3d   C                     eth0\n\n\n# \u67e5\u770b\u6307\u5b9a\u4e3b\u673a\u7684arp\u6761\u76ee\narp -n 172.16.1.27  \n\n# \u7ed1\u5b9aIP\u5730\u5740\u548cMAC\u5730\u5740\uff08\u4e34\u65f6\uff0c\uff09\n[root@localhost ~]# arp -s 172.16.1.20 28:6e:d4:8a:02:c1\n[root@localhost ~]# arp -n\nAddress                  HWtype  HWaddress           Flags Mask            Iface\n172.16.1.20              ether   28:6e:d4:8a:02:c1   CM                    eth0\n# \u5220\u9664\u9759\u6001ARP\u7ed1\u5b9a\n[root@localhost ~]# arp -d 172.16.1.20\n\n</code></pre>"},{"location":"2025/sre/1linux/#ip","title":"ip\u547d\u4ee4\u2014\u2014\u7f51\u7edc\u914d\u7f6e\u5de5\u5177","text":"<p>ip\u547d\u4ee4\u7528\u4e8e\u663e\u793a\u6216\u7ba1\u7406linux\u7cfb\u7edf\u7684\u8def\u7531\u3001\u7f51\u7edc\u8bbe\u5907\u3001\u7b56\u7565\u8def\u7531\u548c\u96a7\u9053\u3002</p> <p>\u8bed\u6cd5\u683c\u5f0f\uff1a</p> <pre><code>ip  [\u9009\u9879]  [\u7f51\u7edc\u5bf9\u8c61]  [\u64cd\u4f5c\u547d\u4ee4]\n\n\n\n# \u67e5\u770b\u7f51\u5361\u4fe1\u606f\n[root@localhost ~]# ip a\n\n# \u5173\u95ed\u7f51\u5361\n[root@localhost ~]# ip link set eth0 down\n\n# \u5f00\u542f\u7f51\u5361\n[root@localhost ~]# ip link set eth0 up\n\n# \u6dfb\u52a0IP\u5730\u5740\n[root@localhost ~]# ip a add 172.16.1.31/24 dev eth0\n\n# \u5220\u9664IP\u5730\u5740\n[root@localhost ~]# ip a del 172.16.1.31/24 dev eth0\n\n# \u67e5\u770b\u8def\u7531\n[root@localhost ~]# ip route\ndefault via 172.16.1.254 dev eth0 proto static metric 100\n172.16.1.0/24 dev eth0 proto kernel scope link src 172.16.1.27 metric 100\n172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1\n172.18.0.0/16 dev br-7f15bb750845 proto kernel scope link src 172.18.0.1\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <p>1\u3001\u5220\u9664\u7f51\u5361\u7684\u4e3bIP\u5730\u5740\uff0c\u540c\u65f6\u4f1a\u5220\u9664\u8be5\u7f51\u5361\u7684\u6240\u6709IP\u5730\u5740\u3002</p> <p>2\u3001\u5220\u9664\u7f51\u5361\u7684\u8f85\u52a9IP\u5730\u5740\uff0c\u4e0d\u4f1a\u5f71\u54cd\u8be5\u7f51\u5361\u7684\u5176\u4ed6IP\u5730\u5740\u3002</p> <p>3\u3001ip\u547d\u4ee4\u96c6\u6210\u4e86ifconfig\u548croute\u7684\u529f\u80fd\uff0c\u9010\u6e10\u66ff\u4ee3\u8fd9\u4e24\u4e2aIP</p>"},{"location":"2025/sre/1linux/#netstat","title":"netstat\u547d\u4ee4\u2014\u2014\u67e5\u770b\u7f51\u7edc\u7aef\u53e3\u4fe1\u606f","text":"<p>\u7528\u4e8e\u663e\u793a\u672c\u673a\u7f51\u7edc\u7684\u8fde\u63a5\u72b6\u6001\u3001\u8fd0\u884c\u7aef\u53e3\u548c\u8def\u7531\u8868\u7b49\u4fe1\u606f\u3002</p> <pre><code>-n      \u663e\u793a\u6570\u5b57\u5f62\u5f0f\u7684\u5730\u5740\u800c\u4e0d\u662f\u53bb\u89e3\u6790\u4e3b\u673a\n-a     \u663e\u793a\u5904\u4e8e\u76d1\u542c\u72b6\u6001\u548c\u975e\u76d1\u542c\u72b6\u6001\u7684socket\u4fe1\u606f\n-c &lt;\u79d2\u6570&gt;  \u6bcf\u9694\u51e0\u79d2\u5237\u65b0\u4e00\u6b21\n-l  \u4ec5\u663e\u793a\u5904\u4e8e\u76d1\u542c\u72b6\u6001\u7684\u7f51\u7edc\u72b6\u6001\n-t  \u663e\u793a\u6240\u6709\u7684TCP\u8fde\u63a5\u60c5\u51b5\n-u  \u663e\u793a\u6240\u6709\u7684UDP\u8fde\u63a5\u60c5\u51b5\n-p   \u663e\u793asocket\u6240\u5c5e\u8fdb\u7a0b\u7684PID\u548c\u540d\u79f0\n</code></pre> <p>\u5e38\u7528\u7ec4\u5408\uff1a</p> <pre><code># \u5217\u51fa\u6240\u6709\u5904\u4e8e\u76d1\u542c\u72b6\u6001\u7684\u7aef\u53e3\u4fe1\u606f\n[root@localhost ~]# netstat -lntup\n\n\n# \u5217\u51fa\u6240\u6709\u5904\u4e8e\u76d1\u542c\u548c\u975e\u76d1\u542c\u72b6\u6001\u7684\u7aef\u53e3\u4fe1\u606f\n[root@localhost ~]# netstat -antup\n</code></pre> <p>\u91cd\u8981\u7684\u4e24\u4e2a\u72b6\u6001:</p> <p>1\u3001ESTABLISHED\uff1a\u8868\u793a\u5904\u4e8e\u8fde\u63a5\u7684\u72b6\u6001\uff0c\u8ba4\u4e3a\u6709\u4e00\u4e2aEASTABLISHED\u662f\u4e00\u4e2a\u670d\u52a1\u7684\u5e76\u53d1\u8fde\u63a5\u3002</p> <p>2\u3001LISTEN\uff1asocket\u6b63\u5728\u76d1\u542c\u8fde\u63a5\u8bf7\u6c42\u3002</p>"},{"location":"2025/sre/1linux/#ss","title":"ss\u547d\u4ee4\u2014\u2014\u67e5\u770b\u7f51\u7edc\u7aef\u53e3\u4fe1\u606f","text":"<p>ss\u547d\u4ee4\u548cnetstat\u529f\u80fd\u7c7b\u4f3c\uff0c\u4f46\u5b83\u80fd\u663e\u793a\u66f4\u591a\u66f4\u8be6\u7ec6\u7684\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f\uff0c\u6bd4netstat\u66f4\u5feb\u66f4\u9ad8\u6548</p> <p>\u5b89\u88c5ss\u547d\u4ee4\uff1a</p> <pre><code>yum -y install iproute\n\n\n\n# \u5217\u51fa\u6240\u6709\u5904\u4e8e\u76d1\u542c\u72b6\u6001\u7684\u7aef\u53e3\u4fe1\u606f\n[root@localhost ~]# ss -lntup\n\n# \u5217\u51fa\u6240\u6709\u5904\u4e8e\u76d1\u542c\u548c\u975e\u76d1\u542c\u72b6\u6001\u7684\u7aef\u53e3\u4fe1\u606f\n[root@localhost ~]# ss -antup\n</code></pre>"},{"location":"2025/sre/1linux/#ping","title":"ping\u547d\u4ee4\u2014\u2014\u6d4b\u8bd5\u4e3b\u673a\u4e4b\u95f4\u7f51\u7edc\u7684\u8fde\u901a\u6027","text":"<p>ping\u547d\u4ee4\u53d1\u51fa\u8bf7\u6c42\u540e\uff0c\u8fdc\u7aef\u4e3b\u673a\u7f51\u7edc\u8054\u901a\u7684\u8bdd\uff0c\u5c31\u4f1a\u6536\u5230\u56de\u5e94\u6d88\u606f\u3002\u53ef\u5224\u65ad\u4e3b\u673a\u662f\u5426\u6b63\u5e38\u6216\u4e24\u8005\u7684\u7f51\u7edc\u662f\u5426\u53ef\u4ee5\u4e92\u901a\u3002</p> <pre><code>\n-c &lt;\u6b21\u6570&gt; \u6307\u5b9a\u53d1\u9001ICMP\u62a5\u6587\u7684\u6b21\u6570\uff0c\u9ed8\u8ba4\u4e00\u76f4\u53d1\u9001\u62a5\u6587\n-i &lt;\u65f6\u95f4&gt;  \u53d1\u9001\u62a5\u6587\u7684\u95f4\u9694\u65f6\u95f4\uff0c\u9ed8\u8ba4\u662f1s\n-t &lt;\u751f\u5b58\u671f&gt;  \u8bbe\u7f6e\u53d1\u9001\u7684\u6570\u636e\u5305\u5176\u751f\u5b58\u671fTTL\u503c\n\n# \u76f4\u63a5ping\u57df\u540d\n[root@localhost ~]# ping harbor.liyb.com\n\n# \u6d4b\u8bd5IP\u5730\u5740\n[root@localhost ~]# ping 172.16.1.27\n\n# \u6bcf\u6b21ping\u95f4\u96942\u79d2\uff0c\u4e00\u51715\u6b21\u3002\n[root@localhost ~]# ping -t 2 -c 5 172.16.1.27\nPING 172.16.1.27 (172.16.1.27) 56(84) bytes of data.\n64 bytes from 172.16.1.27: icmp_seq=1 ttl=64 time=0.029 ms\n64 bytes from 172.16.1.27: icmp_seq=2 ttl=64 time=0.032 ms\n64 bytes from 172.16.1.27: icmp_seq=3 ttl=64 time=0.032 ms\n64 bytes from 172.16.1.27: icmp_seq=4 ttl=64 time=0.028 ms\n64 bytes from 172.16.1.27: icmp_seq=5 ttl=64 time=0.026 ms\n\n\n--- 172.16.1.27 ping statistics ---\n5 packets transmitted, 5 received, 0% packet loss, time 3999ms\nrtt min/avg/max/mdev = 0.026/0.029/0.032/0.005 ms\n</code></pre> <p>\u6ce8\u610f\uff1a\u5982\u679c\u4e0d\u52a0-c\u53c2\u6570\u4f1a\u4e00\u76f4ping\u4e0b\u53bb\uff0c\u8fd9\u65f6\u9700\u8981\u4f7f\u7528Ctrl + c\u6765\u7ec8\u6b62\u3002</p>"},{"location":"2025/sre/1linux/#traceroute","title":"traceroute\u547d\u4ee4\u2014\u2014\u8ffd\u8e2a\u6570\u636e\u4f20\u8f93\u8def\u7531\u72b6\u6001","text":"<p>traceroute\u547d\u4ee4\u548cwindow\u4e0b\u7684tracert\u547d\u4ee4\u7c7b\u4f3c\uff0c\u7528\u4e8e\u663e\u793a\u7f51\u7edc\u6570\u636e\u5305\u4f20\u8f93\u5230\u6307\u5b9a\u4e3b\u673a\u7684\u8def\u5f84\u4fe1\u606f</p> <p>\u5b89\u88c5traceroute\uff1a</p> <pre><code>yum install -y traceroute\n\n\ntraceroute www.baidu.com\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <p>1\u3001\u6709\u65f6\u4f1a\u770b\u5230\u4e00\u4e9b\u661f\u53f7\u3002\u53ef\u80fd\u662f\u56e0\u4e3a\u7f51\u7edc\u8bbe\u5907\u5c01\u5835\u6216\u4e22\u5f03\u4e86\u8fd4\u56de\u7684\u4fe1\u606f\uff0c\u6240\u4ee5\u5f97\u4e0d\u5230\u8fd4\u56de\u4fe1\u606f\u3002</p> <p>2\u3001traceroute\u9ed8\u8ba4\u4f7f\u7528UDP\u534f\u8bae\uff08\u53d7\u7f51\u7edc\u5f71\u54cd\u6027\u80fd\u4e0d\u592a\u597d\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528-I\u53c2\u6570\u6765\u8c03\u7528icmp\u534f\u8bae\u3002</p>"},{"location":"2025/sre/1linux/#telnet","title":"telnet\u547d\u4ee4\u2014\u2014\u8fdc\u7a0b\u767b\u5f55\u4e3b\u673a\u6216\u68c0\u6d4b\u8fdc\u7a0b\u7aef\u53e3","text":"<p>telnet\u547d\u4ee4\u4f7f\u752823\u7aef\u53e3\u8fdb\u884c\u8fdc\u7a0b\uff0c\u4f46\u662f\u4f7f\u7528\u660e\u6587\u4f20\u8f93\uff0c\u5b89\u5168\u6027\u4e0d\u597d\u3002\u76ee\u524d\u8fdc\u7a0b\u8fde\u63a5\u4e00\u822c\u4f7f\u7528\u5b89\u5168\u6027\u66f4\u597d\u7684SSH\u670d\u52a1\u3002\u73b0\u5728telnet\u7684\u4e3b\u8981\u5e94\u7528\u573a\u666f\u662f\u5224\u65ad\u8fdc\u7aef\u670d\u52a1\u5668\u7684\u7aef\u53e3\u662f\u5426\u5f00\u653e\u3002</p> <p>\u64cd\u4f5c\uff1a</p> <pre><code># \u7aef\u53e3\u653e\u901a\u7684\u73b0\u8c61\n[root@localhost ~]# telnet 172.16.1.20 22\nTrying 172.16.1.20...\nConnected to 172.16.1.20.\nEscape character is '^]'.\nSSH-2.0-OpenSSH_7.4   # \u770b\u5230\u8fd9\u79cd\u60c5\u51b5\uff0c\u4ee3\u886822\u7aef\u53e3\u662f\u653e\u901a\u7684\u3002\n# \u7aef\u53e3\u65e0\u6cd5\u8fde\u63a5\u7684\u73b0\u8c61\n[root@localhost ~]# telnet 172.16.1.20 3306\nTrying 172.16.1.20...\ntelnet: connect to address 172.16.1.20: Connection refused\n</code></pre>"},{"location":"2025/sre/1linux/#ssh","title":"ssh\u547d\u4ee4\u2014\u2014\u8fdc\u7a0b\u767b\u5f55\u4e3b\u673a","text":"<p>ssh\u547d\u4ee4\u53ef\u4ee5\u4f7f\u7528ssh\u52a0\u5bc6\u534f\u8bae\u5b9e\u73b0\u5b89\u5168\u7684\u8fdc\u7a0b\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5b9e\u73b0\u5bf9\u670d\u52a1\u5668\u7684\u8fdc\u7a0b\u7ba1\u7406\u3002</p> <p>\u8bed\u6cd5\u683c\u5f0f\uff1a</p> <pre><code>ssh  [\u9009\u9879]  [\u7528\u6237]@[\u4e3b\u673a\u540d\u6216IP\u5730\u5740]  [\u8fdc\u7a0b\u6267\u884c\u7684\u547d\u4ee4]\n\n\n# \u9996\u6b21\u8fde\u63a5\u4f1a\u63d0\u793a\uff0c\u518d\u6b21\u8fde\u63a5\u5c31\u4e0d\u4f1a\u63d0\u793a\uff0c\u8f93\u5165\u6b63\u786e\u5bc6\u7801\u5c31\u53ef\u4ee5\u8fdc\u7a0b\n[root@k8s-master03 ~]# ssh -p 22 root@172.16.1.20\nThe authenticity of host '172.16.1.20 (172.16.1.20)' can't be established.\nECDSA key fingerprint is SHA256:ANt+WLWZpyB8YH14ROYVMTS68fEcEqoIrdVAi2FtwvU.\nECDSA key fingerprint is MD5:d0:f1:19:71:df:cb:39:b3:b2:cb:9a:83:39:f2:05:cb.\nAre you sure you want to continue connecting (yes/no)?  yes\nWarning: Permanently added '172.16.1.20' (ECDSA) to the list of known hosts.\nroot@172.16.1.20's password:\n\n\n\n# \u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\n[root@localhost ~]# ssh root@172.16.1.20 \"free -h\"\nroot@172.16.1.20's password:    # \u8f93\u5165\u6b63\u5e38\u5bc6\u7801\n              total        used        free      shared  buff/cache   available\nMem:            15G        1.4G        2.4G        743M         11G         13G\nSwap:            0B          0B          0B\n\n# \u8c03\u8bd5\n[root@localhost ~]# ssh -v root@172.16.1.20\n</code></pre>"},{"location":"2025/sre/1linux/#wget","title":"wget\u547d\u4ee4\u2014\u2014\u547d\u4ee4\u884c\u4e0b\u8f7d\u5de5\u5177","text":"<p>wget\u547d\u4ee4\u7528\u4e8e\u4ece\u7f51\u7edc\u4e0a\u4e0b\u8f7d\u67d0\u4e9b\u8d44\u6599\uff0c\u53ef\u4ee5\u76f4\u63a5\u4ece\u7f51\u7edc\u4e0a\u4e0b\u8f7d\u81ea\u5df1\u7684\u6240\u9700\u8981\u7684\u6587\u4ef6</p> <pre><code>\n-o  \u5c06\u6587\u4ef6\u7684\u6267\u884c\u7ed3\u679c\u5199\u5165\u6587\u4ef6\u4e2d\n-O  \u6307\u5b9a\u4fdd\u5b58\u7684\u6587\u4ef6\u540d\u540e\u4e0b\u8f7d\u6587\u4ef6\n-c  \u65ad\u70b9\u7eed\u4f20\n--limit-rate      \u9650\u901f\u4e0b\u8f7d\n\n\n\u64cd\u4f5c\uff1a\n\n# \u4e0b\u8f7d\u5355\u4e2a\u6587\u4ef6\uff0c\u76f4\u63a5\u540e\u9762\u52a0\u94fe\u63a5\nwget https://dlcdn.apache.org/tomcat/tomcat-8/v8.5.98/src/apache-tomcat-8.5.98-src.tar.gz\n\n# \u6307\u5b9a\u4fdd\u5b58\u7684\u6587\u4ef6\u540e\u4e0b\u8f7d\nwget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo\n\n# \u9650\u901f\u4e0b\u8f7d\nwget  --limit-rate=5k -O  /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo\n</code></pre>"},{"location":"2025/sre/1linux/#nslookup","title":"nslookup\u547d\u4ee4\u2014\u2014\u57df\u540d\u89e3\u6790\u67e5\u8be2\u5de5\u5177","text":"<pre><code>nslookup [\u9009\u9879]  [\u57df\u540d/IP]  [DNS\u670d\u52a1\u5668]\n\n\n# \u67e5\u770bDNS\u914d\u7f6e\u6587\u4ef6\n[root@localhost ~]# cat /etc/resolv.conf     \n# Generated by NetworkManager\nsearch liyb.com\nnameserver 172.16.1.27\n\n\n# \u4ea4\u4e92\u6a21\u5f0f\n[root@localhost ~]# nslookup\n&gt; server    172.16.1.27    # \u6307\u5b9aDNS\u670d\u52a1\u5668\nDefault server: 172.16.1.27\nAddress: 172.16.1.27#53\n&gt; harbor.liyb.com    # \u89e3\u6790\u57df\u540d\nServer:         172.16.1.27\nAddress:        172.16.1.27#53\n\nName:   harbor.liyb.com\nAddress: 172.16.1.26\n\n\n# \u975e\u4ea4\u4e92\u6a21\u5f0f\n[root@localhost ~]# nslookup harbor.liyb.com\nServer:         172.16.1.27\nAddress:        172.16.1.27#53\n\nName:   harbor.liyb.com\nAddress: 172.16.1.26\n</code></pre>"},{"location":"2025/sre/1linux/#dig","title":"dig\u547d\u4ee4\u2014\u2014\u57df\u540d\u67e5\u8be2\u5de5\u5177","text":"<p>dig\u547d\u4ee4\u7528\u4e8e\u6d4b\u8bd5\u57df\u540d\u7cfb\u7edf\u7684\u5de5\u4f5c\u662f\u5426\u6b63\u5e38</p> <pre><code>@&lt;DNS\u7684IP\u5730\u5740\uff1e \u6307\u5b9aDNS\u670d\u52a1\u5668\u6765\u8fdb\u884c\u89e3\u6790\n-t  \u6307\u5b9a\u8981\u67e5\u8be2\u7684DNS\u6570\u636e\u7c7b\u578b\n\uff0btrace  \u4ece\u6839\u57df\u540d\u5f00\u59cb\u8ddf\u8e2a\u67e5\u8be2\u7ed3\u679c\n+short  \u4ec5\u8f93\u51fa\u6700\u7cbe\u7b80\u7684CNAME\u548cA\u8bb0\u5f55\n</code></pre> <pre><code>\n# \u67e5\u8be2\u6307\u5b9a\u57df\u540d\u7684IP\u5730\u5740\n[root@localhost ~]# dig harbor.liyb.com\n\n\n; &lt;&lt;&gt;&gt; DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7 &lt;&lt;&gt;&gt; harbor.liyb.com\n;; global options: +cmd\n;; Got answer:\n;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 6359\n;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2\n\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;harbor.liyb.com.               IN      A\n\n\n;; ANSWER SECTION:\nharbor.liyb.com.        86400   IN      A       172.16.1.26\n\n\n;; AUTHORITY SECTION:\nliyb.com.               86400   IN      NS      www.liyb.com.\n\n\n;; ADDITIONAL SECTION:\nwww.liyb.com.           86400   IN      A       172.16.1.27\n\n\n;; Query time: 0 msec\n;; SERVER: 172.16.1.27#53(172.16.1.27)\n;; WHEN: \u4e94 1\u6708 26 12:04:32 CST 2024\n;; MSG SIZE  rcvd: 94\n# \u6307\u5b9aDNS\u670d\u52a1\u5668\n[root@localhost ~]# dig @172.16.1.27 harbor.liyb.com\n\n# \u7cbe\u7b80\u8f93\u51fa\n\n[root@localhost ~]# dig +short harbor.liyb.com\n172.16.1.26\n</code></pre>"},{"location":"2025/sre/1linux/#tcpdump","title":"tcpdump\u547d\u4ee4\u2014\u2014\u76d1\u542c\u7f51\u7edc\u6d41\u91cf","text":"<p>tcpdump\u547d\u4ee4\u662f\u4e00\u4e2a\u622a\u83b7\u7f51\u7edc\u6570\u636e\u5305\u7684\u5305\u5206\u6790\u5de5\u5177\u3002tcpdump\u53ef\u4ee5\u5c06\u7f51\u7edc\u4e2d\u4f20\u9001\u7684\u6570\u636e\u5305\u7684\u201c\u5934\u201d\u5b8c\u5168\u622a\u83b7\u4e0b\u6765\u4ee5\u63d0\u4f9b\u5206\u6790\u3002</p> <pre><code>-c &lt;\u6570\u91cf&gt;  \u63a5\u6536\u5230\u6307\u5b9a\u7684\u6570\u636e\u5305\u6570\u76ee\u540e\u9000\u51fa\n-i &lt;\u7f51\u7edc\u63a5\u53e3&gt;  \u6307\u5b9a\u8981\u76d1\u542c\u7684\u7f51\u7edc\u63a5\u53e3\n-n \u4e0d\u8fdb\u884cDNS\u89e3\u6790\uff0c\u52a0\u5feb\u663e\u793a\u901f\u5ea6\n-nn \u4e0d\u5c06\u534f\u8bae\u548c\u7aef\u53e3\u6570\u5b57\u7b49\u8f6c\u6362\u6210\u540d\u5b57\n-q  \u4ee5\u66f4\u5feb\u901f\u8f93\u51fa\u7684\u65b9\u5f0f\u8fd0\u884c\u3002\n-v  \u663e\u793a\u547d\u4ee4\u6267\u884c\u7684\u8be6\u7ec6\u4fe1\u606f\n</code></pre> <pre><code># \u4e0d\u52a0\u53c2\u6570\u5c06\u542f\u52a8\u76d1\u89c6\u7b2c\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u6240\u6d41\u8fc7\u7684\u6570\u636e\u5305\n[root@localhost ~]# tcpdump\n\n# \u6307\u5b9a\u7f51\u7edc\u63a5\u53e3\u8fdb\u884c\u76d1\u542c\n[root@localhost ~]# tcpdump -i eth0\n\n# \u6307\u5b9a\u76d1\u542c\u4e3b\u673a\u7684\u6570\u636e\u5305\n[root@localhost ~]# tcpdump -n host 172.16.1.26\n\n# \u76d1\u542c\u6307\u5b9a\u7aef\u53e3\u7684\u6570\u636e\u5305\n[root@localhost ~]# tcpdump -nn port 22\n\u5e38\u89c1\u7684\u534f\u8bae\u5173\u952e\u5b57\u6709ip\u3001arp\u3001icmp\u3001tcp\u3001udp\u7b49\u7c7b\u578b\u3002\n\n# \u4f7f\u7528tcpdump\u5bf9tcp\u6570\u636e\u8fdb\u884c\u6293\u5305\n[root@localhost ~]# tcpdump tcp dst port 80 or src 172.16.1.26 -i eth0 -n\n</code></pre>"},{"location":"2025/sre/2ansible/","title":"Ansible \u4ece\u5165\u95e8\u5230\u653e\u5f03","text":""},{"location":"2025/sre/2ansible/#1-ansible","title":"1 Ansible \u7b80\u4ecb","text":""},{"location":"2025/sre/2ansible/#ansible_1","title":"Ansible \u7b80\u4ecb","text":"<p>Ansible \u662f\u4e00\u4e2a\u7531 Red Hat \u5f00\u53d1\u7684 \u5f00\u6e90\u81ea\u52a8\u5316\u8fd0\u7ef4\u5de5\u5177\uff0c\u7528\u6765\u505a\uff1a</p> <ul> <li>\u2022 \u914d\u7f6e\u7ba1\u7406</li> <li>\u2022 \u5e94\u7528\u90e8\u7f72</li> <li>\u2022 \u81ea\u52a8\u5316\u4efb\u52a1\u6267\u884c</li> <li>\u2022 \u591a\u53f0\u670d\u52a1\u5668\u6279\u91cf\u64cd\u4f5c</li> </ul> <p>\u5b83\u7684\u6700\u5927\u7279\u70b9\u662f\uff1a\u65e0\u4ee3\u7406\uff08agentless\uff09+ \u57fa\u4e8e SSH \u8fde\u63a5 + YAML \u7f16\u5199\uff08\u53ef\u8bfb\u6027\u5f3a\uff09\u3002</p>"},{"location":"2025/sre/2ansible/#ansible_2","title":"\u4e3a\u4ec0\u4e48\u9009\u62e9 Ansible\uff1f","text":"<pre><code>\n\u7279\u70b9     \u63cf\u8ff0\n\u2705 \u65e0\u4ee3\u7406     \u88ab\u63a7\u7aef\u65e0\u9700\u5b89\u88c5 agent\uff0c\u76f4\u63a5\u901a\u8fc7 SSH \u64cd\u4f5c\n\u2705 \u6613\u4e8e\u4e0a\u624b   \u4f7f\u7528 YAML \u7f16\u5199 playbook\uff0c\u53ef\u8bfb\u6027\u5f3a\n\u2705 \u6a21\u5757\u4e30\u5bcc   \u5185\u7f6e\u548c\u793e\u533a\u6a21\u5757\u652f\u6301\u5404\u79cd\u5e73\u53f0\u4e0e\u4efb\u52a1\n\u2705 \u8de8\u5e73\u53f0     \u7ba1\u7406 Linux\u3001Windows\u3001\u7f51\u7edc\u8bbe\u5907\u7b49\n\u2705 \u53ef\u6269\u5c55     \u652f\u6301\u81ea\u5b9a\u4e49\u6a21\u5757\u548c\u63d2\u4ef6\u7cfb\u7edf\n\u2705 \u793e\u533a\u6d3b\u8dc3   \u62e5\u6709\u4e30\u5bcc\u7684\u5f00\u6e90\u8d44\u6e90\u548c\u6587\u6863\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible_3","title":"Ansible \u80fd\u505a\u4ec0\u4e48\uff1f","text":"<ul> <li>\u2022 \u6279\u91cf\u90e8\u7f72\u8f6f\u4ef6\uff08\u5982\u5b89\u88c5 nginx\u3001mysql\uff09</li> <li>\u2022 \u914d\u7f6e\u6587\u4ef6\u4e0b\u53d1\u4e0e\u6a21\u677f\u66ff\u6362</li> <li>\u2022 \u91cd\u542f\u670d\u52a1\u3001\u7ba1\u7406\u7528\u6237\u3001\u5f00\u9632\u706b\u5899\u7b49</li> <li>\u2022 \u81ea\u52a8\u5316\u90e8\u7f72 Web \u5e94\u7528\u3001\u5bb9\u5668\u3001\u4e91\u670d\u52a1\uff08AWS\u3001Azure\uff09</li> <li>\u2022 \u7f16\u6392\u8de8\u4e3b\u673a\u4efb\u52a1\uff08\u5982\u90e8\u7f72 Hadoop\u3001K8s\u3001Ceph\uff09</li> </ul>"},{"location":"2025/sre/2ansible/#ansible_4","title":"Ansible \u7684\u67b6\u6784","text":"<p>Ansible \u7ba1\u7406\u8282\u70b9\u8d1f\u8d23\u4e0b\u53d1\u4efb\u52a1\uff0c\u5305\u542b\u4ee5\u4e0b\u7ec4\u4ef6\uff1a</p> <ul> <li>\u2022 Ansible\uff1aAnsible-core\uff0cAnsible \u7684\u4e3b\u7a0b\u5e8f\uff0c\u5305\u542b Ansible \u76f8\u5173\u4e8c\u8fdb\u7a0b\u7a0b\u5e8f</li> <li>\u2022 Inventory\uff1a\u4e3b\u673a\u6e05\u5355\uff0c\u7528\u6765\u5b9a\u4e49\u88ab\u7ba1\u7406\u670d\u52a1\u5668\u7684\u6e05\u5355</li> <li>\u2022 Ad Hoc\uff1aAnsible \u7684\u547d\u4ee4\u884c\uff0c\u7528\u4e8e\u6267\u884c\u7b80\u5355\u7684\u4efb\u52a1\u6216\u505a\u8c03\u8bd5\u4f7f\u7528</li> <li>\u2022 Playbooks\uff1a\u5267\u672c\uff0c\u7528\u6765\u5b9a\u4e49\u590d\u6742\u7684\u81ea\u52a8\u5316\u4efb\u52a1</li> <li>\u2022 Core Modules\uff1aAnsible \u6838\u5fc3\u6a21\u5757\uff0c\u5305\u542b Ansible \u6700\u5e38\u7528\u7684\u6a21\u5757\uff08Ansible 2.9 \u4ee5\u524d\u4f1a\u5305\u542b\u5927\u91cf\u6a21\u5757\uff0c\u4f46\u5728 2.10 \u540e Ansible \u53ea\u4f1a\u5305\u542b\u5c11\u91cf\u7684\u6838\u5fc3\u6a21\u5757\uff09</li> <li>\u2022 Ansible Collections\uff1a\u6838\u5fc3\u6a21\u5757\u53ea\u80fd\u6ee1\u8db3\u57fa\u7840\u529f\u80fd\uff0c\u901a\u8fc7 Ansible Collections \u53ef\u4ee5\u5b89\u88c5\u65b0\u7684\u6a21\u5757\u6765\u6269\u5c55 Ansible \u7684\u529f\u80fd</li> <li>\u2022 Connection Plugins\uff1a \u8fde\u63a5\u63d2\u4ef6 \uff0c\u8fde\u63a5\u63d2\u4ef6\u5b9a\u4e49 Ansible \u8fde\u63a5\u5230\u8fdc\u7a0b\u4e3b\u673a\u7684\u65b9\u5f0f</li> </ul>"},{"location":"2025/sre/2ansible/#ansible_5","title":"Ansible \u7ba1\u7406\u4e3b\u673a\u7684\u6d41\u7a0b\uff1a","text":"<ol> <li>Ansible \u901a\u8fc7 Inventory \u6765\u5b9a\u4e49\u4e3b\u673a\u6e05\u5355</li> <li>\u901a\u8fc7 Playbooks \u6216 Ad Hoc \u6765\u5b9a\u4e49\u4efb\u52a1\uff08\u4efb\u52a1\u901a\u8fc7\u6a21\u5757\u6267\u884c\uff09\u548c\u8981\u6267\u884c\u4efb\u52a1\u7684\u4e3b\u673a</li> <li>\u901a\u8fc7\u8fde\u63a5\u63d2\u4ef6\uff0c\u5c06\u6a21\u5757\u63a8\u9001\u5230\u88ab\u63a7\u7aef</li> <li>\u5728\u88ab\u63a7\u7aef\u6267\u884c\u6a21\u5757\u7684\u4efb\u52a1\uff0c\u6267\u884c\u5b8c\u6210\u540e\u5220\u9664\u6a21\u5757</li> </ol> <p>Ansible \u7684\u5927\u90e8\u5206\u6a21\u5757\u90fd\u5177\u6709\u5e42\u7b49\u6027\uff0c\u591a\u6b21\u6267\u884c\u53ea\u4f1a\u4fee\u6539\u9700\u8981\u6539\u7684\u5185\u5bb9\u3002\u4f46\u90e8\u5206\u6a21\u5757\u9664\u5916\uff0c\u5982 raw\u3001command \u548c shell \u6a21\u5757\u3002</p> <p>Ansible \u7684\u7ba1\u7406\u8282\u70b9\u53ea\u80fd\u662f Linux \u7cfb\u7edf</p> <p></p> <p>Ansible \u4f1a\u4f7f\u7528\u88ab\u63a7\u8282\u70b9\u6709\u7684\u8fde\u63a5\u65b9\u5f0f\u6765\u7ba1\u7406\u88ab\u63a7\u8282\u70b9\uff0c\u5982\u901a\u8fc7 SSH \u7ba1\u7406 Linux\uff0c\u56e0\u6b64 Ansible \u662f\u65e0\u4ee3\u7406\u7684\uff0c\u4e0d\u9700\u8981\u5728\u88ab\u63a7\u8282\u70b9\u5b89\u88c5 Agent</p> <ul> <li>\u2022 <code>ANSIBLE_CONFIG</code> \u7684\u73af\u5883\u53d8\u91cf</li> <li>\u2022 \u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e0b\u7684 <code>ansible.cfg</code></li> <li>\u2022 \u5f53\u524d\u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u7684 <code>.ansible.cfg</code> \u9690\u85cf\u6587\u4ef6</li> <li>\u2022 \u5168\u5c40\u9ed8\u8ba4\u7684\u914d\u7f6e\u6587\u4ef6 <code>`/etc/ansible/ansible.cfg</code></li> </ul>"},{"location":"2025/sre/2ansible/#ansible_6","title":"Ansible \u5b89\u88c5","text":"<p>Ansible \u6709\u4e09\u79cd\u5b89\u88c5\u65b9\u5f0f\uff0c\u6e90\u7801\u5b89\u88c5\u3001\u53d1\u884c\u7248\u5b89\u88c5\u548c Python \u5b89\u88c5\u3002</p> <p>\u4f7f\u7528\u53d1\u884c\u7248\u5b89\u88c5\u6216 Python \u5b89\u88c5\u4e24\u79cd\u65b9\u5f0f\u65f6\uff0cAnsible \u7684\u5b89\u88c5\u5305\u6709\u4e24\u4e2a\uff0c\u533a\u522b\u5982\u4e0b\uff1a</p> <ul> <li>\u2022 ansible-core\uff1a\u4e00\u79cd\u6781\u7b80\u8bed\u8a00\u548c\u8fd0\u884c\u65f6\u5305\uff0c\u5305\u542b\u4e00\u7ec4\u5185\u7f6e\u6a21\u5757\u548c\u63d2\u4ef6\u3002</li> <li>\u2022 ansible\uff1a\u4e00\u4e2a\u66f4\u5927\u7684\u201c\u5305\u542b\u7535\u6c60\u201d\u7684\u8f6f\u4ef6\u5305\uff0c\u5b83\u6dfb\u52a0\u4e86\u793e\u533a\u7cbe\u9009\u7684 Ansible \u96c6\u5408\u9009\u62e9\uff0c\u7528\u4e8e\u81ea\u52a8\u5316\u5404\u79cd\u8bbe\u5907\u3002</li> </ul> <p>\u5728\u7528\u6e90\u7801\u6216\u8005 Python \u5b89\u88c5 Ansible \u65f6\uff0c\u9ed8\u8ba4\u4e0d\u4f1a\u5b89\u88c5 sshpass \u8f6f\u4ef6\u5305\uff0c\u8be5\u8f6f\u4ef6\u5305\u7528\u6765\u7ed9 Ansible \u63d0\u4f9b\u5bc6\u7801\u9a8c\u8bc1\u88ab\u63a7\u7aef\uff0c\u56e0\u6b64\u5982\u679c\u5728\u6267\u884c Ansible \u7684\u547d\u4ee4\u65f6\u9700\u8981\u8f93\u5165 ssh \u7684\u5bc6\u7801\uff0c\u5219\u9700\u8981\u8be5\u8f6f\u4ef6\u5305\uff0c\u8be5\u8f6f\u4ef6\u5305\u901a\u8fc7 <code>dnf install -y sshpass</code>\u3002</p> <pre><code>[root@ansible ansible]# ansible servera -m ping\nservera | FAILED! =&gt; {\n \"msg\": \"to use the 'ssh' connection type with passwords or pkcs11_provider, you must install the sshpass program\"\n}\n</code></pre> <pre><code>[root@ansible ~]# dnf install python3.12 python3.12-pip sshpass\n[root@ansible ~]# tar xf ansible-2.16.3.tar.gz\n[root@ansible ~]# cd ansible-2.16.3/\n[root@ansible ansible-2.16.3]# python3 -m pip install -r ./requirements.txt\n[root@ansible ansible-2.16.3]# python3 setup.py install\n</code></pre> <p>\u6e90\u7801\u5b89\u88c5\u53ea\u80fd\u5b89\u88c5 Ansible-core\u3002</p> <pre><code>[root@ansible ~]# dnf install -y epel-release\n\n# \u5b89\u88c5\u6700\u7b80\u6d01\u7684 Ansible\n[root@ansible ~]# dnf install ansible-core\n\n\n# \u5b89\u88c5\u5305\u542b\u5e38\u7528\u6a21\u5757\u7684 Ansible\n[root@ansible ~]# dnf install ansible\n</code></pre> <p>Python \u5b89\u88c5</p> <pre><code># \u5b89\u88c5 Python3 \u548c pip\n[root@ansible ~]# dnf install python3.12 python3.12-pip sshpass\n\n# \u5b89\u88c5 Ansible-core\n[root@ansible ~]# python3.12 -m pip install ansible-core==2.16.3\n\n# \u5b89\u88c5 Ansible\n[root@ansible ~]# python3.12 -m pip install ansible\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible_7","title":"\u8bbe\u7f6e Ansible \u53c2\u6570\u81ea\u52a8\u8865\u5168","text":"<pre><code>[root@ansible ~]# python3 -m pip install argcomplete\n[root@ansible ~]# activate-global-python-argcomplete --user\n</code></pre> <p>\u91cd\u65b0\u767b\u5f55\u547d\u4ee4\u884c\u52a0\u8f7d\u4e00\u4e0b\u73af\u5883\u53d8\u91cf\u5c31\u53ef\u4ee5\u770b\u5230\u81ea\u52a8\u8865\u5168\u4e86\u3002</p>"},{"location":"2025/sre/2ansible/#ansible_8","title":"\u5feb\u901f\u914d\u7f6e\u5e76\u4f7f\u7528 Ansible","text":"<p>\u6709\u4e00\u4e2a\u88ab\u63a7\u8282\u70b9\uff0c\u5730\u5740\u4e3a 192.168.221.131\uff0c\u4e3b\u673a\u540d\u4e3a servera\u3002</p> <pre><code>[root@ansible ~]# mkdir ansible\n[root@ansible ~]# cd ansible\n[root@ansible ansible]# sed -i 's/;inventory=.*/inventory\\ =\\ .\\/inventory/' ansible.cfg\n[root@ansible ansible]# cat &lt;&lt;-EOF &gt; ansible.cfg\n[defaults]\ninventory      = ./inventory\nask_pass       = false\nremote_user    =  root\nlog_path       = /var/log/ansible.log\nhost_key_checking = False\n[privilege_escalation]\nbecome = True\nbecome_method = sudo\nbecome_user = root\nbecome_ask_pass = False\n[ssh_connection]\nssh_args = -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no\nEOF\n\n[root@ansible ansible]# echo servera &gt; inventory\n\n[root@ansible ansible]# tail -n1 /etc/hosts\n192.168.221.131 servera\n\n# \u901a\u8fc7 ping \u6a21\u5757\u6d4b\u8bd5\u7f51\u7edc\u8fde\u901a\u6027\n[root@ansible ansible]# ansible all -k -m ping\nSSH password:\nservera | SUCCESS =&gt; {\n    \"ansible_facts\": {\n        \"discovered_interpreter_python\": \"/usr/libexec/platform-python\"\n    },\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\n\n</code></pre>"},{"location":"2025/sre/2ansible/#3-ansible","title":"3 Ansible \u914d\u7f6e\u6587\u4ef6","text":""},{"location":"2025/sre/2ansible/#ansible_9","title":"Ansible\u914d\u7f6e\u6587\u4ef6","text":"<pre><code>[root@ansible ansible]# ansible --version\nansible [core 2.16.3]\n  config file = /root/ansible/ansible.cfg\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /usr/local/lib/python3.12/site-packages/ansible_core-2.16.3-py3.12.egg/ansible\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\n  executable location = /usr/local/bin/ansible\n  python version = 3.12.8 (main, Dec 12 2024, 16:30:29) [GCC 8.5.0 20210514 (Red Hat 8.5.0-22)] (/usr/bin/python3)\n  jinja version = 3.1.6\n  libyaml = True\n</code></pre>"},{"location":"2025/sre/2ansible/#_1","title":"\u6587\u4ef6\u4f4d\u7f6e\u548c\u4f18\u5148\u7ea7","text":"<p>Ansible \u7684\u914d\u7f6e\u6587\u4ef6\u5728\u56db\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u51fa\u73b0\uff1a</p> <ul> <li>\u2022 <code>ANSIBLE_CONFIG</code> \u7684\u73af\u5883\u53d8\u91cf</li> <li>\u2022 \u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e0b\u7684 <code>ansible.cfg</code></li> <li>\u2022 \u5f53\u524d\u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u7684 <code>.ansible.cfg</code> \u9690\u85cf\u6587\u4ef6</li> <li>\u2022 \u5168\u5c40\u9ed8\u8ba4\u7684\u914d\u7f6e\u6587\u4ef6 <code>/etc/ansible/ansible.cfg</code></li> </ul> <p>\u4f18\u5148\u7ea7\u7531\u9ad8\u5230\u4f4e\uff1a\u73af\u5883\u53d8\u91cf \u2192 \u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 \u2192 \u5bb6\u76ee\u5f55 \u2192 /etc</p> <p>\u6240\u4ee5\u6267\u884c Ansible \u6307\u4ee4\u65f6\uff0c\u5148\u4ece\u73af\u5883\u53d8\u91cf\u4e2d\u627e\u914d\u7f6e\u6587\u4ef6\uff0c\u5982\u679c\u73af\u5883\u53d8\u91cf\u6ca1\u6709\uff0c\u5c31\u5230\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e0b\u627e\u914d\u7f6e\u6587\u4ef6\uff0c\u5982\u679c\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4f9d\u7136\u6ca1\u6709\uff0c\u5c31\u5230\u5f53\u524d\u7528\u6237\u7684\u5bb6\u76ee\u5f55\u4e0b\u627e\u914d\u7f6e\u6587\u4ef6\uff0c\u5982\u679c\u5f53\u524d\u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u8fd8\u6ca1\u6709\uff0c\u5c31\u53bb\u627e <code>/etc/ansible/ansible.cfg</code>\u3002</p> <p>\u63a8\u8350\u7684 ansible.cfg \u7ba1\u7406\u65b9\u5f0f\uff1a</p> <p>\u4f18\u5148\u7ea7\u4ece\u9ad8\u5230\u4f4e\u5982\u4e0b\uff1a</p> <ol> <li>\u5f53\u524d\u76ee\u5f55\u7684 <code>./ansible.cfg</code></li> <li>\u73af\u5883\u53d8\u91cf <code>ANSIBLE_CONFIG</code> \u6307\u5b9a\u7684\u8def\u5f84</li> <li>\u7528\u6237\u76ee\u5f55\u4e0b\u7684 <code>`~/.ansible.cfg</code></li> <li>\u7cfb\u7edf\u8def\u5f84 <code>/etc/ansible/ansible.cfg</code></li> </ol> <p>\u751f\u6210\u4e00\u4e2a\u9ed8\u8ba4\u7684\u914d\u7f6e\u6587\u4ef6</p> <pre><code>[root@ansible ansible]# ansible-config init --disabled &gt; ansible.cfg\n\n</code></pre> <p>\u6587\u4ef6\u5185\u5bb9</p> <pre><code>[root@ansible ansible]# grep -E '^\\[' ansible.cfg\n[defaults]\n[privilege_escalation]\n[persistent_connection]\n[connection]\n[colors]\n[selinux]\n[diff]\n[galaxy]\n[inventory]\n[netconf_connection]\n[paramiko_connection]\n[jinja2]\n[tags]\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible_10","title":"Ansible \u914d\u7f6e\u6bb5\u8bf4\u660e","text":"<pre><code>[defaults]  \n\u9ed8\u8ba4\u8bbe\u7f6e\n\u4e3b\u8981\u914d\u7f6e Ansible \u7684\u57fa\u7840\u884c\u4e3a\uff0c\u6bd4\u5982 inventory, remote_user, timeout, roles_path \u7b49\n\n\n[privilege_escalation]  \n\u63d0\u6743\u63a7\u5236\n\u63a7\u5236 become, become_user, become_method \u7b49\u63d0\u6743\u884c\u4e3a\uff08\u5982 sudo\uff09\n\n[persistent_connection] \n\u6301\u4e45\u8fde\u63a5\u53c2\u6570\n\u63a7\u5236\u8fde\u63a5\u63d2\u4ef6\u5982 SSH \u7684\u6301\u4e45\u5316\uff08\u53ef\u51cf\u5c11\u8fde\u63a5\u5f00\u9500\uff09\n\n[persistent_connection] \n\u6301\u4e45\u8fde\u63a5\u53c2\u6570\n\u63a7\u5236\u8fde\u63a5\u63d2\u4ef6\u5982 SSH \u7684\u6301\u4e45\u5316\uff08\u53ef\u51cf\u5c11\u8fde\u63a5\u5f00\u9500\uff09\n\n[connection]    \n\u901a\u7528\u8fde\u63a5\u914d\u7f6e\n\u5305\u62ec\u8fdc\u7a0b\u8fde\u63a5\u7684\u8d85\u65f6\u3001\u91cd\u8bd5\u3001\u7f13\u5b58\u63a7\u5236\u7b49\n\n[selinux]   \nSELinux \u8bbe\u7f6e\n\u662f\u5426\u81ea\u52a8\u7ba1\u7406 semanage\u3001\u6807\u7b7e\u6062\u590d\u7b49\uff08\u5bf9\u542f\u7528 SELinux \u7684\u4e3b\u673a\u6709\u7528\uff09\n\n[diff]  \n\u663e\u793a\u5dee\u5f02\u8bbe\u7f6e\n\u63a7\u5236\u662f\u5426\u5f00\u542f diff \u6a21\u5f0f\uff0c\u80fd\u5728\u4fee\u6539\u914d\u7f6e\u65f6\u663e\u793a\u5dee\u5f02\n\n[galaxy]    \nAnsible Galaxy \u8bbe\u7f6e\n\u8bbe\u7f6e Galaxy \u6e90\u3001\u7f13\u5b58\u7b56\u7565\u3001\u89d2\u8272\u4e0b\u8f7d\u7b49\n\n[diff]  \n\u663e\u793a\u5dee\u5f02\u8bbe\u7f6e\n\u63a7\u5236\u662f\u5426\u5f00\u542f diff \u6a21\u5f0f\uff0c\u80fd\u5728\u4fee\u6539\u914d\u7f6e\u65f6\u663e\u793a\u5dee\u5f02\n\n[galaxy]    \nAnsible Galaxy \u8bbe\u7f6e\n\u8bbe\u7f6e Galaxy \u6e90\u3001\u7f13\u5b58\u7b56\u7565\u3001\u89d2\u8272\u4e0b\u8f7d\u7b49\n\n[inventory] \n\u52a8\u6001\u5e93\u5b58\u53c2\u6570\n\u9488\u5bf9 Inventory \u63d2\u4ef6\u7684\u9ed8\u8ba4\u8bbe\u7f6e\uff0c\u6bd4\u5982\u7f13\u5b58\u3001\u8def\u5f84\u7b49\n\n[netconf_connection]    \nNetconf \u8fde\u63a5\u53c2\u6570\n\u9488\u5bf9\u652f\u6301 NETCONF \u7684\u7f51\u7edc\u8bbe\u5907\uff08\u5982 Cisco\u3001Juniper\uff09\u8fde\u63a5\u8bbe\u7f6e\n\n\n[paramiko_connection]   \n\u4f7f\u7528 paramiko \u65f6\u7684\u8bbe\u7f6e\n\u4f7f\u7528 paramiko\uff08Python SSH \u5e93\uff09\u66ff\u4ee3 OpenSSH \u65f6\u7684\u884c\u4e3a\u63a7\u5236\n\n[jinja2]    \n\u6a21\u677f\u6e32\u67d3\u8bbe\u7f6e\n\u63a7\u5236\u6a21\u677f\u53d8\u91cf\u3001\u672a\u5b9a\u4e49\u53d8\u91cf\u884c\u4e3a\u3001Jinja \u73af\u5883\u7b49\n\n\n[tags]  \ntag \u884c\u4e3a\n\u63a7\u5236\u8fd0\u884c playbook \u65f6\u5173\u4e8e tag \u7684\u5339\u914d\u65b9\u5f0f\n</code></pre>"},{"location":"2025/sre/2ansible/#_2","title":"\u5e38\u7528\u914d\u7f6e\u9009\u9879","text":"<p>[defaults] \u5e38\u7528\u914d\u7f6e\uff1a</p> <pre><code>inventory   \n\u6307\u5b9a\u4e3b\u673a\u6e05\u5355\u8def\u5f84\ninventory = ./hosts\n\n\nremote_user \n\u9ed8\u8ba4\u8fdc\u7a0b\u767b\u5f55\u7528\u6237\nremote_user = ansible\n\n\nask_pass    \n\u662f\u5426\u5728\u6267\u884c\u65f6\u8be2\u95ee SSH \u5bc6\u7801\nask_pass = false\n\nask_become_pass \n\u662f\u5426\u8be2\u95ee sudo \u5bc6\u7801\nask_become_pass = true\n\nprivate_key_file    \n\u6307\u5b9a\u79c1\u94a5\u8def\u5f84\nprivate_key_file = ~/.ssh/id_rsa\n\nhost_key_checking   \n\u662f\u5426\u542f\u7528 SSH \u4e3b\u673a\u5bc6\u94a5\u68c0\u67e5\nhost_key_checking = false\n\ntimeout \n\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09\ntimeout = 30\n\nforks   \n\u5e76\u53d1\u6267\u884c\u4e3b\u673a\u6570\nforks = 10\n\nretry_files_enabled \n\u662f\u5426\u751f\u6210 .retry \u6587\u4ef6\nretry_files_enabled = false\n\n\nlog_path    \n\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\nlog_path = /var/log/ansible.log\n\n\nroles_path  \n\u6307\u5b9a\u89d2\u8272\u76ee\u5f55\nroles_path = ./roles\n\n\ngathering   \n\u63a7\u5236 facts \u7684\u6536\u96c6\u65b9\u5f0f\uff08implicit\u3001explicit\u3001smart\uff09\ngathering = smart\n\n\nfact_caching    \n\u662f\u5426\u542f\u7528 facts \u7f13\u5b58\nfact_caching = jsonfile\n\n\nfact_caching_connection \nfacts \u7f13\u5b58\u8def\u5f84\nfact_caching_connection = ./fact_cache\n</code></pre>"},{"location":"2025/sre/2ansible/#privilege_escalation","title":"<code>[privilege_escalation]</code>\u63d0\u6743\u914d\u7f6e\uff1a","text":"<pre><code>become  \n\u662f\u5426\u542f\u7528\u63d0\u6743\nbecome = true\n\n\nbecome_method   \n\u4f7f\u7528\u63d0\u6743\u65b9\u5f0f\uff08sudo/su/pbrun/doas \u7b49\uff09\nbecome_method = sudo\n\nbecome_user \n\u63d0\u6743\u540e\u7684\u76ee\u6807\u7528\u6237\nbecome_user = root\n\nbecome_ask_pass \n\u662f\u5426\u8be2\u95ee\u63d0\u6743\u5bc6\u7801\nbecome_ask_pass = false\n</code></pre>"},{"location":"2025/sre/2ansible/#ssh_connection-connection","title":"[<code>ssh_connection</code>]\uff08\u6216 [connection]\uff09\u8fde\u63a5\u4f18\u5316\u914d\u7f6e\uff1a","text":"<pre><code>pipelining  \n\u542f\u7528 SSH pipelining\uff0c\u52a0\u901f\u6267\u884c\npipelining = true\n\ncontrol_path    \nSSH \u63a7\u5236\u8fde\u63a5\u7684 socket \u8def\u5f84\ncontrol_path = %(directory)s/%%h-%%r\n\nssh_args    \n\u4f20\u9012\u7ed9 SSH \u7684\u53c2\u6570\nssh_args = -o ControlMaster=auto -o ControlPersist=60s\n\nretries \nSSH \u5931\u8d25\u91cd\u8bd5\u6b21\u6570\nretries = 3\n</code></pre>"},{"location":"2025/sre/2ansible/#jinja2","title":"[jinja2] \u6a21\u677f\u6e32\u67d3\u76f8\u5173\uff1a","text":"<pre><code>undefined   \n\u63a7\u5236\u672a\u5b9a\u4e49\u53d8\u91cf\u7684\u5904\u7406\u65b9\u5f0f\uff08\u5982 strict\uff09\nundefined = strict\n\ntrim_blocks \n\u53bb\u9664 Jinja2 \u6a21\u677f\u4e2d\u7684\u7a7a\u884c\ntrim_blocks = true\n\nlstrip_blocks   \n\u53bb\u9664 Jinja2 \u5de6\u4fa7\u7a7a\u683c\nlstrip_blocks = true\n</code></pre>"},{"location":"2025/sre/2ansible/#diff","title":"[diff] \u5dee\u5f02\u663e\u793a\uff1a","text":"<pre><code>always  \n\u662f\u5426\u59cb\u7ec8\u663e\u793a\u53d8\u66f4 diff\nalways = true\n\ncontext \n\u663e\u793a\u4e0a\u4e0b\u6587\u884c\u6570\ncontext = 5\n</code></pre>"},{"location":"2025/sre/2ansible/#galaxy-ansible-galaxy","title":"[galaxy] Ansible Galaxy \u8bbe\u7f6e\uff1a","text":"<pre><code>server_list \n\u6307\u5b9a Galaxy \u670d\u52a1\u5668\nserver_list = ansible_galaxy\n\nignore_certs    \n\u5ffd\u7565 Galaxy HTTPS \u8bc1\u4e66\u9a8c\u8bc1\nignore_certs = false\n</code></pre>"},{"location":"2025/sre/2ansible/#inventory","title":"[inventory] \u4e3b\u673a\u6e05\u5355\u8bbe\u7f6e\uff08\u52a8\u6001\u5e93\u5b58\uff09\uff1a","text":"<pre><code>enable_plugins  \n\u542f\u7528\u7684\u5e93\u5b58\u63d2\u4ef6\nenable_plugins = host_list, yaml, ini\n\nache    \n\u542f\u7528\u4e3b\u673a\u7f13\u5b58\ncache = true\n\ncache_plugin    \n\u4f7f\u7528\u7684\u7f13\u5b58\u63d2\u4ef6\ncache_plugin = jsonfile\n\ncache_timeout   \n\u7f13\u5b58\u6709\u6548\u65f6\u95f4\ncache_timeout = 600\n</code></pre>"},{"location":"2025/sre/2ansible/#_3","title":"\u5176\u4ed6\u914d\u7f6e\u6bb5\uff08\u53ef\u9009\uff09\uff1a","text":"<pre><code>[paramiko_connection]   \n\u5982\u679c\u4f7f\u7528 paramiko \u4f5c\u4e3a SSH \u8fde\u63a5\u540e\u7aef\uff0c\u914d\u7f6e\u8fde\u63a5\u884c\u4e3a\n\n[netconf_connection]    \n\u7ba1\u7406 NETCONF \u7f51\u7edc\u8bbe\u5907\u7684\u8fde\u63a5\u53c2\u6570\n\n[colors]    \n\u63a7\u5236\u7ec8\u7aef\u8f93\u51fa\u989c\u8272\u6837\u5f0f\n\n[selinux]   \n\u914d\u7f6e\u5982\u4f55\u5904\u7406 SELinux \u6807\u7b7e\u4fee\u590d\n\n[tags]  \n\u63a7\u5236 tag \u5339\u914d\u884c\u4e3a\uff0c\u6bd4\u5982 skip_tags \u9ed8\u8ba4\u503c\u7b49\n</code></pre>"},{"location":"2025/sre/2ansible/#_4","title":"\u914d\u7f6e\u6848\u4f8b","text":"<pre><code>[defaults]  \ninventory      = ./inventory    # \u4e3b\u673a\u6e05\u5355\u7684\u4f4d\u7f6e\nfork           = 20                # \u5e76\u53d1\u6267\u884c\u7684\u4e3b\u673a\u6570\nask_pass       = False            # \u6267\u884c Ansible \u65f6\u662f\u5426\u8be2\u95ee\u5bc6\u7801\nremote_user    =  root            # \u8868\u793a\u4f7f\u7528 root \u7528\u6237\u6765\u8bbf\u95ee\u88ab\u63a7\u8282\u70b9\nlog_path       = /var/log/ansible.log    # \u6307\u5b9a Ansible \u7684\u65e5\u5fd7\u6587\u4ef6\u4f4d\u7f6e\nhost_key_checking = False                # \u662f\u5426\u8fdb\u884c SSH \u4e3b\u673a Key \u68c0\u67e5\nansible_python_interpreter = /usr/bin/python3.9        # \u6307\u5b9a\u88ab\u63a7\u7aef\u4e0a Python \u7684\u89e3\u91ca\u5668\n[privilege_escalation]\nbecome = True    # \u662f\u5426\u63d0\u6743\nbecome_method = sudo    # \u63d0\u6743\u7684\u65b9\u5f0f\nbecome_user = root        # \u63d0\u6743\u5230\u54ea\u4e2a\u7528\u6237\nbecome_ask_pass = False    # \u6267\u884c Ansible \u65f6\u662f\u5426\u8be2\u95ee\u63d0\u6743\u5bc6\u7801\n</code></pre>"},{"location":"2025/sre/2ansible/#4-ansible","title":"4 Ansible \u4e3b\u673a\u6e05\u5355","text":""},{"location":"2025/sre/2ansible/#ansible_11","title":"Ansible \u4e3b\u673a\u6e05\u5355","text":"<p>\u4e3b\u673a\u6e05\u5355\u7528\u6765\u5b9a\u4e49\u54ea\u4e9b\u4e3b\u673a\u5728 Ansible \u7684\u7ba1\u7406\u8303\u56f4\u3002\u4e3b\u673a\u6e05\u5355\u652f\u6301\u4ee5\u4e0b\u5199\u6cd5\uff1a</p> <ul> <li>\u2022 IP \u5730\u5740</li> <li>\u2022 \u4e3b\u673a\u540d</li> <li>\u2022 \u8303\u56f4\uff08<code>server[b:c]</code>\uff09</li> <li>\u2022 \u4e3b\u673a\u7ec4\uff08webserver\uff09</li> <li>\u2022 \u7ec4\u7684\u5b50\u7ec4\uff08lnmp:children\uff09</li> </ul>"},{"location":"2025/sre/2ansible/#_5","title":"\u4e3b\u673a\u6e05\u5355","text":"<pre><code>172.25.250.10\n\n[webserver]\nserver[b:c]\n\n[mysql]\n172.25.250.1[3:4]\n\n[lnmp:children]\nwebserver\nmysql\n</code></pre> <p>\u2022 \u76f4\u63a5\u5b9a\u4e49\u4e3b\u673a\u540d\u6216\u5730\u5740\uff0c\u5f53\u524d 172.25.250.10 \u4e0d\u5c5e\u4e8e\u4efb\u4f55\u7ec4\u3002</p> <pre><code>172.25.250.10\n</code></pre> <p>\u2022 \u5b9a\u4e49\u4e3b\u673a\u7ec4\uff0cwebserver \u4e3b\u673a\u7ec4\u5305\u542b serverb \u5230 serverc</p> <pre><code>[webserver]\nserver[b:c]\n</code></pre> <p>\u2022 \u7ec4\u548c\u7ec4\u4e4b\u95f4\u53ef\u4ee5\u5d4c\u5957</p> <pre><code>[lnmp:children]\nwebserver\nmysql\n</code></pre> <p>\u2022 \u4f7f\u7528\u8303\u56f4\u6765\u5339\u914d\u4e3b\u673a</p> <pre><code>server[b:c]\n172.25.250.1[3:4]\n</code></pre>"},{"location":"2025/sre/2ansible/#_6","title":"\u9009\u62e9\u4e3b\u673a\u548c\u4e3b\u673a\u7ec4","text":"<p>\u5339\u914d\u6240\u6709\u4e3b\u673a</p> <pre><code>**ansible all --list-hosts\n  hosts (5):\n    172.25.250.10\n    serverb\n    serverc\n    172.25.250.13\n    172.25.250.14**\n</code></pre> <p>\u5339\u914d\u6307\u5b9a\u7684\u4e3b\u673a\u6216\u4e3b\u673a\u7ec4</p> <pre><code>ansible serverc --list-hosts\n  hosts (1):\n    serverc\n\nansible lnmp --list-hosts\n  hosts (4):\n    serverb\n    serverc\n    172.25.250.13\n    172.25.250.14\n\n</code></pre> <p>\u5339\u914d\u591a\u4e2a\u4e3b\u673a\u548c\u4e3b\u673a\u7ec4</p> <pre><code>ansible serverb,serverc --list-hosts\n  hosts (2):\n    serverb\n    serverc\n\nansible webserver,mysql --list-hosts\n  hosts (4):\n    serverb\n    serverc\n    172.25.250.13\n    172.25.250.14\n</code></pre> <p>\u5339\u914d\u6ca1\u6709\u7ec4\u7684\u4e3b\u673a</p> <pre><code>ansible server* --list-hosts\n  hosts (2):\n    serverb\n    serverc\n\nansible *25.* --list-hosts\n  hosts (3):\n    172.25.250.10\n    172.25.250.13\n    172.25.250.14\n</code></pre> <p>\u901a\u914d\u7b26\u903b\u8f91\u7ec4\u5408</p> <ul> <li>\u2022 `&amp;``\uff1a\u53d6\u4ea4\u96c6</li> <li>\u2022 `!``\uff1a\u53bb\u53cd</li> <li>\u2022 `\uff0c``\uff1a\u53d6\u5e76\u96c6</li> </ul> <pre><code># \u5339\u914d\u6240\u6709\u4ee5server\u5f00\u5934\u7684\u4e3b\u673a\uff0c\u6392\u9664serverc\nansible 'server*,!serverc' --list-hosts\n  hosts (1):\n    serverb\n\n# \u5339\u914d\u7ec4webserver\u548c\u7ec4lnmp\u4e24\u4e2a\u7ec4\u5185\u76f8\u540c\u7684\u4e3b\u673a\nansible 'webserver,&amp;lnmp' --list-hosts\n  hosts (2):\n    serverb\n    serverc\n\n# \u5728\u4e0a\u4e00\u4e2a\u4f8b\u5b50\u5728\u6392\u9664serverc\nansible 'webserver,&amp;lnmp,!serverc' --list-hosts\n  hosts (1):\n    serverb\n</code></pre> <p>\u4f7f\u7528\u6b63\u5219\u5339\u914d</p> <pre><code># '~'\u540e\u63a5\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u4e0b\u8fb9\u4f8b\u5b50\u8868\u793a\u5339\u914d\u4ee5se\u5f00\u5934\u7684\u4e3b\u673a\nansible '~^se' --list-hosts\n  hosts (2):\n    serverb\n    serverc\n</code></pre> <p>\u901a\u8fc7limit\u5339\u914d\u4e3b\u673a</p> <pre><code>ansible all --limit serverb,172.25.250.13 --list-hosts\n  hosts (2):\n    serverb\n    172.25.250.13\n\n# \u4f7f\u7528\u6587\u4ef6\u5339\u914d\ncat &lt;&lt;EOF &gt; ip.txt\nserverb\nserverc\n172.25.250.14\nEOF\n\nansible all --limit @/home/student/ansible/ip.txt --list-hosts\n  hosts (3):\n    serverb\n    serverc\n    172.25.250.14\n</code></pre>"},{"location":"2025/sre/2ansible/#localhost","title":"\u7279\u6b8a\u7684\u4e3b\u673a localhost","text":"<p>\u6700\u540e\u8bf4\u4e00\u4e2a\u7279\u6b8a\u7684\u4e3b\u673a localhost\uff0c\u8fd9\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u4e3b\u673a\uff0c\u5b83\u4e0d\u9700\u8981\u5728\u4e3b\u673a\u6e05\u5355\u91cc\u58f0\u660e\u5c31\u53ef\u4ee5\u4f7f\u7528\u3002</p> <p>localhost \u8868\u793a\u672c\u5730\u4e3b\u673a\uff0c\u672a\u5728\u4e3b\u673a\u6e05\u5355\u4e2d\u58f0\u660e\u65f6\uff0cAnsible \u4f1a\u4f7f\u7528 local \u65b9\u5f0f\u8fde\u63a5\uff0c\u76f8\u5f53\u4e8e\u5728\u672c\u5730\u6267\u884c\u547d\u4ee4\uff0c\u4ee5\u4e0b\u662f\u5b83\u548c SSH \u8fde\u63a5\u7684\u533a\u522b\uff1a</p> <pre><code>\u9879\u76ee  local. ssh\n\u6267\u884c\u4f4d\u7f6e. \u63a7\u5236\u8282\u70b9\u672c\u5730\u6267\u884c. \u8fdc\u7a0b\u901a\u8fc7 ssh \u6267\u884c\n\u662f\u5426\u8d70\u7f51\u7edc. \u5426. \u662f\n\u6743\u9650\u63a7\u5236. \u5f53\u524d\u7528\u6237. \u53ef\u6307\u5b9a\u8fdc\u7a0b\u7528\u6237\n\u5e38\u89c1\u7528\u9014. \u63a7\u5236\u8282\u70b9\u914d\u7f6e\u3001\u672c\u5730\u8c03\u8bd5. \u6b63\u5f0f\u73af\u5883\u3001\u7ba1\u7406\u591a\u53f0\u4e3b\u673a\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7\u5728\u4e3b\u673a\u6e05\u5355\u5185\u660e\u786e\u6307\u5b9a localhost \u6765\u8bbe\u7f6e\u8fde\u63a5\u65b9\u5f0f\u4e3a ssh\u3002</p> <p>local \u548c ssh \u8fde\u63a5\u6709\u4e2a\u6700\u5927\u7684\u533a\u522b\u5c31\u662f local \u4f1a\u5ffd\u7565 <code>remote_user</code>\u9009\u9879\uff0c\u53ef\u4ee5\u770b\u4ee5\u4e0b\u4f8b\u5b50\uff1a</p> <pre><code># \u914d\u7f6e\u6587\u4ef6\n[test@awx-1 ansible]$ cat ansible.cfg\n[defaults]\ninventory      = ./inventory\nfork          = 20\nask_pass       = False\nremote_user    =  remote-manager\nhost_key_checking = False\nansible_python_interpreter = /usr/bin/python3.9\n[privilege_escalation]\nbecome = True\nbecome_method = sudo\nbecome_user = root\nbecome_ask_pass = False\n\n\n# \u5f53\u524d\u7528\u6237\n[test@awx-1 ansible]$ id\nuid=1000(test) gid=1000(test) groups=1000(test) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\n\n# \u67e5\u770b\u4e3b\u673a\u6e05\u5355\uff0c\u5f53\u524d localhost \u5df2\u88ab\u6ce8\u91ca\n[test@awx-1 ansible]$ cat inventory\n#localhost ansible_ssh_password=redhat\n\n# \u6d4b\u8bd5\n[test@awx-1 ansible]$ ansible localhost -b -m command -a 'id'\nlocalhost | CHANGED | rc=0 &gt;&gt;\nuid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\n# \u53ef\u4ee5\u770b\u5230\u53ef\u4ee5\u6267\u884c\u6210\u529f\n\n# \u5220\u9664\u4e3b\u673a\u6e05\u5355\u7684\u6ce8\u91ca\n[test@awx-1 ansible]$ cat inventory\nlocalhost ansible_ssh_password=redhat\n\n# \u518d\u6b21\u6d4b\u8bd5\n[test@awx-1 ansible]$ ansible localhost -b -m command -a 'id'\nlocalhost | UNREACHABLE! =&gt; {\n    \"changed\": false,\n    \"msg\": \"Failed to connect to the host via ssh: remote-manager@localhost: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password,keyboard-interactive).\",\n    \"unreachable\": true\n}\n# \u53ef\u4ee5\u770b\u5230\u62a5\u9519\u4e86\uff0c\u56e0\u4e3a test \u4e0d\u80fd\u76f4\u63a5 ssh remote-manager \u7528\u6237\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 local \u65b9\u5f0f\u4f1a\u5ffd\u7565 remote_user \u9009\u9879\uff0c\u800c ssh \u4e0d\u4f1a\u5ffd\u7565\u3002</p>"},{"location":"2025/sre/2ansible/#5-ansible","title":"5 Ansible \u5e38\u7528\u547d\u4ee4","text":"<p>Ansible \u6709\u591a\u4e2a\u547d\u4ee4\uff0c\u4e0d\u540c\u547d\u4ee4\u6709\u4e0d\u540c\u7684\u529f\u80fd\uff0c\u4ee5\u4e0b\u5217\u51fa\u4e00\u4e9b\u5e38\u7528\u7684\u547d\u4ee4\u548c\u5e38\u7528\u53c2\u6570\u3002</p>"},{"location":"2025/sre/2ansible/#_7","title":"\u5e38\u7528\u547d\u4ee4","text":"<pre><code># \u8bbe\u7f6e ansible \u7684\u914d\u7f6e\u6587\u4ef6\nansible-config\n\n# \u67e5\u770b ansible \u76f8\u5173\u6a21\u5757\u548c\u6a21\u5757\u6587\u6863\nansible-doc\n\n# \u67e5\u770b ansible \u7684\u4e3b\u673a\u6e05\u5355\nansible-inventory\n\n# \u6267\u884c\u4e34\u65f6\u4efb\u52a1\nansible\n\n# \u6267\u884c ansible \u7684 playbook\nansible-playbook\n\n# \u8bbe\u7f6e ansible \u7684\u89d2\u8272\nansible-galaxy\n\n# ansible \u76f8\u5173\u6587\u4ef6\u52a0\u5bc6\u6216\u89e3\u5bc6\nansible-vault\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible-config","title":"Ansible-config \u5e38\u7528\u53c2\u6570","text":"<pre><code># \u751f\u6210\u4e00\u4e2a\u6ce8\u91ca\u6240\u6709\u914d\u7f6e\u7684 ansible \u914d\u7f6e\u6587\u4ef6\nansible-config init --disabled -t all &gt; ./ansible.cfg\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible-doc","title":"Ansible-doc \u5e38\u7528\u53c2\u6570","text":"<pre><code># \u5217\u51fa\u6240\u6709\u652f\u6301\u7684\u6a21\u5757\nansible-doc -l\n\n# \u67e5\u770b\u6a21\u5757\u53c2\u6570\nansible-doc -s &lt;\u6a21\u5757\u540d&gt;\n\n# \u67e5\u770b\u6a21\u5757\u6848\u4f8b\nansible-doc &lt;\u6a21\u5757\u540d&gt;\n# \u8fd9\u4e2a\u53ef\u4ee5\u901a\u8fc7\u641c\u7d22 EXAMPLE \u6765\u5feb\u901f\u67e5\u770b\u4f7f\u7528\u65b9\u6cd5\n\n# \u6309\u7c7b\u578b\u5217\u51fa\u6a21\u5757\nansible-doc -t cache -l        # \u5217\u51fa\u6240\u6709\u7f13\u5b58\u6a21\u5757\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible-inventory","title":"Ansible-inventory \u5e38\u7528\u53c2\u6570","text":"<pre><code># \u5217\u51fa\u6240\u6709\u4e3b\u673a\nansible-inventory -i inventory --list\n-i        # \u6307\u5b9a\u4e3b\u673a\u6e05\u5355\u6587\u4ef6\n--list    # \u5217\u51fa\u6240\u6709\u4e3b\u673a\n\n# \u67e5\u770b\u67d0\u4e00\u4e2a\u4e3b\u673a\nansible-inventory -i inventory --host server1\n\n# \u4ee5\u6811\u72b6\u56fe\u663e\u793a\u5e76\u663e\u793a\u53d8\u91cf\nansible-inventory -i inventory --graph --vars\n\n# \u4ee5 toml \u683c\u5f0f\u8f93\u51fa\u4e3b\u673a\u6e05\u5355\nansible-inventory -i inventory --list --toml\n\n# \u4ee5 yaml \u683c\u5f0f\u8f93\u51fa\u4e3b\u673a\u6e05\u5355\nansible-inventory -i inventory --list --yaml\n\n# \u5c06\u5185\u5bb9\u8f93\u51fa\u5230\u6587\u4ef6\u91cc\nansible-inventory -i inventory --list --output file\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible_12","title":"Ansible \u5e38\u7528\u53c2\u6570","text":"<pre><code>ansible all -u root -k -m command -a 'pwd chdir=/opt removes=/root/anaconda-ks.cfg'\nall        # \u8868\u793a\u9700\u8981\u6267\u884c\u4efb\u52a1\u7684\u4e3b\u673a\u6216\u4e3b\u673a\u7ec4\n-m        # \u540e\u63a5\u8981\u4f7f\u7528\u7684\u6a21\u5757\ncommand    # \u4f7f\u7528\u7684\u6a21\u5757\n-u root    # \u6307\u5b9a\u8fde\u63a5\u7528\u6237\n-k        # \u624b\u52a8\u8f93\u5165\u5bc6\u7801\n-a        # \u540e\u63a5\u6a21\u5757\u7684\u53c2\u6570\n</code></pre> <p>\u6709\u7684\u5730\u65b9\u53ef\u80fd\u4f1a\u63d0\u5230 Ansible Ad-Hoc\uff0cAnsible Ad-Hoc \u5c31\u662f ansible \u547d\u4ee4\uff0c\u901a\u8fc7\u547d\u4ee4\u7684\u65b9\u5f0f\u6267\u884c\u7b80\u5355\u4efb\u52a1\uff08\u4e00\u6b21\u4f7f\u7528\u4e00\u4e2a\u6a21\u5757\u6267\u884c\u4e00\u4e2a\u4efb\u52a1\uff09\u3002</p>"},{"location":"2025/sre/2ansible/#ansible-playbook","title":"Ansible-playbook \u5e38\u7528\u53c2\u6570","text":"<pre><code>ansible-playbook --become --become-method sudo \\\n    --become-user root -i inventory \\\n    --ask-pass --ask-become-pass playbook.yaml\n--become            # \u542f\u52a8\u63d0\u6743\n--become-method        # \u8bbe\u7f6e\u63d0\u6743\u65b9\u6cd5\n--become-user        # \u8bbe\u7f6e\u63d0\u6743\u5230\u4ec0\u4e48\u7528\u6237\n--ask-pass            # \u8f93\u5165\u8fdc\u7a0b\u7528\u6237\u5bc6\u7801\n--ask-become-pass    # \u8bbe\u7f6e\u63d0\u6743\u5bc6\u7801\n\n# \u68c0\u67e5 playbook \u662f\u5426\u6709\u8bed\u6cd5\u9519\u8bef\nansible-playbook --syntax-check playbook.yaml\n\n# \u6267\u884c playbook \u4f46\u4e0d\u505a\u66f4\u6539\nansible-playbook --check playbook.yaml\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible-galaxy","title":"Ansible-galaxy \u5e38\u7528\u9009\u9879","text":"<pre><code># \u5217\u51fa\u6240\u6709 role\nansible-galaxy role list\n\n# \u521d\u59cb\u5316\u4e00\u4e2a\u540d\u4e3a role \u7684 role1\nansible-galaxy role init role1\n\n# \u4e0b\u8f7d\u96c6\u5408\nansible-galaxy collection download\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible-vault","title":"Ansible-vault \u5e38\u7528\u9009\u9879","text":"<pre><code># \u521b\u5efa\u52a0\u5bc6\u6587\u4ef6\nansible-vault create test1\n\n# \u5bf9\u5df2\u6709\u6587\u4ef6\u8fdb\u884c\u52a0\u5bc6\nansible-vault encrypt test\n\n# \u5bf9\u5b57\u7b26\u4e32 username=root \u8fdb\u884c\u52a0\u5bc6\nansible-vault encrypt_string \"username=root\"\n\n# \u7f16\u8f91\u52a0\u5bc6\u6587\u4ef6\nansible-vault edit test\n\n# \u67e5\u770b\u52a0\u5bc6\u6587\u4ef6\nansible-vault view test\n\n# \u4fee\u6539\u6587\u4ef6\u5bc6\u7801\nansible-vault rekey test\n\n# \u89e3\u5bc6\u6587\u4ef6\nansible-vault decrypt test2\n</code></pre>"},{"location":"2025/sre/2ansible/#6-ansible","title":"6 Ansible \u6a21\u5757\u548c\u96c6\u5408","text":""},{"location":"2025/sre/2ansible/#ansible_13","title":"Ansible \u6a21\u5757\u548c\u96c6\u5408","text":"<p>Ansible \u901a\u8fc7\u6a21\u5757\u6267\u884c\u4efb\u52a1\uff0c\u4f8b\u5982 <code>ansible.builtin.hostname</code> \u7528\u4e8e\u8bbe\u7f6e\u4e3b\u673a\u540d\u3002</p> <p><code>ansible.builtin</code>  \u662f\u6a21\u5757\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u4e0d\u540c\u7684\u6a21\u5757\u5c5e\u4e8e\u4e0d\u540c\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u6a21\u5757\u540d\u79f0\u4e0d\u4f1a\u51b2\u7a81\uff0c\u4f46\u662f\u968f\u7740\u6a21\u5757\u6570\u91cf\u7684\u589e\u52a0\uff0c\u4e0d\u6392\u9664\u6a21\u5757\u540d\u51b2\u7a81\u7684\u53ef\u80fd\uff0c\u6240\u4ee5\u5c06\u4e0d\u540c\u7684\u6a21\u5757\u653e\u5728\u4e0d\u540c\u7684\u547d\u540d\u7a7a\u95f4\u91cc\u7528\u4e8e\u533a\u5206\uff0c\u5982\u679c\u63a7\u5236\u8282\u70b9\u5b89\u88c5\u7684\u6a21\u5757\u6ca1\u6709\u6a21\u5757\u540d\u51b2\u7a81\u7684\u60c5\u51b5\uff0c\u8c03\u7528\u6a21\u5757\u65f6\u53ef\u4ee5\u4e0d\u5199\u547d\u540d\u7a7a\u95f4\uff0c\u5982\uff1ahostname\u3002</p> <p>Ansible \u662f Python \u5199\u7684\uff0c\u6240\u4ee5 Ansible \u7684\u5927\u90e8\u5206\u6a21\u5757\u90fd\u9700\u8981\u88ab\u63a7\u4e3b\u673a\u6709 Python\u624d\u80fd\u4f7f\u7528\uff0c\u5c11\u90e8\u5206\u6a21\u5757\u9664\u5916\uff0c\u5982\uff1aansible.builtin.raw\u3002</p>"},{"location":"2025/sre/2ansible/#_8","title":"\u6587\u4ef6\u4e0e\u76ee\u5f55\u64cd\u4f5c\u6a21\u5757","text":"<pre><code>\u6a21\u5757\u540d \u529f\u80fd\u63cf\u8ff0    \nansible.builtin.copy        \u590d\u5236\u6587\u4ef6\u5230\u8fdc\u7a0b\u4e3b\u673a\nansible.builtin.template    \u6e32\u67d3 Jinja2 \u6a21\u677f\u5e76\u4f20\u8f93\nansible.builtin.fetch   \u4ece\u8fdc\u7a0b\u4e3b\u673a\u83b7\u53d6\u6587\u4ef6\nansible.builtin.file    \u8bbe\u7f6e\u6587\u4ef6\u6743\u9650\u3001\u5c5e\u4e3b\u7b49\nansible.builtin.stat    \u83b7\u53d6\u6587\u4ef6\u72b6\u6001\nansible.builtin.unarchive   \u89e3\u538b\u5f52\u6863\u6587\u4ef6\nansible.builtin.lineinfile  \u4fee\u6539\u6587\u4ef6\u4e2d\u7684\u4e00\u884c\u5185\u5bb9\nansible.builtin.blockinfile \u5411\u6587\u4ef6\u4e2d\u63d2\u5165\u591a\u4e2a\u884c\n</code></pre>"},{"location":"2025/sre/2ansible/#_9","title":"\u7cfb\u7edf\u7ba1\u7406\u6a21\u5757","text":"<pre><code>\u6a21\u5757\u540d. \u529f\u80fd\u63cf\u8ff0\n\nansible.builtin.hostname    \u8bbe\u7f6e\u4e3b\u673a\u540d\nansible.builtin.user    \u521b\u5efa/\u4fee\u6539/\u5220\u9664\u7528\u6237\nansible.builtin.group   \u521b\u5efa/\u4fee\u6539/\u5220\u9664\u7528\u6237\u7ec4\nansible.builtin.service \u7ba1\u7406\u7cfb\u7edf\u670d\u52a1\nansible.builtin.systemd  \u7ba1\u7406 systemd \u670d\u52a1\nansible.builtin.package  \u5b89\u88c5/\u5378\u8f7d\u901a\u7528\u8f6f\u4ef6\u5305\uff08\u81ea\u52a8\u9009\u62e9\u540e\u7aef\uff09\nansible.builtin.yum    \u4f7f\u7528 yum \u5b89\u88c5\u5305\nansible.builtin.apt   \u4f7f\u7528 apt \u5b89\u88c5\u5305\nansible.builtin.dnf   \u4f7f\u7528 dnf \u5b89\u88c5\u5305\n</code></pre>"},{"location":"2025/sre/2ansible/#_10","title":"\u547d\u4ee4\u6267\u884c\u6a21\u5757","text":"<pre><code>\n\u6a21\u5757\u540d   \u529f\u80fd\u63cf\u8ff0\nansible.builtin.command   \u8fd0\u884c\u666e\u901a\u547d\u4ee4\uff08\u4e0d\u652f\u6301\u7ba1\u9053\u3001\u91cd\u5b9a\u5411\uff09\nansible.builtin.shell     \u8fd0\u884c shell \u547d\u4ee4\uff08\u652f\u6301\u7ba1\u9053\u3001\u91cd\u5b9a\u5411\u7b49\uff09\nansible.builtin.raw       \u539f\u59cb\u547d\u4ee4\u6267\u884c\uff0c\u4e0d\u8d70\u6a21\u5757\u7cfb\u7edf\nansible.builtin.script    \u5c06\u672c\u5730\u811a\u672c\u4e0a\u4f20\u5e76\u6267\u884c\n</code></pre>"},{"location":"2025/sre/2ansible/#_11","title":"\u5f52\u6863\u4e0e\u538b\u7f29","text":"<pre><code>\u6a21\u5757\u540d.  \u529f\u80fd\u63cf\u8ff0\nansible.builtin.archive    \u521b\u5efa\u5f52\u6863\u6587\u4ef6\uff08\u5982 tar.gz\uff09\nansible.builtin.unarchive      \u89e3\u538b\u5f52\u6863\u6587\u4ef6\n</code></pre>"},{"location":"2025/sre/2ansible/#_12","title":"\u6743\u9650\u4e0e\u8ba4\u8bc1","text":"<pre><code>\u6a21\u5757\u540d     \u529f\u80fd\u63cf\u8ff0\nansible.builtin.seboolean   \u7ba1\u7406 SELinux \u5e03\u5c14\u503c\nansible.builtin.selinux     \u8bbe\u7f6e SELinux \u6a21\u5f0f\nansible.builtin.authorized_key      \u6dfb\u52a0 SSH \u516c\u94a5\u5230\u7528\u6237 ~/.ssh/authorized_keys\n</code></pre>"},{"location":"2025/sre/2ansible/#_13","title":"\u7f51\u7edc\u4e0e\u8fdc\u7a0b\u8fde\u63a5","text":"<pre><code>\u6a21\u5757\u540d.    \u529f\u80fd\u63cf\u8ff0\nansible.builtin.uri  \u53d1 HTTP \u8bf7\u6c42\nansible.builtin.get_url   \u4e0b\u8f7d\u6587\u4ef6\nansible.builtin.wait_for     \u7b49\u5f85\u7aef\u53e3/\u6587\u4ef6\u72b6\u6001\u53d8\u66f4\n</code></pre>"},{"location":"2025/sre/2ansible/#_14","title":"\u63a7\u5236\u903b\u8f91\u6a21\u5757","text":"<pre><code>\u6a21\u5757\u540d         \u529f\u80fd\u63cf\u8ff0\nansible.builtin.debug       \u8f93\u51fa\u8c03\u8bd5\u4fe1\u606f\nansible.builtin.pause       \u6682\u505c\u6267\u884c\nansible.builtin.assert      \u6761\u4ef6\u65ad\u8a00\nansible.builtin.set_fact    \u8bbe\u7f6e\u81ea\u5b9a\u4e49\u53d8\u91cf\n</code></pre> <p>\u8fd9\u4e9b\u6a21\u5757\u90fd\u53ef\u4ee5\u901a\u8fc7 <code>ansible-doc &lt;\u6a21\u5757\u540d&gt;</code> \u6765\u67e5\u770b\u5e2e\u52a9\u6587\u6863\uff0c\u53ef\u4ee5\u901a\u8fc7\u641c\u7d22 EXAMPLE \u6765\u5feb\u901f\u4e86\u89e3\u6a21\u5757\u7684\u4f7f\u7528\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 <code>ansible-doc -s &lt;\u6a21\u5757\u540d&gt;</code> \u67e5\u770b\u6a21\u5757\u9009\u9879\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c<code>ansible.builtin.systemd</code> \u6a21\u5757\u7528\u4e8e\u670d\u52a1\u7ba1\u7406\uff0c\u901a\u8fc7 ansible-doc \u67e5\u770b\u6a21\u5757\u6587\u6863\u5e76\u641c\u7d22 EXAMPLE\u3002</p> <pre><code>[root@awx-1 ansible]# ansible-doc ansible.builtin.systemd\n# \u7528 /EXAMPLE \u641c\u7d22\nEXAMPLES:\n\n- name: Make sure a service unit is running\n  ansible.builtin.systemd:\n    state: started\n    name: httpd\n\n- name: Stop service cron on debian, if running\n  ansible.builtin.systemd:\n    name: cron\n    state: stopped\n\n- name: Restart service cron on centos, in all cases, also issue daemon-reload to pick up config changes\n  ansible.builtin.systemd:\n    state: restarted\n    daemon_reload: true\n    name: crond\n\n- name: Reload service httpd, in all cases\n  ansible.builtin.systemd:\n    name: httpd.service\n    state: reloaded\n\n- name: Enable service httpd and ensure it is not masked\n  ansible.builtin.systemd:\n    name: httpd\n    enabled: true\n    masked: no\n\n- name: Enable a timer unit for dnf-automatic\n  ansible.builtin.systemd:\n    name: dnf-automatic.timer\n    state: started\n    enabled: true\n\n- name: Just force systemd to reread configs (2.4 and above)\n  ansible.builtin.systemd:\n    daemon_reload: true\n\n- name: Just force systemd to re-execute itself (2.8 and above)\n  ansible.builtin.systemd:\n    daemon_reexec: true\n\n- name: Run a user service when XDG_RUNTIME_DIR is not set on remote login\n  ansible.builtin.systemd:\n    name: myservice\n    state: started\n    scope: user\n  environment:\n    XDG_RUNTIME_DIR: \"/run/user/{{ myuid }}\"\n</code></pre> <p>\u5f88\u591a\u9009\u9879\u90fd\u80fd\u505a\u5230\u89c1\u6587\u77e5\u610f\uff0c\u6bd4\u65b9\u8bf4 enabled \u7528\u4e8e\u8bbe\u7f6e\u662f\u5426\u5f00\u673a\u81ea\u542f\uff0cstate \u7528\u4e8e\u8bbe\u7f6e\u670d\u52a1\u72b6\u6001\u3002</p>"},{"location":"2025/sre/2ansible/#ansible_14","title":"Ansible \u96c6\u5408","text":"<p>Ansible-core \u81ea\u5e26\u4e00\u7ec4\u6a21\u5757\uff0c\u4ee5 <code>ansible.builtin</code> \u5f00\u5934\uff0c\u8fd9\u4e9b\u6a21\u5757\u662f\u8fdc\u8fdc\u4e0d\u591f\u7684\uff0c\u9700\u8981\u5176\u4ed6\u6a21\u5757\u6765\u6269\u5c55 Ansible \u7684\u529f\u80fd\uff0c\u4e3a\u4e86\u65b9\u4fbf\u8fd9\u4e9b\u6a21\u5757\u7684\u7ba1\u7406\uff0c\u6240\u4ee5\u5c06\u8fd9\u4e9b\u6269\u5c55\u6a21\u5757\u5206\u7c7b\uff0c\u4e00\u7c7b\u6a21\u5757\u5c31\u7ec4\u6210\u4e00\u4e2a\u96c6\u5408\u3002</p> <p></p> <pre><code>ansible-galaxy collection download community.general\n</code></pre> <pre><code>---\n- name: init    # \u5b9a\u4e49 Playbook \u7684\u540d\u5b57\n  hosts: all    # \u5b9a\u4e49\u88ab\u63a7\u4e3b\u673a\u8303\u56f4\n  tasks:        # \u5b9a\u4e49\u8981\u6267\u884c\u7684\u4efb\u52a1\uff0c\u4e0b\u8fb9\u4e00\u4e2a - \u5bf9\u5e94\u4e00\u4e2a\u4efb\u52a1\uff08\u4e00\u4e2a - \u8868\u793a\u4e00\u4e2a\u5217\u8868\uff09\n  - name: set hostname        # \u7b2c\u4e00\u4e2a\u4efb\u52a1\u7684\u540d\u79f0\n    ansible.builtin.hostname:    # \u7b2c\u4e00\u4e2a\u4efb\u52a1\u4f7f\u7528\u7684\u6a21\u5757\n      name: \"{{ inventory_hostname }}.{{ host_search_name }}\"    # \u6a21\u5757\u9009\u9879\n  - name: dnf install package    # \u7b2c\u4e8c\u4e2a\u4efb\u52a1\u540d\u79f0\n    ansible.builtin.dnf:        # \u7b2c\u4e8c\u4e2a\u4efb\u52a1\u4f7f\u7528\u7684\u6a21\u5757\n      name:                        # \u6a21\u5757\u9009\u9879\n      - bash-completion\n      - vim\n      - gcc\n      - make\n      - git\n      - wget\n      - tar\n      - bzip2\n      - unzip\n      - python3\n      - sysstat\n      state: present\n  - name: set hosts\n    ansible.builtin.template:\n      src: ./templates/hosts.j2\n      dest: /etc/hosts\n      owner: root\n      group: root\n      mode: '0644'\n</code></pre> <ul> <li> <p><code>---</code>\uff1a\u2014yaml \u6587\u4ef6\u7684\u6587\u6863\u5206\u9694\u7b26\uff0c\u591a\u4e2a yaml \u6587\u6863\u53ef\u4ee5\u653e\u5728\u4e00\u4e2a\u6587\u4ef6\u91cc\uff0c\u7528---\u6765\u505a\u5206\u9694</p> </li> <li> <p><code>- name</code>\uff1a\u7528\u4e8e\u5b9a\u4e49 Playbook \u548c Play \u7684\u540d\u79f0\uff0c\u7c7b\u4f3c\u4e8e\u6ce8\u91ca</p> </li> <li> <p><code>hosts</code>\uff1a\u5b9a\u4e49 Playbook \u4f5c\u7528\u7684\u4e3b\u673a\u8303\u56f4</p> </li> <li> <p><code>tasks</code>\uff1a\u5b9a\u4e49 Playbook \u7684\u591a\u4e2a\u81ea\u52a8\u5316\u4efb\u52a1\uff0c\u4e0b\u8fb9\u5305\u542b\u591a\u4e2a\u4efb\u52a1</p> </li> </ul> <p>YAML\u5bf9\u7f29\u8fdb\u6709\u4e25\u683c\u8981\u6c42\uff0c\u6bd4\u65b9\u8bf4<code>- name</code>\u548c<code>hosts</code>\u662f\u4e00\u4e2a\u7b49\u7ea7\uff08\u5728\u4e00\u4e2a\u5217\u8868\uff09\uff0c\u6240\u4ee5\u7f29\u8fdb\u662f\u5bf9\u9f50\u7684\uff0ctasks\u4e0b\u7684<code>- name</code>\u548c<code>ansible.builtin.hostname</code>\u662f\u5b83\u7684\u5b50\u9879\uff08\u662ftasks\u4e0b\u7684\u5217\u8868\uff09\uff0c\u6240\u4ee5\u4f1a\u591a\u7f29\u8fdb\u4e24\u4e2a\u7a7a\u683c\uff08\u7f29\u8fdb\u4ee5\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u7b97\uff0c\u4e0d\u8003\u8651-\uff09\u3002</p> <pre><code>  - name: set hosts\n    ansible.builtin.template:\n      src: ./templates/hosts.j2\n      dest: /etc/hosts\n      owner: root\n      group: root\n      mode: '0644'\n</code></pre> <p>\u8fd9\u4e2a\u8868\u793a\u4e00\u4e2a play\uff0cplay \u7684\u540d\u5b57\u4e3aset hosts\uff0c\u4f7f\u7528\u7684\u6a21\u5757\u4e3a<code>ansible.builtin.template</code>\uff0c\u6a21\u5757\u4f7f\u7528\u7684\u53c2\u6570\u6709<code>src\u3001dest\u3001owner\u3001group\u3001mode</code>\u3002</p>"},{"location":"2025/sre/2ansible/#ansible-playbook_1","title":"Ansible Playbook \u547d\u4ee4\u5e38\u7528\u9009\u9879","text":"<ol> <li>\u53ef\u4ee5\u901a\u8fc7ansible-playbook\u547d\u4ee4\u6765\u6267\u884c Playbook\uff0c\u901a\u8fc7-v\u53ef\u4ee5\u67e5\u770b\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f\u3002</li> <li>\u2022-v: \u63d0\u4f9b\u4efb\u52a1\u548c\u4e3b\u673a\u72b6\u6001\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f46\u4e0d\u5305\u62ec\u53d8\u91cf\u503c\u548c\u8be6\u7ec6\u8c03\u8bd5\u4fe1\u606f\u3002</li> <li>\u2022-vv: \u63d0\u4f9b\u66f4\u8be6\u7ec6\u7684\u4efb\u52a1\u6267\u884c\u4fe1\u606f\uff0c\u5305\u62ec\u53d8\u91cf\u503c\u3002</li> <li>\u2022-vvv: \u663e\u793a\u5305\u62ec\u53d8\u91cf\u5c55\u5f00\u548c\u4efb\u52a1\u8be6\u7ec6\u4fe1\u606f\u5728\u5185\u7684\u66f4\u591a\u8c03\u8bd5\u4fe1\u606f\u3002</li> <li> <p>\u2022-vvvv: \u663e\u793a\u6240\u6709\u8c03\u8bd5\u4fe1\u606f\uff0c\u5305\u62ec HTTP \u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u8be6\u7ec6\u5185\u5bb9\u3002</p> </li> <li> <p>\u53ef\u4ee5\u901a\u8fc7<code>--syntax-check</code>\u9009\u9879\u6765\u5bf9 Playbook \u7684\u683c\u5f0f\u8fdb\u884c\u68c0\u67e5</p> </li> <li>\u53ef\u4ee5\u901a\u8fc7<code>--check</code>\u6765\u6267\u884c Playbook\uff0c\u4f46\u5e76\u4e0d\u505a\u5b9e\u9645\u7684\u6539\u53d8</li> </ol> <p>Ansible Playbook \u961f\u5217\u9519\u8bef\u5904\u7406\u673a\u5236</p> <p>Ansible Playbook \u7684\u673a\u5236\u662f\u5982\u679c\u67d0\u4e2a\u4e3b\u673a\u7684\u67d0\u4e2a Play \u6267\u884c\u9519\u8bef\uff0c\u90a3\u4e48\u8fd9\u4e2a\u4e3b\u673a\u5c31\u4f1a\u88ab\u79fb\u9664\u6267\u884c\u961f\u5217\uff0c\u8be5\u4e3b\u673a\u76f8\u5173\u7684\u540e\u7eed\u6240\u6709 Play \u90fd\u4e0d\u4f1a\u6267\u884c</p> <p></p> <p>\u6709\u65f6\u5019\u6211\u4eec\u53ef\u80fd\u5e0c\u671b\u4efb\u52a1\u62a5\u9519\u540e\u8282\u70b9\u7ee7\u7eed\u6267\u884c\u540e\u8fb9\u7684\u4efb\u52a1\uff0c\u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528<code>ignore_errors: yes</code>\u6765\u5b9e\u73b0\u3002</p> <pre><code>  - name: dnf install package\n    ansible.builtin.dnf:\n      name:    sysstat\n      state: present\n    ignore_errors: yes\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible-handlers","title":"Ansible Handlers","text":"<p>Ansible Handlers \u8868\u793a\u4e00\u7ec4\u7279\u6b8a\u7684\u4efb\u52a1\uff0c\u5b83\u53ea\u4f1a\u5728\u7279\u5b9a\u7684\u60c5\u51b5\u4e0b\u624d\u4f1a\u88ab\u6267\u884c\uff0c\u4f8b\u5982\u914d\u7f6e sssd \u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7 Ansible Handlers \u6765\u5b9e\u73b0\u53ea\u6709 sssd \u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\u53d1\u751f\u6539\u53d8\u540e\u624d\u6267\u884c sssd \u670d\u52a1\u7684\u91cd\u542f\u3002</p> <p>Ansible Handlers \u6709\u4e24\u4e2a\u5e38\u7528\u9009\u9879\uff0cnotify\u3001handlers\u548clisten\u3002</p> <p>notify\uff1a\u5728\u67d0\u4e2a play \u4e0b\u8ffd\u52a0notify\u540e\uff0c\u8868\u793a\u8fd9\u4e2a play \u6267\u884c\u6210\u529f\u540e\u5e76\u4e14\u505a\u51fa\u4fee\u6539\u540e\u89e6\u53d1handlers\u7684\u67d0\u4e2a\u7279\u6b8a\u4efb\u52a1</p>"},{"location":"2025/sre/2ansible/#ansible-handlers_1","title":"Ansible Handlers \u4f8b\u5b50","text":"<pre><code>---\n- name: set sssd\n  hosts: all\n  gather_facts: false\n  vars:\n    sssd_packages:\n    - sssd\n    - sssd-tools\n    - oddjob\n    - oddjob-mkhomedir\n    - libsss_sudo\n  tasks:\n  - name: install packages\n    ansible.builtin.yum:\n      name: \"{{ sssd_packages }}\"\n      state: present\n  - name: set sssd.conf\n    ansible.builtin.template:\n      src: templates/sssd.conf.j2\n      dest: /etc/sssd/sssd.conf\n      mode: '0600'\n      owner: root\n      group: root\n    notify: set_pam_and_service\n  - name: set oddjob service\n    ansible.builtin.systemd:\n      name: oddjobd\n      state: started\n      enabled: true\n  handlers:\n  - name: set authselect\n    ansible.builtin.command: \"authselect select sssd with-sudo with-mkhomedir --force\"\n    listen: set_pam_and_service\n  - name: set sssd service\n    ansible.builtin.systemd:\n      name: sssd\n      state: restarted\n    listen: set_pam_and_service\n</code></pre> <p>\u5728\u8fd9\u4e2a Playbook \u4e2d\uff0c\u5728\u540d\u4e3aset sssd.conf\u7684 Play \u4e0b\u5b9a\u4e49\u4e86\u4e00\u4e2anotify\uff0cnotify\u7684\u540d\u5b57\u4e3a <code>set_pam_and_service</code>\uff0c\u7136\u540e\u5728handlers\u4e2d\u5b9a\u4e49\u4e86\u4e24\u4e2a Play\uff0c\u5206\u522b\u662f<code>set authselect</code>\u548c<code>set sssd service</code>\uff0c</p> <p>\u8fd9\u4e24\u4e2a Play \u90fd\u4e00\u4e2alisten\u9009\u9879\uff0clisten\u7684\u5185\u5bb9\u5747\u4e3a <code>set_pam_and_service</code>\uff0c\u8fd9\u4e2a\u5b9e\u73b0\u7684\u7ed3\u679c\u5c31\u662f\u5f53<code>set sssd.conf</code>\u6267\u884c\u6210\u529f\u4e14\u505a\u51fa\u6539\u53d8\u4e4b\u540e\u5c31\u4f1a\u89e6\u53d1<code>set authselect</code>\u548c<code>set sssd service</code>\u8fd9\u4e24\u4e2a\u4efb\u52a1\uff0c\u5f53<code>set sssd.con</code>f\u6ca1\u6709\u505a\u51fa\u6539\u53d8\u65f6\uff0c<code>set authselect</code>\u548c<code>set sssd service</code>\u8fd9\u4e24\u4e2a\u4efb\u52a1\u4f1a\u76f4\u63a5\u88ab\u8df3\u8fc7\u3002</p> <p>\u4e0a\u8ff0\u4f8b\u5b50\u91cc\u662f\u4e00\u4e2a Play \u89e6\u53d1\u4e24\u4e2ahandlers\u7684 Play\uff0c\u5982\u679chandlers\u91cc\u88ab\u89e6\u53d1\u7684 Play \u53ea\u6709\u4e00\u4e2a\uff0c\u90a3\u4e48\u53ef\u4ee5\u4e0d\u7528listen\uff0c\u53ef\u4ee5\u76f4\u63a5\u5c06handlers\u91cc Play \u7684name\u8bbe\u7f6e\u4e3a\u548cnotify\u5185\u5bb9\u76f8\u540c\u3002\uff08\u5982\u679chandlers\u91cc\u591a\u4e2a Play \u7684\u540d\u5b57\u4e3a<code>set_pam_and_service</code>\uff0c\u90a3\u4e48\u53ea\u6709\u7b2c\u4e00\u4e2a Play \u4f1a\u88ab\u6267\u884c\uff09</p> <pre><code>---\n- name: set sssd\n  hosts: all\n  gather_facts: false\n  tasks:\n  - name: set sssd.conf\n    ansible.builtin.template:\n      src: templates/sssd.conf.j2\n      dest: /etc/sssd/sssd.conf\n      mode: '0600'\n      owner: root\n      group: root\n    notify: set_pam_and_service\n  handlers:\n  - name: set_pam_and_service\n    ansible.builtin.systemd:\n      name: sssd\n      state: restarted\n</code></pre>"},{"location":"2025/sre/2ansible/#handlers","title":"\u5f3a\u5236\u6267\u884c handlers","text":"<p>Ansible \u7684\u673a\u5236\u662f\u5982\u679c\u67d0\u4e2a\u4e3b\u673a\u7684\u67d0\u4e2a Play \u6267\u884c\u9519\u8bef\uff0c\u90a3\u4e48\u8fd9\u4e2a\u4e3b\u673a\u5c31\u4f1a\u88ab\u79fb\u9664\u6267\u884c\u961f\u5217\uff0c\u8be5\u4e3b\u673a\u76f8\u5173\u7684\u540e\u7eed\u6240\u6709 Play \u90fd\u4e0d\u4f1a\u6267\u884c\uff0c\u6240\u4ee5\u4e3a\u4e86\u4fdd\u8bc1handlers\u80fd\u591f\u6b63\u5e38\u6267\u884c\uff0c\u53ef\u4ee5\u6dfb\u52a0\u00a7<code>force_handlers: true</code>\u9009\u9879\uff0c\u8fd9\u6837\u65e0\u8bba\u662f\u5426\u6709\u9519\u8bef\u4efb\u52a1\u4ea7\u751fhandlers\u90fd\u4f1a\u6b63\u5e38\u6267\u884c</p> <pre><code>---\n- name: set sssd\n  hosts: all\n  gather_facts: false\n  force_handlers: true\n  tasks:\n  ...\n</code></pre>"},{"location":"2025/sre/2ansible/#8-ansible","title":"8 Ansible \u53d8\u91cf\u7684\u5b9a\u4e49\u548c\u5f15\u7528","text":""},{"location":"2025/sre/2ansible/#ansible_15","title":"Ansible \u53d8\u91cf","text":"<ul> <li>\u2022 Ansible \u7684\u53d8\u91cf\u533a\u5206\u5927\u5c0f\u5199</li> <li>\u2022 Ansible \u7684\u53d8\u91cf\u4e0d\u8981\u91cd\u540d\uff0c\u7279\u522b\u662f\u4e0d\u8981\u548c\u5185\u7f6e\u53d8\u91cf\u51b2\u7a81</li> <li>\u2022 Ansible \u7684\u53d8\u91cf\u540d\u79f0\u53ef\u4ee5\u4f7f\u7528\u6570\u5b57\u3001\u5b57\u6bcd\u548c\u4e0b\u5212\u7ebf\u7ec4\u6210\uff0c\u4f46\u662f\u53ea\u80fd\u4ee5\u5b57\u6bcd\u5f00\u5934</li> </ul>"},{"location":"2025/sre/2ansible/#_15","title":"\u8fde\u63a5\u53d8\u91cf","text":"<p>\u8fde\u63a5\u53d8\u91cf\u662f Ansible \u7684\u5185\u7f6e\u53d8\u91cf\uff0c\u8fd9\u4e2a\u53d8\u91cf\u63a7\u5236 Ansible \u5bf9\u88ab\u63a7\u4e3b\u673a\u7684\u8fde\u63a5\u65b9\u5f0f\u3002</p> <p>\u53ef\u4ee5\u5728\u4e3b\u673a\u6e05\u5355\u3001Playbook \u548cansible -e\u5904\u8bbe\u7f6e\u53d8\u91cf\u3002</p> <ul> <li>\u2022 <code>ansible_host</code>~\uff1a\u6307\u5b9a\u6e05\u5355\u4e2d\u4e3b\u673a\u7684\u771f\u5b9e IP \u5730\u5740</li> <li>\u2022 <code>ansible_port</code>\uff1a\u6307\u5b9a\u6e05\u5355\u4e2d\u4e3b\u673a\u7684\u7aef\u53e3</li> <li>\u2022 <code>ansible_user</code>\uff1a\u6307\u5b9a\u6e05\u5355\u4e2d\u4e3b\u673a\u7684\u8fde\u63a5\u7528\u6237</li> <li>\u2022 <code>ansible_become</code>\uff1a\u662f\u5426\u8fdb\u884c\u7279\u6743\u5347\u7ea7</li> <li>\u2022 <code>ansible_become_user</code>\uff1a\u901a\u8fc7\u7279\u6743\u5347\u7ea7\u5230\u54ea\u4e2a\u7528\u6237</li> <li>\u2022 <code>ansible_become_password</code>\uff1a\u63d0\u5347\u7279\u6743\u65f6\uff0c\u5982\u679c\u9700\u8981\u5bc6\u7801\u7684\u8bdd\uff0c\u53ef\u4ee5\u901a\u8fc7\u8be5\u53d8\u91cf\u6307\u5b9a</li> <li>\u2022 <code>ansible_sudo_exec</code>\uff1a\u5982\u679c sudo \u547d\u4ee4\u4e0d\u5728\u9ed8\u8ba4\u8def\u5f84\uff0c\u9700\u8981\u6307\u5b9a sudo \u547d\u4ee4\u8def\u5f84</li> <li>\u2022 <code>ansible_connection</code>\uff1assh \u8fde\u63a5\u7684\u7c7b\u578b\uff1alocal, ssh, paramiko\uff0c\u9ed8\u8ba4\u662f ssh</li> <li>\u2022 <code>ansible_ssh_password</code>\uff1assh \u8fde\u63a5\u65f6\u7684\u5bc6\u7801</li> <li>\u2022 <code>ansible_ssh_private_key_file</code>\uff1a\u79d8\u94a5\u6587\u4ef6\u8def\u5f84\uff0c\u5982\u679c\u4e0d\u60f3\u4f7f\u7528 ssh-agent \u7ba1\u7406\u79d8\u94a5\u6587\u4ef6\u65f6\u53ef\u4ee5\u4f7f\u7528\u6b64\u9009\u9879</li> <li>\u2022 <code>ansible_ssh_executable</code>\uff1a\u5982\u679c ssh \u6307\u4ee4\u4e0d\u5728\u9ed8\u8ba4\u8def\u5f84\u5f53\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u8be5\u53d8\u91cf\u6765\u5b9a\u4e49\u5176\u8def\u5f84</li> <li>\u2022 <code>ansible_ssh_extra_args</code>\uff1a\u989d\u5916\u7684 ssh \u53c2\u6570\u3002</li> <li>\u2022 <code>ansible_python_interpreter</code>\uff1a\u6307\u5b9a\u53d7\u63a7\u4e3b\u673a\u7684 python \u7684\u4f4d\u7f6e</li> </ul> <p>\u4ee5\u4e0b\u662f\u5728\u4e3b\u673a\u6e05\u5355\u4e2d\u8bbe\u7f6e\u53d8\u91cf\u793a\u4f8b\uff1a</p> <pre><code>[all:vars]\nansible_ssh_user = root\nansible_ssh_password = redhat\nansible_become = true\nansible_become_user = redhat\n</code></pre>"},{"location":"2025/sre/2ansible/#_16","title":"\u5b9a\u4e49\u53d8\u91cf","text":"<p>\u4e3b\u673a\u6e05\u5355\u5b9a\u4e49</p> <pre><code>server1 MYSQL_VERSION=5.7 MYSQL_MASTER=true\n[web]\nserver2\nserver3\n\n[web:vars]\nHTTPD_VERSION=2.4\n\n[all:vars]\nSYSTEM_TYPE=RHEL\n</code></pre> <ul> <li>\u2022 \u4e3b\u673a\u53d8\u91cf\u5199\u5728\u4e3b\u673a\u540e\u8fb9\u7528\u7a7a\u683c\u5206\u9694\uff0c\u5982<code>MYSQL_VERSION</code>\u548c<code>MYSQL_MASTER</code></li> <li>\u2022 \u7ec4\u53d8\u91cf\u901a\u8fc7\u7ec4\u540d\u63a5<code>:vars</code>\u5b9a\u4e49\uff0c\u5982<code>[web:vars]</code></li> <li>\u2022 \u6240\u6709\u4e3b\u673a\u7684\u53d8\u91cf\u53ef\u4ee5\u901a\u8fc7<code>[all:vars]</code>\u6765\u5b9a\u4e49</li> </ul> <p>\u4e5f\u53ef\u7528 yaml \u683c\u5f0f\u5b9a\u4e49\u4e3b\u673a\u6e05\u5355</p> <pre><code>ungrouped:\n  hosts:\n    server1:\n      MYSQL_VERSION: 5.7\n      MYSQL_MASTER: true\n\nweb:\n  hosts:\n    server2:\n    server3:\n  vars:\n    HTTPD_VERSION: 2.4\n\nall:\n  vars:\n    SYSTEM_TYPE: RHEL\n</code></pre> <p><code>sssd_packages</code>\u5c31\u662f\u5b9a\u4e49\u7684\u53d8\u91cf</p> <p>\u901a\u8fc7 <code>set_fact</code> \u6a21\u5757\u8bbe\u7f6e</p> <pre><code>- name: set fact\n  hosts: localhost\n  gather_facts: false\n  tasks:\n  - name: set fact\n    ansible.builtin.set_fact:\n      var1: one\n      var2:\n      - two\n      - three\n  - name: print vars\n    ansible.builtin.debug:\n      msg: \"{{ var1 }} and {{ var2 }} \"\n</code></pre> <p>var1 \u548c var2 \u90fd\u662f\u901a\u8fc7<code>set_fact</code>\u6a21\u5757\u8bbe\u7f6e\u7684\u53d8\u91cf\uff0c\u901a\u8fc7<code>set_fact</code>\u8bbe\u7f6e\u7684\u53d8\u91cf\u53ef\u4ee5\u7ed9\u540e\u7eed\u7684\u6a21\u5757\u4f7f\u7528\u3002</p> <p>\u901a\u8fc7\u6587\u4ef6\u8bbe\u7f6e\u53d8\u91cf</p> <p>\u81ea\u5b9a\u4e49\u53d8\u91cf\u6587\u4ef6</p> <pre><code>cat vars_file.yml\n---\nvar3: three\nvar4: four\n\ncat test.yml\n- name: set fact\n  hosts: localhost\n  gather_facts: false\n  vars_files:\n  - ./vars_file.yml\n  tasks:\n  - name: print vars\n    ansible.builtin.debug:\n      msg: \"{{ var3 }} and {{ var4 }} \"\n</code></pre> <p>\u5c06\u53d8\u91cf\u5199\u5165 <code>vars_file.yml</code> \u6587\u4ef6\uff0c\u5728 playbook \u4e2d\u901a\u8fc7 <code>vars_files</code> \u52a0\u8f7d\u53d8\u91cf\u6587\u4ef6</p> <p>\u8bbe\u7f6e\u4e3b\u673a\u53d8\u91cf</p> <pre><code>cat host_vars/localhost/vars.yml\n---\nHTTPD_VERSION: 2.4\ncat test.yml\n- name: set fact\n  hosts: localhost\n  gather_facts: false\n  tasks:\n  - name: print vars\n    ansible.builtin.debug:\n      msg: \"{{ HTTPD_VERSION }}\"\n</code></pre> <p>\u5728 Ansible \u914d\u7f6e\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u521b\u5efa\u4e00\u4e2a <code>host_vars</code> \u76ee\u5f55\uff0c\u5728 <code>host_vars</code> \u76ee\u5f55\u4e0b\u521b\u5efa\u548c\u6e05\u5355\u4e2d\u5bf9\u5e94\u540d\u79f0\u6216\u5730\u5740\u7684\u76ee\u5f55\uff0c\u5982<code>./host_vars/localhost/</code>\uff08\u8868\u793a\u8bbe\u7f6elocalhost\u4e3b\u673a\u7684\u53d8\u91cf\uff09\uff0c\u5728<code>./host_vars/localhost/</code>\u4e0b\u521b\u5efa\u4efb\u610f\u540d\u79f0\u7684\u6587\u4ef6\uff08\u6587\u4ef6\u53d6\u4ec0\u4e48\u540d\u5b57\u90fd\u53ef\u4ee5\uff0c\u6700\u597d\u4ee5<code>.yml</code>\u6216<code>.yaml</code>\u7ed3\u5c3e\uff0c\u65b9\u4fbf\u89c2\u770b\uff09\uff0c\u5c06\u53d8\u91cf\u5199\u5165\u6587\u4ef6\uff0c\u5982<code>./host_vars/localhost/vars.yml</code>\uff0cAnsible \u4f1a\u81ea\u52a8\u53d6\u8bfb\u53d6\u540c\u540d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0cPlaybook \u53ef\u4ee5\u76f4\u63a5\u5f15\u7528\u53d8\u91cf\u3002</p> <p>\u8bbe\u7f6e\u4e3b\u673a\u7ec4\u53d8\u91cf</p> <pre><code>cat inventory\n[webserver]\nserver1\nserver2\ncat group_vars/webserver/vars.yml\n---\nSYSTEM_TYPE: RHEL\ncat test.yml\n- name: set fact\n  hosts: webserver\n  gather_facts: false\n  tasks:\n  - name: print vars\n    ansible.builtin.debug:\n      msg: \"{{ SYSTEM_TYPE }}\"\n</code></pre> <p>\u548c <code>host_vars</code> \u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u4e3b\u673a\u6362\u6210\u4e86\u7ec4\u3002</p> <p>\u6ce8\u518c\u53d8\u91cf</p> <pre><code>cat test.yml\n- name: set fact\n  hosts: webserver\n  gather_facts: false\n  tasks:\n  - name: register\n    ansible.builtin.command: id\n    register: register_var\n  - name: print vars\n    ansible.builtin.debug:\n      msg: \"{{ register_var }}\"\n</code></pre> <p>\u5728\u6a21\u5757\u6267\u884c\u6210\u529f\u540e\u53ef\u4ee5\u901a\u8fc7register\u6765\u5c06\u8f93\u51fa\u6ce8\u518c\u4e3a\u53d8\u91cf\uff0c\u6ce8\u518c\u7684\u53d8\u91cf\u8f93\u51fa\u5982\u4e0b</p> <pre><code>ok: [server1] =&gt; {\n    \"msg\": {\n        \"ansible_facts\": {\n            \"discovered_interpreter_python\": \"/usr/libexec/platform-python\"\n        },\n        \"changed\": true,\n        \"cmd\": [\n            \"id\"\n        ],\n        \"delta\": \"0:00:00.004153\",\n        \"end\": \"2024-08-04 23:09:14.460466\",\n        \"failed\": false,\n        \"msg\": \"\",\n        \"rc\": 0,\n        \"start\": \"2024-08-04 23:09:14.456313\",\n        \"stderr\": \"\",\n        \"stderr_lines\": [],\n        \"stdout\": \"uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\",\n        \"stdout_lines\": [\n            \"uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\"\n        ]\n    }\n}\n</code></pre> <p>\u8fd9\u91cc\u6709\u4ef7\u503c\u7684\u51e0\u4e2a\u8f93\u51fa\u4e3afailed\u3001rc\u3001stderr\u3001stderr_lines\u3001stdout\u548cstdout_lines\uff0c\u8fd9\u51e0\u4e2a\u8f93\u51fa\u53ef\u7528\u4e8e\u5224\u65ad\u6267\u884c\u662f\u5426\u6210\u529f\u548c\u540e\u7eed\u6a21\u5757\u5bf9\u8fd9\u6b21\u6267\u884c\u7ed3\u679c\u5185\u5bb9\u7684\u5f15\u7528\u3002</p>"},{"location":"2025/sre/2ansible/#ansible-ad-hoc","title":"\u901a\u8fc7 Ansible Ad-Hoc \u8bbe\u7f6e\u53d8\u91cf","text":"<pre><code>ansible localhost -e SYSTEM_TYPE=RHEL -m debug -a 'msg=\"{{ SYSTEM_TYPE }}\"'\n</code></pre> <p>\u4f7f\u7528-e\u9009\u9879\u8bbe\u7f6e\u53d8\u91cf\uff0c\u4f18\u5148\u7ea7\u6700\u9ad8\u3002</p>"},{"location":"2025/sre/2ansible/#ansible-playbook_2","title":"Ansible Playbook \u5f15\u7528\u53d8\u91cf","text":"<p>\u901a\u8fc7<code>{{}}</code> \u5f15\u7528</p> <pre><code>---\n- name: set sssd\n  hosts: all\n  gather_facts: false\n  vars:\n    sssd_packages:\n    - sssd\n    - sssd-tools\n    - oddjob\n    - oddjob-mkhomedir\n    - libsss_sudo\n  tasks:\n  - name: install packages\n    ansible.builtin.yum:\n      name: \"{{ sssd_packages }}\"\n</code></pre> <p>playbook \u5728\u4f7f\u7528\u53d8\u91cf\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u53cc\u5f15\u53f7\u7684\u4f7f\u7528\uff0c\u5982\u679c\u67d0\u4e2a\u6bb5\u843d\u7684\u5f00\u5934\u5c31\u662f\u8c03\u7528\u53d8\u91cf\uff0c\u5373\u4ee5{{\u5f00\u5934\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6bb5\u843d\u5c31\u9700\u8981\u4f7f\u7528\u53cc\u5f15\u53f7\u5f15\u8d77\u6765\uff0c\u4f46\u5982\u679c\u5f00\u59cb\u662f\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u53ef\u4ee5\u4e0d\u4f7f\u7528\u53cc\u5f15\u53f7\u3002</p> <pre><code>---\n- name: vars example\n  hosts: all\n  vars:\n    var1: one\n    var2: two\n  tasks:\n  - name: debug1\n    ansible.builtin.debug:\n      msg: vars is {{ var1 }} and {{ var2 }}\n  - name: debug2\n    ansible.builtin.debug:\n      msg: \"{{ var1 }} and {{ var2 }}\"\n</code></pre> <p>template \u6a21\u5757\u4e5f\u53ef\u4ee5\u4f7f\u7528\u53d8\u91cf\uff0c\u4f7f\u7528\u65b9\u6cd5\u548c\u4e0a\u8fb9\u4e00\u6837\u3002</p>"},{"location":"2025/sre/2ansible/#_17","title":"\u901a\u8fc7 [] \u5f15\u7528","text":"<p><code>[]</code>\u5f15\u7528\u548c<code>{{}}</code>\u7684\u533a\u522b\u5c31\u662f<code>[]</code>\u5185\u7684\u503c\u4f1a\u88ab\u5f53\u6210\u53d8\u91cf\u5904\u7406\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>---\n- name: test\n  hosts: localhost\n  vars:\n    netcard: ens18\n  tasks:\n  - name: loop list\n    debug:\n      msg: \"{{ ansible_facts[netcard].ipv4.address }}\"\n</code></pre> <p>\u4e0a\u8fb9\u7684<code>\"{{ ansible_facts[netcard].ipv4.address }}\"</code>\u4f7f\u7528\u4e86<code>[]</code>\uff0cnetcard\u4e5f\u4f1a\u88ab\u201d\u6210\u53d8\u91cf\u5904\u7406\uff0c\u5b9e\u9645\u8981\u6253\u5370\u7684\u53d8\u91cf\u4e3a<code>ansible_facts.ens18.ipv4.address</code>\u3002</p> <p>\u6709\u7684\u5730\u65b9\u5728\u5f15\u7528\u53d8\u91cf\u662f\u4f1a\u4f7f\u7528['']\uff0c\u8fd9\u4e2a\u56e0\u4e3a\u5e26\u6709''\uff0c\u6240\u4ee5\u91cc\u8fb9\u7684\u503c\u4e0d\u4f1a\u5f53\u6210\u53d8\u91cf\u5904\u7406\uff0c\u6bd4\u5982\uff1aansible_facts['ens18']ipv4.address\u5c31\u662fansible_facts.ens18.ipv4.address\u3002</p> <p>\u6ce8\u610f\u4f7f\u7528[]\u65f6\uff0c\u5de6\u8fb9\u662f\u6ca1\u6709.\u7684\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1aansible_facts[netcard].ipv4['address']\u3002</p>"},{"location":"2025/sre/2ansible/#9-ansible","title":"9 Ansible \u4e8b\u5b9e\u53d8\u91cf\u548c\u9b54\u6cd5\u53d8\u91cf","text":"<p>\u4e8b\u5b9e\u53d8\u91cf</p> <p>\u987e\u540d\u601d\u4e49\u4e8b\u5b9e\u53d8\u91cf\u5c31\u662f\u6839\u636e\u4e8b\u5b9e\u5b9a\u4e49\u7684\u53d8\u91cf\u3002\u6bd4\u65b9\u8bf4\u88ab\u63a7\u4e3b\u673a\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5982 cpu\u3001\u5185\u5b58\u3001\u786c\u76d8\u3001IP \u548c\u7cfb\u7edf\u7248\u672c\u7b49\u4fe1\u606f\u3002</p>"},{"location":"2025/sre/2ansible/#_18","title":"\u9ed8\u8ba4\u7684\u4e8b\u5b9e\u53d8\u91cf","text":"<p><code>ansible_facts</code> \u662f Ansible \u7684\u4e8b\u5b9e\u53d8\u91cf\u3002</p> <pre><code>ansible localhost -m ansible.builtin.setup\n</code></pre> <p>\u901a\u8fc7 ansible.builtin.setup \u53ef\u4ee5\u67e5\u770b\u53d7\u63a7\u4e3b\u673a\u7684\u4e8b\u5b9e\u53d8\u91cf\u3002</p> <pre><code>ansible localhost -m ansible.builtin.setup -a 'filter=ansible_distribution'\nansible localhost -m ansible.builtin.setup -a 'filter=ansible_distribution_file_variety'\nansible localhost -m ansible.builtin.setup -a 'filter=ansible_distribution_major_version'\nansible localhost -m ansible.builtin.setup -a 'filter=ansible_distribution_version'\n</code></pre> <p>\u901a\u8fc7 <code>-a 'filter=ansible_distribution\u2019`` \u6765\u8fdb\u884c\u8fc7\u6ee4\uff0c\u6240\u6709</code>ansible.builtin.setup` \u6a21\u5757\u770b\u5230\u7684\u53d8\u91cf\u90fd\u53ef\u4ee5\u5f15\u7528\u3002</p> <p>\u901a\u8fc7 <code>-a 'filter=ansible_distribution\u2019</code> \u6765\u8fdb\u884c\u8fc7\u6ee4\uff0c\u6240\u6709 <code>ansible.builtin.setup</code> \u6a21\u5757\u770b\u5230\u7684\u53d8\u91cf\u90fd\u53ef\u4ee5\u5f15\u7528\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>[root@awx-1 ansible]# ansible localhost -m ansible.builtin.setup -a 'filter=ansible_python'\nlocalhost | SUCCESS =&gt; {\n    \"ansible_facts\": {\n        \"ansible_python\": {\n            \"executable\": \"/usr/bin/python3.11\",\n            \"has_sslcontext\": true,\n            \"type\": \"cpython\",\n            \"version\": {\n                \"major\": 3,\n                \"micro\": 5,\n                \"minor\": 11,\n                \"releaselevel\": \"final\",\n                \"serial\": 0\n            },\n            \"version_info\": [\n                3,\n                11,\n                5,\n                \"final\",\n                0\n            ]\n        }\n    },\n    \"changed\": false\n}\n[root@awx-1 ansible]# ansible localhost -m ansible.builtin.setup -a 'filter=ansible_python.version'\nlocalhost | SUCCESS =&gt; {\n    \"ansible_facts\": {},\n    \"changed\": false\n}\n[root@awx-1 ansible]# ansible localhost -m ansible.builtin.setup -a 'filter=ansible_python.version'\nlocalhost | SUCCESS =&gt; {\n    \"ansible_facts\": {},\n    \"changed\": false\n}\n[root@awx-1 ansible]# ansible localhost -m ansible.builtin.debug -a 'var=ansible_python.version'\nlocalhost | SUCCESS =&gt; {\n    \"ansible_python.version\": {\n        \"major\": 3,\n        \"micro\": 5,\n        \"minor\": 11,\n        \"releaselevel\": \"final\",\n        \"serial\": 0\n    }\n}\n</code></pre> <p>\u81ea\u5b9a\u4e49\u4e8b\u5b9e\u53d8\u91cf</p> <pre><code>cat /etc/ansible/facts.d/install.fact\n[install]\ninstall_date=2024-8-4\n\ncat /etc/ansible/facts.d/uptime.fact\n{\n  \"uptime\": {\n    \"time\": \"10d\",\n    \"health\": \"true\"\n  }\n}\n\n</code></pre> <p>\u5728\u53d7\u63a7\u4e3b\u673a\u521b\u5efa <code>/etc/ansible/facts.d/</code>\uff0c\u5728 <code>/etc/ansible/facts.d/</code> \u76ee\u5f55\u4e0b\u521b\u5efa\u53d8\u91cf\u6587\u4ef6\uff08\u5fc5\u987b\u4ee5 .fact \u7ed3\u5c3e\uff09\uff0c\u5982 <code>/etc/ansible/facts.d/install.fact</code>\uff0c\u6587\u4ef6\u5185\u5bb9\u53ef\u4ee5\u662f INI \u683c\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u662f JSON \u683c\u5f0f\u3002</p> <pre><code>ansible localhost -m setup -a 'filter=ansible_local'\nlocalhost | SUCCESS =&gt; {\n    \"ansible_facts\": {\n        \"ansible_local\": {\n            \"install_vars\": {\n                \"install\": {\n                    \"install_date\": \"2024-8-4\"\n                }\n            },\n            \"uptime_vars\": {\n                \"uptime\": {\n                    \"health\": \"true\",\n                    \"time\": \"10d\"\n                }\n            }\n        }\n    },\n    \"changed\": false\n}\n</code></pre> <p>\u901a\u8fc7 <code>-a 'filter=ansible_local'</code>\u53ef\u4ee5\u67e5\u627e\u81ea\u5b9a\u4e49\u4e8b\u5b9e\u53d8\u91cf\uff0c<code>ansible_local</code> \u8868\u793a\u81ea\u5b9a\u4e49\u4e8b\u5b9e\u53d8\u91cf\uff0c<code>install_vars</code> \u548c\u81ea\u5b9a\u4e49\u4e8b\u5b9e\u53d8\u91cf\u6587\u4ef6\u540d\u5bf9\u5e94\uff0cinstall \u5bf9\u5e94\u6587\u4ef6\u91cc\u7684 <code>[install]\uff0c\"install_date\": \"2024-8-4\u201d</code> \u5bf9\u5e94\u6587\u4ef6\u91cc\u7684 <code>install_date=2024-8-4</code></p> <pre><code>ansible localhost -m ansible.builtin.debug -a 'msg=\"{{ ansible_local.uptime_vars.uptime.time }}\"'\nansible localhost -m ansible.builtin.debug -a 'var=ansible_local.uptime_vars.uptime.time'\n</code></pre> <p>\u6253\u5370\u53d8\u91cf\u7684\u65f6\u5019\u4f7f\u7528 ansible.builtin.debug \u6a21\u5757\u6253\u5370\u6bd4\u8f83\u65b9\u4fbf.</p>"},{"location":"2025/sre/2ansible/#_19","title":"\u9b54\u6cd5\u53d8\u91cf","text":"<p>https://docs.ansible.com/ansible/latest/reference_appendices/special_variables.html#magic-variables</p> <p>Ansible \u9b54\u6cd5\u53d8\u91cf\u662f\u53cd\u6620\u5f53\u524d\u7684\u4e00\u4e9b\u72b6\u6001\u7684\u53d8\u91cf\uff0c\u5982\u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\u3001Ansible \u7248\u672c\u3001Python \u7248\u672c\u3001\u5f53\u524d\u4e3b\u673a\u5728\u4e3b\u673a\u6e05\u5355\u4e2d\u7684\u540d\u5b57\u548c\u6240\u5c5e\u4e3b\u673a\u7ec4\uff0c\u8fd9\u4e9b\u53d8\u91cf\u7684\u503c\u90fd\u662f\u968f\u7740\u914d\u7f6e\u6587\u4ef6\u6216\u4e3b\u673a\u6e05\u5355\u7b49\u6765\u786e\u5b9a\u7684\uff0c\u53ef\u4ee5\u7528 <code>ansible all -m debug -a 'var=hostvars\u2019</code> \u6765\u67e5\u770b\u6240\u6709\u9b54\u6cd5\u53d8\u91cf</p> <pre><code>#\u67e5\u770b\u6240\u6709\u9b54\u6cd5\u53d8\u91cf\nansible all -m debug -a 'var=hostvars'\n\n#\u67e5\u770b\u4e3b\u673a\u6e05\u5355\u4e2d\u8bbe\u7f6e\u7684\u4e3b\u673a\u540d\nansible all -m debug -a 'var=inventory_hostname'\n\n#\u67e5\u770b\u4e3b\u673a\u6240\u5c5e\u7ec4\nansible all -m debug -a 'var=group_names'\n</code></pre> <p>\u4e0a\u8fb9\u5217\u51fa\u51e0\u4e2a\u67e5\u770b\u7684\u4f8b\u5b50\uff0c\u5176\u4ed6\u7684\u4ee5\u6b64\u7c7b\u63a8\u3002</p>"},{"location":"2025/sre/2ansible/#_20","title":"\u9b54\u6cd5\u53d8\u91cf\u548c\u4e8b\u5b9e\u53d8\u91cf\u7684\u533a\u522b","text":"<p>\u6211\u81ea\u5df1\u7684\u7406\u89e3\uff0c\u4e8b\u5b9e\u53d8\u91cf\u8bb0\u5f55\u7740\u5f53\u524d\u53d7\u63a7\u4e3b\u673a\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u6bd4\u5982CPU\u3001\u5185\u5b58\u3001\u786c\u76d8\uff0c\u5f53\u524d\u4e3b\u673a\u7684 python \u7248\u672c\uff0c\u8fd9\u4e9b\u53d8\u91cf\u90fd\u662f\u4ece\u53d7\u63a7\u4e3b\u673a\u91c7\u96c6\u7684\u4fe1\u606f\uff0c\u6240\u4ee5\u5b83\u4eec\u7684\u503c\u4f1a\u968f\u7740\u53d7\u63a7\u4e3b\u673a\u7684\u6539\u53d8\u800c\u6539\u53d8\uff0cAnsible \u662f\u6ca1\u6709\u529e\u6cd5\u5728 server2 \u4e3b\u673a\u4e0a\u4f7f\u7528 server1 \u7684\u4e8b\u5b9e\u53d8\u91cf\u7684\u3002</p> <p>\u4f46\u662f\u9b54\u6cd5\u53d8\u91cf\u4e0d\u4e00\u6837\uff0c\u5982\u53d7\u63a7\u4e3b\u673a\u5728\u4e3b\u673a\u6e05\u5355\u7684\u540d\u5b57\u3001\u4e3b\u673a\u7ec4\u540d\u5b57\u3001Ansible \u7684\u914d\u7f6e\u6587\u4ef6\u3001\u63a7\u5236\u8282\u70b9\u7684 python \u8def\u5f84\u7b49\uff0c\u8fd9\u4e9b\u90fd\u662f\u53d7 Ansible \u914d\u7f6e\u6587\u4ef6\u6216\u4e3b\u673a\u6e05\u5355\u6765\u914d\u7f6e\u7684\uff0c\u56e0\u4e3a\u5728 Ansible \u914d\u7f6e\u6587\u4ef6\u548c\u4e3b\u673a\u6e05\u5355\u786e\u5b9a\u4e4b\u540e\uff0c\u9b54\u6cd5\u53d8\u91cf\u7684\u503c\u4e5f\u90fd\u786e\u5b9a\u4e86\uff0c\u6240\u4ee5\u662f\u53ef\u4ee5\u5728 server2 \u4e0a\u4f7f\u7528 server1 \u7684\u9b54\u6cd5\u53d8\u91cf\u7684\uff0c\u4f8b\u5982\uff1a</p> <pre><code>ansible server1,server2 -m debug -a 'var=hostvars.server1.inventory_hostname'\n</code></pre> <p>\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u5728 server1 \u548c server2 \u90fd\u8f93\u51fa server1\u3002</p> <p>\u518d\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>[root@awx-1 ansible]# cat hosts\nservera ansible_ssh_host=127.0.0.1 ansible_ssh_user=root ansible_ssh_password=redhat\n[root@awx-1 ansible]# ansible servera -i hosts -m ansible.builtin.debug -a 'var=hostvars.servera.inventory_hostname'\nservera | SUCCESS =&gt; {\n    \"hostvars.servera.inventory_hostname\": \"servera\"\n}\n[root@awx-1 ansible]# ansible servera -i hosts -m ansible.builtin.debug -a 'var=ansible_hostname'\nservera | SUCCESS =&gt; {\n    \"ansible_hostname\": \"awx-1\"\n}\n</code></pre> <p>\u4e3b\u673a\u6e05\u5355\u91cc\u6709 servera \u4e3b\u673a\uff0c\u901a\u8fc7 servera \u4e3b\u673a\u67e5\u770b\u9b54\u6cd5\u53d8\u91cf\u5c31\u80fd\u770b\u5230 servera\uff0c\u8fd9\u4e2a\u53d8\u91cf\u5c31\u662f\u901a\u8fc7\u4e3b\u673a\u6e05\u5355\u5b9a\u4e49\u7684\uff0c\u8ddf\u88ab\u63a7\u4e3b\u673a\u7684\u914d\u7f6e\u6ca1\u6709\u4efb\u4f55\u5173\u7cfb\u3002</p>"},{"location":"2025/sre/2ansible/#10-ansible","title":"10 Ansible \u53d8\u91cf\u7684\u4f18\u5148\u7ea7\u3001\u5224\u65ad\u548c\u5faa\u73af","text":"<p>\u4f18\u5148\u7ea7\u662f\u4ece\u9ad8\u5230\u4f4e</p> <ol> <li>\u547d\u4ee4\u884c\u8bbe\u7f6e\u7684\u53d8\u91cf\u4f18\u5148\u7ea7\u6700\u9ad8</li> <li>role \u4e2d\u7684 vars \u53d8\u91cf</li> <li>playbook \u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf\u5176\u6b21</li> <li><code>host_vars</code> \u76ee\u5f55\u548c <code>group_vars</code> \u76ee\u5f55\u7684\u53d8\u91cf\uff08<code>host_vars</code> \u4f18\u5148\u4e8e <code>group_vars</code>\uff09</li> <li>inventory \u53d8\u91cf</li> <li> <p>role \u4e2d\u7684 default \u53d8\u91cf</p> </li> <li> <p>\u2022 \u53d8\u91cf\u540d\u76f8\u540c\uff0c\u9ad8\u4f18\u5148\u7ea7\u4f1a\u8986\u76d6\u4f4e\u4f18\u5148\u7ea7\u53d8\u91cf</p> </li> <li>\u2022 \u53d8\u91cf\u540d\u76f8\u540c\uff0c\u4e3b\u673a\u53d8\u91cf\u4f1a\u8986\u76d6\u4e3b\u673a\u7ec4\u53d8\u91cf</li> <li>\u2022 \u53d8\u91cf\u540d\u76f8\u540c\uff0c\u5b50\u7ec4\u8986\u76d6\u5d4c\u5957\u7ec4\u7684\u53d8\u91cf</li> </ol> <p>\u611f\u89c9\u53ea\u8981\u53d8\u91cf\u4e0d\u91cd\u540d\u5e94\u8be5\u5c31\u4e0d\u6d89\u53ca\u4f18\u5148\u7ea7\u95ee\u9898\u3002</p>"},{"location":"2025/sre/2ansible/#_21","title":"\u53d8\u91cf\u7684\u6761\u4ef6\u5224\u65ad","text":"<p>\u5224\u65ad\u7684\u7c7b\u578b</p> <p>\u9488\u5bf9\u53d8\u91cf\u6709\u4ee5\u4e0b\u5224\u65ad\u65b9\u6cd5\uff1a</p> <pre><code>\u7b49\u4e8e\uff08\u5b57\u7b26\u4e32\uff09 \nansible_machine == \"x86_64\"\n\n\u7b49\u4e8e\uff08\u6570\u5b57\uff09  \nansible_distribution_major_version == 8\n\n\u5c0f\u4e8e  \nansible_memfree_mb &lt; 1024\n\n\u5927\u4e8e  \nansible_memfree_mb &gt; 1024\n\n\u5c0f\u4e8e\u7b49\u4e8e    \nansible_memfree_mb &lt;= 1024\n\n\u5927\u4e8e\u7b49\u4e8e    \nansible_memfree_mb &gt;= 1024\n\n\u4e0d\u7b49\u4e8e \nansible_memfree_mb != 1024\n\n\u53d8\u91cf\u5b58\u5728    \ncustom_var is defined\n\n\u53d8\u91cf\u4e0d\u5b58\u5728   \ncustom_var is not defined\n\n\u5e03\u5c14\u53d8\u91cf\u4e3a True\u3002True\u3001Yes \u6216 1 \nansible_selinux_python_present\n\n\u5e03\u5c14\u53d8\u91cf\u4e3a False\u3002False\u3001No \u6216 0    \nnot ansible_selinux_python_present\n\n\u7b2c\u4e00\u4e2a\u53d8\u91cf\u5b58\u5728\uff0c\u4e14\u5728\u7b2c\u4e8c\u4e2a\u53d8\u91cf\u7684\u5217\u8868\u91cc \nansible_distribution in supported_distros\n\n\u53d8\u91cf\u662f\u5426\u4e3a\u7a7a  \ncustom_var == \"\"\n\n\u53d8\u91cf\u662f\u5426\u4e0d\u4e3a\u7a7a \ncustom_var != \"\"\n\n\u53d8\u91cf\u662f\u8def\u5f84\u65f6\u7684\u6587\u4ef6\u7c7b\u578b \ncustom_var is file (directory\u3001link\u3001mount\u3001exists)\n</code></pre> <p>\u901a\u8fc7 ansible -e \u6216 ansible-playbook -e \u8bbe\u7f6e\u7684\u53d8\u91cf\u4e3a\u5b57\u7b26\u4e32\u3002</p> <p>\u5e03\u5c14\u53d8\u91cf\u9700\u8981\u7528 var=true \u548c var=false \u8bbe\u7f6e\u3002</p> <p>\u6570\u5b57\u9700\u8981\u901a\u8fc7 json \u65b9\u5f0f\u8bbe\u7f6e\uff1a'{ \"var\": 100 }'\u3002</p> <p>\u5224\u65ad\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528\uff0c\u6bd4\u5982\uff1a</p> <pre><code>custom_var is defined and custom_var == \"RedHat\"\n\nansible_distribution == \"Rocky\" or (custom_var is defined and custom_var == \"Linux\")\n</code></pre> <p>\u591a\u4e2a\u5224\u65ad\u53ef\u4ee5\u7528\u5217\u8868</p> <pre><code>when:\n  - my_var is defined\n  - my_var == 'abc'\n</code></pre> <p>\u4f8b\u5b50</p> <pre><code>---\n- name: test\n  hosts: localhost\n  tasks:\n  - name: test\n    debug:\n      msg:\n      - \"{{ ansible_facts.hostname }}\"\n    when: ansible_distribution == \"Rocky\" or (custom_var is defined and custom_var == \"Linux\")\n</code></pre>"},{"location":"2025/sre/2ansible/#_22","title":"\u5217\u8868\u53d8\u91cf\u548c\u5b57\u5178\u53d8\u91cf","text":"<p>\u5217\u8868\u53d8\u91cf\u548c\u5b57\u5178\u53d8\u91cf</p>"},{"location":"2025/sre/2ansible/#_23","title":"\u5217\u8868","text":"<p>\u5217\u8868\u662f\u4e00\u4e2a\u6709\u5e8f\u7684\u5143\u7d20\u96c6\u5408\uff0c\u5143\u7d20\u53ef\u4ee5\u662f\u6570\u5b57\u3001\u5b57\u7b26\u4e32\u3001\u5b57\u5178\u3001\u751a\u81f3\u662f\u53e6\u4e00\u4e2a\u5217\u8868\u3002\u53ef\u4ee5\u901a\u8fc7\u4e0b\u6807\u8bbf\u95ee\u5217\u8868\u7684\u5143\u7d20\u3002</p> <p>\u4ee5\u4e0b\u662f\u5217\u8868\u53d8\u91cf\u5b9a\u4e49\u7684\u65b9\u5f0f\uff1a</p> <pre><code>list_var1:\n- var1\n- var2\n- var3\n\nlist_var2: [ \"var4\", \"var5\", \"var6\" ]\n</code></pre>"},{"location":"2025/sre/2ansible/#_24","title":"\u5b57\u5178","text":"<p>\u5b57\u5178\u662f\u4e00\u4e2a\u65e0\u5e8f\u7684\u952e\u503c\u5bf9\u96c6\u5408\uff0c\u6bcf\u4e2a\u952e\u90fd\u6709\u5bf9\u5e94\u7684\u503c\u3002\u5b57\u5178\u53ef\u4ee5\u5d4c\u5957\uff0c\u952e\u548c\u503c\u7684\u7c7b\u578b\u53ef\u4ee5\u662f\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u3002</p> <p>\u4ee5\u4e0b\u662f\u5b57\u5178\u53d8\u91cf\u5b9a\u4e49\u7684\u65b9\u5f0f</p> <pre><code>dict_var1:\n  var7: 7\n  var8: \"eight\"\n\ndict_var2: { var9: \"nine\", var10: 10 }\n</code></pre>"},{"location":"2025/sre/2ansible/#_25","title":"\u5217\u8868\u548c\u5b57\u5178\u7684\u6df7\u5408","text":"<pre><code>list_var:\n- var1: 1\n- var2: \"two\"\ndict_var:\n  var3:\n  - var3_1\n  - var3_2\n  var4: \"four\"\n</code></pre>"},{"location":"2025/sre/2ansible/#_26","title":"\u904d\u5386\u53d8\u91cf","text":"<p>\u904d\u5386\u53d8\u91cf\u901a\u8fc7 loop \u5b9e\u73b0\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e2a\u5728 Playbook \u904d\u5386\u53d8\u91cf\u7684\u4f8b\u5b50\uff1a</p> <pre><code>---\n- name: test\n  hosts: localhost\n  vars:\n    user_list:\n    - name: \"root\"\n      password: \"redhat\"\n      host: \"192.168.1.1\"\n    - name: \"admin\"\n      password: \"redhat\"\n      host: \"192.168.1.2\"\n  tasks:\n  - name: loop list\n    debug:\n      msg: \"{{ item }}\"\n    loop: \"{{ user_list }}\"\n  - name: loop list.name\n    debug:\n      msg: \"{{ item.name }}\"\n    loop: \"{{ user_list }}\"\n</code></pre> <p>\u65e9\u7248\u672c\u7684 Ansible \u53ef\u80fd\u4f1a\u6709 <code>with_items</code> \u6216 <code>with_dict</code>\uff0c\u4e0d\u8fc7\u5df2\u7ecf\u88ab\u6dd8\u6c70\u4e86\uff08\u53ef\u80fd\u8fd8\u652f\u6301\uff09\uff0c\u65b0\u7248\u672c\u7edf\u4e00\u7528 loop\u3002</p>"},{"location":"2025/sre/2ansible/#11-ansible-ansible-doc","title":"11 Ansible \u901a\u8fc7 ansible-doc \u67e5\u8be2\u6a21\u5757\u9009\u9879\u548c\u4f7f\u7528\u6848\u4f8b","text":""},{"location":"2025/sre/2ansible/#_27","title":"\u6a21\u5757\u9009\u9879\u67e5\u8be2\u8bf4\u660e","text":"<p>\u6a21\u5757\u9009\u9879\u67e5\u8be2\u8bf4\u660e</p> <pre><code>[root@awx-1 ansible]# ansible --version\nansible [core 2.16.3]\n  config file = /root/ansible/ansible.cfg\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /usr/lib/python3.12/site-packages/ansible\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\n  executable location = /usr/bin/ansible\n  python version = 3.12.8 (main, Dec 12 2024, 16:30:29) [GCC 8.5.0 20210514 (Red Hat 8.5.0-22)] (/usr/bin/python3.12)\n  jinja version = 3.1.2\n  libyaml = True\n</code></pre> <p>Ansible \u7248\u672c\uff1a2.16.3</p> <p>Python \u7248\u672c\uff1a3.12.8</p> <p>\u540e\u8fb9\u4f1a\u5199\u4e00\u4e9b\u5e38\u7528\u6a21\u5757\u7684\u5e38\u7528\u9009\u9879\u548c\u4f7f\u7528\u4f8b\u5b50\uff0c\u5168\u90e8\u90fd\u57fa\u4e8e\u8fd9\u4e2a\u7248\u672c\u5199\u7684\u3002</p>"},{"location":"2025/sre/2ansible/#ansible-doc_1","title":"\u901a\u8fc7 ansible-doc \u67e5\u8be2\u6a21\u5757","text":"<p>\u901a\u8fc7 <code>ansible-doc -l</code> \u53ef\u4ee5\u5217\u51fa\u5f53\u524d\u6240\u6709\u53ef\u7528\u6a21\u5757\uff1a</p> <pre><code>[root@awx-1 ansible]# ansible-doc -l | grep ansible.builtin | head\nansible.builtin.add_host                                                                         Add a host (and alternatively a group) to the ansible-playbo...\nansible.builtin.apt                                                                              ...\nansible.builtin.apt_key                                                                          Ad...\nansible.builtin.apt_repository                                                                   Add and r...\nansible.builtin.assemble                                                                         Assemble configuratio...\nansible.builtin.assert                                                                           Asserts give...\nansible.builtin.async_status                                                                     Obtain statu...\nansible.builtin.blockinfile                                                                      Insert/update/remove a text block surr...\nansible.builtin.command                                                                          Execu...\nansible.builtin.copy                                                                             Copy fil...\n</code></pre> <p>\u901a\u8fc7 <code>ansible-doc ansible.builtin.yum</code> \u53ef\u4ee5\u67e5\u8be2 <code>ansible.builtin.yum</code> \u4f7f\u7528\u8bf4\u660e\uff1a</p> <pre><code>[root@awx-1 ansible]# ansible-doc ansible.builtin.yum\n</code></pre> <p>\u67e5\u8be2\u7684\u4fe1\u606f\u6709\u4ee5\u4e0b\u91cd\u8981\u6bb5\u843d\uff08\u6bd4\u65b9\u8bf4\u901a\u8fc7 /EXAMPLE \u6765\u641c\u7d22\u4f8b\u5b50\uff09\uff1a</p> <p>OPTIONS\uff1a\u53ef\u7528\u9009\u9879\uff08\u9009\u9879\uff09\u9488\u5bf9 OPTIONS\uff0c\u6709\u4e24\u4e2a\u91cd\u8981\u7684\u5c5e\u6027\uff1a</p> <p>type\uff1a\u5b9a\u4e49\u4e86\u9009\u9879\u7684\u6570\u636e\u7ed3\u6784\uff08list/str/bool \u7b49\uff09</p> <p>\u6bd4\u5982 <code>ansible.builtin.yum</code> \u6a21\u5757\u7684 name \u9009\u9879\u7684 type \u4e3a list\uff0c\u6240\u4ee5\u5199\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>- name: Download the nginx package but do not install it\n  ansible.builtin.yum:\n    name:\n      - nginx\n      - mysql\n    state: latest\n</code></pre> <ul> <li>\u2022 list\uff1a\u5217\u8868</li> <li>\u2022 str\uff1a\u5b57\u7b26\u4e32</li> <li>\u2022 bool\uff1a\u5e03\u5c14\u503c\uff08yes/no\u3001true/false\uff09</li> </ul> <p>\u2022 default\uff1a\u5b9a\u4e49\u9009\u9879\u7684\u9ed8\u8ba4\u503c</p> <p>\u901a\u8fc7 <code>ansible-doc -s ansible.builtin.yum</code> \u53ef\u4ee5\u5217\u51fa\u6a21\u5757\u6240\u6709\u9009\u9879\uff1a</p> <pre><code>[root@awx-1 ansible]# ansible-doc -s ansible.builtin.yum\n</code></pre> <p>\u6211\u4e00\u822c\u7684\u4f7f\u7528\u4e60\u60ef\u5c31\u662f\u5148 ansible-doc ansible.builtin.yum\uff0c\u7136\u540e\u641c\u7d22 EXAMPLE\uff0c\u76f4\u63a5\u6284\u4f8b\u5b50\u3002</p>"},{"location":"2025/sre/2ansible/#12-0-ansible","title":"12 \u4ece 0 \u5f00\u59cb\u914d\u7f6e\u4e00\u4e2a Ansible \u73af\u5883","text":""},{"location":"2025/sre/2ansible/#_28","title":"\u8282\u70b9\u73af\u5883","text":"<p>\u7ba1\u7406\u8282\u70b9</p> <ul> <li>\u2022 \u7cfb\u7edf\u7248\u672c\uff1aRocky Linux release 8.10 (Green Obsidian)\uff0c\u6700\u5c0f\u5316\u5b89\u88c5</li> <li>\u2022 Python \u73af\u5883\uff1apython3.12</li> <li>\u2022 Ansible-core \u7248\u672c\uff1a2.15.13</li> </ul> <p>\u8fd9\u91cc\u4e3a\u4e86\u6f14\u793a\uff0c\u5b89\u88c5\u7684\u662f ansible-core\uff08\u53ea\u5e26\u57fa\u7840\u6a21\u5757\uff09\uff0c\u6b63\u5e38\u4f7f\u7528\u53ef\u4ee5\u5b89\u88c5 ansible\uff08\u5e26\u6709\u4e00\u4e9b\u6269\u5c55\u6a21\u5757\uff09\uff0c\u66f4\u65b9\u4fbf\u4f7f\u7528\u3002</p> <p>\u672c\u6b21\u5b89\u88c5\u901a\u8fc7 pip \u5b89\u88c5\u3002</p>"},{"location":"2025/sre/2ansible/#_29","title":"\u88ab\u63a7\u8282\u70b9","text":"<ul> <li>\u2022 \u7cfb\u7edf\u7248\u672c\uff1aRocky Linux release 8.10 (Green Obsidian)\uff0c\u6700\u5c0f\u5316\u5b89\u88c5</li> <li>\u2022 Python \u73af\u5883\uff1apython3.6</li> </ul> <p>\u4e09\u4e2a\u8282\u70b9\u5730\u5740\u5206\u522b\u4e3a\uff1a192.168.221.142\u3001192.168.221.143\u3001192.168.221.144\u3002</p> <p>Ansible \u5bf9 Python \u7248\u672c\u4f1a\u6709\u8981\u6c42\uff0c\u5982\u679c Ansible \u7248\u672c\u8fc7\u9ad8\uff0c\u800c\u88ab\u63a7\u8282\u70b9 Python \u7248\u672c\u8f83\u4f4e\uff0c\u53ef\u80fd\u4f1a\u5b58\u5728\u6a21\u5757\u6267\u884c\u5931\u8d25\u7684\u60c5\u51b5\u3002</p> <p>https://docs.ansible.com/ansible/latest/reference_appendices/release_and_maintenance.html#ansible-core-target-node-python-support</p>"},{"location":"2025/sre/2ansible/#_30","title":"\u914d\u7f6e\u57fa\u7840\u73af\u5883","text":"<pre><code># \u5b89\u88c5 Python \u548c \u4e24\u4e2a\u5e38\u7528\u57fa\u7840\u5305\n[root@ansible-controller ~]# dnf install -y vim bash-completion python3.12 python3.12-pip sshpass\n\n# \u5347\u7ea7 pip\n[root@ansible-controller ~]# python3.12 -m pip install --upgrade pip\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible_16","title":"\u5b89\u88c5 Ansible","text":"<pre><code># \u68c0\u67e5\u53ef\u7528 Ansible-core \u7248\u672c\n[root@ansible-controller ~]# python3.12 -m pip index versions ansible-core\nansible-core (2.18.5)\nAvailable versions: 2.18.5, 2.18.4, 2.18.3, 2.18.2, 2.18.1, 2.18.0, 2.17.11, 2.17.10, 2.17.9, 2.17.8, 2.17.7, 2.17.6, 2.17.5, 2.17.4, 2.17.3, 2.17.2, 2.17.1, 2.17.0, 2.16.14, 2.16.13, 2.16.12, 2.16.11, 2.16.10, 2.16.9, 2.16.8, 2.16.7, 2.16.6, 2.16.5, 2.16.4, 2.16.3, 2.16.2, 2.16.1, 2.16.0, 2.15.13, 2.15.12, 2.15.11, 2.15.10, 2.15.9, 2.15.8, 2.15.7, 2.15.6, 2.15.5, 2.15.4, 2.15.3, 2.15.2, 2.15.1, 2.15.0, 2.14.18, 2.14.17, 2.14.16, 2.14.15, 2.14.14, 2.14.13, 2.14.12, 2.14.11, 2.14.10, 2.14.9, 2.14.8, 2.14.7, 2.14.6, 2.14.5, 2.14.4, 2.14.3, 2.14.2, 2.14.1, 2.14.0, 2.13.13, 2.13.12, 2.13.11, 2.13.10, 2.13.9, 2.13.8, 2.13.7, 2.13.6, 2.13.5, 2.13.4, 2.13.3, 2.13.2, 2.13.1, 2.13.0, 2.12.10, 2.12.9, 2.12.8, 2.12.7, 2.12.6, 2.12.5, 2.12.4, 2.12.3, 2.12.2, 2.12.1, 2.12.0, 2.11.12, 2.11.11, 2.11.10, 2.11.9, 2.11.8, 2.11.7, 2.11.6, 2.11.5, 2.11.4, 2.11.3, 2.11.2, 2.11.1, 2.11.0\n\n# \u5b89\u88c5 Ansible-core\n[root@ansible-controller ~]# python3.12 -m pip install ansible-core==2.15.13 argcomplete\n...output omitted...\n\n# \u914d\u7f6e\u547d\u4ee4\u81ea\u52a8\u8865\u5168\n[root@ansible-controller ansible]# activate-global-python-argcomplete --user\nAdding shellcode to /root/.zshenv...\nAdded.\nAdding shellcode to /root/.bash_completion...\nAdded.\nPlease restart your shell or source the installed file to activate it.\n[root@ansible-controller ~]# exit\nlogout\n# \u91cd\u65b0\u6253\u5f00\u4e00\u4e2a\u547d\u4ee4\u884c\n\n# \u67e5\u770b\u5b89\u88c5\u7684 Ansible\n[root@ansible-controller ~]# ansible --version\nansible [core 2.15.13]\n  config file = /root/ansible_init/ansible.cfg\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /usr/local/lib/python3.12/site-packages/ansible\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\n  executable location = /usr/local/bin/ansible\n  python version = 3.12.8 (main, Dec 12 2024, 16:30:29) [GCC 8.5.0 20210514 (Red Hat 8.5.0-22)] (/usr/bin/python3.12)\n  jinja version = 3.1.6\n  libyaml = True\n\n# \u53ef\u4ee5\u770b\u5230\u53ea\u6709 70 \u4e2a\u57fa\u7840\u6a21\u5757\n[root@ansible-controller ~]# ansible-doc -l | wc -l\n74\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible_17","title":"\u914d\u7f6e Ansible \u521d\u59cb\u5316\u73af\u5883","text":"<p>\u8fd9\u91cc\u4e3b\u8981\u662f\u914d\u7f6e\u88ab\u63a7\u8282\u70b9\u652f\u6301\u8fd0\u884c Ansible \u6a21\u5757\uff0c\u4e3b\u8981\u662f\u5b89\u88c5 Python \u548c \u521b\u5efa Ansible \u8fde\u63a5\u8d26\u6237\u3002</p>"},{"location":"2025/sre/2ansible/#_31","title":"\u521d\u59cb\u5316\u88ab\u63a7\u8282\u70b9\u6a21\u5757\u6267\u884c\u73af\u5883","text":"<p>\u521b\u5efa\u4e00\u4e2a\u4e34\u65f6\u73af\u5883\uff0c\u7528\u4e8e\u7ed9\u88ab\u63a7\u8282\u70b9\u5b89\u88c5 Python \u548c\u521b\u5efa Ansible \u8fde\u63a5\u8d26\u6237\u3002</p> <pre><code># \u521b\u5efa ansible \u4e3b\u76ee\u5f55\n[root@ansible-controller ~]# mkdir ansible_init\n[root@ansible-controller ~]# cd ansible_init/\n\n# \u521b\u5efa\u914d\u7f6e\u6587\u4ef6\n[root@ansible-controller ansible_init]# cat ansible.cfg\n[defaults]\ninventory=./inventory\nbecome=false\nhost_key_checking=False\n\n# \u914d\u7f6e\u521d\u59cb\u5316\u914d\u7f6e\u7684\u4e3b\u673a\u6e05\u5355\n[root@ansible-controller ansible_init]# cat inventory\nmaster1 ansible_ssh_host=192.168.221.142 HOSTNAME=master1.example.com\nworker1 ansible_ssh_host=192.168.221.143 HOSTNAME=worker1.example.com\nworker2 ansible_ssh_host=192.168.221.144 HOSTNAME=worker2.example.com\n\n[all:vars]\nansible_ssh_user=root\nansible_ssh_password=redhat\n\n# \u6d4b\u8bd5\n[root@ansible-controller ansible_init]# ansible all -m raw -a id\nworker1 | CHANGED | rc=0 &gt;&gt;\nuid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\nShared connection to 192.168.221.143 closed.\n\nmaster1 | CHANGED | rc=0 &gt;&gt;\nuid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\nShared connection to 192.168.221.142 closed.\n\nworker2 | CHANGED | rc=0 &gt;&gt;\nuid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\nShared connection to 192.168.221.144 closed.\n\n# \u5b89\u88c5 python3\n[root@ansible-controller ansible_init]# ansible all -m raw -a 'dnf install -y python3'\n...output omitted...\n\n# \u6d4b\u8bd5\u6a21\u5757\n[root@ansible-controller ansible_init]# ansible all -m ping\n...output omitted...\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible_18","title":"\u6dfb\u52a0 Ansible \u7ba1\u7406\u7528\u6237","text":"<pre><code># \u6dfb\u52a0 Ansible \u7528\u6237\n[root@ansible-controller ~]# openssl passwd -6 -salt randomsalt redhat\n$6$randomsalt$nyZMZWZT9mAsW3O4fAAX66nk/RagLSUr4vq921cGE/hsqskAzcOJvaF4uvHUFxYnT1vBB9tGbR7UhEAhuVWu/0\n[root@ansible-controller ansible_init]# ansible all -m user \\\n    -a 'name=ansible uid=10000 groups=wheel append=true password=$6$randomsalt$nyZMZWZT9mAsW3O4fAAX66nk/RagLSUr4vq921cGE/hsqskAzcOJvaF4uvHUFxYnT1vBB9tGbR7UhEAhuVWu/0'\n...output omitted...\n</code></pre>"},{"location":"2025/sre/2ansible/#13-ansible","title":"13 \u2014\u2014 \u901a\u8fc7\u5bb9\u5668\u89e3\u51b3 Ansible \u7248\u672c\u517c\u5bb9\u6027\u95ee\u9898","text":""},{"location":"2025/sre/2ansible/#ansible_19","title":"\u901a\u8fc7\u5bb9\u5668\u89e3\u51b3 Ansible \u7248\u672c\u517c\u5bb9\u6027\u95ee\u9898","text":"<p>Ansible \u548c Python \u4e4b\u524d\u5b58\u50a8\u7248\u672c\u4f9d\u8d56\uff0c\u4e0d\u540c\u7248\u672c\u7684 Python \u652f\u6301\u7684 Ansible \u7248\u672c\u4e0d\u4e00\u6837\u3002</p> <p>https://docs.ansible.com/ansible/latest/reference_appendices/release_and_maintenance.html#ansible-core-control-node-python-support</p> <p>https://docs.ansible.com/ansible/latest/reference_appendices/release_and_maintenance.html#ansible-core-target-node-python-support</p> <p>Ansible \u4e0e Python \u7248\u672c\u4e0d\u517c\u5bb9\u5bfc\u81f4\u6267\u884c\u5931\u8d25\u7684\u95ee\u9898\uff0c\u6bd4\u65b9\u8bf4 Ansible \u7248\u672c\u4e3a 3.18.2\uff0c\u88ab\u63a7\u8282\u70b9 Python \u5206\u522b\u4e3a 3.12.0 \u548c 3.6.8\uff0c\u5bf9 3.6.8 Python \u7248\u672c\u7684\u88ab\u63a7\u8282\u70b9\u6267\u884c\u4efb\u52a1\u65f6\u4f1a\u6709 Python \u62a5\u9519\u5bfc\u81f4\u4efb\u52a1\u6267\u884c\u5931\u8d25\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cAnsible \u63d0\u51fa\u4e86\u901a\u8fc7\u5bb9\u5668\u6267\u884c Ansible \u4efb\u52a1\u7684\u65b9\u5f0f</p> <p></p>"},{"location":"2025/sre/2ansible/#ansible_20","title":"Ansible \u6267\u884c\u73af\u5883\u6f14\u793a","text":"<pre><code>[root@study ansible]# ansible all --list-hosts\n  hosts (2):\n    servera\n    serverb\n</code></pre> <p>\u8fd9\u4e24\u53f0\u670d\u52a1\u5668\u7684 python \u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u5176\u4e2d servera \u4e3a\u5f53\u524d Ansible \u63a7\u5236\u8282\u70b9\uff1a</p> <pre><code>[root@study ansible]# ansible --version\nansible [core 2.18.2]\n  config file = /root/ansible1/ansible.cfg\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /usr/local/python/lib/python3.12/site-packages/ansible\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\n  executable location = /usr/local/python/bin/ansible\n  python version = 3.12.0 (main, Oct  8 2023, 15:41:59) [GCC 8.5.0 20210514 (Red Hat 8.5.0-18)] (/usr/local/python/bin/python3.12)\n  jinja version = 3.1.2\n  libyaml = True\n[root@study ansible]# ssh servera\nroot@servera's password:\nActivate the web console with: systemctl enable --now cockpit.socket\n\nLast login: Sun Feb  9 16:52:29 2025 from 10.0.164.64\n[root@localhost ~]# python3 --version\nPython 3.6.8\n[root@localhost ~]# python\npython3                                       python3.6m                                    python-argcomplete-tcsh\npython3.6                                     python-argcomplete-check-easy-install-script\n</code></pre> <ul> <li>\u2022 Ansible \u7684 \u7248\u672c\u4e3a 2.18.2</li> <li>\u2022 servera \u7684 Python \u7248\u672c\u4e3a 3.12.0</li> <li>\u2022 serverb \u7684 Python \u7248\u672c\u4e3a 3.6.8</li> </ul> <p>\u6267\u884c ansible \u547d\u4ee4\u6d4b\u8bd5\uff1a</p> <pre><code>[root@study ansible]# ansible servera -m ping\n[WARNING]: Platform linux on host servera is using the discovered Python interpreter at /usr/local/python/bin/python3.12, but future installation of another Python\ninterpreter could change the meaning of that path. See https://docs.ansible.com/ansible-core/2.18/reference_appendices/interpreter_discovery.html for more\ninformation.\nservera | SUCCESS =&gt; {\n    \"ansible_facts\": {\n        \"discovered_interpreter_python\": \"/usr/local/python/bin/python3.12\"\n    },\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\n[root@study ansible]# ansible serverb -m ping\n[WARNING]: Unhandled error in Python interpreter discovery for host serverb: Expecting value: line 1 column 1 (char 0)\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: SyntaxError: future feature annotations is not defined\n[WARNING]: Platform linux on host serverb is using the discovered Python interpreter at /usr/bin/python3, but future installation of another Python interpreter could\nchange the meaning of that path. See https://docs.ansible.com/ansible-core/2.18/reference_appendices/interpreter_discovery.html for more information.\nserverb | FAILED! =&gt; {\n    \"ansible_facts\": {\n        \"discovered_interpreter_python\": \"/usr/bin/python3\"\n    },\n    \"changed\": false,\n    \"module_stderr\": \"Shared connection to serverb closed.\\r\\n\",\n    \"module_stdout\": \"Traceback (most recent call last):\\r\\n  File \\\"/root/.ansible/tmp/ansible-tmp-1739091843.7380877-172497-249791526669330/AnsiballZ_ping.py\\\", line 107, in &lt;module&gt;\\r\\n    _ansiballz_main()\\r\\n  File \\\"/root/.ansible/tmp/ansible-tmp-1739091843.7380877-172497-249791526669330/AnsiballZ_ping.py\\\", line 99, in _ansiballz_main\\r\\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\\r\\n  File \\\"/root/.ansible/tmp/ansible-tmp-1739091843.7380877-172497-249791526669330/AnsiballZ_ping.py\\\", line 44, in invoke_module\\r\\n    from ansible.module_utils import basic\\r\\n  File \\\"&lt;frozen importlib._bootstrap&gt;\\\", line 971, in _find_and_load\\r\\n  File \\\"&lt;frozen importlib._bootstrap&gt;\\\", line 951, in _find_and_load_unlocked\\r\\n  File \\\"&lt;frozen importlib._bootstrap&gt;\\\", line 894, in _find_spec\\r\\n  File \\\"&lt;frozen importlib._bootstrap_external&gt;\\\", line 1157, in find_spec\\r\\n  File \\\"&lt;frozen importlib._bootstrap_external&gt;\\\", line 1131, in _get_spec\\r\\n  File \\\"&lt;frozen importlib._bootstrap_external&gt;\\\", line 1112, in _legacy_get_spec\\r\\n  File \\\"&lt;frozen importlib._bootstrap&gt;\\\", line 441, in spec_from_loader\\r\\n  File \\\"&lt;frozen importlib._bootstrap_external&gt;\\\", line 544, in spec_from_file_location\\r\\n  File \\\"/tmp/ansible_ping_payload_3__qh04p/ansible_ping_payload.zip/ansible/module_utils/basic.py\\\", line 5\\r\\nSyntaxError: future feature annotations is not defined\\r\\n\",\n    \"msg\": \"MODULE FAILURE: No start of json char found\\nSee stdout/stderr for the exact error\",\n    \"rc\": 1\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 serverb \u6267\u884c\u5931\u8d25\u4e86\uff0c\u56e0\u4e3a Python \u7248\u672c\u592a\u4f4e\u4e86\u3002</p> <p>\u5236\u4f5c\u4e86\u4e00\u4e2a Ansible \u7684\u5bb9\u5668\u6267\u884c\u73af\u5883\uff1a</p> <pre><code>[root@study ansible]# podman images\nREPOSITORY                     TAG         IMAGE ID      CREATED         SIZE\nlocalhost/ansible_ee_rocky     8.10        516702fcfaf2  32 minutes ago  364 MB\n</code></pre> <p>\u68c0\u67e5\u5bb9\u5668\u6267\u884c\u73af\u5883\u7684\u7248\u672c\uff1a</p> <pre><code>[root@study ansible]# ansible-navigator exec -- ansible --version\nansible [core 2.15.13]\n  config file = /root/ansible/ansible.cfg\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /usr/local/lib/python3.9/site-packages/ansible\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\n  executable location = /usr/local/bin/ansible\n  python version = 3.9.20 (main, Oct 23 2024, 13:02:27) [GCC 8.5.0 20210514 (Red Hat 8.5.0-22)] (/usr/bin/python3)\n  jinja version = 3.1.5\n  libyaml = True\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u5bb9\u5668\u5185\u6267\u884c\u73af\u5883\u7684 Ansible \u7248\u672c\u4e3a 2.15.13\uff0cPython \u7248\u672c\u4e3a 3.9.20\u3002</p> <p>\u4f7f\u7528\u5bb9\u5668\u6267\u884c\u73af\u5883\u6267\u884c\u547d\u4ee4\u6d4b\u8bd5\uff1a</p> <pre><code>[root@study ansible]# ansible-navigator exec -- ansible servera -m ping\nservera | SUCCESS =&gt; {\n    \"ansible_facts\": {\n        \"discovered_interpreter_python\": \"/usr/libexec/platform-python\"\n    },\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\n[root@study ansible]# ansible-navigator exec -- ansible serverb -m ping\nserverb | SUCCESS =&gt; {\n    \"ansible_facts\": {\n        \"discovered_interpreter_python\": \"/usr/libexec/platform-python\"\n    },\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u6837\u80fd\u591f\u6267\u884c\u4e86\uff0c\u6240\u4ee5\u9488\u5bf9\u591a\u79cd\u7cfb\u7edf\u7248\u672c\u7684\u73af\u5883\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u5bb9\u5668\u6267\u884c\u73af\u5883\u6765\u89c4\u907f\u7248\u672c\u517c\u5bb9\u6027\u7684\u95ee\u9898\uff0c\u800c\u4e14\u53ef\u4ee5\u9488\u5bf9\u4e0d\u540c\u7684 Ansible \u96c6\u5408\u5236\u4f5c\u5bb9\u5668\u6267\u884c\u73af\u5883\uff0c\u4fbf\u4e8e\u4e0d\u540c\u6a21\u5f0f\u7684\u7ba1\u7406\uff0c\u6bd4\u65b9\u8bf4\u4e00\u4e2a\u5bb9\u5668\u6267\u884c\u5883\u7528\u4e8e\u7cfb\u7edf\u521d\u59cb\u5316\uff0c\u5b89\u88c5\u7cfb\u7edf\u521d\u59cb\u5316\u4f7f\u7528\u7684\u6a21\u5757\uff0c\u53e6\u4e00\u4e2a\u5bb9\u5668\u6267\u884c\u73af\u5883\u5b89\u88c5 Ldap \u96c6\u5408\uff0c\u7528\u4e8e Ldap \u7684\u7ba1\u7406\u3002</p>"},{"location":"2025/sre/2ansible/#ansible_21","title":"\u914d\u7f6e Ansible \u5bb9\u5668\u6267\u884c\u73af\u5883","text":"<p>\u5b89\u88c5 Ansible \u5bb9\u5668\u6267\u884c\u73af\u5883</p> <p>\u914d\u7f6e Ansible \u6267\u884c\u73af\u5883\u9700\u8981\u5b89\u88c5 ansible-navigator \u548c\u5bb9\u5668\u73af\u5883\uff0c\u5982\u679c\u662f RHEL \u7cfb\u7edf\u4e14\u6709 RHEL \u8ba2\u9605\uff0c\u90fd\u4f1a\u6709\u76f8\u5e94\u7684 RPM \u5305\uff0c\u5982\u679c\u662f\u5f00\u6e90\u73af\u5883\uff0cansible-navigator \u53ef\u4ee5\u7528 pip \u5b89\u88c5\uff0c\u5bb9\u5668\u73af\u5883\u53ef\u4ee5\u4f7f\u7528 podman \u6216 docker\u3002</p> <p>\u56e0\u4e3a\u662f\u901a\u8fc7\u5bb9\u5668\u6267\u884c\uff0c\u6240\u4ee5\u9700\u8981\u5bb9\u5668\u955c\u50cf\uff0c\u5f00\u6e90\u7684 ansible-navigator \u9ed8\u8ba4\u4f7f\u7528\u7684\u955c\u50cf\u662f ghcr.io/ansible/community-ansible-dev-tools:latest\u3002</p> <pre><code># \u5b89\u88c5 ansible-navigator\n[root@ansible-controller ~]# python3 -m pip install ansible-navigator\n\n# \u5b89\u88c5\u5bb9\u5668\u73af\u5883\n[root@ansible-controller ~]# dnf install podman\n\n# \u6d4b\u8bd5\n[root@ansible-controller ~]# cd ansible-navigator/\n[root@ansible-controller ansible-navigator]# ansible-navigator welcome\n-------------------------------------------------------------------------------------\nExecution environment image and pull policy overview\n-------------------------------------------------------------------------------------\nExecution environment image name:     ghcr.io/ansible/community-ansible-dev-tools:latest\nExecution environment image tag:      latest\nExecution environment pull arguments: None\nExecution environment pull policy:    tag\nExecution environment pull needed:    True\n-------------------------------------------------------------------------------------\nUpdating the execution environment\n-------------------------------------------------------------------------------------\nRunning the command: podman pull ghcr.io/ansible/community-ansible-dev-tools:latest\nTrying to pull ghcr.io/ansible/community-ansible-dev-tools:latest...\n\n# \u6267\u884c ansible-navigator welcome \u4f1a\u51fa\u73b0\u4e00\u4e2a\u4ea4\u4e92\u9875\u9762\uff0c\u9875\u9762\u5982\u4e0b\n 0\u2502Welcome\n 1\u2502\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n 2\u2502\n 3\u2502Some things you can try from here:\n 4\u2502- :collections                                    Explore available collections\n 5\u2502- :config                                         Explore the current ansible configuration\n 6\u2502- :doc &lt;plugin&gt;                                   Review documentation for a module or plugin\n 7\u2502- :help                                           Show the main help page\n 8\u2502- :images                                         Explore execution environment images\n 9\u2502- :inventory -i &lt;inventory&gt;                       Explore an inventory\n10\u2502- :log                                            Review the application log\n11\u2502- :lint &lt;file or directory&gt;                       Lint Ansible/YAML files (experimental)\n12\u2502- :open                                           Open current page in the editor\n13\u2502- :replay                                         Explore a previous run using a playbook artifact\n14\u2502- :run &lt;playbook&gt; -i &lt;inventory&gt;                  Run a playbook in interactive mode\n15\u2502- :settings                                       Review the current ansible-navigator settings\n16\u2502- :quit                                           Quit the application\n17\u2502\n18\u2502happy automating,\n19\u2502\n20\u2502-winston\n</code></pre> <p>\u5728\u4e0a\u8fb9\u8fd9\u4e2a\u4ea4\u4e92\u9875\u9762\u4e0b\uff0c\u8f93\u5165 :collections \u53ef\u4ee5\u67e5\u770b\u53ef\u4f7f\u7528\u7684\u96c6\u5408\uff08\u5c31\u50cf VIM \u65f6\u8f93\u5165 :wq \u4fdd\u5b58\u6587\u4ef6\u4e00\u6837\uff09\u3002</p> <p>\u901a\u8fc7\u5bb9\u5668\u6765\u6267\u884c Ansible \u4efb\u52a1</p> <ul> <li>\u2022 --pp \u8bbe\u7f6e\u955c\u50cf\u62c9\u53d6\u7b56\u7565</li> <li>\u2022 --eei \u8bbe\u7f6e\u4f7f\u7528\u4ec0\u4e48\u5bb9\u5668\u955c\u50cf</li> </ul> <pre><code>[root@ansible-controller ~]# mkdir ansible-navigator/\n[root@ansible-controller ~]# cd ansible-navigator/\n[root@ansible-controller ansible-navigator]# ansible-navigator exec --pp missing --eei quay.io/ansible/awx-ee:24.6.1 -- ansible --version\nansible [core 2.15.12]\n  config file = /root/ansible-navigator/ansible.cfg\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /usr/local/lib/python3.9/site-packages/ansible\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\n  executable location = /usr/local/bin/ansible\n  python version = 3.9.19 (main, Jun 11 2024, 00:00:00) [GCC 11.4.1 20231218 (Red Hat 11.4.1-3)] (/usr/bin/python3)\n  jinja version = 3.1.4\n  libyaml = True\n\n# \u51c6\u5907\u914d\u7f6e\u6587\u4ef6\u548c\u4e3b\u673a\u6e05\u5355\u7528\u4e8e\u6d4b\u8bd5\n[root@ansible-controller ansible-navigator]# cat ansible.cfg\n[defaults]\ninventory=./inventory\nhost_key_checking=False\n[root@ansible-controller ansible-navigator]# cat inventory\nmaster1 ansible_ssh_host=192.168.221.142 HOSTNAME=master1.example.com\nworker1 ansible_ssh_host=192.168.221.143 HOSTNAME=worker1.example.com\n\n[all:vars]\nansible_ssh_user=ansible\nansible_ssh_password=redhat\n</code></pre> <p>\u88ab\u63a7\u8282\u70b9\u7cfb\u7edf\u4e3a Rocky 8.10\uff0cPython \u7248\u672c\u4e3a 3.6.8\u3002</p> <p>ansible-navigator \u6267\u884c\u4efb\u52a1\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li>\u2022 \u901a\u8fc7 exec \u9009\u9879\u6267\u884c Ansible Ad-Hoc</li> <li>\u2022 \u901a\u8fc7 run \u9009\u9879\u6267\u884c Ansible Playbook</li> </ul> <p>\u901a\u8fc7\u5bb9\u5668\u6267\u884c Ansible Ad-Hoc</p> <p><code>`-m stdout</code> \u8bbe\u7f6e\u8f93\u51fa\u6a21\u5f0f\u4e3a\u975e\u4ea4\u4e92\u6a21\u5f0f</p> <pre><code>[root@ansible-controller ansible-navigator]# ansible-navigator exec --pp missing --eei quay.io/ansible/awx-ee:24.6.1 -- 'ansible all -m command -a \"python3 --version\"'\nworker1 | CHANGED | rc=0 &gt;&gt;\nPython 3.6.8\nmaster1 | CHANGED | rc=0 &gt;&gt;\nPython 3.6.8\n</code></pre> <p>\u901a\u8fc7\u5bb9\u5668\u6267\u884c Playbook</p> <p><code>-m stdout</code> \u8bbe\u7f6e\u8f93\u51fa\u6a21\u5f0f\u4e3a\u975e\u4ea4\u4e92\u6a21\u5f0f</p> <pre><code>[root@ansible-controller ansible-navigator]# ansible-navigator --pp missing --eei quay.io/ansible/awx-ee:24.6.1 -m stdout run test.yml\n\nPLAY [Ansible-navigator test!] *************************************************\n\nTASK [Gathering Facts] *********************************************************\nok: [master1]\nok: [worker1]\n\nTASK [Print Hello World!] ******************************************************\nok: [master1] =&gt; {\n    \"msg\": \"Hello World!\"\n}\nok: [worker1] =&gt; {\n    \"msg\": \"Hello World!\"\n}\n\nPLAY RECAP *********************************************************************\nmaster1                    : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\nworker1                    : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n</code></pre>"},{"location":"2025/sre/2ansible/#14-ansible-navigator","title":"14 Ansible-navigator \u4ecb\u7ecd","text":""},{"location":"2025/sre/2ansible/#step-3-save-the-insights-to-the-cresourcesvideoinsightsjson-folder","title":"Step 3: Save the insights to the C:\\Resources\\Video\\Insights.json folder.","text":"<p>\u7b80\u5355\u8bb2\uff0cansible-navigator \u5c31\u662f\u901a\u8fc7\u5bb9\u5668\u6765\u8fd0\u884c Ansible \u4efb\u52a1\uff0cansible-navigator \u8c03\u7528 ansible-runner \u63a5\u53e3\u6765\u542f\u52a8\u5bb9\u5668\u5e76\u6267\u884c\u4efb\u52a1\u3002</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \ud83d\udfe6 ansible-navigator                         \u2502\n\u2502    - Reads .ansible-navigator.yml            \u2502\n\u2502    - Parses CLI arguments                    \u2502\n\u2502    - Constructs execution context            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n             \u2502 calls ansible-runner API\n             \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \ud83d\udfe8 ansible-runner (Python API)               \u2502\n\u2502    - Builds podman/docker command            \u2502\n\u2502    - Prepares artifacts directory structure  \u2502\n\u2502    - Generates env.list, cmd, settings       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n             \u2502 launches container\n             \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \ud83d\udfe9 EE Container (Execution Environment)      \u2502\n\u2502    - Entrypoint: ansible-playbook            \u2502\n\u2502    - Uses mounted inventory/playbook/env     \u2502\n\u2502    - Runs tasks, connects to targets         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n             \u2502 writes output\n             \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \ud83d\udfea artifacts/ (on host)                      \u2502\n\u2502    - stdout                                  \u2502\n\u2502    - job_events/*.json                       \u2502\n\u2502    - command, env.list, status               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>ansible-navigator \u53ef\u4ee5\u901a\u8fc7\u5bb9\u5668\u5b8c\u6210 Ansible \u6240\u6709\u7684\u547d\u4ee4\u3002</p>"},{"location":"2025/sre/2ansible/#_32","title":"\u67e5\u770b\u5e2e\u52a9\u6587\u6863","text":"<p>\u901a\u8fc7 <code>ansible-navigator --help</code> \u53ef\u4ee5\u67e5\u770b\u5e2e\u52a9\u6587\u6863\u3002</p> <p>\u901a\u8fc7 <code>ansible-navigator &lt;subcommand&gt; --help</code> \u2014\u67e5\u770b\u5b50\u9009\u9879\u5e2e\u52a9\u6587\u6863\uff08\u6bd4\u65b9\u8bf4 <code>ansible-navigator run --help</code>\uff09\u3002</p> <pre><code>[root@ansible-controller ansible-navigator]# ansible-navigator --help\nUsage: ansible-navigator [options]\n\nOptions (global):\n-h     --help                                   Show this help message and exit\n--version                                       Show the application version and exit\n--rad  --ansible-runner-artifact-dir            The directory path to store artifacts generated by ansible-runner\n--rac  --ansible-runner-rotate-artifacts-count  Keep ansible-runner artifact directories, for last n runs, if set to 0 artifact directories won't be deleted\n--rt   --ansible-runner-timeout                 The timeout value after which ansible-runner will forcefully stop the execution\n--rwje --ansible-runner-write-job-events        Write ansible-runner job_events in the artifact directory (true|false)\n--cdcp --collection-doc-cache-path              The path to collection doc cache (default: /root/.cache/ansible-navigator/collection_doc_cache.db)\n--ce   --container-engine                       Specify the container engine (auto=podman then docker) (auto|podman|docker) (default: auto)\n--co   --container-options                      Extra parameters passed to the container engine command\n--dc   --display-color                          Enable the use of color for mode interactive and stdout (true|false) (default: true)\n--ecmd --editor-command                         Specify the editor command (default: vi +{line_number} {filename})\n--econ --editor-console                         Specify if the editor is console based (true|false) (default: true)\n--ee   --execution-environment                  Enable or disable the use of an execution environment (true|false) (default: true)\n--eei  --execution-environment-image            Specify the name of the execution environment image (default: ghcr.io/ansible/community-ansible-dev-tools:latest)\n--eev  --execution-environment-volume-mounts    Specify volume to be bind mounted within an execution environment (--eev /home/user/test:/home/user/test:Z)\n--la   --log-append                             Specify if log messages should be appended to an existing log file, otherwise a new log file will be created per session (true|false)\n                                                (default: true)\n--lf   --log-file                               Specify the full path for the ansible-navigator log file (default: /root/ansible-navigator/ansible-navigator.log)\n--ll   --log-level                              Specify the ansible-navigator log level (debug|info|warning|error|critical) (default: warning)\n-m     --mode                                   Specify the user-interface mode (stdout|interactive) (default: interactive)\n--osc4 --osc4                                   Enable or disable terminal color changing support with OSC 4 (true|false) (default: true)\n--penv --pass-environment-variable              Specify an existing environment variable to be passed through to and set within the execution environment (--penv MY_VAR)\n--pa   --pull-arguments                         Specify any additional parameters that should be added to the pull command when pulling an execution environment from a container\n                                                registry. e.g. --pa='--tls-verify=false'\n--pp   --pull-policy                            Specify the image pull policy always:Always pull the image, missing:Pull if not locally available, never:Never pull the image, tag:if the\n                                                image tag is 'latest', always pull the image, otherwise pull if not locally available (always|missing|never|tag) (default: tag)\n--senv --set-environment-variable               Specify an environment variable and a value to be set within the execution environment (--senv MY_VAR=42)\n--tz   --time-zone                              Specify the IANA time zone to use or 'local' to use the system time zone (default: utc)\n\nSubcommands:\n{subcommand} --help\n builder                                        Build [execution environment](https://ansible.readthedocs.io/en/latest/getting_started_ee/index.html) (container image)\n collections                                    Explore available collections\n config                                         Explore the current ansible configuration\n doc                                            Review documentation for a module or plugin\n exec                                           Run a command within an execution environment\n images                                         Explore execution environment images\n inventory                                      Explore an inventory\n lint                                           Lint a file or directory for common errors and issues\n replay                                         Explore a previous run using a playbook artifact\n run                                            Run a playbook\n settings                                       Review the current ansible-navigator settings\n welcome                                        Start at the welcome page\n</code></pre> <p>ansible-navigator \u5b50\u547d\u4ee4</p> <pre><code>\u5b50\u547d\u4ee4 \u529f\u80fd\u63cf\u8ff0    \u5e38\u89c1\u7528\u9014\nrun     \u8fd0\u884c\u4e00\u4e2a playbook   \u6267\u884c\u81ea\u52a8\u5316\u4efb\u52a1\nexec    \u5728\u6267\u884c\u73af\u5883\u4e2d\u8fd0\u884c\u547d\u4ee4  \u8fdb\u5165\u5bb9\u5668\u73af\u5883\u8fdb\u884c\u8c03\u8bd5\u3001\u6267\u884c shell\nimages  \u67e5\u770b\u672c\u5730\u5df2\u6709\u7684\u6267\u884c\u73af\u5883\u955c\u50cf   \u7ba1\u7406 EE \u955c\u50cf\nbuilder     \u6784\u5efa EE \u5bb9\u5668\u955c\u50cf\uff08\u4f7f\u7528 ansible-builder\uff09  \u81ea\u5b9a\u4e49\u6267\u884c\u73af\u5883\ncollections     \u67e5\u770b\u5f53\u524d\u53ef\u7528\u7684 Ansible Collections \u4e86\u89e3\u5df2\u5b89\u88c5\u7684\u6a21\u5757\u5305\nconfig      \u67e5\u770b\u5f53\u524d ansible \u914d\u7f6e\uff08ansible.cfg\uff09    \u5feb\u901f\u67e5\u660e\u914d\u7f6e\u6765\u6e90\ndoc     \u67e5\u770b\u6a21\u5757\u6216\u63d2\u4ef6\u6587\u6863   \u67e5\u7528\u6cd5\uff0c\u5982\uff1adoc -t module ping\ninventory       \u6d4f\u89c8\u5e76\u6d4b\u8bd5 inventory \u6587\u4ef6  \u67e5\u770b\u7ec4/\u4e3b\u673a\u7ed3\u6784\u6216\u53d8\u91cf\nlint    \u5bf9 Playbook\u3001role \u8fdb\u884c\u8bed\u6cd5\u68c0\u67e5  \u68c0\u67e5\u6700\u4f73\u5b9e\u8df5\u3001\u9519\u8bef\nreplay  \u56de\u987e\u5df2\u6267\u884c\u8fc7\u7684 playbook\uff08artifact\uff09\u7528\u4e8e\u8c03\u8bd5\u548c\u56de\u987e\u5386\u53f2\u6267\u884c\nsettings    \u663e\u793a\u5f53\u524d\u7684 ansible-navigator \u8bbe\u7f6e  \u67e5\u770b\u914d\u7f6e\u9879\u53ca\u6765\u6e90\nwelcome     \u6253\u5f00\u6b22\u8fce\u754c\u9762\uff08TUI \u6a21\u5f0f\uff09\u4ece TUI \u754c\u9762\u5f00\u59cb\u5bfc\u822a\n</code></pre>"},{"location":"2025/sre/2ansible/#ansible-navigator","title":"ansible-navigator \u901a\u7528\u9009\u9879","text":"<ul> <li>\u57fa\u7840\u9009\u9879</li> </ul> <pre><code>\u53c2\u6570  \u542b\u4e49  \u9ed8\u8ba4\u503c\n-h, --help  \u663e\u793a\u5e2e\u52a9\u4fe1\u606f  -\n--version   \u663e\u793a\u7248\u672c\u4fe1\u606f  -\n-m, --mode  UI \u6a21\u5f0f\uff1astdout \u6216 interactive  interactive\n--tz    \u8bbe\u7f6e\u65f6\u533a\uff08\u5982 utc\u3001local\uff09   utc\n</code></pre>"},{"location":"2025/sre/3git/","title":"3 GIT TEST","text":"<ol> <li>You are working on the main branch. HEAD in main and HEAD in the branch branchi point to the same commit.</li> </ol> <p>What would be the consequences to the placement of the HEAD pointer if you rename branchi to branch2</p> <pre><code>HEAD would still be the same in main and in branch2 .\n</code></pre> <ol> <li>A submodule contains changes, including local changes and upstream changes from various contributors. You also have changes ready for a commit in the main project. What is the best solution to ensure that both main project and submodule changes are available for all contributors to access</li> </ol> <pre><code>git push -- recurse-submodules=on-demand\n</code></pre> <ol> <li>Which command renames branch1 to branch2?</li> </ol> <pre><code>git branch -m branch1 branch2\n</code></pre> <ol> <li>Git stops in the middle of a merge because a file was modified in both branches. How would you detect file caused the conflict? </li> </ol> <p>The git status command lists the conflicting file as \"Both modified.\"</p> <ol> <li>Which statement best describes <code>git reset</code>'s hard and <code>mixed</code> flags?</li> </ol> <p>**hard will reset all changes in the staging area and working directory. **</p> <p>mixed will only reset the staging area.</p> <ol> <li>What flag can you use to preview which files git clean will delete before actually deleting anything?</li> </ol> <pre><code>-n \n</code></pre> <ol> <li>The sole difference between branches b1 and b2 is that b2 contains a file that b1 does not. When you merge branch b1 into b2, it results in a conflict. What is the most likely explanation?</li> </ol> <p>The file was modified on b2 and deleted from b1.</p> <ol> <li>What command can result in a fast-forward?</li> </ol> <p>pull</p> <ol> <li>Which term defines Git repositories that are included as subdirectories in another repository?</li> </ol> <p>Submodules</p> <ol> <li>At the command <code>git log master</code>, Git displays an error. Which scenario caused the error?</li> </ol> <pre><code>The master branch does not exist or it does not have a commit.\n</code></pre> <ol> <li>What command allows you to delete the remote branch feature/test?</li> </ol> <pre><code>git push origin -d feature/test\n</code></pre> <ol> <li>Why would you consider the reflog a safety net?</li> </ol> <p>It maintains references to the old state of objects even if they are not connected to a branch.</p> <ol> <li>What does git show do?</li> </ol> <p>It shows blobs, trees, tags, and commits in a human-readable format.</p> <ol> <li>What is the purpose of the command <code>git branch -m</code> ?</li> </ol> <p>To rename or move a branch and the corresponding reflog</p> <ol> <li>You are working on a project where keeping a linear repository history is important. One of your teammates pushes their latest changes to the main branch, so you proceed to pull the latest changes using the following command:</li> </ol> <p><code>git pull origin main</code></p> <p>What is the problem with this approach?</p> <p>git pull will execute a merge by default, creating merge commits and damaging the linearity of the project's history.</p> <ol> <li>What is a rebase conflict?</li> </ol> <p>An error where a rebase branch contains objects that have different contents than their versions on the destination branch.</p> <ol> <li>Which situation is impossible in Git?</li> </ol> <p>A tag pointing to a branch</p> <ol> <li>Which two commands could you use to output all commits from the last two weeks?</li> </ol> <p><code>git log --after=\"2 weeks ago\"</code> and <code>git log --after=\"14 days\u201dago\u201d</code></p> <ol> <li>How does git bisect help you find bugs in your codebase?</li> </ol> <p>It performs a binary search that isolates the commit that introduced an error.</p>"},{"location":"2025/sre/4sre/","title":"4 SRE Test","text":"<p>1 Which of the following is a recommended practice for defining interfaces in API development?</p> <ul> <li>1 Defining interfaces after development is complete</li> <li>2 Defining interfaces only for current use cases</li> <li>3 Defining interfaces to support current, planned, and foreseeable uses</li> <li>4 Defining interfaces without considering reuse</li> </ul> <p>The recommended practice is:</p> <p>\u2705 3 \u2014 Defining interfaces to support current, planned, and foreseeable uses</p> <p>In API development, designing interfaces with future scalability and flexibility in mind helps avoid breaking changes later, supports reuse, and ensures that the API remains relevant as requirements evolve.</p> <p>2 Which of the following is a recommended practice for registering interfaces in API development</p> <ul> <li>1 Registering only interfaces that are currently exposed as endpoints</li> <li>2 Not registering any interfaces that are not currently exposed as endpoints</li> <li>3 Registering all interfaces that are currently exposed as endpoints</li> <li>4 Registering all interfaces even if not currently exposed as endpoints</li> </ul> <p>The recommended practice is:</p> <p>\u2705 3 \u2014 Registering all interfaces that are currently exposed as endpoints</p> <p>This ensures that:</p> <ul> <li>API consumers have a clear, up-to-date catalog of what\u2019s actually available.</li> <li>Documentation and discovery tools (like API gateways or developer portals) are accurate.</li> <li>You avoid cluttering the registry with unused or internal-only interfaces.</li> </ul> <p>3 Which of the following is a recommended practice for using common context and library services in API development?</p> <ul> <li>1 Ignoring common context and library services</li> <li>2 Using only some common context and library services</li> <li>3 Using all common context and library services</li> <li>4 Using common context and library services only for security</li> </ul> <p>The recommended practice is:</p> <p>\u2705 3 \u2014 Using all common context and library services</p> <p>This promotes consistency, maintainability, and security across APIs by ensuring all services (e.g., logging, authentication, error handling, configuration management) follow shared standards. It also reduces duplication and simplifies long-term maintenance.</p> <p>4 Are applications built according to a data-centric design?</p> <ul> <li>1 Applications are built according to an application-centric design, data is data-centric</li> <li>2 Applications are built according to a user-centric design, data is data-centric</li> <li>3 Applications are built according to a data-centric design</li> <li>4 It depends on the type of application</li> </ul> <p>The correct answer is:</p> <p>\u2705 1 \u2014 Applications are built according to an application-centric design, data is data-centric</p> <p>In most architectures:</p> <ul> <li>Applications are designed around functionality, workflows, and business logic \u2014 hence application-centric.</li> <li>Data is designed, modeled, and managed according to data-centric principles to ensure integrity, consistency, and reuse across systems.</li> </ul> <p>5 what is considered the central asset of the enterprise</p> <ul> <li>1 employees</li> <li>2 technology</li> <li>3 data</li> <li>4 customers</li> </ul> <p>The correct answer is:</p> <p>\u2705 3 \u2014 Data</p> <p>In modern enterprise architecture, data is considered the central asset because it:</p> <ul> <li>Drives decision-making and innovation.</li> <li>Retains value even as technology and applications change.</li> <li>Can be reused across multiple applications and business processes.</li> </ul> <p>Employees and customers are essential, but in the information management context, data is the primary enduring asset.</p> <p>4 can unstructured data be as valuable as structured data</p> <ul> <li>1 no</li> <li>2 yes, but only in certain cases</li> <li>3 yes always</li> <li>4 it depends on the type of unstructured data</li> </ul> <p>The correct answer is:</p> <p>\u2705 3 \u2014 yes always</p> <p>Unstructured data \u2014 like emails, documents, videos, social media posts \u2014 can be just as valuable as structured data because it often contains rich context, insights, and patterns that structured data alone can\u2019t capture.</p> <p>Its value depends more on how effectively it\u2019s managed, processed, and analyzed, not on its format.</p> <p>5 What does a data-centric enterprise have besides a tech implementation</p> <ul> <li>1 an associated culture and mindset</li> <li>2 no associated culture or mindset</li> <li>3 only a tech implementation</li> <li>4 only an associated culture and mindset</li> </ul> <p>The correct answer is:</p> <p>\u2705 1 \u2014 an associated culture and mindset</p> <p>A truly data-centric enterprise isn\u2019t just about having the right technology \u2014 it also requires:</p> <ul> <li>A culture that treats data as a core asset.</li> <li>A mindset where decisions are driven by data and data stewardship is everyone\u2019s responsibility.</li> <li>Processes and governance that reinforce data quality, accessibility, and reuse.</li> </ul> <p>6 how are data products described?</p> <ul> <li>1 based on a common taxonomy and ontology</li> <li>2 based on individual preferences</li> <li>3 based on the type of data product</li> <li>4 based on stage of creation and evolution</li> </ul> <p>The correct answer is:</p> <p>\u2705 1 \u2014 based on a common taxonomy and ontology</p> <p>Data products are best described and classified using a common taxonomy and ontology to ensure consistent understanding, discoverability, and interoperability across the enterprise. This helps align teams and systems around shared definitions and relationships.</p> <p>7 what is expected of stakeholders in a system</p> <ul> <li>1 they should not make data-driven decisions</li> <li>2 they should make data-driven decisions during development</li> <li>3 they should make data-driven decisions only  during production</li> <li>4 they will make data-driven decisions to validate ideas and reduce uncertainty. These may be automated</li> </ul> <p>The correct answer is:</p> <p>\u2705 4 \u2014 they will make data-driven decisions to validate ideas and reduce uncertainty. These may be automated</p> <p>Stakeholders are expected to leverage data continuously\u2014both during development and production\u2014to guide decisions, improve outcomes, and reduce risks. Automation can further enhance this process by making timely, data-driven actions.</p> <p>8 what is required for the information supplied to improve observability</p> <ul> <li>1 it must be unintelligible and unrelated</li> <li>2 it must be intelligible and unrelated</li> <li>3 it must be unintelligible and relatable</li> <li>4 it must be intelligible and relatable</li> </ul> <p>The correct answer is:</p> <p>\u2705 4 \u2014 it must be intelligible and relatable</p> <p>For information to improve observability, it needs to be clear (intelligible) so that it can be understood easily, and relatable so it connects meaningfully to the system\u2019s components or behaviors being observed. This enables effective monitoring, diagnosis, and decision-making.</p> <p>9 what is required for backing service</p> <ul> <li>1 they cannot be exchanged during othe peration</li> <li>2 they can only be exchanged during deployment</li> <li>3 they can be exchanged during operation without redeploying the application</li> <li>4 they cannot be exchanged at all</li> </ul> <p>The correct answer is:</p> <p>\u2705 3 \u2014 Collect as much info as possible and use it to dynamically improve resilience, reliability, and performance</p> <p>Enterprises are expected to gather comprehensive control plane information so they can continuously monitor and adapt systems to enhance stability, reliability, and efficiency dynamically.</p> <p>10 what is the requirement for services specific to an application?</p> <ul> <li>1 they should be deployed and enabled as part of deploying an application</li> <li>2 they should not be part of deploying an application</li> <li>3 they should be specific to each environment</li> <li>4 they should not be enabled during deployment</li> </ul> <p>The correct answer is:</p> <p>\u2705 1 \u2014 they should be deployed and enabled as part of deploying an application</p> <p>Services that are specific to an application need to be deployed and activated together with the application to ensure the application functions correctly and consistently across environments.</p> <p>11 which of following is true about a codebase</p> <ul> <li>1 it can be forked for different deployment</li> <li>2 different deployment may have different codebase</li> <li>3 it must be singular even it different have configuration that apply to them</li> <li>4 env specific code be included in the codebase</li> </ul> <p>The correct answer is:</p> <p>\u2705 1 \u2014 it can be forked for different deployments</p> <p>A codebase can be forked (copied and modified) to support different deployments or versions when needed.</p> <p>Explanation for others:</p> <ul> <li>2 is usually avoided because having multiple different codebases for deployments leads to complexity and maintenance challenges.</li> <li>3 is ideal in many cases\u2014keeping a single codebase with environment-specific configs\u2014but not always possible.</li> <li>4 is discouraged; environment-specific logic should be handled via configuration, not hardcoded in the codebase.</li> </ul> <p>12 what is the importance of maintaining links in a codebase</p> <ul> <li>1 it allows for forking of the codebase</li> <li>2 it ensures that different deployment thave different codebases</li> <li>3 it defines the codebase and ensures it remains singular</li> <li>4 it allows for env specfic code to be included in the codebase</li> </ul> <p>The correct answer is:</p> <p>\u2705 3 \u2014 it defines the codebase and ensures it remains singular</p> <p>Maintaining links (like references, dependencies, and version control connections) helps keep the codebase unified and coherent, preventing fragmentation and ensuring all changes are tracked and integrated properly.</p> <p>**13 what does the enterprise do with collected infiormation</p> <ul> <li>1 it use to maintain it's current security posture</li> <li>2 it use to improve its security  posture dynamically</li> <li>3 it uses it to improve  its security  posture statically</li> </ul> <p>The correct answer is:</p> <p>2 \u2014 it use to improve its security posture dynamically</p> <p>Enterprises leverage collected information to continuously and adaptively enhance their security measures, responding in real-time or near-real-time to emerging threats and vulnerabilities.</p> <p>14 how is access to individual enterprise resources granted</p> <ul> <li>1 on an atomic basis</li> <li>2 on a large basis</li> <li>3 on a case-by-case basis</li> <li>4 on a device-by-device basis</li> </ul> <p>The correct answer is:</p> <p>\u2705 1 \u2014 on an atomic basis</p> <p>Access to individual enterprise resources is granted at the finest, smallest possible level (atomic basis) to ensure precise control and minimize security risks by limiting permissions strictly to what is necessary.</p> <p>15 what is the attribute of an independent service</p> <ul> <li>1 being stateful</li> <li>2 being able to share state with other services</li> <li>3 being able to predict its halting externally</li> <li>4 being stateless</li> </ul> <p>The correct answer is:</p> <p>\u2705 4 \u2014 being stateless</p> <p>An independent service is typically stateless, meaning it does not rely on storing state internally between requests, which makes it more scalable, resilient, and easier to manage independently.</p> <p>16 what is required for publishing events</p> <ul> <li>1 must have a defined schema and be published using a registered topic</li> <li>2 must have a defined schema and published using an unregistered topic</li> <li>3 they do not havea  defined schema</li> <li>4 they can be published without using topic</li> </ul> <p>The correct answer is:</p> <p>\u2705 1 \u2014 must have a defined schema and be published using a registered topic</p> <p>This ensures events are well-structured, consistent, and discoverable, enabling reliable communication and integration across systems.</p> <p>17 what must be clear when cloud services scale with demand</p> <ul> <li>1 the cost of scaling </li> <li>2 the root cause of the demand</li> <li>3 the number of users</li> <li>4 the type of service</li> </ul> <p>The correct answer is:</p> <p>\u2705 1 \u2014 the cost of scaling</p> <p>When cloud services scale with demand, it\u2019s crucial to clearly understand how much scaling will cost to manage budgets and optimize resource usage effectively.</p> <p>18 how are cloud services charged?</p> <ul> <li>1 to the users of the service</li> <li>2 to the developer of service</li> <li>3 to the owner of service</li> <li>4 to the admin  of service</li> </ul> <p>The correct answer is:</p> <p>\u2705 3 \u2014 to the owner of service</p> <p>Cloud services are typically charged to the service owner who is responsible for managing costs, budgeting, and optimizing usage.</p> <ol> <li>If you are tasked as a Site Reliability Engineer to take on-call responsibilities, what activities would you do to optimize on-call processes?  </li> </ol> <p>Add automation and context to alerts for more collaborative response from on-call responders.  </p> <ol> <li>You have set up an alert that notifies the on-call SRE whenever the Heap utilization of a Java application rises above 85%. Over time, your team suffers from alert fatigue due to false positives. What changes would you make to stop the alert fatigue?</li> </ol> <p>Modify the alert to be based on the end-user experience such as degraded response time.</p> <ol> <li>What is an example of an incorrect alert setup that can result in alert fatigue?</li> </ol> <p>Configuring alerts that are not actionable or have narrow reset periods.</p> <ol> <li>The SLO (Service Level Objective) of an application you support is a 99.9% success rate over the past 30 days. In alignment with the SLO, you have defined an alert to trigger whenever the error rate exceeds 0.1%. Your alert window is 10 minutes. What can you say about the precision of this alert?</li> </ol> <p>The precision is low because the alert window is narrow.</p> <ol> <li>What is a service level objective (SLO)?  </li> </ol> <p>Service level objectives (SLOs) are an agreed target within a service level agreement that must be achieved for each activity to provide the best chance to achieve customer success.</p> <ol> <li>In the context of Site Reliability Engineering (SRE), what strategy can be used to reduce toil associated with equipment procurement where users submit requests through an online form?</li> </ol> <p>Providing self-service methods for users.</p> <ol> <li>What is an inherent problem with distributed systems?</li> </ol> <p>Nodes in a distributed system can randomly fail.</p> <ol> <li>The SLO (Service Level Objective) for an application you support is a 99.9% success rate in 30 days. Upon setting up an alert based on burn rate, you notice that the burn rate at times hits 1000; you also notice that this application receives only a small number of requests per hour, around 10. Given these facts, what would you do to fix the issue?</li> </ol> <p>Low-traffic applications can consume the error budget faster than high-traffic applications. Add synthetic traffic to compensate.</p> <ol> <li>What steps would you take to implement the standard plans to establish \"psychological safety\" within the Site Reliability Engineering (SRE) team, specifically by making explicit expectations?</li> </ol> <p>Start with a service level objective (SLO) to make expectations clear. You can ask for collective commitments to avoid assuming everyone agrees on urgency. </p> <ol> <li>What is true of service level objectives (SLOs) in terms of achievability and its relation to the Site Reliability Engineering (SRE) team?  </li> </ol> <p>SLOs should be high enough to satisfy consumers but low enough for SRE to meet. System improvements can alter the SLO. SLOs should also reflect SRE team technology.</p> <ol> <li>What is the main key aspect of implementing Site Reliability Engineering (SRE) within an organization?</li> </ol> <p>Collaborate closely with developers to troubleshoot and resolve issues effectively when alerts are triggered.</p> <ol> <li>As part of the Site Reliability Engineering (SRE) team, what activities or methods would you use to effectively measure the set Service Level Objectives (SLOs)?</li> </ol> <p>Integrate SLOs into a unified monitoring platform that consolidates performance data and user experience metrics. Regularly evaluate the SLOs using a data-driven approach, and ensure that there is clear ownership and accountability for monitoring and reporting.</p> <ol> <li>What is an example of a service level indicator (SLI) for cloud-based software services?</li> </ol> <p>Availability rate</p> <ol> <li>In a multisite configuration (engineers located in multiple sites), what is the minimum recommended team size per site for on-call?</li> </ol> <p>Six</p> <ol> <li>Which work scenario is an example of a toil task that can be done by a Site Reliability Engineering (SRE) team?</li> </ol> <p>Reviewing non-critical monitoring alerts.</p> <ol> <li>As part of the Site Reliability Engineering (SRE) team of the organization, you have observed that your team is handling several production systems at a large scale. What would you do to help increase operational excellence in the organization?   </li> </ol> <p>You can take advantage of software engineering practices as they can be applied to your organization\u2019s IT operations. </p> <ol> <li>How will you use the SLO (Service Level Objective) of an application to eliminate toil?</li> </ol> <p>Decide if a toil can be rejected when the impact is kept within the SLO.</p> <ol> <li>You are working on creating a monitoring dashboard for an application. The audience for this dashboard is the SRE team and the senior leadership. What is an effective way to present information for both audiences?</li> </ol> <p>Create two different dashboards, one meant for SREs and the other for senior leadership with relevant graphs.</p> <ol> <li>As a Site Reliability Engineer, you configure the monitoring for an application to catch issues as soon as possible. The application generates large amounts of raw logs (multiple gigabytes per hour). How will you design your monitoring to see the problems without having to parse all the logs?</li> </ol> <p>Create alerts using metrics from your application.</p> <ol> <li>What is an example of progressive rollout?</li> </ol> <p>Rollout changes on one geographic region at a time.</p> <ol> <li>What is psychological safety in the context of Site Reliability Engineering (SRE)?  </li> </ol> <p>The shared belief held by the SRE team members that others on the team will not embarrass, reject, or punish any members for speaking up.  </p> <ol> <li>Your organization is considering implementing Site Reliability Engineering (SRE) to manage operational tasks and improve existing systems. You were tasked with convincing the management team to adopt SRE. What argument would most effectively support this recommendation?</li> </ol> <p>Implementing SRE will decrease the mean time to repair (MTTR) and increase the mean time between failures (MTBF), improving system reliability and allowing faster updates.</p>"},{"location":"2025/sre/5jump_trade/","title":"5 Jump Trading Interview (code)","text":""},{"location":"2025/sre/5jump_trade/#1-smallest-missing-positive-integer","title":"1 smallest missing positive integer","text":"<p>Write a function:</p> <p>def solution(A)</p> <p>that, given an array A of N integers, returns the smallest positive integer (greater than 0) that does not occur in A.</p> <p>For example, given <code>A = [1, 3, 6, 4, 1, 2]</code>, the function should return 5.</p> <p>Given <code>A = [1, 2, 3]</code>, the function should return 4.</p> <p>Given <code>A = [\u22121, \u22123]</code>, the function should return 1.</p> <p>Write an efficient algorithm for the following assumptions:</p> <p>N is an integer within the range <code>[1..100,000]</code>;</p> <p>each element of array A is an integer within the range <code>[\u22121,000,000..1,000,000]</code>.</p> <pre><code>def solution(A):\n    # Keep only positive numbers in a set for O(1) lookups\n    positives = set(x for x in A if x &gt; 0)\n\n    # Start checking from 1 upwards\n    smallest = 1\n    while smallest in positives:\n        smallest += 1\n\n    return smallest\n</code></pre> <p>This is the \"smallest missing positive integer\" problem.</p> <p>We can solve it in O(N) time and O(N) space by using a set to track all positive numbers in the array, then scanning for the smallest missing one.</p> <p>Explanation</p>"},{"location":"2025/sre/5jump_trade/#1-filter-positives","title":"1 Filter positives","text":"<p>Negative numbers and zero are irrelevant since we\u2019re looking for the smallest positive integer.</p>"},{"location":"2025/sre/5jump_trade/#2-use-a-set","title":"2 Use a set","text":"<p>Lookup in a set is O(1) average time complexity.</p>"},{"location":"2025/sre/5jump_trade/#3-increment-until-missing","title":"3 Increment until missing","text":"<p>Start from 1 and keep going until we find a number not in the set.</p> <pre><code>print(solution([1, 3, 6, 4, 1, 2]))  # 5\nprint(solution([1, 2, 3]))           # 4\nprint(solution([-1, -3]))            # 1\n</code></pre> <p>If you want O(1) extra space and still O(N) time, we could do an in-place index marking trick \u2014 I can show you that version too, which is more memory efficient and popular in coding interviews.</p> <p>Do you want the O(1)-space in-place version? It\u2019s the one Codility gives 100/100 for this problem.</p>"},{"location":"2025/sre/5jump_trade/#2-file-sync-check","title":"2 File sync check","text":"<p>Given list of <code>source_files</code>, and a list of <code>destination_files</code> returns a list of filenames that need to be synced from source to destination in the order as they appear in <code>source_files</code>. Each element in the file lists will have 5 columns delimited by a space character.</p> <p>The columns in order from left to right will be: permissioning, username, size, modification time, filename.\u00a0 For example:</p> <pre><code>[\"rwx alex 2673422 05:04:03 somefilename.txt\", \n\"rwx alice 993432 05:45:00 myfile.csv\", \n\"rwx alex 734673422 19:24:13 somefilename.txt\", \n\"rwx root 14384 12:04:05 somefilename.txt\"]\n</code></pre> <p>A file needs to be synced if it does not exist at the destination or either size, modification time, permissions, or user are different between the source and destination. </p> <p>A file can only be synced if the file is readable at the source and writeable at the destination. </p> <p>For example, given the following source and destination files:</p> <p>source:</p> <pre><code>[\"rwx alex 2673422 05:04:03 somefilename.txt\", \n\"rwx alice 993432 05:45:00 myfile.csv\", \n\"rwx alex 734673422 19:24:13 foobar.txt\", \n\"-wx root 184 12:04:05 barfoo.txt\", \n\"r-- alice 10 02:00:00 helloworld.txt\"]\n</code></pre> <p>destination:</p> <pre><code>[\"rwx alex 5 05:04:03 somefilename.txt\", \n\"rwx alice 993432 10:45:00 myfile.csv\", \n\"r-x alex 734673422 04:24:13 foobar.txt\", \n\"rwx root 4 12:04:05 barfoo.txt\"]\n</code></pre> <p>In this example, the return list should be</p> <pre><code>[\"somefilename.txt\", \"myfile.csv\", \"helloworld.txt\"]\n</code></pre> <p>because:</p> <ul> <li>somefilename.txt has different sizes between source and destination</li> <li>foobar.txt is not writeable at the destination</li> <li>etc</li> </ul> <p>Your solution will be evaluated both on correctness and coding style. We will read your code.</p> <p>This is essentially a file sync check with some permission constraints.</p> <p>We need to:</p> <ol> <li>Parse the file lists into structured records for easy comparison.</li> <li> <p>Check:</p> </li> <li> <p>File is in source but not in destination \u2192 needs sync.</p> </li> <li>File is in both, but any of permissions, username, size, modification time differ \u2192 needs sync.</li> <li> <p>Only sync if:</p> </li> <li> <p>Source file\u2019s permission has <code>'r'</code> in position 0 (readable).</p> </li> <li>Destination file\u2019s permission has <code>'w'</code> in position 1 (writeable) OR file missing in destination (in which case we assume we can write it).</li> </ol> <p>Here\u2019s a clean Python implementation:</p> <pre><code>\ndef parse_file_entry(entry):\n    # permission, user, size, mtime, filename\n    perm, user, size, mtime, filename = entry.split(\" \", 4)\n    return {\n        \"perm\": perm,\n        \"user\": user,\n        \"size\": int(size),\n        \"mtime\": mtime,\n        \"filename\": filename\n    }\n\ndef solution(source_files, destination_files):\n    # Convert destination files into a dict for quick lookup by filename\n    dest_dict = {}\n    for entry in destination_files:\n        info = parse_file_entry(entry)\n        dest_dict[info[\"filename\"]] = info\n\n    to_sync = []\n\n    for src_entry in source_files:\n        src = parse_file_entry(src_entry)\n\n        # Must be readable at source\n        if not src[\"perm\"].startswith(\"r\"):\n            continue\n\n        dest = dest_dict.get(src[\"filename\"])\n\n        # If file missing in destination \u2192 needs sync\n        if dest is None:\n            to_sync.append(src[\"filename\"])\n            continue\n\n        # Must be writeable at destination\n        if \"w\" not in dest[\"perm\"][1]:\n            continue\n\n        # Check differences (excluding filename)\n        if (\n            src[\"perm\"] != dest[\"perm\"] or\n            src[\"user\"] != dest[\"user\"] or\n            src[\"size\"] != dest[\"size\"] or\n            src[\"mtime\"] != dest[\"mtime\"]\n        ):\n            to_sync.append(src[\"filename\"])\n\n    return to_sync\n</code></pre>"},{"location":"2025/sre/5jump_trade/#walkthrough-with-your-example","title":"Walkthrough with your example","text":"<pre><code>source = [\n    \"rwx alex 2673422 05:04:03 somefilename.txt\",\n    \"rwx alice 993432 05:45:00 myfile.csv\",\n    \"rwx alex 734673422 19:24:13 foobar.txt\",\n    \"-wx root 184 12:04:05 barfoo.txt\",\n    \"r-- alice 10 02:00:00 helloworld.txt\"\n]\n\ndest = [\n    \"rwx alex 5 05:04:03 somefilename.txt\",\n    \"rwx alice 993432 10:45:00 myfile.csv\",\n    \"r-x alex 734673422 04:24:13 foobar.txt\",\n    \"rwx root 4 12:04:05 barfoo.txt\"\n]\n\nprint(solution(source, dest))\n# Output: ['somefilename.txt', 'myfile.csv', 'helloworld.txt']\n</code></pre> <p>This approach is:</p> <ul> <li>O(N + M) time (N = source length, M = destination length)</li> <li>O(M) space for the destination dictionary.</li> </ul> <p>If you want, I can make this more concise without losing clarity, or even write a single-pass version that avoids building the dictionary when lists are sorted.</p>"},{"location":"2025/sre/5jump_trade/#integer-prices","title":"Integer prices","text":"<p>Given a sequence of integer prices, we can determine when to buy and sell by identifying special sequences of prices movements called indicators.</p> <p>For example, we can decide to buy every time we see 2\u00a0consecutive price increases, and we can decide to sell every time we see 2\u00a0consecutive price decreases followed by a price increase. If we represent a price increase as 1 and a price decrease as -1, we could write the above rules as:</p> <pre><code>buyIndicator = [ 1, \u00a01] \u00a0 \u00a0 // buy after 2 price increases\nsellIndicator = [-1, -1, 1] // sell after 2 price decreases then an increase\n</code></pre> <p>Specifically, consider the price sequence:</p> <pre><code>indexes \u00a0= [ \u00a00, \u00a0 1, \u00a0 2, \u00a0 3, \u00a0 4, \u00a0 5, \u00a0 6, \u00a0 7, \u00a0 8, \u00a0 9]\u00a0\nprices \u00a0 \u00a0 = [51, 56, 56, 58, 60, 59, 54, 57, 52, 48]\n</code></pre> <p>According to the buy/sell rules described in the indicators above, we would decide to buy at index=3 (price=58) because that price is a second consecutive price increase. </p> <p>**Note that the price changes need not occur on consecutive indices. For example the sequence \"51 56 56 58\" counts as a buy signal since after ignoring indices with no change, the price increased twice from 51-&gt;56-&gt;58. **</p> <p>We would also buy at index=4 (price=60) for the same reason. We would sell at index=7 (price=57) because that price is preceded by 2 consecutive price decreases then an increase. Buy/sell signal will never trigger if the current price is equal to the previous price (i.e. if the price sequence is [51, 56, 56, 58, 58] we will only buy once at index=3). Note that this is just an example of buyIndicator and sellIndicator - they may differ between tests.</p> <p>Finally, we define a position as the sum of buys and sells we have done up to that point, where a buy=1 and a sell=-1. When we have made no buys or sells, our position is 0. In the above example, our positions would be:</p> <pre><code>indexes \u00a0= [ \u00a00, \u00a0 1, \u00a0 2, \u00a0 3, \u00a0 4, \u00a0 5, \u00a0 6, \u00a0 7, \u00a0 8, \u00a0 9]\nprices \u00a0 \u00a0 = [51, 56, 56, 58, 60, 59, 54, 57, 52, 48]\nposition \u00a0= [ \u00a00, \u00a0 0, \u00a0 0, \u00a0 1, \u00a0 2, \u00a0 2, \u00a0 2, \u00a0 1, \u00a0 1, \u00a0 1]\n</code></pre> <p>Note that when we buy at index=3 and index=4 our position increases by 1 each time, and when we sell at index=7 our position decreases by 1.</p> <p>Write a function:\u00a0</p> <p>solution(prices, buyIndicator, sellIndicator)</p> <p>that, given a sequence of prices and sequences defining\u00a0buy and sell indicators, returns a\u00a0list of positions. Your position list must be the same length as the input price list. The buyIndicator and sellIndicator lists will each have at least one element and each element can only be\u00a01 or\u00a0-1. It is possible for both the buy and sell indicators to match at the same time. In that case the change in position should be 1 + (-1) = 0.</p> <p>Your solution will be evaluated both on correctness and coding style. We will read your code.</p> <p>Alright \u2014 let\u2019s break this one down carefully.</p>"},{"location":"2025/sre/5jump_trade/#step-by-step-reasoning","title":"Step-by-step reasoning","text":"<p>We\u2019re essentially:</p> <ol> <li> <p>Converting the <code>prices</code> into a movement sequence:</p> </li> <li> <p><code>1</code> = price increase</p> </li> <li><code>-1</code> = price decrease</li> <li> <p><code>0</code> = no change (and we ignore these when matching indicators)</p> </li> <li> <p>Scanning the movements and checking if the last <code>len(buyIndicator)</code> or <code>len(sellIndicator)</code> non-zero movements match the pattern.</p> </li> <li> <p>When a match happens:</p> </li> <li> <p>Buy \u2192 position += 1</p> </li> <li>Sell \u2192 position -= 1</li> <li> <p>If both match \u2192 net change = 0.</p> </li> <li> <p>For each price index, append the current position to the output list.</p> </li> </ol>"},{"location":"2025/sre/5jump_trade/#python-solution","title":"Python solution","text":"<pre><code>def solution(prices, buyIndicator, sellIndicator):\n    n = len(prices)\n    position = 0\n    positions = []\n\n    # We'll store the last non-zero movements\n    movement_history = []\n\n    for i in range(n):\n        if i &gt; 0:\n            if prices[i] &gt; prices[i - 1]:\n                movement_history.append(1)\n            elif prices[i] &lt; prices[i - 1]:\n                movement_history.append(-1)\n            else:\n                movement_history.append(0)  # unchanged\n\n        # Remove zeros for pattern matching\n        filtered_history = [m for m in movement_history if m != 0]\n\n        delta = 0  # net change in position at this index\n\n        # Check buy pattern\n        if len(filtered_history) &gt;= len(buyIndicator):\n            if filtered_history[-len(buyIndicator):] == buyIndicator:\n                delta += 1\n\n        # Check sell pattern\n        if len(filtered_history) &gt;= len(sellIndicator):\n            if filtered_history[-len(sellIndicator):] == sellIndicator:\n                delta -= 1\n\n        # Update position\n        position += delta\n        positions.append(position)\n\n    return positions\n</code></pre>"},{"location":"2025/sre/5jump_trade/#walkthrough-with-your-example_1","title":"Walkthrough with your example","text":"<pre><code>prices = [51, 56, 56, 58, 60, 59, 54, 57, 52, 48]\nbuyIndicator = [1, 1]\nsellIndicator = [-1, -1, 1]\n\nprint(solution(prices, buyIndicator, sellIndicator))\n# Output: [0, 0, 0, 1, 2, 2, 2, 1, 1, 1]\n</code></pre>"},{"location":"2025/sre/5jump_trade/#why-this-works-well","title":"Why this works well:","text":"<ul> <li>Keeps track of only the last relevant movements.</li> <li>Ignores <code>0</code> movements for matching logic.</li> <li>Correctly handles both patterns matching at the same time (buy=1, sell=-1 \u2192 net 0).</li> <li>O(n) time and O(n) space (could be reduced to O(1) extra space by only keeping a sliding window).</li> </ul>"},{"location":"2025/sre/5jump_trade/#4-to-access-csv-data-sets-download-zipped-files","title":"4 To access CSV data sets download zipped files","text":"<p>Extract, summarise and export information from CSV files to a list</p> <p>Your task is to prepare a function that will return a list of aggregated data from provided CSV files located in the ./data/ folder. The CSV files contains historical prices of traded shares of fictional companies. The filename of each file reflects the name of a fictional company. All data sets have the same structure and consist of six columns:</p> <ul> <li> <p>date \u2013 a specific trading date parsed as a datetime object in the format 'YYYY-MM-DD';</p> </li> <li> <p>open , max , min , close  \u2013 the opening, maximum, minimum and closing prices, respectively;</p> </li> <li> <p>vol \u2013 volume (number of shares traded during a given day).</p> </li> </ul> <p>Task details</p> <p>Create a function named solution that takes as an argument a list of paths to one or more of the provided files. The function should return a list of several nested lists. The length of the returned list equals the length of the list of paths passed to the function. Each nested list consists of two data frames with aggregated data for the individual company:</p> <p>first data frame: highest trading volume values in individual years</p> <p>contains two columns: date</p> <ul> <li>the date of the day with the highest trading volume in a year (parsed as a datetime, in the format 'YYYY-MM-DD'), and vol</li> <li>the actual volume of shares traded in that day,</li> <li>the number of rows of the data frame should be equal to the number of years in the history of the given company;</li> </ul> <p>second data frame: days of highest closing prices in individual years</p> <p>contains two columns: date</p> <ul> <li>the date of the day with the highest closing prices in a year (parsed as a datetime, in the format 'YYYY-MM-DD'), and close</li> <li>the actual closing price; if the same closing price occurred on more than one day in a given year, you should include them all with their full dates,</li> <li>the number of rows of the data frame might be greater than the equivalent dimension for the first data frame.</li> </ul> <p>Below you can find output returned after calling the function for two chosen files (i.e. throwsh.csv and twerche.csv).</p> <p>For readability purposes only 6 first rows of each data frame are shown. Notice that in the first data frame with aggregated data of a given company there are only single values in a given year; however closing prices for a given company in a given year might have repeated, so years in a date columns in the second data frame for a given company are not distinct.</p> <pre><code>[\n    [\n            date       vol\n        0  1997-07-10   7190075\n        1  1998-02-09   3968369\n        2  1999-07-07   6231927\n        3  2000-01-14   5259179\n        4  2001-10-11   7681942\n        5  2002-01-10   4323656,\n            date     close\n        0  1997-10-22    8.4273\n        1  1998-02-09    5.4130\n        2  1998-04-30    5.4130\n        3  1999-07-09    9.8670\n        4  2000-02-25   11.4410\n        5  2001-01-29    8.7326\n    ],\n    [\n            date      vol\n        0  1997-07-01  3240026\n        1  1998-11-03  1047549\n        2  1999-07-15  3829036\n        3  2000-01-18  1351917\n        4  2001-01-23   103433\n        5  2002-02-13    90521,\n            date   close\n        0  1997-10-22  22.278\n        1  1998-07-20  32.673\n        2  1998-07-23  32.673\n        3  1999-07-14  30.127\n        4  2000-01-27  31.785\n        5  2001-12-31  27.157\n    ]\n]\n</code></pre> <p>Remember that aggregated data for any chosen companies (CSV files) must be presented as a list of lists. Apart from base Python, you can use the numpy and pandas packages to create a solution to the task.</p> <p>Available packages / libraries</p> <p>pandas - 2.2.3</p> <pre><code>import pandas as pd\n\ndef solution(file_paths):\n    result = []\n\n    for path in file_paths:\n        # Load CSV, parse 'date' as datetime\n        df = pd.read_csv(path, parse_dates=['date'])\n\n        # Add a 'year' column for grouping\n        df['year'] = df['date'].dt.year\n\n        # 1) Highest trading volume days per year (single day per year)\n        vol_idx = df.groupby('year')['vol'].idxmax()  # index of max volume per year\n        highest_vol_df = df.loc[vol_idx, ['date', 'vol']].reset_index(drop=True)\n\n        # 2) Days of highest closing prices per year (can be multiple days per year)\n        max_close_per_year = df.groupby('year')['close'].transform('max')\n        highest_close_df = df[df['close'] == max_close_per_year][['date', 'close']].reset_index(drop=True)\n\n        result.append([highest_vol_df, highest_close_df])\n\n    return result\n</code></pre>"},{"location":"2025/sre/5jump_trade/#explanation","title":"Explanation:","text":"<ul> <li>We read each CSV and parse the <code>date</code> column as datetime.</li> <li>Create a <code>year</code> column for grouping.</li> <li> <p>For volumes:</p> </li> <li> <p>Use <code>groupby('year')['vol'].idxmax()</code> to get the index of the max volume day per year.</p> </li> <li>Select those rows and columns.</li> <li> <p>For closing prices:</p> </li> <li> <p>Use <code>groupby('year')['close'].transform('max')</code> to get max close per row's year.</p> </li> <li>Filter rows matching max close price (this includes duplicates in a year).</li> <li>Return a list of pairs of dataframes as requested.</li> </ul>"},{"location":"2025/sre/5jump_trade/#usage-example","title":"Usage example:","text":"<pre><code>files = ['./data/throwsh.csv', './data/twerche.csv']\naggregated_data = solution(files)\n\nfor company_data in aggregated_data:\n    vol_df, close_df = company_data\n    print(vol_df.head())\n    print(close_df.head())\n</code></pre> <p>This is clean, efficient, and uses pandas idiomatically. Let me know if you want help with zipping/unzipping files or anything else!</p>"},{"location":"2025/sreln/1k8s_dev/","title":"1 Using Kubernetes as a Developer","text":"<p>1. You are generating Kubernetes resources using <code>kompose</code>. You use the following <code>kompose</code> labels in your <code>docker-compose.yaml</code> file:</p> <ul> <li><code>kompose.volume.size</code> as <code>1Gi</code> for the requests storage\u2019s size in the PersistentVolumeClaim</li> <li><code>kompose.service.type</code> as <code>node</code> to designate the service to be created</li> <li><code>kompose.controller.type</code> as <code>daemonset</code> to convert the deployment upon creation</li> </ul> <p>When you run <code>kompose convert</code>, the command fails. Why is this?</p> <p>You must define the <code>kompose.service.type</code> as nodeport instead.</p> <p>2. How do the containers in Pods run in a Kubernetes cluster?</p> <p>A Pod has a group of one or more containers and it keeps them colocated and coscheduled on the same physical node, sharing its resources.</p> <p>3. You run a Deployment and create a Service. You confirmed that the Service exists, is reachable by Domain Name System (DNS) and IP, and has been crosschecked against the original YAML manifest. A Pod is not able to reach itself with a Service IP, however. What is the issue?</p> <p>The network is not properly configured for hairpin traffic.</p> <p>4. A static port is exposed on every worker node's network IP address passing traffic to a service. What is this an example of?</p> <p>A NodePort</p> <p>5. Why is Service an optional field in the Kubernetes web user interface (UI) deploy wizard?</p> <p>Because not every application needs to expose a Service to an external IP address</p> <p>6. You created a blue/green deployment for your Kubernetes application. After transferring all traffic to the green version, what will you do if users start to report bugs?</p> <p>Switch the traffic back to the blue version and destroy the green version.</p> <p>7. Which daemon keeps track of the kernel logs and identifies kernel vulnerabilities based on predefined rules?</p> <p>Kernel Monitor</p> <p>8. You have a simple Pod definition with two containers. One container is a sidecar and the Pod is scheduled to run once on all three worker nodes in a cluster. How many IP addresses will the Pods consume in total?</p> <p>Three IP addresses, one per Pod</p> <p>9. What does the kubectl port-forward command do?</p> <p>Forward one or more local ports to a Pod.</p> <p>10. An administrator created an application deployment from the command line. An update of the container image rescales the deployment to three instances. The admin ran the following set of commands in a Kubernetes command-line interface (CLI):  <code>kubectl create deployment nginx --image=nginx:1.7.9</code></p> <p><code>kubectl set image deployment/nginx nginx=nginx:1.9.1 --record=true</code></p> <p><code>kubectl scale deployment/nginx --replicas=3</code></p> <p>Because of an incident that the admin must fix in the application version, they reverse the deployment revision as follows:  <code>kubectl rollout undo deployment/nginx</code></p> <p>What values will the Image and Replicas fields indicate for the deployment nginx if the admin runs the command <code>kubectl describe deployment/nginx</code>?</p> <pre><code>Image: nginx:1.7.9\nReplicas: 3\n</code></pre> <p>11. You want to create a new CronJob object called demo-job that uses the image training/demo-job and runs the /scripts/job.sh script every minute. What command runs the Kubernetes command-line interface (CLI)?</p> <pre><code>kubectl create cronjob demo-job --restart=OnFailure --schedule=\"*/1 * * * *\" \n                       --image=training/demo-job -- /scripts/job.sh\n</code></pre> <p>13. What is true of a blue/green deployment?</p> <p>During deployment, both the current and the new version of the application are running at the same time so that traffic can be drained from the current version and all new traffic can be sent to the new version.</p> <p>14. Which metadata field in a Pod is populated by the system?</p> <p>generation</p> <p>15. You created a Deployment with five replicas using the command <code>kubectl apply -f https://eg.com/demo/controllers/dep.yaml</code>. How can you verify if all five replicas are ready in the Deployment?</p> <p>Run <code>kubectl get deployments</code> and check if the AVAILABLE label has the number five in it.</p> <p>16. How many ways can you discover a Service in Kubernetes?  4</p> <p>17. How are files from a directory defined inside a ConfigMap?</p> <p>With the contents of a single file in the data attribute or a collection of key/value pairs that are also defined in the data attribute of the object</p> <p>18. You must implement a probe to stop Pods from receiving traffic when they are busy. The probe should also make sure the Pods are taken out within 20 seconds, checking on the /healthz:8080 endpoint. What would be the correct YAML to configure this?</p> <pre><code>readinessProbe:\n  httpGet:\n    path: /healthz\n    port: 8080\n  initialDelaySeconds: 3\n  periodSeconds: 5\n</code></pre> <p>19. Which container acts as a client proxy and proxies the connections to the main container?</p> <p>Ambassador</p> <p>20. Consider the following configuration file of a Service with multiple ports:</p> <pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: service-demo\nspec:\n  selector:\n    app: PSDemo\n  ports:\n    - name: 0_http\n      protocol: TCP\n      port: 80\n      targetPort: 2342\n    - name: https-p\n      protocol: TCP\n      port: 443\n      targetPort: 9871\n\n</code></pre> <p>This file results in an error because of an invalid port name. What fixes must you make to remove the error?</p> <p>Remove <code>0_</code> from <code>0_http</code></p> <p>21 Given the following PersistentVolume (PV) belonging to the storage class Recyclable:</p> <pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: persistent-disk\nspec:\n  capacity:\n    storage: 10Gi\n  accessModes:\n    - ReadWriteMany\n  persistentVolumeReclaimPolicy: Recycle\n  storageClassName: Recyclable\n  nfs:\n    path: /tmp\n    server: 172.17.0.2\n</code></pre> <p>The PVC is created with 5 Gb of storage capacity and the PV locks the remaining amount.</p> <p>22 You must load the following configuration file into Kubernetes as a ConfigMap:</p> <pre><code>## application config appconfig.txt\n## comments for dev use only\n\nhost=reports.example.com\nport=80\ntimeout=6\n</code></pre> <p>When you run the command <code>kubectl create configmap myconfig --from-file=./appconfig.txt</code>, however, the ConfigMap is created with the comments intact, which is causing your application to throw an error. How would you fix the command?</p> <pre><code>kubectl create configmap myconfig --from-env-file=./appconfig.txt\n\n</code></pre> <p>23 In Kubernetes, which environment variable controls the log destination?</p> <p><code>KUBE_LOGGING_DESTINATION</code></p> <p>24 What changes will you make to the following deployment definition to ensure that there were no unavailable Pods and never more than 12 Pods running nginx during a rolling update deployment?</p> <pre><code>spec:\n  replicas: 10\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 2\n      maxUnavailable: 0\n</code></pre> <p>25 You are working with a PersistentVolumeClaim and pass the same value to both the dataSourceRef and dataSource fields. This results in an error from the dataSourceRef field. You confirm that the value of the apiGroup is demo.kubernetes.ex. What is the cause of the error?</p> <p>The object doesn't belong to any of the available apiGroup values.</p> <p>26 Given the following PersistentVolumeClaim (PVC) and PersistentVolume (PV) definition:</p> <pre><code>apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: persistent-disk-claim\nspec:\n  accessModes:\n    - ReadWriteOnce\n  volumeMode: Filesystem\n  resources:\n    requests:\n      storage: 8Gi\n\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: persistent-disk\nspec:\n  capacity:\n    storage: 8Gi\n  volumeMode: Filesystem\n  accessModes:\n    - ReadWriteOnce\n  persistentVolumeReclaimPolicy: Recycle\n  storageClassName: Recyclable\n  nfs:\n    path: /tmp\n    server: 172.17.0.2\n</code></pre> <p><code>Add the storageClassName: Recyclable attribute to the PVC.</code></p> <p>27 While working with kubectl, you encounter an error. To troubleshoot it, which verbosity level would you choose to get its detailed trace?</p> <pre><code>--v=5\n\n</code></pre> <p>28 Which is a valid label value?</p> <p>An empty value</p> <p>29 How are files from a directory defined inside a ConfigMap?</p> <p>With the contents of a single file in the data attribute or a collection of key/value pairs that are also defined in the data attribute of the object</p> <p>30 You must mount a directory folder of configuration files located at /app/config/ on a Pod. What command can you use in a Kubernetes command-line interface (CLI) to create a ConfigMap named app-config with all files as key/value pairs?</p> <p><code>kubectl create configmap app-config --from-file=/app/config/</code></p> <p>31 Why would you use the shorthand R with the kubectl rollout command?</p> <p>To process the directory specified in <code>-f</code> recursively</p> <p>32 What purpose does the <code>--dry-run option</code> flag serve when running the command: <code>kubectl rollout undo deployment/web-application-demo --to-revision=2 --dry-run</code>?</p> <p>If set, the command only prints the object that would be sent without changing the cluster state.</p> <p>33 You must implement a probe to stop Pods from receiving traffic when they are busy. The probe should also make sure the Pods are taken out within 20 seconds, checking on the /healthz:8080 endpoint. What would be the correct YAML to configure this?</p> <pre><code>readinessProbe:\n  httpGet:\n    path: /healthz\n    port: 8080\n  initialDelaySeconds: 3\n  periodSeconds: 5\n</code></pre> <p>34 Consider the following Pod definition</p> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: cuda-test\nspec:\n  containers:\n    - name: cuda-test\n      image: \"k8s.gcr.io/cuda-vector-add:v0.1\"\n      resources:\n        limits:\n          nvidia.com/gpu: 1\n  nodeSelector:\n    accelerator: nvidia-tesla-p100\n</code></pre> <p>Equality-based requirements</p> <p>35 A cluster administrator created a StorageClass resource named gce-storage-disk, allowing an external GCEPersistentDisk storage system to dynamically provision volumes. What actions must a developer take to bind PersistentVolumesClaims (PVC) to PersistentVolumes (PV) of the storage class gce-storage-disk?</p> <p>Set the <code>spec.storageClassName: gce-storage-disk</code> attribute on PVC resources.</p> <p>36 You are diagnosing a problem, but running kubectl get events produces too many events for you to see the problem. Which command would you use to view only the important events?</p> <p><code>kubectl get events --field-selector type!=Normal</code></p>"},{"location":"2025/sreln/2Linux_test/","title":"1 Linux Fundamentals","text":""},{"location":"2025/sreln/2Linux_test/#1-linux-fundamentals","title":"1 Linux Fundamentals.","text":"<p>1. What file contains a list of all network-accessible services and their related ports?</p> <p><code>/etc/services</code></p> <p>2. Which action will display your hardware device profile on your Linux system?</p> <p>Type Ishw from the terminal.</p> <p>3. You must create a directory nameaptd spreadsheets in the Documents directory belonging to user steve. Your current working directory (PWD) is /home/steve. What command would you USE?</p> <p><code>mkdir Documents/spreadsheets</code></p> <ol> <li>Using systemd tools, how would you set the default runlevel so the machine automatically boots to a graphical user interface (GUI)</li> </ol> <p><code>systemctl set-default graphical.target</code></p> <p>5.What is an advantage of using tar instead of zip ?</p> <p>tar preserves Unix filesystem features.</p> <p>6. What file contains the system and user created groups?</p> <p><code>/etc/group</code></p> <p>7. When using Debian or Red Hat systems, which package must you install and configure to allow for incoming Secure Shell (SSH) connections to Linux systems?</p> <p><code>openssh-server</code></p> <p>8. What tool does the Debian manual recommend you use to create a new user when working on Debian/Ubuntu-based systems?</p> <p>adduser</p> <p>9. You must write a shell script to repeat a command once every hour and only stop if you kill or interrupt the script. What action should you take to best accomplish this?</p> <p><code>Use a while loop with an hour long sleep timer.</code></p> <p>10. You are reviewing the output from running netstat and notice a port 21 is active and listening. What would you deduce from this information?</p> <p><code>A File Transfer Protocol (FTP) daemon is running on the local host.</code></p> <p>11. You plan to build your own Ubuntu server image for a cloud deployment. What is the minimum disk space you will need for the operating system (OS) itself?</p> <p>4 GB</p> <p>12. What command could a non-root user issue to update Debian/Ubuntu repositories?</p> <p>sudo apt update</p> <p>13. Which code will print a complete, easy-to-read list of the Peripheral Component Interconnect (PCI) devices connected to your machine?</p> <p>1spci</p> <p>14. What application allows you to install third-party software on an Ubuntu system?</p> <p>Advanced Package Tool (APT)</p> <p>15. What folder contains most of the human-editable configuration files that control how applications operate?</p> <p>/etc</p> <p>16. You just installed a new Peripheral Component Interconnect (PCI) network card and Linux did not immediately recognize it. What tool do you need to enable the kernel module to run the card?</p> <p>modprobe module-name</p> <p>17. On most modern Linux systems, what file contains the list of users and encrypted versions of their passwords?</p> <p><code>/etc/shadow</code></p> <p>18. How would you adjust the display resolution in distributions using the GNOME 3 desktop (but not the Wayland compositor) to 1366x768 using the command line?</p> <p><code>xrandr --size 1366x768</code></p> <p>19. Using systemd tools, how would you change the current target to allow only command-line access?</p> <p><code>systemctl isolate multi-user.target</code></p> <p>20. Which Linux desktop is best suited for older, slower, or low-powered hardware?</p> <p><code>XForms Common Environment (Xfce)</code></p> <p>21. Which flag would you add to a useradd command in a CentOS system if you wanted to add new users to one or more additional groups?</p> <p><code>-G</code></p> <p>22. At a minimum, which is a valid, standalone, tar command?</p> <pre><code>tar -cf archive. tar foo.txt\n</code></pre> <p>23. In a Bash shell, what would you type to set an environment variable of EDITOR to nano and add the setting to your environment?</p> <pre><code>EDITOR=/usi/bin/nano; export EDITOR\n</code></pre> <p>24. What command dumps socket connection statistics?</p> <pre><code>ss\n</code></pre> <p>25. What command lists only directories in the /etc directory?</p> <pre><code>ls -d /etc/*/\n</code></pre> <p>26. What setting must you edit on the server-side machine to allow remote graphic sessions over Secure Shell (SSH)?</p> <p>The <code>X11Forwarding</code> line in the <code>/etc/ssh/sshd_config</code> file</p> <p>27. When using CentOS, which file contains the configurations controlling way the useradd command will define system and user account unique identifiers (UIDs)?</p> <p><code>/etc/login.defs</code></p> <p>28. What command would you use to change a file's group to root for a file named users.txt?</p> <p><code>sudo chgrp root users.txt</code></p> <p>29. Which command would you use to determine the distribution name and version of your Linux system?</p> <p><code>cat /etc/os-release</code></p> <p>30 You plugged a USB drive into your Ubuntu system with automount enabled and want to check its contents. What should you do to accomplish this? </p> <p>Navigate to your username in the media directory.</p> <p>31 Which command will update the password for a user named \"user\"?</p> <p>passwd user</p> <p>32 What are the three types of object owners on a Linux system?</p> <p>User (owner), group, and other</p> <p>33 How, on a system using systemd, would you set (or reset) your computer's timezone to Eastern Standard Time?</p> <p>sudo timedatectl set-timezone EST</p> <p>34 What setting in the /etc/passwd file is normally given to system user accounts (meaning, an account associated with a process rather than a person) to prevent them from being used to login?</p> <p>/usr/sbin/nologin</p> <p>35 What is the purpose of the shebang line in a Linux script (for example, #!/bin/bash)?</p> <p>To identify the shell interpreter you want to use</p> <p>36  What command allows you to set a priority value for a process when it launches?</p> <p>nice</p> <p>37 Which file sets the PATH environment variable for the current user on an Ubuntu system?</p> <p><code>~/.profile</code></p> <p>38  On a Debian/Ubuntu system, how would you delete a package along with any configuration settings?</p> <p>sudo apt purge packagename</p> <p>39  Which code will print a complete, easy-to-read list of the Peripheral Component Interconnect (PCI) devices connected to your machine?</p> <p>lspci</p> <p>40 In addition to loading the operating system (OS), what other purpose might a boot loader serve?</p> <p>To provide a multi-OS boot environment</p> <p>41 What command displays all processes in a tree format?</p> <p>pstree</p> <p>42 What command displays a static snapshot of running processes?</p> <p>ps</p> <p>43 What is firmware?</p> <p>Software embedded into the system hardware</p> <p>44 What command assigns others read, write, and execute (rwx) permissions to the file users.txt?</p> <p>chmod o+rwx users.txt</p> <p>45 What command clears the local APT-based repositories of retrieved package files on a Debian/Ubuntu system?</p> <p>sudo apt-get clean</p> <p>46 What User ID will the root account possess by default?  0</p> <p>47 What is the default nice setting for a new process in Linux?  0</p> <p>48 What command would you issue to display all the groups associated with the system?</p> <p>cat /etc/group</p> <p>49 You download the ISO file for the Linux distribution you want to install and use on a local PC or server. What is your next step?</p> <p>Write the image to a DVD or USB drive.</p> <p>50 After you update the system repository index (using apt update), what would you execute to apply the updates on Ubuntu?</p> <p>sudo apt upgrade</p> <p>51 What command would you issue to download and install VideoLAN Client (VLC) in Ubuntu</p> <p>sudo apt-get install vlc</p> <p>52 When would you install the Gnome Tweak Tool on your Linux system? </p> <p>When you want to customize your system's user interface</p> <p>53 What is the most widely-used default boot loader for Linux systems?</p> <p>Grand Unified Boot Loader (GRUB)</p> <p>54 Which statement best explains what happens when you use a USB device to run a live image of Linux on your computer?</p> <p>You can run a single session using a USB or optical drive without modifying your local system.</p> <p>55 You must list the permission and ownership of the file users.txt. What would you do to accomplish this task?</p> <p>Issue ls -l users.txt</p>"},{"location":"2025/sreln/5agile/","title":"5 Agile Test","text":"<p>1. Which is an example of an appropriate use of storyboarding?</p> <p>Showing examples of how screens of an application move from one to another</p> <p>2. What is a map that shows what the Value Stream will look like after the implementation of the improvements called?</p> <p>Future State Value Stream Map</p> <p>3. You are assessing a feature that is high value from a market differentiation and mission critical perspective. In what quadrant of the Purpose Alignment model would this feature fit?</p> <p>Differentiating</p> <p>4. What is an example of rapid feedback in agile?</p> <p>Unit testing throughout the project</p> <p>5. Your customer came to your agile development shop after a failed waterfall project. What can you do to demonstrate the agile advantage of delivering value rapidly?</p> <p>Release functional software in iterations</p> <p>6. You are consulting on a product placement initiative for a series of summer blockbuster movies. Your customer has been successful placing products in the past, but only two contracts have been signed versus 50 the previous year. Given these factors, what would you do to start an Agile business analysis of the problem?</p> <p>Identify key customer taste trends and evaluate if the products to be placed meet the needs of the audience targeted by the movie studios.</p> <p>7. When would be a good time to schedule a Review?</p> <p>When a first release of a product is ready to show the stakeholder</p> <p>8. What is a key element of the agile mindset?</p> <p>Inspecting and Adapting</p> <p>9. What is the description of a User Story?</p> <p>A representation of the customer need expressed as a small, concise statement of a feature needed to deliver value.</p> <p>10. What is used to communicate the expected future direction of a product at the Strategy Horizon?</p> <p>Product Roadmap</p> <p>11. You are the lead analyst for a company whose software development team culture is tough and cutthroat. This culture is affecting the company's ability to keep top talent. Management asks you for recommendations on how to handle the issue. How might you apply an Agile-based approach to this problem?</p> <p>Run a team mission, vision, and values exercise to create a shared team vision and define the desired goals and culture.</p> <p>12. You are the lead analyst for a company that has the patent for a new medical procedure. Teams across the organization have expressed confusion about what the procedure is and how it will fit into the company's offerings. What would you do to bring clarity around this new procedure?</p> <p>Run a visioning session to clarify the new procedure and how it fits in the company as a whole.</p> <p>13. You analyze a story as part of a functional spike to assess a new module for a design tool. The process still seems incomplete. What process is missing to properly perform this functional spike?</p> <p>Determine clear acceptance criteria for the story.</p> <p>14. What are Retrospectives used for?</p> <p>Reflecting what went well, what could be better, and how to improve processes.</p> <p>15. A business analyst is looking to write up a User Story. What is one of the INVEST principles that would help ensure a quality deliverable?</p> <p>Testable</p> <p>16. After discovering several process improvements while creating the initial deliverable, you want to have a session for the team to explicitly discuss opportunities for continuous improvement. What is the Agile Extension Technique being utilized?</p> <p>Retrospective</p> <p>17. Once AAC certification is attained, what skills can you expect to apply to a situation when gathering requirements for a new Bill Pay system?</p> <p>The evolution of Agile business analysis practices and common techniques that can be applied to gathering requirements for the new Bill Pay system.</p> <p>18. You must implement a new snack bar system at a major theme park. The project is on a tight time frame of eight months. You establish a backlog of tasks to implement. You start the initial rollout, but encounter a major delay because of a problem with the theme park's credit card processing equipment. What do you do next to deal with the delay?</p> <p>Add the equipment issue to the backlog and reprioritize to solve in the next two-week sprint, allowing for a better estimate for stakeholders on any project delay.</p> <p>19. What does a Vision Statement communicate to external stakeholders?</p> <p>Clarity of the business value a solution brings</p> <p>20. What is an easy way to apply agile processes to business analysis?</p> <p>Use feedback from your customer to ensure your deliverable satisfies the customer's need.</p>"},{"location":"2025/sreln/6cloud/","title":"6 Cloud Native Test","text":"<p>**1. Which of the following is a recommended practice for defining interfaces in API development? **</p> <ul> <li>1 Defining interfaces after development is complete. </li> <li>2 Defining interfaces only for current use cases </li> <li>3 Defining interfaces to support current, planned, and foreseeable uses </li> <li>4 Defining interfaces without considering reuse.</li> </ul> <p>The correct answer is:</p> <p>3 \u2014 Defining interfaces to support current, planned, and foreseeable uses \u2705</p> <p>In API development, you want your interface design to be forward-looking. That means:</p> <ul> <li>Cover current requirements</li> <li>Anticipate planned features</li> <li>Allow for reasonable future expansion without breaking backward compatibility</li> </ul> <p>This approach reduces costly redesigns and avoids breaking changes for API consumers later.</p> <p>Defining interfaces only for the current state (option 2) or after development is done (option 1) is risky, and skipping reuse considerations (option 4) is a common cause of technical debt.</p> <p>2 Which of the following is a recommended practice for registering interfaces in API development</p> <ul> <li>1 Registering only interfaces that are currently exposed as endpoints</li> <li>2 Not registering any interfaces that are not currently exposed as endpoints - 3 Registering all interfaces that are currently exposed as endpoints</li> <li>4 Registering all interfaces even if not currently exposed as endpoints</li> </ul> <p>The correct answer is:</p> <p>3 \u2014 Registering all interfaces that are currently exposed as endpoints \u2705</p> <p>In API development, registration is about making exposed endpoints discoverable and documented\u2014usually in an API registry, developer portal, or service catalog.</p> <ul> <li>Why not 1 or 2? Those could mean leaving some exposed endpoints unregistered, which is risky because undocumented APIs are harder to maintain and more prone to misuse.</li> <li>Why not 4? You shouldn\u2019t register endpoints that are not actually exposed\u2014this could cause confusion or security risks.</li> </ul> <p>So the best practice is: \ud83d\udd39 Register every API interface you expose so it\u2019s documented, searchable, and properly governed, but don\u2019t register internal-only or unused interfaces.</p> <p>4 Which of the following is a recommended practice for using common context and library services in API development?</p> <ul> <li>1 Ignoring common context and library services</li> <li>2 Using only some common context and library services</li> <li>3 Using all common context and library services</li> <li>4 Using common context and library services only for security</li> </ul> <p>The correct answer is:</p> <p>3 \u2014 Using all common context and library services \u2705</p> <p>In API development, common context and library services (e.g., logging, security, error handling, metrics, authentication, configuration management) are designed to ensure consistency, reusability, and maintainability across APIs.</p> <ul> <li>Using all of them ensures every API benefits from the shared standards and avoids duplication of effort.</li> <li>Option 1 ignores them entirely \u2014 leading to inconsistent implementations.</li> <li>Option 2 cherry-picks, which can cause gaps in functionality or governance.</li> <li>Option 4 limits them to security, missing other key benefits like observability, performance, and maintainability.</li> </ul> <p>5 Are applications built according to a data-centric design?</p> <ul> <li>1 Applications are built according to an application-centric design, data is data-centric</li> <li>2 Applications are built according to a user-centric design, data is data-centric</li> <li>3 Applications are built according to a data-centric design</li> <li>4 It depends on the type of application</li> </ul> <p>The correct answer is:</p> <p>1 \u2014 Applications are built according to an application-centric design, data is data-centric \u2705</p> <p>In architecture principles:</p> <ul> <li>Applications are generally designed around specific business functions and use cases \u2192 application-centric.</li> <li>Data is designed, modeled, and governed in a data-centric way \u2192 independent of any single application so it can be reused and shared.</li> </ul> <p>This distinction is important because while applications may change or be replaced, data persists and needs a consistent, centralized design.</p> <p>**6 what is considered the central assest of the enterprise **</p> <ul> <li>1 employees </li> <li>2 technology </li> <li>3 data </li> <li>4 customers</li> </ul> <p>The correct answer is:</p> <p>3 \u2014 Data \u2705</p> <p>In modern enterprise architecture, data is considered the central asset because:</p> <ul> <li>Applications, technology, and even business processes can change, but data has long-term value.</li> <li>Data drives decision-making, analytics, compliance, and innovation.</li> <li>Protecting and managing data well directly impacts the organization's competitiveness and resilience.</li> </ul> <p>Employees, technology, and customers are all critical, but data is the persistent, reusable core asset across all business operations.</p> <p>7 can unstructured data be as valuable as structured data</p> <ul> <li>1 no</li> <li>2 yes, but only in certain cases</li> <li>3 yes always</li> <li>4 it depends on the type of unstructured data</li> </ul> <p>The correct answer is:</p> <p>2 \u2014 Yes, but only in certain cases \u2705</p> <p>Unstructured data (like emails, documents, images, videos, social media posts, sensor readings) can be highly valuable\u2014for example, in sentiment analysis, fraud detection, or medical imaging.</p> <p>However:</p> <ul> <li>Its value depends on context, quality, and the ability to process and interpret it.</li> <li>Without the right tools and analysis, unstructured data might be hard to exploit effectively.</li> </ul> <p>So, while it can match or exceed the value of structured data, it\u2019s not always the case.</p> <p>8 what does a data-centric enterprise have besides a tech implementation</p> <ul> <li>1 an associated culture and mindset</li> <li>2 no associated culture or mindset</li> <li>3 only a tech implementation</li> <li>4 only an associated culture and mindset</li> </ul> <p>The correct answer is:</p> <p>1 \u2014 An associated culture and mindset \u2705</p> <p>A data-centric enterprise isn\u2019t just about having the right technology stack; it also requires:</p> <ul> <li>A culture that treats data as a shared, strategic asset.</li> <li>A mindset where teams prioritize data quality, governance, and reuse.</li> <li>Policies and processes that ensure data is consistent, accessible, and trusted.</li> </ul> <p>Without that cultural foundation, even the best technology won\u2019t deliver the full benefits of being data-centric.</p> <p>9 how are data products described?</p> <ul> <li>1 based on a common taxonomy and ontology</li> <li>2 based on individual preferences</li> <li>3 based on the type of data product</li> <li>4 based on stage of creation and evolution</li> </ul> <p>The correct answer is:</p> <p>1 \u2014 Based on a common taxonomy and ontology \u2705</p> <p>Data products should be described consistently so they can be easily understood, discovered, and integrated across the enterprise.</p> <ul> <li>Common taxonomy \u2192 shared classification system for organizing data products.</li> <li>Common ontology \u2192 shared definitions of terms, relationships, and meaning, ensuring everyone interprets data the same way.</li> </ul> <p>Using individual preferences (option 2) or inconsistent criteria (options 3 or 4) would lead to confusion and make data harder to reuse.</p> <p>10 what is expected of stakeholders in a system</p> <ul> <li>1 they should not make data-driven decisions</li> <li>2 they should make data-driven decisions during development</li> <li>3 they should make data-driven decisions only  during production</li> <li>4 they will make data-driven decisions to validate ideas and reduce uncertainty. These may be automated</li> </ul> <p>The correct answer is:</p> <p>4 \u2014 They will make data-driven decisions to validate ideas and reduce uncertainty. These may be automated \u2705</p> <p>In a well-designed system:</p> <ul> <li>Stakeholders rely on data to guide choices, not just intuition.</li> <li>Decisions are made throughout the lifecycle \u2014 from early validation of ideas to ongoing optimization.</li> <li>Automation can speed up decision-making and reduce human bias, especially for repetitive or real-time scenarios.</li> </ul> <p>This approach ensures that decisions are evidence-based and uncertainty is minimized.</p> <p>11 what is required for the information supplied to improve observability</p> <ul> <li>1 it must be unintelligible and unrelated</li> <li>2 it must be intelligible and unrelated</li> <li>3 it must be unintelligible and relatable</li> <li>4 it must be intelligible and relatable</li> </ul> <p>The correct answer is:</p> <p>4 \u2014 It must be intelligible and relatable \u2705</p> <p>For observability, the information you collect should:</p> <ul> <li>Be intelligible \u2192 clear, understandable, and meaningful to the people or systems consuming it.</li> <li>Be relatable \u2192 connected to the system\u2019s context, so it helps explain behaviors, issues, and performance.</li> </ul> <p>If data is unclear or irrelevant, it won\u2019t help identify problems or improve system understanding.</p> <p>12 what is expected of an enterprise regarding control plane information collection</p> <ul> <li>1 collect as little information as possible</li> <li>2 collect information only for specific use cases</li> <li>3 collect as much info as possible and use it to dynamically improve resilience, reliability, and performance</li> <li>4 collect info only for expected future use cases</li> </ul> <p>The correct answer is:</p> <p>3 \u2014 Collect as much info as possible and use it to dynamically improve resilience, reliability, and performance \u2705</p> <p>In an enterprise:</p> <ul> <li>The control plane monitors and manages systems, applications, and infrastructure.</li> <li>Collecting comprehensive information allows the enterprise to detect issues early, optimize performance, and adapt dynamically.</li> <li>Limiting data collection (options 1, 2, or 4) risks blind spots and reduces the system\u2019s ability to self-heal or improve.</li> </ul> <p>13 what is required for backing service</p> <ul> <li>1 they cannot be exchanged during other operation</li> <li>2 they can only be exchanged during deployment</li> <li>3 they can be exchanged during operation without redeploying the application</li> <li>4 they cannot be exchanged at all</li> </ul> <p>The correct answer is:</p> <p>3 \u2014 They can be exchanged during operation without redeploying the application \u2705</p> <p>A backing service (like databases, message queues, or caches) should be:</p> <ul> <li>Replaceable at runtime without requiring changes or redeployment of the application.</li> <li>This allows for flexibility, scaling, and resilience, letting the system swap services if needed (e.g., for upgrades, failover, or switching vendors).</li> </ul> <p>Options 1, 2, and 4 would limit operational flexibility and violate the principles of modern, cloud-native design.</p> <p>14 what is the requirement for services specific to an application?</p> <ul> <li>1 they should be deployed and enabled as part of deploying an application</li> <li>2 they should not be part of deploying an application</li> <li>3 they should be specific to each environment</li> <li>4 they should not be enabled during deployment</li> </ul> <p>The correct answer is:</p> <p>1 \u2014 They should be deployed and enabled as part of deploying an application \u2705</p> <p>Services that are specific to an application (like certain APIs, caches, or supporting microservices) must:</p> <ul> <li>Be deployed together with the application to ensure it functions correctly.</li> <li>Be enabled automatically during deployment to avoid manual configuration errors.</li> </ul> <p>Options 2, 3, and 4 would risk the application failing to run properly or inconsistencies across environments.</p> <p>15 which of following is true about a codebase</p> <ul> <li>1 it can be forked for different deployment</li> <li>2 different deployment may have different codebase</li> <li>3 it must be singular even it different have configuration that apply to them</li> <li>4 env specific code be included in the codebase</li> </ul> <p>3 \u2014 It must be singular even if different deployments have configurations that apply to them \u2705</p> <p>In modern development practices:</p> <ul> <li>A single codebase is maintained for all deployments to ensure consistency, easier maintenance, and streamlined updates.</li> <li>Deployment-specific variations (like environment settings, feature flags, or secrets) are handled through configuration, not by duplicating or forking the code.</li> </ul> <p>Options 1, 2, and 4 go against best practices because forking or including environment-specific code leads to complexity, drift, and maintenance challenges.</p> <p>16 what is the importance of maintaining links in a codebase</p> <ul> <li>1 it allows for forking of the codebase</li> <li>2 it ensures that different deployment have different codebases</li> <li>3 it defines the codebase and ensures it remains singular</li> <li>4 it allows for env specific code to be included in the codebase</li> </ul> <p>The correct answer is:</p> <p>3 \u2014 It defines the codebase and ensures it remains singular \u2705</p> <p>Maintaining links (like references to modules, libraries, or dependencies) is important because:</p> <ul> <li>It keeps the codebase coherent and unified.</li> <li>Ensures all deployments use the same underlying code while allowing configuration to handle environment-specific differences.</li> <li>Prevents fragmentation or duplication that can lead to maintenance challenges and inconsistencies.</li> </ul> <p>Options 1, 2, and 4 would undermine the principle of a single, maintainable codebase.</p> <p>17 what does the enterprise do with collected information</p> <ul> <li>1 it use to maintain it's current security posture</li> <li>2 it use to improve its security  posture dynamically</li> <li>3 it uses it to improve  its security  posture statically</li> </ul> <p>The correct answer is:</p> <p>2 \u2014 It uses it to improve its security posture dynamically \u2705</p> <p>In a modern enterprise:</p> <ul> <li>Collected information (logs, metrics, alerts, access patterns) is continuously analyzed.</li> <li>This allows the enterprise to adapt and enhance security in real time, responding to threats, vulnerabilities, or anomalous behavior.</li> <li>Static approaches (option 3) or using data only for maintenance (option 1) are insufficient in dynamic, evolving environments.</li> </ul> <p>18 how is access to individual enterprise resources granted</p> <ul> <li>1 on a atomic basis</li> <li>2 on a large basis</li> <li>3 on a case-by-case basis</li> <li>4 on a device-by-device basis</li> </ul> <p>The correct answer is:</p> <p>1 \u2014 On an atomic basis \u2705</p> <p>In a data-centric enterprise, access control is fine-grained:</p> <ul> <li>Permissions are granted at the smallest logical unit of a resource (atomic level), such as a specific record, file, or service operation.</li> <li>This ensures least-privilege access, improving security and reducing the risk of unauthorized use.</li> </ul> <p>Options 2, 3, and 4 are less precise and do not provide the same level of control and protection.</p> <p>19 what is an attribute of an independent service</p> <ul> <li>1 being stateful</li> <li>2 being able to share state with other services</li> <li>3 being able to predict its halting externally</li> <li>4 being stateless</li> </ul> <p>The correct answer is:</p> <p>4 \u2014 Being stateless \u2705</p> <p>An independent service in modern architectures (like microservices) is typically:</p> <ul> <li>Stateless, meaning it does not retain client-specific data between requests.</li> <li>This enables scalability, resilience, and easier deployment, because any instance of the service can handle any request.</li> </ul> <p>Options 1 and 2 (stateful or sharing state) reduce independence, and option 3 (predicting halting externally) is not a defining attribute of independence.</p> <p>20 what is required for publishing events</p> <ul> <li>1 must have a defined schema and be published using registered topic</li> <li>2 must have a defined schema and published using unregistered topic</li> <li>3 they do not have defined schema</li> <li>4 they can be published without using topic</li> </ul> <p>The correct answer is:</p> <p>1 \u2014 Must have a defined schema and be published using a registered topic \u2705</p> <p>For event-driven systems:</p> <ul> <li>A defined schema ensures that consumers understand the structure and meaning of the event data.</li> <li>Using a registered topic ensures discoverability, governance, and proper routing of events across the system.</li> </ul> <p>Options 2, 3, and 4 would lead to ambiguity, integration issues, and potential system errors.</p> <p>21 what must be clear when cloud services scale with demand</p> <ul> <li>1 the cost of scaling </li> <li>2 the root cause of the demand</li> <li>3 the number of users</li> <li>4 the type of service</li> </ul> <p>The correct answer is:</p> <p>1 \u2014 The cost of scaling \u2705</p> <p>When cloud services scale dynamically with demand, it\u2019s essential to understand how much it will cost to handle increased load.</p> <ul> <li>This allows the organization to budget appropriately and avoid unexpected expenses.</li> <li>While understanding the number of users, root cause of demand, and type of service can be useful, the primary concern for scaling decisions is the financial impact.</li> </ul> <p>22 how are cloud services charged</p> <ul> <li>1 to the users of the service</li> <li>2 to the developer of service</li> <li>3 to the owner of service</li> <li>4 to the admin  of service</li> </ul> <p>The correct answer is:</p> <p>3 \u2014 To the owner of the service \u2705</p> <p>In cloud computing:</p> <ul> <li>The service owner is responsible for costs associated with running the service, including compute, storage, networking, and any managed services used.</li> <li>Users of the service typically consume the service but do not directly pay the underlying cloud provider unless a billing model is set up.</li> <li>Developers or admins may influence costs but are not typically charged directly.</li> </ul>"},{"location":"Eng/1work/","title":"1 \u804c\u573a\u82f1\u8bed","text":""},{"location":"Eng/1work/#1","title":"1 \u804c\u573a\u82f1\u8bed","text":""},{"location":"Eng/1work/#20250527-","title":"20250527 - \u5f00\u901a\u6743\u9650","text":"<p>Access +  Permission</p> <ul> <li>Grant Access / Grant Permission</li> <li>Enable Access / Enable Permission</li> <li> <p>Authorize Access /  Authorize Permission</p> </li> <li> <p>We need to grant access to the new employee so they can use the company's database</p> </li> <li>Could you please grant permission to me to edit the website</li> <li>Please enable permission for the HR team to manage the employee performance review</li> <li>Can you authorize me access to the financial reports folders? I need it for the upcoming audit</li> </ul>"},{"location":"Eng/1work/#20250529-","title":"20250529 - \u6b27\u7f8e\u804c\u573a\u4e2d\u6563\u53d1\u51fa\u5f3a\u8005\u6c14\u606f\u7684\u5fae\u4e60\u60ef","text":"<p>\ud83d\udd36 1.\u4e3b\u52a8\u8ddf\u8fdb \u2260 \u8ba8\u4eba\u5acc\uff0c\u53cd\u800c\u8ba9\u4eba\u4fe1\u4efb\u4f60</p> <p>\ud83c\udf62 Just following up to see if you had a chance to review the draft. We're waiting on this to move forward.</p> <p>\u2705 \u4f20\u9012\u51fa\u8d23\u4efb\u611f\uff0c\u4e5f\u8ba9\u5bf9\u65b9\u610f\u8bc6\u5230\u8fd9\u662f\u4ed6\u7684\u56de\u5408\uff0c\u800c\u4e0d\u662f\u4f60push\u4ed6\u3002</p> <p>\ud83d\udd36 2. \u4f1a\u524d\u4e3b\u52a8\u53d1Agenda\uff0c\u7a33\u4f4f\u573a\u9762\u638c\u63a7\u8282\u594f</p> <p>\ud83c\udf62 Just sharing a quick agenda ahead of our meeting tomorrow. Feel free to add anything you'd like to discuss.</p> <p>\ud83e\udde0 \u5f3a\u8005\u4e0d\u662f\u8bdd\u591a\uff0c\u800c\u662f\u63d0\u524d\u9884\u8bbe\u8bae\u9898\uff0c\u8ba9\u5bf9\u65b9\u77e5\u9053\u4f60\u662f\u6709\u51c6\u5907\u3001\u6709\u4e3b\u5bfc\u529b\u7684\uff0c\u907f\u514d\u8dd1\u9898\u3001\u8282\u7701\u65f6\u95f4\u3002</p> <p>\ud83d\udd36 3. \u4e0d\u5435\u4e0d\u62a2\uff0c\u4e3b\u52a8\u5c55\u793a\u6210\u679c\u624d\u5173\u952e</p> <p>\ud83c\udf62 Quick update: The dashboard is now live. Happy to walk you through the metrics if helpful.</p> <p>\ud83e\udde0 \u6b27\u7f8e\u804c\u573a\u6ca1\u4eba\u4f1a\u201c\u53d1\u73b0\u4f60\u9ed8\u9ed8\u505a\u4e86\u4ec0\u4e48\u201d\uff0c\u4f60\u4e0d\u8bf4\uff0c\u522b\u4eba\u9ed8\u8ba4\u4f60\u6ca1\u505a\u3002</p> <p>\ud83d\udd36 4. \u6709\u8fb9\u754c\u5730\u8bf4No\uff0c\u624d\u80fd\u8d62\u5f97\u5c0a\u91cd</p> <p>\ud83c\udf62 Unfortunately I can\u2019t take this on right now. I recommend checking with Sarah who might be available.</p> <p>\u9ad8\u60c5\u5546\u4e0d\u662f\u201c\u7b54\u5e94\u6240\u6709\u4e8b\u201d\uff0c\u800c\u662f\u80fd\u6e05\u695a\u8868\u8fbe\u62d2\u7edd + \u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u3002</p> <p>\ud83d\udd36 5. \u4e0d\u62a2\u529f\u4e5f\u4e0d\u80cc\u9505\uff0c\u6e05\u6670\u8868\u8fbe\u89d2\u8272\u5b9a\u4f4d</p> <p>\ud83c\udf62 This was a team effort led by James. I mainly supported the data part.</p> <p>\ud83e\udde0 \u5728\u6b27\u7f8e\u804c\u573a\uff0c\u201c\u9002\u5ea6\u8ba4\u9886\u201d\u662f\u4e00\u79cd\u6210\u719f</p> <p>\ud83d\udd36 6. \u5f00\u573a\u5bd2\u6684\u4e00\u5c0f\u53e5\uff0c\u80fd\u8ba9\u6c14\u6c1b\u677e\u4e0b\u6765\u4e0d\u5c11</p> <p>\ud83c\udf62 Hope your week\u2019s going well. Just wanted to check in on the proposal we discussed.</p> <p>\ud83e\udde0 \u4e00\u53e5\u7b80\u77ed\u95ee\u5019 = \u793e\u4ea4\u6da6\u6ed1\u5242\uff0c\u7f13\u548c\u6c14\u6c1b\uff0c\u5efa\u7acb\u8d77\u4fe1\u4efb\u7684\u8bed\u5883\u3002</p> <p>\ud83d\udd36 7. \u627f\u8ba4\u4e0d\u786e\u5b9a\uff0c\u4f46\u5c55\u73b0\u79ef\u6781\u63a8\u8fdb\u7684\u6001\u5ea6</p> <p>\ud83c\udf62 I'm not entirely sure about the answer, but I\u2019ll look into it and get back to you shortly.</p> <p>\u2705 \u8fd9\u6837\u4e0d\u4ec5\u4e0d\u4f1a\u663e\u5f97\u5f31\uff0c\u53cd\u800c\u4f20\u8fbe\u51fa\u4f60\u7684\u8d1f\u8d23\u548c\u4e13\u4e1a</p> <p>\ud83d\udd36 8. \u9047\u5230\u6a21\u7cca\u4efb\u52a1\uff0c\u4e3b\u52a8\u6f84\u6e05\u800c\u4e0d\u662f\u786c\u4e0a</p> <p>\ud83c\udf62 Just to clarify \u2014 are we prioritizing the launch timeline or the UI polish for this sprint?</p> <p>\ud83e\udde0 \u5f88\u591a\u65b0\u4eba\u51fa\u95ee\u9898\u4e0d\u662f\u56e0\u4e3a\u4e0d\u52aa\u529b\uff0c\u800c\u662f\u4efb\u52a1\u7406\u89e3\u9519\u4e86\u65b9\u5411\u3002</p> <p>\ud83d\udd369. \u6253\u62db\u547c\u4e5f\u80fd\u62c9\u8fd1\u8ddd\u79bb\uff0cWarm but professional is the way to go</p> <p>\ud83c\udf36 \u201cHi team, hope you\u2019re all doing well. Just wanted to quickly check in on...\u201d</p> <p>\ud83e\udde0 \u7f8e\u5f0f\u804c\u573a\u4e2d\uff0c\u793c\u8c8c\u800c\u81ea\u7136\u7684\u5bd2\u6684\u662f\u6253\u5f00\u5bf9\u8bdd\u7684\u94a5\u5319\uff0c\u4e5f\u80fd\u4f20\u9012\u201c\u6211\u61c2\u6c9f\u901a\u793c\u4eea\u201d \u2014\u2014 \u6bd4\u51b7\u51b0\u51b0\u7684\u201cHi\u201d\u591a\u4e00\u70b9\u6e29\u5ea6\uff0c\u8ba9\u5408\u4f5c\u4ece\u7b2c\u4e00\u53e5\u8bdd\u5f00\u59cb\u987a\u7545\u3002</p> <p>\ud83d\udd3610. \u6709\u9519\u6562\u8ba4\uff0c\u5f3a\u8005\u4e0d\u6015\u66b4\u9732\u95ee\u9898\u70b9</p> <p>\ud83c\udf36 \u201cYou\u2019re right \u2014 I missed that. Thanks for pointing it out. I\u2019ll fix it right away.\u201d</p> <p>\ud83e\udde0 \u8868\u8fbe\u627f\u62c5\u8d23\u4efb\u5e76\u8fc5\u901f\u884c\u52a8\uff0c\u662f\u9ad8\u60c5\u5546+\u9ad8\u6267\u884c\u529b\u7684\u4f53\u73b0\u3002\u804c\u573a\u5f3a\u8005\u4e0d\u662f\u4e0d\u51fa\u9519\uff0c\u800c\u662f\u51fa\u4e86\u95ee\u9898\u540e\u8ba9\u4eba\u5b89\u5fc3\u53ef\u9760\u3002</p> <p>\ud83d\udd3611. \u4e0d\u6e05\u695a\uff1f\u5c31\u95ee\u6e05\u695a \u2014\u2014 Clarify instead of assuming</p> <p>\ud83c\udf36 \u201cJust to confirm, when you say \u2018final version,\u2019 do you mean the one with all revisions or the draft from last week?\u201d</p> <p>\ud83e\udde0 \u4e0d\u5047\u8bbe\u3001\u4e0d\u88c5\u61c2\uff0c\u53cd\u800c\u5c55\u73b0\u51fa\u4f60\u7ec6\u81f4\u3001\u6ce8\u91cd\u6210\u679c\u8d28\u91cf\u7684\u4e13\u4e1a\u6001\u5ea6\u3002\u6b27\u7f8e\u804c\u573a\u4e2d\uff0c\u6c9f\u901a\u6e05\u695a\u8fdc\u6bd4\u201c\u6015\u663e\u5f97\u4e0d\u61c2\u201d\u91cd\u8981\u3002</p>"},{"location":"Eng/1work/#20250530-","title":"20250530 -  \u82e5\u6709\u8fdb\u5c55\uff0c\u6211\u4f1a\u901a\u77e5\u4f60","text":"<ul> <li> <p>development / update / progress   \u8fdb\u5c55</p> </li> <li> <p>contact sb  \u8054\u7cfb\u67d0\u4eba</p> </li> <li>inform sb  \u901a\u77e5\u67d0\u4eba</li> <li>inform sb of sth \u901a\u77e5\u67d0\u4eba\u67d0\u4e8b</li> <li>reach out to sb \u8054\u7cfb\u67d0\u4eba</li> <li>be in touch/stay in touch /keep in touch \u4fdd\u6301\u8054\u7cfb</li> <li>keep sb posted \u968f\u65f6\u901a\u77e5\u67d0\u4eba\u6700\u65b0\u60c5\u51b5</li> <li> <p>keep sb in loop \u8ba9\u67d0\u4eba\u77e5\u60c5</p> </li> <li> <p>immediatgly/ promptly \u7acb\u5373\u9a6c\u4e0a</p> </li> <li>as soon as \u9a6c\u4e0a</li> </ul> <p>If there are any developments, I'll contact you immediately \u5982\u679c\u6709\u4efb\u4f55\u8fdb\u5c55\uff0c\u6211\u4f1a\u7acb\u5373\u8054\u7cfb\u4f60</p> <p>If there are any updates, I'll reach out to you promptly \u5982\u679c\u6709\u4efb\u4f55\u8fdb\u5c55\uff0c\u6211\u4f1a\u8054\u7cfb\u4f60</p> <p>I'll keep you posted if there's any progress   \u5982\u679c\u6709\u4efb\u4f55\u8fdb\u5c55\uff0c\u6211\u4f1a\u9a6c\u8054\u7cfb\u4f60</p> <p>I'll keep you in the loop if there's any update  \u5982\u679c\u6709\u4efb\u4f55\u8fdb\u5c55\uff0c\u6211\u4f1a\u9a6c\u8054\u7cfb\u4f60</p> <p>I'll be in touch, as soon as there's any progress \u4e00\u65e6\u6709\u4efb\u4f55\u8fdb\u5c55\u6211\u5c31\u8054\u7cfb\u4f60</p> <p>I'll stay in touch and inform you of any updates</p>"},{"location":"Eng/1work/#20250605-","title":"20250605 - \u56de\u987e\u4e00\u4e0b","text":""},{"location":"Eng/1work/#recap","title":"recap  \u6982\u8ff0\uff0c\u56de\u987e\u603b\u7ed3","text":"<p>Before we wrap up, let's recap the key decisions we made today</p> <p>\u5728\u7ed3\u675f\u4e4b\u524d\uff0c\u8ba9\u6211\u4eec\u56de\u987e\u6211\u4eec\u4eca\u5929\u505a\u51fa\u7684\u5173\u952e\u51b3\u7b56</p>"},{"location":"Eng/1work/#review","title":"review \u5ba1\u67e5\uff0c\u56de\u987e","text":"<p>Before we sign the contract, let's review the terms one more time</p> <p>\u5728\u7b7e\u7f72\u5408\u540c\u4e4b\u524d\uff0c\u8ba9\u6211\u4eec\u518d\u56de\u987e\u4e00\u4e0b\u6761\u6b3e</p>"},{"location":"Eng/1work/#look-back","title":"look back \u56de\u987e\u8fc7\u53bb","text":"<p>Looking back at our initial plan, we can see how much has changed</p> <p>\u56de\u987e\u6700\u521d\u7684\u8ba1\u5212\uff0c \u6211\u4eec\u53ef\u4ee5\u770b\u5230\u53d1\u751f\u4e86\u591a\u5c11\u53d8\u5316</p>"},{"location":"Eng/1work/#reflect-on","title":"reflect on \u53cd\u601d\u56de\u987e","text":"<p>It's important to reflect on our mistakes so that we can improve in the future</p> <p>\u53cd\u601d\u6211\u4eec\u7684\u9519\u8bef\u5f88\u91cd\u8981 \u8fd9\u6837\u6211\u4eec\u624d\u80fd\u5f00\u59cb\u6539\u8fdb</p>"},{"location":"Eng/1work/#go-over","title":"go over \u518d\u8fc7\u4e00\u904d","text":"<p>Before the meeting, let's go over the presentation one last time</p> <p>\u5728\u4f1a\u8bae\u524d\uff0c\u8ba9\u6211\u4eec\u6700\u540e\u518d\u8fc7\u4e00\u904d\u6f14\u793a\u5185\u5bb9</p>"},{"location":"Eng/1work/#20250611","title":"20250611 \u7ecf\u5e38\u7528\u4e0a\u7684\u6cd5\u8bed\u8868\u8fbe","text":""},{"location":"Eng/1work/#wrap-up","title":"wrap up \u7ed3\u675f","text":"<p>let's wrap up the meeting and get back to work \u8ba9\u6211\u4eec\u7ed3\u8fd9\u4e2a\u4f1a\u8bae\uff0c\u7ee7\u7eed\u5de5\u4f5c\u5427</p> <p>I think it's time to wrap up this conversation \u662f\u65f6\u5019\u7ed3\u675f\u8fd9\u4e2a\u5bf9\u8bdd\u4e86</p>"},{"location":"Eng/1work/#sort-ourt","title":"sort ourt \u89e3\u51b3\u95ee\u9898\uff1b\u5f04\u6e05\u695a\u4e00\u4ef6\u4e8b","text":"<p>the company is working to sort out the supply chain issues</p> <p>\u516c\u53f8\u6b63\u5728\u52aa\u4e3a\u89e3\u51b3\u4f9b\u5e94\u94fe\u95ee</p> <p>let's meet and sort out the details for our project</p> <p>\u8ba9\u6211\u4eec\u89c1\u9762\u8ba8\u8bba\u4e00\u4e0b\u9879\u76ee\u7684\u7ec6\u8282</p>"},{"location":"Eng/1work/#chase-up","title":"chase up \u8ddf\u8fdb","text":"<p>could you please chase up the payment for the invoice we sent? </p> <p>\u4f60\u80fd\u4e0d\u8fdb\u4e00\u4e0b\u6211\u4eec\u53d1\u51fa\u7684\u53d1\u7968\u7684\u4ed8\u6b3e\u60c5\u51b5\u5417\uff1f</p>"},{"location":"Eng/1work/#slack-off","title":"slack off \u5077\u61d2\uff1b\u6478\u9c7c","text":"<p>don't slack off just because it's Friday afternoon. we still have work to do</p> <p>\u522b\u56e0\u6ca9\u662f\u661f\u671f\u4e94\u4e0b\u5348\u5c31\u61d2\u6563\u8d77\u6765\u3002 \u6211\u4eec\u8fd8\u6709\u5de5\u4f5c\u8981\u505a</p> <p>he got fired because he was always slacking off</p> <p>\u4ed6\u88ab\u89e3\u96c7\u4e86\uff0c\u56e0\u4e3a\u4ed6\u603b\u662f\u5077\u61d2\u3002\u6ca1\u6709\u8ba4\u771f\u505a\u597d\u81ea\u5df1\u7684\u5de5\u4f5c</p>"},{"location":"Eng/1work/#pile-up","title":"pile up \u5806\u79ef\uff1b\u79ef\u7d2f","text":"<p>the paperwork is starting to pile up on my desk</p> <p>\u6587\u4e66\u5de5\u4f5c\u5f00\u59cb\u5728\u6211\u7684\u684c\u5b50\u4e0a\u79ef\u7d2f\u8d77\u6765</p> <p>if we don't address the issue now, it will pile up and become a bigger problem later on</p> <p>\u5982\u679c\u6211\u4eec\u73b0\u5728\u4e0d\u89e3\u51b3\u95ee\u9898\uff0c \u4e5f\u4f1a\u79ef\u7d2f\u8d77\u6765\uff0c\u4ee5\u540e\u4f1a\u53d8\u6210\u66f4\u5927\u7684\u95ee\u9898</p>"},{"location":"Eng/1work/#iron-out","title":"iron out \u6572\u5b9a\u3002\u89e3\u51b3\u7ec6\u8282\u95ee\u9898","text":"<p>we need to iron out the details of the contract before we can sign it</p> <p>\u6211\u4eec\u9700\u8981\u6572\u5b9a\u5408\u540c\u7684\u7ec6\u8282\uff0c\u7136\u540e\u624d\u80fd\u7b7e\u7f72</p>"},{"location":"Eng/1work/#20250623","title":"20250623 \u7ecf\u5e38\u7528\u4e0a\u7684\u6cd5\u8bed\u8868\u8fbe","text":""},{"location":"Eng/1work/#carry-out","title":"carry out \u8fdb\u884c\uff1b\u5f00\u5c55\uff1b\u6267\u884c","text":"<p>We need to carry out this work as soon as possible \u6211\u4eec\u9700\u8981\u5c3d\u5feb\u5f00\u5c55\u8fd9\u9879\u5de5\u4f5c</p> <p>The building work was carried out by a local contractor \u5efa\u7b51\u5de5\u7a0b\u7531\u5f53\u5730\u627f\u5305\u5546\u8fdb\u884c</p>"},{"location":"Eng/1work/#take-over","title":"take over \u63a5\u7ba1","text":"<p>I just took over the job \u6211\u624d\u63a5\u7ba1\u8fd9\u9879\u5de5\u4f5c</p> <p>I think you should take over the business \u6211\u89c9\u5f97\u4f60\u5e94\u8be5\u4e58\u63a5\u7ba1\u516c\u53f8</p>"},{"location":"Eng/1work/#knuckle-down","title":"knuckle down \u5f00\u59cb\u8ba4\u771f\u5de5\u4f5c\uff0c\u4e13\u6ce8\u5728\u5de5\u4f5c\u4e0a\u3002","text":"<p>Its time to knuckle dotm\u662f\u65f6\u5019\u8981\u8ba4\u771f\u5de5\u4f5c\u4e86</p>"},{"location":"Eng/1work/#hand-in","title":"hand in \u4e0a\u4ea4\uff0c\u9012\u4ea4","text":"<p>He's a ready handed in his report  \u4ed6\u5df2\u7ecf\u68af\u4e0d\u98db\u4ed6\u7684\u90e8\u51fa</p>"},{"location":"Eng/1work/#knock-off","title":"knock off \u7ed3\u675f\u5de5\u4f5c\uff0c\u4e0b\u73ed\uff0c\u6536\u5de5","text":"<p>Let's knock off early tonight \u6211\u4eec\u4eca\u665a\u63d0\u524d\u6536\u5de5\u5427</p> <p>Latts knock off for lunch \u6211\u4eec\u6536\u5de5\u5403\u5348\u996d</p>"},{"location":"Eng/1work/#call-out","title":"call out \u5f15\u8d77\u6ce8\u610f\uff0c\u63d0\u51fa\u503c\u5f97\u6ce8\u610f\u7684\u5730\u65b9","text":"<p>I want to call out this problem for all of you </p> <p>I have to call out the risk of this project  \u6211\u987b\u8981\u63d0\u51fa\u8fd9\u4e2a\u9879\u81ea\u98ce\u9669</p>"},{"location":"Eng/1work/#call-off","title":"call off \u53d6\u6d88","text":"<p>She just called off the meeting \u5979\u5219\u521a\u628a\u53c1\u79d8\u53d6\u6d88\u4e86</p>"},{"location":"Eng/1work/#slack-off_1","title":"slack off \u5077\u61d2\uff1b\u6478\u9c7c","text":"<p>Workers usually slack off on Fridays \u5458\u5de5\u4eec\u901a\u5e38\u5468\u672b\u56de\u6478\u9c7c</p>"},{"location":"Eng/1work/#work-out","title":"work out \u5982\u671f\u53d1\u751f\uff1b\u8fdb\u5c55\u987a\u5229","text":"<p>This solution didn't work out \u8fd9\u4e2a\u89e3\u51b3\u529e\u6cd5\u6ca1\u6709\u7528</p> <p>Things have worked out for us  \u5807\u60c5\u5bf9\u6211\u4eec\u83b1\u8bf4\u6eaf\u5c5e\u987a\u5229</p>"},{"location":"Eng/1work/#20250625","title":"20250625 \u201c\u5982\u4e0b\u6240\u793a","text":""},{"location":"Eng/1work/#_1","title":"\u901a\u7528\u8868\u8fbe","text":"<p>As follows \u5982\u4e0b\u6240\u793a</p> <p>The steps to complete the project are as follows  \u5b8c\u6210\u8be5\u9879\u76ee\u7684\u6b65\u9aa4\u5982</p>"},{"location":"Eng/1work/#_2","title":"\u5f3a\u8c03\u5c4f\u793a\u5185\u5bb9","text":"<ul> <li>*As shown below \u5982\u4e0b\u6240\u793a</li> <li>As illustrated below \u5982\u4e0b\u6240\u793a</li> <li>As presented below \u5982\u4e0b\u6240\u793a</li> </ul> <p>The results of the survey are as shown below  \u8c03\u67e5\u7ed3\u679c\u5982\u4e0b\u6240\u793a</p> <p>The process can be summarized as illustrated below  \u8be5\u8fc7\u7a0b\u53ef\u4ee5\u603b\u7ed3\u5982\u4e0b\u6240\u793a</p>"},{"location":"Eng/1work/#_3","title":"\u8be6\u7ec6\u5c55\u793a\u5185\u5bb9","text":"<ul> <li> <p>As detailed below \u5177\u4f53\u5982\u4e0b</p> </li> <li> <p>As described below \u5177\u4f53\u5982\u4e0b</p> </li> </ul> <p>The plan is as detailed below \u8ba1\u5212\u5177\u4f53\u5982\u4e0b\u6240\u4e0b</p> <p>The procedure is as described below \u6b65\u9aa4\u5982\u4e0b\u6240\u4e0b</p>"},{"location":"Eng/1work/#_4","title":"\u5f3a\u8c03\u63d0\u53ca\u5185\u5bb9","text":"<p>As mentioned below \u5982\u4e0b\u9762\u63d0\u5230\u7684</p> <p>As indicated below \u5982\u4e0b\u6240\u793a</p> <p>The key points are as mentioned below \u5173\u952e\u70b9\u5982\u4e0b\u6240\u8ff0</p> <p>the data is as indicated below \u6570\u636e\u5982\u4e0b\u6240\u793a</p>"},{"location":"Eng/1work/#_5","title":"\u5f3a\u8c03\u89c4\u8303\u8981\u6c42","text":"<p>As outlined below \u5982\u4e0b\u6240\u8ff0</p> <p>As specified below \u5982\u4e0b\u6240\u660e\u786e</p> <p>The meeting agenda is as outlined below \u4f1a\u8bae\u8bae\u7a0b\u5982\u4e0b\u6240\u793a</p> <p>The requirements are as specified below \u8981\u6c42\u5982\u4e0b\u6240\u793a</p>"},{"location":"Eng/1work/#20250630","title":"20250630 \u201c\u6211\u6ca1\u542c\u6e05\u201c","text":""},{"location":"Eng/1work/#_6","title":"\u7f51\u7edc\u95ee\u9898","text":"<p>I apologize, but your voice is breaking up. Can you say that again?  \u62b1\u6b49\uff0c\u4f46\u4f60\u7684\u58f0\u97f3\u65ad\u65ad\u7eed\u7eed\u3002\u4f60\u80fd\u518d\u8bf4\u4e00\u904d\u5417\uff1f</p> <p>I'm sorry, but it seems like the connection is a bit unstable. Can you explain it again? \u62b1\u6b49\uff01\u4f46\u4f60\u7684\u8fde\u63a5\u4f3c\u4e4e\u6709\u70b9\u6728\u7a33\u5b9a\u3002\u4f60\u80fd\u5728\u89e3\u91ca\u4e00\u4e0b\u5417</p> <p>It looks like the internet is lagging, I'm missing some of what you're saying. Could you repeat it?</p> <p>\u7f51\u7edc\u597d\u50cf\u6709\u5ef6\u8fdf\uff1b \u6211\u9519\u8fc7\u4e86\u4f60\u8bf4\u7684\u4e00\u4e9b\u5185\u5bb9\uff0c\u4f60\u80fd\u518d\u8bf4\u4e00\u6b21\u5417\uff1f</p> <p>I'm sorry, but your voice is a bit soft, could you please speak a little louder?  \u62b1\u6b61\uff0c\u4f46\u4f60\u7684\u58f0\u97f3\u6709\u70b9\u5c0f\uff1b\u60a8\u80fd\u8bf4\u5f97\u5927\u58f0\u4e00\u70b9\u5417\uff1f</p>"},{"location":"Eng/1work/#_7","title":"\u7406\u89e3\u95ee\u9898","text":"<p>I apologize, but I didn't quite catch that. Could you please repeat it? \u62b1\u6b49\uff0c\u6211\u6ca1\u6709\u542c\u6e05\u3002 \u60a8\u80fd\u518d\u8bf4\u4e00\u904d\u5417\uff1f</p> <p>I'm sorry, but I missed that part. Could you clarify what you just said? \u62d6\u6b49\uff0c\u90a3\u90e8\u5206\u6211\u6ca1\u542c\u6e05\u3002\u4f60\u80fd\u8bf4\u5f97\u66f4\u6e05\u695a\u4e00\u4e9b\u5417</p> <p>I'm not sure if I followed that. If you don't mind, could you go over that again? \u6211\u4e0d\u592a\u786e\u5b9a\u6211\u6709\u6ca1\u6709\u8ddf\u4e0a\u3002 \u5982\u679c\u4f60\u4e0d\u4ecb\u610f\u7684\u8bdd\uff0c\u53ef\u4ee5\u518d\u8bb2\u4e00\u904d\u5417</p> <p>Could you please elaborate on that? I want to make sure I got it right. \u4f60\u80fd\u8be6\u7ec6\u8bf4\u660e\u4e00\u4e0b\u5417\uff1f\u6211\u60f3\u786e\u4fdd\u6211\u7406\u89e3\u6b63\u786e</p>"},{"location":"Eng/1work/#20250702","title":"20250702  \u6b27\u7f8e\u804c\u573a\u5e38\u7528\u8868\u8fbe","text":""},{"location":"Eng/1work/#1-jump-the-gun","title":"1 jump the gun \u884c\u52a8\u8fc7\u65e9\uff1b\u64cd\u4e4b\u8fc7\u6025","text":"<p>We might jump the gun if we launch the campaign without a clear target audience</p> <p>\u5982\u679c\u5728\u6ca1\u6709\u660e\u786e\u76ee\u6807\u53d7\u4f17\u7684\u60c5\u51b5\u4e0b\uff0c \u542f\u52a8\u8fd9\u4e2a\u6d3b\u52a8\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u64cd\u4e4b\u8fc7\u6025</p> <p>Let's not jump the gun by ordering materials before the design is finalized</p> <p>\u8bbe\u8ba1\u5b9a\u7a3f\u524d\u6211\u4eec\u4e0d\u8981\u6025\u4e8e\u8ba2\u8d2d\u6750\u6599</p>"},{"location":"Eng/1work/#2-in-the-pipeline","title":"2 in the pipeline \u6b63\u5728\u8fdb\u884c\u4e2d","text":"<p>Our expansion into the Asian market is in the pipeline</p> <p>\u6211\u4eec\u8fdb\u8f66\u4e9a\u6d32\u5e02\u573a\u7684\u8ba1\u5212\u6b63\u5728\u63a8\u8fdb\u4e2d</p> <p>We have several new products in the pipeline hat we plan to launch next quarter</p> <p>\u6211\u4eec\u6709\u51e0\u6b3e\u65b0\u4ea7\u54c1\u6b63\u5728\u5f00\u53d1\u4e2d\uff0c\u8ba1\u5212\u5728\u4e0b\u4e2a\u5b63\u5ea6\u63a8\u51fa</p>"},{"location":"Eng/1work/#3-in-the-long-run","title":"3 in the long run \u4ece\u957f\u8fdc\u6765\u770b","text":"<p>Building strong client relationships will benefit us in the long run  \u5efa\u7acb\u7a33\u56fa\u7684\u5ba2\u6237\u5173\u7cfb\u4ece\u957f\u8fdc\u6765\u770b\u5bf9\u6211\u4eec\u6709\u76ca</p> <p>Streamlining our supply chain will reduce costs in the long run \u7b80\u4ecb\u6211\u4eec\u7684\u4f9b\u5e94\u94fe\u4ece\u957f\u8fdc\u6765\u770b\u4f1a\u964d\u4f4e\u6210\u672c</p>"},{"location":"Eng/1work/#4-on-the-radar","title":"4 on the radar \u5728\u5173\u6ce8\u8303\u56f4\u5185\uff1b\u88ab\u6ce8\u610f\u5230","text":"<p>This opportunity is definitely on the radar for future projects \u8fd9\u4e2a\u673a\u4f1a\u7edd\u5bf9\u5728\u6211\u4eec\u672a\u6765\u9879\u76ee\u7684\u8003\u8651\u8303\u56f4\u5185</p> <p>We need to keep this issue on the radar \u6211\u4eec\u9700\u8981\u5c06\u8fd9\u4e2a\u95ee\u9898\u4fdd\u6301\u5728\u5173\u6ce8\u8303\u56f4\u5185</p>"},{"location":"Eng/1work/#20250707","title":"20250707  \"\u8fde\u7eed\u4e09\u5929\"","text":"<ul> <li>for 3 days in a row \u8fde\u7eed3\u5929</li> <li>for 3 weeks in a row \u8fde\u7eed3\u5468</li> <li>for a few days in a row \u8fde\u7eed\u51e0\u5929</li> </ul> <p>I've been reviewing reports for 3 days in a row to ensure everything is correct </p> <p>\u6211\u5df2\u7ecf\u8fde\u7eed3\u5929\u5728\u5ba1\u67e5\u62a5\u544a\uff0c\u4ee5\u786e\u4fdd\u4e00\u5207\u90fd\u6b63\u786e</p> <p>For 3 days in a row, we've been receiving positive feedback from the clients</p> <p>\u8fde\u7eed3\u5929\uff0c\u6211\u4eec\u6536\u5230\u4e86\u6765\u81ea\u5ba2\u6237\u7684\u79ef\u6781\u53cd\u9988</p> <ul> <li>for 3 days straight \u8fde\u7eed3\u5929</li> <li>for 3 weeks straight \u8fde\u7eed3\u5468</li> <li>For a few days straight \u8fde\u7eed\u51e0\u5929</li> </ul> <p>We've been putting in extra hours for 3 days straight to meet the deadline</p> <p>\u6211\u4eec\u4e3a\u4e86\u8d76\u4e0a\u622a\u6b62\u65e5\u671f\uff0c\u8fde\u7eed3\u5929\u90fd\u5728\u52a0\u73ed</p> <p>She's been in meetings for 3 days straight, trying to resolve the issue with the clients</p> <p>\u5979\u8fde\u7eed3\u5929\u90fd\u5728\u5f00\u4f1a\uff0c\u8bd5\u56fe\u89e3\u51b3\u5ba2\u6237\u7684\u95ee\u9898</p>"},{"location":"Eng/1work/#for-3-consecutive-days-3","title":"for 3 consecutive days \u8fde\u7eed3\u5929","text":"<p>The team has been conducting interviews for 3 consecutive days to fill the open positions</p> <p>\u56e2\u961f\u5df2\u7ecf\u8fde\u7eed3\u5929\u8fdb\u884c\u9762\u8bd5\uff0c\u4ee5\u586b\u8865\u7a7a\u7f3a\u804c\u4f4d</p> <p>The sales team exceeded their targets for 3 consecutive days</p> <p>\u9500\u552e\u56e2\u961f\u8fde\u7eed3\u5929\u8d85\u989d\u5b8c\u6210\u76ee\u6807</p>"},{"location":"Eng/1work/#20250708","title":"20250708  \"\u6211\u4e34\u65f6\u6709\u4e8b\"","text":"<ul> <li>Something came up \u6211\u4e34\u65f6\u6709\u4e8b</li> </ul> <p>Sorry, I can't make it to the meeting, something came up \u5bf9\u4e0d\u8d77\uff0c\u6211\u4e0d\u80fd\u53c2\u52a0\u4f1a\u8bae\u4e86\uff0c\u6211\u4e34\u65f6\u6709\u4e8b</p> <p>I apologize for the sudden change \u5f88\u62b1\u6b49\u7a81\u7136\u6539\u53d8\u8ba1</p> <p>but something unexpected came up and I have to reschedule \u4f46\u6211\u4e34\u65f6\u6709\u4e8b\uff0c\u9700\u8981\u91cd\u65b0\u5b89\u6392\u65f6\u95f4</p> <ul> <li>urgent matter \u7d27\u6025\u7684\u4e8b\u60c5</li> <li>urgent issue \u7d27\u6025\u7684\u95ee\u9898</li> <li> <p>urgent situation \u7d27\u6025\u7684\u60c5\u51b5</p> </li> <li> <p>unexpected matter \u7a81\u53d1\u4e8b\u60c5</p> </li> <li>unexpected issue \u7a81\u53d1\u95ee\u9898</li> <li> <p>unexpected situation \u7a81\u53d1\u60c5\u51b5</p> </li> <li> <p>a last-minute matter \u4e34\u65f6\u7684\u4e8b\u60c5</p> </li> <li>a last-minute issue \u4e34\u65f6\u7684\u95ee\u9898</li> <li>a last-minute situation \u4e34\u65f6\u7684\u60c5\u51b5</li> </ul> <p>emergency \u7d27\u6025\u7684\u4e8b\u60c5</p>"},{"location":"Eng/1work/#attend-to-deal-with-handle-take-care-of","title":"Attend to \u5904\u7406 \uff1bdeal with\u5904\u7406 handle \u5904\u7406\uff1b take care of \u5904\u7406","text":"<ul> <li>I have an urgent matter to attend to  \u6211\u6709\u7d27\u6025\u7684\u4e8b\u60c5\u8981\u5904\u7406</li> <li>I have an unexpected situation to deal with \u6211\u6709\u7a81\u53d1\u60c5\u51b5\u9700\u8981\u5904\u7406</li> <li>I need to handle an emergency \u6211\u9700\u8981\u5904\u7406\u7d27\u6025\u60c5\u51b5</li> <li>I have a last-minute issue to take care of \u6211\u6709\u4e00\u4e2a\u4e34\u65f6\u7684\u95ee\u9898\u9700\u8981\u5904\u7406</li> <li>I need to handle an unexpected issue \u6211\u9700\u8981\u5904\u7406\u4e00\u4e2a\u7a81\u53d1\u95ee\u9898</li> <li>I have a last-minute issue to attend to \u6211\u4e34\u65f6\u6709\u4e8b\u8981\u5904\u7406</li> </ul>"},{"location":"Eng/1work/#20250709","title":"\u590d\u76d8 20250709","text":""},{"location":"Eng/1work/#retro","title":"retro \u590d\u76d8","text":"<p>In tomorrow's retrospective, we'll discuss what we can improve in the next phase  \u5728\u660e\u5929\u7684\u590d\u76d8\u4f1a\u4e0a\uff0c \u6211\u4eec\u4f1a\u8ba8\u8bba\u4e0b\u4e00\u9636\u6bb5\u53ef\u4ee5\u6539\u8fdb\u7684\u5730\u65b9</p> <p>The retro provide valuable insights into how we can streamline our workflow  \u8fd9\u6b21\u590d\u76d8\u4e3a\u6211\u4eec\u5982\u4f55\u4f18\u5316\u5de5\u4f5c\u6d41\u7a0b\u63d0\u4f9b\u4e86\u6709\u4ef7\u503c\u7684\u89c1\u89e3\u3002</p>"},{"location":"Eng/1work/#debrief","title":"debrief \u590d\u76d8","text":"<p>We scheduled a debrief to go over the outcomes of the training session \u6211\u4eec\u5b89\u6392\u4e86\u4e00\u6b21\u590d\u76d8\uff0c\u4ee5\u56de\u987e\u57f9\u8bad\u7684\u7ed3\u679c</p> <p>The debrief helped us understand where we fell short and how to adjust next time \u590d\u76d8\u8ba9\u6211\u4eec\u4e86\u89e3\u4e86\u4e0d\u8db3\u4e4b\u5904\uff0c\u5e76\u77e5\u9053\u5982\u4f55\u5728\u4e0b\u6b21\u8c03\u6574</p> <p>After the campaign, we'll debrief to see what strategies worked best \u6d3b\u52a8\u7ed3\u675f\u540e\uff0c\u6211\u4eec\u4f1a\u590d\u76d8\uff0c\u770b\u770b\u54ea\u4e9b\u7b56\u7565\u6709\u6548 </p>"},{"location":"Eng/1work/#review_1","title":"review \u590d\u76d8","text":"<p>We need a detailed review to understand what caused the delays \u6211\u4eec\u9700\u8981\u4e00\u6b21\u8be6\u7ec6\u7684\u590d\u76d8\u6765\u4e86\u89e3\u5ef6\u8bef\u7684\u539f\u56e0</p> <p>The quarterly review showcased both achievements and challenges \u8fd9\u6b21\u590d\u76d8\u5c55\u793a\u4e86\u6210\u5c31\u4e0e\u6311\u6218</p> <p>We need to review last quarter's performance to identify areas for improvement \u6211\u4eec\u9700\u8981\u590d\u76d8\u4e0a\u4e00\u5b63\u5ea6\u7684\u8868\u73b0\uff0c\u4ee5\u627e\u51fa\u53ef\u4ee5\u6539\u8fdb\u7684\u5730\u5546</p>"},{"location":"Eng/1work/#3-20250710","title":"\u201c\u4f1a\u8bae\u63a8\u8fdf\u52303\u70b9\u201d  20250710","text":""},{"location":"Eng/1work/#postpone","title":"postpone \u63a8\u8fdf\u3001","text":"<p>The project kick-off meeting has been postponed to 3pm due to some technical issues \u7531\u4e8e\u6280\u6765\u95ee\u9898\uff0c\u9879\u81ea\u542f\u52a8\u4f1a\u63a8\u8fdf\u5230\u4e00\u5361\u5e743\u70b9</p> <p>We have postponed the submission deadline until 3PM  \u6211\u4eec\u628a\u63d0\u4ea4\u622a\u6b62\u65f6\u95f4\u63a8\u8fdf\u5230\u4e0b\u53483\u70b9</p>"},{"location":"Eng/1work/#push-back","title":"push back \u63a8\u8fdf","text":"<p>The staff meeting has been pushed back 3pm due to a scheduling conflict \u7531\u4e8e\u65f6\u95f4\u51b2\u7a81\uff0c\u5458\u5de5\u4f1a\u8bae\u5df2\u63a8\u8fdf\u5230\u4e0b\u53483\u70b9</p> <p>We need to push back the training workshop to 3pm to align with the trainer's schedule  \u57f9\u8bad\u7814\u8ba8\u4f1a\u5df2\u63a8\u8fdf\u5230\u4e0b\u5e743\u70b9\uff0c\u4ee5\u987e\u53ca\u8bb2\u5e08\u7684\u65f6\u95f4\u5b89\u6296</p>"},{"location":"Eng/1work/#delay","title":"delay \u63a8\u8fdf\u3001","text":"<p>The client meeting has been delayed until 3pm to allow for further preparation \u4e3a\u4e86\u8fdb\u884c\u66f4\u8fdb\u4e00\u6b65\u7684\u51c6\u5907\uff0c\u5ba2\u6237\u4f1a\u8bae\u5df2\u63a8\u8fdf\u5230\u4e0b\u53483\u70b9</p>"},{"location":"Eng/1work/#reschedule","title":"reschedule \u4fee\u6539\u65f6\u95f4","text":"<p>We need to reschedule the team meeting to pm to accommodate everyone\u2019s 3 pm to accommodate everyone's availability</p> <p>\u6211\u4eec\u9700\u8981\u5c06\u56e2\u961f\u4f1a\u8bae\u65f6\u95f4\u63a8\u8fdf\u5230\u4e0b\u53483\u70b9\uff0c \u4ee5\u914d\u5408\u6240\u6709\u4eba\u7684\u65f6\u95f4\u5b89\u6392</p>"},{"location":"Eng/1work/#im-frozen","title":"I'm frozen=\u6211\u5361\u4f4f\u4e86","text":"<p>I'm frozen on my end. Is everything okay on your side? \u6211\u8fd9\u8fb9\u5361\u4f4f\u4e86\u3002\u4f60\u90a3\u8fb9\u4e00\u5207\u6b63\u5e38\u5417\uff1f</p> <p>I'm frozen and can't respond. Please give me a moment \u6211\u5361\u4f4f\u4e86\uff0c\u65e0\u6cd5\u56de\u590d\u3002\u8bf7\u7ed9\u6211\u4e00\u70b9\u65f6\u95f4</p> <p>My screen is frozen  \u6211\u7684\u5c4f\u5e55\u5361\u4f4f\u4e86</p> <p>My screen is frozen. Can you hear me? \u6211\u7684\u5c4f\u5e55\u5361\u4f4f\u4e86\u3002\u4f60\u4eec\u8fd8\u80fd\u542c\u5230\u6211</p>"},{"location":"Eng/1work/#break-up","title":"break up \u58f0\u97f3\u65ad\u65ad\u7eed\u7eed","text":"<p>I'm breaking up \u6211\u5361\u4f4f\u4e86</p> <p>Sorry, I think I'm breaking up. Let me move to a better spot \u62b1\u6b49\uff0c\u6211\u89c9\u5f97\u6211\u7684\u58f0\u7ae0\u65ad\u65ad\u7eed\u7eed\u7684\u3002 \u8ba9\u6211\u6362\u4e2a\u4fe1\u53f7\u66f4\u597d\u7684\u5730\u65b9</p> <p>I'm breaking up. Maybe it's the internet connection \u6211\u8fd9\u9069\u7684\u58f0\u97f3\u65ad\u65ad\u7eed\u7eed\u7684\u3002\u53ef\u80fd\u662f\u7f51\u7edc\u8fde\u63a5\u7684\u95ee\u9898</p> <p>sorry, you re breaking up. \u62b1\u6b49\uff0c\u4f60\u5361\u4e3b\u4e86\uff0c \u4f60\u80fd\u518d\u8bf4\u4e00\u904d\u5417</p>"},{"location":"Eng/1work/#lag","title":"lag \u5ef6\u8fdf\uff1b \u5361\u987f","text":"<p>Im lagging \u6211\u5361\u4f4f\u4e86\uff1b \u6211\u6709\u5ef6\u8fdf</p> <p>Sorry, I'm lagging. Let me try to restart my connection  \u62b1\u6b49\uff0c\u6211\u6709\u70b9\u5361\u3002\u8ba9\u6211\u8bd5\u8bd5\u91cd\u542f\u8fde\u63a5</p> <p>I'm lagging a bit. Give me a moment to catch up \u6211\u6709\u70b9\u5361\u3002\u7ed9\u6211\u4e00\u70b9\u65f6\u95f4\u8ddf\u4e0a\u5927\u5bb6</p>"},{"location":"Eng/1work/#bad-connectionpoor-connection","title":"bad connection/poor connection \u7f51\u7edc\u4e0d\u597d\uff1b\u5361\u4f4f","text":"<p>The connection is bad, I can't really hear you \u7f51\u4e0d\u597d\uff0c\u6211\u542c\u4e0d\u5230\u4f60\u8bf4\u4ec0\u4e48</p> <p>The connection is poor, I might drop out unexpectedly \u7f51\u5f88\u5dee\uff0c\u6211\u53ef\u80fd\u4f1a\u7a81\u7136\u6389\u7ebf</p>"},{"location":"Eng/1work/#20250725-in-due-course-by-the-book-call-the-shots-take-it-offline","title":"20250725 In due course / By the book / Call the shots / Take it offline","text":""},{"location":"Eng/1work/#in-due-course","title":"In due course \u5728\u9002\u5f53\u7684\u65f6\u5019\uff1b\u5728\u5408\u9002\u7684\u65f6\u95f4","text":"<p>All payments will be processed in due course, so please be patient </p> <p>\u6240\u6709\u4ed8\u6b3e\u90fd\u4f1a\u5728\u9002\u5f53\u7684\u65f6\u95f4\u5185\u5904\u7406\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85</p> <p>You will receive further details about the project in due course</p> <p>\u4f60\u5c06\u5728\u9002\u5f53\u7684\u65f6\u5019\u6536\u5230\u6709\u5173\u8be5\u9879\u76ee\u7684\u66f4\u591a\u7ec6\u8282</p>"},{"location":"Eng/1work/#by-the-book","title":"By the book \u6309\u89c4\u77e9\u529e\u4e8b\uff1b\u9075\u5faa\u89c4\u5b9a","text":"<p>We need to do this by the book to avoid any legal issues  \u6211\u4eec\u9700\u8981\u4e25\u683c\u6309\u7167\u89c4\u7ae0\u5236\u5ea6\u6765\u505a\uff0c\u4ee5\u907f\u514d\u4efb\u4f55\u6cd5\u5f8b\u95fb\u9898</p> <p>He runs his team by the book, making sure all policies are followed \u4ed6\u4e25\u683c\u6309\u7167\u89c4\u5b9a\u7ba1\u7406\u56e2\u961f\uff0c\u786e\u4fdd\u6240\u6709\u653f\u7b56\u90fd\u88ab\u6267\u884c</p>"},{"location":"Eng/1work/#call-the-shots","title":"Call the shots \u505a\u6700\u7ec8\u51b3\u5b9a\uff1b\u505a\u51b3\u7b56","text":"<p>In this project, she is the one calling the shots \u5728\u8fd9\u4e2a\u9879\u76ee\u91cc\uff0c\u5979\u662f\u505a\u51b3\u7b56\u7684\u4eba</p> <p>If you want more responsibility, you need to show you can call the shots \u5982\u679c\u4f60\u60f3\u627f\u62c5\u66f4\u591a\u8d23\u4efb\uff0c\u5c31\u8981\u5c55\u73b0\u51fa\u4f60\u7684\u51b3\u7b56\u80fd\u529b</p>"},{"location":"Eng/1work/#take-it-offline","title":"Take it offline \u79c1\u4e0b\u8ba8\u8bba\uff1b\u7ebf\u4e0b\u8ba8\u8bba","text":"<p>This discussion is getting too detailed, let's take it offline \u8fd9\u4e2a\u8ba8\u8bba\u592a\u7ec6\u8282\u4e86\uff0c\u6211\u4eec\u79c1\u4e0b\u518d\u804a</p> <p>We'll take this issue offline and discuss it after the meeting \u6211\u4eec\u4f1a\u5728\u4f1a\u8bae\u540e\u79c1\u4e0b\u8ba8\u8bba\u8fd9\u4e2a\u95ee\u9898</p>"},{"location":"Eng/1work/#20250726","title":"20250726 \u6211\u80fd\u63d2\u53e5\u8bdd\u5417","text":"<p>Can I jump in for a second?  \u6211\u80fd\u63d2\u53e5\u8bdd\u5417\uff1f</p> <p>Can I jump in for a second? I just want to clarity one point about the timeline </p> <p>\u6211\u80fd\u63d2\u53e5\u8bdd\u5417\uff1f\u6211\u53ea\u662f\u8bf4\u6e05\u65f6\u95f4\u5b89\u6392\u7684\u95ee\u9898</p> <p>Can I jump in for a second? I have some relevant data that might help \u6211\u80fd\u63d2\u4e00\u53e5\u5417\uff1f\u6211\u6709\u4e00\u4e9b\u76f8\u5173\u6570\u636e\u53ef\u80fd\u4f1a\u6709\u5e2e\u52a9</p> <p>Can I add something here? \u6211\u80fd\u8865\u5145\u4e00\u53e5\u5417\uff1f</p> <p>Can I add something here? I think we might be overlooking a key risk \u6211\u80fd\u8865\u5145\u4e00\u53e5\u5417\uff1f\u6211\u89c9\u5f97\u6211\u4eec\u53ef\u80fd\u5ffd\u7565\u4e86\u4e00\u4e2a\u5173\u952e\u98ce\u9669\u70b9</p> <p>Can I add something here? We also need to consider the client's timeline \u6211\u53ef\u4ee5\u8865\u5145\u4e00\u70b9\u5417\uff1f\u6211\u4eec\u4e5f\u9700\u8981\u8003\u8651\u5ba2\u6237\u7684\u65f6\u95f4\u5b89\u6392</p> <p>May I chime in? \u6211\u53ef\u4ee5\u63d2\u53e5\u8bdd\u5417\uff1f</p> <p>May I chime in? l've handled a similar case before \u6211\u53ef\u4ee5\u63d2\u4e00\u53e5\u5417\uff1f\u6211\u4ee5\u524d\u5904\u7406\u8fc7\u7c7b\u4f3c\u7684\u60c5\u51b5</p> <p>May I chime in? I have a suggestion that could streamline the process \u6211\u53ef\u4ee5\u63d2\u53e5\u8bdd\u5417\uff1f\u6211\u6709\u4e00\u4e2a\u5efa\u8bae\u53ef\u80fd\u53ef\u4ee5\u7b80\u5316\u8fd9\u4e2a\u6d41\u7a0b</p>"},{"location":"Eng/1work/#20250804","title":"20250804 \u6211\u80fd\u63d2\u53e5\u8bdd\u5417","text":""},{"location":"Eng/1work/#1-perspective","title":"1 perspective \u770b\u4e8b\u60c5\u7684\u89d2\u5ea6/ \u89c2\u70b9/\u770b\u6cd5","text":"<p>We need to consider the user\u2019s perspective when designing this feature  \u6211\u4eec\u5728\u8bbe\u8ba1\u8fd9\u4e2a\u529f\u80fd\u65f6\u8981\u8003\u8651\u7528\u6237\u7684\u89c6\u89d2</p> <p>Her international background brings a valuable perspective to our team \u5979\u7684\u56fd\u9645\u80cc\u666f\u4e3a\u6211\u4eec\u7684\u56e2\u961f\u5e26\u6765\u4e86\u5b9d\u8d35\u7684\u521d\u89d2</p> <p>From a financial perspective this project carries too much risk \u4ece\u8d22\u52a1\u89d2\u5ea6\u6765\u770b\uff0c\u8fd9\u4e2a\u9879\u76ee\u98ce\u9669\u592a\u9ad8</p>"},{"location":"Eng/1work/#2-prospective","title":"2 prospective \u672a\u6765\u7684\uff1b\u6f5c\u5728\u7684\uff1b\u6709\u53ef\u80fd\u6210\u4e3a\u7684","text":"<p>We're meeting a prospective client this afternoon \u6211\u4eec\u4e0b\u5348\u8981\u89c1\u4e00\u4e2a\u6f5c\u5728\u5ba2\u6237</p> <p>The team is making a list of prospective suppliers for next quarter \u56e2\u961f\u6b63\u5728\u505a\u4e00\u4efd\u4e0b\u5b63\u5ea6\u53ef\u80fd\u5408\u4f5c\u7684\u4f9b\u5e94\u5546\u540d</p> <p>Our marketing materials are designed to attract prospective investors \u6211\u4eec\u7684\u8425\u9500\u8d44\u6599\u65e8\u5e03\u961f\u5f15\u6f5c\u5728\u6295\u8d44</p> <ul> <li> <p>perspective n. \u770b\u4e8b\u60c5\u7684\u89d2\u5ea6/\u89c2\u70b9/\u770b\u6cd5</p> </li> <li> <p>prospective adj. \u672a\u6765\u7684/ \u6f5c\u5728\u7684</p> </li> </ul>"},{"location":"Eng/1work/#20250805-compliment-complement","title":"20250805 compliment / complement","text":""},{"location":"Eng/1work/#compliment","title":"compliment \u540d\u8bcd/\u52a8\u8bcd","text":"<p>n.\u8d5e\u7f8e\uff0c\u79f0\u8d5e v.\u8d5e\u7f8e/\u79f0\u8d5e \u67d0\u4eba\u6216\u67d0\u4e8b\u7269</p> <p>She blushed when he gave her a genuine compliment \u5f53\u4ed6\u76f4\u8bda\u5730\u5938\u5979\u65f6\uff0c\u5979\u8138\u90fd\u7ea2\u4e86</p> <p>The manager complimented the whole team for meeting the tight deadline \u7ecf\u7406\u8868\u626c\u4e86\u6574\u4e2a\u56e2\u961f\u5982\u671f\u5b8c\u6210\u7d27\u6025\u4f4f\u52a1</p> <p>I just wanted to compliment you on your outfit, it looks great! \u6211\u5c31\u662f\u60f3\u5938\u4e00\u4e0b\u4f60\u4eca\u5173\u7684\u7a7f\u642d\uff0c\u771f\u7684\u5f88\u597d\u770b</p>"},{"location":"Eng/1work/#complement","title":"complement \u540d\u8bcd/\u52a8\u8bcd","text":"<p>n.\u8865\u5145\uff1b\u642d\u914d\uff1b \u4e92\u8865</p> <p>v.\u4e0e\u2026\u642d\u914d \u4e0e\u2026.\u4e92\u8865</p> <p>His calm nature is the perfect complement to her high energy \u4ed6\u51b7\u9759\u7684\u6027\u683c\u4e0e\u5979\u5145\u6c9b\u7684\u6d3b\u529b\u5f62\u6210\u4e86\u5b8c\u7f8e\u539f\u8865</p> <p>This dish is the perfect complement to the red wine \u8fd9\u9053\u83dc\u662f\u7ea2\u9152\u7684\u5b8c\u7f8e\u642d\u914d</p> <p>Your strengths complement mine, that's why we work so well together \u4f60\u7684\u957f\u5904\u6b63\u597d\u548c\u6211\u4e92\u8865\uff0c\u6240\u4ee5\u6211\u4eec\u914d\u5408\u5f97\u5f88\u9ed8\u5951</p> <p>Their personalities complement each other, she's outgoing, he's shy \u4ed6\u4eec\u7684\u6027\u683c\u4e92\u8865\u3002\u5979\u5916\u5411\uff0c\u4ed6\u5bb3\u7f9e</p>"},{"location":"Eng/1work/#20250805-if-it-werent-for","title":"20250805 If it weren't for...\u8981\u4e0d\u662f\u56e0\u4e3a","text":"<p>If it weren't for...\u8981\u4e0d\u662f\u56e0\u4e3a\u2026..  \u56e0\u4e3a\u8fd9\u4e2a\u4eba/\u8fd9\u4e2a\u539f\u56e0\uff0c\u4e8b\u60c5\u5c31\u4e0d\u4f1a\u53d8\u6210\u8fd9\u6837</p> <p>\u5728\u8bf4\u4e00\u4e2a\u201c\u5047\u8bbe\u201d\uff0c\u7528\u865a\u62df\u8bed\u6c14</p> <p>If it weren't for your support, we couldn't have closed the deal  \u5982\u679c\u4e0d\u662f\u4f60\u7684\u652f\u6301\uff0c\u6211\u4eec\u65e0\u6cd5\u62ff\u4e0b\u8fd9\u4e2a\u8ba2\u5355</p> <p>If it weren't for Sarah's quick thinking, the whole project might have failed \u8981\u4e0d\u662fSarah \u53cd\u5e94\u5feb\uff0c\u8fd9\u4e2a\u9879\u76ee\u53ef\u80fd\u5c31\u5931\u8d25\u4e86</p> <p>If it weren't for my morning coffee, I wouldn't survive Mondays \u800d\u4e0d\u662f\u65e9\u4e0a\u7684\u5496\u5561\uff0c\u6211\u6839\u672c\u71ac\u4e0d\u8fc7\u661f\u671f\u4e00</p> <p>If it weren't for my cat, my furniture would still be in good shape \u8981\u4e0d\u662f\u6211\u5bb6\u732b\uff0c\u6211\u7684\u5bb6\u5177\u73b0\u5728\u8fd8\u5b8c\u597d\u65e0\u635f\u5462</p>"},{"location":"Eng/1work/#20250806","title":"20250806 \u6577\u884d","text":""},{"location":"Eng/1work/#brush-off-sb","title":"brush off sb \u6577\u884d","text":"<p>He brushed off the client's concerns, saying everything was under control</p> <p>\u4ed6\u6577\u884d\u4e86\u5ba2\u6237\u7684\u62c5\u5fe7\uff0c\u8bf4\u4e00\u5207\u90fd\u5728\u638c\u63a7\u4e4b\u4e2d</p> <p>I felt frustrated because my ideas were constantly brushed off in the meeting</p> <p>\u6211\u611f\u5230\u6cae\u4e27\uff0c\u56e0\u4e3a\u6211\u7684\u60f3\u6cd5\u5728\u4f1a\u8bae\u4e0a\u603b\u662f\u88ab\u6577\u884d\u5bf9\u5f85</p>"},{"location":"Eng/1work/#go-through-the-motions","title":"Go through the motions \u8d70\u8fc7\u573a\uff1b\u6577\u884d\u4e86\u4e8b","text":"<p>If you just go through the motions in customer service, clients will notice and lose trust</p> <p>\u5982\u679c\u4f60\u5728\u5ba2\u6237\u670d\u52a1\u4e2d\u53ea\u662f\u6577\u884d\u5e94\u4ed8\uff0c\u5ba2\u6237\u4f1a\u5bdf\u89c9\u5e76\u5931\u53bb\u4fe1\u4efb</p> <p>We can't afford to go through the motions on this project, every detail matters</p> <p>\u8fd9\u4e2a\u9879\u76ee\u4e0d\u80fd\u6577\u884d\u4e86\u4e8b\uff0c\u6bcf\u4e2a\u7ec6\u8282\u90fd\u5f88\u91cd\u8981</p>"},{"location":"Eng/1work/#do-the-bare-minimum","title":"Do the bare minimum \u53ea\u505a\u6700\u4f4e\u9650\u5ea6\u7684\u4e8b\u60c5\uff1b\u6577\u884d\u4e86\u4e8b","text":"<p>If you just do the bare minimum, don't expect to get promoted</p> <p>\u5982\u679c\u4f60\u53ea\u662f\u6577\u884d\u4e86\u4e8b\uff0c\u522b\u6307\u671b\u80fd\u5347\u804c</p> <p>The intern did the bare minimum on the report, so I had to rewrite most of it</p> <p>\u5b9e\u4e60\u751f\u5728\u62a5\u544a\u4e0a\u53ea\u662f\u6577\u884d\u4e86\u4e8b\uff0c\u6240\u4ee5\u6211\u4e0d\u5f97\u4e0d\u91cd\u5199\u5927\u90e8\u5206\u5185\u5bb9</p>"},{"location":"chap1/1CPU_Cache/","title":"\u7b2c\u4e00\u8282 \u4ee3\u7801\u8ba9CPU\u6267\u884c\u5f97\u66f4\u5feb \u2014 CPU\u7f13\u5b58","text":"<p>\u4efb\u4f55\u4ee3\u7801\u7684\u6267\u884c\u90fd\u4f9d\u8d56 CPU\uff0c\u901a\u5e38\uff0c\u4f7f\u7528\u597d CPU \u662f\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7684\u5de5\u4f5c\u3002\u7136\u800c\uff0c\u5f53\u6211\u4eec\u7f16\u5199\u8ba1\u7b97\u5bc6\u96c6\u578b\u7684\u7a0b\u5e8f\u65f6\uff0cCPU \u7684\u6267\u884c\u6548\u7387\u5c31\u5f00\u59cb\u53d8\u5f97\u81f3\u5173\u91cd\u8981\u3002</p> <p>\u7531\u4e8e CPU \u7f13\u5b58\u7531\u66f4\u5feb\u7684 SRAM \u6784\u6210\uff08\u5185\u5b58\u662f\u7531 DRAM \u6784\u6210\u7684\uff09\uff0c\u800c\u4e14\u79bb CPU \u6838\u5fc3\u66f4\u8fd1\uff0c\u5982\u679c\u8fd0\u7b97\u65f6\u9700\u8981\u7684\u8f93\u5165\u6570\u636e\u662f\u4ece CPU \u7f13\u5b58\uff0c\u800c\u4e0d\u662f\u5185\u5b58\u4e2d\u8bfb\u53d6\u65f6\uff0c\u8fd0\u7b97\u901f\u5ea6\u5c31\u4f1a\u5feb\u5f88\u591a\u3002</p> <p>\u6240\u4ee5\uff0c\u4e86\u89e3 CPU \u7f13\u5b58\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\uff0c\u4fbf\u80fd\u591f\u66f4\u6709\u6548\u5730\u7f16\u5199\u6211\u4eec\u7684\u4ee3\u7801\uff0c\u4f18\u5316\u7a0b\u5e8f\u6027\u80fd\u3002</p>"},{"location":"chap1/1CPU_Cache/#1cpu","title":"1\u3001CPU \u7684\u591a\u7ea7\u7f13\u5b58","text":"<p>CPU \u7f13\u5b58\u79bb CPU \u6838\u5fc3\u66f4\u8fd1\uff0c\u7531\u4e8e\u7535\u5b50\u4fe1\u53f7\u4f20\u8f93\u662f\u9700\u8981\u65f6\u95f4\u7684\uff0c\u6240\u4ee5\u79bb CPU \u6838\u5fc3\u8d8a\u8fd1\uff0c\u7f13\u5b58\u7684\u8bfb\u5199\u901f\u5ea6\u5c31\u8d8a\u5feb\u3002\u4f46 CPU \u7684\u7a7a\u95f4\u5f88\u72ed\u5c0f\uff0c\u79bb CPU \u8d8a\u8fd1\u7f13\u5b58\u5927\u5c0f\u53d7\u5230\u7684\u9650\u5236\u4e5f\u8d8a\u5927\u3002\u6240\u4ee5\uff0c\u7efc\u5408\u786c\u4ef6\u5e03\u5c40\u3001\u6027\u80fd\u7b49\u56e0\u7d20\uff0cCPU \u7f13\u5b58\u901a\u5e38\u5206\u4e3a\u5927\u5c0f\u4e0d\u7b49\u7684\u4e09\u7ea7\u7f13\u5b58\u3002</p> <p>CPU \u7f13\u5b58\u7684\u6750\u8d28 SRAM \u6bd4\u5185\u5b58\u4f7f\u7528\u7684 DRAM \u8d35\u8bb8\u591a\uff0c\u6240\u4ee5\u4e0d\u540c\u4e8e\u5185\u5b58\u52a8\u8f84\u4ee5 GB \u8ba1\u7b97\uff0c\u5b83\u7684\u5927\u5c0f\u662f\u4ee5 MB \u6765\u8ba1\u7b97\u7684\u3002</p> <p>\u6bd4\u5982\uff0c\u5728\u6211\u7684 Linux \u7cfb\u7edf\u4e0a\uff0c\u79bb CPU \u6700\u8fd1\u7684\u4e00\u7ea7\u7f13\u5b58\u662f 32KB\uff0c\u4e8c\u7ea7\u7f13\u5b58\u662f 256KB\uff0c\u6700\u5927\u7684\u4e09\u7ea7\u7f13\u5b58\u5219\u662f 20MB\u3002</p> <p></p> <pre><code>$ getconf -a | grep CACHE\nLEVEL1_ICACHE_SIZE                 32768\nLEVEL1_ICACHE_ASSOC                8\nLEVEL1_ICACHE_LINESIZE             64\nLEVEL1_DCACHE_SIZE                 32768\nLEVEL1_DCACHE_ASSOC                8\nLEVEL1_DCACHE_LINESIZE             64\nLEVEL2_CACHE_SIZE                  262144\nLEVEL2_CACHE_ASSOC                 4\nLEVEL2_CACHE_LINESIZE              64\nLEVEL3_CACHE_SIZE                  16777216\nLEVEL3_CACHE_ASSOC                 16\nLEVEL3_CACHE_LINESIZE              64\nLEVEL4_CACHE_SIZE                  0\nLEVEL4_CACHE_ASSOC                 0\nLEVEL4_CACHE_LINESIZE              0\n</code></pre> <p></p> <p>\u7f13\u5b58\u8981\u6bd4\u5185\u5b58\u5feb\u5f88\u591a\u3002</p> <p>CPU \u8bbf\u95ee\u4e00\u6b21\u5185\u5b58\u901a\u5e38\u9700\u8981 100 \u4e2a\u65f6\u949f\u5468\u671f\u4ee5\u4e0a\uff0c\u800c\u8bbf\u95ee\u4e00\u7ea7\u7f13\u5b58\u53ea\u9700\u8981 4~5 \u4e2a\u65f6\u949f\u5468\u671f\uff0c\u4e8c\u7ea7\u7f13\u5b58\u5927\u7ea6 12 \u4e2a\u65f6\u949f\u5468\u671f\uff0c\u4e09\u7ea7\u7f13\u5b58\u5927\u7ea6 30 \u4e2a\u65f6\u949f\u5468\u671f\uff08\u5bf9\u4e8e 2GHZ \u4e3b\u9891\u7684 CPU \u6765\u8bf4\uff0c\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u662f 0.5 \u7eb3\u79d2\u3002</p> <p>\u5982\u679c CPU \u6240\u8981\u64cd\u4f5c\u7684\u6570\u636e\u5728\u7f13\u5b58\u4e2d\uff0c\u5219\u76f4\u63a5\u8bfb\u53d6\uff0c\u8fd9\u79f0\u4e3a\u7f13\u5b58\u547d\u4e2d\u3002\u547d\u4e2d\u7f13\u5b58\u4f1a\u5e26\u6765\u5f88\u5927\u7684\u6027\u80fd\u63d0\u5347\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u7684\u4ee3\u7801\u4f18\u5316\u76ee\u6807\u662f\u63d0\u5347 CPU \u7f13\u5b58\u7684\u547d\u4e2d\u7387\u3002</p> <p>\u5f53\u7136\uff0c\u7f13\u5b58\u547d\u4e2d\u7387\u662f\u5f88\u7b3c\u7edf\u7684\uff0c\u5177\u4f53\u4f18\u5316\u65f6\u8fd8\u5f97\u4e00\u5206\u4e3a\u4e8c\u3002</p> <p>\u6bd4\u5982\uff0c\u4f60\u5728\u67e5\u770b CPU \u7f13\u5b58\u65f6\u4f1a\u53d1\u73b0\u6709 2 \u4e2a\u4e00\u7ea7\u7f13\u5b58\uff08\u6bd4\u5982 Linux \u4e0a\u5c31\u662f\u4e0a\u56fe\u4e2d\u7684 index0 \u548c index1\uff09\uff0c\u8fd9\u662f\u56e0\u4e3a\uff0cCPU \u4f1a\u533a\u522b\u5bf9\u5f85\u6307\u4ee4\u4e0e\u6570\u636e\u3002\u6bd4\u5982\uff0c\u201c1+1=2\u201d\u8fd9\u4e2a\u8fd0\u7b97\uff0c\u201c+\u201d\u5c31\u662f\u6307\u4ee4\uff0c\u4f1a\u653e\u5728\u4e00\u7ea7\u6307\u4ee4\u7f13\u5b58\u4e2d\uff0c\u800c\u201c1\u201d\u8fd9\u4e2a\u8f93\u5165\u6570\u5b57\uff0c\u5219\u653e\u5728\u4e00\u7ea7\u6570\u636e\u7f13\u5b58\u4e2d\u3002</p> <p>\u867d\u7136\u5728\u51af\u8bfa\u4f9d\u66fc\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\u4e2d\uff0c\u4ee3\u7801\u6307\u4ee4\u4e0e\u6570\u636e\u662f\u653e\u5728\u4e00\u8d77\u7684\uff0c\u4f46\u6267\u884c\u65f6\u5374\u662f\u5206\u5f00\u8fdb\u5165\u6307\u4ee4\u7f13\u5b58\u4e0e\u6570\u636e\u7f13\u5b58\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u8981\u5206\u5f00\u6765\u770b\u4e8c\u8005\u7684\u7f13\u5b58\u547d\u4e2d\u7387\u3002</p>"},{"location":"chap1/1CPU_Cache/#2","title":"2\u3001\u63d0\u5347\u6570\u636e\u7f13\u5b58\u7684\u547d\u4e2d\u7387","text":"<p>\u8bbf\u95ee\u987a\u5e8f\u662f\u5982\u4f55\u5f71\u54cd\u7f13\u5b58\u547d\u4e2d\u7387</p> <p>\u6bd4\u5982\u73b0\u5728\u8981\u904d\u5386\u4e8c\u7ef4\u6570\u7ec4\uff0c\u5176\u5b9a\u4e49\u5982\u4e0b\u8bc1\u7684 C/C++\u3001Java</p> <pre><code>int array[N][N];\n</code></pre> <p>\u7528 <code>array[j][i]</code> \u548c <code>array[i][j]</code>\u8bbf\u95ee\u6570\u7ec4\u5143\u7d20\uff0c\u54ea\u4e00\u79cd\u6027\u80fd\u66f4\u5feb\uff1f</p> <pre><code>for(i = 0; i &lt; N; i+=1) {\n   for(j = 0; j &lt; N; j+=1) {\n       array[i][j] = 0;\n   }\n}\n</code></pre> <p>C++ \u4ee3\u7801\u5b9e\u73b0\u4e2d\uff0c\u524d\u8005 <code>array[j][i]\u6267</code>\u884c\u7684\u65f6\u95f4\u662f\u540e\u8005 <code>array[i][j]</code>\u7684 <code>8</code>\u500d\u4e4b\u591a</p> <p>\u4e3a\u4ec0\u4e48\u4f1a\u6709\u8fd9\u4e48\u5927\u7684\u5dee\u8ddd\u5462\uff1f</p> <p>\u8fd9\u662f\u56e0\u4e3a\u4e8c\u7ef4\u6570\u7ec4 array \u6240\u5360\u7528\u7684\u5185\u5b58\u662f\u8fde\u7eed\u7684\uff0c\u6bd4\u5982\u82e5\u957f\u5ea6 N \u7684\u503c\u4e3a 2\uff0c\u90a3\u4e48\u5185\u5b58\u4e2d\u4ece\u524d\u81f3\u540e\u5404\u5143\u7d20\u7684\u987a\u5e8f\u662f\uff1a</p> <pre><code>array[0][0]\uff0carray[0][1]\uff0carray[1][0]\uff0carray[1][1]\u3002\n</code></pre> <p>\u6b64\u65f6\u5185\u5b58\u662f\u8df3\u8dc3\u8bbf\u95ee\u7684\uff0c\u5982\u679c N \u7684\u6570\u503c\u5f88\u5927\uff0c\u90a3\u4e48\u64cd\u4f5c <code>array[j][i]</code>\u65f6\uff0c\u662f\u6ca1\u6709\u529e\u6cd5\u628a <code>array[j+1][i</code>]\u4e5f\u8bfb\u5165\u7f13\u5b58\u7684\u3002</p> <p>2 \u4e2a\u95ee\u9898</p> <ul> <li>\u4e3a\u4ec0\u4e48\u4e24\u8005\u7684\u6267\u884c\u65f6\u95f4\u6709\u7ea6 7\u30018 \u500d\u7684\u5dee\u8ddd\u5462\uff1f</li> <li>\u8f7d\u5165 <code>array[0][0]</code>\u5143\u7d20\u65f6\uff0c\u7f13\u5b58\u4e00\u6b21\u6027\u4f1a\u8f7d\u5165\u591a\u5c11\u5143\u7d20\u5462\uff1f</li> </ul> <p>\u5176\u5b9e\u8fd9\u4e24\u4e2a\u95ee\u9898\u7684\u7b54\u6848\u90fd\u4e0e CPU Cache Line \u76f8\u5173\uff0c\u5b83\u5b9a\u4e49\u4e86\u7f13\u5b58\u4e00\u6b21\u8f7d\u5165\u6570\u636e\u7684\u5927\u5c0f\uff0cLinux \u4e0a\u4f60\u53ef\u4ee5\u901a\u8fc7 <code>coherency_line_size</code> \u914d\u7f6e\u67e5\u770b\u5b83\uff0c\u901a\u5e38\u662f 64 \u5b57\u8282\u3002</p> <p>cup cache line\u4e00\u6b21\u52a0\u8f7d\u5230cpu \u9ad8\u901f\u7f13\u5b58\u7684\u5b57\u8282\u6570(\u4e00\u822c64\u5b57\u8282), \u4e3a\u4e86\u8ba9\u591a\u6838\u76841,2\u7ea7\u9ad8\u901f\u7f13\u5b58\u4e0d\u5931\u6548\u548c\u88ab\u9501(cpu\u7f13\u5b58\u4e00\u81f4\u6027\u539f\u5219)\u5199\u4ee3\u7801\u7684\u65f6\u5019\u7ecf\u5e38\u4f1a\u505a\u5b57\u8282\u5bf9\u5176,\u4fdd\u8bc1\u4e00\u4e2a\u53d8\u91cf\u6216\u5bf9\u8c61\u8865\u9f5064</p> <pre><code>$ cat /sys/devices/system/cpu/cpu0/cache/index1/coherency_line_size\n64\n</code></pre> <p>\u6d4b\u8bd5\u7684\u670d\u52a1\u5668\u4e00\u6b21\u4f1a\u8f7d\u5165 64 \u5b57\u8282\u81f3\u7f13\u5b58\u4e2d\u3002</p> <p>\u5f53\u8f7d\u5165 <code>array[0][0]</code>\u65f6\uff0c\u82e5\u5b83\u4eec\u5360\u7528\u7684\u5185\u5b58\u4e0d\u8db3 64 \u5b57\u8282\uff0cCPU \u5c31\u4f1a\u987a\u5e8f\u5730\u8865\u8db3\u540e\u7eed\u5143\u7d20\u3002\u987a\u5e8f\u8bbf\u95ee\u7684<code>array[i][j]</code>\u56e0\u4e3a\u5229\u7528\u4e86\u8fd9\u4e00\u7279\u70b9\uff0c\u6240\u4ee5\u5c31\u4f1a\u6bd4 <code>array[j][i]</code>\u8981\u5feb\u3002</p> <p>\u4e5f\u6b63\u56e0\u4e3a\u8fd9\u6837\uff0c\u5f53\u5143\u7d20\u7c7b\u578b\u662f 4 \u4e2a\u5b57\u8282\u7684\u6574\u6570\u65f6\uff0c\u6027\u80fd\u5c31\u4f1a\u6bd4 8 \u4e2a\u5b57\u8282\u7684\u9ad8\u7cbe\u5ea6\u6d6e\u70b9\u6570\u65f6\u901f\u5ea6\u66f4\u5feb\uff0c\u56e0\u4e3a\u7f13\u5b58\u4e00\u6b21\u8f7d\u5165\u7684\u5143\u7d20\u4f1a\u66f4\u591a</p> <p>\u56e0\u6b64\uff0c\u9047\u5230\u8fd9\u79cd\u904d\u5386\u8bbf\u95ee\u6570\u7ec4\u7684\u60c5\u51b5\u65f6\uff0c\u6309\u7167\u5185\u5b58\u5e03\u5c40\u987a\u5e8f\u8bbf\u95ee\u5c06\u4f1a\u5e26\u6765\u5f88\u5927\u7684\u6027\u80fd\u63d0\u5347\u3002</p> <p>\u518d\u6765\u770b\u4e3a\u4ec0\u4e48\u6267\u884c\u65f6\u95f4\u76f8\u5dee 8 \u500d\u3002\u5728\u4e8c\u7ef4\u6570\u7ec4\u4e2d\uff0c\u5176\u5b9e\u7b2c\u4e00\u7ef4\u5143\u7d20\u5b58\u653e\u7684\u662f\u5730\u5740\uff0c\u7b2c\u4e8c\u7ef4\u5b58\u653e\u7684\u624d\u662f\u76ee\u6807\u5143\u7d20\u3002</p> <p>\u7531\u4e8e 64 \u4f4d\u64cd\u4f5c\u7cfb\u7edf\u7684\u5730\u5740\u5360\u7528 8 \u4e2a\u5b57\u8282\uff0832 \u4f4d\u64cd\u4f5c\u7cfb\u7edf\u662f 4 \u4e2a\u5b57\u8282\uff09\uff0c\u56e0\u6b64\uff0c\u6bcf\u6279 Cache Line \u6700\u591a\u4e5f\u5c31\u80fd\u8f7d\u5165\u4e0d\u5230 8 \u4e2a\u4e8c\u7ef4\u6570\u7ec4\u5143\u7d20\uff0c\u6240\u4ee5\u6027\u80fd\u5dee\u8ddd\u5927\u7ea6\u63a5\u8fd1 8 \u500d\u3002</p> <p>\u5173\u4e8e <code>CPU Cache Line</code> \u7684\u5e94\u7528\u5176\u5b9e\u975e\u5e38\u5e7f\u6cdb\uff0c\u5982\u679c\u4f60\u7528\u8fc7 Nginx\uff0c\u4f1a\u53d1\u73b0\u5b83\u662f\u7528\u54c8\u5e0c\u8868\u6765\u5b58\u653e\u57df\u540d\u3001HTTP \u5934\u90e8\u7b49\u6570\u636e\u7684\uff0c\u8fd9\u6837\u8bbf\u95ee\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u800c\u54c8\u5e0c\u8868\u91cc\u6876\u7684\u5927\u5c0f\u5982 <code>server_names_hash_bucket_size</code>\uff0c\u5b83\u9ed8\u8ba4\u5c31\u7b49\u4e8e CPU Cache Line \u7684\u503c\u3002</p> <p>\u7531\u4e8e\u6240\u5b58\u653e\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\u4e0d\u80fd\u5927\u4e8e\u6876\u7684\u5927\u5c0f\uff0c\u6240\u4ee5\u5f53\u9700\u8981\u5b58\u653e\u66f4\u957f\u7684\u5b57\u7b26\u4e32\u65f6\uff0c\u5c31\u9700\u8981\u4fee\u6539\u6876\u5927\u5c0f\uff0c\u4f46 Nginx \u5b98\u7f51\u4e0a\u660e\u786e\u5efa\u8bae\u5b83\u5e94\u8be5\u662f <code>CPU Cache Line</code> \u7684\u6574\u6570\u500d\u3002</p> <p></p> <p>\u4e3a\u4ec0\u4e48\u8981\u505a\u8fd9\u6837\u7684\u8981\u6c42\u5462\uff1f</p> <p>\u5c31\u662f\u56e0\u4e3a\u6309\u7167 cpu cache line\uff08\u6bd4\u5982 64 \u5b57\u8282\uff09\u6765\u8bbf\u95ee\u5185\u5b58\u65f6\uff0c\u4e0d\u4f1a\u51fa\u73b0\u591a\u6838 CPU \u4e0b\u7684\u4f2a\u5171\u4eab\u95ee\u9898\uff0c\u53ef\u4ee5\u5c3d\u91cf\u51cf\u5c11\u8bbf\u95ee\u5185\u5b58\u7684\u6b21\u6570\u3002</p> <p>\u6bd4\u5982\uff0c\u82e5\u6876\u5927\u5c0f\u4e3a 64 \u5b57\u8282\uff0c\u90a3\u4e48\u6839\u636e\u5730\u5740\u83b7\u53d6\u5b57\u7b26\u4e32\u65f6\u53ea\u9700\u8981\u8bbf\u95ee\u4e00\u6b21\u5185\u5b58\uff0c\u800c\u6876\u5927\u5c0f\u4e3a 50 \u5b57\u8282\uff0c\u4f1a\u5bfc\u81f4\u6700\u574f 2 \u6b21\u8bbf\u95ee\u5185\u5b58\uff0c\u800c 70 \u5b57\u8282\u6700\u574f\u4f1a\u6709 3 \u6b21\u8bbf\u95ee\u5185\u5b58\u3002</p> <p>\u5982\u679c\u4f60\u5728\u7528 Linux \u64cd\u4f5c\u7cfb\u7edf\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u540d\u53eb <code>Perf</code>\u7684\u5de5\u5177\u76f4\u89c2\u5730\u9a8c\u8bc1\u7f13\u5b58\u547d\u4e2d\u7684\u60c5\u51b5\uff08\u53ef\u4ee5\u7528 <code>yum install perf</code>\u6216\u8005 <code>apt-get install perf</code> \u5b89\u88c5\u8fd9\u4e2a\u5de5\u5177\uff0c\u8fd9\u4e2a\u7f51\u5740\u4e2d\u6709\u5927\u91cf\u6848\u4f8b\u53ef\u4f9b\u53c2\u8003\uff09\u3002</p> <p>\u6267\u884c <code>perf stat</code> \u53ef\u4ee5\u7edf\u8ba1\u51fa\u8fdb\u7a0b\u8fd0\u884c\u65f6\u7684\u7cfb\u7edf\u4fe1\u606f\uff08\u901a\u8fc7 <code>-e</code> \u9009\u9879\u6307\u5b9a\u8981\u7edf\u8ba1\u7684\u4e8b\u4ef6\uff0c\u5982\u679c\u8981\u67e5\u770b\u4e09\u7ea7\u7f13\u5b58\u603b\u7684\u547d\u4e2d\u7387\uff0c\u53ef\u4ee5\u6307\u5b9a\u7f13\u5b58\u672a\u547d\u4e2d <code>cache-misses</code> \u4e8b\u4ef6\uff0c\u4ee5\u53ca\u8bfb\u53d6\u7f13\u5b58\u6b21\u6570 <code>cache-references</code> \u4e8b\u4ef6\uff0c\u4e24\u8005\u76f8\u9664\u5c31\u662f\u7f13\u5b58\u7684\u672a\u547d\u4e2d\u7387\uff0c\u7528 <code>1</code>\u76f8\u51cf\u5c31\u662f\u547d\u4e2d\u7387\u3002</p> <p>\u7c7b\u4f3c\u7684\uff0c\u901a\u8fc7 <code>L1-dcache-load-misses</code> \u548c <code>L1-dcache-loads</code>\u53ef\u4ee5\u5f97\u5230 L1 \u7f13\u5b58\u7684\u547d\u4e2d\u7387\uff09\uff0c\u6b64\u65f6\u4f60\u4f1a\u53d1\u73b0 <code>array[i][j]</code>\u7684\u7f13\u5b58\u547d\u4e2d\u7387\u8fdc\u9ad8\u4e8e <code>array[j][i]</code>\u3002</p> <p>\u5f53\u7136\uff0c<code>perf stat</code>\u8fd8\u53ef\u4ee5\u901a\u8fc7\u6307\u4ee4\u6267\u884c\u901f\u5ea6\u53cd\u6620\u51fa\u4e24\u79cd\u8bbf\u95ee\u65b9\u5f0f\u7684\u4f18\u52a3\uff0c</p> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff08instructions \u4e8b\u4ef6\u6307\u660e\u4e86\u8fdb\u7a0b\u6267\u884c\u7684\u603b\u6307\u4ee4\u6570\uff0c\u800c cycles \u4e8b\u4ef6\u6307\u660e\u4e86\u8fd0\u884c\u7684\u65f6\u949f\u5468\u671f\uff0c\u4e8c\u8005\u76f8\u9664\u5c31\u53ef\u4ee5\u5f97\u5230\u6bcf\u65f6\u949f\u5468\u671f\u6240\u6267\u884c\u7684\u6307\u4ee4\u6570\uff0c\u7f29\u5199\u4e3a IPC\u3002\u5982\u679c\u7f13\u5b58\u672a\u547d\u4e2d\uff0c\u5219 CPU \u8981\u7b49\u5f85\u5185\u5b58\u7684\u6162\u901f\u8bfb\u53d6\uff0c\u56e0\u6b64 IPC \u5c31\u4f1a\u5f88\u4f4e\u3002<code>array[i][j]</code>\u7684 <code>IPC</code> \u503c\u4e5f\u6bd4 <code>array[j][i]</code>\u8981\u9ad8\u5f97\u591a\uff09\uff1a</p> <p></p>"},{"location":"chap1/1CPU_Cache/#2_1","title":"2\u3001\u63d0\u5347\u6307\u4ee4\u7f13\u5b58\u7684\u547d\u4e2d\u7387","text":"<p>\u8bf4\u5b8c\u6570\u636e\u7684\u7f13\u5b58\u547d\u4e2d\u7387\uff0c\u518d\u6765\u770b\u6307\u4ee4\u7684\u7f13\u5b58\u547d\u4e2d\u7387\u8be5\u5982\u4f55\u63d0\u5347\u3002</p> <p>\u6bd4\u5982\uff0c\u6709\u4e00\u4e2a\u5143\u7d20\u4e3a 0 \u5230 255 \u4e4b\u95f4\u968f\u673a\u6570\u5b57\u7ec4\u6210\u7684\u6570\u7ec4\uff1a</p> <pre><code>int array[N];\nfor (i = 0; i &lt; TESTN; i++) array[i] = rand() % 256;\n</code></pre> <p>\u63a5\u4e0b\u6765\u8981\u5bf9\u5b83\u505a\u4e24\u4e2a\u64cd\u4f5c\uff1a</p> <ul> <li>\u4e00\u662f\u5faa\u73af\u904d\u5386\u6570\u7ec4\uff0c\u5224\u65ad\u6bcf\u4e2a\u6570\u5b57\u662f\u5426\u5c0f\u4e8e 128\uff0c\u5982\u679c\u5c0f\u4e8e\u5219\u628a\u5143\u7d20\u7684\u503c\u7f6e\u4e3a 0\uff1b</li> <li>\u4e8c\u662f\u5c06\u6570\u7ec4\u6392\u5e8f\u3002</li> </ul> <p>\u90a3\u4e48\uff0c\u5148\u6392\u5e8f\u518d\u904d\u5386\u901f\u5ea6\u5feb\uff0c\u8fd8\u662f\u5148\u904d\u5386\u518d\u6392\u5e8f\u901f\u5ea6\u5feb\u5462\uff1f</p> <pre><code>for(i = 0; i &lt; N; i++) {\n       if (array [i] &lt; 128) array[i] = 0;\n}\nsort(array, array +N);\n</code></pre> <p>\u5148\u6392\u5e8f\u7684\u904d\u5386\u65f6\u95f4\u53ea\u6709\u540e\u6392\u5e8f\u7684\u4e09\u5206\u4e4b\u4e00 </p> <p>\u8fd9\u662f\u56e0\u4e3a\u5faa\u73af\u4e2d\u6709\u5927\u91cf\u7684 if \u6761\u4ef6\u5206\u652f\uff0c\u800c CPU\u542b\u6709\u5206\u652f\u9884\u6d4b\u5668\u3002</p> <p>\u5f53\u4ee3\u7801\u4e2d\u51fa\u73b0 if\u3001switch \u7b49\u8bed\u53e5\u65f6\uff0c\u610f\u5473\u7740\u6b64\u65f6\u81f3\u5c11\u53ef\u4ee5\u9009\u62e9\u8df3\u8f6c\u5230\u4e24\u6bb5\u4e0d\u540c\u7684\u6307\u4ee4\u53bb\u6267\u884c\u3002\u5982\u679c\u5206\u652f\u9884\u6d4b\u5668\u53ef\u4ee5\u9884\u6d4b\u63a5\u4e0b\u6765\u8981\u5728\u54ea\u6bb5\u4ee3\u7801\u6267\u884c\uff08\u6bd4\u5982 if \u8fd8\u662f else \u4e2d\u7684\u6307\u4ee4\uff09\uff0c\u5c31\u53ef\u4ee5\u63d0\u524d\u628a\u8fd9\u4e9b\u6307\u4ee4\u653e\u5728\u7f13\u5b58\u4e2d\uff0cCPU \u6267\u884c\u65f6\u5c31\u4f1a\u5f88\u5feb\u3002</p> <p>\u5f53\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u5b8c\u5168\u968f\u673a\u65f6\uff0c\u5206\u652f\u9884\u6d4b\u5668\u65e0\u6cd5\u6709\u6548\u5de5\u4f5c\uff0c\u800c\u5f53 array \u6570\u7ec4\u6709\u5e8f\u65f6\uff0c\u5206\u652f\u9884\u6d4b\u5668\u4f1a\u52a8\u6001\u5730\u6839\u636e\u5386\u53f2\u547d\u4e2d\u6570\u636e\u5bf9\u672a\u6765\u8fdb\u884c\u9884\u6d4b\uff0c\u547d\u4e2d\u7387\u5c31\u4f1a\u975e\u5e38\u9ad8\u3002</p> <p>\u8fd8\u662f\u7528<code>Linux</code> \u4e0a\u7684 <code>perf</code>\u6765\u505a\u4e2a\u9a8c\u8bc1\u3002\u4f7f\u7528 <code>-e</code> \u9009\u9879\u6307\u660e <code>branch-loads</code> \u4e8b\u4ef6\u548c <code>branch-load-misses</code> \u4e8b\u4ef6\uff0c\u5b83\u4eec\u5206\u522b\u8868\u793a\u5206\u652f\u9884\u6d4b\u7684\u6b21\u6570\uff0c\u4ee5\u53ca\u9884\u6d4b\u5931\u8d25\u7684\u6b21\u6570\u3002\u901a\u8fc7 <code>L1-icache-load-misses</code> \u4e5f\u80fd\u67e5\u770b\u5230\u4e00\u7ea7\u7f13\u5b58\u4e2d\u6307\u4ee4\u7684\u672a\u547d\u4e2d\u60c5\u51b5\u3002</p> <p>\u5148\u6392\u5e8f\u7684\u8bdd\u5206\u652f\u9884\u6d4b\u7684\u6210\u529f\u7387\u975e\u5e38\u9ad8\uff0c\u800c\u4e14\u4e00\u7ea7\u6307\u4ee4\u7f13\u5b58\u7684\u672a\u547d\u4e2d\u7387\u4e5f\u6709\u5927\u5e45\u4e0b\u964d\u3002</p> <p></p> <pre><code>#define likely(x) __builtin_expect(!!(x), 1) \n#define unlikely(x) __builtin_expect(!!(x), 0)\nif (likely(a == 1)) \u2026\n</code></pre>"},{"location":"chap1/1CPU_Cache/#3-cpu","title":"3\u3001\u63d0\u5347\u591a\u6838 CPU \u4e0b\u7684\u7f13\u5b58\u547d\u4e2d\u7387","text":"<p>\u9762\u5411\u4e00\u4e2a CPU \u6838\u5fc3\u8c08\u6570\u636e\u53ca\u6307\u4ee4\u7f13\u5b58\u7684\uff0c\u7136\u800c\u73b0\u4ee3 CPU \u51e0\u4e4e\u90fd\u662f\u591a\u6838\u7684\u3002</p> <p>\u867d\u7136\u4e09\u7ea7\u7f13\u5b58\u9762\u5411\u6240\u6709\u6838\u5fc3\uff0c\u4f46\u4e00\u3001\u4e8c\u7ea7\u7f13\u5b58\u662f\u6bcf\u9897\u6838\u5fc3\u72ec\u4eab\u7684\u3002\u6211\u4eec\u77e5\u9053\uff0c\u5373\u4f7f\u53ea\u6709\u4e00\u4e2a CPU \u6838\u5fc3\uff0c\u73b0\u4ee3\u5206\u65f6\u64cd\u4f5c\u7cfb\u7edf\u90fd\u652f\u6301\u8bb8\u591a\u8fdb\u7a0b\u540c\u65f6\u8fd0\u884c\u3002\u8fd9\u662f\u56e0\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u628a\u65f6\u95f4\u5207\u6210\u4e86\u8bb8\u591a\u7247\uff0c\u5fae\u89c2\u4e0a\u5404\u8fdb\u7a0b\u6309\u65f6\u95f4\u7247\u4ea4\u66ff\u5730\u5360\u7528 CPU\uff0c\u8fd9\u9020\u6210\u5b8f\u89c2\u4e0a\u770b\u8d77\u6765\u5404\u7a0b\u5e8f\u540c\u65f6\u5728\u6267\u884c\u3002</p> <p>\u56e0\u6b64\uff0c\u82e5\u8fdb\u7a0b A \u5728\u65f6\u95f4\u7247 1 \u91cc\u4f7f\u7528 CPU \u6838\u5fc3 1\uff0c\u81ea\u7136\u4e5f\u586b\u6ee1\u4e86\u6838\u5fc3 1 \u7684\u4e00\u3001\u4e8c\u7ea7\u7f13\u5b58\uff0c\u5f53\u65f6\u95f4\u7247 1 \u7ed3\u675f\u540e\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u8ba9\u8fdb\u7a0b A \u8ba9\u51fa CPU\uff0c\u57fa\u4e8e\u6548\u7387\u5e76\u517c\u987e\u516c\u5e73\u7684\u7b56\u7565\u91cd\u65b0\u8c03\u5ea6 CPU \u6838\u5fc3 1\uff0c\u4ee5\u9632\u6b62\u67d0\u4e9b\u8fdb\u7a0b\u997f\u6b7b\u3002</p> <p>\u5982\u679c\u6b64\u65f6 CPU \u6838\u5fc3 1 \u7e41\u5fd9\uff0c\u800c CPU \u6838\u5fc3 2 \u7a7a\u95f2\uff0c\u5219\u8fdb\u7a0b A \u5f88\u53ef\u80fd\u4f1a\u88ab\u8c03\u5ea6\u5230 CPU \u6838\u5fc3 2 \u4e0a\u8fd0\u884c\uff0c\u8fd9\u6837\uff0c\u5373\u4f7f\u6211\u4eec\u5bf9\u4ee3\u7801\u4f18\u5316\u5f97\u518d\u597d\uff0c\u4e5f\u53ea\u80fd\u5728\u4e00\u4e2a\u65f6\u95f4\u7247\u5185\u9ad8\u6548\u5730\u4f7f\u7528 CPU \u4e00\u3001\u4e8c\u7ea7\u7f13\u5b58\u4e86\uff0c\u4e0b\u4e00\u4e2a\u65f6\u95f4\u7247\u4fbf\u9762\u4e34\u7740\u7f13\u5b58\u6548\u7387\u7684\u95ee\u9898\u3002</p> <p>\u56e0\u6b64\uff0c\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u4e86\u5c06\u8fdb\u7a0b\u6216\u8005\u7ebf\u7a0b\u7ed1\u5b9a\u5230\u67d0\u4e00\u9897 CPU \u4e0a\u8fd0\u884c\u7684\u80fd\u529b\u3002</p> <p>\u5982 Linux \u4e0a\u63d0\u4f9b\u4e86 <code>sched_setaffinity</code>\u65b9\u6cd5\u5b9e\u73b0\u8fd9\u4e00\u529f\u80fd\uff0c\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u4e5f\u6709\u7c7b\u4f3c\u529f\u80fd\u7684 API \u53ef\u7528\u3002</p> <p>\u5f53\u591a\u7ebf\u7a0b\u540c\u65f6\u6267\u884c\u5bc6\u96c6\u8ba1\u7b97\uff0c\u4e14 CPU \u7f13\u5b58\u547d\u4e2d\u7387\u5f88\u9ad8\u65f6\uff0c\u5982\u679c\u5c06\u6bcf\u4e2a\u7ebf\u7a0b\u5206\u522b\u7ed1\u5b9a\u5728\u4e0d\u540c\u7684 CPU \u6838\u5fc3\u4e0a\uff0c\u6027\u80fd\u4fbf\u4f1a\u83b7\u5f97\u975e\u5e38\u53ef\u89c2\u7684\u63d0\u5347\u3002Perf \u5de5\u5177\u4e5f\u63d0\u4f9b\u4e86 <code>cpu-migrations</code> \u4e8b\u4ef6\uff0c\u5b83\u53ef\u4ee5\u663e\u793a\u8fdb\u7a0b\u4ece\u4e0d\u540c\u7684 CPU \u6838\u5fc3\u4e0a\u8fc1\u79fb\u7684\u6b21\u6570\u3002</p>"},{"location":"chap1/1CPU_Cache/#4","title":"4\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>CPU \u7f13\u5b58\u5206\u4e3a\u6570\u636e\u7f13\u5b58\u4e0e\u6307\u4ee4\u7f13\u5b58\uff0c\u5bf9\u4e8e\u6570\u636e\u7f13\u5b58\uff0c\u6211\u4eec\u5e94\u5728\u5faa\u73af\u4f53\u4e2d\u5c3d\u91cf\u64cd\u4f5c\u540c\u4e00\u5757\u5185\u5b58\u4e0a\u7684\u6570\u636e\uff0c\u7531\u4e8e\u7f13\u5b58\u662f\u6839\u636e CPU Cache Line \u6279\u91cf\u64cd\u4f5c\u6570\u636e\u7684\uff0c\u6240\u4ee5\u987a\u5e8f\u5730\u64cd\u4f5c\u8fde\u7eed\u5185\u5b58\u6570\u636e\u65f6\u4e5f\u6709\u6027\u80fd\u63d0\u5347\u3002</p> <p>\u5bf9\u4e8e\u6307\u4ee4\u7f13\u5b58\uff0c\u6709\u89c4\u5f8b\u7684\u6761\u4ef6\u5206\u652f\u80fd\u591f\u8ba9 CPU \u7684\u5206\u652f\u9884\u6d4b\u53d1\u6325\u4f5c\u7528\uff0c\u8fdb\u4e00\u6b65\u63d0\u5347\u6267\u884c\u6548\u7387\u3002\u5bf9\u4e8e\u591a\u6838\u7cfb\u7edf\uff0c\u5982\u679c\u8fdb\u7a0b\u7684\u7f13\u5b58\u547d\u4e2d\u7387\u975e\u5e38\u9ad8\uff0c\u5219\u53ef\u4ee5\u8003\u8651\u7ed1\u5b9a CPU \u6765\u63d0\u5347\u7f13\u5b58\u547d\u4e2d\u7387\u3002</p>"},{"location":"chap1/2Mem_Pool/","title":"\u7b2c\u4e8c\u8282 \u5185\u5b58\u6c60\u63d0\u5347\u5185\u5b58\u5206\u914d\u7684\u6548\u7387","text":"<p>\u5728 Linux \u7cfb\u7edf\u4e2d\uff0c\u7528 Xmx \u8bbe\u7f6e JVM \u7684\u6700\u5927\u5806\u5185\u5b58\u4e3a 8GB\uff0c\u4f46\u5728\u8fd1\u767e\u4e2a\u5e76\u53d1\u7ebf\u7a0b\u4e0b\uff0c\u89c2\u5bdf\u5230 Java \u8fdb\u7a0b\u5360\u7528\u4e86 14GB \u7684\u5185\u5b58\u3002\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\u5462\uff1f</p> <p>\u8fd9\u662f\u56e0\u4e3a\uff0c\u7edd\u5927\u90e8\u5206\u9ad8\u7ea7\u8bed\u8a00\u90fd\u662f\u7528 C \u8bed\u8a00\u7f16\u5199\u7684\uff0c\u5305\u62ec Java\uff0c\u7533\u8bf7\u5185\u5b58\u5fc5\u987b\u7ecf\u8fc7 C \u5e93\uff0c\u800c C \u5e93\u901a\u8fc7\u9884\u5206\u914d\u66f4\u5927\u7684\u7a7a\u95f4\u4f5c\u4e3a\u5185\u5b58\u6c60\uff0c\u6765\u52a0\u5feb\u540e\u7eed\u7533\u8bf7\u5185\u5b58\u7684\u901f\u5ea6\u3002\u8fd9\u6837\uff0c\u9884\u5206\u914d\u7684 6GB \u7684 C \u5e93\u5185\u5b58\u6c60\u5c31\u4e0e JVM \u4e2d\u9884\u5206\u914d\u7684 8G \u5185\u5b58\u6c60\u53e0\u52a0\u5728\u4e00\u8d77\uff0c\u9020\u6210\u4e86 Java \u8fdb\u7a0b\u7684\u5185\u5b58\u5360\u7528\u8d85\u51fa\u4e86\u9884\u671f\u3002</p> <p>\u638c\u63e1\u5185\u5b58\u6c60\u7684\u7279\u6027\uff0c\u65e2\u53ef\u4ee5\u907f\u514d\u5199\u7a0b\u5e8f\u65f6\u5185\u5b58\u5360\u7528\u8fc7\u5927\uff0c\u5bfc\u81f4\u670d\u52a1\u5668\u6027\u80fd\u4e0b\u964d\u6216\u8005\u8fdb\u7a0b OOM\uff08Out Of Memory\uff0c\u5185\u5b58\u6ea2\u51fa\uff09\u88ab\u7cfb\u7edf\u6740\u6b7b\uff0c\u8fd8\u53ef\u4ee5\u52a0\u5feb\u5185\u5b58\u5206\u914d\u7684\u901f\u5ea6\u3002</p> <p>\u5728\u7cfb\u7edf\u7a7a\u95f2\u65f6\u7533\u8bf7\u5185\u5b58\u82b1\u8d39\u4e0d\u4e86\u591a\u5c11\u65f6\u95f4\uff0c\u4f46\u662f\u5bf9\u4e8e\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u7e41\u5fd9\u7684\u591a\u7ebf\u7a0b\u670d\u52a1\uff0c\u83b7\u53d6\u5185\u5b58\u7684\u65f6\u95f4\u4f1a\u4e0a\u5347\u51e0\u5341\u500d\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\uff0c\u5185\u5b58\u6c60\u662f\u975e\u5e38\u5e95\u5c42\u7684\u6280\u672f\uff0c\u53ef\u4ee5\u66f4\u6362\u9002\u5408\u5e94\u7528\u573a\u666f\u7684\u5185\u5b58\u6c60\u3002</p> <p>\u5728\u591a\u79cd\u7f16\u7a0b\u8bed\u8a00\u5171\u5b58\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u5185\u5b58\u6c60\u6709\u5f88\u5e7f\u6cdb\u7684\u5e94\u7528\uff0c\u4f18\u5316\u5185\u5b58\u6c60\u5e26\u6765\u7684\u4efb\u4f55\u5fae\u5c0f\u7684\u6027\u80fd\u63d0\u5347\uff0c\u90fd\u5c06\u88ab\u5206\u5e03\u5f0f\u96c6\u7fa4\u5de8\u5927\u7684\u4e3b\u673a\u89c4\u6a21\u653e\u5927\uff0c\u4ece\u800c\u5e26\u6765\u6574\u4f53\u4e0a\u975e\u5e38\u53ef\u89c2\u7684\u6536\u76ca\u3002</p>"},{"location":"chap1/2Mem_Pool/#1","title":"1\u3001\u9690\u85cf\u7684\u5185\u5b58\u6c60","text":""},{"location":"chap1/2Mem_Pool/#1-1","title":"1-1 \u989d\u5916\u7684\u5185\u5b58\u5f00\u9500\u4ece\u4f55\u800c\u6765","text":"<p>\u4e1a\u52a1\u4ee3\u7801\u4e0e\u7cfb\u7edf\u5185\u6838\u95f4\uff0c\u5f80\u5f80\u6709\u4e24\u5c42\u5185\u5b58\u6c60\u5bb9\u6613\u88ab\u5ffd\u7565\uff0c\u5c24\u5176\u662f\u5176\u4e2d\u7684 C \u5e93\u5185\u5b58\u6c60\u3002</p> <p>\u5f53\u4ee3\u7801\u7533\u8bf7\u5185\u5b58\u65f6\uff0c\u9996\u5148\u4f1a\u5230\u8fbe\u5e94\u7528\u5c42\u5185\u5b58\u6c60\uff0c\u5982\u679c\u5e94\u7528\u5c42\u5185\u5b58\u6c60\u6709\u8db3\u591f\u7684\u53ef\u7528\u5185\u5b58\uff0c\u5c31\u4f1a\u76f4\u63a5\u8fd4\u56de\u7ed9\u4e1a\u52a1\u4ee3\u7801\uff0c\u5426\u5219\uff0c\u5b83\u4f1a\u5411\u66f4\u5e95\u5c42\u7684 C \u5e93\u5185\u5b58\u6c60\u7533\u8bf7\u5185\u5b58\u3002</p> <p>\u6bd4\u5982\uff0c\u5982\u679c\u4f60\u5728 Apache\u3001Nginx \u7b49\u670d\u52a1\u4e4b\u4e0a\u505a\u6a21\u5757\u5f00\u53d1\uff0c\u8fd9\u4e9b\u670d\u52a1\u4e2d\u5c31\u6709\u72ec\u7acb\u7684\u5185\u5b58\u6c60\u3002</p> <p>\u5f53\u7136\uff0cJava \u4e2d\u4e5f\u6709\u5185\u5b58\u6c60\uff0c\u5f53\u901a\u8fc7\u542f\u52a8\u53c2\u6570 Xmx \u6307\u5b9a JVM \u7684\u5806\u5185\u5b58\u4e3a 8GB \u65f6\uff0c\u5c31\u8bbe\u5b9a\u4e86 JVM \u5806\u5185\u5b58\u6c60\u7684\u5927\u5c0f\u3002</p> <p>Google \u7684 TCMalloc \u548c FaceBook \u7684 JEMalloc\uff0c\u5b83\u4eec\u4e5f\u662f C \u5e93\u5185\u5b58\u6c60\u3002\u5f53 C \u5e93\u5185\u5b58\u6c60\u65e0\u6cd5\u6ee1\u8db3\u5185\u5b58\u7533\u8bf7\u65f6\uff0c\u624d\u4f1a\u5411\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7533\u8bf7\u5206\u914d\u5185\u5b58\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>Java \u5df2\u7ecf\u6709\u4e86\u5e94\u7528\u5c42\u5185\u5b58\u6c60\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u4f1a\u53d7\u5230 C \u5e93\u5185\u5b58\u6c60\u7684\u5f71\u54cd\u5462\uff1f</p> <p>\u8fd9\u662f\u56e0\u4e3a\uff0c\u9664\u4e86 JVM \u8d1f\u8d23\u7ba1\u7406\u7684\u5806\u5185\u5b58\u5916\uff0cJava \u8fd8\u62e5\u6709\u4e00\u4e9b\u5806\u5916\u5185\u5b58\uff0c\u7531\u4e8e\u5b83\u4e0d\u4f7f\u7528 JVM \u7684\u5783\u573e\u56de\u6536\u673a\u5236\uff0c\u6240\u4ee5\u66f4\u7a33\u5b9a\u3001\u6301\u4e45\uff0c\u5904\u7406 IO \u7684\u901f\u5ea6\u4e5f\u66f4\u5feb\u3002\u8fd9\u4e9b\u5806\u5916\u5185\u5b58\u5c31\u4f1a\u7531 C \u5e93\u5185\u5b58\u6c60\u8d1f\u8d23\u5206\u914d\uff0c\u8fd9\u662f Java \u53d7\u5230 C \u5e93\u5185\u5b58\u6c60\u5f71\u54cd\u7684\u539f\u56e0\u3002</p> <p>\u5176\u5b9e\u4e0d\u53ea\u662f Java\uff0c\u51e0\u4e4e\u6240\u6709\u7a0b\u5e8f\u90fd\u5728\u4f7f\u7528 C \u5e93\u5185\u5b58\u6c60\u5206\u914d\u51fa\u7684\u5185\u5b58\u3002</p> <p>C \u5e93\u5185\u5b58\u6c60\u5f71\u54cd\u7740\u7cfb\u7edf\u4e0b\u4f9d\u8d56\u5b83\u7684\u6240\u6709\u8fdb\u7a0b\u3002\u4ee5 Linux \u7cfb\u7edf\u7684\u9ed8\u8ba4 C \u5e93\u5185\u5b58\u6c60 <code>Ptmalloc2</code> \u6765\u5177\u4f53\u5206\u6790\uff0c\u770b\u770b\u5b83\u5230\u5e95\u5bf9\u6027\u80fd\u53d1\u6325\u7740\u600e\u6837\u7684\u4f5c\u7528\u3002</p> <p>C \u5e93\u5185\u5b58\u6c60\u5de5\u4f5c\u65f6\uff0c\u4f1a\u9884\u5206\u914d\u6bd4\u4f60\u7533\u8bf7\u7684\u5b57\u8282\u6570\u66f4\u5927\u7684\u7a7a\u95f4\u4f5c\u4e3a\u5185\u5b58\u6c60\u3002\u6bd4\u5982\u8bf4\uff0c\u5f53\u4e3b\u8fdb\u7a0b\u4e0b\u7533\u8bf7 1 \u5b57\u8282\u7684\u5185\u5b58\u65f6\uff0cPtmalloc2 \u4f1a\u9884\u5206\u914d 132K \u5b57\u8282\u7684\u5185\u5b58\uff08Ptmalloc2 \u4e2d\u53eb Main Arena\uff09\uff0c\u5e94\u7528\u4ee3\u7801\u518d\u7533\u8bf7\u5185\u5b58\u65f6\uff0c\u4f1a\u4ece\u8fd9\u5df2\u7ecf\u7533\u8bf7\u5230\u7684 132KB \u4e2d\u7ee7\u7eed\u5206\u914d\u3002</p> <pre><code># cat /proc/2891/maps | grep heap\n01643000-01664000 rw-p 00000000 00:00 0     [heap]\n</code></pre> <p>\u5f53\u6211\u4eec\u91ca\u653e\u8fd9 1 \u5b57\u8282\u65f6\uff0cPtmalloc2 \u4e5f\u4e0d\u4f1a\u628a\u5185\u5b58\u5f52\u8fd8\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u3002</p> <p>Ptmalloc2 \u8ba4\u4e3a\uff0c\u4e0e\u5176\u628a\u8fd9 1 \u5b57\u8282\u91ca\u653e\u7ed9\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e0d\u5982\u5148\u7f13\u5b58\u7740\u653e\u8fdb\u5185\u5b58\u6c60\u91cc\uff0c\u4ecd\u7136\u5f53\u4f5c\u7528\u6237\u6001\u5185\u5b58\u7559\u4e0b\u6765\uff0c\u8fdb\u7a0b\u518d\u6b21\u7533\u8bf7 1 \u5b57\u8282\u7684\u5185\u5b58\u65f6\u5c31\u53ef\u4ee5\u76f4\u63a5\u590d\u7528\uff0c\u8fd9\u6837\u901f\u5ea6\u5feb\u4e86\u5f88\u591a\u3002</p> <p>132KB \u4e0d\u591a\u5440\uff1f\u4e3a\u4ec0\u4e48\u8fd9\u4e00\u8bb2\u5f00\u5934\u63d0\u5230\u7684 Java \u8fdb\u7a0b\uff0c\u4f1a\u88ab\u5206\u914d\u4e86\u51e0\u4e2a GB \u7684\u5185\u5b58\u6c60\u5462\uff1f\u8fd9\u662f\u56e0\u4e3a\u591a\u7ebf\u7a0b\u4e0e\u5355\u7ebf\u7a0b\u7684\u9884\u5206\u914d\u7b56\u7565\u5e76\u4e0d\u76f8\u540c\u3002</p> <p>\u6bcf\u4e2a\u5b50\u7ebf\u7a0b\u9884\u5206\u914d\u7684\u5185\u5b58\u662f 64MB\uff08Ptmalloc2 \u4e2d\u88ab\u79f0\u4e3a Thread Arena\uff0c32 \u4f4d\u7cfb\u7edf\u4e0b\u4e3a 1MB\uff0c64 \u4f4d\u7cfb\u7edf\u4e0b\u4e3a 64MB\uff09\u3002</p> <p>\u5982\u679c\u6709 100 \u4e2a\u7ebf\u7a0b\uff0c\u5c31\u5c06\u6709 6GB \u7684\u5185\u5b58\u90fd\u4f1a\u88ab\u5185\u5b58\u6c60\u5360\u7528\u3002\u5f53\u7136\uff0c\u5e76\u4e0d\u662f\u8bbe\u7f6e\u4e86 1000 \u4e2a\u7ebf\u7a0b\uff0c\u5c31\u4f1a\u9884\u5206\u914d 60GB \u7684\u5185\u5b58\uff0c\u5b50\u7ebf\u7a0b\u5185\u5b58\u6c60\u6700\u591a\u53ea\u80fd\u5230 8 \u500d\u7684 CPU \u6838\u6570\uff0c\u6bd4\u5982\u5728 32 \u6838\u7684\u670d\u52a1\u5668\u4e0a\uff0c\u6700\u591a\u53ea\u4f1a\u6709 256 \u4e2a\u5b50\u7ebf\u7a0b\u5185\u5b58\u6c60\uff0c\u4f46\u8fd9\u4e5f\u975e\u5e38\u5938\u5f20\u4e86\uff0c<code>16GB\uff0864MB * 256 = 16GB\uff09</code>\u7684\u5185\u5b58\u5c06\u4e00\u76f4\u88ab Ptmalloc2 \u5360\u7528\u3002</p> <p>Linux \u4e0b\u7684 JVM \u7f16\u8bd1\u65f6\u9ed8\u8ba4\u4f7f\u7528\u4e86 Ptmalloc2 \u5185\u5b58\u6c60\uff0c\u56e0\u6b64\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u9884\u5206\u914d\u4e86 64MB \u7684\u5185\u5b58\uff0c\u8fd9\u9020\u6210\u542b\u6709\u4e0a\u767e\u4e2a Java \u7ebf\u7a0b\u7684 JVM \u591a\u4f7f\u7528\u4e86 6GB \u7684\u5185\u5b58\u3002\u5728\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e9b\u9884\u5206\u914d\u51fa\u6765\u7684\u5185\u5b58\u6c60\uff0c\u53ef\u4ee5\u63d0\u5347\u540e\u7eed\u5185\u5b58\u5206\u914d\u7684\u6027\u80fd\u3002</p>"},{"location":"chap1/2Mem_Pool/#1-2-ptmalloc2","title":"1-2 \u89e3\u51b3Ptmalloc2\u591a\u5185\u5b58\u5f00\u9500\u7684\u95ee\u9898","text":"<p>\u7136\u800c\uff0cJava \u4e2d\u7684 JVM \u5185\u5b58\u6c60\u5df2\u7ecf\u7ba1\u7406\u4e86\u7edd\u5927\u90e8\u5206\u5185\u5b58\uff0c\u786e\u5b9e\u4e0d\u80fd\u63a5\u53d7\u83ab\u540d\u591a\u51fa\u6765 6GB \u7684\u5185\u5b58\uff0c\u90a3\u8be5\u600e\u4e48\u529e\u5462\uff1f</p> <p>\u65e2\u7136\u6211\u4eec\u77e5\u9053\u4e86 Ptmalloc2 \u5185\u5b58\u6c60\u7684\u5b58\u5728\uff0c\u5c31\u6709\u4e24\u79cd\u89e3\u51b3\u529e\u6cd5\u3002</p> <p>\u9996\u5148\u53ef\u4ee5\u8c03\u6574 Ptmalloc2 \u7684\u5de5\u4f5c\u65b9\u5f0f\u3002</p> <p>\u901a\u8fc7\u8bbe\u7f6e <code>MALLOC_ARENA_MAX</code> \u73af\u5883\u53d8\u91cf\uff0c\u53ef\u4ee5\u9650\u5236\u7ebf\u7a0b\u5185\u5b58\u6c60\u7684\u6700\u5927\u6570\u91cf\uff0c\u5f53\u7136\uff0c\u7ebf\u7a0b\u5185\u5b58\u6c60\u7684\u6570\u91cf\u51cf\u5c11\u540e\uff0c\u4f1a\u5f71\u54cd Ptmalloc2 \u5206\u914d\u5185\u5b58\u7684\u901f\u5ea6\u3002\u4e0d\u8fc7\u7531\u4e8e Java \u4e3b\u8981\u4f7f\u7528 JVM \u5185\u5b58\u6c60\u6765\u7ba1\u7406\u5bf9\u8c61\uff0c\u8fd9\u70b9\u5f71\u54cd\u5e76\u4e0d\u91cd\u8981\u3002</p> <p>\u5176\u6b21\u53ef\u4ee5\u66f4\u6362\u6389 Ptmalloc2 \u5185\u5b58\u6c60\uff0c\u9009\u62e9\u4e00\u4e2a\u9884\u5206\u914d\u5185\u5b58\u66f4\u5c11\u7684\u5185\u5b58\u6c60\uff0c\u6bd4\u5982 Google \u7684 TCMalloc\u3002</p> <p>\u8fd9\u5e76\u4e0d\u662f\u8bf4 Google \u51fa\u54c1\u7684 TCMalloc \u6027\u80fd\u66f4\u597d\uff0c\u800c\u662f\u5728\u7279\u5b9a\u7684\u573a\u666f\u4e2d\u7684\u9009\u62e9\u4e0d\u540c\u3002\u800c\u4e14\uff0c\u76f2\u76ee\u5730\u9009\u62e9 TCMalloc \u5f88\u53ef\u80fd\u4f1a\u964d\u4f4e\u6027\u80fd\uff0c\u5426\u5219 Linux \u7cfb\u7edf\u65e9\u628a\u9ed8\u8ba4\u7684\u5185\u5b58\u6c60\u6539\u4e3a TCMalloc \u4e86\u3002</p>"},{"location":"chap1/2Mem_Pool/#2-ptmalloc2-tcmalloc","title":"2\u3001\u9009\u62e9 Ptmalloc2 \u8fd8\u662f TCMalloc\uff1f","text":""},{"location":"chap1/2Mem_Pool/#2-1-tcmalloc","title":"2-1 TCMalloc \u9002\u7528\u7684\u573a\u666f","text":"<p>\u5b83\u5bf9\u591a\u7ebf\u7a0b\u4e0b\u5c0f\u5185\u5b58\u7684\u5206\u914d\u7279\u522b\u53cb\u597d\u3002</p> <p>\u6bd4\u5982\uff0c\u5728 2GHz \u7684 CPU \u4e0a\u5206\u914d\u3001\u91ca\u653e 256K \u5b57\u8282\u7684\u5185\u5b58\uff0cPtmalloc2 \u8017\u65f6 32 \u7eb3\u79d2\uff0c\u800c TCMalloc \u4ec5\u8017\u65f6 10 \u7eb3\u79d2\u3002\u5dee\u8ddd\u8d85\u8fc7\u4e86 3 \u500d\uff0c\u4e3a\u4ec0\u4e48\u5462\uff1f</p> <p>\u8fd9\u662f\u56e0\u4e3a\uff0cPtmalloc2 \u5047\u5b9a\uff0c\u5982\u679c\u7ebf\u7a0b A \u7533\u8bf7\u5e76\u91ca\u653e\u4e86\u7684\u5185\u5b58\uff0c\u7ebf\u7a0b B \u53ef\u80fd\u4e5f\u4f1a\u7533\u8bf7\u7c7b\u4f3c\u7684\u5185\u5b58\uff0c\u6240\u4ee5\u5b83\u5141\u8bb8\u5185\u5b58\u6c60\u5728\u7ebf\u7a0b\u95f4\u590d\u7528\u4ee5\u63d0\u5347\u6027\u80fd\u3002</p> <p>\u56e0\u6b64\uff0c\u6bcf\u6b21\u5206\u914d\u5185\u5b58\uff0cPtmalloc2 \u4e00\u5b9a\u8981\u52a0\u9501\uff0c\u624d\u80fd\u89e3\u51b3\u5171\u4eab\u8d44\u6e90\u7684\u4e92\u65a5\u95ee\u9898\u3002\u7136\u800c\uff0c\u52a0\u9501\u7684\u6d88\u8017\u5e76\u4e0d\u5c0f\u3002\u5982\u679c\u4f60\u76d1\u63a7\u5206\u914d\u901f\u5ea6\u7684\u8bdd\uff0c\u4f1a\u53d1\u73b0\u5355\u7ebf\u7a0b\u670d\u52a1\u8c03\u6574\u4e3a 100 \u4e2a\u7ebf\u7a0b\uff0cPtmalloc2 \u7533\u8bf7\u5185\u5b58\u7684\u901f\u5ea6\u4f1a\u53d8\u6162 10 \u500d\u3002TCMalloc \u9488\u5bf9\u5c0f\u5185\u5b58\u505a\u4e86\u5f88\u591a\u4f18\u5316\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u72ec\u7acb\u5206\u914d\u5185\u5b58\uff0c\u65e0\u987b\u52a0\u9501\uff0c\u6240\u4ee5\u901f\u5ea6\u66f4\u5feb\uff01</p> <p>\u800c\u4e14\uff0c\u7ebf\u7a0b\u6570\u8d8a\u591a\uff0cPtmalloc2 \u51fa\u73b0\u9501\u7ade\u4e89\u7684\u6982\u7387\u5c31\u8d8a\u9ad8\u3002\u6bd4\u5982\u6211\u4eec\u7528 40 \u4e2a\u7ebf\u7a0b\u505a\u540c\u6837\u7684\u6d4b\u8bd5\uff0cTCMalloc \u53ea\u662f\u4ece 10 \u7eb3\u79d2\u4e0a\u5347\u5230 25 \u7eb3\u79d2\uff0c\u53ea\u589e\u957f\u4e86 1.5 \u500d\uff0c\u800c Ptmalloc2 \u5219\u4ece 32 \u7eb3\u79d2\u4e0a\u5347\u5230 137 \u7eb3\u79d2\uff0c\u589e\u957f\u4e86 3 \u500d\u4ee5\u4e0a\u3002</p> <p>\u7ebf\u7a0b\u6570\u8d8a\u591a\uff0c\u4e8c\u8005\u7684\u901f\u5ea6\u5dee\u8ddd\u8d8a\u5927\u3002\u6240\u4ee5\uff0c\u5f53\u5e94\u7528\u573a\u666f\u6d89\u53ca\u5927\u91cf\u7684\u5e76\u53d1\u7ebf\u7a0b\u65f6\uff0c\u6362\u6210 TCMalloc \u5e93\u4e5f\u66f4\u6709\u4f18\u52bf\uff01</p> <p></p>"},{"location":"chap1/2Mem_Pool/#2-2-ptmalloc2","title":"2-2 Ptmalloc2 \u9002\u7528\u7684\u573a\u666f","text":"<p>\u4e3a\u4ec0\u4e48 GlibC \u4e0d\u628a\u9ed8\u8ba4\u7684 Ptmalloc2 \u5185\u5b58\u6c60\u6362\u6210 TCMalloc \u5462\uff1f\u56e0\u4e3a Ptmalloc2 \u66f4\u64c5\u957f\u5927\u5185\u5b58\u7684\u5206\u914d\u3002</p> <p>\u6bd4\u5982\uff0c\u5355\u7ebf\u7a0b\u4e0b\u5206\u914d 257K \u5b57\u8282\u7684\u5185\u5b58\uff0cPtmalloc2 \u7684\u8017\u65f6\u4e0d\u53d8\u4ecd\u7136\u662f 32 \u7eb3\u79d2\uff0c\u4f46 TCMalloc \u5c31\u7531 10 \u7eb3\u79d2\u4e0a\u5347\u5230 64 \u7eb3\u79d2\uff0c\u589e\u957f\u4e86 5 \u500d\u4ee5\u4e0a\uff01\u73b0\u5728 TCMalloc \u53cd\u8fc7\u6765\u6bd4 Ptmalloc2 \u6162\u4e86 1 \u500d\uff01\u8fd9\u662f\u56e0\u4e3a TCMalloc \u7279\u610f\u9488\u5bf9\u5c0f\u5185\u5b58\u505a\u4e86\u4f18\u5316\u3002</p>"},{"location":"chap1/2Mem_Pool/#2-3","title":"2-3 \u591a\u5c11\u5b57\u8282\u53eb\u5c0f\u5185\u5b58\u5462\uff1f","text":"<p>TCMalloc \u628a\u5185\u5b58\u5206\u4e3a 3 \u4e2a\u6863\u6b21\uff0c\u5c0f\u4e8e\u7b49\u4e8e 256KB \u7684\u79f0\u4e3a\u5c0f\u5185\u5b58\uff0c\u4ece 256KB \u5230 1M \u79f0\u4e3a\u4e2d\u7b49\u5185\u5b58\uff0c\u5927\u4e8e 1MB \u7684\u53eb\u505a\u5927\u5185\u5b58\u3002</p> <p>TCMalloc \u5bf9\u4e2d\u7b49\u5185\u5b58\u3001\u5927\u5185\u5b58\u7684\u5206\u914d\u901f\u5ea6\u5f88\u6162\uff0c\u6bd4\u5982\u6211\u4eec\u7528\u5355\u7ebf\u7a0b\u5206\u914d 2M \u7684\u5185\u5b58\uff0cPtmalloc2 \u8017\u65f6\u4ecd\u7136\u7a33\u5b9a\u5728 32 \u7eb3\u79d2\uff0c\u4f46 TCMalloc \u5df2\u7ecf\u4e0a\u5347\u5230 86 \u7eb3\u79d2\uff0c\u589e\u957f\u4e86 7 \u500d\u4ee5\u4e0a\u3002</p> <p>\u6240\u4ee5\uff0c\u5982\u679c\u4e3b\u8981\u5206\u914d 256KB \u4ee5\u4e0b\u7684\u5185\u5b58\uff0c\u7279\u522b\u662f\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\uff0c\u5e94\u5f53\u9009\u62e9 TCMalloc\uff1b\u5426\u5219\u5e94\u4f7f\u7528 Ptmalloc2\uff0c\u5b83\u7684\u901a\u7528\u6027\u66f4\u597d\u3002</p>"},{"location":"chap1/2Mem_Pool/#3","title":"3\u3001\u4ece\u5806\u8fd8\u662f\u6808\u4e0a\u5206\u914d\u5185\u5b58\uff1f","text":""},{"location":"chap1/2Mem_Pool/#3-1","title":"3-1 \u5806\u548c\u6808\u5185\u5b58\u662f\u5982\u4f55\u5206\u914d\u7684","text":"<p>\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f\u9759\u6001\u7c7b\u578b\u8bed\u8a00\uff0c\u90a3\u4e48\uff0c\u4e0d\u4f7f\u7528 new \u5173\u952e\u5b57\u5206\u914d\u7684\u5bf9\u8c61\u5927\u90fd\u662f\u5728\u6808\u4e2d\u7684\u3002\u6bd4\u5982\uff1a</p> <pre><code>C/C++/Java\u8bed\u8a00\uff1aint a = 10;\n</code></pre> <p>\u5426\u5219\uff0c\u901a\u8fc7 new \u6216\u8005 malloc \u5173\u952e\u5b57\u5206\u914d\u7684\u5bf9\u8c61\u5219\u662f\u5728\u5806\u4e2d\u7684\uff1a</p> <pre><code>C\u8bed\u8a00\uff1aint * a = (int*) malloc(sizeof(int));\nC++\u8bed\u8a00\uff1aint * a = new int;\nJava\u8bed\u8a00\uff1aint a = new Integer(10);\n</code></pre> <p>\u53e6\u5916\uff0c\u5bf9\u4e8e\u52a8\u6001\u7c7b\u578b\u8bed\u8a00\uff0c\u65e0\u8bba\u662f\u5426\u4f7f\u7528 new \u5173\u952e\u5b57\uff0c\u5185\u5b58\u90fd\u662f\u4ece\u5806\u4e2d\u5206\u914d\u7684\u3002</p>"},{"location":"chap1/2Mem_Pool/#3-2","title":"3-2 \u4ece\u6808\u4e2d\u5206\u914d\u5185\u5b58\u4f1a\u66f4\u5feb","text":"<p>\u7531\u4e8e\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6709\u72ec\u7acb\u7684\u6808\uff0c\u6240\u4ee5\u5206\u914d\u5185\u5b58\u65f6\u4e0d\u9700\u8981\u52a0\u9501\u4fdd\u62a4\uff0c\u800c\u4e14\u6808\u4e0a\u5bf9\u8c61\u7684\u5c3a\u5bf8\u5728\u7f16\u8bd1\u9636\u6bb5\u5c31\u5df2\u7ecf\u5199\u5165\u53ef\u6267\u884c\u6587\u4ef6\u4e86\uff0c\u6267\u884c\u6548\u7387\u66f4\u9ad8\uff01</p> <p>\u6027\u80fd\u81f3\u4e0a\u7684 Golang \u8bed\u8a00\u5c31\u662f\u6309\u7167\u8fd9\u4e2a\u903b\u8f91\u8bbe\u8ba1\u7684\uff0c\u5373\u4f7f\u4f60\u7528 new \u5173\u952e\u5b57\u5206\u914d\u4e86\u5806\u5185\u5b58\uff0c\u4f46\u7f16\u8bd1\u5668\u5982\u679c\u8ba4\u4e3a\u5728\u6808\u4e2d\u5206\u914d\u4e0d\u5f71\u54cd\u529f\u80fd\u8bed\u4e49\u65f6\uff0c\u4f1a\u81ea\u52a8\u6539\u4e3a\u5728\u6808\u4e2d\u5206\u914d\u3002</p>"},{"location":"chap1/2Mem_Pool/#3-3","title":"3-3 \u5728\u6808\u4e2d\u5206\u914d\u5185\u5b58\u7f3a\u70b9","text":"<ul> <li>\u4e00 \u6808\u5185\u5b58\u751f\u547d\u5468\u671f\u6709\u9650\uff0c\u5b83\u4f1a\u968f\u7740\u51fd\u6570\u8c03\u7528\u7ed3\u675f\u540e\u81ea\u52a8\u91ca\u653e\uff0c\u5728\u5806\u4e2d\u5206\u914d\u7684\u5185\u5b58\uff0c\u5e76\u4e0d\u968f\u7740\u5206\u914d\u65f6\u6240\u5728\u51fd\u6570\u8c03\u7528\u7684\u7ed3\u675f\u800c\u91ca\u653e\uff0c\u5b83\u7684\u751f\u547d\u5468\u671f\u8db3\u591f\u4f7f\u7528\u3002</li> <li>\u4e8c \u6808\u7684\u5bb9\u91cf\u6709\u9650\uff0c\u5982 CentOS 7 \u4e2d\u662f 8MB \u5b57\u8282\uff0c\u5982\u679c\u4f60\u7533\u8bf7\u7684\u5185\u5b58\u8d85\u8fc7\u9650\u5236\u4f1a\u9020\u6210\u6808\u6ea2\u51fa\u9519\u8bef\uff08\u6bd4\u5982\uff0c\u9012\u5f52\u51fd\u6570\u8c03\u7528\u5f88\u5bb9\u6613\u9020\u6210\u8fd9\u79cd\u95ee\u9898\uff09\uff0c\u800c\u5806\u5219\u6ca1\u6709\u5bb9\u91cf\u9650\u5236\u3002</li> </ul> <p>\u6240\u4ee5\uff0c\u5f53\u6211\u4eec\u5206\u914d\u5185\u5b58\u65f6\uff0c\u5982\u679c\u5728\u6ee1\u8db3\u529f\u80fd\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5728\u6808\u4e2d\u5206\u914d\u7684\u8bdd\uff0c\u5c31\u9009\u62e9\u6808\u3002</p>"},{"location":"chap1/2Mem_Pool/#4","title":"4\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u8fdb\u7a0b\u7533\u8bf7\u5185\u5b58\u7684\u901f\u5ea6\uff0c\u4ee5\u53ca\u603b\u5185\u5b58\u7a7a\u95f4\u90fd\u53d7\u5230\u5185\u5b58\u6c60\u7684\u5f71\u54cd\u3002</p> <p>\u9690\u85cf\u7740\u7684 C \u5e93\u5185\u5b58\u6c60\uff0c\u5bf9\u8fdb\u7a0b\u7684\u5185\u5b58\u5f00\u9500\u6709\u5f88\u5927\u7684\u5f71\u54cd\u3002\u5f53\u8fdb\u7a0b\u7684\u5360\u7528\u7a7a\u95f4\u8d85\u51fa\u9884\u671f\u65f6\uff0c\u4f60\u9700\u8981\u6e05\u695a\u4f60\u6b63\u5728\u4f7f\u7528\u7684\u662f\u4ec0\u4e48\u5185\u5b58\u6c60\uff0c\u5b83\u5bf9\u6bcf\u4e2a\u7ebf\u7a0b\u9884\u5206\u914d\u4e86\u591a\u5927\u7684\u7a7a\u95f4\u3002</p> <p>\u4e0d\u540c\u7684 C \u5e93\u5185\u5b58\u6c60\uff0c\u90fd\u6709\u5b83\u4eec\u6700\u9002\u5408\u7684\u5e94\u7528\u573a\u666f\uff0c\u4f8b\u5982 TCMalloc \u5bf9\u591a\u7ebf\u7a0b\u4e0b\u7684\u5c0f\u5185\u5b58\u5206\u914d\u7279\u522b\u53cb\u597d\uff0c\u800c Ptmalloc2 \u5219\u5bf9\u5404\u7c7b\u5c3a\u5bf8\u7684\u5185\u5b58\u7533\u8bf7\u90fd\u6709\u7a33\u5b9a\u7684\u8868\u73b0\uff0c\u66f4\u52a0\u901a\u7528\u3002</p> <ul> <li>\u5185\u5b58\u6c60\u7ba1\u7406\u7740\u5806\u5185\u5b58\uff0c\u5b83\u7684\u5206\u914d\u901f\u5ea6\u6bd4\u4e0d\u4e0a\u5728\u6808\u4e2d\u5206\u914d\u5185\u5b58\u3002\u53ea\u662f\u6808\u4e2d\u5206\u914d\u7684\u5185\u5b58\u53d7\u5230\u751f\u547d\u5468\u671f\u548c\u5bb9\u91cf\u5927\u5c0f\u7684\u9650\u5236\uff0c\u5e94\u7528\u573a\u666f\u66f4\u4e3a\u6709\u9650\u3002</li> <li>\u7136\u800c\uff0c\u5982\u679c\u6709\u53ef\u80fd\u7684\u8bdd\uff0c\u5c3d\u91cf\u5728\u6808\u4e2d\u5206\u914d\u5185\u5b58\uff0c\u5b83\u6bd4\u5185\u5b58\u6c60\u4e2d\u7684\u5806\u5185\u5b58\u5206\u914d\u901f\u5ea6\u5feb\u5f88\u591a\uff01</li> </ul> <p>Google \u7684 TCMalloc \u548c FaceBook \u7684 JEMalloc\uff0c\u5b83\u4eec\u4e5f\u662f C \u5e93\u5185\u5b58\u6c60\u3002\u5f53 C \u5e93\u5185\u5b58\u6c60\u65e0\u6cd5\u6ee1\u8db3\u5185\u5b58\u7533\u8bf7\u65f6\uff0c\u624d\u4f1a\u5411\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7533\u8bf7\u5206\u914d\u5185\u5b58\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>TCMalloc \u5bf9\u4e2d\u7b49\u5185\u5b58\u3001\u5927\u5185\u5b58\u7684\u5206\u914d\u901f\u5ea6\u5f88\u6162\uff0c\u6bd4\u5982\u6211\u4eec\u7528\u5355\u7ebf\u7a0b\u5206\u914d 2M \u7684\u5185\u5b58\uff0cPtmalloc2 \u8017\u65f6\u4ecd\u7136\u7a33\u5b9a\u5728 32 \u7eb3\u79d2\uff0c\u4f46 TCMalloc \u5df2\u7ecf\u4e0a\u5347\u5230 86 \u7eb3\u79d2\uff0c\u589e\u957f\u4e86 7 \u500d\u4ee5\u4e0a\u3002</p> <p>\u6240\u4ee5\uff0c\u5982\u679c\u4e3b\u8981\u5206\u914d 256KB \u4ee5\u4e0b\u7684\u5185\u5b58\uff0c\u7279\u522b\u662f\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\uff0c\u5e94\u5f53\u9009\u62e9 TCMalloc\uff1b\u5426\u5219\u5e94\u4f7f\u7528 Ptmalloc2\uff0c\u5b83\u7684\u901a\u7528\u6027\u66f4\u597d\u3002</p> <ul> <li>\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f\u9759\u6001\u7c7b\u578b\u8bed\u8a00\uff0c\u90a3\u4e48\uff0c\u4e0d\u4f7f\u7528 new \u5173\u952e\u5b57\u5206\u914d\u7684\u5bf9\u8c61\u5927\u90fd\u662f\u5728\u6808\u4e2d\u7684</li> <li>\u901a\u8fc7 new \u6216\u8005 malloc \u5173\u952e\u5b57\u5206\u914d\u7684\u5bf9\u8c61\u5219\u662f\u5728\u5806\u4e2d\u7684</li> <li>\u53e6\u5916\uff0c\u5bf9\u4e8e\u52a8\u6001\u7c7b\u578b\u8bed\u8a00\uff0c\u65e0\u8bba\u662f\u5426\u4f7f\u7528 new \u5173\u952e\u5b57\uff0c\u5185\u5b58\u90fd\u662f\u4ece\u5806\u4e2d\u5206\u914d\u7684\u3002</li> </ul> <p>\u4e3a\u4ec0\u4e48\u4ece\u6808\u4e2d\u5206\u914d\u5185\u5b58\u4f1a\u66f4\u5feb\u3002\u7531\u4e8e\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6709\u72ec\u7acb\u7684\u6808\uff0c\u6240\u4ee5\u5206\u914d\u5185\u5b58\u65f6\u4e0d\u9700\u8981\u52a0\u9501\u4fdd\u62a4\uff0c\u800c\u4e14\u6808\u4e0a\u5bf9\u8c61\u7684\u5c3a\u5bf8\u5728\u7f16\u8bd1\u9636\u6bb5\u5c31\u5df2\u7ecf\u5199\u5165\u53ef\u6267\u884c\u6587\u4ef6\u4e86\uff0c\u6267\u884c\u6548\u7387\u66f4\u9ad8\uff01</p> <p>\u6240\u4ee5\uff0c\u5f53\u6211\u4eec\u5206\u914d\u5185\u5b58\u65f6\uff0c\u5982\u679c\u5728\u6ee1\u8db3\u529f\u80fd\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5728\u6808\u4e2d\u5206\u914d\u7684\u8bdd\uff0c\u5c31\u9009\u62e9\u6808\u3002</p>"},{"location":"chap1/3Hash_index/","title":"\u7b2c\u4e09\u8282 \u54c8\u5e0c\u8868\u5229\u7528\u7d22\u5f15\u7ba1\u7406\u4ebf\u7ea7\u5bf9\u8c61","text":"<p>Ptmalloc2 \u4e3a\u5b50\u7ebf\u7a0b\u9884\u5206\u914d\u4e86 64MB \u5185\u5b58\u6c60\uff0c\u867d\u7136\u589e\u5927\u4e86\u5185\u5b58\u6d88\u8017\uff0c\u4f46\u5374\u52a0\u5feb\u4e86\u5206\u914d\u901f\u5ea6\uff0c\u8fd9\u5c31\u662f\u4ee5\u7a7a\u95f4\u6362\u65f6\u95f4\u7684\u601d\u60f3</p> <p>\u5728\u5185\u5b58\u6709\u9650\u7684\u5355\u7247\u673a\u4e0a\u8fd0\u884c\u5d4c\u5165\u5f0f\u7a0b\u5e8f\u65f6\uff0c\u4f1a\u538b\u7f29\u6570\u636e\u7684\u7a7a\u95f4\u5360\u7528\uff0c\u4ee5\u65f6\u95f4\u6362\u7a7a\u95f4\uff1b</p> <p>\u4f46\u5728\u9762\u5411\u6d77\u91cf\u7528\u6237\u7684\u5206\u5e03\u5f0f\u670d\u52a1\u4e2d\uff0c\u4f7f\u7528\u66f4\u591a\u7684\u7a7a\u95f4\u5efa\u7acb\u7d22\u5f15\uff0c\u6362\u53d6\u66f4\u77ed\u7684\u67e5\u8be2\u65f6\u95f4\uff0c\u7ba1\u7406\u5927\u6570\u636e\u7684\u5e38\u7528\u624b\u6bb5\u3002</p> <p>\u6bd4\u5982\u73b0\u5728\u9700\u8981\u7ba1\u7406\u6570\u4ebf\u6761\u6570\u636e\uff0c\u6bcf\u6761\u6570\u636e\u4e0a\u6709\u8bb8\u591a\u72b6\u6001\uff0c\u6709\u4e9b\u8bf7\u6c42\u5728\u67e5\u8be2\u8fd9\u4e9b\u72b6\u6001\uff0c\u6709\u4e9b\u8bf7\u6c42\u5219\u4f1a\u6839\u636e\u4e1a\u52a1\u89c4\u5219\u6709\u6761\u4ef6\u5730\u66f4\u65b0\u72b6\u6001\uff0c\u6709\u4e9b\u8bf7\u6c42\u4f1a\u65b0\u589e\u6570\u636e\uff0c\u6bcf\u6761\u6570\u636e\u51e0\u5341\u5230\u51e0\u767e\u5b57\u8282\u3002\u5982\u679c\u9700\u8981\u63d0\u4f9b\u5fae\u79d2\u7ea7\u7684\u8bbf\u95ee\u901f\u5ea6\uff0c\u8be5\u600e\u4e48\u5b9e\u73b0\uff1f</p> <p>\u8fd9\u79cd\u60c5\u51b5\u4f60\u4f1a\u9762\u5bf9\u5927\u91cf\u6570\u636e\uff0c\u663e\u7136\uff0c\u904d\u5386\u5168\u90e8\u6570\u636e\u53bb\u5339\u914d\u67e5\u8be2\u5173\u952e\u5b57\uff0c\u4f1a\u975e\u5e38\u8017\u65f6\u3002</p> <p>\u5982\u679c\u4f7f\u7528\u989d\u5916\u7684\u7a7a\u95f4\u4e3a\u8fd9\u4e9b\u6570\u636e\u521b\u5efa\u7d22\u5f15\uff0c\u5c31\u53ef\u4ee5\u57fa\u4e8e\u7d22\u5f15\u5b9e\u73b0\u5feb\u901f\u67e5\u627e\uff0c\u8fd9\u662f\u5e38\u7528\u7684\u89e3\u51b3\u65b9\u6848\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u7528\u6807\u51c6\u5e93\u91cc\u63d0\u4f9b\u7684\u5b57\u5178\u7c7b\u5bb9\u5668\u5b58\u653e\u5bf9\u8c61\uff0c\u5c31\u662f\u5728\u6570\u636e\u524d\u589e\u52a0\u4e86\u7d22\u5f15\uff0c\u5176\u672c\u8d28\u5c31\u662f\u4ee5\u7a7a\u95f4\u6362\u65f6\u95f4\u3002</p> <p>\u7d22\u5f15\u6709\u5f88\u591a\uff0c\u54c8\u5e0c\u8868\u3001\u7ea2\u9ed1\u6811\u3001B \u6811\u90fd\u53ef\u4ee5\u5728\u5185\u5b58\u4e2d\u4f7f\u7528\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u6570\u636e\u89c4\u6a21\u4e0a\u4ebf\u540e\u8fd8\u80fd\u63d0\u4f9b\u5fae\u79d2\u7ea7\u7684\u8bbf\u95ee\u901f\u5ea6\uff0c\u90a3\u4e48\u4f5c\u4e3a\u6700\u5feb\u7684\u7d22\u5f15\uff0c\u54c8\u5e0c\u8868\u662f\u7b2c\u4e00\u9009\u62e9\u3002</p>"},{"location":"chap1/3Hash_index/#1","title":"1\u3001\u4e3a\u4ec0\u4e48\u9009\u62e9\u54c8\u5e0c\u8868\uff1f","text":""},{"location":"chap1/3Hash_index/#1-1","title":"1-1 \u600e\u4e48\u5b9a\u91cf\u8bc4\u4ef7\u7d22\u5f15\u5feb\u6162\u5462\uff1f","text":"<p>\u65f6\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u5f88\u597d\u5730\u53cd\u6620\u8fd0\u884c\u65f6\u95f4\u968f\u6570\u636e\u89c4\u6a21\u7684\u53d8\u5316\u8d8b\u52bf\uff0c\u5c31\u5982\u4e0b\u56fe\u4e2d\uff0c\u6a2a\u8f74\u662f\u6570\u636e\u89c4\u6a21\uff0c\u7eb5\u8f74\u662f\u8fd0\u884c\u65f6\u95f4\uff0c\u968f\u7740\u6570\u636e\u89c4\u6a21\u7684\u589e\u957f\uff0c\u6c34\u5e73\u76f4\u7ebf 1 \u4e0d\u968f\u4e4b\u53d8\u5316\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd0\u884c\u65f6\u95f4\u4e0d\u53d8\uff0c\u662f\u6700\u597d\u7684\u66f2\u7ebf\u3002\u7528\u5927 O \u8868\u793a\u6cd5\u63cf\u8ff0\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u54c8\u5e0c\u8868\u5c31\u662f\u5e38\u91cf\u7ea7\u7684 O(1)\uff0c\u6570\u636e\u89c4\u6a21\u589e\u957f\u4e0d\u5f71\u54cd\u5b83\u7684\u8fd0\u884c\u65f6\u95f4\uff0c\u6240\u4ee5 Memcached\u3001Redis \u90fd\u5728\u7528\u54c8\u5e0c\u8868\u7ba1\u7406\u6570\u636e\u3002</p> <p></p>"},{"location":"chap1/3Hash_index/#1-2-o1","title":"1-2 \u54c8\u5e0c\u8868\u505a\u5230 O(1) \u65f6\u95f4\u590d\u6742\u5ea6","text":"<ul> <li> <p>\u9996\u5148\uff0c\u54c8\u5e0c\u8868\u57fa\u4e8e\u6570\u7ec4\u5b9e\u73b0\uff0c\u800c\u6570\u7ec4\u53ef\u4ee5\u6839\u636e\u4e0b\u6807\u968f\u673a\u8bbf\u95ee\u4efb\u610f\u5143\u7d20\u3002</p> <ul> <li>\u6570\u7ec4\u4e4b\u6240\u4ee5\u53ef\u4ee5\u968f\u673a\u8bbf\u95ee\uff0c\u662f\u56e0\u4e3a\u5b83\u7531\u8fde\u7eed\u5185\u5b58\u627f\u8f7d\uff0c\u4e14\u6bcf\u4e2a\u6570\u7ec4\u5143\u7d20\u7684\u5927\u5c0f\u90fd\u76f8\u7b49\u3002</li> <li>\u5f53\u77e5\u9053\u4e0b\u6807\u540e\uff0c\u628a\u4e0b\u6807\u4e58\u4ee5\u5143\u7d20\u5927\u5c0f\uff0c\u518d\u52a0\u4e0a\u6570\u7ec4\u7684\u9996\u5730\u5740\uff0c\u5c31\u53ef\u4ee5\u83b7\u5f97\u76ee\u6807\u8bbf\u95ee\u5730\u5740\uff0c\u76f4\u63a5\u83b7\u53d6\u6570\u636e\u3002</li> </ul> </li> <li> <p>\u5176\u6b21\uff0c\u54c8\u5e0c\u51fd\u6570\u76f4\u63a5\u628a\u67e5\u8be2\u5173\u952e\u5b57\u8f6c\u6362\u4e3a\u6570\u7ec4\u4e0b\u6807\uff0c\u518d\u901a\u8fc7\u6570\u7ec4\u7684\u968f\u673a\u8bbf\u95ee\u7279\u6027\u83b7\u53d6\u6570\u636e\u3002</p> <ul> <li>\u6bd4\u5982\uff0c\u5982\u679c\u5173\u952e\u5b57\u662f\u5b57\u7b26\u4e32\uff0c\u6211\u4eec\u4f7f\u7528 BKDR \u54c8\u5e0c\u7b97\u6cd5\u5c06\u5176\u8f6c\u6362\u4e3a\u81ea\u7136\u6570\uff0c\u518d\u4ee5\u54c8\u5e0c\u6570\u7ec4\u5927\u5c0f\u4e3a\u9664\u6570\uff0c\u5bf9\u5b83\u8fdb\u884c\u6c42\u4f59\uff0c\u5c31\u5f97\u5230\u4e86\u6570\u7ec4\u4e0b\u6807\u3002 </li> </ul> </li> </ul> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5b57\u7b26\u4e32 abc \u7ecf\u8fc7\u54c8\u5e0c\u51fd\u6570\u7684\u8fd0\u7b97\uff0c\u5f97\u5230\u4e86\u4e0b\u6807 39\uff0c\u4e8e\u662f\u6570\u636e\u5c31\u5b58\u653e\u5728\u6570\u7ec4\u7684\u7b2c 39 \u4e2a\u5143\u7d20\u4e0a\u3002</p> <p></p> <p>\u54c8\u5e0c\u51fd\u6570\u7684\u6267\u884c\u65f6\u95f4\u662f\u5e38\u91cf\uff0c\u6570\u7ec4\u7684\u968f\u673a\u8bbf\u95ee\u4e5f\u662f\u5e38\u91cf\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f O(1)\u3002</p>"},{"location":"chap1/3Hash_index/#1-3","title":"1-3 \u751f\u4ea7\u73af\u5883\u7528\u54c8\u5e0c\u8868\u9762\u4e34\u7684\u95ee\u9898","text":"<p>\u5728\u751f\u4ea7\u73af\u5883\u7528\u54c8\u5e0c\u8868\u7ba1\u7406\u5982\u6b64\u591a\u7684\u6570\u636e\uff0c\u5fc5\u7136\u9762\u4e34\u4ee5\u4e0b\u95ee\u9898</p> <ul> <li>\u9996\u5148\uff0c\u9762\u5bf9\u4e0a\u4ebf\u6761\u6570\u636e\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u53ef\u9760\u6027\uff0c\u9700\u8981\u505a\u707e\u5907\u6062\u590d\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed3\u5408\u5feb\u7167 +oplog \u65b9\u5f0f\u6062\u590d\u6570\u636e\uff0c\u4f46\u5185\u5b58\u4e2d\u7684\u54c8\u5e0c\u8868\u5982\u4f55\u5feb\u901f\u5730\u5e8f\u5217\u5316\u4e3a\u5feb\u7167\u6587\u4ef6\uff1f</li> <li>\u5176\u6b21\uff0c\u7b80\u5355\u7684\u4f7f\u7528\u6807\u51c6\u5e93\u63d0\u4f9b\u7684\u54c8\u5e0c\u8868\u5904\u7406\u5982\u6b64\u89c4\u6a21\u7684\u6570\u636e\uff0c\u4f1a\u5bfc\u81f4\u5185\u5b58\u6d88\u8017\u8fc7\u5927\uff0c\u56e0\u4e3a\u6bcf\u591a\u4f7f\u7528\u4e00\u4e2a 8 \u5b57\u8282\u7684\u6307\u9488\uff08\u6216\u8005\u53eb\u5f15\u7528\uff09\u90fd\u4f1a\u88ab\u653e\u5927\u4ebf\u4e07\u500d\uff0c\u6b64\u65f6\u8be5\u5982\u4f55\u5b9e\u73b0\u66f4\u8282\u7ea6\u5185\u5b58\u7684\u4e2a\u6027\u5316\u54c8\u5e0c\u8868\uff1f</li> <li>\u518d\u6b21\uff0c\u54c8\u5e0c\u8868\u9891\u7e41\u53d1\u751f\u51b2\u7a81\u65f6\uff0c\u901f\u5ea6\u4f1a\u6025\u5267\u964d\u4f4e\uff0c\u6211\u4eec\u8be5\u901a\u8fc7\u54ea\u4e9b\u624b\u6bb5\u51cf\u5c11\u51b2\u7a81\u6982\u7387\uff1f</li> </ul>"},{"location":"chap1/3Hash_index/#2","title":"2\u3001\u5185\u5b58\u7ed3\u6784\u4e0e\u5e8f\u5217\u5316\u65b9\u6848","text":"<p>\u4e8b\u5b9e\u4e0a\u5bf9\u4e8e\u52a8\u6001\uff08\u5143\u7d20\u662f\u53d8\u5316\u7684\uff09\u54c8\u5e0c\u8868\uff0c\u6211\u4eec\u65e0\u6cd5\u907f\u514d\u54c8\u5e0c\u51b2\u7a81\u3002</p> <p>\u6bd4\u5982\u4e0a\u4f8b\u4e2d\uff0c\u201cabc\u201d\u4e0e\u201ccba\u201d\u8fd9\u4e24\u4e2a\u5b57\u7b26\u4e32\u54c8\u5e0c\u540e\u90fd\u4f1a\u843d\u5230\u4e0b\u6807 39 \u4e2d\uff0c\u8fd9\u5c31\u4ea7\u751f\u4e86\u51b2\u7a81\u3002\u6709\u4e24\u79cd\u65b9\u6cd5\u89e3\u51b3\u54c8\u5e0c\u51b2\u7a81\uff1a</p> <ol> <li>\u94fe\u63a5\u6cd5\uff0c\u843d\u5230\u6570\u7ec4\u540c\u4e00\u4e2a\u4f4d\u7f6e\u4e2d\u7684\u591a\u4e2a\u6570\u636e\uff0c\u901a\u8fc7\u94fe\u8868\u4e32\u5728\u4e00\u8d77\u3002\u4f7f\u7528\u54c8\u5e0c\u51fd\u6570\u67e5\u627e\u5230\u8fd9\u4e2a\u4f4d\u7f6e\u540e\uff0c\u518d\u4f7f\u7528\u94fe\u8868\u904d\u5386\u7684\u65b9\u5f0f\u67e5\u627e\u6570\u636e\u3002Java \u6807\u51c6\u5e93\u4e2d\u7684\u54c8\u5e0c\u8868\u5c31\u4f7f\u7528\u94fe\u63a5\u6cd5\u89e3\u51b3\u51b2\u7a81\u3002</li> <li>\u5f00\u653e\u5bfb\u5740\u6cd5\uff0c\u63d2\u5165\u65f6\u82e5\u53d1\u73b0\u5bf9\u5e94\u7684\u4f4d\u7f6e\u5df2\u7ecf\u5360\u7528\uff0c\u6216\u8005\u67e5\u8be2\u65f6\u53d1\u73b0\u8be5\u4f4d\u7f6e\u4e0a\u7684\u6570\u636e\u4e0e\u67e5\u8be2\u5173\u952e\u5b57\u4e0d\u540c\uff0c\u5f00\u653e\u5bfb\u5740\u6cd5\u4f1a\u6309\u65e2\u5b9a\u89c4\u5219\u53d8\u6362\u54c8\u5e0c\u51fd\u6570\uff08\u4f8b\u5982\u54c8\u5e0c\u51fd\u6570\u8bbe\u4e3a H(key,i)\uff0c\u987a\u5e8f\u5730\u628a\u53c2\u6570 i \u52a0 1\uff09\uff0c\u8ba1\u7b97\u51fa\u4e0b\u4e00\u4e2a\u6570\u7ec4\u4e0b\u6807\uff0c\u7ee7\u7eed\u5728\u54c8\u5e0c\u8868\u4e2d\u63a2\u67e5\u6b63\u786e\u7684\u4f4d\u7f6e\u3002</li> </ol> <p>\u6211\u4eec\u8be5\u9009\u62e9\u54ea\u79cd\u65b9\u6cd5\u5462\uff1f</p> <p>\u7531\u4e8e\u751f\u4ea7\u7ea7\u5b58\u653e\u5927\u91cf\u5bf9\u8c61\u7684\u54c8\u5e0c\u8868\u662f\u9700\u8981\u5bb9\u707e\u7684\uff0c\u6bd4\u5982\u6bcf\u9694\u4e00\u5929\u628a\u54c8\u5e0c\u8868\u6570\u636e\u5b9a\u671f\u5907\u4efd\u5230\u53e6\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u3002\u5f53\u670d\u52a1\u5668\u5b95\u673a\u800c\u542f\u52a8\u5907\u7528\u670d\u52a1\u5668\u65f6</p> <p>\u9996\u5148\u53ef\u4ee5\u7528\u5907\u4efd\u6570\u636e\u628a\u54c8\u5e0c\u8868\u6062\u590d\u5230 1 \u5929\u524d\u7684\u72b6\u6001\uff0c\u518d\u901a\u8fc7\u64cd\u4f5c\u65e5\u5fd7 oplog \u628a 1 \u5929\u5185\u7684\u6570\u636e\u8f7d\u5165\u54c8\u5e0c\u8868\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u6700\u5feb\u901f\u7684\u6062\u590d\u54c8\u5e0c\u8868\u3002\u6240\u4ee5\uff0c\u4e3a\u4e86\u80fd\u591f\u4f20\u8f93\uff0c\u9996\u5148\u5fc5\u987b\u628a\u54c8\u5e0c\u8868\u5e8f\u5217\u5316\u3002</p> <p>\u94fe\u63a5\u6cd5\u867d\u7136\u5b9e\u73b0\u7b80\u5355\uff0c\u8fd8\u5141\u8bb8\u5b58\u653e\u5143\u7d20\u4e2a\u6570\u5927\u4e8e\u6570\u7ec4\u7684\u5927\u5c0f\uff08\u4e5f\u53eb\u88c5\u8f7d\u56e0\u5b50\u5927\u4e8e 1\uff09\uff0c\u4f46\u94fe\u63a5\u6cd5\u5e8f\u5217\u5316\u6570\u636e\u7684\u4ee3\u4ef7\u5f88\u5927\uff0c\u56e0\u4e3a\u4f7f\u7528\u4e86\u6307\u9488\u540e\uff0c\u5185\u5b58\u662f\u4e0d\u8fde\u7eed\u7684\u3002</p> <p>\u5f00\u653e\u5bfb\u5740\u6cd5\u786e\u4fdd\u6240\u6709\u5bf9\u8c61\u90fd\u5728\u6570\u7ec4\u91cc\uff0c\u5c31\u53ef\u4ee5\u628a\u6570\u7ec4\u7528\u5230\u7684\u8fd9\u6bb5\u8fde\u7eed\u5185\u5b58\u539f\u5730\u6620\u5c04\u5230\u6587\u4ef6\u4e2d\uff08\u53c2\u8003 Linux \u4e2d\u7684 mmap\uff0cJava \u7b49\u8bed\u8a00\u90fd\u6709\u7c7b\u4f3c\u7684\u5c01\u88c5\uff09\uff0c\u518d\u901a\u8fc7\u5907\u4efd\u6587\u4ef6\u7684\u65b9\u5f0f\u5907\u4efd\u54c8\u5e0c\u8868</p> <p>\u867d\u7136\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u540c\u6b65\u5185\u5b58\u4e2d\u53d8\u66f4\u7684\u6570\u636e\u81f3\u6587\u4ef6\uff0c\u4f46\u5907\u4efd\u524d\u8fd8\u662f\u9700\u8981\u4e3b\u52a8\u5237\u65b0\u5185\u5b58\uff08\u53c2\u8003 Linux \u4e2d\u7684 msync\uff0c\u5b83\u53ef\u4ee5\u6309\u5730\u5740\u53ca\u957f\u5ea6\u6765\u5206\u6bb5\u5237\u65b0\uff0c\u4ee5\u51cf\u5c11 msync \u7684\u8017\u65f6\uff09\uff0c\u4ee5\u786e\u5b9a\u5907\u4efd\u6570\u636e\u7684\u7cbe\u786e\u65f6\u95f4\u70b9\u3002\u800c\u65b0\u7684\u8fdb\u7a0b\u542f\u52a8\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u6620\u5c04\u78c1\u76d8\u4e2d\u7684\u6587\u4ef6\u5230\u5185\u5b58\uff0c\u5feb\u901f\u91cd\u5efa\u54c8\u5e0c\u8868\u63d0\u4f9b\u670d\u52a1\u3002</p> <p>\u5982\u679c\u80fd\u5c06\u6570\u636e\u5b8c\u6574\u7684\u653e\u8fdb\u6570\u7ec4\uff0c\u90a3\u4e48\u5f00\u653e\u5bfb\u5740\u6cd5\u5df2\u7ecf\u89e3\u51b3\u4e86\u5e8f\u5217\u5316\u95ee\u9898\uff0c\u6240\u4ee5\u6211\u4eec\u5e94\u8be5\u9009\u62e9\u5f00\u653e\u5bfb\u5740\u6cd5\u3002</p> <p>\u6709\u4e24\u4e2a\u56e0\u7d20\u4f7f\u5f97\u6211\u4eec\u5fc5\u987b\u628a\u6570\u636e\u653e\u5728\u54c8\u5e0c\u6876\u4e4b\u5916</p> <ol> <li>\u6bcf\u6761\u6570\u636e\u6709\u4e0a\u767e\u5b57\u8282\uff1b</li> <li>\u54c8\u5e0c\u8868\u4e2d\u4e00\u5b9a\u4f1a\u6709\u5f88\u591a\u7a7a\u6876\uff08\u6ca1\u6709\u5b58\u653e\u6570\u636e\uff09\u3002\u7a7a\u6876\u7684\u6bd4\u4f8b\u8d8a\u9ad8\uff08\u88c5\u8f7d\u56e0\u5b50\u8d8a\u5c0f\uff09\uff0c\u51b2\u7a81\u6982\u7387\u4e5f\u4f1a\u8d8a\u4f4e\uff0c\u4f46\u5982\u679c\u6bcf\u4e2a\u7a7a\u6876\u90fd\u5360\u7528\u4e0a\u767e\u5b57\u8282\uff0c\u4ebf\u7ea7\u89c4\u6a21\u4f1a\u8f7b\u677e\u628a\u6d6a\u8d39\u7684\u5185\u5b58\u653e\u5927\u8bb8\u591a\u500d\u3002</li> </ol> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u8981\u628a\u6570\u636e\u4ece\u54c8\u5e0c\u8868\u4e2d\u5206\u79bb\u51fa\u6765\uff0c\u63d0\u5347\u54c8\u5e0c\u8868\u7684\u7075\u6d3b\u6027\uff08\u7075\u6d3b\u8c03\u6574\u88c5\u8f7d\u56e0\u5b50\uff09\u3002</p> <p>\u6700\u5feb\u901f\u7684\u5e8f\u5217\u5316\u65b9\u6848\uff0c\u8fd8\u662f\u50cf\u5f00\u653e\u5bfb\u5740\u6cd5\u7684\u6563\u5217\u8868\u4e00\u6837\uff0c\u4f7f\u7528\u5b9a\u957f\u6570\u7ec4\u5b58\u653e\u5bf9\u8c61\uff0c\u901a\u8fc7\u539f\u5730\u6620\u5c04\u6587\u4ef6\u7684\u65b9\u5f0f\u5e8f\u5217\u5316\u6570\u636e\u3002\u7531\u4e8e\u6570\u636e\u672a\u5fc5\u662f\u5b9a\u957f\u7684\uff0c\u6240\u4ee5\u53c8\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\u3002</p> <ul> <li>\u4e00\u3001\u6570\u636e\u7684\u957f\u5ea6\u662f\u56fa\u5b9a\u7684\u3002</li> <li>\u4e8c\u3001\u6570\u636e\u7684\u957f\u5ea6\u5e76\u4e0d\u56fa\u5b9a\u3002</li> </ul>"},{"location":"chap1/3Hash_index/#3","title":"3\u3001\u964d\u4f4e\u54c8\u5e0c\u8868\u7684\u51b2\u7a81\u6982\u7387","text":"<p>\u867d\u7136\u54c8\u5e0c\u51b2\u7a81\u6709\u89e3\u51b3\u65b9\u6848\uff0c\u4f46\u82e5\u662f\u6240\u6709\u5143\u7d20\u90fd\u53d1\u751f\u4e86\u51b2\u7a81\uff0c\u54c8\u5e0c\u8868\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u9000\u5316\u6210\u4e86 O(N)\uff0c\u5373\u6bcf\u67e5\u627e\u4e00\u6b21\u90fd\u8981\u904d\u5386\u6240\u6709\u6570\u636e</p> <p>\u51cf\u5c11\u51b2\u7a81\u7684\u6982\u7387\uff0c\u800c\u51cf\u5c11\u51b2\u7a81\u6982\u7387\u6709\u4e24\u4e2a\u529e\u6cd5\uff0c\u7b2c\u4e00\u4e2a\u529e\u6cd5\u662f\u8c03\u4f18\u54c8\u5e0c\u51fd\u6570\uff0c\u7b2c\u4e8c\u4e2a\u529e\u6cd5\u5c31\u662f\u6269\u5bb9\u3002</p>"},{"location":"chap1/3Hash_index/#3-1","title":"3-1 \u8c03\u4f18\u54c8\u5e0c\u51fd\u6570","text":"<p>\u4ec0\u4e48\u662f\u597d\u7684\u54c8\u5e0c\u51fd\u6570\u5462\uff1f</p> <p>\u9996\u5148\u5b83\u7684\u8ba1\u7b97\u91cf\u4e0d\u80fd\u5927\uff0c\u5176\u6b21\u5e94\u5c3d\u91cf\u964d\u4f4e\u51b2\u7a81\u6982\u7387\u3002\u56de\u5230\u5f00\u5934\u7684\u90a3\u4e2a\u54c8\u5e0c\u51fd\u6570\uff1a</p> <p></p> <p>\u8fd9\u4e2a\u54c8\u5e0c\u51fd\u6570\u4f7f\u5f97\u201cabc\u201d\u548c\u201ccba\u201d\u4e24\u4e2a\u5173\u952e\u5b57\u90fd\u843d\u5728\u4e86\u4e0b\u6807 39 \u4e0a\uff0c\u9020\u6210\u4e86\u54c8\u5e0c\u51b2\u7a81\uff0c\u662f\u56e0\u4e3a\u5b83\u4e22\u5931\u4e86\u5b57\u6bcd\u7684\u4f4d\u7f6e\u4fe1\u606f\u3002</p> <p>BKDR \u662f\u4f18\u79c0\u7684\u54c8\u5e0c\u7b97\u6cd5\uff0c\u4f46\u5b83\u4e0d\u80fd\u4ee5 28 \u4f5c\u4e3a\u57fa\u6570\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u5b57\u7b26\u4e32\u5206\u5e03\u4e0d\u5747\u5300\u3002\u4e8b\u5b9e\u4e0a\uff0c\u6211\u4eec\u5e94\u5f53\u627e\u4e00\u4e2a\u5408\u9002\u7684\u7d20\u6570\u4f5c\u4e3a\u57fa\u6570\uff0c\u6bd4\u5982 31\uff0cJava \u6807\u51c6\u5e93\u7684 BKDR \u54c8\u5e0c\u7b97\u6cd5\u5c31\u4ee5\u5b83\u4e3a\u57fa\u6570\uff0c\u5b83\u7684\u8ba1\u7b97\u91cf\u4e5f\u5f88\u5c0f\uff1a<code>n*31</code> \u53ef\u4ee5\u901a\u8fc7\u5148\u628a n \u5de6\u79fb 5 \u4f4d\uff0c\u518d\u51cf\u53bb n \u7684\u65b9\u5f0f\u66ff\u6362<code>\uff08n*31 == n&lt;&lt;5 - n\uff09</code>\u3002</p> <p>\u4e00\u6b21\u4f4d\u79fb\u52a0\u4e00\u6b21\u51cf\u6cd5\uff0c\u8981\u6bd4\u4e00\u6b21\u4e58\u6cd5\u5feb\u5f97\u591a\u3002\u5f53\u7136\uff0c\u56fe\u4e2d\u7684\u54c8\u5e0c\u51fd\u6570\u4e4b\u6240\u4ee5\u4f1a\u4e22\u5931\u4f4d\u7f6e\u4fe1\u606f\uff0c\u662f\u56e0\u4e3a\u4ee5 28 \u4f5c\u4e3a\u57fa\u6570\u7684\u540c\u65f6\uff0c\u53c8\u628a <code>28-1</code> \u4f5c\u4e3a\u9664\u6570\u6240\u81f4\uff0c\u6570\u5b66\u8f83\u597d\u7684\u540c\u5b66\u53ef\u4ee5\u8bd5\u7740\u63a8\u5bfc\u8bc1\u660e\uff0c\u8fd9\u91cc\u53ea\u9700\u8981\u8bb0\u4f4f\uff0c\u57fa\u6570\u5fc5\u987b\u662f\u7d20\u6570\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u5f53\u54c8\u5e0c\u51fd\u6570\u628a\u9ad8\u4fe1\u606f\u91cf\u7684\u5173\u952e\u5b57\u538b\u7f29\u6210\u66f4\u5c0f\u7684\u6570\u7ec4\u4e0b\u6807\u65f6\uff0c\u4e00\u5b9a\u4f1a\u4e22\u5931\u4fe1\u606f\u3002\u6211\u4eec\u5e0c\u671b\u53ea\u4e22\u5931\u4e00\u4e9b\u65e0\u5173\u7d27\u8981\u7684\u4fe1\u606f\uff0c\u5c3d\u91cf\u591a\u5730\u4fdd\u7559\u533a\u5206\u5ea6\u9ad8\u7684\u4fe1\u606f</p>"},{"location":"chap1/3Hash_index/#3-2","title":"3-2 \u6269\u5bb9","text":"<p>\u88c5\u8f7d\u56e0\u5b50\u8d8a\u63a5\u8fd1\u4e8e 1\uff0c\u51b2\u7a81\u6982\u7387\u5c31\u4f1a\u8d8a\u5927\u3002\u6211\u4eec\u4e0d\u80fd\u6539\u53d8\u5143\u7d20\u7684\u6570\u91cf\uff0c\u53ea\u80fd\u901a\u8fc7\u6269\u5bb9\u63d0\u5347\u54c8\u5e0c\u6876\u7684\u6570\u91cf\uff0c\u51cf\u5c11\u51b2\u7a81\u3002</p> <p>\u7531\u4e8e\u54c8\u5e0c\u51fd\u6570\u5fc5\u987b\u786e\u4fdd\u8ba1\u7b97\u51fa\u7684\u4e0b\u6807\u843d\u5728\u6570\u7ec4\u8303\u56f4\u4e2d\uff0c\u800c\u6269\u5bb9\u4f1a\u589e\u52a0\u6570\u7ec4\u7684\u5927\u5c0f\uff0c\u8fdb\u800c\u5f71\u54cd\u54c8\u5e0c\u51fd\u6570\uff0c\u56e0\u6b64\uff0c\u6269\u5bb9\u524d\u5b58\u653e\u5728\u54c8\u5e0c\u8868\u4e2d\u7684\u6240\u6709\u5143\u7d20\uff0c\u5b83\u4eec\u5728\u6269\u5bb9\u540e\u7684\u6570\u7ec4\u4e2d\u4f4d\u7f6e\u90fd\u53d1\u751f\u4e86\u53d8\u5316\u3002</p> <p>\u6240\u4ee5\uff0c\u6269\u5bb9\u9700\u8981\u65b0\u8001\u54c8\u5e0c\u8868\u540c\u65f6\u5b58\u5728\uff0c\u901a\u8fc7\u904d\u5386\u5168\u90e8\u6570\u636e\uff0c\u7528\u65b0\u7684\u54c8\u5e0c\u51fd\u6570\u628a\u5173\u952e\u5b57\u653e\u5230\u5408\u9002\u7684\u65b0\u54c8\u5e0c\u6876\u4e2d\u3002\u53ef\u89c1\uff0c\u6269\u5bb9\u662f\u4e00\u4e2a\u6781\u5176\u8017\u65f6\u7684\u64cd\u4f5c\uff0c\u5c24\u5176\u5728\u5143\u7d20\u4ee5\u4ebf\u8ba1\u7684\u60c5\u51b5\u4e0b\u3002</p> <p>\u8981\u628a\u4e00\u6b21\u6027\u7684\u8fc1\u79fb\u8fc7\u7a0b\uff0c\u5206\u4e3a\u591a\u6b21\u540e\u53f0\u8fc1\u79fb\uff0c\u4e14\u63d0\u4f9b\u670d\u52a1\u65f6\u80fd\u591f\u6839\u636e\u8fc1\u79fb\u60c5\u51b5\u9009\u62e9\u65b0\u8001\u54c8\u5e0c\u8868\u5373\u53ef\u3002</p> <p>\u5982\u679c\u5355\u673a\u5185\u5b58\u53ef\u4ee5\u5b58\u653e\u4e0b\u65b0\u8001\u4e24\u5f20\u54c8\u5e0c\u8868\uff0c\u90a3\u4e48\u52a8\u6001\u6269\u5bb9\u4e0d\u9700\u8981\u8de8\u4e3b\u673a\u3002\u53cd\u4e4b\uff0c\u6269\u5bb9\u8fc7\u7a0b\u5c06\u6d89\u53ca\u65b0\u8001\u54c8\u5e0c\u8868\u6240\u5728\u7684\u4e24\u53f0\u670d\u52a1\u5668\uff0c\u5b9e\u73b0\u66f4\u4e3a\u590d\u6742\uff0c\u4f46\u539f\u7406\u662f\u76f8\u540c\u7684\u3002</p>"},{"location":"chap1/3Hash_index/#_2","title":"\u672c\u8282\u5c0f\u7ed3","text":"<p>\u7ba1\u7406\u4e0a\u4ebf\u6761\u6570\u636e\u3002\u4e3a\u4ec0\u4e48\u9009\u62e9\u54c8\u5e0c\u8868\uff1f</p> <ul> <li>\u56e0\u4e3a\u54c8\u5e0c\u8868\u7684\u8fd0\u884c\u65f6\u95f4\u4e0d\u968f\u7740\u4e1a\u52a1\u89c4\u6a21\u589e\u957f\u800c\u53d8\u5316\u3002</li> <li>\u4f4d\u56fe\u672c\u8d28\u4e0a\u662f\u54c8\u5e0c\u8868\u7684\u53d8\u79cd\uff0c\u4e0d\u8fc7\u5b83\u5e38\u7528\u4e8e\u914d\u5408\u4e3b\u7d22\u5f15\uff0c\u5feb\u901f\u5224\u65ad\u6570\u636e\u7684\u72b6\u6001\u3002\u56e0\u4e3a\u54c8\u5e0c\u8868\u672c\u8eab\u6ca1\u529e\u6cd5\u627e\u5230\u5173\u952e\u5b57\u76f8\u90bb\u7684\u4e0b\u4e00\u4e2a\u5143\u7d20\uff0c\u6240\u4ee5\u54c8\u5e0c\u8868\u4e0d\u652f\u6301\u8303\u56f4\u67e5\u8be2\u4e0e\u904d\u5386\u3002</li> <li>\u5982\u679c\u4e1a\u52a1\u9700\u8981\u652f\u6301\u8303\u56f4\u67e5\u8be2\u65f6\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u7ea2\u9ed1\u6811\u3001B \u6811\u7b49\u7d22\u5f15\uff0c\u5b83\u4eec\u5176\u5b9e\u5e76\u4e0d\u6162\u3002\u5f53\u7d22\u5f15\u592a\u5927\uff0c\u5fc5\u987b\u5c06\u4e00\u90e8\u5206\u4ece\u5185\u5b58\u4e2d\u79fb\u5230\u786c\u76d8\u65f6\uff0cB \u6811\u5c31\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u9009\u62e9\u3002</li> </ul> <p>\u4f7f\u7528\u54c8\u5e0c\u8868\uff0c\u51e0\u4e2a\u5173\u952e\u95ee\u9898\u3002</p> <ul> <li>\u751f\u4ea7\u73af\u5883\u4e00\u5b9a\u8981\u8003\u8651\u5bb9\u707e\uff0c\u800c\u628a\u54c8\u5e0c\u8868\u539f\u5730\u5e8f\u5217\u5316\u4e3a\u6587\u4ef6\u662f\u4e00\u4e2a\u89e3\u51b3\u65b9\u6848\uff0c\u5b83\u80fd\u4fdd\u8bc1\u65b0\u8fdb\u7a0b\u5feb\u901f\u6062\u590d\u54c8\u5e0c\u8868\u3002\u89e3\u51b3\u54c8\u5e0c\u51b2\u7a81\u6709\u94fe\u63a5\u6cd5\u548c\u5f00\u653e\u5bfb\u5740\u6cd5\uff0c\u800c\u540e\u8005\u66f4\u64c5\u957f\u5e8f\u5217\u5316\u6570\u636e\uff0c\u56e0\u6b64\u6210\u4e3a\u6211\u4eec\u7684\u9996\u9009 \u3002</li> <li>\u4ebf\u7ea7\u6570\u636e\u4e0b\uff0c\u6211\u4eec\u5fc5\u987b\u6ce8\u91cd\u5185\u5b58\u7684\u8282\u7ea6\u4f7f\u7528\u3002\u6570\u4ebf\u6761\u6570\u636e\u4f1a\u653e\u5927\u8282\u7ea6\u4e0b\u7684\u70b9\u6ef4\u5185\u5b58\uff0c\u518d\u628a\u5b83\u4eec\u7528\u4e8e\u63d0\u5347\u54c8\u5e0c\u6570\u7ec4\u7684\u5927\u5c0f\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u964d\u4f4e\u88c5\u8f7d\u56e0\u5b50\u6765\u51cf\u5c11\u54c8\u5e0c\u51b2\u7a81\uff0c\u63d0\u5347\u901f\u5ea6\u3002</li> <li>\u4f18\u5316\u54c8\u5e0c\u51fd\u6570\u4e5f\u662f\u964d\u4f4e\u54c8\u5e0c\u51b2\u7a81\u7684\u91cd\u8981\u624b\u6bb5\uff0c\u6211\u4eec\u9700\u8981\u7814\u7a76\u5173\u952e\u5b57\u7684\u7279\u5f81\u4e0e\u5206\u5e03\uff0c\u8bbe\u8ba1\u51fa\u5feb\u901f\u3001\u4f7f\u5173\u952e\u5b57\u5747\u5300\u5206\u5e03\u7684\u54c8\u5e0c\u51fd\u6570</li> </ul> <p>\u54c8\u5e0c\u8868\u3001\u7ea2\u9ed1\u6811\u7b49\u8fd9\u4e9b\u7d22\u5f15\u90fd\u4f7f\u7528\u4e86\u4ee5\u7a7a\u95f4\u6362\u65f6\u95f4\u7684\u601d\u60f3\u3002\u5224\u65ad\u5b83\u4eec\u7684\u65f6\u95f4\u6d88\u8017\uff0c\u6211\u4eec\u90fd\u9700\u8981\u4f9d\u8d56\u65f6\u95f4\u590d\u6742\u5ea6\u8fd9\u4e2a\u5de5\u5177\u3002\u5f53\u7136\uff0c\u7d22\u5f15\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\u4e5f\u4f1a\u964d\u4f4e\u6027\u80fd\u3002\u4f8b\u5982\u6dfb\u52a0\u3001\u5220\u9664\u5143\u7d20\u65f6\uff0c\u66f4\u65b0\u7d22\u5f15\u6d88\u8017\u7684\u65f6\u95f4\u5c31\u662f\u65b0\u589e\u7684\u3002\u4f46\u76f8\u5bf9\u4e8e\u6574\u4f53\u7684\u6536\u76ca\uff0c\u8fd9\u4e9b\u6d88\u8017\u662f\u5fae\u4e0d\u8db3\u9053\u7684\u3002</p>"},{"location":"chap1/4PageCache/","title":"\u7b2c\u56db\u8282 \u78c1\u76d8\u9ad8\u6548\u5730\u4f20\u8f93\u6587\u4ef6\u96f6\u62f7\u8d1d\uff1aPageCache","text":"<p>\u5f53\u7d22\u5f15\u7684\u5927\u5c0f\u8d85\u8fc7\u5185\u5b58\u65f6\uff0c\u5c31\u4f1a\u7528\u78c1\u76d8\u5b58\u653e\u7d22\u5f15\u3002\u78c1\u76d8\u7684\u8bfb\u5199\u901f\u5ea6\u8fdc\u6162\u4e8e\u5185\u5b58\uff0c\u6240\u4ee5\u624d\u9488\u5bf9\u78c1\u76d8\u8bbe\u8ba1\u4e86\u51cf\u5c11\u8bfb\u5199\u6b21\u6570\u7684 B \u6811\u7d22\u5f15\u3002</p> <p>\u78c1\u76d8\u662f\u4e3b\u673a\u4e2d\u6700\u6162\u7684\u786c\u4ef6\u4e4b\u4e00\uff0c\u5e38\u5e38\u662f\u6027\u80fd\u74f6\u9888\uff0c\u6240\u4ee5\u4f18\u5316\u5b83\u80fd\u83b7\u5f97\u7acb\u7aff\u89c1\u5f71\u7684\u6548\u679c\u3002</p> <p>\u9488\u5bf9\u78c1\u76d8\u7684\u4f18\u5316\u6280\u672f\u5c42\u51fa\u4e0d\u7a77\uff0c\u6bd4\u5982\u96f6\u62f7\u8d1d\u3001\u76f4\u63a5 IO\u3001\u5f02\u6b65 IO \u7b49\u7b49\u3002\u8fd9\u4e9b\u4f18\u5316\u6280\u672f\u4e3a\u4e86\u964d\u4f4e\u64cd\u4f5c\u65f6\u5ef6\u3001\u63d0\u5347\u7cfb\u7edf\u7684\u541e\u5410\u91cf\uff0c\u56f4\u7ed5\u7740\u5185\u6838\u4e2d\u7684\u78c1\u76d8\u9ad8\u901f\u7f13\u5b58\uff08\u4e5f\u53eb PageCache\uff09\uff0c\u53bb\u51cf\u5c11 CPU \u548c\u78c1\u76d8\u8bbe\u5907\u7684\u5de5\u4f5c\u91cf\u3002</p>"},{"location":"chap1/4PageCache/#1","title":"1\u3001\u5982\u4f55\u5b9e\u73b0\u6587\u4ef6\u4f20\u8f93\uff1f","text":"<p>\u670d\u52a1\u5668\u63d0\u4f9b\u6587\u4ef6\u4f20\u8f93\u529f\u80fd\uff0c\u9700\u8981\u5c06\u78c1\u76d8\u4e0a\u7684\u6587\u4ef6\u8bfb\u53d6\u51fa\u6765\uff0c\u901a\u8fc7\u7f51\u7edc\u534f\u8bae\u53d1\u9001\u5230\u5ba2\u6237\u7aef\u3002\u5982\u679c\u9700\u8981\u4f60\u81ea\u5df1\u7f16\u7801\u5b9e\u73b0\u8fd9\u4e2a\u6587\u4ef6\u4f20\u8f93\u529f\u80fd\uff0c\u4f60\u4f1a\u600e\u4e48\u5b9e\u73b0\u5462\uff1f</p> <p>\u901a\u5e38\uff0c\u4f60\u4f1a\u9009\u62e9\u6700\u76f4\u63a5\u7684\u65b9\u6cd5\uff1a</p> <p>\u4ece\u7f51\u7edc\u8bf7\u6c42\u4e2d\u627e\u51fa\u6587\u4ef6\u5728\u78c1\u76d8\u4e2d\u7684\u8def\u5f84\u540e\uff0c\u5982\u679c\u8fd9\u4e2a\u6587\u4ef6\u6bd4\u8f83\u5927\uff0c\u5047\u8bbe\u6709 320MB\uff0c\u53ef\u4ee5\u5728\u5185\u5b58\u4e2d\u5206\u914d 32KB \u7684\u7f13\u51b2\u533a\uff0c\u518d\u628a\u6587\u4ef6\u5206\u6210\u4e00\u4e07\u4efd\uff0c\u6bcf\u4efd\u53ea\u6709 32KB\uff0c\u8fd9\u6837\uff0c\u4ece\u6587\u4ef6\u7684\u8d77\u59cb\u4f4d\u7f6e\u8bfb\u5165 32KB \u5230\u7f13\u51b2\u533a\uff0c\u518d\u901a\u8fc7\u7f51\u7edc API \u628a\u8fd9 32KB \u53d1\u9001\u5230\u5ba2\u6237\u7aef\u3002\u63a5\u7740\u91cd\u590d\u4e00\u4e07\u6b21\uff0c\u76f4\u5230\u628a\u5b8c\u6574\u7684\u6587\u4ef6\u90fd\u53d1\u9001\u5b8c\u6bd5\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u4e0d\u8fc7\u8fd9\u4e2a\u65b9\u6848\u6027\u80fd\u5e76\u4e0d\u597d\uff0c\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\u3002</p> <p>\u9996\u5148\uff0c\u5b83\u81f3\u5c11\u7ecf\u5386\u4e86 4 \u4e07\u6b21\u7528\u6237\u6001\u4e0e\u5185\u6838\u6001\u7684\u4e0a\u4e0b\u6587\u5207\u6362\u3002</p> <p>\u56e0\u4e3a\u6bcf\u5904\u7406 32KB \u7684\u6d88\u606f\uff0c\u5c31\u9700\u8981\u4e00\u6b21 read \u8c03\u7528\u548c\u4e00\u6b21 write \u8c03\u7528\uff0c\u6bcf\u6b21\u7cfb\u7edf\u8c03\u7528\u90fd\u5f97\u5148\u4ece\u7528\u6237\u6001\u5207\u6362\u5230\u5185\u6838\u6001\uff0c\u7b49\u5185\u6838\u5b8c\u6210\u4efb\u52a1\u540e\uff0c\u518d\u4ece\u5185\u6838\u6001\u5207\u6362\u56de\u7528\u6237\u6001\u3002\u53ef\u89c1\uff0c\u6bcf\u5904\u7406 32KB\uff0c\u5c31\u6709 4 \u6b21\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u91cd\u590d 1 \u4e07\u6b21\u540e\u5c31\u6709 4 \u4e07\u6b21\u5207\u6362\u3002</p> <p>\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u6210\u672c\u5e76\u4e0d\u5c0f\uff0c\u867d\u7136\u4e00\u6b21\u5207\u6362\u4ec5\u6d88\u8017\u51e0\u5341\u7eb3\u79d2\u5230\u51e0\u5fae\u79d2\uff0c\u4f46\u9ad8\u5e76\u53d1\u670d\u52a1\u4f1a\u653e\u5927\u8fd9\u7c7b\u65f6\u95f4\u7684\u6d88\u8017\u3002</p> <p>\u5176\u6b21\uff0c\u8fd9\u4e2a\u65b9\u6848\u505a\u4e86 4 \u4e07\u6b21\u5185\u5b58\u62f7\u8d1d\uff0c\u5bf9 320MB \u6587\u4ef6\u62f7\u8d1d\u7684\u5b57\u8282\u6570\u4e5f\u7ffb\u4e86 4 \u500d\uff0c\u5230\u4e86 1280MB</p> <p>\u6240\u4ee5\u8981\u60f3\u63d0\u5347\u4f20\u8f93\u6587\u4ef6\u7684\u6027\u80fd\uff0c\u9700\u8981\u4ece\u964d\u4f4e\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u9891\u7387\u548c\u5185\u5b58\u62f7\u8d1d\u6b21\u6570\u4e24\u4e2a\u65b9\u5411\u5165\u624b\u3002</p>"},{"location":"chap1/4PageCache/#2","title":"2\u3001\u96f6\u62f7\u8d1d\u5982\u4f55\u63d0\u5347\u6587\u4ef6\u4f20\u8f93\u6027\u80fd\uff1f","text":""},{"location":"chap1/4PageCache/#2-1","title":"2-1 \u5982\u4f55\u964d\u4f4e\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u9891\u7387","text":"<p>\u4e3a\u4ec0\u4e48\u8bfb\u53d6\u78c1\u76d8\u6587\u4ef6\u65f6\uff0c\u4e00\u5b9a\u8981\u505a\u4e0a\u4e0b\u6587\u5207\u6362\u5462\uff1f</p> <p>\u8fd9\u662f\u56e0\u4e3a\uff0c\u8bfb\u53d6\u78c1\u76d8\u6216\u8005\u64cd\u4f5c\u7f51\u5361\u90fd\u7531\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u5b8c\u6210\u3002\u5185\u6838\u8d1f\u8d23\u7ba1\u7406\u7cfb\u7edf\u4e0a\u7684\u6240\u6709\u8fdb\u7a0b\uff0c\u5b83\u7684\u6743\u9650\u6700\u9ad8\uff0c\u5de5\u4f5c\u73af\u5883\u4e0e\u7528\u6237\u8fdb\u7a0b\u5b8c\u5168\u4e0d\u540c\u3002</p> <p>\u53ea\u8981\u6211\u4eec\u7684\u4ee3\u7801\u6267\u884c read \u6216\u8005 write \u8fd9\u6837\u7684\u7cfb\u7edf\u8c03\u7528\uff0c\u4e00\u5b9a\u4f1a\u53d1\u751f 2 \u6b21\u4e0a\u4e0b\u6587\u5207\u6362\uff1a</p> <ul> <li>\u9996\u5148\u4ece\u7528\u6237\u6001\u5207\u6362\u5230\u5185\u6838\u6001\uff0c\u5f53\u5185\u6838\u6267\u884c\u5b8c\u4efb\u52a1\u540e\uff0c</li> <li>\u518d\u5207\u6362\u56de\u7528\u6237\u6001\u4ea4\u7531\u8fdb\u7a0b\u4ee3\u7801\u6267\u884c\u3002</li> </ul> <p>\u5982\u679c\u60f3\u51cf\u5c11\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\uff0c\u5c31\u4e00\u5b9a\u8981\u51cf\u5c11\u7cfb\u7edf\u8c03\u7528\u7684\u6b21\u6570\u3002\u89e3\u51b3\u65b9\u6848\u5c31\u662f\u628a read\u3001write \u4e24\u6b21\u7cfb\u7edf\u8c03\u7528\u5408\u5e76\u6210\u4e00\u6b21\uff0c\u5728\u5185\u6838\u4e2d\u5b8c\u6210\u78c1\u76d8\u4e0e\u7f51\u5361\u7684\u6570\u636e\u4ea4\u6362\u3002</p>"},{"location":"chap1/4PageCache/#2-2","title":"2-2 \u5982\u4f55\u51cf\u5c11\u5185\u5b58\u62f7\u8d1d\u6b21\u6570","text":"<p>\u6bcf\u5468\u671f\u4e2d\u7684 4 \u6b21\u5185\u5b58\u62f7\u8d1d\uff0c\u5176\u4e2d\u4e0e\u7269\u7406\u8bbe\u5907\u76f8\u5173\u7684 2 \u6b21\u62f7\u8d1d\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\uff0c\u5305\u62ec\uff1a\u628a\u78c1\u76d8\u5185\u5bb9\u62f7\u8d1d\u5230\u5185\u5b58\uff0c\u4ee5\u53ca\u628a\u5185\u5b58\u62f7\u8d1d\u5230\u7f51\u5361\u3002</p> <p>\u4f46\u53e6\u5916 2 \u6b21\u4e0e\u7528\u6237\u7f13\u51b2\u533a\u76f8\u5173\u7684\u62f7\u8d1d\u52a8\u4f5c\u90fd\u4e0d\u662f\u5fc5\u9700\u7684\uff0c\u56e0\u4e3a\u5728\u628a\u78c1\u76d8\u6587\u4ef6\u53d1\u5230\u7f51\u7edc\u7684\u573a\u666f\u4e2d\uff0c\u7528\u6237\u7f13\u51b2\u533a\u6ca1\u6709\u5fc5\u987b\u5b58\u5728\u7684\u7406\u7531\u3002</p> <p>\u5982\u679c\u5185\u6838\u5728\u8bfb\u53d6\u6587\u4ef6\u540e\uff0c\u76f4\u63a5\u628a PageCache \u4e2d\u7684\u5185\u5bb9\u62f7\u8d1d\u5230 Socket \u7f13\u51b2\u533a\uff0c\u5f85\u5230\u7f51\u5361\u53d1\u9001\u5b8c\u6bd5\u540e\uff0c\u518d\u901a\u77e5\u8fdb\u7a0b\uff0c\u8fd9\u6837\u5c31\u53ea\u6709 2 \u6b21\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u548c 3 \u6b21\u5185\u5b58\u62f7\u8d1d\u3002</p> <p></p> <p>\u5982\u679c\u7f51\u5361\u652f\u6301 SG-DMA\uff08The Scatter-Gather Direct Memory Access\uff09\u6280\u672f\uff0c\u8fd8\u53ef\u4ee5\u518d\u53bb\u9664 Socket \u7f13\u51b2\u533a\u7684\u62f7\u8d1d\uff0c\u8fd9\u6837\u4e00\u5171\u53ea\u6709 2 \u6b21\u5185\u5b58\u62f7\u8d1d\u3002</p> <p></p> <p>\u5b9e\u9645\u4e0a\uff0c\u8fd9\u5c31\u662f\u96f6\u62f7\u8d1d\u6280\u672f\u3002</p> <p>\u5b83\u662f\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u65b0\u51fd\u6570\uff0c\u540c\u65f6\u63a5\u6536\u6587\u4ef6\u63cf\u8ff0\u7b26\u548c TCP socket \u4f5c\u4e3a\u8f93\u5165\u53c2\u6570\uff0c\u8fd9\u6837\u6267\u884c\u65f6\u5c31\u53ef\u4ee5\u5b8c\u5168\u5728\u5185\u6838\u6001\u5b8c\u6210\u5185\u5b58\u62f7\u8d1d\uff0c\u65e2\u51cf\u5c11\u4e86\u5185\u5b58\u62f7\u8d1d\u6b21\u6570\uff0c\u4e5f\u964d\u4f4e\u4e86\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\u3002</p> <p>\u800c\u4e14\uff0c\u96f6\u62f7\u8d1d\u53d6\u6d88\u4e86\u7528\u6237\u7f13\u51b2\u533a\u540e\uff0c\u4e0d\u53ea\u964d\u4f4e\u4e86\u7528\u6237\u5185\u5b58\u7684\u6d88\u8017\uff0c\u8fd8\u901a\u8fc7\u6700\u5927\u5316\u5229\u7528 socket \u7f13\u51b2\u533a\u4e2d\u7684\u5185\u5b58\uff0c\u95f4\u63a5\u5730\u518d\u4e00\u6b21\u51cf\u5c11\u4e86\u7cfb\u7edf\u8c03\u7528\u7684\u6b21\u6570\uff0c\u4ece\u800c\u5e26\u6765\u4e86\u5927\u5e45\u51cf\u5c11\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\u7684\u673a\u4f1a\uff01</p>"},{"location":"chap1/4PageCache/#3-3-socket","title":"3-3 \u96f6\u62f7\u8d1d\u4f7f\u6211\u4eec\u4e0d\u5fc5\u5173\u5fc3 socket \u7f13\u51b2\u533a\u7684\u5927\u5c0f","text":"<p>\u6bd4\u5982\uff0c\u8c03\u7528\u96f6\u62f7\u8d1d\u53d1\u9001\u65b9\u6cd5\u65f6\uff0c\u5c3d\u53ef\u4ee5\u628a\u53d1\u9001\u5b57\u8282\u6570\u8bbe\u4e3a\u6587\u4ef6\u7684\u6240\u6709\u672a\u53d1\u9001\u5b57\u8282\u6570\uff0c\u4f8b\u5982 320MB\uff0c\u4e5f\u8bb8\u6b64\u65f6 socket \u7f13\u51b2\u533a\u5927\u5c0f\u4e3a 1.4MB\uff0c\u90a3\u4e48\u4e00\u6b21\u6027\u5c31\u4f1a\u53d1\u9001 1.4MB \u5230\u5ba2\u6237\u7aef\uff0c\u800c\u4e0d\u662f\u53ea\u6709 32KB\u3002\u8fd9\u610f\u5473\u7740\u5bf9\u4e8e 1.4MB \u7684 1 \u6b21\u96f6\u62f7\u8d1d\uff0c\u4ec5\u5e26\u6765 2 \u6b21\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u800c\u4e0d\u4f7f\u7528\u96f6\u62f7\u8d1d\u4e14\u7528\u6237\u7f13\u51b2\u533a\u4e3a 32KB \u65f6\uff0c\u7ecf\u5386\u4e86 176 \u6b21\uff084 * 1.4MB/32KB\uff09\u4e0a\u4e0b\u6587\u5207\u6362</p> <p>\u96f6\u62f7\u8d1d\u53ef\u4ee5\u628a\u6027\u80fd\u63d0\u5347\u81f3\u5c11\u4e00\u500d\u4ee5\u4e0a\uff01\u5bf9\u6587\u7ae0\u5f00\u5934\u63d0\u5230\u7684 320MB \u6587\u4ef6\u7684\u4f20\u8f93\uff0c\u5f53 socket \u7f13\u51b2\u533a\u5728 1.4MB \u5de6\u53f3\u65f6\uff0c\u53ea\u9700\u8981 4 \u767e\u591a\u6b21\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u4ee5\u53ca 4 \u767e\u591a\u6b21\u5185\u5b58\u62f7\u8d1d\uff0c\u62f7\u8d1d\u7684\u6570\u636e\u91cf\u4e5f\u4ec5\u6709 640MB\uff0c\u8fd9\u6837\uff0c\u4e0d\u53ea\u8bf7\u6c42\u65f6\u5ef6\u4f1a\u964d\u4f4e\uff0c\u5904\u7406\u6bcf\u4e2a\u8bf7\u6c42\u6d88\u8017\u7684 CPU \u8d44\u6e90\u4e5f\u4f1a\u66f4\u5c11\uff0c\u4ece\u800c\u652f\u6301\u66f4\u591a\u7684\u5e76\u53d1\u8bf7\u6c42\u3002</p>"},{"location":"chap1/4PageCache/#4pagecache","title":"4\u3001PageCache\uff0c\u78c1\u76d8\u9ad8\u901f\u7f13\u5b58","text":"<p>\u8bfb\u53d6\u6587\u4ef6\u65f6\uff0c\u662f\u5148\u628a\u78c1\u76d8\u6587\u4ef6\u62f7\u8d1d\u5230 PageCache \u4e0a\uff0c\u518d\u62f7\u8d1d\u5230\u8fdb\u7a0b\u4e2d\u3002\u4e3a\u4ec0\u4e48\u8fd9\u6837\u505a\u5462\uff1f\u6709\u4e24\u4e2a\u539f\u56e0\u6240\u81f4\u3002</p> <p>\u7b2c\u4e00\uff0c\u7531\u4e8e\u78c1\u76d8\u6bd4\u5185\u5b58\u7684\u901f\u5ea6\u6162\u8bb8\u591a\uff0c\u6240\u4ee5\u6211\u4eec\u5e94\u8be5\u60f3\u529e\u6cd5\u628a\u8bfb\u5199\u78c1\u76d8\u66ff\u6362\u6210\u8bfb\u5199\u5185\u5b58\uff0c\u6bd4\u5982\u628a\u78c1\u76d8\u4e2d\u7684\u6570\u636e\u590d\u5236\u5230\u5185\u5b58\u4e2d\uff0c\u5c31\u53ef\u4ee5\u7528\u8bfb\u5185\u5b58\u66ff\u6362\u8bfb\u78c1\u76d8\u3002\u4f46\u662f\uff0c\u5185\u5b58\u7a7a\u95f4\u8fdc\u6bd4\u78c1\u76d8\u8981\u5c0f\uff0c\u5185\u5b58\u4e2d\u6ce8\u5b9a\u53ea\u80fd\u590d\u5236\u4e00\u5c0f\u90e8\u5206\u78c1\u76d8\u4e2d\u7684\u6570\u636e\u3002</p> <p>\u9009\u62e9\u54ea\u4e9b\u6570\u636e\u590d\u5236\u5230\u5185\u5b58\u5462\uff1f\u901a\u5e38\uff0c\u521a\u88ab\u8bbf\u95ee\u7684\u6570\u636e\u5728\u77ed\u65f6\u95f4\u5185\u518d\u6b21\u88ab\u8bbf\u95ee\u7684\u6982\u7387\u5f88\u9ad8\uff08\u8fd9\u4e5f\u53eb\u201c\u65f6\u95f4\u5c40\u90e8\u6027\u201d\u539f\u7406\uff09\uff0c\u7528 PageCache \u7f13\u5b58\u6700\u8fd1\u8bbf\u95ee\u7684\u6570\u636e\uff0c\u5f53\u7a7a\u95f4\u4e0d\u8db3\u65f6\u6dd8\u6c70\u6700\u4e45\u672a\u88ab\u8bbf\u95ee\u7684\u7f13\u5b58\uff08\u5373 LRU \u7b97\u6cd5\uff09\u3002\u8bfb\u78c1\u76d8\u65f6\u4f18\u5148\u5230 PageCache \u4e2d\u627e\u4e00\u627e\uff0c\u5982\u679c\u6570\u636e\u5b58\u5728\u4fbf\u76f4\u63a5\u8fd4\u56de\uff0c\u8fd9\u4fbf\u5927\u5927\u63d0\u5347\u4e86\u8bfb\u78c1\u76d8\u7684\u6027\u80fd\u3002</p> <p>\u7b2c\u4e8c\uff0c\u8bfb\u53d6\u78c1\u76d8\u6570\u636e\u65f6\uff0c\u9700\u8981\u5148\u627e\u5230\u6570\u636e\u6240\u5728\u7684\u4f4d\u7f6e\uff0c\u5bf9\u4e8e\u673a\u68b0\u78c1\u76d8\u6765\u8bf4\uff0c\u5c31\u662f\u65cb\u8f6c\u78c1\u5934\u5230\u6570\u636e\u6240\u5728\u7684\u6247\u533a\uff0c\u518d\u5f00\u59cb\u987a\u5e8f\u8bfb\u53d6\u6570\u636e\u3002\u5176\u4e2d\uff0c\u65cb\u8f6c\u78c1\u5934\u8017\u65f6\u5f88\u957f\uff0c\u4e3a\u4e86\u964d\u4f4e\u5b83\u7684\u5f71\u54cd\uff0cPageCache \u4f7f\u7528\u4e86\u9884\u8bfb\u529f\u80fd\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u867d\u7136 read \u65b9\u6cd5\u53ea\u8bfb\u53d6\u4e86 0-32KB \u7684\u5b57\u8282\uff0c\u4f46\u5185\u6838\u4f1a\u628a\u5176\u540e\u7684 32-64KB \u4e5f\u8bfb\u53d6\u5230 PageCache\uff0c\u8fd9\u540e 32KB \u8bfb\u53d6\u7684\u6210\u672c\u5f88\u4f4e\u3002\u5982\u679c\u5728 32-64KB \u6dd8\u6c70\u51fa PageCache \u524d\uff0c\u8fdb\u7a0b\u8bfb\u53d6\u5230\u5b83\u4e86\uff0c\u6536\u76ca\u5c31\u975e\u5e38\u5927</p> <p>\u4ece\u8fd9\u4e24\u70b9\u53ef\u4ee5\u770b\u5230 PageCache \u7684\u4f18\u70b9\uff0c\u5b83\u5728 90% \u4ee5\u4e0a\u573a\u666f\u4e0b\u90fd\u4f1a\u63d0\u5347\u78c1\u76d8\u6027\u80fd\uff0c\u4f46\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0cPageCache \u4f1a\u4e0d\u8d77\u4f5c\u7528\uff0c\u751a\u81f3\u7531\u4e8e\u591a\u505a\u4e86\u4e00\u6b21\u5185\u5b58\u62f7\u8d1d\uff0c\u9020\u6210\u6027\u80fd\u7684\u964d\u4f4e\u3002\u5728\u8fd9\u4e9b\u573a\u666f\u4e2d\uff0c\u4f7f\u7528\u4e86 PageCache \u7684\u96f6\u62f7\u8d1d\u4e5f\u4f1a\u635f\u5931\u6027\u80fd\u3002</p> <p>\u5c31\u662f\u5728\u4f20\u8f93\u5927\u6587\u4ef6\u7684\u65f6\u5019\u3002\u6bd4\u5982\uff0c\u4f60\u6709\u5f88\u591a GB \u7ea7\u7684\u6587\u4ef6\u9700\u8981\u4f20\u8f93\uff0c\u6bcf\u5f53\u7528\u6237\u8bbf\u95ee\u8fd9\u4e9b\u5927\u6587\u4ef6\u65f6\uff0c\u5185\u6838\u5c31\u4f1a\u628a\u5b83\u4eec\u8f7d\u5165\u5230 PageCache \u4e2d\uff0c\u8fd9\u4e9b\u5927\u6587\u4ef6\u5f88\u5feb\u4f1a\u628a\u6709\u9650\u7684 PageCache \u5360\u6ee1\u3002</p> <p>\u7136\u800c\uff0c\u7531\u4e8e\u6587\u4ef6\u592a\u5927\uff0c\u6587\u4ef6\u4e2d\u67d0\u4e00\u90e8\u5206\u5185\u5bb9\u88ab\u518d\u6b21\u8bbf\u95ee\u5230\u7684\u6982\u7387\u5176\u5b9e\u975e\u5e38\u4f4e\u3002\u8fd9\u5e26\u6765\u4e86 2 \u4e2a\u95ee\u9898\uff1a\u9996\u5148\uff0c\u7531\u4e8e PageCache \u957f\u671f\u88ab\u5927\u6587\u4ef6\u5360\u636e\uff0c\u70ed\u70b9\u5c0f\u6587\u4ef6\u5c31\u65e0\u6cd5\u5145\u5206\u4f7f\u7528 PageCache\uff0c\u5b83\u4eec\u8bfb\u8d77\u6765\u53d8\u6162\u4e86\uff1b\u5176\u6b21\uff0cPageCache \u4e2d\u7684\u5927\u6587\u4ef6\u6ca1\u6709\u4eab\u53d7\u5230\u7f13\u5b58\u7684\u597d\u5904\uff0c\u4f46\u5374\u8017\u8d39 CPU\uff08\u6216\u8005 DMA\uff09\u591a\u62f7\u8d1d\u5230 PageCache \u4e00\u6b21\u3002</p> <p>\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\uff0c\u4e3a\u4e86\u9632\u6b62 PageCache \u88ab\u5927\u6587\u4ef6\u5360\u6ee1\u540e\u4e0d\u518d\u5bf9\u5c0f\u6587\u4ef6\u4ea7\u751f\u4f5c\u7528\uff0c\u5927\u6587\u4ef6\u4e0d\u5e94\u4f7f\u7528 PageCache\uff0c\u8fdb\u800c\u4e5f\u4e0d\u5e94\u4f7f\u7528\u96f6\u62f7\u8d1d\u6280\u672f\u5904\u7406\u3002</p>"},{"location":"chap1/4PageCache/#5-io-io","title":"5\u3001\u5f02\u6b65 IO + \u76f4\u63a5 IO","text":"<p>\u9ad8\u5e76\u53d1\u573a\u666f\u5904\u7406\u5927\u6587\u4ef6\u65f6\uff0c\u5e94\u5f53\u4f7f\u7528\u5f02\u6b65 IO \u548c\u76f4\u63a5 IO \u6765\u66ff\u6362\u96f6\u62f7\u8d1d\u6280\u672f\u3002</p> <p>\u5f53\u8c03\u7528 read \u65b9\u6cd5\u8bfb\u53d6\u6587\u4ef6\u65f6\uff0c\u5b9e\u9645\u4e0a read \u65b9\u6cd5\u4f1a\u5728\u78c1\u76d8\u5bfb\u5740\u8fc7\u7a0b\u4e2d\u963b\u585e\u7b49\u5f85\uff0c\u5bfc\u81f4\u8fdb\u7a0b\u65e0\u6cd5\u5e76\u53d1\u5730\u5904\u7406\u5176\u4ed6\u4efb\u52a1\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u5f02\u6b65 IO \u5e76\u6ca1\u6709\u62f7\u8d1d\u5230 PageCache \u4e2d\uff0c\u8fd9\u5176\u5b9e\u662f\u5f02\u6b65 IO \u5b9e\u73b0\u4e0a\u7684\u7f3a\u9677\u3002\u7ecf\u8fc7 PageCache \u7684 IO \u6211\u4eec\u79f0\u4e3a\u7f13\u5b58 IO\uff0c\u5b83\u4e0e\u865a\u62df\u5185\u5b58\u7cfb\u7edf\u8026\u5408\u592a\u7d27\uff0c\u5bfc\u81f4\u5f02\u6b65 IO \u4ece\u8bde\u751f\u8d77\u5230\u73b0\u5728\u90fd\u4e0d\u652f\u6301\u7f13\u5b58 IO\u3002</p> <p>\u7ed5\u8fc7 PageCache \u7684 IO \u662f\u4e2a\u65b0\u7269\u79cd\uff0c\u6211\u4eec\u628a\u5b83\u79f0\u4e3a\u76f4\u63a5 IO\u3002\u5bf9\u4e8e\u78c1\u76d8\uff0c\u5f02\u6b65 IO \u53ea\u652f\u6301\u76f4\u63a5 IO\u3002</p> <p>\u76f4\u63a5 IO \u7684\u5e94\u7528\u573a\u666f\u5e76\u4e0d\u591a\uff0c\u4e3b\u8981\u6709\u4e24\u79cd\uff1a</p> <ul> <li>\u7b2c\u4e00\uff0c\u5e94\u7528\u7a0b\u5e8f\u5df2\u7ecf\u5b9e\u73b0\u4e86\u78c1\u76d8\u6587\u4ef6\u7684\u7f13\u5b58\uff0c\u4e0d\u9700\u8981 PageCache \u518d\u6b21\u7f13\u5b58\uff0c\u5f15\u53d1\u989d\u5916\u7684\u6027\u80fd\u6d88\u8017\u3002\u6bd4\u5982 MySQL \u7b49\u6570\u636e\u5e93\u5c31\u4f7f\u7528\u76f4\u63a5 IO\uff1b</li> <li>\u7b2c\u4e8c\uff0c\u9ad8\u5e76\u53d1\u4e0b\u4f20\u8f93\u5927\u6587\u4ef6\uff0c\u6211\u4eec\u4e0a\u6587\u63d0\u5230\u8fc7\uff0c\u5927\u6587\u4ef6\u96be\u4ee5\u547d\u4e2d PageCache \u7f13\u5b58\uff0c\u53c8\u5e26\u6765\u989d\u5916\u7684\u5185\u5b58\u62f7\u8d1d\uff0c\u540c\u65f6\u8fd8\u6324\u5360\u4e86\u5c0f\u6587\u4ef6\u4f7f\u7528 PageCache \u65f6\u9700\u8981\u7684\u5185\u5b58\uff0c\u56e0\u6b64\uff0c\u8fd9\u65f6\u5e94\u8be5\u4f7f\u7528\u76f4\u63a5 IO\u3002</li> </ul> <p>\u5f53\u7136\uff0c\u76f4\u63a5 IO \u4e5f\u6709\u4e00\u5b9a\u7684\u7f3a\u70b9\u3002</p> <ul> <li>\u9664\u4e86\u7f13\u5b58\u5916\uff0c\u5185\u6838\uff08IO \u8c03\u5ea6\u7b97\u6cd5\uff09\u4f1a\u8bd5\u56fe\u7f13\u5b58\u5c3d\u91cf\u591a\u7684\u8fde\u7eed IO \u5728 PageCache \u4e2d\uff0c\u6700\u540e\u5408\u5e76\u6210\u4e00\u4e2a\u66f4\u5927\u7684 IO \u518d\u53d1\u7ed9\u78c1\u76d8\uff0c\u8fd9\u6837\u53ef\u4ee5\u51cf\u5c11\u78c1\u76d8\u7684\u5bfb\u5740\u64cd\u4f5c\uff1b</li> <li>\u53e6\u5916\uff0c\u5185\u6838\u4e5f\u4f1a\u9884\u8bfb\u540e\u7eed\u7684 IO \u653e\u5728 PageCache \u4e2d\uff0c\u51cf\u5c11\u78c1\u76d8\u64cd\u4f5c\u3002\u76f4\u63a5 IO \u7ed5\u8fc7\u4e86 PageCache\uff0c\u6240\u4ee5\u65e0\u6cd5\u4eab\u53d7\u8fd9\u4e9b\u6027\u80fd\u63d0\u5347\u3002</li> </ul> <p>\u6709\u4e86\u76f4\u63a5 IO \u540e\uff0c\u5f02\u6b65 IO \u5c31\u53ef\u4ee5\u65e0\u963b\u585e\u5730\u8bfb\u53d6\u6587\u4ef6\u4e86\u3002\u73b0\u5728\uff0c\u5927\u6587\u4ef6\u7531\u5f02\u6b65 IO \u548c\u76f4\u63a5 IO \u5904\u7406\uff0c\u5c0f\u6587\u4ef6\u5219\u4ea4\u7531\u96f6\u62f7\u8d1d\u5904\u7406\uff0c\u81f3\u4e8e\u5224\u65ad\u6587\u4ef6\u5927\u5c0f\u7684\u9608\u503c\u53ef\u4ee5\u7075\u6d3b\u914d\u7f6e</p>"},{"location":"chap1/4PageCache/#6","title":"6\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u57fa\u4e8e\u7528\u6237\u7f13\u51b2\u533a\u4f20\u8f93\u6587\u4ef6\u65f6\uff0c\u8fc7\u591a\u7684\u5185\u5b58\u62f7\u8d1d\u4e0e\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\u4f1a\u964d\u4f4e\u6027\u80fd\u3002</p> <p>\u96f6\u62f7\u8d1d\u6280\u672f\u5728\u5185\u6838\u4e2d\u5b8c\u6210\u5185\u5b58\u62f7\u8d1d\uff0c\u5929\u7136\u964d\u4f4e\u4e86\u5185\u5b58\u62f7\u8d1d\u6b21\u6570\u3002\u5b83\u901a\u8fc7\u4e00\u6b21\u7cfb\u7edf\u8c03\u7528\u5408\u5e76\u4e86\u78c1\u76d8\u8bfb\u53d6\u4e0e\u7f51\u7edc\u53d1\u9001\u4e24\u4e2a\u64cd\u4f5c\uff0c\u964d\u4f4e\u4e86\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\u3002\u5c24\u5176\u662f\uff0c\u7531\u4e8e\u62f7\u8d1d\u5728\u5185\u6838\u4e2d\u5b8c\u6210\uff0c\u5b83\u53ef\u4ee5\u6700\u5927\u5316\u4f7f\u7528 socket \u7f13\u51b2\u533a\u7684\u53ef\u7528\u7a7a\u95f4\uff0c\u4ece\u800c\u63d0\u9ad8\u4e86\u4e00\u6b21\u7cfb\u7edf\u8c03\u7528\u4e2d\u5904\u7406\u7684\u6570\u636e\u91cf\uff0c\u8fdb\u4e00\u6b65\u964d\u4f4e\u4e86\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\u3002</p> <p>\u96f6\u62f7\u8d1d\u6280\u672f\u57fa\u4e8e PageCache\uff0c\u800c PageCache \u7f13\u5b58\u4e86\u6700\u8fd1\u8bbf\u95ee\u8fc7\u7684\u6570\u636e\uff0c\u63d0\u5347\u4e86\u8bbf\u95ee\u7f13\u5b58\u6570\u636e\u7684\u6027\u80fd\uff0c\u540c\u65f6\uff0c\u4e3a\u4e86\u89e3\u51b3\u673a\u68b0\u78c1\u76d8\u5bfb\u5740\u6162\u7684\u95ee\u9898\uff0c\u5b83\u8fd8\u534f\u52a9 IO \u8c03\u5ea6\u7b97\u6cd5\u5b9e\u73b0\u4e86 IO \u5408\u5e76\u4e0e\u9884\u8bfb\uff08\u8fd9\u4e5f\u662f\u987a\u5e8f\u8bfb\u6bd4\u968f\u673a\u8bfb\u6027\u80fd\u597d\u7684\u539f\u56e0\uff09\uff0c\u8fd9\u8fdb\u4e00\u6b65\u63d0\u5347\u4e86\u96f6\u62f7\u8d1d\u7684\u6027\u80fd\u3002\u51e0\u4e4e\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\u90fd\u652f\u6301\u96f6\u62f7\u8d1d\uff0c\u5982\u679c\u5e94\u7528\u573a\u666f\u5c31\u662f\u628a\u6587\u4ef6\u53d1\u9001\u5230\u7f51\u7edc\u4e2d\uff0c\u90a3\u4e48\u6211\u4eec\u5e94\u5f53\u9009\u62e9\u4f7f\u7528\u4e86\u96f6\u62f7\u8d1d\u7684\u89e3\u51b3\u65b9\u6848\u3002</p> <p>\u4e0d\u8fc7\uff0c\u96f6\u62f7\u8d1d\u6709\u4e00\u4e2a\u7f3a\u70b9\uff0c\u5c31\u662f\u4e0d\u5141\u8bb8\u8fdb\u7a0b\u5bf9\u6587\u4ef6\u5185\u5bb9\u4f5c\u4e00\u4e9b\u52a0\u5de5\u518d\u53d1\u9001\uff0c\u6bd4\u5982\u6570\u636e\u538b\u7f29\u540e\u518d\u53d1\u9001\u3002\u53e6\u5916\uff0c\u5f53 PageCache \u5f15\u53d1\u8d1f\u4f5c\u7528\u65f6\uff0c\u4e5f\u4e0d\u80fd\u4f7f\u7528\u96f6\u62f7\u8d1d\uff0c\u6b64\u65f6\u53ef\u4ee5\u7528\u5f02\u6b65 IO+ \u76f4\u63a5 IO \u66ff\u6362\u3002\u6211\u4eec\u901a\u5e38\u4f1a\u8bbe\u5b9a\u4e00\u4e2a\u6587\u4ef6\u5927\u5c0f\u9608\u503c\uff0c\u9488\u5bf9\u5927\u6587\u4ef6\u4f7f\u7528\u5f02\u6b65 IO \u548c\u76f4\u63a5 IO\uff0c\u800c\u5bf9\u5c0f\u6587\u4ef6\u4f7f\u7528\u96f6\u62f7\u8d1d\u3002</p> <p>\u4e8b\u5b9e\u4e0a PageCache \u5bf9\u5199\u64cd\u4f5c\u4e5f\u6709\u5f88\u5927\u7684\u6027\u80fd\u63d0\u5347\uff0c\u56e0\u4e3a write \u65b9\u6cd5\u5728\u5199\u5165\u5185\u5b58\u4e2d\u7684 PageCache \u540e\u5c31\u4f1a\u8fd4\u56de\uff0c\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u7531\u5185\u6838\u8d1f\u8d23\u5f02\u6b65\u5730\u628a PageCache \u5237\u65b0\u5230\u78c1\u76d8\u4e2d\uff0c\u8fd9\u91cc\u4e0d\u518d\u5c55\u5f00\u3002</p> <p>\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\uff0c\u4e3a\u4e86\u9632\u6b62 PageCache \u88ab\u5927\u6587\u4ef6\u5360\u6ee1\u540e\u4e0d\u518d\u5bf9\u5c0f\u6587\u4ef6\u4ea7\u751f\u4f5c\u7528\uff0c\u5927\u6587\u4ef6\u4e0d\u5e94\u4f7f\u7528 PageCache\uff0c\u8fdb\u800c\u4e5f\u4e0d\u5e94\u4f7f\u7528\u96f6\u62f7\u8d1d\u6280\u672f\u5904\u7406\u3002</p> <p>\u8fd9\u91cc\u9762\u7684\u6027\u80fd\u4f18\u5316\u6280\u672f\uff0c\u8981\u4e48\u51cf\u5c11\u4e86\u78c1\u76d8\u7684\u5de5\u4f5c\u91cf\uff08\u6bd4\u5982 PageCache \u7f13\u5b58\uff09\uff0c\u8981\u4e48\u51cf\u5c11\u4e86 CPU \u7684\u5de5\u4f5c\u91cf\uff08\u6bd4\u5982\u76f4\u63a5 IO\uff09\uff0c\u8981\u4e48\u63d0\u9ad8\u4e86\u5185\u5b58\u7684\u5229\u7528\u7387\uff08\u6bd4\u5982\u96f6\u62f7\u8d1d\uff09\u3002</p> <p>\u9ad8\u5e76\u53d1\u573a\u666f\u5904\u7406\u5927\u6587\u4ef6\u65f6\uff0c\u5e94\u5f53\u4f7f\u7528\u5f02\u6b65 IO \u548c\u76f4\u63a5 IO \u6765\u66ff\u6362\u96f6\u62f7\u8d1d\u6280\u672f\u3002</p>"},{"location":"chap1/5Coroutine/","title":"\u7b2c\u4e94\u8282 \u534f\u7a0b\u5feb\u901f\u5730\u5b9e\u73b0\u9ad8\u5e76\u53d1\u670d\u52a1\uff1aCoroutine","text":"<p>\u5982\u679c\u4f60\u9700\u8981\u8bbf\u95ee\u591a\u4e2a\u670d\u52a1\u6765\u5b8c\u6210\u4e00\u4e2a\u8bf7\u6c42\u7684\u5904\u7406\uff0c\u6bd4\u5982\u5b9e\u73b0\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\u65f6\uff0c</p> <ul> <li>\u9996\u5148\u8bbf\u95ee Redis \u7f13\u5b58\uff0c\u9a8c\u8bc1\u7528\u6237\u662f\u5426\u767b\u9646\uff0c</li> <li>\u518d\u63a5\u6536 HTTP \u6d88\u606f\u4e2d\u7684 body \u5e76\u4fdd\u5b58\u5728\u78c1\u76d8\u4e0a\uff0c</li> <li>\u6700\u540e\u628a\u6587\u4ef6\u8def\u5f84\u7b49\u4fe1\u606f\u5199\u5165 MySQL \u6570\u636e\u5e93\u4e2d</li> </ul> <p>\u7528\u963b\u585e API \u5199\u540c\u6b65\u4ee3\u7801\u6700\u7b80\u5355\uff0c\u4f46\u4e00\u4e2a\u7ebf\u7a0b\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\uff0c\u6709\u9650\u7684\u7ebf\u7a0b\u6570\u5bfc\u81f4\u65e0\u6cd5\u5b9e\u73b0\u4e07\u7ea7\u522b\u7684\u5e76\u53d1\u8fde\u63a5\uff0c\u8fc7\u591a\u7684\u7ebf\u7a0b\u5207\u6362\u4e5f\u62a2\u8d70\u4e86 CPU \u7684\u65f6\u95f4\uff0c\u4ece\u800c\u964d\u4f4e\u4e86\u6bcf\u79d2\u80fd\u591f\u5904\u7406\u7684\u8bf7\u6c42\u6570\u91cf\u3002</p> <p>\u4e3a\u4e86\u8fbe\u5230\u9ad8\u5e76\u53d1\uff0c\u53ef\u80fd\u4f1a\u9009\u62e9\u4e00\u4e2a\u5f02\u6b65\u6846\u67b6\uff0c\u7528\u975e\u963b\u585e API \u628a\u4e1a\u52a1\u903b\u8f91\u6253\u4e71\u5230\u591a\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\u901a\u8fc7\u591a\u8def\u590d\u7528\u5b9e\u73b0\u9ad8\u5e76\u53d1\uff0c\u7136\u800c\uff0c\u7531\u4e8e\u4e1a\u52a1\u4ee3\u7801\u8fc7\u5ea6\u5173\u6ce8\u5e76\u53d1\u7ec6\u8282\uff0c\u9700\u8981\u7ef4\u62a4\u5f88\u591a\u4e2d\u95f4\u72b6\u6001\uff0c\u4e0d\u4f46 Bug \u7387\u4f1a\u5f88\u9ad8\uff0c\u9879\u76ee\u7684\u5f00\u53d1\u901f\u5ea6\u4e5f\u4e0a\u4e0d\u53bb\uff0c\u4ea7\u54c1\u53ca\u65f6\u4e0a\u7ebf\u5b58\u5728\u98ce\u9669\u3002</p> <p>\u5982\u679c\u60f3\u517c\u987e\u5f00\u53d1\u6548\u7387\uff0c\u53c8\u80fd\u4fdd\u8bc1\u9ad8\u5e76\u53d1\uff0c\u534f\u7a0b\u5c31\u662f\u6700\u597d\u7684\u9009\u62e9\u3002\u5b83\u53ef\u4ee5\u5728\u4fdd\u6301\u5f02\u6b65\u5316\u8fd0\u884c\u673a\u5236\u7684\u540c\u65f6\uff0c\u7528\u540c\u6b65\u65b9\u5f0f\u5199\u4ee3\u7801\uff0c\u8fd9\u5728\u5b9e\u73b0\u9ad8\u5e76\u53d1\u7684\u540c\u65f6\uff0c\u7f29\u77ed\u4e86\u5f00\u53d1\u5468\u671f\uff0c\u662f\u9ad8\u6027\u80fd\u670d\u52a1\u672a\u6765\u7684\u53d1\u5c55\u65b9\u5411\u3002</p> <p>\u534f\u7a0b\u5c31\u662f\u7528\u6237\u6001\u7684\u7ebf\u7a0b</p>"},{"location":"chap1/5Coroutine/#1","title":"1\u3001\u5982\u4f55\u901a\u8fc7\u5207\u6362\u8bf7\u6c42\u5b9e\u73b0\u9ad8\u5e76\u53d1\uff1f","text":""},{"location":"chap1/5Coroutine/#1-1","title":"1-1 \u7ebf\u7a0b&amp;\u8fdb\u7a0b\u7684\u9ad8\u5e76\u53d1","text":"<p>\u4e3b\u673a\u4e0a\u8d44\u6e90\u6709\u9650\uff0c\u4e00\u9897 CPU\u3001\u4e00\u5757\u78c1\u76d8\u3001\u4e00\u5f20\u7f51\u5361\uff0c\u5982\u4f55\u540c\u65f6\u670d\u52a1\u4e0a\u767e\u4e2a\u8bf7\u6c42\u5462\uff1f</p> <p>\u591a\u8fdb\u7a0b\u6a21\u5f0f\u662f\u6700\u521d\u7684\u89e3\u51b3\u65b9\u6848\u3002\u5185\u6838\u628a CPU \u7684\u6267\u884c\u65f6\u95f4\u5207\u5206\u6210\u8bb8\u591a\u65f6\u95f4\u7247\uff08timeslice\uff09\uff0c\u6bd4\u5982 1 \u79d2\u949f\u53ef\u4ee5\u5207\u5206\u4e3a 100 \u4e2a 10 \u6beb\u79d2\u7684\u65f6\u95f4\u7247\uff0c\u6bcf\u4e2a\u65f6\u95f4\u7247\u518d\u5206\u53d1\u7ed9\u4e0d\u540c\u7684\u8fdb\u7a0b\uff0c\u901a\u5e38\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u9700\u8981\u591a\u4e2a\u65f6\u95f4\u7247\u624d\u80fd\u5b8c\u6210\u4e00\u4e2a\u8bf7\u6c42\u3002</p> <p>\u867d\u7136\u5fae\u89c2\u4e0a\uff0c\u6bd4\u5982\u8bf4\u5c31\u8fd9 10 \u6beb\u79d2\u65f6\u95f4 CPU \u53ea\u80fd\u6267\u884c\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u4f46\u5b8f\u89c2\u4e0a 1 \u79d2\u949f\u6267\u884c\u4e86 100 \u4e2a\u65f6\u95f4\u7247\uff0c\u4e8e\u662f\u6bcf\u4e2a\u65f6\u95f4\u7247\u6240\u5c5e\u8fdb\u7a0b\u4e2d\u7684\u8bf7\u6c42\u4e5f\u5f97\u5230\u4e86\u6267\u884c\uff0c\u8fd9\u5c31\u5b9e\u73b0\u4e86\u8bf7\u6c42\u7684\u5e76\u53d1\u6267\u884c\u3002</p> <p>\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u5185\u5b58\u7a7a\u95f4\u90fd\u662f\u72ec\u7acb\u7684\uff0c\u8fd9\u6837\u7528\u591a\u8fdb\u7a0b\u5b9e\u73b0\u5e76\u53d1\u5c31\u6709\u4e24\u4e2a\u7f3a\u70b9\uff1a</p> <ul> <li>\u4e00\u662f\u5185\u6838\u7684\u7ba1\u7406\u6210\u672c\u9ad8\uff0c</li> <li>\u4e8c\u662f\u65e0\u6cd5\u7b80\u5355\u5730\u901a\u8fc7\u5185\u5b58\u540c\u6b65\u6570\u636e\uff0c\u5f88\u4e0d\u65b9\u4fbf\u3002</li> </ul> <p>\u4e8e\u662f\uff0c\u591a\u7ebf\u7a0b\u6a21\u5f0f\u5c31\u51fa\u73b0\u4e86\uff0c\u591a\u7ebf\u7a0b\u6a21\u5f0f\u901a\u8fc7\u5171\u4eab\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff0c\u89e3\u51b3\u4e86\u8fd9\u4e24\u4e2a\u95ee\u9898\u3002</p> <p>\u5171\u4eab\u5730\u5740\u7a7a\u95f4\u867d\u7136\u53ef\u4ee5\u65b9\u4fbf\u5730\u5171\u4eab\u5bf9\u8c61\uff0c\u4f46\u8fd9\u4e5f\u5bfc\u81f4\u4e00\u4e2a\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u4efb\u4f55\u4e00\u4e2a\u7ebf\u7a0b\u51fa\u9519\u65f6\uff0c\u8fdb\u7a0b\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u4f1a\u8ddf\u7740\u4e00\u8d77\u5d29\u6e83\u3002\u8fd9\u4e5f\u662f\u5982 Nginx \u7b49\u5f3a\u8c03\u7a33\u5b9a\u6027\u7684\u670d\u52a1\u575a\u6301\u4f7f\u7528\u591a\u8fdb\u7a0b\u6a21\u5f0f\u7684\u539f\u56e0\u3002</p> <p>\u65e0\u8bba\u57fa\u4e8e\u591a\u8fdb\u7a0b\u8fd8\u662f\u591a\u7ebf\u7a0b\uff0c\u90fd\u96be\u4ee5\u5b9e\u73b0\u9ad8\u5e76\u53d1\uff0c\u8fd9\u7531\u4e24\u4e2a\u539f\u56e0\u6240\u81f4\u3002</p> <ul> <li>\u9996\u5148\uff0c\u5355\u4e2a\u7ebf\u7a0b\u6d88\u8017\u7684\u5185\u5b58\u8fc7\u591a\uff0c\u6bd4\u5982\uff0c64 \u4f4d\u7684 Linux \u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u6808\u5206\u914d\u4e86 8MB \u7684\u5185\u5b58\uff0c\u8fd8\u9884\u5206\u914d\u4e86 64MB \u7684\u5185\u5b58\u4f5c\u4e3a\u5806\u5185\u5b58\u6c60 \u6240\u4ee5\uff0c\u6211\u4eec\u6ca1\u6709\u8db3\u591f\u7684\u5185\u5b58\u53bb\u5f00\u542f\u51e0\u4e07\u4e2a\u7ebf\u7a0b\u5b9e\u73b0\u5e76\u53d1\u3002</li> <li>\u5207\u6362\u8bf7\u6c42\u662f\u5185\u6838\u901a\u8fc7\u5207\u6362\u7ebf\u7a0b\u5b9e\u73b0\u7684\uff0c\u4ec0\u4e48\u65f6\u5019\u4f1a\u5207\u6362\u7ebf\u7a0b\u5462\uff1f<ul> <li>\u4e0d\u53ea\u65f6\u95f4\u7247\u7528\u5c3d\uff0c\u5f53\u8c03\u7528\u963b\u585e\u65b9\u6cd5\u65f6\uff0c\u5185\u6838\u4e3a\u4e86\u8ba9 CPU \u5145\u5206\u5de5\u4f5c\uff0c\u4e5f\u4f1a\u5207\u6362\u5230\u5176\u4ed6\u7ebf\u7a0b\u6267\u884c\u3002\u4e00\u6b21\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u6210\u672c\u5728\u51e0\u5341\u7eb3\u79d2\u5230\u51e0\u5fae\u79d2\u95f4\uff0c\u5f53\u7ebf\u7a0b\u7e41\u5fd9\u4e14\u6570\u91cf\u4f17\u591a\u65f6\uff0c\u8fd9\u4e9b\u5207\u6362\u4f1a\u6d88\u8017\u7edd\u5927\u90e8\u5206\u7684 CPU \u8fd0\u7b97\u80fd\u529b\u3002</li> </ul> </li> </ul> <p>2 \u4e2a\u7ebf\u7a0b\u95f4\u7684\u5207\u6362\u65b9\u5f0f\u3002</p> <p></p>"},{"location":"chap1/5Coroutine/#1-2","title":"1-2 \u600e\u4e48\u624d\u80fd\u5b9e\u73b0\u9ad8\u5e76\u53d1\u5462\uff1f","text":"<p>\u628a\u4e0a\u56fe\u4e2d\u672c\u6765\u7531\u5185\u6838\u5b9e\u73b0\u7684\u8bf7\u6c42\u5207\u6362\u5de5\u4f5c\uff0c\u4ea4\u7531\u7528\u6237\u6001\u7684\u4ee3\u7801\u6765\u5b8c\u6210\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u5f02\u6b65\u5316\u7f16\u7a0b\u901a\u8fc7\u5e94\u7528\u5c42\u4ee3\u7801\u5b9e\u73b0\u4e86\u8bf7\u6c42\u5207\u6362\uff0c\u964d\u4f4e\u4e86\u5207\u6362\u6210\u672c\u548c\u5185\u5b58\u5360\u7528\u7a7a\u95f4\u3002</p> <p>\u5f02\u6b65\u5316\u4f9d\u8d56\u4e8e IO \u591a\u8def\u590d\u7528\u673a\u5236\uff0c\u6bd4\u5982 Linux \u7684 epoll \u6216\u8005 Windows \u4e0a\u7684 iocp\uff0c\u540c\u65f6\uff0c\u5fc5\u987b\u628a\u963b\u585e\u65b9\u6cd5\u66f4\u6539\u4e3a\u975e\u963b\u585e\u65b9\u6cd5\uff0c\u624d\u80fd\u907f\u514d\u5185\u6838\u5207\u6362\u5e26\u6765\u7684\u5de8\u5927\u6d88\u8017\u3002Nginx\u3001Redis \u7b49\u9ad8\u6027\u80fd\u670d\u52a1\u90fd\u4f9d\u8d56\u5f02\u6b65\u5316\u5b9e\u73b0\u4e86\u767e\u4e07\u91cf\u7ea7\u7684\u5e76\u53d1\u3002</p> <p>\u4e0b\u56fe\u63cf\u8ff0\u4e86\u5f02\u6b65 IO \u7684\u975e\u963b\u585e\u8bfb\u548c\u5f02\u6b65\u6846\u67b6\u7ed3\u5408\u540e\uff0c\u662f\u5982\u4f55\u5207\u6362\u8bf7\u6c42\u7684\u3002</p> <p></p> <p>\u7136\u800c\uff0c\u5199\u5f02\u6b65\u5316\u4ee3\u7801\u5f88\u5bb9\u6613\u51fa\u9519\u3002\u56e0\u4e3a\u6240\u6709\u963b\u585e\u51fd\u6570\uff0c\u90fd\u9700\u8981\u901a\u8fc7\u975e\u963b\u585e\u7684\u7cfb\u7edf\u8c03\u7528\u62c6\u5206\u6210\u4e24\u4e2a\u51fd\u6570</p> <p>\u6709\u6ca1\u6709\u529e\u6cd5\u65e2\u4eab\u53d7\u5230\u5f02\u6b65\u5316\u5e26\u6765\u7684\u9ad8\u5e76\u53d1\uff0c\u53c8\u53ef\u4ee5\u4f7f\u7528\u963b\u585e\u51fd\u6570\u5199\u540c\u6b65\u5316\u4ee3\u7801\u5462</p> <p>\u534f\u7a0b\u53ef\u4ee5\u505a\u5230\uff0c\u5b83\u5728\u5f02\u6b65\u5316\u4e4b\u4e0a\u5305\u4e86\u4e00\u5c42\u5916\u8863\uff0c\u517c\u987e\u4e86\u5f00\u53d1\u6548\u7387\u4e0e\u8fd0\u884c\u6548\u7387\u3002</p>"},{"location":"chap1/5Coroutine/#2","title":"2\u3001\u534f\u7a0b\u662f\u5982\u4f55\u5b9e\u73b0\u9ad8\u5e76\u53d1\u7684\uff1f","text":"<p>\u534f\u7a0b\u4e0e\u5f02\u6b65\u7f16\u7a0b\u76f8\u4f3c\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u5b83\u4eec\u5fc5\u987b\u4f7f\u7528\u975e\u963b\u585e\u7684\u7cfb\u7edf\u8c03\u7528\u4e0e\u5185\u6838\u4ea4\u4e92\uff0c\u628a\u5207\u6362\u8bf7\u6c42\u7684\u6743\u529b\u7262\u7262\u638c\u63e1\u5728\u7528\u6237\u6001\u7684\u4ee3\u7801\u4e2d\u3002</p> <p>\u4f46\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u534f\u7a0b\u628a\u5f02\u6b65\u5316\u4e2d\u7684\u4e24\u6bb5\u51fd\u6570\uff0c\u5c01\u88c5\u4e3a\u4e00\u4e2a\u963b\u585e\u7684\u534f\u7a0b\u51fd\u6570\u3002</p> <p>\u8fd9\u4e2a\u51fd\u6570\u6267\u884c\u65f6\uff0c\u4f1a\u4f7f\u8c03\u7528\u5b83\u7684\u534f\u7a0b\u65e0\u611f\u77e5\u5730\u653e\u5f03\u6267\u884c\u6743\uff0c\u7531\u534f\u7a0b\u6846\u67b6\u5207\u6362\u5230\u5176\u4ed6\u5c31\u7eea\u7684\u534f\u7a0b\u7ee7\u7eed\u6267\u884c\u3002\u5f53\u8fd9\u4e2a\u51fd\u6570\u7684\u7ed3\u679c\u6ee1\u8db3\u540e\uff0c\u534f\u7a0b\u6846\u67b6\u518d\u9009\u62e9\u5408\u9002\u7684\u65f6\u673a\uff0c\u5207\u6362\u56de\u5b83\u6240\u5728\u7684\u534f\u7a0b\u7ee7\u7eed\u6267\u884c\u3002</p> <p></p>"},{"location":"chap1/5Coroutine/#2-1","title":"2-1 \u90a3\u534f\u7a0b\u7684\u5207\u6362\u662f\u5982\u4f55\u5b8c\u6210\u7684\u5462\uff1f","text":"<p>\u7528\u6237\u6001\u7684\u4ee3\u7801\u5207\u6362\u534f\u7a0b\uff0c\u4e0e\u5185\u6838\u5207\u6362\u7ebf\u7a0b\u7684\u539f\u7406\u662f\u4e00\u6837\u7684</p> <p>\u5185\u6838\u901a\u8fc7\u7ba1\u7406 CPU \u7684\u5bc4\u5b58\u5668\u6765\u5207\u6362\u7ebf\u7a0b\uff0c\u6211\u4eec\u4ee5\u6700\u91cd\u8981\u7684\u6808\u5bc4\u5b58\u5668\u548c\u6307\u4ee4\u5bc4\u5b58\u5668\u4e3a\u4f8b\uff0c\u770b\u770b\u534f\u7a0b\u5207\u6362\u65f6\u5982\u4f55\u5207\u6362\u7a0b\u5e8f\u6307\u4ee4\u4e0e\u5185\u5b58\u3002</p> <p>\u534f\u7a0b\u5c31\u662f\u7528\u6237\u6001\u7684\u7ebf\u7a0b\u3002</p> <p>\u7136\u800c\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u6240\u6709\u5207\u6362\u90fd\u5728\u7528\u6237\u6001\u8fdb\u884c\uff0c\u534f\u7a0b\u5fc5\u987b\u91cd\u65b0\u5c01\u88c5\u6240\u6709\u7684\u963b\u585e\u7cfb\u7edf\u8c03\u7528\uff0c\u5426\u5219\uff0c\u4e00\u65e6\u534f\u7a0b\u89e6\u53d1\u4e86\u7ebf\u7a0b\u5207\u6362\uff0c\u4f1a\u5bfc\u81f4\u8fd9\u4e2a\u7ebf\u7a0b\u8fdb\u5165\u4f11\u7720\u72b6\u6001\uff0c\u8fdb\u800c\u5176\u4e0a\u7684\u6240\u6709\u534f\u7a0b\u90fd\u5f97\u4e0d\u5230\u6267\u884c\u3002</p> <p>\u6bd4\u5982\uff0c\u666e\u901a\u7684 sleep \u51fd\u6570\u4f1a\u8ba9\u5f53\u524d\u7ebf\u7a0b\u4f11\u7720\uff0c\u7531\u5185\u6838\u6765\u5524\u9192\u7ebf\u7a0b\uff0c\u800c\u534f\u7a0b\u5316\u6539\u9020\u540e\uff0csleep \u53ea\u4f1a\u8ba9\u5f53\u524d\u534f\u7a0b\u4f11\u7720\uff0c\u7531\u534f\u7a0b\u6846\u67b6\u5728\u6307\u5b9a\u65f6\u95f4\u540e\u5524\u9192\u534f\u7a0b\u3002\u518d\u6bd4\u5982\uff0c\u7ebf\u7a0b\u95f4\u7684\u4e92\u65a5\u9501\u662f\u4f7f\u7528\u4fe1\u53f7\u91cf\u5b9e\u73b0\u7684\uff0c\u800c\u4fe1\u53f7\u91cf\u4e5f\u4f1a\u5bfc\u81f4\u7ebf\u7a0b\u4f11\u7720\uff0c\u534f\u7a0b\u5316\u6539\u9020\u4e92\u65a5\u9501\u540e\uff0c\u540c\u6837\u7531\u6846\u67b6\u6765\u534f\u8c03\u3001\u540c\u6b65\u5404\u534f\u7a0b\u7684\u6267\u884c\u3002</p> <p>\u6240\u4ee5\uff0c\u534f\u7a0b\u7684\u9ad8\u6027\u80fd\uff0c\u5efa\u7acb\u5728\u5207\u6362\u5fc5\u987b\u7531\u7528\u6237\u6001\u4ee3\u7801\u5b8c\u6210\u4e4b\u4e0a\uff0c\u8fd9\u8981\u6c42\u534f\u7a0b\u751f\u6001\u662f\u5b8c\u6574\u7684\uff0c\u8981\u5c3d\u91cf\u8986\u76d6\u5e38\u89c1\u7684\u7ec4\u4ef6\u3002</p> <p>\u6bd4\u5982 MySQL \u5b98\u65b9\u63d0\u4f9b\u7684\u5ba2\u6237\u7aef SDK\uff0c\u5b83\u4f7f\u7528\u4e86\u963b\u585e socket \u505a\u7f51\u7edc\u8bbf\u95ee\uff0c\u4f1a\u5bfc\u81f4\u7ebf\u7a0b\u4f11\u7720\uff0c\u5fc5\u987b\u7528\u975e\u963b\u585e socket \u628a SDK \u6539\u9020\u4e3a\u534f\u7a0b\u51fd\u6570\u540e\uff0c\u624d\u80fd\u5728\u534f\u7a0b\u4e2d\u4f7f\u7528\u3002</p> <p>\u5f53\u7136\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u51fd\u6570\u90fd\u80fd\u7528\u534f\u7a0b\u6539\u9020\u3002\u6bd4\u5982\u5f02\u6b65 IO\uff0c\u5b83\u867d\u7136\u662f\u975e\u963b\u585e\u7684\uff0c\u4f46\u65e0\u6cd5\u4f7f\u7528 PageCache\uff0c\u964d\u4f4e\u4e86\u7cfb\u7edf\u541e\u5410\u91cf\u3002\u5982\u679c\u4f7f\u7528\u7f13\u5b58 IO \u8bfb\u6587\u4ef6\uff0c\u5728\u6ca1\u6709\u547d\u4e2d PageCache \u65f6\u662f\u53ef\u80fd\u53d1\u751f\u963b\u585e\u7684\u3002</p>"},{"location":"chap1/5Coroutine/#2-2","title":"2-2 \u9762\u5bf9\u591a\u6838\u7cfb\u7edf\uff0c\u4e5f\u9700\u8981\u534f\u7a0b\u4e0e\u7ebf\u7a0b\u914d\u5408\u5de5\u4f5c","text":"<p>\u5b9e\u9645\u4e0a\uff0c\u9762\u5bf9\u591a\u6838\u7cfb\u7edf\uff0c\u4e5f\u9700\u8981\u534f\u7a0b\u4e0e\u7ebf\u7a0b\u914d\u5408\u5de5\u4f5c\u3002\u56e0\u4e3a\u534f\u7a0b\u7684\u8f7d\u4f53\u662f\u7ebf\u7a0b\uff0c\u800c\u4e00\u4e2a\u7ebf\u7a0b\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u4f7f\u7528\u4e00\u9897 CPU\uff0c\u6240\u4ee5\u901a\u8fc7\u5f00\u542f\u66f4\u591a\u7684\u7ebf\u7a0b\uff0c\u5c06\u6240\u6709\u534f\u7a0b\u5206\u5e03\u5728\u8fd9\u4e9b\u7ebf\u7a0b\u4e2d\uff0c\u5c31\u80fd\u5145\u5206\u4f7f\u7528 CPU \u8d44\u6e90\u3002</p> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u4e3a\u4e86\u8ba9\u534f\u7a0b\u83b7\u5f97\u66f4\u591a\u7684 CPU \u65f6\u95f4\uff0c\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u6240\u5728\u7ebf\u7a0b\u7684\u4f18\u5148\u7ea7\uff0c\u6bd4\u5982 Linux \u4e0b\u628a\u7ebf\u7a0b\u7684\u4f18\u5148\u7ea7\u8bbe\u7f6e\u5230 <code>-20</code>\uff0c\u5c31\u53ef\u4ee5\u6bcf\u6b21\u83b7\u5f97\u66f4\u957f\u7684\u65f6\u95f4\u7247\u3002</p> <p>CPU \u7f13\u5b58\u5bf9\u7a0b\u5e8f\u6027\u80fd\u7684\u5f71\u54cd\uff0c\u4e3a\u4e86\u51cf\u5c11 CPU \u7f13\u5b58\u5931\u6548\u7684\u6bd4\u4f8b\uff0c\u8fd8\u53ef\u4ee5\u628a\u7ebf\u7a0b\u7ed1\u5b9a\u5230\u67d0\u4e2a CPU \u4e0a\uff0c\u589e\u52a0\u534f\u7a0b\u6267\u884c\u65f6\u547d\u4e2d CPU \u7f13\u5b58\u7684\u673a\u7387\u3002</p>"},{"location":"chap1/5Coroutine/#3","title":"3\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u534f\u7a0b\u878d\u5408\u4e86\u591a\u7ebf\u7a0b\u4e0e\u5f02\u6b65\u5316\u7f16\u7a0b\u7684\u4f18\u70b9\uff0c\u65e2\u4fdd\u8bc1\u4e86\u5f00\u53d1\u6548\u7387\uff0c\u4e5f\u63d0\u5347\u4e86\u8fd0\u884c\u6548\u7387\u3002</p> <p>\u6709\u9650\u7684\u786c\u4ef6\u8d44\u6e90\u4e0b\uff0c\u591a\u7ebf\u7a0b\u901a\u8fc7\u5fae\u89c2\u4e0a\u65f6\u95f4\u7247\u7684\u5207\u6362\uff0c\u5b9e\u73b0\u4e86\u540c\u65f6\u670d\u52a1\u4e0a\u767e\u4e2a\u7528\u6237\u7684\u80fd\u529b\u3002\u591a\u7ebf\u7a0b\u7684\u5f00\u53d1\u6210\u672c\u867d\u7136\u4f4e\uff0c\u4f46\u5185\u5b58\u6d88\u8017\u5927\uff0c\u5207\u6362\u6b21\u6570\u8fc7\u591a\uff0c\u65e0\u6cd5\u5b9e\u73b0\u9ad8\u5e76\u53d1\u3002</p> <p>\u5f02\u6b65\u7f16\u7a0b\u65b9\u5f0f\u901a\u8fc7\u975e\u963b\u585e\u7cfb\u7edf\u8c03\u7528\u548c\u591a\u8def\u590d\u7528\uff0c\u628a\u539f\u672c\u5c5e\u4e8e\u5185\u6838\u7684\u8bf7\u6c42\u5207\u6362\u80fd\u529b\uff0c\u653e\u5728\u7528\u6237\u6001\u7684\u4ee3\u7801\u4e2d\u6267\u884c\u3002\u8fd9\u6837\uff0c\u4e0d\u4ec5\u51cf\u5c11\u4e86\u6bcf\u4e2a\u8bf7\u6c42\u7684\u5185\u5b58\u6d88\u8017\uff0c\u4e5f\u964d\u4f4e\u4e86\u5207\u6362\u8bf7\u6c42\u7684\u6210\u672c\uff0c\u6700\u7ec8\u5b9e\u73b0\u4e86\u9ad8\u5e76\u53d1\u3002\u7136\u800c\uff0c\u5f02\u6b65\u7f16\u7a0b\u8fdd\u53cd\u4e86\u4ee3\u7801\u7684\u5185\u805a\u6027\uff0c\u8fd8\u9700\u8981\u4e1a\u52a1\u4ee3\u7801\u5173\u6ce8\u5e76\u53d1\u7ec6\u8282\uff0c\u5f00\u53d1\u6210\u672c\u5f88\u9ad8\u3002</p> <p>\u534f\u7a0b\u53c2\u8003\u5185\u6838\u901a\u8fc7 CPU \u5bc4\u5b58\u5668\u5207\u6362\u7ebf\u7a0b\u7684\u65b9\u6cd5\uff0c\u5728\u7528\u6237\u6001\u4ee3\u7801\u4e2d\u5b9e\u73b0\u4e86\u534f\u7a0b\u7684\u5207\u6362\uff0c\u65e2\u964d\u4f4e\u4e86\u5207\u6362\u8bf7\u6c42\u7684\u6210\u672c\uff0c\u4e5f\u4f7f\u5f97\u534f\u7a0b\u4e2d\u7684\u4e1a\u52a1\u4ee3\u7801\u4e0d\u7528\u5173\u6ce8\u81ea\u5df1\u4f55\u65f6\u88ab\u6302\u8d77\uff0c\u4f55\u65f6\u88ab\u6267\u884c\u3002\u76f8\u6bd4\u5f02\u6b65\u7f16\u7a0b\u4e2d\u8981\u7ef4\u62a4\u4e00\u5806\u6570\u636e\u7ed3\u6784\u8868\u793a\u4e2d\u95f4\u72b6\u6001\uff0c\u534f\u7a0b\u76f4\u63a5\u7528\u4ee3\u7801\u8868\u793a\u72b6\u6001\uff0c\u5927\u5927\u63d0\u5347\u4e86\u5f00\u53d1\u6548\u7387\u3002</p> <p>\u5728\u534f\u7a0b\u4e2d\u8c03\u7528\u7684\u6240\u6709 API\uff0c\u90fd\u9700\u8981\u505a\u975e\u963b\u585e\u7684\u534f\u7a0b\u5316\u6539\u9020\u3002\u4f18\u79c0\u7684\u534f\u7a0b\u751f\u6001\u4e0b\uff0c\u5e38\u7528\u670d\u52a1\u90fd\u6709\u5bf9\u5e94\u7684\u534f\u7a0b SDK\uff0c\u65b9\u4fbf\u4e1a\u52a1\u4ee3\u7801\u4f7f\u7528\u3002\u5f00\u53d1\u9ad8\u5e76\u53d1\u670d\u52a1\u65f6\uff0c\u4e0e IO \u591a\u8def\u590d\u7528\u7ed3\u5408\u7684\u534f\u7a0b\u6846\u67b6\u53ef\u4ee5\u4e0e\u8fd9\u4e9b SDK \u914d\u5408\uff0c\u81ea\u52a8\u6302\u8d77\u3001\u5207\u6362\u534f\u7a0b\uff0c\u8fdb\u4e00\u6b65\u63d0\u5347\u5f00\u53d1\u6548\u7387\u3002</p> <p>\u534f\u7a0b\u5e76\u4e0d\u662f\u5b8c\u5168\u4e0e\u7ebf\u7a0b\u65e0\u5173\uff0c\u9996\u5148\u7ebf\u7a0b\u53ef\u4ee5\u5e2e\u52a9\u534f\u7a0b\u5145\u5206\u4f7f\u7528\u591a\u6838 CPU \u7684\u8ba1\u7b97\u529b\uff0c\u5176\u6b21\uff0c\u9047\u5230\u65e0\u6cd5\u534f\u7a0b\u5316\u3001\u4f1a\u5bfc\u81f4\u5185\u6838\u5207\u6362\u7684\u963b\u585e\u51fd\u6570\uff0c\u6216\u8005\u8ba1\u7b97\u592a\u5bc6\u96c6\u4ece\u800c\u957f\u65f6\u95f4\u5360\u7528 CPU \u7684\u4efb\u52a1\uff0c\u8fd8\u662f\u8981\u653e\u5728\u72ec\u7acb\u7684\u7ebf\u7a0b\u4e2d\u6267\u884c\uff0c\u4ee5\u9632\u6b62\u5b83\u5f71\u54cd\u6240\u6709\u534f\u7a0b\u7684\u6267\u884c\u3002</p>"},{"location":"chap1/6Locks/","title":"\u7b2c\u516d\u8282 \u636e\u4e1a\u52a1\u573a\u666f\u9009\u62e9\u5408\u9002\u7684\u9501","text":""},{"location":"chap1/6Locks/#1","title":"1\u3001\u4e92\u65a5\u9501\u4e0e\u81ea\u65cb\u9501\uff1a\u4f11\u7720\u8fd8\u662f\u201c\u5fd9\u7b49\u5f85\u201d\uff1f","text":"<p>\u5e38\u89c1\u7684\u5404\u79cd\u9501\u662f\u6709\u5c42\u7ea7\u7684\uff0c\u6700\u5e95\u5c42\u7684\u4e24\u79cd\u9501\u5c31\u662f\u4e92\u65a5\u9501\u548c\u81ea\u65cb\u9501\uff0c\u5176\u4ed6\u9501\u90fd\u662f\u57fa\u4e8e\u5b83\u4eec\u5b9e\u73b0\u7684\u3002</p> <ul> <li>\u4e92\u65a5\u9501\u7684\u52a0\u9501\u6210\u672c\u66f4\u9ad8\uff0c\u4f46\u5b83\u5728\u52a0\u9501\u5931\u8d25\u65f6\u4f1a\u91ca\u653e CPU \u7ed9\u5176\u4ed6\u7ebf\u7a0b\uff1b</li> <li>\u81ea\u65cb\u9501\u5219\u521a\u597d\u76f8\u53cd\u3002</li> </ul> <p>\u5f53\u4f60\u65e0\u6cd5\u5224\u65ad\u9501\u4f4f\u7684\u4ee3\u7801\u4f1a\u6267\u884c\u591a\u4e45\u65f6\uff0c\u5e94\u8be5\u9996\u9009\u4e92\u65a5\u9501\uff0c\u4e92\u65a5\u9501\u662f\u4e00\u79cd\u72ec\u5360\u9501\u3002</p> <p>\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u5f53 A \u7ebf\u7a0b\u53d6\u5230\u9501\u540e\uff0c\u4e92\u65a5\u9501\u5c06\u88ab A \u7ebf\u7a0b\u72ec\u81ea\u5360\u6709\uff0c\u5f53 A \u6ca1\u6709\u91ca\u653e\u8fd9\u628a\u9501\u65f6\uff0c\u5176\u4ed6\u7ebf\u7a0b\u7684\u53d6\u9501\u4ee3\u7801\u90fd\u4f1a\u88ab\u963b\u585e\u3002</p>"},{"location":"chap1/6Locks/#1-1","title":"1-1 \u963b\u585e\u662f\u600e\u6837\u8fdb\u884c\u7684\u5462\uff1f","text":"<p>\u5bf9\u4e8e 99% \u7684\u7ebf\u7a0b\u7ea7\u4e92\u65a5\u9501\u800c\u8a00\uff0c\u963b\u585e\u90fd\u662f\u7531\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u5b9e\u73b0\u7684\uff08\u6bd4\u5982 Linux \u4e0b\u5b83\u901a\u5e38\u7531\u5185\u6838\u63d0\u4f9b\u7684\u4fe1\u53f7\u91cf\u5b9e\u73b0\uff09\u3002</p> <p>\u5f53\u83b7\u53d6\u9501\u5931\u8d25\u65f6\uff0c\u5185\u6838\u4f1a\u5c06\u7ebf\u7a0b\u7f6e\u4e3a\u4f11\u7720\u72b6\u6001\uff0c\u7b49\u5230\u9501\u88ab\u91ca\u653e\u540e\uff0c\u5185\u6838\u4f1a\u5728\u5408\u9002\u7684\u65f6\u673a\u5524\u9192\u7ebf\u7a0b\uff0c\u800c\u8fd9\u4e2a\u7ebf\u7a0b\u6210\u529f\u62ff\u5230\u9501\u540e\u624d\u80fd\u7ee7\u7eed\u6267\u884c\u3002</p> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u4e92\u65a5\u9501\u901a\u8fc7\u5185\u6838\u5e2e\u5fd9\u5207\u6362\u7ebf\u7a0b\uff0c\u7b80\u5316\u4e86\u4e1a\u52a1\u4ee3\u7801\u4f7f\u7528\u9501\u7684\u96be\u5ea6\u3002</p> <p>\u4f46\u662f\uff0c\u7ebf\u7a0b\u83b7\u53d6\u9501\u5931\u8d25\u65f6\uff0c\u589e\u52a0\u4e86\u4e24\u6b21\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u6210\u672c\uff1a\u4ece\u8fd0\u884c\u4e2d\u5207\u6362\u4e3a\u4f11\u7720\uff0c\u4ee5\u53ca\u9501\u91ca\u653e\u65f6\u4ece\u4f11\u7720\u72b6\u6001\u5207\u6362\u4e3a\u8fd0\u884c\u4e2d\u3002\u4e0a\u4e0b\u6587\u5207\u6362\u8017\u65f6\u5728\u51e0\u5341\u7eb3\u79d2\u5230\u51e0\u5fae\u79d2\u4e4b\u95f4\uff0c\u6216\u8bb8\u8fd9\u6bb5\u65f6\u95f4\u6bd4\u9501\u4f4f\u7684\u4ee3\u7801\u6bb5\u6267\u884c\u65f6\u95f4\u8fd8\u957f\u3002\u800c\u4e14\uff0c\u7ebf\u7a0b\u4e3b\u52a8\u8fdb\u5165\u4f11\u7720\u662f\u9ad8\u5e76\u53d1\u670d\u52a1\u65e0\u6cd5\u5bb9\u5fcd\u7684\u884c\u4e3a\uff0c\u8fd9\u8ba9\u5176\u4ed6\u5f02\u6b65\u8bf7\u6c42\u90fd\u65e0\u6cd5\u6267\u884c\u3002</p>"},{"location":"chap1/6Locks/#1-2","title":"1-2 \u5982\u679c\u80fd\u786e\u5b9a\u88ab\u9501\u4f4f\u7684\u4ee3\u7801\u6267\u884c\u65f6\u95f4\u5f88\u77ed\uff0c\u5c31\u5e94\u8be5\u7528\u81ea\u65cb\u9501\u53d6\u4ee3\u4e92\u65a5\u9501","text":"<p>\u5982\u679c\u4f60\u80fd\u786e\u5b9a\u88ab\u9501\u4f4f\u7684\u4ee3\u7801\u6267\u884c\u65f6\u95f4\u5f88\u77ed\uff0c\u5c31\u5e94\u8be5\u7528\u81ea\u65cb\u9501\u53d6\u4ee3\u4e92\u65a5\u9501</p>"},{"location":"chap1/6Locks/#1-3","title":"1-3 \u81ea\u65cb\u9501","text":"<p>\u81ea\u65cb\u9501\u6bd4\u4e92\u65a5\u9501\u5feb\u5f97\u591a\uff0c\u56e0\u4e3a\u5b83\u901a\u8fc7 CPU \u63d0\u4f9b\u7684 CAS \u51fd\u6570\uff08\u5168\u79f0 Compare And Swap\uff09\uff0c\u5728\u7528\u6237\u6001\u4ee3\u7801\u4e2d\u5b8c\u6210\u52a0\u9501\u4e0e\u89e3\u9501\u64cd\u4f5c\u3002</p> <p>\u52a0\u9501\u6d41\u7a0b\u5305\u62ec 2 \u4e2a\u6b65\u9aa4\uff1a</p> <ul> <li>\u7b2c 1 \u6b65\u67e5\u770b\u9501\u7684\u72b6\u6001\uff0c\u5982\u679c\u9501\u662f\u7a7a\u95f2\u7684\uff0c</li> <li>\u7b2c 2 \u6b65\u5c06\u9501\u8bbe\u7f6e\u4e3a\u5f53\u524d\u7ebf\u7a0b\u6301\u6709\u3002</li> </ul> <p>\u5728\u6ca1\u6709 CAS \u64cd\u4f5c\u524d\uff0c\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u6267\u884c\u8fd9 2 \u4e2a\u6b65\u9aa4\u662f\u4f1a\u51fa\u9519\u7684\u3002\u6bd4\u5982\u7ebf\u7a0b A \u6267\u884c\u7b2c 1 \u6b65\u53d1\u73b0\u9501\u662f\u7a7a\u95f2\u7684\uff0c\u4f46\u5b83\u5728\u6267\u884c\u7b2c 2 \u6b65\u524d\uff0c\u7ebf\u7a0b B \u4e5f\u6267\u884c\u4e86\u7b2c 1 \u6b65\uff0cB \u4e5f\u53d1\u73b0\u9501\u662f\u7a7a\u95f2\u7684\uff0c\u4e8e\u662f\u7ebf\u7a0b A\u3001B \u4f1a\u540c\u65f6\u8ba4\u4e3a\u5b83\u4eec\u83b7\u5f97\u4e86\u9501\u3002</p> <p>CAS \u51fd\u6570\u628a\u8fd9 2 \u4e2a\u6b65\u9aa4\u5408\u5e76\u4e3a\u4e00\u6761\u786c\u4ef6\u7ea7\u6307\u4ee4\u3002</p> <p>\u8fd9\u6837\uff0c\u7b2c 1 \u6b65\u6bd4\u8f83\u9501\u72b6\u6001\u548c\u7b2c 2 \u6b65\u9501\u53d8\u91cf\u8d4b\u503c\uff0c\u5c06\u53d8\u4e3a\u4e0d\u53ef\u5206\u5272\u7684\u539f\u5b50\u6307\u4ee4\u3002</p> <p>\u4e8e\u662f\uff0c\u8bbe\u9501\u4e3a\u53d8\u91cf lock\uff0c\u6574\u6570 0 \u8868\u793a\u9501\u662f\u7a7a\u95f2\u72b6\u6001\uff0c\u6574\u6570 pid \u8868\u793a\u7ebf\u7a0b ID\uff0c\u90a3\u4e48 CAS(lock, 0, pid) \u5c31\u8868\u793a\u81ea\u65cb\u9501\u7684\u52a0\u9501\u64cd\u4f5c\uff0cCAS(lock, pid, 0) \u5219\u8868\u793a\u89e3\u9501\u64cd\u4f5c\u3002</p> <p>\u591a\u7ebf\u7a0b\u7ade\u4e89\u9501\u7684\u65f6\u5019\uff0c\u52a0\u9501\u5931\u8d25\u7684\u7ebf\u7a0b\u4f1a\u201c\u5fd9\u7b49\u5f85\u201d\uff0c\u76f4\u5230\u5b83\u62ff\u5230\u9501\u3002</p> <p>\u4ec0\u4e48\u53eb\u201c\u5fd9\u7b49\u5f85\u201d\u5462\uff1f\u5b83\u5e76\u4e0d\u610f\u5473\u7740\u4e00\u76f4\u6267\u884c CAS \u51fd\u6570\uff0c\u751f\u4ea7\u7ea7\u7684\u81ea\u65cb\u9501\u5728\u201c\u5fd9\u7b49\u5f85\u201d\u65f6\uff0c\u4f1a\u4e0e CPU \u7d27\u5bc6\u914d\u5408 \uff0c\u5b83\u901a\u8fc7 CPU \u63d0\u4f9b\u7684 PAUSE \u6307\u4ee4\uff0c\u51cf\u5c11\u5faa\u73af\u7b49\u5f85\u65f6\u7684\u8017\u7535\u91cf\uff1b\u5bf9\u4e8e\u5355\u6838 CPU\uff0c\u5fd9\u7b49\u5f85\u5e76\u6ca1\u6709\u610f\u4e49\uff0c\u6b64\u65f6\u5b83\u4f1a\u4e3b\u52a8\u628a\u7ebf\u7a0b\u4f11\u7720\u3002</p> <pre><code>while (true) {\n  //\u56e0\u4e3a\u5224\u65adlock\u53d8\u91cf\u7684\u503c\u6bd4CAS\u64cd\u4f5c\u66f4\u5feb\uff0c\u6240\u4ee5\u5148\u5224\u65adlock\u518d\u8c03\u7528CAS\u6548\u7387\u66f4\u9ad8\n  if (lock == 0 &amp;&amp;  CAS(lock, 0, pid) == 1) return;\n\n  if (CPU_count &gt; 1 ) { //\u5982\u679c\u662f\u591a\u6838CPU\uff0c\u201c\u5fd9\u7b49\u5f85\u201d\u624d\u6709\u610f\u4e49\n      for (n = 1; n &lt; 2048; n &lt;&lt;= 1) {//pause\u7684\u65f6\u95f4\uff0c\u5e94\u5f53\u8d8a\u6765\u8d8a\u957f\n        for (i = 0; i &lt; n; i++) pause();//CPU\u4e13\u4e3a\u81ea\u65cb\u9501\u8bbe\u8ba1\u4e86pause\u6307\u4ee4\n        if (lock == 0 &amp;&amp; CAS(lock, 0, pid)) return;//pause\u540e\u518d\u5c1d\u8bd5\u83b7\u53d6\u9501\n      }\n  }\n  sched_yield();//\u5355\u6838CPU\uff0c\u6216\u8005\u957f\u65f6\u95f4\u4e0d\u80fd\u83b7\u53d6\u5230\u9501\uff0c\u5e94\u4e3b\u52a8\u4f11\u7720\uff0c\u8ba9\u51faCPU\n}\n</code></pre> <p>\u5728\u4f7f\u7528\u5c42\u9762\u4e0a\uff0c\u81ea\u65cb\u9501\u4e0e\u4e92\u65a5\u9501\u5f88\u76f8\u4f3c\uff0c\u5b9e\u73b0\u5c42\u9762\u4e0a\u5b83\u4eec\u53c8\u5b8c\u5168\u4e0d\u540c\u3002</p> <p>\u81ea\u65cb\u9501\u5f00\u9500\u5c11\uff0c\u5728\u591a\u6838\u7cfb\u7edf\u4e0b\u4e00\u822c\u4e0d\u4f1a\u4e3b\u52a8\u4ea7\u751f\u7ebf\u7a0b\u5207\u6362\uff0c\u5f88\u9002\u5408\u5728\u7528\u6237\u6001\u5207\u6362\u8bf7\u6c42\u7684\u7f16\u7a0b\u65b9\u5f0f\uff0c\u6709\u52a9\u4e8e\u9ad8\u5e76\u53d1\u670d\u52a1\u5145\u5206\u5229\u7528\u591a\u9897 CPU\u3002</p> <p>\u4f46\u5982\u679c\u88ab\u9501\u4f4f\u7684\u4ee3\u7801\u6267\u884c\u65f6\u95f4\u8fc7\u957f\uff0cCPU \u8d44\u6e90\u5c06\u88ab\u5176\u4ed6\u7ebf\u7a0b\u5728\u201c\u5fd9\u7b49\u5f85\u201d\u4e2d\u957f\u65f6\u95f4\u5360\u7528\u3002</p> <p>\u5f53\u53d6\u4e0d\u5230\u9501\u65f6\uff0c\u4e92\u65a5\u9501\u7528\u201c\u7ebf\u7a0b\u5207\u6362\u201d\u6765\u9762\u5bf9\uff0c\u81ea\u65cb\u9501\u5219\u7528\u201c\u5fd9\u7b49\u5f85\u201d\u6765\u9762\u5bf9\u3002</p> <p>\u8fd9\u662f\u4e24\u79cd\u6700\u57fa\u672c\u7684\u5904\u7406\u65b9\u5f0f\uff0c\u66f4\u9ad8\u7ea7\u522b\u7684\u9501\u90fd\u4f1a\u9009\u62e9\u5176\u4e2d\u4e00\u79cd\u6765\u5b9e\u73b0\uff0c\u6bd4\u5982\u8bfb\u5199\u9501\u5c31\u65e2\u53ef\u4ee5\u57fa\u4e8e\u4e92\u65a5\u9501\u5b9e\u73b0\uff0c\u4e5f\u53ef\u4ee5\u57fa\u4e8e\u81ea\u65cb\u9501\u5b9e\u73b0\u3002</p>"},{"location":"chap1/6Locks/#2","title":"2\u3001\u5141\u8bb8\u5e76\u53d1\u6301\u6709\u7684\u8bfb\u5199\u9501","text":"<p>\u5982\u679c\u4f60\u80fd\u591f\u660e\u786e\u533a\u5206\u51fa\u8bfb\u548c\u5199\u4e24\u79cd\u573a\u666f\uff0c\u53ef\u4ee5\u9009\u62e9\u8bfb\u5199\u9501\u3002</p>"},{"location":"chap1/6Locks/#2-1","title":"2-1 \u8bfb\u5199\u9501","text":"<p>\u8bfb\u5199\u9501\u7531\u8bfb\u9501\u548c\u5199\u9501\u4e24\u90e8\u5206\u6784\u6210\uff0c\u4ec5\u8bfb\u53d6\u5171\u4eab\u8d44\u6e90\u7684\u4ee3\u7801\u6bb5\u7528\u8bfb\u9501\u6765\u52a0\u9501\uff0c\u4f1a\u4fee\u6539\u8d44\u6e90\u7684\u4ee3\u7801\u6bb5\u5219\u7528\u5199\u9501\u6765\u52a0\u9501\u3002</p> <p>\u8bfb\u9501</p> <ul> <li>\u8bfb\u5199\u9501\u7684\u4f18\u52bf\u5728\u4e8e\uff0c\u5f53\u5199\u9501\u672a\u88ab\u6301\u6709\u65f6\uff0c\u591a\u4e2a\u7ebf\u7a0b\u80fd\u591f\u5e76\u53d1\u5730\u6301\u6709\u8bfb\u9501\uff0c\u8fd9\u63d0\u9ad8\u4e86\u5171\u4eab\u8d44\u6e90\u7684\u4f7f\u7528\u7387\u3002</li> <li>\u591a\u4e2a\u8bfb\u9501\u88ab\u540c\u65f6\u6301\u6709\u65f6\uff0c\u8bfb\u7ebf\u7a0b\u5e76\u4e0d\u4f1a\u4fee\u6539\u5171\u4eab\u8d44\u6e90\uff0c\u6240\u4ee5\u5b83\u4eec\u7684\u5e76\u53d1\u6267\u884c\u4e0d\u4f1a\u4ea7\u751f\u6570\u636e\u9519\u8bef\u3002</li> </ul> <p>\u5199\u9501</p> <ul> <li>\u800c\u4e00\u65e6\u5199\u9501\u88ab\u6301\u6709\u540e\uff0c\u4e0d\u53ea\u8bfb\u7ebf\u7a0b\u5fc5\u987b\u963b\u585e\u5728\u83b7\u53d6\u8bfb\u9501\u7684\u73af\u8282\uff0c\u5176\u4ed6\u83b7\u53d6\u5199\u9501\u7684\u5199\u7ebf\u7a0b\u4e5f\u8981\u88ab\u963b\u585e\u3002\u5199\u9501\u5c31\u50cf\u4e92\u65a5\u9501\u548c\u81ea\u65cb\u9501\u4e00\u6837\uff0c\u662f\u4e00\u79cd\u72ec\u5360\u9501\uff1b</li> <li>\u800c\u8bfb\u9501\u5141\u8bb8\u5e76\u53d1\u6301\u6709\uff0c\u5219\u662f\u4e00\u79cd\u5171\u4eab\u9501\u3002</li> </ul> <p>\u56e0\u6b64\uff0c\u8bfb\u5199\u9501\u771f\u6b63\u53d1\u6325\u4f18\u52bf\u7684\u573a\u666f\uff0c\u5fc5\u7136\u662f\u8bfb\u591a\u5199\u5c11\u7684\u573a\u666f\uff0c\u5426\u5219\u8bfb\u9501\u5c06\u5f88\u96be\u5e76\u53d1\u6301\u6709\u3002</p> <p>\u8bfb\u5199\u503e\u5411</p> <p>\u5b9e\u9645\u4e0a\uff0c\u8bfb\u5199\u9501\u65e2\u53ef\u4ee5\u503e\u5411\u4e8e\u8bfb\u7ebf\u7a0b\uff0c\u53c8\u53ef\u4ee5\u503e\u5411\u4e8e\u5199\u7ebf\u7a0b</p> <p>\u524d\u8005\u6211\u4eec\u79f0\u4e3a\u8bfb\u4f18\u5148\u9501\uff0c\u540e\u8005\u79f0\u4e3a\u5199\u4f18\u5148\u9501\u3002</p> <p></p> <p>\u8bfb\u4f18\u5148\u9501\u5e76\u53d1\u6027\u66f4\u597d\uff0c\u4f46\u95ee\u9898\u4e5f\u5f88\u660e\u663e\u3002\u5982\u679c\u8bfb\u7ebf\u7a0b\u6e90\u6e90\u4e0d\u65ad\u5730\u83b7\u53d6\u8bfb\u9501\uff0c\u5199\u7ebf\u7a0b\u5c06\u6c38\u8fdc\u83b7\u53d6\u4e0d\u5230\u5199\u9501\u3002\u5199\u4f18\u5148\u9501\u53ef\u4ee5\u4fdd\u8bc1\u5199\u7ebf\u7a0b\u4e0d\u4f1a\u997f\u6b7b\uff0c\u4f46\u5982\u679c\u65b0\u7684\u5199\u7ebf\u7a0b\u6e90\u6e90\u4e0d\u65ad\u5730\u5230\u6765\uff0c\u8bfb\u7ebf\u7a0b\u4e5f\u53ef\u80fd\u88ab\u997f\u6b7b\u3002</p>"},{"location":"chap1/6Locks/#2-2","title":"2-2 \u907f\u514d\u8bfb\u3001\u5199\u7ebf\u7a0b\u997f\u6b7b","text":"<p>\u7528\u961f\u5217\u628a\u8bf7\u6c42\u9501\u7684\u7ebf\u7a0b\u6392\u961f\uff0c\u6309\u7167\u5148\u6765\u540e\u5230\u7684\u987a\u5e8f\u52a0\u9501\u5373\u53ef\uff0c\u5f53\u7136\u8bfb\u7ebf\u7a0b\u4ecd\u7136\u53ef\u4ee5\u5e76\u53d1\uff0c\u53ea\u4e0d\u8fc7\u4e0d\u80fd\u63d2\u961f\u5230\u5199\u7ebf\u7a0b\u4e4b\u524d\u3002Java \u4e2d\u7684 ReentrantReadWriteLock \u8bfb\u5199\u9501\uff0c\u5c31\u652f\u6301\u8fd9\u79cd\u6392\u961f\u7684\u516c\u5e73\u8bfb\u5199\u9501\u3002</p>"},{"location":"chap1/6Locks/#3","title":"3\u3001\u4e50\u89c2\u9501\uff1a\u4e0d\u4f7f\u7528\u9501\u4e5f\u80fd\u540c\u6b65","text":"<p>\u65e0\u8bba\u4e92\u65a5\u9501\u3001\u81ea\u65cb\u9501\u8fd8\u662f\u8bfb\u5199\u9501\uff0c\u90fd\u5c5e\u4e8e\u60b2\u89c2\u9501\u3002</p>"},{"location":"chap1/6Locks/#3-1","title":"3-1 \u60b2\u89c2\u9501","text":"<p>\u5b83\u8ba4\u4e3a\u540c\u65f6\u4fee\u6539\u8d44\u6e90\u7684\u6982\u7387\u5f88\u9ad8\uff0c\u5f88\u5bb9\u6613\u51fa\u73b0\u51b2\u7a81\uff0c\u6240\u4ee5\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u524d\uff0c\u5148\u52a0\u4e0a\u9501\uff0c\u603b\u4f53\u6548\u7387\u4f1a\u66f4\u4f18\u3002\u7136\u800c\uff0c\u5982\u679c\u5e76\u53d1\u4ea7\u751f\u51b2\u7a81\u7684\u6982\u7387\u5f88\u4f4e\uff0c\u5c31\u4e0d\u5fc5\u4f7f\u7528\u60b2\u89c2\u9501\uff0c\u800c\u662f\u4f7f\u7528\u4e50\u89c2\u9501\u3002</p>"},{"location":"chap1/6Locks/#3-2","title":"3-2 \u4e50\u89c2\u9501","text":"<p>\u5c31\u662f\u5047\u5b9a\u51b2\u7a81\u7684\u6982\u7387\u5f88\u4f4e\uff0c\u6240\u4ee5\u5b83\u91c7\u7528\u7684\u201c\u52a0\u9501\u201d\u65b9\u5f0f\u662f\uff0c\u5148\u4fee\u6539\u5b8c\u5171\u4eab\u8d44\u6e90\uff0c\u518d\u9a8c\u8bc1\u8fd9\u6bb5\u65f6\u95f4\u5185\u6709\u6ca1\u6709\u53d1\u751f\u51b2\u7a81\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u5176\u4ed6\u7ebf\u7a0b\u5728\u4fee\u6539\u8d44\u6e90\uff0c\u90a3\u4e48\u64cd\u4f5c\u5b8c\u6210\u3002\u5982\u679c\u53d1\u73b0\u5176\u4ed6\u7ebf\u7a0b\u5df2\u7ecf\u4fee\u6539\u4e86\u8fd9\u4e2a\u8d44\u6e90\uff0c\u5c31\u653e\u5f03\u672c\u6b21\u64cd\u4f5c\u3002</p> <p>\u81f3\u4e8e\u653e\u5f03\u540e\u5982\u4f55\u91cd\u8bd5\uff0c\u5219\u4e0e\u4e1a\u52a1\u573a\u666f\u76f8\u5173\uff0c\u867d\u7136\u91cd\u8bd5\u7684\u6210\u672c\u5f88\u9ad8\uff0c\u4f46\u51fa\u73b0\u51b2\u7a81\u7684\u6982\u7387\u8db3\u591f\u4f4e\u7684\u8bdd\uff0c\u8fd8\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\u53ef\u89c1\uff0c\u4e50\u89c2\u9501\u5168\u7a0b\u5e76\u6ca1\u6709\u52a0\u9501\uff0c\u6240\u4ee5\u5b83\u4e5f\u53eb\u65e0\u9501\u7f16\u7a0b\u3002</p>"},{"location":"chap1/6Locks/#3-3","title":"3-3 \u65e0\u9501\u7f16\u7a0b\u4e2d\uff0c\u9a8c\u8bc1\u662f\u5426\u53d1\u751f\u4e86\u51b2\u7a81\u662f\u5173\u952e","text":"<p>\u6bd4\u5982\u8bf4\u5728\u7ebf\u6587\u6863\u3002Web \u4e2d\u7684\u5728\u7ebf\u6587\u6863\u662f\u600e\u4e48\u5b9e\u73b0\u591a\u4eba\u7f16\u8f91\u7684\uff1f\u7528\u6237 A \u5148\u5728\u6d4f\u89c8\u5668\u4e2d\u7f16\u8f91\u67d0\u4e2a\u6587\u6863\uff0c\u4e4b\u540e\u7528\u6237 B \u4e5f\u6253\u5f00\u4e86\u76f8\u540c\u7684\u9875\u9762\u5f00\u59cb\u7f16\u8f91\uff0c\u53ef\u662f\uff0c\u7528\u6237 B \u6700\u5148\u7f16\u8f91\u5b8c\u6210\u63d0\u4ea4\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u7528\u6237 A \u5374\u4e0d\u77e5\u9053\u3002\u5f53 A \u63d0\u4ea4\u4ed6\u6539\u5b8c\u7684\u5185\u5bb9\u65f6\uff0cA\u3001B \u4e4b\u95f4\u7684\u5e76\u884c\u4fee\u6539\u5f15\u53d1\u4e86\u51b2\u7a81\u3002</p> <p>Web \u670d\u52a1\u662f\u600e\u4e48\u89e3\u51b3\u8fd9\u79cd\u51b2\u7a81\u7684\u5462\uff1f</p> <p>\u5b83\u5e76\u6ca1\u6709\u9650\u5236\u7528\u6237\u5148\u62ff\u5230\u9501\u540e\u624d\u80fd\u7f16\u8f91\u6587\u6863\uff0c\u8fd9\u65e2\u56e0\u4e3a\u51b2\u7a81\u7684\u6982\u7387\u975e\u5e38\u4f4e\uff0c\u4e5f\u56e0\u4e3a\u52a0\u89e3\u9501\u7684\u4ee3\u4ef7\u5f88\u9ad8\u3002Web \u4e2d\u7684\u65b9\u6848\u662f\u8fd9\u6837\u7684\uff1a\u8ba9\u7528\u6237\u5148\u6539\u7740\uff0c\u4f46\u9700\u8981\u6d4f\u89c8\u5668\u8bb0\u5f55\u4e0b\u4fee\u6539\u524d\u7684\u6587\u6863\u7248\u672c\u53f7\uff0c\u8fd9\u901a\u8fc7\u4e0b\u8f7d\u6587\u6863\u65f6\uff0c\u8fd4\u56de\u7684 HTTP ETag \u5934\u90e8\u5b9e\u73b0\u3002</p> <p>\u4e50\u89c2\u9501\u867d\u7136\u53bb\u9664\u4e86\u9501\u64cd\u4f5c\uff0c\u4f46\u662f\u4e00\u65e6\u53d1\u751f\u51b2\u7a81\uff0c\u91cd\u8bd5\u7684\u6210\u672c\u975e\u5e38\u9ad8\u3002\u6240\u4ee5\uff0c\u53ea\u6709\u5728\u51b2\u7a81\u6982\u7387\u975e\u5e38\u4f4e\uff0c\u4e14\u52a0\u9501\u6210\u672c\u8f83\u9ad8\u65f6\uff0c\u624d\u8003\u8651\u4f7f\u7528\u4e50\u89c2\u9501\u3002</p>"},{"location":"chap1/6Locks/#4","title":"4\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u4e92\u65a5\u9501\u80fd\u591f\u6ee1\u8db3\u5404\u7c7b\u529f\u80fd\u6027\u8981\u6c42\uff0c\u7279\u522b\u662f\u88ab\u9501\u4f4f\u7684\u4ee3\u7801\u6267\u884c\u65f6\u95f4\u4e0d\u53ef\u63a7\u65f6\uff0c\u5b83\u901a\u8fc7\u5185\u6838\u6267\u884c\u7ebf\u7a0b\u5207\u6362\u53ca\u65f6\u91ca\u653e\u4e86\u8d44\u6e90\uff0c\u4f46\u5b83\u7684\u6027\u80fd\u6d88\u8017\u6700\u5927\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u534f\u7a0b\u7684\u4e92\u65a5\u9501\u5b9e\u73b0\u539f\u7406\u5b8c\u5168\u4e0d\u540c\uff0c\u5b83\u5e76\u4e0d\u4e0e\u5185\u6838\u6253\u4ea4\u9053\uff0c\u867d\u7136\u4e0d\u80fd\u8de8\u7ebf\u7a0b\u5de5\u4f5c\uff0c\u4f46\u6548\u7387\u5f88\u9ad8\u3002</p> <p>\u5982\u679c\u80fd\u591f\u786e\u5b9a\u88ab\u9501\u4f4f\u7684\u4ee3\u7801\u53d6\u5230\u9501\u540e\u5f88\u5feb\u5c31\u80fd\u91ca\u653e\uff0c\u5e94\u8be5\u4f7f\u7528\u66f4\u9ad8\u6548\u7684\u81ea\u65cb\u9501\uff0c\u5b83\u7279\u522b\u9002\u5408\u57fa\u4e8e\u5f02\u6b65\u7f16\u7a0b\u5b9e\u73b0\u7684\u9ad8\u5e76\u53d1\u670d\u52a1\u3002</p> <p>\u8bfb\u5199\u9501\u65e2\u53ef\u4ee5\u4f7f\u7528\u4e92\u65a5\u9501\u5b9e\u73b0\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u81ea\u65cb\u9501\u5b9e\u73b0\uff0c\u6211\u4eec\u5e94\u6839\u636e\u573a\u666f\u6765\u9009\u62e9\u5408\u9002\u7684\u5b9e\u73b0\u3002</p> <p>\u5f53\u5e76\u53d1\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\uff0c\u51b2\u7a81\u6982\u7387\u975e\u5e38\u4f4e\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u9009\u62e9\u65e0\u9501\u7f16\u7a0b\u3002\u5b83\u5728 Web \u548c\u6570\u636e\u5e93\u4e2d\u6709\u5e7f\u6cdb\u7684\u5e94\u7528\u3002\u7136\u800c\uff0c\u4e00\u65e6\u51b2\u7a81\u6982\u7387\u4e0a\u5347\uff0c\u5c31\u4e0d\u9002\u5408\u4f7f\u7528\u5b83\uff0c\u56e0\u4e3a\u5b83\u89e3\u51b3\u51b2\u7a81\u7684\u91cd\u8bd5\u6210\u672c\u975e\u5e38\u9ad8\u3002</p> <ul> <li>\u5f53\u4f60\u65e0\u6cd5\u5224\u65ad\u9501\u4f4f\u7684\u4ee3\u7801\u4f1a\u6267\u884c\u591a\u4e45\u65f6\uff0c\u5e94\u8be5\u9996\u9009\u4e92\u65a5\u9501\uff0c\u4e92\u65a5\u9501\u662f\u4e00\u79cd\u72ec\u5360\u9501\u3002</li> <li>\u5f53\u83b7\u53d6\u9501\u5931\u8d25\u65f6\uff0c\u5185\u6838\u4f1a\u5c06\u7ebf\u7a0b\u7f6e\u4e3a\u4f11\u7720\u72b6\u6001\uff0c\u7b49\u5230\u9501\u88ab\u91ca\u653e\u540e\uff0c\u5185\u6838\u4f1a\u5728\u5408\u9002\u7684\u65f6\u673a\u5524\u9192\u7ebf\u7a0b\uff0c\u800c\u8fd9\u4e2a\u7ebf\u7a0b\u6210\u529f\u62ff\u5230\u9501\u540e\u624d\u80fd\u7ee7\u7eed\u6267\u884c\u3002</li> <li>\u56e0\u6b64\uff0c\u8bfb\u5199\u9501\u771f\u6b63\u53d1\u6325\u4f18\u52bf\u7684\u573a\u666f\uff0c\u5fc5\u7136\u662f\u8bfb\u591a\u5199\u5c11\u7684\u573a\u666f\uff0c\u5426\u5219\u8bfb\u9501\u5c06\u5f88\u96be\u5e76\u53d1\u6301\u6709\u3002</li> <li>\u4e50\u89c2\u9501\u867d\u7136\u53bb\u9664\u4e86\u9501\u64cd\u4f5c\uff0c\u4f46\u662f\u4e00\u65e6\u53d1\u751f\u51b2\u7a81\uff0c\u91cd\u8bd5\u7684\u6210\u672c\u975e\u5e38\u9ad8\u3002\u6240\u4ee5\uff0c\u53ea\u6709\u5728\u51b2\u7a81\u6982\u7387\u975e\u5e38\u4f4e\uff0c\u4e14\u52a0\u9501\u6210\u672c\u8f83\u9ad8\u65f6\uff0c\u624d\u8003\u8651\u4f7f\u7528\u4e50\u89c2\u9501\u3002</li> </ul>"},{"location":"chap10/1Autosys_tot1/","title":"1 Autosys Introduction","text":""},{"location":"chap10/1Autosys_tot1/#1-autosys-introduction_1","title":"1 Autosys Introduction","text":""},{"location":"chap10/1Autosys_tot1/#1-1-what-is-autosys","title":"1-1 What is Autosys","text":"<ul> <li>Autosys is a automated job control system for monitoring, reporting and scheduling. </li> <li>A job is any single command, script, executable file. </li> <li>Jobs can reside on any configured machine that is attached to network. </li> </ul>"},{"location":"chap10/1Autosys_tot1/#1-2-instance","title":"1-2 Instance","text":"<ul> <li>An AutoSys instance is one licensed version of AutoSys software running as an AutoSys server with one or more clients, on a single machine or on multiple machines. </li> <li>AutoSys instance is defined by the instance ID - a capitalized three-letter identifier defined by the <code>$AUTOSERV</code> environment variable. </li> <li>An instance uses its own event server and event processor and operates independently of other AutoSys instances </li> </ul> <p>Example: ACE</p>"},{"location":"chap10/1Autosys_tot1/#1-3-components-of-autosys","title":"1-3 Components of Autosys","text":"<p>There are 3 major component of Autosys. </p> <ul> <li>1) Event Server </li> <li>2) Scheduler </li> <li>3) Remote agent </li> </ul>"},{"location":"chap10/1Autosys_tot1/#1-4-events","title":"1-4 Events","text":"<ul> <li>Autosys is a event driven. </li> <li>Manually events are generated using the sendevent command. </li> </ul>"},{"location":"chap10/1Autosys_tot1/#2-why-autosys-event-sendevent","title":"2 Why autosys: Event, Sendevent","text":""},{"location":"chap10/1Autosys_tot1/#why-autosys","title":"Why Autosys","text":"<ul> <li>To Automate any process to make business easy </li> <li>To Reduce manual Intervention </li> <li>To Deliver required results in time </li> </ul>"},{"location":"chap10/1Autosys_tot1/#what-is-an-event","title":"What is an EVENT","text":"<ul> <li>Event is nothing but an action taken on a Job. </li> <li>The action on the job is being performed using sendevent. </li> <li>AutoSys is completely event-driven; that is, for a job </li> </ul>"},{"location":"chap10/1Autosys_tot1/#send-event","title":"SEND EVENT","text":"<ul> <li> <p>You can send events for a variety of purposes, including </p> <ul> <li>starting or stopping jobs, </li> <li>Stopping the Event processor, </li> <li>Putting a job on hold and etc. </li> </ul> </li> <li> <p>This command is also used to set global variables or cancel a scheduled event. </p> </li> <li>The event that is sent, is written to the database, which the event processor(Scheduler) is continually polling. <ul> <li>The event processor(Scheduler) reads and processes the event. </li> </ul> </li> <li> <p>To issue a sendevent on a job, you must have execute permission on that job. Only comments and set global can be sent without regard to permissions. </p> </li> <li> <p>Sendevent can be performed via two ways </p> <ul> <li>GUI </li> <li>COMMANDS </li> </ul> </li> </ul> <p> </p>"},{"location":"chap10/1Autosys_tot1/#2-why-autosys-event-sendevent_1","title":"2 Why autosys: Event, Sendevent","text":""},{"location":"chap10/1Autosys_tot1/#sendevent-via-command","title":"SendEvent via Command","text":"<pre><code>sendevent -E START_JOB -J &lt;Job name&gt;\n# Start the job (job_load)\n</code></pre> <pre><code>sendevent -E FORCE_STARTJOB -J &lt;Job name&gt; \n</code></pre> <ul> <li>If you use the sendevent command to send a <code>FORCE_STARTJOB</code> event to a job, CA Workload Automation AE immediately starts the job on the machine that is specified in the job definition, regardless of the current load on the machine or the <code>job_load</code> value that is set for the job.<ul> <li>If you send a <code>FORCE_STARTJOB</code> event to a job in <code>ON_ICE</code> or <code>ON_HOLD</code> status, the job's status does not revert to its previous status when it completes.</li> <li>If you send a <code>FORCE_STARTJOB</code> event to a job in RESWAIT status, the <code>FORCE_STARTJOB</code> is ignored and the job remains in the RESWAIT status.</li> <li>You can remove or alter the resource requirements of the job so the job is no longer in RESWAIT and can be started.</li> </ul> </li> </ul> <pre><code>sendevent -E KILLJOB -J &lt;job name&gt; \n</code></pre> <p>Indicates that the job ends while it is still in the RUNNING state. The scheduler issues an alarm when a job is terminated. </p> <pre><code>sendevent -E DELETEJOB -J &lt;Job name&gt;\n</code></pre> <pre><code>sendevent -E JOB_ON_HOLD -J &lt;Job name&gt; \nsendevent -E JOB_OFF_HOLD -J &lt;Job name&gt; \nsendevent -E JOB_ON_ICE -J &lt;Job name&gt; \nsendevent -E JOB_OFF_ICE -J &lt;Job name&gt; \n</code></pre> <ul> <li> <p><code>ON_HOLD</code>   : Indicates that the job is on hold and cannot run until you take it off hold.</p> <ul> <li>You can place a job in this status only by sending the <code>JOB_ON_HOLD</code> event.</li> <li>To take a job off hold, send the <code>JOB_OFF_HOLD</code> event.</li> </ul> </li> <li> <p><code>ON_ICE</code>: Indicates that the job is removed from the job stream but is still defined.</p> <ul> <li>You can place a job in this status only by sending the <code>JOB_ON_ICE</code> event.</li> <li>To return a job that is on ice to the job stream and resume running it, send the <code>JOB_OFF_ICE</code> event.</li> </ul> </li> </ul> <pre><code>sendevent -E CHANGE_STATUS -s STATUS -J &lt;Job name&gt;\n</code></pre> <p>When the status of a job with cross-instance dependencies changes, the scheduler sends a <code>CHANGE_STATUS</code> event to the remote instance event server while the job in the local instance runs. </p> <p>The scheduler also sends an equivalent <code>CHANGE_STATUS</code> event to the remote instance for status changes not resulting from a <code>CHANGE_STATUS</code> event, specifically status changes resulting from one of the following:</p> <ul> <li>Unavailable machine load units, resources or agents prevent a job from running and the scheduler change the status of the job.</li> <li>The user changes the status by issuing a sendevent command for one of the following events: <code>JOB_ON_HOLD</code>, <code>JOB_OFF_HOLD</code>, <code>JOB_ON_ICE</code>, <code>JOB_OFF_ICE</code>, <code>JOB_ON_NOEXEC</code>, <code>JOB_OFF_NOEXEC</code>.</li> </ul> <pre><code>sendevent -E &lt;any event&gt; -c \"comment to be displayed\"\n</code></pre> <pre><code>sendevent -E SET_GLOABL -G \"Global variable=value\"\n</code></pre>"},{"location":"chap10/1Autosys_tot1/#3-type-of-machines","title":"3 Type of Machines","text":""},{"location":"chap10/1Autosys_tot1/#objectives","title":"Objectives","text":"<ul> <li> <p>Types of machines </p> <ul> <li>Server machine</li> <li>Client Machine </li> </ul> </li> <li> <p>Types of Jobs </p> <ul> <li>Command Jobs </li> <li>File Watcher Jobs </li> <li>Box Jobs </li> </ul> </li> </ul>"},{"location":"chap10/1Autosys_tot1/#types-of-machines","title":"Types Of Machines","text":"<ul> <li>Server Machine: </li> </ul> <p>An Autosys server machine is a machine on which the scheduler, the event server, and/or both reside. </p> <ul> <li>Client Machine: </li> </ul> <p>An Autosys client machine is one on which the remote agent is installed. This is the machine where the job actually runs </p>"},{"location":"chap10/1Autosys_tot1/#types-of-jobs","title":"Types Of Jobs","text":"<p>Command Job: Usually executes a command script or run a program. </p> <ul> <li>Run under a user id on remote machine. </li> <li>A single action performed on a validated machine. </li> <li>Can comprise of only one command to be executed in one job. </li> </ul> <p>File Watcher Job:  Is a remote process that monitors the existence and size of a file. </p> <ul> <li>If it detects file - success. </li> <li>It can search only for one file when the job is been defined. </li> </ul> <p>Box Job: </p> <ul> <li>Is a container of jobs which comprises of Command ,File watcher and even box jobs. </li> <li>It itself performs no action but it can trigger other jobs to run. </li> </ul>"},{"location":"chap10/1Autosys_tot1/#5-autosys-job-status-box-logic","title":"5 Autosys: Job status, Box Logic","text":""},{"location":"chap10/1Autosys_tot1/#objectives_1","title":"Objectives","text":"<ul> <li>Autosys Job Status </li> <li>BOX Logic </li> <li>What Happens when BOX Runs </li> </ul>"},{"location":"chap10/1Autosys_tot1/#autosys-job-status","title":"Autosys Job Status","text":"<ul> <li>Autosys keeps track of the current state, or status , of every job. </li> <li> <p>Here ,are the different status of the job: </p> <ul> <li>INACTIVE(IN) </li> <li>ACTIVATED(AC) </li> <li>STARTING(ST) </li> <li>RUNNING(RU) </li> <li>SUCCESS(SU) </li> <li>FAILURE(FA) </li> <li>TERMINTED(TE) </li> <li>RESTART(RE) </li> <li>RESOURCE WAIT(RW) </li> <li><code>ON_HOLD</code>(OH) </li> <li><code>ON_ICE</code>(OI) </li> </ul> </li> <li> <p>INACTIVE: The job has pot vet been processed. Either the job has never been run, or its status was intentionally altered. </p> </li> <li>ACTIVATED: The top-level box that this job is in now in the RUNNING state, but the job itself has not started yet. </li> <li>STARTING: The event processor has initiated the start job procedure with the Remote Agent. </li> <li>RUNNING: The job is ruming. If the job is a box job, this value simply means that jobs within the box may be started. If it is a command or file watcher job, the value means that the process is actually running on the remote machine. </li> <li>SUCCESS: By default, only the exit code \"0\" is interpreted as \"Success\". </li> <li>FAILURE: By default, any code which is greater than \"0\" is interpreteLd as \" F ilure\" . </li> <li>TERMINATED: The job has been terminated while in the Running state i.e if a KILLJOB event has been passed or it can also be terminated if it has exceeded the maximum run time. </li> <li>RESTART: The job was unable to start due to hardware or application problems, and has been scheduled to restart. </li> <li>SUCCESS: By default, only the exit code \"0\" is interpreted as \"Success\". </li> <li>FAILURE: By default, any code which is greater than \"0\" is interpreteLd as \" Failure\" . </li> <li>TERMINATED: The job has been terminated while in the Running state i.e if a KILLJOB event has been passed or it can also be terminated if it has exceeded the maximum run time. </li> <li>RESTART: The job was unable to start due to hardware or application problems, and has been scheduled to restart. </li> <li>RESOURCE WAIT: The job can logically run(that its all starting conditions have been met),but there are not enough machine resources available. </li> <li><code>ON_HOLD</code>: This job is on hold and will not run until its offholded. </li> <li><code>ON_ICE</code>: This job is removed from all conditions and logic, but is still define to autosys.It will remain ONICE until its officed </li> </ul>"},{"location":"chap10/1Autosys_tot1/#box-logic","title":"BOX LOGIC","text":"<p>Default Box Job Behavior</p> <ul> <li>Jobs run only once per box execution. </li> <li>Jobs in a box will start only if the box itself is running. </li> <li>Boxes should be used primarily for jobs with the same starting conditions. </li> <li>As long as any job in a box is running, the box remains in RUNNING state; the box cannot complete until all jobs have run. </li> <li>By default, a box will return a status SUCCESS only when all the jobs in the box have run and the status of all the jobs is success. </li> <li>By default, a box will return a status FAILURE only when all jobs in the box have run and the status of one or more of the jobs is failure.</li> <li>Unless otherwise specified, a bo will run indefinitely until it reaches a status SUCCESS or FAILURE </li> <li>Changing the state of a box to INACTIVE(through the sendevent command) changes the state of all the jobs in the box to INACTIVE</li> </ul> <p>What happens when a Box Runs</p> <ul> <li> <p>As a box starts running, all the jobs in the box (including sub-boxes )change to status ACTIVATED, meaning they are eligible to run. </p> </li> <li> <p>Then each job is analyzed for additional starting conditions. All jobs with no additional starting conditions are started, without any implied ordering or prioritizing. </p> </li> <li> <p>Jobs with additional starting conditions remain in the  ACTIVATED state until those additional dependencies have been met. </p> </li> </ul>"},{"location":"chap10/1Autosys_tot1/#6-difference-between-onhold-and-onice","title":"6 Difference between onhold and onice","text":""},{"location":"chap10/1Autosys_tot1/#objectives_2","title":"Objectives","text":"<ul> <li><code>JOB_ON_HOLD</code> </li> <li><code>JOB_OFF_HOLD</code> </li> <li><code>JOB_ON_ICE</code> </li> <li><code>JOB_OFF_ICE</code> </li> <li><code>DIFF.B/WON HOLD and ON ICE</code></li> </ul>"},{"location":"chap10/1Autosys_tot1/#job_on_hold","title":"<code>JOB_ON_HOLD</code>","text":"<ul> <li>Puts the job specified in <code>-J</code> job name \"On Hold.\" When a job is \"On Hold,\" <ul> <li>it will not be started, and downstream dependent jobs will not run. </li> </ul> </li> <li>A box cannot successfully complete if a job within it is <code>ON_HOLD</code>. </li> <li>If the job is already STARTING or RUNNING, You cannot put it <code>ON_HOLD</code>. </li> </ul> <p>Syntax: </p> <pre><code>sendevent -E JOB_ON_HOLD -J &lt;Job name&gt; \n</code></pre>"},{"location":"chap10/1Autosys_tot1/#job_off_hold","title":"<code>JOB_OFF_HOLD</code>","text":"<p>Takes the jobs specified in -J <code>job_name</code> \"Off Hold.\" If the starting conditions are met, the job will be started. </p> <p>Syntax: </p> <pre><code>sendevent -E JOB OFF HOLD -j &lt;Job name&gt; \n</code></pre>"},{"location":"chap10/1Autosys_tot1/#job_on_ice","title":"<code>JOB_ON_ICE</code>","text":"<ul> <li>Prevents the job from running. </li> <li>The dependencies and run criteria (such as date/time) is not tracked while it's on ice .</li> </ul> <p>Syntax: </p> <pre><code>sendevent -E JOB_ON_ICE -J &lt;Job name&gt; \n</code></pre>"},{"location":"chap10/1Autosys_tot1/#job_off_ice","title":"<code>JOB_OFF_ICE</code>","text":"<ul> <li>Takes the job specified in -J <code>job_name</code> \"Off Ice.\" </li> <li>The job acts as a brand new when taken off ice. Meaning dependencies need to be newly satisfied before the job will run again. </li> </ul> <p>Syntax: </p> <pre><code>sendevent -E JOB_OFF_ICE -J &lt;Job name&gt; \n</code></pre>"},{"location":"chap10/1Autosys_tot1/#diff-bw-onhold-onice","title":"Diff B/W ONHOLD &amp; ONICE","text":"<p><code>ON_HOLD</code></p> <ul> <li>Putting a job <code>ON_HOLD</code> means the job will not be started and any downstceam dependent jobs will not run</li> <li>When an \"on hold\" job is taken off hold, if its starting conditions are already met. it will be scheduled to run, and it will run. </li> <li>EVENTS </li> </ul> <pre><code>sendevent -E JOB_ON_HOLD -j jobname -c \"tkt #\" \nsendevent -E JOB_OFF_HOLD -j jobname -c \"tkt #\" \n\nsendevent -E TOB_ON_HOLD -J lock_out -c ma# 1234\" \nsendevent -E JOB_OFF_HOLD -J lock_out -c \"T1CT#1234\" \n</code></pre> <ul> <li>STATUS </li> </ul> <pre><code>JOB_ON_HOLD ---- OH \nJOB_OFF_HOLD ---- IN (Depends on previous state when onhold) \n</code></pre> <ul> <li>A job can not be STARTING or RUNNING to have it put \"on hold\". </li> </ul> <p><code>ON_ICE</code></p> <ul> <li>Putting a job <code>ON_ICE</code> means the job will not be started and any downstream dependent jobs could run depending on those dependent jobs' start conditions. </li> <li>When an 'on ice\" job is taken \"off ice\" its starting conditions are already met it will not start. <ul> <li>It will not start until its starting conditions reoccur -- just like a new job </li> </ul> </li> <li>EVENTS </li> </ul> <pre><code>sendevent -E JOB_ON_ICE -j jobname -c \"tkt #\" \nsendevent -E JOB_OFF_ICE -j jobname -c \"tkt #\" \n\nsendevent -E TOB_ON_ICE -J lock_out -c ma# 1234\" \nsendevent -E JOB_OFF_ICE -J lock_out -c \"T1CT#1234\" \n</code></pre> <ul> <li>STATUS </li> </ul> <pre><code>JOB_ON_ICE ---- OI\nJOB_OFF_ICE  ---- IN (always) \n</code></pre> <ul> <li>A job can not be STARTING or RUNNING to have it put \"on ice\". </li> </ul>"},{"location":"chap10/1Autosys_tot1/#7-how-to-setup-future-event-and-cancel-event","title":"7 How to setup future event and cancel event","text":""},{"location":"chap10/1Autosys_tot1/#objectives_3","title":"Objectives","text":"<ul> <li>SET FUTURE SEND EVENT </li> <li>CANCEL FUTURE SEND EVENT </li> </ul>"},{"location":"chap10/1Autosys_tot1/#how-to-set-future-send-event","title":"How to set future send event","text":"<p>This is used to schedule an event in the future Date or Time </p> <p>Syntax: </p> <pre><code>sendevent -E JOB_ON_HOLD &lt;JOB NAME&gt; -T \"MM/DD/YY YYHH:MM\" \n</code></pre> <p>Example</p> <p>Put the job on hold at 9:00 a.m., today </p> <pre><code>sendevent -E JOB_ON_HOLD -J TESTJOB -T \"12/11/2016 09:00\" \n</code></pre> <p>To take the job off hold at 2:00 p.m </p> <pre><code>sendevent -E JOB_OFF_HOLD -J TESTJOB -T \"12/11/2016 14:00\" \n</code></pre>"},{"location":"chap10/1Autosys_tot1/#how-to-cancel-future-send-event","title":"How To cancel future send event","text":"<p>This is used to schedule an event in the future Date or Time </p> <p>Syntax: </p> <pre><code>sendevent -E &lt;JOB_ON_HOLD&gt; &lt;JOB NAME&gt; -J \"MM/DD/YYYY HH:MM\" \n</code></pre>"},{"location":"chap10/1autosys_intro/","title":"1 AutoSys: A Beginner\u2019s Guide AutoSys Workload Automation","text":""},{"location":"chap10/1autosys_intro/#what-is-autosys","title":"What is AutoSys?","text":"<p>AutoSys Workload Automation is a multi-platform automated job control system that provides scheduling, monitoring, and reporting of Autoys jobs.</p> <ul> <li>Autosys server will communicate with the remote AutoSys agent.</li> <li>i.e. Installed in the remote machine like Windows/Unix to perform the job operations.</li> </ul>"},{"location":"chap10/1autosys_intro/#autosys-ae-architecture","title":"Autosys AE Architecture","text":"<p>CA Workload Automation AE main components are as follows:</p> <ul> <li>Event server(database)</li> <li>Application server</li> <li>Web server</li> <li>Scheduler</li> <li>Agent</li> <li>Client</li> </ul>"},{"location":"chap10/1autosys_intro/#how-does-autosys-work","title":"How does AutoSys work?","text":"<p>Remote Agent, Event Server, Event Processor are the build blockings.</p> <p></p> <ul> <li> <p>Remote Agent: The Remote Agent is a process triggered by the event processor to execute a task scheduler on remote machine I.e. on AutoSys client machine.</p> </li> <li> <p>Event Server (AutoSys Database):The Event Server is the repository where job events and autosys job definition stored.</p> </li> <li> <p>Event Processor:Event Processor is a crucial component, it reads and processes all the events from the autosys database tables(event server).</p> </li> </ul> <p>This process can be a window service or unix and Event Processor will scan the database events continuously.</p> <p>Majority of the server configurations will be configured by autosys administrator.</p>"},{"location":"chap10/1autosys_intro/#autosys-job-types","title":"AutoSys Job Types:","text":"<p>Jobs in AutoSys classified into following job type. Command job</p> <ul> <li>Command jobs execute commands.</li> </ul> <p>An command job is a single command or executable, windows batch file, or unix script/powershell script/shell script(scripting language).</p> <ul> <li>File Watcher job:</li> </ul> <p>The AutoSys file watcher job will watch for the arrival of particular file.</p> <ul> <li>Box (box jobs):</li> </ul> <p>AutoSys box jobs are containers that consists other jobs</p> <p>The box job in AutoSys used to control and organize process flow.</p> <p>boxes can include another boxes.</p>"},{"location":"chap10/1autosys_intro/#job-statusstates-infographic","title":"Job Status/States - Infographic","text":"<p>This tool keeps track of the AutoSys status of every job.</p> <p></p> <p>The job status used to determine when to start other jobs that are dependent on the job.</p> <p>The following were the list of job status and their AutoSys change status behaviours.</p> <ul> <li>STARTING : An event initiated to the start job procedure with the remote agent.</li> <li>RUNNING : Means the job is in running mode. In case if the job is a box job, this value means that the jobs within the AutoSys box started.</li> <li>INACTIVE : Means the job is inactive. The job has been never executed or its status was intentionally marked to turnoff its previous completion status.</li> <li>ACTIVATED : The top-level box that this job resided now in RUNNING state, but note that job itself has not started yet.</li> <li>SUCCESS: The job completed successfully, by default the Exit Code \"0\" considered as success. <ul> <li>In case of box job, success status means that all the jobs inside the box has completed successfully.</li> </ul> </li> <li>FAILURE : The job failed, which means the Exit Code-is greater than zero.</li> <li>TERMINATED : The job terminated while in the running state. A job terminated when user sends a KILL job event.</li> <li>RESTART: The job was unable to start due to application or hardware problems and scheduled to restart.</li> <li><code>QUE_WAIT</code>: The job ready to run, but there are not enough machine resources available.</li> <li><code>ON HOLD</code> : The job is ON HOLD and will not run until it receives job OFF HOLD event.</li> <li><code>ON ICE</code> : The job will be ON ICE (AutoSys jobs on ice) until it receives OFF ICE event. In other words, ICE job can be ON/OFF.</li> </ul>"},{"location":"chap10/1autosys_intro/#on-hold-vs-on-ice","title":"ON HOLD VS ON ICE?","text":"<p>Its one of the standard AutoSys interview questions.</p> <p>Here are the details of AutoSys condition which covers ON ICE to OFF ICE VS ON HOLD to OFF HOLD.</p> <ul> <li>When a job is ON HOLD and If the same job has kept OFF HOLD, Its runs in case of job starting conditions met/satisfied. </li> <li>When a job is OFF ICE and If the same Job kept OFF ICE, Its will not run even though the respective job starting conditions met/satisfied.</li> <li>If a job is ON HOLD, The dependent jobs will not run. <li>Where as If a job is ON ICE, the dependent will A run as per the schedule.</li>"},{"location":"chap10/1autosys_intro/#managing-file-transferftpsftpscp-jobs","title":"Managing File Transfer(FTP/SFTP/SCP) Jobs","text":"<p>File Transfer jobs allows transferring of, binary, ASCII, EBCDIC files between an agent computer/remote location or FTP server.</p> <p>File transfer jobs defined as following:</p> <ul> <li>FTP:  Lets you transfer files using File Transfer Protocol(FTP).</li> <li>SFTP: We can securely transfer binary or ASCII files using the Secure File Transfer Protocol (SFTP).</li> </ul> <p>Also FTP protocol supports wildcard transfers, so you can upload multiple files to a remote FTP server or download multiple files to the agent machine.</p> <ul> <li>SCP: Securely transfer binary files using the Secure Copy Protocol(SCP). Note that SCP protocol doesn't support wildcard transfers.</li> </ul>"},{"location":"chap10/1autosys_intro/#what-are-autosys-jil-filescripts","title":"What are AutoSys JIL file/scripts?","text":"<p>JIL stands for Job Information Language.</p> <p>JIL file/scripts used to built an job definition via command-line interface.</p> <p>JIL scripts contain one or more subcommands/attribute statements. </p> <p>The following are the jil command syntax for subcommand and attribute.</p> <ul> <li> <p><code>sub_command:object_name</code></p> </li> <li> <p><code>sub_command</code> -&gt; Defines a JIL sub command.</p> </li> <li> <p><code>object_name</code> -&gt; Defines the name of the object (i,e job / machine) to act on.</p> </li> <li> <p><code>attribute_keyword:value</code></p> </li> <li> <p><code>attribute_keyword</code> -&gt; Defines a valid JIL attribute.</p> </li> <li><code>value</code> -&gt; Defines the setting to apply a attribute.</li> </ul> <p>1.Sample JIL command example for an command job \"helloJob.jil\"</p> <pre><code>insert_job :helloJob\nmachine :unix machine name\nowner :username\ncommand :echo \"Hello this a welcome command job\"\n</code></pre> <p>2.To add the command job \"<code>helloJob.jil</code>\" in database(db)</p> <p>Run the following autosys unix commands through command prompt.</p> <pre><code>jil &lt; echoJob.jil\n</code></pre> <p>If you want to read JIL tag and the corresponding job associated with it, can grep the JIL script.</p> <pre><code>grep \u201chello_job:echo\u201d *.jil | cut -d \u2018 \u2018 -f2\n</code></pre> <p>By using above command syntax solution, you can get the job names. </p> <p>I.e. via filter options available in Sequential file/script and load using datastage job.</p>"},{"location":"chap10/1autosys_intro/#autosys-update-job","title":"AutoSys update job:","text":"<p>Lets go through update job syntax and each attribute/parameter in detail.</p> <pre><code>update_job: BOX_N\nstart_times: \"18:00\"\n</code></pre> <p>Here <code>start_times</code> aceepts numeric type of time format. Save into a jil file and run it using jil executable script</p> <p>command <code>jil &lt; filename.jil</code></p> <p>Example:</p> <pre><code>insert_job: HelloWorld\njob_type: c\nbox_name: box1\ncommand: Datasource/scripts/Autosys/oraclesqlquery/storedprocedure.sh\nmachine: localhost\nowner: admin@localhost\npermission: gx,ge,wx,we,mx,me\ndate_conditions: 1\ndays_of_week: all\nstart_times: 0,30]\n</code></pre> <ul> <li> <p><code>strong&gt;term_run_time: 180</code> </p> </li> <li> <p><code>alarm_if_fail: 1</code> Let\u2019s go through each attribute of jil commands from above example</p> </li> <li><code>insert_job</code>:  Its a JIL keyword which used as Name to identify a job.</li> <li><code>job_type</code>: It defines type of a job and in this case <code>C</code> refers to a Command Job.</li> <li>command: This attribute can be any command, UNIX shell script, executable, or batch file. </li> <li> <p>machine: The client machine on which the command should run.</p> </li> <li> <p>Owner:</p> </li> </ul> <p>It will be the userID on which the command will be running. For above scenario, I gave autosys admin as owner.</p> <ul> <li>permission:</li> </ul> <p>First letter (g, w,m) combination refers to group user and last letter (x,e) refers to the rights for edit (e) and execute(x).</p> <ul> <li><code>date_conditions</code>:</li> </ul> <p>The AutoSys <code>date_conditions</code> which enables the run calendar for the respective job.</p> <ul> <li><code>days_of_week</code></li> </ul> <p>Days on which the job should run</p> <ul> <li><code>start_times</code></li> </ul> <p>autosys start times, This specifies start time of job that it should trigger/run.</p> <ul> <li><code>term_run_time</code></li> </ul> <p><code>term_run_time</code> result in a job status being set to Terminated after specified time. As per example above, it will set the job status to terminated after running 180 minutes.</p> <ul> <li><code>alarmif_fail</code></li> </ul> <p>If the value is 1, then you will receive an failure alert and If the value is O, then you will not receive any alert. max run alarm in AutoSys is an classic example for this.</p> <p>Whenever job runs than the specified time, an max run alarm alert will trigger.</p> <p>Note: AutoSys <code>start_mins</code> leveraged, if a job needs to trigger every minute/minutes.</p> <p>The following syntax will start the job for every 10 mins. </p> <ul> <li><code>start_mins</code>: 00,10,20,30,40,50</li> </ul>"},{"location":"chap10/1autosys_intro/#autosys-commands-cheat-sheet","title":"AutoSys Commands \u2013 Cheat Sheet","text":"<ul> <li>cron2jil  To convert from CRON to JIL (only in UNIX)</li> <li>jil  To define objects like jobs/machines</li> <li>sendevent  For event commands</li> <li>autoflags / autoping / autosyslog / chk_auto_up / chase  Check system status</li> <li><code>autocal_asc</code>: To define calendars</li> <li><code>archive_jobs/archive_events/clean_files/autotrack/dbspace/dbstatistics/DBMaint</code> To maintain Databases</li> <li>autorep/autostatad/autostatus/forecast/monbro: To report job status</li> <li>autosyslog/autorep/monbro: To monitor jobs</li> <li><code>job_depends</code>: To report job dependencies and conditions</li> <li><code>autosys_secure</code>: To manage security</li> <li>autotimezone: To manage time zone </li> </ul>"},{"location":"chap10/1autosys_intro/#autocal_asc-command","title":"<code>autocal_asc</code> command :","text":"<p><code>autocal_asc</code> used to define AutoSys calendars.</p> <p>Calendars are very helpful incase of job/box specific events, processed based on a date in a calendar</p> <p>eg: holiday batch job or batch jobs processing based on the date etc).</p> <p>AutoSys condition parameter \"date_conditions\" related tocalendar concepts. </p> <p>For a job to run 'standalone'\uff0c the 'Date/Time conditions' attribute in the 'Schedule' section must reflect 'true'.</p> <p>If the <code>date_conditions</code> field is not set to '1' (true). , </p> <p>AutoSys review ignore 'Days' or 'Time' attributes and rely on dependencies for job scheduling software</p> <p>If the \u2018Date/Time conditions are \u2018true\u2019,</p> <p>The job or job box will also reference \u2018Run days\u2019, or \u2018Run calendar\u2019 and/or \u2018Exclude Calendar\u2019;</p> <p>and, \"Times of day\"  or 'Minutes past hour'.</p> <p>These job attributes will covered in more details in other sections of autosys documentation.</p>"},{"location":"chap10/1autosys_intro/#cron2jil-command","title":"CRON2JIL command:","text":"<p>Cron is a job scheduler in unix based operating systems.</p> <p>Used to schedule a job (either command or the scripts that runs at fixed intervals, schedule.</p> <p>Cron controlled by a crontab file, a config file that defines shell commands to run cyclically on a specified schedule.</p> <p>cron2jil command is used to convert from CRON to JIL.</p>"},{"location":"chap10/1autosys_intro/#sendevent-command","title":"sendevent command :","text":"<p>The sendevent Autosys command is a component that sends events.</p> <p>to</p> <ul> <li>start or stop jobs, </li> <li>stop the AutoSys scheduler, </li> <li>put a job on hold\uff0c</li> <li>set a AutoSys global variable, </li> <li>cancel a scheduled jobs event </li> <li>and so on.</li> </ul> <p>Basically this command will send event in AutoSys scheduling tool. Following are sample sendevent commands, generally denoted by using sendevent e job name.</p> <p>To start a job:</p> <pre><code>sendevent -E STARTJOB -J\n</code></pre> <p>To force start a job : <code>sendevent -E FORCE_STARTJOB -J</code></p> <p>AutoSys ON ICE:</p> <pre><code>sendevent -E ON_ICE -J\n</code></pre> <p>Put job OFF ICE :</p> <pre><code>sendevent -E OFF_ICE -J\n</code></pre> <p>AutoSys kill job:</p> <pre><code>send event -E KILLJOB -J &lt;job name&gt;\n</code></pre> <p>Event logs verified to check the output, errors.</p>"},{"location":"chap10/1autosys_intro/#calling-an-autosys-job-from-unix-scriptautosys-commands-in-unix","title":"Calling an AutoSys job from Unix Script(AutoSys commands in unix):","text":"<p>We can call an AutoSys job via unix executable script, following is an example.</p> <ul> <li> <p>JobName : SchedulerCommand</p> </li> <li> <p>Custom Script Name: <code>callJob.ksh</code></p> </li> <li> <p>Server: AutoSys Server</p> </li> </ul> <p>In shell script \"callJob.ksh\" use the below sendevent command to pass the event type and job name.</p> <pre><code>sendevent -E FORCE _STARTJOB -J SchedulerCommand\n</code></pre> <p>Now save the unix script and invoke it using command <code>./callJob.ksh</code> from AutoSys server.</p> <p>that's it, the job 'SchedulerCommand' will be successfully force started</p>"},{"location":"chap10/1autosys_intro/#autorep-command","title":"autorep Command:","text":"<p>autorep command generates reports about jobs, machines, and autosys global variables defined in database.</p> <p>It pulls data from the database to formulate the reports.</p> <p>**autorep command used to achieve the following. **</p> <ul> <li>Displaying the current machine load information.</li> <li>Backing up job definitions by extracting definitions and saving them to an output file.</li> <li>Displaying a summary of all defined jobs.</li> <li>Listing relvant information of any job last run (previous run).</li> </ul> <p>If you want to check the job definition history changes, then you can acieve it using autorep command below</p> <pre><code>autorep -j \"mention the job name\"\n</code></pre> <p>Also by using wildcards(%) with autorep command, you export the AutoSys JIL's.</p> <pre><code>autorep -j% -q &gt; /temp/filename.jil\n</code></pre> <ul> <li>To report on jobs in a group: <code>autorep -B group [-d | -s | -q | -o overnum] [-I application] [-n] [-w] [-t] [-R run_num] [-L print_level]</code></li> <li>To report on jobs in an application: <code>autorep -I application [-d | -s | -q | -o overnum] [-B group] [-n] [-w] [-t] [-R run_num] [-L print_level]</code></li> <li>To report on a machine: <code>autorep -M machine [-p | -q] [-d | -s] [-n] [-w]</code></li> <li>To report on a user-defined job type: <code>autorep -Y job_type [-d | -s | -q ] [-n] [-w]</code></li> <li>To report on global variables: <code>autorep -G global_name [-n] [-w] [-d | -s]</code></li> <li>To report on a external instance: <code>autorep -X ext_instance [-s | -q ] [-n] [-w] [-t]</code></li> <li>To report on a virtual resource: <code>autorep -V virtual_resource_name [-d | -s | -q ] [-n] [-w]</code></li> <li>To display the version number for the command <code>autorep -x</code></li> <li>To display help for the command: <code>autorep -?</code></li> </ul>"},{"location":"chap10/1autosys_intro/#autosys-alarms","title":"AutoSys Alarms:","text":"<p>For an instance, jobs could be dependent on a arrival file and if the file not yet arrived in an expected time frame.</p> <ul> <li> <p>Then the job fails and then alarm notification alert the respective groups or owners to take appropriate action.</p> </li> <li> <p>Alarms provides notification mechanism during alarming situations like AutoSys job scheduler failures, dependencies.</p> </li> <li> <p>Upon these kind of notifications, it will allow manual interventions to address the issue</p> </li> <li> <p>Alarms are system specific messages about a detected issue. Typically alarms sent through system as a event.</p> </li> </ul>"},{"location":"chap10/1autosys_intro/#best-practices-for-autosys-errorsexception-handling","title":"Best Practices For AutoSys Errors/Exception Handling:","text":"<p>Exception Handling is one of the key attribute in the software life cycle. </p> <p>W.r.t AutoSys, its best practice to have exception handling on failed operator which have exit path for only \"retry\" scenario. Else having retry without ever exiting the process results in endless loops.</p> <p>Error/Err files or log files can found by using following commands.</p> <p>Scheduler Server and Application Server logs: (default)</p> <pre><code>/opt/CA/WorkloadAutomationAE/autouser.ACE/out\n</code></pre> <p>AutoSys WCC logs:</p> <p><code>(default) /opt/CA/WorkloadCC/log</code></p> <p>AutoSys agent logs: (default)</p> <p><code>/opt/CA/WorkloadAutomationAE/SystemAgent/WA_AGENT/log</code></p>"},{"location":"chap10/1autosys_intro/#exit-codesexit-status","title":"Exit Codes/Exit Status","text":"<p>In general, a zero Exit Code- indicates success; while a non zero Exit Code- indicates an error. Following are exit or error codes which are frequently seen.</p> <ul> <li>Exit Code-1:</li> </ul> <p>Missing System Agent configuration parameter \"oscomponent.cmdprefix.force=true\" and/or the Windows machine definition missing the and/or the Windows machine definition missing the \"opsys: windows\" (JIL) attribute.</p> <ul> <li>Exit Code-2:</li> </ul> <p>This error is coming from the first line in the job script where the shell was being sourced. The first line read <code>#!/usr/bin/ksh.</code></p> <p>However, this was an invalid location for setting the shell interpreter which are typically located in /bin and not /usr/bin.</p> <ul> <li>Exit Code-13:</li> </ul> <p>Due to a permission error on the <code>std_out_file</code>.</p> <ul> <li>Exit Code-15:</li> </ul> <p>The job terminated</p> <ul> <li>Exit Code-101:</li> </ul> <p><code>CHANGE_STATUS</code> performed on the job. for eg: The job changed to FAILURE or TERMINATED status.</p> <ul> <li>Exit Code-121:</li> </ul> <p>Cannot open <code>std_in_file</code>. File does not exist or it is inaccessible</p> <ul> <li>Exit Code-122:</li> </ul> <p>Cannot open <code>std_out_file</code> File does not exist or it is inaccessible.</p> <ul> <li>Exit Code-123:</li> </ul> <p>Cannot open <code>std_err_file</code>. File does not exist or it is inaccessible.</p> <ul> <li>Exit Code-127:</li> </ul> <p>Directory that holds the executable is not in the command search PATH.</p> <ul> <li>Exit Code-256:</li> </ul> <p>Unable to execute the command.</p> <ul> <li>Exit Code-512:</li> </ul> <p>Incorrect command options.</p> <ul> <li>-656 NO EXIT CODE:</li> </ul> <p>exit code field in database initialized to this.</p> <ul> <li>-657 <code>PROCESS_MIA</code>: Set by a chase-generated FAILURE event.</li> </ul>"},{"location":"chap10/1autosys_intro/#oracle-e-business-suite-jobs","title":"Oracle E-Business Suite Jobs","text":"<p>Oracle job scheduler definedto run Oraclet-Business Suite workload.</p> <p>It is illustrated in the following ways.</p> <ul> <li> <p>Request Set Job : To run multiple programs in oracle application.</p> </li> <li> <p>Single Request Job : To run single programs in oracle application.</p> </li> <li> <p>Copy Single Request Job: copying the existing Single Request Job and running it under the AutoSys agent.</p> </li> </ul>"},{"location":"chap10/1autosys_intro/#coordination-between-hadoop-and-conventional-jobs","title":"Coordination between Hadoop and conventional jobs:","text":"<ul> <li>Seamlessly integrate Hadoop tasks, such as HDFS, PIG, HIVE, SQOOP, and Oozie.</li> <li>Gain comprehensive visibility and management capabilities for Hadoop-driven applications through a unified view of workflows spanning the entire IT ecosystem.</li> <li>Create Hadoop and other application workflows effortlessly, without the necessity for coding, thanks to an intuitive design interface.</li> <li>Empower data scientists to independently execute workload processing without relying on IT specialists through self-service capabilities.</li> </ul> <p>CA Workload Automation Reviews from subject matter experts posted in itcentralstation.com.</p>"},{"location":"chap10/1autosys_intro/#interview-faq","title":"Interview FAQ","text":"<ul> <li>What is AutoSys?</li> </ul> <p>AutoSys Workload Automation is a multi-platform automated job control system that provides scheduling, monitoring, and reporting of AutoSys jobs.</p> <ul> <li>What is global name in AutoSys batch scheduling tool?</li> </ul> <p>To report on global variables, use below command</p> <p><code>autorep -G global_name [-n] [-w] [-d | -s]</code></p> <ul> <li>What are all the Autosys job status?</li> </ul> <p>STARTING, RUNNING, INACTIVE, ACTIVATED, SUCCESS, FAILURE, TERMINATED, RESTART, <code>QUE_WAIT</code>, <code>ON HOLD</code>, <code>ON ICE</code></p> <ul> <li>What is AutoSys JIL file?</li> </ul> <p>JIL stands for Job Information Language.</p> <ul> <li>How to create an AutoSys Job?</li> </ul> <p>There are two ways to create an AutoSys job definition.</p> <p>1) Using AutoSys GUI(AutoSys Graphical User Interface).</p> <p>2) Using Job Information Language (JIL) via command-line interface.</p> <ul> <li>What is file watcher in AutoSys?</li> </ul> <p>File watcher job will watch for the arrival of specific file defined.</p> <ul> <li>How to check the job definition history changes in AutoSys?</li> </ul> <p>By running command \"autorep -j\"  where -j refers to job name.</p> <ul> <li>How to mark job as success in AutoSys?</li> </ul> <p>1) Login to autosys wec client url.</p> <p>2) Locate the job you want to mark it as success.</p> <p>3)Click on send event and select 'mark as success' from the drop-down list, then the job marked as success.</p> <p>You can perform the same through \"send event\" command in server command line</p> <ul> <li>How to run Python script in Autosys?</li> </ul> <p>Define the python script as command like \"/usr/bin/python\" and then pass the script as 'Argument\".</p> <ul> <li>What is global name in AutoSys batch scheduling tool?</li> </ul> <p>To report on global variables, use below command</p> <pre><code>autorep -G global_name [-n] [-w] [-d|-s]\n</code></pre> <ul> <li> <p>How to mark job as success in AutoSys?</p> </li> <li> <p>1)Login to autosys wcc client url.</p> </li> <li>2)Locate the job you want to mark it as success.</li> <li>3)Click on send event and select \u2018mark as success\u2019 from the drop-down list, then the job marked as success.</li> </ul> <p>You can perform the same through \u201csend event\u201d command in server command line.</p>"},{"location":"chap10/2Autosys_jil/","title":"2 Autosys JIL","text":""},{"location":"chap10/2Autosys_jil/#autosys-jil-essential-general-options-attributes","title":"Autosys JIL, Essential, General &amp; Options Attributes","text":""},{"location":"chap10/2Autosys_jil/#objectives","title":"Objectives","text":"<ul> <li>JIL </li> <li>Essential Attributes </li> <li>General Attributes </li> <li>Optional Attributes </li> </ul>"},{"location":"chap10/2Autosys_jil/#what-is-an-autosys-job","title":"What is an Autosys Job?","text":"<p>A single action performed on a validated machine which can be a command or executable script or NT batch file. </p> <p>Autosys jobs can be defined using GUI or JIL which contains a set of qualifying attributes, conditions specifying when and where a job should be run. </p> <p>Two methods to define Autosys Jobs\uff1a </p> <ul> <li>Using Autosys GUI. </li> <li>Using Job Information Language(JIL). </li> </ul>"},{"location":"chap10/2Autosys_jil/#jil-job-information-language","title":"JIL (Job information language)","text":"<p>JIL is a language that has its own syntax to describe when, and where and how a job should be run. </p> <p>Example:</p> <pre><code>/*************MY_JOB_1**********/ \ninsert_job: MY_JOB_1 job_type: c \ncommand: /full-path-of-/clean.sh &lt;dirname&gt; \nmachine: machabcWind \nowner: sugnan \nstart_times: 00:10 \npermission: wx,mx,we,me \ndescription: \"Job to clean the &lt;dirname&gt;\" \njob_terminator: 1 \nalarm_if_fail: 0\n</code></pre> <ul> <li> <p>Essential attributes </p> <ul> <li><code>insert_job</code>(job name) </li> <li><code>job_type</code> </li> <li>owner </li> <li>Machine </li> </ul> </li> <li> <p>General attributes </p> <ul> <li>Description </li> <li><code>max_run_alarm</code> </li> <li><code>min_run_alarm</code> </li> <li><code>alarm_if_fail</code> </li> <li><code>std_out_file</code> </li> <li><code>std_err_file</code> </li> <li><code>watch_file:</code> </li> <li><code>watch_interval</code> </li> <li><code>watch_file_min_size</code> </li> <li>command </li> <li><code>box_name</code> </li> <li><code>job_terminator</code> </li> <li><code>box_terminator</code> </li> </ul> </li> <li> <p>Optional attributes</p> <ul> <li><code>date_conditions</code> </li> <li><code>Start_times/start_min</code> </li> <li><code>days_of_week</code> </li> <li><code>Condition</code> </li> <li><code>run_calendar</code> </li> <li><code>exclude_calendar</code> </li> <li><code>term_run_time</code> </li> <li><code>n_retrys</code> </li> <li><code>run_window</code> </li> <li><code>job_load</code> </li> <li>Priority </li> </ul> </li> </ul>"},{"location":"chap10/2Autosys_jil/#2-jobs-attributes-in-details","title":"2 Jobs Attributes in details","text":"<ul> <li>Essential Attributes </li> <li>General Attributes </li> </ul>"},{"location":"chap10/2Autosys_jil/#essential-jobs-attributes","title":"Essential Jobs Attributes","text":"<ul> <li> <p><code>insert_job</code>: The job name is used to identify the job, and must be unqiue. It can be from 1 to 30 alphanumetic characters. Command, file watcher, and box jobs cannot use the same name</p> <ul> <li><code>insert_job: PC_JOB1</code></li> </ul> </li> <li> <p><code>job_type</code>: The job type specifies the type of job: command (c), file watcher(f) or box(b). </p> <ul> <li><code>job_type: c or f or b</code></li> </ul> </li> <li> <p>owner: The job owner specifies whose user ID the command will be run under on the client Machine. </p> <ul> <li><code>owner: root</code> </li> </ul> </li> <li> <p>machine: This attribute specifies the client machine on which the command should be run. </p> <ul> <li><code>Machine: server1</code> </li> </ul> </li> </ul>"},{"location":"chap10/2Autosys_jil/#general-job-attributes","title":"General Job attributes","text":"<p>command : command is any single unix command, Shell Script or a NT batch file</p> <p><code>Example : command : ls -1</code></p> <p>description: This attribute provides a comment field, used for documentation purposes only. </p> <p><code>Example: description: \"Run every day to zip ARCH files in serverl\"</code></p> <ul> <li> <p><code>max_run_alarm</code>: A maximum runtime can be specified for a job. If a maximum runtime is specified, the job should not take longer than the specified time to finish. </p> </li> <li> <p><code>min_run_alarm</code>: A minimum runtime (in minutes) can be specified for it job; the job should not end in less than the specified time. </p> </li> <li> <p><code>alarm_if_fail</code>: Send ALARM if this Job Fails </p> </li> <li><code>std_out_file</code>: The standard output file can be redirected to any file on the client machine to which the job owner has write permission </li> <li><code>std_err_file</code>: The standard error file can be redirected to any file on the client machine to which the job owner has write permission. </li> <li><code>watch_file</code>: This attribute specifies the name of the file to watch for </li> <li><code>watch_interval</code>: The watch interval specifies (in seconds) how often the File Watcher should check the current file size to ascertain whether data is still being written to the file. The default is every 60 seconds. </li> <li><code>watch_file_min_size</code>: The watch file minimum size determines when enough data has been written to the file to consider it \"complete.\" This attribute is specified in bytes. </li> <li><code>job_terminator</code>: This attribute specifies whether or not the job should be terminated if the box it is in fails or terminates. </li> </ul>"},{"location":"chap10/2Autosys_jil/#optional-attributes","title":"Optional attributes","text":"<ul> <li><code>date_conditions</code>: The start date/time dependencies attribute is a toggle, which specifies whether or not there is date, time, or both, conditions required for starting the job If the attribute is set to \"no\", the remainder of the related date/ time attributes, will be ignored </li> <li><code>days_of_week</code>:The days of the week attribute specifies the days on which the job should be run. You can specify one or more days, or \"all\" for every day </li> <li><code>start_times</code>: This attribute specifies one or more specific times of day when the job should be Started </li> </ul> <p>Example: </p> <pre><code>insert_job: job1 job_type: c \nmachine: server1 \nowner: oracle \npermission: mx,me \ndate_conditions: 1 \ndays_of_week: all \nstart_times: \"5:00\" \n</code></pre> <p><code>start_mins</code>: One or more specific times per hour when the of should be started can be specified. Each time is specified in minutes past the hour </p> <p>Example: </p> <pre><code>insert_job: job2 job_type: C\nCommand: rm -rf *txt \nmachine: server1 \nowner: oracle \npermission: mx,me \ndate_conditions: 1 \ndays_of_week: all \nstart_mines: 0,15,30,45 \ndescription: \"Remove .txt files\" \n</code></pre> <ul> <li>condition: This attribute specifies the Starting Condition required for a job. Any number of job dependencies can be specified which include successtul completion of a job, failure of a job, a job's exit code, and the value of a global variable. Various combinations of conditions may also he specified </li> <li><code>n_retrys</code>: This attribute specifies how many times, it any, the job should be restarted after exiting with a FAILURE status. <ul> <li>The default is 0, which means the job will not be automatically restarted after an application failure. This attribute applies to application failures not to system or network failures </li> </ul> </li> <li><code>term_run_time</code>: A maximum rtmtime (in minutes) can be specified for a job; the job should not take longer than the specified time to finish. This feature allows the job to be automatically terminated it it runs longer than the allotted thee. </li> <li>run_window`: This attribute specifies a time range ( or time window) during which a job can be started. </li> <li><code>run_calendar</code>: The days on which a job should be run can be specified by way of a custom canlendar, rather than through a list of days of the week. </li> <li><code>exclude_calendar</code>: The days on which a job should not lie run can be specified by way of a custom calendar. </li> </ul>"},{"location":"chap10/2Autosys_jil/#jil-subcommands","title":"JIL Subcommands","text":"<p>JIL subcommands lets you define and modify asset definitions. You specify JIL subcommands using the jil command.</p> <p>The following JIL subcommands define and modify jobs and boxes:</p> <ul> <li><code>delete_box</code></li> </ul> <p>Deletes an existing box job and all the jobs in that box from the database.</p> <ul> <li><code>delete_job</code></li> </ul> <p>Deletes a job from the database. If the specified job is a box job, the box job is deleted and the jobs in the box become stand-alone jobs.</p> <ul> <li><code>insert_job</code></li> </ul> <p>Adds a new job definition to the database.</p> <ul> <li><code>override_job</code></li> </ul> <p>Defines a one-time override for an existing job definition. This override affects the job for the next run only.</p> <ul> <li><code>update_job</code></li> </ul> <p>Updates an existing job definition in the database. The following JIL subcommands define and modify machines:</p> <ul> <li><code>delete_machine</code></li> </ul> <p>Deletes an existing real or virtual machine definition from the database.</p> <ul> <li><code>insert_machine</code></li> </ul> <p>Insert a new real or virtual machine definition in the database. A machine must be defined before it can be used in a job definition.</p> <ul> <li><code>update_machine</code></li> </ul> <p>Updates an existing machine in the database.</p> <p>The following JIL subcommands define and modify monitor or report definitions:</p> <ul> <li><code>delete_monbro</code></li> </ul> <p>Deletes the specified monitor or report definition from the database.</p> <ul> <li><code>insert_monbro</code></li> </ul> <p>Adds a new monitor or report definition to the database.</p> <ul> <li><code>update_monbro</code></li> </ul> <p>Updates an existing monitor or report definition in the database.</p> <p>The following JIL subcommands define and modify job types:</p> <ul> <li><code>delete_job_type</code></li> </ul> <p>Verifies that no jobs are currently defined with the specified job type, then deletes the specified job type definition from the database.</p> <ul> <li><code>insert_job_type</code></li> </ul> <p>Adds a new user-defined job type definition to the database. This is the only way to create a user-defined job type.</p> <ul> <li><code>update_job_type</code></li> </ul> <p>Updates an existing user-defined job type definition in the database. You can use <code>update_job_type</code> to change the values of the command and description attributes.</p> <p>The following JIL subcommands define and modify blobs and globs:</p> <ul> <li><code>insert_blob</code></li> </ul> <p>Adds a new blob definition associated with an existing job.</p> <ul> <li> <p><code>insert_glob</code> Adds a new glob definition referenced by a given name.</p> </li> <li> <p><code>delete_blob</code> Decouples a blob definition from an existing job and deletes the blob from the database.</p> </li> <li> <p><code>delete_glob</code> Deletes the specified glob definition from the database. The following JIL subcommands define and modify external instances:</p> </li> <li> <p><code>delete_xinst</code></p> </li> </ul> <p>Deletes the specified external instance definition from the database.</p> <ul> <li><code>insert_xinst</code></li> </ul> <p>Adds a new external instance definition to the database.</p> <ul> <li><code>update_xinst</code></li> </ul> <p>Updates an existing external instance definition in the database.</p> <p>The following JIL subcommands define and modify resources:</p> <ul> <li><code>delete_resource</code></li> </ul> <p>Deletes a virtual resource from the database.</p> <ul> <li><code>insert_resource</code></li> </ul> <p>Adds a new virtual resource definition to the database. JIL Subcommands</p> <p>Example JIL Script</p> <pre><code># Example of a Machine insert_machine: lowgate type: a\n# Example of Jobs insert_job: Nightly_Download job_type: box date_conditions: yes days_of_week: all start_times: \"02:00\" insert_job: Watch_4_file job_type: ft\nbox_name: Nightly_Download\nwatch_file: /DOWNLOAD/MAINFRAME/SALES.RAW watch_file_type: generate\nmachine: lowgate\ninsert_job: filter_data\njob_type: cmd\nbox_name: Nightly_Download\ncondition: success(Watch_4_file)\ncommand: filter_mainframe_info\nmachine: lowgate\nstd_in_file: /DOWNLOAD/MAINFRAME/SALES.RAW\ninsert_job: parse_data \njob_type: cmd\nbox_name: Nightly_Download c\nondition: success(filter_data) \nmachine: lowgate\ncommand: isql -U mutt -P jeff\nstd_in_file: /DOWNLOAD/MAINFRAME/SALES.SQL std_out_file: /LOG/parse_data.out \nstd_err_file: /LOG/LOG/parse_data.err\n</code></pre>"},{"location":"chap10/2Autosys_jil/#3-jil-job-type-definitions","title":"3 JIL Job Type Definitions","text":"<p>When you create a job definition, you must specify the job type. </p> <p>Job types define the type of work to be scheduled. </p> <p>For example, </p> <ul> <li>You can create a CMD job to run a Windows command, </li> <li>An FTP job to download a file from a server, </li> <li>An SAPEM job to monitor for the triggering of an SAP event. </li> <li>You can also define box jobs, which are containers that hold other jobs or box jobs. You can define your own job type.</li> </ul> <p>Each job type has required and optional attributes that define the job. </p> <p>The job types have many common attributes and CA Workload Automation AE treats them all similarly. </p> <p>The primary differences between them are the actions taken when the jobs run.</p> <p>The structure of a job depends on the job type. For example, the following illustration shows the structure of a Command, File Watcher, and Box job:</p> <p></p>"},{"location":"chap10/2Autosys_jil/#insert-a-job-definition","title":"Insert a Job Definition","text":"<p>Sometimes the job that you need to run does not have a definition stored in the database</p> <p>Follow these steps:</p> <ul> <li> <p>Do one of the following:</p> <ul> <li>Issue JIL in interactive mode.</li> <li>Open a JIL script in a text editor.</li> </ul> </li> <li> <p>Specify the following definition:</p> </li> </ul> <pre><code>insert_job: job_name \nmachine: machine_name \njob_type: type \nrequired_attribute: value \n[attribute: value...]\n</code></pre> <ul> <li><code>job_name</code> Defines a unique name for the job.</li> <li><code>machine_name</code> Specifies the name of the machine on which the job runs.</li> <li>type Specifies the type of job you are defining.</li> <li><code>required_attribute: value</code>   (Optional) Specifies that name of an optional JIL attribute and the corresponding value. The optional attributes that you can specify in a job definition depend on the type of job that you are defining.</li> <li>value  Defines the value of the corresponding attribute.</li> </ul> <p>Do one of the following:</p> <ul> <li>Enter exit if you are using interactive mode.</li> <li>Redirect the script to the jil command if you are using a script. </li> </ul> <p>The data is loaded into the database and the job is defined.</p> <p>Example: Define a Command Job</p> <p>This example runs the <code>/bin/touc</code>h command on the file named <code>/tmp/test_run.out</code>. The job runs on the UNIX client computer named unixagent.</p> <pre><code>insert_job: test_run\njob_type: CMD /* This attribute is optional for Command jobs. CMD is the default. */ machine: unixagent\ncommand: /bin/touch /tmp/test_run.out\n</code></pre>"},{"location":"chap10/2Autosys_jil/#update-a-job-definition","title":"Update a Job Definition","text":"<p>Sometimes you must modify an existing job definition. For example, you must edit the definition of a reporting job to comply with new reporting requirements. To modify the definition, use the <code>update_job</code> subcommand.</p> <pre><code>update_job: job_name \nattribute: value \n[attribute: value...]\n</code></pre>"},{"location":"chap10/2Autosys_jil/#defining-jobs-to-run-on-a-cluster","title":"Defining Jobs to Run on a Cluster","text":"<p>Defining jobs to run on a cluster helps improve workload performance. We recommend this method for the following types of jobs:</p> <ul> <li>Jobs that use shared resources</li> <li>Jobs with high CPU consumption</li> <li>Command jobs that execute client utilities</li> </ul>"},{"location":"chap10/2Autosys_jil/#delete-a-job","title":"Delete a Job","text":"<p>When you no longer need a job definition, you can delete it from the database.</p> <p>Specify the following subcommand:</p> <pre><code>delete_job: job_name\n</code></pre> <p><code>job_name</code>: </p> <p>This example deletes the <code>test_run</code> job.</p> <pre><code>delete_job: test_run\n</code></pre> <p>Running a Job After Using JIL</p> <p>After you submit a job definition to the database, it runs according to the starting parameters specified in its JIL script. </p> <p>Example: Run a Job with the sendevent Command</p> <p>This example assumes that a job named <code>test_install</code> has no starting parameters specified in its JIL script. The only way to start it is to issue the following command:</p> <pre><code>sendevent -E STARTJOB -J test_install\n</code></pre> <p>This command tells the scheduler to start the job named test_install.</p>"},{"location":"chap10/3Autosys_comp/","title":"3 Autosys Components, Configuration &amp; Validation","text":""},{"location":"chap10/3Autosys_comp/#ca-worlad-automation-ae-components","title":"CA Worlad Automation AE Components","text":""},{"location":"chap10/3Autosys_comp/#ca-workload-automation-ae-components","title":"CA Workload Automation AE Components","text":"<ul> <li>Event server (database)</li> <li>Application server </li> <li>Web server </li> <li>Scheduler </li> <li>Agent </li> <li>Client </li> </ul> <p>Event Server </p>"},{"location":"chap10/3Autosys_comp/#dual-event-server","title":"Dual Event Server","text":"<p>Dual event server is nothing but having two events servers like we can configure see a workload automation AE instance to run using Servers and this configuration is called dual event server.</p> <p>Two servers are synchronized to maintain identical data and this data is use when one event server is down </p>"},{"location":"chap10/3Autosys_comp/#application-server","title":"Application Server :","text":"<p>The application server acts as the communication interface between the event server and the client utilities. </p> <p>It receives requests from the client utilities, queries the event server, and returns the responses to the client utilities. </p>"},{"location":"chap10/3Autosys_comp/#scheduler","title":"Scheduler :","text":"<p>When you start the scheduler, it continually scans the database for events to process. </p> <p>High Avaialability</p> <ul> <li> <p>Agent</p> <ul> <li>agentwill allow us to automate monitor and manage workload on different operating environments </li> </ul> </li> <li> <p>Client </p> <ul> <li>It will include command-line interfaces such as jil job information language auto </li> </ul> </li> <li>Web Server <ul> <li>Web server is used to host the web services</li> </ul> </li> </ul>"},{"location":"chap10/3Autosys_comp/#2-checking-autosys-system-configuration","title":"2 Checking Autosys System Configuration","text":"<p>autoflags </p> <p>autoflags: Prints information about AutoSys and the system configuration. </p>"},{"location":"chap10/3Autosys_comp/#options-","title":"<code>options: -</code>","text":"<ul> <li><code>-a</code>:  Displays all autoflags information to standard output. </li> <li><code>-i</code> Displays the AutoSys tape ID number to standard output. </li> <li><code>-o</code> Displays the operating system to standard output. </li> <li><code>-d</code> Displays the database type to standard output, either SYB for Sybase or ORA for Oracle. </li> <li><code>-v</code> Displays theAutoSys version number to standard output. </li> <li><code>-r</code> Displays theAutoSys release number to standard output. </li> <li><code>-h</code> Displays the <code>host-id</code> to standard output to standard output. </li> <li><code>-n</code> Displays the <code>host-name</code> to standard output to standard output. </li> </ul> <p>Example</p> <p>autoflags -a</p> <pre><code>3 AIX SYB 11.3.6 1 coae38prodserver \n</code></pre>"},{"location":"chap10/3Autosys_comp/#how-to-check-whether-the-autosys-is-up-or-down","title":"How to check whether the Autosys is up or down","text":"<p><code>chk_auto_up</code></p> <ul> <li>This command Verifies status of the Unicenter AutoSys JM Scheduler and database. </li> <li>It determines if the Event Server (database) and the scheduler are running. <ul> <li>This is the utility you can use for debugging of Autosys </li> </ul> </li> </ul> <p><code>chk_auto_up -r 111</code> </p> <p>Command gives Event server, Scheduler and Application server status as well. </p> <p></p>"},{"location":"chap10/3Autosys_comp/#3-chk_files-attribute","title":"3 <code>chk_files</code> Attribute","text":"<p>Verify File Space Required to Start a job</p> <ul> <li><code>chk_files</code> attribute</li> <li>Unix file system</li> <li>Windows drive</li> <li>Alarm</li> <li><code>n_retrys</code></li> <li>MaxRestartTrys</li> <li>Default size in KB</li> <li>Sizes B.KB.G.M</li> </ul>"},{"location":"chap10/3Autosys_comp/#example-on-unix-machine","title":"Example on unix machine","text":"<pre><code>insert job: job_unix_chk \njob_type: CMD\nmachine: agentunix\n</code></pre> <p>command: </p> <pre><code>autorep -m agentunix\n\nchk files: /tmp 100 /home 120\n</code></pre>"},{"location":"chap10/3Autosys_comp/#example-on-windows-server","title":"Example on windows server","text":"<pre><code>insert_job: job_win_chk \njob_type: CMD\nmachine: agentwin\n</code></pre> <pre><code>command: \"C:\\Programs\\powershel.ps1\"\nchk_files: \"C:110  D:100\"\n</code></pre>"},{"location":"chap10/4Autosys_cmd/","title":"4 Austosys command","text":"<ul> <li>autoping</li> <li>autostatus</li> <li>autosyslog</li> <li><code>as_server</code></li> <li>astail</li> <li>autorep</li> </ul>"},{"location":"chap10/4Autosys_cmd/#1-autoping-command-verify-server-agent-and-client-communication","title":"1 autoping Command ---- Verify Server, Agent, and Client Communication","text":""},{"location":"chap10/4Autosys_cmd/#autoping","title":"autoping","text":"<ul> <li>Unicenter AutoSys JM Autoping Utility</li> <li>USAGE: <code>autoping [-m Machine | All][-A][-D][-x][-?]</code></li> </ul> <p>WHERE: </p> <ul> <li><code>-m</code> Machine | ALL Machine name to ping, or ALL for ALL machines </li> <li><code>-D</code>: Checks the Database connections from Application Server </li> <li><code>-A</code> Sends an ALARM if there are problems </li> <li><code>-x</code> Returns version information </li> <li><code>-?</code> Help </li> </ul>"},{"location":"chap10/4Autosys_cmd/#2-autostatus-command-report-job-status-or-global-varibale-value","title":"2 autostatus Command - Report Job Status or Global Varibale Value","text":"<p>The autostatus command is a client component utility that reports the current status of the specified job or the current value of a global variable to standard output</p> <pre><code>unicenter AutoSys JM Autostatus utility \n\nUSAGE: autostatus [-J Jobname | -G GlobalName] [-S AUTOSERV] [-x] [-?] \n\nWHERE: \n\n-J jobname Displays status of the Job \n-G globalname Displays Global variable's value \n-S instance AutoSys instance to be queried for -J or -G options \n-x          Returns version information \n-?       Help \n</code></pre> <ul> <li>Example: Check the Status of a Job on the Current Instance </li> <li>This example checks the current status of the job test install on the current instance. <ul> <li><code>autostatus -J test_job</code> </li> </ul> </li> <li>The command writes the result to standard output. For example: SUCCESS </li> </ul> <p>Example: </p> <ul> <li>Check the Value of a Global Variable </li> <li>This example checks the value of a global variable named \"Today\". <ul> <li><code>autostatus -G today</code> </li> </ul> </li> <li>The command writes the result to standard output. For example:  <code>01/21/2017</code></li> </ul>"},{"location":"chap10/4Autosys_cmd/#3-autosyslog-for-event-scheduler-application-server-and-log-file-for-job","title":"3 autosyslog for Event scheduler, Application Server, and log file for Job","text":"<p>The autosyslog command is a client component utility that displays the scheduler, application server, agent log file, or spool file for a job. </p> <pre><code>Autosys Command - autosyslog \n\nunicenter Autosys Jm log utility \n\nUSAGE: autosyslog [-e | -s | -j Job_Name][-p][-?] \n\nWHERE -e [monitor (tail -f) the event scheduler output file.]\n     -s [monitor (tail -f) the application server output file.]\n     -j job_name [inspect the latest remote agent output file for job_name] \n     -p Include the output from the environment if available (RemoteProFile) \n     -? Help \n</code></pre> <p><code>autosyslog  -e</code>: scheduler</p> <p></p> <p><code>autosyslog  -s</code>: application server</p> <p></p>"},{"location":"chap10/4Autosys_cmd/#application-server-log-file","title":"Application Server Log File","text":"<p>Path </p> <p><code>/opt/CA/UnicenterAutosysJM/autouser.PRD/out/as_server.PRD</code></p>"},{"location":"chap10/4Autosys_cmd/#4-as_server-command-run-the-application-server","title":"4 <code>as_server</code> Command Run the Application Server","text":"<p><code>as_server</code> - Runs the Unicenter AutoSys Job Management(JM) Application Server </p> <ul> <li>SYNOPSIS </li> </ul> <p><code>as_server -A autoserv</code></p> <ul> <li>DESCRIPTION </li> </ul> <p>Runs the Unicenter AutoSys JM Application Server for a specific instance.</p> <ul> <li>OPTIONS </li> </ul> <p><code>-A autoserv</code>: Specifies the instance for which to start the Application Server.</p> <p>EXAMPLES </p> <p><code>as server -A ACE</code> </p> <p>Start the Unicenter AutoSys JM Application Server for the instance ACE. </p>"},{"location":"chap10/4Autosys_cmd/#5-astail-commanddisplay-end-of-file","title":"5 astail Command\u2014Display End of File","text":"<p>Valid on UNIX </p> <p>The astail command displays the last 10 lines of the file specified in the command </p> <p>Syntax </p> <p>This command has the following format: </p> <pre><code>astail [-f filename] [-x] \n</code></pre> <p><code>-f filename</code></p> <ul> <li><code>-f</code> filename: (optional) Defines the name of the file to display. </li> <li><code>-x</code> (Optional) Returns the version number of the astail command to standard output. </li> </ul> <p>Note: To terminate the command, press <code>Ctrl+C</code>. </p> <p>Example: Display the Last 10 Lines of the Scheduler Log File </p> <p>This example displays the last 10 lines of the scheduler log file where <code>instance_name</code> is the unique <code>3-character</code> identifier chosen for this installation. </p> <pre><code>astail -f $AUTOUSER/out/event_demon.instance_name \n</code></pre>"},{"location":"chap10/4Autosys_cmd/#6-autorep-commandreport-job-machine-and-variable-information","title":"6 autorep Command\u2014Report job, Machine, and Variable Information","text":"<p>The autorep command is a client component utility that generates reports about objects such as jobs, machines, and global variables currently defined in the database. </p> <p>The autorep command retrieves data from the database to formulate the reports </p> <ul> <li>Display a summary of all currently defined jobs </li> <li>Display current machine load information </li> <li>List all relevant event information for the last run of any job or for a specified job run </li> <li>Back up job definitions by extracting definitions and saving them to an output file </li> </ul> <pre><code>USAGE: autorep [-J JobName] [-d | -s | -q | -o OverRide # -a | -w ]\n        [-B GroupName] [-I ApplicationName] [-t] \n        [-X ExternalInstanceName] [-Y JobType] [-x]\n        [-R Run_num] [-L PrintLevel] [-N Retry] \n        [-z GlobalBlobName] [-f BlobDownloadDirectory] \n        [-G GlobalName] [-M MachineName] [-D DataSource] [-?] \n\nWHERE: -J JobName \n       -I ApplicationName \n       -B GroupName \n       -o Overnum \n       -X ExternalInstance \n       -Y JobType \n       -z GlobalBlobName \n       -G GlobalName \n       -M MachineName \n       -d Generates a detail report\n       -s Generates a summary report \n       -q Generates a query report(Jil format)\n       -w Reports untruncated job name and machine name and uses the long form of job conditions \n       -t Includes the timezone in the report\n       -R Run_num  Generates the report for the job run\n       -L PrintLevel Generated Box Job hierarchy report will be limited to level specified\n       -N Retry Attempts to connect to the database for number of times before generating an error \n       -D DataSource Generates report from specified DataSource\n       -f BlobDownloadDirectory Location on disk where blob data is downloaded to\n       -a Download blob data to file as ASCII text\n       -x Returns version information \n       -?  Help \n</code></pre> <p>Examples </p> <p>View Machines </p> <pre><code>autorep -M All \n</code></pre> <p></p> <p>View Global Variables </p> <pre><code>autorep -G %AUT%\n</code></pre> <p></p> <p>Backup Global Variables </p> <pre><code>autorep -G ALL &gt; DUMP_GLOBAL_ALL\n</code></pre> <p>Backup ALL JIL's </p> <pre><code>autorep -J ALL -q &gt; DUMP_JOBDEFINITION_ALL \n</code></pre> <p>First level reporting </p> <pre><code>autorep -w -J All -L0 \n</code></pre> <p>Example </p> <pre><code>autorep -w -J %UT% -L0 | sort\n</code></pre> <p></p> <p>Second Level reporting </p> <pre><code>autorep -J ALL -L1\n</code></pre> <p>Detail info about the job execution </p> <pre><code>autorep -w -J box_AUT_daily_batch -d\n</code></pre> <p>What is currently running </p> <pre><code>autorep -d -m ALL\n</code></pre> <ul> <li><code>-d</code> Generates a detail report</li> <li><code>-M</code> MachineName </li> </ul> <p>Job Status </p> <pre><code>autorep -J &lt;box/job&gt;\n</code></pre> <p>Job Definition </p> <pre><code>autorep -J &lt;box/job&gt; -q\n</code></pre>"},{"location":"chap10/4Autosys_cmd/#autotrack-command-tracks-changes-to-the-database","title":"autotrack Command - Tracks Changes to the Database","text":"<ul> <li>autotrack can flack changes made to job definitions from JIL or the GUI. </li> <li>It cannot track changes made directly to the database through SQL commands. </li> </ul> <p>autotrack </p> <p>Tracks changes to the Unicenter AutoSys Job Management (JM) database </p> <p>USAGE </p> <pre><code>autotrack [-D data_source] [-F \"from_time\"] [-h] \n                [-J job_name|All] [-l] [-m machine] \n                [-t type] [-T \"to_time\"] [-u level] \n                [-U user_name] [-v] \n</code></pre> <p><code>-u level</code></p> <p>Updates the level of detail that autotrack writes to the database. Set level to one of following</p> <ul> <li>O The default setting, and detail. </li> <li>1 Tracks the following and condenses each tracked event to a one-line summary: <ul> <li>Job, calendar, monitor, browser, and machine  definition changes</li> <li>Job overrides</li> <li><code>autosys_secure</code>, <code>autotrack</code>,  and <code>sendevent calls</code></li> </ul> </li> <li>Tracks the same information as level 1, but also writes the entire job definition for overrides and job definition changes. <ul> <li>Level 2 is very database intensive and will significantly impair JIL per-formance</li> </ul> </li> </ul> <p><code>-U user_name</code></p> <p>Reports changes or events initiated by the specified user. </p> <p><code>-m machine</code> </p> <p>Reports changes or events initiated from the specified machine. </p> <p><code>-J job_name</code></p> <p>Identifies the job on which to report. </p> <ul> <li>To report on all jobs, enter <code>-J</code> All. </li> <li>You can use the percent (%) and underscore (<code>_</code>) characters as wildcards in this value. </li> <li>The SQL ESCAPE option is not supported for wildcards. </li> </ul> <p><code>-t type</code> </p> <p>Reports a specific event. Set type to one of the following: </p> <ul> <li>A Reports calls generated by the autosys_secure command. </li> <li>B Reports Monitor/Browser definition changes generated by JIl or the GUI. </li> <li>C Reports calendar definition changes generated BY the <code>autocal_asc</code> command or the GUI. </li> <li>J Reports job definition changes, <code>sendevent -J</code>,  or overrides to a specific job generated by JIL or the GUI. </li> <li>M Reports machine definition changes generated by JIL or the GUI. </li> <li>O Reports override definition changes generated by JIL or the GUI. </li> </ul>"},{"location":"chap10/4Autosys_cmd/#examples","title":"Examples","text":"<pre><code>autotrack -u 1 -J StartAppReport -v\n</code></pre> <pre><code>autotrack u -2 -3 StartAppsReport -v \n\nRequests level 2 verbose reporting about a job named StartAppsReport. \n</code></pre> <pre><code>autotrack -F \"02/12/2017 01:00\" -J StartAppsReport \n\nView all the changes that occurred to the job NightlyReport after 1 a.m. on February 12, 2017. \n</code></pre> <pre><code>autotrack -U sugnan -F \"02/16/2017 01:00\" -T \"02/17/2004 23:59\"\n</code></pre> <p>View all changes made by user sue over the weekend of  February 16 and 17, 2017. </p> <pre><code>autotrack -t A -m testmachine\n</code></pre> <p>View all <code>autosys_secure</code> changes that occurred from the machine gemini. The output from this command would resemble the following: </p> <pre><code>jacob@testmachine \n02/0S 19:08:12 \nauto_sysesecure change \nEDIT Super-User: jacob \nEXEC Super-User: jacob \npassword: ***************\n</code></pre> <p>Notes:</p> <p>Only the EXEC or EDIT superuser can change the tracking level. </p>"},{"location":"chap10/4Autosys_cmd/#7-forecast-commandreport-job-flow","title":"7 forecast Command\u4e00Report Job Flow","text":"<p>The forecast report displays day-based jobs and event-based jobs expected to occur during a specified time frame of any length </p>"},{"location":"chap10/4Autosys_cmd/#syntax","title":"Syntax","text":"<ul> <li>This command has the following formats: </li> </ul> <pre><code>forecast {-M machine_name | -J job_name | -M machine_name -J job_name | -F {\"mm/dd/yyyy HH:MM | mm/dd/yyyy HH:MM-mm/dd/yyyy HH:MM)[-T \"mm/dd/yyyy HH:MM\"][OPTIONS] \n</code></pre> <ul> <li><code>-s</code> (Optional) Sorts the data by job names and start times. </li> <li><code>-h</code> (Optional) Generates a report without header information. </li> <li><code>-n</code> (Optional) Generates a report in narrow format. </li> </ul> <p>the forecast command considers a the following job attributes:</p> <ul> <li><code>-start_mins</code> </li> <li><code>-start_times</code> </li> <li><code>-run_windows</code> </li> <li><code>-run_calendar</code> </li> <li><code>-exclude_calendar</code> </li> <li><code>-days_of_week</code></li> </ul> <p>forecast command ignores global variables, job overrides, cross-instance dependencies, DST changes, and the timezone attribute associated with a job. </p> <p>The forecast report is based on the local time zone. </p> <p>Examples </p> <p><code>forecast -m machinetest -F \"05/27/2017\"</code></p> <p>report forecasts when each job runs between <code>00:00</code> on </p> <p><code>May 27, 2017 and 23:59 on May 27, 2017</code></p>"},{"location":"chap10/4Autosys_cmd/#3-chase-command-verify-job-starting-or-running-status","title":"3 chase Command Verify Job STARTING or RUNNING Status","text":"<p>Verifies the status of jobs that the database indicates are running and checks the associated agents. </p> <p>The database is also inspected to determine which jobs are in the STARTING or RUNNING state, and on which machine. </p> <p>For each client, chase passes a list of jobs that are supposed to be running there to an agent. </p> <p>The agent then verifies that the processes are running. </p> <p>For Command jobs running on a UNIX machine, the agent also checks for the pid of the UNIX process. </p> <p>When verifying that the agent is running, chase checks that the agent has a lock on the agent log file. This is more reliable than checking the agent process ID. </p> <p>When the scheduler is started (with the eventor command), chase is automatically invoked. </p> <p>Because chase uses the same mechanism as the scheduler to communicate with the agent machines, it gives an accurate picture of the system state. </p> <p>Note: The scheduler does not have to be running while chase runs, but the database must be available. </p> <p>When chase detects errors, the client sends them to  standard output. </p> <p>Optional parameters used with chase further determine the actions to take for error conditions. </p> <ul> <li>The <code>-A</code> option sends an alarm to alert the user that problems were found. </li> <li>When the <code>-E</code> option is specified, chase forces a FAILURE of jobs that should be running but are not.</li> <li>When the <code>n_retrys</code> attribute is defined, this triggers an automatic restart of the job. </li> <li>The scheduler must be running for chase to automatically restart jobs. </li> </ul> <p>It is a good idea to run chase automatically at regular intervals to track problems on the network. </p> <p>For example, if a machine becomes unreachable while running a job, chase will detect that the machine is down and send an alarm. </p> <p>If a user has a monitor running, they are also alerted to the problem. </p>"},{"location":"chap10/4Autosys_cmd/#options-a","title":"OPTIONS -A","text":"<p>sends alarms when errors occur. </p> <ul> <li><code>&lt;:vspace&gt; -E</code> </li> </ul> <p>Puts a job in FAILURE status when the job and its agent are not running on the client but the database indicates they should be. in this case, the job restarts if the job definition includes the ruetrys attribute. </p> <ul> <li><code>&lt;:vspace&gt;</code></li> </ul> <p>Note: when you run chase with no options, unicenter Autosys JM performs all chase activities and writes the results to standard output, but sends no alarms or job restart events. </p> <ul> <li>&lt;:vspace&gt; </li> </ul> <p>EXAMPLE </p> <p>If a job is running longer than expected and you suspect it may have abnorrally ended (but still shows as running), you should run chase. </p> <p>To verify that the job is running, receive an alarm if there is an inconsistency, and restart the job if necessary, enter this: </p> <p><code>&lt;:vspace&gt;</code> </p> <p><code>chase -A -E</code></p>"},{"location":"chap10/5Autosys_job_cmd/","title":"5 Manage Job in the Database","text":""},{"location":"chap10/5Autosys_job_cmd/#1-delete-a-box-job-from-the-database","title":"1 Delete a Box Job from the Database","text":"<p>The <code>delete_box</code> subcommand deletes the specified box job and all the jobs in that box from the database </p> <p>Syntax </p> <p><code>delete_box</code>: <code>box_name</code></p> <p>Example1</p> <p><code>delete_box</code>: Box1</p>"},{"location":"chap10/5Autosys_job_cmd/#2-delete-a-job-from-the-database","title":"2 Delete a Job from the Database","text":"<p>Syntax </p> <p><code>delete_job: job_name</code> </p>"},{"location":"chap10/5Autosys_job_cmd/#add-a-job-to-the-database","title":"Add a Job to the Database","text":"<p>The <code>insert_job</code> subcommand adds a job definition to the database. </p> <p>Syntax </p> <p><code>insert_job: job_name</code> </p> <p>Example1</p> <ul> <li><code>insert_job: job1</code> </li> <li><code>machine: prod</code> </li> <li><code>command: /home/user/job_status.ksh</code> </li> <li><code>job_type:cmd</code> </li> </ul> <p>Example2 </p> <ul> <li><code>insert_job: file</code> </li> <li><code>job_type: fw</code> </li> <li><code>machine: prod</code> </li> <li><code>watch_file: \"C:\\myfiles\\testfile\"</code></li> </ul> <p>Example3 </p> <ul> <li><code>insert_job: testjob</code></li> <li><code>job_type: box</code></li> </ul>"},{"location":"chap10/5Autosys_job_cmd/#3-update-an-existing-box-or-job-definition-in-the-database","title":"3 Update an Existing Box or Job Definition in the Database","text":"<p>Syntax </p> <p><code>update_job: job_name</code></p> <p>Example </p> <pre><code>update_job: job1 \nmachine: pre-prod \n</code></pre> <p>Original Job definition </p> <pre><code>insert_job: job1 \nmachine: prod \nStart_times: \"04:00\"\n</code></pre>"},{"location":"chap10/5Autosys_job_cmd/#4-automatically-delete-a-job-on-completion","title":"4 Automatically Delete a Job on Completion","text":"<p>The <code>auto_delete</code> attribute specifies the number of hours to wait after a job completes. </p> <p>Syntax </p> <p><code>auto_delete : hours | 0 | -1</code></p> <p>Example </p> <pre><code>insert_job: jobs \njob_type: CMD \nmachine: prod \ncommand: /home/user/job_status.ksh \nauto_delete:5 \n</code></pre>"},{"location":"chap10/5Autosys_job_cmd/#5-define-the-number-of-times-to-restart-a-job-after-a-failure","title":"5 Define the Number of Times to Restart a Job After a Failure","text":"<p>Syntax </p> <p><code>n_retrys</code>:attempts</p> <ul> <li>Applicable for only application failures </li> <li>If job is terminated then no action of <code>n_retrys</code> </li> <li>Not applicable for network failures </li> <li>network failures are controlled by the MaxRestartTrys parameter in the configuration file.</li> </ul>"},{"location":"chap10/6autosys_vir_resouce/","title":"6 Autotsys virtual resource management","text":""},{"location":"chap10/6autosys_vir_resouce/#1-delete-a-virtual-resource","title":"1 Delete a Virtual Resource","text":"<p>Syntax </p> <p><code>delete_resource: resource_name</code></p> <p>Example1 </p> <pre><code>delete_resource: global_resource_name \n</code></pre> <p>**Example2 **</p> <pre><code>delete_resource: machine_resource _name \nmachine: machine_name \n</code></pre>"},{"location":"chap10/6autosys_vir_resouce/#2-types-of-virtual-resource","title":"2 Types of Virtual Resource","text":"<p>Syntax </p> <p><code>res_type: D | R | T</code></p> <ul> <li>D - Depletable Resource </li> <li>R - Renewable /Borrowed resource </li> <li>T - Threshold /Sizing resource </li> </ul> <p>Note:You cannot update a resource's type using the <code>update_resource</code> subcommand. </p> <p>Example </p> <pre><code>insert_resource: renew_res_name \nres_type: R \namount: 10\n</code></pre> <pre><code>insert_job: res_dependency_job \njob_type: CMD \nmachine: testmachine \ncommand: /home/testscript.ksh \nresources: (renew_res_name, QUANTITY=5, FREE=Y) \n</code></pre>"},{"location":"chap10/6autosys_vir_resouce/#3-amount-attribute-of-virtual-resource","title":"3 Amount attribute of Virtual Resource","text":"<p>Syntax </p> <p>The amount attribute specifies the number of units to assign to a virtual resource. </p> <p><code>amount:value</code></p> <p>Example </p> <pre><code>update_resource: res_test \namount: 20 \n</code></pre> <p>Example2 </p> <pre><code>update_resource: res_test \nmachine: testmachine \namount: +5 \n</code></pre>"},{"location":"chap10/7autosys_shell/","title":"7 Shell Script to check Autosys agent installed","text":"<p>Default Path for <code>agentparm.txt</code></p> <pre><code>Install directory/SystemAgent/agent_name\n</code></pre> <p><code>shell script code</code></p> <pre><code>#!/bin/ksh\nFILE=\"/home/unicenter/WA_AGENT/agentparm.txt\"\n\n\nif [-e  \"SFILE\"]:\nthen\n    cd /home/unicenter/WA_AGENT\n    echo \"Hostname is: 'hostname', AgentPARAM File exists, 'cat agentparm.txt| grep version' \"\n    else\n    echo \"File $FILE does not exist\"\nfi\n</code></pre> <p>Output</p> <pre><code>Hostname is: eu-testci-pprd, AgentPARAM File exists,\ninstaller.version=11.4.00.00\n</code></pre>"},{"location":"chap2/1broadcast_network/","title":"\u7b2c\u4e00\u8282 \u4e00\u5bf9\u591a\u901a\u8baf\u5982\u4f55\u5b9e\u73b0","text":"<p>\u7edd\u5927\u591a\u6570\u901a\u8baf\u65b9\u5f0f\uff0c\u65e0\u8bba\u662f\u9762\u5411\u8fde\u63a5\u7684 HTTP \u534f\u8bae\uff0c\u8fd8\u662f\u65e0\u8fde\u63a5\u7684 DNS \u534f\u8bae\uff0c\u90fd\u662f\u4e00\u5bf9\u4e00\u6536\u53d1\u6d88\u606f\u7684</p> <p>\u9664\u4e86\u4e00\u5bf9\u4e00\uff0c\u8fd8\u6709\u4e00\u5bf9\u591a\u7684\u901a\u8baf\u65b9\u5f0f\uff0c\u5b83\u5728\u7f51\u7edc\u8d44\u6e90\u7684\u5229\u7528\u4e0a\u6548\u7387\u8981\u6bd4\u4e00\u5bf9\u4e00\u9ad8\u5f97\u591a\u3002\u8fd9\u79cd\u4e00\u5bf9\u591a\u7684\u901a\u8baf\u65b9\u5f0f\uff0c\u5728\u5c40\u57df\u7f51\u4e2d\u6709\u5f88\u5e7f\u6cdb\u7684\u5e94\u7528\uff0c\u5e38\u89c1\u7684 ARP \u6b3a\u9a97\u3001\u6cdb\u6d2a\u653b\u51fb\u7b49\uff0c\u90fd\u662f\u901a\u8fc7\u4e00\u5bf9\u591a\u901a\u8baf\u8fdb\u884c\u7684\u3002</p> <p>\u5f53\u5e94\u7528\u573a\u666f\u4e2d\u7528\u4e00\u5bf9\u591a\u4ee3\u66ff\u4e00\u5bf9\u4e00\u901a\u8baf\u65f6\uff0c\u53d1\u9001\u65b9\u6027\u80fd\u4f1a\u83b7\u5f97\u5f88\u5927\u7684\u63d0\u5347\uff0c\u6574\u4e2a\u5c40\u57df\u7f51\u7684\u6548\u7387\u4e5f\u4f1a\u63d0\u9ad8\u3002\u6bd4\u5982\uff0c\u6e90\u4e3b\u673a\u7684\u5e26\u5bbd\u53ea\u6709 1Gbps\uff0c\u5982\u679c\u91c7\u7528\u4e00\u5bf9\u4e00\u7684\u65b9\u5f0f\u5411 100 \u4e2a\u5ba2\u6237\u7aef\u53d1\u9001\u6d41\u5a92\u4f53\uff0c\u8fd9 100 \u53f0\u4e3b\u673a\u7684\u5e26\u5bbd\u4e4b\u548c\u4e0d\u4f1a\u8d85\u8fc7 1Gbps\u3002\u4f46\u91c7\u7528\u4e00\u5bf9\u591a\u4f20\u8f93\u65f6\uff0c\u603b\u5e26\u5bbd\u5c31\u53ef\u4ee5\u8fbe\u5230 100Gbps\u3002</p>"},{"location":"chap2/1broadcast_network/#1","title":"1\u3001\u5e7f\u64ad\u662f\u600e\u4e48\u5b9e\u73b0\u7684\uff1f","text":"<p>\u4e00\u5bf9\u591a\u901a\u8baf\u5206\u4e3a\u4e24\u79cd\uff1a\u5bf9\u5c40\u57df\u7f51\u5185\u6240\u6709\u4e3b\u673a\u53d1\u9001\u6d88\u606f\u7684\u53eb\u505a\u5e7f\u64ad\uff0c\u800c\u5bf9\u90e8\u5206\u4e3b\u673a\u53d1\u9001\u6d88\u606f\u7684\uff0c\u5219\u53eb\u505a\u7ec4\u64ad</p>"},{"location":"chap2/1broadcast_network/#1-1","title":"1-1 \u5e7f\u64ad\u662f\u600e\u4e48\u5b9e\u73b0","text":"<p>\u4f7f\u7528\u5e7f\u64ad\u8981\u6539\u7528 UDP \u534f\u8bae\u3002\u53ef\u80fd\u4f60\u4f1a\u95ee\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u4f7f\u7528\u6700\u719f\u6089\u7684 TCP \u534f\u8bae\u5462\uff1f\u8fd9\u8981\u4ece TCP \u534f\u8bae\u7684\u5206\u5c42\u8bf4\u8d77\u3002</p> <p>\u5f53\u4f60\u8bbf\u95ee Internet \u7ad9\u70b9\u65f6\uff0cIP \u534f\u8bae\u4f1a\u5c06\u6570\u636e\u901a\u8fc7\u7f51\u7edc\u8bbe\u5907\u7a7f\u8d8a\u591a\u4e2a\u536b\u661f\u3001\u5149\u7ea4\u7b49\u7f51\u7edc\uff0c\u624d\u80fd\u9001\u5230\u670d\u52a1\u5668\u3002\u800c\u7f51\u7edc\u8bbe\u5907\u5929\u7136\u5c31\u62e5\u6709\u5e7f\u64ad\u80fd\u529b\uff0c\u5f53\u5b83\u5728\u4e00\u4e2a\u7f51\u7edc\u7aef\u53e3\u4e0a\u6536\u5230\u4e3b\u673a\u53d1\u6765\u7684\u62a5\u6587\u65f6\uff0c\u53ef\u4ee5\u5411\u5176\u4ed6\u7aef\u53e3\u4e0a\u7684\u6240\u6709\u4e3b\u673a\u91cd\u53d1\u4e00\u904d\uff0c\u8fd9\u5c31\u662f\u5e7f\u64ad\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p>\u867d\u7136 IP \u534f\u8bae\u5df2\u7ecf\u5177\u6709\u5e7f\u64ad\u529f\u80fd\uff0c\u4f46\u5b9e\u9645\u7f16\u7a0b\u4e2d\u5e76\u4e0d\u4f1a\u76f4\u63a5\u4f7f\u7528 IP \u534f\u8bae\u53d1\u9001\u5e7f\u64ad\uff0c\u56e0\u4e3a\u5b83\u5f88\u96be\u4e0e\u8fdb\u7a0b\u5173\u8054\u8d77\u6765\u3002</p> <p></p> <p>\u6839\u636e\u7f51\u7edc\u5206\u5c42\u6a21\u578b\uff0c\u4e0a\u5c42\u534f\u8bae\u53ef\u4ee5\u4f7f\u7528\u4e0b\u5c42\u534f\u8bae\u7684\u529f\u80fd\uff0c\u6240\u4ee5\u4f20\u8f93\u5c42\u534f\u8bae\u62e5\u6709 IP \u534f\u8bae\u7684\u5e7f\u64ad\u80fd\u529b\u3002\u540c\u65f6\uff0c\u4f20\u8f93\u5c42\u901a\u8fc7\u7aef\u53e3\u53f7\u628a\u7f51\u7edc\u62a5\u6587\u548c\u8fdb\u7a0b\u5173\u8054\u5728\u4e86\u4e00\u8d77\uff0c\u5c31\u50cf TCP \u7684 80 \u7aef\u53e3\uff0c\u628a HTTP \u6d88\u606f\u4e0e Nginx \u7b49 Web Server \u5173\u8054\u5728\u4e00\u8d77\u3002</p> <p></p> <p>\u7136\u800c\uff0c\u4f20\u8f93\u5c42\u7684 TCP \u534f\u8bae\u4e3a\u4e86\u4fdd\u8bc1\u53ef\u9760\u6027\uff0c\u5efa\u7acb\u4e86\u903b\u8f91\u4e0a\u7684\u8fde\u63a5\u6982\u5ff5\uff0c\u7531\u4e8e\u4e00\u4e2a\u8fde\u63a5\u4e0a\u53ea\u80fd\u6709\u4e24\u65b9\uff0c\u6240\u4ee5 TCP \u65e0\u6cd5\u8fdb\u884c\u4e00\u5bf9\u591a\u901a\u8baf\u3002</p> <p>\u800c\u4f20\u8f93\u5c42\u7684 UDP \u534f\u8bae\u65e0\u9700\u5efa\u7acb\u8fde\u63a5\uff0c\u6240\u4ee5\u6211\u4eec\u5e38\u7528 UDP \u534f\u8bae\u53d1\u9001\u5e7f\u64ad\u3002</p>"},{"location":"chap2/1broadcast_network/#1-2","title":"1-2 \u5e7f\u64ad\u7684\u6027\u80fd\u9ad8","text":"<ul> <li>\u9996\u5148\uff0c\u4ea4\u6362\u673a\u76f4\u63a5\u8f6c\u53d1\u7ed9\u63a5\u6536\u65b9\uff0c\u8981\u6bd4\u4ece\u53d1\u9001\u65b9\u5230\u63a5\u6536\u65b9\u7684\u4f20\u8f93\u8def\u5f84\u66f4\u77ed\u3002</li> <li>\u5176\u6b21\uff0c\u539f\u672c\u9700\u8981\u53d1\u9001\u65b9\u590d\u5236\u591a\u4efd\u62a5\u6587\u518d\u9010\u4e00\u53d1\u9001\u81f3\u5404\u4e2a\u63a5\u53d7\u8005\u7684\u5de5\u4f5c\uff0c\u88ab\u4ea4\u6362\u673a\u5b8c\u6210\u4e86\uff0c\u8fd9\u65e2\u5206\u62c5\u4e86\u53d1\u9001\u65b9\u7684\u8d1f\u8f7d\uff0c\u4e5f\u5145\u5206\u4f7f\u7528\u4e86\u6574\u4e2a\u7f51\u7edc\u7684\u5e26\u5bbd\u3002</li> </ul> <p>\u4ea4\u6362\u673a\u6536\u5230\u6d88\u606f\u540e\uff0c\u600e\u4e48\u77e5\u9053\u8fd9\u662f\u5e7f\u64ad\u62a5\u6587\u5e76\u8f6c\u53d1\u7ed9\u6574\u4e2a\u7f51\u7edc\u5462\uff1f</p> <p>\u5f53\u4ea4\u6362\u673a\u6536\u5230\u76ee\u6807 MAC \u5730\u5740\u662f ff:ff:ff:ff:ff:ff \u7684\u62a5\u6587\u65f6\uff0c\u4fbf\u77e5\u9053\u8fd9\u662f\u4e00\u4e2a\u5e7f\u64ad\u62a5\u6587\uff0c\u624d\u4f1a\u5c06\u5b83\u8f6c\u53d1\u7ed9\u5c40\u57df\u7f51\u4e2d\u7684\u6240\u6709\u4e3b\u673a\uff0c\u5426\u5219\u53ea\u4f1a\u8f6c\u53d1\u7ed9 MAC \u5730\u5740\u5bf9\u5e94\u7aef\u53e3\u4e0a\u7684\u4e3b\u673a\u3002</p> <p>\u4e0d\u8fc7\uff0c\u6211\u4eec\u5199\u4ee3\u7801\u65f6\u65e0\u6cd5\u63a7\u5236\u5e95\u5c42\u7684 MAC \u5730\u5740\uff0c\u53ea\u80fd\u586b\u5199\u76ee\u6807 IP \u5730\u5740\u3002\u4ec0\u4e48\u6837\u7684\u76ee\u6807 IP \u5730\u5740\uff0c\u4f1a\u751f\u6210\u5e7f\u64ad MAC \u5730\u5740\u5462\uff1f</p> <p>\u5982\u679c\u53ea\u662f\u5bf9\u6240\u5728\u5b50\u7f51\u8fdb\u884c\u5e7f\u64ad\uff0c\u90a3\u4e48\u4f7f\u7528\u53d7\u9650\u5e7f\u64ad\u5730\u5740 255.255.255.255 \u5c31\u53ef\u4ee5\u4e86\uff1b\u5982\u679c\u5c40\u57df\u7f51\u5212\u5206\u4e86\u591a\u4e2a\u5b50\u7f51\uff0c\u4e3b\u673a\u9700\u8981\u5411\u5176\u4ed6\u5b50\u7f51\u5e7f\u64ad\uff0c\u5219\u9700\u8981\u6b63\u786e\u5730\u8bbe\u7f6e\u76f4\u63a5\u5e7f\u64ad\u5730\u5740\uff08\u8def\u7531\u5668\u9700\u8981\u6253\u5f00\u76f4\u63a5\u5e7f\u64ad\u529f\u80fd\uff09\u3002</p>"},{"location":"chap2/1broadcast_network/#2-ip","title":"2\u3001\u5982\u4f55\u6b63\u786e\u5730\u8bbe\u7f6e\u76f4\u63a5\u5e7f\u64ad IP \u5730\u5740\uff1f","text":"<p>2-1 IP \u5730\u5740\u7684\u6784\u6210</p> <p>\u7531\u4e8e IP \u534f\u8bae\u9700\u8981\u8de8\u8d8a\u591a\u4e2a\u7f51\u7edc\u5de5\u4f5c\uff0c\u6240\u4ee5 IP \u5730\u5740\u88ab\u4e00\u5206\u4e3a\u4e8c\uff0c\u5305\u62ec\u524d\u8fb9\u7684\u7f51\u7edc ID \u548c\u540e\u8fb9\u7684\u4e3b\u673a ID\uff0c\u5176\u4e2d\uff0c\u7f51\u7edc ID \u7528\u4e8e\u4e0d\u540c\u7f51\u7edc\u95f4\u7684\u5bfb\u5740\uff0c\u800c\u4e3b\u673a ID \u5219\u7528\u4e8e\u5728\u672c\u5730\u5c40\u57df\u7f51\u5185\u901a\u8baf\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u4f60\u7684\u5c40\u57df\u7f51 IP \u5730\u5740\u662f 192.168.0.101\uff0c\u90a3\u4e48\u7f51\u7edc ID \u5c31\u662f 192.168.0\uff0c\u800c\u4e3b\u673a ID \u5219\u662f 101\uff08\u8fd9\u91cc\u5047\u5b9a\u7f51\u7edc\u7ba1\u7406\u5458\u6ca1\u6709\u7ee7\u7eed\u5212\u5206 C \u7c7b\u5b50\u7f51\uff09\u3002</p> <p>\u8fd9\u662f\u56e0\u4e3a\uff0c\u4ee5 192.168 \u6253\u5934\u7684 IP \u5730\u5740\uff0c\u88ab\u79f0\u4e3a C \u7c7b\u5730\u5740\uff0c\u800c C \u7c7b\u5730\u5740\u4e2d\uff0c\u6700\u540e 1 \u4e2a\u5341\u8fdb\u5236\u6570\u5b57\u4ee3\u8868\u4e3b\u673a ID\u3002</p> <p>\u5982\u679c IP \u5730\u5740\u662f 172.16.20.227\uff0c\u8fd9\u5c31\u662f B \u7c7b\u5730\u5740\uff0c\u6b64\u65f6\uff0c172.16 \u662f\u7f51\u7edc ID\uff0c\u800c 20.227 \u624d\u662f\u4e3b\u673a ID\u3002</p> <p>\u6240\u4ee5\uff0cIP \u5730\u5740\u7684\u524d\u7f00\u6570\u5b57\u4e0d\u540c\uff0c\u4e3b\u673a ID \u7684\u5212\u5206\u4f4d\u7f6e\u4e5f\u4e0d\u540c\u3002\u4e8b\u5b9e\u4e0a\uff0cIP \u5730\u5740\u4e00\u5171\u88ab\u5212\u5206\u4e3a A\u3001B\u3001C\u3001D\u3001E\uff0c5 \u4e2a\u7c7b\u522b\uff0c\u5b83\u7684\u5212\u5206\u4f9d\u636e\u6b63\u662f IP \u5730\u5740\u8f6c\u6362\u4e3a\u4e8c\u8fdb\u5236\u540e\uff0c\u7528\u524d 4 \u4e2a\u6bd4\u7279\u4f4d\u4f5c\u4e3a\u4f9d\u636e\u7684\u3002\u5982\u679c\u7b2c 1 \u4e2a\u6bd4\u7279\u4f4d\u4e3a 0\uff0c\u8fd9\u5c31\u662f A \u7c7b\u5730\u5740\uff0c\u5b83\u7684\u7f51\u7edc ID \u662f IP \u5730\u5740\u7684\u7b2c 1 \u5230\u7b2c 8 \u6bd4\u7279\u4f4d\uff0c\u800c\u4e3b\u673a ID \u5219\u662f\u968f\u540e\u7684 24 \u4e2a\u6bd4\u7279\u4f4d\u3002\u5982\u679c\u5c40\u57df\u7f51 IP \u5730\u5740\u7b2c 1 \u4e2a\u6570\u5b57\u662f 10\uff0c\u8fd9\u5c31\u662f A \u7c7b\u79c1\u6709\u5730\u5740\uff08\u5c40\u57df\u7f51\u4e2d\u7684\u5730\u5740\u4e0d\u80fd\u5728\u516c\u7f51\u4e2d\u4f7f\u7528\uff0c\u7edf\u79f0\u4e3a\u79c1\u6709\u5730\u5740\u6216\u8005\u5185\u7f51\u5730\u5740\uff09\u3002</p> <p></p> <ul> <li>\u7c7b\u4f3c\u7684\uff0c\u82e5\u524d 2 \u4e2a\u6bd4\u7279\u4f4d\u662f 10\uff0c\u5219\u662f B \u7c7b\u5730\u5740\uff0c\u5b83\u7684\u4e3b\u673a ID \u662f\u540e 16 \u4f4d\uff1b</li> <li>\u5982\u679c\u524d 3 \u4e2a\u6bd4\u7279\u4f4d\u4e3a 110\uff0c\u8fd9\u5c31\u662f C \u7c7b\u5730\u5740\uff0c\u5b83\u7684\u4e3b\u673a ID \u662f\u540e 8 \u4f4d\u3002\u663e\u7136\uff0c\u4ee5 192 \u6253\u5934\u7684\u5730\u5740\uff0c\u524d 3 \u4f4d\u6b63\u662f 110\uff0c\u6240\u4ee5\u8fd9\u662f C \u7c7b\u5730\u5740\u3002</li> </ul> <p></p> <p>\u6b64\u5916\u8fd8\u6709 D \u7c7b\u7ec4\u64ad\u5730\u5740\u548c E \u7c7b\u9884\u7559\u5b9e\u9a8c\u5730\u5740\u3002</p>"},{"location":"chap2/1broadcast_network/#2-2-id-ip","title":"2-2 \u4fee\u6539\u4e3b\u673a ID \u5c06 IP \u5730\u5740\u6539\u4e3a\u76f4\u63a5\u5e7f\u64ad\u5730\u5740","text":"<p>\u5982\u679c\u4f60\u7559\u5fc3\u89c2\u5bdf IP \u5730\u5740\uff0c\u4f1a\u53d1\u73b0\u4e3b\u673a ID \u4e0d\u4f1a\u51fa\u73b0\u5168 0 \u548c\u5168 1 \u8fd9\u4e24\u79cd\u60c5\u51b5\uff0c\u8fd9\u662f\u56e0\u4e3a\u5168 0 \u548c\u5168 1 \u6709\u7279\u6b8a\u7528\u9014\uff0c\u5176\u4e2d\u5168 0 \u7279\u6307\u5b83\u81ea\u5df1\uff08\u6240\u4ee5 0.0.0.0 \u53ef\u4ee5\u6307\u4ee3\u672c\u673a IP\uff09\uff0c\u800c\u5168 1 \u8868\u793a\u5168\u90e8\u4e3b\u673a\u3002</p> <p>\u6240\u4ee5\uff0c\u4e3b\u673a ID \u7684\u6bd4\u7279\u4f4d\u5168\u90e8\u8bbe\u4e3a 1 \u540e\u5c31\u662f\u5e7f\u64ad\u5730\u5740\u3002 \u6bd4\u5982\uff0c<code>192.168.0.101</code> \u662f C \u7c7b\u5730\u5740\uff0c\u628a\u4e3b\u673a ID \u4ece 101 \u6539\u4e3a 255 \u540e\uff0c\u5c31\u53ef\u4ee5\u7528 <code>192.168.0.255</code> \u53d1\u9001\u5e7f\u64ad\u4e86\u3002</p> <p>\u4e00\u4e2a A \u7c7b\u7f51\u7edc\u53ef\u4ee5\u5bb9\u7eb3\u5343\u4e07\u53f0\u4e3b\u673a\uff0cB \u7c7b\u7f51\u7edc\u5219\u53ea\u80fd\u5bb9\u7eb3 6 \u4e07\u591a\u53f0\u4e3b\u673a\uff0cC \u7c7b\u7f51\u7edc\u5219\u6700\u591a\u5bb9\u7eb3 254 \u53f0\u4e3b\u673a\u3002</p> <p>\u4ec5\u6709\u7684\u4e09\u7c7b\u7f51\u7edc\u4e2d\u4e3b\u673a\u6570\u91cf\u5dee\u8ddd\u592a\u5927\uff0c\u800c\u4e16\u754c\u4e0a\u5b58\u5728\u5404\u79cd\u89c4\u6a21\u7684\u4f01\u4e1a\uff0c\u5b83\u4eec\u6240\u9700\u7f51\u7edc\u4e2d\u7684\u4e3b\u673a\u89c4\u6a21\u5343\u5dee\u4e07\u522b\uff0c\u4e0a\u8ff0\u5212\u5206\u65b9\u5f0f\u592a\u8fc7\u5355\u4e00\uff0c\u65e0\u6cd5\u6ee1\u8db3\u5404\u7c7b\u4f01\u4e1a\u7684\u9700\u6c42\uff0c\u4e8e\u662f\u8bde\u751f\u4e86 CIDR \u8fd9\u79cd\u65b0\u7684\u5212\u5206\u65b9\u5f0f\uff0c\u5b83\u901a\u8fc7\u5b50\u7f51\u63a9\u7801\uff08\u6216\u8005\u53eb Netmask\uff09\uff0c\u53ef\u4ee5\u5728\u4efb\u610f\u7684\u4f4d\u7f6e\u5c06 IP \u5730\u5740\u62c6\u5206\u4e3a\u7f51\u7edc ID \u548c\u4e3b\u673a ID\uff0c\u6269\u5c55\u4e86 A\u3001B\u3001C \u4e09\u7c7b\u7f51\u7edc\u7684\u7528\u6cd5\u3002</p> <p>\u5f53\u4f60\u67e5\u770b\u4e3b\u673a\u7684 IP \u5730\u5740\u65f6\uff0c\u5c31\u4f1a\u770b\u5230\u5176\u540e\u8ddf\u7740\u4e00\u4e2a\u7c7b\u4f3c IP \u5730\u5740\u7684\u5b50\u7f51\u63a9\u7801\u3002\u5b50\u7f51\u63a9\u7801\u5fc5\u987b\u628a\u5b83\u5c55\u5f00\u6210\u4e8c\u8fdb\u5236\u624d\u80fd\u4f7f\u7528\uff0c\u8fd9\u6837\uff0c\u63a9\u7801\u524d N \u4f4d\u4e3a 1 \u65f6\uff0c\u5c31\u8868\u793a IP \u5730\u5740\u7684\u524d N \u4f4d\u662f\u7f51\u7edc ID\uff0c\u800c\u63a9\u7801\u540e\u9762\u5269\u4f59\u7684\u4f4d\u5168\u662f 0\uff0c\u8868\u793a IP \u5730\u5740\u5bf9\u5e94\u7684\u4f4d\u662f\u4e3b\u673a ID\u3002</p> <p>\u6bd4\u5982\uff0c\u82e5 192.168.0.101 \u7684\u5b50\u7f51\u63a9\u7801\u662f 255.255.255.192\uff0c\u5c31\u8868\u793a IP \u5730\u5740\u7684\u524d 26 \u4f4d\u662f\u7f51\u7edc ID\uff0c\u540e 6 \u4f4d\u662f\u4e3b\u673a ID\uff0c\u5c06\u4e3b\u673a ID \u7f6e\u4e3a\u5168 1 \u540e\uff0c\u5c31\u5f97\u5230\u4e86\u5b83\u7684\u5e7f\u64ad\u5730\u5740 192.168.0.127\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u6211\u4eec\u8bbe\u7f6e\u597d IP \u5730\u5740\u540e\uff0c\u518d\u628a socket \u53e5\u67c4\u8bbe\u7f6e <code>SO_BROADCAS</code> \u5c5e\u6027\uff0c\u5c31\u53ef\u4ee5\u53d1\u9001\u5e7f\u64ad\u4e86\u3002\u5e7f\u64ad\u867d\u7136\u6709\u5f88\u591a\u4f18\u70b9\uff0c\u53ef\u662f\u4e00\u65e6\u88ab\u6ee5\u7528\uff0c\u5f88\u5bb9\u6613\u4ea7\u751f\u7f51\u7edc\u98ce\u66b4\uff0c\u6240\u4ee5\u8def\u7531\u5668\u9ed8\u8ba4\u662f\u4e0d\u8f6c\u53d1\u5e7f\u64ad\u62a5\u6587\u7684\u3002</p>"},{"location":"chap2/1broadcast_network/#3","title":"3\u3001\u7528\u66f4\u7cbe\u51c6\u7684\u7ec4\u64ad\u6765\u505a\u670d\u52a1\u53d1\u73b0","text":"<p>\u5f53\u4f60\u7528 UDP \u5e7f\u64ad\u6765\u505a\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u670d\u52a1\u53d1\u73b0\uff0c\u4f1a\u9047\u5230\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff1a\u82e5\u5e76\u975e\u7f51\u7edc\u5185\u7684\u6240\u6709\u4e3b\u673a\u90fd\u5c5e\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\uff0c\u90a3\u4e48\uff0c\u5f53\u6307\u5b9a\u4e86\u7aef\u53e3\u7684 UDP \u5e7f\u64ad\u62a5\u6587\u5230\u8fbe\u5176\u4ed6\u4e3b\u673a\u65f6\uff0c\u4f1a\u600e\u4e48\u6837\u5462\uff1f\u8fd9\u4e9b\u5e7f\u64ad\u62a5\u6587\u5728\u8fd9 3 \u4e2a\u6b65\u9aa4\u540e\u4f1a\u88ab\u4e22\u5f03\uff1a</p> <ul> <li>\u7b2c 1 \u6b65\uff0c\u7f51\u5361\u8bbe\u5907\u6536\u5230\u62a5\u6587\u540e\uff0c\u67e5\u770b\u62a5\u6587\u4e2d\u7684\u76ee\u6807 MAC \u5730\u5740\u662f\u5426\u4e0e\u672c\u673a\u7684 MAC \u5730\u5740\u5339\u914d\uff0c\u5982\u679c\u4e0d\u5339\u914d\u5c31\u4f1a\u4e22\u5f03\u3002\u5e7f\u64ad MAC \u5730\u5740\u9ed8\u8ba4\u5339\u914d\uff0c\u7ee7\u7eed\u4ea4\u7531\u4e0a\u5c42\u7684 IP \u534f\u8bae\u6808\u5904\u7406\uff1b</li> <li>\u7b2c 2 \u6b65\uff0cIP \u534f\u8bae\u6808\u67e5\u770b\u76ee\u6807 IP \u5730\u5740\u662f\u5426\u4e3a\u672c\u673a IP \u5730\u5740\uff0c\u4e0d\u5339\u914d\u4e5f\u4f1a\u4e22\u5f03\u62a5\u6587\u3002\u4e0a\u6587\u4ecb\u7ecd\u8fc7\u7684\u5e7f\u64ad IP \u5730\u5740\u540c\u6837\u9ed8\u8ba4\u5339\u914d\uff0c\u4ea4\u7531\u4f20\u8f93\u5c42\u534f\u8bae\u7ee7\u7eed\u5904\u7406\u3002</li> <li>\u7b2c 3 \u6b65\uff0c\u4f20\u8f93\u5c42\u68c0\u67e5\u76ee\u6807\u7aef\u53e3\u662f\u5426\u6709\u8fdb\u7a0b\u5728\u76d1\u542c\uff0c\u5982\u679c\u6ca1\u6709\u5219\u4e22\u5f03\u62a5\u6587\uff0c\u53cd\u4e4b\u5219\u4ea4\u4ed8\u7ed9\u8fdb\u7a0b\u5904\u7406\u3002\u4e0d\u5c5e\u4e8e\u96c6\u7fa4\u7684\u4e3b\u673a\u81ea\u7136\u4e0d\u4f1a\u542f\u52a8\u670d\u52a1\u76d1\u542c\u7aef\u53e3\uff0c\u5728\u8fd9\u4e00\u6b65\u624d\u4f1a\u4e22\u5f03\u5e7f\u64ad\u62a5\u6587\u3002</li> </ul> <p></p> <p>\u53ef\u89c1\uff0c\u5bf9\u4e8e\u4e0d\u5c5e\u4e8e\u5206\u5e03\u5f0f\u96c6\u7fa4\u7684\u4e3b\u673a\u800c\u8a00\uff0c\u5e7f\u64ad\u62a5\u6587\u65e2\u5360\u7528\u4e86\u5b83\u4eec\u7684\u5e26\u5bbd\uff0c\u8fd9 3 \u6b65\u534f\u8bae\u6808\u7684\u64cd\u4f5c\u4e5f\u6d88\u8017\u4e86 CPU \u7684\u8ba1\u7b97\u529b\u3002\u6709\u4ec0\u4e48\u529e\u6cd5\u80fd\u7f29\u5c0f\u5e7f\u64ad\u7684\u8303\u56f4\uff0c\u6d88\u9664\u5b83\u52a0\u5728\u65e0\u5173\u4e3b\u673a\u4e0a\u7684\u8d1f\u8f7d\u5462\uff1f</p>"},{"location":"chap2/1broadcast_network/#3-1","title":"3-1 \u7ec4\u64ad\u53ef\u4ee5\u505a\u5230\u3002","text":"<p>\u7ec4\u64ad\u662f\u4e00\u79cd\u201c\u5b9a\u5411\u5e7f\u64ad\u201d\uff0c\u5b83\u8bbe\u5b9a\u4e86\u4e00\u4e2a\u865a\u62df\u7ec4\uff0c\u7528\u7ec4\u64ad IP \u6765\u6807\u8bc6\u3002\u8fd9\u4e2a\u865a\u62df\u7ec4\u4e2d\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u4e3b\u673a\u7684 IP\uff0c\u5f53\u5411\u5bf9\u5e94\u7684\u7ec4\u64ad IP \u53d1\u9001\u6d88\u606f\u65f6\uff0c\u4ec5\u5728\u8fd9\u4e2a\u7ec4\u5185\u7684\u4e3b\u673a\u624d\u80fd\u6536\u5230\u6d88\u606f\u3002</p> <p>\u7ec4\u64ad IP \u4e0e\u5e38\u89c1\u7684\u5355\u64ad IP \u4e0d\u540c\uff0c\u5b83\u662f\u524d\u6587\u4ecb\u7ecd\u8fc7 5 \u7c7b IP \u5730\u5740\u4e2d\u7684 D \u7c7b\u5730\u5740\uff0c32 \u4f4d IP \u5730\u5740\u7684\u524d 4 \u4f4d\u5fc5\u987b\u662f 1110\uff0c\u56e0\u6b64\u7ec4\u64ad IP \u5730\u5740\u7684\u8303\u56f4\u662f\u4ece 224.0.0.0 \u5230 239.255.255.255\u3002</p> <p>\u5f53\u8bbe\u7f6e\u597d\u7ec4\u64ad IP \u5730\u5740\u540e\uff0c\u8fd8\u8981\u901a\u8fc7\u7ba1\u7406\u7ec4\u64ad\u5730\u5740\u7684 IGMP \u534f\u8bae\uff08Internet Group Management Protocol\uff09\uff0c\u5c06\u4e3b\u673a IP \u5730\u5740\u6dfb\u52a0\u8fdb\u865a\u62df\u7ec4\u4e2d\u3002\u7f16\u7a0b\u8bed\u8a00\u63d0\u4f9b\u7684 setsockopt \u51fd\u6570\uff0c\u5c31\u53ef\u4ee5\u64cd\u4f5c IGMP \u534f\u8bae\u7ba1\u7406\u7ec4\u64ad\u5730\u5740\u3002\u6bd4\u5982\uff0c\u4f7f\u7528\u53c2\u6570 <code>IP_ADD_MEMBERSHIP</code> \u5c31\u80fd\u591f\u5411\u865a\u62df\u7ec4\u4e2d\u589e\u52a0 IP\uff0c\u800c <code>IP_DROP_MEMBERSHIP</code> \u5219\u53ef\u4ee5\u4ece\u7ec4\u4e2d\u53bb\u9664\u67d0\u4e2a\u4e3b\u673a\u7684 IP\u3002</p> <p>\u7ec4\u64ad\u76f8\u5bf9\u4e8e\u5e7f\u64ad\u800c\u8a00 \uff0c\u9664\u4e86\u80fd\u591f\u66f4\u7cbe\u51c6\u7684\u7ba1\u7406\u7ec4\u64ad\u8303\u56f4\uff0c\u8fd8\u80fd\u591f\u8de8\u8d8a\u591a\u4e2a\u7f51\u7edc\u5de5\u4f5c\u3002\u5f53\u7136\uff0c\u5982\u679c\u5c06\u591a\u4e2a\u7f51\u7edc\u4e2d\u7684 IP \u52a0\u5165\u540c\u4e00\u865a\u62df\u7ec4\u65f6\uff0c\u9700\u8981\u6d89\u53ca\u5230\u7684\u8def\u7531\u5668\u90fd\u53ef\u4ee5\u6b63\u786e\u5730\u5904\u7406\u8fd9\u4e9b IP \u5730\u5740\uff0c\u4e14\u90fd\u80fd\u652f\u6301 IGMP \u534f\u8bae\u3002</p>"},{"location":"chap2/1broadcast_network/#4","title":"4\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u7531\u4e8e\u4e00\u5bf9\u591a\u901a\u8baf\u80fd\u591f\u5145\u5206\u5229\u7528\u6574\u4f53\u7f51\u7edc\u7684\u6027\u80fd\uff0c\u800c\u4e14\u901a\u8fc7\u4ea4\u6362\u673a\u80fd\u591f\u540c\u65f6\u5411\u8bb8\u591a\u4e3b\u673a\u53d1\u9001\u6d88\u606f\uff0c\u6240\u4ee5\u5728\u5c40\u57df\u7f51\u5185\u6709\u5e7f\u6cdb\u7684\u5e94\u7528\u3002</p> <p>\u5728 TCP \u534f\u8bae\u5206\u5c42\u540e\uff0cIP \u534f\u8bae\u5929\u7136\u5c31\u652f\u6301\u4e00\u5bf9\u591a\u901a\u8baf\u65b9\u5f0f\u3002TCP \u534f\u8bae\u9762\u5411\u8fde\u63a5\u7684\u7279\u6027\u4f7f\u5b83\u653e\u5f03\u4e86\u4e00\u5bf9\u591a\u7684\u901a\u8baf\u65b9\u5f0f\uff0c\u800c UDP \u534f\u8bae\u5219\u7ee7\u627f\u4e86 IP \u534f\u8bae\u7684\u8fd9\u4e00\u529f\u80fd\u3002\u6240\u4ee5\uff0c\u5728\u4e00\u5bf9\u591a\u901a\u8baf\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u4f1a\u9009\u62e9 UDP \u534f\u8bae\u3002</p> <p>\u6b63\u786e\u8f93\u5165\u5e7f\u64ad\u5730\u5740\u7684\u524d\u63d0\uff0c\u662f\u7406\u89e3 IP \u5730\u5740\u5982\u4f55\u5212\u5206\u4e3a\u7f51\u7edc ID \u548c\u4e3b\u673a ID\u3002\u5f53\u4e3b\u673a ID \u6240\u6709\u7684\u6bd4\u7279\u4f4d\u6539\u4e3a\u5168 1 \u65f6\uff0cIP \u5730\u5740\u5c31\u8868\u793a\u8be5\u7f51\u7edc\u4e0b\u7684\u6240\u6709\u4e3b\u673a\uff0c\u8fd9\u5c31\u662f\u5e7f\u64ad\u5730\u5740\u3002\u5f53\u5411\u5e7f\u64ad\u5730\u5740\u53d1\u9001 UDP \u6d88\u606f\u65f6\uff0c\u7f51\u7edc\u4e2d\u7684\u6240\u6709\u4e3b\u673a\u90fd\u4f1a\u6536\u5230\u3002\u5e7f\u64ad\u5728\u5c40\u57df\u7f51\u4e2d\u6709\u5e7f\u6cdb\u7684\u5e94\u7528\uff0c\u8f6c\u6362 IP \u5730\u5740\u4e0e MAC \u5730\u5740\u7684 ARP \u534f\u8bae\u5c31\u662f\u7528\u5e7f\u64ad\u5b9e\u73b0\u7684\u3002</p> <p>\u5e7f\u64ad\u5bf9\u65e0\u5173\u7684\u4e3b\u673a\u589e\u52a0\u4e86\u4e0d\u5fc5\u8981\u7684\u8d1f\u62c5\uff0c\u800c\u7ec4\u64ad\u53ef\u4ee5\u66f4\u7cbe\u51c6\u5730\u201c\u5b9a\u5411\u201d\u5e7f\u64ad\u3002\u7ec4\u64ad\u5730\u5740\u4e5f\u88ab\u79f0\u4e3a D \u7c7b\u5730\u5740\uff0c\u5b83\u63cf\u8ff0\u7684\u865a\u62df\u7ec4\u8981\u901a\u8fc7 IGMP \u534f\u8bae\u7ba1\u7406\u3002\u7f51\u7edc API \u4e2d\u7684 setsockopt \u51fd\u6570\u53ef\u4ee5\u901a\u8fc7 IGMP \u534f\u8bae\uff0c\u5411\u865a\u62df\u7ec4\u4e2d\u6dfb\u52a0\u6216\u8005\u5220\u9664 IP \u5730\u5740\u3002\u5f53\u8def\u7531\u5668\u652f\u6301 IGMP \u534f\u8bae\u65f6\uff0c\u7ec4\u64ad\u5c31\u53ef\u4ee5\u8de8\u8d8a\u591a\u4e2a\u7f51\u7edc\u5b9e\u73b0\u66f4\u5e7f\u6cdb\u7684\u4e00\u5bf9\u591a\u901a\u8baf\u3002</p> <p>\u5e7f\u64ad\u548c\u7ec4\u64ad\u80fd\u591f\u5145\u5206\u5730\u4f7f\u7528\u5168\u7f51\u5e26\u5bbd\uff0c\u4e5f\u901a\u8fc7\u4ea4\u6362\u673a\u7b49\u7f51\u7edc\u8bbe\u5907\u5206\u6563\u4e86\u53d1\u9001\u4e3b\u673a\u7684\u8d1f\u8f7d\u3002\u4f46\u5b83\u5f88\u96be\u5bf9\u6bcf\u53f0\u63a5\u6536\u4e3b\u673a\u63d0\u4f9b\u5b9a\u5236\u5316\u670d\u52a1\uff0c\u8fd9\u6837\u53ef\u9760\u4f20\u8f93\u5c31\u5f88\u96be\u5b9e\u73b0\u3002\u8fd9\u4f7f\u5f97\u5b83\u4eec\u5728\u66f4\u5173\u6ce8\u53ca\u65f6\u6027\u3001\u5bf9\u4e22\u5305\u4e0d\u654f\u611f\u7684\u6d41\u5a92\u4f53\u76f4\u64ad\u4e2d\u66f4\u6709\u5e94\u7528\u524d\u666f\u3002</p>"},{"location":"chap2/2C10M/","title":"\u7b2c\u4e8c\u8282 C10M\u662f\u5982\u4f55\u5b9e\u73b0\u4e8b\u4ef6\u9a71\u52a8","text":"<p>\u8c08\u5230\u9ad8\u5e76\u53d1\uff0c\u603b\u662f\u4f1a\u63d0\u5230 C10K\uff0c\u8fd9\u662f\u6307\u670d\u52a1\u5668\u540c\u65f6\u5904\u7406 1 \u4e07\u4e2a TCP \u8fde\u63a5\u3002</p> <ul> <li>\u968f\u7740\u670d\u52a1\u5668\u6027\u80fd\u7684\u63d0\u5347\uff0c\u8fd1\u6765\u6211\u4eec\u66f4\u5e0c\u671b\u5355\u53f0\u670d\u52a1\u5668\u7684\u5e76\u53d1\u80fd\u529b\u53ef\u4ee5\u8fbe\u5230 C10M\uff0c\u4e5f\u5c31\u662f\u540c\u65f6\u53ef\u4ee5\u5904\u7406 1 \u5343\u4e07\u4e2a TCP \u8fde\u63a5\u3002</li> <li>\u4ece C10K \u5230 C10M\uff0c\u5b9e\u73b0\u6280\u672f\u5e76\u6ca1\u6709\u672c\u8d28\u53d8\u5316\uff0c\u90fd\u662f\u7528\u4e8b\u4ef6\u9a71\u52a8\u548c\u5f02\u6b65\u5f00\u53d1\u5b9e\u73b0\u7684\u3002</li> </ul> <p>\u5904\u7406\u57fa\u4e8e TCP \u7684\u5e94\u7528\u5c42\u534f\u8bae\u65f6\uff0c\u4e00\u4e2a\u8bf7\u6c42\u7684\u5904\u7406\u4ee3\u7801\u5fc5\u987b\u88ab\u62c6\u5206\u5230\u591a\u4e2a\u56de\u8c03\u51fd\u6570\u4e2d\uff0c\u7531\u5f02\u6b65\u6846\u67b6\u5728\u76f8\u5e94\u7684\u4e8b\u4ef6\u751f\u6210\u65f6\u8c03\u7528\u5b83\u4eec\u3002\u8fd9\u5c31\u662f\u4e8b\u4ef6\u9a71\u52a8\u65b9\u5f0f\uff0c\u5b83\u901a\u8fc7\u51cf\u5c11\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\uff0c\u5b9e\u73b0\u4e86 C10M \u7ea7\u522b\u7684\u9ad8\u5e76\u53d1\u3002</p> <p>\u8fd9\u6837\uff0c\u5728\u9ad8\u5e76\u53d1\u4e0b\uff0c\u5f53\u591a\u4e2a HTTP \u8bf7\u6c42\u4e89\u62a2\u6267\u884c\u65f6\uff0c\u6d89\u53ca\u8d44\u6e90\u5206\u914d\u3001\u91ca\u653e\u7b49\u91cd\u8981\u5de5\u4f5c\u7684\u56de\u8c03\u51fd\u6570\uff0c\u5c31\u53ef\u80fd\u5728\u9519\u8bef\u7684\u65f6\u95f4\u88ab\u8c03\u7528\uff0c\u8fdb\u800c\u5f15\u53d1\u4e00\u7cfb\u5217\u95ee\u9898\u3002\u6bd4\u5982\uff0c\u4e0d\u540c\u7684\u56de\u8c03\u51fd\u6570\u5bf9\u5e94\u4e0d\u540c\u7684\u4e8b\u4ef6\uff0c\u5982\u679c\u67d0\u4e2a\u51fd\u6570\u6267\u884c\u65f6\u95f4\u8fc7\u957f\uff0c\u5c31\u4f1a\u5f71\u54cd\u5176\u4ed6\u8bf7\u6c42\uff0c\u53ef\u80fd\u5bfc\u81f4\u5927\u91cf\u8bf7\u6c42\u51fa\u73b0\u8d85\u65f6\u800c\u5904\u7406\u5931\u8d25\u3002</p>"},{"location":"chap2/2C10M/#1","title":"1\u3001\u4e8b\u4ef6\u662f\u600e\u4e48\u4ea7\u751f\u7684\uff1f","text":""},{"location":"chap2/2C10M/#1-1","title":"1-1 \u4ec0\u4e48\u662f\u4e8b\u4ef6","text":"<p>\u8981\u4e86\u89e3\u201c\u4e8b\u4ef6\u9a71\u52a8\u201d\u7684\u8fd0\u4f5c\u673a\u5236\uff0c\u9996\u5148\u5c31\u8981\u641e\u6e05\u695a\u5230\u5e95\u4ec0\u4e48\u662f\u4e8b\u4ef6</p> <p>\u4ece\u7f51\u7edc\u4e2d\u63a5\u6536\u5230\u4e00\u4e2a\u62a5\u6587\uff0c\u5c31\u53ef\u80fd\u4ea7\u751f\u4e00\u4e2a\u4e8b\u4ef6\u3002\u7ecd\u8fc7\u7684 UDP \u8bf7\u6c42\u5c31\u662f\u6700\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u4e00\u4e2a UDP \u8bf7\u6c42\u901a\u5e38\u4ec5\u7531\u4e00\u4e2a\u7f51\u7edc\u62a5\u6587\u7ec4\u6210\uff0c\u6240\u4ee5\uff0c\u5f53\u6536\u5230\u4e00\u4e2a UDP \u62a5\u6587\uff0c\u5c31\u610f\u5473\u7740\u6536\u5230\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5b83\u4f1a\u751f\u6210\u4e00\u4e2a\u4e8b\u4ef6\uff0c\u8fdb\u800c\u89e6\u53d1\u56de\u8c03\u51fd\u6570\u6267\u884c\u3002</p> <p>\u5e38\u89c1\u7684 HTTP \u7b49\u534f\u8bae\u90fd\u662f\u57fa\u4e8e TCP \u5b9e\u73b0\u7684\u3002\u7531\u4e8e TCP \u662f\u4e00\u79cd\u9762\u5411\u5b57\u8282\u6d41\u7684\u534f\u8bae\uff0cHTTP \u8bf7\u6c42\u7684\u5927\u5c0f\u5e76\u4e0d\u53d7\u9650\u5236\uff0c\u5f53\u4e00\u4e2a HTTP \u8bf7\u6c42\u7684\u5927\u5c0f\u8d85\u8fc7 TCP \u62a5\u6587\u7684\u6700\u5927\u957f\u5ea6\u65f6\uff0c\u8bf7\u6c42\u4f1a\u88ab\u62c6\u5206\u5230\u591a\u4e2a\u62a5\u6587\u4e2d\u8fd0\u8f93\uff0c\u5728\u63a5\u6536\u7aef\u7684\u7f13\u51b2\u533a\u4e2d\u91cd\u7ec4\u3001\u6392\u5e8f\u3002\u56e0\u6b64\uff0c\u5e76\u4e0d\u662f\u6bcf\u4e2a\u5230\u8fbe\u7684 TCP \u62a5\u6587\u90fd\u80fd\u751f\u6210\u4e8b\u4ef6\u7684\u3002</p>"},{"location":"chap2/2C10M/#1-2","title":"1-2 \u4e8b\u4ef6\u7c7b\u578b","text":"<p>\u4e8b\u4ef6\u5e76\u6ca1\u6709\u4f60\u60f3\u8c61\u4e2d\u90a3\u4e48\u590d\u6742\uff0c\u5b83\u53ea\u6709\u4e24\u79cd\u7c7b\u578b\uff1a\u8bfb\u4e8b\u4ef6\u4e0e\u5199\u4e8b\u4ef6\uff0c\u5176\u4e2d\uff0c</p> <ul> <li>\u8bfb\u4e8b\u4ef6\u8868\u793a\u6709\u5230\u8fbe\u7684\u6d88\u606f\u9700\u8981\u5904\u7406\uff0c</li> <li>\u5199\u4e8b\u4ef6\u8868\u793a\u53ef\u4ee5\u53d1\u9001\u6d88\u606f\uff08TCP \u8fde\u63a5\u7684\u5199\u7f13\u51b2\u533a\u4e2d\u6709\u53ef\u7528\u7a7a\u95f4\uff09\u3002</li> </ul> <p>\u7531\u4e8e TCP \u5141\u8bb8\u53cc\u5411\u4f20\u8f93\uff0c\u6240\u4ee5\u5efa\u7acb\u8fde\u63a5\u65f6\uff0c\u4f1a\u4f9d\u6b21\u5728\u8fde\u63a5\u7684\u4e24\u4e2a\u65b9\u5411\u4e0a\u5efa\u7acb\u901a\u9053\u3002</p> <ul> <li>\u4e3b\u52a8\u53d1\u8d77\u8fde\u63a5\u7684\u4e00\u65b9\u53eb\u505a\u5ba2\u6237\u7aef</li> <li>\u88ab\u52a8\u76d1\u542c\u7aef\u53e3\u7b49\u5f85\u8fde\u63a5\u7684\u4e00\u65b9\u53eb\u505a\u670d\u52a1\u5668\u3002</li> </ul> <p>\u5ba2\u6237\u7aef\u9996\u5148\u53d1\u9001 SYN \u62a5\u6587\u7ed9\u670d\u52a1\u5668\uff0c\u800c\u670d\u52a1\u5668\u6536\u5230\u540e\u56de\u590d ACK \u548c SYN\uff0c\u5f53\u5b83\u4eec\u5230\u8fbe\u5ba2\u6237\u7aef\u65f6\uff0c\u53cc\u5411\u8fde\u63a5\u4e2d\u7531\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u5668\u7684\u901a\u9053\u5c31\u5efa\u7acb\u597d\u4e86\uff0c\u6b64\u65f6\u5ba2\u6237\u7aef\u5c31\u5df2\u7ecf\u53ef\u4ee5\u53d1\u9001\u8bf7\u6c42\u4e86\uff0c\u56e0\u6b64\u5ba2\u6237\u7aef\u4f1a\u4ea7\u751f\u5199\u4e8b\u4ef6\u3002</p> <p>\u63a5\u7740\uff0c\u5ba2\u6237\u7aef\u53d1\u9001 ACK \u62a5\u6587\uff0c\u5230\u8fbe\u670d\u52a1\u5668\u540e\uff0c\u670d\u52a1\u5668\u4e0a\u4f1a\u4ea7\u751f\u8bfb\u4e8b\u4ef6\uff0c\u56e0\u4e3a\u8fdb\u7a0b\u539f\u672c\u5728\u76d1\u542c 80 \u7b49\u7aef\u53e3\uff0c\u6b64\u65f6\u6709\u65b0\u8fde\u63a5\u5efa\u7acb\u6210\u529f\uff0c\u5e94\u5f53\u8c03\u7528 <code>accept</code> \u51fd\u6570\u8bfb\u53d6\u8fd9\u4e2a\u8fde\u63a5\uff0c\u6240\u4ee5\u8fd9\u662f\u4e00\u4e2a\u8bfb\u4e8b\u4ef6\u3002</p> <p></p> <p>\u5728\u5efa\u7acb\u597d\u7684 TCP \u8fde\u63a5\u4e0a\u6536\u53d1\u6d88\u606f\u65f6\uff0c\u8bfb\u4e8b\u4ef6\u5bf9\u5e94\u7740\u63a5\u6536\u5230\u5bf9\u65b9\u7684\u6d88\u606f\uff0c\u8fd9\u5f88\u597d\u7406\u89e3\u3002\u5199\u4e8b\u4ef6\u5219\u7a0d\u5fae\u590d\u6742\u4e9b\uff0c\u6211\u4eec\u4e3e\u4e2a\u4f8b\u5b50\u52a0\u4ee5\u8bf4\u660e\u3002\u5047\u8bbe\u8981\u53d1\u9001\u4e00\u4e2a 2MB \u7684\u8bf7\u6c42\uff0c\u5f53\u8c03\u7528 write \u51fd\u6570\u53d1\u9001\u65f6\uff0c\u4f1a\u5148\u628a\u5185\u5b58\u4e2d\u7684\u6570\u636e\u62f7\u8d1d\u5230\u5199\u7f13\u51b2\u533a\u4e2d\u540e\uff0c\u518d\u53d1\u9001\u5230\u7f51\u5361\u4e0a\u3002</p> <p>\u5728\u5bf9\u65b9\u6ca1\u6709\u660e\u786e\u8868\u793a\u6536\u5230\u524d\uff0cTCP \u4f1a\u901a\u8fc7\u5b9a\u65f6\u5668\u91cd\u53d1\u5199\u7f13\u51b2\u533a\u4e2d\u7684\u6570\u636e\uff0c\u4fdd\u8bc1\u6d88\u606f\u80fd\u591f\u5230\u8fbe\u5bf9\u65b9\u3002\u5199\u7f13\u51b2\u533a\u662f\u6709\u5927\u5c0f\u9650\u5236\u7684\u3002\u8fd9\u91cc\u5047\u8bbe\u5199\u7f13\u51b2\u533a\u53ea\u6709 1MB\uff0c\u6240\u4ee5\u8c03\u7528 write \u53d1\u9001 2MB \u6570\u636e\u65f6\uff0cwrite \u51fd\u6570\u7684\u8fd4\u56de\u503c\u53ea\u6709 1MB\uff0c\u8868\u793a\u5199\u7f13\u51b2\u533a\u5df2\u7528\u5c3d\u3002\u5f53\u6536\u5230\u5bf9\u65b9\u53d1\u6765\u7684 ACK \u62a5\u6587\u540e\uff0c\u7f13\u51b2\u533a\u4e2d\u7684\u6570\u636e\u624d\u80fd\u91ca\u653e\uff0c\u5c31\u4f1a\u4ea7\u751f\u5199\u4e8b\u4ef6\u901a\u77e5\u8fdb\u7a0b\u53d1\u9001\u5269\u4f59\u7684\u90a3 1MB \u6570\u636e\u3002</p> <p></p> <p>\u5982\u540c\u5efa\u7acb\u8fde\u63a5\u9700\u8981\u53cc\u5411\u5efa\u7acb\u4e00\u6837\uff0c\u5173\u95ed\u8fde\u63a5\u4e5f\u9700\u8981\u53cc\u65b9\u5404\u81ea\u5173\u95ed\u6bcf\u4e2a\u65b9\u5411\u7684\u901a\u9053\u3002\u4e3b\u52a8\u5173\u95ed\u7684\u4e00\u65b9\u53d1\u9001 FIN \u62a5\u6587\uff0c\u5230\u8fbe\u88ab\u52a8\u65b9\u540e\uff0c\u5185\u6838\u81ea\u52a8\u56de\u590d ACK \u62a5\u6587\uff0c\u8fd9\u8868\u793a\u4ece\u4e3b\u52a8\u65b9\u5230\u88ab\u52a8\u65b9\u7684\u901a\u9053\u5df2\u7ecf\u5173\u95ed\u3002\u4f46\u88ab\u52a8\u65b9\u5230\u4e3b\u52a8\u65b9\u7684\u901a\u9053\u4e5f\u9700\u8981\u5173\u95ed\uff0c\u6240\u4ee5\u6b64\u65f6\u88ab\u52a8\u65b9\u4f1a\u4ea7\u751f\u8bfb\u4e8b\u4ef6\uff0c\u63d0\u9192\u88ab\u52a8\u65b9\u8c03\u7528 close \u51fd\u6570\u5173\u95ed\u8fde\u63a5\u3002</p> <p></p> <p>\u76f8\u5bf9\u800c\u8a00\uff0c\u7f51\u7edc\u4e0d\u53ea\u901f\u5ea6\u6162\uff0c\u800c\u4e14\u6ce2\u52a8\u5f88\u5927\uff0c\u65e2\u53d7\u5236\u4e8e\u8fde\u63a5\u5bf9\u7aef\u7684\u6027\u80fd\uff0c\u4e5f\u53d7\u5236\u4e8e\u7f51\u7edc\u4f20\u8f93\u8def\u5f84\u3002</p> <ul> <li>\u628a\u64cd\u4f5c\u7f51\u7edc\u7684\u540c\u6b65 API \u6539\u4e3a\u4e8b\u4ef6\u9a71\u52a8\u7684\u5f02\u6b65 API \u6536\u76ca\u6700\u5927\u3002</li> <li>\u800c\u78c1\u76d8\uff08\u7279\u522b\u662f\u673a\u68b0\u786c\u76d8\uff09\u8bbf\u95ee\u901f\u5ea6\u867d\u7136\u4e0d\u5feb\uff0c\u4f46\u5b83\u6700\u6162\u65f6\u4e5f\u4e0d\u8fc7\u51e0\u5341\u6beb\u79d2\uff0c\u662f\u53ef\u63a7\u7684\u3002</li> <li>\u800c\u4e14\u76ee\u524d\u78c1\u76d8\u5f02\u6b65 IO \u6280\u672f\u8fd8\u4e0d\u6210\u719f\uff0c\u5b83\u7ed5\u8fc7\u4e86 PageCache \u6027\u80fd\u635f\u5931\u5f88\u5927\u3002\u6240\u4ee5\u5f53\u4e0b\u7684\u4e8b\u4ef6\u9a71\u52a8\uff0c\u4e3b\u8981\u5c31\u662f\u6307\u7f51\u7edc\u4e8b\u4ef6\u3002</li> </ul>"},{"location":"chap2/2C10M/#2","title":"2\u3001\u8be5\u600e\u6837\u5904\u7406\u7f51\u7edc\u4e8b\u4ef6\uff1f","text":""},{"location":"chap2/2C10M/#2-1","title":"2-1 \u7528\u6237\u6001\u4ee3\u7801\u5982\u4f55\u5904\u7406\u4e8b\u4ef6","text":"<p>\u7f51\u7edc\u4e8b\u4ef6\u662f\u7531\u5185\u6838\u4ea7\u751f\u7684\uff0c\u8fdb\u7a0b\u8be5\u600e\u6837\u83b7\u53d6\u5230\u5b83\u4eec\u5462\uff1f\u5982 epoll \u8fd9\u6837\u7684\u591a\u8def\u590d\u7528\u6280\u672f\u53ef\u4ee5\u5e2e\u6211\u4eec\u505a\u5230\u3002\u591a\u8def\u590d\u7528\u662f\u901a\u8baf\u9886\u57df\u7684\u8bcd\u6c47\uff0c\u6709\u4e9b\u62bd\u8c61\u4f46\u539f\u7406\u786e\u5f88\u7b80\u5355\u3002</p> <p>\u6bd4\u5982\uff0c\u4e00\u6761\u9ad8\u901f\u7684\u5149\u7ea4\u4e0a\uff0c\u5141\u8bb8\u591a\u4e2a\u7528\u6237\u7528\u8f83\u4f4e\u7684\u7f51\u901f\u540c\u65f6\u901a\u8baf\uff0c\u8fd9\u5c31\u662f\u591a\u8def\u590d\u7528\u3002\u540c\u6837\u9053\u7406\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u867d\u7136\u4efb\u4e00\u65f6\u523b\u53ea\u80fd\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\uff0c\u4f46\u5904\u7406\u6bcf\u4e2a\u8bf7\u6c42\u4ea7\u751f\u7684\u4e8b\u4ef6\u65f6\uff0c\u82e5\u8017\u65f6\u63a7\u5236\u5728 1 \u6beb\u79d2\u4ee5\u5185\uff0c\u8fd9\u6837 1 \u79d2\u949f\u5c31\u53ef\u4ee5\u5904\u7406\u6570\u5343\u4e2a\u8bf7\u6c42\uff0c\u4ece\u66f4\u957f\u7684\u65f6\u95f4\u7ef4\u5ea6\u4e0a\u770b\uff0c\u591a\u4e2a\u8bf7\u6c42\u590d\u7528\u4e86\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u4e5f\u53eb\u505a\u591a\u8def\u590d\u7528\uff08\u6216\u8005\u53eb\u505a\u65f6\u5206\u591a\u8def\u590d\u7528\uff09\u3002</p> <p>epoll\uff0c\u5c31\u662f\u5185\u6838\u63d0\u4f9b\u7ed9\u7528\u6237\u6001\u7684\u591a\u8def\u590d\u7528\u63a5\u53e3\uff0c\u8fdb\u7a0b\u53ef\u4ee5\u901a\u8fc7\u5b83\u4ece\u5185\u6838\u4e2d\u83b7\u53d6\u4e8b\u4ef6\u3002</p>"},{"location":"chap2/2C10M/#2-1-epoll","title":"2-1 epoll \u662f\u5982\u4f55\u83b7\u53d6\u7f51\u7edc\u4e8b\u4ef6","text":"<p>\u6700\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u5c31\u662f\u5728\u83b7\u53d6\u4e8b\u4ef6\u65f6\uff0c\u628a\u6240\u6709\u5e76\u53d1\u8fde\u63a5\u4f20\u7ed9\u5185\u6838\uff0c\u518d\u7531\u5185\u6838\u8fd4\u56de\u4ea7\u751f\u4e86\u4e8b\u4ef6\u7684\u8fde\u63a5\uff0c\u518d\u5904\u7406\u8fd9\u4e9b\u8fde\u63a5\u5bf9\u5e94\u7684\u8bf7\u6c42\u5373\u53ef\u3002epoll \u524d\u7684 select \u7b49\u591a\u8def\u590d\u7528\u51fd\u6570\u5c31\u662f\u8fd9\u4e48\u5e72\u7684\u3002</p> <p>\u7136\u800c\uff0cC10M \u610f\u5473\u7740\u6709\u4e00\u5343\u4e07\u4e2a\u8fde\u63a5\uff0c\u82e5\u6bcf\u4e2a socket \u662f 4 \u5b57\u8282\uff0c\u90a3\u4e48 1 \u5343\u4e07\u8fde\u63a5\u5c31\u662f 40M \u5b57\u8282\u3002\u8fd9\u6837\uff0c\u6bcf\u6536\u96c6\u4e00\u6b21\u4e8b\u4ef6\uff0c\u5c31\u9700\u8981\u4ece\u7528\u6237\u6001\u590d\u5236 40M \u5b57\u8282\u5230\u5185\u6838\u6001\u3002\u800c\u4e14\uff0c\u9ad8\u6027\u80fd Server \u5fc5\u987b\u53ca\u65f6\u5730\u5904\u7406\u7f51\u7edc\u4e8b\u4ef6\uff0c\u6240\u4ee5\u6bcf\u9694\u51e0\u5341\u6beb\u79d2\u5c31\u8981\u6536\u96c6\u4e00\u6b21\u4e8b\u4ef6\uff0c\u6027\u80fd\u6d88\u8017\u5de8\u5927\u3002</p> <p>epoll \u4e3a\u4e86\u964d\u4f4e\u6027\u80fd\u6d88\u8017\uff0c\u628a\u83b7\u53d6\u4e8b\u4ef6\u62c6\u5206\u6210\u4e24\u6b65\u3002</p> <ul> <li>\u7b2c\u4e00\u6b65\u628a\u9700\u8981\u76d1\u63a7\u7684 socket \u4f20\u7ed9\u5185\u6838\uff08<code>epoll_ctl</code> \u51fd\u6570\uff09\uff0c\u5b83\u4ec5\u5728\u8fde\u63a5\u5efa\u7acb\u7b49\u6709\u9650\u7684\u65f6\u673a\u8c03\u7528\uff1b</li> <li>\u7b2c\u4e8c\u6b65\u6536\u96c6\u4e8b\u4ef6\uff08<code>epoll_wait</code> \u51fd\u6570\uff09\u4fbf\u4e0d\u7528\u4f20\u9012 socket \u4e86\uff0c\u8fd9\u6837\u5c31\u628a socket \u7684\u91cd\u590d\u4f20\u9012\u6539\u4e3a\u4e86\u4e00\u6b21\u4f20\u9012\uff0c\u964d\u4f4e\u4e86\u6027\u80fd\u635f\u8017\u3002</li> </ul>"},{"location":"chap2/2C10M/#2-2","title":"2-2 \u600e\u6837\u4fdd\u8bc1\u5904\u7406\u4e00\u4e2a\u4e8b\u4ef6\u7684\u65f6\u95f4\u4e0d\u4f1a\u592a\u957f","text":"<ul> <li>\u7b2c\u4e00\u7c7b\u662f\u8ba1\u7b97\u4efb\u52a1\uff0c\u867d\u7136\u5185\u5b58\u3001CPU \u7684\u901f\u5ea6\u5f88\u5feb\uff0c\u7136\u800c\u5faa\u73af\u6267\u884c\u4e5f\u53ef\u80fd\u8017\u65f6\u8fbe\u5230\u79d2\u7ea7\u3002\u6240\u4ee5\uff0c\u5982\u679c\u4e00\u5b9a\u8981\u5f15\u5165\u9700\u8981\u5bc6\u96c6\u8ba1\u7b97\u624d\u80fd\u5b8c\u6210\u7684\u8bf7\u6c42\uff0c\u4e3a\u4e86\u4e0d\u963b\u788d\u5176\u4ed6\u4e8b\u4ef6\u7684\u5904\u7406\uff0c\u8981\u4e48\u628a\u8fd9\u6837\u7684\u8bf7\u6c42\u653e\u5728\u72ec\u7acb\u7684\u7ebf\u7a0b\u4e2d\u5b8c\u6210\uff0c\u8981\u4e48\u628a\u8bf7\u6c42\u7684\u5904\u7406\u8fc7\u7a0b\u62c6\u5206\u6210\u591a\u6bb5\uff0c\u786e\u4fdd\u6bcf\u6bb5\u80fd\u591f\u5feb\u901f\u6267\u884c\u5b8c\uff0c\u540c\u65f6\u6bcf\u6bb5\u6267\u884c\u5b8c\u90fd\u8981\u5747\u7b49\u5730\u5904\u7406\u5176\u4ed6\u4e8b\u4ef6\uff0c\u8fd9\u6837\u901a\u8fc7\u653e\u6162\u8be5\u8bf7\u6c42\u7684\u5904\u7406\u65f6\u95f4\uff0c\u5c31\u4fdd\u969c\u4e86\u5176\u4ed6\u8bf7\u6c42\u7684\u53ca\u65f6\u5904\u7406\u3002</li> <li>\u7b2c\u4e8c\u7c7b\u4f1a\u8bfb\u5199\u78c1\u76d8\uff0c\u7531\u4e8e\u78c1\u76d8\u7684\u5199\u5165\u64cd\u4f5c\u4f7f\u7528\u4e86 PageCache \u7684\u5ef6\u8fdf\u5199\u7279\u6027\uff0c\u5f53 write \u51fd\u6570\u8fd4\u56de\u65f6\u53ea\u662f\u590d\u5236\u5230\u4e86\u5185\u5b58\u4e2d\uff0c\u6240\u4ee5\u5199\u5165\u64cd\u4f5c\u5f88\u5feb\u3002\u78c1\u76d8\u7684\u8bfb\u53d6\u64cd\u4f5c\u5c31\u6bd4\u8f83\u6162\u4e86\uff0c\u8fd9\u65f6\uff0c\u901a\u5e38\u8981\u628a\u5927\u6587\u4ef6\u7684\u8bfb\u53d6\uff0c\u62c6\u5206\u6210\u8bb8\u591a\u4efd\uff0c\u6bcf\u4efd\u4ec5\u6709\u51e0\u5341 KB\uff0c\u964d\u4f4e\u5355\u6b21\u64cd\u4f5c\u7684\u8017\u65f6\u3002</li> <li>\u7b2c\u4e09\u7c7b\u662f\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\u4e0a\u6e38\u670d\u52a1\u3002\u4e0e\u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42\u76f8\u4f3c\uff0c\u6211\u4eec\u5fc5\u987b\u4f7f\u7528\u975e\u963b\u585e socket\uff0c\u7528\u4e8b\u4ef6\u9a71\u52a8\u65b9\u5f0f\u5904\u7406\u8bf7\u6c42\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8bb8\u591a\u7f51\u7edc\u670d\u52a1\u63d0\u4f9b\u7684 SDK\uff0c\u90fd\u662f\u57fa\u4e8e\u963b\u585e socket \u5b9e\u73b0\u7684\uff0c\u4f7f\u7528\u524d\u5fc5\u987b\u5148\u505a\u5b8c\u975e\u963b\u585e\u6539\u9020\u3002\u6bd4\u5982 Memcached \u7684\u5b98\u65b9 SDK \u662f\u7528\u963b\u585e socket \u5b9e\u73b0\u7684\uff0cNginx \u5982\u679c\u76f4\u63a5\u4f7f\u7528\u8be5 SDK \u8bbf\u95ee\u5b83\uff0c\u6027\u80fd\u5c31\u4f1a\u4e00\u843d\u5343\u4e08\u3002\u6b63\u786e\u7684\u8bbf\u95ee\u65b9\u5f0f\uff0c\u662f\u4f7f\u7528\u7b2c\u4e09\u65b9\u63d0\u4f9b\u7684 <code>ngx_http_memcached_module</code> \u6a21\u5757\uff0c\u5b83\u7528\u975e\u963b\u585e socket \u91cd\u65b0\u5c01\u88c5\u4e86 SDK\u3002</li> </ul> <p>\u7f51\u7edc\u62a5\u6587\u5230\u8fbe\u540e\uff0c\u5185\u6838\u5c31\u4ea7\u751f\u4e86\u8bfb\u3001\u5199\u4e8b\u4ef6\uff0c\u800c epoll \u51fd\u6570\u4f7f\u5f97\u8fdb\u7a0b\u53ef\u4ee5\u9ad8\u6548\u5730\u6536\u96c6\u5230\u8fd9\u4e9b\u4e8b\u4ef6\u3002\u63a5\u4e0b\u6765\uff0c\u8981\u786e\u4fdd\u5728\u8fdb\u7a0b\u4e2d\u5904\u7406\u6bcf\u4e2a\u4e8b\u4ef6\u7684\u65f6\u95f4\u8db3\u591f\u77ed\uff0c\u624d\u80fd\u53ca\u65f6\u5730\u5904\u7406\u6240\u6709\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u65e2\u8981\u907f\u514d\u963b\u585e socket \u7684\u4f7f\u7528\uff0c\u4e5f\u8981\u628a\u8017\u65f6\u8fc7\u957f\u7684\u64cd\u4f5c\u62c6\u6210\u591a\u4efd\u6267\u884c\u3002\u6700\u7ec8\uff0c\u901a\u8fc7\u5feb\u901f\u3001\u53ca\u65f6\u3001\u5747\u7b49\u5730\u6267\u884c\u6240\u6709\u4e8b\u4ef6\uff0c\u5f02\u6b65 Server \u5b9e\u73b0\u4e86\u9ad8\u5e76\u53d1\u3002</p>"},{"location":"chap2/2C10M/#3","title":"3\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u4e8b\u4ef6\u6709\u5f88\u591a\u79cd\uff0c\u7f51\u7edc\u6d88\u606f\u7684\u4f20\u8f93\u65e2\u6162\u53c8\u4e0d\u53ef\u63a7\uff0c\u6240\u4ee5\u7528\u7f51\u7edc\u4e8b\u4ef6\u9a71\u52a8\u8bf7\u6c42\u7684\u6027\u4ef7\u6bd4\u6700\u9ad8\u3002\u8fd9\u6837\uff0c\u5c31\u9700\u8981\u4f60\u4e86\u89e3 TCP \u62a5\u6587\u662f\u5982\u4f55\u4ea7\u751f\u4e8b\u4ef6\u7684\u3002</p> <p>TCP \u8fde\u63a5\u5efa\u7acb\u65f6\uff0c\u4f1a\u5728\u5ba2\u6237\u7aef\u4ea7\u751f\u5199\u4e8b\u4ef6\uff0c\u5728\u670d\u52a1\u5668\u7aef\u4ea7\u751f\u8bfb\u4e8b\u4ef6\u3002\u8fde\u63a5\u5173\u95ed\u65f6\uff0c\u5219\u4f1a\u5728\u88ab\u52a8\u5173\u95ed\u7aef\u4ea7\u751f\u8bfb\u4e8b\u4ef6\u3002\u5728\u8fde\u63a5\u4e0a\u6536\u53d1\u6d88\u606f\u65f6\uff0c\u4e5f\u4f1a\u4ea7\u751f\u4e8b\u4ef6\uff0c\u5176\u4e2d\u53d1\u9001\u6d88\u606f\u524d\u7684\u5199\u4e8b\u4ef6\u4e0e\u5185\u6838\u5206\u914d\u7684\u7f13\u51b2\u533a\u6709\u5173\u3002</p> <p>\u4f60\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5904\u7406 epoll \u6536\u96c6\u5230\u7684\u4e8b\u4ef6\u65f6\uff0c\u5fc5\u987b\u4fdd\u8bc1\u5904\u7406\u4e00\u4e2a\u4e8b\u4ef6\u7684\u5e73\u5747\u65f6\u95f4\u5728\u6beb\u79d2\u7ea7\u4ee5\u5185\u3002\u4f20\u7edf\u7684\u963b\u585e socket \u662f\u505a\u4e0d\u5230\u7684\uff0c\u6240\u4ee5\u5fc5\u987b\u7528\u975e\u963b\u585e socket \u66ff\u6362\u963b\u585e socket\u3002\u5982\u679c\u4e8b\u4ef6\u7684\u56de\u8c03\u51fd\u6570\u8017\u65f6\u8fc7\u957f\uff0c\u4e5f\u5f97\u62c6\u5206\u4e3a\u591a\u4e2a\u8017\u65f6\u77ed\u7684\u51fd\u6570\uff0c\u7528\u591a\u6b21\u4e8b\u4ef6\uff08\u6bd4\u5982\u5b9a\u65f6\u5668\u4e8b\u4ef6\uff09\u7684\u89e6\u53d1\u6765\u66ff\u4ee3\u3002</p> <p>\u867d\u7136\u6211\u4eec\u6709\u4e86\u4e0a\u8ff0\u7684\u4e8b\u4ef6\u9a71\u52a8\u65b9\u6848\uff0c\u4f46\u5b9e\u73b0 C10M \u8fd8\u9700\u8981\u66f4\u8c28\u614e\u5730\u4f7f\u7528\u4e0d\u8fc7\u6570\u767e GB \u7684\u670d\u52a1\u5668\u5185\u5b58</p>"},{"location":"chap2/3tcp3shakehand/","title":"\u7b2c\u4e09\u8282 \u63d0\u5347TCP\u4e09\u6b21\u63e1\u624b\u7684\u6027\u80fd","text":"<p>TCP \u662f\u4e00\u4e2a\u53ef\u4ee5\u53cc\u5411\u4f20\u8f93\u7684\u5168\u53cc\u5de5\u534f\u8bae\uff0c\u6240\u4ee5\u9700\u8981\u7ecf\u8fc7\u4e09\u6b21\u63e1\u624b\u624d\u80fd\u5efa\u7acb\u8fde\u63a5\u3002</p> <p>\u4e09\u6b21\u63e1\u624b\u5728\u4e00\u4e2a HTTP \u8bf7\u6c42\u4e2d\u7684\u5e73\u5747\u65f6\u95f4\u5360\u6bd4\u5728 10% \u4ee5\u4e0a\uff0c\u5728\u7f51\u7edc\u72b6\u51b5\u4e0d\u4f73\u3001\u9ad8\u5e76\u53d1\u6216\u8005\u906d\u9047 SYN \u6cdb\u6d2a\u653b\u51fb\u7b49\u573a\u666f\u4e2d\uff0c\u5982\u679c\u4e0d\u80fd\u6b63\u786e\u5730\u8c03\u6574\u4e09\u6b21\u63e1\u624b\u4e2d\u7684\u53c2\u6570\uff0c\u5c31\u4f1a\u5bf9\u6027\u80fd\u6709\u5f88\u5927\u7684\u5f71\u54cd\u3002</p> <p>TCP \u534f\u8bae\u662f\u7531\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u73b0\u7684\uff0c\u8c03\u6574 TCP \u5fc5\u987b\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u63a5\u53e3\u548c\u5de5\u5177\uff0c\u8fd9\u5c31\u9700\u8981\u7406\u89e3 Linux \u662f\u600e\u6837\u628a\u4e09\u6b21\u63e1\u624b\u4e2d\u7684\u72b6\u6001\u66b4\u9732\u7ed9\u6211\u4eec\uff0c\u4ee5\u53ca\u901a\u8fc7\u54ea\u4e9b\u5de5\u5177\u53ef\u4ee5\u627e\u5230\u4f18\u5316\u4f9d\u636e\uff0c\u5e76\u901a\u8fc7\u54ea\u4e9b\u63a5\u53e3\u4fee\u6539\u53c2\u6570\u3002</p>"},{"location":"chap2/3tcp3shakehand/#1","title":"1\u3001\u5ba2\u6237\u7aef\u7684\u4f18\u5316","text":"<p>\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u90fd\u53ef\u4ee5\u9488\u5bf9\u4e09\u6b21\u63e1\u624b\u4f18\u5316\u6027\u80fd\u3002\u76f8\u5bf9\u800c\u8a00\uff0c\u4e3b\u52a8\u53d1\u8d77\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u4f18\u5316\u76f8\u5bf9\u7b80\u5355\u4e00\u4e9b\uff0c\u800c\u670d\u52a1\u5668\u9700\u8981\u5728\u76d1\u542c\u7aef\u53e3\u4e0a\u88ab\u52a8\u7b49\u5f85\u8fde\u63a5\uff0c\u5e76\u4fdd\u5b58\u8bb8\u591a\u63e1\u624b\u7684\u4e2d\u95f4\u72b6\u6001\uff0c\u4f18\u5316\u65b9\u6cd5\u66f4\u4e3a\u590d\u6742\u4e00\u4e9b\u3002</p> <p>\u4e09\u6b21\u63e1\u624b\u5efa\u7acb\u8fde\u63a5\u7684\u9996\u8981\u76ee\u7684\u662f\u540c\u6b65\u5e8f\u5217\u53f7\u3002</p> <p>\u53ea\u6709\u540c\u6b65\u4e86\u5e8f\u5217\u53f7\u624d\u6709\u53ef\u9760\u7684\u4f20\u8f93\uff0cTCP \u534f\u8bae\u7684\u8bb8\u591a\u7279\u6027\u90fd\u662f\u4f9d\u8d56\u5e8f\u5217\u53f7\u5b9e\u73b0\u7684\uff0c\u6bd4\u5982\u6d41\u91cf\u63a7\u5236\u3001\u6d88\u606f\u4e22\u5931\u540e\u7684\u91cd\u53d1\u7b49\u7b49\uff0c\u8fd9\u4e5f\u662f\u4e09\u6b21\u63e1\u624b\u4e2d\u7684\u62a5\u6587\u88ab\u79f0\u4e3a SYN \u7684\u539f\u56e0\uff0c\u56e0\u4e3a SYN \u7684\u5168\u79f0\u5c31\u53eb\u505a <code>Synchronize Sequence Numbers</code>\u3002</p> <p>\u4e09\u6b21\u63e1\u624b\u867d\u7136\u7531\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u73b0\uff0c\u4f46\u5b83\u901a\u8fc7\u8fde\u63a5\u72b6\u6001\u628a\u8fd9\u4e00\u8fc7\u7a0b\u66b4\u9732\u7ed9\u4e86\u6211\u4eec\uff0c\u6211\u4eec\u6765\u7ec6\u770b\u4e0b\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u7684 3 \u79cd\u72b6\u6001\u7684\u610f\u4e49\u3002</p> <p>\u5ba2\u6237\u7aef\u53d1\u9001 SYN \u5f00\u542f\u4e86\u4e09\u6b21\u63e1\u624b\uff0c\u6b64\u65f6\u5728\u5ba2\u6237\u7aef\u4e0a\u7528 netstat \u547d\u4ee4\u53ef\u4ee5\u770b\u5230\u8fde\u63a5\u7684\u72b6\u6001\u662f <code>SYN_SENT</code>\uff08\u628a\u521a SYN \u53d1\u9001\u51fa\u53bb\uff09\u3002</p> <pre><code>tcp    0   1 172.16.20.227:39198     129.28.56.36:81         SYN_SENT\n</code></pre> <p>\u5ba2\u6237\u7aef\u5728\u7b49\u5f85\u670d\u52a1\u5668\u56de\u590d\u7684 ACK \u62a5\u6587\u3002\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u670d\u52a1\u5668\u4f1a\u5728\u51e0\u6beb\u79d2\u5185\u8fd4\u56de ACK\uff0c\u4f46\u5982\u679c\u5ba2\u6237\u7aef\u8fdf\u8fdf\u6ca1\u6709\u6536\u5230 ACK \u4f1a\u600e\u4e48\u6837\u5462\uff1f</p> <p>\u5ba2\u6237\u7aef\u4f1a\u91cd\u53d1 SYN\uff0c\u91cd\u8bd5\u7684\u6b21\u6570\u7531 <code>tcp_syn_retries</code> \u53c2\u6570\u63a7\u5236\uff0c\u9ed8\u8ba4\u662f 6 \u6b21\uff1a\u3002</p> <pre><code>net.ipv4.tcp_syn_retries = 6\n</code></pre> <p>\u7b2c 1 \u6b21\u91cd\u8bd5\u53d1\u751f\u5728 1 \u79d2\u949f\u540e\uff0c\u63a5\u7740\u4f1a\u4ee5\u7ffb\u500d\u7684\u65b9\u5f0f\u5728\u7b2c 2\u30014\u30018\u300116\u300132 \u79d2\u5171\u505a 6 \u6b21\u91cd\u8bd5\uff0c\u6700\u540e\u4e00\u6b21\u91cd\u8bd5\u4f1a\u7b49\u5f85 64 \u79d2\uff0c\u5982\u679c\u4ecd\u7136\u6ca1\u6709\u8fd4\u56de ACK\uff0c\u624d\u4f1a\u7ec8\u6b62\u4e09\u6b21\u63e1\u624b\u3002\u6240\u4ee5\uff0c\u603b\u8017\u65f6\u662f 1+2+4+8+16+32+64=127 \u79d2\uff0c\u8d85\u8fc7 2 \u5206\u949f\u3002</p> <p>\u5982\u679c\u8fd9\u662f\u4e00\u53f0\u6709\u660e\u786e\u4efb\u52a1\u7684\u670d\u52a1\u5668\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u7f51\u7edc\u7684\u7a33\u5b9a\u6027\u548c\u76ee\u6807\u670d\u52a1\u5668\u7684\u7e41\u5fd9\u7a0b\u5ea6\u4fee\u6539\u91cd\u8bd5\u6b21\u6570\uff0c\u8c03\u6574\u5ba2\u6237\u7aef\u7684\u4e09\u6b21\u63e1\u624b\u65f6\u95f4\u4e0a\u9650</p> <p>\u6bd4\u5982\u5185\u7f51\u4e2d\u901a\u8baf\u65f6\uff0c\u5c31\u53ef\u4ee5\u9002\u5f53\u8c03\u4f4e\u91cd\u8bd5\u6b21\u6570\uff0c\u5c3d\u5feb\u628a\u9519\u8bef\u66b4\u9732\u7ed9\u5e94\u7528\u7a0b\u5e8f\u3002</p> <p></p>"},{"location":"chap2/3tcp3shakehand/#2","title":"2\u3001\u670d\u52a1\u5668\u7aef\u7684\u4f18\u5316","text":""},{"location":"chap2/3tcp3shakehand/#2-1-syn","title":"2-1 SYN \u961f\u5217\u6ea2\u51fa\u4f18\u5316","text":"<p>\u5f53\u670d\u52a1\u5668\u6536\u5230 SYN \u62a5\u6587\u540e\uff0c\u670d\u52a1\u5668\u4f1a\u7acb\u523b\u56de\u590d <code>SYN+ACK</code>\u62a5\u6587\uff0c\u65e2\u786e\u8ba4\u4e86\u5ba2\u6237\u7aef\u7684\u5e8f\u5217\u53f7\uff0c\u4e5f\u628a\u81ea\u5df1\u7684\u5e8f\u5217\u53f7\u53d1\u7ed9\u4e86\u5bf9\u65b9\u3002</p> <p>\u6b64\u65f6\uff0c\u670d\u52a1\u5668\u7aef\u51fa\u73b0\u4e86\u65b0\u8fde\u63a5\uff0c\u72b6\u6001\u662f <code>SYN_RCV</code>\uff08RCV \u662f received \u7684\u7f29\u5199\uff09\u3002</p> <p>\u8fd9\u4e2a\u72b6\u6001\u4e0b\uff0c\u670d\u52a1\u5668\u5fc5\u987b\u5efa\u7acb\u4e00\u4e2a <code>SYN</code> \u534a\u8fde\u63a5\u961f\u5217\u6765\u7ef4\u62a4\u672a\u5b8c\u6210\u7684\u63e1\u624b\u4fe1\u606f\uff0c\u5f53\u8fd9\u4e2a\u961f\u5217\u6ea2\u51fa\u540e\uff0c\u670d\u52a1\u5668\u5c06\u65e0\u6cd5\u518d\u5efa\u7acb\u65b0\u8fde\u63a5\u3002</p> <p></p> <p>\u65b0\u8fde\u63a5\u5efa\u7acb\u5931\u8d25\u7684\u539f\u56e0\u6709\u5f88\u591a\uff0c\u600e\u6837\u83b7\u5f97\u7531\u4e8e\u961f\u5217\u5df2\u6ee1\u800c\u5f15\u53d1\u7684\u5931\u8d25\u6b21\u6570\u5462\uff1f<code>netstat -s</code> \u547d\u4ee4\u7ed9\u51fa\u7684\u7edf\u8ba1\u7ed3\u679c\u4e2d\u53ef\u4ee5\u5f97\u5230\u3002</p> <pre><code>\n# netstat -s | grep \"SYNs to LISTEN\"\n    1192450 SYNs to LISTEN sockets dropped\n</code></pre> <p>\u8fd9\u91cc\u7ed9\u51fa\u7684\u662f\u961f\u5217\u6ea2\u51fa\u5bfc\u81f4 SYN \u88ab\u4e22\u5f03\u7684\u4e2a\u6570\u3002\u6ce8\u610f\u8fd9\u662f\u4e00\u4e2a\u7d2f\u8ba1\u503c\uff0c\u5982\u679c\u6570\u503c\u5728\u6301\u7eed\u589e\u52a0\uff0c\u5219\u5e94\u8be5\u8c03\u5927 SYN \u534a\u8fde\u63a5\u961f\u5217\u3002</p> <p>\u4fee\u6539\u961f\u5217\u5927\u5c0f\u7684\u65b9\u6cd5\uff0c\u662f\u8bbe\u7f6e Linux \u7684 <code>tcp_max_syn_backlog</code>\u53c2\u6570\uff1a\u3002</p> <pre><code>net.ipv4.tcp_max_syn_backlog = 1024\n</code></pre>"},{"location":"chap2/3tcp3shakehand/#2-2-syncookies-syn","title":"2-2 syncookies\u4e0d\u4f7f\u7528 SYN \u961f\u5217","text":"<p>\u5982\u679c SYN \u534a\u8fde\u63a5\u961f\u5217\u5df2\u6ee1\uff0c\u53ea\u80fd\u4e22\u5f03\u8fde\u63a5\u5417\uff1f</p> <p>\u5e76\u4e0d\u662f\u8fd9\u6837\uff0c\u5f00\u542f syncookies \u529f\u80fd\u5c31\u53ef\u4ee5\u5728\u4e0d\u4f7f\u7528 SYN \u961f\u5217\u7684\u60c5\u51b5\u4e0b\u6210\u529f\u5efa\u7acb\u8fde\u63a5\u3002</p> <p>syncookies \u662f\u8fd9\u4e48\u505a\u7684\uff1a\u670d\u52a1\u5668\u6839\u636e\u5f53\u524d\u72b6\u6001\u8ba1\u7b97\u51fa\u4e00\u4e2a\u503c\uff0c\u653e\u5728\u5df1\u65b9\u53d1\u51fa\u7684 SYN+ACK \u62a5\u6587\u4e2d\u53d1\u51fa\uff0c\u5f53\u5ba2\u6237\u7aef\u8fd4\u56de ACK \u62a5\u6587\u65f6\uff0c\u53d6\u51fa\u8be5\u503c\u9a8c\u8bc1\uff0c\u5982\u679c\u5408\u6cd5\uff0c\u5c31\u8ba4\u4e3a\u8fde\u63a5\u5efa\u7acb\u6210\u529f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002</p> <p></p> <p>Linux \u4e0b\u600e\u6837\u5f00\u542f syncookies \u529f\u80fd\u5462\uff1f</p> <p>\u4fee\u6539 <code>tcp_syncookies</code> \u53c2\u6570\u5373\u53ef\uff0c\u5176\u4e2d\u503c\u4e3a 0 \u65f6\u8868\u793a\u5173\u95ed\u8be5\u529f\u80fd\uff0c2 \u8868\u793a\u65e0\u6761\u4ef6\u5f00\u542f\u529f\u80fd\uff0c\u800c 1 \u5219\u8868\u793a\u4ec5\u5f53 SYN \u534a\u8fde\u63a5\u961f\u5217\u653e\u4e0d\u4e0b\u65f6\uff0c\u518d\u542f\u7528\u5b83\u3002</p> <p>\u7531\u4e8e syncookie \u4ec5\u7528\u4e8e\u5e94\u5bf9 SYN \u6cdb\u6d2a\u653b\u51fb\uff08\u653b\u51fb\u8005\u6076\u610f\u6784\u9020\u5927\u91cf\u7684 SYN \u62a5\u6587\u53d1\u9001\u7ed9\u670d\u52a1\u5668\uff0c\u9020\u6210 SYN \u534a\u8fde\u63a5\u961f\u5217\u6ea2\u51fa\uff0c\u5bfc\u81f4\u6b63\u5e38\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u65e0\u6cd5\u5efa\u7acb\uff09\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5efa\u7acb\u7684\u8fde\u63a5\uff0c\u8bb8\u591a TCP \u7279\u6027\u90fd\u65e0\u6cd5\u4f7f\u7528\u3002\u6240\u4ee5\uff0c\u5e94\u5f53\u628a<code>tcp_syncookies</code>\u8bbe\u7f6e\u4e3a 1\uff0c\u4ec5\u5728\u961f\u5217\u6ee1\u65f6\u518d\u542f\u7528\u3002</p> <pre><code>net.ipv4.tcp_syncookies = 1\n</code></pre> <p>\u5f53\u5ba2\u6237\u7aef\u63a5\u6536\u5230\u670d\u52a1\u5668\u53d1\u6765\u7684 <code>SYN+ACK</code> \u62a5\u6587\u540e\uff0c\u5c31\u4f1a\u56de\u590d ACK \u53bb\u901a\u77e5\u670d\u52a1\u5668\uff0c\u540c\u65f6\u5df1\u65b9\u8fde\u63a5\u72b6\u6001\u4ece <code>SYN_SENT</code> \u8f6c\u6362\u4e3a ESTABLISHED\uff0c\u8868\u793a\u8fde\u63a5\u5efa\u7acb\u6210\u529f\u3002\u670d\u52a1\u5668\u7aef\u8fde\u63a5\u6210\u529f\u5efa\u7acb\u7684\u65f6\u95f4\u8fd8\u8981\u518d\u5f80\u540e\uff0c\u5230\u5b83\u6536\u5230 ACK \u540e\u72b6\u6001\u624d\u53d8\u4e3a <code>ESTABLISHED</code>\u3002</p>"},{"location":"chap2/3tcp3shakehand/#2-3-tcp_synack_retries","title":"2-3 <code>tcp_synack_retries</code>","text":"<p>\u5982\u679c\u670d\u52a1\u5668\u6ca1\u6709\u6536\u5230 ACK\uff0c\u5c31\u4f1a\u4e00\u76f4\u91cd\u53d1 SYN+ACK \u62a5\u6587\u3002\u5f53\u7f51\u7edc\u7e41\u5fd9\u3001\u4e0d\u7a33\u5b9a\u65f6\uff0c\u62a5\u6587\u4e22\u5931\u5c31\u4f1a\u53d8\u4e25\u91cd\uff0c\u6b64\u65f6\u5e94\u8be5\u8c03\u5927\u91cd\u53d1\u6b21\u6570\u3002\u53cd\u4e4b\u5219\u53ef\u4ee5\u8c03\u5c0f\u91cd\u53d1\u6b21\u6570\u3002\u4fee\u6539\u91cd\u53d1\u6b21\u6570\u7684\u65b9\u6cd5\u662f\uff0c\u8c03\u6574 <code>tcp_synack_retries</code> \u53c2\u6570\uff1a</p> <pre><code>net.ipv4.tcp_synack_retries = 5\n</code></pre> <p><code>tcp_synack_retries</code>\u7684\u9ed8\u8ba4\u91cd\u8bd5\u6b21\u6570\u662f 5 \u6b21\uff0c\u4e0e\u5ba2\u6237\u7aef\u91cd\u53d1 SYN \u7c7b\u4f3c\uff0c\u5b83\u7684\u91cd\u8bd5\u4f1a\u7ecf\u5386 1\u30012\u30014\u30018\u300116 \u79d2\uff0c\u6700\u540e\u4e00\u6b21\u91cd\u8bd5\u540e\u7b49\u5f85 32 \u79d2\uff0c\u82e5\u4ecd\u7136\u6ca1\u6709\u6536\u5230 ACK\uff0c\u624d\u4f1a\u5173\u95ed\u8fde\u63a5\uff0c\u6545\u5171\u9700\u8981\u7b49\u5f85 63 \u79d2\u3002</p>"},{"location":"chap2/3tcp3shakehand/#2-4-accept","title":"2-4 accept \u961f\u5217\u6ea2\u51fa\u4f18\u5316","text":"<p>\u670d\u52a1\u5668\u6536\u5230 ACK \u540e\u8fde\u63a5\u5efa\u7acb\u6210\u529f\uff0c\u6b64\u65f6\uff0c\u5185\u6838\u4f1a\u628a\u8fde\u63a5\u4ece SYN \u534a\u8fde\u63a5\u961f\u5217\u4e2d\u79fb\u51fa\uff0c\u518d\u79fb\u5165 accept \u961f\u5217\uff0c\u7b49\u5f85\u8fdb\u7a0b\u8c03\u7528 accept \u51fd\u6570\u65f6\u628a\u8fde\u63a5\u53d6\u51fa\u6765\u3002</p> <p>\u5982\u679c\u8fdb\u7a0b\u4e0d\u80fd\u53ca\u65f6\u5730\u8c03\u7528 accept \u51fd\u6570\uff0c\u5c31\u4f1a\u9020\u6210 accept \u961f\u5217\u6ea2\u51fa\uff0c\u6700\u7ec8\u5bfc\u81f4\u5efa\u7acb\u597d\u7684 TCP \u8fde\u63a5\u88ab\u4e22\u5f03\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u4e22\u5f03\u8fde\u63a5\u53ea\u662f Linux \u7684\u9ed8\u8ba4\u884c\u4e3a\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u9009\u62e9\u5411\u5ba2\u6237\u7aef\u53d1\u9001 RST \u590d\u4f4d\u62a5\u6587\uff0c\u544a\u8bc9\u5ba2\u6237\u7aef\u8fde\u63a5\u5df2\u7ecf\u5efa\u7acb\u5931\u8d25\u3002\u6253\u5f00\u8fd9\u4e00\u529f\u80fd\u9700\u8981\u5c06 <code>tcp_abort_on_overflow</code> \u53c2\u6570\u8bbe\u7f6e\u4e3a 1\u3002</p> <pre><code>net.ipv4.tcp_abort_on_overflow = 0\n</code></pre> <p>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5e94\u5f53\u628a <code>tcp_abort_on_overflow</code> \u8bbe\u7f6e\u4e3a 0\uff0c\u56e0\u4e3a\u8fd9\u6837\u66f4\u6709\u5229\u4e8e\u5e94\u5bf9\u7a81\u53d1\u6d41\u91cf\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5f53 accept \u961f\u5217\u6ee1\u5bfc\u81f4\u670d\u52a1\u5668\u4e22\u6389\u4e86 ACK\uff0c\u4e0e\u6b64\u540c\u65f6\uff0c\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u72b6\u6001\u5374\u662f ESTABLISHED\uff0c\u8fdb\u7a0b\u5c31\u5728\u5efa\u7acb\u597d\u7684\u8fde\u63a5\u4e0a\u53d1\u9001\u8bf7\u6c42\u3002\u53ea\u8981\u670d\u52a1\u5668\u6ca1\u6709\u4e3a\u8bf7\u6c42\u56de\u590d ACK\uff0c\u8bf7\u6c42\u5c31\u4f1a\u88ab\u591a\u6b21\u91cd\u53d1\u3002\u5982\u679c\u670d\u52a1\u5668\u4e0a\u7684\u8fdb\u7a0b\u53ea\u662f\u77ed\u6682\u7684\u7e41\u5fd9\u9020\u6210 accept \u961f\u5217\u6ee1\uff0c\u90a3\u4e48\u5f53 accept \u961f\u5217\u6709\u7a7a\u4f4d\u65f6\uff0c\u518d\u6b21\u63a5\u6536\u5230\u7684\u8bf7\u6c42\u62a5\u6587\u7531\u4e8e\u542b\u6709 ACK\uff0c\u4ecd\u7136\u4f1a\u89e6\u53d1\u670d\u52a1\u5668\u7aef\u6210\u529f\u5efa\u7acb\u8fde\u63a5\u3002</p> <p>\u6240\u4ee5\uff0c<code>tcp_abort_on_overflow</code> \u8bbe\u4e3a 0 \u53ef\u4ee5\u63d0\u9ad8\u8fde\u63a5\u5efa\u7acb\u7684\u6210\u529f\u7387\uff0c\u53ea\u6709\u4f60\u975e\u5e38\u80af\u5b9a accept \u961f\u5217\u4f1a\u957f\u671f\u6ea2\u51fa\u65f6\uff0c\u624d\u80fd\u8bbe\u7f6e\u4e3a 1 \u4ee5\u5c3d\u5feb\u901a\u77e5\u5ba2\u6237\u7aef\u3002</p> <p>\u90a3\u4e48\uff0c\u600e\u6837\u8c03\u6574 accept \u961f\u5217\u7684\u957f\u5ea6\u5462\uff1f</p> <p>listen \u51fd\u6570\u7684 backlog \u53c2\u6570\u5c31\u53ef\u4ee5\u8bbe\u7f6e accept \u961f\u5217\u7684\u5927\u5c0f\u3002\u4e8b\u5b9e\u4e0a\uff0cbacklog \u53c2\u6570\u8fd8\u53d7\u9650\u4e8e Linux \u7cfb\u7edf\u7ea7\u7684\u961f\u5217\u957f\u5ea6\u4e0a\u9650\uff0c\u5f53\u7136\u8fd9\u4e2a\u4e0a\u9650\u9608\u503c\u4e5f\u53ef\u4ee5\u901a\u8fc7 somaxconn \u53c2\u6570\u4fee\u6539\u3002</p> <pre><code>net.core.somaxconn = 128\n</code></pre> <p>\u5f53\u4e0b\u5404\u76d1\u542c\u7aef\u53e3\u4e0a\u7684 accept \u961f\u5217\u957f\u5ea6\u53ef\u4ee5\u901a\u8fc7<code>ss -ltn</code> \u547d\u4ee4\u67e5\u770b\uff0c\u4f46 accept \u961f\u5217\u957f\u5ea6\u662f\u5426\u9700\u8981\u8c03\u6574\u8be5\u600e\u4e48\u5224\u65ad\u5462\uff1f</p> <p>\u8fd8\u662f\u901a\u8fc7 <code>netstat -s</code>\u547d\u4ee4\u7ed9\u51fa\u7684\u7edf\u8ba1\u7ed3\u679c\uff0c\u53ef\u4ee5\u770b\u5230\u7a76\u7adf\u6709\u591a\u5c11\u4e2a\u8fde\u63a5\u56e0\u4e3a\u961f\u5217\u6ea2\u51fa\u800c\u88ab\u4e22\u5f03\u3002</p> <pre><code># netstat -s | grep \"listen queue\"\n    14 times the listen queue of a socket overflowed\n</code></pre> <p>\u5982\u679c\u6301\u7eed\u4e0d\u65ad\u5730\u6709\u8fde\u63a5\u56e0\u4e3a accept \u961f\u5217\u6ea2\u51fa\u88ab\u4e22\u5f03\uff0c\u5c31\u5e94\u8be5\u8c03\u5927 backlog \u4ee5\u53ca somaxconn \u53c2\u6570\u3002</p>"},{"location":"chap2/3tcp3shakehand/#3-tfo","title":"3\u3001 TFO \u6280\u672f\u5982\u4f55\u7ed5\u8fc7\u4e09\u6b21\u63e1\u624b\uff1f","text":"<p>\u5982\u4f55\u7ed5\u8fc7\u4e09\u6b21\u63e1\u624b\u53d1\u9001\u6570\u636e</p> <p>\u4e09\u6b21\u63e1\u624b\u5efa\u7acb\u8fde\u63a5\u9020\u6210\u7684\u540e\u679c\u5c31\u662f\uff0cHTTP \u8bf7\u6c42\u5fc5\u987b\u5728\u4e00\u6b21 RTT\uff08Round Trip Time\uff0c\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u5668\u4e00\u4e2a\u5f80\u8fd4\u7684\u65f6\u95f4\uff09\u540e\u624d\u80fd\u53d1\u9001\uff0cGoogle \u5bf9\u6b64\u505a\u7684\u7edf\u8ba1\u663e\u793a\uff0c\u4e09\u6b21\u63e1\u624b\u6d88\u8017\u7684\u65f6\u95f4\uff0c\u5728 HTTP \u8bf7\u6c42\u5b8c\u6210\u7684\u65f6\u95f4\u5360\u6bd4\u5728 10% \u5230 30% \u4e4b\u95f4\u3002</p> <p></p> <p>\u56e0\u6b64\uff0cGoogle \u63d0\u51fa\u4e86 TCP fast open \u65b9\u6848\uff08\u7b80\u79f0TFO\uff09\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u5728\u9996\u4e2a SYN \u62a5\u6587\u4e2d\u5c31\u643a\u5e26\u8bf7\u6c42\uff0c\u8fd9\u8282\u7701\u4e86 1 \u4e2a RTT \u7684\u65f6\u95f4\u3002</p>"},{"location":"chap2/3tcp3shakehand/#3-1-tfo","title":"3-1 TFO \u5177\u4f53\u662f\u600e\u4e48\u5b9e\u73b0\u7684","text":"<p>\u4e3a\u4e86\u8ba9\u5ba2\u6237\u7aef\u5728 SYN \u62a5\u6587\u4e2d\u643a\u5e26\u8bf7\u6c42\u6570\u636e\uff0c\u5fc5\u987b\u89e3\u51b3\u670d\u52a1\u5668\u7684\u4fe1\u4efb\u95ee\u9898\u3002\u56e0\u4e3a\u6b64\u65f6\u670d\u52a1\u5668\u7684 SYN \u62a5\u6587\u8fd8\u6ca1\u6709\u53d1\u7ed9\u5ba2\u6237\u7aef\uff0c\u5ba2\u6237\u7aef\u662f\u5426\u80fd\u591f\u6b63\u5e38\u5efa\u7acb\u8fde\u63a5\u8fd8\u672a\u53ef\u77e5\uff0c\u4f46\u6b64\u65f6\u670d\u52a1\u5668\u9700\u8981\u5047\u5b9a\u8fde\u63a5\u5df2\u7ecf\u5efa\u7acb\u6210\u529f\uff0c\u5e76\u628a\u8bf7\u6c42\u4ea4\u4ed8\u7ed9\u8fdb\u7a0b\u53bb\u5904\u7406\uff0c\u6240\u4ee5\u670d\u52a1\u5668\u5fc5\u987b\u80fd\u591f\u4fe1\u4efb\u8fd9\u4e2a\u5ba2\u6237\u7aef\u3002</p>"},{"location":"chap2/3tcp3shakehand/#3-2-tfo","title":"3-2 TFO \u5230\u5e95\u600e\u6837\u8fbe\u6210\u8fd9\u4e00\u76ee\u7684\u5462\uff1f","text":"<p>\u5b83\u628a\u901a\u8baf\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5\uff0c\u7b2c\u4e00\u9636\u6bb5\u4e3a\u9996\u6b21\u5efa\u7acb\u8fde\u63a5\uff0c\u8fd9\u65f6\u8d70\u6b63\u5e38\u7684\u4e09\u6b21\u63e1\u624b\uff0c\u4f46\u5728\u5ba2\u6237\u7aef\u7684 SYN \u62a5\u6587\u4f1a\u660e\u786e\u5730\u544a\u8bc9\u670d\u52a1\u5668\u5b83\u60f3\u4f7f\u7528 TFO \u529f\u80fd\uff0c\u8fd9\u6837\u670d\u52a1\u5668\u4f1a\u628a\u5ba2\u6237\u7aef IP \u5730\u5740\u7528\u53ea\u6709\u81ea\u5df1\u77e5\u9053\u7684\u5bc6\u94a5\u52a0\u5bc6\uff08\u6bd4\u5982 AES \u52a0\u5bc6\u7b97\u6cd5\uff09\uff0c\u4f5c\u4e3a<code>Cookie</code> \u643a\u5e26\u5728\u8fd4\u56de\u7684 SYN+ACK \u62a5\u6587\u4e2d\uff0c\u5ba2\u6237\u7aef\u6536\u5230\u540e\u4f1a\u5c06 Cookie \u7f13\u5b58\u5728\u672c\u5730\u3002</p> <p>\u4e4b\u540e\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u518d\u6b21\u5411\u670d\u52a1\u5668\u5efa\u7acb\u8fde\u63a5\uff0c\u5c31\u53ef\u4ee5\u5728\u7b2c\u4e00\u4e2a SYN \u62a5\u6587\u4e2d\u643a\u5e26\u8bf7\u6c42\u6570\u636e\uff0c\u540c\u65f6\u8fd8\u8981\u9644\u5e26\u7f13\u5b58\u7684 Cookie\u3002\u5f88\u663e\u7136\uff0c\u8fd9\u79cd\u901a\u8baf\u65b9\u5f0f\u4e0b\u4e0d\u80fd\u518d\u91c7\u7528\u7ecf\u5178\u7684\u201c\u5148 connect \u518d write \u8bf7\u6c42\u201d\u8fd9\u79cd\u7f16\u7a0b\u65b9\u6cd5\uff0c\u800c\u8981\u6539\u7528 sendto \u6216\u8005 sendmsg \u51fd\u6570\u624d\u80fd\u5b9e\u73b0\u3002</p> <p>\u670d\u52a1\u5668\u6536\u5230\u540e\uff0c\u4f1a\u7528\u81ea\u5df1\u7684\u5bc6\u94a5\u9a8c\u8bc1 Cookie \u662f\u5426\u5408\u6cd5\uff0c\u9a8c\u8bc1\u901a\u8fc7\u540e\u8fde\u63a5\u624d\u7b97\u5efa\u7acb\u6210\u529f\uff0c\u518d\u628a\u8bf7\u6c42\u4ea4\u7ed9\u8fdb\u7a0b\u5904\u7406\uff0c\u540c\u65f6\u7ed9\u5ba2\u6237\u7aef\u8fd4\u56de SYN+ACK\u3002</p> <p>\u867d\u7136\u5ba2\u6237\u7aef\u6536\u5230\u540e\u8fd8\u4f1a\u8fd4\u56de ACK\uff0c\u4f46\u670d\u52a1\u5668\u4e0d\u7b49\u6536\u5230 ACK \u5c31\u53ef\u4ee5\u53d1\u9001 HTTP \u54cd\u5e94\u4e86\uff0c\u8fd9\u5c31\u51cf\u5c11\u4e86\u63e1\u624b\u5e26\u6765\u7684 1 \u4e2a RTT \u7684\u65f6\u95f4\u6d88\u8017\u3002</p> <p></p> <p>\u5f53\u7136\uff0c\u4e3a\u4e86\u9632\u6b62 SYN \u6cdb\u6d2a\u653b\u51fb\uff0c\u670d\u52a1\u5668\u7684 TFO \u5b9e\u73b0\u5fc5\u987b\u80fd\u591f\u81ea\u52a8\u5316\u5730\u5b9a\u65f6\u66f4\u65b0\u5bc6\u94a5\u3002</p>"},{"location":"chap2/3tcp3shakehand/#3-3-linux-tfo","title":"3-3 Linux \u4e0b\u600e\u4e48\u6253\u5f00 TFO \u529f\u80fd\u5462","text":"<p>\u8fd9\u8981\u901a\u8fc7 tcp_fastopen \u53c2\u6570\u3002\u7531\u4e8e\u53ea\u6709\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u540c\u65f6\u652f\u6301\u65f6\uff0cTFO \u529f\u80fd\u624d\u80fd\u4f7f\u7528\uff0c\u6240\u4ee5 <code>tcp_fastopen</code> \u53c2\u6570\u662f\u6309\u6bd4\u7279\u4f4d\u63a7\u5236\u7684\u3002</p> <p>\u5176\u4e2d\uff0c\u7b2c 1 \u4e2a\u6bd4\u7279\u4f4d\u4e3a 1 \u65f6\uff0c\u8868\u793a\u4f5c\u4e3a\u5ba2\u6237\u7aef\u65f6\u652f\u6301 TFO\uff1b\u7b2c 2 \u4e2a\u6bd4\u7279\u4f4d\u4e3a 1 \u65f6\uff0c\u8868\u793a\u4f5c\u4e3a\u670d\u52a1\u5668\u65f6\u652f\u6301 TFO\uff0c\u6240\u4ee5\u5f53 <code>tcp_fastopen</code>\u7684\u503c\u4e3a 3 \u65f6\uff08\u6bd4\u7279\u4e3a 0x11\uff09\u5c31\u8868\u793a\u5b8c\u5168\u652f\u6301 TFO \u529f\u80fd\u3002</p> <pre><code>net.ipv4.tcp_fastopen = 3\n</code></pre>"},{"location":"chap2/3tcp3shakehand/#4","title":"4\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u5f53\u5ba2\u6237\u7aef\u901a\u8fc7\u53d1\u9001 SYN \u53d1\u8d77\u63e1\u624b\u65f6\uff0c</p> <ul> <li>\u53ef\u4ee5\u901a\u8fc7 <code>tcp_syn_retries</code> \u63a7\u5236\u91cd\u53d1\u6b21\u6570\u3002</li> <li>\u5f53\u670d\u52a1\u5668\u7684 SYN \u534a\u8fde\u63a5\u961f\u5217\u6ea2\u51fa\u540e\uff0cSYN \u62a5\u6587\u4f1a\u4e22\u5931\u4ece\u800c\u5bfc\u81f4\u8fde\u63a5\u5efa\u7acb\u5931\u8d25\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 <code>netstat -s</code> \u7ed9\u51fa\u7684\u7edf\u8ba1\u7ed3\u679c\u5224\u65ad\u961f\u5217\u957f\u5ea6\u662f\u5426\u5408\u9002\uff0c\u8fdb\u800c\u901a\u8fc7 <code>tcp_max_syn_backlog</code> \u53c2\u6570\u8c03\u6574\u961f\u5217\u7684\u957f\u5ea6\u3002</li> <li>\u670d\u52a1\u5668\u56de\u590d SYN+ACK \u62a5\u6587\u7684\u91cd\u8bd5\u6b21\u6570\u7531 <code>tcp_synack_retries</code> \u53c2\u6570\u63a7\u5236\uff0c\u7f51\u7edc\u7a33\u5b9a\u65f6\u53ef\u4ee5\u8c03\u5c0f\u5b83\u3002</li> <li>\u4e3a\u4e86\u5e94\u5bf9 SYN \u6cdb\u6d2a\u653b\u51fb\uff0c\u5e94\u5c06 <code>tcp_syncookies</code> \u53c2\u6570\u8bbe\u7f6e\u4e3a 1\uff0c\u5b83\u4ec5\u5728 SYN \u961f\u5217\u6ee1\u540e\u5f00\u542f syncookie \u529f\u80fd\uff0c\u4fdd\u8bc1\u8fde\u63a5\u6210\u529f\u5efa\u7acb\u3002</li> </ul> <p>\u670d\u52a1\u5668\u6536\u5230\u5ba2\u6237\u7aef\u8fd4\u56de\u7684 ACK \u540e</p> <ul> <li>\u4f1a\u628a\u8fde\u63a5\u79fb\u5165 accept \u961f\u5217\uff0c\u7b49\u5f85\u8fdb\u7a0b\u8c03\u7528 accept \u51fd\u6570\u53d6\u51fa\u8fde\u63a5\u3002\u5982\u679c accept \u961f\u5217\u6ea2\u51fa\uff0c\u9ed8\u8ba4\u7cfb\u7edf\u4f1a\u4e22\u5f03 ACK\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 <code>tcp_abort_on_overflow</code> \u53c2\u6570\u7528 RST \u901a\u77e5\u5ba2\u6237\u7aef\u8fde\u63a5\u5efa\u7acb\u5931\u8d25\u3002</li> <li>\u5982\u679c netstat \u7edf\u8ba1\u4fe1\u606f\u663e\u793a\uff0c\u5927\u91cf\u7684 ACK \u88ab\u4e22\u5f03\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7 listen \u51fd\u6570\u7684 backlog \u53c2\u6570\u548c somaxconn \u7cfb\u7edf\u53c2\u6570\u63d0\u9ad8\u961f\u5217\u4e0a\u9650\u3002</li> </ul> <p>TFO \u6280\u672f\u7ed5\u8fc7\u4e09\u6b21\u63e1\u624b\uff0c\u4f7f\u5f97 HTTP \u8bf7\u6c42\u51cf\u5c11\u4e86 1 \u4e2a RTT \u7684\u65f6\u95f4\u3002Linux \u4e0b\u53ef\u4ee5\u901a\u8fc7 tcp_fastopen \u53c2\u6570\u5f00\u542f\u8be5\u529f\u80fd\u3002</p> <p>\u957f\u8fde\u63a5\u4f18\u5316\uff0c \u51cf\u5c11<code>time_wait</code>\u65f6\u957f\uff0c\u590d\u7528<code>time_wait</code>\u8fde\u63a5</p>"},{"location":"chap2/4tcpshutdown/","title":"\u7b2c\u56db\u8282 \u63d0\u5347TCP\u56db\u6b21\u6325\u624b\u7684\u6027\u80fd","text":"<p>close \u548c shutdown \u51fd\u6570\u90fd\u53ef\u4ee5\u5173\u95ed\u8fde\u63a5\uff0c\u4f46\u8fd9\u4e24\u79cd\u65b9\u5f0f\u5173\u95ed\u7684\u8fde\u63a5\uff0c\u4e0d\u53ea\u529f\u80fd\u4e0a\u6709\u5dee\u5f02\uff0c\u63a7\u5236\u5b83\u4eec\u7684 Linux \u53c2\u6570\u4e5f\u4e0d\u76f8\u540c\u3002</p> <ul> <li>close \u51fd\u6570\u4f1a\u8ba9\u8fde\u63a5\u53d8\u4e3a\u5b64\u513f\u8fde\u63a5\uff0c</li> <li>shutdown \u51fd\u6570\u5219\u5141\u8bb8\u5728\u534a\u5173\u95ed\u7684\u8fde\u63a5\u4e0a\u957f\u65f6\u95f4\u4f20\u8f93\u6570\u636e\u3002</li> </ul> <p>TCP \u4e4b\u6240\u4ee5\u5177\u5907\u8fd9\u4e2a\u529f\u80fd\uff0c\u662f\u56e0\u4e3a\u5b83\u662f\u5168\u53cc\u5de5\u534f\u8bae\uff0c\u4f46\u8fd9\u4e5f\u9020\u6210\u56db\u6b21\u6325\u624b\u975e\u5e38\u590d\u6742\u3002</p> <p>\u56db\u6b21\u6325\u624b\u4e2d\u4f60\u53ef\u4ee5\u7528 <code>netstat</code> \u547d\u4ee4\u89c2\u5bdf\u5230 6 \u79cd\u72b6\u6001\u3002</p> <p>Linux \u4e3a\u56db\u6b21\u6325\u624b\u63d0\u4f9b\u4e86\u5f88\u591a\u63a7\u5236\u53c2\u6570\uff0c\u6709\u4e9b\u53c2\u6570\u7684\u540d\u79f0\u4e0e\u542b\u4e49\u5e76\u4e0d\u76f8\u7b26\u3002\u4f8b\u5982 <code>tcp_orphan_retries</code> \u53c2\u6570\u4e2d\u6709 orphan \u5b64\u513f\uff0c\u5374\u540c\u65f6\u5bf9\u975e\u5b64\u513f\u8fde\u63a5\u4e5f\u751f\u6548\u3002</p> <p>\u800c\u4e14\uff0c\u9519\u8bef\u5730\u914d\u7f6e\u8fd9\u4e9b\u53c2\u6570\uff0c\u4e0d\u53ea\u65e0\u6cd5\u9488\u5bf9\u9ad8\u5e76\u53d1\u573a\u666f\u63d0\u5347\u6027\u80fd\uff0c\u8fd8\u4f1a\u964d\u4f4e\u8d44\u6e90\u7684\u4f7f\u7528\u6548\u7387\uff0c\u751a\u81f3\u5f15\u53d1\u6570\u636e\u9519\u8bef\u3002</p>"},{"location":"chap2/4tcpshutdown/#1","title":"1\u3001\u56db\u6b21\u6325\u624b\u7684\u6d41\u7a0b","text":"<p>\u4e3a\u4ec0\u4e48\u5efa\u7acb\u8fde\u63a5\u662f\u4e09\u6b21\u63e1\u624b\uff0c\u800c\u5173\u95ed\u8fde\u63a5\u9700\u8981\u56db\u6b21\u6325\u624b\u5462\uff1f</p> <p>\u8fd9\u662f\u56e0\u4e3a TCP \u4e0d\u5141\u8bb8\u8fde\u63a5\u5904\u4e8e\u534a\u6253\u5f00\u72b6\u6001\u65f6\u5c31\u5355\u5411\u4f20\u8f93\u6570\u636e\uff0c\u6240\u4ee5\u5728\u4e09\u6b21\u63e1\u624b\u5efa\u7acb\u8fde\u63a5\u65f6\uff0c\u670d\u52a1\u5668\u4f1a\u628a ACK \u548c SYN \u653e\u5728\u4e00\u8d77\u53d1\u7ed9\u5ba2\u6237\u7aef(ESTABLISHED)</p> <p>\u5176\u4e2d\uff0cACK \u7528\u6765\u6253\u5f00\u5ba2\u6237\u7aef\u7684\u53d1\u9001\u901a\u9053\uff0cSYN \u7528\u6765\u6253\u5f00\u670d\u52a1\u5668\u7684\u53d1\u9001\u901a\u9053\u3002\u8fd9\u6837\uff0c\u539f\u672c\u7684\u56db\u6b21\u63e1\u624b\u5c31\u964d\u4e3a\u4e09\u6b21\u63e1\u624b\u4e86\u3002</p> <p></p> <p>\u4f46\u662f\u5f53\u8fde\u63a5\u5904\u4e8e\u534a\u5173\u95ed\u72b6\u6001\u65f6\uff0cTCP \u662f\u5141\u8bb8\u5355\u5411\u4f20\u8f93\u6570\u636e\u7684\u3002</p> <p>\u5148\u5173\u95ed\u8fde\u63a5\u7684\u4e00\u65b9\u53eb\u505a\u4e3b\u52a8\u65b9\uff0c\u540e\u5173\u95ed\u8fde\u63a5\u7684\u4e00\u65b9\u53eb\u505a\u88ab\u52a8\u65b9\u3002</p> <p>\u5f53\u4e3b\u52a8\u65b9\u5173\u95ed\u8fde\u63a5\u65f6\uff0c\u88ab\u52a8\u65b9\u4ecd\u7136\u53ef\u4ee5\u5728\u4e0d\u8c03\u7528 close \u51fd\u6570\u7684\u72b6\u6001\u4e0b\uff0c\u957f\u65f6\u95f4\u53d1\u9001\u6570\u636e\uff0c\u6b64\u65f6\u8fde\u63a5\u5904\u4e8e\u534a\u5173\u95ed\u72b6\u6001\u3002\u8fd9\u4e00\u7279\u6027\u662f TCP \u7684\u53cc\u5411\u901a\u9053\u4e92\u76f8\u72ec\u7acb\u6240\u81f4\uff0c\u5374\u4e5f\u4f7f\u5f97\u5173\u95ed\u8fde\u63a5\u5fc5\u987b\u901a\u8fc7\u56db\u6b21\u6325\u624b\u624d\u80fd\u505a\u5230\u3002</p> <p>\u4e92\u8054\u7f51\u4e2d\u5f80\u5f80\u670d\u52a1\u5668\u624d\u662f\u4e3b\u52a8\u5173\u95ed\u8fde\u63a5\u7684\u4e00\u65b9\u3002\u8fd9\u662f\u56e0\u4e3a\uff0cHTTP \u6d88\u606f\u662f\u5355\u5411\u4f20\u8f93\u534f\u8bae\uff0c\u670d\u52a1\u5668\u63a5\u6536\u5b8c\u8bf7\u6c42\u624d\u80fd\u751f\u6210\u54cd\u5e94\uff0c\u53d1\u9001\u5b8c\u54cd\u5e94\u540e\u5c31\u4f1a\u7acb\u523b\u5173\u95ed TCP \u8fde\u63a5\uff0c\u8fd9\u6837\u53ca\u65f6\u91ca\u653e\u4e86\u8d44\u6e90\uff0c\u80fd\u591f\u4e3a\u66f4\u591a\u7684\u7528\u6237\u670d\u52a1\u3002</p> <p>\u8fd9\u5c31\u4f7f\u5f97\u670d\u52a1\u5668\u7684\u4f18\u5316\u7b56\u7565\u53d8\u5f97\u590d\u6742\u8d77\u6765\u3002</p> <ul> <li>\u4e00\u65b9\u9762\uff0c\u7531\u4e8e\u88ab\u52a8\u65b9\u6709\u591a\u79cd\u5e94\u5bf9\u7b56\u7565\uff0c\u4ece\u800c\u589e\u52a0\u4e86\u4e3b\u52a8\u65b9\u7684\u5904\u7406\u5206\u652f\u3002</li> <li>\u53e6\u4e00\u65b9\u9762\uff0c\u670d\u52a1\u5668\u540c\u65f6\u4e3a\u6210\u5343\u4e0a\u4e07\u4e2a\u7528\u6237\u670d\u52a1\uff0c\u4efb\u4f55\u9519\u8bef\u90fd\u4f1a\u88ab\u5e9e\u5927\u7684\u7528\u6237\u6570\u653e\u5927\u3002\u6240\u4ee5\u5bf9\u4e3b\u52a8\u65b9\u7684\u5173\u95ed\u8fde\u63a5\u53c2\u6570\u8c03\u6574\u65f6\uff0c\u9700\u8981\u683c\u5916\u5c0f\u5fc3\u3002</li> </ul> <p></p> <p>\u5176\u5b9e\u56db\u6b21\u6325\u624b\u53ea\u6d89\u53ca\u4e24\u79cd\u62a5\u6587\uff1aFIN \u548c ACK\u3002</p> <ul> <li>FIN \u5c31\u662f Finish \u7ed3\u675f\u8fde\u63a5\u7684\u610f\u601d\uff0c\u8c01\u53d1\u51fa FIN \u62a5\u6587\uff0c\u5c31\u8868\u793a\u5b83\u5c06\u4e0d\u518d\u53d1\u9001\u4efb\u4f55\u6570\u636e\uff0c\u5173\u95ed\u8fd9\u4e00\u65b9\u5411\u7684\u4f20\u8f93\u901a\u9053\u3002</li> <li>ACK \u662f Acknowledge \u786e\u8ba4\u7684\u610f\u601d\uff0c\u5b83\u7528\u6765\u901a\u77e5\u5bf9\u65b9\uff1a\u4f60\u65b9\u7684\u53d1\u9001\u901a\u9053\u5df2\u7ecf\u5173\u95ed\u3002</li> </ul>"},{"location":"chap2/4tcpshutdown/#_1","title":"\u5f53\u4e3b\u52a8\u65b9\u5173\u95ed\u8fde\u63a5\u65f6","text":"<ol> <li>\u5f53\u4e3b\u52a8\u65b9\u5173\u95ed\u8fde\u63a5\u65f6\uff0c\u4f1a\u53d1\u9001 FIN \u62a5\u6587\uff0c\u6b64\u65f6\u4e3b\u52a8\u65b9\u7684\u8fde\u63a5\u72b6\u6001\u7531 ESTABLISHED \u53d8\u4e3a <code>FIN_WAIT1</code>\u3002</li> <li>\u5f53\u88ab\u52a8\u65b9\u6536\u5230 FIN \u62a5\u6587\u540e\uff0c\u5185\u6838\u81ea\u52a8\u56de\u590d ACK \u62a5\u6587\uff0c\u8fde\u63a5\u72b6\u6001\u7531 ESTABLISHED \u53d8\u4e3a <code>CLOSE_WAIT</code>\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5b83\u5728\u7b49\u5f85\u8fdb\u7a0b\u8c03\u7528 close \u51fd\u6570\u5173\u95ed\u8fde\u63a5\u3002</li> <li>\u5f53\u4e3b\u52a8\u65b9\u63a5\u6536\u5230\u8fd9\u4e2a ACK \u62a5\u6587\u540e\uff0c\u8fde\u63a5\u72b6\u6001\u7531 <code>FIN_WAIT1</code> \u53d8\u4e3a <code>FIN_WAIT2</code>\uff0c\u4e3b\u52a8\u65b9\u7684\u53d1\u9001\u901a\u9053\u5c31\u5173\u95ed\u4e86\u3002</li> </ol>"},{"location":"chap2/4tcpshutdown/#_2","title":"\u88ab\u52a8\u65b9\u7684\u53d1\u9001\u901a\u9053\u662f\u5982\u4f55\u5173\u95ed\u7684","text":"<ol> <li>\u5f53\u88ab\u52a8\u65b9\u8fdb\u5165 <code>CLOSE_WAIT</code> \u72b6\u6001\u65f6\uff0c\u8fdb\u7a0b\u7684 read \u51fd\u6570\u4f1a\u8fd4\u56de 0\uff0c\u8fd9\u6837\u5f00\u53d1\u4eba\u5458\u5c31\u4f1a\u6709\u9488\u5bf9\u6027\u5730\u8c03\u7528 close \u51fd\u6570\uff0c\u8fdb\u800c\u89e6\u53d1\u5185\u6838\u53d1\u9001 FIN \u62a5\u6587\uff0c\u6b64\u65f6\u88ab\u52a8\u65b9\u8fde\u63a5\u7684\u72b6\u6001\u53d8\u4e3a <code>LAST_ACK</code>\u3002</li> <li>\u5f53\u4e3b\u52a8\u65b9\u6536\u5230\u8fd9\u4e2a FIN \u62a5\u6587\u65f6\uff0c\u5185\u6838\u4f1a\u81ea\u52a8\u56de\u590d ACK\uff0c\u540c\u65f6\u8fde\u63a5\u7684\u72b6\u6001\u7531 <code>FIN_WAIT2</code> \u53d8\u4e3a <code>TIME_WAIT</code>\uff0cLinux \u7cfb\u7edf\u4e0b\u5927\u7ea6 1 \u5206\u949f\u540e <code>TIME_WAIT</code> \u72b6\u6001\u7684\u8fde\u63a5\u624d\u4f1a\u5f7b\u5e95\u5173\u95ed\u3002</li> <li>\u800c\u88ab\u52a8\u65b9\u6536\u5230 ACK \u62a5\u6587\u540e\uff0c\u8fde\u63a5\u5c31\u4f1a\u5173\u95ed\u3002</li> </ol>"},{"location":"chap2/4tcpshutdown/#2","title":"2\u3001\u4e3b\u52a8\u65b9\u7684\u4f18\u5316","text":"<p>\u5173\u95ed\u8fde\u63a5\u6709\u591a\u79cd\u65b9\u5f0f\uff0c\u6bd4\u5982\u8fdb\u7a0b\u5f02\u5e38\u9000\u51fa\u65f6\uff0c\u9488\u5bf9\u5b83\u6253\u5f00\u7684\u8fde\u63a5\uff0c\u5185\u6838\u5c31\u4f1a\u53d1\u9001 RST \u62a5\u6587\u6765\u5173\u95ed\u3002</p> <p>RST \u7684\u5168\u79f0\u662f Reset \u590d\u4f4d\u7684\u610f\u601d\uff0c\u5b83\u53ef\u4ee5\u4e0d\u8d70\u56db\u6b21\u6325\u624b\u5f3a\u884c\u5173\u95ed\u8fde\u63a5\uff0c\u4f46\u5f53\u62a5\u6587\u5ef6\u8fdf\u6216\u8005\u91cd\u590d\u4f20\u8f93\u65f6\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4f1a\u5bfc\u81f4\u6570\u636e\u9519\u4e71\uff0c\u6240\u4ee5\u8fd9\u662f\u4e0d\u5f97\u5df2\u800c\u4e3a\u4e4b\u7684\u5173\u95ed\u8fde\u63a5\u65b9\u6848\u3002</p>"},{"location":"chap2/4tcpshutdown/#tcp_max_orphans","title":"<code>tcp_max_orphans</code>","text":"<p>\u5b89\u5168\u5173\u95ed\u8fde\u63a5\u7684\u65b9\u5f0f\u5fc5\u987b\u901a\u8fc7\u56db\u6b21\u6325\u624b\uff0c\u5b83\u7531\u8fdb\u7a0b\u8c03\u7528 close \u6216\u8005 shutdown \u51fd\u6570\u53d1\u8d77\uff0c\u8fd9\u4e8c\u8005\u90fd\u4f1a\u5411\u5bf9\u65b9\u53d1\u9001 FIN \u62a5\u6587\uff08shutdown \u53c2\u6570\u987b\u4f20\u5165 <code>SHUT_WR</code> \u6216\u8005 <code>SHUT_RDWR</code> \u624d\u4f1a\u53d1\u9001 FIN\uff09\uff0c\u533a\u522b\u5728\u4e8e close \u8c03\u7528\u540e\uff0c\u54ea\u6015\u5bf9\u65b9\u5728\u534a\u5173\u95ed\u72b6\u6001\u4e0b\u53d1\u9001\u7684\u6570\u636e\u5230\u8fbe\u4e3b\u52a8\u65b9\uff0c\u8fdb\u7a0b\u4e5f\u65e0\u6cd5\u63a5\u6536\u3002</p> <p>\u6b64\u65f6\uff0c\u8fd9\u4e2a\u8fde\u63a5\u53eb\u505a\u5b64\u513f\u8fde\u63a5\uff0c\u5982\u679c\u4f60\u7528 <code>netstat -p</code> \u547d\u4ee4\uff0c\u4f1a\u53d1\u73b0\u8fde\u63a5\u5bf9\u5e94\u7684\u8fdb\u7a0b\u540d\u4e3a\u7a7a\u3002\u800c shutdown \u51fd\u6570\u8c03\u7528\u540e\uff0c\u5373\u4f7f\u8fde\u63a5\u8fdb\u5165\u4e86 <code>FIN_WAIT1</code> \u6216\u8005 <code>FIN_WAIT2</code>\u72b6\u6001\uff0c\u5b83\u4e5f\u4e0d\u662f\u5b64\u513f\u8fde\u63a5\uff0c\u8fdb\u7a0b\u4ecd\u7136\u53ef\u4ee5\u7ee7\u7eed\u63a5\u6536\u6570\u636e\u3002</p> <ul> <li>\u4e3b\u52a8\u65b9\u53d1\u9001 FIN \u62a5\u6587\u540e\uff0c\u8fde\u63a5\u5c31\u5904\u4e8e <code>FIN_WAIT1</code> \u72b6\u6001\u4e0b\uff0c\u8be5\u72b6\u6001\u901a\u5e38\u5e94\u5728\u6570\u5341\u6beb\u79d2\u5185\u8f6c\u4e3a <code>FIN_WAIT2</code>\u3002</li> <li>\u53ea\u6709\u8fdf\u8fdf\u6536\u4e0d\u5230\u5bf9\u65b9\u8fd4\u56de\u7684 ACK \u65f6\uff0c\u624d\u80fd\u7528 <code>netstat</code> \u547d\u4ee4\u89c2\u5bdf\u5230 <code>FIN_WAIT1</code> \u72b6\u6001\u3002</li> <li>\u6b64\u65f6\uff0c\u5185\u6838\u4f1a\u5b9a\u65f6\u91cd\u53d1 <code>FIN</code> \u62a5\u6587\uff0c\u5176\u4e2d\u91cd\u53d1\u6b21\u6570\u7531 <code>tcp_orphan_retries</code> \u53c2\u6570\u63a7\u5236\uff08\u6ce8\u610f\uff0corphan \u867d\u7136\u662f\u5b64\u513f\u7684\u610f\u601d\uff0c\u8be5\u53c2\u6570\u5374\u4e0d\u53ea\u5bf9\u5b64\u513f\u8fde\u63a5\u6709\u6548\uff0c\u4e8b\u5b9e\u4e0a\uff0c\u5b83\u5bf9\u6240\u6709 <code>FIN_WAIT1</code> \u72b6\u6001\u4e0b\u7684\u8fde\u63a5\u90fd\u6709\u6548\uff09\uff0c\u9ed8\u8ba4\u503c\u662f 0\uff0c\u7279\u6307 8 \u6b21\uff1a</li> </ul> <pre><code>net.ipv4.tcp_orphan_retries = 0\n</code></pre> <p>\u5982\u679c <code>FIN_WAIT1</code>\u72b6\u6001\u8fde\u63a5\u6709\u5f88\u591a\uff0c\u4f60\u5c31\u9700\u8981\u8003\u8651\u964d\u4f4e <code>tcp_orphan_retries</code>\u7684\u503c\u3002\u5f53\u91cd\u8bd5\u6b21\u6570\u8fbe\u5230 <code>tcp_orphan_retries</code> \u65f6\uff0c\u8fde\u63a5\u5c31\u4f1a\u76f4\u63a5\u5173\u95ed\u6389\u3002</p> <p>\u5bf9\u4e8e\u6b63\u5e38\u60c5\u51b5\u6765\u8bf4\uff0c\u8c03\u4f4e <code>tcp_orphan_retries</code>\u5df2\u7ecf\u591f\u7528\uff0c\u4f46\u5982\u679c\u9047\u5230\u6076\u610f\u653b\u51fb\uff0cFIN \u62a5\u6587\u6839\u672c\u65e0\u6cd5\u53d1\u9001\u51fa\u53bb\u3002\u8fd9\u662f\u7531 TCP \u7684 2 \u4e2a\u7279\u6027\u5bfc\u81f4\u7684\u3002</p> <ul> <li>\u9996\u5148\uff0cTCP \u5fc5\u987b\u4fdd\u8bc1\u62a5\u6587\u662f\u6709\u5e8f\u53d1\u9001\u7684\uff0cFIN \u62a5\u6587\u4e5f\u4e0d\u4f8b\u5916\uff0c\u5f53\u53d1\u9001\u7f13\u51b2\u533a\u8fd8\u6709\u6570\u636e\u6ca1\u53d1\u9001\u65f6\uff0cFIN \u62a5\u6587\u4e5f\u4e0d\u80fd\u63d0\u524d\u53d1\u9001\u3002</li> <li>\u5176\u6b21\uff0cTCP \u6709\u6d41\u63a7\u529f\u80fd\uff0c\u5f53\u63a5\u6536\u65b9\u5c06\u63a5\u6536\u7a97\u53e3\u8bbe\u4e3a 0 \u65f6\uff0c\u53d1\u9001\u65b9\u5c31\u4e0d\u80fd\u518d\u53d1\u9001\u6570\u636e\u3002\u6240\u4ee5\uff0c\u5f53\u653b\u51fb\u8005\u4e0b\u8f7d\u5927\u6587\u4ef6\u65f6\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u5c06\u63a5\u6536\u7a97\u53e3\u8bbe\u4e3a 0\uff0c\u5bfc\u81f4 FIN \u62a5\u6587\u65e0\u6cd5\u53d1\u9001\uff0c\u8fdb\u800c\u5bfc\u81f4\u8fde\u63a5\u4e00\u76f4\u5904\u4e8e <code>FIN_WAIT1</code> \u72b6\u6001\u3002</li> </ul> <p>\u89e3\u51b3\u8fd9\u79cd\u95ee\u9898\u7684\u65b9\u6848\u662f\u8c03\u6574 <code>tcp_max_orphans</code> \u53c2\u6570\uff1a</p> <pre><code>net.ipv4.tcp_max_orphans = 16384\n</code></pre> <p><code>tcp_max_orphans</code> \u5b9a\u4e49\u4e86\u5b64\u513f\u8fde\u63a5\u7684\u6700\u5927\u6570\u91cf\u3002</p> <p>\u5f53\u8fdb\u7a0b\u8c03\u7528 close \u51fd\u6570\u5173\u95ed\u8fde\u63a5\u540e\uff0c\u65e0\u8bba\u8be5\u8fde\u63a5\u662f\u5728 <code>FIN_WAIT1</code> \u72b6\u6001\uff0c\u8fd8\u662f\u786e\u5b9e\u5173\u95ed\u4e86\uff0c\u8fd9\u4e2a\u8fde\u63a5\u90fd\u4e0e\u8be5\u8fdb\u7a0b\u65e0\u5173\u4e86\uff0c\u5b83\u53d8\u6210\u4e86\u5b64\u513f\u8fde\u63a5\u3002Linux \u7cfb\u7edf\u4e3a\u9632\u6b62\u5b64\u513f\u8fde\u63a5\u8fc7\u591a\uff0c\u5bfc\u81f4\u7cfb\u7edf\u8d44\u6e90\u957f\u671f\u88ab\u5360\u7528\uff0c\u5c31\u63d0\u4f9b\u4e86 <code>tcp_max_orphans</code> \u53c2\u6570\u3002\u5982\u679c\u5b64\u513f\u8fde\u63a5\u6570\u91cf\u5927\u4e8e\u5b83\uff0c\u65b0\u589e\u7684\u5b64\u513f\u8fde\u63a5\u5c06\u4e0d\u518d\u8d70\u56db\u6b21\u6325\u624b\uff0c\u800c\u662f\u76f4\u63a5\u53d1\u9001 RST \u590d\u4f4d\u62a5\u6587\u5f3a\u5236\u5173\u95ed\u3002</p> <p>\u5f53\u8fde\u63a5\u6536\u5230 ACK \u8fdb\u5165 <code>FIN_WAIT2</code> \u72b6\u6001\u540e\uff0c\u5c31\u8868\u793a\u4e3b\u52a8\u65b9\u7684\u53d1\u9001\u901a\u9053\u5df2\u7ecf\u5173\u95ed\uff0c\u63a5\u4e0b\u6765\u5c06\u7b49\u5f85\u5bf9\u65b9\u53d1\u9001 FIN \u62a5\u6587\uff0c\u5173\u95ed\u5bf9\u65b9\u7684\u53d1\u9001\u901a\u9053</p> <p>\u8fd9\u65f6\uff0c\u5982\u679c\u8fde\u63a5\u662f\u7528 shutdown \u51fd\u6570\u5173\u95ed\u7684\uff0c\u8fde\u63a5\u53ef\u4ee5\u4e00\u76f4\u5904\u4e8e FIN_WAIT2 \u72b6\u6001\u3002\u4f46\u5bf9\u4e8e close \u51fd\u6570\u5173\u95ed\u7684\u5b64\u513f\u8fde\u63a5\uff0c\u8fd9\u4e2a\u72b6\u6001\u4e0d\u53ef\u4ee5\u6301\u7eed\u592a\u4e45\uff0c\u800c <code>tcp_fin_timeout</code> \u63a7\u5236\u4e86\u8fd9\u4e2a\u72b6\u6001\u4e0b\u8fde\u63a5\u7684\u6301\u7eed\u65f6\u957f\u3002</p> <pre><code>net.ipv4.tcp_fin_timeout = 60\n</code></pre> <p>\u5b83\u7684\u9ed8\u8ba4\u503c\u662f 60 \u79d2\u3002\u8fd9\u610f\u5473\u7740\u5bf9\u4e8e\u5b64\u513f\u8fde\u63a5\uff0c\u5982\u679c 60 \u79d2\u540e\u8fd8\u6ca1\u6709\u6536\u5230 FIN \u62a5\u6587\uff0c\u8fde\u63a5\u5c31\u4f1a\u76f4\u63a5\u5173\u95ed\u3002</p>"},{"location":"chap2/4tcpshutdown/#time_wait","title":"<code>TIME_WAIT</code> \u662f\u4e3b\u52a8\u65b9\u56db\u6b21\u6325\u624b\u7684\u6700\u540e\u4e00\u4e2a\u72b6\u6001","text":"<p><code>TIME_WAIT</code> \u72b6\u6001\u7684\u8fde\u63a5\uff0c\u5728\u4e3b\u52a8\u65b9\u770b\u6765\u786e\u5b9e\u5df2\u7ecf\u5173\u95ed\u4e86\u3002\u7136\u800c\uff0c\u88ab\u52a8\u65b9\u6ca1\u6709\u6536\u5230 ACK \u62a5\u6587\u524d\uff0c\u8fde\u63a5\u8fd8\u5904\u4e8e <code>LAST_ACK</code> \u72b6\u6001\u3002\u5982\u679c\u8fd9\u4e2a <code>ACK</code>\u62a5\u6587\u6ca1\u6709\u5230\u8fbe\u88ab\u52a8\u65b9\uff0c\u88ab\u52a8\u65b9\u5c31\u4f1a\u91cd\u53d1 FIN \u62a5\u6587\u3002\u91cd\u53d1\u6b21\u6570\u4ecd\u7136\u7531\u524d\u9762\u4ecb\u7ecd\u8fc7\u7684 <code>tcp_orphan_retries</code> \u53c2\u6570\u63a7\u5236\u3002</p> <p>\u5982\u679c\u4e3b\u52a8\u65b9\u4e0d\u4fdd\u7559 <code>TIME_WAIT</code> \u72b6\u6001\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\u5462\uff1f</p> <p>\u6b64\u65f6\u8fde\u63a5\u7684\u7aef\u53e3\u6062\u590d\u4e86\u81ea\u7531\u8eab\uff0c\u53ef\u4ee5\u590d\u7528\u4e8e\u65b0\u8fde\u63a5\u4e86\u3002\u7136\u800c\uff0c\u88ab\u52a8\u65b9\u7684 FIN \u62a5\u6587\u53ef\u80fd\u518d\u6b21\u5230\u8fbe\uff0c\u8fd9\u65e2\u53ef\u80fd\u662f\u7f51\u7edc\u4e2d\u7684\u8def\u7531\u5668\u91cd\u590d\u53d1\u9001\uff0c\u4e5f\u6709\u53ef\u80fd\u662f\u88ab\u52a8\u65b9\u6ca1\u6536\u5230 ACK \u65f6\u57fa\u4e8e <code>tcp_orphan_retries</code> \u53c2\u6570\u91cd\u53d1\u3002\u8fd9\u6837\uff0c\u6b63\u5e38\u901a\u8baf\u7684\u65b0\u8fde\u63a5\u5c31\u53ef\u80fd\u88ab\u91cd\u590d\u53d1\u9001\u7684 FIN \u62a5\u6587\u8bef\u5173\u95ed\u3002\u4fdd\u7559 <code>TIME_WAIT</code> \u72b6\u6001\uff0c\u5c31\u53ef\u4ee5\u5e94\u4ed8\u91cd\u53d1\u7684 FIN \u62a5\u6587\uff0c\u5f53\u7136\uff0c\u5176\u4ed6\u6570\u636e\u62a5\u6587\u4e5f\u6709\u53ef\u80fd\u91cd\u53d1\uff0c\u6240\u4ee5 <code>TIME_WAIT</code> \u72b6\u6001\u8fd8\u80fd\u907f\u514d\u6570\u636e\u9519\u4e71\u3002</p> <p>\u8fd9\u4e0e\u5b64\u513f\u8fde\u63a5 <code>FIN_WAIT2</code>\u72b6\u6001\u9ed8\u8ba4\u4fdd\u7559 60 \u79d2\u7684\u539f\u7406\u662f\u4e00\u6837\u7684\uff0c\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u72b6\u6001\u90fd\u9700\u8981\u4fdd\u6301 2MSL \u65f6\u957f\u3002MSL \u5168\u79f0\u662f Maximum Segment Lifetime\uff0c\u5b83\u5b9a\u4e49\u4e86\u4e00\u4e2a\u62a5\u6587\u5728\u7f51\u7edc\u4e2d\u7684\u6700\u957f\u751f\u5b58\u65f6\u95f4\uff08\u62a5\u6587\u6bcf\u7ecf\u8fc7\u4e00\u6b21\u8def\u7531\u5668\u7684\u8f6c\u53d1\uff0cIP \u5934\u90e8\u7684 TTL \u5b57\u6bb5\u5c31\u4f1a\u51cf 1\uff0c\u51cf\u5230 0 \u65f6\u62a5\u6587\u5c31\u88ab\u4e22\u5f03\uff0c\u8fd9\u5c31\u9650\u5236\u4e86\u62a5\u6587\u7684\u6700\u957f\u5b58\u6d3b\u65f6\u95f4\uff09\u3002</p> <p>\u56e0\u6b64\uff0c<code>TIME_WAIT</code> \u548c <code>FIN_WAIT2</code> \u72b6\u6001\u7684\u6700\u5927\u65f6\u957f\u90fd\u662f 2 MSL\uff0c\u7531\u4e8e\u5728 Linux \u7cfb\u7edf\u4e2d\uff0cMSL \u7684\u503c\u56fa\u5b9a\u4e3a 30 \u79d2\uff0c\u6240\u4ee5\u5b83\u4eec\u90fd\u662f 60 \u79d2\u3002</p> <p>\u867d\u7136 <code>TIME_WAIT</code> \u72b6\u6001\u7684\u5b58\u5728\u662f\u6709\u5fc5\u8981\u7684\uff0c\u4f46\u5b83\u6bd5\u7adf\u5728\u6d88\u8017\u7cfb\u7edf\u8d44\u6e90\uff0c\u6bd4\u5982 <code>TIME_WAIT</code> \u72b6\u6001\u7684\u7aef\u53e3\u5c31\u65e0\u6cd5\u4f9b\u65b0\u8fde\u63a5\u4f7f\u7528\u3002\u600e\u6837\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5462\uff1f</p> <p>Linux \u63d0\u4f9b\u4e86 <code>tcp_max_tw_buckets</code> \u53c2\u6570\uff0c\u5f53 <code>TIME_WAIT</code>\u7684\u8fde\u63a5\u6570\u91cf\u8d85\u8fc7\u8be5\u53c2\u6570\u65f6\uff0c\u65b0\u5173\u95ed\u7684\u8fde\u63a5\u5c31\u4e0d\u518d\u7ecf\u5386 <code>TIME_WAIT</code> \u800c\u76f4\u63a5\u5173\u95ed\u3002</p> <pre><code>net.ipv4.tcp_max_tw_buckets = 5000\n</code></pre> <p>\u5f53\u670d\u52a1\u5668\u7684\u5e76\u53d1\u8fde\u63a5\u589e\u591a\u65f6\uff0c\u76f8\u5e94\u5730\uff0c\u540c\u65f6\u5904\u4e8e <code>TIME_WAIT</code> \u72b6\u6001\u7684\u8fde\u63a5\u6570\u91cf\u4e5f\u4f1a\u53d8\u591a\uff0c\u6b64\u65f6\u5c31\u5e94\u5f53\u8c03\u5927 <code>tcp_max_tw_buckets</code> \u53c2\u6570\uff0c\u51cf\u5c11\u4e0d\u540c\u8fde\u63a5\u95f4\u6570\u636e\u9519\u4e71\u7684\u6982\u7387\u3002</p> <p>\u5f53\u7136\uff0c<code>tcp_max_tw_buckets</code> \u4e5f\u4e0d\u662f\u8d8a\u5927\u8d8a\u597d\uff0c\u6bd5\u7adf\u5185\u5b58\u548c\u7aef\u53e3\u53f7\u90fd\u662f\u6709\u9650\u7684\u3002\u6709\u6ca1\u6709\u529e\u6cd5\u8ba9\u65b0\u8fde\u63a5\u590d\u7528 TIME_WAIT \u72b6\u6001\u7684\u7aef\u53e3\u5462\uff1f\u5982\u679c\u670d\u52a1\u5668\u4f1a\u4e3b\u52a8\u5411\u4e0a\u6e38\u670d\u52a1\u5668\u53d1\u8d77\u8fde\u63a5\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u628a <code>tcp_tw_reuse</code> \u53c2\u6570\u8bbe\u7f6e\u4e3a 1\uff0c\u5b83\u5141\u8bb8\u4f5c\u4e3a\u5ba2\u6237\u7aef\u7684\u65b0\u8fde\u63a5\uff0c\u5728\u5b89\u5168\u6761\u4ef6\u4e0b\u4f7f\u7528 <code>TIME_WAIT</code> \u72b6\u6001\u4e0b\u7684\u7aef\u53e3\u3002</p> <pre><code>net.ipv4.tcp_tw_reuse = 1\n</code></pre> <p>\u5f53\u7136\uff0c\u8981\u60f3\u4f7f <code>tcp_tw_reuse</code> \u751f\u6548\uff0c\u8fd8\u5f97\u628a timestamps \u53c2\u6570\u8bbe\u7f6e\u4e3a 1\uff0c\u5b83\u6ee1\u8db3\u5b89\u5168\u590d\u7528\u7684\u5148\u51b3\u6761\u4ef6\uff08\u5bf9\u65b9\u4e5f\u8981\u6253\u5f00 tcp_timestamps \uff09\uff1a</p> <pre><code>net.ipv4.tcp_timestamps = 1\n</code></pre> <p>\u8001\u7248\u672c\u7684 Linux \u8fd8\u63d0\u4f9b\u4e86 <code>tcp_tw_recycle</code>\u53c2\u6570\uff0c\u5b83\u5e76\u4e0d\u8981\u6c42 TIME_WAIT \u72b6\u6001\u5b58\u5728 60 \u79d2\uff0c\u5f88\u5bb9\u6613\u5bfc\u81f4\u6570\u636e\u9519\u4e71\uff0c\u4e0d\u5efa\u8bae\u8bbe\u7f6e\u4e3a 1\u3002</p> <pre><code>net.ipv4.tcp_tw_recycle = 0\n</code></pre> <p>\u6240\u4ee5\u5728 Linux 4.12 \u7248\u672c\u540e\uff0c\u76f4\u63a5\u53d6\u6d88\u4e86\u8fd9\u4e00\u53c2\u6570\u3002</p>"},{"location":"chap2/4tcpshutdown/#2_1","title":"2\u3001\u88ab\u52a8\u65b9\u7684\u4f18\u5316","text":"<p>\u5f53\u88ab\u52a8\u65b9\u6536\u5230 FIN \u62a5\u6587\u65f6\uff0c\u5c31\u5f00\u542f\u4e86\u88ab\u52a8\u65b9\u7684\u56db\u6b21\u6325\u624b\u6d41\u7a0b\u3002\u5185\u6838\u81ea\u52a8\u56de\u590d ACK \u62a5\u6587\u540e\uff0c\u8fde\u63a5\u5c31\u8fdb\u5165 <code>CLOSE_WAIT</code> \u72b6\u6001\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5b83\u8868\u793a\u7b49\u5f85\u8fdb\u7a0b\u8c03\u7528 close \u51fd\u6570\u5173\u95ed\u8fde\u63a5\u3002</p> <p>\u5185\u6838\u6ca1\u6709\u6743\u529b\u66ff\u4ee3\u8fdb\u7a0b\u53bb\u5173\u95ed\u8fde\u63a5\uff0c\u56e0\u4e3a\u82e5\u4e3b\u52a8\u65b9\u662f\u901a\u8fc7 shutdown \u5173\u95ed\u8fde\u63a5\uff0c\u90a3\u4e48\u5b83\u5c31\u662f\u60f3\u5728\u534a\u5173\u95ed\u8fde\u63a5\u4e0a\u63a5\u6536\u6570\u636e\u3002\u56e0\u6b64\uff0cLinux \u5e76\u6ca1\u6709\u9650\u5236 <code>CLOSE_WAIT</code> \u72b6\u6001\u7684\u6301\u7eed\u65f6\u95f4\u3002</p> <p>\u7531\u4e8e <code>CLOSE_WAIT</code> \u72b6\u6001\u4e0b\uff0c\u8fde\u63a5\u5df2\u7ecf\u5904\u4e8e\u534a\u5173\u95ed\u72b6\u6001\uff0c\u6240\u4ee5\u6b64\u65f6\u8fdb\u7a0b\u82e5\u8981\u5173\u95ed\u8fde\u63a5\uff0c\u53ea\u80fd\u8c03\u7528 close \u51fd\u6570\uff08\u518d\u8c03\u7528 shutdown \u5173\u95ed\u5355\u5411\u901a\u9053\u5c31\u6ca1\u6709\u610f\u4e49\u4e86\uff09\uff0c\u5185\u6838\u5c31\u4f1a\u53d1\u51fa FIN \u62a5\u6587\u5173\u95ed\u53d1\u9001\u901a\u9053\uff0c\u540c\u65f6\u8fde\u63a5\u8fdb\u5165 <code>LAST_ACK</code> \u72b6\u6001\uff0c\u7b49\u5f85\u4e3b\u52a8\u65b9\u8fd4\u56de ACK \u6765\u786e\u8ba4\u8fde\u63a5\u5173\u95ed\u3002</p> <p>\u5982\u679c\u8fdf\u8fdf\u7b49\u4e0d\u5230 ACK\uff0c\u5185\u6838\u5c31\u4f1a\u91cd\u53d1 FIN \u62a5\u6587\uff0c\u91cd\u53d1\u6b21\u6570\u4ecd\u7136\u7531 <code>tcp_orphan_retries</code> \u53c2\u6570\u63a7\u5236\uff0c\u8fd9\u4e0e\u4e3b\u52a8\u65b9\u91cd\u53d1 FIN \u62a5\u6587\u7684\u4f18\u5316\u7b56\u7565\u4e00\u81f4\u3002</p> <p>\u9700\u8981\u4f60\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u88ab\u52a8\u65b9\u8fc5\u901f\u8c03\u7528 close \u51fd\u6570\uff0c\u90a3\u4e48\u88ab\u52a8\u65b9\u7684 ACK \u548c FIN \u6709\u53ef\u80fd\u5728\u4e00\u4e2a\u62a5\u6587\u4e2d\u53d1\u9001\uff0c\u8fd9\u6837\u770b\u8d77\u6765\uff0c\u56db\u6b21\u6325\u624b\u4f1a\u53d8\u6210\u4e09\u6b21\u6325\u624b\uff0c\u8fd9\u53ea\u662f\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\uff0c\u4e0d\u7528\u5728\u610f\u3002</p> <p>\u5982\u679c\u8fde\u63a5\u53cc\u65b9\u540c\u65f6\u5173\u95ed\u8fde\u63a5\uff0c\u4f1a\u600e\u4e48\u6837\uff1f</p> <p>\u4e24\u65b9\u53d1\u9001 FIN \u62a5\u6587\u65f6\uff0c\u90fd\u8ba4\u4e3a\u81ea\u5df1\u662f\u4e3b\u52a8\u65b9\uff0c\u6240\u4ee5\u90fd\u8fdb\u5165\u4e86 FIN_WAIT1 \u72b6\u6001\uff0cFIN \u62a5\u6587\u7684\u91cd\u53d1\u6b21\u6570\u4ecd\u7531 <code>tcp_orphan_retries</code> \u53c2\u6570\u63a7\u5236\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u53cc\u65b9\u5728\u7b49\u5f85 ACK \u62a5\u6587\u7684\u8fc7\u7a0b\u4e2d\uff0c\u90fd\u7b49\u6765\u4e86 FIN \u62a5\u6587\u3002\u8fd9\u662f\u4e00\u79cd\u65b0\u60c5\u51b5\uff0c\u6240\u4ee5\u8fde\u63a5\u4f1a\u8fdb\u5165\u4e00\u79cd\u53eb\u505a CLOSING \u7684\u65b0\u72b6\u6001\uff0c\u5b83\u66ff\u4ee3\u4e86 <code>FIN_WAIT2</code> \u72b6\u6001\u3002\u6b64\u65f6\uff0c\u5185\u6838\u56de\u590d ACK \u786e\u8ba4\u5bf9\u65b9\u53d1\u9001\u901a\u9053\u7684\u5173\u95ed\uff0c\u4ec5\u5df1\u65b9\u7684 FIN \u62a5\u6587\u5bf9\u5e94\u7684 ACK \u8fd8\u6ca1\u6709\u6536\u5230\u3002\u6240\u4ee5\uff0cCLOSING \u72b6\u6001\u4e0e <code>LAST_ACK</code> \u72b6\u6001\u4e0b\u7684\u8fde\u63a5\u5f88\u76f8\u4f3c\uff0c\u5b83\u4f1a\u5728\u9002\u65f6\u91cd\u53d1 FIN \u62a5\u6587\u7684\u60c5\u51b5\u4e0b\u6700\u7ec8\u5173\u95ed\u3002</p>"},{"location":"chap2/4tcpshutdown/#3","title":"3\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u56db\u6b21\u6325\u624b\u7684\u4e3b\u52a8\u65b9\uff0c\u4e3a\u4e86\u5e94\u5bf9\u4e22\u5305\uff0c\u5141\u8bb8\u5728 <code>tcp_orphan_retries</code> \u6b21\u6570\u5185\u91cd\u53d1 FIN \u62a5\u6587\u3002\u5f53\u6536\u5230 ACK \u62a5\u6587\uff0c\u8fde\u63a5\u5c31\u8fdb\u5165\u4e86 <code>FIN_WAIT2</code> \u72b6\u6001\uff0c\u6b64\u65f6\u7cfb\u7edf\u7684\u884c\u4e3a\u4f9d\u8d56\u8fd9\u662f\u5426\u4e3a\u5b64\u513f\u8fde\u63a5\u3002</p> <p>\u5982\u679c\u8fd9\u662f close \u51fd\u6570\u5173\u95ed\u7684\u5b64\u513f\u8fde\u63a5\uff0c\u90a3\u4e48\u5728<code>tcp_fin_timeout</code> \u79d2\u5185\u6ca1\u6709\u6536\u5230\u5bf9\u65b9\u7684 FIN \u62a5\u6587\uff0c\u8fde\u63a5\u5c31\u76f4\u63a5\u5173\u95ed\uff0c\u53cd\u4e4b shutdown \u51fd\u6570\u5173\u95ed\u7684\u8fde\u63a5\u5219\u4e0d\u53d7\u6b64\u9650\u5236\u3002\u6bd5\u7adf\u5b64\u513f\u8fde\u63a5\u53ef\u80fd\u5728\u91cd\u53d1\u6b21\u6570\u5185\u5b58\u5728\u6570\u5206\u949f\u4e4b\u4e45\uff0c\u4e3a\u4e86\u5e94\u5bf9\u5b64\u513f\u8fde\u63a5\u5360\u7528\u592a\u591a\u7684\u8d44\u6e90\uff0c<code>tcp_max_orphans</code>\u5b9a\u4e49\u4e86\u6700\u5927\u5b64\u513f\u8fde\u63a5\u7684\u6570\u91cf\uff0c\u8d85\u8fc7\u65f6\u8fde\u63a5\u5c31\u4f1a\u76f4\u63a5\u91ca\u653e\u3002</p> <p>\u88ab\u52a8\u5173\u95ed\u7684\u8fde\u63a5\u65b9\u5e94\u5bf9\u975e\u5e38\u7b80\u5355\uff0c\u5b83\u5728\u56de\u590d ACK \u540e\u5c31\u8fdb\u5165\u4e86 <code>CLOSE_WAIT</code> \u72b6\u6001\uff0c\u7b49\u5f85\u8fdb\u7a0b\u8c03\u7528 close \u51fd\u6570\u5173\u95ed\u8fde\u63a5\u3002\u56e0\u6b64\uff0c\u51fa\u73b0\u5927\u91cf <code>CLOSE_WAIT</code> \u72b6\u6001\u7684\u8fde\u63a5\u65f6\uff0c\u5e94\u5f53\u4ece\u5e94\u7528\u7a0b\u5e8f\u4e2d\u627e\u95ee\u9898\u3002\u5f53\u88ab\u52a8\u65b9\u53d1\u9001 FIN \u62a5\u6587\u540e\uff0c\u8fde\u63a5\u5c31\u8fdb\u5165 <code>LAST_ACK</code> \u72b6\u6001\uff0c\u5728\u672a\u7b49\u6765 ACK \u65f6\uff0c\u4f1a\u5728 <code>tcp_orphan_retries</code> \u53c2\u6570\u7684\u63a7\u5236\u4e0b\u91cd\u53d1 FIN \u62a5\u6587\u3002</p>"},{"location":"chap2/5tcpchachepool/","title":"\u7b2c\u4e94\u8282 TCP\u7f13\u51b2\u533a\u517c\u987e\u5e76\u53d1\u6570\u91cf\u4e0e\u4f20\u8f93\u901f\u5ea6","text":"<p>\u5728 Linux \u7cfb\u7edf\u4e2d\u7528 free \u547d\u4ee4\u67e5\u770b\u5185\u5b58\u5360\u7528\u60c5\u51b5\uff0c\u4f1a\u53d1\u73b0\u4e00\u680f\u53eb\u505a buff/cache\uff0c\u5b83\u662f\u7cfb\u7edf\u5185\u5b58\uff0c\u4f3c\u4e4e\u4e0e\u5e94\u7528\u8fdb\u7a0b\u65e0\u5173\u3002</p> <p>\u4f46\u6bcf\u5f53\u8fdb\u7a0b\u65b0\u5efa\u4e00\u4e2a TCP \u8fde\u63a5\uff0c<code>buff/cache</code> \u4e2d\u7684\u5185\u5b58\u90fd\u4f1a\u4e0a\u5347 <code>4K</code> \u5de6\u53f3\u3002\u800c\u4e14\uff0c\u5f53\u8fde\u63a5\u4f20\u8f93\u6570\u636e\u65f6\uff0c\u5c31\u8fdc\u4e0d\u6b62\u589e\u52a0 4K \u5185\u5b58\u4e86\u3002\u8fd9\u6837\uff0c\u51e0\u5341\u4e07\u5e76\u53d1\u8fde\u63a5\uff0c\u5c31\u5728\u8fdb\u7a0b\u5185\u5b58\u5916\u53c8\u589e\u52a0\u4e86 GB \u7ea7\u522b\u7684\u7cfb\u7edf\u5185\u5b58\u6d88\u8017\u3002</p> <p>\u8fd9\u662f\u56e0\u4e3a TCP \u8fde\u63a5\u662f\u7531\u5185\u6838\u7ef4\u62a4\u7684\uff0c\u5185\u6838\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u5efa\u7acb\u7684\u5185\u5b58\u7f13\u51b2\u533a\uff0c\u65e2\u8981\u4e3a\u7f51\u7edc\u4f20\u8f93\u670d\u52a1\uff0c\u4e5f\u8981\u5145\u5f53\u8fdb\u7a0b\u4e0e\u7f51\u7edc\u95f4\u7684\u7f13\u51b2\u6865\u6881\u3002</p> <p>\u5982\u679c\u8fde\u63a5\u7684\u5185\u5b58\u914d\u7f6e\u8fc7\u5c0f\uff0c\u5c31\u65e0\u6cd5\u5145\u5206\u4f7f\u7528\u7f51\u7edc\u5e26\u5bbd\uff0cTCP \u4f20\u8f93\u901f\u5ea6\u5c31\u4f1a\u5f88\u6162\uff1b\u5982\u679c\u8fde\u63a5\u7684\u5185\u5b58\u914d\u7f6e\u8fc7\u5927\uff0c\u90a3\u4e48\u670d\u52a1\u5668\u5185\u5b58\u4f1a\u5f88\u5feb\u7528\u5c3d\uff0c\u65b0\u8fde\u63a5\u5c31\u65e0\u6cd5\u5efa\u7acb\u6210\u529f\u3002\u56e0\u6b64\uff0c\u53ea\u6709\u6df1\u5165\u7406\u89e3 Linux \u4e0b TCP \u5185\u5b58\u7684\u7528\u9014\uff0c\u624d\u80fd\u6b63\u786e\u5730\u914d\u7f6e\u5185\u5b58\u5927\u5c0f\u3002</p>"},{"location":"chap2/5tcpchachepool/#1","title":"1\u3001\u6ed1\u52a8\u7a97\u53e3\u662f\u600e\u6837\u5f71\u54cd\u4f20\u8f93\u901f\u5ea6\u7684\uff1f","text":"<p>TCP \u5fc5\u987b\u4fdd\u8bc1\u6bcf\u4e00\u4e2a\u62a5\u6587\u90fd\u80fd\u591f\u5230\u8fbe\u5bf9\u65b9\uff0c\u5b83\u91c7\u7528\u7684\u673a\u5236\u5c31\u662f\uff1a\u62a5\u6587\u53d1\u51fa\u540e\uff0c\u5fc5\u987b\u6536\u5230\u63a5\u6536\u65b9\u8fd4\u56de\u7684 ACK \u786e\u8ba4\u62a5\u6587\uff08Acknowledge \u786e\u8ba4\u7684\u610f\u601d\uff09\u3002\u5982\u679c\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\uff08\u79f0\u4e3a RTO\uff0cretransmission timeout\uff09\u6ca1\u6709\u6536\u5230\uff0c\u8fd9\u4e2a\u62a5\u6587\u8fd8\u5f97\u91cd\u65b0\u53d1\u9001\uff0c\u76f4\u5230\u6536\u5230 ACK \u4e3a\u6b62\u3002</p> <p>\u53ef\u89c1\uff0cTCP \u62a5\u6587\u53d1\u51fa\u53bb\u540e\uff0c\u5e76\u4e0d\u80fd\u7acb\u523b\u4ece\u5185\u5b58\u4e2d\u5220\u9664\uff0c\u56e0\u4e3a\u91cd\u53d1\u65f6\u8fd8\u9700\u8981\u7528\u5230\u5b83\u3002</p> <p>\u7531\u4e8e TCP \u662f\u7531\u5185\u6838\u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u62a5\u6587\u5b58\u653e\u5728\u5185\u6838\u7f13\u51b2\u533a\u4e2d\uff0c\u8fd9\u4e5f\u662f\u9ad8\u5e76\u53d1\u4e0b buff/cache \u5185\u5b58\u589e\u52a0\u5f88\u591a\u7684\u539f\u56e0\u3002</p> <p>\u5982\u679c\u6211\u4eec\u53d1\u9001\u4e00\u4e2a\u62a5\u6587\uff0c\u6536\u5230 ACK \u786e\u8ba4\u540e\uff0c\u518d\u53d1\u9001\u4e0b\u4e00\u4e2a\u62a5\u6587\uff0c\u4f1a\u6709\u4ec0\u4e48\u95ee\u9898\uff1f</p> <p>\u663e\u7136\uff0c\u53d1\u9001\u6bcf\u4e2a\u62a5\u6587\u90fd\u9700\u8981\u7ecf\u5386\u4e00\u4e2a RTT \u65f6\u5ef6\uff08RTT \u7684\u503c\u53ef\u4ee5\u7528 ping \u547d\u4ee4\u5f97\u5230\uff09\u3002\u8981\u77e5\u9053\uff0c\u56e0\u4e3a\u7f51\u7edc\u8bbe\u5907\u9650\u5236\u4e86\u62a5\u6587\u7684\u5b57\u8282\u6570\uff0c\u6240\u4ee5\u6bcf\u4e2a\u62a5\u6587\u7684\u4f53\u79ef\u6709\u9650\u3002</p> <p>\u6bd4\u5982\uff0c\u4ee5\u592a\u7f51\u62a5\u6587\u6700\u5927\u53ea\u6709 1500 \u5b57\u8282\uff0c\u800c\u53d1\u9001\u4e3b\u673a\u5230\u63a5\u6536\u4e3b\u673a\u95f4\uff0c\u8981\u7ecf\u5386\u591a\u4e2a\u5e7f\u57df\u7f51\u3001\u5c40\u57df\u7f51\uff0c\u5176\u4e2d\u6700\u5c0f\u7684\u8bbe\u5907\u51b3\u5b9a\u4e86\u7f51\u7edc\u62a5\u6587\u7684\u6700\u5927\u5b57\u8282\u6570\uff0c\u5728 TCP \u4e2d\uff0c\u8fd9\u4e2a\u503c\u53eb\u505a MSS\uff08Maximum Segment Size\uff09\uff0c\u5b83\u901a\u5e38\u5728 1KB \u5de6\u53f3\u3002\u5982\u679c RTT \u65f6\u5ef6\u662f 10ms\uff0c\u90a3\u4e48\u5b83\u4eec\u7684\u4f20\u9001\u901f\u5ea6\u6700\u591a\u53ea\u6709 1KB/10ms=100KB/s\uff01\u53ef\u89c1\uff0c\u8fd9\u79cd\u786e\u8ba4\u62a5\u6587\u65b9\u5f0f\u592a\u5f71\u54cd\u4f20\u8f93\u901f\u5ea6\u4e86\u3002</p> <p></p> <p>\u63d0\u901f\u7684\u65b9\u5f0f\u5f88\u7b80\u5355\uff0c\u5e76\u884c\u5730\u6279\u91cf\u53d1\u9001\u62a5\u6587\uff0c\u518d\u6279\u91cf\u786e\u8ba4\u62a5\u6587\u5373\u53ef\u3002</p> <p>\u7136\u800c\uff0c\u8fd9\u5f15\u51fa\u4e86\u53e6\u4e00\u4e2a\u95ee\u9898\uff0c\u63a5\u6536\u65b9\u6709\u90a3\u4e48\u5f3a\u7684\u5904\u7406\u80fd\u529b\u5417\uff1f\u63a5\u6536\u65b9\u7684\u5904\u7406\u80fd\u529b\uff0c\u8fd9\u662f\u5f71\u54cd\u786e\u8ba4\u673a\u5236\u7684\u7b2c\u4e8c\u4e2a\u56e0\u7d20\u3002</p> <p></p> <p>\u5f53\u63a5\u6536\u65b9\u786c\u4ef6\u4e0d\u5982\u53d1\u9001\u65b9\uff0c\u6216\u8005\u7cfb\u7edf\u7e41\u5fd9\u3001\u8d44\u6e90\u7d27\u5f20\u65f6\uff0c\u662f\u65e0\u6cd5\u77ac\u95f4\u5904\u7406\u8fd9\u4e48\u591a\u62a5\u6587\u7684\u3002\u4e8e\u662f\uff0c\u8fd9\u4e9b\u62a5\u6587\u53ea\u80fd\u88ab\u4e22\u6389\uff0c\u7f51\u7edc\u6548\u7387\u975e\u5e38\u4f4e\u3002\u600e\u4e48\u9650\u5236\u53d1\u9001\u65b9\u7684\u901f\u5ea6\u5462\uff1f</p> <p>\u63a5\u6536\u65b9\u628a\u5b83\u7684\u5904\u7406\u80fd\u529b\u544a\u8bc9\u53d1\u9001\u65b9\uff0c\u4f7f\u5176\u9650\u5236\u53d1\u9001\u901f\u5ea6\u5373\u53ef\uff0c\u8fd9\u5c31\u662f\u6ed1\u52a8\u7a97\u53e3\u7684\u7531\u6765</p> <ul> <li>\u63a5\u6536\u65b9\u6839\u636e\u5b83\u7684\u7f13\u51b2\u533a\uff0c\u53ef\u4ee5\u8ba1\u7b97\u51fa\u540e\u7eed\u80fd\u591f\u63a5\u6536\u591a\u5c11\u5b57\u8282\u7684\u62a5\u6587\uff0c\u8fd9\u4e2a\u6570\u5b57\u53eb\u505a\u63a5\u6536\u7a97\u53e3\u3002</li> <li>\u5f53\u5185\u6838\u63a5\u6536\u5230\u62a5\u6587\u65f6\uff0c\u5fc5\u987b\u7528\u7f13\u51b2\u533a\u5b58\u653e\u5b83\u4eec\uff0c\u8fd9\u6837\u5269\u4f59\u7f13\u51b2\u533a\u7a7a\u95f4\u53d8\u5c0f\uff0c\u63a5\u6536\u7a97\u53e3\u4e5f\u5c31\u53d8\u5c0f\u4e86</li> <li>\u5f53\u8fdb\u7a0b\u8c03\u7528 read \u51fd\u6570\u540e\uff0c\u6570\u636e\u88ab\u8bfb\u5165\u4e86\u7528\u6237\u7a7a\u95f4\uff0c\u5185\u6838\u7f13\u51b2\u533a\u5c31\u88ab\u6e05\u7a7a\uff0c\u8fd9\u610f\u5473\u7740\u4e3b\u673a\u53ef\u4ee5\u63a5\u6536\u66f4\u591a\u7684\u62a5\u6587\uff0c\u63a5\u6536\u7a97\u53e3\u5c31\u4f1a\u53d8\u5927\u3002</li> </ul> <p>\u63a5\u6536\u7a97\u53e3\u5e76\u4e0d\u662f\u6052\u5b9a\u4e0d\u53d8\u7684\uff0c\u90a3\u4e48\u600e\u4e48\u628a\u65f6\u523b\u53d8\u5316\u7684\u7a97\u53e3\u901a\u77e5\u7ed9\u53d1\u9001\u65b9\u5462\uff1fTCP \u62a5\u6587\u5934\u90e8\u4e2d\u7684\u7a97\u53e3\u5b57\u6bb5\uff0c\u5c31\u53ef\u4ee5\u8d77\u5230\u901a\u77e5\u7684\u4f5c\u7528\u3002</p> <p>\u5f53\u53d1\u9001\u65b9\u4ece\u62a5\u6587\u4e2d\u5f97\u5230\u63a5\u6536\u65b9\u7684\u7a97\u53e3\u5927\u5c0f\u65f6\uff0c\u5c31\u660e\u767d\u4e86\u6700\u591a\u80fd\u53d1\u9001\u591a\u5c11\u5b57\u8282\u7684\u62a5\u6587\uff0c\u8fd9\u4e2a\u6570\u5b57\u88ab\u79f0\u4e3a\u53d1\u9001\u65b9\u7684\u53d1\u9001\u7a97\u53e3\u3002</p> <p>\u6269\u5145\u7a97\u53e3\u7684\u65b9\u6cd5,\u4f46 Linux \u4e2d\u6253\u5f00\u8fd9\u4e00\u529f\u80fd\uff0c\u9700\u8981\u628a <code>tcp_window_scaling</code> \u914d\u7f6e\u8bbe\u4e3a 1\uff0c\u6b64\u65f6\u7a97\u53e3\u7684\u6700\u5927\u503c\u53ef\u4ee5\u8fbe\u5230 1GB\uff08230\uff09\u3002</p> <pre><code>net.ipv4.tcp_window_scaling = 1\n</code></pre> <p>\u8fd9\u6837\u770b\u6765\uff0c\u53ea\u8981\u8fdb\u7a0b\u80fd\u53ca\u65f6\u5730\u8c03\u7528 read \u51fd\u6570\u8bfb\u53d6\u6570\u636e\uff0c\u5e76\u4e14\u63a5\u6536\u7f13\u51b2\u533a\u914d\u7f6e\u5f97\u8db3\u591f\u5927\uff0c\u90a3\u4e48\u63a5\u6536\u7a97\u53e3\u5c31\u53ef\u4ee5\u65e0\u9650\u5730\u653e\u5927\uff0c\u53d1\u9001\u65b9\u4e5f\u5c31\u65e0\u9650\u5730\u63d0\u5347\u53d1\u9001\u901f\u5ea6\u3002</p> <p>\u5f88\u663e\u7136\uff0c\u8fd9\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u56e0\u4e3a\u7f51\u7edc\u7684\u4f20\u8f93\u80fd\u529b\u662f\u6709\u9650\u7684\uff0c\u5f53\u53d1\u9001\u65b9\u4f9d\u636e\u53d1\u9001\u7a97\u53e3\uff0c\u53d1\u9001\u8d85\u8fc7\u7f51\u7edc\u5904\u7406\u80fd\u529b\u7684\u62a5\u6587\u65f6\uff0c\u8def\u7531\u5668\u4f1a\u76f4\u63a5\u4e22\u5f03\u8fd9\u4e9b\u62a5\u6587\u3002\u56e0\u6b64\uff0c\u7f13\u51b2\u533a\u7684\u5185\u5b58\u5e76\u4e0d\u662f\u8d8a\u5927\u8d8a\u597d\u3002</p>"},{"location":"chap2/5tcpchachepool/#2","title":"2\u3001\u5e26\u5bbd\u65f6\u5ef6\u79ef\u5982\u4f55\u786e\u5b9a\u6700\u5927\u4f20\u8f93\u901f\u5ea6\uff1f","text":"<p>TCP \u7684\u4f20\u8f93\u901f\u5ea6\uff0c\u53d7\u5236\u4e8e\u53d1\u9001\u7a97\u53e3\u4e0e\u63a5\u6536\u7a97\u53e3\uff0c\u4ee5\u53ca\u7f51\u7edc\u4f20\u8f93\u80fd\u529b\u3002</p> <p>\u5176\u4e2d\uff0c\u4e24\u4e2a\u7a97\u53e3\u7531\u7f13\u51b2\u533a\u5927\u5c0f\u51b3\u5b9a\uff08\u8fdb\u7a0b\u8c03\u7528 read \u51fd\u6570\u662f\u5426\u53ca\u65f6\u4e5f\u4f1a\u5f71\u54cd\u5b83\uff09\u3002\u5982\u679c\u7f13\u51b2\u533a\u5927\u5c0f\u4e0e\u7f51\u7edc\u4f20\u8f93\u80fd\u529b\u5339\u914d\uff0c\u90a3\u4e48\u7f13\u51b2\u533a\u7684\u5229\u7528\u7387\u5c31\u8fbe\u5230\u4e86\u6700\u5927\u503c\u3002</p> <p>\u600e\u6837\u8ba1\u7b97\u51fa\u7f51\u7edc\u4f20\u8f93\u80fd\u529b\u5462\uff1f</p> <p>\u5e26\u5bbd\u63cf\u8ff0\u4e86\u7f51\u7edc\u4f20\u8f93\u80fd\u529b\uff0c\u4f46\u5b83\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528\uff0c\u56e0\u4e3a\u5b83\u4e0e\u7a97\u53e3\u6216\u8005\u8bf4\u7f13\u51b2\u533a\u7684\u8ba1\u91cf\u5355\u4f4d\u4e0d\u540c\u3002\u5e26\u5bbd\u662f\u5355\u4f4d\u65f6\u95f4\u5185\u7684\u6d41\u91cf \uff0c\u5b83\u8868\u8fbe\u7684\u662f\u901f\u5ea6\uff0c\u6bd4\u5982\u4f60\u5bb6\u91cc\u7684\u5bbd\u5e26 100MB/s\uff0c\u800c\u7a97\u53e3\u548c\u7f13\u51b2\u533a\u7684\u5355\u4f4d\u662f\u5b57\u8282\u3002\u5f53\u7f51\u7edc\u901f\u5ea6\u4e58\u4ee5\u65f6\u95f4\u624d\u80fd\u5f97\u5230\u5b57\u8282\u6570\uff0c\u5dee\u7684\u8fd9\u4e2a\u65f6\u95f4\uff0c\u8fd9\u5c31\u662f\u7f51\u7edc\u65f6\u5ef6\u3002</p> <p>\u5f53\u6700\u5927\u5e26\u5bbd\u662f 100MB/s\u3001\u7f51\u7edc\u65f6\u5ef6\u662f 10ms \u65f6\uff0c\u8fd9\u610f\u5473\u7740\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u5668\u95f4\u7684\u7f51\u7edc\u4e00\u5171\u53ef\u4ee5\u5b58\u653e 100MB/s * 0.01s = 1MB \u7684\u5b57\u8282\u3002\u8fd9\u4e2a 1MB \u662f\u5e26\u5bbd\u4e0e\u65f6\u5ef6\u7684\u4e58\u79ef\uff0c\u6240\u4ee5\u5b83\u5c31\u53eb\u505a\u5e26\u5bbd\u65f6\u5ef6\u79ef\uff08\u7f29\u5199\u4e3a BDP\uff0cBandwidth Delay Product\uff09\u3002\u8fd9 1MB \u5b57\u8282\u5b58\u5728\u4e8e\u98de\u884c\u4e2d\u7684 TCP \u62a5\u6587\uff0c\u5b83\u4eec\u5c31\u5728\u7f51\u7edc\u7ebf\u8def\u3001\u8def\u7531\u5668\u7b49\u7f51\u7edc\u8bbe\u5907\u4e0a\u3002\u5982\u679c\u98de\u884c\u62a5\u6587\u8d85\u8fc7\u4e86 1MB\uff0c\u5c31\u4e00\u5b9a\u4f1a\u8ba9\u7f51\u7edc\u8fc7\u8f7d\uff0c\u6700\u7ec8\u5bfc\u81f4\u4e22\u5305\u3002</p> <p>\u7531\u4e8e\u53d1\u9001\u7f13\u51b2\u533a\u51b3\u5b9a\u4e86\u53d1\u9001\u7a97\u53e3\u7684\u4e0a\u9650\uff0c\u800c\u53d1\u9001\u7a97\u53e3\u53c8\u51b3\u5b9a\u4e86\u5df2\u53d1\u9001\u4f46\u672a\u786e\u8ba4\u7684\u98de\u884c\u62a5\u6587\u7684\u4e0a\u9650\uff0c\u56e0\u6b64\uff0c\u53d1\u9001\u7f13\u51b2\u533a\u4e0d\u80fd\u8d85\u8fc7\u5e26\u5bbd\u65f6\u5ef6\u79ef\uff0c\u56e0\u4e3a\u8d85\u51fa\u7684\u90e8\u5206\u6ca1\u6709\u529e\u6cd5\u7528\u4e8e\u6709\u6548\u7684\u7f51\u7edc\u4f20\u8f93\uff0c\u4e14\u98de\u884c\u5b57\u8282\u5927\u4e8e\u5e26\u5bbd\u65f6\u5ef6\u79ef\u8fd8\u4f1a\u5bfc\u81f4\u4e22\u5305\uff1b\u800c\u4e14\uff0c\u7f13\u51b2\u533a\u4e5f\u4e0d\u80fd\u5c0f\u4e8e\u5e26\u5bbd\u65f6\u5ef6\u79ef\uff0c\u5426\u5219\u65e0\u6cd5\u53d1\u6325\u51fa\u9ad8\u901f\u7f51\u7edc\u7684\u4ef7\u503c\u3002</p>"},{"location":"chap2/5tcpchachepool/#3","title":"3\u3001\u600e\u6837\u8c03\u6574\u7f13\u51b2\u533a\u53bb\u9002\u914d\u6ed1\u52a8\u7a97\u53e3\uff1f","text":"<p>\u65f6\u523b\u8ba9\u7f13\u51b2\u533a\u4fdd\u6301\u6700\u5927\uff0c\u592a\u8fc7\u6d6a\u8d39\u5185\u5b58\u4e86\u3002</p> <p>\u56e0\u4e3a\u4e0d\u662f\u6bcf\u4e00\u4e2a\u8bf7\u6c42\u90fd\u80fd\u591f\u8fbe\u5230\u6700\u5927\u4f20\u8f93\u901f\u5ea6\uff0c\u6bd4\u5982\u8bf7\u6c42\u7684\u4f53\u79ef\u592a\u5c0f\u65f6\uff0c\u5728\u6162\u542f\u52a8\uff08\u4e0b\u4e00\u8bb2\u4f1a\u8c08\u5230\uff09\u7684\u5f71\u54cd\u4e0b\uff0c\u672a\u8fbe\u5230\u6700\u5927\u901f\u5ea6\u65f6\u8bf7\u6c42\u5c31\u5904\u7406\u5b8c\u4e86\u3002\u518d\u6bd4\u5982\u7f51\u7edc\u672c\u8eab\u4e5f\u4f1a\u6709\u6ce2\u52a8\uff0c\u672a\u5fc5\u53ef\u4ee5\u4e00\u76f4\u4fdd\u6301\u6700\u5927\u901f\u5ea6\u3002</p>"},{"location":"chap2/5tcpchachepool/#_1","title":"\u5230\u5e95\u8be5\u5982\u4f55\u8bbe\u7f6e\u7f13\u51b2\u533a\u5462\uff1f","text":"<p>\u53ef\u4ee5\u4f7f\u7528 Linux \u7684\u7f13\u51b2\u533a\u52a8\u6001\u8c03\u8282\u529f\u80fd\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002\u5176\u4e2d\uff0c\u7f13\u51b2\u533a\u7684\u8c03\u8282\u8303\u56f4\u662f\u53ef\u4ee5\u8bbe\u7f6e\u7684\u3002\u5148\u6765\u770b\u53d1\u9001\u7f13\u51b2\u533a\uff0c\u5b83\u7684\u8303\u56f4\u901a\u8fc7 <code>tcp_wmem</code> \u914d\u7f6e\uff1a</p> <pre><code>net.ipv4.tcp_wmem = 4096        16384   4194304\n</code></pre> <p>\u5176\u4e2d\uff0c\u7b2c 1 \u4e2a\u6570\u503c\u662f\u52a8\u6001\u8303\u56f4\u7684\u4e0b\u9650\uff0c\u7b2c 3 \u4e2a\u6570\u503c\u662f\u52a8\u6001\u8303\u56f4\u7684\u4e0a\u9650\u3002\u800c\u4e2d\u95f4\u7b2c 2 \u4e2a\u6570\u503c\uff0c\u5219\u662f\u521d\u59cb\u9ed8\u8ba4\u503c\u3002</p> <p>\u53d1\u9001\u7f13\u51b2\u533a\u5b8c\u5168\u6839\u636e\u9700\u6c42\u81ea\u884c\u8c03\u6574\u3002\u6bd4\u5982\uff0c\u4e00\u65e6\u53d1\u9001\u51fa\u7684\u6570\u636e\u88ab\u786e\u8ba4\uff0c\u800c\u4e14\u6ca1\u6709\u65b0\u7684\u6570\u636e\u8981\u53d1\u9001\uff0c\u5c31\u53ef\u4ee5\u628a\u53d1\u9001\u7f13\u51b2\u533a\u7684\u5185\u5b58\u91ca\u653e\u6389\u3002\u800c\u63a5\u6536\u7f13\u51b2\u533a\u7684\u8c03\u6574\u5c31\u8981\u590d\u6742\u4e00\u4e9b\uff0c\u5148\u6765\u770b\u8bbe\u7f6e\u63a5\u6536\u7f13\u51b2\u533a\u8303\u56f4\u7684 <code>tcp_rmem</code>\uff1a</p> <pre><code>net.ipv4.tcp_rmem = 4096        87380   6291456\n</code></pre> <p>\u5b83\u7684\u6570\u503c\u4e0e <code>tcp_wmem</code> \u7c7b\u4f3c\uff0c\u7b2c 1\u30013 \u4e2a\u503c\u662f\u8303\u56f4\u7684\u4e0b\u9650\u548c\u4e0a\u9650\uff0c\u7b2c 2 \u4e2a\u503c\u662f\u521d\u59cb\u9ed8\u8ba4\u503c\u3002\u53d1\u9001\u7f13\u51b2\u533a\u81ea\u52a8\u8c03\u8282\u7684\u4f9d\u636e\u662f\u5f85\u53d1\u9001\u7684\u6570\u636e\uff0c\u63a5\u6536\u7f13\u51b2\u533a\u7531\u4e8e\u53ea\u80fd\u88ab\u52a8\u5730\u7b49\u5f85\u63a5\u6536\u6570\u636e\uff0c\u5b83\u8be5\u5982\u4f55\u81ea\u52a8\u8c03\u6574\u5462\uff1f</p> <p>\u53ef\u4ee5\u4f9d\u636e\u7a7a\u95f2\u7cfb\u7edf\u5185\u5b58\u7684\u6570\u91cf\u6765\u8c03\u8282\u63a5\u6536\u7a97\u53e3\u3002\u5982\u679c\u7cfb\u7edf\u7684\u7a7a\u95f2\u5185\u5b58\u5f88\u591a\uff0c\u5c31\u53ef\u4ee5\u628a\u7f13\u51b2\u533a\u589e\u5927\u4e00\u4e9b\uff0c\u8fd9\u6837\u4f20\u7ed9\u5bf9\u65b9\u7684\u63a5\u6536\u7a97\u53e3\u4e5f\u4f1a\u53d8\u5927\uff0c\u56e0\u800c\u5bf9\u65b9\u7684\u53d1\u9001\u901f\u5ea6\u5c31\u4f1a\u901a\u8fc7\u589e\u52a0\u98de\u884c\u62a5\u6587\u6765\u63d0\u5347\u3002\u53cd\u4e4b\uff0c\u5185\u5b58\u7d27\u5f20\u65f6\u5c31\u4f1a\u7f29\u5c0f\u7f13\u51b2\u533a\uff0c\u8fd9\u867d\u7136\u4f1a\u51cf\u6162\u901f\u5ea6\uff0c\u4f46\u53ef\u4ee5\u4fdd\u8bc1\u66f4\u591a\u7684\u5e76\u53d1\u8fde\u63a5\u6b63\u5e38\u5de5\u4f5c\u3002</p> <p>\u53d1\u9001\u7f13\u51b2\u533a\u7684\u8c03\u8282\u529f\u80fd\u662f\u81ea\u52a8\u5f00\u542f\u7684\uff0c\u800c\u63a5\u6536\u7f13\u51b2\u533a\u5219\u9700\u8981\u914d\u7f6e <code>tcp_moderate_rcvbuf</code> \u4e3a 1 \u6765\u5f00\u542f\u8c03\u8282\u529f\u80fd\uff1a</p> <pre><code>net.ipv4.tcp_moderate_rcvbuf = 1\n</code></pre> <p>\u63a5\u6536\u7f13\u51b2\u533a\u8c03\u8282\u65f6\uff0c\u600e\u4e48\u5224\u65ad\u7a7a\u95f2\u5185\u5b58\u7684\u591a\u5c11\u5462\uff1f\u8fd9\u662f\u901a\u8fc7 tcp_mem \u914d\u7f6e\u5b8c\u6210\u7684\uff1a</p> <pre><code>net.ipv4.tcp_mem = 88560        118080  177120\n</code></pre> <p><code>tcp_mem</code> \u7684 3 \u4e2a\u503c\uff0c\u662f Linux \u5224\u65ad\u7cfb\u7edf\u5185\u5b58\u662f\u5426\u7d27\u5f20\u7684\u4f9d\u636e\u3002\u5f53 TCP \u5185\u5b58\u5c0f\u4e8e\u7b2c 1 \u4e2a\u503c\u65f6\uff0c\u4e0d\u9700\u8981\u8fdb\u884c\u81ea\u52a8\u8c03\u8282\uff1b\u5728\u7b2c 1 \u548c\u7b2c 2 \u4e2a\u503c\u4e4b\u95f4\u65f6\uff0c\u5185\u6838\u5f00\u59cb\u8c03\u8282\u63a5\u6536\u7f13\u51b2\u533a\u7684\u5927\u5c0f\uff1b\u5927\u4e8e\u7b2c 3 \u4e2a\u503c\u65f6\uff0c\u5185\u6838\u4e0d\u518d\u4e3a TCP \u5206\u914d\u65b0\u5185\u5b58\uff0c\u6b64\u65f6\u65b0\u8fde\u63a5\u662f\u65e0\u6cd5\u5efa\u7acb\u7684\u3002</p> <p>\u5728\u9ad8\u5e76\u53d1\u670d\u52a1\u5668\u4e2d\uff0c\u4e3a\u4e86\u517c\u987e\u7f51\u901f\u4e0e\u5927\u91cf\u7684\u5e76\u53d1\u8fde\u63a5\uff0c\u6211\u4eec\u5e94\u5f53\u4fdd\u8bc1\u7f13\u51b2\u533a\u7684\u52a8\u6001\u8c03\u6574\u4e0a\u9650\u8fbe\u5230\u5e26\u5bbd\u65f6\u5ef6\u79ef\uff0c\u800c\u4e0b\u9650\u4fdd\u6301\u9ed8\u8ba4\u7684 4K \u4e0d\u53d8\u5373\u53ef\u3002\u800c\u5bf9\u4e8e\u5185\u5b58\u7d27\u5f20\u7684\u670d\u52a1\u800c\u8a00\uff0c\u8c03\u4f4e\u9ed8\u8ba4\u503c\u662f\u63d0\u9ad8\u5e76\u53d1\u7684\u6709\u6548\u624b\u6bb5\u3002</p> <p>\u540c\u65f6\uff0c\u5982\u679c\u8fd9\u662f\u7f51\u7edc IO \u578b\u670d\u52a1\u5668\uff0c\u90a3\u4e48\uff0c\u8c03\u5927 <code>tcp_mem</code> \u7684\u4e0a\u9650\u53ef\u4ee5\u8ba9 TCP \u8fde\u63a5\u4f7f\u7528\u66f4\u591a\u7684\u7cfb\u7edf\u5185\u5b58\uff0c\u8fd9\u6709\u5229\u4e8e\u63d0\u5347\u5e76\u53d1\u80fd\u529b\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c<code>tcp_wmem</code> \u548c <code>tcp_rmem</code> \u7684\u5355\u4f4d\u662f\u5b57\u8282\uff0c\u800c <code>tcp_mem</code> \u7684\u5355\u4f4d\u662f\u9875\u9762\u5927\u5c0f\u3002\u800c\u4e14\uff0c\u5343\u4e07\u4e0d\u8981\u5728 socket \u4e0a\u76f4\u63a5\u8bbe\u7f6e <code>SO_SNDBUF</code> \u6216\u8005 <code>SO_RCVBUF</code>\uff0c\u8fd9\u6837\u4f1a\u5173\u95ed\u7f13\u51b2\u533a\u7684\u52a8\u6001\u8c03\u6574\u529f\u80fd\u3002</p>"},{"location":"chap2/5tcpchachepool/#4","title":"4\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u5b9e\u73b0\u9ad8\u5e76\u53d1\u670d\u52a1\u65f6\uff0c\u7531\u4e8e\u5fc5\u987b\u628a\u5927\u90e8\u5206\u5185\u5b58\u7528\u5728\u7f51\u7edc\u4f20\u8f93\u4e0a\uff0c\u6240\u4ee5\u9664\u4e86\u5173\u6ce8\u5e94\u7528\u5185\u5b58\u7684\u4f7f\u7528\uff0c\u8fd8\u5fc5\u987b\u5173\u6ce8 TCP \u5185\u6838\u7f13\u51b2\u533a\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\u3002</p> <p>TCP \u4f7f\u7528 ACK \u786e\u8ba4\u62a5\u6587\u5b9e\u73b0\u4e86\u53ef\u9760\u6027\uff0c\u53c8\u4f9d\u8d56\u6ed1\u52a8\u7a97\u53e3\u65e2\u63d0\u5347\u4e86\u53d1\u9001\u901f\u5ea6\u4e5f\u517c\u987e\u4e86\u63a5\u6536\u65b9\u7684\u5904\u7406\u80fd\u529b\u3002\u7136\u800c\uff0c\u9ed8\u8ba4\u7684\u6ed1\u52a8\u7a97\u53e3\u6700\u5927\u53ea\u80fd\u5230 65KB\uff0c\u8981\u60f3\u63d0\u5347\u53d1\u9001\u901f\u5ea6\u5fc5\u987b\u63d0\u5347\u6ed1\u52a8\u7a97\u53e3\u7684\u4e0a\u9650\uff0c\u5728 Linux \u4e0b\u662f\u901a\u8fc7\u8bbe\u7f6e <code>tcp_window_scaling</code> \u4e3a 1 \u505a\u5230\u7684\u3002</p> <p>\u6ed1\u52a8\u7a97\u53e3\u5b9a\u4e49\u4e86\u98de\u884c\u62a5\u6587\u7684\u6700\u5927\u5b57\u8282\u6570\uff0c\u5f53\u5b83\u8d85\u8fc7\u5e26\u5bbd\u65f6\u5ef6\u79ef\u65f6\uff0c\u5c31\u4f1a\u53d1\u751f\u4e22\u5305\u3002\u800c\u5f53\u5b83\u5c0f\u4e8e\u5e26\u5bbd\u65f6\u5ef6\u79ef\u65f6\uff0c\u5c31\u65e0\u6cd5\u8ba9 TCP \u7684\u4f20\u8f93\u901f\u5ea6\u8fbe\u5230\u7f51\u7edc\u5141\u8bb8\u7684\u6700\u5927\u503c\u3002\u56e0\u6b64\uff0c\u6ed1\u52a8\u7a97\u53e3\u7684\u8bbe\u8ba1\uff0c\u5fc5\u987b\u53c2\u8003\u5e26\u5bbd\u65f6\u5ef6\u79ef\u3002</p> <p>\u5185\u6838\u7f13\u51b2\u533a\u51b3\u5b9a\u4e86\u6ed1\u52a8\u7a97\u53e3\u7684\u4e0a\u9650\uff0c\u4f46\u6211\u4eec\u4e0d\u80fd\u901a\u8fc7 socket \u7684 <code>SO_SNFBUF</code> \u7b49\u9009\u9879\u76f4\u63a5\u628a\u7f13\u51b2\u533a\u5927\u5c0f\u8bbe\u7f6e\u4e3a\u5e26\u5bbd\u65f6\u5ef6\u79ef\uff0c\u56e0\u4e3a TCP \u4e0d\u4f1a\u4e00\u76f4\u7ef4\u6301\u5728\u6700\u9ad8\u901f\u4e0a\uff0c\u8fc7\u5927\u7684\u7f13\u51b2\u533a\u4f1a\u51cf\u5c11\u5e76\u53d1\u8fde\u63a5\u6570\u3002Linux \u5e26\u6765\u7684\u7f13\u51b2\u533a\u81ea\u52a8\u8c03\u8282\u529f\u80fd\u975e\u5e38\u6709\u6548\uff0c\u6211\u4eec\u5e94\u5f53\u628a\u7f13\u51b2\u533a\u7684\u4e0a\u9650\u8bbe\u7f6e\u4e3a\u5e26\u5bbd\u65f6\u5ef6\u79ef\u3002\u5176\u4e2d\uff0c\u53d1\u9001\u7f13\u51b2\u533a\u7684\u8c03\u8282\u529f\u80fd\u662f\u81ea\u52a8\u6253\u5f00\u7684\uff0c\u800c\u63a5\u6536\u7f13\u51b2\u533a\u9700\u8981\u628a <code>tcp_moderate_rcvbuf</code> \u8bbe\u7f6e\u4e3a 1 \u6765\u5f00\u542f\uff0c\u5176\u4e2d\u8c03\u8282\u7684\u4f9d\u636e\u6839\u636e <code>tcp_mem</code> \u800c\u5b9a\u3002</p> <p>\u8fd9\u6837\u9ad8\u6548\u5730\u914d\u7f6e\u5185\u5b58\u540e\uff0c\u65e2\u80fd\u591f\u6700\u5927\u7a0b\u5ea6\u5730\u4fdd\u6301\u5e76\u53d1\u6027\uff0c\u4e5f\u80fd\u8ba9\u8d44\u6e90\u5145\u88d5\u65f6\u8fde\u63a5\u4f20\u8f93\u901f\u5ea6\u8fbe\u5230\u6700\u5927\u503c</p> <p>\u5e26\u5bbd\u63cf\u8ff0\u4e86\u7f51\u7edc\u4f20\u8f93\u80fd\u529b\uff0c\u4f46\u5b83\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528\uff0c\u56e0\u4e3a\u5b83\u4e0e\u7a97\u53e3\u6216\u8005\u8bf4\u7f13\u51b2\u533a\u7684\u8ba1\u91cf\u5355\u4f4d\u4e0d\u540c\u3002\u5e26\u5bbd\u662f\u5355\u4f4d\u65f6\u95f4\u5185\u7684\u6d41\u91cf \uff0c\u5b83\u8868\u8fbe\u7684\u662f\u901f\u5ea6\uff0c\u6bd4\u5982\u4f60\u5bb6\u91cc\u7684\u5bbd\u5e26 100MB/s\uff0c\u800c\u7a97\u53e3\u548c\u7f13\u51b2\u533a\u7684\u5355\u4f4d\u662f\u5b57\u8282\u3002\u5f53\u7f51\u7edc\u901f\u5ea6\u4e58\u4ee5\u65f6\u95f4\u624d\u80fd\u5f97\u5230\u5b57\u8282\u6570\uff0c\u5dee\u7684\u8fd9\u4e2a\u65f6\u95f4\uff0c\u8fd9\u5c31\u662f\u7f51\u7edc\u65f6\u5ef6\u3002</p>"},{"location":"chap2/6tcpcongestion/","title":"\u7b2c\u516d\u8282 \u8c03\u6574TCP\u62e5\u585e\u63a7\u5236\u7684\u6027\u80fd","text":"<p>\u63a5\u6536\u4e3b\u673a\u7684\u5904\u7406\u80fd\u529b\u4e0d\u8db3\u65f6\uff0c\u662f\u901a\u8fc7\u6ed1\u52a8\u7a97\u53e3\u6765\u51cf\u7f13\u5bf9\u65b9\u7684\u53d1\u9001\u901f\u5ea6</p> <p>\u7f51\u7edc\u5904\u7406\u80fd\u529b\u4e0d\u8db3\u65f6\u53c8\u8be5\u5982\u4f55\u4f18\u5316 TCP \u7684\u6027\u80fd</p> <p>\u5982\u679c\u6ca1\u6709\u62e5\u585e\u63a7\u5236\uff0c\u6574\u4e2a\u7f51\u7edc\u5c06\u4f1a\u9501\u6b7b\uff0c\u6240\u6709\u6d88\u606f\u90fd\u65e0\u6cd5\u4f20\u8f93\u3002</p>"},{"location":"chap2/6tcpcongestion/#1","title":"1\u3001\u6162\u542f\u52a8\u9636\u6bb5\u5982\u4f55\u8c03\u6574\u521d\u59cb\u62e5\u585e\u7a97\u53e3\uff1f","text":"<p>\u4e0a\u4e00\u8bb2\u8c08\u5230\uff0c\u53ea\u8981\u63a5\u6536\u65b9\u7684\u8bfb\u7f13\u51b2\u533a\u8db3\u591f\u5927\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u62a5\u6587\u4e2d\u7684\u63a5\u6536\u7a97\u53e3\uff0c\u8981\u6c42\u5bf9\u65b9\u66f4\u5feb\u5730\u53d1\u9001\u6570\u636e\u3002</p> <p>\u7136\u800c\uff0c\u7f51\u7edc\u7684\u4f20\u8f93\u901f\u5ea6\u662f\u6709\u9650\u7684\uff0c\u5b83\u4f1a\u76f4\u63a5\u4e22\u5f03\u8d85\u8fc7\u5176\u5904\u7406\u80fd\u529b\u7684\u62a5\u6587\u3002</p> <p>\u800c\u53d1\u9001\u65b9\u53ea\u6709\u5728\u91cd\u4f20\u5b9a\u65f6\u5668\u8d85\u65f6\u540e\uff0c\u624d\u80fd\u53d1\u73b0\u8d85\u53d1\u7684\u62a5\u6587\u88ab\u7f51\u7edc\u4e22\u5f03\u4e86\uff0c\u53d1\u9001\u901f\u5ea6\u63d0\u4e0d\u4e0a\u53bb\u3002\u66f4\u4e3a\u7cdf\u7cd5\u7684\u662f\uff0c\u5982\u679c\u7f51\u7edc\u4e2d\u7684\u6bcf\u4e2a\u8fde\u63a5\u90fd\u6309\u7167\u63a5\u6536\u7a97\u53e3\u5c3d\u53ef\u80fd\u5730\u53d1\u9001\u66f4\u591a\u7684\u62a5\u6587\u65f6\uff0c\u5c31\u4f1a\u5f62\u6210\u6076\u6027\u5faa\u73af\uff0c\u6700\u7ec8\u8d85\u9ad8\u7684\u7f51\u7edc\u4e22\u5305\u7387\u4f1a\u4f7f\u5f97\u6bcf\u4e2a\u8fde\u63a5\u90fd\u65e0\u6cd5\u53d1\u9001\u6570\u636e\u3002</p>"},{"location":"chap2/6tcpcongestion/#_1","title":"\u62e5\u585e\u63a7\u5236","text":"<p>\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\u7684\u65b9\u6848\u53eb\u505a\u62e5\u585e\u63a7\u5236\uff0c\u5b83\u5305\u62ec 4 \u4e2a\u9636\u6bb5\uff0c\u6211\u4eec\u9996\u5148\u6765\u770b TCP \u8fde\u63a5\u521a\u5efa\u7acb\u65f6\u7684\u6162\u542f\u52a8\u9636\u6bb5\u3002\u7531\u4e8e TCP \u8fde\u63a5\u4f1a\u7a7f\u8d8a\u8bb8\u591a\u7f51\u7edc\uff0c\u6240\u4ee5\u6700\u521d\u5e76\u4e0d\u77e5\u9053\u7f51\u7edc\u7684\u4f20\u8f93\u80fd\u529b\uff0c\u4e3a\u4e86\u907f\u514d\u53d1\u9001\u8d85\u8fc7\u7f51\u7edc\u8d1f\u8f7d\u7684\u62a5\u6587\uff0cTCP \u53ea\u80fd\u5148\u8c03\u4f4e\u53d1\u9001\u7a97\u53e3\uff0c\u51cf\u5c11\u98de\u884c\u4e2d\u7684\u62a5\u6587\u6765\u8ba9\u53d1\u9001\u901f\u5ea6\u53d8\u6162\uff0c\u8fd9\u4e5f\u662f\u201c\u6162\u542f\u52a8\u201d\u540d\u5b57\u7684\u7531\u6765\u3002</p> <p>\u8ba9\u53d1\u9001\u901f\u5ea6\u53d8\u6162\u662f\u901a\u8fc7\u5f15\u5165\u62e5\u585e\u7a97\u53e3\uff08\u5168\u79f0\u4e3a congestion window\uff0c\u7f29\u5199\u4e3a CWnd\uff0c\u7c7b\u4f3c\u5730\uff0c\u63a5\u6536\u7a97\u53e3\u53eb\u505a rwnd\uff0c\u53d1\u9001\u7a97\u53e3\u53eb\u505a swnd\uff09\u5b9e\u73b0\u7684\uff0c\u5b83\u7528\u4e8e\u907f\u514d\u7f51\u7edc\u51fa\u73b0\u62e5\u585e\u3002\u4e0a\u4e00\u8bb2\u6211\u4eec\u8bf4\u8fc7\uff0c\u5982\u679c\u4e0d\u8003\u8651\u7f51\u7edc\u62e5\u585e\uff0c\u53d1\u9001\u7a97\u53e3\u5c31\u7b49\u4e8e\u5bf9\u65b9\u7684\u63a5\u6536\u7a97\u53e3\uff0c\u800c\u8003\u8651\u4e86\u7f51\u7edc\u62e5\u585e\u540e\uff0c\u53d1\u9001\u7a97\u53e3\u5219\u5e94\u5f53\u662f\u62e5\u585e\u7a97\u53e3\u4e0e\u5bf9\u65b9\u63a5\u6536\u7a97\u53e3\u7684\u6700\u5c0f\u503c\uff1a</p> <pre><code>swnd = min(cwnd, rwnd)\n</code></pre> <p>\u53d1\u9001\u901f\u5ea6\u5c31\u7efc\u5408\u8003\u8651\u4e86\u63a5\u6536\u65b9\u548c\u7f51\u7edc\u7684\u5904\u7406\u80fd\u529b\u3002</p> <p>\u867d\u7136\u7a97\u53e3\u7684\u8ba1\u91cf\u5355\u4f4d\u662f\u5b57\u8282\uff0c\u4f46\u4e3a\u4e86\u65b9\u4fbf\u7406\u89e3\uff0c\u901a\u5e38\u6211\u4eec\u7528 MSS \u4f5c\u4e3a\u63cf\u8ff0\u7a97\u53e3\u5927\u5c0f\u7684\u5355\u4f4d\uff0c\u5176\u4e2d MSS \u662f TCP \u62a5\u6587\u7684\u6700\u5927\u957f\u5ea6\u3002</p> <p>\u5982\u679c\u521d\u59cb\u62e5\u585e\u7a97\u53e3\u53ea\u6709 1 \u4e2a MSS\uff0c\u5f53 MSS \u662f 1KB\uff0c\u800c RTT \u65f6\u5ef6\u662f 100ms \u65f6\uff0c\u53d1\u9001\u901f\u5ea6\u53ea\u6709 10KB/s\u3002\u6240\u4ee5\uff0c\u5f53\u6ca1\u6709\u53d1\u751f\u62e5\u585e\u65f6\uff0c\u62e5\u585e\u7a97\u53e3\u5fc5\u987b\u5feb\u901f\u6269\u5927\uff0c\u624d\u80fd\u63d0\u9ad8\u4e92\u8054\u7f51\u7684\u4f20\u8f93\u901f\u5ea6\u3002\u56e0\u6b64\uff0c\u6162\u542f\u52a8\u9636\u6bb5\u4f1a\u4ee5\u6307\u6570\u7ea7\u6269\u5927\u62e5\u585e\u7a97\u53e3\uff08\u6269\u5927\u89c4\u5219\u662f\u8fd9\u6837\u7684\uff1a\u53d1\u9001\u65b9\u6bcf\u6536\u5230\u4e00\u4e2a ACK \u786e\u8ba4\u62a5\u6587\uff0c\u62e5\u585e\u7a97\u53e3\u5c31\u589e\u52a0 1 \u4e2a MSS\uff09\uff0c\u6bd4\u5982\u6700\u521d\u7684\u521d\u59cb\u62e5\u585e\u7a97\u53e3\uff08\u4e5f\u79f0\u4e3a initcwnd\uff09\u662f 1 \u4e2a MSS\uff0c\u7ecf\u8fc7 4 \u4e2a RTT \u5c31\u4f1a\u53d8\u6210 16 \u4e2a MSS\u3002</p> <p>\u8fd9\u6837\uff0c\u5f53 MSS \u662f 1KB \u65f6\uff0c\u591a\u6570 HTTP \u8bf7\u6c42\u81f3\u5c11\u5305\u542b 10 \u4e2a\u62a5\u6587\uff0c\u5373\u4f7f\u4ee5\u6307\u6570\u7ea7\u589e\u52a0\u62e5\u585e\u7a97\u53e3\uff0c\u4e5f\u9700\u8981\u81f3\u5c11 4 \u4e2a RTT \u624d\u80fd\u4f20\u8f93\u5b8c\uff0c\u53c2\u89c1\u4e0b\u56fe\uff1a</p> <p></p> <p>\u56e0\u6b64\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u7f51\u7edc\u72b6\u51b5\u548c\u4f20\u8f93\u5bf9\u8c61\u7684\u5927\u5c0f\uff0c\u8c03\u6574\u521d\u59cb\u62e5\u585e\u7a97\u53e3\u7684\u5927\u5c0f\u3002</p> <p>\u8c03\u6574\u524d\uff0c\u5148\u8981\u6e05\u695a\u4f60\u7684\u670d\u52a1\u5668\u73b0\u5728\u7684\u521d\u59cb\u62e5\u585e\u7a97\u53e3\u662f\u591a\u5927\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7 ss \u547d\u4ee4\u67e5\u770b\u5f53\u524d\u62e5\u585e\u7a97\u53e3\uff1a</p> <pre><code># ss -nli|fgrep cwnd\n         cubic rto:1000 mss:536 cwnd:10 segs_in:10621866 lastsnd:1716864402 lastrcv:1716864402 lastack:1716864402\n</code></pre> <p>\u518d\u901a\u8fc7 ip route change \u547d\u4ee4\u4fee\u6539\u521d\u59cb\u62e5\u585e\u7a97\u53e3\uff1a</p> <pre><code># ip route | while read r; do\n           ip route change $r initcwnd 10;\n       done\n</code></pre> <p>\u5f53\u7136\uff0c\u66f4\u5927\u7684\u521d\u59cb\u62e5\u585e\u7a97\u53e3\u4ee5\u53ca\u6307\u6570\u7ea7\u7684\u63d0\u901f\uff0c\u8fde\u63a5\u5f88\u5feb\u5c31\u4f1a\u906d\u9047\u7f51\u7edc\u62e5\u585e\uff0c\u4ece\u800c\u5bfc\u81f4\u6162\u542f\u52a8\u9636\u6bb5\u7684\u7ed3\u675f\u3002</p>"},{"location":"chap2/6tcpcongestion/#2","title":"2\u3001\u51fa\u73b0\u7f51\u7edc\u62e5\u585e\u65f6\u8be5\u600e\u4e48\u529e\uff1f","text":"<p>\u4ee5\u4e0b 3 \u79cd\u573a\u666f\u90fd\u4f1a\u5bfc\u81f4\u6162\u542f\u52a8\u9636\u6bb5\u7ed3\u675f\uff1a</p> <ol> <li>\u901a\u8fc7\u5b9a\u65f6\u5668\u660e\u786e\u63a2\u6d4b\u5230\u4e86\u4e22\u5305\uff1b</li> <li>\u62e5\u585e\u7a97\u53e3\u7684\u589e\u957f\u5230\u8fbe\u4e86\u6162\u542f\u52a8\u9608\u503c ssthresh\uff08\u5168\u79f0\u4e3a slow start threshold\uff09\uff0c\u4e5f\u5c31\u662f\u4e4b\u524d\u53d1\u73b0\u7f51\u7edc\u62e5\u585e\u65f6\u7684\u7a97\u53e3\u5927\u5c0f\uff1b</li> <li>\u63a5\u6536\u5230\u91cd\u590d\u7684 ACK \u62a5\u6587\uff0c\u53ef\u80fd\u5b58\u5728\u4e22\u5305\u3002</li> </ol>"},{"location":"chap2/6tcpcongestion/#2-1-ack","title":"2-1 \u5728\u89c4\u5b9a\u65f6\u95f4\u5185\u6ca1\u6709\u6536\u5230 ACK \u62a5\u6587","text":"<p>\u5728\u89c4\u5b9a\u65f6\u95f4\u5185\u6ca1\u6709\u6536\u5230 ACK \u62a5\u6587\uff0c\u8fd9\u8bf4\u660e\u62a5\u6587\u4e22\u5931\u4e86\uff0c\u7f51\u7edc\u51fa\u73b0\u4e86\u4e25\u91cd\u7684\u62e5\u585e\uff0c\u5fc5\u987b\u5148\u964d\u4f4e\u53d1\u9001\u901f\u5ea6\uff0c\u518d\u8fdb\u5165\u62e5\u585e\u907f\u514d\u9636\u6bb5\u3002</p> <p>\u4e0d\u540c\u7684\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u964d\u4f4e\u901f\u5ea6\u7684\u5e45\u5ea6\u5e76\u4e0d\u76f8\u540c\uff0c\u6bd4\u5982 CUBIC \u7b97\u6cd5\u4f1a\u628a\u62e5\u585e\u7a97\u53e3\u964d\u4e3a\u539f\u5148\u7684 0.8 \u500d\uff08\u4e5f\u5c31\u662f\u53d1\u9001\u901f\u5ea6\u964d\u5230 0.8 \u500d\uff09\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u77e5\u9053\u4e86\u591a\u5927\u7684\u7a97\u53e3\u4f1a\u5bfc\u81f4\u62e5\u585e\uff0c\u56e0\u6b64\u53ef\u4ee5\u628a\u6162\u542f\u52a8\u9608\u503c\u8bbe\u4e3a\u53d1\u751f\u62e5\u585e\u524d\u7684\u7a97\u53e3\u5927\u5c0f\u3002</p>"},{"location":"chap2/6tcpcongestion/#2-2","title":"2-2 \u8fd8\u6ca1\u6709\u53d1\u751f\u4e22\u5305\uff0c\u4f46\u53d1\u9001\u65b9\u5df2\u7ecf\u8fbe\u5230\u4e86\u66fe\u7ecf\u53d1\u751f\u7f51\u7edc\u62e5\u585e\u7684\u901f\u5ea6","text":"<p>\u867d\u7136\u8fd8\u6ca1\u6709\u53d1\u751f\u4e22\u5305\uff0c\u4f46\u53d1\u9001\u65b9\u5df2\u7ecf\u8fbe\u5230\u4e86\u66fe\u7ecf\u53d1\u751f\u7f51\u7edc\u62e5\u585e\u7684\u901f\u5ea6\uff08\u62e5\u585e\u7a97\u53e3\u8fbe\u5230\u4e86\u6162\u542f\u52a8\u9608\u503c\uff09\uff0c\u63a5\u4e0b\u6765\u53d1\u751f\u62e5\u585e\u7684\u6982\u7387\u5f88\u9ad8\uff0c\u6240\u4ee5\u8fdb\u5165\u62e5\u585e\u907f\u514d\u9636\u6bb5\uff0c\u6b64\u65f6\u62e5\u585e\u7a97\u53e3\u4e0d\u80fd\u518d\u4ee5\u6307\u6570\u65b9\u5f0f\u589e\u957f\uff0c\u800c\u662f\u8981\u4ee5\u7ebf\u6027\u65b9\u5f0f\u589e\u957f\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u62e5\u585e\u7a97\u53e3\u4f1a\u4ee5\u6bcf\u4e2a RTT \u589e\u52a0 1 \u4e2a MSS \u7684\u65b9\u5f0f\uff0c\u4ee3\u66ff\u6162\u542f\u52a8\u9636\u6bb5\u6bcf\u6536\u5230 1 \u4e2a ACK \u5c31\u589e\u52a0 1 \u4e2a MSS \u7684\u65b9\u5f0f\u3002\u8fd9\u91cc\u53ef\u80fd\u6709\u540c\u5b66\u4f1a\u6709\u7591\u95ee\uff0c\u5728\u7b2c 1 \u79cd\u573a\u666f\u53d1\u751f\u524d\uff0c\u6162\u542f\u52a8\u9608\u503c\u662f\u591a\u5927\u5462\uff1f</p>"},{"location":"chap2/6tcpcongestion/#2-3-ack","title":"2-3 \u63a5\u6536\u5230\u91cd\u590d\u7684 ACK \u62a5\u6587\uff0c\u53ef\u80fd\u5b58\u5728\u4e22\u5305","text":"<p>CP \u4f20\u8f93\u7684\u662f\u5b57\u8282\u6d41\uff0c\u800c\u201c\u6d41\u201d\u662f\u5929\u7136\u6709\u5e8f\u7684\u3002\u56e0\u6b64\uff0c\u5f53\u63a5\u6536\u65b9\u6536\u5230\u4e0d\u8fde\u7eed\u7684\u62a5\u6587\u65f6\uff0c\u5c31\u53ef\u80fd\u53d1\u751f\u62a5\u6587\u4e22\u5931\u6216\u8005\u5ef6\u8fdf\uff0c\u7b49\u5f85\u53d1\u9001\u65b9\u8d85\u65f6\u91cd\u53d1\u592a\u82b1\u65f6\u95f4\u4e86\uff0c\u4e3a\u4e86\u7f29\u77ed\u91cd\u53d1\u65f6\u95f4\uff0c\u5feb\u901f\u91cd\u4f20\u7b97\u6cd5\u4fbf\u5e94\u8fd0\u800c\u751f\u3002</p> <p>\u5f53\u8fde\u7eed\u6536\u5230 3 \u4e2a\u91cd\u590d ACK \u65f6\uff0c\u53d1\u9001\u65b9\u4fbf\u5f97\u5230\u4e86\u7f51\u7edc\u53d1\u751f\u62e5\u585e\u7684\u660e\u786e\u4fe1\u53f7\uff0c\u901a\u8fc7\u91cd\u590d ACK \u62a5\u6587\u7684\u5e8f\u53f7\uff0c\u6211\u4eec\u77e5\u9053\u4e22\u5931\u4e86\u54ea\u4e2a\u62a5\u6587\uff0c\u8fd9\u6837\uff0c\u4e0d\u7b49\u5f85\u5b9a\u65f6\u5668\u7684\u89e6\u53d1\uff0c\u7acb\u523b\u91cd\u53d1\u4e22\u5931\u7684\u62a5\u6587\uff0c\u53ef\u4ee5\u8ba9\u53d1\u9001\u901f\u5ea6\u4e0b\u964d\u5f97\u6162\u4e00\u4e9b\uff0c\u8fd9\u5c31\u662f\u5feb\u901f\u91cd\u4f20\u7b97\u6cd5\u3002</p> <p>\u51fa\u73b0\u62e5\u585e\u540e\uff0c\u53d1\u9001\u65b9\u4f1a\u7f29\u5c0f\u62e5\u585e\u7a97\u53e3\uff0c\u518d\u8fdb\u5165\u524d\u9762\u63d0\u5230\u7684\u62e5\u585e\u907f\u514d\u9636\u6bb5\uff0c\u7528\u7ebf\u6027\u901f\u5ea6\u6162\u6162\u589e\u52a0\u62e5\u585e\u7a97\u53e3\u3002\u7136\u800c\uff0c\u4e3a\u4e86\u5e73\u6ed1\u5730\u964d\u4f4e\u901f\u5ea6\uff0c\u53d1\u9001\u65b9\u5e94\u5f53\u5148\u8fdb\u5165\u5feb\u901f\u6062\u590d\u9636\u6bb5\uff0c\u5728\u5931\u5e8f\u62a5\u6587\u5230\u8fbe\u63a5\u6536\u65b9\u540e\uff0c\u518d\u8fdb\u5165\u62e5\u585e\u907f\u514d\u9636\u6bb5\u3002</p> <p>\u6211\u4eec\u4e0d\u59a8\u628a\u7f51\u7edc\u770b\u6210\u4e00\u4e2a\u5bb9\u5668\uff08\u4e0a\u4e00\u8bb2\u4e2d\u8bf4\u8fc7\u5b83\u53ef\u4ee5\u5bb9\u7eb3 BDP \u5b57\u8282\u7684\u62a5\u6587\uff09\uff0c\u6bcf\u5f53\u63a5\u6536\u65b9\u4ece\u7f51\u7edc\u4e2d\u53d6\u51fa\u4e00\u4e2a\u62a5\u6587\uff0c\u53d1\u9001\u65b9\u5c31\u53ef\u4ee5\u589e\u52a0\u4e00\u4e2a\u62a5\u6587\u3002\u5f53\u53d1\u9001\u65b9\u63a5\u6536\u5230\u91cd\u590d ACK \u65f6\uff0c\u53ef\u4ee5\u63a8\u65ad\u6709\u5931\u5e8f\u62a5\u6587\u79bb\u5f00\u4e86\u7f51\u7edc\uff0c\u5230\u8fbe\u4e86\u63a5\u6536\u65b9\u7684\u7f13\u51b2\u533a\uff0c\u56e0\u6b64\u53ef\u4ee5\u518d\u591a\u53d1\u9001\u4e00\u4e2a\u62a5\u6587\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u6162\u542f\u52a8\u3001\u62e5\u585e\u907f\u514d\u3001\u5feb\u901f\u91cd\u4f20\u3001\u5feb\u901f\u6062\u590d\uff0c\u5171\u540c\u6784\u6210\u4e86\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u3002Linux \u4e0a\u63d0\u4f9b\u4e86\u66f4\u6539\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u7684\u914d\u7f6e\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 <code>tcp_available_congestion_control</code> \u914d\u7f6e\u67e5\u770b\u5185\u6838\u652f\u6301\u7684\u7b97\u6cd5\u5217\u8868\uff1a</p> <pre><code>net.ipv4.tcp_available_congestion_control = cubic reno\n</code></pre> <p>\u518d\u901a\u8fc7 <code>tcp_congestion_control</code> \u914d\u7f6e\u9009\u62e9\u4e00\u4e2a\u5177\u4f53\u7684\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\uff1a</p> <pre><code>net.ipv4.tcp_congestion_control = cubic\n</code></pre> <p>Linux 4.9 \u7248\u672c\u4e4b\u540e\u90fd\u652f\u6301 BBR \u7b97\u6cd5\uff0c\u5f00\u542f BBR \u7b97\u6cd5\u4ecd\u7136\u4f7f\u7528 <code>tcp_congestion_control</code> \u914d\u7f6e\uff1a</p> <pre><code>net.ipv4.tcp_congestion_control=bbr\n</code></pre>"},{"location":"chap2/6tcpcongestion/#3","title":"3\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u5f53 TCP \u8fde\u63a5\u5efa\u7acb\u6210\u529f\u540e\uff0c\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u5c31\u4f1a\u53d1\u751f\u4f5c\u7528\uff0c\u9996\u5148\u8fdb\u5165\u6162\u542f\u52a8\u9636\u6bb5\u3002\u51b3\u5b9a\u8fde\u63a5\u6b64\u65f6\u7f51\u901f\u7684\u662f\u521d\u59cb\u62e5\u585e\u7a97\u53e3\uff0cLinux \u4e0a\u53ef\u4ee5\u901a\u8fc7 route ip change \u547d\u4ee4\u4fee\u6539\u5b83\u3002\u901a\u5e38\uff0c\u5728\u5e26\u5bbd\u65f6\u5ef6\u79ef\u8f83\u5927\u7684\u7f51\u7edc\u4e2d\uff0c\u5e94\u5f53\u8c03\u9ad8\u521d\u59cb\u62e5\u585e\u7a97\u53e3\u3002</p> <p>\u4e22\u5305\u4ee5\u53ca\u91cd\u590d\u7684 ACK \u90fd\u662f\u660e\u786e\u7684\u62e5\u585e\u4fe1\u53f7\uff0c\u6b64\u65f6\uff0c\u53d1\u9001\u65b9\u5c31\u4f1a\u8c03\u4f4e\u62e5\u585e\u7a97\u53e3\u51cf\u901f\uff0c\u540c\u65f6\u4fee\u6b63\u6162\u542f\u52a8\u9608\u503c\u3002\u8fd9\u6837\uff0c\u5c06\u6765\u518d\u6b21\u5230\u8fbe\u8fd9\u4e2a\u901f\u5ea6\u65f6\uff0c\u5c31\u4f1a\u81ea\u52a8\u8fdb\u5165\u62e5\u585e\u907f\u514d\u9636\u6bb5\uff0c\u7528\u7ebf\u6027\u901f\u5ea6\u4ee3\u66ff\u6162\u542f\u52a8\u9636\u6bb5\u7684\u6307\u6570\u901f\u5ea6\u63d0\u5347\u7a97\u53e3\u5927\u5c0f\u3002</p> <p>\u5f53\u7136\uff0c\u91cd\u590d ACK \u610f\u5473\u7740\u53d1\u9001\u65b9\u53ef\u4ee5\u63d0\u524d\u91cd\u53d1\u4e22\u5931\u62a5\u6587\uff0c\u5feb\u901f\u91cd\u4f20\u7b97\u6cd5\u5b9a\u4e49\u4e86\u8fd9\u4e00\u884c\u4e3a\u3002\u540c\u65f6\uff0c\u4e3a\u4e86\u4f7f\u5f97\u91cd\u53d1\u62a5\u6587\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53d1\u9001\u901f\u5ea6\u4e0d\u81f3\u4e8e\u51fa\u73b0\u65ad\u5d16\u5f0f\u4e0b\u964d\uff0cTCP \u53c8\u5b9a\u4e49\u4e86\u5feb\u901f\u6062\u590d\u7b97\u6cd5\uff0c\u53d1\u9001\u65b9\u5728\u62a5\u6587\u91cd\u65b0\u53d8\u5f97\u6709\u5e8f\u540e\uff0c\u7ed3\u675f\u5feb\u901f\u6062\u590d\u8fdb\u5165\u62e5\u585e\u907f\u514d\u9636\u6bb5\u3002</p> <p>\u4f46\u4ee5\u4e22\u5305\u4f5c\u4e3a\u7f51\u7edc\u62e5\u585e\u7684\u4fe1\u53f7\u5f80\u5f80\u4e3a\u65f6\u5df2\u665a\uff0c\u4e8e\u662f\u4ee5 BBR \u7b97\u6cd5\u4e3a\u4ee3\u8868\u7684\u6d4b\u91cf\u578b\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u5e94\u8fd0\u800c\u751f\u3002\u5f53\u98de\u884c\u4e2d\u62a5\u6587\u6570\u91cf\u4e0d\u53d8\uff0c\u800c\u7f51\u7edc\u65f6\u5ef6\u5347\u9ad8\u65f6\uff0c\u5c31\u8bf4\u660e\u7f51\u7edc\u4e2d\u7684\u7f13\u51b2\u961f\u5217\u51fa\u73b0\u4e86\u79ef\u538b\uff0c\u8fd9\u662f\u8fdb\u884c\u62e5\u585e\u63a7\u5236\u7684\u6700\u597d\u65f6\u673a\u3002Linux \u9ad8\u7248\u672c\u652f\u6301 BBR \u7b97\u6cd5\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 <code>tcp_congestion_control</code> \u914d\u7f6e\u66f4\u6539\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u3002</p>"},{"location":"chap3/10DB_choice/","title":"\u7b2c\u5341\u8282 \u6743\u8861\u5173\u7cfb\u6570\u636e\u5e93\u4e0eNoSQL\u6570\u636e\u5e93","text":"<p>\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u4f1a\u540c\u65f6\u4f7f\u7528\u591a\u79cd\u6570\u636e\u5e93\u3002</p> <p>\u6bd4\u5982\uff0c\u4f60\u53ef\u80fd\u4f1a\u5728 Redis \u4e2d\u5b58\u653e\u7528\u6237 Session \u4f1a\u8bdd\uff0c\u5c06\u4e1a\u52a1\u6570\u636e\u62c6\u89e3\u4e3a\u7531\u884c\u3001\u5217\u6784\u6210\u7684\u4e8c\u7ef4\u8868\u5b58\u50a8\u5728 MySQL \u4e2d\uff0c\u5c06\u9700\u8981\u5168\u6587\u68c0\u7d22\u7684\u6570\u636e\u653e\u5728 ElasticSearch \u4e2d\uff0c\u5c06\u77e5\u8bc6\u56fe\u8c31\u653e\u5728 Neo4j \u56fe\u6570\u636e\u5e93\u4e2d\uff0c\u5c06\u6570\u636e\u91cf\u3001\u8bbf\u95ee\u91cf\u5f88\u5927\u7684\u6570\u636e\u653e\u5728 Cassandra \u5217\u5f0f\u6570\u636e\u5e93\u6216\u8005 MongoDB \u6587\u6863\u578b\u6570\u636e\u5e93\u4e2d\uff0c\u7b49\u7b49\u3002</p> <p>\u9009\u62e9\u6570\u636e\u5e93\u65f6\uff0c\u6211\u4eec\u7684\u4f9d\u636e\u53ef\u80fd\u662f\u8bbf\u95ee\u901f\u5ea6\uff0c\u6bd4\u5982\u57fa\u4e8e\u54c8\u5e0c\u8868\u7684 Redis \u67e5\u8be2\u590d\u6742\u5ea6\u53ea\u6709 O(1)\uff0c\u4e5f\u53ef\u80fd\u4ece\u4e8b\u52a1\u7684\u652f\u6301\u7a0b\u5ea6\u4e0a\u9009\u62e9\u4e86\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u751a\u81f3\u4ece\u5e94\u7528\u5c42\u7684\u5f00\u53d1\u6548\u7387\u4e0a\u8fd8\u7ed9\u5b83\u6dfb\u52a0\u4e86 Hibernate \u7b49 ORM \u6846\u67b6\uff0c\u4e5f\u53ef\u80fd\u4ece\u5904\u7406\u6570\u636e\u7684\u4f53\u91cf\u4e0a\u9009\u62e9\u4e86 NoSQL \u6570\u636e\u5e93\u3002</p> <p>\u53ef\u662f\uff0c\u9664\u4e86\u5404\u79cd\u5b9e\u73b0\u5c42\u9762\u4e0a\u7684\u5dee\u5f02\u5916\uff0c\u5404\u7c7b NoSQL \u4e0e\u5173\u7cfb\u6570\u636e\u5e93\u4e4b\u95f4\uff0c\u6709\u6ca1\u6709\u6700\u672c\u8d28\u7684\u533a\u522b\uff1f</p>"},{"location":"chap3/10DB_choice/#1","title":"1\u3001\u5173\u7cfb\u6570\u636e\u5e93\u7684\u4f18\u70b9","text":"<p>\u5173\u7cfb\u6570\u636e\u5e93\u5bf9\u4e1a\u52a1\u5c42\u5f00\u53d1\u6548\u7387\u7684\u63d0\u5347\u6709\u5f88\u5927\u5e2e\u52a9\u3002</p> <p>\u4e0b\u9762\u5148\u57fa\u4e8e\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u770b\u770b\u5173\u7cfb\u6570\u636e\u5e93\u6709\u4f55\u4f18\u70b9\u3002\u75ab\u60c5\u671f\u95f4\u65b0\u589e\u4e86\u4e00\u6279\u80fd\u591f\u6d4b\u91cf\u4f53\u6e29\u7684\u8003\u52e4\u673a\uff0c\u901a\u8fc7\u5173\u7cfb\u6570\u636e\u5e93\u6211\u4eec\u65b0\u5efa\u4e86\u7528\u6237\u3001\u8003\u52e4\u673a\u3001\u8003\u52e4\u8bb0\u5f55\u4e09\u5f20\u8868</p> <p></p> <p>\u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\uff0c\u8868\u4e2d\u7684\u6bcf\u884c\u6570\u636e\u7531\u591a\u4e2a\u4ece\u5c5e\u4e8e\u5217\u7684\u5355\u4e00\u503c\uff08\u6bd4\u5982\u6570\u5b57\u3001\u5b57\u7b26\u4e32\uff09\u6784\u6210\u3002\u867d\u7136\u8868\u4e2d\u53ef\u4ee5\u5b58\u653e\u4efb\u610f\u884c\u6570\u636e\uff0c\u4f46\u5217\u5374\u662f\u9884\u5148\u5b9a\u4e49\u4e14\u4e0d\u53d8\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u5f88\u5bb9\u6613\u901a\u8fc7\u884c\u3001\u5217\u4ea4\u6c47\u5904\u7684\u5355\u4e00\u503c\u8fdb\u884c\u5173\u8054\u64cd\u4f5c\uff0c</p> <p>\u8fdb\u800c\u5b8c\u6210\u5404\u7c7b\u4e1a\u52a1\u76ee\u7684\u4e0d\u540c\u7684\u67e5\u8be2\u3002\u6bd4\u5982\uff0c\u4e1a\u52a1\u5f00\u53d1\u8005\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u8fd9\u884c SQL \u8bed\u53e5\uff0c\u627e\u5230\u4f53\u6e29\u8d85\u8fc7 37 \u5ea6\u7684\u5458\u5de5\uff0c\u4e0a\u62a5\u5176\u59d3\u540d\u3001\u6d4b\u91cf\u65f6\u95f4\u4ee5\u53ca\u6240\u5728\u5730\u7406\u4f4d\u7f6e\uff1a</p> <pre><code>select user.name, record.time, machine.location from user, record, machine where user.id = record.user_id and machine.id = record.machine_id and record.temporature &gt; 37;\n</code></pre> <p>\u8fd0\u8425\u4eba\u5458\u5219\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u8fd9\u884c SQL \u8bed\u53e5\uff0c\u627e\u51fa\u5404\u7c7b\u8003\u52e4\u673a\u7684\u4f7f\u7528\u9891\u7387\uff1a</p> <pre><code>select count(*), machine.id from machine, record where machine.id = record.machine_id group py machine.id;\n</code></pre> <p>\u56e0\u6b64\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u53ef\u4ee5\u901a\u8fc7\u9884\u5b9a\u4e49\u7684\u5173\u7cfb\uff0c\u7531\u6570\u636e\u5e93\u81ea\u8eab\u5b8c\u6210\u590d\u6742\u7684\u903b\u8f91\u8ba1\u7b97\uff0c\u4e3a\u4e0d\u540c\u7684\u573a\u666f\u63d0\u4f9b\u6570\u636e\u670d\u52a1\u3002\u7531\u4e8e\u4e0d\u540c\u7684\u6570\u636e\u95f4\u5177\u6709\u4e86\u5173\u7cfb\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u8fd8\u63d0\u4f9b\u4e86\u201cTransaction \u4e8b\u52a1\u201d\uff0c\u7528\u4e8e\u4fdd\u8bc1\u76f8\u5173\u6570\u636e\u95f4\u7684\u4e00\u81f4\u6027\uff0c\u8fd9\u5927\u5927\u91ca\u653e\u4e86\u5e94\u7528\u5f00\u53d1\u8005\u7684\u751f\u4ea7\u529b\u3002\u6240\u8c13\u201c\u4e8b\u52a1\u201d\uff0c\u4f1a\u540c\u65f6\u5177\u6709 ACID4 \u4e2a\u7279\u6027\uff1a</p> <ul> <li>Atomicity \u539f\u5b50\u6027\uff0c\u6307\u591a\u4e2a SQL \u8bed\u53e5\u7ec4\u6210\u4e86\u4e00\u4e2a\u903b\u8f91\u5355\u4f4d\uff0c\u6267\u884c\u65f6\u8981\u4e48\u5168\u90e8\u6210\u529f\uff0c\u8981\u4e48\u5168\u90e8\u5931\u8d25\u3002</li> <li>Consistency \u4e00\u81f4\u6027\uff0c\u6307\u6570\u636e\u5e93\u53ea\u80fd\u4ece\u4e00\u4e2a\u4e00\u81f4\u6027\u72b6\u6001\u8f6c\u6362\u5230\u53e6\u4e00\u4e2a\u4e00\u81f4\u6027\u72b6\u6001\u3002\u5373\u4f7f\u6570\u636e\u5e93\u53d1\u751f\u4e86\u91cd\u542f\uff0c\u4ecd\u7136\u5f97\u7ef4\u6301\u4e00\u81f4\u6027\u3002</li> <li>Isolation \u9694\u79bb\u6027\uff0c\u7531\u4e8e\u6570\u636e\u5e93\u53ef\u4ee5\u652f\u6301\u591a\u4e2a\u8fde\u63a5\u5e76\u53d1\u64cd\u4f5c\uff0c\u56e0\u6b64\u5e76\u53d1\u7684\u4e8b\u52a1\u95f4\u5fc5\u987b\u4e92\u76f8\u9694\u79bb\u624d\u6709\u610f\u4e49\u3002SQL \u6807\u51c6\u5b9a\u4e49\u4e86\u4ee5\u4e0b 4 \u79cd\u9694\u79bb\u7ea7\u522b\uff1a<ul> <li>READ UNCOMMITTED \u672a\u63d0\u4ea4\u8bfb\uff0c\u5b83\u8868\u793a\u5728\u4e8b\u52a1 A \u8fd8\u672a\u63d0\u4ea4\u65f6\uff0c\u5e76\u53d1\u6267\u884c\u7684\u4e8b\u52a1 B \u5df2\u7ecf\u53ef\u4ee5\u770b\u5230\u4e8b\u52a1 A \u6539\u53d8\u7684\u6570\u636e\u3002\u8fd9\u79cd\u9694\u79bb\u7ea7\u522b\u4f1a\u5e26\u6765\u5f88\u591a\u95ee\u9898\uff0c\u56e0\u6b64\u5f88\u5c11\u4f7f\u7528\u3002</li> <li>READ COMMITTED \u63d0\u4ea4\u8bfb\uff0c\u5b83\u8868\u793a\u5f53\u4e8b\u52a1 A \u672a\u63d0\u4ea4\u65f6\uff0c\u4e8b\u52a1 B \u770b\u4e0d\u5230\u4e8b\u52a1 A \u6539\u53d8\u7684\u4efb\u4f55\u6570\u636e\uff0c\u8fd9\u662f PostgreSQL \u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\u3002</li> <li>REPEATABLE READ \u53ef\u91cd\u590d\u8bfb\uff0c\u6307\u5728 READ COMMITTED \u7684\u57fa\u7840\u4e0a\u89e3\u51b3\u4e86\u810f\u8bfb\u95ee\u9898\u3002\u6240\u8c13\u810f\u8bfb\uff0c\u662f\u6307\u5728\u4e00\u4e2a\u4e8b\u52a1\u5185\uff0c\u591a\u6b21\u8bfb\u53d6\u5230\u540c\u4e00\u6570\u636e\u65f6\uff0c\u7ed3\u679c\u53ef\u80fd\u4e0d\u4e00\u81f4\u3002\u8fd9\u662f MySQL \u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\u3002</li> <li>SERIALIZABLE \u53ef\u4e32\u884c\u5316\uff0c\u5b83\u901a\u8fc7\u5bf9\u6bcf\u4e00\u884c\u6570\u636e\u52a0\u9501\uff0c\u4f7f\u5f97\u6240\u6709\u4e8b\u52a1\u4e32\u884c\u6267\u884c\uff0c\u867d\u7136\u9694\u79bb\u6027\u6700\u597d\uff0c\u4f46\u4e5f\u5927\u5927\u964d\u4f4e\u4e86\u6570\u636e\u5e93\u7684\u5e76\u53d1\u6027\uff0c\u6240\u4ee5\u5f88\u5c11\u4f7f\u7528\u3002</li> </ul> </li> </ul> <p>Durability \u6301\u4e45\u6027\uff0c\u6307\u4e00\u65e6\u4e8b\u52a1\u63d0\u4ea4\uff0c\u4e8b\u52a1\u6240\u505a\u7684\u4fee\u6539\u5fc5\u987b\u6c38\u4e45\u6027\u5730\u4fdd\u5b58\u5230\u6570\u636e\u5e93\u4e2d\u3002</p> <ul> <li>\u65e0\u8bba\u662f\u5546\u4e1a\u7248\u7684 Oracle\uff0c\u8fd8\u662f\u5f00\u6e90\u7684 MySQL\u3001PostgreSQL\uff0c\u53ea\u8981\u662f\u5173\u7cfb\u6570\u636e\u5e93\u5c31\u62e5\u6709\u540c\u6837\u7684\u6570\u636e\u6a21\u578b\uff0c\u56e0\u6b64\u5b83\u4eec\u53ef\u4ee5\u901a\u8fc7SQL \u8bed\u8a00\u4e3a\u5e94\u7528\u5c42\u63d0\u4f9b\u6807\u51c6\u5316\u3001\u51e0\u4e4e\u6ca1\u6709\u5dee\u5f02\u7684\u8bbf\u95ee\u63a5\u53e3\uff1b</li> <li>\u751f\u4ea7\u7ea7\u7684\u6570\u636e\u5e93\u5bf9\u6301\u4e45\u5316\u90fd\u6709\u826f\u597d\u7684\u652f\u6301\uff0c\u5168\u9762\u7684\u51b7\u5907\u3001\u70ed\u5907\u65b9\u6848\u63d0\u4f9b\u4e86\u5f88\u9ad8\u7684\u53ef\u7528\u6027\uff1b</li> <li>\u901a\u8fc7\u7d22\u5f15\u3001\u7f13\u5b58\u7b49\u7279\u6027\uff0c\u5f53\u884c\u6570\u5728\u4ebf\u7ea7\u4ee5\u4e0b\u65f6\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u7684\u6027\u80fd\u5e76\u4e0d\u4f4e\uff1b\u5173</li> <li>\u7cfb\u6570\u636e\u5e93\u652f\u6301\u8fd8\u4e0d\u9519\u7684\u5e76\u53d1\u5ea6\uff0c\u4e00\u822c\u53ef\u4ee5\u670d\u52a1\u4e8e\u4e0a\u5343\u4e2a\u5e76\u53d1\u8fde\u63a5\u3002</li> </ul>"},{"location":"chap3/10DB_choice/#2","title":"2\u3001\u5173\u7cfb\u6570\u636e\u5e93\u7684\u95ee\u9898","text":"<p>\u867d\u7136\u57fa\u4e8e\u5355\u4e00\u503c\u7684\u5173\u7cfb\u6620\u5c04\u63d0\u4f9b\u4e86\u4e8b\u52a1\u7b49\u8bb8\u591a\u529f\u80fd\uff0c\u4f46\u540c\u65f6\u4e5f\u5f15\u5165\u4e86 3 \u4e2a\u95ee\u9898\u3002</p> <p>\u9996\u5148\uff0c\u5185\u5b58\u4e2d\u7684\u6570\u636e\u7ed3\u6784\u975e\u5e38\u591a\u6837\uff0c\u96be\u4ee5\u76f4\u63a5\u6620\u5c04\u5230\u884c\u5217\u4ea4\u6c47\u5904\u7684\u5355\u4e00\u503c\u4e0a\u3002\u4e0d\u8fc7\uff0c\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u901a\u8fc7ORM\uff08Object-relational mapping\uff09\u6846\u67b6\u89e3\u51b3\u3002\u6bd4\u5982\uff0cPython \u4e2d\u7684 Django ORM \u6846\u67b6\uff0c\u53ef\u4ee5\u5c06\u4e0a\u8ff0 3 \u5f20\u8868\u6620\u5c04\u4e3a\u5185\u5b58\u4e2d\u7684 3 \u4e2a\u7c7b\uff1a</p> <pre><code>from django.db import models\n\nclass User(models.Model):\n    name = models.CharField(max_length=20)\n\nclass Machine(models.Model):\n    location = models.CharField(max_length=100)\n\nclass Record(models.Model):\n    time = models.DateTimeField()\n    temporature = models.FloatField()\n    user = models.ForeignKey(User)\n    machine= models.ForeignKey(Machine)\n</code></pre> <p>ORM \u6846\u67b6\u4f1a\u4e3a\u6bcf\u5f20\u8868\u751f\u6210 id \u5b57\u6bb5\uff0c\u800c Record \u8868\u5c06 User \u548c Machine \u8868\u4e2d\u7684 id \u5b57\u6bb5\u4f5c\u4e3a\u5916\u952e\uff08ForeignKey\uff09\u4e92\u76f8\u5173\u8054\u5728\u4e00\u8d77\u3002</p> <p>\u4e8e\u662f\uff0c\u8fd9 3 \u4e2a\u7c7b\u5c31\u6620\u5c04\u4e86\u6570\u636e\u5e93\u4e2d\u7684\u90a3 3 \u5f20\u8868\uff0c\u800c\u5185\u5b58\u4e2d\u7684\u5bf9\u8c61\uff08\u5373\u7c7b\u7684\u5b9e\u4f8b\uff09\u5219\u6620\u5c04\u4e3a\u6bcf\u5f20\u8868\u4e2d\u7684\u4e00\u884c\u6570\u636e\u3002\u5728 ORM \u6846\u67b6\u4e0b\uff0c\u627e\u5230\u4f53\u6e29\u5927\u4e8e 37 \u5ea6\u5458\u5de5\u7684\u90a3\u4e32\u957f SQL\uff0c\u53ef\u4ee5\u8f6c\u5316\u4e3a OOP \u4e2d\u7684\u51fd\u6570\u8c03\u7528\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>#gte\u8868\u793a\u5927\u4e8e\u7b49\u4e8e\nrecords = Record.objects.filter(temporature__gte = 37)\nfor r in records:\n  print(r.user.name, r.machine.location, r.time)\n</code></pre> <p>\u76f8\u6bd4\u8d77 SQL \u8bed\u53e5\uff0c\u6620\u5c04\u540e\u7684 OO \u7f16\u7a0b\u8981\u7b80\u5355\u8bb8\u591a\u3002</p> <p>\u5176\u6b21\uff0c\u4e3a\u4e86\u5b9e\u73b0\u5173\u7cfb\u6620\u5c04\uff0c\u6bcf\u5f20\u8868\u4e2d\u7684\u5b57\u6bb5\u90fd\u5f97\u9884\u5148\u5b9a\u4e49\u597d\uff0c\u4e00\u65e6\u5728\u4ea7\u54c1\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u6570\u636e\u6a21\u578b\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u4fbf\u9700\u8981\u540c\u6b65\u5b8c\u6210\u4ee5\u4e0b 3 \u4ef6\u4e8b\uff1a</p> <ul> <li>\u4fee\u6539\u8868\u7ed3\u6784\uff1b</li> <li>\u4fee\u6539\u5e94\u7528\u5c42\u64cd\u4f5c\u6570\u636e\u7684\u4ee3\u7801\uff1b</li> <li>\u6839\u636e\u65b0\u7684\u89c4\u5219\u8f6c\u6362\u3001\u8fc1\u79fb\u5df2\u6709\u6570\u636e\u3002</li> </ul> <p>\u6700\u540e\u662f\u5173\u7cfb\u6570\u636e\u5e93\u56fa\u6709\u7684\u53ef\u4f38\u7f29\u6027\u95ee\u9898\uff0c\u8fd9\u662f\u5404\u7c7b NoSQL \u6570\u636e\u5e93\u4e0d\u65ad\u8bde\u751f\u7684\u4e3b\u8981\u539f\u56e0\u3002\u4ecb\u7ecd\u8fc7\u6cbf AKF X \u8f74\u6269\u5c55\u7684\u590d\u5236\u578b\u4e3b\u4ece\u7ed3\u6784\uff0c\u7136\u800c\u5355\u70b9\u4e3b\u5e93\u65e0\u6cd5\u89e3\u51b3\u6570\u636e\u6301\u7eed\u589e\u957f\u5f15\u5165\u7684\u6027\u80fd\u95ee\u9898\u3002</p> <p></p> <p>\u6cbf AKF Z \u8f74\u6269\u5c55\u6570\u636e\u5e93\u867d\u7136\u80fd\u591f\u964d\u4f4e\u6570\u636e\u89c4\u6a21\uff0c\u4f46\u5206\u5e93\u5206\u8868\u540e\uff0c\u5355\u4e00\u503c\u5173\u7cfb\u5f15\u7533\u51fa\u7684 ACID \u4e8b\u52a1\u4e0d\u80fd\u57fa\u4e8e\u9ad8\u65f6\u5ef6\u3001\u4f1a\u6296\u52a8\u7684\u7f51\u7edc\u4f20\u8f93\u5f3a\u884c\u5b9e\u73b0\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u6027\u80fd\u5927\u5e45\u4e0b\u964d\uff0c\u8fd9\u6837\u7684\u53ef\u7528\u6027\u662f\u5206\u5e03\u5f0f\u7cfb\u7edf\u65e0\u6cd5\u63a5\u53d7\u7684\u3002</p> <p></p> <p>\u56e0\u6b64\uff0c\u5728\u5355\u673a\u4e0a\u8bbe\u8ba1\u51fa\u7684\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u96be\u4ee5\u5904\u7406 PB \u7ea7\u7684\u5927\u6570\u636e\u3002\u800c NoSQL \u6570\u636e\u5e93\u653e\u5f03\u4e86\u5355\u4e00\u503c\u6570\u636e\u6a21\u578b\uff0c\u975e\u5e38\u9002\u5408\u90e8\u7f72\u5728\u6210\u5343\u4e0a\u4e07\u4e2a\u8282\u70b9\u7684\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u3002</p>"},{"location":"chap3/10DB_choice/#3nosql","title":"3\u3001NoSQL \u6570\u636e\u5e93\u662f\u5982\u4f55\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u7684\uff1f","text":"<p>NoSQL \u6570\u636e\u5e93\u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0b 4 \u7c7b\uff1a</p> <ul> <li>Key/Value \u6570\u636e\u5e93\uff0c\u901a\u5e38\u57fa\u4e8e\u54c8\u5e0c\u8868\u5b9e\u73b0\uff0c\u6027\u80fd\u975e\u5e38\u597d\u3002\u5176\u4e2d Value \u7684\u7c7b\u578b\u901a\u5e38\u7531\u5e94\u7528\u5c42\u4ee3\u7801\u51b3\u5b9a\uff0c\u5f53\u7136\uff0cRedis \u8fd9\u6837\u7684 Key/Value \u6570\u636e\u5e93\u8fd8\u53ef\u4ee5\u5c06 Value \u5b9a\u4e49\u4e3a\u5217\u8868\u3001\u54c8\u5e0c\u7b49\u590d\u5408\u7ed3\u6784\u3002</li> <li>\u6587\u6863\u578b\u6570\u636e\u5e93\uff0c\u5728 Key/Value \u6570\u636e\u5e93\u4e2d\uff0c\u7531\u4e8e\u6ca1\u6709\u9884\u5b9a\u4e49\u7684\u503c\u7ed3\u6784\uff0c\u6240\u4ee5\u53ea\u80fd\u9488\u5bf9 Key \u6267\u884c\u67e5\u8be2\uff0c\u8fd9\u5927\u5927\u9650\u5236\u4e86\u4f7f\u7528\u573a\u666f\u3002\u6587\u6863\u578b\u6570\u636e\u5e93\u5c06 Value \u6269\u5c55\u4e3a XML\u3001JSON\uff08\u6bd4\u5982 MongoDB\uff09\u7b49\u6570\u636e\u7ed3\u6784\uff0c\u4e8e\u662f\u5141\u8bb8\u4f7f\u7528\u8005\u5728\u6587\u6863\u578b\u6570\u636e\u5e93\u7684\u5185\u90e8\u89e3\u6790\u590d\u5408\u578b\u7684 Value \u7ed3\u6784\uff0c\u518d\u901a\u8fc7\u5176\u4e2d\u7684\u5355\u4e00\u503c\u8fdb\u884c\u67e5\u8be2\uff0c\u8fd9\u5c31\u517c\u5177\u4e86\u90e8\u5206\u5173\u7cfb\u6570\u636e\u5e93\u7684\u529f\u80fd\u3002</li> <li>\u5217\u5f0f\u6570\u636e\u5e93\uff0c\u4ecb\u7ecd\u8fc7\u7684 Cassandra\u3002\u5217\u5f0f\u6570\u636e\u5e93\u57fa\u4e8e Key \u6765\u6620\u5c04\u884c\uff0c\u518d\u901a\u8fc7\u5217\u540d\u8fdb\u884c\u4e8c\u7ea7\u6620\u5c04\uff0c\u540c\u65f6\u5b83\u57fa\u4e8e\u5217\u6765\u5b89\u6392\u5b58\u50a8\u7684\u62d3\u6251\u7ed3\u6784\uff0c\u8fd9\u6837\u5f53\u4ec5\u8bfb\u5199\u5927\u91cf\u884c\u4e2d\u67d0\u4e2a\u5217\u65f6\uff0c\u64cd\u4f5c\u7684\u6570\u636e\u8282\u70b9\u3001\u78c1\u76d8\u975e\u5e38\u96c6\u4e2d\uff0c\u78c1\u76d8 IO\u3001\u7f51\u7edc IO \u90fd\u4f1a\u5c11\u5f88\u591a\u3002\u5217\u5f0f\u6570\u636e\u5e93\u7684\u5e94\u7528\u573a\u666f\u975e\u5e38\u6709\u9488\u5bf9\u6027\uff0c\u6bd4\u5982\u535a\u5ba2\u6587\u7ae0\u6807\u7b7e\u7684\u884c\u6570\u5f88\u591a\uff0c\u4f46\u5728\u505a\u6570\u636e\u5206\u6790\u65f6\u5f80\u5f80\u53ea\u8bfb\u53d6\u6807\u7b7e\u5217\uff0c\u8fd9\u5c31\u5f88\u9002\u5408\u4f7f\u7528\u5217\u5f0f\u6570\u636e\u5e93\u3002\u518d\u6bd4\u5982\uff0c\u901a\u8fc7\u5012\u6392\u7d22\u5f15\u5b9e\u73b0\u4e86\u5168\u6587\u68c0\u7d22\u7684 ElasticSearch\uff0c\u5c31\u9002\u5408\u4f7f\u7528\u5217\u5f0f\u5b58\u50a8\u5b58\u653e Doc Values\uff0c\u8fd9\u6837\u505a\u6392\u5e8f\u3001\u805a\u5408\u65f6\u975e\u5e38\u9ad8\u6548\u3002</li> <li>\u56fe\u6570\u636e\u5e93\uff0c\u5728\u793e\u4ea4\u5173\u7cfb\u3001\u77e5\u8bc6\u56fe\u8c31\u7b49\u573a\u666f\u4e2d\uff0c\u643a\u5e26\u5404\u79cd\u5c5e\u6027\u7684\u8fb9\u53ef\u4ee5\u8868\u793a\u8282\u70b9\u95f4\u7684\u5173\u7cfb\uff0c\u7531\u4e8e\u8282\u70b9\u7684\u5173\u7cfb\u6570\u91cf\u591a\uff0c\u800c\u4e14\u975e\u5e38\u5bb9\u6613\u53d8\u5316\uff0c\u6240\u4ee5\u5173\u7cfb\u6570\u636e\u5e93\u7684\u5b9e\u73b0\u6210\u672c\u5f88\u9ad8\uff0c\u800c\u56fe\u6570\u636e\u5e93\u65e2\u6ca1\u6709\u56fa\u5b9a\u7684\u6570\u636e\u6a21\u578b\uff0c\u904d\u5386\u5173\u7cfb\u7684\u901f\u5ea6\u4e5f\u975e\u5e38\u5feb\uff0c\u5f88\u9002\u5408\u5904\u7406\u8fd9\u7c7b\u95ee\u9898\u3002\u5f53\u7136\uff0c\u6211\u4eec\u65e5\u5e38\u89c1\u5230\u7684\u4e3b\u8981\u662f\u524d 3 \u7c7b NoSQL \u6570\u636e\u5e93\u3002</li> </ul> <p>\u76f8\u5bf9\u4e8e\u5173\u7cfb\u6570\u636e\u5e93\uff0cNoSQL \u5728\u6027\u80fd\u548c\u6613\u7528\u6027\u4e0a\u90fd\u6709\u660e\u663e\u7684\u4f18\u70b9\u3002</p> <ul> <li>NoSQL \u6570\u636e\u5e93\u7684\u53ef\u4f38\u7f29\u6027\u90fd\u975e\u5e38\u597d\u3002\u867d\u7136\u8bb8\u591a\u6587\u6863\u578b\u3001\u5217\u5f0f\u6570\u636e\u5e93\u90fd\u63d0\u4f9b\u4e86\u7c7b SQL \u8bed\u8a00\u63a5\u53e3\uff0c\u4f46\u8fd9\u53ea\u662f\u4e3a\u4e86\u964d\u4f4e\u7528\u6237\u7684\u5b66\u4e60\u6210\u672c\uff0c\u5b83\u4eec\u5bf9\u8de8\u8282\u70b9\u4e8b\u52a1\u7684\u652f\u6301\u6781\u5176\u6709\u9650\u3002\u56e0\u6b64\uff0c\u8fd9\u4e9b NoSQL \u6570\u636e\u5e93\u53ef\u4ee5\u653e\u5f00\u624b\u811a\uff0c\u57fa\u4e8e Key/Value \u6a21\u578b\u6cbf AKF Z \u8f74\u5c06\u7cfb\u7edf\u6269\u5c55\u5230\u4e0a\u4e07\u4e2a\u8282\u70b9\u3002</li> <li>\u5728\u6570\u636e\u57fa\u4e8e Key \u5206\u7247\u540e\uff0c\u5f88\u5bb9\u6613\u901a\u8fc7\u4ecb\u7ecd\u8fc7\u7684 MapReduce \u601d\u60f3\uff0c\u63d0\u9ad8\u7cfb\u7edf\u7684\u8ba1\u7b97\u80fd\u529b\u3002\u6bd4\u5982\uff0cMongoDB \u5f88\u81ea\u7136\u7684\u5c31\u5728\u67e5\u8be2\u63a5\u53e3\u4e2d\uff0c\u63d0\u4f9b\u4e86MapReduce \u51fd\u6570\u3002</li> <li>\u901a\u8fc7\u5197\u4f59\u5907\u4efd\uff0cNoSQL \u53ef\u4ee5\u63d0\u4f9b\u4f18\u79c0\u7684\u5bb9\u707e\u80fd\u529b\u3002\u6bd4\u5982\uff0cRedis\u3001Cassandra \u7b49\u6570\u636e\u5e93\uff0c\u90fd\u53ef\u4ee5\u57fa\u4e8e\u4ecb\u7ecd\u8fc7\u7684 NWR \u7b97\u6cd5\uff0c\u7075\u6d3b\u5730\u8c03\u6574 CAP \u6743\u91cd\u3002</li> <li>\u5982\u679c\u6bcf\u4e2a Key \u4e2d Value \u5b58\u653e\u7684\u590d\u5408\u6570\u636e\u5df2\u7ecf\u80fd\u6ee1\u8db3\u5168\u90e8\u4e1a\u52a1\u9700\u6c42\uff0c\u90a3\u4e48 NoSQL \u7684\u5355\u673a\u67e5\u8be2\u901f\u5ea6\u4e5f\u4f1a\u4f18\u4e8e\u5173\u7cfb\u6570\u636e\u5e93\u3002</li> </ul> <p>\u5176\u6b21\u518d\u6765\u770b\u6613\u7528\u6027\uff0c\u8fd9\u4e3b\u8981\u4f53\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u4f4e\u6210\u672c\u5730\u53d8\u66f4 Value \u7ed3\u6784\u3002\u867d\u7136 NoSQL \u6570\u636e\u5e93\u652f\u6301\u590d\u5408\u578b Value \u7ed3\u6784\uff0c\u4f46\u5e76\u4e0d\u9650\u5b9a\u7ed3\u6784\u7c7b\u578b\u3002</p> <p>\u6bd4\u5982\uff0c\u6587\u6863\u578b\u6570\u636e\u5e93\u4e2d\uff0c\u540c\u4e00\u4e2a\u8868\u4e2d\u7684\u4e24\u884c\u6570\u636e\uff0c\u5176\u503c\u53ef\u4ee5\u662f\u5b8c\u5168\u4e0d\u540c\u7684 JSON \u7ed3\u6784\uff1b\u540c\u6837\u7684\uff0c\u5217\u5f0f\u6570\u636e\u5e93\u4e2d\u4e24\u884c\u6570\u636e\u4e5f\u53ef\u4ee5\u62e5\u6709\u4e0d\u540c\u7684\u5217\u6570\u3002\u56e0\u6b64\uff0c\u5f53\u6570\u636e\u7ed3\u6784\u6539\u53d8\u65f6\uff0c\u53ea\u9700\u8981\u4fee\u6539\u5e94\u7528\u5c42\u64cd\u4f5c\u6570\u636e\u7684\u4ee3\u7801\uff0c\u5e76\u4e0d\u9700\u8981\u50cf\u5173\u7cfb\u6570\u636e\u5e93\u90a3\u6837\u540c\u65f6\u4fee\u6539\u8868\u7ed3\u6784\u4ee5\u53ca\u8fc1\u79fb\u6570\u636e\u3002</p>"},{"location":"chap3/10DB_choice/#4","title":"4\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u5173\u7cfb\u6570\u636e\u5e93\u901a\u8fc7\u884c\u3001\u5217\u4ea4\u6c47\u5904\u7684\u5355\u4e00\u503c\uff0c\u5b9e\u73b0\u4e86\u591a\u79cd\u6570\u636e\u95f4\u7684\u5173\u8054\u3002\u901a\u8fc7\u7edf\u4e00\u7684 SQL \u63a5\u53e3\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u6570\u636e\u5e93\u4e2d\u5b9e\u73b0\u590d\u6742\u7684\u8ba1\u7b97\u4efb\u52a1\u3002\u4e3a\u4e86\u7ef4\u6301\u5173\u8054\u6570\u636e\u95f4\u7684\u4e00\u81f4\u6027\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u63d0\u4f9b\u4e86\u62e5\u6709 ACID \u7279\u6027\u7684\u4e8b\u52a1\uff0c\u63d0\u5347\u4e86\u5e94\u7528\u5c42\u7684\u5f00\u53d1\u6548\u7387\u3002</p> <p>\u867d\u7136\u5355\u4e00\u503c\u65e0\u6cd5\u6620\u5c04\u5185\u5b58\u4e2d\u7684\u590d\u5408\u6570\u636e\u7ed3\u6784\uff0c\u4f46\u901a\u8fc7 ORM \u6846\u67b6\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u53ef\u4ee5\u5c06\u8868\u6620\u5c04\u4e3a\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u4e2d\u7684\u7c7b\uff0c\u5c06\u6bcf\u884c\u6570\u636e\u6620\u5c04\u4e3a\u5bf9\u8c61\uff0c\u7ee7\u7eed\u964d\u4f4e\u5f00\u53d1\u6210\u672c\u3002\u7136\u800c\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u662f\u4e3a\u5355\u673a\u8bbe\u8ba1\u7684\uff0c\u4e00\u65e6\u5c06\u4e8b\u52a1\u5ef6\u4f38\u5230\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u6267\u884c\u6210\u672c\u5c31\u4f1a\u9ad8\u5230\u5f71\u54cd\u57fa\u672c\u7684\u53ef\u7528\u6027\u3002\u56e0\u6b64\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u7684\u53ef\u4f38\u7f29\u6027\u662f\u5f88\u5dee\u7684\u3002</p> <p>NoSQL \u6570\u636e\u5e93\u57fa\u4e8e Key/Value \u6570\u636e\u6a21\u578b\uff0c\u53ef\u4ee5\u63d0\u4f9b\u51e0\u4e4e\u65e0\u9650\u7684\u53ef\u4f38\u7f29\u6027\u3002</p> <p>\u540c\u65f6\uff0c\u5c06 Value \u503c\u8fdb\u4e00\u6b65\u8bbe\u8ba1\u4e3a\u590d\u5408\u7ed3\u6784\u540e\uff0c\u65e2\u53ef\u4ee5\u589e\u52a0\u67e5\u8be2\u65b9\u5f0f\u7684\u591a\u6837\u6027\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 MapReduce \u63d0\u5347\u7cfb\u7edf\u7684\u8ba1\u7b97\u80fd\u529b\u3002\u5b9e\u9645\u4e0a\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u4e0e\u6bcf\u4e00\u7c7b NoSQL \u6570\u636e\u5e93\u90fd\u6709\u660e\u663e\u7684\u4f18\u7f3a\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u6570\u636e\u6a21\u578b\u3001\u8bbf\u95ee\u65b9\u5f0f\u3001\u6570\u636e\u5bb9\u91cf\u4e0a\u89c2\u5bdf\u5b83\u4eec\uff0c\u7ed3\u5408\u5177\u4f53\u7684\u5e94\u7528\u573a\u666f\u6743\u8861\u53d6\u820d\u3002</p>"},{"location":"chap3/1Mon_perf/","title":"\u7b2c\u4e00\u8282 \u901a\u8fc7\u76d1\u63a7\u627e\u5230\u6027\u80fd\u74f6\u9888","text":"<p>\u6839\u636e\u5e15\u7d2f\u6258\u6cd5\u5219\uff08\u4e5f\u53eb\u4e8c\u516b\u5b9a\u5f8b\uff09\uff0c\u53ea\u6709\u4f18\u5316\u5904\u4e8e\u6027\u80fd\u74f6\u9888\u7684\u90a3\u4e9b\u5c11\u91cf\u4ee3\u7801\uff0c\u624d\u80fd\u7528\u6700\u5c0f\u7684\u6210\u672c\u83b7\u5f97\u6700\u5927\u7684\u6536\u76ca\u3002</p> <p>\u5982\u679c\u76d1\u63a7\u52a8\u4f5c\u81ea\u8eab\u7684\u5f00\u53d1\u6210\u672c\u8fc7\u9ad8\uff0c\u6216\u8005\u65bd\u884c\u76d1\u63a7\u65f6\u663e\u8457\u964d\u4f4e\u4e86\u4e1a\u52a1\u8bf7\u6c42\u7684\u6027\u80fd\uff0c\u6216\u8005\u65e0\u6cd5\u5168\u9762\u8986\u76d6\u6f5c\u5728\u7684\u95ee\u9898\uff0c\u90fd\u4f1a\u5f71\u54cd\u6027\u80fd\u4f18\u5316\u76ee\u6807\u7684\u5b9e\u73b0\u3002</p>"},{"location":"chap3/1Mon_perf/#1","title":"1\u3001\u5355\u673a\uff1a\u901a\u8fc7\u706b\u7130\u56fe\u627e\u5230\u6027\u80fd\u74f6\u9888","text":"<p>\u5bf9\u4e8e\u5de5\u4f5c\u5728\u4e00\u53f0\u4e3b\u673a\u4e0a\u7684\u8fdb\u7a0b\u800c\u8a00\uff0c\u6709\u8bb8\u591a\u76d1\u63a7\u65b9\u6848\u53ef\u7528\u4e8e\u5bfb\u627e\u6027\u80fd\u74f6\u9888\u3002</p> <p>\u6bd4\u5982\u5728 Linux \u4e0b\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 <code>iostat</code> \u547d\u4ee4\u76d1\u63a7\u78c1\u76d8\u72b6\u6001\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 <code>top</code> \u547d\u4ee4\u76d1\u63a7 CPU\u3001\u5185\u5b58\u7684\u4f7f\u7528\u3002</p> <p>\u8fd9\u4e9b\u65b9\u6848\u90fd\u662f\u5728\u65c1\u6572\u4fa7\u51fb\u7740\u5bfb\u627e\u6027\u80fd\u74f6\u9888\uff0c\u7136\u800c\uff0c\u6709\u4e00\u79cd\u6700\u76f4\u63a5\u6709\u6548\u7684\u65b9\u5f0f\uff0c\u5c31\u662f\u4ece\u4ee3\u7801\u5c42\u9762\u76f4\u63a5\u5bfb\u627e\u8c03\u7528\u6b21\u6570\u6700\u9891\u7e41\u3001\u8017\u65f6\u6700\u957f\u7684\u51fd\u6570\uff0c\u901a\u5e38\u5b83\u5c31\u662f\u6027\u80fd\u74f6\u9888\u3002</p> <p>\u8981\u5b8c\u6210\u8fd9\u6837\u7684\u76ee\u6807\uff0c\u901a\u5e38\u8fd8\u6709 3 \u4e2a\u7ea6\u675f\u6761\u4ef6\u3002</p> <ol> <li>\u6ca1\u6709\u4ee3\u7801\u4fb5\u5165\u6027\u3002</li> <li>\u8986\u76d6\u5230\u4ee3\u7801\u4e2d\u7684\u5168\u90e8\u51fd\u6570\u3002</li> <li>\u642d\u5efa\u73af\u5883\u7684\u6210\u672c\u8db3\u591f\u4f4e\u3002</li> </ol> <p>\u706b\u7130\u56fe\uff0c\u4ee5\u53ca\u4e3a\u706b\u7130\u56fe\u63d0\u4f9b\u76d1\u63a7\u6570\u636e\u7684\u5de5\u5177</p> <p>\u706b\u7130\u56fe\u53ef\u4ee5\u5c06\u76d1\u63a7\u671f\u95f4\u6d89\u53ca\u5230\u7684\u6240\u6709\u51fd\u6570\u8c03\u7528\u6808\u90fd\u5217\u51fa\u6765\uff0c\u5c31\u50cf\u4e0a\u56fe\u5bf9 Nginx worker \u8fdb\u7a0b\u7684\u76d1\u63a7\u4e00\u6837\uff0c\u51fd\u6570\u975e\u5e38\u5bc6\u96c6\uff0c\u56e0\u6b64\u901a\u5e38\u91c7\u7528\u53ef\u7f29\u653e\u3001\u53ef\u4e92\u52a8\u7684SVG \u77e2\u91cf\u683c\u5f0f\u56fe\u7247\u6765\u5c55\u793a</p> <p></p> <p>\u706b\u7130\u56fe\u4e2d\u6700\u91cd\u8981\u7684\u4fe1\u606f\uff0c\u5c31\u662f\u8868\u793a\u51fd\u6570\u6267\u884c\u65f6\u95f4\u7684 X \u8f74\uff0c\u4ee5\u53ca\u8868\u793a\u51fd\u6570\u8c03\u7528\u6808\u7684 Y \u8f74\u3002</p> <p>\u5148\u6765\u770b X \u8f74\u3002X \u8f74\u7531\u591a\u4e2a\u65b9\u5757\u7ec4\u6210\uff0c\u6bcf\u4e2a\u65b9\u5757\u8868\u793a\u4e00\u4e2a\u51fd\u6570\uff0c\u5176\u957f\u5ea6\u662f\u5b9a\u65f6\u91c7\u6837\u5f97\u5230\u7684\u51fd\u6570\u8c03\u7528\u9891\u7387\uff0c\u56e0\u6b64\u4f60\u53ef\u4ee5\u7b80\u5355\u7c97\u66b4\u5730\u628a\u5b83\u8fd1\u4f3c\u4e3a\u6267\u884c\u65f6\u95f4</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u51fd\u6570 A \u4e2d\u8c03\u7528\u4e86\u51fd\u6570 B\u3001C\u3001D\uff0c\u76d1\u63a7\u91c7\u6837\u65f6\u4f1a\u5f62\u6210 A-&gt;B\u3001A-&gt;C\u3001A-&gt;D \u8fd9 3 \u4e2a\u51fd\u6570\u8c03\u7528\u6808\uff0c\u4f46\u706b\u7130\u56fe\u4f1a\u5c06 3 \u4e2a\u8c03\u7528\u6808\u4e2d\u8868\u793a A \u51fd\u6570\u7684\u65b9\u5757\u5408\u5e76\uff0c\u5e76\u5c06 B\u3001C\u3001D \u653e\u5728\u4e0a\u4e00\u5c42\u4e2d\uff0c\u5e76\u4ee5\u5b57\u6bcd\u8868\u987a\u5e8f\u6392\u5217\u5b83\u4eec\u3002\u8fd9\u6837\u66f4\u6709\u52a9\u4e8e\u4f60\u627e\u5230\u8017\u65f6\u6700\u957f\u7684\u51fd\u6570\u3002</p> <p>\u518d\u6765\u770b Y \u8f74\uff0c\u5b83\u8868\u793a\u51fd\u6570\u7684\u8c03\u7528\u6808\u3002\u8fd9\u91cc\uff0c\u6211\u4eec\u65e2\u53ef\u4ee5\u770b\u5230\u5185\u6838 API \u7684\u51fd\u6570\u8c03\u7528\u6808\uff0c\u4e5f\u53ef\u4ee5\u770b\u5230\u7528\u6237\u6001\u51fd\u6570\u7684\u8c03\u7528\u6808\uff0c\u975e\u5e38\u5f3a\u5927\u3002\u5982\u679c\u4f60\u6b63\u5728\u5b66\u4e60\u5f00\u6e90\u7ec4\u4ef6\u7684\u6e90\u7801\uff0c\u63a8\u8350\u4f60\u5148\u751f\u6210\u706b\u7130\u56fe\uff0c\u518d\u5bf9\u7167\u56fe\u4e2d\u7684 Y \u8f74\u8c03\u7528\u6808\uff0c\u7406\u89e3\u6e90\u7801\u4e2d\u51fd\u6570\u7684\u8c03\u7528\u5173\u7cfb\u3002\u6ce8\u610f\uff0c\u51fd\u6570\u65b9\u5757\u7684\u989c\u8272\u662f\u968f\u673a\u7684\uff0c\u5e76\u6ca1\u6709\u7279\u522b\u7684\u610f\u4e49\uff0c\u53ea\u662f\u4e3a\u4e86\u5728\u89c6\u89c9\u4e0a\u66f4\u5bb9\u6613\u533a\u5206\u5f00\u3002</p> <p>\u9996\u5148\uff0c\u706b\u7130\u56fe\u5f88\u5bb9\u6613\u4ece\u5168\u5c40\u89c6\u89d2\uff0c\u901a\u8fc7\u5bfb\u627e\u957f\u65b9\u5757\uff0c\u627e\u5230\u8c03\u7528\u9891\u7387\u6700\u9ad8\u7684\u51e0\u4e2a\u51fd\u6570\u3002</p> <p>\u5176\u6b21\uff0c\u51fd\u6570\u65b9\u5757\u957f\uff0c\u6709\u4e9b\u662f\u56e0\u4e3a\u51fd\u6570\u81ea\u8eab\u6267\u884c\u4e86\u5f88\u6d88\u8017 CPU \u7684\u4ee3\u7801\uff0c\u800c\u6709\u4e9b\u5219\u662f\u8c03\u7528\u7684\u5b50\u51fd\u6570\u8017\u65f6\u957f\u9020\u6210\u7684\u3002\u600e\u4e48\u533a\u5206\u8fd9\u4e24\u79cd\u573a\u666f\u5462\uff1f</p> <p>\u5f88\u7b80\u5355\uff0c\u5982\u679c\u51fd\u6570\u65b9\u5757\u7684\u957f\u5ea6\uff0c\u8fdc\u5927\u4e8e\u8c03\u7528\u6808\u4e2d\u5b50\u51fd\u6570\u65b9\u5757\u7684\u957f\u5ea6\u4e4b\u548c\uff0c\u90a3\u4e48\u8fd9\u4e2a\u51fd\u6570\u5c31\u6267\u884c\u4e86\u6bd4\u8f83\u8017\u8d39 CPU \u7684\u8ba1\u7b97\u3002\u6bd4\u5982\uff0c\u4e0b\u56fe\u4e2d\u6267\u884c TLS \u63e1\u624b\u7684 <code>ngx_ssl_handshake_handler</code> \u51fd\u6570\uff0c\u81ea\u8eab\u5e76\u6ca1\u6709\u6d88\u8017 CPU \u591a\u5c11\u8ba1\u7b97\u529b</p> <p></p> <p>\u800c\u66f4\u65b0 Nginx \u65f6\u95f4\u7684 <code>ngx_time_update</code> \u51fd\u6570\u5c31\u4e0d\u540c\uff0c\u5b83\u5728\u505a\u65f6\u95f4\u683c\u5f0f\u8f6c\u6362\u65f6\u6d88\u8017\u4e86\u8bb8\u591a CPU\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u600e\u4e48\u751f\u6210\u706b\u7130\u56fe\u5462\uff1f\u5728 Linux \u4e0a\u8fd9\u975e\u5e38\u7b80\u5355\uff0c\u56e0\u4e3a Linux \u5185\u6838\u9ed8\u8ba4\u652f\u6301 perf \u5de5\u5177\uff0c\u4f60\u53ef\u4ee5\u7528 perf \u751f\u6210\u51fd\u6570\u7684\u91c7\u6837\u6570\u636e\uff0c\u518d\u7528 FlameGraph \u811a\u672c\u751f\u6210\u706b\u7130\u56fe\u3002\u5f53\u7136\uff0c\u5982\u679c\u4f60\u5728\u4f7f\u7528 Java\u3001GoLang\u3001Python \u7b49\u9ad8\u7ea7\u8bed\u8a00\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5404\u81ea\u8bed\u8a00\u751f\u6001\u4e2d\u5c01\u88c5\u8fc7\u7684 Profile \u7c7b\u5de5\u5177\uff0c\u751f\u6210\u91c7\u6837\u6570\u636e\u3002\u8fd9\u91cc\u6211\u4ee5\u6700\u57fa\u672c\u7684 perf\u3001FlameGraph \u4e3a\u4f8b\uff0c\u4ecb\u7ecd\u4e0b\u751f\u6210\u706b\u7130\u56fe\u7684 5 \u6b65\u6d41\u7a0b\u3002</p> <p>\u9996\u5148\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 yum \u6216\u8005 <code>apt-get</code> \u5b89\u88c5 perf \u5de5\u5177\uff0c\u518d\u901a\u8fc7 git \u6765\u4e0b\u8f7d FlameGraph\uff1a</p> <pre><code>yum install perf\ngit clone --depth 1 https://github.com/brendangregg/FlameGraph.git\n</code></pre> <p>Kubernetes \u5e94\u7528\u6027\u80fd\u5206\u6790\u5de5\u5177 - Kubectl Flame</p> <p>\u63a5\u7740\uff0c\u9488\u5bf9\u8fd0\u884c\u4e2d\u7684\u8fdb\u7a0b PID\uff0c\u4f7f\u7528 perf \u91c7\u6837\u51fd\u6570\u7684\u8c03\u7528\u9891\u7387\uff08\u5bf9\u4e8e C/C++ \u8bed\u8a00\uff0c\u4e3a\u4e86\u80fd\u591f\u663e\u793a\u5b8c\u6574\u7684\u51fd\u6570\u6808\uff0c\u4f60\u9700\u8981\u5728\u7f16\u8bd1\u65f6\u52a0\u5165 -g \u9009\u9879\uff09\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>perf record -F 99 -p \u8fdb\u7a0bPID -g --call-graph dwarf\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u884c\u4e2d\u5404\u53c2\u6570\u7684\u542b\u4e49\uff0c\u53ef\u4ee5\u53c2\u89c1\u8fd9\u91cc\u3002</p> <p>\u518d\u5c06\u4e8c\u8fdb\u5236\u4fe1\u606f\u8f6c\u6362\u4e3a ASCII \u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u65b9\u4fbf FlameGraph \u5904\u7406\uff1a</p> <pre><code>perf script &gt; out.perf\n</code></pre> <p>\u518d\u7136\u540e\uff0c\u9700\u8981\u6c47\u805a\u51fd\u6570\u8c03\u7528\u6808\uff0c\u8f6c\u5316\u4e3a FlameGraph \u751f\u6210\u706b\u7130\u56fe\u7684\u6570\u636e\u683c\u5f0f\uff1a</p> <pre><code>FlameGraph/stackcollapse-perf.pl out.perf &gt; out.folded\n</code></pre> <p>\u6700\u540e\u4e00\u6b65\uff0c\u751f\u6210 SVG \u683c\u5f0f\u7684\u77e2\u91cf\u56fe\u7247\uff1a</p> <pre><code>FlameGraph/flamegraph.pl out.folded &gt; out.svg\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\uff0c\u4e0a\u9762\u7684\u706b\u7130\u56fe\u53ea\u80fd\u627e\u5230\u6d88\u8017 CPU \u8ba1\u7b97\u529b\u6700\u591a\u7684\u51fd\u6570\uff0c\u56e0\u6b64\u5b83\u4e5f\u53eb\u505a On CPU \u706b\u7130\u56fe\uff0c\u7531\u4e8e CPU \u5de5\u4f5c\u65f6\u4f1a\u53d1\u70ed\uff0c\u6240\u4ee5\u8272\u5757\u90fd\u662f\u6696\u8272\u8c03</p> <p>\u6709\u4e9b\u4f7f\u7528\u4e86\u963b\u585e API \u7684\u4ee3\u7801\uff0c\u5219\u4f1a\u5bfc\u81f4\u8fdb\u7a0b\u4f11\u7720\uff0cOn CPU \u706b\u7130\u56fe\u65e0\u6cd5\u627e\u5230\u4f11\u7720\u65f6\u95f4\u6700\u957f\u7684\u51fd\u6570\uff0c\u6b64\u65f6\u53ef\u4ee5\u4f7f\u7528 Off CPU \u706b\u7130\u56fe\uff0c\u5b83\u6309\u7167\u51fd\u6570\u5f15\u53d1\u8fdb\u7a0b\u7684\u4f11\u7720\u65f6\u95f4\u7684\u957f\u77ed\uff0c\u786e\u5b9a\u51fd\u6570\u65b9\u5757\u7684\u957f\u5ea6\u3002\u7531\u4e8e\u8fdb\u7a0b\u4f11\u7720\u65f6\u4e0d\u4f7f\u7528 CPU\uff0c\u6240\u4ee5\u8272\u5757\u4f1a\u4f7f\u7528\u51b7\u8272\u8c03\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u751f\u6210 Off CPU \u706b\u7130\u56fe\u7684\u6b65\u9aa4\u7a0d\u5fae\u7e41\u7410\u70b9\uff0c\u4f60\u53ef\u4ee5\u53c2\u7167\u8fd9\u4e2a\u9875\u9762\u3002</p>"},{"location":"chap3/1Mon_perf/#2","title":"2\u3001\u5206\u5e03\u5f0f\u7cfb\u7edf\uff1a\u5982\u4f55\u901a\u8fc7\u5168\u94fe\u8def\u76d1\u63a7\u627e\u5230\u6027\u80fd\u74f6\u9888\uff1f","text":"<p>\u8bf4\u5b8c\u5fae\u89c2\u4e0a\u6027\u80fd\u74f6\u9888\u7684\u5b9a\u4f4d\uff0c\u6211\u4eec\u518d\u6765\u770b\u5b8f\u89c2\u4e0a\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\uff0c\u5b83\u901a\u8fc7\u7f51\u7edc\u628a\u4e0d\u540c\u7c7b\u578b\u7684\u786c\u4ef6\u3001\u64cd\u4f5c\u7cfb\u7edf\u3001\u7f16\u7a0b\u8bed\u8a00\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u7ed3\u6784\u5f88\u590d\u6742\uff0c</p> <p>\u5f53\u7136\uff0c\u4e0e\u5355\u673a\u4e0d\u540c\u7684\u662f\uff0c\u627e\u5230\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u6027\u80fd\u74f6\u9888\u7ec4\u4ef6\u540e\uff0c\u9664\u4e86\u53ef\u4ee5\u7ee7\u7eed\u901a\u8fc7\u706b\u7130\u56fe\u4f18\u5316\u7ec4\u4ef6\u4e2d\u67d0\u4e2a\u8fdb\u7a0b\u7684\u6027\u80fd\u5916\uff0c\u8fd8\u6709\u4e0b\u9762\u8fd9\u6837 3 \u4e2a\u65b0\u6536\u76ca\u3002</p> <ol> <li>\u9996\u5148\uff0c\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684\u6269\u5bb9\u52a8\u4f5c\uff0c\u5229\u7528\u8d1f\u8f7d\u5747\u8861\u673a\u5236\u63d0\u5347\u6027\u80fd\u3002\u5176</li> <li>\u6b21\uff0c\u5728\u4e91\u8ba1\u7b97\u548c\u5fae\u670d\u52a1\u65f6\u4ee3\uff0c\u6269\u5bb9\u53ef\u4ee5\u5728\u5206\u949f\u7ea7\u65f6\u95f4\u5185\u5b8c\u6210\u3002\u56e0\u6b64\uff0c\u5982\u679c\u6027\u80fd\u74f6\u9888\u53ef\u4ee5\u5b9e\u65f6\u68c0\u6d4b\u5230\uff0c\u5c31\u53ef\u4ee5\u81ea\u52a8\u5316\u5730\u5b8c\u6210\u6269\u5bb9\u548c\u6d41\u91cf\u8fc1\u79fb\u3002\u8fd9\u53ef\u4ee5\u63d0\u5347\u670d\u52a1\u5668\u8d44\u6e90\u7684\u5229\u7528\u7387\u3002</li> <li>\u6700\u540e\uff0c\u65e2\u7136\u80fd\u591f\u627e\u5230\u74f6\u9888\u7ec4\u4ef6\uff0c\u540c\u6837\u4e5f\u80fd\u627e\u51fa\u8d44\u6e90\u5bcc\u88d5\u7684\u7ec4\u4ef6\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u901a\u8fc7\u53cd\u5411\u7684\u7f29\u5bb9\uff0c\u51cf\u5c11\u670d\u52a1\u5668\u8d44\u6e90\u7684\u6d6a\u8d39\u3002</li> </ol>"},{"location":"chap3/1Mon_perf/#4","title":"4 \u4e2a\u89d2\u5ea6\u4ecb\u7ecd\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u6027\u80fd\u76d1\u63a7\u4f53\u7cfb","text":"<ul> <li>\u9996\u5148\uff0c\u76d1\u63a7\u57fa\u4e8e\u65e5\u5fd7\u6765\u505a\uff0c\u5bf9\u7cfb\u7edf\u7684\u4fb5\u5165\u6027\u6700\u4f4e\uff0c\u56e0\u6b64\uff0c\u4f60\u8981\u628a\u683c\u5f0f\u591a\u6837\u5316\u7684\u6587\u672c\u65e5\u5fd7\uff0c\u8fdb\u884c\u7ed3\u6784\u5316\u7ba1\u7406</li> <li>\u5176\u6b21\uff0c\u540c\u65f6\u641c\u96c6\u7cfb\u7edf\u4e2d\u6bcf\u4e2a\u7ec4\u4ef6\u7684\u65e5\u5fd7\u5e76\u6c47\u603b\u5728\u4e00\u8d77\uff0c\u8fd9\u6837\u65e5\u5fd7\u6570\u636e\u7684\u89c4\u6a21\u5c31\u975e\u5e38\u53ef\u89c2\uff0c\u6bcf\u5929\u53ef\u80fd\u4f1a\u4ea7\u751f TB \u7ea7\u522b\u7684\u6570\u636e\uff0c\u56e0\u6b64\u5173\u7cfb\u578b\u6570\u636e\u5e93\u5e76\u4e0d\u53ef\u53d6\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e3a\u4e86\u7167\u987e\u4e8b\u52a1\u3001\u5173\u8054\u67e5\u8be2\u7b49\u64cd\u4f5c\uff0c\u4e0d\u5177\u5907\u5f88\u597d\u7684\u53ef\u4f38\u7f29\u6027\u3002\u540c\u65f6\uff0c\u7ed3\u6784\u5316\u7684\u65e5\u5fd7\u6e90\u4e8e\u6211\u4eec\u5fc5\u987b\u9488\u5bf9\u67d0\u7c7b\u8bf7\u6c42\u3001\u67d0\u7c7b\u7ec4\u4ef6\u505a\u805a\u5408\u5206\u6790\uff0c\u56e0\u6b64\u7eaf\u7cb9\u7684 Key/Value \u6570\u636e\u5e93\u4e5f\u65e0\u6cd5\u5b9e\u73b0\u8fd9\u7c7b\u529f\u80fd\u3002\u56e0\u6b64\uff0c\u50cf HBase \u8fd9\u6837\u7684\u534a\u7ed3\u6784\u5316\u5217\u5f0f\u6570\u636e\u5e93\u5f80\u5f80\u662f\u76d1\u63a7\u6570\u636e\u7684\u9996\u9009\u843d\u5730\u5f62\u5f0f\u3002</li> <li>\u518d\u6b21\uff0c\u6211\u4eec\u5206\u6790\u65e5\u5fd7\u65f6\uff0c\u9996\u5148\u4f1a\u4ece\u6a2a\u5411\u4e0a\uff0c\u805a\u5408\u5206\u6790\u6210\u767e\u4e0a\u5343\u4e2a\u7ec4\u4ef6\u4e2d\u65f6\u5ef6\u3001\u541e\u5410\u91cf\u3001\u9519\u8bef\u7801\u7b49\u6570\u636e\u9879\u7684\u7edf\u8ba1\u503c\u3002</li> </ul> <p>\u8fd9\u6837\uff0c\u8ba1\u7b97\u529b\u5c31\u662f\u4e00\u4e2a\u5f88\u5927\u7684\u95ee\u9898\uff0c\u56e0\u6b64\u901a\u5e38\u9009\u62e9\u652f\u6301 Map Reduce \u7b97\u6cd5\u7684\u7cfb\u7edf\uff08\u6bd4\u5982 Hadoop\uff09\u8fdb\u884c\u8ba1\u7b97\uff0c\u5e76\u5c06\u7ed3\u679c\u4ee5\u53ef\u89c6\u5316\u7684\u65b9\u5f0f\u5c55\u73b0\u51fa\u6765\uff0c\u534f\u52a9\u6027\u80fd\u5206\u6790\u3002\u7531\u4e8e\u8ba1\u7b97\u65f6\u95f4\u6bd4\u8f83\u4e45\uff0c\u6240\u4ee5\u8fd9\u4e5f\u79f0\u4e3a\u79bb\u7ebf\u8ba1\u7b97\u3002\u5176\u6b21\u4f1a\u5728\u7eb5\u5411\u4e0a\uff0c\u76d1\u63a7\u4e00\u4e2a\u8bf7\u6c42\u5728\u6574\u4e2a\u751f\u547d\u5468\u671f\u5185\uff0c\u5404\u4e2a\u53c2\u4e0e\u7ec4\u4ef6\u7684\u6027\u80fd\u72b6\u6001\u3002\u56e0\u6b64\u5fc5\u987b\u8bbe\u8ba1\u4e00\u4e2a\u8bf7\u6c42 ID\uff0c\u80fd\u591f\u8d2f\u7a7f\u5728\u5404\u4e2a\u7ec4\u4ef6\u5185\u4f7f\u7528\uff0c\u7531\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u8bf7\u6c42\u6570\u91cf\u975e\u5e38\u5927\uff0c\u8fd9\u4e2a ID \u7684\u78b0\u649e\u6982\u7387\u5fc5\u987b\u8db3\u591f\u4f4e\u3002\u6240\u4ee5\uff0c\u8bf7\u6c42 ID \u901a\u5e38\u4f1a\u540c\u65f6\u5305\u542b\u65f6\u95f4\u548c\u7a7a\u95f4\u5143\u7d20\uff08\u6bd4\u5982 IP \u5730\u5740\uff09\u3002\u8fd9\u4e2a\u65b9\u6848\u8fd8\u6709\u4e2a\u5f88\u5a01\u6b66\u7684\u540d\u5b57\uff0c\u53eb\u505a\u5168\u94fe\u8def\u76d1\u63a7</p> <p>\u6700\u540e\uff0c\u4f60\u8fd8\u5f97\u5bf9\u6027\u80fd\u74f6\u9888\u505a\u5b9e\u65f6\u76d1\u63a7\uff0c\u8fd9\u662f\u5b9e\u73b0\u5206\u5e03\u5f0f\u7cfb\u7edf\u81ea\u52a8\u5316\u6269\u5bb9\u3001\u7f29\u5bb9\u7684\u524d\u63d0\u3002\u7531\u4e8e\u76d1\u63a7\u6570\u636e\u89c4\u6a21\u5e9e\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u901a\u5e38\u8981\u628a\u6d41\u91cf\u5728\u65f6\u95f4\u7ef4\u5ea6\u4e0a\u5206\u7247\uff0c\u4ec5\u5bf9\u6bcf\u4e2a\u65f6\u95f4\u5c0f\u7a97\u53e3\u4e2d\u6709\u9650\u7684\u6570\u636e\uff0c\u505a\u5feb\u901f\u7684\u589e\u91cf\u8ba1\u7b97\u3002\u50cf Storm\u3001Spark\u3001Flink \u90fd\u662f\u8fd9\u6837\u7684\u5b9e\u65f6\u6d41\u8ba1\u7b97\u4e2d\u95f4\u4ef6\uff0c\u4f60\u53ef\u4ee5\u57fa\u4e8e\u5b83\u4eec\u5b8c\u6210\u5b9e\u65f6\u6570\u636e\u7684\u6c47\u805a\u5206\u6790\u3002</p>"},{"location":"chap3/1Mon_perf/#3","title":"3\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u5728 Linux \u7cfb\u7edf\u4e2d\uff0c\u4f60\u53ef\u4ee5\u7528\u5185\u6838\u652f\u6301\u7684 perf \u5de5\u5177\uff0c\u5feb\u901f\u5730\u751f\u6210\u706b\u7130\u56fe\u3002\u5176\u4ed6\u9ad8\u7ea7\u7f16\u7a0b\u8bed\u8a00\u751f\u6001\u4e2d\uff0c\u90fd\u6709\u7c7b\u4f3c\u7684 Profiler \u5de5\u5177\uff0c\u53ef\u751f\u6210\u706b\u7130\u56fe\u3002</p> <p>\u706b\u7130\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230\u51fd\u6570\u8c03\u7528\u6808\uff0c\u5b83\u5bf9\u4f60\u5206\u6790\u6e90\u7801\u5f88\u6709\u5e2e\u52a9\u3002\u56fe\u4e2d\u65b9\u5757\u7684\u957f\u5ea6\u8868\u793a\u51fd\u6570\u7684\u8c03\u7528\u9891\u7387\uff0c\u5f53\u91c7\u6837\u5f88\u5bc6\u96c6\u65f6\uff0c\u4f60\u53ef\u4ee5\u628a\u5b83\u8fd1\u4f3c\u4e3a\u51fd\u6570\u7684\u6267\u884c\u65f6\u957f\u3002\u7236\u65b9\u5757\u957f\u5ea6\u51cf\u53bb\u6240\u6709\u5b50\u65b9\u5757\u957f\u5ea6\u7684\u548c\uff0c\u5c31\u8868\u793a\u4e86\u7236\u51fd\u6570\u81ea\u8eab\u4ee3\u7801\u5bf9 CPU \u8ba1\u7b97\u529b\u7684\u6d88\u8017\u3002\u56e0\u6b64\uff0c\u706b\u7130\u56fe\u53ef\u4ee5\u76f4\u89c2\u5730\u627e\u5230\u8c03\u7528\u6b21\u6570\u6700\u9891\u7e41\u4e14\u6700\u8017\u65f6\u7684\u51fd\u6570\u3002</p> <p>\u5bf9\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\uff0c\u6027\u80fd\u76d1\u63a7\u8fd8\u6709\u5229\u4e8e\u7cfb\u7edf\u7684\u6269\u5bb9\u548c\u7f29\u5bb9\u8fd0\u7ef4\u3002\u642d\u5efa\u6027\u80fd\u76d1\u63a7\u4f53\u7cfb\u5305\u62ec\u4ee5\u4e0b\u56db\u4e2a\u5173\u952e\u70b9\uff1a</p> <ul> <li>\u9996\u5148\u8981\u628a\u4e94\u82b1\u516b\u95e8\u7684\u65e5\u5fd7\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u63d0\u53d6\u4e3a\u7ed3\u6784\u5316\u7684\u76d1\u63a7\u6570\u636e\uff1b</li> <li>\u5176\u6b21\u7528\u534a\u7ed3\u6784\u5316\u7684\u5217\u5f0f\u6570\u636e\u5e93\u5b58\u653e\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u65e5\u5fd7\uff0c\u4fbf\u4e8e\u540e\u7eed\u7684\u6c47\u805a\u5206\u6790\uff1b</li> <li>\u7b2c\u4e09\uff0c\u4f7f\u7528\u7edf\u4e00\u7684\u8bf7\u6c42 ID \u5c06\u5404\u7ec4\u4ef6\u4e32\u8054\u5728\u4e00\u8d77\uff0c\u5e76\u4f7f\u7528 MapReduce \u7b97\u6cd5\u5bf9\u5927\u91cf\u7684\u76d1\u63a7\u6570\u636e\u505a\u79bb\u7ebf\u5206\u6790\uff1b</li> <li>\u6700\u540e\uff0c\u901a\u8fc7\u5b9e\u65f6\u6d41\u8ba1\u7b97\u6846\u67b6\uff0c\u5bf9\u76d1\u63a7\u6570\u636e\u505a\u5b9e\u65f6\u6c47\u805a\u5206\u6790\u3002</li> </ul>"},{"location":"chap3/2perf_cap/","title":"\u7b2c\u4e8c\u8282 \u820d\u5f03\u4e00\u81f4\u6027\u53bb\u6362\u53d6\u6027\u80fd\u7684CAP\u7406\u8bba","text":"<p>\u8fdb\u7a0b\u7684\u6027\u80fd\u5fc5\u7136\u53d7\u5236\u4e8e\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u5404\u786c\u4ef6\u7684\u5904\u7406\u80fd\u529b\u4e0a\u9650\u3002\u5982\u679c\u9700\u8981\u8fdb\u4e00\u6b65\u5730\u63d0\u5347\u670d\u52a1\u6027\u80fd\uff0c\u90a3\u53ea\u6709\u6574\u5408\u591a\u53f0\u4e3b\u673a\u7ec4\u6210\u5206\u5e03\u5f0f\u7cfb\u7edf\u624d\u80fd\u529e\u5230\u3002</p> <p>\u5f53\u591a\u53f0\u4e3b\u673a\u901a\u8fc7\u7f51\u7edc\u534f\u540c\u5904\u7406\u7528\u6237\u8bf7\u6c42\u65f6\uff0c\u5982\u679c\u4e3b\u673a\u4e0a\u7684\u8fdb\u7a0b\u542b\u6709\u6570\u636e\u72b6\u6001\uff0c\u90a3\u4e48\u5fc5\u7136\u9700\u8981\u5728\u591a\u53f0\u4e3b\u673a\u4e4b\u95f4\u8de8\u7f51\u7edc\u540c\u6b65\u6570\u636e\uff0c\u7531\u4e8e\u7f51\u7edc\u5b58\u5728\u65f6\u5ef6\uff0c\u4e5f\u5e76\u4e0d\u7a33\u5b9a\uff0c\u56e0\u6b64\u4e0d\u53ef\u9760\u7684\u6570\u636e\u540c\u6b65\u64cd\u4f5c\u5c06\u4f1a\u589e\u52a0\u8bf7\u6c42\u7684\u5904\u7406\u65f6\u5ef6\u3002</p> <p>CAP \u7406\u8bba\u6307\u51fa\uff0c\u5f53\u6570\u636e\u540c\u65f6\u5b58\u653e\u5728\u591a\u4e2a\u4e3b\u673a\u4e0a\u65f6\uff0c\u53ef\u7528\u6027\u4e0e\u4e00\u81f4\u6027\u662f\u4e0d\u53ef\u517c\u5f97\u7684\u3002</p> <p>\u6839\u636e CAP \u7684\u6307\u5bfc\u6027\u601d\u60f3\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u727a\u7272\u4e00\u81f4\u6027\uff0c\u6765\u63d0\u5347\u53ef\u7528\u6027\u4e2d\u7684\u6838\u5fc3\u56e0\u7d20\uff1a\u6027\u80fd\u3002\u5f53\u7136\uff0c\u5728\u5b9e\u8df5\u4e2d\u5bf9\u4e00\u81f4\u6027\u4e0e\u6027\u80fd\u5e76\u4e0d\u662f\u975e\u9ed1\u5373\u767d\u7684\u9009\u62e9\uff0c\u800c\u662f\u4ece\u6982\u7387\u4e0a\u8fdb\u884c\u4e0d\u540c\u7a0b\u5ea6\u7684\u53d6\u820d\u3002</p>"},{"location":"chap3/2perf_cap/#1","title":"1\u3001\u5982\u4f55\u6743\u8861\u6027\u80fd\u4e0e\u4e00\u81f4\u6027\uff1f","text":"<p>\u9996\u5148\uff0c\u9488\u5bf9\u7684\u662f\u6709\u72b6\u6001\u670d\u52a1\u7684\u6027\u80fd\u4f18\u5316\u3002\u6240\u8c13\u6709\u72b6\u6001\u670d\u52a1\uff0c\u662f\u6307\u8fdb\u7a0b\u4f1a\u5728\u5904\u7406\u5b8c\u8bf7\u6c42\u540e\uff0c\u4ecd\u7136\u4fdd\u5b58\u7740\u5f71\u54cd\u4e0b\u6b21\u8bf7\u6c42\u7ed3\u679c\u7684\u7528\u6237\u6570\u636e\uff0c\u800c\u65e0\u72b6\u6001\u670d\u52a1\u5219\u53ea\u4ece\u6bcf\u4e2a\u8bf7\u6c42\u7684\u8f93\u5165\u53c2\u6570\u4e2d\u83b7\u53d6\u6570\u636e\uff0c\u5728\u8bf7\u6c42\u5904\u7406\u5b8c\u6210\u540e\u5e76\u4e0d\u4fdd\u5b58\u4efb\u4f55\u4f1a\u8bdd\u4fe1\u606f\u3002</p> <p>\u56e0\u6b64\uff0c\u65e0\u72b6\u6001\u670d\u52a1\u62e5\u6709\u6700\u597d\u7684\u53ef\u4f38\u7f29\u6027\uff0c\u4f46\u6d89\u53ca\u6570\u636e\u6301\u4e45\u5316\u65f6\uff0c\u5219\u5fc5\u987b\u7531\u6709\u72b6\u6001\u670d\u52a1\u5904\u7406\uff0c\u8fd9\u662f CAP \u7406\u8bba\u6240\u8981\u89e3\u51b3\u7684\u95ee\u9898\u3002</p> <p>\u4ec0\u4e48\u662f CAP \u7406\u8bba\u5462\uff1f\u8fd9\u662f 2000 \u5e74University of California, Berkeley \u7684\u8ba1\u7b97\u673a\u6559\u6388Eric Brewer\uff08\u4e5f\u662f\u8c37\u6b4c\u57fa\u7840\u8bbe\u65bd VP\uff09\u63d0\u51fa\u7684\u7406\u8bba\u3002\u6240\u8c13 CAP\uff0c\u662f\u4ee5\u4e0b 3 \u4e2a\u5355\u8bcd\u7684\u9996\u5b57\u6bcd\u7f29\u5199\uff0c\u5b83\u4eec\u90fd\u662f\u5206\u5e03\u5f0f\u7cfb\u7edf\u6700\u6838\u5fc3\u7684\u7279\u6027\uff1a</p> <ul> <li>Consistency \u4e00\u81f4\u6027</li> <li>Availability \u53ef\u7528\u6027</li> <li>Partition tolerance \u5206\u533a\u5bb9\u9519\u6027</li> </ul> <p>3 \u5f20\u793a\u610f\u56fe\uff0c\u5feb\u901f\u7406\u89e3\u4e0b\u8fd9 3 \u4e2a\u8bcd\u7684\u610f\u4e49\u3002\u4e0b\u56fe\u4e2d N1\u3001N2 \u4e24\u53f0\u4e3b\u673a\u4e0a\u8fd0\u884c\u7740 A \u8fdb\u7a0b\u548c B \u8fdb\u7a0b\uff0c\u5b83\u4eec\u64cd\u4f5c\u7740\u540c\u4e00\u4e2a\u7528\u6237\u7684\u6570\u636e\uff08\u6570\u636e\u7684\u521d\u59cb\u503c\u662f V0\uff09\uff0c\u8fd9\u91cc N1 \u548c N2 \u4e3b\u673a\u5c31\u5904\u4e8e\u4e0d\u540c\u7684 Partition \u5206\u533a\u4e2d\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5f53\u7528\u6237\u8bf7\u6c42\u5230\u8fbe N1 \u4e3b\u673a\u4e0a\u7684 A \u8fdb\u7a0b\uff0c\u5e76\u5c06\u6570\u636e V0 \u4fee\u6539\u4e3a V1 \u540e\uff0cA \u8fdb\u7a0b\u5c06\u4f1a\u628a\u8fd9\u4e00\u4fee\u6539\u884c\u4e3a\u540c\u6b65\u5230 N2 \u4e3b\u673a\u4e0a\u7684 B \u8fdb\u7a0b\uff0c\u6700\u7ec8 N1\u3001N2 \u4e0a\u7684\u6570\u636e\u90fd\u662f V1\uff0c\u8fd9\u5c31\u4fdd\u6301\u4e86\u7cfb\u7edf\u7684 Consistency \u4e00\u81f4\u6027\u3002</p> <p></p> <p>\u7136\u800c\uff0c\u4e00\u65e6 N1 \u548c N2 \u4e4b\u95f4\u7f51\u7edc\u5f02\u5e38\uff0c\u6570\u636e\u540c\u6b65\u884c\u4e3a\u5c31\u4f1a\u5931\u8d25\u3002</p> <p>\u8fd9\u65f6\uff0cN1 \u548c N2 \u4e4b\u95f4\u6570\u636e\u4e0d\u4e00\u81f4\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u5728\u5206\u533a\u95f4\u7f51\u7edc\u4e0d\u901a\u7684\u60c5\u51b5\u4e0b\uff0cN2 \u80fd\u591f\u7ee7\u7eed\u4e3a\u7528\u6237\u63d0\u4f9b\u670d\u52a1\uff0c\u5c31\u5fc5\u987b\u5bb9\u5fcd\u6570\u636e\u7684\u4e0d\u4e00\u81f4\uff0c\u6b64\u65f6\u7cfb\u7edf\u7684 Availability \u53ef\u7528\u6027\u66f4\u9ad8\uff0c\u7cfb\u7edf\u7684\u5e76\u53d1\u5904\u7406\u80fd\u529b\u66f4\u5f3a\uff0c\u6bd4\u5982 Cassandra \u6570\u636e\u5e93\u3002</p> <p></p> <p>\u53cd\u4e4b\uff0c\u5982\u679c A\u3001B \u8fdb\u7a0b\u4e00\u65e6\u53d1\u73b0\u6570\u636e\u540c\u6b65\u5931\u8d25\uff0c\u90a3\u4e48 B \u8fdb\u7a0b\u81ea\u52a8\u62d2\u7edd\u65b0\u8bf7\u6c42\uff0c\u4ec5\u7531 A \u8fdb\u7a0b\u72ec\u7acb\u63d0\u4f9b\u670d\u52a1\uff0c\u90a3\u4e48\u867d\u7136\u964d\u4f4e\u4e86\u7cfb\u7edf\u7684\u53ef\u7528\u6027\uff0c\u4f46\u4fdd\u8bc1\u4e86\u66f4\u5f3a\u7684\u4e00\u81f4\u6027\uff0c\u6bd4\u5982 MySQL \u7684\u4e3b\u5907\u540c\u6b65\u6a21\u5f0f\u3002</p> <p>\u5f53\u7136\uff0c\u53ef\u7528\u6027\u662f\u4e00\u4e2a\u5f88\u5927\u7684\u6982\u5ff5\uff0c\u5b83\u63cf\u8ff0\u4e86\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u6301\u7eed\u670d\u52a1\u80fd\u529b\uff0c\u5982\u4e0b\u8868\u6240\u793a\uff1a</p> <p></p> <p>\u5f53\u7528\u6237\u3001\u6d41\u91cf\u4e0d\u65ad\u589e\u957f\u65f6\uff0c\u7cfb\u7edf\u7684\u6027\u80fd\u5c06\u53d8\u6210\u8861\u91cf\u53ef\u7528\u6027\u7684\u5173\u952e\u56e0\u7d20\u3002\u5f53\u5e0c\u671b\u62e5\u6709\u66f4\u5f3a\u7684\u6027\u80fd\u65f6\uff0c\u5c31\u4e0d\u5f97\u4e0d\u727a\u7272\u6570\u636e\u7684\u4e00\u81f4\u6027\u3002\u5f53\u7136\uff0c\u4e00\u81f4\u6027\u5e76\u4e0d\u662f\u53ea\u6709\u662f\u548c\u5426\u8fd9\u4e24\u79cd\u5c5e\u6027\uff0c\u65e2\u53ef\u4ee5\u4ece\u65f6\u95f4\u7ef4\u5ea6\u4e0a\u8bbe\u8ba1\u77ed\u6682\u4e0d\u4e00\u81f4\u7684\u540c\u6b65\u6a21\u578b\uff0c\u4e5f\u53ef\u4ee5\u4ece\u7a7a\u95f4\u7ef4\u5ea6\u4e0a\u4e3a\u4e0d\u542b\u6709\u56e0\u679c\u3001\u65f6\u5e8f\u5173\u7cfb\u7684\u7528\u6237\u6570\u636e\u8bbe\u8ba1\u5e76\u53d1\u6a21\u578b\u3002</p> <p>\u5728\u5b66\u672f\u4e0a\uff0c\u901a\u5e38\u4f1a\u6309\u7167 2 \u4e2a\u7ef4\u5ea6\u5bf9\u4e00\u81f4\u6027\u6a21\u578b\u5206\u7c7b\u3002</p> <p>\u9996\u5148\u662f\u4ece\u6570\u636e\u51fa\u53d1\u8bbe\u8ba1\u51fa\u7684\u4e00\u81f4\u6027\u6a21\u578b\uff0c\u6bd4\u5982\u987a\u5e8f\u4e00\u81f4\u6027\u5fc5\u987b\u9075\u7167\u8bfb\u5199\u64cd\u4f5c\u7684\u6b21\u5e8f\u6765\u4fdd\u6301\u4e00\u81f4\u6027\uff0c\u800c\u5f31\u4e00\u4e9b\u7684\u56e0\u679c\u4e00\u81f4\u6027\u5219\u5141\u8bb8\u4e0d\u5177\u5907\u56e0\u679c\u5173\u7cfb\u7684\u8bfb\u5199\u64cd\u4f5c\u5e76\u53d1\u6267\u884c\u3002</p> <p>\u5176\u6b21\u662f\u4ece\u7528\u6237\u51fa\u53d1\u8bbe\u8ba1\u51fa\u7684\u4e00\u81f4\u6027\u6a21\u578b\uff0c\u6bd4\u5982\u5355\u8c03\u8bfb\u4e00\u81f4\u6027\u4fdd\u8bc1\u5ba2\u6237\u7aef\u4e0d\u4f1a\u8bfb\u53d6\u5230\u65e7\u503c\uff0c\u800c\u5355\u8c03\u5199\u4e00\u81f4\u6027\u5219\u4fdd\u8bc1\u5199\u64cd\u4f5c\u662f\u4e32\u884c\u7684\u3002</p> <p>\u5b9e\u9645\u5de5\u7a0b\u4e2d\u4e00\u81f4\u6027\u4e0e\u53ef\u7528\u6027\u7684\u8fb9\u754c\u4f1a\u6a21\u7cca\u5f88\u591a\uff0c\u56e0\u6b64\u53c8\u6709\u4e86\u6700\u7ec8\u4e00\u81f4\u6027\u8fd9\u6837\u4e00\u4e2a\u6982\u5ff5\uff0c\u8fd9\u4e2a\u201c\u6700\u7ec8\u201d\u7a76\u7adf\u662f\u591a\u4e45\uff0c\u5c06\u7531\u4e1a\u52a1\u7279\u6027\u3001\u7f51\u7edc\u6545\u969c\u7387\u7b49\u56e0\u7d20\u7efc\u5408\u51b3\u5b9a\u3002\u4f34\u968f\u6700\u7ec8\u4e00\u81f4\u6027\u7684\u662f BASE \u7406\u8bba\uff1a</p> <ul> <li>Basically Available \u57fa\u672c\u53ef\u7528\u6027</li> <li>Soft state \u8f6f\u72b6\u6001</li> <li>Eventually consistent \u6700\u7ec8\u4e00\u81f4\u6027</li> </ul>"},{"location":"chap3/2perf_cap/#2","title":"2\u3001\u600e\u6837\u820d\u5f03\u4e00\u81f4\u6027\u63d0\u5347\u6027\u80fd\uff1f","text":"<p>\u670d\u52a1\u7684\u6027\u80fd\uff0c\u4e3b\u8981\u4f53\u73b0\u5728\u8bf7\u6c42\u7684\u65f6\u5ef6\u548c\u7cfb\u7edf\u7684\u5e76\u53d1\u6027\u8fd9\u4e24\u4e2a\u65b9\u9762\uff0c\u800c\u5b83\u4eec\u90fd\u4e0e\u4e0a\u9762\u63d0\u5230\u7684\u6700\u7ec8\u4e00\u81f4\u6027\u6709\u5173\u3002</p> <p>\u8fd9\u6837\uff0c\u5728\u7eb5\u5411\u4e0a\u5728\u79bb\u5ba2\u6237\u7aef\u66f4\u8fd1\u7684\u4f4d\u7f6e\u589e\u52a0\u6570\u636e\u7684\u526f\u672c\uff0c\u5e76\u628a\u5b83\u5b58\u653e\u5728\u5904\u7406\u901f\u5ea6\u66f4\u5feb\u7684\u7269\u7406\u4ecb\u8d28\u4e0a\uff0c\u5c31\u53ef\u4ee5\u4f5c\u4e3a\u7f13\u5b58\u964d\u4f4e\u8bf7\u6c42\u7684\u65f6\u5ef6\uff1b</p> <p>\u800c\u5728\u6a2a\u5411\u4e0a\u5bf9\u6570\u636e\u589e\u52a0\u526f\u672c\uff0c\u5e76\u5728\u8fd9\u4e9b\u4e3b\u673a\u95f4\u540c\u6b65\u6570\u636e\uff0c\u8fd9\u6837\u5de5\u4f5c\u5728\u6570\u636e\u526f\u672c\u4e0a\u7684\u8fdb\u7a0b\u4e5f\u53ef\u4ee5\u540c\u65f6\u5bf9\u5ba2\u6237\u7aef\u63d0\u4f9b\u670d\u52a1\uff0c\u8fd9\u5c31\u589e\u52a0\u4e86\u7cfb\u7edf\u7684\u5e76\u53d1\u6027\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u770b\u7eb5\u5411\u4e0a\u7684\u7f13\u5b58\uff0c\u662f\u5982\u4f55\u5728\u964d\u4f4e\u8bf7\u6c42\u5904\u7406\u65f6\u5ef6\u65f6\uff0c\u4fdd\u6301\u6700\u7ec8\u4e00\u81f4\u6027\u7684</p> <p>\u7f13\u5b58\u53ef\u4ee5\u7531\u8bfb\u3001\u5199\u4e24\u4e2a\u64cd\u4f5c\u89e6\u53d1\u66f4\u65b0\uff0c\u4f8b\u5982 HTTP \u79c1\u6709\u7f13\u5b58\uff0c\u5c31\u662f\u5de5\u4f5c\u5728\u6d4f\u89c8\u5668\u4e0a\u57fa\u4e8e\u8bfb\u64cd\u4f5c\u89e6\u53d1\u7684\u7f13\u5b58\u3002</p> <p></p> <p>\u5de5\u4f5c\u5728\u4ee3\u7406\u670d\u52a1\u5668\u4e0a\u7684 HTTP \u5171\u4eab\u7f13\u5b58\uff0c\u4e5f\u662f\u7531\u8bfb\u64cd\u4f5c\u89e6\u53d1\u7684\u3002\u8fd9\u4e9b\u7f13\u5b58\u4e0e\u6e90\u670d\u52a1\u5668\u4e0a\u7684\u6570\u636e\u6700\u7ec8\u662f\u4e00\u81f4\u7684\uff0c\u4f46\u5728 CacheControl \u7b49 HTTP \u5934\u90e8\u6307\u5b9a\u7684\u65f6\u95f4\u5185\uff0c\u7f13\u5b58\u5b8c\u5168\u6709\u53ef\u80fd\u4e0e\u6e90\u6570\u636e\u4e0d\u540c\uff0c\u8fd9\u5c31\u662f\u727a\u7272\u4e00\u81f4\u6027\u6765\u63d0\u5347\u6027\u80fd\u7684\u5178\u578b\u4f8b\u5b50\u3002</p> <p>\u4e8b\u5b9e\u4e0a\uff0c\u4e5f\u6709\u5f88\u591a\u4ee5\u5199\u64cd\u4f5c\u89e6\u53d1\u7f13\u5b58\u66f4\u65b0\u7684\u8bbe\u8ba1\uff0c\u5b83\u4eec\u901a\u5e38\u53c8\u5206\u4e3a write back \u548c write through \u4e24\u79cd\u6a21\u5f0f\u3002</p> <p>write back \u727a\u7272\u4e86\u66f4\u591a\u7684\u4e00\u81f4\u6027\uff0c\u4f46\u5e26\u6765\u4e86\u66f4\u4f4e\u7684\u8bf7\u6c42\u65f6\u5ef6\u3002\u6bd4\u5982 Linux \u78c1\u76d8\u9ad8\u901f\u7f13\u5b58\u5c31\u91c7\u7528\u4e86 write back \u8fd9\u79cd\u8bbe\u8ba1\uff0c\u5b83\u867d\u7136\u662f\u5355\u673a\u5185\u7684\u4e00\u79cd\u7f13\u5b58\u8bbe\u8ba1\uff0c\u4f46\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7f13\u5b58\u7684\u8bbe\u8ba1\u65b9\u5f0f\u4e5f\u662f\u4e00\u6837\u7684\u3002</p> <p>write through \u4f1a\u5728\u66f4\u65b0\u6570\u636e\u6210\u529f\u540e\u518d\u66f4\u65b0\u7f13\u5b58\uff0c\u867d\u7136\u5e26\u6765\u4e86\u5f88\u597d\u7684\u4e00\u81f4\u6027\uff0c\u4f46\u5199\u64cd\u4f5c\u7684\u65f6\u5ef6\u4f1a\u66f4\u4e45</p> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>write through \u7684\u4e00\u81f4\u6027\u975e\u5e38\u597d\u662f\u9996\u9009\u8bbe\u8ba1\u3002</p> <p>\u7136\u800c\uff0c\u4e00\u65e6\u7f13\u5b58\u5230\u6e90\u6570\u636e\u7684\u8def\u5f84\u5f88\u957f\u3001\u5ef6\u65f6\u5f88\u9ad8\u7684\u65f6\u5019\uff0c\u5c31\u503c\u5f97\u8003\u8651 write back \u6a21\u5f0f\uff0c\u6b64\u65f6\u4e00\u81f4\u6027\u6a21\u578b\u867d\u7136\u590d\u6742\u4e86\u8bb8\u591a\uff0c\u4f46\u53ef\u4ee5\u5e26\u6765\u663e\u8457\u7684\u6027\u80fd\u63d0\u5347\u3002\u6bd4\u5982\u673a\u68b0\u78c1\u76d8\u76f8\u5bf9\u5185\u5b58\u5ef6\u65f6\u9ad8\u4e86\u5f88\u591a\uff0c\u56e0\u6b64\u78c1\u76d8\u9ad8\u901f\u7f13\u5b58\u4f1a\u91c7\u7528 write back \u6a21\u5f0f\u3002</p> <p>\u867d\u7136\u7f13\u5b58\u4e5f\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u589e\u52a0\u7cfb\u7edf\u7684\u5e76\u53d1\u5904\u7406\u8fde\u63a5\uff0c\u4f46\u8fd9\u66f4\u591a\u662f\u7f18\u4e8e\u7f13\u5b58\u91c7\u7528\u4e86\u66f4\u5feb\u7684\u7b97\u6cd5\u4ee5\u53ca\u5b58\u50a8\u4ecb\u8d28\u5e26\u6765\u7684\u6536\u76ca\u3002</p> <p>\u4ece\u6c34\u5e73\u65b9\u5411\u4e0a\uff0c\u5728\u66f4\u591a\u7684\u4e3b\u673a\u4e0a\u6dfb\u52a0\u6570\u636e\u526f\u672c\uff0c\u5e76\u5728\u5176\u4e0a\u7528\u65b0\u7684\u8fdb\u7a0b\u63d0\u4f9b\u670d\u52a1\uff0c\u8fd9\u624d\u662f\u63d0\u5347\u7cfb\u7edf\u5e76\u53d1\u5904\u7406\u80fd\u529b\u6700\u6709\u6548\u7684\u624b\u6bb5\u3002</p> <p>\u6b64\u65f6\uff0c\u8fdb\u7a0b\u95f4\u540c\u6b65\u6570\u636e\u4e3b\u8981\u5305\u542b\u4e24\u79cd\u65b9\u5f0f\uff1a\u540c\u6b65\u65b9\u5f0f\u4ee5\u53ca\u5f02\u6b65\u65b9\u5f0f\uff0c\u524d\u8005\u4f1a\u5728\u6bcf\u4e2a\u66f4\u65b0\u8bf7\u6c42\u5b8c\u6210\u524d\uff0c\u5c06\u6570\u636e\u6210\u529f\u540c\u6b65\u5230\u6bcf\u4e2a\u526f\u672c\u540e\uff0c\u8bf7\u6c42\u624d\u4f1a\u5904\u7406\u5b8c\u6210\uff0c\u800c\u540e\u8005\u5219\u4f1a\u5728\u5904\u7406\u5b8c\u8bf7\u6c42\u540e\uff0c\u624d\u5f00\u59cb\u5f02\u6b65\u5730\u540c\u6b65\u6570\u636e\u5230\u526f\u672c\u4e2d\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u540c\u6b65\u65b9\u5f0f\u4e0b\u7cfb\u7edf\u7684\u4e00\u81f4\u6027\u6700\u597d\uff0c\u4f46\u7531\u4e8e\u8bf7\u6c42\u7684\u5904\u7406\u65f6\u5ef6\u5305\u542b\u4e86\u526f\u672c\u95f4\u7684\u901a\u8baf\u65f6\u957f\uff0c\u6240\u4ee5\u6027\u80fd\u5e76\u4e0d\u597d\u3002</p> <p>\u800c\u5f02\u6b65\u65b9\u5f0f\u4e0b\u7cfb\u7edf\u7684\u4e00\u81f4\u6027\u8981\u5dee\uff0c\u7279\u522b\u662f\u5728\u4e3b\u8fdb\u7a0b\u5b95\u673a\u540e\uff0c\u526f\u672c\u4e0a\u7684\u8fdb\u7a0b\u5f88\u5bb9\u6613\u51fa\u73b0\u6570\u636e\u4e22\u5931\uff0c\u4f46\u5f02\u6b65\u65b9\u5f0f\u7684\u6027\u80fd\u8981\u597d\u5f97\u591a\uff0c\u8fd9\u4e0d\u53ea\u7531\u4e8e\u66f4\u65b0\u8bf7\u6c42\u7684\u8fd4\u56de\u66f4\u5feb\uff0c\u800c\u4e14\u5f02\u6b65\u5316\u540e\u4e3b\u8fdb\u7a0b\u53ef\u4ee5\u57fa\u4e8e\u5408\u5e76\u3001\u6279\u91cf\u64cd\u4f5c\u7b49\u6280\u5de7\uff0c\u8fdb\u884c\u6548\u7387\u66f4\u9ad8\u7684\u6570\u636e\u540c\u6b65\u3002</p> <p>\u6bd4\u5982 MySQL \u7684\u4e3b\u5907\u6a21\u5f0f\u4e0b\uff0c\u9ed8\u8ba4\u5c31\u4f7f\u7528\u5f02\u6b65\u65b9\u5f0f\u540c\u6b65\u6570\u636e\uff0c\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u6539\u4e3a\u540c\u6b65\u65b9\u5f0f\uff0c\u5305\u62ec <code>Full-synchronous Replication</code>\uff08\u540c\u6b65\u6240\u6709\u6570\u636e\u526f\u672c\u540e\u8bf7\u6c42\u624d\u80fd\u8fd4\u56de\uff09\u4ee5\u53ca <code>Semi-synchronous Replication</code>\uff08\u4ec5\u6210\u529f\u540c\u6b65 1 \u4e2a\u526f\u672c\u540e\u8bf7\u6c42\u5c31\u53ef\u4ee5\u8fd4\u56de\uff09\u4e24\u79cd\u65b9\u5f0f\u3002</p> <p>\u5f53\u7136\uff0c\u5728\u6269\u5bb9\u3001\u5b95\u673a\u6062\u590d\u7b49\u573a\u666f\u4e0b\uff0c\u526f\u672c\u4e4b\u95f4\u7684\u6570\u636e\u4e25\u91cd\u4e0d\u4e00\u81f4\uff0c\u5982\u679c\u4ecd\u7136\u57fa\u4e8e\u5355\u4e2a\u64cd\u4f5c\u540c\u6b65\u6570\u636e\uff0c\u65f6\u95f4\u4f1a\u5f88\u4e45\uff0c\u6027\u80fd\u5f88\u5dee\u3002\u6b64\u65f6\u5e94\u7ed3\u5408\u5b9a\u671f\u66f4\u65b0\u7684 Snapshot \u5feb\u7167\uff0c\u4ee5\u53ca\u5b9e\u65f6\u7684 <code>Oplog</code> \u64cd\u4f5c\u65e5\u5fd7\uff0c\u534f\u4f5c\u540c\u6b65\u6570\u636e\uff0c\u8fd9\u6837\u6548\u7387\u4f1a\u9ad8\u5f88\u591a\u3002</p> <p>\u5176\u4e2d\uff0c\u5feb\u7167\u662f\u622a\u6b62\u65f6\u95f4 T0 \u65f6\u6240\u6709\u6570\u636e\u7684\u72b6\u6001\uff0c\u800c\u64cd\u4f5c\u65e5\u5fd7\u5219\u662f T0 \u65f6\u95f4\u5230\u5f53\u4e0b T1 \u4e4b\u95f4\u7684\u6240\u6709\u66f4\u65b0\u64cd\u4f5c\uff0c\u8fd9\u6837\uff0c\u526f\u672c\u8f7d\u5165\u5feb\u7167\u6062\u590d\u81f3 T0 \u65f6\u523b\u7684\u6570\u636e\u540e\uff0c\u518d\u901a\u8fc7\u6709\u9650\u7684\u64cd\u4f5c\u65e5\u5fd7\u4e0e\u4e3b\u8fdb\u7a0b\u4fdd\u6301\u4e00\u81f4\u3002</p>"},{"location":"chap3/2perf_cap/#3","title":"3\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>CAP \u7406\u8bba\u6307\u51fa\uff0c\u53ef\u7528\u6027\u3001\u5206\u533a\u5bb9\u9519\u6027\u3001\u4e00\u81f4\u6027\u4e09\u8005\u53ea\u80fd\u53d6\u5176\u4e8c\uff0c\u56e0\u6b64\u5f53\u5206\u5e03\u5f0f\u7cfb\u7edf\u9700\u8981\u670d\u52a1\u66f4\u591a\u7684\u7528\u6237\u65f6\uff0c\u53ea\u80fd\u820d\u5f03\u4e00\u81f4\u6027\uff0c\u6362\u53d6\u53ef\u7528\u6027\u4e2d\u7684\u6027\u80fd\u56e0\u5b50\u3002</p> <p>\u5f53\u7136\uff0c\u6027\u80fd\u4e0e\u4e00\u81f4\u6027\u5e76\u4e0d\u662f\u7b80\u5355\u7684\u4e8c\u9009\u4e00\uff0c\u800c\u662f\u9700\u8981\u4f60\u6839\u636e\u7f51\u7edc\u65f6\u5ef6\u3001\u6545\u969c\u6982\u7387\u8bbe\u8ba1\u51fa\u4e00\u81f4\u6027\u6a21\u578b\uff0c\u5728\u63d0\u4f9b\u9ad8\u6027\u80fd\u7684\u540c\u65f6\uff0c\u4fdd\u6301\u65f6\u95f4\u3001\u7a7a\u95f4\u4e0a\u53ef\u63a5\u53d7\u7684\u6700\u7ec8\u4e00\u81f4\u6027\u3002</p> <p>\u5177\u4f53\u7684\u8bbe\u8ba1\u65b9\u6cd5\uff0c\u53ef\u4ee5\u5206\u4e3a\u7eb5\u5411\u4e0a\u6dfb\u52a0\u7f13\u5b58\uff0c\u6a2a\u5411\u4e0a\u6dfb\u52a0\u526f\u672c\u8fdb\u7a0b\u4e24\u79cd\u505a\u6cd5\u3002\u5bf9\u4e8e\u7f13\u5b58\u7684\u66f4\u65b0\uff0cwrite through \u6a21\u5f0f\u4fdd\u6301\u4e00\u81f4\u6027\u66f4\u5bb9\u6613\uff0c\u4f46\u5199\u8bf7\u6c42\u7684\u65f6\u5ef6\u504f\u9ad8\uff0c\u800c\u4e00\u81f4\u6027\u6a21\u578b\u66f4\u590d\u6742\u7684 write back \u6a21\u5f0f\u65f6\u5ef6\u5219\u66f4\u4f4e\uff0c\u9002\u7528\u4e8e\u6027\u80fd\u8981\u6c42\u5f88\u9ad8\u7684\u573a\u666f\u3002</p> <p>\u63d0\u5347\u7cfb\u7edf\u5e76\u53d1\u6027\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0\u6570\u636e\u526f\u672c\uff0c\u5e76\u8ba9\u5de5\u4f5c\u5728\u526f\u672c\u4e0a\u7684\u8fdb\u7a0b\u540c\u65f6\u5bf9\u7528\u6237\u63d0\u4f9b\u670d\u52a1\u3002</p> <p>\u526f\u672c\u95f4\u7684\u6570\u636e\u540c\u6b65\u662f\u7531\u5199\u8bf7\u6c42\u89e6\u53d1\u7684\uff0c\u5176\u4e2d\u5305\u62ec\u540c\u6b65\u3001\u5f02\u6b65\u4e24\u79cd\u540c\u6b65\u65b9\u5f0f\u3002\u5f02\u6b65\u65b9\u5f0f\u7684\u6700\u7ec8\u4e00\u81f4\u6027\u8981\u5dee\u4e00\u4e9b\uff0c\u4f46\u5199\u8bf7\u6c42\u7684\u5904\u7406\u65f6\u5ef6\u66f4\u5feb\u3002\u5728\u5b95\u673a\u6062\u590d\u3001\u7cfb\u7edf\u6269\u5bb9\u65f6\uff0c\u91c7\u7528\u5feb\u7167\u52a0\u64cd\u4f5c\u65e5\u5fd7\u7684\u65b9\u5f0f\uff0c\u7cfb\u7edf\u7684\u6027\u80fd\u4f1a\u597d\u5f88\u591a\u3002</p>"},{"location":"chap3/3perf_akf/","title":"\u7b2c\u4e09\u8282 AKF\u7acb\u65b9\u4f53\u53ef\u6269\u5c55\u6027\u6765\u63d0\u9ad8\u6027\u80fd","text":"<p>\u5728\u9762\u5bf9 Scalability \u53ef\u4f38\u7f29\u6027\u95ee\u9898\u65f6\uff0c\u6211\u4eec\u5fc5\u987b\u6709\u4e00\u4e2a\u7cfb\u7edf\u7684\u65b9\u6cd5\u8bba\uff0c\u624d\u80fd\u5e94\u5bf9\u65e5\u76ca\u590d\u6742\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u3002\u8fd9\u4e00\u8bb2\u6211\u5c06\u4ecb\u7ecd AKF \u7acb\u65b9\u4f53\u7406\u8bba\uff0c\u5b83\u5b9a\u4e49\u4e86\u6269\u5c55\u7cfb\u7edf\u7684 3 \u4e2a\u7ef4\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u7efc\u5408\u4f7f\u7528\u5b83\u4eec\u6765\u4f18\u5316\u6027\u80fd\u3002 </p>"},{"location":"chap3/3perf_akf/#1-akf-x","title":"1\u3001\u5982\u4f55\u57fa\u4e8e AKF X \u8f74\u6269\u5c55\u7cfb\u7edf\uff1f","text":"<p>AKF \u7acb\u65b9\u4f53\u4e5f\u53eb\u505ascala cube\uff0c\u5b83\u5728\u300aThe Art of Scalability\u300b\u4e00\u4e66\u4e2d\u88ab\u9996\u6b21\u63d0\u51fa\uff0c\u65e8\u5728\u63d0\u4f9b\u4e00\u4e2a\u7cfb\u7edf\u5316\u7684\u6269\u5c55\u601d\u8def\u3002AKF \u628a\u7cfb\u7edf\u6269\u5c55\u5206\u4e3a\u4ee5\u4e0b\u4e09\u4e2a\u7ef4\u5ea6\uff1a</p> <ul> <li>X \u8f74\uff1a\u76f4\u63a5\u6c34\u5e73\u590d\u5236\u5e94\u7528\u8fdb\u7a0b\u6765\u6269\u5c55\u7cfb\u7edf\u3002</li> <li>Y \u8f74\uff1a\u5c06\u529f\u80fd\u62c6\u5206\u51fa\u6765\u6269\u5c55\u7cfb\u7edf\u3002</li> <li>Z \u8f74\uff1a\u57fa\u4e8e\u7528\u6237\u4fe1\u606f\u6269\u5c55\u7cfb\u7edf\u3002</li> </ul> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u5047\u5b9a\u6211\u4eec\u5f00\u53d1\u4e00\u4e2a\u535a\u5ba2\u5e73\u53f0\uff0c\u7528\u6237\u53ef\u4ee5\u7533\u8bf7\u81ea\u5df1\u7684\u535a\u5ba2\u5e10\u53f7\uff0c\u5e76\u5728\u5176\u4e0a\u53d1\u5e03\u6587\u7ae0\u3002\u6700\u521d\u7684\u7cfb\u7edf\u8003\u8651\u4e86 MVC \u67b6\u6784\uff0c\u5c06\u6570\u636e\u72b6\u6001\u53ca\u5173\u7cfb\u6a21\u578b\u4ea4\u7ed9\u6570\u636e\u5e93\u5b9e\u73b0\uff0c\u5e94\u7528\u8fdb\u7a0b\u901a\u8fc7 SQL \u8bed\u8a00\u64cd\u4f5c\u6570\u636e\u6a21\u578b\uff0c\u7ecf\u7531 HTTP \u534f\u8bae\u5bf9\u6d4f\u89c8\u5668\u5ba2\u6237\u7aef\u63d0\u4f9b\u670d\u52a1\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u5728\u8fd9\u4e2a\u67b6\u6784\u4e2d\uff0c\u5904\u7406\u4e1a\u52a1\u7684\u5e94\u7528\u8fdb\u7a0b\u5c5e\u4e8e\u65e0\u72b6\u6001\u670d\u52a1\uff0c\u7528\u6237\u6570\u636e\u5168\u90e8\u653e\u5728\u4e86\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u3002\u56e0\u6b64\uff0c\u5f53\u6211\u4eec\u5728\u5e94\u7528\u8fdb\u7a0b\u524d\u52a0 1 \u4e2a\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u540e\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u90e8\u7f72\u66f4\u591a\u7684\u5e94\u7528\u8fdb\u7a0b\uff0c\u63d0\u4f9b\u66f4\u5927\u7684\u541e\u5410\u91cf\u3002</p> <p>\u800c\u4e14\uff0c\u521d\u671f\u589e\u52a0\u5e94\u7528\u8fdb\u7a0b\uff0cRPS \u53ef\u4ee5\u83b7\u5f97\u7ebf\u6027\u589e\u957f\uff0c\u5f88\u5b9e\u7528\u3002</p> <p></p> <p>\u8fd9\u5c31\u53eb\u505a\u6cbf AKF X \u8f74\u6269\u5c55\u7cfb\u7edf\u3002\u8fd9\u79cd\u6269\u5c55\u65b9\u5f0f\u6700\u5927\u7684\u4f18\u70b9\uff0c\u5c31\u662f\u5f00\u53d1\u6210\u672c\u8fd1\u4e4e\u4e3a\u96f6\uff0c\u800c\u4e14\u5b9e\u65bd\u8d77\u6765\u901f\u5ea6\u5feb\uff01\u5728\u642d\u5efa\u597d\u8d1f\u8f7d\u5747\u8861\u540e\uff0c\u53ea\u9700\u8981\u5728\u65b0\u7684\u7269\u7406\u673a\u3001\u865a\u62df\u673a\u6216\u8005\u5fae\u670d\u52a1\u4e0a\u590d\u5236\u7a0b\u5e8f\uff0c\u5c31\u53ef\u4ee5\u8ba9\u65b0\u8fdb\u7a0b\u5206\u62c5\u8bf7\u6c42\u6d41\u91cf\uff0c\u800c\u4e14\u4e0d\u4f1a\u5f71\u54cd\u4e8b\u52a1 Transaction \u7684\u5904\u7406\u3002</p> <p>AKF X \u8f74\u6269\u5c55\u6700\u5927\u7684\u95ee\u9898\u662f\u53ea\u80fd\u6269\u5c55\u65e0\u72b6\u6001\u670d\u52a1\uff0c\u5f53\u6709\u72b6\u6001\u7684\u6570\u636e\u5e93\u51fa\u73b0\u6027\u80fd\u74f6\u9888\u65f6\uff0cX \u8f74\u662f\u65e0\u80fd\u4e3a\u529b\u7684</p> <p>\u4f8b\u5982\uff0c\u5f53\u7528\u6237\u6570\u636e\u91cf\u6301\u7eed\u589e\u957f\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u7684\u8868\u5c31\u4f1a\u8fbe\u5230\u767e\u4e07\u3001\u5343\u4e07\u884c\u6570\u636e\uff0cSQL \u8bed\u53e5\u4f1a\u8d8a\u6765\u8d8a\u6162\uff0c\u8fd9\u65f6\u53ef\u4ee5\u6cbf\u7740 AKF Z \u8f74\u53bb\u5206\u5e93\u5206\u8868\u63d0\u5347\u6027\u80fd\u3002\u53c8\u6bd4\u5982\uff0c\u5f53\u8bf7\u6c42\u7528\u6237\u9891\u7387\u8d8a\u6765\u8d8a\u9ad8\uff0c\u90a3\u4e48\u53ef\u4ee5\u628a\u5355\u5b9e\u4f8b\u6570\u636e\u5e93\u6269\u5c55\u4e3a\u4e3b\u5907\u591a\u5b9e\u4f8b\uff0c\u6cbf Y \u8f74\u628a\u8bfb\u5199\u529f\u80fd\u5206\u79bb\u63d0\u5347\u6027\u80fd\u3002</p>"},{"location":"chap3/3perf_akf/#2-akf-y","title":"2\u3001\u5982\u4f55\u57fa\u4e8e AKF Y \u8f74\u6269\u5c55\u7cfb\u7edf\uff1f","text":"<p>\u5f53\u6570\u636e\u5e93\u7684 CPU\u3001\u7f51\u7edc\u5e26\u5bbd\u3001\u5185\u5b58\u3001\u78c1\u76d8 IO \u7b49\u67d0\u4e2a\u6307\u6807\u7387\u5148\u8fbe\u5230\u4e0a\u9650\u540e\uff0c\u7cfb\u7edf\u7684\u541e\u5410\u91cf\u5c31\u8fbe\u5230\u4e86\u74f6\u9888\uff0c\u6b64\u65f6\u6cbf\u7740 AKF X \u8f74\u6269\u5c55\u7cfb\u7edf\uff0c\u662f\u6ca1\u6709\u529e\u6cd5\u63d0\u5347\u6027\u80fd\u7684\u3002</p> <p>\u5728\u73b0\u4ee3\u7ecf\u6d4e\u4e2d\uff0c\u66f4\u7ec6\u5206\u3001\u66f4\u4e13\u4e1a\u7684\u4ea7\u4e1a\u5316\u3001\u4f9b\u5e94\u94fe\u5206\u5de5\uff0c\u53ef\u4ee5\u7ed9\u793e\u4f1a\u5e26\u6765\u66f4\u9ad8\u7684\u6548\u7387\uff0c\u800c AKF Y \u8f74\u4e0e\u4e4b\u76f8\u4f3c\uff0c\u5f53\u9047\u5230\u4e0a\u8ff0\u6027\u80fd\u74f6\u9888\u540e\uff0c\u62c6\u5206\u7cfb\u7edf\u529f\u80fd\uff0c\u4f7f\u5f97\u5404\u7ec4\u4ef6\u7684\u804c\u8d23\u3001\u5206\u5de5\u66f4\u7ec6\uff0c\u4e5f\u53ef\u4ee5\u63d0\u5347\u7cfb\u7edf\u7684\u6548\u7387\u3002</p> <p>\u6bd4\u5982\uff0c\u5f53\u6211\u4eec\u5c06\u5e94\u7528\u8fdb\u7a0b\u5bf9\u6570\u636e\u5e93\u7684\u8bfb\u5199\u64cd\u4f5c\u62c6\u5206\u540e\uff0c\u5c31\u53ef\u4ee5\u6269\u5c55\u5355\u673a\u6570\u636e\u5e93\u4e3a\u4e3b\u5907\u5206\u5e03\u5f0f\u7cfb\u7edf\uff0c\u4f7f\u5f97\u4e3b\u5e93\u652f\u6301\u8bfb\u5199\u4e24\u79cd SQL\uff0c\u800c\u5907\u5e93\u53ea\u652f\u6301\u8bfb SQL\u3002\u8fd9\u6837\uff0c\u4e3b\u5e93\u53ef\u4ee5\u8f7b\u677e\u5730\u652f\u6301\u4e8b\u52a1\u64cd\u4f5c\uff0c\u4e14\u5b83\u5c06\u6570\u636e\u540c\u6b65\u5230\u5907\u5e93\u4e2d\u4e5f\u5e76\u4e0d\u590d\u6742\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u5f53\u7136\uff0c\u4e0a\u56fe\u4e2d\u5982\u679c\u8bfb\u6027\u80fd\u8fbe\u5230\u4e86\u74f6\u9888\uff0c\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u6cbf\u7740 AKF X \u8f74\uff0c\u7528\u590d\u5236\u7684\u65b9\u5f0f\u6269\u5c55\u591a\u4e2a\u5907\u5e93\uff0c\u63d0\u5347\u8bfb SQL \u7684\u6027\u80fd\uff0c\u53ef\u89c1\uff0cAKF \u591a\u4e2a\u8f74\u5b8c\u5168\u53ef\u4ee5\u642d\u914d\u7740\u534f\u540c\u4f7f\u7528\u3002</p> <p>\u62c6\u5206\u529f\u80fd\u662f\u9700\u8981\u91cd\u6784\u4ee3\u7801\u7684\uff0c\u5b83\u7684\u5b9e\u65bd\u6210\u672c\u6bd4\u6cbf X \u8f74\u7b80\u5355\u590d\u5236\u6269\u5c55\u8981\u9ad8\u5f97\u591a\u3002\u5728\u4e0a\u56fe\u4e2d\uff0c\u901a\u5e38\u5173\u7cfb\u6570\u636e\u5e93\u7684\u5ba2\u6237\u7aef SDK \u5df2\u7ecf\u652f\u6301\u8bfb\u5199\u5206\u79bb\uff0c\u6240\u4ee5\u5b9e\u65bd\u6210\u672c\u7531\u4e2d\u95f4\u4ef6\u627f\u62c5\u4e86\uff0c\u8fd9\u5bf9\u6211\u4eec\u7406\u89e3 Y \u8f74\u7684\u5b9e\u65bd\u4ee3\u4ef7\u610f\u4e49\u4e0d\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u518d\u6765\u770b\u4ece\u4e1a\u52a1\u4e0a\u62c6\u5206\u529f\u80fd\u7684\u4f8b\u5b50\u3002</p> <p>\u5f53\u8fd9\u4e2a\u535a\u5ba2\u5e73\u53f0\u8bbf\u95ee\u91cf\u8d8a\u6765\u8d8a\u5927\u65f6\uff0c\u4e00\u53f0\u4e3b\u5e93\u662f\u65e0\u6cd5\u625b\u4f4f\u6240\u6709\u5199\u6d41\u91cf\u7684\u3002\u56e0\u6b64\uff0c\u57fa\u4e8e\u4e1a\u52a1\u7279\u6027\u62c6\u5206\u529f\u80fd\uff0c\u5c31\u662f\u5fc5\u987b\u8981\u505a\u7684\u5de5\u4f5c\u3002\u6bd4\u5982\uff0c\u628a\u7528\u6237\u7684\u4e2a\u4eba\u4fe1\u606f\u3001\u8eab\u4efd\u9a8c\u8bc1\u7b49\u529f\u80fd\u62c6\u5206\u51fa\u4e00\u4e2a\u5b50\u7cfb\u7edf\uff0c\u518d\u628a\u6587\u7ae0\u3001\u7559\u8a00\u53d1\u5e03\u7b49\u529f\u80fd\u62c6\u5206\u5230\u53e6\u4e00\u4e2a\u5b50\u7cfb\u7edf\uff0c\u7531\u65e0\u72b6\u6001\u7684\u4e1a\u52a1\u5c42\u4ee3\u7801\u5206\u5f00\u8c03\u7528\uff0c\u5e76\u901a\u8fc7\u4e8b\u52a1\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u6bcf\u4e2a\u540e\u7aef\u7684\u5b50\u5e94\u7528\u66f4\u52a0\u805a\u7126\u4e8e\u7ec6\u5206\u7684\u529f\u80fd\uff0c\u5b83\u7684\u6570\u636e\u5e93\u89c4\u6a21\u4f1a\u53d8\u5c0f\uff0c\u4e5f\u66f4\u5bb9\u6613\u4f18\u5316\u6027\u80fd\u3002\u6bd4\u5982\uff0c\u9488\u5bf9\u7528\u6237\u767b\u5f55\u529f\u80fd\uff0c\u4f60\u53ef\u4ee5\u518d\u6b21\u57fa\u4e8e Y \u8f74\u5c06\u8eab\u4efd\u9a8c\u8bc1\u529f\u80fd\u62c6\u5206\uff0c\u7528 Redis \u7b49\u670d\u52a1\u642d\u5efa\u4e00\u4e2a\u57fa\u4e8e LRU \u7b97\u6cd5\u6dd8\u6c70\u7684\u7f13\u5b58\u7cfb\u7edf\uff0c\u5feb\u901f\u9a8c\u8bc1\u7528\u6237\u8eab\u4efd\u3002</p> <p>\u7136\u800c\uff0c\u6cbf Y \u8f74\u505a\u529f\u80fd\u62c6\u5206\uff0c\u5b9e\u65bd\u6210\u672c\u975e\u5e38\u9ad8\uff0c\u9700\u8981\u91cd\u6784\u4ee3\u7801\u5e76\u505a\u5927\u91cf\u6d4b\u8bd5\u5de5\u4f5c\uff0c\u4e0a\u7ebf\u90e8\u7f72\u4e5f\u5f88\u590d\u6742\u3002\u6bd4\u5982\u4e0a\u4f8b\u4e2d\u8981\u5bf9\u6570\u636e\u6a21\u578b\u505a\u62c6\u5206\uff08\u5982\u540c\u4e00\u4e2a\u5e93\u4e2d\u7684\u8868\u62c6\u5206\u5230\u591a\u4e2a\u5e93\u4e2d\uff0c\u6216\u8005\u8868\u4e2d\u7684\u5b57\u6bb5\u62c6\u5230\u591a\u5f20\u8868\u4e2d\uff09\uff0c\u8bbe\u8ba1\u7ec4\u4ef6\u4e4b\u95f4\u7684 API \u4ea4\u4e92\u534f\u8bae\uff0c\u91cd\u6784\u65e0\u72b6\u6001\u5e94\u7528\u8fdb\u7a0b\u4e2d\u7684\u4ee3\u7801\uff0c\u4e3a\u4e86\u5b8c\u6210\u5347\u7ea7\u8fd8\u8981\u505a\u6570\u636e\u8fc1\u79fb\uff0c\u7b49\u7b49\u3002</p>"},{"location":"chap3/3perf_akf/#3-akf-z","title":"3\u3001\u5982\u4f55\u57fa\u4e8e AKF Z \u8f74\u6269\u5c55\u7cfb\u7edf\uff1f","text":"<p>\u4e0d\u540c\u4e8e\u7ad9\u5728\u670d\u52a1\u89d2\u5ea6\u6269\u5c55\u7cfb\u7edf\u7684 X \u8f74\u548c Y \u8f74\uff0cAKF Z \u8f74\u5219\u4ece\u7528\u6237\u7ef4\u5ea6\u62c6\u5206\u7cfb\u7edf\uff0c\u5b83\u4e0d\u4ec5\u53ef\u4ee5\u63d0\u5347\u6570\u636e\u6301\u7eed\u589e\u957f\u964d\u4f4e\u7684\u6027\u80fd\uff0c\u8fd8\u80fd\u57fa\u4e8e\u7528\u6237\u7684\u5730\u7406\u4f4d\u7f6e\u83b7\u5f97\u989d\u5916\u6536\u76ca\u3002</p> <p>\u4ecd\u7136\u4ee5\u4e0a\u9762\u865a\u62df\u7684\u535a\u5ba2\u5e73\u53f0\u4e3a\u4f8b\uff0c\u5f53\u6ce8\u518c\u7528\u6237\u6570\u91cf\u4e0a\u4ebf\u540e\uff0c\u65e0\u8bba\u4f60\u5982\u4f55\u57fa\u4e8e Y \u8f74\u7684\u529f\u80fd\u53bb\u62c6\u5206\u8868\uff08\u5373\u201c\u5782\u76f4\u201d\u5730\u62c6\u5206\u8868\u4e2d\u7684\u5b57\u6bb5\uff09\uff0c\u90fd\u65e0\u6cd5\u4f7f\u5f97\u5173\u7cfb\u6570\u636e\u5e93\u5355\u4e2a\u8868\u7684\u884c\u6570\u5728\u5343\u4e07\u7ea7\u4ee5\u4e0b\uff0c\u8fd9\u6837\u8868\u5b57\u6bb5\u7684 B \u6811\u7d22\u5f15\u975e\u5e38\u5e9e\u5927\uff0c\u96be\u4ee5\u5b8c\u5168\u653e\u5728\u5185\u5b58\u4e2d\uff0c\u6700\u540e\u5927\u91cf\u7684\u78c1\u76d8 IO \u64cd\u4f5c\u4f1a\u62d6\u6162 SQL \u8bed\u53e5\u7684\u6267\u884c\u3002</p> <p>\u8fd9\u4e2a\u65f6\u5019\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u6700\u5e38\u7528\u7684\u5206\u5e93\u5206\u8868\u64cd\u4f5c\u5c31\u767b\u573a\u4e86\uff0c\u5b83\u6b63\u662f AKF \u6cbf Z \u8f74\u62c6\u5206\u7cfb\u7edf\u7684\u5b9e\u8df5\u3002\u6bd4\u5982\u5df2\u7ecf\u542b\u6709\u4e0a\u4ebf\u884c\u6570\u636e\u7684 User \u7528\u6237\u4fe1\u606f\u8868\uff0c\u53ef\u4ee5\u5206\u6210 10 \u4e2a\u5e93\uff0c\u6bcf\u4e2a\u5e93\u518d\u5206\u6210 10 \u5f20\u8868\uff0c\u5229\u7528\u56fa\u5b9a\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u5c31\u53ef\u4ee5\u628a\u6bcf\u4e2a\u7528\u6237\u7684\u6570\u636e\u6620\u5c04\u5230\u67d0\u4e2a\u5e93\u7684\u67d0\u5f20\u8868\u4e2d\u3002\u8fd9\u6837\uff0c\u5355\u5f20\u8868\u7684\u6570\u636e\u91cf\u5c31\u53ef\u4ee5\u964d\u4f4e\u5230 1 \u767e\u4e07\u884c\u5de6\u53f3\uff0c\u5982\u679c\u6bcf\u4e2a\u5e93\u90e8\u7f72\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\uff08\u5177\u4f53\u7684\u90e8\u7f72\u65b9\u5f0f\u89c6\u8bbf\u95ee\u541e\u5410\u91cf\u4ee5\u53ca\u670d\u52a1\u5668\u7684\u914d\u7f6e\u800c\u5b9a\uff09\uff0c\u5b83\u4eec\u5904\u7406\u7684\u6570\u636e\u91cf\u51cf\u5c11\u4e86\u5f88\u591a\uff0c\u5374\u53ef\u4ee5\u72ec\u5360\u670d\u52a1\u5668\u7684\u786c\u4ef6\u8d44\u6e90\uff0c\u6027\u80fd\u81ea\u7136\u5c31\u6709\u4e86\u63d0\u5347\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u5206\u5e93\u5206\u8868\u662f\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u89e3\u51b3\u6570\u636e\u589e\u957f\u538b\u529b\u7684\u6700\u6709\u6548\u529e\u6cd5\uff0c\u4f46\u5206\u5e93\u5206\u8868\u540c\u65f6\u4e5f\u5bfc\u81f4\u8de8\u8868\u7684\u67e5\u8be2\u8bed\u53e5\u590d\u6742\u8bb8\u591a\uff0c\u800c\u8de8\u5e93\u7684\u4e8b\u52a1\u51e0\u4e4e\u96be\u4ee5\u5b9e\u73b0\uff0c\u56e0\u6b64\u8fd9\u79cd\u6269\u5c55\u7684\u4ee3\u4ef7\u975e\u5e38\u9ad8\u3002</p> <p>\u5f53\u7136\uff0c\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f\u7c7b\u4f3c MySQL \u8fd9\u4e9b\u6210\u719f\u7684\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u6574\u4e2a\u751f\u6001\u4e2d\u4f1a\u6709\u5382\u5546\u63d0\u4f9b\u76f8\u5e94\u7684\u4e2d\u95f4\u4ef6\u5c42\uff0c\u4f7f\u7528\u5b83\u4eec\u53ef\u4ee5\u964d\u4f4e Z \u8f74\u6269\u5c55\u7684\u4ee3\u4ef7\u3002</p> <p>\u518d\u6bd4\u5982\uff0c\u6700\u5f00\u59cb\u6211\u4eec\u91c7\u7528 X \u8f74\u590d\u5236\u6269\u5c55\u7684\u670d\u52a1\uff0c\u5b83\u4eec\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u5f88\u7b80\u5355\uff0c\u53ea\u9700\u8981\u9009\u62e9\u8d1f\u8f7d\u6700\u5c0f\u7684\u4e0a\u6e38\u670d\u52a1\u5668\u5373\u53ef\uff0c\u6bd4\u5982 RoundRobin \u6216\u8005\u6700\u5c0f\u8fde\u63a5\u7b97\u6cd5\u90fd\u53ef\u4ee5\u8fbe\u5230\u76ee\u7684\u3002</p> <p>\u4f46\u82e5\u4e0a\u6e38\u670d\u52a1\u5668\u901a\u8fc7 Y \u8f74\u6269\u5c55\uff0c\u5f00\u542f\u4e86\u7f13\u5b58\u529f\u80fd\uff0c\u90a3\u4e48\u8003\u8651\u5230\u7f13\u5b58\u7684\u547d\u4e2d\u7387\uff0c\u5c31\u5fc5\u987b\u6539\u7528 Z \u8f74\u6269\u5c55\u7684\u65b9\u5f0f\uff0c\u57fa\u4e8e\u7528\u6237\u4fe1\u606f\u505a\u54c8\u5e0c\u89c4\u5219\u4e0b\u7684\u65b0\u8def\u7531\uff0c\u5c3d\u91cf\u5c06\u540c\u4e00\u4e2a\u7528\u6237\u7684\u8bf7\u6c42\u547d\u4e2d\u76f8\u540c\u7684\u4e0a\u6e38\u670d\u52a1\u5668\uff0c\u624d\u80fd\u5145\u5206\u63d0\u9ad8\u7f13\u5b58\u547d\u4e2d\u7387\u3002</p> <p>Z \u8f74\u6269\u5c55\u8fd8\u6709\u4e00\u4e2a\u597d\u5904\uff0c\u5c31\u662f\u53ef\u4ee5\u5145\u5206\u5229\u7528 IDC \u4e0e\u7528\u6237\u95f4\u7684\u7f51\u901f\u5dee\uff0c\u9009\u62e9\u66f4\u5feb\u7684 IDC \u4e3a\u7528\u6237\u63d0\u4f9b\u9ad8\u6027\u80fd\u670d\u52a1\u3002\u7f51\u7edc\u662f\u57fa\u4e8e\u5149\u901f\u4f20\u64ad\u7684\uff0c\u5f53 IDC \u8de8\u57ce\u5e02\u3001\u56fd\u5bb6\u751a\u81f3\u5927\u6d32\u65f6\uff0c\u7528\u6237\u8bbf\u95ee\u4e0d\u540c IDC \u7684\u7f51\u901f\u5c31\u4f1a\u6709\u5f88\u5927\u5dee\u5f02\u3002\u5f53\u7136\uff0c\u540c\u4e00\u5730\u57df\u5185\u4e0d\u540c\u7684\u7f51\u7edc\u8fd0\u8425\u5546\u4e4b\u95f4\uff0c\u4e5f\u4f1a\u6709\u5f88\u5927\u7684\u7f51\u901f\u5dee\u3002</p> <p>\u4f8b\u5982\u4f60\u5728\u5168\u7403\u90fd\u6709 IDC \u6216\u8005\u516c\u6709\u4e91\u670d\u52a1\u5668\u65f6\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u57df\u540d\u4e3a\u5f53\u5730\u7528\u6237\u5c31\u8fd1\u63d0\u4f9b\u670d\u52a1\uff0c\u8fd9\u6837\u6027\u80fd\u4f1a\u9ad8\u5f88\u591a\u3002\u4e8b\u5b9e\u4e0a\uff0cCDN \u6280\u672f\u5c31\u57fa\u4e8e IP \u5730\u5740\u7684\u4f4d\u7f6e\u4fe1\u606f\uff0c\u5c31\u8fd1\u4e3a\u7528\u6237\u63d0\u4f9b\u9759\u6001\u8d44\u6e90\u7684\u9ad8\u901f\u8bbf\u95ee\u3002</p> <p>\u7528\u4e86 2 \u79cd Z \u8f74\u6269\u5c55\u7cfb\u7edf\u7684\u65b9\u5f0f\u3002\u9996\u5148\u662f\u57fa\u4e8e\u5ba2\u6237\u7aef\u7684\u5730\u7406\u4f4d\u7f6e\uff0c\u9009\u62e9\u4e0d\u540c\u7684 IDC \u5c31\u8fd1\u63d0\u4f9b\u670d\u52a1\u3002\u5176\u6b21\u662f\u5c06\u4e0d\u540c\u7684\u7528\u6237\u5206\u7ec4\uff0c\u6bd4\u5982\u514d\u8d39\u7528\u6237\u7ec4\u4e0e\u4ed8\u8d39\u7528\u6237\u7ec4\uff0c\u8fd9\u6837\u5728\u4e1a\u52a1\u4e0a\u5206\u79bb\u7528\u6237\u7fa4\u4f53\u540e\uff0c\u8fd8\u53ef\u4ee5\u6709\u9488\u5bf9\u6027\u5730\u63d0\u4f9b\u4e0d\u540c\u6c34\u51c6\u7684\u670d\u52a1\u3002</p> <p></p> <p>\u6cbf AKF Z \u8f74\u6269\u5c55\u7cfb\u7edf\u53ef\u4ee5\u89e3\u51b3\u6570\u636e\u589e\u957f\u5e26\u6765\u7684\u6027\u80fd\u74f6\u9888\uff0c\u4e5f\u53ef\u4ee5\u57fa\u4e8e\u6570\u636e\u7684\u7a7a\u95f4\u4f4d\u7f6e\u63d0\u5347\u7cfb\u7edf\u6027\u80fd\uff0c\u7136\u800c\u5b83\u7684\u5b9e\u65bd\u6210\u672c\u6bd4\u8f83\u9ad8\uff0c\u5c24\u5176\u662f\u5728\u7cfb\u7edf\u5b95\u673a\u3001\u6269\u5bb9\u65f6\uff0c\u4e00\u65e6\u8def\u7531\u89c4\u5219\u53d1\u751f\u53d8\u5316\uff0c\u4f1a\u5e26\u6765\u5f88\u5927\u7684\u6570\u636e\u8fc1\u79fb\u6210\u672c\uff0c</p>"},{"location":"chap3/3perf_akf/#4","title":"4\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>X \u8f74\u6269\u5c55\u7cfb\u7edf\u65f6\u5b9e\u65bd\u6210\u672c\u6700\u4f4e\uff0c\u53ea\u9700\u8981\u5c06\u7a0b\u5e8f\u590d\u5236\u5230\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\uff0c\u518d\u7528\u4e0b\u6e38\u7684\u8d1f\u8f7d\u5747\u8861\u5206\u914d\u6d41\u91cf\u5373\u53ef\u3002  X \u8f74\u53ea\u80fd\u5e94\u7528\u5728\u65e0\u72b6\u6001\u8fdb\u7a0b\u4e0a\uff0c\u6545\u65e0\u6cd5\u89e3\u51b3\u6570\u636e\u589e\u957f\u5f15\u5165\u7684\u6027\u80fd\u74f6\u9888\u3002</p> <p>Y \u8f74\u6269\u5c55\u7cfb\u7edf\u65f6\u5b9e\u65bd\u6210\u672c\u6700\u9ad8\uff0c\u901a\u5e38\u6d89\u53ca\u5230\u90e8\u5206\u4ee3\u7801\u7684\u91cd\u6784\uff0c\u4f46\u5b83\u901a\u8fc7\u62c6\u5206\u529f\u80fd\uff0c\u4f7f\u7cfb\u7edf\u4e2d\u7684\u7ec4\u4ef6\u5206\u5de5\u66f4\u7ec6\uff0c\u56e0\u6b64\u53ef\u4ee5\u89e3\u51b3\u6570\u636e\u589e\u957f\u5e26\u6765\u7684\u6027\u80fd\u538b\u529b\uff0c\u4e5f\u53ef\u4ee5\u63d0\u5347\u7cfb\u7edf\u7684\u603b\u4f53\u6548\u7387\u3002\u6bd4\u5982\u5173\u7cfb\u6570\u636e\u5e93\u7684\u8bfb\u5199\u5206\u79bb\u3001\u8868\u5b57\u6bb5\u7684\u5782\u76f4\u62c6\u5206\uff0c\u6216\u8005\u5f15\u5165\u7f13\u5b58\uff0c\u90fd\u5c5e\u4e8e\u6cbf Y \u8f74\u6269\u5c55\u7cfb\u7edf\u3002</p> <p>Z \u8f74\u6269\u5c55\u7cfb\u7edf\u65f6\u5b9e\u65bd\u6210\u672c\u4e5f\u6bd4\u8f83\u9ad8\uff0c\u4f46\u5b83\u57fa\u4e8e\u7528\u6237\u4fe1\u606f\u62c6\u5206\u6570\u636e\u540e\uff0c\u53ef\u4ee5\u5728\u89e3\u51b3\u6570\u636e\u589e\u957f\u95ee\u9898\u7684\u540c\u65f6\uff0c\u57fa\u4e8e\u5730\u7406\u4f4d\u7f6e\u5c31\u8fd1\u63d0\u4f9b\u670d\u52a1\uff0c\u8fdb\u800c\u5927\u5e45\u5ea6\u964d\u4f4e\u8bf7\u6c42\u7684\u65f6\u5ef6\uff0c\u6bd4\u5982\u5e38\u89c1\u7684 CDN \u5c31\u662f\u8fd9\u4e48\u63d0\u5347\u7528\u6237\u4f53\u9a8c\u7684\u3002\u4f46 Z \u8f74\u6269\u5c55\u7cfb\u7edf\u540e\uff0c\u4e00\u65e6\u53d1\u751f\u8def\u7531\u89c4\u5219\u7684\u53d8\u52a8\u5bfc\u81f4\u6570\u636e\u8fc1\u79fb\u65f6\uff0c\u8fd0\u7ef4\u6210\u672c\u5c31\u4f1a\u6bd4\u8f83\u9ad8\u3002</p>"},{"location":"chap3/4perf_nwr/","title":"\u7b2c\u56db\u8282 NWR\u7b97\u6cd5\u4fee\u6539\u8bfb\u5199\u6a21\u578b\u4ee5\u63d0\u5347\u6027\u80fd","text":"<p>\u6570\u636e\u5e93\u7684\u6269\u5c55\u65f6\uff0c\u5199\u8bf7\u6c42\u4ecd\u7136\u5728\u64cd\u4f5c\u4e2d\u5fc3\u5316\u7684 Master \u5355\u70b9\uff0c\u8fd9\u5728\u5f88\u591a\u4e1a\u52a1\u573a\u666f\u4e0b\u90fd\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\u3002\u8fd9\u4e00\u8bb2\u5c06\u4ecb\u7ecd\u5bf9\u4e8e\u65e0\u5355\u70b9\u7684\u53bb\u4e2d\u5fc3\u5316\u7cfb\u7edf\u975e\u5e38\u6709\u7528\u7684 NWR \u7b97\u6cd5\uff0c\u5b83\u53ef\u4ee5\u7075\u6d3b\u5730\u5e73\u8861\u4e00\u81f4\u6027\u4e0e\u6027\u80fd\u3002</p> <p>\u5728\u5355\u673a\u4e0a\u90e8\u7f72\u6570\u636e\u5e93\uff0c\u4e00\u65e6\u6027\u80fd\u5230\u8fbe\u74f6\u9888\uff0c\u6211\u4eec\u53ef\u4ee5\u57fa\u4e8e AKF Y \u8f74\u5c06\u8bfb\u5199\u5206\u79bb\uff0c\u8fd9\u6837\u591a\u4e2a Slave \u4ece\u5e93\u5c06\u8bfb\u64cd\u4f5c\u5206\u6d41\u540e\uff0c\u5199\u64cd\u4f5c\u5c31\u53ef\u4ee5\u72ec\u4eab Master \u4e3b\u5e93\u7684\u5168\u90e8\u6027\u80fd\u3002</p> <p>\u7136\u800c\u4e3b\u5e93\u4f5c\u4e3a\u4e2d\u5fc3\u5316\u7684\u5355\u70b9\uff0c\u4e00\u65e6\u5b95\u673a\uff0c\u672a\u53ca\u65f6\u540c\u6b65\u5230\u4ece\u5e93\u7684\u6570\u636e\u5c31\u6709\u53ef\u80fd\u4e22\u5931\u3002\u800c\u4e14\uff0c\u8fd9\u4e00\u67b6\u6784\u4e0b\uff0c\u4e3b\u5e93\u7684\u6545\u969c\u8fd8\u4f1a\u5bfc\u81f4\u6574\u4e2a\u7cfb\u7edf\u762b\u75ea\u3002</p> <p>\u53bb\u4e2d\u5fc3\u5316\u7cfb\u7edf\u4e2d\u6ca1\u6709\u201cMaster \u4e3b\u5e93\u201d\u8fd9\u4e00\u6982\u5ff5\uff0c\u6570\u636e\u5b58\u653e\u5728\u591a\u4e2a Replication \u5197\u4f59\u8282\u70b9\u4e0a\uff0c\u4e14\u8fd9\u4e9b\u8282\u70b9\u95f4\u5730\u4f4d\u5747\u7b49\uff0c\u6240\u4ee5\u6ca1\u6709\u5355\u70b9\u95ee\u9898\u3002</p> <p>\u4e3a\u4e86\u4fdd\u6301\u5f3a\u4e00\u81f4\u6027\uff0c\u7cfb\u7edf\u53ef\u4ee5\u8981\u6c42\u4fee\u6539\u6570\u636e\u65f6\uff0c\u5fc5\u987b\u540c\u65f6\u5199\u5165\u6240\u6709\u5197\u4f59\u8282\u70b9\uff0c\u624d\u80fd\u5411\u5ba2\u6237\u7aef\u8fd4\u56de\u6210\u529f\u3002\u4f46\u8fd9\u6837\u7cfb\u7edf\u7684\u53ef\u7528\u6027\u4e00\u5b9a\u5f88\u6210\u95ee\u9898\uff0c\u6bd5\u7adf\u5927\u89c4\u6a21\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u51fa\u73b0\u6545\u969c\u662f\u5e38\u6001\uff0c\u5199\u5165\u5168\u90e8\u8282\u70b9\u7684\u64cd\u4f5c\u6839\u672c\u65e0\u6cd5\u5bb9\u9519\uff0c\u4efb\u4f55 1 \u4e2a\u8282\u70b9\u5b95\u673a\u90fd\u4f1a\u9020\u6210\u5199\u64cd\u4f5c\u5931\u8d25\u3002\u800c\u4e14\uff0c\u540c\u6b65\u8282\u70b9\u8fc7\u591a\u4e5f\u4f1a\u5bfc\u81f4\u5199\u64cd\u4f5c\u6027\u80fd\u4f4e\u4e0b</p> <p>NWR \u7b97\u6cd5\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f88\u68d2\u7684\u8bfb\u5199\u6a21\u578b\uff0c\u53ef\u4ee5\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002\u8fd9\u91cc\u7684\u201cNWR\u201d\uff0c\u662f\u6307\u5728\u53bb\u4e2d\u5fc3\u5316\u7cfb\u7edf\u4e2d\u5c06 1 \u4efd\u6570\u636e\u5b58\u653e\u5728 N \u4e2a\u8282\u70b9\u4e0a\uff0c\u6bcf\u6b21\u64cd\u4f5c\u65f6\uff0c\u5199 W \u4e2a\u8282\u70b9\u3001\u8bfb R \u4e2a\u8282\u70b9\uff0c\u53ea\u8981\u8c03\u6574 W\u3001R \u4e0e N \u7684\u5173\u7cfb\uff0c\u5c31\u80fd\u52a8\u6001\u5730\u5e73\u8861\u4e00\u81f4\u6027\u4e0e\u6027\u80fd\u3002</p> <p>NWR \u5728 NoSQL \u6570\u636e\u5e93\u4e2d\u6709\u5f88\u5e7f\u6cdb\u7684\u5e94\u7528\uff0c\u6bd4\u5982 Amazon \u7684 Dynamo \u548c\u5f00\u6e90\u7684 Cassandra\uff0c\u8fd9\u4e9b\u6570\u636e\u5e93\u5f80\u5f80\u8de8\u8d8a\u591a\u4e2a IDC \u6570\u636e\u4e2d\u5fc3\uff0c\u5305\u542b\u6210\u5343\u4e0a\u4e07\u4e2a\u7269\u7406\u673a\u8282\u70b9\uff0c\u9002\u7528\u4e8e\u6d77\u91cf\u6570\u636e\u7684\u5b58\u50a8\u4e0e\u5904\u7406\u3002</p> <p>\u5206\u5e03\u5f0f\u952e\u503c\u5b58\u50a8 Dynamo \u7684\u5b9e\u73b0\u539f\u7406</p>"},{"location":"chap3/4perf_nwr/#1-nwr","title":"1\u3001\u4ece\u9e3d\u5de2\u539f\u7406\u5230 NWR \u7b97\u6cd5","text":"<p>NWR \u7b97\u6cd5\u662f\u7531\u9e3d\u5de2\u539f\u7406\u5f97\u6765\u7684\uff1a\u5982\u679c 10 \u53ea\u9e3d\u5b50\u653e\u5165 9 \u4e2a\u9e3d\u5de2\uff0c\u90a3\u4e48\u6709 1 \u4e2a\u9e3d\u5de2\u5185\u81f3\u5c11\u6709 2 \u53ea\u9e3d\u5b50\uff0c\u8fd9\u5c31\u662f\u9e3d\u5de2\u539f\u7406</p> <p>\u9e3d\u5de2\u539f\u7406\u544a\u8bc9\u6211\u4eec\uff0c\u53ea\u8981\u54c8\u5e0c\u51fd\u6570\u8f93\u5165\u4e3b\u952e\u7684\u503c\u8303\u56f4\u5927\u4e8e\u8f93\u51fa\u7d22\u5f15\uff0c\u51fa\u73b0\u51b2\u7a81\u7684\u6982\u7387\u5c31\u4e00\u5b9a\u5927\u4e8e 0\uff1b\u53ea\u8981\u5b58\u653e\u5143\u7d20\u7684\u6570\u91cf\u8d85\u8fc7\u54c8\u5e0c\u6876\u7684\u6570\u91cf\uff0c\u5c31\u5fc5\u7136\u4f1a\u53d1\u751f\u51b2\u7a81\u3002</p> <p>\u57fa\u4e8e\u9e3d\u5de2\u539f\u7406\uff0cDavid K. Gifford \u5728 1979 \u5e74\u9996\u6b21\u63d0\u51fa\u4e86Quorum \u7b97\u6cd5\uff08\u53c2\u89c1\u300aWeighted Voting for Replicated Data\u300b\u8bba\u6587\uff09\uff0c\u89e3\u51b3\u53bb\u4e2d\u5fc3\u5316\u7cfb\u7edf\u5197\u4f59\u6570\u636e\u7684\u4e00\u81f4\u6027\u95ee\u9898\u3002</p> <p>\u800c Quorum \u7b97\u6cd5\u63d0\u51fa\uff0c\u5982\u679c\u5197\u4f59\u6570\u636e\u5b58\u653e\u5728 N \u4e2a\u8282\u70b9\u4e0a\uff0c\u4e14\u6bcf\u6b21\u5199\u64cd\u4f5c\u6210\u529f\u5199\u5165 W \u4e2a\u8282\u70b9\uff08\u5176\u4ed6 <code>N - W</code> \u4e2a\u8282\u70b9\u5c06\u5f02\u6b65\u5730\u540c\u6b65\u6570\u636e\uff09\uff0c\u800c\u8bfb\u64cd\u4f5c\u5219\u4ece R \u4e2a\u8282\u70b9\u4e2d\u9009\u62e9\u5e76\u8bfb\u51fa\u6b63\u786e\u7684\u6570\u636e\uff0c\u53ea\u8981\u786e\u4fdd <code>W + R &gt; N</code>\uff0c\u540c 1 \u6761\u6570\u636e\u7684\u8bfb\u3001\u5199\u64cd\u4f5c\u5c31\u4e0d\u80fd\u5e76\u53d1\u6267\u884c\uff0c\u8fd9\u6837\u5ba2\u6237\u7aef\u5c31\u603b\u80fd\u8bfb\u5230\u6700\u65b0\u5199\u5165\u7684\u6570\u636e\u3002\u7279\u522b\u662f\u5f53 <code>W &gt; N/2</code> \u65f6\uff0c\u540c 1 \u6761\u6570\u636e\u7684\u4fee\u6539\u5fc5\u7136\u662f\u987a\u5e8f\u6267\u884c\u7684\u3002</p> <p>\u8fd9\u6837\uff0c\u5206\u5e03\u5f0f\u7cfb\u7edf\u5c31\u5177\u5907\u4e86\u5f3a\u4e00\u81f4\u6027\uff0c\u8fd9\u4e5f\u662f NWR \u7b97\u6cd5\u7684\u7531\u6765\u3002</p> <p>\u6bd4\u5982\uff0c\u82e5 N \u4e3a 3\uff0c\u90a3\u4e48\u8bbe\u7f6e W \u548c R \u4e3a 2 \u65f6\uff0c\u5728\u4fdd\u969c\u7cfb\u7edf\u5f3a\u4e00\u81f4\u6027\u7684\u540c\u65f6\uff0c\u8fd8\u5141\u8bb8 3 \u4e2a\u8282\u70b9\u4e2d 1 \u4e2a\u8282\u70b9\u5b95\u673a\u540e\uff0c\u7cfb\u7edf\u4ecd\u7136\u53ef\u4ee5\u63d0\u4f9b\u8bfb\u3001\u5199\u670d\u52a1\uff0c\u8fd9\u6837\u7684\u7cfb\u7edf\u5177\u5907\u4e86\u5f88\u9ad8\u7684\u53ef\u7528\u6027\u3002</p> <p>\u5f53\u7136\uff0cR \u548c W \u7684\u6570\u503c\u5e76\u4e0d\u9700\u8981\u4e00\u81f4\uff0c\u5982\u4f55\u8c03\u6574\u5b83\u4eec\uff0c\u53d6\u51b3\u4e8e\u8bfb\u3001\u5199\u8bf7\u6c42\u6570\u91cf\u7684\u6bd4\u4f8b\u3002\u6bd4\u5982\u5f53 N \u4e3a 5 \u65f6\uff0c\u5982\u679c\u7cfb\u7edf\u8bfb\u591a\u5199\u5c11\u65f6\uff0c\u53ef\u4ee5\u5c06 W \u8bbe\u4e3a 4\uff0c\u800c R \u8bbe\u4e3a 2\uff0c\u8fd9\u6837\u8bfb\u64cd\u4f5c\u7684\u6027\u80fd\u4f1a\u66f4\u597d\u3002</p> <p>NWR \u7b97\u6cd5\u6700\u65e9\u5e94\u7528\u5728 Amazon \u63a8\u51fa\u7684Dynamo \u6570\u636e\u5e93\u4e2d\uff0c\u4f60\u53ef\u4ee5\u53c2\u89c1 2007 \u5e74 Amazon \u53d1\u8868\u7684\u300aDynamo: Amazon\u2019s Highly Available Key-value Store\u300b\u8bba\u6587\u3002</p> <p>2008 \u5e74 Dynamo \u7684\u4f5c\u8005 Avinash Lakshman \u8df3\u69fd\u5230 FaceBook\uff0c\u5f00\u53d1\u4e86 Dynamo \u7684\u5f00\u6e90\u7248\u6570\u636e\u5e93Cassandra\uff0c\u5b83\u662f\u76ee\u524d\u6700\u6d41\u884c\u7684 NoSQL \u6570\u636e\u5e93\u4e4b\u4e00\uff0c\u5728 Apple\u3001Netflix\u3001360 \u7b49\u516c\u53f8\u5f97\u5230\u4e86\u5e7f\u6cdb\u7684\u5e94\u7528\u3002\u60f3\u5fc5\u4f60\u5bf9 NWR \u7b97\u6cd5\u7684\u5f88\u591a\u7ec6\u8282\u5e76\u4e0d\u6e05\u695a\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u6211\u4eec\u4ee5 Cassandra \u4e3a\u4f8b\uff0c\u770b\u770b NWR \u662f\u5982\u4f55\u5e94\u7528\u5728\u5b9e\u9645\u5de5\u7a0b\u4e2d\u7684\u3002</p>"},{"location":"chap3/4perf_nwr/#2cassandra-nwr","title":"2\u3001Cassandra \u6570\u636e\u5e93\u662f\u5982\u4f55\u4f7f\u7528 NWR \u7b97\u6cd5\u7684\uff1f","text":"<p>1 \u4e2a Cassandra \u5206\u5e03\u5f0f\u7cfb\u7edf\u53ef\u4ee5\u7531\u591a\u4e2a IDC \u6570\u636e\u4e2d\u5fc3\u3001\u6570\u4e07\u4e2a\u670d\u52a1\u5668\u8282\u70b9\u6784\u6210\uff0c\u8fd9\u4e9b\u8282\u70b9\u95f4\u4f7f\u7528 RPC \u6846\u67b6\u901a\u4fe1</p> <p>\u7531\u4e8e Cassandra \u63a8\u51fa\u65f6 gRPC \u8fd8\u6ca1\u6709\u8bde\u751f\uff0c\u56e0\u6b64\u5b83\u4f7f\u7528\u7684\u662f\u6027\u80fd\u76f8\u5bf9\u8f83\u4f4e\u7684 <code>Thrift RPC</code> \u6846\u67b6\uff08Thrift \u7684\u4f18\u70b9\u662f\u652f\u6301\u7684\u5f00\u53d1\u8bed\u8a00\u66f4\u591a\uff09\u3002</p> <p>\u540c\u65f6\uff0cCassandra \u867d\u7136\u4f7f\u7528\u5bbd\u5217\u5b58\u50a8\u6a21\u578b\uff08\u6bcf\u884c\u6700\u591a\u53ef\u4ee5\u5305\u542b20 \u4ebf\u5217\u6570\u636e\uff09\uff0c\u4f46\u6570\u636e\u7684\u5206\u5e03\u662f\u57fa\u4e8e\u884c Key \u8fdb\u884c\u7684\uff0c\u5b83\u548c Dynamo \u4e00\u6837\u4f7f\u7528\u4e86\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\uff0c\u5c06 Key \u5bf9\u5e94\u7684\u6570\u636e\u5b58\u50a8\u5728\u591a\u4e2a\u8282\u70b9\u4e2d</p> <p>Cassandra \u5bf9\u5ba2\u6237\u7aef\u63d0\u4f9b\u4e00\u79cd\u7c7b SQL \u7684CQL \u8bed\u8a00\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u8fd9\u884c CQL \u8bed\u53e5\u8bbe\u5b9a\u6570\u636e\u5b58\u50a8\u7684\u5197\u4f59\u8282\u70b9\u4e2a\u6570\uff0c\u4e5f\u5c31\u662f NWR \u7b97\u6cd5\u4e2d\u7684 N\uff08\u4e5f\u79f0\u4e3a Replication Factor\uff09\uff1a</p> <pre><code>CREATE KEYSPACE excalibur\n  WITH REPLICATION = {'class' : 'NetworkTopologyStrategy', 'dc1' : 3};\n</code></pre> <p>\u4e0a\u9762\u8fd9\u884c CQL \u8bed\u53e5\u8bbe\u7f6e\u4e86\u6bcf\u884c\u6570\u636e\u5728\u6570\u636e\u4e2d\u5fc3 DC1 \u4e2d\u5b58\u50a8 3 \u4efd\u5197\u4f59\uff0c\u5373 N = 3\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u901a\u8fc7\u4e0b\u9762\u7684 CQL \u8bed\u53e5\uff0c\u5c06\u8bfb R\u3001\u5199 W \u7684\u8282\u70b9\u6570\u90fd\u8bbe\u7f6e\u4e3a 1\uff1a</p> <pre><code>cqlsh&gt; CONSISTENCY ONE\nConsistency level set to ONE.\ncqlsh&gt; CONSISTENCY\nCurrent consistency level is ONE.\n</code></pre> <p>\u6b64\u65f6\uff0cCassandra \u7684\u6027\u80fd\u6700\u9ad8\uff0c\u4f46\u8fbe\u6210\u6700\u7ec8\u4e00\u81f4\u6027\u7684\u8017\u65f6\u6700\u957f\uff0c\u4e22\u6570\u636e\u98ce\u9669\u4e5f\u6700\u5927\u3002</p> <p>\u5982\u679c\u4e1a\u52a1\u4e0a\u5bf9\u4e22\u5931\u5c11\u91cf\u6570\u636e\u4e0d\u592a\u5728\u610f\uff0c\u53ef\u4ee5\u91c7\u7528\u8fd9\u79cd\u6a21\u578b\u3002\u6b64\u65f6\u4fee\u6539\u6570\u636e\u65f6\uff0c\u5ba2\u6237\u7aef\u4f1a\u5e76\u53d1\u5730\u5411 3 \u4e2a\u5b58\u50a8\u8282\u70b9\u5199\u5165\u6570\u636e\uff0c\u4f46\u53ea\u8981 1 \u4e2a\u8282\u70b9\u8fd4\u56de\u6210\u529f\uff0cCassandra \u5c31\u4f1a\u5411\u5ba2\u6237\u7aef\u8fd4\u56de\u5199\u5165\u6210\u529f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u7cfb\u7edf\u7531 12 \u4e2a\u4e3b\u673a\u8282\u70b9\u6784\u6210\uff0c\u7531\u4e8e\u6570\u636e\u91c7\u7528\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u5206\u7247\uff0c\u6545\u6784\u6210\u4e86\u4e00\u4e2a\u8282\u70b9\u73af\u3002</p> <p>\u5176\u4e2d\uff0c\u672c\u6b21\u5199\u5165\u7684\u6570\u636e\u88ab\u5206\u5e03\u5230 1\u30013\u30016 \u8fd9 3 \u4e2a\u8282\u70b9\u4e2d\u5b58\u50a8\u3002\u5ba2\u6237\u7aef\u53ef\u4ee5\u968f\u673a\u8fde\u63a5\u5230\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u8282\u70b9\u8bbf\u95ee Cassandra\uff0c\u6b64\u65f6\u8be5\u8282\u70b9\u88ab\u79f0\u4e3a Coordinator Node\uff0c\u7531\u5b83\u6839\u636e NWR \u7684\u503c\u6765\u9009\u62e9\u4e00\u81f4\u6027\u6a21\u578b\uff0c\u8bbf\u95ee\u5b58\u50a8\u8282\u70b9\u3002</p> <p>\u518d\u6765\u770b\u8bfb\u53d6\u6570\u636e\u7684\u6d41\u7a0b\u3002\u4e0b\u56fe\u4e2d\uff0c\u4f5c\u4e3a Coordinator Node \u7684\u8282\u70b9 10 \u9996\u5148\u8bd5\u56fe\u8bfb\u53d6\u8282\u70b9 1 \u4e2d\u7684\u6570\u636e\uff0c\u4f46\u53d1\u73b0\u8282\u70b9 1 \u5df2\u7ecf\u5b95\u673a\uff0c\u4e8e\u662f\u6539\u9009\u8282\u70b9 6 \u5e76\u83b7\u53d6\u5230\u6570\u636e\uff0c\u7531\u4e8e R = 1 \u4e8e\u662f\u7acb\u523b\u5411\u5ba2\u6237\u7aef\u8fd4\u56de\u6210\u529f\u3002</p> <p></p> <p>\u5982\u679c\u6211\u4eec\u5c06 R\u3001W \u90fd\u8bbe\u7f6e\u6210 2\uff0c\u8fd9\u5c31\u6ee1\u8db3\u4e86 <code>R + W &gt; N(3)</code>\u7684\u573a\u666f\uff0c\u6b64\u65f6\u7cfb\u7edf\u5177\u5907\u4e86\u5f3a\u4e00\u81f4\u6027\u3002</p> <p>\u5ba2\u6237\u7aef\u8bfb\u5199\u6570\u636e\u65f6\uff0c\u5fc5\u987b\u6709 2 \u4e2a\u8282\u70b9\u8fd4\u56de\uff0c\u624d\u7b97\u64cd\u4f5c\u6210\u529f\u3002\u6bd4\u5982\u4e0b\u56fe\u4e2d\u8bfb\u53d6\u6570\u636e\u65f6\uff0c\u53ea\u6709\u63a5\u6536\u5230\u8282\u70b9 1\u3001\u8282\u70b9 6 \u7684\u8fd4\u56de\uff0c\u64cd\u4f5c\u624d\u7b97\u6210\u529f\u3002</p> <p></p> <p>\u84dd\u8272\u7ebf\u53eb\u505a Read repair\uff0c\u5982\u679c\u8282\u70b9 3 \u4e0a\u7684\u6570\u636e\u4e0d\u4e00\u81f4\uff0c\u90a3\u4e48\u672c\u6b21\u8bfb\u64cd\u4f5c\u53ef\u4ee5\u5c06\u5b83\u4fee\u590d\u4e3a\u6b63\u786e\u7684\u6570\u636e\u3002\u8bf4\u5b8c\u6b63\u5e38\u573a\u666f\uff0c\u6211\u4eec\u518d\u6765\u770b\u5f53\u4e00\u4e2a\u8282\u70b9\u51fa\u73b0\u5f02\u5e38\u65f6\uff0cNWR \u662f\u5982\u4f55\u4fdd\u6301\u5f3a\u4e00\u81f4\u6027\u7684\u3002</p> <p>\u4e0b\u56fe\u4e2d\uff0c\u5ba2\u6237\u7aef 1 \u5728\u7b2c 2 \u6b65\uff0c\u540c\u65f6\u5411 3 \u4e2a\u5b58\u50a8\u8282\u70b9\u5199\u5165\u4e86\u6570\u636e\uff0c\u7531\u4e8e\u8282\u70b9 1\u30013 \u8fd4\u56de\u6210\u529f\uff0c\u6240\u4ee5\u5199\u5165\u64cd\u4f5c\u5b9e\u9645\u5df2\u7ecf\u5b8c\u6210\u4e86\uff0c\u4f46\u662f\u8282\u70b9 6 \u7531\u4e8e\u7f51\u7edc\u6545\u969c\uff0c\u5374\u4e00\u76f4\u6ca1\u6709\u6536\u5230 Coordinator Node \u53d1\u6765\u7684\u5199\u5165\u64cd\u4f5c\u3002</p> <p>\u5728\u5f3a\u4e00\u81f4\u6027\u7684\u7ea6\u675f\u4e0b\uff0c\u5ba2\u6237\u7aef 2 \u5728\u7b2c 5 \u6b65\u53d1\u8d77\u7684\u8bfb\u8bf7\u6c42\uff0c\u5fc5\u987b\u80fd\u83b7\u53d6\u5230\u7b2c 2 \u6b65\u5199\u5165\u7684\u6570\u636e\u3002\u7136\u800c\uff0c\u5ba2\u6237\u7aef 2 \u8fde\u63a5\u7684 Coordinator Node \u4e0e\u5ba2\u6237\u7aef 1 \u4e0d\u540c\uff0c\u5b83\u9009\u62e9\u4e86\u8282\u70b9 3 \u548c\u8282\u70b9 6\uff0c\u8fd9\u4e24\u4e2a\u8282\u70b9\u4e0a\u7684\u6570\u636e\u5e76\u4e0d\u4e00\u81f4\u3002</p> <p>\u6839\u636e\u4e0d\u540c\u7684 timestamp \u65f6\u95f4\u6233\uff0cCoordinator Node \u53d1\u73b0\u8282\u70b9 3 \u4e0a\u7684\u6570\u636e\u624d\u662f\u6700\u540e\u5199\u5165\u7684\u6570\u636e\uff0c\u56e0\u6b64\u9009\u62e9\u5176\u4e0a\u7684\u6570\u636e\u8fd4\u56de\u5ba2\u6237\u7aef\u3002\u8fd9\u4e5f\u53eb <code>Last-Write-Win</code> \u7b56\u7565\u3002</p> <p></p> <p>Cassandra \u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u7528\u4e8e\u8bbe\u7f6e\u8bfb\u5199\u8282\u70b9\u6570\u91cf\u90fd\u8fc7\u534a\uff0c\u6ee1\u8db3\u5f3a\u4e00\u81f4\u6027\u7684\u8981\u6c42\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>cqlsh&gt; CONSISTENCY QUORUM\nConsistency level set to QUORUM.\ncqlsh&gt; CONSISTENCY\nCurrent consistency level is QUORUM.\n</code></pre> <p>\u8bfb\u53d6\u6570\u636e\u65f6\uff0c\u8fd9 2 \u4e2a IDC \u5185\u5fc5\u987b\u7531 4 \u4e2a\u5b58\u50a8\u8282\u70b9\u8fd4\u56de\u6570\u636e\uff0c\u624d\u6ee1\u8db3 QUORUM \u4e00\u81f4\u6027\u7684\u8981\u6c42\u3002\u4e0b\u56fe\u4e2d\uff0cCoordinator Node \u83b7\u53d6\u5230\u4e86 IDC Alpha \u4e2d\u8282\u70b9 1\u30013\u30016 \u7684\u8fd4\u56de\uff0c\u4ee5\u53ca IDC Beta \u4e2d\u8282\u70b9 11 \u7684\u8fd4\u56de\uff0c\u5c31\u53ef\u4ee5\u57fa\u4e8e timestamp \u65f6\u95f4\u6233\u9009\u62e9\u6700\u65b0\u7684\u6570\u636e\u8fd4\u56de\u5ba2\u6237\u7aef\u3002\u800c\u4e14 Coordinator Node \u4f1a\u5e76\u53d1\u5730\u53d1\u8d77 Read repair\uff0c\u8bd5\u56fe\u4fee\u590d IDC Beta \u4e2d\u53ef\u80fd\u5b58\u5728\u4e0d\u4e00\u81f4\u7684\u8282\u70b9 4 \u548c 8\u3002</p> <p></p> <p>Cassandra \u8fd8\u6709\u8bb8\u591a\u4e00\u81f4\u6027\u6a21\u578b\uff0c\u6bd4\u5982 LOCAL_QUORUM \u53ea\u8981\u6c42\u672c\u5730 IDC \u5185\u6709\u591a\u6570\u8282\u70b9\u54cd\u5e94\u5373\u53ef\uff0c\u800c EACH_QUORUM \u5219\u8981\u6c42\u6bcf\u4e2a IDC \u5185\u90fd\u5fc5\u987b\u6709\u591a\u6570\u8282\u70b9\u8fd4\u56de\u6210\u529f\uff08\u6ce8\u610f\uff0c\u8fd9\u4e0e\u4e0a\u56fe\u4e2d IDC Alpha \u4e2d\u6709 3 \u4e2a\u8282\u70b9\u8fd4\u56de\uff0c\u800c IDC Beta \u5219\u53ea\u6709 1 \u4e2a\u8282\u70b9\u8fd4\u56de\u7684 QUORUM \u662f\u4e0d\u540c\u7684\uff09</p>"},{"location":"chap3/4perf_nwr/#3","title":"3\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u5f53\u9e3d\u5b50\u7684\u6570\u91cf\u8d85\u8fc7\u4e86\u9e3d\u5de2\u540e\uff0c\u5c31\u8981\u6ce8\u5b9a\u67d0\u4e00\u4e2a\u9e3d\u5de2\u5185\u4e00\u5b9a\u542b\u6709\u4e24\u53ea\u4ee5\u4e0a\u7684\u9e3d\u5b50\uff0c\u540c\u6837\u7684\u9053\u7406\uff0c\u53ea\u8981\u8bfb\u3001\u5199\u64cd\u4f5c\u6d89\u53ca\u7684\u8282\u70b9\u8d85\u8fc7\u534a\u6570\uff0c\u5c31\u6ce8\u5b9a\u8bfb\u5199\u64cd\u4f5c\u603b\u5305\u542b\u4e00\u4e2a\u542b\u6709\u6b63\u786e\u6570\u636e\u7684\u8282\u70b9\u3002NWR \u7b97\u6cd5\u5c06\u8fd9\u4e00\u539f\u7406\u4e00\u822c\u5316\u4e3a\uff1a\u53ea\u8981\u8bfb\u8282\u70b9\u6570 R + \u5199\u8282\u70b9\u6570 W &gt; \u5b58\u50a8\u8282\u70b9\u6570 N\uff0c\u7279\u522b\u662f W &gt; N/2 \u65f6\uff0c\u5c31\u80fd\u4f7f\u53bb\u4e2d\u5fc3\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u83b7\u5f97\u5f3a\u4e00\u81f4\u6027\u3002</p> <p>\u652f\u6301\u4e0a\u4e07\u8282\u70b9\u7684 Cassandra \u6570\u636e\u5e93\uff0c\u5c31\u4f7f\u7528\u4e86 NWR \u7b97\u6cd5\u6765\u4fdd\u6301\u4e00\u81f4\u6027\u3002\u5f53\u7136\uff0cCassandra \u652f\u6301\u591a\u79cd\u4e00\u81f4\u6027\u6a21\u578b\uff0c\u5f53\u4f60\u9700\u8981\u66f4\u5f3a\u52b2\u7684\u6027\u80fd\u65f6\uff0c\u4f60\u53ef\u4ee5\u4ee4 R + W &lt; N\uff0c\u5f53\u4e1a\u52a1\u53d8\u5316\u5bfc\u81f4\u9700\u8981\u589e\u5f3a\u7cfb\u7edf\u7684\u4e00\u81f4\u6027\u65f6\uff0c\u4f60\u53ef\u4ee5\u5b9e\u65f6\u5730\u4fee\u6539 R\u3001W\u3002Cassandra \u4e5f\u652f\u6301\u8de8\u6570\u636e\u4e2d\u5fc3\u90e8\u7f72\uff0c\u6b64\u65f6\u7684\u4e00\u81f4\u6027\u6a21\u578b\u66f4\u4e3a\u590d\u6742\uff0c\u4f46\u4ecd\u7136\u5c06 NWR \u7b97\u6cd5\u4f5c\u4e3a\u5b9e\u73b0\u57fa\u7840\u3002</p>"},{"location":"chap3/5nginx_openresty/","title":"\u7b2c\u4e94\u8282 \u8d1f\u8f7d\u5747\u8861\uff1a\u9009\u62e9Nginx\u8fd8\u662fOpenResty","text":"<p>\u8d1f\u8f7d\u5747\u8861\u901a\u8fc7\u5c06\u6d41\u91cf\u5206\u53d1\u7ed9\u65b0\u589e\u7684\u670d\u52a1\u5668\uff0c\u63d0\u5347\u4e86\u7cfb\u7edf\u7684\u6027\u80fd\u3002</p> <p>\u56e0\u6b64\uff0c\u5bf9\u8d1f\u8f7d\u5747\u8861\u6700\u57fa\u672c\u7684\u8981\u6c42\uff0c\u5c31\u662f\u5b83\u7684\u541e\u5410\u91cf\u8981\u8fdc\u5927\u4e8e\u4e0a\u6e38\u7684\u5e94\u7528\u670d\u52a1\u5668\uff0c\u5426\u5219\u6269\u5c55\u80fd\u529b\u4f1a\u6781\u4e3a\u6709\u9650\u3002\u56e0\u6b64\uff0c\u76ee\u524d\u6027\u80fd\u6700\u597d\u7684 Nginx\uff0c\u4ee5\u53ca\u5728 Nginx \u4e4b\u4e0a\u6784\u5efa\u7684 OpenResty\uff0c\u901a\u5e38\u662f\u7b2c\u4e00\u9009\u62e9\u3002</p> <p>\u7cfb\u7edf\u63a5\u5165\u5c42\u7684\u8d1f\u8f7d\u5747\u8861\uff0c\u5e38\u901a\u8fc7 Waf \u9632\u706b\u5899\u627f\u62c5\u7740\u7f51\u7edc\u5b89\u5168\u804c\u8d23\uff0c\u7cfb\u7edf\u5185\u90e8\u7684\u8d1f\u8f7d\u5747\u8861\u5219\u901a\u8fc7\u6743\u9650\u3001\u6d41\u91cf\u63a7\u5236\u7b49\u529f\u80fd\u627f\u62c5\u7740 API \u7f51\u5173\u7684\u804c\u8d23\uff0cCDN \u7b49\u8fb9\u7f18\u8282\u70b9\u4e0a\u7684\u8d1f\u8f7d\u5747\u8861\u8fd8\u4f1a\u627f\u62c5\u8fb9\u7f18\u8ba1\u7b97\u7684\u4efb\u52a1\u3002  </p> <p>Nginx \u5b8c\u5168\u7b26\u5408\u4e0a\u8ff0\u8981\u6c42\uff0c\u5b83\u6027\u80fd\u4e00\u6d41\u800c\u4e14\u975e\u5e38\u7a33\u5b9a\u3002</p> <p>\u4ece 2004 \u5e74\u8bde\u751f\u4e4b\u521d\uff0cNginx \u7684\u6a21\u5757\u5316\u8bbe\u8ba1\u5c31\u672a\u6539\u53d8\u8fc7\uff0c\u8fd9\u6837 16 \u5e74\u6765\u7d2f\u79ef\u4e0b\u7684\u5404\u79cd Nginx \u6a21\u5757\u90fd\u53ef\u4ee5\u590d\u7528\u3002\u5b83\u76842-clause BSD-like license \u6e90\u7801\u8bb8\u53ef\u534f\u8bae\u6781\u5176\u5f00\u653e\uff0c\u5373\u4f7f\u4fee\u6539\u6e90\u7801\u540e\u4ecd\u7136\u53ef\u4f5c\u5546\u4e1a\u7528\u9014\uff0c\u56e0\u6b64 Nginx \u4e4b\u4e0a\u5ef6\u4f38\u51fa\u4e86 TEngine\u3001OpenResty\u3001Kong \u7b49\u751f\u6001\uff0c\u8fd9\u5927\u5927\u6269\u5c55\u4e86 Nginx \u7684\u80fd\u529b\u8fb9\u754c\u3002</p> <p>Nginx \u4ee5\u53ca\u5efa\u7acb\u4e86 Lua \u8bed\u8a00\u751f\u6001\u7684 OpenResty \u4e3a\u4f8b\uff0c\u770b\u770b\u8d1f\u8f7d\u5747\u8861\u662f\u600e\u6837\u6269\u5c55\u7cfb\u7edf\u7684\uff0c\u4ee5\u53ca Nginx \u548c\u540c\u6e90\u7684 OpenResty \u6709\u4f55\u4e0d\u540c\u3002</p>"},{"location":"chap3/5nginx_openresty/#2","title":"2\u3001\u8d1f\u8f7d\u5747\u8861\u662f\u5982\u4f55\u6269\u5c55\u7cfb\u7edf\u63d0\u5347\u6027\u80fd\u7684\uff1f","text":""},{"location":"chap3/5nginx_openresty/#2-1-akf-x","title":"2-1 AKF \u7acb\u65b9\u4f53 X \u8f74\u6269\u5c55\u7cfb\u7edf","text":"<p>\u901a\u8fc7 AKF \u7acb\u65b9\u4f53 X \u8f74\u6269\u5c55\u7cfb\u7edf\u65f6\uff0c\u8d1f\u8f7d\u5747\u8861\u53ea\u9700\u8981\u80fd\u591f\u900f\u4f20\u534f\u8bae\uff0c\u5e76\u9009\u62e9\u8d1f\u8f7d\u6700\u4f4e\u7684\u4e0a\u6e38\u5e94\u7528\u4f5c\u4e3a\u6d41\u91cf\u5206\u53d1\u5bf9\u8c61\u5373\u53ef\u3002</p> <p>\u8fd9\u6837\uff0c\u4e09\u5c42\uff08\u7f51\u7edc\u5c42\uff09\u3001\u56db\u5c42\uff08\u4f20\u8f93\u5c42\uff09\u8d1f\u8f7d\u5747\u8861\u90fd\u53ef\u7528\u4e8e\u6269\u5c55\u7cfb\u7edf\uff0c\u751a\u81f3\u5728\u5355\u4e2a\u5c40\u57df\u7f51\u5185\u4f60\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4e8c\u5c42\uff08\u6570\u636e\u94fe\u8def\u5c42\uff09\u8d1f\u8f7d\u5747\u8861</p> <p>\u5176\u4e2d\uff0c\u5206\u53d1\u6d41\u91cf\u7684\u8def\u7531\u7b97\u6cd5\u65e2\u53ef\u4ee5\u4f7f\u7528 RoundRobin \u8f6e\u8f6c\u7b97\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u57fa\u4e8e TCP \u8fde\u63a5\u6216\u8005 UDP Session \u4f7f\u7528\u6700\u5c11\u8fde\u63a5\u6570\u7b97\u6cd5\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p>"},{"location":"chap3/5nginx_openresty/#2-2-akf-y","title":"2-2 AKF Y \u8f74\u6269\u5c55\u7cfb\u7edf","text":"<p>\u4e8e AKF Y \u8f74\u6269\u5c55\u7cfb\u7edf\u65f6\uff0c\u8d1f\u8f7d\u5747\u8861\u5fc5\u987b\u6839\u636e\u529f\u80fd\u6765\u5206\u53d1\u8bf7\u6c42\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u5fc5\u987b\u89e3\u6790\u5b8c\u5e94\u7528\u5c42\u534f\u8bae\uff0c\u624d\u80fd\u660e\u767d\u8fd9\u662f\u4ec0\u4e48\u8bf7\u6c42\u3002</p> <p>\u56e0\u6b64\uff0c\u5982 LVS \u8fd9\u6837\u5de5\u4f5c\u5728\u4e09\u5c42\u548c\u56db\u5c42\u7684\u8d1f\u8f7d\u5747\u8861\u5c31\u65e0\u6cd5\u6ee1\u8db3\u9700\u6c42\u4e86\uff0c\u6211\u4eec\u9700\u8981 Nginx \u8fd9\u6837\u7684\u4e03\u5c42\uff08\u5e94\u7528\u5c42\uff09\u8d1f\u8f7d\u5747\u8861\uff0c\u5b83\u80fd\u591f\u4ece\u8bf7\u6c42\u4e2d\u83b7\u53d6\u5230\u63cf\u8ff0\u529f\u80fd\u7684\u5173\u952e\u4fe1\u606f\uff0c\u5e76\u4ee5\u6b64\u4e3a\u4f9d\u636e\u8def\u7531\u8bf7\u6c42\u3002</p> <p>\u6bd4\u5982\u5f53 HTTP \u8bf7\u6c42\u4e2d\u7684 URL \u63cf\u8ff0\u529f\u80fd\u65f6\uff0cNginx \u5c31\u53ef\u4ee5\u7528 location \u5339\u914d URL\uff0c\u518d\u57fa\u4e8e location \u6765\u8def\u7531\u8bf7\u6c42\uff0c\u5982\u4e0b\u56fe\u6240\u793a</p> <p></p>"},{"location":"chap3/5nginx_openresty/#2-3-akf-z","title":"2-3 AKF Z \u8f74\u6269\u5c55\u65f6","text":"<p>\u5982\u679c\u53ea\u662f\u4f7f\u7528\u4e86\u7f51\u7edc\u62a5\u6587\u4e2d\u7684\u6e90 IP \u5730\u5740\uff0c\u90a3\u4e48\u4e09\u5c42\u3001\u56db\u5c42\u8d1f\u8f7d\u5747\u8861\u90fd\u80fd\u80dc\u4efb\u3002\u7136\u800c\u5982\u679c\u9700\u8981\u5e10\u53f7\u3001\u8bbf\u95ee\u5bf9\u8c61\u7b49\u7528\u6237\u4fe1\u606f\u6269\u5c55\u7cfb\u7edf\uff0c\u4ecd\u7136\u53ea\u80fd\u4f7f\u7528\u4e03\u5c42\u8d1f\u8f7d\u5747\u8861\u4ece\u8bf7\u6c42\u4e2d\u83b7\u5f97\u3002\u6bd4\u5982\uff0cNginx \u53ef\u4ee5\u901a\u8fc7 $ \u53d8\u91cf\u83b7\u53d6\u5230 URL \u53c2\u6570\u6216\u8005 HEADER \u5934\u90e8\u7684\u503c\uff0c\u518d\u4ee5\u6b64\u4f5c\u4e3a\u8def\u7531\u7b97\u6cd5\u7684\u8f93\u5165\u53c2\u6570\u3002</p> <p>\u56e0\u6b64\uff0c\u4e03\u5c42\u8d1f\u8f7d\u5747\u8861\u662f\u5206\u5e03\u5f0f\u7cfb\u7edf\u63d0\u5347\u6027\u80fd\u7684\u5fc5\u5907\u5de5\u5177\u3002</p> <p>\u9664\u4e86\u57fa\u4e8e\u5404\u79cd\u8def\u7531\u7b56\u7565\u5206\u53d1\u6d41\u91cf\uff0c\u63d0\u9ad8\u6027\u80fd\u53ca\u53ef\u7528\u6027\uff08\u5982\u5b95\u673a\u8fc1\u79fb\uff09\u5916\uff0c\u8d1f\u8f7d\u5747\u8861\u8fd8\u9700\u8981\u5b8c\u6210\u4e0a\u3001\u4e0b\u6e38\u534f\u8bae\u95f4\u7684\u9002\u914d\u3001\u8f6c\u6362\u3002\u4f8b\u5982\u8003\u8651\u5230\u4fe1\u606f\u5b89\u5168\uff0c\u8dd1\u5728\u516c\u7f51\u4e0a\u7684\u5916\u90e8\u534f\u8bae\u5e38\u57fa\u4e8e TLS/SSL \u534f\u8bae\uff0c\u800c\u5728\u6548\u7387\u4f18\u5148\u7684\u4f01\u4e1a\u5185\u7f51\u4e2d\uff0c\u4e00\u822c\u4e0d\u4f1a\u4f7f\u7528\u5927\u5e45\u964d\u4f4e\u6027\u80fd\u7684 TLS \u534f\u8bae\uff0c\u56e0\u6b64\u8d1f\u8f7d\u5747\u8861\u9700\u8981\u62e5\u6709\u5378\u8f7d\u6216\u8005\u88c5\u8f7d TLS \u5c42\u7684\u80fd\u529b\u3002</p> <p>\u4e0b\u6e38\u5ba2\u6237\u7aef\u591a\u6837\u4e14\u96be\u4ee5\u4fdd\u6301\u4e00\u81f4\uff08\u6bd4\u5982 IE6 \u8fd9\u4e2a\u53e4\u8463\u6d4f\u89c8\u5668\u4ecd\u7136\u5b58\u5728\u4e8e\u5f53\u4e0b\u7684\u4e92\u8054\u7f51\u4e2d\uff09\uff0c\u56e0\u6b64\u5e38\u4f7f\u7528 HTTP \u534f\u8bae\u4e0e\u670d\u52a1\u5668\u901a\u8baf\uff0c\u800c\u4e0a\u6e38\u7ec4\u4ef6\u5219\u4f9d\u636e\u5f00\u53d1\u56e2\u961f\u6216\u8005\u7cfb\u7edf\u67b6\u6784\u7684\u7279\u70b9\uff0c\u4f1a\u9009\u62e9 CGI\u3001uWSGI\u3001gRPC \u7b49\u534f\u8bae\uff0c\u8fd9\u6837\u8d1f\u8f7d\u5747\u8861\u8fd8\u5f97\u62e5\u6709\u8f6c\u6362\u5404\u79cd\u534f\u8bae\u7684\u529f\u80fd\u3002Nginx \u53ef\u4ee5\u901a\u8fc7\u53cd\u5411\u4ee3\u7406\u6a21\u5757\uff0c\u8f7b\u677e\u9002\u914d\u5404\u7c7b\u534f\u8bae\uff0c\u5982\u4e0b\u6240\u793a\uff08\u901a\u8fc7 stream \u6a21\u5757\uff0cNginx \u4e5f\u652f\u6301\u56db\u5c42\u8d1f\u8f7d\u5747\u8861\uff09\uff1a</p> <p></p> <p>\u4ece\u6027\u80fd\u89d2\u5ea6\uff0cNginx \u652f\u6301 C10M \u7ea7\u522b\u7684\u5e76\u53d1\u8fde\u63a5\u3002</p> <p>\u4ece\u529f\u80fd\u89d2\u5ea6\uff0c\u826f\u597d\u7684\u6a21\u5757\u5316\u8bbe\u8ba1\uff0c\u4f7f\u5f97 Nginx \u53ef\u4ee5\u5b8c\u6210\u5404\u7c7b\u534f\u8bae\u7684\u9002\u914d\uff0c\u4e0d\u53ea\u5305\u62ec\u7b2c 3 \u90e8\u5206\u8bfe\u7a0b\u4ecb\u7ecd\u8fc7\u7684\u901a\u7528\u534f\u8bae\uff0c\u751a\u81f3\u652f\u6301 Redis\u3001MySQL \u7b49\u4e13\u6709\u534f\u8bae\u3002\u56e0\u6b64\uff0cNginx \u662f\u76ee\u524d\u6700\u597d\u7528\u7684\u8d1f\u8f7d\u5747\u8861\u3002</p>"},{"location":"chap3/5nginx_openresty/#3nginx-openresty","title":"3\u3001Nginx \u4e0e OpenResty \u7684\u5dee\u522b\u5728\u54ea\u91cc\uff1f","text":"<p>\u9996\u5148\u770b\u7248\u672c\u5dee\u5f02\u3002\u5f53\u4f60\u5728\u5b98\u7f51\u4e0b\u8f7d Nginx \u65f6\uff0c\u4f1a\u53d1\u73b0\u6709 3 \u7c7b\u7248\u672c\uff1aMainline\u3001Stable \u548c Legacy\u3002\u5176\u4e2d\uff0cMainline \u662f\u5355\u53f7\u7248\u672c\uff0c\u5b83\u662f\u542b\u6709\u6700\u65b0\u529f\u80fd\u7684\u4e3b\u7ebf\u7248\u672c\uff0c\u8fed\u4ee3\u901f\u5ea6\u6700\u5feb\u3002Stable \u662f mainline \u7248\u672c\u7a33\u5b9a\u8fd0\u884c\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u5c06\u5355\u53f7\u5927\u7248\u672c\u8f6c\u6362\u4e3a\u53cc\u53f7\u7684\u7a33\u5b9a\u7248\u672c\uff0c\u6bd4\u5982 1.18.0 \u5c31\u662f\u7531 1.17.10 \u8f6c\u6362\u800c\u6765\u3002Legacy \u5219\u662f\u66fe\u7ecf\u7684\u7a33\u5b9a\u7248\u672c\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u6e90\u4ee3\u7801\u4e2d\u7684 CHANGES \u6587\u4ef6\uff0c\u901a\u8fc7 4 \u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u53d8\u66f4\u67e5\u770b\u7248\u672c\u95f4\u7684\u5dee\u5f02\uff0c\u5305\u62ec\uff1a</p> <ul> <li>\u8868\u793a\u65b0\u529f\u80fd\u7684 Feature\uff0c\u6bd4\u5982\u4e0b\u56fe\u4e2d HTTP \u670d\u52a1\u65b0\u589e\u7684 <code>auth_delay</code> \u6307\u4ee4\u3002</li> <li>\u8868\u793a\u5df2\u4fee\u590d\u95ee\u9898\u7684 <code>Bugfix</code>\u3002</li> <li>\u8868\u793a\u5df2\u77e5\u7279\u6027\u53d8\u66f4\u7684 <code>Change</code>\uff0c\u6bd4\u5982 <code>Nginx</code> \u66fe\u7ecf\u5141\u8bb8 HTTP \u8bf7\u6c42\u5934\u90e8\u4e2d\u51fa\u73b0\u591a\u4e2a Host \u5934\u90e8\uff0c\u4f46\u5728 1.17.9 \u8fd9\u4e2a Change \u4e4b\u540e\uff0c\u8fd9\u7c7b HTTP \u8bf7\u6c42\u5c06\u4f5c\u4e3a\u975e\u6cd5\u8bf7\u6c42\u5904\u7406\u3002</li> <li>\u8868\u793a\u5b89\u5168\u5347\u7ea7\u7684 Security\uff0c\u6bd4\u5982 1.15.6 \u7248\u672c\u5c31\u4fee\u590d\u4e86 CVE-2018-16843 \u7b49 3 \u4e2a\u5b89\u5168\u95ee\u9898\u3002</li> </ul> <p></p> <p>\u5f53\u4f60\u5b89\u88c5\u597d\u4e86 OpenResty \u6216\u8005 Nginx \u540e\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 nginx -v \u547d\u4ee4\u67e5\u770b\u5b83\u4eec\u7684\u7248\u672c\u3002\u4f60\u4f1a\u53d1\u73b0\uff0c2014 \u5e74\u4ee5\u540e\u53d1\u5e03\u7684 OpenResty \u90fd\u662f\u8fd0\u884c\u5728\u5355\u53f7 Mainline \u7248\u672c\u4e0a\u7684\uff1a</p> <pre><code># /usr/local/nginx/sbin/nginx -v\nnginx version: nginx/1.18.0\n# /usr/local/openresty/nginx/sbin/nginx -v\nnginx version: openresty/1.15.8.3\n</code></pre> <p>OpenResty \u5e76\u6ca1\u6709\u4fee\u6539 Nginx \u7684\u6e90\u4ee3\u7801\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u7531\u7528\u6237\u5728\u5b98\u65b9 Nginx \u4e0a\u81ea\u884c\u6dfb\u52a0 C \u6a21\u5757\uff0c\u5b9e\u73b0 OpenResty \u7684\u5b89\u88c5\u5462\uff1f</p> <p>\u8fd9\u6e90\u4e8e\u90e8\u5206 OpenResty C \u6a21\u5757\uff0c\u6ca1\u6709\u6309\u7167 Nginx \u67b6\u6784\u6307\u5b9a\u7684\u987a\u5e8f\u6dfb\u52a0\u5230\u6a21\u5757\u5217\u8868\u4e2d\uff0c\u800c\u4e14\u5b83\u4eec\u7684\u7f16\u8bd1\u73af\u5883\u4e5f\u8fc7\u4e8e\u590d\u6742\u3002\u56e0\u6b64\uff0cOpenResty \u653e\u5f03\u4e86 Nginx \u5b98\u65b9\u7684 configure \u6587\u4ef6\uff0c\u7528\u6237\u9700\u8981\u4f7f\u7528 OpenResty \u6539\u9020\u8fc7\u7684 configure \u811a\u672c\u7f16\u8bd1 Nginx\u3002</p> <p>\u518d\u6765\u770b\u6a21\u5757\u95f4\u7684\u5dee\u5f02\u3002\u5982\u679c\u4f60\u7559\u610f OpenResty \u4e0e Nginx \u95f4\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u4f53\u79ef\uff0c\u4f1a\u53d1\u73b0\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\u65f6\uff0cOpenResty \u7684\u53ef\u6267\u884c\u6587\u4ef6\u5927\u4e86 5 \u500d\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code># ls -s --block-size=1 /usr/local/openresty/nginx/sbin/nginx \n16437248 /usr/local/openresty/nginx/sbin/nginx\n# ls -s --block-size=1 /usr/local/nginx/sbin/nginx \n3851568 /usr/local/openresty/nginx/sbin/nginx\n</code></pre> <p>\u8fd9\u7531 2 \u4e2a\u539f\u56e0\u6240\u81f4\u3002</p> <p>\u9996\u5148\uff0c\u5b98\u65b9 Nginx \u63d0\u4f9b\u7684\u56db\u5c42\u8d1f\u8f7d\u5747\u8861\u529f\u80fd\uff08\u7531 18 \u4e2a STREAM \u6a21\u5757\u5b9e\u73b0\uff09\u3001TLS \u534f\u8bae\u5904\u7406\u529f\u80fd\uff0c\u9ed8\u8ba4\u90fd\u662f\u4e0d\u6dfb\u52a0\u5230 Nginx \u4e2d\u7684\uff0c</p> <p>\u800c OpenResty \u7684 configure \u811a\u672c\u5c06\u5176\u6539\u4e3a\u4e86\u9ed8\u8ba4\u6a21\u5757\u3002\u5f53\u7136\uff0c\u5982\u679c\u4f60\u5728\u7f16\u8bd1\u5b98\u65b9 Nginx \u65f6\uff0c\u52a0\u5165\u4ee5\u4e0b\u9009\u9879\uff1a</p> <pre><code>./configure --with-stream --with-stream_ssl_module --with-stream_ssl_preread_module --with-http_ssl_module\n</code></pre> <p>\u90a3\u4e48\u4ece\u5b98\u65b9\u6a21\u5757\u4e0a\uff0cNginx \u5c31\u4e0e OpenResty \u5b8c\u5168\u4e00\u81f4\u4e86\uff0c\u6b64\u65f6\u518d\u89c2\u5bdf\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u4f53\u79ef\uff0c\u4f1a\u53d1\u73b0\u5b83\u7ffb\u4e86\u4e00\u500d\uff1a</p> <pre><code># ls -s --block-size=1 /usr/local/openresty/nginx/sbin/nginx \n6999144 /usr/local/openresty/nginx/sbin/nginx\n</code></pre> <p>\u5176\u6b21\uff0cOpenResty \u6dfb\u52a0\u4e86\u8fd1 20 \u4e2a\u7b2c\u4e09\u65b9 C \u6a21\u5757\uff0c\u9664\u4e86\u652f\u6301 Lua \u8bed\u8a00\u7684 2 \u4e2a\u6a21\u5757\u5916\uff0c\u8fd8\u6709\u652f\u6301 Redis\u3001Memcached\u3001MySQL \u7b49\u670d\u52a1\u7684\u6a21\u5757\u3002\u8fd9\u4e9b\u6a21\u5757\u7f16\u8bd1\u65f6\uff0c\u8fd8\u9700\u8981\u94fe\u63a5\u4f9d\u8d56\u7684\u8f6f\u4ef6\u5e93\uff0c\u56e0\u6b64\u5b83\u4eec\u53c8\u5c06 Nginx \u53ef\u6267\u884c\u6587\u4ef6\u7684\u4f53\u79ef\u589e\u52a0\u4e86 1 \u500d\u591a\u3002</p> <p>\u9664\u7248\u672c\u3001\u6a21\u5757\u5916\uff0cOpenResty \u4e0e Nginx \u95f4\u8fd8\u6709\u4e00\u4e9b\u5c0f\u7684\u5dee\u5f02\uff0c\u6bd4\u5982 Nginx \u4f7f\u7528\u4e86 GCC \u7f16\u8bd1\u5668\u7684 -O1 \u4f18\u5316\u53c2\u6570\uff0c\u800c OpenResty \u5219\u4f7f\u7528\u4e86 -O2 \u4f18\u5316\u53c2\u6570\u3002\u518d\u6bd4\u5982\uff0c\u5b98\u65b9 Nginx \u6700\u65b0\u7248\u672c\u7684 Makefile \u652f\u6301 upgrade \u53c2\u6570\uff0c\u7b80\u5316\u4e86\u70ed\u5347\u7ea7\u64cd\u4f5c\u3002\u5f53\u7136\uff0c\u8fd9\u4e9b\u5c0f\u6539\u52a8\u5e76\u4e0d\u91cd\u8981\uff0c\u53ea\u8981\u4fee\u6539 configure \u811a\u672c\u5c31\u80fd\u505a\u5230\u3002</p> <p>\u5230\u5e95\u8be5\u5982\u4f55\u5728\u4e8c\u8005\u4e2d\u9009\u62e9\u5462\uff1f\u6211\u8ba4\u4e3a\uff0c\u5982\u679c\u4e0d\u4f7f\u7528 Lua \u8bed\u8a00\uff0c\u90a3\u4e48\u6211\u5efa\u8bae\u4f7f\u7528 Nginx\u3002</p> <p>\u5b98\u65b9 Nginx \u7684 Stable \u7248\u672c\u66f4\u7a33\u5b9a\uff0c\u53ef\u6267\u884c\u6587\u4ef6\u7684\u4f53\u79ef\u4e5f\u66f4\u5c0f\u3002\u5982\u679c\u4f60\u9700\u8981\u4f7f\u7528 OpenResty\u3001TEngine \u4e2d\u7684\u90e8\u5206 C \u6a21\u5757\uff0c\u53ef\u4ee5\u901a\u8fc7<code>\u2013add-module</code> \u9009\u9879\u5c06\u5176\u52a0\u5165\u5230\u5b98\u65b9 Nginx \u4e2d\u3002</p> <p>\u6ce8\u610f\uff0cLua \u8bed\u8a00\u7ed9\u4f60\u5e26\u6765\u6781\u5927\u7075\u6d3b\u6027\u7684\u540c\u65f6\uff0c\u4e5f\u4f1a\u5f15\u5165\u8bb8\u591a\u4e0d\u786e\u5b9a\u6027\u3002\u6bd4\u5982\uff0c\u5982\u679c\u4f60\u8c03\u7528\u4e86\u4f1a\u5bfc\u81f4\u8fdb\u7a0b\u4f11\u7720\u7684 Lua \u963b\u585e\u51fd\u6570\uff08\u6bd4\u5982\u5c01\u88c5\u4e86\u7cfb\u7edf\u8c03\u7528\u7684\u539f\u751f Lua \u5e93\uff0c\u6216\u8005\u7b2c\u4e09\u65b9\u670d\u52a1\u63d0\u4f9b\u7684\u540c\u6b65 SDK\uff09\uff0c\u5c06\u4f1a\u5bfc\u81f4 Nginx \u6b63\u5728\u5904\u7406\u6570\u4e07\u5e76\u53d1\u8bf7\u6c42\u7684 C \u6a21\u5757\u540c\u65f6\u8fdb\u5165\u4f11\u7720\uff0c\u4ece\u800c\u8ba9\u670d\u52a1\u7684\u6027\u80fd\u5927\u5e45\u5ea6\u4e0b\u964d\u3002</p>"},{"location":"chap3/5nginx_openresty/#4","title":"4\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u8d1f\u8f7d\u5747\u8861\u7684\u5de5\u4f5c\u65b9\u5f0f\uff0c\u4ee5\u53ca Nginx\u3001OpenResty \u8fd9\u4e24\u4e2a\u6700\u6d41\u884c\u7684\u8d1f\u8f7d\u5747\u8861\u4e4b\u95f4\u7684\u5f02\u540c\u3002</p> <p>\u4efb\u4f55\u8d1f\u8f7d\u5747\u8861\u90fd\u80fd\u4ece AKF X \u8f74\u6c34\u5e73\u6269\u5c55\u7cfb\u7edf\uff0c\u4f46\u53ea\u6709\u80fd\u591f\u89e3\u6790\u5e94\u7528\u5c42\u534f\u8bae\uff0c\u83b7\u53d6\u5230\u8bf7\u6c42\u7684\u529f\u80fd\u3001\u7528\u6237\u8eab\u4efd\u3001\u8bbf\u95ee\u5bf9\u8c61\u7b49\u4fe1\u606f\uff0c\u624d\u80fd\u591f\u6cbf AKF Y \u8f74\u3001Z \u8f74\u5168\u65b9\u4f4d\u6269\u5c55\u7cfb\u7edf\u3002\u56e0\u6b64\uff0c\u4e03\u5c42\u8d1f\u8f7d\u5747\u8861\u662f\u5206\u5e03\u5f0f\u7cfb\u7edf\u63d0\u5347\u6027\u80fd\u7684\u5229\u5668\u3002</p> <p>Nginx \u7684\u5f00\u653e\u5f0f\u67b6\u6784\u5141\u8bb8\u7b2c\u4e09\u65b9\u6a21\u5757\u901a\u8fc7 10 \u591a\u4e2a\u94a9\u5b50\u51fd\u6570\uff0c\u5728\u4e0d\u540c\u7684\u751f\u547d\u5468\u671f\u4e2d\u5904\u7406\u8bf7\u6c42\u3002\u540c\u65f6\uff0c\u8fd8\u5141\u8bb8 C \u6a21\u5757\u81ea\u884c\u89e3\u6790 nginx.conf \u914d\u7f6e\u6587\u4ef6\u3002\u8fd9\u6837\uff0cOpenResty \u5c31\u901a\u8fc7 2 \u4e2a C \u6a21\u5757\uff0c\u5c06 Lua \u4ee3\u7801\u7528 LuaJIT \u7f16\u8bd1\u5230 Nginx \u4e2d\u6267\u884c\uff0c\u5e76\u901a\u8fc7 FFI \u6280\u672f\u5c06 C \u51fd\u6570\u66b4\u9732\u7ed9 Lua \u4ee3\u7801\u3002\u8fd9\u5c31\u662f OpenResty \u5141\u8bb8 Lua \u8bed\u8a00\u4e0e C \u6a21\u5757\u534f\u540c\u5904\u7406\u8bf7\u6c42\u7684\u539f\u56e0\u3002</p> <p>OpenResty \u867d\u7136\u5c31\u662f Nginx\uff0c\u4f46\u7531\u4e8e\u7248\u672c\u53d1\u5e03\u9891\u7387\u4f4e\u4e8e\u5b98\u65b9 Nginx\uff0c\u56e0\u6b64\u4f7f\u7528\u4e86\u5355\u53f7\u7684 Mainline \u7248\u672c\u4ee5\u83b7\u5f97 Nginx \u7684\u6700\u65b0\u7279\u6027\u3002\u7531\u4e8e OpenResty \u9ed8\u8ba4\u52a0\u5165\u4e86\u56db\u5c42\u8d1f\u8f7d\u5747\u8861\u548c TLS \u534f\u8bae\u5904\u7406\u529f\u80fd\uff0c\u8fd8\u65b0\u589e\u4e86\u8fd1 20 \u4e2a\u7b2c\u4e09\u65b9 C \u6a21\u5757\uff0c\u8fd9\u9020\u6210\u5b83\u7f16\u8bd1\u51fa\u7684 Nginx \u4f53\u79ef\u5927\u4e86 5 \u500d\u3002\u5982\u679c\u65e0\u987b\u4f7f\u7528 Lua \u8bed\u8a00\u5c31\u80fd\u591f\u6ee1\u8db3\u4e1a\u52a1\u9700\u6c42\uff0c\u6211\u63a8\u8350\u4f60\u4f7f\u7528 Nginx\u3002</p>"},{"location":"chap3/6hash_consistent/","title":"\u7b2c\u516d\u8282 \u4e00\u81f4\u6027\u54c8\u5e0c\u7684\u5747\u8861\u8d1f\u8f7d","text":"<p>\u4f7f\u7528\u54c8\u5e0c\u7b97\u6cd5\u6269\u5c55\u7cfb\u7edf\u65f6\uff0c\u6700\u5927\u7684\u95ee\u9898\u5728\u4e8e\u4ee3\u8868\u54c8\u5e0c\u6876\u7684\u670d\u52a1\u5668\u8282\u70b9\u6570\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u54c8\u5e0c\u51fd\u6570\u5c31\u6539\u53d8\u4e86\uff0c\u6570\u636e\u4e0e\u8282\u70b9\u95f4\u7684\u6620\u5c04\u5173\u7cfb\u81ea\u7136\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u7ed3\u679c\u5927\u91cf\u6570\u636e\u5c31\u5f97\u5728\u670d\u52a1\u5668\u95f4\u8fc1\u79fb\u3002</p> <p>\u7279\u522b\u662f\u542b\u6709\u591a\u4efd\u5197\u4f59\u6570\u636e\u7684\u7cfb\u7edf\uff0c\u8fc1\u79fb\u5de5\u4f5c\u91cf\u66f4\u662f\u4f1a\u6210\u500d\u63d0\u9ad8\u3002</p> <p>\u4e3a\u4e86\u5728\u6574\u4f53\u4e0a\u66f4\u52a0\u5145\u5206\u5730\u4f7f\u7528 IT \u8d44\u6e90\uff0c\u6211\u4eec\u5fc5\u987b\u89e3\u51b3\u5206\u5e03\u5f0f\u7cfb\u7edf\u6269\u5c55\u65f6\u53ef\u80fd\u51fa\u73b0\u7684\u4e24\u4e2a\u95ee\u9898\uff1a\u6570\u636e\u5206\u5e03\u4e0d\u5747\u8861\u548c\u8bbf\u95ee\u91cf\u4e0d\u5747\u8861\u3002</p> <p>\u6bd4\u5982\uff0c\u5bf9\u4e8e\u5305\u542b 10 \u4e2a\u670d\u52a1\u5668\u8282\u70b9\u3001\u6301\u4e45\u5316 1 \u4ebf\u6761\u7528\u6237\u6570\u636e\u7684\u6709\u72b6\u6001\u670d\u52a1\uff0c\u5982\u679c\u91c7\u7528\u5173\u952e\u5b57\u6a21 <code>10\uff08key%10\uff09</code>\u7684\u54c8\u5e0c\u7b97\u6cd5\u4f5c\u4e3a\u8def\u7531\u7b56\u7565\uff0c\u5c31\u5f88\u96be\u4fdd\u8bc1\u6bcf\u4e2a\u8282\u70b9\u5904\u7406 1 \u5343\u4e07\u6761\u6570\u636e\uff0c\u90a3\u4e9b\u53ef\u80fd\u8fd8\u672a\u8fbe\u5230\u4e00\u534a\u8bbe\u8ba1\u5bb9\u91cf\u7684\u8282\u70b9\u4f1a\u6d6a\u8d39\u5927\u91cf\u78c1\u76d8\u7a7a\u95f4\u3002</p> <p>\u5373\u4f7f\u8282\u70b9\u95f4\u5b58\u50a8\u7684\u6570\u636e\u975e\u5e38\u5747\u5300\uff0c\u4f46\u8fd9\u4e9b\u6570\u636e\u95f4\u7684\u6d3b\u8dc3\u7a0b\u5ea6\u4e5f\u4e0d\u76f8\u540c\uff0c\u5b58\u653e\u70ed\u70b9\u6570\u636e\u8f83\u591a\u7684\u8282\u70b9\u8bbf\u95ee\u91cf\u975e\u5e38\u5927\uff0c\u5f88\u5bb9\u6613\u7387\u5148\u8fbe\u5230 CPU \u74f6\u9888\uff0c\u5728\u8bb8\u591a\u4e3b\u673a\u8282\u70b9\u8fd8\u5f88\u7a7a\u95f2\u65f6\uff0c\u6211\u4eec\u5c31\u5f97\u6269\u5bb9\u7cfb\u7edf\u3002</p>"},{"location":"chap3/6hash_consistent/#1","title":"1\u3001\u5982\u4f55\u51cf\u5c11\u6269\u5bb9\u3001\u7f29\u5bb9\u65f6\u8fc1\u79fb\u7684\u6570\u636e\u91cf\uff1f","text":"<p>\u5728\u4e3b\u673a\u786c\u4ef6\u8fbe\u5230\u6027\u80fd\u74f6\u9888\u540e\uff0c\u6709\u72b6\u6001\u670d\u52a1\u53ef\u4ee5\u6cbf AKF \u7acb\u65b9\u4f53 Z \u8f74\uff0c\u57fa\u4e8e\u54c8\u5e0c\u7b97\u6cd5\u6269\u5c55\u4e3a\u5206\u5e03\u5f0f\u7cfb\u7edf\u3002</p> <p>\u7cfb\u7edf\u4e2d\u62e5\u6709 5 \u4e2a\u8282\u70b9\uff0c\u54c8\u5e0c\u7b97\u6cd5\u5c06\u6bcf\u6761\u6570\u636e\u7684\u5173\u952e\u5b57\u6a21 5 \u5f97\u51fa\u7684\u6570\u5b57\u4f5c\u4e3a\u54c8\u5e0c\u6876\u5e8f\u53f7\uff0c\u4ece\u800c\u5c06\u6570\u636e\u6620\u5c04\u5230\u8282\u70b9\u4e0a\uff08\u5982\u679c\u5173\u952e\u5b57\u662f\u5b57\u7b26\u4e32\u6216\u8005\u5176\u4ed6\u7ed3\u6784\u5316\u6570\u636e\uff0c\u53ef\u4ee5\u5148\u901a\u8fc7\u5176\u4ed6\u54c8\u5e0c\u7b97\u6cd5\u8f6c\u6362\u4e3a\u6574\u6570\uff0c\u518d\u8fdb\u884c\u6a21\u8fd0\u7b97\uff09</p> <p></p> <p>\u7136\u800c\uff0c\u53d6\u6a21\u54c8\u5e0c\u51fd\u6570\u4e2d\u57fa\u6570\u7684\u53d8\u5316\uff0c\u5f80\u5f80\u4f1a\u5bfc\u81f4\u7edd\u5927\u90e8\u5206\u6620\u5c04\u5173\u7cfb\u6539\u53d8\uff0c\u6bd4\u5982\u4e0a\u4f8b\u4e2d\u7684 5 \u4e2a\u5173\u952e\u5b57\uff0c\u5728\u4e0b\u56fe\u4e2d\u96c6\u7fa4\u8282\u70b9\u6570\uff08\u5373\u57fa\u6570\uff09\u4ece 5 \u964d\u4e3a 4 \u65f6\uff0c\u539f\u6620\u5c04\u5173\u7cfb\u5168\u90e8\u5931\u6548\uff0c\u8fd9 5 \u6761\u6570\u636e\u90fd\u5f97\u8fc1\u79fb\u5230\u5176\u4ed6\u8282\u70b9\uff1a</p> <p></p> <p>1997 \u5e74\u53d1\u5e03\u7684\u300aConsistent Hashing and Random Trees\u300b\u8bba\u6587\u63d0\u51fa\u4e86\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\uff0c\u53ef\u4ee5\u5927\u5e45\u5ea6\u51cf\u5c11\u6570\u636e\u8fc1\u79fb\u91cf\u3002\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u662f\u901a\u8fc7\u4ee5\u4e0b 2 \u4e2a\u6b65\u9aa4\u6765\u5efa\u7acb\u6570\u636e\u4e0e\u4e3b\u673a\u8282\u70b9\u95f4\u6620\u5c04\u5173\u7cfb\u7684\uff1a</p> <ul> <li>\u5148\uff0c\u5c06\u5173\u952e\u5b57\u7ecf\u7531\u901a\u7528\u7684\u54c8\u5e0c\u51fd\u6570\u6620\u5c04\u4e3a 32 \u4f4d\u6574\u578b\u54c8\u5e0c\u503c\u3002\u8fd9\u4e9b\u54c8\u5e0c\u503c\u4f1a\u5f62\u6210 1 \u4e2a\u73af\uff0c\u6700\u5927\u7684\u6570\u5b57 <code>2^32</code> \u76f8\u5f53\u4e8e 0\u3002</li> <li> <p>\u5176\u6b21\uff0c\u8bbe\u96c6\u7fa4\u8282\u70b9\u6570\u4e3a N\uff0c\u5c06\u54c8\u5e0c\u73af\u7531\u5c0f\u81f3\u5927\u5206\u6210 N \u6bb5\uff0c\u6bcf\u4e2a\u4e3b\u673a\u8282\u70b9\u5904\u7406\u54c8\u5e0c\u503c\u843d\u5728\u8be5\u6bb5\u5185\u7684\u6570\u636e\u3002\u6bd4\u5982\u4e0b\u56fe\u4e2d\uff0c\u5f53\u8282\u70b9\u6570 N \u7b49\u4e8e 3 \u4e14\u5747\u5300\u5730\u5206\u6bb5\u65f6\uff0c</p> </li> <li> <p>\u8282\u70b9 0 \u5904\u7406\u54c8\u5e0c\u503c\u5728 <code>[0, 1/3\u22172^32]</code> \u8303\u56f4\u5185\u7684\u5173\u952e\u5b57\uff0c</p> </li> <li>\u8282\u70b9 1 \u5904\u7406<code>[1/3\u22172^32, 2/3\u22172^32]</code>\u8303\u56f4\u5185\u7684\u5173\u952e\u5b57\uff0c</li> <li>\u8282\u70b9 2 \u5219\u5904\u7406\u7684\u8303\u56f4\u662f <code>[2/3\u200b\u22172^32, 2^32]</code>\uff1a</li> </ul> <p></p> <p>\u5f53\u7136\uff0c\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u4e3b\u673a\u8282\u70b9\u5f88\u53ef\u80fd\u662f\u5f02\u6784\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u7ed9\u9ad8\u89c4\u683c\u7684\u670d\u52a1\u5668\u8282\u70b9\u8d4b\u4e88\u66f4\u9ad8\u7684\u6743\u91cd\u3002\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u6539\u53d8\u8282\u70b9\u7684\u6743\u91cd\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u8981\u7ed9\u6bcf\u4e2a\u8282\u70b9\u5206\u914d\u66f4\u5927\u7684\u5f27\u957f\u5373\u53ef\u3002</p> <p>\u4f8b\u5982\uff0c\u5982\u679c\u4e0a\u56fe\u4e2d\u7684\u8282\u70b9 0 \u62e5\u6709\u66f4\u9ad8\u7684\u786c\u4ef6\u914d\u7f6e\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06\u539f\u672c\u5747\u5300\u5206\u5e03\u7684 3 \u4e2a\u8282\u70b9\u8c03\u6574\u4e3a 2:1:1 \u7684\u6743\u91cd </p> <ul> <li>\u8fd9\u6837\u8282\u70b9 0 \u5904\u7406\u7684\u54c8\u5e0c\u503c\u8303\u56f4\u8c03\u6574\u4e3a <code>[0, 2^31]</code>\uff0c</li> <li>\u8282\u70b9 1 \u7684\u5904\u7406\u8303\u56f4\u8c03\u6574\u4e3a <code>[2^31, 3\u22172^30]</code>\uff0c</li> <li>\u8282\u70b9 2 \u7684\u5904\u7406\u8303\u56f4\u8c03\u6574\u4e3a <code>[3\u22172^30, 2^32]</code></li> </ul> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u800c\u6269\u5bb9\u3001\u7f29\u5bb9\u65f6\uff0c\u867d\u7136\u8282\u70b9\u6570\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u4f46\u53ea\u8981\u5c0f\u5e45\u5ea6\u8c03\u6574\u73af\u4e0a\u5404\u8282\u70b9\u7684\u4f4d\u7f6e\uff0c\u5c31\u4e0d\u4f1a\u5bfc\u81f4\u5927\u91cf\u6570\u636e\u7684\u8fc1\u79fb\u3002</p> <p>\u6bd4\u5982\u4e0b\u56fe\u4e2d\u6211\u4eec\u5c06 3 \u4e2a\u8282\u70b9\u7684\u96c6\u7fa4\u6269\u5bb9\u4e3a 4 \u4e2a\u8282\u70b9\uff0c\u53ea\u9700\u8981\u5c06\u8282\u70b9 0 \u4e0a\u4e00\u534a\u7684\u6570\u636e\u8fc1\u79fb\u81f3\u8282\u70b9 3 \u5373\u53ef\uff0c\u5176\u4ed6\u8282\u70b9\u4e0d\u53d7\u5f71\u54cd\uff1a</p> <p></p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u4ece\u6210\u672c\u4e0a\u5206\u6790\u4e0b\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u7684\u4f18\u52a3\u3002</p> <p>\u5047\u8bbe\u603b\u6570\u636e\u6761\u6570\u4e3a M\uff0c\u800c\u8282\u70b9\u4e2a\u6570\u4e3a N\uff0c\u5148\u6765\u770b\u6620\u5c04\u51fd\u6570\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u4f20\u7edf\u7684\u54c8\u5e0c\u7b97\u6cd5\u4ee5 N \u4e3a\u57fa\u6570\u6267\u884c\u53d6\u6a21\u8fd0\u7b97\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a O(1)\uff1b</p> <p>\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u9700\u8981\u5c06\u5173\u952e\u5b57\u5148\u8f6c\u6362\u4e3a 32 \u4f4d\u6574\u578b\uff08\u8fd9 1 \u6b65\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f O(1)\uff09\uff0c\u518d\u6839\u636e\u54c8\u5e0c\u73af\u4e2d\u5404\u8282\u70b9\u7684\u5904\u7406\u8303\u56f4\uff0c\u627e\u5230\u6240\u5c5e\u7684\u8282\u70b9\u3002\u7531\u4e8e\u6240\u6709\u8282\u70b9\u662f\u6709\u5e8f\u6392\u5217\u7684\uff0c\u6240\u4ee5\u91c7\u7528\u4e8c\u5206\u6cd5\uff0c\u53ef\u4ee5\u5728 O(logN) \u65f6\u95f4\u590d\u6742\u5ea6\u5185\uff0c\u5b8c\u6210\u5173\u952e\u5b57\u5230\u8282\u70b9\u4f4d\u7f6e\u7684\u6620\u5c04\u3002</p> <p>\u518d\u6765\u8bc4\u4f30\u4e0b\u6570\u636e\u7684\u8fc1\u79fb\u89c4\u6a21\u3002\u8282\u70b9\u53d8\u5316\u4f1a\u5bfc\u81f4\u4f20\u7edf\u54c8\u5e0c\u7b97\u6cd5\u7684\u6620\u5c04\u7ed3\u679c\u4e0d\u53ef\u63a7\uff0c\u6700\u574f\u60c5\u51b5\u4e0b\u6240\u6709\u6570\u636e\u90fd\u9700\u8981\u8fc1\u79fb\uff0c\u6240\u4ee5\u5b83\u7684\u6570\u636e\u8fc1\u79fb\u89c4\u6a21\u662f O(M)\uff1b</p> <p>\u5bf9\u4e8e\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8c03\u6574\u8282\u70b9\u4f4d\u7f6e\uff0c\u4efb\u610f\u8bbe\u5b9a\u8fc1\u79fb\u89c4\u6a21\u3002\u5728\u73af\u4e2d\u5404\u8282\u70b9\u5747\u5300\u5206\u5e03\u7684\u60c5\u51b5\u4e0b\uff0c\u6570\u636e\u8fc1\u79fb\u89c4\u6a21\u662f O(M/N)\u3002</p> <p>\u56e0\u6b64\uff0c\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u7684\u7f3a\u70b9\u662f\u5c06\u6620\u5c04\u51fd\u6570\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4ece <code>O(1)</code>\u63d0\u9ad8\u5230\u4e86<code>O(logN)</code>\uff0c\u5b83\u7684\u4f18\u70b9\u662f\u5c06\u6570\u636e\u8fc1\u79fb\u89c4\u6a21\u4ece O(M) \u964d\u4f4e\u81f3 <code>O(M/N)</code>\u3002</p> <p>\u7531\u4e8e\u6570\u636e\u6761\u6570 M \u8fdc\u5927\u4e8e\u4e3b\u673a\u8282\u70b9\u6570 N\uff0c\u800c\u4e14\u6570\u636e\u8fc1\u79fb\u7684\u6210\u672c\u5f88\u5927\uff0c\u6240\u4ee5\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u66f4\u5212\u7b97\uff0c\u5b83\u7684\u9002\u7528\u573a\u666f\u4e5f\u66f4\u5e7f\uff01</p>"},{"location":"chap3/6hash_consistent/#2","title":"2\u3001\u5982\u4f55\u901a\u8fc7\u865a\u62df\u8282\u70b9\u63d0\u9ad8\u5747\u8861\u5ea6\uff1f","text":"<p>\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u867d\u7136\u964d\u4f4e\u4e86\u6570\u636e\u7684\u8fc1\u79fb\u91cf\uff0c\u4f46\u5374\u9057\u7559\u4e86\u4e24\u4e2a\u95ee\u9898\u6ca1\u6709\u89e3\u51b3\u3002</p> <p>\u9996\u5148\uff0c\u5982\u679c\u6620\u5c04\u540e\u54c8\u5e0c\u73af\u4e2d\u7684\u6570\u5b57\u5206\u5e03\u4e0d\u5747\u5300\uff0c\u5c31\u4f1a\u5bfc\u81f4\u5404\u8282\u70b9\u5904\u7406\u7684\u6570\u636e\u4e0d\u5747\u8861\uff0c\u4ece\u800c\u964d\u4f4e\u4e86\u7cfb\u7edf\u7684\u8fd0\u884c\u6548\u7387\u4e0e\u6027\u80fd\u3002\u5728\u65e0\u6cd5\u627e\u51fa\u5206\u5e03\u89c4\u5f8b\u65f6\uff0c\u6211\u4eec\u4e5f\u65e0\u6cd5\u901a\u8fc7\u8c03\u6574\u73af\u4e2d\u8282\u70b9\u7684\u6743\u91cd\uff0c\u5e73\u8861\u5404\u8282\u70b9\u5904\u7406\u7684\u6570\u636e\u91cf\u3002</p> <p>\u5176\u6b21\uff0c\u5bb9\u707e\u4e0e\u6269\u5bb9\u65f6\uff0c\u54c8\u5e0c\u73af\u4e0a\u7684\u76f8\u90bb\u8282\u70b9\u5bb9\u6613\u53d7\u5230\u8fc7\u5927\u5f71\u54cd\u3002\u6bd4\u5982\u4e0b\u56fe\u4e2d\uff0c\u5f53\u8282\u70b9 0 \u5b95\u673a\u540e\uff0c\u6839\u636e\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u7684\u89c4\u5219\uff0c\u5176\u4e0a\u6570\u636e\u5e94\u8be5\u5168\u90e8\u8fc1\u79fb\u5230\u76f8\u90bb\u7684\u8282\u70b9 1 \u4e0a\uff0c\u8fd9\u6837\uff0c\u8282\u70b9 1 \u7684\u6570\u636e\u91cf\u3001\u8bbf\u95ee\u91cf\u90fd\u4f1a\u8fc5\u901f\u589e\u52a0 1 \u500d\uff0c\u4e00\u65e6\u65b0\u589e\u7684\u538b\u529b\u8d85\u8fc7\u4e86\u8282\u70b9 1 \u7684\u5904\u7406\u80fd\u529b\u4e0a\u9650\uff0c\u5c31\u4f1a\u5bfc\u81f4\u8282\u70b9 1 \u5d29\u6e83\uff0c\u8fdb\u800c\u5f62\u6210\u96ea\u5d29\u5f0f\u7684\u8fde\u9501\u53cd\u5e94\uff1a</p> <p></p> <p>\u7cfb\u7edf\u6269\u5bb9\u65f6\u4e5f\u9762\u4e34\u7740\u540c\u6837\u7684\u95ee\u9898\uff0c\u9664\u975e\u540c\u65f6\u8c03\u6574\u73af\u4e2d\u5404\u8282\u70b9\u7684\u4f4d\u7f6e\uff0c\u5426\u5219\u6269\u5bb9\u8282\u70b9\u4e5f\u53ea\u4f1a\u51cf\u8f7b\u76f8\u90bb\u8282\u70b9\u7684\u8d1f\u8f7d\u3002</p> <p>\u5f53\u6570\u636e\u5b58\u5728\u591a\u4efd\u5197\u4f59\u65f6\uff0c\u8fd9\u4e24\u7c7b\u95ee\u9898\u4f1a\u88ab\u8fdb\u4e00\u6b65\u653e\u5927\u3002</p> <p>\u90a3\u5982\u4f55\u63d0\u9ad8\u5747\u8861\u6027\u5462\uff1f</p> <p>\u5728\u771f\u5b9e\u7684\u6570\u636e\u8282\u70b9\u4e0e\u54c8\u5e0c\u73af\u4e4b\u95f4\u5f15\u5165\u4e00\u4e2a\u865a\u62df\u8282\u70b9\u5c42\uff0c\u5c31\u53ef\u4ee5\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002</p> <p>\u4f8b\u5982\u4e0b\u56fe\u4e2d\u7684\u96c6\u7fa4\u542b\u6709 4 \u4e2a\u8282\u70b9\uff0c\u4f46\u6211\u4eec\u5e76\u4e0d\u76f4\u63a5\u5c06\u54c8\u5e0c\u73af\u5206\u4e3a 4 \u4efd\uff0c\u800c\u662f\u5c06\u5b83\u5747\u5300\u5730\u5206\u4e3a 32 \u4efd\u5e76\u8d4b\u4e88 32 \u4e2a\u865a\u62df\u8282\u70b9\uff0c\u56e0\u6b64\u6bcf\u4e2a\u865a\u62df\u8282\u70b9\u4f1a\u5904\u7406 227 \u4e2a\u54c8\u5e0c\u503c\uff0c\u518d\u5c06 32 \u4e2a\u865a\u62df\u8282\u70b9\u901a\u8fc7\u67d0\u4e2a\u54c8\u5e0c\u51fd\u6570\uff08\u6bd4\u5982 <code>CRC32</code>\uff09\u6620\u5c04\u5230 4 \u4e2a\u771f\u5b9e\u8282\u70b9\u4e0a\uff08\u6bd4\u5982\u56fe\u4e2d 8 \u4e2a\u7eff\u8272\u865a\u62df\u8282\u70b9\u7686\u7531\u540c\u8272\u7684\u4e3b\u673a\u8282\u70b9 0 \u5904\u7406\uff09\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u5982\u679c\u56fe\u4e2d\u7eff\u8272\u7684\u8282\u70b9 0 \u5b95\u673a\uff0c\u6309\u7167\u54c8\u5e0c\u73af\u4e0a\u6570\u636e\u7684\u8fc1\u79fb\u89c4\u5219\uff0c8 \u4e2a\u7eff\u8272\u865a\u62df\u8282\u70b9\u4e0a\u7684\u6570\u636e\u5c31\u4f1a\u6cbf\u7740\u987a\u65f6\u9488\u65b9\u5411\uff0c\u5206\u522b\u8fc1\u79fb\u81f3\u76f8\u90bb\u7684\u865a\u62df\u8282\u70b9\u4e0a\uff0c\u6700\u7ec8\u4f1a\u8fc1\u79fb\u5230\u771f\u5b9e\u8282\u70b9 1\uff08\u6a59\u8272\uff09\u3001\u8282\u70b9 2\uff08\u84dd\u8272\uff09\u3001\u8282\u70b9 3\uff08\u6c34\u7ea2\u8272\uff09\u4e0a\u3002\u6240\u4ee5\uff0c\u5b95\u673a\u8282\u70b9\u4e0a\u7684\u6570\u636e\u4f1a\u8fc1\u79fb\u5230\u5176\u4ed6\u6240\u6709\u8282\u70b9\u4e0a\u3002</p> <p>\u6269\u5bb9\u65f6\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u901a\u8fc7\u865a\u62df\u8282\u70b9\u73af\uff0c\u65b0\u589e\u8282\u70b9\u53ef\u4ee5\u5206\u62c5\u73b0\u6709\u5168\u90e8\u8282\u70b9\u7684\u538b\u529b\u3002\u81f3\u4e8e\u865a\u62df\u8282\u70b9\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u8ba9\u6570\u636e\u7684\u5206\u5e03\u66f4\u5747\u8861\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u865a\u62df\u8282\u70b9\u4e0e\u771f\u5b9e\u8282\u70b9\u95f4\uff0c\u53c8\u589e\u52a0\u4e86\u4e00\u5c42\u54c8\u5e0c\u6620\u5c04\uff0c\u54c8\u5e0c\u51fd\u6570\u4f1a\u5c06\u539f\u672c\u4e0d\u5747\u5300\u7684\u6570\u5b57\u8fdb\u4e00\u6b65\u6253\u6563\u3002</p> <p>\u4e0a\u56fe\u4e3a\u4e86\u65b9\u4fbf\u4f60\u7406\u89e3\uff0c\u6bcf\u4e2a\u771f\u5b9e\u8282\u70b9\u4ec5\u5305\u542b 8 \u4e2a\u865a\u62df\u8282\u70b9\uff0c\u8fd9\u6837\u80fd\u8d77\u5230\u7684\u5747\u8861\u6548\u679c\u5176\u5b9e\u5f88\u6709\u9650\u3002\u800c\u5728\u5b9e\u9645\u7684\u5de5\u7a0b\u4e2d\uff0c\u865a\u62df\u8282\u70b9\u7684\u6570\u91cf\u4f1a\u5927\u5f88\u591a\uff0c\u6bd4\u5982 Nginx \u7684\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\uff0c\u6bcf\u4e2a\u6743\u91cd\u4e3a 1 \u7684\u771f\u5b9e\u8282\u70b9\u5c31\u542b\u6709160 \u4e2a\u865a\u62df\u8282\u70b9\u3002</p> <p>\u5f53\u7136\uff0c\u6709\u4e86\u865a\u62df\u8282\u70b9\u540e\uff0c\u4e3a\u5f02\u6784\u7684\u670d\u52a1\u5668\u8282\u70b9\u8bbe\u7f6e\u6743\u91cd\u4e5f\u66f4\u65b9\u4fbf\u3002\u53ea\u9700\u8981\u4e3a\u6743\u91cd\u9ad8\u7684\u771f\u5b9e\u8282\u70b9\uff0c\u8d4b\u4e88\u66f4\u591a\u7684\u865a\u62df\u8282\u70b9\u5373\u53ef\u3002\u6ce8\u610f\uff0c\u865a\u62df\u8282\u70b9\u589e\u591a\u867d\u7136\u4f1a\u63d0\u5347\u5747\u8861\u6027\uff0c\u4f46\u4e5f\u4f1a\u6d88\u8017\u66f4\u591a\u7684\u5185\u5b58\u4e0e\u8ba1\u7b97\u529b\u3002</p>"},{"location":"chap3/6hash_consistent/#3","title":"3\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u4f20\u7edf\u54c8\u5e0c\u51fd\u6570\u4e2d\uff0c\u4e3b\u673a\u8282\u70b9\u7684\u53d8\u5316\u4f1a\u5bfc\u81f4\u5927\u91cf\u6570\u636e\u53d1\u751f\u8fc1\u79fb\u3002</p> <p>\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u5c06 32 \u4f4d\u54c8\u5e0c\u503c\u6784\u6210\u73af\uff0c\u5e76\u5c06\u5b83\u5206\u6bb5\u8d4b\u4e88\u5404\u8282\u70b9\uff0c\u8fd9\u6837\uff0c\u6269\u5bb9\u3001\u7f29\u5bb9\u52a8\u4f5c\u5c31\u53ea\u5f71\u54cd\u76f8\u90bb\u8282\u70b9\uff0c\u5927\u5e45\u5ea6\u51cf\u5c11\u4e86\u6570\u636e\u8fc1\u79fb\u91cf\u3002</p> <p>\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u867d\u7136\u5c06\u6570\u636e\u7684\u8fc1\u79fb\u91cf\u4ece <code>O(M)</code> \u964d\u4e3a <code>O(M/N)</code>\uff0c\u5374\u4e5f\u5c06\u6620\u5c04\u51fd\u6570\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4ece <code>O(1)</code> \u63d0\u9ad8\u5230 <code>O(logN)</code>\uff0c\u4f46\u7531\u4e8e\u8282\u70b9\u6570\u91cf N \u5e76\u4e0d\u4f1a\u5f88\u5927\uff0c\u6240\u4ee5\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u7684\u6027\u4ef7\u6bd4\u8fd8\u662f\u5f88\u9ad8\u7684\u3002</p> <p>\u5f53\u54c8\u5e0c\u503c\u5206\u5e03\u4e0d\u5747\u5300\u65f6\uff0c\u6570\u636e\u5206\u5e03\u4e5f\u4e0d\u4f1a\u5747\u8861\u3002\u5728\u54c8\u5e0c\u73af\u4e0e\u771f\u5b9e\u8282\u70b9\u95f4\uff0c\u6dfb\u52a0\u865a\u62df\u8282\u70b9\u5c42\uff0c\u53ef\u4ee5\u901a\u8fc7\u65b0\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u5206\u6563\u4e0d\u5747\u5300\u7684\u6570\u636e\u3002\u6bcf\u4e2a\u771f\u5b9e\u8282\u70b9\u542b\u6709\u7684\u865a\u62df\u8282\u70b9\u6570\u8d8a\u591a\uff0c\u6570\u636e\u5206\u5e03\u4fbf\u4f1a\u8d8a\u5747\u8861\uff0c\u4f46\u540c\u65f6\u4e5f\u4f1a\u6d88\u8017\u66f4\u591a\u7684\u5185\u5b58\u4e0e\u8ba1\u7b97\u529b\u3002</p> <p>\u865a\u62df\u8282\u70b9\u5e26\u6765\u7684\u6700\u5927\u4f18\u70b9\uff0c\u662f\u5b95\u673a\u65f6\u7531\u6240\u6709\u8282\u70b9\u5171\u540c\u5206\u62c5\u6d41\u91cf\u7f3a\u53e3\uff0c\u8fd9\u907f\u514d\u4e86\u53ef\u80fd\u4ea7\u751f\u7684\u96ea\u5d29\u6548\u5e94\u3002\u540c\u65f6\uff0c\u6269\u5bb9\u7684\u65b0\u8282\u70b9\u4e5f\u4f1a\u5206\u6d41\u6240\u6709\u8282\u70b9\u7684\u538b\u529b\uff0c\u8fd9\u4e5f\u63d0\u5347\u4e86\u7cfb\u7edf\u6574\u4f53\u8d44\u6e90\u7684\u5229\u7528\u7387\u3002</p>"},{"location":"chap3/7cache_expire/","title":"\u7b2c\u4e03\u8282 \u8fc7\u671f\u7f13\u5b58\u9632\u6b62\u7f13\u5b58\u88ab\u6d41\u91cf\u6253\u7a7f","text":"<p>\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u7f13\u5b58\u65e0\u5904\u4e0d\u5728\u3002</p> <p>\u6bd4\u5982\uff0c\u6d4f\u89c8\u5668\u4f1a\u7f13\u5b58\u7528\u6237 Cookie\uff0cCDN \u4f1a\u7f13\u5b58\u56fe\u7247\uff0c\u8d1f\u8f7d\u5747\u8861\u4f1a\u7f13\u5b58 TLS \u7684\u63e1\u624b\u4fe1\u606f\uff0cRedis \u4f1a\u7f13\u5b58\u7528\u6237\u7684 session\uff0cMySQL \u4f1a\u7f13\u5b58 select \u67e5\u8be2\u51fa\u7684\u884c\u6570\u636e\uff0cHTTP/2 \u4f1a\u7528\u52a8\u6001\u8868\u7f13\u5b58\u4f20\u8f93\u8fc7\u7684 HTTP \u5934\u90e8\uff0cTCP Socket Buffer \u4f1a\u7f13\u5b58 TCP \u62a5\u6587\uff0cPage Cache \u4f1a\u7f13\u5b58\u78c1\u76d8 IO\uff0cCPU \u4f1a\u7f13\u5b58\u4e3b\u5b58\u4e0a\u7684\u6570\u636e\uff0c\u7b49\u7b49\u3002</p> <p>\u53ea\u8981\u7cfb\u7edf\u95f4\u7684\u8bbf\u95ee\u901f\u5ea6\u6709\u8f83\u5927\u5dee\u5f02\uff0c\u7f13\u5b58\u5c31\u80fd\u63d0\u5347\u6027\u80fd\u3002\u6bd4\u5982\uff0cMySQL \u4e3a\u907f\u514d\u81ea\u8eab\u7f13\u5b58\u4e0e Page Cache \u7684\u91cd\u5408\uff0c\u5c31\u4f7f\u7528\u76f4\u63a5 IO \u7ed5\u8fc7\u4e86\u78c1\u76d8\u9ad8\u901f\u7f13\u5b58\u3002</p> <p>\u7f13\u5b58\u63d0\u5347\u6027\u80fd\u7684\u5e45\u5ea6\uff0c\u4e0d\u53ea\u53d6\u51b3\u4e8e\u5b58\u50a8\u4ecb\u8d28\u7684\u901f\u5ea6\uff0c\u8fd8\u53d6\u51b3\u4e8e\u7f13\u5b58\u547d\u4e2d\u7387\u3002</p> <p>\u4e3a\u4e86\u63d0\u9ad8\u547d\u4e2d\u7387\uff0c\u7f13\u5b58\u4f1a\u57fa\u4e8e\u65f6\u95f4\u3001\u7a7a\u95f4\u4e24\u4e2a\u7ef4\u5ea6\u66f4\u65b0\u6570\u636e\u3002\u5728\u65f6\u95f4\u4e0a\u53ef\u4ee5\u91c7\u7528 LRU\u3001FIFO \u7b49\u7b97\u6cd5\u6dd8\u6c70\u6570\u636e\uff0c\u800c\u5728\u7a7a\u95f4\u4e0a\u5219\u53ef\u4ee5\u9884\u8bfb\u3001\u5408\u5e76\u8fde\u7eed\u7684\u6570\u636e\u3002</p> <p>\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u7f13\u5b58\u670d\u52a1\u4f1a\u4e3a\u4e0a\u6e38\u5e94\u7528\u6321\u4f4f\u8bb8\u591a\u6d41\u91cf\u3002\u5982\u679c\u53ea\u662f\u7b80\u5355\u7684\u57fa\u4e8e\u5b9a\u65f6\u5668\u6dd8\u6c70\u7f13\u5b58\uff0c\u4e00\u65e6\u70ed\u70b9\u6570\u636e\u5728\u7f13\u5b58\u4e2d\u5931\u6548\uff0c\u8d85\u8f7d\u7684\u6d41\u91cf\u4f1a\u7acb\u523b\u6253\u57ae\u4e0a\u6e38\u5e94\u7528\uff0c\u5bfc\u81f4\u7cfb\u7edf\u4e0d\u53ef\u7528\u3002</p>"},{"location":"chap3/7cache_expire/#1","title":"1\u3001\u7f13\u5b58\u662f\u6700\u6709\u6548\u7684\u6027\u80fd\u63d0\u5347\u5de5\u5177","text":"<p>\u5728\u8ba1\u7b97\u673a\u4f53\u7cfb\u4e2d\uff0c\u5404\u7c7b\u786c\u4ef6\u7684\u8bbf\u95ee\u901f\u5ea6\u5929\u5dee\u5730\u522b\u3002\u6bd4\u5982\uff1a</p> <ul> <li>CPU \u8bbf\u95ee\u7f13\u5b58\u7684\u8017\u65f6\u5728 10 \u7eb3\u79d2\u5de6\u53f3\uff0c\u8bbf\u95ee\u5185\u5b58\u7684\u65f6\u5ef6\u5219\u7ffb\u4e86 10 \u500d\uff1b</li> <li>\u5982\u679c\u8bbf\u95ee SSD \u56fa\u6001\u78c1\u76d8\uff0c\u65f6\u95f4\u8fd8\u8981\u518d\u7ffb\u4e2a 1000 \u500d\uff0c\u8fbe\u5230 100 \u5fae\u79d2\uff1b</li> <li>\u5982\u679c\u8bbf\u95ee\u673a\u68b0\u786c\u76d8\uff0c\u5bf9\u968f\u673a\u5c0f IO \u7684\u8bbf\u95ee\u8981\u518d\u7ffb\u4e2a 100 \u500d\uff0c\u65f6\u5ef6\u63a5\u8fd1 10 \u6beb\u79d2\uff1b</li> <li>\u5982\u679c\u8de8\u8d8a\u7f51\u7edc\uff0c\u8bbf\u95ee\u65f6\u5ef6\u66f4\u8981\u53d7\u5236\u4e8e\u4e3b\u673a\u4e4b\u95f4\u7684\u7269\u7406\u8ddd\u79bb\u3002\u6bd4\u5982\u676d\u5dde\u5230\u4f26\u6566\u76f8\u8ddd 9200 \u516c\u91cc\uff0cping \u65f6\u5ef6\u63a5\u8fd1 200 \u6beb\u79d2\u3002\u5f53\u7136\uff0c\u7f51\u7edc\u4f20\u8f93\u7684\u53ef\u9760\u6027\u4f4e\u5f88\u591a\uff0c\u4e00\u65e6\u62a5\u6587\u4e22\u5931\uff0cTCP \u8fd8\u9700\u8981\u81f3\u5c11 1 \u79d2\u949f\u624d\u80fd\u5b8c\u6210\u62a5\u6587\u91cd\u4f20\u3002</li> </ul> <p>\u6700\u5feb\u7684 CPU \u7f13\u5b58\u4e0e\u6700\u6162\u7684\u7f51\u7edc\u4f20\u8f93\uff0c\u6709 1 \u4ebf\u500d\u7684\u901f\u5ea6\u5dee\u8ddd\uff01</p> <p>\u6211\u4eec\u4f1a\u4f7f\u7528\u9ad8\u901f\u7684\u5b58\u50a8\u4ecb\u8d28\u521b\u5efa\u7f13\u51b2\u533a\uff0c\u901a\u8fc7\u9884\u5904\u7406\u3001\u6279\u5904\u7406\u4ee5\u53ca\u7f13\u51b2\u6570\u636e\u7684\u53cd\u590d\u547d\u4e2d\uff0c\u63d0\u5347\u7cfb\u7edf\u7684\u6574\u4f53\u6027\u80fd\u3002</p> <p>\u4e0d\u53ea\u662f\u786c\u4ef6\u5c42\u9762\uff0c\u8f6f\u4ef6\u8bbe\u8ba1\u5bf9\u8bbf\u95ee\u901f\u5ea6\u7684\u5f71\u54cd\u66f4\u5927\u3002\u6bd4\u5982\uff0c\u5bf9\u5173\u7cfb\u6570\u636e\u5e93\u7684\u975e\u7d22\u5f15\u5217\u505a\u6761\u4ef6\u67e5\u8be2\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(N)\uff0c\u800c\u5bf9 Memcached \u505a Key/Value \u67e5\u8be2\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5219\u662f O(1)\uff0c\u6240\u4ee5\u5728\u6d77\u91cf\u6570\u636e\u4e0b\uff0c\u4e24\u8005\u7684\u6027\u80fd\u5dee\u8ddd\u8fdc\u9ad8\u4e8e\u786c\u4ef6\u3002\u56e0\u6b64\uff0cRabbitMQ\u3001Kafka \u8fd9\u6837\u7684\u6d88\u606f\u670d\u52a1\u4e5f\u4f1a\u5145\u5f53\u9ad8\u901f\u3001\u4f4e\u901f\u5e94\u7528\u95f4\u7684\u7f13\u5b58\u3002</p> <p>\u5982\u679c\u4e24\u4e2a\u5b9e\u4f53\u4e4b\u95f4\u7684\u8bbf\u95ee\u65f6\u5ef6\u5dee\u8ddd\u8fc7\u5927\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u591a\u7ea7\u7f13\u5b58\uff0c\u9010\u7ea7\u964d\u4f4e\u8bbf\u95ee\u901f\u5ea6\u5dee\uff0c\u63d0\u5347\u6574\u4f53\u6027\u80fd</p> <p>CPU \u4e09\u7ea7\u7f13\u5b58\uff0c\u6bcf\u7ea7\u7f13\u5b58\u8d8a\u9760\u8fd1 CPU \u901f\u5ea6\u8d8a\u5feb\uff0c\u5bb9\u91cf\u4e5f\u8d8a\u5c0f\uff0c\u4ee5\u6b64\u7f13\u89e3 CPU \u9891\u7387\u4e0e\u4e3b\u5b58\u7684\u901f\u5ea6\u5dee\uff0c\u63d0\u5347 CPU \u7684\u8fd0\u884c\u6548\u7387\u3002</p> <p></p> <p>\u518d\u6bd4\u5982\u4e0b\u56fe\u7684 Web \u573a\u666f\u4e2d\uff0c\u6d4f\u89c8\u5668\u7684\u672c\u5730\u7f13\u5b58\u3001\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e2d\u7684 TCP \u7f13\u51b2\u533a\uff08\u3001\u8d1f\u8f7d\u5747\u8861\u4e2d\u7684 TLS \u63e1\u624b\u7f13\u5b58\u3001\u5e94\u7528\u670d\u52a1\u4e2d\u7684 HTTP \u54cd\u5e94\u7f13\u5b58\u3001MySQL \u4e2d\u7684\u67e5\u8be2\u7f13\u5b58\u7b49\uff0c\u6bcf\u4e00\u7ea7\u7f13\u5b58\u90fd\u7f13\u89e3\u4e86\u4e0a\u4e0b\u6e38\u95f4\u4e0d\u5747\u8861\u7684\u8bbf\u95ee\u901f\u5ea6\uff0c\u901a\u8fc7\u7f29\u77ed\u8bbf\u95ee\u8def\u5f84\u964d\u4f4e\u4e86\u8bf7\u6c42\u65f6\u5ef6\uff0c\u901a\u8fc7\u5f02\u6b65\u8bbf\u95ee\u3001\u6279\u91cf\u5904\u7406\u63d0\u5347\u4e86\u7cfb\u7edf\u6548\u7387\u3002</p> <p></p> <p>\u5f53\u7136\uff0c\u7f13\u5b58\u4f7f\u7528\u4e86\u7b80\u5355\u7684 Key/Value \u7ed3\u6784\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u54c8\u5e0c\u8868\u3001\u67e5\u627e\u6811\u7b49\u5bb9\u5668\u505a\u7d22\u5f15\uff0c\u8fd9\u4e5f\u63d0\u5347\u4e86\u8bbf\u95ee\u901f\u5ea6\u3002</p> <p>\u4ece\u7cfb\u7edf\u5e95\u5c42\u5230\u4e1a\u52a1\u9ad8\u5c42\uff0c\u7f13\u5b58\u90fd\u5927\u6709\u7528\u6b66\u4e4b\u5730\u3002\u6bd4\u5982\u5728 Django \u8fd9\u4e2a Python Web Server \u4e2d\uff0c\u65e2\u53ef\u4ee5\u4f7f\u7528\u89c6\u56fe\u7f13\u5b58\uff0c\u5c06\u52a8\u6001\u7684 HTTP \u54cd\u5e94\u7f13\u5b58\u4e0b\u6765\uff1a</p> <pre><code>from django.views.decorators.cache import cache_page\n\n@cache_page(60 * 15)\ndef my_view(request):\n    ...\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528django-cachealot \u8fd9\u6837\u7684\u4e2d\u95f4\u4ef6\uff0c\u5c06\u6240\u6709 SQL \u67e5\u8be2\u7ed3\u679c\u7f13\u5b58\u8d77\u6765:</p> <pre><code>INSTALLED_APPS = [\n  ...\n  'cachalot',\n  ...\n]\n</code></pre> <p>\u8fd8\u53ef\u4ee5\u5728\u66f4\u7ec6\u7684\u7c92\u5ea6\u4e0a\uff0c\u4f7f\u7528 Cache API \u4e2d\u7684 get\u3001set \u7b49\u51fd\u6570\uff0c\u5c06\u8f83\u4e3a\u8017\u65f6\u7684\u8fd0\u7b97\u7ed3\u679c\u5b58\u653e\u5728\u7f13\u5b58\u4e2d\uff1a</p> <pre><code>\ncache.set('online_user_count', counts, 3600)\nuser_count = cache.get('online_user_count')\n</code></pre>"},{"location":"chap3/7cache_expire/#2","title":"2\u3001\u7f13\u5b58\u6570\u636e\u7684\u66f4\u65b0\u65b9\u5f0f","text":"<p>\u7f13\u5b58\u7684\u5b58\u50a8\u5bb9\u91cf\u5f80\u5f80\u5c0f\u4e8e\u539f\u59cb\u6570\u636e\u96c6\uff0c\u8fd9\u6709\u8bb8\u591a\u539f\u56e0\uff0c\u6bd4\u5982\uff1a</p> <ul> <li>\u7f13\u5b58\u4f7f\u7528\u4e86\u901f\u5ea6\u66f4\u5feb\u7684\u5b58\u50a8\u4ecb\u8d28\uff0c\u800c\u8fd9\u7c7b\u786c\u4ef6\u7684\u5355\u4f4d\u5bb9\u91cf\u66f4\u6602\u8d35\uff0c\u56e0\u6b64\u4ece\u7ecf\u6d4e\u539f\u56e0\u4e0a\u53ea\u80fd\u9009\u62e9\u66f4\u5c0f\u7684\u5b58\u50a8\u5bb9\u91cf\uff1b</li> <li>\u8d1f\u8f7d\u5747\u8861\u53ef\u4ee5\u5c06\u4e0a\u6e38\u670d\u52a1\u7684\u52a8\u6001\u54cd\u5e94\u8f6c\u6362\u4e3a\u9759\u6001\u7f13\u5b58\uff0c\u4ece\u65f6\u95f4\u7ef4\u5ea6\u4e0a\u770b\uff0c\u4e0a\u6e38\u54cd\u5e94\u662f\u65e0\u9650\u7684\uff0c\u8fd9\u6837\u8d1f\u8f7d\u5747\u8861\u7684\u7f13\u5b58\u5bb9\u91cf\u5c31\u4e00\u5b9a\u4f1a\u4e0d\u8db3\uff1b</li> <li>\u5373\u4f7f\u684c\u9762\u4e3b\u673a\u7684\u78c1\u76d8\u5bb9\u91cf\u8fbe\u5230\u4e86 TB \u7ea7\uff0c\u4f46\u6d4f\u89c8\u5668\u8981\u5bf9\u7528\u6237\u8bbf\u95ee\u7684\u6240\u6709\u7ad9\u70b9\u505a\u7f13\u5b58\uff0c\u5c31\u4e0d\u53ef\u80fd\u7f13\u5b58\u4e00\u4e2a\u7ad9\u70b9\u4e0a\u7684\u5168\u90e8\u8d44\u6e90\uff0c\u5728\u4e00\u5bf9\u591a\u7684\u7a7a\u95f4\u7ef4\u5ea6\u4e0b\uff0c\u7f13\u5b58\u4e00\u6837\u662f\u7a00\u7f3a\u8d44\u6e90\u3002</li> </ul> <p>\u5fc5\u987b\u4fdd\u8bc1\u5728\u6709\u9650\u7684\u7f13\u5b58\u7a7a\u95f4\u5185\uff0c\u53ea\u5b58\u653e\u4f1a\u88ab\u591a\u6b21\u8bbf\u95ee\u7684\u70ed\u70b9\u6570\u636e\uff0c\u901a\u8fc7\u63d0\u9ad8\u547d\u4e2d\u7387\u6765\u63d0\u5347\u7cfb\u7edf\u6027\u80fd\u3002\u8981\u5b8c\u6210\u8fd9\u4e2a\u76ee\u6807\uff0c\u5fc5\u987b\u7cbe\u5fc3\u8bbe\u8ba1\u5411\u7f13\u5b58\u4e2d\u6dfb\u52a0\u54ea\u4e9b\u6570\u636e\uff0c\u7f13\u5b58\u6ea2\u51fa\u65f6\u6dd8\u6c70\u51fa\u54ea\u4e9b\u51b7\u6570\u636e\u3002</p> <p>\u901a\u5e38\uff0c\u7f13\u5b58\u6570\u636e\u7684\u6dfb\u52a0\u6216\u8005\u66f4\u65b0\uff0c\u90fd\u662f\u7531\u7528\u6237\u8bf7\u6c42\u89e6\u53d1\u7684\uff0c\u8fd9\u5f80\u5f80\u53ef\u4ee5\u5e26\u6765\u66f4\u9ad8\u7684\u547d\u4e2d\u7387\u3002\u6bd4\u5982\uff0c\u5f53\u8bfb\u8bf7\u6c42\u5b8c\u6210\u540e\uff0c\u5c06\u8bfb\u51fa\u7684\u5185\u5bb9\u653e\u5165\u7f13\u5b58\uff0c\u57fa\u4e8e\u65f6\u95f4\u5c40\u90e8\u6027\u539f\u7406\uff0c\u5b83\u6709\u5f88\u9ad8\u7684\u6982\u7387\u88ab\u540e\u7eed\u7684\u8bfb\u8bf7\u6c42\u547d\u4e2d</p> <p>\u5bf9\u4e8e\u78c1\u76d8\u64cd\u4f5c\uff0c\u8fd8\u53ef\u4ee5\u57fa\u4e8e\u7a7a\u95f4\u5c40\u90e8\u6027\u539f\u7406\uff0c\u91c7\u7528\u9884\u8bfb\u7b97\u6cd5\u6dfb\u52a0\u7f13\u5b58\u6570\u636e\u3002\u6bd4\u5982\u5f53\u6211\u4eec\u7edf\u8ba1\u51fa\u8fde\u7eed\u4e24\u6b21\u8bfb IO \u7684\u64cd\u4f5c\u8303\u56f4\u4e5f\u662f\u8fde\u7eed\u7684\uff0c\u5c31\u53ef\u4ee5\u5224\u65ad\u8fd9\u662f\u4e00\u4e2a\u987a\u5e8f\u8bfb IO\uff0c\u5982\u679c\u8fd9\u4e2a\u8bfb IO \u83b7\u53d6 32KB \u7684\u6570\u636e\uff0c\u5c31\u53ef\u4ee5\u5728\u8fd9\u6b21\u78c1\u76d8\u4e2d\uff0c\u591a\u8bfb\u51fa 128KB \u7684\u6570\u636e\u653e\u5728\u7f13\u5b58\uff0c\u8fd9\u4f1a\u5e26\u6765 2 \u4e2a\u6536\u76ca\uff1a</p> <ul> <li>\u9996\u5148\uff0c\u901a\u8fc7\u51cf\u5c11\u5b9a\u4f4d\u65f6\u95f4\u63d0\u9ad8\u4e86\u78c1\u76d8\u5de5\u4f5c\u6548\u7387\u3002\u673a\u68b0\u78c1\u76d8\u5bb9\u91cf\u5927\u4ef7\u683c\u4f4e\uff0c\u5b83\u7684\u987a\u5e8f\u8bfb\u5199\u901f\u5ea6\u7531\u78c1\u76d8\u65cb\u8f6c\u901f\u5ea6\u4e0e\u5b58\u50a8\u5bc6\u5ea6\u51b3\u5b9a\uff0c\u901a\u5e38\u53ef\u4ee5\u8fbe\u5230 100MB/s \u5de6\u53f3\u3002\u7136\u800c\uff0c\u7531\u4e8e\u673a\u68b0\u8f6c\u901f\u96be\u4ee5\u63d0\u9ad8\uff08\u670d\u52a1\u5668\u78c1\u76d8\u7684\u8f6c\u901f\u4e5f\u53ea\u6709 10000 \u8f6c /s\uff09\uff0c\u78c1\u5934\u5b9a\u4f4d\u4e0e\u65cb\u8f6c\u5ef6\u8fdf\u5927\u7ea6\u6d88\u8017\u4e86 8 \u6beb\u79d2\uff0c\u56e0\u6b64\u5bf9\u4e8e\u7edd\u5927\u90e8\u5206\u65f6\u95f4\u82b1\u5728\u78c1\u5934\u5b9a\u4f4d\u4e0a\u7684\u968f\u673a\u5c0f IO\uff08\u6bd4\u5982 4KB\uff09\uff0c\u8bfb\u5199\u541e\u5410\u91cf\u53ea\u6709\u51e0 MB\u3002</li> <li>\u5176\u6b21\uff0c\u5f53\u540e\u7eed\u7684\u8bfb\u8bf7\u6c42\u547d\u4e2d\u63d0\u524d\u8bfb\u5165\u7f13\u5b58\u7684\u6570\u636e\u65f6\uff0c\u8bf7\u6c42\u65f6\u5ef6\u4f1a\u5927\u5e45\u5ea6\u964d\u4f4e\uff0c\u8fd9\u63d0\u5347\u4e86\u7528\u6237\u4f53\u9a8c\u3002</li> </ul> <p>\u800c\u4e14\uff0c\u5e76\u4e0d\u662f\u53ea\u6709\u5355\u673a\u8fdb\u7a0b\u624d\u80fd\u4f7f\u7528\u9884\u8bfb\u7b97\u6cd5\u3002</p> <p>\u6bd4\u5982\u516c\u6709\u4e91\u4e2d\u7684\u4e91\u78c1\u76d8\uff0c\u4e4b\u6240\u4ee5\u53ef\u4ee5\u5b9e\u65f6\u5730\u6302\u8f7d\u5230\u4efb\u610f\u865a\u62df\u673a\u4e0a\uff0c\u5c31\u662f\u56e0\u4e3a\u5b83\u5b9e\u9645\u5b58\u653e\u5728\u7c7b\u4f3c HDFS \u8fd9\u6837\u7684\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002\u56e0\u6b64\uff0c\u4e91\u670d\u52a1\u4f1a\u5728\u5bbf\u4e3b\u7269\u7406\u673a\u7684\u5185\u5b58\u4e2d\u7f13\u5b58\u865a\u62df\u673a\u53d1\u51fa\u7684\u8bfb\u5199 IO\uff0c\u7531\u4e8e\u7f51\u7edc\u4f20\u8f93\u7684\u6210\u672c\u66f4\u9ad8\uff0c\u6240\u4ee5\u9884\u8bfb\u6548\u679c\u4e5f\u66f4\u597d\u3002</p>"},{"location":"chap3/7cache_expire/#_2","title":"\u5199\u8bf7\u6c42\u4e5f\u53ef\u4ee5\u66f4\u65b0\u7f13\u5b58\uff0c","text":"<p>\u53c2\u8003 \u820d\u5f03\u4e00\u81f4\u6027\u53bb\u6362\u53d6\u6027\u80fd\u7684CAP\u7406\u8bba\u4ecb\u7ecd\u8fc7 write through \u548c write back \u65b9\u5f0f\u3002</p> <ul> <li>write back \u91c7\u7528\u5f02\u6b65\u8c03\u7528\u56de\u5199\u6570\u636e\uff0c\u80fd\u901a\u8fc7\u6279\u91cf\u5904\u7406\u63d0\u5347\u6027\u80fd\u3002\u6bd4\u5982 Linux \u5728\u5408\u5e76 IO \u7684\u540c\u65f6\uff0c\u4e5f\u4f1a\u50cf\u7535\u68af\u8fd0\u884c\u4e00\u6837\uff0c\u6bcf\u6b21\u4f7f\u78c1\u5934\u4ec5\u5411\u4e00\u4e2a\u65b9\u5411\u65cb\u8f6c\u5199\u5165\u6570\u636e\uff0c\u63d0\u5347\u673a\u68b0\u78c1\u76d8\u7684\u5de5\u4f5c\u6548\u7387\uff0c\u56e0\u6b64\u5f97\u540d\u4e3a\u7535\u68af\u8c03\u5ea6\u7b97\u6cd5\u3002</li> </ul>"},{"location":"chap3/7cache_expire/#2_1","title":"2 \u79cd\u6700\u5e38\u89c1\u7684\u7f13\u5b58\u6dd8\u6c70\u7b97\u6cd5","text":"<p>\u5148\u6765\u770bFIFO(First In, First Out) \u5148\u5165\u5148\u51fa\u6dd8\u6c70\u7b97\u6cd5</p> <ul> <li>\u4f8b\u5982 HTTP/2 \u52a8\u6001\u8868\uff0c\u4f1a\u5c06 HTTP/2 \u8fde\u63a5\u4e0a\u9996\u6b21\u51fa\u73b0\u7684 HTTP \u5934\u90e8\uff0c\u7f13\u5b58\u5728\u5ba2\u6237\u7aef\u3001\u670d\u52a1\u5668\u7684\u5185\u5b58\u4e2d\u3002\u7531\u4e8e\u5b83\u4eec\u57fa\u4e8e\u76f8\u540c\u7684\u89c4\u5219\u751f\u6210\uff0c\u6240\u4ee5\u62e5\u6709\u76f8\u540c\u7684\u52a8\u6001\u8868\u5e8f\u53f7\u3002</li> <li>\u8fd9\u6837\uff0c\u4f20\u8f93 1-2 \u4e2a\u5b57\u8282\u7684\u8868\u5e8f\u53f7\uff0c\u8981\u6bd4\u4f20\u8f93\u51e0\u5341\u4e2a\u5b57\u8282\u7684\u5934\u90e8\u5212\u7b97\u5f97\u591a\u3002\u5f53\u5185\u5b58\u5bb9\u91cf\u8d85\u8fc7 <code>SETTINGS_HEADER_TABLE_SIZE</code> \u9608\u503c\u65f6\uff0c\u4f1a\u57fa\u4e8e FIFO \u7b97\u6cd5\u5c06\u6700\u65e9\u7f13\u5b58\u7684 HTTP \u5934\u90e8\u6dd8\u6c70\u51fa\u52a8\u6001\u8868\u3002</li> </ul> <p></p> <p>\u518d\u6bd4\u5982\u7684 TLS \u63e1\u624b\u5f88\u8017\u65f6</p> <p>\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06\u5bc6\u94a5\u7f13\u5b58\u5728\u5ba2\u6237\u7aef\u3001\u670d\u52a1\u5668\u4e2d\uff0c\u7b49\u518d\u6b21\u5efa\u7acb\u8fde\u63a5\u65f6\uff0c\u901a\u8fc7 session ID \u8fc5\u901f\u6062\u590d TLS \u4f1a\u8bdd\u3002</p> <p>\u7531\u4e8e\u5185\u5b58\u6709\u9650\uff0c\u670d\u52a1\u5668\u5fc5\u987b\u53ca\u65f6\u6dd8\u6c70\u8fc7\u671f\u7684\u5bc6\u94a5\uff0c\u5176\u4e2d\uff0cNginx \u4e5f\u662f\u91c7\u7528 FIFO \u961f\u5217\u6dd8\u6c70 TLS \u7f13\u5b58\u7684\u3002</p> <p>LRU(Less Recently Used) \u4e5f\u662f\u6700\u5e38\u7528\u7684\u6dd8\u6c70\u7b97\u6cd5\uff0c</p> <p>\u6bd4\u5982 Redis \u670d\u52a1\u5c31\u901a\u8fc7\u5b83\u6765\u6dd8\u6c70\u6570\u636e\uff0cOpenResty \u5728\u8fdb\u7a0b\u95f4\u5171\u4eab\u6570\u636e\u7684 <code>shared_dict</code> \u5728\u8fbe\u5230\u5171\u4eab\u5185\u5b58\u6700\u5927\u503c\u540e\uff0c\u4e5f\u4f1a\u901a\u8fc7 LRU \u7b97\u6cd5\u6dd8\u6c70\u6570\u636e\u3002</p> <p>LRU \u901a\u5e38\u4f7f\u7528\u53cc\u5411\u961f\u5217\u5b9e\u73b0\uff08\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a<code>O(1)</code>\uff09\uff0c\u961f\u9996\u662f\u6700\u8fd1\u8bbf\u95ee\u7684\u5143\u7d20\uff0c\u961f\u5c3e\u5c31\u662f\u6700\u5c11\u8bbf\u95ee\u3001\u5373\u5c06\u6dd8\u6c70\u7684\u5143\u7d20\u3002\u5f53\u8bbf\u95ee\u4e86\u961f\u5217\u4e2d\u67d0\u4e2a\u5143\u7d20\u65f6\uff0c\u53ef\u4ee5\u5c06\u5176\u79fb\u52a8\u5230\u961f\u9996\u3002</p> <p>\u5f53\u7f13\u5b58\u6ea2\u51fa\u9700\u8981\u6dd8\u6c70\u5143\u7d20\u65f6\uff0c\u76f4\u63a5\u5220\u9664\u961f\u5c3e\u5143\u7d20\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p> <p>\u4ee5\u4e0a\u6211\u53ea\u8c08\u4e86\u7f13\u5b58\u5bb9\u91cf\u5230\u8fbe\u4e0a\u9650\u540e\u7684\u6dd8\u6c70\u7b56\u7565\uff0c\u4e3a\u4e86\u907f\u514d\u7f13\u5b58\u4e0e\u6e90\u6570\u636e\u4e0d\u4e00\u81f4\uff0c\u5728\u4f20\u8f93\u6210\u672c\u9ad8\u6602\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u901a\u5e38\u4f1a\u57fa\u4e8e\u8fc7\u671f\u65f6\u95f4\u6765\u6dd8\u6c70\u7f13\u5b58\u3002</p> <p>\u6bd4\u5982 HTTP \u54cd\u5e94\u4e2d\u7684 Cache-Control\u3001Expires \u6216\u8005 Last-Modified \u5934\u90e8\uff0c\u90fd\u4f1a\u7528\u6765\u8bbe\u7f6e\u5b9a\u65f6\u5668\uff0c\u54cd\u5e94\u8fc7\u671f\u540e\u4f1a\u88ab\u6dd8\u6c70\u51fa\u7f13\u5b58\u3002</p> <p>\u7136\u800c\uff0c\u4e00\u65e6\u70ed\u70b9\u6570\u636e\u88ab\u6dd8\u6c70\u51fa\u7f13\u5b58\uff0c\u90a3\u4e48\u6765\u81ea\u7528\u6237\u7684\u6d41\u91cf\u5c31\u4f1a\u7a7f\u900f\u7f13\u5b58\u5230\u8fbe\u5e94\u7528\u670d\u52a1\u3002\u7531\u4e8e\u7f13\u5b58\u670d\u52a1\u6027\u80fd\u8fdc\u5927\u4e8e\u5e94\u7528\u670d\u52a1\uff0c\u8fc7\u5927\u7684\u6d41\u91cf\u5f88\u53ef\u80fd\u4f1a\u5c06\u5e94\u7528\u538b\u57ae\u3002</p> <p>\u56e0\u6b64\uff0c\u8fc7\u671f\u7f13\u5b58\u5e76\u4e0d\u80fd\u7b80\u5355\u5730\u6dd8\u6c70\uff0c\u4e0b\u9762\u6211\u4eec\u4ee5 Nginx \u4e3a\u4f8b\uff0c\u770b\u770b\u5982\u4f55\u5229\u7528\u8fc7\u671f\u7f13\u5b58\u63d0\u5347\u7cfb\u7edf\u7684\u53ef\u7528\u6027\u3002</p>"},{"location":"chap3/7cache_expire/#3nginx","title":"3\u3001Nginx \u662f\u5982\u4f55\u9632\u6b62\u6d41\u91cf\u6253\u7a7f\u7f13\u5b58\u7684\uff1f","text":"<p>\u5f53\u70ed\u70b9\u7f13\u5b58\u6dd8\u6c70\u540e\uff0c\u5927\u91cf\u7684\u5e76\u53d1\u8bf7\u6c42\u4f1a\u540c\u65f6\u56de\u6e90\u4e0a\u6e38\u5e94\u7528\uff0c\u5176\u5b9e\u8fd9\u662f\u4e0d\u5fc5\u8981\u7684\u3002</p> <p>\u6bd4\u5982\u4e0b\u56fe\u4e2d Nginx \u7684\u5408\u5e76\u56de\u6e90\u529f\u80fd\u5f00\u542f\u540e\uff0cNginx \u4f1a\u5c06\u591a\u4e2a\u5e76\u53d1\u8bf7\u6c42\u5408\u5e76\u4e3a 1 \u6761\u56de\u6e90\u8bf7\u6c42\uff0c\u5e76\u9501\u4f4f\u6240\u6709\u7684\u5ba2\u6237\u7aef\u8bf7\u6c42\uff0c\u76f4\u5230\u56de\u6e90\u8bf7\u6c42\u8fd4\u56de\u540e\uff0c\u624d\u4f1a\u66f4\u65b0\u7f13\u5b58\uff0c\u540c\u65f6\u5411\u6240\u6709\u5ba2\u6237\u7aef\u8fd4\u56de\u54cd\u5e94\u3002</p> <p>\u7531\u4e8e Nginx \u53ef\u4ee5\u652f\u6301 C10M \u7ea7\u522b\u7684\u5e76\u53d1\u8fde\u63a5\uff0c\u56e0\u6b64\u53ef\u4ee5\u5f88\u8f7b\u677e\u5730\u9501\u4f4f\u8fd9\u4e9b\u5e76\u53d1\u8bf7\u6c42\uff0c\u964d\u4f4e\u5e94\u7528\u670d\u52a1\u7684\u8d1f\u8f7d\u3002</p> <p></p> <p>\u542f\u7528\u5408\u5e76\u56de\u6e90\u529f\u80fd\u5f88\u7b80\u5355\uff0c\u53ea\u9700\u8981\u5728 <code>nginx.conf</code> \u4e2d\u6dfb\u52a0\u4e0b\u9762\u8fd9\u6761\u6307\u4ee4\u5373\u53ef\uff1a</p> <pre><code>proxy_cache_lock on;\n</code></pre> <p>\u5f53 1 \u4e2a\u8bf7\u6c42\u56de\u6e90\u66f4\u65b0\u65f6\uff0c\u5176\u4f59\u8bf7\u6c42\u5c06\u4f1a\u9ed8\u8ba4\u7b49\u5f85\uff0c\u5982\u679c 5 \u79d2\uff08\u53ef\u7531 <code>proxy_cache_lock_timeout</code>\u4fee\u6539\uff09\u540e\u7f13\u5b58\u4f9d\u65e7\u672a\u5b8c\u6210\u66f4\u65b0\uff0c\u8fd9\u4e9b\u8bf7\u6c42\u4e5f\u4f1a\u56de\u6e90\uff0c\u4f46\u5b83\u4eec\u7684\u54cd\u5e94\u4e0d\u4f1a\u7528\u4e8e\u66f4\u65b0\u7f13\u5b58\u3002</p> <p>\u540c\u65f6\uff0c\u7b2c 1 \u4e2a\u56de\u6e90\u8bf7\u6c42\u4e5f\u6709\u65f6\u95f4\u9650\u5236\uff0c\u5982\u679c\u5230\u8fbe 5 \u79d2\uff08\u53ef\u7531 proxy_cache_lock_age \u4fee\u6539\uff09\u540e\u672a\u83b7\u5f97\u54cd\u5e94\uff0c\u5c31\u4f1a\u653e\u884c\u5176\u4ed6\u5e76\u53d1\u8bf7\u6c42\u56de\u6e90\u66f4\u65b0\u7f13\u5b58\u3002</p> <p>\u5f00\u542f\u8fc7\u671f\u7f13\u5b58\u529f\u80fd\u4e5f\u5f88\u7b80\u5355\uff0c\u6dfb\u52a0\u4e0b\u9762 2 \u884c\u6307\u4ee4\u5373\u53ef\uff1a</p> <p></p> <pre><code>proxy_cache_use_stale updating;\nproxy_cache_background_update on;\n</code></pre>"},{"location":"chap3/7cache_expire/#4","title":"4\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u5f53\u7ec4\u4ef6\u95f4\u7684\u8bbf\u95ee\u901f\u5ea6\u5dee\u8ddd\u5f88\u5927\u65f6\uff0c\u76f4\u63a5\u8bbf\u95ee\u4f1a\u964d\u4f4e\u6574\u4f53\u6027\u80fd\uff0c\u5728\u4e8c\u8005\u4e4b\u95f4\u6dfb\u52a0\u66f4\u5feb\u7684\u7f13\u5b58\u662f\u5e38\u7528\u7684\u89e3\u51b3\u65b9\u6848\u3002\u6839\u636e\u65f6\u95f4\u5c40\u90e8\u6027\u539f\u7406\uff0c\u5c06\u8bf7\u6c42\u7ed3\u679c\u653e\u5165\u7f13\u5b58\uff0c\u4f1a\u6709\u5f88\u5927\u6982\u7387\u88ab\u518d\u6b21\u547d\u4e2d\uff0c\u800c\u6839\u636e\u7a7a\u95f4\u5c40\u90e8\u6027\u539f\u7406\uff0c\u53ef\u4ee5\u5c06\u76f8\u90bb\u7684\u5185\u5bb9\u9884\u53d6\u81f3\u7f13\u5b58\u4e2d\uff0c\u8fd9\u6837\u65e2\u80fd\u901a\u8fc7\u6279\u5904\u7406\u63d0\u5347\u6548\u7387\uff0c\u4e5f\u80fd\u964d\u4f4e\u540e\u7eed\u8bf7\u6c42\u7684\u65f6\u5ef6\u3002</p> <p>\u7531\u4e8e\u7f13\u5b58\u5bb9\u91cf\u5c0f\u4e8e\u539f\u59cb\u6570\u636e\u96c6\uff0c\u56e0\u6b64\u9700\u8981\u5c06\u547d\u4e2d\u6982\u7387\u8f83\u4f4e\u7684\u6570\u636e\u53ca\u65f6\u6dd8\u6c70\u51fa\u53bb\u3002\u5176\u4e2d\u6700\u5e38\u7528\u7684\u6dd8\u6c70\u7b97\u6cd5\u662f FIFO \u4e0e LRU\uff0c\u5b83\u4eec\u6267\u884c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662f O(1)\uff0c\u6548\u7387\u5f88\u9ad8\u3002</p> <p>\u7531\u4e8e\u7f13\u5b58\u670d\u52a1\u7684\u6027\u80fd\u8fdc\u5927\u4e8e\u4e0a\u6e38\u5e94\u7528\uff0c\u4e00\u65e6\u5927\u6d41\u91cf\u7a7f\u900f\u5931\u6548\u7684\u7f13\u5b58\u5230\u8fbe\u4e0a\u6e38\u540e\uff0c\u5c31\u53ef\u80fd\u538b\u57ae\u5e94\u7528\u3002Nginx \u4f5c\u4e3a HTTP \u7f13\u5b58\u4f7f\u7528\u65f6\uff0c\u53ef\u4ee5\u6253\u5f00\u5408\u5e76\u56de\u6e90\u529f\u80fd\uff0c\u51cf\u8f7b\u4e0a\u6e38\u538b\u529b\u3002\u5728\u4e0a\u6e38\u5e94\u7528\u5b95\u673a\u540e\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u8fc7\u671f\u7f13\u5b58\u4e3a\u7528\u6237\u63d0\u4f9b\u964d\u7ea7\u670d\u52a1\u3002</p>"},{"location":"chap3/8message_queue/","title":"\u7b2c\u516b\u8282 \u6d88\u606f\u961f\u5217\u57fa\u4e8e\u5f02\u6b65\u6d88\u606f\u63d0\u5347\u6027\u80fd","text":"<p>\u5f02\u6b65\u901a\u8baf\u662f\u6700\u5e38\u7528\u7684\u6027\u80fd\u63d0\u5347\u65b9\u5f0f\uff0c\u6bd4\u5982 gRPC \u63d0\u4f9b\u7684\u5f02\u6b65 API\uff0c\u6216\u8005\u57fa\u4e8e write-back \u6a21\u5f0f\u5411\u7f13\u5b58\u5199\u5165\u6570\u636e\u65f6\uff0c\u7cfb\u7edf\u6027\u80fd\u90fd\u53ef\u4ee5\u63d0\u9ad8\u3002\u7136\u800c\uff0c\u5bf9\u4e8e\u590d\u6742\u7684\u5927\u89c4\u6a21\u5206\u5e03\u5f0f\u7cfb\u7edf\uff0c\u8fd9\u4e9b\u5206\u6563\u3001\u5b64\u7acb\u7684\u5f02\u6b65\u5b9e\u73b0\u673a\u5236\uff0c\u65e0\u6cd5\u89e3\u51b3\u4ee5\u4e0b\u95ee\u9898\uff1a</p> <ul> <li>\u7ec4\u4ef6\u95f4\u8026\u5408\u5728\u4e00\u8d77\uff0c\u4e0d\u53ea\u8fed\u4ee3\u53d8\u66f4\u65f6\u66f4\u4e3a\u56f0\u96be\uff0c\u800c\u4e14\u5f53\u5b83\u4eec\u4e4b\u95f4\u7684\u6027\u80fd\u6709\u5dee\u5f02\u65f6\uff0c\u541e\u5410\u91cf\u8f83\u4f4e\u7684\u7ec4\u4ef6\u5c31\u4f1a\u6210\u4e3a\u7cfb\u7edf\u74f6\u9888\uff1b</li> <li>\u5f53\u4e1a\u52a1\u5728\u65f6\u95f4\u4e0a\u5177\u6709\u660e\u663e\u7684\u5cf0\u8c37\u8bbf\u95ee\u5dee\u5f02\u65f6\uff0c\u5b9e\u73b0\u524a\u5cf0\u586b\u8c37\u9700\u8981\u4e00\u5b9a\u7684\u5f00\u53d1\u6210\u672c\uff1b</li> <li>\u5b9e\u73b0 BASE \u7406\u8bba\u4e2d\u7684 Basically Available \u5e76\u4e0d\u5bb9\u6613\uff1b</li> <li>\u6bcf\u4e2a\u7ec4\u4ef6\u90fd\u8981\u81ea\u884c\u7ef4\u62a4\u8d1f\u8f7d\u5747\u8861\u7ec4\u4ef6\uff0c\u4ee5\u6b64\u63d0\u4f9b\u53ef\u4f38\u7f29\u6027\uff1b</li> <li>\u6bcf\u4e2a\u7ec4\u4ef6\u7684\u8bf7\u6c42\u683c\u5f0f\u3001\u65e5\u5fd7\u90fd\u4e0d\u5c3d\u76f8\u540c\uff0c\u56e0\u6b64\u7cfb\u7edf\u603b\u4f53\u7684\u76d1\u63a7\u6210\u672c\u76f8\u5bf9\u8f83\u9ad8\uff1b</li> <li>\u6279\u91cf\u5904\u7406\u8bf7\u6c42\u3001\u5f02\u6b65\u5316\u90fd\u53ef\u4ee5\u63d0\u5347\u6027\u80fd\uff0c\u4f46\u6bcf\u4e2a\u7ec4\u4ef6\u72ec\u7acb\u5b9e\u73b0\u8fd9\u4e9b\u57fa\u7840\u529f\u80fd\u4ed8\u51fa\u7684\u6210\u672c\u5e76\u975e\u5b8c\u5168\u5fc5\u8981\u3002</li> </ul>"},{"location":"chap3/8message_queue/#1","title":"1\u3001\u6d88\u606f\u961f\u5217\u89e3\u51b3\u4e86\u54ea\u4e9b\u95ee\u9898\uff1f","text":"<p>\u5f53\u8fdb\u7a0b\u4e2d\u9700\u8981\u4ea4\u4e92\u7684\u4e24\u4e2a\u6a21\u5757\u6027\u80fd\u5dee\u8ddd\u5f88\u5927\u65f6\uff0c\u6211\u4eec\u4f1a\u57fa\u4e8e FIFO \u5148\u5165\u5148\u51fa\u961f\u5217\u5b9e\u73b0\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u578b\uff0c\u901a\u8fc7\u8c03\u6574\u751f\u4ea7\u8005\u3001\u6d88\u8d39\u8005\u7684\u6570\u91cf\uff0c\u5b9e\u73b0\u7ebf\u7a0b\u95f4\u7684\u8d1f\u8f7d\u5747\u8861\u3002\u800c\u4e14\uff0c\u751f\u4ea7\u8005\u4ec5\u5c06\u4efb\u52a1\u6dfb\u52a0\u81f3\u961f\u5217\u9996\u90e8\u5c31\u53ef\u4ee5\u8fd4\u56de\uff0c\u8fd9\u79cd\u5f02\u6b65\u64cd\u4f5c\u91ca\u653e\u4e86\u5b83\u7684\u6027\u80fd</p> <p>\u628a\u5355\u673a\u4e2d\u7684 FIFO \u961f\u5217\u653e\u5927\u5230\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u5c31\u5f62\u6210\u4e86\u72ec\u7acb\u7684\u6d88\u606f\u961f\u5217\u670d\u52a1\u3002</p> <p>\u6b64\u65f6\uff0c\u751f\u4ea7\u8005\u3001\u6d88\u8d39\u8005\u7684\u89d2\u8272\u4ece\u7ebf\u7a0b\u53d8\u6210\u4e86\u7f51\u7edc\u4e2d\u7684\u72ec\u7acb\u670d\u52a1\uff0c\u751f\u4ea7\u8005\u53ef\u4ee5\u5411\u6d88\u606f\u961f\u5217\u53d1\u5e03\u591a\u79cd\u6d88\u606f\uff0c\u591a\u4e2a\u6d88\u8d39\u8005\u4e5f\u53ef\u4ee5\u8ba2\u9605\u540c\u4e00\u79cd\u6d88\u606f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u603b\u7ed3\u4e00\u4e0b\u7684\u8bdd\uff0c\u6d88\u606f\u961f\u5217\u5c31\u5177\u5907\u4e86\u4ee5\u4e0b 7 \u4e2a\u4f18\u70b9\uff1a</p> <ol> <li>\u964d\u4f4e\u4e86\u7cfb\u7edf\u7684\u8026\u5408\u6027\u3002\u6bd4\u5982\u4e0a\u56fe\u4e2d\uff0c\u7ec4\u4ef6 2 \u53d1\u5e03\u4e86\u4e00\u6761\u7528\u6237\u6ce8\u518c\u6210\u529f\u6d88\u606f\uff0c\u539f\u672c\u53ea\u6709\u8d1f\u8d23\u901a\u77e5\u7528\u6237\u6ce8\u518c\u7ed3\u679c\u7684\u7ec4\u4ef6 3 \u5728\u5904\u7406\uff0c\u5982\u679c\u7ec4\u4ef6 4 \u9700\u8981\u7acb\u523b\u5f00\u542f\u65b0\u7528\u6237\u7684\u8425\u9500\u5de5\u4f5c\uff0c\u53ea\u9700\u8981\u540c\u65f6\u5411\u6d88\u606f\u961f\u5217\u8ba2\u9605\u5373\u53ef\uff1b\u518d\u6bd4\u5982\uff0c\u7ec4\u4ef6 2\u3001\u7ec4\u4ef6 3\u3001\u7ec4\u4ef6 4 \u901a\u8baf\u65f6\u5e76\u4e0d\u9700\u8981\u7edf\u4e00\u5e94\u7528\u5c42\u534f\u8bae\u6216\u8005 RPC \u63a5\u53e3\uff0c\u6240\u6709\u53c2\u4e0e\u65b9\u53ea\u9700\u8981\u4e0e\u6d88\u606f\u961f\u5217\u670d\u52a1\u7684 SDK \u6253\u4ea4\u9053\u3002</li> <li>\u53ef\u4f38\u7f29\u6027\u5f88\u5bb9\u6613\u5b9e\u73b0\u3002\u6bd4\u5982\uff0c\u5f53\u7ec4\u4ef6 3 \u7684\u6027\u80fd\u4e0d\u8db3\u65f6\uff0c\u6dfb\u52a0\u8ba2\u9605\u6d88\u606f\u7684\u65b0\u5b9e\u4f8b\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u6c34\u5e73\u6269\u5c55\u63d0\u5347\u6d88\u8d39\u80fd\u529b\u3002\u53cd\u4e4b\uff0c\u4e5f\u53ef\u4ee5\u6269\u5c55\u7ec4\u4ef6 1\uff0c\u63d0\u5347\u6d88\u606f\u7684\u751f\u4ea7\u80fd\u529b\u3002</li> <li>\u5929\u7136\u5b9e\u73b0\u201c\u524a\u5cf0\u586b\u8c37\u201d\u529f\u80fd\u3002\u6d88\u606f\u961f\u5217\u670d\u52a1\u4f1a\u5c06\u6d88\u606f\u6301\u4e45\u5316\u5b58\u50a8\u5728\u78c1\u76d8\u4e2d\uff0c\u5728\u9ad8\u5cf0\u671f\u6765\u4e0d\u53ca\u5904\u7406\u7684\u6d88\u606f\uff0c\u4f1a\u5728\u4f4e\u8c37\u671f\u88ab\u6d88\u8d39\u8005\u670d\u52a1\u5904\u7406\u5b8c\u3002\u901a\u5e38\uff0c\u6d88\u606f\u961f\u5217\u4f1a\u4f7f\u7528\u5ec9\u4ef7\u3001\u9ad8\u5bb9\u91cf\u7684\u673a\u68b0\u78c1\u76d8\u5b58\u653e\u6d88\u606f\uff0c\u53ef\u4ee5\u8f7b\u677e\u7f13\u5b58\u4f4f\u9ad8\u5cf0\u671f\u8d85\u8f7d\u7684\u5168\u90e8\u8bf7\u6c42\u3002</li> <li>\u63d0\u9ad8\u4e86\u7cfb\u7edf\u53ef\u7528\u6027\u3002<ul> <li>\u9996\u5148\uff0c\u6301\u4e45\u5316\u5230\u78c1\u76d8\u4e2d\u7684\u6d88\u606f\uff0c\u5728\u5b95\u673a\u6545\u969c\u65f6\u6bd4\u5185\u5b58\u4e2d\u7684\u8bf7\u6c42\u6709\u66f4\u9ad8\u7684\u53ef\u7528\u6027\uff1b</li> <li>\u5176\u6b21\uff0c\u6d88\u606f\u961f\u5217\u53ef\u4ee5\u9694\u79bb\u6545\u969c\uff0c\u6bd4\u5982\uff0c\u6d88\u8d39\u8005\u670d\u52a1\u5b95\u673a\u540e\uff0c\u751f\u4ea7\u8005\u670d\u52a1\u77ed\u671f\u5185\u4e0d\u4f1a\u53d7\u5230\u5f71\u54cd\uff1b</li> <li>\u518d\u6b21\uff0c\u5f53\u603b\u541e\u5410\u91cf\u8d85\u8fc7\u6027\u80fd\u4e0a\u9650\u65f6\uff0c\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u4e0d\u540c\u7684\u6d88\u606f\u4f18\u5148\u7ea7\uff0c\u901a\u8fc7\u670d\u52a1\u964d\u7ea7\u4fdd\u969c\u7cfb\u7edf\u7684\u57fa\u672c\u53ef\u7528\u6027\u3002</li> </ul> </li> <li>\u6d88\u606f\u961f\u5217\u7684\u751f\u4ea7\u8005\u5929\u7136\u5177\u5907\u5f02\u6b65\u529f\u80fd\uff0c\u8fd9\u964d\u4f4e\u4e86\u751f\u4ea7\u8005\u7684\u8bf7\u6c42\u5904\u7406\u65f6\u5ef6\uff0c\u63d0\u5347\u4e86\u7528\u6237\u4f53\u9a8c\u3002</li> <li>\u57fa\u4e8e AKF Y \u8f74\u62c6\u5206\u529f\u80fd\u53ef\u4ee5\u964d\u4f4e\u6570\u636e\u89c4\u6a21\uff0c\u800c\u4e14\u7ec4\u4ef6\u95f4\u5206\u5de5\u66f4\u7ec6\u4e5f\u4f1a\u5e26\u6765\u66f4\u6df1\u5165\u7684\u6027\u80fd\u4f18\u5316\u3002\u5f53\u6d88\u606f\u961f\u5217\u4f5c\u4e3a\u901a\u8baf\u65b9\u5f0f\u65f6\uff0c\u8fd9\u79cd\u201c\u4e8b\u4ef6\u9a71\u52a8\u201d\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u5f88\u5bb9\u6613\u901a\u8fc7\u6d88\u606f\u5b9e\u73b0\u670d\u52a1\u62c6\u5206\uff0c\u6210\u672c\u4f1a\u4f4e\u5f88\u591a\u3002</li> <li>\u6d88\u606f\u961f\u5217\u670d\u52a1\u5bf9\u4e8e\u5404\u79cd\u6d88\u606f\u7684\u53d1\u5e03\u3001\u6d88\u8d39\u60c5\u51b5\u90fd\u6709\u7edf\u8ba1\uff0c\u56e0\u6b64\uff0c\u4ece\u6d88\u606f\u4e2d\u5c31\u80fd\u83b7\u5f97\u4e1a\u52a1\u7684\u5b9e\u65f6\u8fd0\u884c\u72b6\u6001\uff0c\u4ee5\u6781\u4f4e\u7684\u6210\u672c\u5b9e\u73b0\u7cfb\u7edf\u7684\u76d1\u63a7\u3002</li> </ol> <p>\u6b63\u662f\u56e0\u4e3a\u8fd9\u4e48\u591a\u7684\u4f18\u70b9\uff0c\u6240\u4ee5\u6d88\u606f\u961f\u5217\u6210\u4e3a\u4e86\u591a\u6570\u5206\u5e03\u5f0f\u7cfb\u7edf\u5fc5\u5907\u7684\u57fa\u7840\u8bbe\u65bd\u3002</p> <p>\u800c\u4e14\uff0c\u6d88\u606f\u961f\u5217\u81ea\u8eab\u4e5f\u62e5\u6709\u5f88\u9ad8\u7684\u6027\u80fd\uff0c\u6bd4\u5982 RabbitMQ \u5355\u673a\u6bcf\u79d2\u53ef\u4ee5\u5904\u7406 10 \u4e07\u6761\u6d88\u606f\uff0c\u800c Kafka \u5355\u673a\u6bcf\u79d2\u751a\u81f3\u53ef\u4ee5\u5904\u7406\u767e\u4e07\u6761\u6d88\u606f\u3002</p> <p>\u9664\u4e86\u6d88\u606f\u961f\u5217\u5904\u7406\u903b\u8f91\u7b80\u5355\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u91cd\u8981\u539f\u56e0\uff0c\u5c31\u662f\u6d88\u606f\u7684\u4ea7\u751f\u3001\u6d88\u8d39\u5728\u65f6\u95f4\u4e0a\u662f\u8fde\u7eed\u7684\uff0c\u8fd9\u8ba9\u6d88\u606f\u961f\u5217\u5728\u4ee5\u4e0b\u4f18\u5316\u70b9\u4e0a\u80fd\u83b7\u5f97\u5f88\u9ad8\u7684\u6536\u76ca\uff1a</p> <ul> <li>\u9996\u5148\uff0c\u5728\u7f51\u7edc\u901a\u8baf\u4e2d\uff0c\u5f88\u5bb9\u6613\u901a\u8fc7\u6279\u91cf\u5904\u7406\u63d0\u9ad8\u7f51\u7edc\u6548\u7387\u3002\u6bd4\u5982\u751f\u4ea7\u8005\u5feb\u901f\u53d1\u5e03\u6d88\u606f\u65f6\uff0cKafka \u7684\u5ba2\u6237\u7aef SDK \u4f1a\u81ea\u52a8\u805a\u96c6\u5b8c\u4e00\u6279\u6d88\u606f\uff0c\u518d\u4e00\u6b21\u6027\u53d1\u9001\u7ed9 Broker\uff0c\u8fd9\u6837\u7f51\u7edc\u62a5\u6587\u7684\u6709\u6548\u8f7d\u8377\u6bd4\u4f1a\u5f88\u9ad8\u3002</li> <li>\u5176\u6b21\uff0c\u5728\u6570\u636e\u5199\u5165\u78c1\u76d8\u7684\u8fc7\u7a0b\u4e2d\uff0c\u7531\u4e8e\u65f6\u5e8f\u6027\u7279\u5f81\uff0c\u5b58\u653e\u6d88\u606f\u7684\u6587\u4ef6\u4ec5\u4ee5\u8ffd\u52a0\u5f62\u5f0f\u53d8\u66f4\uff0c\u8fd9\u6837\u591a\u6570\u60c5\u51b5\u4e0b\u673a\u68b0\u786c\u76d8\u7684\u78c1\u5934\u4ec5\u671d\u4e00\u4e2a\u65b9\u5411\u8f6c\u52a8\uff0c\u8fd9\u8ba9\u78c1\u76d8\u5199\u5165\u901f\u5ea6\u53ef\u4ee5\u8f7b\u677e\u8fbe\u5230 100MB/s\u3002</li> <li>\u6700\u540e\uff0c\u7531\u4e8e\u6d88\u8d39\u8005\u4e5f\u662f\u6309\u7167 FIFO \u89c4\u5219\u6709\u5e8f\u63a5\u6536\u6d88\u606f\u7684\uff0c\u8fd9\u6837\u6d88\u606f\u961f\u5217\u7684\u7f13\u5b58\u5c31\u53ef\u4ee5\u901a\u8fc7\u6279\u91cf\u9884\u8bfb\u7b49\u4f18\u5316\u65b9\u5f0f\uff0c\u5927\u5e45\u63d0\u9ad8\u8bfb\u64cd\u4f5c\u7684\u7f13\u5b58\u547d\u4e2d\u7387\u3002</li> </ul>"},{"location":"chap3/8message_queue/#2","title":"2\u3001\u6d88\u606f\u961f\u5217\u7684\u670d\u52a1\u8d28\u91cf\u662f\u5982\u4f55\u4fdd\u8bc1\u7684\uff1f","text":"<p>\u4e3a\u4e86\u63d0\u5347\u6574\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u6027\u80fd\uff0c\u6211\u4eec\u5728\u5904\u7406\u6d88\u606f\u65f6\uff0c\u8fd8\u9700\u8981\u5728\u751f\u4ea7\u7aef\u3001\u6d88\u8d39\u7aef\u4ee5\u53ca\u6d88\u606f\u961f\u5217\u7684\u76d1\u63a7\u4e0a\uff0c\u505a\u5230\u4ee5\u4e0b 3 \u4ef6\u4e8b\uff1a</p> <ul> <li>\u9996\u5148\uff0c\u867d\u7136\u751f\u4ea7\u8005\u4f1a\u5f02\u6b65\u5730\u53d1\u5e03\u6d88\u606f\uff0c\u4f46\u6bd5\u7adf\u9700\u8981\u63a5\u6536\u5230\u6d88\u606f\u961f\u5217\u7684\u786e\u8ba4\uff0c\u624d\u6784\u6210\u5b8c\u6574\u7684\u53d1\u5e03\u6d41\u7a0b\u3002\u7f51\u7edc\u4f20\u8f93\u662f\u76f8\u5bf9\u6f2b\u957f\u3001\u4e0d\u53ef\u63a7\u7684\uff0c\u6240\u4ee5\u5728\u9ad8\u6027\u80fd\u573a\u666f\u4e2d\uff0c\u751f\u4ea7\u8005\u5e94\u57fa\u4e8e\u591a\u7ebf\u7a0b\u6216\u8005\u975e\u963b\u585e Socket \u53d1\u5e03\u6d88\u606f\uff0c\u4ee5\u63d0\u9ad8\u5e76\u53d1\u80fd\u529b\u3002</li> <li>\u5176\u6b21\uff0c\u5f53\u6d88\u8d39\u7aef\u6027\u80fd\u4e0d\u8db3\u9700\u8981\u6269\u5bb9\u65f6\uff0c\u5fc5\u987b\u540c\u6b65\u589e\u52a0\u6d88\u606f\u961f\u5217\u670d\u52a1\u4e2d\u7684\u961f\u5217\uff08\u5728 Kafka \u4e2d\u53eb\u505a\u5206\u533a\uff09\uff0c\u624d\u80fd\u5141\u8bb8\u65b0\u589e\u7684\u6d88\u8d39\u8282\u70b9\u5e76\u884c\u63a5\u6536\u6d88\u606f\uff0c\u63d0\u9ad8\u6d88\u606f\u7684\u5904\u7406\u80fd\u529b\u3002\u5426\u5219\uff0c\u5f53\u591a\u4e2a\u6d88\u8d39\u8005\u6d88\u8d39\u540c\u4e00\u6d88\u606f\u961f\u5217\u65f6\uff0c\u6d88\u606f\u7684\u6709\u5e8f\u6027\u4f1a\u5bfc\u81f4\u591a\u4e2a\u6d88\u8d39\u8282\u70b9\u4e32\u884c\u5904\u7406\u6d88\u606f\uff0c\u65e0\u6cd5\u53d1\u6325\u51fa\u5b83\u4eec\u7684\u5168\u90e8\u6027\u80fd\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</li> </ul> <p></p> <ul> <li>\u6700\u540e\uff0c\u5982\u679c\u901a\u8fc7\u76d1\u63a7\u53d1\u73b0\u6d88\u606f\u7684\u6d88\u8d39\u80fd\u529b\u5c0f\u4e8e\u751f\u4ea7\u80fd\u529b\uff0c\u90a3\u5c31\u5fc5\u987b\u53ca\u65f6\u6269\u5bb9\u6d88\u8d39\u7aef\uff0c\u6216\u8005\u964d\u4f4e\u6d88\u606f\u7684\u53d1\u5e03\u901f\u5ea6\uff0c\u5426\u5219\u6d88\u606f\u5c31\u4f1a\u79ef\u538b\uff0c\u6700\u7ec8\u5bfc\u81f4\u7cfb\u7edf\u4e0d\u53ef\u7528\u3002</li> </ul> <p>\u63a5\u4e0b\u6765\uff0c\u518d\u6765\u770b\u6d88\u606f\u961f\u5217\u7684 QoS\uff08Quality of Service\uff09\u662f\u5982\u4f55\u4fdd\u8bc1\u7684\uff0c\u5373\uff1a\u6d88\u606f\u5728\u4f20\u9012\u8fc7\u7a0b\u4e2d\u4f1a\u4e0d\u4f1a\u4e22\u5931\uff0c\u4ee5\u53ca\u63a5\u6536\u65b9\u4f1a\u4e0d\u4f1a\u91cd\u590d\u6d88\u8d39\u6d88\u606f\u3002\u5728MQTT \u534f\u8bae\u4e2d\uff0c\u7ed9\u6d88\u606f\u961f\u5217\u5b9a\u4e49\u4e86\u4e09\u79cd QoS \u7ea7\u522b\uff1a</p> <ul> <li>at most once\uff0c\u6bcf\u6761\u6d88\u606f\u6700\u591a\u53ea\u88ab\u4f20\u9001\u4e00\u6b21\uff0c\u8fd9\u610f\u5473\u7740\u6d88\u606f\u6709\u53ef\u80fd\u4e22\u5931\uff1b</li> <li>at least once\uff0c\u6bcf\u6761\u6d88\u606f\u81f3\u5c11\u4f1a\u4f20\u9001\u4e00\u6b21\uff0c\u8fd9\u610f\u5473\u7740\u6d88\u606f\u53ef\u80fd\u88ab\u91cd\u590d\u6d88\u8d39\uff1b</li> <li>exactly once\uff0c\u6bcf\u6761\u6d88\u606f\u6070\u597d\u53ea\u4f20\u9001\u4e00\u6b21\uff0c\u8fd9\u662f\u6700\u5b8c\u7f8e\u7684\u72b6\u6001\u3002</li> </ul> <p>\u9700\u8981 at most once \u7ea6\u675f\u7684\u573a\u666f\u8f83\u7f55\u89c1\uff0c\u56e0\u6b64\u76ee\u524d\u7edd\u5927\u90e8\u5206\u6d88\u606f\u961f\u5217\u670d\u52a1\u63d0\u4f9b\u7684 QoS \u7ea6\u675f\u90fd\u662f at least once\uff0c\u5b83\u662f\u901a\u8fc7\u4ee5\u4e0b 3 \u70b9\u505a\u5230\u7684\uff1a</p> <ul> <li>\u751f\u4ea7\u7aef\u53d1\u5e03\u6d88\u606f\u65f6\uff0c\u53ea\u6709\u6d88\u606f\u961f\u5217\u786e\u5b9a\u5199\u5165\u78c1\u76d8\u540e\uff0c\u624d\u4f1a\u8fd4\u56de\u6210\u529f\uff1b</li> <li>\u4e3a\u9632\u6b62\u6d88\u606f\u961f\u5217\u670d\u52a1\u51fa\u73b0\u6545\u969c\u540e\u4e22\u6d88\u606f\u4eec\u4e5f\u9700\u8981\u5c06\u6570\u636e\u5b58\u653e\u5728\u591a\u4e2a\u526f\u672c\u8282\u70b9\u4e2d\u3002\u8bb8\u591a\u9ad8\u53ef\u7528\u7b56\u7565\uff0c\u6d88\u606f\u961f\u5217\u90fd\u4f1a\u91c7\u7528\uff0c\u6bd4\u5982 Kafka \u5c31\u662f\u4f7f\u7528\u4ecb\u7ecd\u8fc7\u7684 NWR \u7b97\u6cd5\u6765\u9009\u51fa\u526f\u672c\u4e2d\u7684 Leader \u8282\u70b9\uff0c\u518d\u7ecf\u7531\u5b83\u540c\u6b65\u6570\u636e\u526f\u672c\u3002</li> <li>\u6d88\u8d39\u7aef\u5fc5\u987b\u5728\u6d88\u8d39\u5b8c\u6d88\u606f\uff08\u800c\u4e0d\u662f\u6536\u5230\u6d88\u606f\uff09\u540e\uff0c\u624d\u80fd\u5411\u6d88\u606f\u961f\u5217\u670d\u52a1\u8fd4\u56de\u6210\u529f\u3002</li> </ul> <p>\u8fd9\u6837\uff0c\u6d88\u606f\u961f\u5217\u5c31\u80fd\u4ee5\u5f88\u9ad8\u7684\u53ef\u7528\u6027\u63d0\u4f9b at least once \u7ea7\u522b\u7684 QoS\u3002</p> <p>\u800c exactly once \u662f\u5728 at least once \u7684\u57fa\u7840\u4e0a\uff0c\u901a\u8fc7\u5e42\u7b49\u6027 idempotency \u5b9e\u73b0\u7684\u3002\u5bf9\u4e8e\u4e00\u6761\u201c\u5e42\u7b49\u6027\u6d88\u606f\u201d\uff0c\u65e0\u8bba\u6d88\u8d39 1 \u6b21\u8fd8\u662f\u591a\u6b21\uff0c</p> <p>\u7ed3\u679c\u90fd\u662f\u4e00\u6837\u7684\u3002\u56e0\u6b64\uff0cKafka \u901a\u8fc7\u6d88\u606f\u4e8b\u52a1\u548c\u5e42\u7b49\u6027\u7ea6\u675f\u5b9e\u73b0\u4e86exactly once \u8bed\u4e49\uff0c\u5176\u4e2d\uff0c\u53d1\u5e03\u6d88\u606f\u65f6 Kafka \u4f1a\u521b\u5efa\u5168\u5c40\u552f\u4e00\u7684\u9012\u589e ID\uff0c\u8fd9\u6837\u4f20\u8f93\u6d88\u606f\u65f6\u5b83\u5c31\u80fd\u4f4e\u6210\u672c\u5730\u53bb\u9664\u91cd\u590d\u7684\u6d88\u606f\uff0c\u901a\u8fc7\u5e42\u7b49\u6027\u4e3a\u5355\u961f\u5217\u5b9e\u73b0 exactly once \u8bed\u4e49\uff1b\u9488\u5bf9\u751f\u4ea7\u8005\u5411\u591a\u4e2a\u5206\u533a\u53d1\u5e03\u540c\u4e00\u6761\u6d88\u606f\u7684\u573a\u666f\uff0c\u6d88\u606f\u4e8b\u52a1\u901a\u8fc7\u201c\u8981\u4e48\u5168\u90e8\u6210\u529f\u8981\u4e48\u5168\u90e8\u5931\u8d25\u201d\uff0c\u4e5f\u5b9e\u73b0\u4e86 exactly once \u8bed\u4e49\u3002</p>"},{"location":"chap3/8message_queue/#3","title":"3\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u6d88\u606f\u961f\u5217\u53ef\u4ee5\u89e3\u8026\u5206\u5e03\u5f0f\u7cfb\u7edf\uff0c\u5176\u7f13\u5b58\u7684\u6d88\u606f\u63d0\u4f9b\u4e86\u524a\u5cf0\u586b\u8c37\u529f\u80fd\uff0c\u5c06\u6d88\u606f\u6301\u4e45\u5316\u5219\u63d0\u9ad8\u4e86\u7cfb\u7edf\u53ef\u7528\u6027\uff0c\u5171\u4eab\u961f\u5217\u5219\u4e3a\u7cfb\u7edf\u63d0\u4f9b\u4e86\u53ef\u4f38\u7f29\u6027\uff0c\u800c\u4e14\u7edf\u8ba1\u6d88\u606f\u5c31\u53ef\u4ee5\u76d1\u63a7\u6574\u4e2a\u7cfb\u7edf\uff0c\u56e0\u6b64\u6d88\u606f\u961f\u5217\u5df2\u6210\u4e3a\u5f53\u4e0b\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u5fc5\u5907\u57fa\u7840\u8bbe\u65bd\u3002</p> <p>\u867d\u7136\u6d88\u606f\u961f\u5217\u81ea\u8eab\u62e5\u6709\u4f18\u79c0\u7684\u6027\u80fd\uff0c\u4f46\u82e5\u60f3\u63d0\u9ad8\u4f7f\u7528\u6548\u7387\uff0c\u6211\u4eec\u5c31\u9700\u8981\u786e\u4fdd\u5728\u751f\u4ea7\u7aef\u5b9e\u73b0\u7f51\u7edc\u4f20\u8f93\u4e0a\u7684\u5e76\u53d1\uff0c\u5728\u6d88\u8d39\u7aef\u6269\u5bb9\u65f6\u540c\u6b65\u589e\u52a0\u961f\u5217\u6216\u8005\u5206\u533a\uff0c\u5e76\u4e14\u9700\u8981\u6301\u7eed\u76d1\u63a7\u7cfb\u7edf\uff0c\u786e\u4fdd\u6d88\u606f\u7684\u751f\u4ea7\u80fd\u529b\u5c0f\u4e8e\u6d88\u8d39\u80fd\u529b\uff0c\u9632\u6b62\u6d88\u606f\u79ef\u538b\u3002</p> <p>\u6d88\u606f\u961f\u5217\u7684 Qos \u63d0\u4f9b\u4e09\u79cd\u8bed\u4e49\uff0c\u5176\u4e2d at most once \u5f88\u5c11\u4f7f\u7528\uff0c\u800c\u4e3b\u6d41\u7684 at least once \u7531\u6d88\u606f\u6301\u4e45\u5316\u65f6\u7684\u5197\u4f59\uff0c\u4ee5\u53ca\u751f\u4ea7\u7aef\u3001\u6d88\u606f\u7aef\u4f7f\u7528\u6d88\u606f\u7684\u65b9\u5f0f\u5171\u540c\u4fdd\u969c\u3002Kafka \u901a\u8fc7\u5e42\u7b49\u6027\u3001\u4e8b\u52a1\u6d88\u606f\u8fd9\u4e24\u4e2a\u7279\u6027\uff0c\u5728 at least once \u7684\u57fa\u7840\u4e0a\u63d0\u4f9b\u4e86 exactly once \u8bed\u4e49\u3002</p>"},{"location":"chap3/9map_reduce/","title":"\u7b2c\u4e5d\u8282 MapReduce\u901a\u8fc7\u96c6\u7fa4\u5b9e\u73b0\u79bb\u7ebf\u8ba1\u7b97","text":"<p>\u5bf9\u5927\u91cf\u6570\u636e\u505a\u8ba1\u7b97\u65f6\uff0c\u901a\u5e38\u4f1a\u91c7\u7528\u5206\u800c\u6cbb\u4e4b\u7684\u7b56\u7565\u63d0\u5347\u8ba1\u7b97\u901f\u5ea6\u3002</p> <p>\u6bd4\u5982\u5355\u673a\u4e0a\u57fa\u4e8e\u9012\u5f52\u3001\u5206\u6cbb\u601d\u60f3\u5b9e\u73b0\u7684\u5feb\u901f\u6392\u5e8f\u3001\u5806\u6392\u5e8f\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u53ea\u6709 <code>O(N*logN)</code>\uff0c\u8fd9\u6bd4\u5728\u539f\u59cb\u6570\u636e\u96c6\u4e0a\u5de5\u4f5c\u7684\u63d2\u5165\u6392\u5e8f\u3001\u5192\u6ce1\u6392\u5e8f\u8981\u5feb\u5f97\u591a<code>\uff08O(N2)\uff09</code>\u3002</p> <p>\u7136\u800c\uff0c\u5f53\u5355\u673a\u78c1\u76d8\u5bb9\u91cf\u65e0\u6cd5\u5b58\u653e\u5168\u90e8\u6570\u636e\uff0c\u6216\u8005\u53d7\u9650\u4e8e CPU \u9891\u7387\u3001\u6838\u5fc3\u6570\u91cf\uff0c\u5355\u673a\u7684\u8ba1\u7b97\u65f6\u95f4\u8fdc\u5927\u4e8e\u53ef\u63a5\u53d7\u8303\u56f4\u65f6\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5728\u5206\u5e03\u5f0f\u96c6\u7fa4\u4e0a\u4f7f\u7528\u5206\u6cbb\u7b56\u7565\u3002</p> <p>\u5f53\u5355\u673a\u78c1\u76d8\u5bb9\u91cf\u65e0\u6cd5\u5b58\u653e\u5168\u90e8\u6570\u636e\uff0c\u6216\u8005\u53d7\u9650\u4e8e CPU \u9891\u7387\u3001\u6838\u5fc3\u6570\u91cf\uff0c\u5355\u673a\u7684\u8ba1\u7b97\u65f6\u95f4\u8fdc\u5927\u4e8e\u53ef\u63a5\u53d7\u8303\u56f4\u65f6\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5728\u5206\u5e03\u5f0f\u96c6\u7fa4\u4e0a\u4f7f\u7528\u5206\u6cbb\u7b56\u7565\u3002</p> <p>\u6bd4\u5982\uff0c\u5927\u89c4\u6a21\u96c6\u7fa4\u6bcf\u5929\u4ea7\u751f\u7684\u65e5\u5fd7\u91cf\u662f\u4ee5 TB \u4e3a\u5355\u4f4d\u8ba1\u7b97\u7684\uff0c\u8fd9\u79cd\u65e5\u5fd7\u5206\u6790\u4efb\u52a1\u5355\u53f0\u670d\u52a1\u5668\u7684\u5904\u7406\u80fd\u529b\u662f\u8fdc\u8fdc\u4e0d\u591f\u7684\u3002</p> <p>\u9700\u8981\u5c06\u8ba1\u7b97\u4efb\u52a1\u5206\u89e3\u6210\u5355\u673a\u53ef\u4ee5\u5b8c\u6210\u7684\u5c0f\u4efb\u52a1\uff0c\u7531\u5206\u5e03\u5f0f\u96c6\u7fa4\u5e76\u884c\u5904\u7406\u540e\uff0c\u518d\u4ece\u4e2d\u95f4\u7ed3\u679c\u4e2d\u5f52\u5e76\u5f97\u5230\u6700\u7ec8\u7684\u8fd0\u7b97\u7ed3\u679c\u3002\u8fd9\u4e00\u8fc7\u7a0b\u7531 Google \u62bd\u8c61\u4e3aMapReduce \u6a21\u5f0f\uff0c\u5b9e\u73b0\u5728 Hadoop \u7b49\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u3002</p> <p>\u867d\u7136 MapReduce \u5df2\u7ecf\u6709\u5341\u591a\u4e2a\u5e74\u5934\u7684\u5386\u53f2\u4e86\uff0c\u4f46\u5b83\u4ecd\u662f\u5206\u5e03\u5f0f\u8ba1\u7b97\u7684\u57fa\u77f3\uff0c\u8fd9\u79cd\u7f16\u7a0b\u601d\u60f3\u5728\u65b0\u51fa\u73b0\u7684\u5404\u79cd\u6280\u672f\u4e2d\u90fd\u6709\u5e7f\u6cdb\u7684\u5e94\u7528\u3002\u6bd4\u5982\u5f53\u5728\u5355\u673a\u4e0a\u4f7f\u7528 TensorFlow \u5b8c\u6210\u4e00\u8f6e\u6df1\u5ea6\u5b66\u4e60\u7684\u65f6\u95f4\u8fc7\u4e45\uff0c\u6216\u8005\u5355\u9897 GPU \u663e\u5b58\u65e0\u6cd5\u5b58\u653e\u5b8c\u6574\u7684\u795e\u7ecf\u7f51\u7edc\u6a21\u578b\u65f6\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7 Map \u601d\u60f3\u628a\u6570\u636e\u6216\u8005\u6a21\u578b\u5206\u89e3\u7ed9\u591a\u4e2a TensorFlow \u5b9e\u4f8b\uff0c\u5e76\u884c\u8ba1\u7b97\u540e\u518d\u6839\u636e Reduce \u601d\u60f3\u5408\u5e76\u5f97\u5230\u6700\u7ec8\u7ed3\u679c\u3002\u518d\u6bd4\u5982\u77e5\u8bc6\u56fe\u8c31\u4e5f\u662f\u901a\u8fc7 MapReduce \u601d\u60f3\u5e76\u884c\u5b8c\u6210\u56fe\u8ba1\u7b97\u4efb\u52a1\u7684\u3002</p>"},{"location":"chap3/9map_reduce/#1","title":"1\u3001\u5206\u800c\u6cbb\u4e4b\uff1a\u5982\u4f55\u5b9e\u73b0\u96c6\u7fa4\u4e2d\u7684\u6279\u91cf\u8ba1\u7b97\uff1f","text":"<p>\u5206\u800c\u6cbb\u4e4b\u7684\u601d\u60f3\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u5e7f\u4e3a\u4f7f\u7528\uff0c\u6bd4\u5982\u4ecb\u7ecd\u8fc7\u7684 AKF \u7acb\u65b9\u4f53 Z \u8f74\u6269\u5c55\uff0c\u5c31\u662f\u57fa\u4e8e\u7528\u6237\u7684\u8bf7\u6c42\uff0c\u7f29\u5c0f\u96c6\u7fa4\u4e2d\u5355\u4e2a\u8282\u70b9\u5f85\u5904\u7406\u7684\u6570\u636e\u91cf\uff0c\u6bd4\u5982\u4e0b\u56fe\u4e2d\u5f53\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u5355\u8868\u884c\u6570\u8fbe\u5230\u5343\u4e07\u884c\u4ee5\u4e0a\u65f6\uff0c\u6b64\u65f6\u4e0d\u5f97\u4e0d\u5b58\u653e\u5728\u78c1\u76d8\u4e2d\u7684\u7d22\u5f15\u5c06\u4f1a\u4e25\u91cd\u964d\u4f4e SQL \u8bed\u53e5\u7684\u67e5\u8be2\u901f\u5ea6\u3002</p> <p>\u800c\u6267\u884c\u5206\u5e93\u5206\u8868\u540e\uff0c\u7531\u5e94\u7528\u6216\u8005\u4e2d\u95f4\u5c42\u7684\u4ee3\u7406\u5206\u89e3\u67e5\u8be2\u8bed\u53e5\uff0c\u5f85\u591a\u4e2a\u4e0d\u8db3\u767e\u4e07\u884c\u7684\u8868\u5feb\u901f\u8fd4\u56de\u67e5\u8be2\u7ed3\u679c\u540e\uff0c\u518d\u5f52\u5e76\u4e3a\u6700\u7ec8\u7684\u7ed3\u679c\u96c6\u3002</p> <p></p> <p>\u4e0e\u4e0a\u8ff0\u7684 IO \u7c7b\u4efb\u52a1\u4e0d\u540c\uff0c\u5e76\u975e\u6240\u6709\u7684\u8ba1\u7b97\u4efb\u52a1\u90fd\u53ef\u4ee5\u57fa\u4e8e\u5206\u6cbb\u7b56\u7565\uff0c\u5206\u89e3\u4e3a\u53ef\u4ee5\u5e76\u53d1\u6267\u884c\u7684\u5b50\u4efb\u52a1\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528 MapReduce \u7684\u8ba1\u7b97\u4efb\u52a1\uff0c\u5176\u4e2d\u6700\u7ecf\u5178\u7684\u4f8b\u5b50\u662f\u6392\u5e8f\uff08Google \u5728\u6784\u5efa\u5012\u6392\u7d22\u5f15\u65f6\u8981\u4e3a\u5927\u91cf\u7f51\u9875\u6392\u5e8f\uff09\u3002</p> <p>\u5f53\u4f7f\u7528\u63d2\u5165\u6392\u5e8f\uff08\u4e0d\u719f\u6089\u63d2\u5165\u6392\u5e8f\u7684\u540c\u5b66\uff0c\u53ef\u4ee5\u60f3\u8c61\u81ea\u5df1\u62ff\u4e86\u4e00\u624b\u4e71\u724c\uff0c\u7136\u540e\u5728\u624b\u4e2d\u4e00\u5f20\u5f20\u91cd\u65b0\u63d2\u5165\u5c06\u5176\u6574\u7406\u6709\u5e8f\uff09\u5728\u6574\u4e2a\u6570\u636e\u96c6\u4e0a\u64cd\u4f5c\u65f6\uff0c\u8ba1\u7b97\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f<code>O(N2)</code>\uff0c\u4f46\u5feb\u6392\u3001\u5806\u6392\u5e8f\u3001\u5f52\u5e76\u6392\u5e8f\u7b49\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u53ea\u6709 <code>O(N*logN)</code>\uff0c\u8fd9\u5c31\u662f\u901a\u8fc7\u5206\u6cbb\u7b56\u7565\uff0c\u7f29\u5c0f\u5b50\u95ee\u9898\u6570\u636e\u89c4\u6a21\u5b9e\u73b0\u7684\u3002</p> <p>\u6bd4\u5982\u4e0b\u56fe\u662f\u5728 8 \u4e2a\u6570\u5b57\u4e0a\u4f7f\u7528\u5f52\u5e76\u6392\u5e8f\u7b97\u6cd5\u8fdb\u884c\u6392\u5e8f\u7684\u6d41\u7a0b\u3002\u6211\u4eec\u5c06\u6570\u7ec4\u9012\u5f52\u5730\u8fdb\u884c <code>3\uff08log8</code>\uff09\u8f6e\u5bf9\u534a\u62c6\u5206\u540e\uff0c\u6bcf\u4e2a\u5b50\u6570\u7ec4\u5c31\u53ea\u6709 2 \u4e2a\u5143\u7d20\u3002\u5bf9 2 \u4e2a\u5143\u7d20\u6392\u5e8f\u53ea\u9700\u8981\u8fdb\u884c 1 \u6b21\u6bd4\u8f83\u5c31\u80fd\u5b8c\u6210\u3002\u63a5\u7740\uff0c\u518d\u5c06\u6709\u5e8f\u7684\u5b50\u6570\u7ec4\u4e0d\u65ad\u5730\u5408\u5e76\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u5b8c\u6574\u7684\u6709\u5e8f\u6570\u7ec4\u3002</p> <p></p> <p>\u5176\u4e2d\uff0c\u5c06\u4e24\u4e2a\u542b\u6709 N/2 \u4e2a\u5143\u7d20\u7684\u6709\u5e8f\u5b50\u6570\u7ec4\uff08\u6bd4\u5982 1\u30013\u30017\u300119 \u548c 4\u30018\u300111\u300125\uff09\uff0c\u5408\u5e76\u4e3a\u4e00\u4e2a\u6709\u5e8f\u6570\u7ec4\u65f6\u53ea\u9700\u8981\u505a <code>N/2</code> \u5230 <code>N-1</code> \u6b21\u6bd4\u8f83\uff08\u56fe\u4e2d\u53ea\u505a\u4e86 5 \u6b21\u6bd4\u8f83\uff09\uff0c\u901f\u5ea6\u975e\u5e38\u5feb\u3002\u56e0\u6b64\uff0c\u6bd4\u8f83\u6b21\u6570\u4e58\u4ee5\u8fed\u4ee3\u8f6e\u6570\u5c31\u53ef\u4ee5\u5f97\u51fa\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a <code>O(N*logN)</code>\u3002</p> <p>\u540c\u6837\u7684\u9053\u7406\u5f15\u7533\u5230\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u5c31\u6210\u4e3a\u4e86 MapReduce \u6a21\u5f0f\u3002</p> <p>\u5176\u4e2d\uff0c\u539f\u59cb\u6570\u636e\u96c6\u8981\u901a\u8fc7 SPLIT \u6b65\u9aa4\u62c6\u5206\u5230\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u591a\u4e2a\u8282\u70b9\u4e2d\uff0c\u800c\u6bcf\u4e2a\u8282\u70b9\u5e76\u53d1\u6267\u884c\u7528\u6237\u9884\u5b9a\u4e49\u7684 MAP \u51fd\u6570\uff0c\u6700\u540e\u5c06 MAP \u8fd0\u7b97\u51fa\u7684\u7ed3\u679c\u901a\u8fc7\u7528\u6237\u9884\u5b9a\u4e49\u7684 REDUCE \u51fd\u6570\uff0c\u5f52\u5e76\u4e3a\u6700\u7ec8\u7684\u7ed3\u679c\u3002</p> <p>\u6bd4\u5982\u4e0a\u4f8b\u4e2d\u6211\u4eec\u53ef\u4ee5\u5c06 8 \u4e2a\u5143\u7d20\u62c6\u5206\u5230 2 \u4e2a\u8282\u70b9\u4e2d\u5e76\u884c\u8ba1\u7b97\uff0c\u5176\u4e2d\u6bcf\u4e2a\u8282\u70b9\u7a76\u7adf\u662f\u7ee7\u7eed\u91c7\u7528\u5f52\u5e76\u6392\u5e8f\uff0c\u8fd8\u662f\u4f7f\u7528\u5176\u4ed6\u6392\u5e8f\u7b97\u6cd5\uff0c\u8fd9\u7531\u9884\u5b9a\u4e49\u7684 MAP \u51fd\u6570\u51b3\u5b9a\u3002\u5f53</p> <p>MAP \u51fd\u6570\u751f\u6210\u6709\u5e8f\u7684\u5b50\u6570\u7ec4\u540e\uff0cREDUCE \u51fd\u6570\u518d\u5c06\u5b83\u4eec\u5f52\u5e76\u4e3a\u5b8c\u6574\u7684\u6709\u5e8f\u6570\u7ec4\uff0c\u5177\u4f53\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u5f53\u9762\u5bf9 TB\u3001PB \u7ea7\u522b\u7684\u6570\u636e\u65f6\uff0cMapReduce \u601d\u60f3\u5c31\u6210\u4e86\u552f\u4e00\u7684\u89e3\u51b3\u65b9\u6848\u3002</p> <p>\u5f53\u7136\uff0c\u5728\u5b9e\u9645\u8f6f\u4ef6\u5de5\u7a0b\u4e2d\u5b9e\u73b0 MapReduce \u7684\u6846\u67b6\u8981\u6bd4\u4e0a\u9762\u7684\u793a\u610f\u56fe\u590d\u6742\u8bb8\u591a\uff0c\u6bd5\u7adf\u5728\u5927\u89c4\u6a21\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u6545\u969c\u6bcf\u65f6\u6bcf\u523b\u90fd\u4f1a\u53d1\u751f\uff0c\u5982\u4f55\u5206\u53d1\u6570\u636e\u3001\u8c03\u5ea6\u8282\u70b9\u6267\u884c MAP \u6620\u5c04\u3001\u76d1\u63a7\u8ba1\u7b97\u8282\u70b9\u7b49\uff0c\u90fd\u9700\u8981\u7cbe\u5fc3\u7684\u8bbe\u8ba1\u3002\u7279\u522b\u662f\uff0c\u5f53\u5355\u4e2a\u8282\u70b9\u7684\u78c1\u76d8\u65e0\u6cd5\u5b58\u653e\u4e0b\u5168\u90e8\u6570\u636e\u65f6\uff0c\u5e38\u5e38\u4f7f\u7528\u7c7b\u4f3c HDFS \u7684\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u5b58\u653e\u6570\u636e\uff0c\u6240\u4ee5 MapReduce \u6846\u67b6\u5f80\u5f80\u8fd8\u9700\u8981\u5bf9\u63a5\u8fd9\u6837\u7684\u7cfb\u7edf\u6765\u83b7\u53d6\u6570\u636e\uff0c\u5177\u4f53\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u800c\u4e14\uff0c\u751f\u4ea7\u73af\u5883\u4e2d\u7684\u4efb\u52a1\u8fdc\u6bd4\u6574\u6570\u6392\u5e8f\u590d\u6742\u5f97\u591a\uff0c\u6240\u4ee5\u5199\u5bf9 Map\u3001Reduce \u51fd\u6570\u5e76\u4e0d\u5bb9\u6613\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\uff0c\u5927\u90e8\u5206\u6570\u636e\u5206\u6790\u4efb\u52a1\u53c8\u662f\u9ad8\u5ea6\u76f8\u4f3c\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u6ca1\u6709\u5fc5\u8981\u603b\u662f\u76f4\u63a5\u7f16\u5199 Map\u3001Reduce \u51fd\u6570\uff0c\u5b9e\u73b0\u53d1\u5e03\u5f0f\u7cfb\u7edf\u7684\u79bb\u7ebf\u8ba1\u7b97\u3002</p> <p>\u7531\u4e8e SQL \u8bed\u8a00\u652f\u6301\u805a\u5408\u5206\u6790\u3001\u8868\u5173\u8054\uff0c\u8fd8\u5185\u7f6e\u4e86\u8bb8\u591a\u7edf\u8ba1\u51fd\u6570\uff0c\u5f88\u9002\u5408\u7528\u6765\u505a\u6570\u636e\u5206\u6790\uff0c\u5b83\u7684\u5b66\u4e60\u6210\u672c\u53c8\u975e\u5e38\u4f4e\uff0c\u6240\u4ee5\u5927\u90e8\u5206 MapReduce \u6846\u67b6\u90fd\u63d0\u4f9b\u4e86\u7c7b SQL \u8bed\u8a00\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u66ff\u4ee3\u81ea\u884c\u7f16\u5199 Map\u3001Reduce \u51fd\u6570\u3002</p>"},{"location":"chap3/9map_reduce/#2sql-mapreduce","title":"2\u3001SQL \u662f\u5982\u4f55\u7b80\u5316 MapReduce \u6a21\u5f0f\u7684\uff1f","text":"<p>\u6700\u5e38\u89c1\u7684 Web \u65e5\u5fd7\u5206\u6790\u4e3a\u4f8b\uff0c\u89c2\u5bdf\u7528 SQL \u8bed\u8a00\u505a\u7edf\u8ba1\u65f6\uff0cMapReduce \u6d41\u7a0b\u662f\u600e\u6837\u6267\u884c\u7684\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0cNginx \u7684 <code>access.log</code> \u8bbf\u95ee\u65e5\u5fd7\u662f\u8fd9\u6837\u7684\uff08\u57fa\u4e8e\u9ed8\u8ba4\u7684 <code>combined</code> \u683c\u5f0f\uff09\uff1a</p> <pre><code>127.0.0.1 - - [18/Jul/2020:10:16:15 +0800] \"GET /login\uff1fuserid=101 HTTP/1.1\" 200 56 \"-\" \"curl/7.29.0\"\n</code></pre> <p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u6b63\u5219\u8868\u8fbe\u5f0f\u53d6\u51fa\u5ba2\u6237\u7aef IP \u5730\u5740\u3001\u7528\u6237\u540d\u3001HTTP \u54cd\u5e94\u7801\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u751f\u6210\u7ed3\u6784\u5316\u7684\u6570\u636e\u8868\u683c\uff1a</p> <p></p> <p>\u5982\u679c\u6211\u4eec\u60f3\u6309\u7167\u5ba2\u6237\u7aef IP\u3001HTTP \u54cd\u5e94\u7801\u805a\u5408\u7edf\u8ba1\u8bbf\u95ee\u6b21\u6570\uff0c\u57fa\u4e8e\u901a\u7528\u7684 SQL \u89c4\u5219\uff0c\u5c31\u53ef\u4ee5\u5199\u51fa\u4e0b\u9762\u8fd9\u884c SQL \u8bed\u53e5\uff1a</p> <pre><code>select ClientIp, StatusCode, count(*) from access_log group by ClientIp, StatusCode\n</code></pre> <p>\u800c\u5efa\u7acb\u5728 MapReduce \u4e4b\u4e0a\u7684\u6846\u67b6\uff08\u6bd4\u5982 Hive\uff09\u4f1a\u5c06\u5b83\u7ffb\u8bd1\u6210\u5982\u4e0b\u56fe\u6240\u793a\u7684 MapReduce \u6d41\u7a0b\uff1a</p> <p></p> <p>\u5176\u4e2d\uff0c\u6211\u4eec\u5047\u5b9a 5 \u884c\u6570\u636e\u88ab\u62c6\u5206\u5230 2 \u4e2a\u8282\u70b9\u4e2d\u6267\u884c Map \u51fd\u6570\uff0c\u5176\u4e2d\u5b83\u4eec\u5206\u522b\u57fa\u4e8e 2 \u884c\u30013 \u884c\u8fd9\u6837\u5c0f\u89c4\u6a21\u7684\u6570\u636e\u96c6\uff0c\u751f\u6210\u4e86\u6b63\u786e\u7684\u805a\u5408\u7edf\u8ba1\u7ed3\u679c\u3002</p> <p>\u63a5\u7740\uff0c\u5728 Shuffle \u6b65\u9aa4\u57fa\u4e8e key \u5173\u952e\u5b57\u6392\u5e8f\u540e\uff0c\u518d\u4ea4\u7531 Reduce \u51fd\u6570\u5f52\u5e76\u51fa\u6b63\u786e\u7684\u7ed3\u679c\u3002</p> <p>\u9664\u4e86\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u7684 count \u51fd\u6570\uff0c\u50cf max\uff08\u6c42\u6700\u5927\u503c\uff09\u3001min\uff08\u6c42\u6700\u5c0f\u503c\uff09\u3001distinct\uff08\u53bb\u91cd\uff09\u3001sum\uff08\u6c42\u548c\uff09\u3001avg\uff08\u6c42\u5e73\u5747\u6570\uff09\u3001median\uff08\u6c42\u4e2d\u4f4d\u6570\uff09\u3001stddev\uff08\u6c42\u6807\u51c6\u5dee\uff09\u7b49\u51fd\u6570\uff0c\u90fd\u5f88\u5bb9\u6613\u5206\u89e3\u4e3a\u5b50\u4efb\u52a1\u5e76\u53d1\u6267\u884c\uff0c\u6700\u540e\u5f52\u5e76\u51fa\u6700\u7ec8\u7ed3\u679c\u3002</p> <p>\u5f53\u591a\u4e2a\u6570\u636e\u96c6\u4e4b\u95f4\u9700\u8981\u505a\u4ea4\u53c9\u7edf\u8ba1\u65f6\uff0cSQL \u4e2d\u7684 join \u529f\u80fd\uff08\u5305\u62ec\u5185\u8fde\u63a5\u3001\u5de6\u5916\u8fde\u63a5\u3001\u53f3\u5916\u8fde\u63a5\u3001\u5168\u8fde\u63a5\u56db\u79cd\u6a21\u5f0f\uff09\u4e5f\u5f88\u5bb9\u6613\u505a\u5173\u8054\u67e5\u8be2\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u5e76\u884c\u8ba1\u7b97\u7684 Map \u51fd\u6570\u4e2d\uff0c\u628a where \u6761\u4ef6\u4e2d\u7684\u5173\u8054\u5b57\u6bb5\u4f5c\u4e3a key \u5173\u952e\u5b57\uff0c\u7ecf\u7531 Reduce \u9636\u6bb5\u5b9e\u73b0\u7ed3\u679c\u7684\u5173\u8054\u3002</p> <p>\u7531\u4e8e MapReduce \u64cd\u4f5c\u7684\u6570\u636e\u96c6\u975e\u5e38\u5e9e\u5927\uff0c\u8fd8\u9700\u8981\u7ecf\u7531\u7f51\u7edc\u8c03\u5ea6\u591a\u53f0\u670d\u52a1\u5668\u624d\u80fd\u5b8c\u6210\u8ba1\u7b97\uff0c\u56e0\u6b64\u4efb\u52a1\u7684\u6267\u884c\u65f6\u5ef6\u81f3\u5c11\u5728\u5206\u949f\u7ea7\uff0c\u6240\u4ee5\u901a\u5e38\u4e0d\u4f1a\u670d\u52a1\u4e8e\u7528\u6237\u7684\u5b9e\u65f6\u8bf7\u6c42\uff0c\u800c\u53ea\u662f\u4f5c\u4e3a\u79bb\u7ebf\u7684\u5f02\u6b65\u4efb\u52a1\u5c06\u8fd0\u7b97\u7ed3\u679c\u5199\u5165\u6570\u636e\u5e93\u3002</p>"},{"location":"chap3/9map_reduce/#3","title":"3\u3001\u672c\u8282\u5c0f\u7ed3","text":"<p>\u5f53\u6570\u636e\u91cf\u5f88\u5927\uff0c\u6216\u8005\u8ba1\u7b97\u65f6\u95f4\u8fc7\u957f\u65f6\uff0c\u5982\u679c\u8ba1\u7b97\u8fc7\u7a0b\u53ef\u4ee5\u88ab\u5206\u89e3\u4e3a\u5e76\u53d1\u6267\u884c\u7684\u5b50\u4efb\u52a1\uff0c\u5c31\u53ef\u4ee5\u57fa\u4e8e MapReduce \u601d\u60f3\uff0c\u5229\u7528\u5206\u5e03\u5f0f\u96c6\u7fa4\u7684\u8ba1\u7b97\u529b\u5b8c\u6210\u4efb\u52a1\u3002\u5176\u4e2d\uff0c\u7528\u6237\u53ef\u4ee5\u9884\u5b9a\u4e49\u5728\u8282\u70b9\u4e2d\u5e76\u53d1\u6267\u884c\u7684 Map \u51fd\u6570\uff0c\u4ee5\u53ca\u5c06 Map \u8f93\u51fa\u7684\u5217\u8868\u5408\u5e76\u4e3a\u6700\u7ec8\u7ed3\u679c\u7684 Reduce \u51fd\u6570\u3002</p> <p>\u867d\u7136 MapReduce \u5c06\u5e76\u884c\u8ba1\u7b97\u62bd\u8c61\u4e3a\u7edf\u4e00\u7684\u6a21\u578b\uff0c\u4f46\u5f00\u53d1 Map\u3001Reduce \u51fd\u6570\u7684\u6210\u672c\u8fd8\u662f\u592a\u9ad8\u4e86\uff0c\u4e8e\u662f\u9488\u5bf9\u9ad8\u9891\u573a\u666f\uff0c\u8bb8\u591a MapReduce \u4e4b\u4e0a\u7684\u6846\u67b6\u63d0\u4f9b\u4e86\u7c7b SQL \u8bed\u8a00\u63a5\u53e3\uff0c\u901a\u8fc7 group by \u7684\u805a\u5408\u3001join \u8fde\u63a5\u4ee5\u53ca\u5404\u79cd\u7edf\u8ba1\u51fd\u6570\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u6574\u4e2a\u96c6\u7fa4\u5b8c\u6210\u6570\u636e\u5206\u6790\u3002</p> <p>MapReduce \u6a21\u5f0f\u9488\u5bf9\u7684\u662f\u9759\u6001\u6570\u636e\uff0c\u4e5f\u53eb\u6709\u8fb9\u754c\u6570\u636e\uff0c\u5b83\u66f4\u591a\u7528\u4e8e\u4e1a\u52a1\u7684\u4e8b\u524d\u6216\u8005\u4e8b\u540e\u5904\u7406\u6d41\u7a0b\u4e2d\uff0c\u800c\u505a\u4e8b\u4e2d\u5904\u7406\u65f6\u5fc5\u987b\u9762\u5bf9\u5b9e\u65f6\u3001\u4e0d\u65ad\u589e\u957f\u7684\u65e0\u8fb9\u754c\u6570\u636e\u6d41\uff0c\u6b64\u65f6 MapReduce \u5c31\u65e0\u80fd\u4e3a\u529b\u4e86\u3002</p>"},{"location":"chap4/10Deep_learning/","title":"L10 30 Frequently asked Deep Learning Interview","text":""},{"location":"chap4/10Deep_learning/#1-what-is-deep-learning","title":"1. What is Deep Learning?","text":"<p>It performs complex operations to extract hidden patterns and features(for instance, distinguishing the image of a cat from that of a dog).</p> <p> </p>"},{"location":"chap4/10Deep_learning/#2-what-is-a-neural-network","title":"2. What is a Neural Network?","text":"<p>Neural Networks replicate the way humans learn, inspired by how the neurons in our brains fire, only much simpler.</p> <p> </p> <p>The most common Neural Networks consist of three network layers:</p> <ul> <li>An input layer</li> <li>A hidden layer (this is the most important layer where feature extraction takes place, and adjustments are made to train faster and function better)</li> <li>An output layer</li> </ul> <p>Each sheet contains neurons called \u201cnodes,\u201d performing various operations. Neural Networks are used in deep learning algorithms like CNN, RNN, GAN, etc.</p>"},{"location":"chap4/10Deep_learning/#3-what-is-a-multi-layer-perceptronmlp","title":"3. What Is a Multi-layer Perceptron(MLP)?","text":"<p>As in Neural Networks, MLPs have an input layer, a hidden layer, and an output layer. </p> <p>It has the same structure as a single layer perceptron with one or more hidden layers. </p> <p>A single layer perceptron can classify only linear separable classes with binary output (0,1), but MLP can classify nonlinear classes.</p> <p>Except for the input layer, each node in the other layers uses a nonlinear activation function. </p> <p>This means the input layers, the data coming in, and the activation function is based upon all nodes and weights being added together, producing the output. MLP uses a supervised learning method called \u201cbackpropagation.\u201d In backpropagation, the neural network calculates the error with the help of cost function. It propagates this error backward from where it came (adjusts the weights to train the model more accurately).</p>"},{"location":"chap4/10Deep_learning/#4-what-is-data-normalization-and-why-do-we-need-it","title":"4. What Is Data Normalization, and Why Do We Need It?","text":"<p>The process of standardizing and reforming data is called \u201cData Normalization.\u201d It\u2019s a pre-processing step to eliminate data redundancy.</p> <p>Often, data comes in, and you get the same information in different formats. In these cases, you should rescale values to fit into a particular range, achieving better convergence.</p>"},{"location":"chap4/10Deep_learning/#5-what-is-the-boltzmann-machine","title":"5. What is the Boltzmann Machine?","text":"<p>**One of the most basic Deep Learning models is a Boltzmann Machine, resembling a simplified version of the Multi-Layer Perceptron. **</p> <p>This model features a visible input layer and a hidden layer -- just a two-layer neural net that makes stochastic decisions as to whether a neuron should be on or off. Nodes are connected across layers, but no two nodes of the same layer are connected.</p>"},{"location":"chap4/10Deep_learning/#6-what-is-the-role-of-activation-functions-in-a-neural-network","title":"6. What Is the Role of Activation Functions in a Neural Network?","text":"<p>At the most basic level, an activation function decides whether a neuron should be fired or not.</p> <p>It accepts the weighted sum of the inputs and bias as input to any activation function. </p> <p>Step function, Sigmoid, ReLU, Tanh, and Softmax are examples of activation functions.</p> <p> </p>"},{"location":"chap4/10Deep_learning/#7-what-is-the-cost-function","title":"7. What Is the Cost Function?","text":"<p>Also referred to as \u201closs\u201d or \u201cerror,\u201d cost function is a measure to evaluate how good your model\u2019s performance is.</p> <p>It\u2019s used to compute the error of the output layer during backpropagation. </p> <p>We push that error backward through the neural network and use that during the different training functions.</p> <p> </p>"},{"location":"chap4/10Deep_learning/#8-what-is-gradient-descent","title":"8. What Is Gradient Descent?","text":"<p>Gradient Descent is an optimal algorithm to minimize the cost function or to minimize an error.</p> <p>The aim is to find the local-global minima of a function. This determines the direction the model should take to reduce the error.</p> <p> </p>"},{"location":"chap4/10Deep_learning/#9-what-do-you-understand-by-backpropagation","title":"9. What Do You Understand by Backpropagation?","text":"<p>This is one of the most frequently asked deep learning interview questions. Backpropagation is a technique to improve the performance of the network. </p> <p>It backpropagates the error and updates the weights to reduce the error.</p> <p> </p>"},{"location":"chap4/10Deep_learning/#10-what-is-the-difference-between-a-feedforward-neural-network-and-recurrent-neural-network","title":"10. What Is the Difference Between a Feedforward Neural Network and Recurrent Neural Network?","text":"<p>Feedforward Neural Network signals travel in one direction from input to output. There are no feedback loops; the network considers only the current input. It cannot memorize previous inputs (e.g., CNN).</p> <p>A Recurrent Neural Network\u2019s signals travel in both directions, creating a looped network. It considers the current input with the previously received inputs for generating the output of a layer and can memorize past data due to its internal memory.</p> <p> </p>"},{"location":"chap4/10Deep_learning/#11-what-are-the-applications-of-a-recurrent-neural-network-rnn","title":"11. What Are the Applications of a Recurrent Neural Network (RNN)?","text":"<p>The RNN can be used for sentiment analysis, text mining, and image captioning. </p> <p>Recurrent Neural Networks can also address time series problems such as predicting the prices of stocks in a month or quarter.</p>"},{"location":"chap4/10Deep_learning/#12-what-are-the-softmax-and-relu-functions","title":"12. What Are the Softmax and ReLU Functions?","text":"<p>Softmax is an activation function that generates the output between zero and one. It divides each output, such that the total sum of the outputs is equal to one. Softmax is often used for output layers.</p> <p> </p> <p>ReLU (or Rectified Linear Unit) is the most widely used activation function. It gives an output of X if X is positive and zeros otherwise. ReLU is often used for hidden layers.</p> <p> </p>"},{"location":"chap4/10Deep_learning/#13-what-are-hyperparameters","title":"13. What Are Hyperparameters?","text":"<p>With neural networks, you\u2019re usually working with hyperparameters once the data is formatted correctly. hyperparameter is a parameter whose value is set before the learning process begins. It determines how a network is trained and the structure of the network (such as the number of hidden units, the learning rate, epochs, etc.).</p> <p> </p>"},{"location":"chap4/10Deep_learning/#14-what-will-happen-if-the-learning-rate-is-set-too-low-or-too-high","title":"14. What Will Happen If the Learning Rate Is Set Too Low or Too High?","text":"<p>When your learning rate is too low, training of the model will progress very slowly as we are making minimal updates to the weights. It will take many updates before reaching the minimum point.</p> <p>If the learning rate is set too high, this causes undesirable divergent behavior to the loss function due to drastic updates in weights. It may fail to converge (model can give a good output) or even diverge (data is too chaotic for the network to train).</p> <p> </p>"},{"location":"chap4/10Deep_learning/#15-what-is-dropout-and-batch-normalization","title":"15. What Is Dropout and Batch Normalization?","text":"<p>Dropout is a technique of dropping out hidden and visible units of a network randomly to prevent overfitting of data (typically dropping 20 percent of the nodes). It doubles the number of iterations needed to converge the network.</p> <p> </p> <p>Batch normalization is the technique to improve the performance and stability of neural networks by normalizing the inputs in every layer so that they have mean output activation of zero and standard deviation of one.</p>"},{"location":"chap4/10Deep_learning/#16-what-is-the-difference-between-batch-gradient-descent-and-stochastic-gradient-descent","title":"16. What Is the Difference Between Batch Gradient Descent and Stochastic Gradient Descent?","text":""},{"location":"chap4/10Deep_learning/#17-what-is-overfitting-and-underfitting-and-how-to-combat-them","title":"17. What is Overfitting and Underfitting, and How to Combat Them?","text":"<p>Overfitting occurs when the model learns the details and noise in the training data to the degree that it adversely impacts the execution of the model on new information. It is more likely to occur with nonlinear models that have more flexibility when learning a target function.</p> <p>An example would be if a model is looking at cars and trucks, but only recognizes trucks that have a specific box shape. It might not be able to notice a flatbed truck because there's only a particular kind of truck it saw in training. The model performs well on training data, but not in the real world.</p> <p>Underfitting alludes to a model that is neither well-trained on data nor can generalize to new information. This usually happens when there is less and incorrect data to train a model. Underfitting has both poor performance and accuracy.</p> <p>To combat overfitting and underfitting, you can resample the data to estimate the model accuracy (k-fold cross-validation) and by having a validation dataset to evaluate the model.</p>"},{"location":"chap4/10Deep_learning/#18-how-are-weights-initialized-in-a-network","title":"18. How Are Weights Initialized in a Network?","text":"<p>There are two methods here: we can either initialize the weights to zero or assign them randomly.</p> <p>Initializing all weights to 0: This makes your model similar to a linear model. All the neurons and every layer perform the same operation, giving the same output and making the deep net useless.</p> <p>Initializing all weights randomly: Here, the weights are assigned randomly by initializing them very close to 0. It gives better accuracy to the model since every neuron performs different computations. This is the most commonly used method.</p>"},{"location":"chap4/10Deep_learning/#19-what-are-the-different-layers-on-cnn","title":"19. What Are the Different Layers on CNN?","text":"<p>There are four layers in CNN:</p> <ul> <li>Convolutional Layer -  the layer that performs a convolutional operation, creating several smaller picture windows to go over the data.</li> <li>ReLU Layer - it brings non-linearity to the network and converts all the negative pixels to zero. The output is a rectified feature map.</li> <li>Pooling Layer - pooling is a down-sampling operation that reduces the dimensionality of the feature map.</li> <li>Fully Connected Layer - this layer recognizes and classifies the objects in the image.</li> </ul>"},{"location":"chap4/10Deep_learning/#20-what-is-pooling-on-cnn-and-how-does-it-work","title":"20. What is Pooling on CNN, and How Does It Work?","text":"<p>Pooling is used to reduce the spatial dimensions of a CNN. It performs down-sampling operations to reduce the dimensionality and creates a pooled feature map by sliding a filter matrix over the input matrix.</p> <p> </p>"},{"location":"chap4/10Deep_learning/#21-how-does-an-lstm-network-work","title":"21. How Does an LSTM Network Work?","text":"<p>Long-Short-Term Memory (LSTM) is a special kind of recurrent neural network capable of learning long-term dependencies, remembering information for long periods as its default behavior. There are three steps in an LSTM network:</p> <ul> <li>Step 1: The network decides what to forget and what to remember.</li> <li>Step 2: It selectively updates cell state values.</li> <li>Step 3: The network decides what part of the current state makes it to the output.</li> </ul> <p> </p>"},{"location":"chap4/10Deep_learning/#22-what-are-vanishing-and-exploding-gradients","title":"22. What Are Vanishing and Exploding Gradients?","text":"<p>While training an RNN, your slope can become either too small or too large; this makes the training difficult. When the slope is too small, the problem is known as a \u201cVanishing Gradient.\u201d When the slope tends to grow exponentially instead of decaying, it\u2019s referred to as an \u201cExploding Gradient.\u201d Gradient problems lead to long training times, poor performance, and low accuracy.</p> <p> </p>"},{"location":"chap4/10Deep_learning/#23-what-is-the-difference-between-epoch-batch-and-iteration-in-deep-learning","title":"23. What Is the Difference Between Epoch, Batch, and Iteration in Deep Learning?","text":"<ul> <li>Epoch - Represents one iteration over the entire dataset (everything put into the training model).</li> <li>Batch - Refers to when we cannot pass the entire dataset into the neural network at once, so we divide the dataset into several batches.</li> <li>Iteration - if we have 10,000 images as data and a batch size of 200. then an epoch should run 50 iterations (10,000 divided by 50).</li> </ul>"},{"location":"chap4/10Deep_learning/#25-what-do-you-mean-by-tensor-in-tensorflow","title":"25. What Do You Mean by Tensor in Tensorflow?","text":"<p>This is another most frequently asked deep learning interview question. A tensor is a mathematical object represented as arrays of higher dimensions. These arrays of data with different dimensions and ranks fed as input to the neural network are called \u201cTensors.\u201d</p>"},{"location":"chap4/10Deep_learning/#26-what-are-the-programming-elements-in-tensorflow","title":"26. What Are the Programming Elements in Tensorflow?","text":"<p>Constants - Constants are parameters whose value does not change. To define a constant we use  <code>tf.constant()</code> command. For example:</p> <pre><code>a = tf.constant(2.0,tf.float32)\n\nb = tf.constant(3.0)\n\nPrint(a, b)\n</code></pre> <p>Variables - Variables allow us to add new trainable parameters to graph. To define a variable, we use the tf.Variable() command and initialize them before running the graph in a session. An example:</p> <pre><code>W = tf.Variable([.3].dtype=tf.float32)\n\nb = tf.Variable([-.3].dtype=tf.float32)\n</code></pre> <p>Placeholders - these allow us to feed data to a tensorflow model from outside a model. It permits a value to be assigned later. To define a placeholder, we use the <code>tf.placeholder()</code> command. An example:</p> <pre><code>a = tf.placeholder (tf.float32)\n\nb = a*2\n\nwith tf.Session() as sess:\n\nresult = sess.run(b,feed_dict={a:3.0})\n\nprint result\n</code></pre> <p>Sessions - a session is run to evaluate the nodes. This is called the \u201cTensorflow runtime.\u201d For example:</p> <pre><code>a = tf.constant(2.0)\n\nb = tf.constant(4.0)\n\nc = a+b\n\n# Launch Session\n\nSess = tf.Session()\n\n# Evaluate the tensor c\n\nprint(sess.run(c))\n</code></pre>"},{"location":"chap4/10Deep_learning/#27-explain-a-computational-graph","title":"27. Explain a Computational Graph.","text":"<p>Everything in a tensorflow is based on creating a computational graph. It has a network of nodes where each node operates, Nodes represent mathematical operations, and edges represent tensors. Since data flows in the form of a graph, it is also called a \u201cDataFlow Graph.\u201d</p>"},{"location":"chap4/10Deep_learning/#28-explain-generative-adversarial-network","title":"28. Explain Generative Adversarial Network.","text":"<p>Suppose there is a wine shop purchasing wine from dealers, which they resell later. But some dealers sell fake wine. In this case, the shop owner should be able to distinguish between fake and authentic wine.</p> <p>The forger will try different techniques to sell fake wine and make sure specific techniques go past the shop owner\u2019s check. The shop owner would probably get some feedback from wine experts that some of the wine is not original. The owner would have to improve how he determines whether a wine is fake or authentic.</p> <p>The forger\u2019s goal is to create wines that are indistinguishable from the authentic ones while the shop owner intends to tell if the wine is real or not accurately.</p> <p> </p> <p>Let us understand this example with the help of an image shown above.</p> <p>There is a noise vector coming into the forger who is generating fake wine.</p> <p>Here the forger acts as a Generator.</p> <p>The shop owner acts as a Discriminator.</p> <p>The Discriminator gets two inputs; one is the fake wine, while the other is the real authentic wine. The shop owner has to figure out whether it is real or fake.</p> <p>So, there are two primary components of Generative Adversarial Network (GAN) named:</p> <ul> <li>Generator</li> <li>Discriminator</li> </ul> <p>The generator is a CNN that keeps keys producing images and is closer in appearance to the real images while the discriminator tries to determine the difference between real and fake images The ultimate aim is to make the discriminator learn to identify real and fake images.</p>"},{"location":"chap4/10Deep_learning/#29-what-is-an-auto-encoder","title":"29. What Is an Auto-encoder?","text":"<p>This Neural Network has three layers in which the input neurons are equal to the output neurons. The network's target outside is the same as the input. It uses dimensionality reduction to restructure the input. It works by compressing the image input to a latent space representation then reconstructing the output from this representation.</p>"},{"location":"chap4/10Deep_learning/#30-what-is-bagging-and-boosting","title":"30. What Is Bagging and Boosting?","text":"<p>Bagging and Boosting are ensemble techniques to train multiple models using the same learning algorithm and then taking a call.</p> <p>With Bagging, we take a dataset and split it into training data and test data. Then we randomly select data to place into the bags and train the model separately.</p> <p> </p> <p>With Boosting, the emphasis is on selecting data points which give wrong output to improve the accuracy.</p> <p> </p>"},{"location":"chap4/11Redis_rev/","title":"L11 Redis \u6838\u5fc3\u6280\u672f\u8003\u9898","text":"<ul> <li> <p>1 Redis\u7684Streams\u6570\u636e\u7c7b\u578b\u53ef\u4ee5\u7528\u6765\u5b9e\u73b0\u6d88\u606f\u961f\u5217\uff0c\u5173\u4e8eStreams</p> <ul> <li>Streams\u53ef\u4ee5\u4e3a\u6d88\u606f\u81ea\u52a8\u751f\u6210\u5168\u5c40\u552f\u4e00ID</li> <li>Streams\u4f1a\u81ea\u52a8\u7559\u5b58\u6d88\u606f\uff0c\u76f4\u5230\u6d88\u8d39\u8005\u4f7f\u7528XACK\u786e\u8ba4\u540e\uff0c\u518d\u5220\u9664\u6d88\u606f</li> <li>Streams\u652f\u6301\u963b\u585e\u5f0f\u6d88\u606f\u8bfb\u53d6</li> <li>\u6d88\u606f\u961f\u5217\u4e2d\u7684\u6d88\u606f\u4e00\u65e6\u88ab\u6d88\u8d39\u7ec4\u91cc\u7684\u4e00\u4e2a\u6d88\u8d39\u8005\u8bfb\u53d6\u4e86\uff0c\u5c31\u4e0d\u80fd\u518d\u88ab\u8be5\u6d88\u8d39\u7ec4\u5185\u7684\u5176\u4ed6\u6d88\u8d39\u8005\u8bfb\u53d6\u4e86\u3002</li> </ul> </li> <li> <p>2.Redis\u8fd0\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u8fd0\u7ef4\u4eba\u5458\u901a\u8fc7info memory \u67e5\u770b\u5230<code>mem_fragmentation_ratio</code>\u7684\u503c\u7b49\u4e8e2, Redis\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\u662f\u600e\u6837\u7684\uff1f</p> </li> </ul> <p><code>mem_fragmentation_ratio</code>\u5927\u4e8e 1.5\u3002\u8fd9\u8868\u660e\u5185\u5b58\u788e\u7247\u7387\u5df2\u7ecf\u8d85\u8fc7\u4e86 50%\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u5c31\u9700\u8981\u91c7\u53d6\u4e00\u4e9b\u63aa\u65bd\u6765\u964d\u4f4e\u5185\u5b58\u788e\u7247\u7387\u4e86\u3002</p> <ul> <li> <p>3.Redis\u4f7f\u7528RDB\u673a\u5236\u521b\u5efa\u5feb\u7167\uff0c\u5173\u4e8eRDB\u673a\u5236</p> <ul> <li>\u4f7f\u7528save\u547d\u4ee4\u751f\u6210RDB\u5feb\u7167\u65f6\uff0c\u662f\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u6267\u884c\u7684\uff0c\u4f1a\u963b\u585e\u4e3b\u7ebf\u7a0b</li> <li>RDB\u6587\u4ef6\u662fRedis\u5b9e\u4f8b\u7684\u955c\u50cf\uff0c\u7528RDB \u6587\u4ef6\u6062\u590d\u5b9e\u4f8b\u65f6\uff0c\u76f4\u63a5\u628aRDB\u6587\u4ef6\u52a0\u8f7d\u5230\u5185\u5b58\uff0c \u5c31\u53ef\u4ee5\u5feb\u901f\u6062\u590d\u4e86</li> <li>\u548cAOF\u6587\u4ef6\u76f8\u6bd4\uff0cRDB\u6587\u4ef6\u66f4\u5c0f\u4e00\u70b9</li> <li>bgsave \u521b\u5efa\u5feb\u7167\u65f6\uff0c\u4e3b\u7ebf\u7a0b\u80fd\u540c\u65f6\u5904\u7406\u8bfb\u5199\u8bf7\u6c42</li> </ul> </li> <li> <p>4.Redis\u4f7f\u7528AOF\u673a\u5236\u4fdd\u5b58\u6570\u636e\u64cd\u4f5c\u65f6\uff0c\u53ef\u4ee5\u91c7\u7528\u4e0d\u540c\u7684\u5199\u56de\u7b56\u7565\u3002\u5f53\u9700\u8981\u6709\u4e00\u5b9a\u7684\u6570\u636e\u53ef\u9760\u6027\uff0c\u540c\u65f6\u4e5f\u4e0d\u80fd\u5bf9Redis\u5b9e\u4f8b\u9020\u6210\u8f83\u5927\u963b\u585e\u7684\u8bdd\uff0c\u5e94\u8be5\u9009\u62e9\u5199\u56de\u7b56\u7565\uff1f everysec</p> <ul> <li>\u4f7f\u7528everysec\u65f6\uff0c\u4f1a\u4f7f\u7528\u5b50\u7ebf\u7a0b\u6765\u64cd\u4f5c\uff0c\u4e0d\u4f1a\u963b\u585e\u4e3b\u7ebf\u7a0b\u3002\u800c\u4f7f\u7528always\u65f6\uff0c\u662f\u4f7f\u7528\u4e3b\u7ebf\u7a0b\u6765\u64cd\u4f5c\uff0c\u6240\u4ee5\u4f1a\u963b\u585e\u4e3b\u7ebf\u7a0b</li> <li>always \u53ef\u9760\u6027\u9ad8\uff0c\u4f46\u4f1a\u963b\u585eRedis\u5b9e\u4f8b</li> <li>no \u57fa\u672c\u4e0d\u4f1a\u963b\u585eRedis\u5b9e\u4f8b\uff0c\u4f46\u662f\u5b95\u673a\u540e\uff0c\u4f1a\u4e22\u5931\u8f83\u591a\u7684\u65e5\u5fd7\u8bb0\u5f55</li> </ul> </li> <li> <p>5. \u73b0\u5728\uff0c\u6709\u4e00\u4e2aRedis\u5b9e\u4f8b\u6b63\u5728\u7ebf\u4e0a\u8fd0\u884c\uff0c\u5b83\u4f7f\u7528Hash\u7c7b\u578b\u4fdd\u5b58\u4e86\u4e00\u4e2akey\u4e3adevice\u7684Hash\u96c6\u5408\uff0c\u96c6\u5408\u4e2d\u4fdd\u5b58\u4e86500\u4e07\u6761\u8bb0\u5f55\u3002\u5728\u8fd9\u4e9b\u8bb0\u5f55\u4e2d\uff0c\u670920\u4e07\u6761\u8bb0\u5f55\u7684key\u662f\u4ee5\u201credis\u201d\u5f00\u5934\u7684\uff0c\u73b0\u5728\u60f3\u628a\u8fd9\u4e9b\u8bb0\u5f55\u8bfb\u53d6\u51fa\u6765\uff0c\u5e94\u8be5\u91c7\u7528 HSCAN  \u547d\u4ee4</p> <ul> <li>KEYS \u4f1a\u5f15\u8d77Redis\u5b9e\u4f8b\u963b\u585e\uff0c\u800c\u4e14KEYS\u65e0\u6cd5\u67e5\u8be2\u65e5Hash\u96c6\u5408\u4e2d\u7684\u8bb0\u5f55</li> <li>SCAN\u53ea\u80fd\u67e5\u8be2\u6574\u4e2a\u6570\u636e\u5e93\u4e2d\u7684key</li> <li>SSCAN\u662f\u7528\u6765\u626b\u63cf\u67e5\u8be2Set\u7c7b\u578b</li> </ul> </li> <li>6.\u5728\u4e3b\u4ece\u96c6\u7fa4\u4e2d\uff0c\u5f53\u4e3b\u5e93\u6536\u5230\u4ece\u5e93\u53d1\u9001\u7684<code>psync?-1</code>\u547d\u4ee4\u65f6\uff0c\u4ece\u5e93\u5e0c\u671b\u4e3b\u5e93\u6267\u884c\u7684\u64cd\u4f5c\u662f: \u8fdb\u884c\u5168\u91cf\u590d\u5236<ul> <li>\u589e\u91cf\u590d\u5236\u65f6\uff0c\u4ece\u5e93\u4f1a\u628a\u81ea\u5df1\u8bb0\u5f55\u7684\u4e3b\u5e93ID\u53d1\u7ed9\u4e3b\u5e93\uff0c\u6240\u4ee5psync\u547d\u4ee4\u4f1a\u5e26\u6709\u4e3b\u5e93ID</li> <li>\u7ed3\u675f\u6570\u636e\u590d\u5236\u64cd\u4f5c\uff1a \u4e0d\u4f1a\u53d1\u9001psync</li> <li>\u65ad\u5f00\u7f51\u7edc\u8fde\u63a5\uff1a  \u4e0d\u4f1a\u53d1\u9001psync</li> </ul> </li> <li>7. \u5173\u4e8e\u54e8\u5175\u673a\u5236<ul> <li>\u901a\u8fc7 pub/sub \u673a\u5236\uff0c\u54e8\u5175\u4e4b\u95f4\u53ef\u4ee5\u7ec4\u6210\u96c6\u7fa4\uff0c\u540c\u65f6\uff0c\u54e8\u5175\u53c8\u901a\u8fc7 INFO \u547d\u4ee4\uff0c\u83b7\u5f97\u4e86\u4ece\u5e93\u8fde\u63a5\u4fe1\u606f\uff0c\u4e5f\u80fd\u548c\u4ece\u5e93\u5efa\u7acb\u8fde\u63a5\uff0c\u5e76\u8fdb\u884c\u76d1\u63a7\u4e86\u3002</li> <li>\u54e8\u5175\u8fdb\u7a0b\u4f1a\u4f7f\u7528 PING \u547d\u4ee4\u68c0\u6d4b\u5b83\u81ea\u5df1\u548c\u4e3b\u3001\u4ece\u5e93\u7684\u7f51\u7edc\u8fde\u63a5\u60c5\u51b5\uff0c\u7528\u6765\u5224\u65ad\u5b9e\u4f8b\u7684\u72b6\u6001\u3002</li> <li>\u5982\u679c\u5728 <code>down-after-milliseconds</code> \u6beb\u79d2\u5185\uff0c\u4e3b\u4ece\u8282\u70b9\u90fd\u6ca1\u6709\u901a\u8fc7\u7f51\u7edc\u8054\u7cfb\u4e0a\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8ba4\u4e3a\u4e3b\u4ece\u8282\u70b9\u65ad\u8fde\u4e86\u3002</li> </ul> </li> <li>8. \u5728\u4f7f\u7528\u54e8\u5175\u673a\u5236\u5bf9\u53d1\u751f\u6545\u969c\u7684\u4e3b\u4ece\u96c6\u7fa4\u8fdb\u884c\u4e3b\u4ece\u5e93\u5207\u65f6\uff0c\u4f1a\u6d89\u53ca<ul> <li>\u4e3b\u5e93\u7684\u4e3b\u89c2\u4e0b\u7ebf\u53ea\u7528\u54e8\u5175\u81ea\u5df1\u5224\u65ad\u5c31\u884c\uff0c\u800c\u5ba2\u89c2\u4e0b\u7ebf\u9700\u8981\u591a\u4e2a\u54e8\u5175\u5171\u540c\u51b3\u5b9a\uff0c\u6240\u4ee5\u5224\u65ad\u4e3b\u5e93\u4e3b\u89c2\u4e0b\u7ebf\u8981\u65e9\u4e8e\u5224\u65ad\u5ba2\u89c2\u4e0b\u7ebf\u3002 \u4e3b\u4ece\u5e93\u5207\u6362\u65f6\uff0c\u65b0\u4e3b\u5e93\u662f\u7531\u54e8\u5175Leader\u6765\u786e\u5b9a\u7684\uff0c\u6240\u4ee5\uff0c\u54e8\u5175\u96c6\u7fa4\u9700\u8981\u5148\u9009\u51faLeader\uff0c\u518d\u786e\u5b9a\u65b0\u4e3b\u5e93\u3002</li> </ul> </li> <li>9.\u5728\u4f7f\u7528Redis Cluster\u65f6\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u53d1\u9001\u64cd\u4f5c\u8bf7\u6c42\u540e\uff0c\u6536\u5230\u4e86MOVED\u547d\u4ee4\uff0c\u6b64\u65f6\uff0cRedis Cluster\u53d1\u751f\u4e86\u4ee5\u4e0b \u54ea\u79cd\u60c5\u51b5\uff1f : \u8bf7\u6c42\u6570\u636e\u6240\u5728\u7684\u54c8\u5e0c\u69fd\u5df2\u7ecf\u8fc1\u79fb\u5230\u4e86\u5176\u4ed6\u5b9e\u4f8b</li> <li>10.\u5728Redis\u7684\u8bf8\u591a\u6570\u636e\u7c7b\u578b\u4e2d\uff0c\u4ee5\u4e0b\u54ea\u79cd\u6570\u636e\u7c7b\u578b\u5141\u8bb8\u63d2\u5165\u91cd\u590d\u7684\u5143\u7d20\uff1f<ul> <li>List: \u6b63\u786e\uff0c\u5141\u8bb8\u5199\u5165\u91cd\u590d\u5143\u7d20</li> <li>HyperLogLog, Set, Sorted Set \u4f1a\u5bf9\u5143\u7d20\u53bb\u91cd</li> <li>HyperLogLog \u662f\u4e00\u79cd\u7528\u4e8e\u7edf\u8ba1\u57fa\u6570\u7684\u6570\u636e\u96c6\u5408\u7c7b\u578b\uff0c\u5b83\u7684\u6700\u5927\u4f18\u52bf\u5c31\u5728\u4e8e\uff0c\u5f53\u96c6\u5408\u5143\u7d20\u6570\u91cf\u975e\u5e38\u591a\u65f6\uff0c\u5b83\u8ba1\u7b97\u57fa\u6570\u6240\u9700\u7684\u7a7a\u95f4\u603b\u662f\u56fa\u5b9a\u7684\uff0c\u800c\u4e14\u8fd8\u5f88\u5c0f\u3002</li> </ul> </li> <li>11.Redis\u6570\u636e\u5e93\u662f\u5c06\u4e0b\u5217\u54ea\u79cd\u6570\u636e\u7ed3\u6784\u4f5c\u4e3a\u5168\u5c40\u6570\u636e\u7ed3\u6784\u6765\u4fdd\u5b58\u6bcf\u4e00\u5bf9\u952e\u503c\u5bf9\uff1f<ul> <li>\u54c8\u5e0c\u8868</li> </ul> </li> <li>12 .\u5728Redis\u7684\u4e3b\u4ece\u5e93\u96c6\u7fa4\u4e2d\uff0c\u5982\u679c\u4e3b\u5e93\u5b95\u673a\u4e86\uff0c\u4ee5\u4e0b\u54ea\u4e2a\u673a\u5236\u53ef\u4ee5\u8ba9Redis\u5b9e\u73b0\u81ea\u52a8\u7684\u4e3b\u4ece\u5e93\u5207\u6362\uff1f  \u54e8\u5175\u673a\u5236<ul> <li>AOF\u91cd\u5199\u7528\u6765\u7cbe\u7b80\u8fc7\u5927\u7684AOF\u6587\u4ef6\uff0c\u52a0\u901fRedis\u5b9e\u4f8b\u6062\u590d\u3002</li> <li>RDB\u673a\u5236\u7528\u6765\u751f\u6210\u5feb\u7167\uff0c\u7528\u4e8e\u5b9e\u4f8b\u6062\u590d\u6216\u662f\u4e3b\u4ece\u5e93\u590d\u5236\u3002</li> <li>\u5207\u7247\u673a\u5236\u662f\u628a\u6570\u636e\u5206\u6563\u5230\u591a\u4e2a\u5b9e\u4f8b\u4fdd\u5b58\uff0c\u7528\u4e8e\u4fdd\u5b58\u5927\u91cf\u6570\u636e\u3002</li> </ul> </li> <li>13.\u4ee5\u4e0b\u54ea\u4e2a\u529f\u80fd\u662f\u7531Redis\u4e3b\u7ebf\u7a0b\u5b8c\u6210\u7684\uff1a  \u952e\u503c\u5bf9\u8bfb\u5199<ul> <li>UNLINK\u64cd\u4f5c\u662fRedis 4.0\u540e\u63d0\u4f9b\u7684\u540e\u53f0\u5f02\u6b65\u5220\u9664\u64cd\u4f5c\uff0c\u7531\u540e\u53f0\u5b50\u7ebf\u7a0b\u5b8c\u6210\u3002</li> <li>RDB\u751f\u6210\u662f\u4e3b\u7ebf\u7a0b\u901a\u8fc7fork\u521b\u5efa\u4e86\u5b50\u8fdb\u7a0b\u6765\u5b8c\u6210\u7684\u3002</li> <li>AOF\u91cd\u5199\u4e5f\u662f\u7531\u4e3b\u7ebf\u7a0b\u901a\u8fc7fork\u521b\u5efa\u4e86\u5b50\u8fdb\u7a0b\u6765\u5b8c\u6210\u7684</li> </ul> </li> <li>14. \u4ee5\u4e0b\u54ea\u4e9b\u60c5\u51b5\u4f1a\u5f15\u8d77Redis\u7684\u4e3b\u7ebf\u7a0b\u963b\u585e<ul> <li>Redis 3.0\u4e2d\uff0c\u5220\u9664\u4e00\u4e2a100\u4e07\u5143\u7d20\u7684Set\u96c6</li> <li>AOF\u5199\u56de\u7b56\u7565\u914d\u7f6e\u4e3aeverysec\uff0c\u540c\u65f6<code>no-appendfsync-on-rewrite</code>\u8bbe\u7f6e\u4e3a<code>no</code>\uff0cAOF\u91cd\u5199\u548cAOF\u5199\u56de\u4f1a\u7ade\u4e89\u78c1\u76d8IO\u8d44\u6e90\uff0c\u5bfc\u81f4AOF\u5199\u56de\u88ab\u963b\u585e\uff0c\u8fdb\u800c\u5bfc\u81f4\u4e3b\u7ebf\u7a0b\u4e5f\u88ab\u963b\u585e</li> <li>\u5927\u91cf\u952e\u503c\u5bf9\u540c\u65f6\u8fc7\u671f\u4f1a\u5f15\u53d1\u4e3b\u7ebf\u7a0b\u963b\u585e</li> </ul> </li> <li>15.RDB\u548cAOF\u662fRedis\u4f7f\u7528\u7684\u4e24\u79cd\u6301\u4e45\u5316\u673a\u5236\uff0c\u5173\u4e8e\u8fd9\u4e24\u79cd\u673a\u5236\uff0c\u4e0b\u9762\u7684\u54ea\u4e9b\u63cf\u8ff0\u662f\u6b63\u786e\u7684\uff1f<ul> <li>\u4f7f\u7528RDB\u8fdb\u884c\u5b9e\u4f8b\u6062\u590d\u7684\u901f\u5ea6\uff0c\u8981\u6bd4\u4f7f\u7528AOF \u8fdb\u884c\u6062\u590d\u7684\u901f\u5ea6\u5feb\u8ba4</li> <li>AOF\u65e5\u5fd7\u8bb0\u5f55\u662f\u7531\u4e3b\u7ebf\u7a0b\u5b8c\u6210\u7684</li> <li>AOF\u91cd\u5199\u673a\u5236\u53ef\u4ee5\u81ea\u52a8\u6e05\u7406AOF\u6587\u4ef6\uff0c\u4e0d\u7528\u624b\u52a8\u6e05\u7406</li> <li>Redis 4.0\u7248\u672c\u4e2d\u53ef\u4ee5\u4f7f\u7528RDB\u505a\u5feb\u7167\uff0c\u540c\u65f6\u4f7f \u7528AOF\u8bb0\u5f55\u4e24\u6b21\u5feb\u7167\u95f4\u7684\u64cd\u4f5c\u65e5\u5fd7</li> </ul> </li> <li>16.\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Hash\u548cSorted Set\u7ec4\u5408\u6765\u4fdd\u5b58\u65f6\u95f4\u5e8f\u5217\u6570\u636e\uff0c\u4ee5\u4e0b\u54ea\u4e9b\u529f\u80fd\u53ef\u4ee5\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u76f4\u63a5\u5728Redis\u5b9e\u4f8b\u4e0a\u5b8c\u6210\uff1f<ul> <li>\u67e5\u8be2\u67d0\u4e2a\u65f6\u523b\u7684\u6570\u636e</li> <li>\u67e5\u8be2\u67d0\u4e2a\u65f6\u95f4\u8303\u56f4\u5185\u7684\u6240\u6709\u6570\u636e</li> <li>\u67e5\u8be2\u6700\u65b0\u65f6\u523b\u7684\u6570\u636e</li> </ul> </li> <li>17.Redis\u7684Hash\u6570\u636e\u7c7b\u578b\uff0c\u662f\u91c7\u7528\u54c8\u5e0c\u8868/\u538b\u7f29\u5217\u8868\u4e24\u79cd\u7ed3\u6784\u4f5c\u4e3a\u5b83\u7684\u5e95\u5c42\u5b9e\u73b0\u7684\uff1f</li> <li>18.\u5173\u4e8eRedis Cluster\uff0c\u4e0b\u9762\u54ea\u4e2a\u63cf\u8ff0\u662f\u6b63\u786e\u7684\uff1f<ul> <li>Redis Cluster\u4e00\u5171\u670916384\u4e2a\u54c8\u5e0c\u69fd</li> <li>\u5ba2\u6237\u7aef\u9700\u8981\u7f13\u5b58\u54c8\u5e0c\u69fd\u548c\u5b9e\u4f8b\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u65e0\u6cd5\u76f4\u63a5\u901a\u8fc7\u54c8\u5e0c\u8ba1\u7b97\u5c31\u77e5\u9053\u6570\u636e\u5728\u54ea\u4e2a\u5b9e\u4f8b\uff0c\u53ea\u80fd\u77e5\u9053\u5728\u54ea\u4e2a\u54c8\u5e0c\u69fd</li> <li>Redis Cluster\u5c5e\u4e8e\u53ef\u6269\u5c55\u96c6\u7fa4\uff0c\u4e3b\u8981\u7528\u9014\u662f\u8ba9Redis\u6570\u636e\u5e93\u80fd\u591f\u4fdd\u5b58\u66f4\u591a\u6570\u636e\u8ba4</li> <li>Redis Cluster\u7684\u5b9e\u4f8b\u4e5f\u53ef\u4ee5\u914d\u7f6e\u4e3b\u4ece\u8282\u70b9\uff0c\u8fdb\u884c\u53ef\u9760\u6027\u4fdd\u8bc1</li> </ul> </li> <li>19.\u5728\u79d2\u6740\u573a\u666f\u4e0b\uff0c\u4f60\u53ef\u4ee5\u5728\u4e0b\u9762\u54ea\u4e2a\u73af\u8282\u5e94\u7528Redis\uff1a \u79d2\u6740\u5546\u54c1\u5e93\u5b58\u67e5\u8be2\u548c\u6263\u51cf</li> <li>20.\u5bf9\u4e8e\u5207\u7247\u96c6\u7fa4\u6765\u8bf4\uff0c\u6570\u636e\u503e\u659c\u662f\u9700\u8981\u5173\u6ce8\u7684\u95ee\u9898\uff0c\u4ee5\u4e0b\u54ea\u4e9b\u539f\u56e0\u4f1a\u5f15\u8d77\u6570\u636e\u503e\u659c\uff1f<ul> <li>\u5b58\u5728bigkey  /  \u6570\u636e\u5206\u5e03\u4e0d\u5747\u8861  / HashTag\u7684\u4f7f\u7528</li> </ul> </li> <li>21.\u5173\u4e8eRedis 6.0\u7684ACL\u63a7\u5236\u673a\u5236\u7684\u63cf\u8ff0<ul> <li>ACL\u652f\u6301\u4e0d\u540c\u7528\u6237\u7528\u4e0d\u540c\u5bc6\u7801\u767b\u5f55</li> <li>ACL\u652f\u6301\u5bf9\u5355\u4e2a\u547d\u4ee4\u8bbe\u7f6e\u8bbf\u95ee\u63a7\u5236\u89c4\u5219</li> <li>ACL\u53ef\u4ee5\u7981\u6b62\u5ba2\u6237\u7aef\u8c03\u7528\u6240\u6709\u547d\u4ee4\u64cd\u4f5c</li> <li>ACL\u4f7f\u7528\u6ce2\u6d6a\u7ebf\u8bbe\u7f6e\u88ab\u8bbf\u95ee\u63a7\u5236\u7684key: \u4f7f\u7528\u6ce2\u6d6a\u53f7<code>\u201c~\u201d</code>\u548c key \u7684\u524d\u7f00\u6765\u8868\u793a\u63a7\u5236\u8bbf\u95ee\u7684 key\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u6267\u884c\u4e0b\u9762\u547d\u4ee4\uff0c\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u7528\u6237 <code>normaluser</code>\u53ea\u80fd\u5bf9\u4ee5<code>\u201cuser:\u201d</code>\u4e3a\u524d\u7f00\u7684 key \u8fdb\u884c\u547d\u4ee4\u64cd\u4f5c\uff1a<code>ACL SETUSER normaluser ~user:* +@all</code></li> </ul> </li> <li>22.\u4e3a\u4e86\u4fdd\u8bc1\u6570\u636e\u5728\u4e3b\u4ece\u5e93\u95f4\u7684\u4e00\u81f4\u6027\uff0c\u6211\u4eec\u9700\u8981\u5c06\u6570\u636e\u7684\u8fc7\u671f\u65f6\u95f4\u8bbe\u7f6e\u4e3a\u7edd\u5bf9\u65f6\u95f4\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u54ea\u4e9b\u547d\u4ee4\u6765\u8fdb\u884c\u8bbe\u7f6e\uff1f<ul> <li>EXPIREAT \u548c PEXPIREAT\uff1a\u5b83\u4eec\u4f1a\u76f4\u63a5\u628a\u6570\u636e\u7684\u8fc7\u671f\u65f6\u95f4\u8bbe\u7f6e\u4e3a\u5177\u4f53\u7684\u4e00\u4e2a\u65f6\u95f4\u70b9\u3002</li> <li>EXPIRE / PEXIRE \u8be5\u547d\u4ee4\u8bbe\u7f6e\u76f8\u5bf9\u8fc7\u671f\u65f6\u95f4</li> </ul> </li> <li>23.\u4e0b\u9762\u8fd9\u4e9b\u5173\u4e8eRedis\u4e8b\u52a1\u673a\u5236\u7684\u63cf\u8ff0\uff0c\u54ea\u4e9b\u662f\u6b63\u786e\u7684\uff1f<ul> <li>Redis\u4e8b\u52a1\u53ef\u4ee5\u4fdd\u8bc1\u4e00\u81f4\u6027 /  Redis\u4e8b\u52a1\u65e0\u6cd5\u4fdd\u8bc1\u6301\u4e45\u6027</li> <li>Redis\u5728\u4e8b\u52a1\u4e2d\u6709\u547d\u4ee4\u8bed\u6cd5\u9519\u8bef\u65f6\uff0c\u65e0\u6cd5\u4fdd\u8bc1\u539f\u5b50\u6027\uff0c\u5176\u4ed6\u60c5\u51b5\u53ef\u4ee5\u4fdd\u8bc1</li> <li>Redis\u4e8b\u52a1\u53ef\u4ee5\u4fdd\u8bc1\u9694\u79bb\u6027</li> </ul> </li> <li>24.\u4e0b\u9762\u8fd9\u4e9b\u5173\u4e8eCodis\u96c6\u7fa4\u7684\u63cf\u8ff0\uff0c\u54ea\u4e9b\u662f\u6b63\u786e\u7684\uff1f<ul> <li>Codis proxy\u63a5\u6536\u5ba2\u6237\u7aef\u8bf7\u6c42\uff0c\u5e76\u8fdb\u884c\u8bf7\u6c42\u8f6c\u53d1</li> <li>Codis\u96c6\u7fa4\u53ef\u4ee5\u4f7f\u7528etcd\u4fdd\u5b58\u96c6\u7fa4\u5143\u6570\u636e</li> <li>Codis\u9ed8\u8ba4\u4f7f\u75281024\u4e2aSlot</li> <li>Codis\u652f\u6301\u5f02\u6b65\u8fc1\u79fb\uff0c\u662f\u4e3a\u4e86\u907f\u514d\u963b\u585e\u4e3b\u7ebf\u7a0b</li> </ul> </li> <li>25.\u5f53Redis\u7528\u4f5c\u7f13\u5b58\u65f6\uff0c\u5982\u679c\u540c\u65f6\u6709\u5927\u91cf\u6570\u636e\u5931\u6548: \u7f13\u5b58\u96ea\u5d29<ul> <li>\u7f13\u5b58\u51fb\u7a7f\u662f\u8868\u793a\u5355\u4e2a\u6216\u5c11\u91cf\u70ed\u70b9\u6570\u636e\u5931\u6548</li> <li>\u7a7f\u900f\u662f\u6307\u8bbf\u95ee\u7684\u6570\u636e\u65e2\u4e0d\u5728\u7f13\u5b58\uff0c\u4e5f\u4e0d\u5728\u6570\u636e\u5e93</li> <li>\u9898\u5e72\u6761\u4ef6\u4e0b\uff0c\u4f1a\u53d1\u751f\u7f13\u5b58\u96ea\u5d29\uff0c\u5bfc\u81f4\u5927\u91cf\u8bf7\u6c42\u53d1\u9001\u5230\u6570\u636e\u5e93\u5c42\uff0c\u7ed9\u6570\u636e\u5e93\u5c42\u5e26\u6765\u538b\u529b</li> </ul> </li> <li>26.\u5728\u4f7f\u7528Redis\u4f5c\u4e3a\u7f13\u5b58\u65f6\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u5e94\u7528\u7684\u8d1f\u8f7d\u662f\u5bf9\u4e00\u4e2a\u5927\u6570\u636e\u96c6\u4e2d\u7684\u6240\u6709\u6570\u636e\u626b\u63cf\u4e00\u904d\uff0c\u90a3\u4e48\u4f7f\u7528\u4e0b\u9762\u54ea\u79cd\u6570\u636e\u6dd8\u6c70\u7b56\u7565\u4f1a\u66f4\u52a0\u5408\u9002\uff1f<ul> <li>allkeys-Ifu</li> <li>allkeys-lru\uff1a \u8be5\u7b56\u7565\u6309\u6570\u636e\u8bbf\u95ee\u65f6\u6548\u6027\u8fdb\u884c\u7b5b\u9009\uff0c\u4f1a\u5bfc\u81f4\u521a\u88ab\u8bbf\u95ee\u7684\u6570\u636e\u6ede\u7559\u5728\u7f13\u5b58\uff0c\u65e0\u6cd5\u88ab\u53ca\u65f6\u6dd8\u6c70\uff0c\u9020\u6210\u7f13\u5b58\u6c61\u67d3</li> <li>allkeys-random\uff1a \u8be5\u7b56\u7565\u968f\u673a\u9009\u53d6\u6dd8\u6c70\u7684\u6570\u636e\uff0c\u4f1a\u9020\u6210\u7f13\u5b58\u6c61\u67d3</li> <li>noeviction\uff1a \u8be5\u7b56\u7565\u4e0d\u4f1a\u6dd8\u6c70\u6570\u636e</li> <li>LFU \u7f13\u5b58\u7b56\u7565\u662f\u5728 LRU \u7b56\u7565\u57fa\u7840\u4e0a\uff0c\u4e3a\u6bcf\u4e2a\u6570\u636e\u589e\u52a0\u4e86\u4e00\u4e2a\u8ba1\u6570\u5668\uff0c\u6765\u7edf\u8ba1\u8fd9\u4e2a\u6570\u636e\u7684\u8bbf\u95ee\u6b21\u6570\u3002\uff08Least frequent)</li> <li>LRU \u7b97\u6cd5\u7684\u5168\u79f0\u662f Least Recently Used\uff0c\u4ece\u540d\u5b57\u4e0a\u5c31\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u662f\u6309\u7167\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u539f\u5219\u6765\u7b5b\u9009\u6570\u636e\uff0c\u6700\u4e0d\u5e38\u7528\u7684\u6570\u636e\u4f1a\u88ab\u7b5b\u9009\u51fa\u6765\uff0c\u800c\u6700\u8fd1\u9891\u7e41\u4f7f\u7528\u7684\u6570\u636e\u4f1a\u7559\u5728\u7f13\u5b58\u4e2d</li> </ul> </li> <li>27 \u5f53Redis\u7528\u4f5c\u53ea\u8bfb\u7f13\u5b58\u65f6\uff0c\u5982\u679c\u6570\u636e\u53d1\u751f\u4e86\u4fee\u6539\uff0c\u4ee5\u4e0b\u54ea\u4e2a\u8bf4\u6cd5\u662f\u6b63\u786e\u7684\uff1f<ul> <li>\u5728\u5148\u5220\u9664\u7f13\u5b58\u503c\uff0c\u540e\u66f4\u65b0\u6570\u636e\u5e93\u65f6\uff0c\u5982\u679c\u6709\u5e76\u53d1\u8bfb\uff0c\u53ef\u4ee5\u4f7f\u7528\u5ef6\u8fdf\u53cc\u5220\uff0c\u6765\u5e94\u5bf9\u6570\u636e\u4e0d\u4e00\u81f4\u95ee\u9898</li> </ul> </li> <li>28 Redis\u7f13\u5b58\u4e00\u65e6\u53d1\u751f\u7f13\u5b58\u51fb\u7a7f\uff0c\u5c31\u4f1a\u5bfc\u81f4\u5927\u91cf\u8bf7\u6c42\u53d1\u9001\u5230\u6570\u636e\u5e93\u5c42\u8fdb\u884c\u5904\u7406\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6570\u636e\u5e93\u538b\u529b\u8fc7\u5927\u800c\u5d29\u6e83\uff0c \u4ee5\u4e0b\u54ea\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u5e94\u5bf9\u7f13\u5b58\u51fb\u7a7f\u95ee\u9898\uff0c\u7f13\u89e3\u6570\u636e\u5e93\u538b\u529b\uff1f<ul> <li>\u6570\u636e\u5e93\u9650\u6d41 / \u4e0d\u7ed9\u70ed\u70b9\u6570\u636e\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4</li> <li>\u51fb\u7a7f\u662f\u8868\u793a\u5355\u4e2a\u6216\u5c11\u91cf\u70ed\u70b9\u6570\u636e\u5931\u6548</li> </ul> </li> </ul>"},{"location":"chap4/12ES_rev/","title":"L12 ES \u671f\u672b\u8003\u8bd5","text":"<ul> <li>\u6839\u636e\u4f7f\u7528\u573a\u666f\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06Elasticsearch\u4e2d\u5b58\u50a8\u7684\u6570\u636e\u5206\u6210\u4ee5\u4e0b\u54ea\u4e24\u7c7b\uff1f</li> </ul> <p>\u4e00\u822c\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b58\u50a8\u5728Elasticsearch\u4e2d\u7684\u6570\u636e\u5206\u6210\u4e24\u5927\u7c7b\uff1aStatic data\u548cTime series data\u3002</p> <p>Static data\u7684\u589e\u957f\u76f8\u5bf9\u7f13\u6162\uff0c\u5982\u5546\u54c1\u5206\u7c7b\u548c\u5e93\u5b58\u4fe1\u606f\u3002\u800cTime series data\u589e\u957f\u65e5\u5fd7\u4fe1\u606f\u548c\u6307\u6807\u6570\u636e\u3002</p> <ul> <li> <p>\u901a\u8fc7ELK\u4ee5\u4e0b\u54ea\u4e9b\u7ec4\u4ef6</p> <ul> <li>Heatbeat\u4e3b\u8981\u7528\u6765\u641c\u96c6\u7f51\u7ad9\u7684uptime\u548cresponse time;</li> <li>Auditbeat\u4e3b\u8981\u7528\u6765\u5ba1\u8ba1\u7cfb\u7edf\u7528\u6237\u548c\u8fdb\u7a0b\u7684\u6d3b\u52a8\u4fe1\u606f\uff1b</li> <li>Metricbeat\u4e3b\u8981\u7528\u4e8e\u641c\u96c6\u670d\u52a1\u5668\u7684\u6307\u6807\u4fe1\u4fe1\u606f\uff1b</li> <li>Packetbeat\u53ef\u4ee5\u641c\u96c6\u7f51\u7edc\u6d41\u91cf\u4fe1\u606f\u3002</li> </ul> </li> <li> <p>Elasticsearch\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\uff0c\u76f8\u4e92\u4e4b\u95f4\u5982\u4f55\u8fdb\u884c\u901a\u4fe1</p> <ul> <li>Elasticsearh\u96c6\u7fa4\u5185\u7684\u8282\u70b9\u901a\u8fc79300\u7aef\u53e3\uff0c\u4ee5Transport API\u7684\u65b9\u5f0f\u8fdb\u884c\u8282\u70b9\u95f4\u901a\u4fe1\u3002</li> <li>\u5bf9\u5916\u5219\u901a\u8fc79200\u7aef\u53e3\uff0c\u4ee5REST API\u63d0\u4f9b\u5916\u90e8\u7a0b\u5e8f\u4e0e\u7528\u6237\u7684\u8bbf\u95ee\u3002</li> </ul> </li> <li> <p>Elasticsearch\u67e5\u8be2\u9ed8\u8ba4\u8fd4\u56de\u591a\u5c11\u6761\u7ed3\u679c\uff1f</p> <ul> <li>Elasticsearch\u7684\u67e5\u8be2\uff0c\u9ed8\u8ba4\u4f7f\u7528\u7b80\u5355\u610f\u4e49\u4e0a\u7684\u6d45\u5206\u9875\u3002from\u5b9a\u4e49\u4e86\u76ee\u6807\u6570\u636e\u7684\u504f\u79fb\u503c\uff0csize\u5b9a\u4e49\u5f53\u524d\u8fd4\u56de\u7684\u6570\u76ee\u3002</li> <li>\u9ed8\u8ba4from\u4e3a0, size\u4e3a10\uff0c\u5373\u6240\u6709\u7684\u67e5\u8be2\u9ed8\u8ba4\u4ec5\u4ec5\u8fd4\u56de\u524d10\u6761\u6570\u636e\u3002 </li> </ul> </li> <li> <p>Analyzer\u7531\u54ea\u51e0\u4e2a\u90e8\u5206\u6784\u6210\uff1f</p> <ul> <li>\u505a\u5168\u6587\u641c\u7d22\u5c31\u9700\u8981\u5bf9\u6587\u6863\u5206\u6790\u3001\u5efa\u7d22\u5f15\u3002</li> <li>\u4ece\u6587\u6863\u4e2d\u63d0\u53d6\u8bcd\u5143\uff08Token)\u7684\u7b97\u6cd5\u79f0\u4e3a\u5206\u8bcd\u5668\uff08Tokenizer)\uff0c\u5728\u5206\u8bcd\u524d\u9884\u5904\u7406\u7684\u7b97\u6cd5\u79f0\u4e3a\u5b57\u7b26\u8fc7\u6ee4\u5668\uff08Character Filter)\uff0c\u8fdb\u4e00\u6b65\u5904\u7406\u8bcd\u5143\u7684\u7b97\u6cd5\u79f0\u4e3a\u8bcd\u5143\u8fc7\u6ee4\u5668(Token Filter) , \u6700\u540e\u5f97\u5230\u8bcd\uff08Term)\uff0c\u6574\u4e2a\u5206\u6790\u7b97\u6cd5\u79f0\u4e3a\u5206\u6790\u5668\uff08Analyzer)  </li> <li>character filter / tokenizer / token filter </li> </ul> </li> <li> <p>\u5982\u679cElasticsearch\u96c6\u7fa4\u603b\u5171\u67095\u4e2a\u8282\u70b9\uff0c\u800c\u5176\u4e2d\u67093\u4e2a<code>master-eligible</code>\u8282\u70b9\uff0c\u90a3\u6211\u4eec\u9700\u8981\u5c06<code>minimum_master_nodes</code>\u8bbe\u7f6e\u6210\u591a\u5c11\uff1f 2</p> <ul> <li>\u5728Elasticsearch7\u4e4b\u524d\uff0c\u4e3a\u4e86\u9632\u6b62\u8111\u88c2\uff0c\u4e00\u4e2a\u57fa\u672c\u7684\u539f\u5219\u662f\uff1a</li> <li>\u9700\u8981\u5c06<code>minimum_master_nodes</code> \u8bbe\u7f6e\u6210 N/2+1\u3002N\u662f\u96c6\u7fa4\u4e2d<code>Master-eligible</code>\u8282\u70b9\u7684\u6570\u91cf\u3002\u5982\u679c\u5728\u96c6\u7fa4\u4e2d\u67093 Master-eligible\u8282\u70b9\u7684\u96c6\u7fa4\u4e2d\uff0c<code>minimum_master_nodes</code>\u5e94\u8be5\u88ab\u8bbe\u4e3a<code>3/2+1=2</code>(\u56db\u820d\u4e94\u5165\uff09\u3002</li> <li>\u5728\u65b0\u7248\u672c\u4e2d\uff0c\u8fd9\u4e2a\u53c2\u6570\u5df2\u7ecf\u88ab\u5e9f\u9664</li> </ul> </li> <li> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cElasticsearch\u4f1a\u6839\u636e\u54ea\u4e2a\u56e0\u7d20\uff0c\u51b3\u5b9a\u5c06\u6587\u6863\u5b58\u50a8\u5230\u5177\u4f53\u54ea\u4e2a\u5206\u7247\uff1f</p> <ul> <li>\u9ed8\u8ba4\u6839\u636e\u6587\u6863\u7684ID / \u53ef\u4ee5\u901a\u8fc7\u7528\u6237\u81ea\u884c\u7684\u6570\u503c </li> <li>\u6587\u6863\u521b\u5efa\u65f6\uff0cElasticsearch\u9700\u8981\u51b3\u5b9a\u5c06\u8fd9\u4e2a\u6587\u6863\u5b58\u50a8\u5728\u54ea\u4e00\u4e2a\u5206\u7247\u3002\u5b9e\u9645\u4e0a\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u4ee5\u4e0b\u516c\u5f0f\u51b3\u5b9a\u7684\uff1a<code>shard=hash(routing)%number_of_primary_shards</code></li> <li>routing\u662f\u4e00\u4e2a\u53ef\u53d8\u503c\uff0c\u9ed8\u8ba4\u662f\u6587\u6863\u7684<code>_id</code>\uff0c\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u6210\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u503c\u3002</li> <li>routing\u901a\u8fc7hash\u51fd\u6570\u751f\u6210\u4e00\u4e2a\u6570\u5b57\uff0c\u7136\u540e\u8fd9\u4e2a\u6570\u5b57\u518d\u9664\u4ee5<code>number_of_primary_shards</code>\uff08\u4e3b\u5206\u7247\u7684\u6570\u91cf\uff09\u540e\u5f97\u5230\u4f59\u6570\u3002</li> <li>\u8fd9\u4e2a\u5206\u5e03\u57280\u5230<code>number_of_primary_shards-1</code>\u4e4b\u95f4\u7684\u4f59\u6570\uff0c\u5c31\u662f\u6211\u4eec\u6240\u5bfb\u6c42\u7684\u6587\u6863\u6240\u5728\u5206\u7247\u7684\u4f4d\u7f6e\u3002</li> </ul> </li> <li> <p>\u5f53\u96c6\u7fa4\u72b6\u6001\u53d8\u4e3a\u9ec4\u8272\uff0c\u8bf4\u660e\u96c6\u7fa4\u51fa\u73b0\u4e86\u4ec0\u4e48\u95ee\u9898\uff1f</p> <ul> <li>\u6570\u636e\u6709\u4e22\u5931\u7684\u98ce\u9669 </li> <li>\u526f\u672c\u5206\u7247\u65e0\u6cd5\u5206\u914d </li> <li>\u5982\u679c\u96c6\u7fa4\u72b6\u6001\u4e3a\u9ec4\u8272\uff0c\u8bf4\u660e\uff1a<ul> <li>\u5206\u914d\u4e86\u6240\u6709\u4e3b\u5206\u7247\uff0c\u4f46\u81f3\u5c11\u7f3a\u5c11\u4e00\u4e2a\u526f\u672c\u3002</li> <li>\u6ca1\u6709\u6570\u636e\u4e22\u5931\uff0c\u4f46\u662f\u6b64\u65f6\u641c\u7d22\u7ed3\u679c\u4ecd\u5c06\u5b8c\u6574\uff0c\u6ca1\u6709\u4e22\u5931\u6570\u636e\u3002</li> <li>\u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\u5728\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u4f1a\u53d7\u5230\u5f71\u54cd\uff0c\u6211\u4eec\u5e94\u8be5\u5c06\u9ec4\u8272\u89c6\u4e3a\u5e94\u8be5\u63d0\u793a\u8c03\u67e5\u7684\u8b66\u544a\u3002\u5982\u679c\u66f4\u591a\u5206\u7247\u6d88\u5931\uff0c\u96c6\u7fa4\u53d8\u7ea2\uff0c\u5c31\u53ef\u80fd\u4f1a\u4e22\u5931\u6570\u636e\u3002</li> </ul> </li> </ul> </li> <li> <p>\u5f53\u96c6\u7fa4\u4e3b\u5206\u7247\u4e0d\u80fd\u5206\u914d\u65f6\uff0cElasticsearch\u96c6\u7fa4\u4f1a\uff1a</p> <ul> <li>\u96c6\u7fa4\u53d8\u7ea2 / \u90e8\u5206\u6570\u636e\u4e0d\u518d\u53ef\u7528 </li> <li>\u5982\u679c\u96c6\u7fa4\u72b6\u6001\u4e3a\u7ea2\u8272\uff0c\u8bf4\u660e\uff1a<ul> <li>\u81f3\u5c11\u4e00\u4e2a\u4e3b\u5206\u7247\u5206\u914d\u5931\u8d25\uff0c\u8fd9\u5c06\u5bfc\u81f4\u4e00\u4e9b\u6570\u636e\u4ee5\u53ca\u7d22\u5f15\u7684\u67d0\u4e9b\u90e8\u5206\u4e0d\u518d\u53ef\u7528\u3002</li> <li>\u5c3d\u7ba1\u5982\u6b64\uff0cElasticSearch\u8fd8\u662f\u5141\u8bb8\u6211\u4eec\u6267\u884c\u67e5\u8be2\uff0c\u81f3\u4e8e\u662f\u901a\u77e5\u7528\u6237\u67e5\u8be2\u7ed3\u679c\u53ef\u80fd\u4e0d\u5b8c\u6574\u8fd8\u662f\u6302\u8d77\u67e5\u8be2\uff0c\u5219\u7531\u5e94\u7528\u6784\u5efa\u8005\u81ea\u884c\u51b3\u5b9a</li> </ul> </li> </ul> </li> <li> <p>\u4ee5\u4e0b\u90a3\u4e9b\u67e5\u8be2\u5c5e\u4e8eElasticsearch\u7684Aggregation Query?</p> <ul> <li>Elasticsearch\u9664\u4e86\u5168\u6587\u68c0\u7d22\u4e4b\u5916\uff0c\u8fd8\u652f\u6301\u5404\u79cd\u805a\u5408\u7b97\u6cd5\u3002</li> <li>Aggregation\u5171\u5206\u4e3a\u4e09\u7c7b\uff1aMetric Aggregations\u3001Bucket Aggregations\u3001Pipeline Aggregations</li> </ul> </li> <li> <p>Elasticsearch\u67e5\u8be2\u901a\u8fc7\u54ea\u51e0\u4e2a\u53c2\u6570\u5b9e\u73b0\u5bf9\u641c\u7d22\u7ed3\u679c\u7684\u5206\u9875\uff1f</p> <ul> <li>Elasticsearch \u7684\u67e5\u8be2\u3002</li> <li>\u63d0\u4f9b\u591a\u79cd\u5206\u9875\u65b9\u5f0f\u3002\u201d\u6d45\u201c\u5206\u9875\u53ef\u4ee5\u7406\u89e3\u4e3a\u7b80\u5355\u610f\u4e49\u4e0a\u7684\u5206\u9875\u3002\u5b83\u7684\u539f\u7406\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u67e5\u8be2\u524d20\u6761\u6570\u636e\uff0c\u7136\u540e\u622a\u65ad\u524d10\u6761\uff0c\u53ea\u8fd4\u56de10-20\u7684\u6570\u636e\u3002\u8fd9\u6837\u5176\u5b9e\u767d\u767d\u6d6a\u8d39\u4e86\u524d10\u6761\u6570\u636e</li> <li>from \u5b9a\u4e49\u4e86\u76ee\u6807\u6570\u636e\u7684\u504f\u79fb\u503c\uff0csize\u5b9a\u4e49\u5f53\u524d\u8fd4\u56de\u7684\u6570\u76ee\u3002\u9ed8\u8ba4from\u4e3a0, size\u4e3a10\uff0c\u5373\u6240\u6709\u7684\u67e5\u8be2\u9ed8\u8ba4\u4ec5\u4ec5\u8fd4\u56de\u524d10 \u901a\u8fc7from\u548csize\u53ef\u4ee5\u5b9e\u73b0\u57fa\u7840\u7684\u6d45\u5206\u9875\u67e5\u8be2\u3002</li> </ul> </li> <li> <p>\u901a\u8fc7Elasticsearch\u63d0\u4f9b\u7684\u54ea\u4e00\u79cdAggregation\uff0c\u53ef\u4ee5\u6ee1\u8db3\u201c\u672c\u6708\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u7528\u6237\u8bbf\u95ee\u4e86\u7f51\u7ad9\u201d\u8fd9\u4e2a\u7edf\u8ba1\u9700\u6c42\uff1f  Cardinality Aggregation</p> <ul> <li>Terms Aggregation:\u805a\u5408\u5206\u7ec4\uff0c\u7c7b\u4f3c\u4e8esql\u4e2dgroup by\u3002\u4f8b\u5982\u53ef\u4ee5\u5c06\u65e5\u5fd7\u4fe1\u606f\u6309\u7167\u201cerror\" , \"warm\", \"info\u201d\u5206\u4e3a\u4e0d\u540c\u7684buckets</li> <li>Cardinality Aggregation:\u53bb\u91cd\uff0c\u7c7b\u4f3c\u4e8esql\u4e2ddistinct\uff0c\u7ed3\u679c\u4e3a\u5355\u4f4d\u6570\u91cf\uff0c\u5982\u67e5\u8be2\u5171\u6709\u591a\u5c11\u4e2a\u73ed\u7ea7\uff0c\u53ef\u4ee5\u4f7f\u7528Cadinality</li> <li>Percentile Ranks Aggregation\uff1a\u4e00\u4e2amulti-value\u6307\u6807\u805a\u5408\uff0c\u5b83\u901a\u8fc7\u4ece\u805a\u5408\u6587\u6863\u4e2d\u63d0\u53d6\u6570\u503c\u6765\u8ba1\u7b97\u4e00\u4e2a\u6216\u591a\u4e2a\u767e\u5206\u6bd4\u3002</li> <li>Value count aggregation:\u67e5\u770b\u67d0\u4e2a\u5b57\u6bb5\u4e00\u5171\u6709\u591a\u5c11\u4e2a\u4e0d\u4e00\u6837\u7684\u6570\u503c</li> </ul> </li> <li> <p>\u5982\u4f55\u53ef\u4ee5\u63d0\u9ad8Terms Aggregation\u7684\u7cbe\u786e\u5ea6\uff1f</p> <ul> <li>\u589e\u52a0<code>shard_size</code></li> <li>\u9898\u76ee\u89e3\u6790<code>Terms</code>\u805a\u5408\u5206\u6790\u4e0d\u51c6\u7684\u539f\u56e0\uff0c\u6570\u636e\u5206\u6563\u5728\u591a\u4e2a\u5206\u7247\u4e0a\uff0c\u800cCoordinating Node\u65e0\u6cd5\u83b7\u53d6\u6570\u636e\u5168\u8c8c\u3002<ul> <li>\u89e3\u51b3\u65b9\u68481: \u5f53\u6570\u636e\u91cf\u4e0d\u5927\u65f6\uff0c\u8bbe\u7f6ePrimary Shard\u4e3a1\uff0c\u5b9e\u73b0\u51c6\u786e\u6027\u80fd\u3002</li> <li>\u89e3\u51b3\u65b9\u68482:\u5728\u5206\u5e03\u5f0f\u6570\u9002\u5f53\u589e\u52a0<code>shard_size</code>\u53c2\u6570\uff0c\u63d0\u9ad8\u7cbe\u786e\u5ea6\u3002\u539f\u7406\uff1a\u6bcf\u6b21\u4eceShard\u4e0a\u989d\u5916\u591a\u83b7\u53d6\u6570\u636e\uff0c\u63d0\u5347\u51c6\u786e\u7387\u3002<code>Shard_Size</code>\u8bbe\u7f6e\u8fc7\u5927\uff0c\u4f1a\u8017\u8d39\u66f4\u591a\u7684\u8ba1\u7b97\u8d44\u6e90\u3002</li> </ul> </li> </ul> </li> <li> <p>\u5982\u4f55\u8bbe\u7f6e\u7d22\u5f15\u7684Mapping\uff0c\u4f7f\u5f97\u5f53\u5199\u5165\u7684\u6587\u6863\u5305\u542b\u4e86\u672a \u5b9a\u4e49\u7684\u5b57\u6bb5\u65f6\uff0c\u5199\u5165\u4f1a\u6700\u7ec8\u5931\u8d25\uff1a dynamic\u8bbe\u7f6e\u4e3astrict</p> <ul> <li>\u52a8\u6001\u6620\u5c04(dynamic: true): \u52a8\u6001\u6dfb\u52a0\u65b0\u7684\u5b57\u6bb5\uff08\u6216\u7f3a\u7701\uff09</li> <li>\u9759\u6001\u6620\u5c04(dynamic: false): \u5ffd\u7565\u65b0\u7684\u5b57\u6bb5\uff0c\u5728\u539f\u6709\u7684\u6620\u5c04\u57fa\u7840\u4e0a\uff0c\u5f53\u6709\u65b0\u7684\u5b57\u6bb5\u65f6\uff0c\u4e0d\u4f1a\u4e3b\u52a8\u7684\u6dfb\u52a0\u65b0\u7684\u6620\u5c04\u5173\u7cfb\uff0c\u53ea\u4f5c\u4e3a\u67e5\u8be2\u7ed3\u679c\u51fa\u73b0\u5728\u67e5\u8be2\u4e2d\u3002</li> <li>\u4e25\u683c\u6a21\u5f0f\uff08dynamic: strict)\uff1a\u5982\u679c\u9047\u5230\u65b0\u7684\u5b57\u6bb5\uff0c\u5c31\u629b\u51fa\u5f02\u5e38\u3002</li> </ul> </li> <li> <p>\u652f\u6301\u7684\u901a\u914d\u7b26\u662f\u201c\u201d\uff0c\u5b83\u5339\u914d\u4efb\u4f55\u5b57\u7b26\u5e8f\u5217(\u5305\u62ec\u7a7a\u5b57\u7b26\uff09\u8fd8\u6709\u201c\uff1f\u201d\uff0c\u5b83\u5339\u914d\u4efb\u4f55\u5355\u4ef7\u5b57\u7b26\u3002 \u6b64\u67e5\u8be2\u53ef\u80fd\u5f88\u6162\uff0c\u56e0\u4e3a\u5b83\u8981\u8fed\u4ee3\u591a\u4e2a\u9879\u3002\u7279\u522b\u662f\u901a\u914d\u7b26\u9879\u4e0d\u5e94\u4ee5\u901a\u914d\u7b26\"\"\u6216\u201c?\u201d\u5f00\u5934\u8fd9\u6837\u7684\u901a\u914d\u67e5\u8be2\u7684\u5f00\u9500\u5f88\u5927\uff0c\u4f1a\u5bf9\u751f\u4ea7\u73af\u5883\u9020\u6210\u6027\u80fd\u7684\u5f71\u54cd\u3002\u6240\u4ee5\u4e00\u5b9a\u8981\u8c28\u614e\u4f7f\u7528\u3002</p> </li> <li> <p>Elasticsearch\u7684Search template\u6709\u54ea\u4e9b\u597d\u5904\uff1f</p> <ul> <li>\u907f\u514d\u91cd\u590d\u4ee3\u7801 / \u51cf\u5c11\u51fa\u9519\u7684\u6982\u7387  / \u66f4\u52a0\u5bb9\u6613\u6d4b\u8bd5\u548c\u6267\u884c / \u53ea\u5141\u8bb8\u7528\u6237\u4f7f\u7528\u4e00\u4e9b\u9884\u5b9a\u4e49\u7684\u67e5\u8be2</li> </ul> </li> <li> <p>\u5173\u4e8eElasticsearch\u7684\u7236\u5b50\u6587\u6863\u5bf9\u8c61</p> <ul> <li>\u5b50\u6587\u6863\u5fc5\u987b\u88ab\u8def\u7531\u5230\u548c\u526f\u6587\u6863\u76f8\u540c\u7684\u5206\u7247 </li> <li>\u5373\u4f7f\u7236\u6587\u6863\u5e76\u4e0d\u5b58\u5728\uff0c\u4e5f\u53ef\u4ee5\u521b\u5efa\u5b50\u6587\u6863</li> </ul> </li> </ul> <p>Elasticsearch\u7ef4\u62a4\u4e86\u4e00\u4e2a\u7236\u6587\u6863\u548c\u5b50\u6587\u6863\u7684\u6620\u5c04\u5173\u7cfb\uff0c\u5f97\u76ca\u4e8e\u8fd9\u4e2a\u6620\u5c04\uff0c\u7236\u3001\u5b50\u6587\u6863\u5173\u8054\u67e5\u8be2\u64cd\u4f5c\u975e\u5e38\u5feb\u3002\u4f46\u662f\u8fd9\u4e2a\u6620\u5c04\u4e5f\u5bf9\u7236\u3001\u5b50\u6587\u6863\u5173\u7cfb\u6709\u4e2a\u9650\u5236\u6761\u4ef6\uff1a\u7236\u6587\u6863\u548c\u5176\u6240\u6709\u5b50\u6587\u6863\uff0c\u90fd\u5fc5\u987b\u8981\u5b58 \u50a8\u5728\u540c\u4e00\u4e2a\u5206\u7247\u4e2d\u3002\u800cElasticsearch\u7684\u7236\u5b50\u5173\u8054\u6587\u6863\u6709\u4ee5\u4e0b\u4f18\u70b9</p> <ul> <li>\u7236\u6587\u6863\u7684\u66f4\u65b0\u4e0d\u9700\u8981\u91cd\u65b0\u4e3a\u5b50\u6587\u6863\u91cd\u5efa\u7d22\u5f15\u3002</li> <li>\u5bf9\u5b50\u6587\u6863\u8fdb\u884c\u6dfb\u52a0\uff0c\u66f4\u6539\uff0c\u5220\u9664\u64cd\u4f5c\u5ba4\u4e0d\u4f1a\u5f71\u54cd\u7236\u6587\u6863\u6216\u8005\u5176\u4ed6\u5b50\u6587\u6863\u3002</li> <li> <p>\u5b50\u6587\u6863\u53ef\u4ee5\u88ab\u5f53\u505a\u67e5\u8be2\u8bf7\u6c42\u7684\u7ed3\u679c\u8fd4\u56de\u3002</p> </li> <li> <p>Elasticsearch\u7684\u9648\u8ff0</p> <ul> <li>\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u6211\u4eec\u5efa\u8bae\u4e3a\u6240\u6709\u7684\u7d22\u5f15\u90fd\u521b\u5efaAlias\uff0c\u8fd9\u6837\uff0c\u5c31\u53ef\u4ee5\u5f88\u7075\u6d3b\u7684\u5bf9\u7d22\u5f15\u8fdb\u884creindex\u7b49\u53d8\u66f4\u64cd\u4f5c\uff0c\u540c\u65f6\u53c8\u4e0d\u4f1a\u5bf9\u7ebf\u4e0a\u4e1a\u52a1\u4ea7\u751f\u5f71\u54cd\u3002</li> <li>\u76f8\u6bd4\u4e0e\u6bcf\u6b21\u5355\u6761\u63d2\u5165\u6570\u636e\uff0c\u4f7f\u7528Bulk API\u80fd\u591f\u51cf\u5c11\u7f51\u7edc\u8fde\u63a5\u7684\u5f00\u9500, \u56e0\u6b64\u80fd\u63d0\u5347\u6570\u636e\u5199\u5165\u7684\u6027\u80fd\u3002</li> <li>\u63d0\u9ad8Replica\u7684\u6570\u91cf\uff0c\u53ef\u4ee5\u63d0\u9ad8\u4e00\u4e2a\u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\u3002\u4f46\u662fReplica\u5e76\u4e0d\u63d0\u4f9b\u5907\u4efd\u7684\u673a\u5236\u3002</li> <li>Snapshot and restore\u6a21\u5757\u5141\u8bb8\u521b\u5efa\u5355\u4e2a\u7d22\u5f15\u6216\u8005\u6574\u4e2a\u96c6\u7fa4\u7684\u5feb\u7167\u5230\u8fdc\u7a0b\u4ed3\u5e93\u3002\u5728\u65e9\u671f\u7248\u672c\u91cc\u53ea\u652f\u6301\u5171\u4eab\u6587\u4ef6\u7cfb\u7edf\u7684\u4ed3\u5e93\uff0c\u4f46\u662f\u73b0\u5728\u901a\u8fc7\u5b98\u65b9\u7684\u4ed3\u5e93\u63d2\u4ef6\u53ef\u4ee5\u652f\u6301\u5404\u79cd\u5404\u6837\u7684\u540e\u53f0\u4ed3\u5e93\u3002 </li> <li>Elasticsearch\u4e3b\u5206\u7247\u6570\u5728\u7d22\u5f15\u521b\u5efa\u65f6\u786e\u5b9a\uff0c\u7d22\u5f15\u521b\u5efa\u540e\u4e0d\u80fd\u4fee\u6539\uff0c\u9664\u975e\u901a\u8fc7reindex API\u91cd\u65b0\u521b\u5efa\u3002\u6240\u4ee5\uff0c\u800c\u526f\u672c\u5206\u7247\u6570\u53ef\u4ee5\u5728\u4efb\u610f\u65f6\u95f4\u4fee\u6539</li> </ul> </li> </ul>"},{"location":"chap4/13istio_rev/","title":"L13 Istio\u9762\u8bd5","text":""},{"location":"chap4/13istio_rev/#_1","title":"\u4f20\u7edf\u6846\u67b6\u7ec4\u4ef6\u5b58\u5728\u7684\u95ee\u9898","text":"<ul> <li>\u5404\u79cd\u57fa\u7840\u7ec4\u4ef6\u7ef4\u62a4\u6210\u672c\u6bd4\u8f83\u9ad8\uff0c\u5355\u70b9\u98ce\u9669\u5b58\u5728\u3002</li> <li>\u5404\u8bed\u8a00\u5ba2\u6237\u7aef\u7279\u6027\u96be\u4ee5\u7edf\u4e00\uff0c\u7194\u65ad\u3001\u91cd\u8bd5\u7b49\u7279\u6027\u5b9e\u73b0\u9887\u6709\u4e0d\u540c\uff0c\u4e14\u4e0d\u80fd\u505a\u5230\u52a8\u6001\u7ebf\u4e0a\u8fdb\u884c\u8c03\u6574\u3002</li> <li>\u5ba2\u6237\u7aef\u7248\u672c\u8fed\u4ee3\u96be\u4ee5\u63a8\u52a8\u3002</li> <li>\u5fae\u670d\u52a1\u67d0\u4e9b\u80fd\u529b\u4e0a\u8ddf\u5176\u4ed6\u5927\u5382\u8fd8\u6709\u5dee\u8ddd\u3002</li> <li>\u4e0e\u793e\u533a\u3001\u4e91\u539f\u751f\u8ddd\u79bb\u8f83\u8fdc\uff0c\u914d\u5408\u5e38\u89c1\u7684\u5f00\u6e90\u9879\u76ee\u7d27\u5bc6\u5ea6\u8f83\u5dee\u3002</li> </ul>"},{"location":"chap4/13istio_rev/#service-mesh","title":"Service Mesh \u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u4e0a\u9762\u7684\u8fd9\u4e9b\u95ee\u9898\uff1a","text":"<ul> <li>\u63d0\u5347\u5fae\u670d\u52a1\u6cbb\u7406\u80fd\u529b\uff0c\u89c4\u8303\u7684\u5f15\u5165\u7cbe\u51c6\u7684\u7194\u65ad\u3001\u9650\u6d41\u3001\u6d41\u91cf\u7ba1\u7406\u7b49\u624b\u6bb5\u3002</li> <li>\u51cf\u5c11\u5ba2\u6237\u7aef\u7ef4\u62a4\u3001\u8fed\u4ee3\u7684\u6295\u5165\u3002</li> <li>\u63d0\u5347\u670d\u52a1\u95f4\u901a\u4fe1\u901f\u5ea6\u3002</li> <li>\u5177\u5907\u6545\u969c\u6ce8\u5165\u80fd\u529b\u3002</li> <li>\u5177\u5907\u52a8\u6001\u670d\u52a1\u8def\u7531\u8c03\u6574\u7684\u80fd\u529b\u3002</li> </ul>"},{"location":"chap4/13istio_rev/#istio","title":"\u8fc1\u79fb\u5230Istio\u7684\u57fa\u672c\u8981\u6c42","text":"<ul> <li>\u4fdd\u8bc1\u4e1a\u52a1\u65e0\u611f\u77e5\u8fc1\u79fb\uff0c\u4e0d\u53d8\u66f4\u4ee3\u7801</li> <li>\u4fdd\u8bc1\u53ef\u56de\u6eda</li> <li>\u4fdd\u8bc1\u9ad8\u53ef\u7528</li> <li>\u4fdd\u8bc1\u6027\u80fd\u65e0\u660e\u663e\u4e0b\u6ed1</li> <li>\u4fdd\u8bc1 Mesh \u5185\u7684\u670d\u52a1\u548c\u539f\u670d\u52a1\u53ef\u4ee5\u4e92\u76f8\u8bbf\u95ee</li> </ul>"},{"location":"chap4/13istio_rev/#istio_1","title":"\u670d\u52a1\u7f51\u683c\u548c Istio \u6982\u89c8","text":"<ul> <li>\u670d\u52a1\u7f51\u683c\u5982\u4f55\u5e2e\u52a9\u670d\u52a1\u4e4b\u95f4\u7684\u901a\u4fe1\u903b\u8f91: \u5c06\u903b\u8f91\u5206\u79bb\u5230\u57fa\u7840\u5b9e\u65bd\u5c42</li> <li>\u4ece\u5b8f\u89c2\u4e0a\u770b\uff0cIstio\u670d\u52a1\u7f51\u683c\u7531\u54ea\u4e24\u90e8\u5206\u7ec4\u6210: \u6570\u636e\u5e73\u9762\u548c\u63a7\u5236\u5e73\u9762</li> <li>\u670d\u52a1\u7f51\u683c\u7684\u4ee3\u7406\u4e5f\u53eb\u505a\u4ec0\u4e48: Sidecar</li> <li>Istio\u4e2d\u7684\u54ea\u4e2a\u7ec4\u4ef6\u53ef\u4ee5\u5c06YAML\u89c4\u5219\u8f6c\u6362\u4e3aEnvoy\u914d\u7f6e: Istiod</li> <li>\u4ece\u4e0b\u9762\u7684\u5217\u8868\u4e2d\u9009\u51fa\u5fae\u670d\u52a1\u67b6\u6784\u7684\u4e24\u4e2a\u597d\u5904\uff1f: \u53ef\u4f38\u7f29\u6027 &amp; \u66f4\u5c0f\u7684\u56e2\u961f</li> </ul>"},{"location":"chap4/13istio_rev/#_2","title":"\u4e3a\u4ec0\u4e48\u9700\u8981\u670d\u52a1\u7f51\u683c","text":"<ul> <li>\u4f7f\u7528\u6307\u6807\u8bc6\u522b\uff0c\u6027\u80fd\u548c\u53ef\u9760\u6027\u95ee\u9898</li> <li>\u5728Grafana\u7b49\u5de5\u5177\u4e2d\u5b9e\u73b0\u6307\u6807\u7684\u53ef\u89c6\u5316\uff1b\u8fd9\u8fdb\u4e00\u6b65\u5141\u8bb8\u6539\u53d8\u5e76\u4e0ePagerDuty\u6574\u5408</li> <li>\u4f7f\u7528Jaeger\u6216Zipkin\u5bf9\u670d\u52a1\u8fdb\u884c\u8c03\u8bd5\u548c\u8ffd\u8e2a</li> <li>\u57fa\u4e8e\u6743\u91cd\u548c\u8bf7\u6c42\u7684\u6d41\u91cf\u8def\u7531\uff0c\u91d1\u4e1d\u96c0\u90e8\u7f72\uff0cA/B\u6d4b\u8bd5</li> <li>\u6d41\u91cf\u955c\u50cf</li> <li>\u901a\u8fc7\u8d85\u65f6\u548c\u91cd\u8bd5\u63d0\u9ad8\u670d\u52a1\u7684\u5f39\u6027</li> <li>\u901a\u8fc7\u5728\u670d\u52a1\u4e4b\u95f4\u6ce8\u5165\u6545\u969c\u548c\u5ef6\u8fdf\u6765\u8fdb\u884c\u6df7\u6c8c\u6d4b\u8bd5</li> <li>\u68c0\u6d4b\u548c\u5f39\u51fa\u4e0d\u5065\u5eb7\u7684\u670d\u52a1\u5b9e\u4f8b\u7684\u65ad\u8def\u5668\u3002</li> </ul>"},{"location":"chap4/13istio_rev/#istlo","title":"Istlo\u7b80\u4ecb","text":"<p>Istio\u662f\u4e00\u4e2a\u670d\u52a1\u7f51\u683c\u7684\u5f00\u6e90\u5b9e\u73b0\u3002\u4ece\u5b8f\u89c2\u4e0a\u6765\u770bIstio\u652f\u6301\u4ee5\u4e0b\u529f\u80fd\u3002</p> <ul> <li>\u6d41\u91cf\u7ba1\u7406</li> <li>\u53ef\u89c2\u5bdf\u6027</li> <li>\u5b89\u5168\u6027</li> </ul>"},{"location":"chap4/13istio_rev/#istio_2","title":"Istio\u7ec4\u4ef6","text":"<p>\u6570\u636e\u5e73\u9762\uff1a</p> <p>\u670d\u52a1\u7f51\u683c\u4e2d\u7684\u6570\u636e\u5e73\u9762\u7531\u8d1f\u8d23\u8def\u7531\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u670d\u52a1\u53d1\u73b0\u3001\u5065\u5eb7\u68c0\u67e5\u548c\u6388\u6743/\u8ba4\u8bc1\u7684Envoy\u4ee3\u7406\u3002\u8fd9\u4e9b\u4ee3\u7406\u6bcf\u4e2a\u5b9e\u4f8b\u670d\u52a1\u5b9e\u4f8b\u8981\u8fb9\u8fd0\u884c\uff0c\u62e6\u622a\u6240\u6709\u4f20\u5165\u548c\u4f20\u51fa\u7684\u7528\u6237\u6d41\u91cf</p> <p>Envoy (data plane)</p> <ul> <li>High-performance proxy (C++)</li> <li>Injected next to application containers</li> <li>Intercepts all traffic for the service</li> <li>Pluggable extension model based on WebAssembly</li> </ul> <p>\u63a7\u5236\u5e73\u9762\uff1a</p> <p>\u670d\u52a1\u7f51\u683c\u4e2d\u7684\u63a7\u5236\u5e73\u9762\u63d0\u4f9b\u914d\u7f6e\u5e76\u63a7\u5236\u6570\u636e\u5e73\u9762\u3002</p> <p>\u5b83\u7531API\u548c\u5de5\u5177\u7ec4\u6210\u7528\u4e8e\u7ba1\u7406\u6570\u636e\u5e73\u9762\u884c\u4e3a\u3002</p> <p>\u670d\u52a1\u7f51\u683c\u8fd0\u7ef4\u53ef\u4ee5\u8bbf\u95ee\u63a7\u5236\u5e73\u9762\u4ee5\u914d\u7f6e\u670d\u52a1\u7f51\u683c\u4e2d\u7684\u6570\u636e\u5e73\u9762\u884c\u4e3a\u3002\u4f8b\u5982\uff0c\u5c06\u6d41\u91cf\u914d\u7f6e\u5e94\u7528\u4e8e\u63a7\u5236\u5e73\u9762\u7ffb\u8bd1\u914d\u7f6e\u5e76\u5c06\u5176\u63a8\u9001\u5230\u6570\u636e\u5e73\u9762</p> <p>Istiod (control plane)</p> <ul> <li>Service discovery</li> <li>Configuration</li> <li>Certificate management</li> <li>Converts YAML to Envoy-readable configuration<ul> <li>propagates it to all sidecars in the mesh</li> </ul> </li> </ul> <p>Envoy\uff1a</p> <p>Envoy\u4ee3\u7406\u662f\u4e2a\u73b0\u4ee3\u7684\u3001\u9ad8\u6027\u80fd\u8fb9\u7f18\u7684\u3001\u5c0f\u578b\u7684L7\u4ee3\u7406\u3002Envoy\u662f\u4e3a\u5927\u578b\u73b0\u4ee3\u9762\u5411\u670d\u52a1\u67b6\u6784\u8bbe\u8ba1\u7684\u3002\u5b83\u53ef\u4ee5\u4e0eNginx\u548cHAproxy\u7b49\u8f6f\u4ef6\u8d1f\u622a\u5747\u8857\u5668\u76f8\u5ab2\u7f8e\u3002</p>"},{"location":"chap4/13istio_rev/#_3","title":"\u53ef\u89c2\u5bdf\u6027\uff1a\u9065\u6d4b\u548c\u65e5\u5fd7","text":"<p>Istio\u751f\u6210\u4e09\u79cd\u7c7b\u578b\u7684\u9065\u6d4b\u6570\u636e\uff0c\u4e3a\u7f51\u683c\u4e2d\u7684\u670d\u52a1\u63d0\u4f9b\u53ef\u89c2\u5bdf\u6027\uff1a</p> <ul> <li>\u6307\u6807\u5ea6\u91cf\uff08Metric)</li> <li>\u5206\u5e03\u5f0f\u8ffd\u8e2a</li> <li>\u8bbf\u95ee\u65e5\u5fd7</li> </ul> <p>\u6307\u6807</p> <p>Istlo\u57fa\u4e8e\u56db\u4e2a\u9ec4\u91d1\u4fe1\u53f7\u751f\u6210\u6307\u6807\uff1a\u5ef6\u8fdf\u3001\u6d41\u91cf\u3001\u9519\u8bef\u548c\u9971\u548c\u5ea6\u3002</p> <ul> <li>Latency: the time it takes to service a request</li> <li>Traffic: how much demand is placed on the system</li> <li>Errors: rate of failed requests</li> <li>Saturation: how full the most constrained resources of service are</li> </ul> <p>Zipkin\uff1a Trace and spans</p> <ul> <li>Trace: collection of spans</li> <li>Span: name, start/finish timestamp, tags, context</li> <li>Tags: applied to all spans, used for querying/filtering</li> <li>Spans are sent to the collector to validate, index &amp; store the data</li> </ul> <p>Distributed Tracing with Zipkin</p> <ul> <li>Zipkin = distributed tracing system</li> <li>Discover latency and performance issues</li> <li>Requirements: propagate HTTP headers (B3 and Envoy request ID)<ul> <li>Traces captured at service boundaries</li> </ul> </li> <li> <p>Instrument your applications</p> </li> <li> <p>Prometheus\u662f\u7528\u6765\u505a\u4ec0\u4e48\u7684\uff1a\u8bb0\u5f55\u6307\u6807\uff0c\u8ddf\u8e2aIstio\u548c\u7f51\u683c\u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u5065\u5eb7\u72b6\u51b5</p> </li> <li>\u4ec0\u4e48\u662fZipkin\uff1a \u5206\u5e03\u5f0f\u8ffd\u8e2a\u7cfb\u7edf</li> <li>\u4ec0\u4e48\u662fKiali\uff1a Istio\u53ef\u89c2\u6d4b\u6027\u9762\u677f</li> <li>Istio\u4f9d\u9760\u54ea\u4e9b\u5934\u4fe1\u606f\u6765\u8fdb\u884c\u5206\u5e03\u5f0f\u8ffd\u8e2a\uff1a B3 header\u548cEnvoy requestID</li> <li>\u4ec0\u4e48\u662fGrafana\uff1a Prometheus\u548c\u5176\u4ed6\u6765\u6e90\u7684\u6570\u636e\u7684\u53ef\u89c6\u5316\u5e73\u53f0</li> </ul>"},{"location":"chap4/13istio_rev/#_4","title":"\u6d41\u91cf\u7ba1\u7406","text":""},{"location":"chap4/13istio_rev/#gateway","title":"\u4f7f\u7528Gateway","text":"<ul> <li>\u4f7f\u7528\u5165\u53e3\u7f51\u5173\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u8fdb\u5165\u96c6\u7fa4\u7684\u6d41\u91cf\u5e94\u7528\u8def\u7531\u89c4\u5219\u3002\u6211\u4eec\u53ef\u4ee5\u6709\u4e00\u4e2a\u6307\u5411\u5165\u53e3\u7f51\u5173\u7684\u5355\u4e00\u5916\u90e8IP\u5730\u5740\uff0c\u5e76\u6839\u636e\u4e3b\u673a\u5934\u5c06\u6d41\u91cf\u8def\u7531\u5230\u96c6\u7fa4\u5185\u7684\u4e0d\u540c\u670d\u52a1\u3002</li> <li>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Gateway\u8d44\u6e90\u6765\u914d\u7f6e\u7f51\u5173\u3002\u7f51\u5173\u8d44\u6e90\u63cf\u8ff0\u4e86\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u66b4\u9732\u7aef\u53e3\u3001\u534f\u8bae\u3001SNI \uff08\u670d\u52a1\u5668\u540d\u79f0\u6307\u793a\uff09\u914d\u7f6e\u7b49\u3002</li> </ul> <p><code>kind: Gateway</code></p>"},{"location":"chap4/13istio_rev/#_5","title":"\u7b80\u5355\u8def\u7531","text":"<ul> <li>\u4f7f\u7528VirtualService\u8d44\u6e90\u5728Istio\u670d\u52a1\u7f51\u683c\u4e2d\u8fdb\u884c\u6d41\u91cf\u8def\u7531\u3002</li> <li>\u76ee\u7684\u5730\u6307\u7684\u662f\u4e0d\u540c\u7684\u5b50\u96c6\uff08subset\uff09\u6216\u670d\u52a1\u7248\u672c\u3002\u901a\u8fc7\u5b50\u96c6\uff0c\u6211\u4eec\u53ef\u4ee5\u8bc6\u522b\u5e94\u7528\u7a0b\u5e8f\u7684\u4e0d\u540c\u53d8\u4f53\u3002</li> <li> <p>\u6211\u4eec\u53ef\u4ee5\u5728\u4e00\u4e2a\u540d\u4e3aDestinationRule\u7684\u8d44\u6e90\u7c7b\u578b\u4e2d\u58f0\u660e\u5b50\u96c6,  Destination Rule\u4e2d\u7684\u6d41\u91cf\u7b56\u7565\u3002</p> <ul> <li>\u6211\u4eec\u53ef\u4ee5\u5728<code>trafficPolicy</code>\u5b57\u6bb5\u4e0b\u8bbe\u7f6e\u6d41\u91cf\u7b56\u7565\u8bbe\u7f6e: <code>kind: DestinationRule</code><ul> <li>Load balancer settings</li> <li>Connection pool settings</li> <li>Outlier detection</li> <li>Client TLS settings</li> <li>Port traffic policy</li> </ul> </li> </ul> </li> <li> <p>Load balancer settings</p> </li> </ul> <pre><code>trafficPolicy:\n   loadBalancer:\n    simple: ROUND_ROBIN\n</code></pre> <ul> <li>Connection pool settings</li> </ul> <pre><code>trafficPolicy:\n   connectionPool:\n    http:\n     http2MaxRequests: 50\n</code></pre> <ul> <li>\u5f02\u5e38\u70b9\u68c0\u6d4b</li> </ul> <p>\u5982\u679c\u4e00\u4e2a\u4e3b\u673a\u5f00\u59cb\u8fd4\u56de5xx HTTP\u9519\u8bef\uff0c\u5b83\u5c31\u4f1a\u5728\u9884\u5b9a\u7684\u65f6\u95f4\u5185\u88ab\u4ece\u8d1f\u8f7d\u5747\u8861\u6c60\u4e2d\u5f39\u51fa\u3002\u5bf9\u4e8eTCP\u670d\u52a1\uff0cEnvoy\u5c06\u8fde\u63a5\u8d85\u65f6\u6216\u5931\u8d25\u8ba1\u7b97\u4e3a\u9519\u8bef\u3002</p> <ul> <li>\u5ba2\u6237\u7aefTLS\u8bbe\u7f6e<ul> <li>\u5176\u4ed6\u652f\u6301\u7684TLS\u6a21\u5f0f\u6709DISABLE\uff08\u6ca1\u6709TLS\u8fde\u63a5\uff09,</li> <li>SIMPLE\uff08\u5728\u4e0a\u6e38\u7aef\u70b9\u53d1\u8d77TLS\u8fde\u63a5,\uff09</li> <li><code>ISTIO_MUTUAL</code>\uff08\u4e0eMUTUAL\u7c7b\u4f3c\uff0c\u4f7f\u7528Istio\u7684mTLS\u8bc1\u4e66\uff09</li> </ul> </li> </ul> <pre><code>trafficPolicy:\n  tls:\n   mode: MUTUAL\n   clientCertificate: /etc/certs/cert.pem\n   privateKey: /etc/certs/key.pem\n   caCertificates: /etc/certs/ca.pem\n</code></pre> <ul> <li>\u7aef\u53e3\u6d41\u91cf\u7b56\u7565</li> </ul> <pre><code>trafficPolicy:\n  portLevelSettings:\n  - port:\n    number: 80\n   loadBalancer:\n    simple: LEAST_CONN\n</code></pre> <ul> <li>\u5f39\u6027</li> </ul> <p>\u8fd9\u4e0d\u662f\u4e3a\u4e86\u907f\u514d\u6545\u969c\uff0c\u800c\u662f\u4ee5\u4e00\u79cd\u6ca1\u6709\u505c\u673a\u6216\u6570\u636e\u4e22\u5931\u7684\u65b9\u5f0f\u6765\u5e94\u5bf9\u6545\u969c\u3002\u5f39\u6027\u7684\u76ee\u6807 \u662f\u5728\u6545\u969c\u53d1\u751f\u540e\u5c06\u670d\u52a1\u6062\u590d\u5230\u4e00\u4e2a\u5b8c\u5168\u6b63\u5e38\u7684\u72b6\u6001</p> <ul> <li>Timeouts</li> <li>Retry policies</li> <li>Configurable on VirtualService</li> <li>Retries<ul> <li>Number of retries</li> <li>Timeout per try</li> <li>Conditions to retry o</li> </ul> </li> </ul> <p>\u4f7f\u670d\u52a1\u53ef\u7528\u7684\u4e00\u4e2a\u5173\u952e\u56e0\u7d20\u662f\u5728\u63d0\u51fa\u670d\u52a1\u8bf7\u6c42\u65f6\u4f7f\u7528\u8d85\u65f6\uff08timeout\uff09\u548c\u91cd\u8bd5\uff08retry\uff09\u7b56\u7565\u3002 \u6211\u4eec\u53ef\u4ee5\u5728Istio\u7684VirtualService\u4e0a\u914d\u7f6e\u8fd9\u4e24\u8005\u3002</p> <pre><code>...\n- route:\n  - destination:\n    host: customers.default.svc.cluster.local\n    subset: v1\n  timeout: 10s\n</code></pre> <p>\u91cd\u8bd5\u7b56\u7565</p> <pre><code>...\n- route:\n  - destination:\n    host: customers.default.svc.cluster.local\n    subset: v1\n  retries:\n   attempts: 10\n   perTryTimeout: 2s\n   retryOn: connect-failure,reset\n...\n</code></pre> <p>\u4e0a\u8ff0\u91cd\u8bd5\u7b56\u7565\u5c06\u5c1d\u8bd5\u91cd\u8bd5\u4efb\u4f55\u8fde\u63a5\u8d85\u65f6\uff08connect-failure)\u6216\u670d\u52a1\u5668\u5b8c\u5168\u4e0d\u54cd\u5e94 (reset)\u7684\u5931\u8d25\u8bf7\u6c42\u3002\u6211\u4eec\u5c06\u6bcf\u6b21\u5c1d\u8bd5\u7684\u8d85\u65f6\u65f6\u95f4\u8bbe\u7f6e\u4e3a2\u79d2\uff0c\u5c1d\u8bd5\u7684\u6b21\u6570\u8bbe\u7f6e\u4e3a10\u6b21\u3002</p> <ul> <li> <p>\u6545\u969c\u6ce8\u5165</p> <ul> <li>\u6709\u4e24\u79cd\u7c7b\u578b\u7684\u6545\u969c\u6ce8\u5165\u3002<ul> <li>\u6211\u4eec\u53ef\u4ee5\u5728\u8f6c\u53d1\u524d\u5ef6\u8fdf\uff08delay\uff09\u8bf7\u6c42\uff0c\u6a21\u62df\u7f13\u6162\u7684\u7f51\u7edc\u6216\u8fc7\u8f7d\u7684\u670d\u52a1\uff0c\u6211\u4eec\u53ef\u4ee5\u4e2d\u6b62\uff08abort) HTTP\u8bf7\u6c42\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u7279\u5b9a\u7684HTTP\u9519\u8bef\u4ee3\u7801\u7ed9\u8c03\u7528\u8005\u3002</li> <li>\u53ef\u9009\u7684\u5ef6\u8fdf</li> </ul> </li> </ul> </li> </ul> <pre><code>- route:\n  - destination:\n    host: customers.default.svc.cluster.local\n    subset: v1\n  fault:\n   abort:\n    percentage:\n     value: 30\n    httpStatus: 404\n</code></pre> <pre><code> fault:\n   delay:\n    percentage:\n     value: 5\n    fixedDelay: 3s\n</code></pre>"},{"location":"chap4/13istio_rev/#_6","title":"\u9ad8\u7ea7\u8def\u7531","text":"<p>Istio\u5141\u8bb8\u6211\u4eec\u4f7f\u7528\u4f20\u5165\u8bf7\u6c42\u7684\u4e00\u90e8\u5206\uff0c\u5e76\u5c06\u5176\u4e0e\u5b9a\u4e49\u7684\u503c\u76f8\u5339\u914d\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u5339\u914d\u4f20\u5165\u8bf7\u6c42\u7684URI\u524d\u7f00\uff0c\u5e76\u57fa\u4e8e\u6b64\u8def\u7531\u6d41\u91cf\u3002</p> <ul> <li>\u91cd\u5b9a\u5411\u548c\u91cd\u5199\u8bf7\u6c42</li> </ul> <pre><code>...\nhttp:\n  - match:\n   - headers:\n     my-header:\n      exact: hello\n   redirect:\n    uri: /hello\n    authority: my-service.default.svc.cluster.local:8000\n...\n</code></pre>"},{"location":"chap4/13istio_rev/#serviceentry","title":"ServiceEntry","text":"<p>\u901a\u8fc7ServiceEntry\u8d44\u6e90\uff0c\u6211\u4eec\u53ef\u4ee5\u5411Istio\u7684\u5185\u90e8\u670d\u52a1\u6ce8\u518c\u8868\u6dfb\u52a0\u989d\u5916\u7684\u6761\u76ee\uff0c\u4f7f\u4e0d\u5c5e\u4e8e\u6211\u4eec\u7f51\u683c\u7684\u5916\u90e8\u670d\u52a1\u6216\u5185\u90e8\u670d\u52a1\u770b\u8d77\u6765\u50cf\u662f\u6211\u4eec\u670d\u52a1\u7f51\u683c\u7684\u4e00\u90e8\u5206\u3002</p> <ul> <li>Add entries to Istio's service registry</li> <li>Use traffic routing, failure injection, and other features against external services</li> </ul> <p><code>kind: ServiceEntry</code></p> <pre><code>hosts:\n   - api.external-svc.com\n  ports:\n   - number: 443\n    name: https\n    protocol: TLS\n  resolution: DNS\n  location: MESH_EXTERNAL\n</code></pre>"},{"location":"chap4/13istio_rev/#workloadentry","title":"WorkloadEntry","text":"<ul> <li>Handle migration of VM workloads to Kubernetes</li> <li>Specify VM workloads and make them part of Istio's service registry</li> </ul> <p>\u5728<code>Workload Entry</code>\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a\u5728\u865a\u62df\u673a\u4e0a\u8fd0\u884c\u7684\u5de5\u4f5c\u8d1f\u8f7d\u7684\u7ec6\u8282\uff08\u540d\u79f0\u3001\u5730\u5740\u3001\u6807\u7b7e\uff09\uff0c\u7136\u540e\u4f7f\u7528<code>ServiceEntry</code>\u4e2d\u7684<code>workloadSelector</code>\u5b57\u6bb5\uff0c\u4f7f\u865a\u62df\u673a\u6210\u4e3aIstio\u5185\u90e8\u670d\u52a1\u6ce8\u518c\u8868\u7684\u4e00\u90e8\u5206\u3002</p>"},{"location":"chap4/13istio_rev/#sidecar","title":"Sidecar","text":"<p>Sidecar\u8d44\u6e90\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff0c\u4e00\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u9009\u62e9\u5668\u3001\u4e00\u4e2a\u5165\u53e3\uff08ingress)\u76d1\u542c\u5668\u548c\u4e00\u4e2a\u51fa\u53e3 (egress)\u76d1\u542c\u5668\u3002</p> <p>Sidecar Resource</p> <ul> <li>Proxies accept traffic on all ports</li> <li>Configure Sidecar to specific ports/services</li> <li>Three parts:<ul> <li>Workload selector</li> <li>Ingress listener</li> <li>Egress listener</li> </ul> </li> </ul> <p>\u5de5\u4f5c\u8d1f\u8f7d\u9009\u62e9\u5668\u51b3\u5b9a\u4e86\u54ea\u4e9b\u5de5\u4f5c\u8d1f\u8f7d\u4f1a\u53d7\u5230sidecar\u914d\u7f6e\u7684\u5f71\u54cd\u3002</p>"},{"location":"chap4/13istio_rev/#envoy-filter","title":"Envoy Filter","text":"<p>EnvoyFilter\u8d44\u6e90\u5141\u8bb8\u4f60\u5b9a\u5236\u7531Istio Pilot\u751f\u6210\u7684Envoy\u914d\u7f6e\u3002\u4f7f\u7528\u8be5\u8d44\u6e90\uff0c\u4f60\u53ef\u4ee5\u66f4\u65b0\u6570\u503c\uff0c\u6dfb\u52a0\u7279\u5b9a\u7684\u8fc7\u6ee4\u5668\uff0c\u751a\u81f3\u6dfb\u52a0\u65b0\u7684\u76d1\u542c\u5668\u3001\u96c6\u7fa4\u7b49\u7b49\u3002\u5c0f\u5fc3\u4f7f\u7528\u8fd9\u4e2a\u529f\u80fd\uff0c\u56e0\u4e3a\u4e0d\u6b63\u786e\u7684 \u5b9a\u5236\u53ef\u80fd\u4f1a\u7834\u574f\u6574\u4e2a\u7f51\u683c\u7684\u7a33\u5b9a\u6027\u3002</p> <p><code>kind: EnvoyFilter</code></p>"},{"location":"chap4/13istio_rev/#_7","title":"\u6d4b\u8bd5","text":"<ul> <li>\u6211\u4eec\u53ef\u4ee5\u7528\u4ec0\u4e48\u8d44\u6e90\u914d\u7f6eIstlo ingress gateway?  Gateway : istio: ingressgateway</li> <li>\u4f7f\u7528VirtualService\u8d44\u6e90\uff0c\u4f60\u53ef\u4ee5\u5c06\u6d41\u91cf\u8def\u7531\u5230Kubernetes\u5185\u90e8\u7684\u4e00\u4e2a\u7279\u5b9a\u670d\u52a1\u3002</li> <li>Istio ingress \u7f51\u5173\u662f\u4f5c\u4e3a\u54ea\u79cd\u670d\u52a1\u7c7b\u578b\u90e8\u7f72\u7684\uff1f: Loadbalancer</li> <li>\u4f60\u53ef\u4ee5\u5728\u54ea\u4e2a\u8d44\u6e90\u4e2d\u4e3aHTTP\u6d41\u91cf\u6307\u5b9a\u8def\u7531\u89c4\u5219\uff1f: VirtuaLService</li> <li>\u5982\u4f55\u5b9a\u4e49\u591a\u4e2a\u670d\u52a1\u7248\u672c\uff0c\u4ee5\u4fbf\u80fd\u591f\u5728\u5b83\u4eec\u4e4b\u95f4\u8fdb\u884c\u6d41\u91cf\u8def\u7531\uff1f\u4f7f\u7528Destination Rule\u548csubset</li> <li>\u5f53\u4f7f\u7528\u79bb\u7fa4\u68c0\u6d4b\u65f6\uff0c\u4e3b\u673a\u4f55\u65f6\u4f1a\u88ab\u4ece\u8d1f\u8f7d\u5747\u8861\u6c60\u4e2d\u5f39\u51fa\uff1f \u5f53\u8fd4\u56deHTTP 5xx\u9519\u8bef\u65f6</li> <li>\u5728\u79bb\u7fa4\u68c0\u6d4b\u914d\u7f6e\u4e2d\uff0c\u95f4\u9694\u8bbe\u7f6e\u6307\u7684\u662f\u4ec0\u4e48  \u626b\u63cf\u4e0a\u6e38\u4e3b\u673a\u65f6\u95f4\u7684\u95f4\u9694</li> <li>\u80fd\u5c06\u6d41\u91cf\u7b56\u7565\u5e94\u7528\u4e8e\u7279\u5b9a\u7684\u7aef\u53e3\u5417\uff1f: \u80fd <code>trafficPolicy: portLevelSettings: port</code></li> <li><code>ISTIO_MUTUAL</code>\u548c<code>MUTUAL TLS</code>\u6a21\u5f0f\u4e4b\u95f4\u6709\u4ec0\u4e48\u533a\u522b\uff1f <code>ISTIO_MUTUAL</code>\u5728mTLS\u4e2d\u4f7f\u7528Istio\u7684\u8bc1\u4e66\uff0c\u800c\u5728MUTUAL TLS\u4e2d\u4f60\u53ef\u4ee5\u7528\u4f60\u81ea\u5df1\u7684\u8bc1\u4e66<ul> <li><code>ISTIO_MUTUAL</code>\uff08\u4e0eMUTUAL\u7c7b\u4f3c\uff0c\u4f7f\u7528Istio\u7684mTLS\u8bc1\u4e66\uff09</li> </ul> </li> <li>\u6211\u4eec\u53ef\u4ee5\u53ea\u5728\u4e0a\u6e38\u670d\u52a1\u5668\u8fd4\u56de5xx\u54cd\u5e94\u4ee3\u7801\u65f6\u91cd\u8bd5\u8bf7\u6c42\uff0c\u6216\u8005\u53ea\u5728\u7f51\u5173\u9519\u8bef\uff08HTTP 5O2\u3001 503\u6216504\uff09\u65f6\u91cd\u8bd5\uff0c\u6216\u8005\u751a\u81f3\u5728\u8bf7\u6c42\u5934\u4e2d\u6307\u5b9a\u53ef\u91cd\u8bd5\u7684\u72b6\u6001\u4ee3\u7801\u3002</li> <li>\u5982\u679c\u4e00\u4e2a\u7aef\u70b9\u5931\u8d25\u5e76\u89e6\u53d1\u91cd\u8bd5\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48: \u5f53Envoy\u91cd\u8bd5\u8bf7\u6c42\u65f6\uff0c\u7aef\u70b9\u88ab\u4ece\u8d1f\u8f7d\u5747\u8861\u6c60\u4e2d\u6392\u9664 \u91cd\u8bd5\u548c\u8d85\u65f6\u90fd\u53d1\u751f\u5728\u5ba2\u6237\u7aef\u3002\u5f53Envoy\u91cd\u8bd5\u4e00\u4e2a\u5931\u8d25\u7684\u8bf7\u6c42\u65f6\uff0c\u6700\u521d\u5931\u8d25\u5e76\u5bfc\u81f4\u91cd\u8bd5\u7684\u7aef\u70b9\u5c31\u4e0d\u518d\u5305\u542b\u5728\u8d1f\u8f7d\u5747\u8861\u6c60\u4e2d\u4e86\u3002\u5047\u8bbeKubernetes\u670d\u52a1\u67093\u4e2a\u7aef\u70b9\uff08Pod)\uff0c\u5176\u4e2d\u4e00\u4e2a\u5931\u8d25\u4e86\uff0c \u5e76\u51fa\u73b0\u4e86\u53ef\u91cd\u8bd5\u7684\u9519\u8bef\u4ee3\u7801</li> <li>\u4f60\u80fd\u4e3a\u540c\u4e00\u4e2a\u8bf7\u6c42\u540c\u65f6\u6ce8\u5165\u5ef6\u8fdf\u548c\u4e2d\u6b62\u5417. \u662f</li> <li>\u8003\u8651\u5230\u4e0b\u9762\u7684\u7247\u6bb5\uff0c\u6709\u591a\u5c11\u767e\u5206\u6bd4\u7684\u8bf7\u6c42\u4f1a\u88ab\u4e2d\u6b62\uff1f \u5982\u679c\u6211\u4eec\u4e0d\u6307\u5b9a\u767e\u5206\u6bd4\uff0c\u6240\u6709\u7684\u8bf7\u6c42\u5c06\u88ab\u4e2d\u6b62</li> <li>\u6545\u969c\u6ce8\u5165\u662f\u5426\u89e6\u53d1\u91cd\u8bd5\u7b56\u7565\uff1f\u6ce8\u610f\uff0c\u6545\u969c\u6ce8\u5165\u5c06\u4e0d\u4f1a\u89e6\u53d1\u6211\u4eec\u5728\u8def\u7531\u4e0a\u8bbe\u7f6e\u7684\u4efb\u4f55\u91cd\u8bd5\u7b56\u7565\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u6ce8\u5165\u4e86\u4e00\u4e2aHTTP 500\u7684\u9519\u8bef\uff0c\u914d\u7f6e\u4e3aHTTP 500\u4e0a\u7684\u91cd\u8bd5\u7b56\u7565\u5c06\u4e0d\u4f1a\u88ab\u89e6\u53d1\u3002</li> <li>\u4f60\u53ef\u4ee5\u4f7f\u7528VirtualService\u4e2d\u7684\u54ea\u4e2a\u5b57\u6bb5\u5c06\u8bf7\u6c42\u91cd\u5b9a\u5411\u5230Kubernetes\u4e2d\u4e00\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u670d\u52a1\uff1f redirect</li> <li>\u4f60\u53ef\u4ee5\u4f7f\u7528\u54ea\u79cd\u8d44\u6e90\u6765\u4f7f\u5916\u90e8\u670d\u52a1\u6210\u4e3a\u4f60\u7684\u670d\u52a1\u7f51\u683c\u7684\u4e00\u90e8\u5206 ServiceEntry <ul> <li>\u901a\u8fc7ServiceEntry\u8d44\u6e90\uff0c\u6211\u4eec\u53ef\u4ee5\u5411Istio\u7684\u5185\u90e8\u670d\u52a1\u6ce8\u518c\u8868\u6dfb\u52a0\u989d\u5916\u7684\u6761\u76ee\uff0c\u4f7f\u4e0d\u5c5e\u4e8e\u6211\u4eec\u7f51\u683c\u7684\u5916\u90e8\u670d\u52a1\u6216\u5185\u90e8\u670d\u52a1\u770b\u8d77\u6765\u50cf\u662f\u6211\u4eec\u670d\u52a1\u7f51\u683c\u7684\u4e00\u90e8\u5206</li> </ul> </li> <li>Envoy sidecar\u68c0\u67e5ServiceEntry\u8d44\u6e90\u4e2d\u7684hosts\u5b57\u6bb5\u7684\u987a\u5e8f\u662f\u4ec0\u4e48.  HTTP\u3001 SNI\u3001 IP\u5730\u5740\u3001\u7aef\u53e3</li> <li>ServiceEntry\u8d44\u6e90\u4e2d\u7684workloadSelector\u5b57\u6bb5\u7684\u76ee\u7684\u662f\u4ec0\u4e48\uff1f\u8981\u9009\u62e9WorkloadEntry\u8d44\u6e90\uff0c\u4f7f\u865a\u62df\u673a\u6210\u4e3aIstio\u5185\u90e8\u670d\u52a1\u6ce8\u518c\u8868\u7684\u4e00\u90e8\u5206</li> <li>\u5982\u4f55\u914d\u7f6esidecar\u4ee3\u7406\uff0c\u4f7f\u5176\u53ea\u5bf9\u67d0\u4e9b\u670d\u52a1\u4f7f\u7528\u7279\u5b9a\u7684\u7aef\u53e3  \u4f7f\u7528Sidecar\u8d44\u6e90</li> <li>Sidecar\u8d44\u6e90\u4e2d\u7684Ingress\u548cegress\u76d1\u542c\u5668\u5b57\u6bb5\u7684\u76ee\u7684\u662f\u4ec0\u4e48   \u5b9a\u4e49\u54ea\u4e9b\u5165\u7ad9\uff0f\u51fa\u7ad9\u6d41\u91cf\u88absidecar\u63a5\u53d7<ul> <li>Workload selector </li> <li>Ingress listener </li> <li>Egress listener </li> </ul> </li> <li>EnvoyFilter\u8d44\u6e90\u5141\u8bb8\u4f60\u5b9a\u5236\u7531Istio Pilot\u751f\u6210\u7684Envoy\u914d\u7f6e</li> <li>\u5f53\u6709\u591a\u4e2aEnvoyFilter\u90e8\u7f72\u65f6\uff0c\u54ea\u4e9b\u8fc7\u6ee4\u5668\u4f1a\u5148\u88ab\u5e94\u7528  \u6839\uff08\u5982istio-system)\u547d\u540d\u7a7a\u95f4\u7684\u8fc7\u6ee4\u5668 \u6839\u547d\u540d\u7a7a\u95f4\uff08\u4f8b\u5982istio-system)\u4e2d\u7684\u8fc7\u6ee4\u5668\u9996\u5148\u88ab\u5e94\u7528\uff0c\u7136\u540e\u662f\u5de5\u4f5c\u8d1f\u8f7d\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u6240\u6709\u5339\u914d\u8fc7\u6ee4\u5668\u3002</li> <li>\u5982\u4f55\u5c06VirtualService\u4e0eGateway\u7ed1\u5b9a  \u4f7f\u7528gateways\u5b57\u6bb5</li> </ul> <pre><code>...\nkind: VirtualService\n...\nspec:\n  hosts:\n    - \"*\"\n  gateways:\n    - gateway\n</code></pre> <ul> <li>Destination Rule\u914d\u7f6e\u6d41\u91cf\u7b56\u7565</li> <li>\u5982\u679c\u4e00\u4e2a\u7aef\u70b9\u5931\u8d25\u5e76\u89e6\u53d1\u91cd\u8bd5\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48  \u5f53Envoy\u91cd\u8bd5\u8bf7\u6c42\u65f6\uff0c\u7aef\u70b9\u88ab\u4ece\u8d1f\u8f7d\u5747\u8861\u6c60\u4e2d\u6392\u9664</li> <li>\u4f60\u53ef\u4ee5\u7528Workload Entry\u8d44\u6e90\u505a\u4ec0\u4e48\uff1f\u5904\u7406\u865a\u62df\u673a\u5de5\u4f5c\u8d1f\u8f7d\u5411Kubernetes\u7684\u8fc1\u79fb</li> </ul>"},{"location":"chap4/13istio_rev/#istio-secuirty","title":"Istio Secuirty","text":""},{"location":"chap4/13istio_rev/#authentication","title":"\u8ba4\u8bc1(Authentication)","text":"<p>Authentication</p> <ul> <li>Principal = Kubernetes service</li> <li>Action = HTTP request methods (e.g. GET, POST, DELETE, ...)</li> <li>Object = Kubernetes service</li> <li>All about the principal (service identity)</li> <li>\"Validating a credential and ensuring it's both valid and trusted\"</li> </ul> <p>Identity</p> <ul> <li>Unique identity in Kubernetes = Kubernetes service account</li> <li>X.509 certificate (from SA) + SPIFFE spec = Identity<ul> <li>Naming scheme (spiffe://cluster.localinsidefault/sa/my-sa)</li> <li>Encoding names into X.509</li> <li>Validating the X.509 to authenticate the SPIFFE identity</li> </ul> </li> </ul>"},{"location":"chap4/13istio_rev/#_8","title":"\u8bc1\u4e66\u521b\u5efa\u548c\u8f6e\u6362","text":"<p>\u5bf9\u4e8e\u7f51\u683c\u4e2d\u7684\u6bcf\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\uff0cIstio\u63d0\u4f9b\u4e00\u4e2a<code>X.509</code>\u8bc1\u4e66\u3002</p> <p>\u4e00\u4e2a\u540d\u4e3a<code>pilot-agent</code>\u7684\u4ee3\u7406\u5728\u6bcf\u4e2aEnvoy\u4ee3\u7406\u65c1\u8fb9\u8fd0\u884c\uff0c\u5e76\u4e0e\u63a7\u5236\u5e73\u9762\uff08istiod\uff09\u4e00\u8d77\u5de5\u4f5c\uff0c\u81ea\u52a8\u8fdb\u884c\u5bc6\u94a5\u548c\u8bc1\u4e66\u7684\u8f6e\u8f6c\u3002</p> <p>Certificate creation</p> <ul> <li>Istio Agent</li> <li>Envoy's Secret Discovery Service(SDS)</li> <li>Citadel(part of the control plane)</li> </ul> <p>Istio Agent\u4e0eEnvoy sidecar\u4e00\u8d77\u5de5\u4f5c\u901a\u8fc7\u5b89\u5168\u5730\u4f20\u9012\u914d\u7f6e\u548c\u79d8\u5bc6\u5e2e\u52a9\u5b83\u4eec\u8fde\u63a5\u5230\u670d\u52a1\u7f51\u683c\u3002\u5373\u4fbfIstio\u4ee3\u7406\u5728\u6bcf\u4e2apod\u4e2d\u8fd0\u884c\u6211\u4eec\u4e5f\u8ba4\u4e3a\u5b83\u662f\u63a7\u5236\u5e73\u9762\u7684\u4e00\u90e8\u5206\u3002</p> <p>\u79d8\u94a5\u53d1\u73b0\u670d\u52a1(SDS)\u7b80\u5316\u4e86\u8bc1\u4e66\u7ba1\u7406\u3002\u5982\u679c\u6ca1\u6709SDS\u8bc1\u4e66\u5fc5\u987b\u4f5c\u4e3a\u79d8\u5bc6(Secret) \u521b\u5efa\uff0c\u7136\u540e\u88c5\u5165\u4ee3\u7406\u5bb9\u5668\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002</p> <p>\u6bcf\u5f53\u8bc1\u4e66\u8fc7\u671f\u65f6SDS\u4f1a\u63a8\u9001\u66f4\u65b0\u7684\u8bc1\u4e66Envoy\u53ef\u4ee5\u7acb\u5373\u4fbf\u7528\u5b83\u4eec\u3002\u4e0d\u9700\u8981\u91cd\u65b0\u90e8\u7f72\u4ee3\u7406\u670d\u52a1\u5668\u4e5f\u4e0d\u9700\u8981\u4e2d\u65ad\u6d41\u91cf\u3002</p>"},{"location":"chap4/13istio_rev/#peer-and-request-authentication","title":"Peer and Request Authentication(\u5bf9\u7b49\u8ba4\u8bc1\u548c\u8bf7\u6c42\u8ba4\u8bc1)","text":"<ul> <li>Peer authentication<ul> <li>Peer authentication</li> <li>service-to-service</li> </ul> </li> <li>All mTLS about the communication between services</li> <li>Request authentication<ul> <li>end user authentication</li> <li>uses JWTs</li> </ul> </li> </ul>"},{"location":"chap4/13istio_rev/#tls","title":"\u53cc\u5411TLS","text":"<p>Mutual TLS(mTLS)</p> <ul> <li>Traffic is re-routed through proxies</li> <li>Envoy starts an mTLS handshake<ul> <li>Secure naming check is done</li> </ul> </li> <li>Once mTLS connection is established:<ul> <li>Request is forwarded to server-side proxy</li> <li>Server-side forwards traffic to the workload</li> </ul> </li> </ul> <p>mTLS Behavior</p> <ul> <li>DISABLE: no TLS connection</li> <li>SIMPLE: originate to the upstream</li> <li>MUTUAL: uses mTLS and certs for auth</li> <li><code>ISTIO_MUTUAL</code>: like MUTUAL; but uses Istlo's certs for mTLS</li> </ul> <p>Permissive mode</p> <ul> <li>Allows services to accpet both plaintext and mTLS</li> <li>Improves mTLS onboarding experience</li> <li>Gradually Install/configure sidecars for mTLS</li> </ul>"},{"location":"chap4/13istio_rev/#_9","title":"\u6388\u6743","text":"<p>Authorization</p> <ul> <li>Can user A send a GET request to /hello on service B?</li> <li>Authn without authz (and vice-versa) is useless</li> <li>Control authenticated principals with AuthorizationPolicy</li> </ul> <p>Authorization policy</p> <ul> <li>Make use of identities extracted from PeerAuthentication and RequestAuthentication:<ul> <li>requestPrincipals (users)</li> <li>principals (service/peer)</li> </ul> </li> <li>Defined at mesh, namespace, and workload level</li> </ul> <p>Authorization policy</p> <ul> <li>Workloads policy applies to</li> <li>Action to take (deny, allow, or audit)</li> <li>Rules when to take action</li> </ul> <p>Istio\u5141\u8bb8\u6211\u4eec\u4f7f\u7528<code>AuthorizationPolicy</code>\u8d44\u6e90\u5728\u7f51\u683c\u3001\u547d\u540d\u7a7a\u95f4\u548c\u5de5\u4f5c\u8d1f\u8f7d\u5c42\u9762\u5b9a\u4e49\u8bbf\u95ee\u63a7\u5236\u3002<code>AuthorizationPolicy</code>\u652f\u6301DENY\u3001ALLOW\u3001 AUDIT\u548cCUSTOM\u64cd\u4f5c\u3002</p> <p><code>kind: AuthorizationPolicy</code></p>"},{"location":"chap4/13istio_rev/#_10","title":"\u5b89\u5168\u6d4b\u8bd5","text":"<ul> <li>\u5728\u901a\u4fe1\u65f6\uff0cEnvoy\u4ee3\u7406\u4f7f\u7528\u4ec0\u4e48\u4f5c\u4e3a\u51ed\u8bc1:  X509\u8bc1\u4e66<ul> <li>Validating the X.509 to authenticate the SPIFFE identity</li> </ul> </li> <li>\u54ea\u4e2a\u7ec4\u4ef6\u4e3a\u4e00\u4e2a\u670d\u52a1\u8d26\u6237\u521b\u5efaSPIFFE\u8eab\u4efd\uff1f Citadel<ul> <li>\u6bcf\u6b21\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u670d\u52a1\u8d26\u6237\u65f6, Citadel\u90fd\u4f1a\u4e3a\u5b83\u521b\u5efa\u4e00\u4e2aSPIFFE\u8eab\u4efd\u3002</li> </ul> </li> <li>\u4f60\u4f1a\u4f7f\u7528\u54ea\u79cd\u8d44\u6e90\u6765\u542f\u7528\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u4e25\u683cmTLS\u6a21\u5f0f\uff1f PeerAuthentication</li> <li>AuthorizationPolicy\u8d44\u6e90\u4e2d\u4f7f\u7528\u54ea\u4e24\u4e2a\u52a8\u4f5c\uff1f DENY\u548cALLOW<ul> <li>\u6bcf\u4e2aEnvoy\u4ee3\u7406\u5b9e\u4f8b\u90fd\u8fd0\u884c\u4e00\u4e2a\u6388\u6743\u5f15\u64ce\uff0c\u5728\u8fd0\u884c\u65f6\u5bf9\u8bf7\u6c42\u8fdb\u884c\u6388\u6743\u3002\u5f53\u8bf7\u6c42\u5230\u8fbe\u4ee3\u7406\u65f6\uff0c\u5f15\u64ce\u4f1a\u6839\u636e\u6388\u6743\u7b56\u7565\u8bc4\u4f30\u8bf7\u6c42\u7684\u4e0a\u4e0b\u6587\uff0c\u5e76\u8fd4\u56deALLOW\u6216DENY</li> </ul> </li> <li>\u5f53\u79d8\u5bc6\u53d1\u73b0\u670d\u52a1\uff08SDS)\u66f4\u65b0\u8bc1\u4e66\u65f6\uff0c\u662f\u5426\u9700\u8981\u91cd\u65b0\u90e8\u7f72\u4ee3\u7406\u4ee5\u4f7f\u7528\u65b0\u8bc1\u4e66\u3002 \u5426</li> <li>AUDIT\u52a8\u4f5c\u7684\u76ee\u7684\u662f\u4ec0\u4e48\uff1f \u8bb0\u5f55\u8bf7\u6c42<ul> <li>AUDIT\u52a8\u4f5c\u51b3\u5b9a\u662f\u5426\u8bb0\u5f55\u7b26\u5408\u89c4\u5219\u7684\u8bf7\u6c42\u3002\u6ce8\u610fAUDIT\u7b56\u7565\u5e76\u4e0d\u5f71\u54cd\u8bf7\u6c42\u88ab\u5141\u8bb8\u6216\u62d2\u7edd\u3002</li> </ul> </li> <li>\u4ec0\u4e48\u662f\u5141\u8bb8\u6a21\u5f0f\uff08permissive mode)?  \u4e00\u4e2a\u5141\u8bb8\u670d\u52a1\u540c\u65f6\u63a5\u53d7\u7eaf\u6587\u672c\u6d41\u6700\u548cmTLS\u6d41\u91cf\u7684\u9009\u9879</li> <li>\u662f\u5426\u53ef\u4ee5\u5728Istio\u4e2d\u4f7f\u7528JSON Web Tokens (JWTs)? \u662f</li> <li>\u9009\u62e9\u4e09\u4e2a\u8d1f\u8d35\u5728\u8fd0\u884c\u65f6\u521b\u5efa\u8eab\u4efd\u7684\u7ec4\u4ef6  Citedel \u3001 lstio Agent \u3001Envoys Secret Discovery Service</li> <li>Istlo Agent\u7684\u5de5\u4f5c\u662f\u4ec0\u4e48\uff1f  \u4e0eEnvoy sidecar\u5408\u4f5c\uff0c\u901a\u8fc7\u4e13\u9012\u914d\u7f6e\u548c\u79d8\u5bc6\uff0c\u5e2e\u52a9\u4ed6\u4eec\u94fe\u63a5\u5230Service mesh Istio Agent\u4e0eEnvoy sidecar\u4e00\u8d77\u5de5\u4f5c\u901a\u8fc7\u5b89\u5168\u5730\u4f20\u9012\u914d\u7f6e\u548c\u79d8\u5bc6\u5e2e\u52a9\u5b83\u4eec\u8fde\u63a5\u5230\u670d\u52a1\u7f51\u683c</li> <li>Istlo\u63d0\u4f9b\u54ea\u4e24\u79cd\u7c7b\u578b\u7684\u8ba4\u8bc1\uff1f  \u5bf9\u7b49\u548c\u8bf7\u6c42\u8ba4\u8bc1</li> <li>Istlo\u4ee3\u7406\u5c06\u5bc6\u94a5\u548c\u8bc1\u4e66\u5b58\u50a8\u5728\u54ea\u91cc\uff1f\u5185\u5b58  \u5c06\u5bc6\u94a5\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u6bd4\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u66f4\u5b89\u5168\uff1b<ul> <li>\u5728\u4f7f\u7528SDS\u65f6\uff0c\u7edd\u4e0d\u4f1a\u5c06\u4efb\u4f55\u5bc6\u94a5\u5199\u5165\u78c1\u76d8\u3002Istio\u4ee3\u7406\u8fd8\u5b9a\u671f\u5237\u65b0\u51ed\u8bc1\uff0c \u5728\u5f53\u524d\u51ed\u8bc1\u8fc7\u670b\u524d\u4eceCitadel\u68c0\u7d22\u4efb\u4f55\u65b0\u7684SVID(SPIFFE\u53ef\u9a8c\u8bc1\u8eab\u4efd\u6587\u4ef6\uff09</li> </ul> </li> <li>\u54ea\u79cd\u4ee3\u7406\u4e0eistiod\u4e00\u8d77\u5de5\u4f5c\uff0c\u4ee5\u5b9e\u73b0\u94a5\u5319\u548c\u8bc1\u4e66\u8f6e\u6362\u7684\u81ea\u52a8\u5316  pilot-agent<ul> <li>\u4e00\u4e2a\u540d\u4e3a<code>pilot-agent</code>\u7684\u4ee3\u7406\u5728\u6bcf\u4e2aEnvoy\u4ee3\u7406\u65c1\u8fb9\u8fd0\u884c\uff0c\u5e76\u4e0e\u63a7\u5236\u5e73\u9762\uff08istiod\uff09\u4e00\u8d77\u5de5\u4f5c\uff0c\u81ea\u52a8\u8fdb\u884c\u5bc6\u94a5\u548c\u8bc1\u4e66\u7684\u8f6e\u8f6c\u3002</li> </ul> </li> <li>\u5b89\u5168\u547d\u540d\u4fe1\u606f\u5305\u542b\u54ea\u4e9b\u5185\u5bb9\uff1f \u4ece\u670d\u52a1\u8eab\u4efd\u5230\u670d\u52a1\u540d\u79f0\u7684\u6620\u5c04</li> <li>\u5982\u679c\u4e00\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u6709\u591a\u4e2a\u7b56\u7565\uff0c\u54ea\u4e9b\u7b56\u7565\u4f1a\u5148\u88ab\u8bc4\u4f30\uff1f Deny \u7b56\u7565</li> <li>\u4f60\u5982\u4f55\u5728Istio\u4e2d\u542f\u7528\u6388\u6743\u529f\u80fd\uff1f  \u4e0d\u9700\u8981\u660e\u786e\u5730\u542f\u7528\u8be5\u529f\u80fd<ul> <li>\u6ca1\u6709\u5fc5\u8981\u660e\u786e\u5730\u542f\u7528\u6388\u6743\u529f\u80fd\u3002\u4e3a\u4e86\u6267\u884c\u8bbf\u95ee\u63a7\u5236\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6388\u6743\u7b56\u7565\u6765\u5e94\u7528\u4e8e\u6211\u4eec\u7684\u5de5\u4f5c\u8d1f\u8f7d <code>AuthorizationPolicy</code>\u8d44\u6e90\u662f\u6211\u4eec\u53ef\u4ee5\u5229\u7528<code>PeerAuthentication</code>\u7b56\u7565\u548c<code>RequestAuthentication</code>\u7b56\u7565\u4e2d\u7684\u4e3b\u4f53\u7684\u5730\u65b9\u3002</li> </ul> </li> <li>Istio\u5982\u4f55\u9a8c\u8bc1\u7528\u6237\uff0f\u8fdb\u7a0b\u7684\u8eab\u4efd  \u901a\u8fc7\u4ece\u8bf7\u6c42\u4e2d\u63d0\u53d6\u51ed\u8bc1</li> <li>\u4f60\u5982\u4f55\u5728\u6574\u4e2a\u7f51\u683c\u4e2d\u5f3a\u5236\u6267\u884c\u4e25\u683c\u7684mTLS\u6a21\u5f0f \u901a\u8fc7\u5c06PeerAuthentication\u8d44\u6e90\u90e8\u7f72\u5230\u6839\u547d\u540d\u7a7a\u95f4(Istlo system\uff09\u4e2d<ul> <li>\u6211\u4eec\u53ef\u4ee5\u521b\u5efaPeerAuthentication\u8d44\u6e90\uff0c\u9996\u5148\u5728\u6bcf\u4e2a\u547d\u540d\u7a7a\u95f4\u4e2d\u5206\u522b\u6267\u884c\u4e25\u683c\u6a21\u5f0f\u3002\u7136\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6839\u547d\u540d\u7a7a\u95f4\uff08\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u662fistio-system)\u521b\u5efa\u4e00\u4e2a\u7b56\u7565\uff0c\u5728\u6574\u4e2a\u670d\u52a1\u7f51\u683c\u4e2d\u6267\u884c\u8be5\u7b56\u7565\uff1a</li> </ul> </li> <li>\u5bf9\u7b49\u8ba4\u8bc1\u662f\u7528\u6765\u505a\u4ec0\u4e48\u7684:  \u670d\u52a1\u95f4\u8ba4\u8bc1</li> <li>\u679cKubernetes\u5de5\u4f5c\u8d1f\u8f7d\u6ca1\u6709Envoy\u4ee3\u7406\uff0cIstio\u662f\u5426\u4f1a\u53d1\u9001mTLS\u6d41\u91cf \u5426</li> <li>Authorization Policy\u8d44\u6e90\u4e2d\u7684selector\u548cmatchLabel\u5b57 \u6bb5\u6709\u4ec0\u4e48\u7528\u9014  \u8981\u9009\u62e9\u7b56\u7565\u9002\u7528\u7684\u5de5\u4f5c\u8d1f\u8f7d</li> </ul>"},{"location":"chap4/13istio_rev/#_11","title":"\u9ad8\u7ea7\u529f\u80fd\u6d4b\u8bd5","text":"<ul> <li>Istio\u5728\u7f51\u683c\u4e2d\u4f7f\u7528\u4ec0\u4e48\u4f5c\u4e3a\u79df\u6237\u5355\u4f4d: Namespace</li> <li>\u4f60\u4f7f\u7528\u54ea\u4e9b\u8d44\u6e90\u5c06\u865a\u62df\u673a\u5de5\u4f5c\u8d1f\u8f7d\u8fde\u63a5\u5230\u670d\u52a1\u7f51\u683c\uff1fWorkloadGroup \u548c WorkloadEntry<ul> <li>\u5de5\u4f5c\u8d1f\u8f7d\u7ec4(WorkloadGroup\u8d44\u6e90\uff09\u7c7b\u4f3c\u4e8eKubernetes \u4e2d\u7684\u90e8\u7f72(Deployments)\u5b83\u4ee3\u8868\u4e86\u5171\u4eab\u5171\u540c\u5c5e\u6027\u7684\u865a\u62df\u673a\u5de5\u4f5c\u8d1f\u8f7d\u7684\u903b\u8f91\u7ec4</li> <li>\u63cf\u8ff0\u865a\u62df\u673a\u5de5\u4f5c\u8d1f\u8f7d\u7684\u7b2c\u4e8c\u79cd\u65b9\u6cd5\u662f\u4f7f\u7528\u5de5\u4f5c\u8d1f\u8f7d\u6761\u76ee(WorkloadEntry\u8d44\u6e90\uff09\u3002\u5de5\u4f5c\u8d1f\u8f7d\u6761\u76ee\u7c7b\u4f3c\u4e8ePod\u5b83\u4ee3\u8868\u4e86\u4e00\u4e2a\u865a\u62df\u673a\u5de5\u4f5c\u8d1f\u8f7d\u7684\u5355\u4e00\u5b9e\u4f8b</li> </ul> </li> <li>\u4f60\u662f\u5426\u53ef\u4ee5\u901a\u8fc7\u5c06\u6240\u6709\u96c6\u7fa4\u4f5c\u4e3a\u8fdc\u7a0b\u96c6\u7fa4\u6765\u5b9e\u73b0\u63a7\u5236\u5e73\u9762\u548c\u6570\u636e\u5e73\u9762\u7684\u5b8c\u5168\u5206\u79bb\uff1f\u662f<ul> <li>\u53e6\u4e00\u79cd\u90e8\u7f72\u6a21\u5f0f\u662f\uff0c\u6211\u4eec\u628a\u6240\u6709\u7684\u96c6\u7fa4\u90fd\u89c6\u4e3a\u7531\u5916\u90e8\u63a7\u5236\u5e73\u9762\u63a7\u5236\u7684\u8fdc\u7a0b\u96c6\u7fa4\u3002\u8fd9\u4f7f\u6211\u4eec\u5728\u63a7\u5236\u5e73\u9762\u548c\u6570\u636e\u5e73\u9762\u4e4b\u95f4\u6709\u4e86\u5b8c\u5168\u7684\u5206\u79bb\u3002</li> </ul> </li> <li>Istio\u662f\u5982\u4f55\u89e3\u51b3\u4e0d\u540c\u79df\u6237\u4e4b\u95f4\u7684\u914d\u7f6e\u9694\u79bb\u7684: \u4e0d\u53ef\u884c<ul> <li>\u79df\u6237\u7684\u53e6\u4e00\u4e2a\u91cd\u8981\u529f\u80fd\u662f\u9694\u79bb\u4e0d\u540c\u79df\u6237\u7684\u914d\u7f6e\u3002\u76ee\u524d\uff0cIstio\u5e76\u6ca1\u6709\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4e0d\u8fc7\uff0c\u5b83\u901a\u8fc7\u5728\u547d\u540d\u7a7a\u95f4\u7ea7\u522b\u4e0a\u7684\u8303\u56f4\u914d\u7f6e\u6765\u5c1d\u8bd5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898</li> </ul> </li> <li>\u591a\u96c6\u7fa4\u90e8\u7f72\u7684\u76ee\u7684\u662f\u4ec0\u4e48\uff1f  \u4e3a\u4e86\u83b7\u5f97\u66f4\u5927\u7a0b\u5ea6\u7684\u9694\u79bb\u548c\u53ef\u7528\u6027\uff0e \u6700\u4f73\u7684\u591a\u96c6\u7fa4\u90e8\u7f72\u62d3\u6251\u7ed3\u6784\u662f\u6bcf\u4e2a\u96c6\u7fa4\u90fd\u6709\u81ea\u5df1\u7684\u63a7\u5236\u5e73\u9762\u3002\u5bf9\u4e8e\u6b63\u5e38\u7684\u670d\u52a1\u7f51\u683c\u90e8\u7f72\u89c4\u6a21\u5efa\u8bae\u4f60\u4f7f\u7528\u591a\u7f51\u683c\u90e8\u7f72\uff0c\u5e76\u6709\u4e00\u4e2a\u5355\u72ec\u7684\u7cfb\u7edf\u5728\u5916\u90e8\u534f\u8c03\u7f51\u683c\u3002</li> <li>\u4ec0\u4e48\u662f\u79df\u6237\uff1f \u79df\u6237\u662f\u4e00\u7ec4\u5171\u4eab\u5de5\u4f5c\u8d1f\u8f7d\u7684\u5171\u540c\u8bbf\u95ee\u6743\u548c\u6743\u9650\u7684\u7528\u6237\u3002\u79df\u6237\u4e4b\u95f4\u7684\u9694\u79bb\u662f\u901a\u8fc7\u7f51\u7edc\u914d\u7f6e\u548c\u7b56\u7565\u5b8c\u6210\u7684\u3002</li> <li>What does the shared control plane model involve?  \u591a\u4e2a\u96c6\u7fa4\u63a7\u5236\u5e73\u9762\u53ea\u5728\u4e00\u4e2a\u96c6\u7fa4\u4e2d\u8fd0\u884c\uff08\u4e3b\u96c6\u7fa4\uff09</li> <li>\u4ec0\u4e48\u88ab\u8ba4\u4e3a\u662f\u6700\u4f73\u7684\u591a\u96c6\u7fa4\u90e8\u7f72\u62d3\u6251\u7ed3\u6784\uff1f \u6bcf\u4e2a\u96c6\u7fa4\u90fd\u6709\u81ea\u5df1\u7684\u63a7\u5236\u5e73\u9762</li> <li>\u4e0d\u540c\u79df\u6237\u4e4b\u95f4\u7684\u9694\u79bb\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f \u4f7f\u7528\u7f51\u7edc\u914d\u7f6e\u548c\u7b56\u7565</li> <li>\u5de5\u4f5c\u8d1f\u8f7d\u5e94\u8be5\u5982\u4f55\u5728\u96c6\u7fa4\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\uff1f \u901a\u8fc7ingress gateway</li> </ul>"},{"location":"chap4/13istio_rev/#istio_3","title":"Istio \u95ee\u9898\u6392\u67e5","text":"<ul> <li><code>istioctl proxy-config</code>\u5217\u51fa\u76d1\u542c\u5668</li> <li>\u914d\u7f6e <code>istioctl validate -f myresource.yaml</code></li> <li>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u53e6\u4e00\u4e2a\u547d\u4ee4<code>istioctl analyze</code></li> <li><code>istioctl proxy-status</code></li> <li><code>istioctl dashboard controlz</code></li> <li>\u5982\u679c\u865a\u62df\u76d1\u542c\u5668\u627e\u4e0d\u5230\u8bf7\u6c42\u7684\u76ee\u7684\u5730\u4f1a\u600e\u6837  \u6839\u636eOutboundTrafficPolicy\u53d1\u9001\u6d41\u91cf</li> <li>\u4f60\u53ef\u4ee5\u4f7f\u7528\u54ea\u4e2aIstio CLI\u547d\u4ee4\u6765\u5217\u51fa\u6240\u6709\u76d1\u542c\u5668  <code>istiocti proxy-config listeners</code></li> <li>\u76d1\u542c\u5668\u4f7f\u7528\u54ea\u4e2a\u670d\u52a1\u6765\u5bfb\u627e\u8def\u7531\u914d\u7f6e  RDS(route discovery service)</li> <li>Envoy\u7684\u57fa\u672c\u6982\u5ff5\u662f\u4ec0\u4e48\uff1f  listener\u3001route\u3001cluster\u548cendpoint</li> <li>\u6bcf\u4e2asidecar\u90fd\u6709\u591a\u4e2a\u76d1\u542c\u5668\u751f\u6210\u3002\u6bcf\u4e2asidecar\u90fd\u6709\u4e00\u4e2a\u76d1\u542c\u5668\uff0c\u5b83\u88ab\u7ed1\u5b9a\u5230 0.0.0.0:15006</li> <li>Where are the circuit breakers defined In clusters configuration</li> <li>\u4ec0\u4e48\u7c7b\u578b\u7684\u6d41\u91cf\u4f1a\u88ab\u8def\u7531\u523015006\u7aef\u53e3 \u5165\u7ad9Pod\u6d41\u91cf</li> </ul>"},{"location":"chap4/14sre/","title":"L14 SRE\u672c\u8d28\u5c31\u662f\u4e00\u4e2a\u61c2\u8fd0\u7ef4\u7684\u8d44\u6df1\u5f00\u53d1","text":""},{"location":"chap4/14sre/#sre-7","title":"SRE \u7684 7 \u9879\u539f\u5219","text":"<p>SRE \u7684\u4e03\u9879\u539f\u5219\u5305\u62ec</p> <ul> <li>Embracing risk \u62e5\u62b1\u98ce\u9669</li> <li>Service level objectives \u670d\u52a1\u6c34\u5e73\u76ee\u6807 SLOs</li> <li>Eliminating toil \u6d88\u9664\u7410\u4e8b</li> <li>Monitoring \u76d1\u63a7</li> <li>Automation \u81ea\u52a8\u5316</li> <li>Release engineering \u53d1\u5e03\u5de5\u7a0b</li> <li>Simplicity \u7b80\u6d01\u6027</li> </ul>"},{"location":"chap4/14sre/#1","title":"1. \u62e5\u62b1\u98ce\u9669","text":"<p>SRE \u4f7f\u7528\u53ef\u7528\u6027\u6307\u6807\u6765\u8861\u91cf\u505c\u673a\u65f6\u95f4\u98ce\u9669\u7684\u53ef\u63a5\u53d7\u6027\u3002\u5728\u4e00\u4e2a\u6307\u6807\u4e2d\uff0c99.99% \u7684\u53ef\u9760\u5e74\u4efd\u5c06\u5305\u62ec 52.6 \u5206\u949f\u7684\u505c\u673a\u65f6\u95f4\u3002\u66f4\u590d\u6742\u7684\u6307\u6807\u4f1a\u8003\u8651\u67d0\u4e2a\u4f4d\u7f6e\u6216\u670d\u52a1\u7684\u4e00\u4e2a\u5143\u7d20\u53d1\u751f\u505c\u673a\u7684\u53ef\u80fd\u6027\uff0c\u800c\u5176\u4ed6\u90e8\u5206\u4ecd\u7136\u6b63\u5e38\u8fd0\u884c\u3002</p>"},{"location":"chap4/14sre/#2-slos","title":"2. \u670d\u52a1\u6c34\u5e73\u76ee\u6807 SLOs","text":"<p>\u786e\u5b9a\u76ee\u6807\u5e76\u8861\u91cf\u8fd9\u4e9b\u76ee\u6807\u7684\u5b9e\u73b0\u7a0b\u5ea6\u53ca\u5176\u539f\u56e0\u5bf9\u4e8e SRE \u56e2\u961f\u81f3\u5173\u91cd\u8981\u3002\u670d\u52a1\u6c34\u5e73\u76ee\u6807\uff08SLO\uff09\u662f\u4e00\u79cd\u5177\u4f53\u4e14\u53ef\u8861\u91cf\u7684\u76ee\u6807\uff0c\u4ee3\u8868\u4e86 SRE \u56e2\u961f\u8bbe\u5b9a\u7684\u8d28\u91cf\u6807\u51c6\u3002\u8fd9\u4e9b SLO \u53ef\u4ee5\u4ee5\u5404\u79cd\u6307\u6807\u7684\u5f62\u5f0f\u51fa\u73b0\uff0c\u4f46\u53ef\u7528\u6027\u3001\u67e5\u8be2\u901f\u7387\u3001\u9519\u8bef\u7387\u548c\u54cd\u5e94\u65f6\u95f4\u90fd\u662f\u5e38\u89c1\u7684\u6307\u6807</p> <p>\u8fd9\u4e9b\u76ee\u6807\u901a\u8fc7\u4f7f\u7528\u670d\u52a1\u7ea7\u522b\u6307\u6807\uff08SLI\uff09\u6765\u8861\u91cf\uff0cSLI \u662f\u5bf9\u6027\u80fd\u7684\u539f\u59cb\u6d4b\u91cf\uff0c\u4f8b\u5982\u5ef6\u8fdf\u3002</p> <ul> <li>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cSLI \u5c31\u662f\u5ef6\u8fdf\u6307\u6807\uff0c\u800c SLO \u5219\u662f\u8be5\u6307\u6807\u4fdd\u6301\u5728\u67d0\u4e2a\u9608\u503c\u4ee5\u4e0b\u3002</li> <li>SLO \u53ef\u4ee5\u6210\u4e3a\u670d\u52a1\u7ea7\u522b\u534f\u8bae\uff08SLA\uff09\u7684\u4e00\u90e8\u5206\uff0cSLA \u662f\u670d\u52a1\u63d0\u4f9b\u5546\u4e0e\u7528\u6237\u4e4b\u95f4\u7684\u5408\u540c\uff0c\u5176\u4e2d\u5217\u51fa\u4e86 SLO \u4ee5\u53ca\u672a\u80fd\u8fbe\u5230\u8fd9\u4e9b\u6307\u6807\u7684\u540e\u679c\u3002</li> </ul> <p>\u9009\u62e9\u670d\u52a1\u7ea7\u522b\u76ee\u6807\uff08SLO\uff09\u53ef\u80fd\u4f1a\u6709\u4e9b\u68d8\u624b\u3002\u7406\u60f3\u60c5\u51b5\u4e0b\uff0cSLO \u5e94\u8be5\u56f4\u7ed5\u7528\u6237\u6700\u5173\u5fc3\u7684\u5185\u5bb9\u6765\u6784\u5efa\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u4e91\u6e38\u620f\u670d\u52a1\uff0cSLO \u53ef\u80fd\u4f1a\u56f4\u7ed5\u4f4e\u5ef6\u8fdf\u6765\u6784\u5efa\uff0c\u4f46\u5bf9\u4e8e\u4f1a\u8ba1\u670d\u52a1\u6765\u8bf4\uff0c\u5ef6\u8fdf\u7684\u91cd\u8981\u6027\u5c31\u6ca1\u90a3\u4e48\u9ad8\u4e86\u3002</p>"},{"location":"chap4/14sre/#3","title":"3. \u6d88\u9664\u7410\u4e8b","text":"<p>SRE \u7684\u521b\u9020\u8005\u4eec\u660e\u786e\u5c06\u201c\u7410\u4e8b\u201d\u5b9a\u4e49\u4e3a\u4e00\u79cd\u52b3\u52a8\u7c7b\u522b\uff0c\u8fd9\u79cd\u52b3\u52a8\u4e0e\u5de5\u4f5c\u6709\u4ea4\u96c6\uff0c\u4f46\u5e76\u4e0d\u5b8c\u5168\u76f8\u540c\u3002\u7410\u4e8b\u6307\u7684\u662f\u90a3\u4e9b\u6309\u7ebf\u6027\u6269\u5c55\u7684\u624b\u52a8\u5de5\u4f5c\u4efb\u52a1\uff0c\u901a\u5e38\u662f\u624b\u52a8\u4e14\u91cd\u590d\u7684\uff0c\u5f80\u5f80\u53ef\u4ee5\u901a\u8fc7\u81ea\u52a8\u5316\u6765\u5b8c\u6210\u3002</p>"},{"location":"chap4/14sre/#4","title":"4. \u76d1\u63a7","text":"<ul> <li>\u5ef6\u8fdf\uff1a\u6700\u57fa\u7840\u7684\u6765\u8bf4\uff0c\u6ee1\u8db3\u4e00\u4e2a\u8bf7\u6c42\u9700\u8981\u591a\u957f\u65f6\u95f4\uff1f\u8bf7\u6ce8\u610f\uff0c\u8fd9\u53ef\u80fd\u4f1a\u6839\u636e\u8bf7\u6c42\u662f\u5426\u6210\u529f\u800c\u6709\u6240\u4e0d\u540c\uff1b\u6709\u65f6\u9519\u8bef\u6d88\u606f\u7684\u670d\u52a1\u65f6\u95f4\u53ef\u80fd\u4f1a\u663e\u8457\u66f4\u957f\u3002</li> <li>\u6d41\u91cf\uff1a\u670d\u52a1\u627f\u53d7\u4e86\u591a\u5c11\u8d1f\u8f7d\u6216\u9700\u6c42\uff1f\u5177\u4f53\u7684\u5355\u4f4d\u4f1a\u6709\u6240\u4e0d\u540c\uff1b\u53ef\u80fd\u662f\u9875\u9762\u6d4f\u89c8\u91cf\uff0c\u53ef\u80fd\u662f\u4ea4\u6613\u91cf\uff0c\u4e5f\u53ef\u80fd\u662f HTTP \u8bf7\u6c42\u3002</li> <li>\u9519\u8bef\uff1a\u901a\u5e38\u901a\u8fc7\u9519\u8bef\u7387\u6765\u8861\u91cf\uff0c\u9519\u8bef\u53ef\u80fd\u5305\u62ec\u83b7\u53d6\u9519\u8bef\u7684\u6570\u636e\u3001\u83b7\u53d6\u6570\u636e\u7684\u901f\u5ea6\u6bd4 SLA \u4e2d\u89c4\u5b9a\u7684\u8981\u6162\uff0c\u6216\u8005\u6839\u672c\u65e0\u6cd5\u83b7\u53d6\u6570\u636e\u3002</li> <li>\u9971\u548c\u5ea6\uff1a\u672c\u8d28\u4e0a\uff0c\u9971\u548c\u5ea6\u662f\u8861\u91cf\u670d\u52a1\u63a5\u8fd1\u5176\u5bb9\u91cf\u7684\u7a0b\u5ea6\u3002\u7406\u89e3\u9971\u548c\u5ea6\u5f88\u91cd\u8981\uff0c\u56e0\u4e3a\u5f53\u670d\u52a1\u63a5\u8fd1 100%\u9971\u548c\u5ea6\u65f6\uff0c\u4e00\u4e9b\u670d\u52a1\u53ef\u80fd\u4f1a\u5f00\u59cb\u5931\u6548\u3001\u53d8\u6162\u6216\u4ea7\u751f\u66f4\u591a\u7684\u9519\u8bef\u3002</li> </ul>"},{"location":"chap4/14sre/#5","title":"5. \u81ea\u52a8\u5316","text":"<p>\u5c31\u50cf\u73b0\u4ee3\u6280\u672f\u4e2d\u7684\u8bb8\u591a\u5176\u4ed6\u5143\u7d20\u4e00\u6837\uff0c\u5c06\u81ea\u52a8\u5316\u5f15\u5165\u5de5\u4f5c\u6d41\u7a0b\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u4f7f\u5de5\u7a0b\u5e08\u514d\u4e8e\u5904\u7406\u90a3\u4e9b\u4e0d\u589e\u52a0\u4ef7\u503c\u7684\u91cd\u590d\u6027\u4efb\u52a1\u3002\u6709\u4e86\u65b0\u62d3\u5c55\u7684\u81ea\u7531\u65f6\u95f4\uff0c\u5de5\u7a0b\u5e08\u4eec\u5c31\u53ef\u4ee5\u4e13\u6ce8\u4e8e\u81ea\u52a8\u5316\u65e0\u6cd5\u5b8c\u6210\u7684\u4efb\u52a1\uff1a\u521b\u4f5c\u3001\u521b\u610f\u3001\u5927\u89c4\u6a21\u6307\u5bfc\u4ee5\u53ca\u5176\u4ed6\u66f4\u591a\u5de5\u4f5c</p> <ul> <li>\u4e00\u81f4\u6027\uff1a\u91cd\u590d\u7684\u624b\u52a8\u4efb\u52a1\u4e0d\u4ec5\u4f1a\u8ba9\u4eba\u611f\u5230\u65e0\u804a\u5e76\u5360\u7528\u66f4\u6709\u4ef7\u503c\u7684\u65f6\u95f4\u3002\u5982\u679c\u50cf\u7528\u6237\u8d26\u6237\u521b\u5efa\u8fd9\u6837\u7684\u4efb\u52a1\u901a\u8fc7\u81ea\u52a8\u5316\u5de5\u5177\u5b8c\u6210\uff0c\u9519\u8bef\u548c\u4e0d\u4e00\u81f4\u6027\u53ef\u4ee5\u51e0\u4e4e\u88ab\u6d88\u9664\u3002\u65b0\u5458\u5de5\u53ef\u80fd\u4f1a\u4ee5\u4e0d\u540c\u4e8e\u8001\u5458\u5de5\u7684\u65b9\u5f0f\u505a\u4e8b\uff1b\u7528\u6237\u53ef\u80fd\u4f1a\u4e0d\u5c0f\u5fc3\u5728\u9519\u8bef\u7684\u5b57\u6bb5\u4e2d\u8f93\u5165\u503c\u3002\u800c\u81ea\u52a8\u5316\u6d41\u7a0b\uff08\u901a\u5e38\u60c5\u51b5\u4e0b\uff09\u4e0d\u4f1a\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u3002</li> <li>\u53ef\u6269\u5c55\u6027\uff1a\u81ea\u52a8\u5316\u662f\u53ef\u6269\u5c55\u6027\u7684\u4e00\u4e2a\u4e3b\u8981\u957f\u671f\u4f18\u52bf\u3002\u4ee5\u6211\u4eec\u4e4b\u524d\u7684\u7528\u6237\u8d26\u6237\u521b\u5efa\u4e3a\u4f8b\uff0c\u5982\u679c\u8d26\u6237\u521b\u5efa\u91cf\u5448\u6307\u6570\u589e\u957f\uff0c\u90a3\u4e48\u8d1f\u8d23\u8d26\u6237\u8bbe\u7f6e\u7684\u5458\u5de5\u7684\u5de5\u4f5c\u91cf\u4e5f\u4f1a\u5448\u6307\u6570\u589e\u957f\uff0c\u4ece\u800c\u5c06\u8fd9\u540d\u5458\u5de5\u4ece\u5176\u4ed6\u53ef\u80fd\u66f4\u6709\u4ef7\u503c\u7684\u5de5\u4f5c\u4e2d\u62bd\u79bb\u51fa\u6765\u3002\u800c\u81ea\u52a8\u5316\u7cfb\u7edf\u5219\u4e0d\u4f1a\u51fa\u73b0\u8fd9\u4e2a\u95ee\u9898\u3002</li> <li>\u901f\u5ea6\uff1a\u67d0\u4e9b\u4efb\u52a1\uff0c\u4f8b\u5982\u67e5\u627e\u548c\u4fee\u590d\u4ee3\u7801\u4e2d\u7684\u9519\u8bef\uff0c\u53ef\u80fd\u9700\u8981\u4eba\u5de5\u82b1\u8d39\u5927\u91cf\u65f6\u95f4\u3002\u81ea\u52a8\u5316\u8f6f\u4ef6\u7cfb\u7edf\u80fd\u591f\u76d1\u63a7\u5927\u91cf\u6570\u636e\uff0c\u5e76\u4e14\u5f80\u5f80\u80fd\u591f\u901a\u8fc7\u9ad8\u7ea7\u6a21\u5f0f\u8bc6\u522b\u548c\u5176\u4ed6\u5de5\u5177\u6bd4\u4eba\u7c7b\u66f4\u5feb\u5730\u68c0\u6d4b\u5230\u9519\u8bef\u3002\u4fee\u590d\u5de5\u4f5c\u4e5f\u53ef\u4ee5\u540c\u6837\u5feb\u901f\u5730\u5b8c\u6210\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u4efb\u4f55\u4eba\u5de5\u5e72\u9884</li> </ul>"},{"location":"chap4/14sre/#6","title":"6. \u53d1\u5e03\u5de5\u7a0b","text":"<ul> <li>\u81ea\u52a8\u5316\u548c\u81ea\u52a9\u670d\u52a1</li> <li>\u901f\u5ea6</li> <li>\u5c01\u95ed\u6784\u5efa</li> <li>\u6807\u51c6\u548c\u653f\u7b56</li> </ul>"},{"location":"chap4/14sre/#7","title":"7. \u7b80\u6d01\u6027","text":"<ul> <li>Infrastructure\uff1a\u4e3b\u8981\u8d1f\u8d23\u6700\u57fa\u7840\u7684\u786c\u4ef6\u8bbe\u65bd\uff0c\u7f51\u7edc\uff0c\u7c7b\u4f3c\u4e8e IaaS\uff0c\u505a\u7684\u4e8b\u60c5\u53ef\u53c2\u8003 DigitalOcean</li> <li>Platform\uff1a\u63d0\u4f9b\u4e2d\u95f4\u4ef6\u6280\u672f\uff0c\u5f00\u7bb1\u5373\u7528\u7684\u4e00\u4e9b\u670d\u52a1\uff0c\u7c7b\u4f3c\u4e8e PaaS\uff0c\u505a\u7684\u4e8b\u60c5\u53ef\u53c2\u8003 Heroku\uff0cGCP\uff0cAWS \u7b49</li> <li>\u4e1a\u52a1 SRE\uff1a\u7ef4\u62a4\u670d\u52a1\uff0c\u5e94\u7528\uff0c\u7ef4\u62a4\u4e1a\u52a1\u7684\u6b63\u5e38\u8fd0\u884c</li> </ul>"},{"location":"chap4/14sre/#1-infrastructure","title":"1 Infrastructure","text":"<p>Infrastructure \u548c Platform SRE \u5176\u5b9e\u53ef\u6709\u53ef\u65e0\uff0c\u8fd9\u4e9b\u5e74\u5546\u4e1a\u5316\u7684\u670d\u52a1\u5176\u5b9e\u8d8a\u6765\u8d8a\u591a\u4e86\uff0c\u6bd4\u5982\uff0c\u5982\u679c\u516c\u53f8\u9009\u62e9\u5168\u90e8\u5728 AWS \u90e8\u7f72\u81ea\u5df1\u7684\u670d\u52a1\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u4e0d\u9700\u8981\u81ea\u5df1\u5efa\u7acb Datacenter\uff0c\u7ef4\u62a4\u7f51\u7edc\u4e4b\u7c7b\u7684\u5de5\u4f5c\u4e86\uff0c\u53ea\u9700\u8981\u51e0\u4e2a AWS \u4e13\u5bb6\u5373\u53ef</p> <p>\u6211\u89c9\u5f97 Infrastructure SRE \u7684\u5de5\u4f5c\u5185\u5bb9\u53ef\u4ee5\u8fd9\u6837\u5b9a\u4e49\uff1a</p> <ul> <li>\u8d1f\u8d23\u670d\u52a1\u5668\u7684\u91c7\u8d2d\uff0c\u9884\u7b97\uff0cCMDB \u7ba1\u7406\u3002\u8981\u77e5\u9053\uff08\u80fd\u67e5\u8be2\u5230\uff09\u6bcf\u4e00\u53f0\u7684\u8d1f\u8d23\u4eba\u662f\u8c01\uff0c\u5728\u5e72\u4ec0\u4e48\u3002\u8fd9\u4e2a\u975e\u5e38\u91cd\u8981\uff0c\u5982\u679c\u505a\u4e0d\u597d\uff0c\u4f1a\u9020\u6210\u6781\u5927\u7684\u8d44\u6e90\u6d6a\u8d39\u3002</li> <li>\u63d0\u4f9b\u53ef\u9760\u8f6f\u4ef6\u7684\u90e8\u7f72\u73af\u5883\uff0c\u4e00\u822c\u662f\u865a\u62df\u673a\uff0c\u6216\u8005 bare mental\u3002</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u7684\u7248\u672c\u7edf\u4e00\u7ef4\u62a4\uff0cLinux \u53d1\u884c\u7248\u7684\u7248\u672c\uff0cKernel \u7684\u7248\u672c\u7b49\u3002</li> <li>\u7ef4\u62a4\u673a\u5668\u4e0a\u7684\u57fa\u7840\u8f6f\u4ef6\uff0c\u6bd4\u5982 NTP\uff0c\u76d1\u63a7\u4ee3\u7406\uff0c\u5176\u4ed6\u7684\u4e00\u4e9b\u4ee3\u7406\u3002</li> <li>\u63d0\u4f9b\u673a\u5668\u7684\u767b\u5f55\u65b9\u5f0f\uff0c\u6743\u9650\u7ba1\u7406\uff0c\u547d\u4ee4\u5ba1\u8ba1\u3002</li> <li>\u7ef4\u62a4\u4e00\u5957\u53ef\u89c2\u6d4b\u6027\u7684\u57fa\u7840\u8bbe\u65bd\uff0c\u6bd4\u5982\u76d1\u63a7\u7cfb\u7edf\uff0clog \u7cfb\u7edf\uff0ctrace \u7cfb\u7edf\u3002</li> <li>\u7ef4\u62a4\u7f51\u7edc\uff0c\u5927\u516c\u53f8\u53ef\u80fd\u90fd\u4f1a\u81ea\u5df1\u8bbe\u8ba1\u673a\u623f\u5185\u7684\u7f51\u7edc\u3002\u5176\u4e2d\u5305\u62ec\uff1a</li> <li>\u7f51\u7edc\u7684\u8fde\u901a\uff0c\u8fd9\u4e2a\u662f\u5fc5\u8981\u7684\u3002\u5bf9\u4e8e\u4e0a\u5c42\u7528\u6237\uff08Platform SRE\uff09\u6765\u8bf4\uff0c\u4ea4\u4ed8\u7684\u670d\u52a1\u5e94\u8be5\u662f\u4efb\u610f\u4e24\u4e2a IP \u662f\u53ef\u4ee5 ping \u901a\u7684\uff0c\u5373\u7ba1\u7406\u597d 3 \u5c42\u4ee5\u4e0b\u7684\u7f51\u7edc\u3002<ul> <li>NAT \u670d\u52a1</li> <li>DNS \u670d\u52a1</li> <li>\u9632\u706b\u5899</li> <li>4 \u5c42\u8d1f\u8f7d\u5747\u8861\uff0c7\u5c42\u8d1f\u8f7d\u5747\u8861</li> <li>CDN</li> <li>\u8bc1\u4e66\u7ba1\u7406</li> </ul> </li> </ul>"},{"location":"chap4/14sre/#2-platform-sre","title":"2 Platform SRE","text":"<p>Infrastructure SRE \u7ef4\u62a4\u7684\u662f\u57fa\u7840\u8bbe\u65bd\uff0cPlatform SRE \u4f7f\u7528\u4ed6\u4eec\u63d0\u4f9b\u7684\u57fa\u7840\u8bbe\u65bd\u5efa\u7acb\u8f6f\u4ef6\u670d\u52a1\uff0c\u8ba9\u516c\u53f8\u5185\u7684\u5f00\u53d1\u8005\u53ef\u4ee5\u4f7f\u7528\u5f00\u7bb1\u5373\u7528\u7684\u8f6f\u4ef6\u670d\u52a1\uff0c\u6bd4\u5982 Queue\u3001Cache\u3001\u5b9a\u65f6\u4efb\u52a1\u3001RPC \u670d\u52a1\u7b49\u7b49\u3002</p> <p>\u4e3b\u8981\u7684\u5de5\u4f5c\u5185\u5bb9\u6709\uff1a</p> <ul> <li>RPC \u670d\u52a1\uff1a\u8ba9\u4e0d\u540c\u7684\u670d\u52a1\u53ef\u4ee5\u4e92\u76f8\u53d1\u73b0\u5e76\u8c03\u7528</li> <li>\u79c1\u6709\u4e91\u670d\u52a1</li> <li>\u961f\u5217\u670d\u52a1\uff0c\u6bd4\u5982 Kafka \u6216\u8005 RabbitMQ</li> <li>\u5206\u5e03\u5f0f\u7684 cronjob \u670d\u52a1</li> <li>Cache</li> <li>\u7f51\u5173\u670d\u52a1\uff1a\u53cd\u5411\u4ee3\u7406\u7684\u914d\u7f6e</li> <li>\u5bf9\u8c61\u5b58\u50a8\uff1aS3</li> <li>\u5176\u4ed6\u4e00\u4e9b\u6570\u636e\u5e93\uff1aES\uff0cmongo \u7b49\u7b49\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4f1a\u6709 DBA \u6765\u8fd0\u7ef4\uff0c\u4f46\u662f NoSQL \u6216\u8005\u56fe\u6570\u636e\u5e93\u4e00\u822c\u7531 SRE \u7ef4\u62a4\u3002</li> </ul> <p>\u5185\u90e8\u7684\u5f00\u53d1\u73af\u5883\uff1a</p> <ul> <li>SCM \u7cfb\u7edf\uff0c\u6bd4\u5982\u81ea\u5efa\u7684 GitLab</li> <li>CI/CD \u7cfb\u7edf</li> <li>\u955c\u50cf\u7cfb\u7edf\uff0c\u6bd4\u5982 Harbor</li> <li>\u5176\u4ed6\u7684\u4e00\u4e9b\u5f00\u53d1\u5de5\u5177\uff0c\u6bd4\u5982\u5206\u5e03\u5f0f\u7f16\u8bd1\uff0cSentry \u9519\u8bef\u7ba1\u7406\u7b49\u7b49</li> </ul> <p>\u4e00\u4e9b\u79bb\u7ebf\u8ba1\u7b97\u73af\u5883\uff0c\u5927\u6570\u636e\u7684\u670d\u52a1</p>"},{"location":"chap4/14sre/#3-sre","title":"3 \u4e1a\u52a1 SRE","text":"<p>\u6709\u4e86 Platform SRE \u7684\u652f\u6301\uff0c\u5f00\u53d1\u4eba\u5458\u5199\u4ee3\u7801\u5c31\u57fa\u672c\u4e0a\u4e0d\u9700\u8981\u5173\u5fc3\u90e8\u7f72\u7684\u95ee\u9898\u4e86\u3002\u53ef\u4ee5\u4e13\u6ce8\u4e8e\u5f00\u53d1\uff0c\u4f7f\u7528\u516c\u53f8\u5f00\u7bb1\u5373\u7528\u7684\u670d\u52a1\u3002\u8fd9\u4e00\u5c42\u7684 SRE \u66f4\u52a0\u8d34\u8fd1\u4e8e\u4e1a\u52a1\uff0c\u77e5\u9053\u4e1a\u52a1\u662f\u600e\u4e48\u8fd0\u884c\u7684\uff0c\u8bf7\u6c42\u662f\u600e\u4e48\u5904\u7406\u7684\uff0c\u4f9d\u8d56\u4e86\u54ea\u4e9b\u7ec4\u4ef6\u3002\u5982\u679c X \u9664\u4e86\u95ee\u9898\uff0c\u53ef\u4ee5\u6709\u54ea\u4e9b\u964d\u7ea7\u7b56\u7565\u3002\u53c2\u4e0e\u5e94\u7528\u7684\u67b6\u6784\u8bbe\u8ba1\uff0c\u63d0\u4f9b\u6280\u672f\u652f\u6301\u3002</p> <p>\u4e3b\u8981\u7684\u5de5\u4f5c\u5185\u5bb9\u6709\uff1a</p> <ul> <li>\u53c2\u4e0e\u7cfb\u7edf\u7684\u8bbe\u8ba1\u3002\u6bd4\u5982\u7194\u65ad\u3001\u964d\u7ea7\uff0c\u6269\u5bb9\u7b49\u7b56\u7565\u3002</li> <li>\u505a\u538b\u6d4b\uff0c\u4e86\u89e3\u7cfb\u7edf\u7684\u5bb9\u91cf\u3002</li> <li>\u505a\u5bb9\u91cf\u89c4\u5212\u3002</li> <li>\u4e1a\u52a1\u4fa7\u7684 Oncall\u3002</li> </ul> <p>\u5bf9\u4e8e\u4e00\u4e2a\u4e13\u4e1a\u7684 SRE \u6765\u8bf4\uff0c\u4e0a\u8ff0\u6280\u80fd\u4e5f\u4e0d\u5e94\u8be5\u6709\u660e\u663e\u7684\u754c\u9650\uff0c\u6bd4\u5982\u8bf4\u4e1a\u52a1 SRE \u4e5f\u9700\u8981\u638c\u63e1\u4e00\u4e9b\u7f51\u7edc\u6280\u80fd\uff0cInfra SRE \u4e5f\u8981\u5199\u4e00\u4e9b\u4ee3\u7801\u3002\u5f88\u591a\u5de5\u5177\u6bcf\u4e00\u4e2a\u5c97\u4f4d\u7684\u4eba\u90fd\u591a\u5c11\u7528\u7684\u5230\uff0c\u6bd4\u5982 Ansible/Puppet/SaltStack \u8fd9\u79cd IT \u81ea\u52a8\u5316\u5de5\u5177\uff0c\u6216\u8005 Grafana/Prometheus \u8fd9\u79cd\u76d1\u63a7\u5de5\u5177\uff0c\u53ea\u6709\u7406\u89e3\u624d\u80fd\u7528\u7684\u6b63\u786e\u3002</p> <p>\u6362\u4e2a\u89d2\u5ea6\u8bb2\uff0c\u5bf9\u4e8e\u4e1a\u52a1 SRE \u6765\u8bf4\uff0c\u867d\u7136\u57fa\u672c\u4e0a\u4e0d\u4f1a\u53bb\u7ba1\u7406\u56db\u5c42\u4ee5\u4e0b\u7684\u7f51\u7edc\uff0c\u4f46\u662f\u5982\u679c\u9047\u5230\u7f51\u7edc\u95ee\u9898\uff0c\u80fd\u901a\u8fc7\u5df2\u6709\u7684\u5de5\u5177\u548c\u6743\u9650\u6392\u67e5\u5230\u4ea4\u6362\u673a\u95ee\u9898\uff0c\u53bb\u627e Infra SRE \u5e2e\u5fd9\uff1a\u201c\u8bf7\u5e2e\u6211\u770b\u4e0b xx IP \u5230\u4ea4\u6362\u673a\u662f\u5426\u6709\u5f02\u5e38\uff0c\u56e0\u4e3a xxx \u663e\u793a\u7684\u7ed3\u679c\u662f xx\u201d\uff0c\u603b\u6bd4 \u201c\u6211\u6000\u7591 xx \u6709\u7f51\u7edc\u95ee\u9898\uff0c\u8bf7\u5e2e\u5fd9\u6392\u67e5\u4e0b\u201d \u8981\u597d\u4e00\u4e9b\u5427\uff1f</p>"},{"location":"chap4/14sre/#4_1","title":"4 \u90e8\u7f72\u670d\u52a1","text":"<p>\u90e8\u7f72\u5206\u6210\u4e24\u79cd\uff1a</p> <ul> <li>Day 1\uff1a\u5c06\u670d\u52a1\u90e8\u7f72\u4e0a\u7ebf\u7684\u90a3\u4e00\u5929</li> <li>Day 2+\uff1a\u670d\u52a1\u90e8\u7f72\u4e4b\u540e\uff0c\u8fd8\u4f1a\u8fdb\u884c\u5f88\u591a\u66f4\u65b0\uff0c\u5347\u7ea7\uff0c\u914d\u7f6e\u66f4\u6539\uff0c\u670d\u52a1\u8fc1\u79fb\u7b49\u7b49</li> </ul> <p>Day 2+ \u7684\u5de5\u4f5c\u8981\u505a\u5f88\u591a\u6b21\uff0cDay 1 \u505a\u7684\u5f88\u5c11\uff0c\u5728\u4e0d\u65ad\u7684\u8fed\u4ee3\u5347\u7ea7\u4e4b\u540e\uff0c\u8fd8\u80fd\u4fdd\u8bc1\u6709\u4e00\u4e2a\u53ef\u9760\u7684 Day 1 \u64cd\u4f5c\u662f\u5f88\u96be\u7684\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u6211\u4eec\u5728\u670d\u52a1\u90e8\u7f72\u4e4b\u540e\u4e00\u76f4\u6539\u6765\u6539\u53bb\uff0c\u8fd8\u8981\u4fdd\u8bc1\u8fd9\u4e2a\u670d\u52a1\u5728\u4e00\u4e2a\u5168\u65b0\u7684\u73af\u5883\u80fd\u591f\u53ef\u9760\u7684\u90e8\u7f72\u8d77\u6765\u3002</p> <p>\u90e8\u7f72\u73af\u5883\u7684\u786c\u7f16\u7801\uff0c\u5947\u5947\u602a\u602a\u7684 work around\uff0c\u90fd\u4f1a\u7834\u574f Day 1 \u7684\u53ef\u9760\u6027\u3002\u4e4b\u524d\u4e00\u5bb6\u516c\u53f8\uff0c\u6269\u5bb9\u4e00\u4e2a\u65b0\u673a\u623f\u7684\u8fc7\u7a0b\u7b80\u76f4\u662f\u5669\u68a6\uff0c\u592a\u591a\u7684\u5947\u602a\u914d\u7f6e\uff0chardcode\uff0c\u5bfc\u81f4\u8e29\u8fc7\u65e0\u6570\u4e2a\u5751\u624d\u80fd\u5728\u4e00\u4e2a\u65b0\u7684\u673a\u623f\u90e8\u7f72\u8d77\u6765\u5168\u90e8\u7684\u670d\u52a1\u3002</p> <p>Day2+ \u7684\u64cd\u4f5c\u4e5f\u4e0d\u7b80\u5355\uff0c\u4e3b\u8981\u8981\u5173\u6ce8\u7a33\u5b9a\u6027\u3002\u5bf9\u4e8e\u91cd\u8981\u7684\u53d8\u66f4\u64cd\u4f5c\u8981\u8bbe\u8ba1\u597d\u53d8\u66f4\u8ba1\u5212\uff0c\u5982\u4f55\u505a\u5230\u7070\u5ea6\u6d4b\u8bd5\uff0c\u5982\u679c\u51fa\u4e86\u95ee\u9898\u5e94\u8be5\u5982\u4f55\u56de\u6eda\uff0c\u5982\u4f55\u4fdd\u8bc1\u56de\u6eda\u53ef\u4ee5\u6210\u529f\uff08\u5982\u4f55\u6d4b\u8bd5\u56de\u6eda\uff09\u7b49\u7b49\u3002</p> <p>\u90e8\u7f72\u7684\u64cd\u4f5c\u6700\u597d\u90fd\u662f\u53ef\u4ee5\u8ffd\u8e2a\u7684\uff0c\u56e0\u4e3a\u5e76\u4e0d\u662f\u6240\u6709\u4f1a\u5f15\u8d77\u95ee\u9898\u7684\u64cd\u4f5c\u90fd\u4f1a\u7acb\u5373\u5f15\u8d77\u95ee\u9898\u3002\u6bd4\u5982\u4e00\u4e2a\u64cd\u4f5c\u5f53\u65f6\u505a\u5b8c\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898\uff0c\u4f46\u662f\u8fc7\u4e86 1 \u4e2a\u6708\uff0c\u5076\u7136\u7684\u91cd\u542f\u6216\u8005\u5185\u5b58\u8fbe\u5230\u4e86\u67d0\u4e00\u4e2a\u6307\u6807\u89e6\u53d1\u4e86\u95ee\u9898\u3002\u5982\u679c\u80fd\u8bb0\u5f55\u64cd\u4f5c\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u56de\u6eaf\u4e4b\u524d\u505a\u8fc7\u7684\u53d8\u66f4\uff0c\u65b9\u4fbf\u5b9a\u4f4d\u95ee\u9898\u3002\u73b0\u5728\u4e00\u822c\u90fd\u7528 Git \u6765\u8ffd\u8e2a\u90e8\u7f72\u8fc7\u7a0b\u7684\u53d8\u66f4\u3002</p>"},{"location":"chap4/14sre/#5-oncall","title":"5 Oncall","text":"<p>Oncall \u7b80\u5355\u6765\u8bf4\u5c31\u662f\u8981\u4fdd\u8bc1\u7ebf\u4e0a\u670d\u52a1\u7684\u6b63\u5e38\u8fd0\u884c\u3002\u5178\u578b\u7684\u5de5\u4f5c\u6d41\u7a0b\u662f\uff1a\u6536\u5230\u544a\u8b66\uff0c\u68c0\u67e5\u544a\u8b66\u53d1\u51fa\u7684\u539f\u56e0\uff0c\u786e\u8ba4\u7ebf\u4e0a\u670d\u52a1\u662f\u5426\u6709\u95ee\u9898\uff0c\u5b9a\u4f4d\u5230\u95ee\u9898\uff0c\u89e3\u51b3\u95ee\u9898\u3002</p> <p>\u6536\u5230\u544a\u8b66\u5e76\u4e0d\u603b\u610f\u5473\u7740\u771f\u6b63\u7684\u95ee\u9898\uff0c\u4e5f\u6709\u53ef\u80fd\u544a\u8b66\u8bbe\u7f6e\u7684\u4e0d\u5408\u7406\u3002\u544a\u8b66\u548c\u76d1\u63a7\u9762\u677f\u5e76\u4e0d\u662f\u4e00\u4e2a\u9759\u6001\u7684\u914d\u7f6e\uff0c\u5b83\u5e94\u8be5\u662f\u6bcf\u5929\u90fd\u5728\u53d8\u5316\u7684\uff0c\u65f6\u523b\u5728\u8c03\u6574\u7684\u3002\u5982\u679c\u53d1\u73b0\u6ca1\u6709\u6807\u5fd7\u771f\u6b63\u7ebf\u4e0a\u95ee\u9898\u7684\u544a\u8b66\u53d1\u4e86\u51fa\u6765\uff0c\u5c31\u5e94\u8be5\u4fee\u6539\u544a\u8b66\u89c4\u5219\u3002\u5982\u679c\u53d1\u73b0\u5f53\u524d\u7684\u76d1\u63a7\u65e0\u6cd5\u5feb\u901f\u5b9a\u4f4d\u95ee\u9898\uff0c\u5e94\u8be5\u8c03\u6574\u76d1\u63a7\u9762\u677f\uff0c\u6dfb\u52a0\u6216\u8005\u5220\u9664\u76d1\u63a7\u6307\u6807\u3002\u4e1a\u52a1\u5728\u53d1\u5c55\uff0c\u8bf7\u6c42\u91cf\u5728\u53d8\u5316\uff0c\u67d0\u4e9b\u9608\u503c\u4e5f\u9700\u8981\u4e0d\u65ad\u5730\u8c03\u6574\u3002</p> <p>\u5b9a\u4f4d\u95ee\u9898\u6ca1\u6709\u4e00\u6982\u800c\u8bba\u7684\u65b9\u6cd5\u4e86\uff0c\u9700\u8981\u6839\u636e\u770b\u5230\u7684\u5b9e\u65f6\uff0c\u7ed3\u5408\u81ea\u5df1\u7684\u7ecf\u9a8c\uff0c\u7136\u540e\u505a\u63a8\u6d4b\uff0c\u7136\u540e\u4f7f\u7528\u5de5\u5177\u9a8c\u8bc1\u81ea\u5df1\u7684\u63a8\u6d4b\uff0c\u7136\u540e\u786e\u5b9a\u95ee\u9898\u7684\u6839\u56e0\u3002</p> <p>\u4f46\u662f\u89e3\u51b3\u95ee\u9898\u662f\u53ef\u4ee5\u6709\u65b9\u6cd5\u8bba\u7684\uff0c\u53eb\u505a SOP\uff08\u6807\u51c6\u64cd\u4f5c\u6d41\u7a0b\uff09\u5373\uff1a\u5982\u679c\u51fa\u73b0\u4e86\u8fd9\u79cd\u73b0\u8c61\uff0c\u90a3\u4e48\u6267\u884c\u90a3\u79cd\u64cd\u4f5c\uff0c\u5c31\u53ef\u4ee5\u6062\u590d\u4e1a\u52a1\u3002SOP \u6587\u6863\u5e94\u8be5\u63d0\u524d\u5236\u5b9a\uff0c\u5e76\u4e14\u9a8c\u8bc1\u5176\u6709\u6548\u6027\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\u4e0a\u8ff0\u5b9a\u4f4d\u95ee\u9898\u3001\u89e3\u51b3\u95ee\u9898\u5e76\u6ca1\u6709\u987a\u5e8f\u5173\u7cfb\u3002\u4e00\u4e2a\u7ecf\u5e38\u72af\u7684\u9519\u8bef\u662f\uff0c\u5728\u51fa\u73b0\u6545\u969c\u7684\u65f6\u5019\uff0c\u82b1\u4e86\u5f88\u957f\u65f6\u95f4\u5b9a\u4f4d\u5230\u6545\u969c\u7684\u6839\u56e0\uff0c\u7136\u540e\u518d\u4fee\u590d\u3002\u8fd9\u6837\u82b1\u7684\u65f6\u95f4\u4e00\u822c\u4f1a\u6bd4\u8f83\u957f\u3002\u6b63\u786e\u7684\u505a\u6cd5\u662f\u5148\u6839\u636e\u73b0\u8c61\u770b\u73b0\u6709\u7684 SOP \u80fd\u5426\u6062\u590d\u4e1a\u52a1\u3002</p> <p>\u6bd4\u5982\u8bf4\u5f53\u524d\u9519\u8bef\u53ea\u53d1\u751f\u5728\u67d0\u4e00\u4e2a\u8282\u70b9\u4e0a\uff0c\u90a3\u4e48\u5c31\u76f4\u63a5\u4e0b\u7ebf\u8fd9\u4e2a\u8282\u70b9\uff0c\u5177\u4f53\u7684\u539f\u56e0\u540e\u9762\u518d\u6392\u67e5\u3002\u6062\u590d\u5f53\u524d\u7684\u6545\u969c\u6c38\u8fdc\u662f\u7b2c\u4e00\u8981\u52a1\u3002\u4f46\u662f\u6062\u590d\u64cd\u4f5c\u4e5f\u8981\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u6bd4\u5982\u731c\u6d4b\u53ef\u4ee5\u901a\u8fc7\u91cd\u542f\u89e3\u51b3\u95ee\u9898\u7684\u8bdd\uff0c\u53ef\u4ee5\u5148\u91cd\u542f\u4e00\u53f0\u505a\u6d4b\u8bd5\uff0c\u800c\u4e0d\u662f\u4e00\u6b21\u6027\u5c06\u6240\u6709\u670d\u52a1\u91cd\u542f\u3002\u5927\u90e8\u5206\u60c5\u51b5\u662f\u9700\u8981\u4e34\u573a\u5206\u6790\u7684\uff0c\u662f\u4e00\u4e2a\u7d27\u5f20\u53c8\u523a\u6fc0\u7684\u8fc7\u7a0b\u3002</p>"},{"location":"chap4/14sre/#6-slislo","title":"6 \u5236\u5b9a\u548c\u4ea4\u4ed8 SLI/SLO","text":"<p>\u7ef4\u62a4\u670d\u52a1\u7b49\u7ea7\u534f\u8bae\uff0c\u542c\u8d77\u6765\u50cf\u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u4e8b\u60c5\uff0c\u53ea\u8981\u201c\u8bbe\u5b9a\u4e00\u4e2a\u53ef\u7528\u7387\u201d\u7136\u540e\u53bb\u5b9e\u73b0\u5b83\u5c31\u597d\u4e86\uff0c\u7136\u800c\u73b0\u5b9e\u7684\u60c5\u51b5\u5e76\u4e0d\u662f\u3002</p> <p>\u6bd4\u5982\uff0c\u5236\u5b9a\u53ef\u7528\u7387\u7684\u65f6\u5019\uff0c\u5e76\u4e0d\u662f\u8bf4\u6211\u4eec\u53bb\u201c\u5b9e\u73b04\u4e2a9\u201d\uff0899.99% \u7684\u65f6\u95f4\u53ef\u7528\uff09\u5c31\u591f\u4e86\uff0c\u6211\u4eec\u6709\u4ee5\u4e0b\u95ee\u9898\u8981\u8003\u8651\uff1a</p> <ul> <li>\u5982\u4f55\u5b9a\u4e49\u8fd9\u4e2a\u53ef\u7528\u7387\uff1f <ul> <li>\u6bd4\u5982\u6211\u4eec\u4ee5\u53ef\u7528\u7387 &gt; 99.9% \u4e3a\u76ee\u6807\uff0c\u6709\u4e00\u4e2a\u670d\u52a1\u90e8\u7f72\u4e86 5 \u4e2a Zone\uff0c\u90a3\u4e48\u6709\u4e00\u4e2a Zone \u6302\u4e86\uff0c\u5176\u4f59\u7684 Zone \u662f\u53ef\u7528\u7684\uff0c\u90a3\u4e48\u53ef\u7528\u7387\u88ab\u7834\u574f\u4e86\u5417\uff1f\u8fd9\u4e2a\u53ef\u7528\u7387\u662f\u6bcf\u4e00\u4e2a Zone \u7684\u8fd8\u662f\u6240\u6709\u7684 Zone \u4e00\u8d77\u8ba1\u7b97\u7684\uff1f</li> </ul> </li> <li>\u53ef\u7528\u7387\u8ba1\u7b97\u7684\u6700\u5c0f\u5355\u4f4d\u662f\u4ec0\u4e48\uff1f<ul> <li>\u5982\u679c 1min \u5185\u6709 50s \u6ca1\u6709\u8fbe\u5230\u53ef\u7528\u7387\uff0c\u90a3\u4e48\u8fd9\u4e00\u5206\u949f\u7b97\u662f down \u8fd8\u662f up\uff1f</li> </ul> </li> <li>\u53ef\u7528\u7387\u7684\u5468\u671f\u662f\u600e\u4e48\u8ba1\u7b97\u7684\uff1f<ul> <li>\u6309\u7167\u4e00\u4e2a\u6708\u8fd8\u662f\u4e00\u4e2a\u5468\uff1f\u4e00\u4e2a\u5468\u662f\u6700\u8fd1\u7684 7 \u5929\u8fd8\u662f\u8ba1\u7b97\u4e00\u4e2a\u81ea\u7136\u5468\uff1f</li> </ul> </li> <li>\u5982\u4f55\u5bf9 SLI \u548c SLO \u505a\u76d1\u63a7\uff1f <ul> <li>\u5982\u679c\u9519\u8bef\u9884\u7b97\u5373\u5c06\u7528\u5b8c\uff0c\u6709\u4ec0\u4e48\u63aa\u65bd\uff1f\u6bd4\u5982\u51cf\u5c11\u53d1\u5e03\uff1f\u5982\u679c SLI \u548c SLO \u6ca1\u6709\u8fbe\u5230\u4f1a\u600e\u4e48\u6837\uff1f</li> </ul> </li> </ul>"},{"location":"chap4/14sre/#7_1","title":"7 \u6545\u969c\u590d\u76d8","text":"<p>\u6545\u969c\u590d\u76d8\u9700\u8981\u6709\u6587\u6863\u8bb0\u5f55\uff0c\u5305\u62ec\u6545\u969c\u53d1\u751f\u7684\u8fc7\u7a0b\uff0c\u65f6\u95f4\u7ebf\u7684\u8bb0\u5f55\uff0c\u64cd\u4f5c\u7684\u8bb0\u5f55\uff0c\u6545\u969c\u6062\u590d\u7684\u65b9\u6cd5\uff0c\u6545\u969c\u6839\u56e0\u7684\u5206\u6790\uff0c\u4e3a\u4ec0\u4e48\u6545\u969c\u4f1a\u53d1\u751f\u7684\u5206\u6790\u3002\u6587\u6863\u5e94\u8be5\u9690\u53bb\u6240\u6709\u5f53\u4e8b\u4eba\u7684\u59d3\u540d\u5bf9\u516c\u53f8\u7684\u6240\u6709\u4eba\u516c\u5f00\u3002\u5f88\u591a\u516c\u53f8\u5bf9\u6545\u969c\u6587\u6863\u8bbe\u7f6e\u67e5\u770b\u6743\u9650\uff0c\u6211\u89c9\u5f97\u6ca1\u4ec0\u4e48\u9053\u7406\u3002\u6709\u4e9b\u516c\u53f8\u7684\u6545\u969c\u590d\u76d8\u751a\u81f3\u5bf9\u5916\u4e5f\u662f\u516c\u5f00\u7684\u3002</p> <p>\u6545\u969c\u5728\u590d\u76d8\u7684\u65f6\u5019\u5e94\u8be5\u5c06\u5f53\u4e8b\u4eba\u7684\u540d\u5b57\u7528\u4ee3\u7801\u66ff\u4ee3\uff0c\u53ef\u4ee5\u8425\u9020\u66f4\u597d\u7684\u8ba8\u8bba\u6c1b\u56f4\u3002</p> <p>\u4e0d\u5e94\u8be5\u8981\u6c42\u6240\u6709\u7684\u6545\u969c\u590d\u76d8\u90fd\u4ea7\u751f Action\u3002\u4e4b\u524d\u4e00\u5bb6\u7684\u516c\u53f8\u7684\u6545\u969c\u590d\u76d8\u4e0a\uff0c\u56e0\u4e3a\u5fc5\u987b\u7ed9\u9886\u5bfc\u4e00\u4e2a\u201c\u4ea4\u5f85\u201d\uff0c\u6240\u4ee5\u6bcf\u6b21\u90fd\u4f1a\u4ea7\u751f\u4e00\u4e9b\u63aa\u65bd\u6765\u9884\u9632\u76f8\u540c\u7684\u6545\u969c\u518d\u6b21\u53d1\u751f\uff0c\u6bd4\u5982\u589e\u52a0\u5ba1\u6279\u6d41\u7a0b\u4e4b\u7c7b\u7684\u3002\u8fd9\u5f88\u626f\uff0c\u8ba9\u7ea7\u522b\u5f88\u9ad8\u7684\u9886\u5bfc\u5ba1\u6279\u4ed6\u81ea\u5df1\u4e5f\u770b\u4e0d\u61c2\u7684\u64cd\u4f5c\uff0c\u53ea\u80fd\u8ba9\u9886\u5bfc\u66f4\u75db\u82e6\uff0c\u4e5f\u8ba9\u64cd\u4f5c\u6d41\u7a0b\u53d8\u5f97\u53c8\u81ed\u53c8\u957f\uff0c\u6700\u540e\u6240\u6709\u4eba\u90fd\u4f1a\u5fd8\u8bb0\u8fd9\u91cc\u4e3a\u4ec0\u4e48\u4f1a\u6709\u4e00\u4e2a\u5ba1\u6279\uff0c\u4f46\u662f\u53c8\u6ca1\u6709\u4eba\u6562\u5220\u6389\u3002\u4f60\u5220\u6389\uff0c\u51fa\u4e86\u4e8b\u60c5\u4f60\u8d1f\u8d23\u3002</p>"},{"location":"chap4/14sre/#8","title":"8 \u5bb9\u91cf\u89c4\u5212","text":"<p>\u5bb9\u91cf\u89c4\u5212\u662f\u4e00\u4e2a\u975e\u5e38\u590d\u6742\u7684\u95ee\u9898\uff0c\u751a\u81f3\u6709\u4e00\u4e9b\u6096\u8bba\u3002\u5bb9\u91cf\u8981\u63d0\u524d\u505a\u597d\u89c4\u5212\uff0c\u4f46\u662f\u5bb9\u91cf\u7684\u89c4\u5212\u9700\u8981\u77e5\u9053\u4e1a\u52a1\u7684\u6269\u5f20\u901f\u5ea6\uff0c\u6269\u5f20\u901f\u5ea6\u8fd9\u79cd\u4e8b\u60c5\u53c8\u4e0d\u662f\u63d0\u524d\u80fd\u8ba1\u5212\u597d\u7684\u3002\u6240\u4ee5\u6211\u4e00\u76f4\u89c9\u5f97\u8fd9\u4e2a\u4e8b\u60c5\u5f88\u96be\u505a\uff0c\u4e5f\u4e00\u76f4\u6ca1\u6709\u89c1\u8fc7\u505a\u7684\u5f88\u597d\u7684\u4f8b\u5b50\u3002</p> <p>\u4f46\u662f\u81f3\u5c11\u53ef\u4ee5\u5bf9\u7ef4\u62a4\u7684\u7cfb\u7edf\u5efa\u7acb\u4e00\u4e2a\u6a21\u578b\uff0c\u77e5\u9053\u591a\u5c11\u673a\u5668\uff0c\u591a\u5c11\u8d44\u6e90\uff0c\u80fd\u5bb9\u7eb3\u591a\u5c11\u5bb9\u91cf\u3002\u8fd9\u6837\u9047\u5230\u5927\u4fc3\u4e4b\u7c7b\u7684\u6d3b\u52a8\u4e5f\u80fd\u53ca\u65f6\u4f30\u7b97\u9700\u8981\u7684\u8d44\u6e90\u6570\u91cf</p>"},{"location":"chap4/14sre/#9","title":"9 \u7528\u6237\u652f\u6301","text":"<p>\u7528\u6237\u652f\u6301\u4e5f\u662f\u65e5\u5e38\u7684\u4e00\u90e8\u5206\u3002\u5305\u62ec\u6280\u672f\u54a8\u8be2\uff0c\u4ee5\u53ca\u7528\u6237\u8981\u6c42\u7684\u7ebf\u4e0a\u95ee\u9898\u6392\u67e5\u3002</p> <p>\u8fd9\u91cc\u5c31\u9700\u8981\u63d0\u5230\u6587\u6863\u7684\u91cd\u8981\u6027\u4e86\u3002\u5982\u679c\u6ca1\u6709\u7ef4\u62a4\u597d\u6587\u6863\uff0c\u90a3\u4e48\u7528\u6237\u5c31\u4f1a\u4e00\u904d\u53c8\u4e00\u904d\u95ee\u76f8\u540c\u7684\u95ee\u9898\u3002\u5199\u6587\u6863\u4e5f\u662f\u4e00\u4e2a\u6280\u672f\u6d3b\uff0c\u4f18\u79c0\u7684\u9700\u8981\u5f88\u957f\u65f6\u95f4\u7684\u79ef\u7d2f\u3002\u6587\u6863\u4e5f\u9700\u8981\u7ecf\u5e38\u66f4\u65b0\u3002\u6211\u4e00\u822c\u4f1a\u8fd9\u6837\uff0c\u4fdd\u6301\u8fd9\u6837\u4e00\u79cd\u72b6\u6001\uff1a\u7528\u6237\u53ef\u4ee5\u4e0d\u9700\u8981\u4efb\u4f55\u4eba\u5c31\u4ece\u6587\u6863\u4e2d\u627e\u5230\u4ed6\u9700\u8981\u7684\u6240\u6709\u7b54\u6848\u3002</p> <p>\u6709\u5173\u505a\u9879\u76ee\u6ca1\u6709\u4e13\u4e1a\u56e2\u961f\u5f97\u4e0d\u5230\u8bad\u7ec3</p> <p>\u8fd9\u65b9\u9762\u662f\u542c\u5230\u6700\u591a\u7684\u62b1\u6028\u3002\u867d\u7136\u8bf4 SRE \u5728\u5de5\u4f5c\u4e0a\u5e94\u8be5\u662f\u5f00\u53d1\u65f6\u95f4\u548c\u8fd0\u7ef4\u65f6\u95f4\u5404 50%\uff0c\u4f46\u662f\u771f\u5b9e\u7684\u60c5\u51b5\u662f\uff0c\u5373\u4f7f SRE \u6709\u4e00\u4e9b\u5f00\u53d1\u5de5\u4f5c\uff0c\u4e5f\u5927\u90e8\u5206\u662f\u9762\u5411\u5185\u90e8\u7528\u6237\uff0c\u9762\u5411\u516c\u53f8\u5185\u90e8\u7684\u5f00\u53d1\u8005\u7684\u3002\u5927\u90e8\u5206\u9879\u76ee\u662f\u4e00\u4e9b\u60f3\u6cd5\uff0c\u9700\u8981\u53bb\u5c1d\u8bd5\u4e00\u4e0b\u884c\u4e0d\u884c\uff0c\u57fa\u672c\u4e0a\u4e0d\u4f1a\u6709\u4e13\u4e1a\u7684\u8bbe\u8ba1\u8d44\u6e90\uff0cPM \u8d44\u6e90\u3002</p>"},{"location":"chap4/14sre/#_1","title":"\u9762\u8bd5\u4f1a\u95ee\u4ec0\u4e48\uff1f","text":"<p>\u8fd9\u4e2a\u4ed3\u5e93\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u9762\u8bd5\u9898\u96c6\u9526\uff1ahttps://github.com/bregman-arie/devops-exercises</p>"},{"location":"chap4/15prometheus/","title":"15 Top Prometheus Interview Questions and Answers (2022)","text":"<p>https://www.techgeeknext.com/tools/prometheus-interview-questions</p>"},{"location":"chap4/15prometheus/#1-what-is-prometheus","title":"1 What is Prometheus?","text":"<p>Prometheus is a free event monitoring and alerting software application. </p> <p>It logs real-time metrics in a time series database built with an HTTP pull model, allowing for flexible queries and real-time alerting.</p>"},{"location":"chap4/15prometheus/#2-what-is-the-architecture-of-prometheus-monitoring","title":"2 What is the Architecture of Prometheus Monitoring?","text":"<p>Prometheus can run with both Go and Docker applications. The monitoring application consists of a time-series database, a user interface, and the PromQL query language, which is a flexible and intelligent query language.</p> <p></p> <p>Prometheus gathers metrics via instrumented jobs. </p> <p>The samples can be kept locally. It can also be scanned using rules to record or collect any new time-series via existing data and generate design alerts. Histograms, gauges, and counters are used to display these metrics. Plaintext data can be transmitted over HTTP.</p>"},{"location":"chap4/15prometheus/#3-how-do-we-manage-and-monitor-spring-boot-application-in-production-using-prometheus","title":"3: How do we manage and monitor Spring boot application in production using Prometheus?","text":"<p>Spring Boot Actuator is a Spring Boot sub-project that adds monitoring and management capabilities for your production-ready apps. </p> <p>It offers a number of HTTP or JMX endpoints with which you can communicate.</p> <p></p> <p><code>localhost:8080/actuator/prometheus</code></p> <p>The Prometheus (a tool for monitoring) endpoint is provided by the Spring Boot Actuator, which regularly pulls this endpoint for metric data and offers graphic representation for data. We can see Api latency, performance etc in Prometheus Graph.</p> <p>Below is Prometheus graph for testApi endpoint.</p> <p></p> <p>https://www.techgeeknext.com/spring-boot/spring-boot-actuator-prometheus-grafana</p>"},{"location":"chap4/15prometheus/#4-what-are-the-features-of-prometheus","title":"4 What are the Features of Prometheus?","text":"<p>The following are some of the most important aspects of Prometheus:</p> <ul> <li>Numerous dashboards and graphing modes are available.</li> <li>Representation of a time series grouping from any HTTP pull model.</li> <li>Abilities to use PromQL to support a data model's multidimensionality feature.</li> <li>Individual server nodes are self - reliant and do not rely on distributed storage.</li> <li>It display time series data, i.e., identified with the metric's name or with KVP (Key-value pairs).</li> </ul>"},{"location":"chap4/15prometheus/#5-what-are-the-components-of-prometheus","title":"5 What are the Components of Prometheus?","text":"<p>The majority of Prometheus components are written in a programming language, namely Go, and can be deployed and built as static binaries. A large number of its components are optional.</p> <ul> <li>Prometheus Server</li> </ul> <p>Prometheus' server stores and scrapes metrics. </p> <p>It makes use of the persistence layer. This layer is part of the server and is not explicitly defined in the documentation. This server's nodes are all self-contained and do not rely on distributed storage.</p> <ul> <li>Prometheus UI</li> </ul> <p>We can see charts/graphs, visualise, and access stored data using the web UI. Prometheus simplifies its user interface. We can also configure other visualisation tools, such as Grafana, to connect to the Prometheus server via the Prometheus Query Language (PromQL).</p> <ul> <li>Prometheus Alertmanager</li> </ul> <p>Alertmanager sends alerts via client applications like the Prometheus server. It has advanced features for routing, grouping, and deduplicating alerts, and it can route alerts from other services like OpsGenie and PagerDuty.</p>"},{"location":"chap4/15prometheus/#6-what-database-is-used-by-prometheus","title":"6 What database is used by Prometheus?","text":"<p>Disk Time Series Database</p> <p>Prometheus comes with a local on-disk time series database and also can integrate with remote storage systems.</p>"},{"location":"chap4/15prometheus/#7-what-is-promql","title":"7 What is PromQL?","text":"<p>Prometheus helps make its query language, Prometheus Query Language, easier to use (PromQL). It allows users to aggregate and select data. PromQL is specifically designed for use in conjunction with the Time-Series database. Prometheus includes four different types of metrics, that are mentioned below:</p> <ul> <li>Prometheus Gauge</li> <li>Prometheus Counter</li> <li>Prometheus Summary</li> <li>Prometheus Histogram</li> </ul>"},{"location":"chap4/15prometheus/#8-what-are-the-different-promql-data-types-available-in-prometheus-expression-language","title":"8. What are the different PromQL data types available in Prometheus Expression language?","text":"<p>An expression or sub-expression in Prometheus expression language can evaluate to one of four types:</p> <ul> <li>Instant vector</li> </ul> <p>A set of time series containing a single sample for each time series, all sharing the same timestamp.</p> <p>This example selects all time series with metric name <code>http_requests_total</code> metric name:</p> <p><code>http_requests_total</code></p> <p>We can filter the data further by using comma separated list of label matchers in curly braces <code>({})</code> also with matching operators like <code>=</code>, <code>!=</code>, <code>=~ (for regex-match)</code>, <code>!~ (do not regex-match)</code></p> <pre><code>// selects data with the http_requests_total metric name that have job label set to prometheus \n//and their group label set to canary\nhttp_requests_total{job=\"prometheus\",group=\"canary\"}\n\n//selects all http_requests_total time series for staging, testing, \n//and development environments and HTTP methods other than GET.\nhttp_requests_total{environment=~\"staging|testing|development\",method!=\"GET\"}\n</code></pre> <ul> <li>Range vector</li> </ul> <p>A set of time series containing a range of data points over time for each time series.</p> <p>Time durations can be specified as <code>ms, s, m, h, d (day with 24h),w (week of 7d),y (year with 365d)</code>.</p> <pre><code>// Select all values recorded within the last 5 minutes for all time series \n//with the metric name http requests total and a job label of prometheus:\nhttp_requests_total{job=\"prometheus\"}[5m]\n</code></pre> <ul> <li>Scalar</li> </ul> <p>A simple numeric floating point value.</p> <ul> <li>String</li> </ul> <p>A a simple string value, currently unused.</p> <p>There is no escaping inside backticks. Unlike Go, Prometheus does not discard newlines within backticks.</p> <pre><code>\"Example of string\"\n'Example of unescaped: \\n \\\\ \\t'\n'Example of escaped: \\n ' \" \\t'\n</code></pre>"},{"location":"chap4/15prometheus/#9-how-to-calculate-the-average-request-duration-over-the-last-5-minutes-from-a-histogram-or-summary","title":"9 How To calculate the average request duration over the last 5 minutes from a histogram or summary?","text":"<pre><code>rate(http_request_duration_seconds_sum[5m])\n/\n rate(http_request_duration_seconds_count[5m])\n</code></pre>"},{"location":"chap4/15prometheus/#10-what-is-gauges-in-prometheus","title":"10 What is Gauges in Prometheus?","text":"<p>A gauge is any metric that shows an individual value that can vary randomly up and down. </p> <p>Gauges are used to measure the values that are typically or recently used in memory.</p> <p>\u4eea\u8868\u662f\u663e\u793a\u53ef\u4ee5\u968f\u673a\u4e0a\u4e0b\u53d8\u5316\u7684\u5355\u4e2a\u503c\u7684\u4efb\u4f55\u6307\u6807\u3002\u4eea\u8868\u7528\u4e8e\u6d4b\u91cf\u5185\u5b58\u4e2d\u901a\u5e38\u6216\u6700\u8fd1\u4f7f\u7528\u7684\u503c\u3002</p>"},{"location":"chap4/15prometheus/#11-what-are-counters-in-prometheus","title":"11 What are Counters in Prometheus?","text":"<p>A counter is any cumulative metric that shows an individual increasing counter monotonically and whose value could only reset or increase to zero over a restart. For example, we can use a counter to represent the number of errors, completed tasks, and requests served.</p> <p>\u8ba1\u6570\u5668\u662f\u4efb\u4f55\u7d2f\u79ef\u5ea6\u91cf\uff0c\u5b83\u663e\u793a\u5355\u4e2a\u8ba1\u6570\u5668\u5355\u8c03\u9012\u589e\uff0c\u5e76\u4e14\u5176\u503c\u53ea\u80fd\u5728\u91cd\u65b0\u542f\u52a8\u65f6\u91cd\u7f6e\u6216\u589e\u52a0\u5230\u96f6\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8ba1\u6570\u5668\u6765\u8868\u793a\u9519\u8bef\u6570\u3001\u5df2\u5b8c\u6210\u4efb\u52a1\u6570\u548c\u670d\u52a1\u8bf7\u6c42\u6570\u3002</p>"},{"location":"chap4/15prometheus/#12-what-do-you-mean-by-summaries-and-histograms-in-prometheus","title":"12  What do you mean by Summaries and Histograms in Prometheus?","text":"<p>Prometheus supports two kinds of complex metrics: Summaries and Histograms.</p> <p>These metrics are being used to keep track of the number of observations and the sum of observed values. It generates time series in the database. For example, they all add the suffix <code>_sum</code> to the observed value's sum.</p> <ul> <li>Histogram</li> </ul> <p>A histogram is used to represent the counts and observations (typically response size and request durations) in the configuration buckets. It also makes the sum of each observed value easier.</p> <p>\u76f4\u65b9\u56fe\u7528\u4e8e\u8868\u793a\u914d\u7f6e\u6876\u4e2d\u7684\u8ba1\u6570\u548c\u89c2\u5bdf\u7ed3\u679c\uff08\u901a\u5e38\u662f\u54cd\u5e94\u5927\u5c0f\u548c\u8bf7\u6c42\u6301\u7eed\u65f6\u95f4\uff09\u3002\u5b83\u8fd8\u4f7f\u6bcf\u4e2a\u89c2\u5bdf\u503c\u7684\u603b\u548c\u66f4\u5bb9\u6613\u3002</p> <p>It makes a histogram an important choice for tracking things like latency, which may have SLO (Service Level Objective) defined across it.</p> <ul> <li>Summary</li> </ul> <p>A summary is used to represent different observations (like response size or request durations usually). It also displays the total number of observations and the sum of each observed value. On any sliding time window, it can calculate configurable quantities.</p> <p>\u6458\u8981\u7528\u4e8e\u8868\u793a\u4e0d\u540c\u7684\u89c2\u5bdf\u7ed3\u679c\uff08\u901a\u5e38\u5982\u54cd\u5e94\u5927\u5c0f\u6216\u8bf7\u6c42\u6301\u7eed\u65f6\u95f4\uff09\u3002\u5b83\u8fd8\u663e\u793a\u89c2\u5bdf\u7684\u603b\u6570\u548c\u6bcf\u4e2a\u89c2\u5bdf\u503c\u7684\u603b\u548c\u3002\u5728\u4efb\u4f55\u6ed1\u52a8\u65f6\u95f4\u7a97\u53e3\u4e0a\uff0c\u5b83\u90fd\u53ef\u4ee5\u8ba1\u7b97\u53ef\u914d\u7f6e\u7684\u6570\u91cf\u3002</p>"},{"location":"chap4/15prometheus/#13-what-is-the-default-data-retention-period-in-prometheus","title":"13 What is the default data retention period in Prometheus?","text":"<p>The default data retention period is 15 days in Prometheus. Data would be automatically deleted after the data storage default retention duration has passed.</p>"},{"location":"chap4/15prometheus/#14-how-to-persist-its-data-between-restarts-in-prometheus-running-in-a-docker-container","title":"14 How to persist its data between restarts in Prometheus running in a Docker container?","text":"<p>We can create/mount volume and persist application data between multiple restarts in Prometheus by using below command:</p> <pre><code>$ docker volume create a-new-volume\n$ docker run \\ --publish 9090:9090 \\\n--volume a-new-volume:/prometheus \\\n--volume \"$(pwd)\"/prometheus.yml:/etc/prometheus/prometheus.yml \\ prom/prometheus\n</code></pre>"},{"location":"chap4/15prometheus/#15-how-do-i-check-my-prometheus-status","title":"15: How do I check my Prometheus status?","text":"<pre><code>check-node_exporter\n</code></pre> <p>Open your browser and go to http://localhost:9090 to test the Prometheus server installation. You should be able to see the Prometheus interface. Select Status, then Targets. Your machines should be listed as UP under State.</p>"},{"location":"chap4/15prometheus/#16-how-do-i-trigger-a-prometheus-alert","title":"16 How do I trigger a Prometheus alert?","text":"<p>AlertManager is a single binary that receives alerts from the Prometheus server and sends them to the end user through email, Slack, or other means</p> <p></p> <p>The following are the steps for setting up Prometheus alerts:</p> <ul> <li>Configure and set up AlertManager.</li> <li>Configure Prometheus' config file to allow it to communicate with the AlertManager.</li> <li>In the Prometheus server configuration, define alert rules.</li> <li>In AlertManager, create an alert mechanism to send alerts via Slack and email.</li> </ul>"},{"location":"chap4/15prometheus/#17-what-is-prometheus-exporter","title":"17 What is Prometheus exporter?","text":"<p>A Prometheus Exporter is a part of software that allows it to fetch statistics from another, non-Prometheus system. </p> <p>It converts those statistics into Prometheus metrics, using a client library. </p> <p>You can start a web server which exposes a /metrics URL, and can see that URL display the system metrics.</p> <p>Prometheus Exporter \u662f\u8f6f\u4ef6\u7684\u4e00\u90e8\u5206\uff0c\u5141\u8bb8\u5b83\u4ece\u53e6\u4e00\u4e2a\u975e Prometheus \u7cfb\u7edf\u83b7\u53d6\u7edf\u8ba1\u4fe1\u606f\u3002\u5b83\u4f7f\u7528\u5ba2\u6237\u7aef\u5e93\u5c06\u8fd9\u4e9b\u7edf\u8ba1\u4fe1\u606f\u8f6c\u6362\u4e3a Prometheus \u6307\u6807\u3002\u60a8\u53ef\u4ee5\u542f\u52a8\u4e00\u4e2a\u516c\u5f00 /metrics URL \u7684 Web \u670d\u52a1\u5668\uff0c\u5e76\u4e14\u53ef\u4ee5\u770b\u5230\u8be5 URL \u663e\u793a\u7cfb\u7edf\u6307\u6807\u3002</p>"},{"location":"chap4/15prometheus/#18-what-is-thanos-prometheus","title":"18 What is Thanos Prometheus?","text":"<p>Thanos is a \"highly available Prometheus setup with long-term storage capability,\" to put it simply. </p> <p>Thanos enables you to query and aggregate data from several Prometheus instances from a single endpoint. </p> <p>Thanos also handles duplicate measurements that may result from several Prometheus instances automatically.</p> <p>\u7b80\u5355\u5730\u8bf4\uff0cThanos \u662f\u201c\u5177\u6709\u957f\u671f\u5b58\u50a8\u80fd\u529b\u7684\u9ad8\u53ef\u7528\u6027 Prometheus \u8bbe\u7f6e\u201d\u3002 Thanos \u4f7f\u60a8\u80fd\u591f\u4ece\u5355\u4e2a\u7aef\u70b9\u67e5\u8be2\u548c\u805a\u5408\u6765\u81ea\u591a\u4e2a Prometheus \u5b9e\u4f8b\u7684\u6570\u636e\u3002 Thanos \u8fd8\u81ea\u52a8\u5904\u7406\u53ef\u80fd\u7531\u591a\u4e2a Prometheus \u5b9e\u4f8b\u4ea7\u751f\u7684\u91cd\u590d\u6d4b\u91cf\u3002</p>"},{"location":"chap4/15prometheus/#19-how-do-i-delete-old-prometheus-data-earlier-than-default-retention-time","title":"19 How do I delete old Prometheus data earlier than default retention time?","text":"<p>You have the option of deleting particular data early.</p> <p>Before you can do so, you must first enable the admin api in Prometheus.</p> <pre><code>sudo nano /etc/default/prometheus\n</code></pre> <p>Add <code>--web.enable-admin-api</code> to the <code>ARGS=\"\"</code> variable.</p> <pre><code>ARGS=\"--web.enable-admin-api\"\n</code></pre> <p>Restart Prometheus and check status.</p> <pre><code>sudo service prometheus restart\nsudo service prometheus status\n</code></pre> <p>You can now make calls to the admin api.</p> <p>Example: Delete all time series for the instance=\"sbcode.net:9100\"</p> <pre><code>curl -X POST -g 'http://localhost:9090/api/v1/admin/tsdb/delete_series?match[]={instance=\"sbcode.net:9100\"}'\n</code></pre> <p>NOTE: Once data is deleted, make sure you should disable the admin api again by following steps:</p> <pre><code>sudo nano /etc/default/prometheus\n</code></pre> <ul> <li>Remove <code>--web.enable-admin-api</code> from the ARGS variable.</li> </ul> <pre><code>ARGS=\"\"\n</code></pre> <ul> <li>Restart Prometheus and check status</li> </ul> <pre><code>sudo service prometheus restart\nsudo service prometheus status\n</code></pre>"},{"location":"chap4/15prometheus/#20-how-do-you-increase-the-time-retention-period-in-prometheus","title":"20 How do you increase the time retention period in Prometheus?","text":"<p>Prometheus metrics are stored for 15 days by default. For troubleshooting purposes, this retention duration may be insufficient.</p> <p>You can increase the time retention period in the Prometheus configuration file as given below:</p> <p>Open the <code>/etc/sysconfig/prometheus</code> file on the management node, update the STORAGE RETENTION option to the required retention duration, and save your modifications.</p> <p>For example:</p> <pre><code>STORAGE_RETENTION=\"--storage.tsdb.retention.time=30d\"\n</code></pre> <p>Restart the Prometheus service:</p> <pre><code>systemctl restart prometheus.service\n</code></pre>"},{"location":"chap4/15prometheus/#21-how-do-you-increase-the-size-retention-policy","title":"21 How do you increase the size retention policy?","text":"<p>If the data is kept for a long time, the root partition where it is stored may run out of space. You can prevent this by setting the Prometheus metrics' maximum size.</p> <p>Open the <code>/etc/sysconfig/prometheus</code> file on the management node, update the STORAGE RETENTION option to the required size retention duration, and save your modifications. For example:</p> <pre><code>STORAGE_RETENTION=\"--storage.tsdb.retention.size=10GB\"\n</code></pre> <ul> <li>estart the Prometheus service</li> </ul> <pre><code>systemctl restart prometheus.service\n</code></pre>"},{"location":"chap4/16jenkins/","title":"16 Top Jenkins Interview Questions and Answers (2022)","text":""},{"location":"chap4/16jenkins/#1-why-to-use-jenkins","title":"1 Why to use Jenkins?","text":"<p>Jenkins is used to continually build and test the software projects, making it easier for developers to integrate changes to the project and for users to get a new build.</p> <p></p>"},{"location":"chap4/16jenkins/#2-what-is-a-jenkins-pipeline","title":"2 What is a Jenkins Pipeline?","text":"<p>This is the user-defined block, which includes all of the processes like build, test, and deploy. </p> <p>It is a set of all JenkinsFile stages.</p> <p>This block contains all of the stages and steps.</p> <p>It's a collection of stages and steps that make Jenkins easier to use for integrating and implementation of continuous delivery pipelines.</p> <pre><code>pipeline{\n// stages\n  //steps\n}  \n</code></pre>"},{"location":"chap4/16jenkins/#3-what-is-jenkins-stage","title":"3 What is Jenkins Stage?","text":"<p>This block includes a pipeline with a series of steps.</p> <p>In other words, a stage is where the build, test, and deploy stages all come together. </p> <p>A stage block is a visual representation of the Jenkins pipeline process. Consider the following example for multiple stages, each of which performs a particular task:</p> <p>\u8fd9\u4e2a\u5757\u5305\u62ec\u4e00\u4e2a\u5e26\u6709\u4e00\u7cfb\u5217\u6b65\u9aa4\u7684\u7ba1\u9053\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u4e00\u4e2a\u9636\u6bb5\u662f\u6784\u5efa\u3001\u6d4b\u8bd5\u548c\u90e8\u7f72\u9636\u6bb5\u90fd\u805a\u96c6\u5728\u4e00\u8d77\u7684\u5730\u65b9\u3002\u9636\u6bb5\u5757\u662f Jenkins \u6d41\u6c34\u7ebf\u8fc7\u7a0b\u7684\u53ef\u89c6\u5316\u8868\u793a\u3002\u8003\u8651\u4ee5\u4e0b\u591a\u4e2a\u9636\u6bb5\u7684\u793a\u4f8b\uff0c\u6bcf\u4e2a\u9636\u6bb5\u6267\u884c\u7279\u5b9a\u4efb\u52a1\uff1a</p> <p></p> <pre><code>pipeline {\n    any agent\n    stages {\n       stage ('Build') {\n           //step...  \n       }\n       stage ('Test') {\n           //step...  \n       }\n       stage ('Deploy') {\n           //step...   \n       }\n       stage ('Monitor') {\n           //step...  \n       }\n    }\n}  \n</code></pre>"},{"location":"chap4/16jenkins/#4-what-is-steps-in-jenkins","title":"4 What is Steps in Jenkins?","text":"<p>A step is a single task that performs a specific task at a specific time. A pipeline is made up of a set of steps that are specified within a stage block</p> <pre><code>pipeline {\n    any agent\n    stages {\n      stage ('Build') {\n          steps {\n                  echo 'Started build phase...'\n          }\n      }\n    }\n}  \n</code></pre>"},{"location":"chap4/16jenkins/#5-what-is-continuous-delivery-pipeline","title":"5 What is Continuous Delivery Pipeline?","text":"<p>A Jenkins continuous delivery pipeline is depicted in the diagram below. It has a number of states, including build, deploy, test, and release. These jobs or events are connected in some way. Every state has its own set of jobs and works in a sequence called a continuous delivery pipeline.</p> <p></p> <p>Continuous delivery (CD) and continuous integration provide a complete process for delivering code packages. </p> <p>At this stage, automated build tools are used to compile the artifacts and make them ready for delivery to end users.</p> <p>Its goal is to make software build, test, and release faster and more frequently. This approach can reduce the cost and time of software development and reduce risks.</p>"},{"location":"chap4/16jenkins/#6-what-is-the-use-of-jenkinsfile-in-jenkins-tool","title":"6 What is the use of JenkinsFile in Jenkins tool?","text":"<p>JenkinsFile is a text file, used to define Jenkins Pipeline steps. JenkinsFile can be used to implement pipelines as code, and this can be described using a DSL (Domain Specific Language). You may use JenkinsFile to write down the steps needed to run a Jenkins Pipeline.</p>"},{"location":"chap4/16jenkins/#7-what-is-jenkins-job-dsl","title":"7: What is Jenkins Job DSL?","text":"<p>Jenkins Job DSL (Domain Specific Language) is a plugin that enables us to programmatically define jobs with relatively little effort. The Jenkins job DSL plugin was designed to make job management easier.</p>"},{"location":"chap4/17devops_int2023/","title":"DevOps Engineer: 30+ Interview Questions and Answers","text":"<p>https://mp.weixin.qq.com/s/ZJm_dVF4T7CLLtZre_UcMg</p> <p>1. How much do you know about DevOps?</p> <p>The words \"Developer\" and \"Operator\" are combined to form the term \"DevOps\".</p> <p>Developers and Operators are two separate teams working together to get the app ready.</p> <p>The people who develop the application are called \"developers\", and the operators set up and operate the application on the server. </p> <p>In previous years, not many updates were required after the application was created and launched. Everyone's happy these days because it's going to take too long to update and adjust software to accommodate changes. Development and operations thus diverge. However, modern apps have been constantly updated in recent years. Newer redundancy required the development of a new process culture, giving rise to DevOps.</p> <p>By coordinating and orchestrating software development and IT operations, businesses can design and deliver applications and services using a set of adaptive practices and processes known as DevOps.</p> <p>\u201cDeveloper\u201d\u548c\u201cOperator\u201d\u8fd9\u4e24\u4e2a\u8bcd\u7ec4\u5408\u8d77\u6765\u5f62\u6210\u672f\u8bed\u201cDevOps\u201d\u3002</p> <p>\u5f00\u53d1\u4eba\u5458\u548c\u8fd0\u8425\u5546\u662f\u4e24\u4e2a\u72ec\u7acb\u7684\u56e2\u961f\uff0c\u5171\u540c\u52aa\u529b\u51c6\u5907\u597d\u5e94\u7528\u7a0b\u5e8f\u3002 \u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f\u7684\u4eba\u79f0\u4e3a\u201c\u5f00\u53d1\u4eba\u5458\u201d\uff0c\u8fd0\u8425\u4eba\u5458\u5728\u670d\u52a1\u5668\u4e0a\u8bbe\u7f6e\u5e76\u8fd0\u7ef4\u6b64\u5e94\u7528\u7a0b\u5e8f\u3002\u524d\u51e0\u5e74\uff0c\u521b\u5efa\u5e76\u542f\u52a8\u5e94\u7528\u7a0b\u5e8f\u540e\u4e0d\u9700\u8981\u8fdb\u884c\u592a\u591a\u66f4\u65b0\u3002\u8fd9\u4e9b\u5929\u6bcf\u4e2a\u4eba\u90fd\u5f88\u9ad8\u5174\uff0c\u56e0\u4e3a\u66f4\u65b0\u548c\u8c03\u6574\u8f6f\u4ef6\u4ee5\u9002\u5e94\u53d8\u5316\u5c06\u82b1\u8d39\u592a\u957f\u65f6\u95f4\u3002\u5f00\u53d1\u548c\u8fd0\u8425\u56e0\u6b64\u4ea7\u751f\u5206\u6b67\u3002\u7136\u800c\uff0c\u73b0\u4ee3\u8fd1\u5e74\u6765\u5e94\u7528\u4e0d\u65ad\u66f4\u65b0\u3002\u66f4\u65b0\u7684\u5197\u4f59\u6027\u8981\u6c42\u5f00\u53d1\u65b0\u7684\u6d41\u7a0b\u6587\u5316\uff0c\u4ece\u800c\u50ac\u751f\u4e86 DevOps\u3002</p> <p>\u901a\u8fc7\u534f\u8c03\u548c\u7f16\u6392\u8f6f\u4ef6\u5f00\u53d1\u4e0e IT \u8fd0\u8425\uff0c\u4f01\u4e1a\u53ef\u4ee5\u4f7f\u7528\u4e00\u7ec4\u79f0\u4e3a DevOps \u7684\u9002\u5e94\u6027\u5b9e\u8df5\u548c\u6d41\u7a0b\u6765\u8bbe\u8ba1\u548c\u4ea4\u4ed8\u5e94\u7528\u7a0b\u5e8f\u548c\u670d\u52a1\u3002</p> <p>\u5f53\u5f00\u53d1\u548c\u8fd0\u8425\u56e2\u961f\u534f\u4f5c\u65f6\uff0c\u4ed6\u4eec\u53ef\u4ee5\u51cf\u5c11\u969c\u788d\u5e76\u6539\u8fdb\u8f6f\u4ef6\u521b\u5efa\u3001\u5206\u53d1\u548c\u76d1\u63a7\u3002 \u901a\u4fd7\u5730\u8bf4\uff0c\u5b83\u6d88\u9664\u4e86\u4ee5\u524d\u963b\u788d\u4ed6\u4eec\u7684\u969c\u788d\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u6301\u7eed\u4ea4\u4ed8\u4f18\u8d28\u8f6f\u4ef6\u529f\u80fd\u548c\u5e94\u7528\u7a0b\u5e8f (CI/CD)\u3002</p> <p>2. What is the difference between DevOps and Agile methodologies?  DevOps \u548c\u654f\u6377\u65b9\u6cd5\u6709\u4ec0\u4e48\u533a\u522b\uff1f</p> <p>A DevOps culture fosters collaboration between development and operations workgroups. Therefore, software is continuously developed, tested, integrated, deployed and monitored throughout its life cycle. DevOps resolves issues and disagreements between IT operations and developers.</p> <p>Agile is a software development methodology that emphasizes customer feedback and iterative, incremental, small and rapid software releases. It resolves disagreements and disputes between clients and developers.</p> <p>DevOps \u6587\u5316\u4fc3\u8fdb\u5f00\u53d1\u548c\u8fd0\u8425\u5de5\u4f5c\u7ec4\u4e4b\u95f4\u7684\u5408\u4f5c\u3002\u56e0\u6b64\uff0c\u8f6f\u4ef6\u5728\u5176\u6574\u4e2a\u751f\u547d\u5468\u671f\u4e2d\u4e0d\u65ad\u5f00\u53d1\u3001\u6d4b\u8bd5\u3001\u96c6\u6210\u3001\u90e8\u7f72\u548c\u76d1\u63a7\u3002DevOps \u89e3\u51b3 IT \u8fd0\u8425\u548c\u5f00\u53d1\u4eba\u5458\u4e4b\u95f4\u7684\u95ee\u9898\u548c\u5206\u6b67\u3002</p> <p>\u654f\u6377\u662f\u4e00\u79cd\u5f3a\u8c03\u5ba2\u6237\u53cd\u9988\u548c\u8fed\u4ee3\u3001\u589e\u91cf\u3001\u5c0f\u800c\u5feb\u901f\u7684\u8f6f\u4ef6\u53d1\u5e03\u7684\u8f6f\u4ef6\u5f00\u53d1\u65b9\u6cd5\u3002\u5b83\u89e3\u51b3\u4e86\u5ba2\u6237\u548c\u5f00\u53d1\u4eba\u5458\u4e4b\u95f4\u7684\u5206\u6b67\u548c\u7ea0\u7eb7\u3002</p> <p>3. Which DevOps tools are most widely used?</p> <p>The most common DevOps tools are:</p> <ul> <li>Saltstack</li> <li>Puppet</li> <li>Chef</li> <li>Git</li> <li>Jenkins</li> <li>Ansible</li> <li>Docker</li> <li>SonarQube</li> <li>Nexus/Artifactory</li> <li>Harbor</li> <li>Kubernetes</li> <li>Maven/Gradle</li> </ul> <p>4. How many stages are there in DevOps?</p> <p>The DevOps lifecycle has eight phases:</p> <ul> <li>Planning: A detailed application type plan is required to fully understand the development process.</li> <li>Code: The program is coded according to the requirements of the end user.</li> <li>Build: Create the application by merging the code generated by the previous stages.</li> <li>Testing: This is the most important stage in the application creation process. Check the functionality of the application and rewrite it if something goes wrong.</li> <li>Integration: Multiple codes from different programmers are combined into one code.</li> <li>Deployment: Publishing code in the cloud for use by other users. New updates are thoroughly checked to make sure they don't break high-traffic sites.</li> <li>Action: Manipulate the code if necessary.</li> <li>Monitoring: The running of the application is always monitored. The needs of the final consumer are prioritized and adjusted accordingly.</li> </ul> <p>DevOps \u751f\u547d\u5468\u671f\u6709\u516b\u4e2a\u9636\u6bb5\uff1a</p> <ul> <li>\u8ba1\u5212\uff1a\u9700\u8981\u8be6\u7ec6\u7684\u5e94\u7528\u7c7b\u578b\u8ba1\u5212\uff0c\u4ee5\u4fbf\u5168\u9762\u4e86\u89e3\u5f00\u53d1\u8fc7\u7a0b\u3002</li> <li>\u4ee3\u7801\uff1a\u7a0b\u5e8f\u6839\u636e\u6700\u7ec8\u7528\u6237\u7684\u8981\u6c42\u8fdb\u884c\u7f16\u7801\u3002</li> <li>\u6784\u5efa\uff1a\u901a\u8fc7\u5408\u5e76\u524d\u9762\u9636\u6bb5\u751f\u6210\u7684\u4ee3\u7801\u6765\u521b\u5efa\u5e94\u7528\u7a0b\u5e8f\u3002</li> <li>\u6d4b\u8bd5\uff1a\u8fd9\u662f\u5e94\u7528\u7a0b\u5e8f\u521b\u5efa\u8fc7\u7a0b\u4e2d\u6700\u91cd\u8981\u7684\u9636\u6bb5\u3002\u68c0\u67e5\u5e94\u7528\u7a0b\u5e8f\u7684\u529f\u80fd\uff0c\u5982\u679c\u51fa\u73b0\u95ee\u9898\u5219\u91cd\u5199\u5b83\u3002</li> <li>\u96c6\u6210\uff1a\u6765\u81ea\u4e0d\u540c\u7a0b\u5e8f\u5458\u7684\u591a\u4e2a\u4ee3\u7801\u88ab\u7ec4\u5408\u6210\u4e00\u4e2a\u4ee3\u7801\u3002</li> <li>\u90e8\u7f72\uff1a\u5728\u4e91\u8ba1\u7b97\u4e2d\u53d1\u5e03\u4ee3\u7801\u4f9b\u5176\u4ed6\u7528\u6237\u4f7f\u7528\u3002\u65b0\u7684\u66f4\u65b0\u90fd\u4f1a\u7ecf\u8fc7\u5f7b\u5e95\u68c0\u67e5\uff0c\u4ee5\u786e\u4fdd\u5b83\u4eec\u4e0d\u4f1a\u7834\u574f\u9ad8\u6d41\u91cf\u7684\u7f51\u7ad9\u3002</li> <li>\u64cd\u4f5c\uff1a\u5982\u679c\u9700\u8981\uff0c\u5bf9\u4ee3\u7801\u8fdb\u884c\u64cd\u4f5c\u3002</li> <li>\u76d1\u63a7\uff1a\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\u59cb\u7ec8\u53d7\u5230\u76d1\u63a7\u3002\u6700\u7ec8\u6d88\u8d39\u8005\u7684\u9700\u6c42\u88ab\u4f18\u5148\u8003\u8651\uff0c\u5e76\u505a\u51fa\u76f8\u5e94\u7684\u8c03\u6574\u3002</li> </ul> <p>5. Describe some of the main benefits of DevOps</p> <p>The main benefits of DevOps are:</p> <ul> <li>Continuous delivery of software</li> <li>Fewer complex issues to deal with</li> <li>Identify defects earlier and fix them faster</li> <li>Deliver features faster</li> <li>reliable working conditions</li> <li>Enhance teamwork and communication</li> </ul> <p>DevOps \u7684\u4e3b\u8981\u4f18\u70b9\u662f\uff1a</p> <ul> <li>\u6301\u7eed\u4ea4\u4ed8\u8f6f\u4ef6</li> <li>\u9700\u8981\u5904\u7406\u7684\u590d\u6742\u95ee\u9898\u66f4\u5c11</li> <li>\u66f4\u65e9\u8bc6\u522b\u5e76\u66f4\u5feb\u901f\u4fee\u590d\u7f3a\u9677</li> <li>\u66f4\u5feb\u5730\u4ea4\u4ed8\u529f\u80fd</li> <li>\u53ef\u9760\u7684\u5de5\u4f5c\u6761\u4ef6</li> <li>\u589e\u5f3a\u56e2\u961f\u5408\u4f5c\u548c\u6c9f\u901a</li> </ul> <p>6. What is Continuous Integration (CI)?</p> <p>\u5f00\u53d1\u4eba\u5458\u8fdb\u884c\u7f16\u7801\uff0c\u7136\u540e\u4f7f\u7528\u6301\u7eed\u96c6\u6210\uff08CI\uff09\u65b9\u6cd5\u5c06\u5176\u4ee3\u7801\u7ec4\u5408\u5230\u4e3b\u5b58\u50a8\u5e93\u4e2d\u3002\u6bcf\u4e2a\u96c6\u6210\u90fd\u4f1a\u901a\u8fc7\u81ea\u52a8\u6784\u5efa\u8fc7\u7a0b\u8fdb\u884c\u68c0\u67e5\uff0c\u4f7f\u56e2\u961f\u80fd\u591f\u6bd4\u53d1\u5e03\u540e\u66f4\u5feb\u5730\u53d1\u73b0\u4ee3\u7801\u4e2d\u7684\u9519\u8bef\u3002</p> <p>Developers code and then combine their code into the master repository using a continuous integration (CI) approach. </p> <p>Every integration is checked through an automated build process, enabling teams to find bugs in code faster than after release.</p> <p></p> <ol> <li>What is the difference between Continuous Delivery and Continuous Deployment?</li> </ol> <p>Continuous Delivery \u6301\u7eed\u4ea4\u4ed8 </p> <ul> <li>Make sure your code is safe to put into production.</li> <li>Guarantees the intended functionality of applications and services</li> <li> <ul> <li>Deliver every modification to a production-like environment with rigorous automated testing </li> </ul> </li> <li>\u786e\u4fdd\u4ee3\u7801\u53ef\u4ee5\u5b89\u5168\u5730\u6295\u5165\u751f\u4ea7\u3002</li> <li>\u4fdd\u8bc1\u5e94\u7528\u7a0b\u5e8f\u548c\u670d\u52a1\u7684\u9884\u671f\u529f\u80fd\u3002   </li> <li>\u901a\u8fc7\u4e25\u683c\u7684\u81ea\u52a8\u5316\u6d4b\u8bd5\u5c06\u6bcf\u6b21\u4fee\u6539\u4ea4\u4ed8\u5230\u7c7b\u4f3c\u751f\u4ea7\u7684\u73af\u5883\u4e2d</li> </ul> <p>Continuous Deployment \u6301\u7eed\u90e8\u7f72</p> <ul> <li>Every update that succeeds in automated testing is automatically deployed to production.</li> <li>Improve the speed and reliability of software development and release.</li> <li> <p>In the absence of such public developer buy-in, monitoring practices are always in place.</p> </li> <li> <p>\u5728\u81ea\u52a8\u5316\u6d4b\u8bd5\u4e2d\u6210\u529f\u7684\u6bcf\u4e2a\u66f4\u65b0\u90fd\u4f1a\u81ea\u52a8\u90e8\u7f72\u5230\u751f\u4ea7\u4e2d</p> </li> <li>\u63d0\u9ad8\u8f6f\u4ef6\u5f00\u53d1\u548c\u53d1\u5e03\u7684\u901f\u5ea6\u548c\u53ef\u9760\u6027\u3002</li> <li>\u5728\u7f3a\u4e4f\u8fd9\u79cd\u516c\u5f00\u7684\u5f00\u53d1\u4eba\u5458\u8ba4\u53ef\u7684\u60c5\u51b5\u4e0b\uff0c\u59cb\u7ec8\u4f1a\u5efa\u7acb\u76d1\u63a7\u5b9e\u8df5\u3002</li> </ul> <p>8. What role does AWS play in DevOps?</p> <p>AWS plays the following roles in DevOps:</p> <ul> <li>Flexible Services: Provides elastic, fully provisioned services with no software to install or configure.</li> <li>Built to scale: AWS services support scaling from a single instance to multiple instances.</li> <li>Automation: Automate tasks and processes with AWS, giving you more time to innovate.</li> <li>Security: AWS Identity and Access Management (IAM) supports configuring user permissions and policies.</li> <li>Huge partner ecosystem: AWS offers a sizable technology platform that can integrate and extend the functionality of AWS services.</li> </ul> <p>AWS \u5728 DevOps \u4e2d\u626e\u6f14\u4ee5\u4e0b\u89d2\u8272\uff1a</p> <ul> <li>\u7075\u6d3b\u7684\u670d\u52a1\uff1a\u63d0\u4f9b\u5f39\u6027\u3001\u5145\u5206\u51c6\u5907\u7684\u670d\u52a1\uff0c\u65e0\u9700\u5b89\u88c5\u6216\u914d\u7f6e\u8f6f\u4ef6\u3002</li> <li>\u4e13\u4e3a\u6269\u5c55\u800c\u6784\u5efa\uff1aAWS \u670d\u52a1\u652f\u6301\u4ece\u5355\u4e2a\u5b9e\u4f8b\u6269\u5c55\u5230\u591a\u4e2a\u5b9e\u4f8b\u3002</li> <li>\u81ea\u52a8\u5316\uff1a\u4f7f\u7528 AWS \u5b9e\u73b0\u4efb\u52a1\u548c\u6d41\u7a0b\u81ea\u52a8\u5316\uff0c\u8ba9\u60a8\u6709\u66f4\u591a\u65f6\u95f4\u8fdb\u884c\u521b\u65b0\u3002</li> <li>\u5b89\u5168\uff1aAWS Identity and Access Management (IAM)\u652f\u6301\u914d\u7f6e\u7528\u6237\u6743\u9650\u548c\u7b56\u7565\u3002</li> <li>\u5e9e\u5927\u7684\u5408\u4f5c\u4f19\u4f34\u751f\u6001\u7cfb\u7edf\uff1aAWS\u63d0\u4f9b\u4e86\u4e00\u4e2a\u76f8\u5f53\u5927\u7684\u6280\u672f\u5e73\u53f0\uff0c\u53ef\u4ee5\u96c6\u6210\u548c\u6269\u5c55AWS\u670d\u52a1\u7684\u529f\u80fd\u3002</li> </ul> <p>9. What is version control?</p> <p>Version control, often called source code control, is the act of monitoring and controlling modifications to software code.</p> <p>With version control, you can:</p> <ul> <li>Restores the state of the file to its previous state.</li> <li>Reverts the entire state of the project to its previous state.</li> <li>Compare evolution over time.</li> <li>Check who last changed something that could be problematic.</li> <li>Who and when initiated the issue?</li> </ul> <p>\u7248\u672c\u63a7\u5236\u901a\u5e38\u79f0\u4e3a\u6e90\u4ee3\u7801\u63a7\u5236\uff0c\u662f\u76d1\u89c6\u548c\u63a7\u5236\u5bf9\u8f6f\u4ef6\u4ee3\u7801\u7684\u4fee\u6539\u7684\u884c\u4e3a\u3002</p> <p>\u4f7f\u7528\u7248\u672c\u63a7\u5236\uff0c\u60a8\u53ef\u4ee5\uff1a</p> <ul> <li>\u5c06\u6587\u4ef6\u7684\u72b6\u6001\u6062\u590d\u5230\u4e4b\u524d\u7684\u72b6\u6001\u3002</li> <li>\u5c06\u9879\u76ee\u7684\u6574\u4e2a\u72b6\u6001\u6062\u590d\u5230\u4e4b\u524d\u7684\u72b6\u6001\u3002</li> <li>\u6bd4\u8f83\u968f\u65f6\u95f4\u7684\u6f14\u53d8\u3002</li> <li>\u68c0\u67e5\u8c01\u6700\u540e\u66f4\u6539\u4e86\u53ef\u80fd\u6709\u95ee\u9898\u7684\u5185\u5bb9\u3002</li> <li>\u8c01\u4ee5\u53ca\u4f55\u65f6\u53d1\u8d77\u4e86\u95ee\u9898\uff1f</li> </ul> <p>10.\u4f7f\u7528\u7248\u672c\u63a7\u5236\u6709\u4ec0\u4e48\u597d\u5904\uff1f</p> <p>I suggest you list the benefits of version control as follows:</p> <ul> <li>A version control system (VCS) enables all team members to work on each file independently at any time. You can later use VCS to merge all the changes into one release.</li> <li>VCS neatly organizes all previous iterations and variants. You can request any version whenever you need it, giving you instant access to screenshots of your entire project.</li> <li>Every time you save an updated version of your project, your VCS asks you to enter a short summary of the changes you made. Additionally, you can view the contents of the file to determine what changes have been made. From this you can determine who changed the content of the project.</li> <li>If the central server goes down, you can use any team member's local Git repository because a distributed VCS like Git gives all team members access to the entire project history.</li> </ul> <p>\u6211\u5efa\u8bae\u60a8\u5217\u51fa\u7248\u672c\u63a7\u5236\u7684\u597d\u5904\u5982\u4e0b\uff1a</p> <ul> <li>\u7248\u672c\u63a7\u5236\u7cfb\u7edf(VCS)\u4f7f\u6240\u6709\u56e2\u961f\u6210\u5458\u80fd\u591f\u968f\u65f6\u72ec\u7acb\u5904\u7406\u6bcf\u4e2a\u6587\u4ef6 \u3002\u60a8\u7a0d\u540e\u53ef\u4ee5\u4f7f\u7528 VCS \u5c06\u6240\u6709\u66f4\u6539\u5408\u5e76\u5230\u4e00\u4e2a\u7248\u672c\u4e2d\u3002</li> <li>VCS \u6574\u9f50\u5730\u7ec4\u7ec7\u4e86\u4e4b\u524d\u7684\u6240\u6709\u8fed\u4ee3\u548c\u53d8\u4f53\u3002\u60a8\u53ef\u4ee5\u5728\u9700\u8981\u65f6\u968f\u65f6\u7d22\u53d6\u4efb\u4f55\u7248\u672c\uff0c\u4ece\u800c\u53ef\u4ee5\u7acb\u5373\u8bbf\u95ee\u6574\u4e2a\u9879\u76ee\u7684\u5c4f\u5e55\u622a\u56fe\u3002</li> <li>\u6bcf\u6b21\u4fdd\u5b58\u9879\u76ee\u7684\u66f4\u65b0\u7248\u672c\u65f6\uff0c\u60a8\u7684 VCS \u90fd\u8981\u6c42\u60a8\u8f93\u5165\u6240\u505a\u66f4\u6539\u7684\u7b80\u77ed\u6458\u8981\u3002\u6b64\u5916\uff0c\u60a8\u53ef\u4ee5\u67e5\u770b\u6587\u4ef6\u7684\u5185\u5bb9\u4ee5\u786e\u5b9a\u8fdb\u884c\u4e86\u54ea\u4e9b\u66f4\u6539\u3002\u7531\u6b64\u60a8\u53ef\u4ee5\u786e\u5b9a\u8c01\u6539\u53d8\u4e86\u9879\u76ee\u7684\u5185\u5bb9\u3002</li> <li>\u5982\u679c\u4e2d\u592e\u670d\u52a1\u5668\u51fa\u73b0\u6545\u969c\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u56e2\u961f\u6210\u5458\u7684\u672c\u5730 Git \u5b58\u50a8\u5e93\uff0c\u56e0\u4e3a\u50cf Git \u8fd9\u6837\u7684\u5206\u5e03\u5f0f VCS \u4f7f\u6240\u6709\u56e2\u961f\u6210\u5458\u90fd\u53ef\u4ee5\u8bbf\u95ee\u6574\u4e2a\u9879\u76ee\u5386\u53f2\u8bb0\u5f55\u3002</li> </ul> <p>11. What is the function of SSH?</p> <p>Secure Shell (or SSH) is a command-line management protocol that enables users to connect to and control remote servers over a network.</p> <p>The secure encrypted SSH protocol replaces the previously popular and insecure Telnet. By doing this, you can ensure that communication with the remote server is encrypted.</p> <p>Secure Shell\uff08\u6216 SSH\uff09\u662f\u4e00\u79cd\u547d\u4ee4\u884c\u7ba1\u7406\u534f\u8bae\uff0c\u4f7f\u7528\u6237\u80fd\u591f\u901a\u8fc7\u7f51\u7edc\u8fde\u63a5\u548c\u63a7\u5236\u8fdc\u7a0b\u670d\u52a1\u5668\u3002</p> <p>\u5b89\u5168\u52a0\u5bc6\u7684SSH\u534f\u8bae\u53d6\u4ee3\u4e86\u4ee5\u524d\u6d41\u884c\u4e14\u4e0d\u5b89\u5168\u7684Telnet\u3002\u901a\u8fc7\u8fd9\u6837\u505a\uff0c\u53ef\u4ee5\u786e\u4fdd\u4e0e\u8fdc\u7a0b\u670d\u52a1\u5668\u7684\u901a\u4fe1\u662f\u52a0\u5bc6\u7684\u3002</p> <p>12.How to push files from local computer to GitHub repository using Git? \u5982\u4f55\u4f7f\u7528 Git \u5c06\u6587\u4ef6\u4ece\u672c\u5730\u8ba1\u7b97\u673a\u63a8\u9001\u5230 GitHub \u5b58\u50a8\u5e93\uff1f</p> <ul> <li>Step 1: Link the local repository to the remote repository: <code>git remote add origin [web addr.]</code><ul> <li>(Example: <code>git remote add https://github.com/file.git</code>)</li> </ul> </li> <li> <p>Step 2: Push the files to the remote repository: <code>git push origin master</code></p> </li> <li> <p>\u6b65\u9aa4 1\uff1a\u5c06\u672c\u5730\u5b58\u50a8\u5e93\u94fe\u63a5\u5230\u8fdc\u7a0b\u5b58\u50a8\u5e93\uff1a<code>git remote add origin [web addr.]</code>    \uff08\u793a\u4f8b\uff1a<code>git remote add https://github.com/file.git</code>\uff09</p> </li> <li>\u6b65\u9aa4 2\uff1a\u5c06\u6587\u4ef6\u63a8\u9001\u5230\u8fdc\u7a0b\u5b58\u50a8\u5e93\uff1a<code>git push origin master</code>\u3002</li> </ul> <p>13.Describe the Git branching concept.</p> <p>Imagine you are working on an application and plan to add new features to it. New features can be built on new branches that you create.</p> <ul> <li>The default working branch is always the master branch.</li> <li>Different branch commits are indicated by circles on the branches.</li> <li>Once you've made all your changes, you can merge them into the master branch.</li> </ul> <p></p> <p>\u60f3\u8c61\u4e00\u4e0b\u60a8\u6b63\u5728\u5236\u4f5c\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5e76\u8ba1\u5212\u4e3a\u5176\u6dfb\u52a0\u65b0\u529f\u80fd\u3002\u65b0\u529f\u80fd\u53ef\u4ee5\u6784\u5efa\u5728\u60a8\u521b\u5efa\u7684\u65b0\u5206\u652f\u4e0a\u3002</p> <ul> <li>\u9ed8\u8ba4\u5de5\u4f5c\u5206\u652f\u59cb\u7ec8\u662f master \u5206\u652f\u3002</li> <li>\u4e0d\u540c\u7684\u5206\u652f\u627f\u8bfa\u7531\u5206\u652f\u4e0a\u7684\u5706\u5708\u8868\u793a\u3002</li> <li>\u5b8c\u6210\u6240\u6709\u66f4\u6539\u540e\uff0c\u60a8\u53ef\u4ee5\u5c06\u5176\u5408\u5e76\u5230\u4e3b\u5206\u652f\u3002</li> </ul> <p>14. What are the three most important KPIs for DevOps?</p> <p>A few DevOps KPIs are listed below: DevOps \u7684\u4e09\u4e2a\u6700\u91cd\u8981\u7684 KPI \u662f\u4ec0\u4e48\uff1f\u4e0b\u9762\u5217\u51fa\u4e86\u51e0\u4e2a DevOps KPI\uff1a</p> <ul> <li>Reduces the time required to recover from failures on average.</li> <li>Increase the frequency of deployments.</li> <li> <p>Reduce deployment failure rate.</p> </li> <li> <p>\u5e73\u5747\u51cf\u5c11\u4ece\u6545\u969c\u4e2d\u6062\u590d\u6240\u9700\u7684\u65f6\u95f4\u3002</p> </li> <li>\u589e\u52a0\u90e8\u7f72\u7684\u9891\u7387\u3002</li> <li>\u964d\u4f4e\u90e8\u7f72\u5931\u8d25\u7387\u3002</li> </ul> <p>15. How does Ansible work?</p> <p>There are two different categories of servers in Ansible:</p> <ul> <li>Control the machine</li> <li>node</li> </ul> <p>Ansible must be installed on the control computer to manage nodes using SSH. The manifest of the control machine will specify and configure the location of the nodes.</p> <p>Due to the agentless nature of Ansible, no installation is required on the server hosting the remote nodes. Therefore, there is no need to run any background processes while managing remote nodes.</p> <p>With Ansible Playbook and SSH connections, Ansible can control multiple nodes from a single system. Playbooks can perform various tasks and are in YAML format.</p> <p>Ansible \u4e2d\u7684\u670d\u52a1\u5668\u6709\u4e24\u79cd\u4e0d\u540c\u7684\u7c7b\u522b\uff1a</p> <p>\u2022 \u63a7\u5236\u673a\u5668</p> <p>\u2022 \u8282\u70b9</p> <p>Ansible \u5fc5\u987b\u5b89\u88c5\u5728\u63a7\u5236\u8ba1\u7b97\u673a\u4e0a\u624d\u80fd\u4f7f\u7528 SSH \u6765\u7ba1\u7406\u8282\u70b9\u3002\u63a7\u5236\u673a\u5668\u7684\u6e05\u5355\u5c06\u6307\u5b9a\u548c\u914d\u7f6e\u8282\u70b9\u7684\u4f4d\u7f6e\u3002</p> <p>\u7531\u4e8e Ansible \u7684\u65e0\u4ee3\u7406\u7279\u6027\uff0c\u65e0\u9700\u5728\u6258\u7ba1\u8fdc\u7a0b\u8282\u70b9\u7684\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u5b89\u88c5\u3002\u56e0\u6b64\uff0c\u65e0\u9700\u5728\u7ba1\u7406\u8fdc\u7a0b\u8282\u70b9\u65f6\u8fd0\u884c\u4efb\u4f55\u540e\u53f0\u8fdb\u7a0b\u3002</p> <p>\u501f\u52a9 Ansible Playbook \u548c SSH \u8fde\u63a5\uff0cAnsible \u53ef\u4ee5\u4ece\u5355\u4e2a\u7cfb\u7edf\u63a7\u5236\u591a\u4e2a\u8282\u70b9\u3002Playbook \u53ef\u4ee5\u6267\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5e76\u4e14\u91c7\u7528 YAML \u683c\u5f0f\u3002</p> <p>16. What is Continuous Testing (CT)?</p> <p>Continuous testing (CT) is a DevOps phase that requires running automated test cases, which are components of an automated software delivery pipeline. This is a way to receive immediate feedback on the performance of the code being developed and the validation of any business risks.</p> <p>CT is the DevOps step that consists of executing automated test cases as part of the pipeline in order to receive quick feedback on the quality and validation of company risks associated with automatically generated code.</p> <p>By using this stage, the team will be able to continuously test each build (once the developed code is pushed), giving the development team the opportunity to receive immediate feedback on their work, and preventing these issues from recurring later in the SDLC.</p> <p>Doing so will significantly speed up a developer's workflow for developing a project by eliminating the manual involvement steps required to rebuild the project and execute automated tests every time a change occurs.</p> <p>\u6301\u7eed\u6d4b\u8bd5 (CT) \u662f\u9700\u8981\u8fd0\u884c\u81ea\u52a8\u5316\u6d4b\u8bd5\u7528\u4f8b\u7684 DevOps \u9636\u6bb5\uff0c\u6d4b\u8bd5\u7528\u4f8b\u662f\u81ea\u52a8\u5316\u8f6f\u4ef6\u4ea4\u4ed8\u7ba1\u9053\u7684\u7ec4\u4ef6\u3002\u8fd9\u662f\u4e00\u79cd\u63a5\u6536\u6709\u5173\u6240\u5f00\u53d1\u4ee3\u7801\u7684\u6027\u80fd\u548c\u4efb\u4f55\u4e1a\u52a1\u98ce\u9669\u9a8c\u8bc1\u7684\u5373\u65f6\u53cd\u9988\u7684\u65b9\u6cd5\u3002</p> <p>CT \u662f DevOps \u6b65\u9aa4\uff0c\u5305\u62ec\u4f5c\u4e3a\u7ba1\u9053\u7684\u4e00\u90e8\u5206\u6267\u884c\u81ea\u52a8\u5316\u6d4b\u8bd5\u7528\u4f8b\uff0c\u4ee5\u4fbf\u63a5\u6536\u6709\u5173\u4e0e\u81ea\u52a8\u751f\u6210\u4ee3\u7801\u76f8\u5173\u7684\u516c\u53f8\u98ce\u9669\u7684\u8d28\u91cf\u548c\u9a8c\u8bc1\u7684\u5feb\u901f\u53cd\u9988\u3002</p> <p>\u901a\u8fc7\u4f7f\u7528\u6b64\u9636\u6bb5\uff0c\u56e2\u961f\u5c06\u80fd\u591f\u8fde\u7eed\u6d4b\u8bd5\u6bcf\u4e2a\u6784\u5efa\uff08\u4e00\u65e6\u5f00\u53d1\u7684\u4ee3\u7801\u88ab\u63a8\u9001\uff09\uff0c\u4f7f\u5f00\u53d1\u56e2\u961f\u6709\u673a\u4f1a\u6536\u5230\u6709\u5173\u5176\u5de5\u4f5c\u7684\u5373\u65f6\u53cd\u9988\uff0c\u5e76\u9632\u6b62\u8fd9\u4e9b\u95ee\u9898\u7a0d\u540e\u5728 SDLC \u4e2d\u51fa\u73b0\u5faa\u73af\u3002</p> <p>\u7531\u4e8e\u4e0d\u9700\u8981\u5728\u6bcf\u6b21\u53d1\u751f\u66f4\u6539\u65f6\u91cd\u5efa\u9879\u76ee\u548c\u6267\u884c\u81ea\u52a8\u5316\u6d4b\u8bd5\u6240\u9700\u7684\u624b\u52a8\u53c2\u4e0e\u6b65\u9aa4\uff0c\u56e0\u6b64\u8fd9\u6837\u505a\u5c06\u663e\u7740\u52a0\u5feb\u5f00\u53d1\u4eba\u5458\u5f00\u53d1\u9879\u76ee\u7684\u5de5\u4f5c\u6d41\u7a0b\u3002</p> <p>17. Can you differentiate between continuous testing and automated testing?</p> <p>Here are the differences:</p> <p>continuous testing </p> <ul> <li>All automated test cases are run through this process as part of the delivery process. </li> <li>This process replaces manual testing by helping developers create test cases that can be executed repeatedly without manual involvement.</li> <li>\u6240\u6709\u81ea\u52a8\u5316\u6d4b\u8bd5\u7528\u4f8b\u90fd\u4f5c\u4e3a\u4ea4\u4ed8\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\u901a\u8fc7\u6b64\u8fc7\u7a0b\u8fd0\u884c\u3002</li> <li>\u6b64\u8fc7\u7a0b\u91cd\u70b9\u5173\u6ce8\u4e0e\u6700\u65e9\u53ef\u80fd\u7684\u8f6f\u4ef6\u53d1\u5e03\u76f8\u5173\u7684\u5546\u4e1a\u98ce\u9669\u3002</li> </ul> <p>automated testing</p> <ul> <li>This process focuses on the business risks associated with the earliest possible software releases. </li> <li>Using a set of pass/fail positions as a guide, this process enables developers to determine whether the functionality they create is bug-free.</li> <li>\u6b64\u8fc7\u7a0b\u901a\u8fc7\u5e2e\u52a9\u5f00\u53d1\u4eba\u5458\u521b\u5efa\u65e0\u9700\u624b\u52a8\u53c2\u4e0e\u5373\u53ef\u91cd\u590d\u6267\u884c\u7684\u6d4b\u8bd5\u7528\u4f8b\u6765\u53d6\u4ee3\u624b\u52a8\u6d4b\u8bd5</li> <li> <p>\u4f7f\u7528\u4e00\u7ec4\u901a\u8fc7/\u5931\u8d25\u4f4d\u7f6e\u4f5c\u4e3a\u6307\u5bfc\uff0c\u6b64\u8fc7\u7a0b\u4f7f\u5f00\u53d1\u4eba\u5458\u80fd\u591f\u786e\u5b9a\u4ed6\u4eec\u521b\u5efa\u7684\u529f\u80fd\u662f\u5426\u6ca1\u6709\u9519\u8bef\u3002</p> </li> <li> <p>Explain the master-slave architecture of Jenkins.</p> </li> <li> <p>Every time code is committed, the Jenkins master retrieves the updated code from the remote GitHub repository.</p> </li> <li>It spreads the workload across all Jenkins slaves.</li> <li> <p>The slave executes, builds, tests and generates test reports as instructed by the Jenkins master.</p> </li> <li> <p>\u6bcf\u6b21\u63d0\u4ea4\u4ee3\u7801\u65f6\uff0cJenkins master \u90fd\u4f1a\u4ece\u8fdc\u7a0bGitHub\u5b58\u50a8\u5e93\u68c0\u7d22\u66f4\u65b0\u7684\u4ee3\u7801\u3002</p> </li> <li>\u5b83\u5c06\u5de5\u4f5c\u8d1f\u8f7d\u5206\u6563\u5230\u6240\u6709Jenkins \u4ece\u673a\u4e0a\u3002</li> <li>\u4ece\u673a\u6309\u7167Jenkins \u4e3b\u673a\u7684\u6307\u793a\u6267\u884c\u3001\u6784\u5efa\u3001\u6d4b\u8bd5\u5e76\u751f\u6210\u6d4b\u8bd5\u62a5\u544a\u3002</li> </ul> <p>19. What are the key concepts in a Jenkins pipeline? Jenkins \u7ba1\u9053\u4e2d\u7684\u5173\u952e\u6982\u5ff5\u662f\u4ec0\u4e48\uff1f</p> <ul> <li>Pipeline: A CD pipeline is a user-defined model. The pipeline's code specifies how the application is built, tested, and delivered.</li> <li>Agent: It is a component of the Jenkins environment that can run pipelines.</li> <li>Steps: Indicates a single task that Jenkins executes when triggered.</li> <li> <p>Stage: Identifies a theoretically independent set of tasks performed throughout the pipeline (build, test, deploy stages)</p> </li> <li> <p>Pipeline\uff1aCD \u7ba1\u9053\u662f\u7528\u6237\u5b9a\u4e49\u7684\u6a21\u578b\u3002\u7ba1\u9053\u7684\u4ee3\u7801\u6307\u5b9a\u5982\u4f55\u6784\u5efa\u3001\u6d4b\u8bd5\u548c\u4ea4\u4ed8\u5e94\u7528\u7a0b\u5e8f\u3002</p> </li> <li>Agent\uff1a\u5b83\u662fJenkins \u73af\u5883\u7684\u7ec4\u4ef6\uff0c\u53ef\u4ee5\u8fd0\u884c\u7ba1\u9053\u3002</li> <li>Steps\uff1a\u6307\u793aJenkins \u5728\u89e6\u53d1\u65f6\u6267\u884c\u7684\u5355\u4e2a\u4efb\u52a1\u3002</li> <li>Stage\uff1a\u6807\u8bc6\u5728\u6574\u4e2a\u7ba1\u9053\uff08\u6784\u5efa\u3001\u6d4b\u8bd5\u3001\u90e8\u7f72\u9636\u6bb5\uff09\u4e2d\u6267\u884c\u7684\u4e00\u7ec4\u7406\u8bba\u4e0a\u72ec\u7acb\u7684\u4efb\u52a1</li> </ul> <p>20. Describe some basic Git commands.</p> <p>The table below summarizes some basic Git commands.</p> <ul> <li>starts a new repository <code>git init</code> </li> <li>Set the user's username and email address.<ul> <li><code>git config</code></li> <li><code>git config --global user.name\u201c[name]\u201d</code></li> <li><code>git config --global user.email\u201c[email]\u201d</code></li> </ul> </li> <li>Generate a local copy of the repository.<ul> <li><code>git clone &lt;repository path&gt;</code></li> </ul> </li> <li>Add multiple files to the staging area.<ul> <li><code>git add</code></li> <li><code>git add &lt;comma-separated filenames&gt;</code></li> <li><code>git add .</code></li> </ul> </li> <li> <p>Create a record or snapshot of the file in the staging area.</p> <ul> <li><code>git commit</code></li> <li><code>git commit -a</code></li> <li><code>git commit -m \u201c&lt;add commit message&gt;\u201d</code></li> </ul> </li> <li> <p>Show the diffs between the two mentioned branches and compare the current version with the staging area's file version.</p> <ul> <li><code>git diff</code></li> <li><code>git diff [first branch] [second branch]</code></li> <li><code>git diff -staged</code></li> </ul> </li> <li>List each file that needs to be submitted.<ul> <li>git status    </li> </ul> </li> <li>Delete one or more files from the current working directory and stage them.<ul> <li><code>git rm &lt;filename&gt;</code></li> </ul> </li> <li>Displays committed metadata and content changes.<ul> <li><code>git show &lt;commit&gt;</code></li> </ul> </li> <li>Create a brand new branch. Delete the mentioned branch. Lists all available branches, highlighting the branch we are currently on.<ul> <li><code>git branch</code></li> <li><code>git branch [branch name]</code></li> <li><code>git branch -d [branch name]</code></li> </ul> </li> </ul> <p>21. How to copy Jenkins from one server to another?</p> <ul> <li>Step 1: Transfer jobs from one Jenkins installation to another by copying the relevant job directory.</li> <li>Step 2: To duplicate an existing job, clone the job directory and give it a new name.</li> <li> <p>Step 3: Rename directory to rename existing jobs.</p> </li> <li> <p>\u6b65\u9aa4 1\uff1a\u590d\u5236\u76f8\u5173\u4f5c\u4e1a\u76ee\u5f55\uff0c\u5c06\u4f5c\u4e1a\u4ece\u4e00\u4e2a Jenkins \u5b89\u88c5\u8f6c\u79fb\u5230\u53e6\u4e00\u4e2a\u5b89\u88c5\u3002</p> </li> <li>\u6b65\u9aa4 2\uff1a\u8981\u590d\u5236\u73b0\u6709\u4f5c\u4e1a\uff0c\u8bf7\u514b\u9686\u4f5c\u4e1a\u76ee\u5f55\u5e76\u4e3a\u5176\u6307\u5b9a\u65b0\u540d\u79f0\u3002</li> <li>\u6b65\u9aa4 3\uff1a\u91cd\u547d\u540d\u76ee\u5f55\u4ee5\u91cd\u547d\u540d\u73b0\u6709\u4f5c\u4e1a\u3002</li> </ul> <p>22. What resources are available in Puppet?</p> <ul> <li>Resources are the main components of any configuration management tool.</li> <li>These are characteristics of a node, such as its software or services.</li> <li>The actions performed on a resource are described in the resource declaration written to the catalog.</li> <li> <p>When the catalog is performed, the node will be in the desired state.</p> </li> <li> <p>\u8d44\u6e90\u662f\u4efb\u4f55\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\u7684\u4e3b\u8981\u7ec4\u4ef6\u3002</p> </li> <li>\u8fd9\u4e9b\u662f\u8282\u70b9\u7684\u7279\u5f81\uff0c\u5982\u5176\u8f6f\u4ef6\u6216\u670d\u52a1\u3002</li> <li>\u5bf9\u8d44\u6e90\u6267\u884c\u7684\u64cd\u4f5c\u5728\u5199\u5165\u76ee\u5f55\u7684\u8d44\u6e90\u58f0\u660e\u4e2d\u8fdb\u884c\u63cf\u8ff0\u3002</li> <li>\u6267\u884c\u7f16\u5f55\u65f6\uff0c\u8282\u70b9\u5c06\u5904\u4e8e\u6240\u9700\u72b6\u6001\u3002</li> </ul> <p>23. What are Ansible roles?</p> <p>Ansible \u89d2\u8272\u662f\u4ec0\u4e48\uff1f</p> <p>Ansible roles are embedded in Playbooks, which are independent sets of tasks, variables, files, and templates</p> <p>Ansible \u89d2\u8272\u5d4c\u5165\u5728Playbook\u4e2d\uff0c\u662f\u4e00\u7ec4\u72ec\u7acb\u7684\u4efb\u52a1\u3001\u53d8\u91cf\u3001\u6587\u4ef6\u548c\u6a21\u677f\u3002</p> <p>24. What is the use of Dockerfile?</p> <ul> <li>Docker image is generated using Dockerfile.</li> <li>Docker images allow any user to run code that builds Docker containers.</li> <li>After the Docker image is created, it will be uploaded to the Docker registry.</li> <li> <p>Users can create new containers at any time by retrieving Docker images from the Docker registry.</p> </li> <li> <p>Docker \u955c\u50cf\u662f\u4f7f\u7528Dockerfile\u751f\u6210\u7684\u3002</p> </li> <li>Docker \u955c\u50cf\u5141\u8bb8\u4efb\u4f55\u7528\u6237\u8fd0\u884c\u6784\u5efa Docker \u5bb9\u5668\u7684\u4ee3\u7801\u3002</li> <li>Docker \u955c\u50cf\u521b\u5efa\u540e\u4f1a\u4e0a\u4f20\u5230 Docker \u6ce8\u518c\u8868\u3002</li> <li>\u7528\u6237\u53ef\u4ee5\u968f\u65f6\u901a\u8fc7\u4ece Docker \u6ce8\u518c\u8868\u68c0\u7d22 Docker \u955c\u50cf\u6765\u521b\u5efa\u65b0\u5bb9\u5668\u3002</li> </ul> <p>25. How to run multiple containers with a single service? \u5982\u4f55\u4f7f\u7528\u5355\u4e2a\u670d\u52a1\u8fd0\u884c\u591a\u4e2a\u5bb9\u5668\uff1f</p> <ul> <li>\u4f7f\u7528 Docker Compose\uff0c\u591a\u4e2a\u5bb9\u5668\u53ef\u4ee5\u4f5c\u4e3a\u5355\u4e2a\u670d\u52a1\u8fd0\u884c\u3002</li> <li>\u6bcf\u4e2a\u5bb9\u5668\u72ec\u7acb\u8fd0\u884c\uff0c\u4f46\u4ecd\u7136\u80fd\u591f\u901a\u4fe1\u3002</li> <li> <p>Docker Compose \u6587\u4ef6\u662f YAML \u6587\u4ef6\u3002</p> </li> <li> <p>Using Docker Compose, multiple containers can run as a single service.</p> </li> <li>Each container runs independently, but is still able to communicate.</li> <li>Docker Compose files are YAML files.</li> </ul> <p>26. Which are the top DevOps tools? What tools have you used?</p> <p>The most popular DevOps tools are</p> <ul> <li>Git: for version control.</li> <li>Jenkins: for continuous integration.</li> <li>Selenium: For continuous testing.</li> <li>Puppet, Chef, Ansible: for configuration management and deployment.</li> <li>Prometheus: for continuous monitoring.</li> <li>Docker: for containerization.</li> </ul> <p>\u6700\u6d41\u884c\u7684 DevOps \u5de5\u5177\u662f</p> <ul> <li>Git\uff1a\u7528\u4e8e\u7248\u672c\u63a7\u5236\u3002</li> <li>Jenkins\uff1a\u7528\u4e8e\u6301\u7eed\u96c6\u6210\u3002</li> <li>Selenium\uff1a\u7528\u4e8e\u8fde\u7eed\u6d4b\u8bd5\u3002</li> <li>Puppet\u3001Chef\u3001Ansible\uff1a\u7528\u4e8e\u914d\u7f6e\u7ba1\u7406\u548c\u90e8\u7f72\u3002</li> <li>Prometheus\uff1a\u7528\u4e8e\u8fde\u7eed\u76d1\u63a7\u3002</li> <li>Docker\uff1a\u7528\u4e8e\u5bb9\u5668\u5316\u3002</li> </ul> <p>\u5728\u6211\u7684\u804c\u4e1a\u751f\u6daf\u4e2d\uff0c\u6211\u4f7f\u7528\u6240\u6709\u8fd9\u4e9b\u5de5\u5177\u6210\u529f\u5f00\u53d1\u548c\u90e8\u7f72\u4e86\u8f6f\u4ef6\u3002</p> <p>\u5982\u679c\u60a8\u6ca1\u6709\u4f7f\u7528\u6240\u6709\u8fd9\u4e9b\u5de5\u5177\uff1a\u8fd9\u4e9b\uff08\u60a8\u4f7f\u7528\u7684\uff09\u5de5\u5177\u662f\u6211\u7684\u4e13\u4e1a\u9886\u57df\uff0c\u5e76\u4e14\u6211\u719f\u6089\u5176\u4ed6\u5de5\u5177</p> <p>27. How do all these tools work together?</p> <p>\u6211\u5c06\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u6d41\u7a0b\u6765\u89e3\u91ca\u3002\u4f46\u6839\u636e\u5177\u4f53\u60c5\u51b5\uff0c\u6b64\u8fc7\u7a0b\u53ef\u80fd\u56e0\u7ec4\u7ec7\u800c\u5f02\u3002</p> <ul> <li>\u5f00\u53d1\u4eba\u5458\u751f\u6210\u6e90\u4ee3\u7801\uff0c\u5e76\u4f7f\u7528Git\u7b49\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u5de5\u5177\u5bf9\u5176\u8fdb\u884c\u7ba1\u7406\u3002</li> <li>\u5f00\u53d1\u4eba\u5458\u5c06\u4ee3\u7801\u53d1\u9001\u5230 Git \u5b58\u50a8\u5e93\uff0c\u7136\u540e\u5c06\u4efb\u4f55\u66f4\u6539\u63d0\u4ea4\u5230\u5b58\u50a8\u5e93\u3002</li> <li>Jenkins \u4f7f\u7528 Git \u63d2\u4ef6\u4ece\u5b58\u50a8\u5e93\u4e2d\u63d0\u53d6\u6b64\u4ee3\u7801\uff0c\u7136\u540e\u4f7f\u7528 Ant \u6216 Maven \u6784\u5efa\u5b83\u3002</li> <li>Puppet \u662f\u4e00\u4e2a\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\uff0c\u7528\u4e8e\u90e8\u7f72\u548c\u8bbe\u7f6e\u6d4b\u8bd5\u73af\u5883\u3002\u7136\u540e Jenkins \u5728\u6d4b\u8bd5\u73af\u5883\u4e2d\u53d1\u5e03\u6b64\u4ee3\u7801\uff0c\u5e76\u4f7f\u7528 Selenium \u7b49\u5de5\u5177\u8fdb\u884c\u6d4b\u8bd5\u3002</li> <li>\u4ee3\u7801\u7ecf\u8fc7\u6d4b\u8bd5\u540e\uff0cJenkins \u5c06\u4ee3\u7801\u53d1\u9001\u5230\u751f\u4ea7\u670d\u52a1\u5668\u8fdb\u884c\u90e8\u7f72\u3002</li> <li>\u5f53\u4f7f\u7528 Prometheus \u7b49\u90e8\u7f72\u5de5\u5177\u5bf9\u5176\u8fdb\u884c\u6301\u7eed\u76d1\u63a7\u65f6\u3002</li> <li>\u6784\u5efa\u529f\u80fd\u7684\u6d4b\u8bd5\u73af\u5883\u7531 Docker \u5bb9\u5668\u63d0\u4f9b\u3002</li> </ul> <p>I will explain with a simple flow. However, this process may vary from organization to organization, depending on the circumstances.</p> <ul> <li>Developers generate source code and manage it using version control system tools like Git.</li> <li>Developers send code to a Git repository, and then commit any changes to the repository.</li> <li>Jenkins pulls this code from the repository using a Git plugin, then builds it using Ant or Maven.</li> <li>Puppet is a configuration management tool for deploying and setting up test environments. Jenkins then publishes this code in a test environment and tests it with tools like Selenium.</li> <li>After the code is tested, Jenkins sends the code to the production server for deployment.</li> <li>When it is continuously monitored with a deployment tool such as Prometheus.</li> <li>The test environment for build functionality is provided by Docker containers.</li> </ul> <p></p> <p>28. How are Puppet modules different from Puppet manifests?</p> <p>Puppet modules consist of manifests and data. </p> <p>Puppet automatically loads classes, facts, custom types, definition types, and tasks when they have a specific directory structure. </p> <p>Modules must have valid names and be installed in Puppet's module path.</p> <p>The Puppet Manifest is a code-based Puppet program. It uses PP extensions.</p> <p>Puppet \u6a21\u5757\u7531\u6e05\u5355\u548c\u6570\u636e\u7ec4\u6210\u3002</p> <p>\u5f53\u7c7b\u3001\u4e8b\u5b9e\u3001\u81ea\u5b9a\u4e49\u7c7b\u578b\u3001\u5b9a\u4e49\u7c7b\u578b\u548c\u4efb\u52a1\u5177\u6709\u7279\u5b9a\u7684\u76ee\u5f55\u7ed3\u6784\u65f6\uff0cPuppet \u4f1a\u81ea\u52a8\u52a0\u8f7d\u5b83\u4eec\u3002\u6a21\u5757\u5fc5\u987b\u5177\u6709\u6709\u6548\u7684\u540d\u79f0\u5e76\u5b89\u88c5\u5728 Puppet \u7684\u6a21\u5757\u8def\u5f84\u4e2d\u3002</p> <p>Puppet Manifest \u662f\u57fa\u4e8e\u4ee3\u7801\u7684 Puppet \u7a0b\u5e8f\u3002\u5b83\u91c7\u7528PP\u6269\u5c55\u3002</p> <p>29. How to configure a system using Puppet?</p> <p>There are two ways to configure a system with Puppet:</p> <ul> <li>Puppet Agent and Puppet Master should be used in client or server architecture.</li> <li>Puppet applications should be used in standalone architectures.</li> </ul> <p>\u4f7f\u7528 Puppet \u914d\u7f6e\u7cfb\u7edf\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a</p> <ul> <li>Puppet Agent \u548c Puppet Master \u5e94\u8be5\u5728\u5ba2\u6237\u7aef\u6216\u670d\u52a1\u5668\u67b6\u6784\u4e2d\u4f7f\u7528\u3002</li> <li>Puppet \u5e94\u7528\u7a0b\u5e8f\u5e94\u5728\u72ec\u7acb\u67b6\u6784\u4e2d\u4f7f\u7528\u3002</li> </ul> <p>30. How is Ansible playbook different from ad-hoc commands?</p> <ul> <li>Server configuration work is described in scripted organizational units called Ansible playbooks. It works well for repetitive movements.</li> <li> <p>Temporary commands are used for quick, occasionally repetitive tasks.</p> </li> <li> <p>\u670d\u52a1\u5668\u914d\u7f6e\u5de5\u4f5c\u5728\u79f0\u4e3a Ansible playbook \u7684\u811a\u672c\u7ec4\u7ec7\u5355\u5143\u4e2d\u8fdb\u884c\u63cf\u8ff0\u3002\u5b83\u9002\u7528\u4e8e\u91cd\u590d\u6027\u52a8\u4f5c\u3002</p> </li> <li>\u4e34\u65f6\u547d\u4ee4\u7528\u4e8e\u5feb\u901f\u3001\u5076\u5c14\u91cd\u590d\u7684\u4efb\u52a1\u3002</li> </ul> <p>31. How is Ansible different from Puppet?</p> <p>**Ansible **</p> <ul> <li>Easy agentless installation </li> <li>Developing in Python </li> <li>Configuration files are written in YAML </li> <li>\u8f7b\u677e\u65e0\u4ee3\u7406\u5b89\u88c5   </li> <li>\u4f7f\u7528Python\u5f00\u53d1    </li> <li>\u914d\u7f6e\u6587\u4ef6\u662f\u7528YAML\u7f16\u5199\u7684 </li> </ul> <p>Puppet</p> <ul> <li>Agent-based installation</li> <li>Developing in Ruby</li> <li>Configuration files are written in DSL</li> <li>\u57fa\u4e8e\u4ee3\u7406\u7684\u5b89\u88c5</li> <li>\u4f7f\u7528 Ruby \u5f00\u53d1</li> <li>\u914d\u7f6e\u6587\u4ef6\u662f\u7528DSL\u7f16\u5199\u7684</li> </ul> <p>32. Why use SSL certificate in Chef?</p> <ul> <li>To ensure that each node can access the correct data, SSL certificates are used between the Chef server and clients.</li> <li>Each node has a set of private and public keys. On the Chef server, save the public key.</li> <li>The node's private key will be included in the SSL certificate sent to the server.</li> <li> <p>The server uses this in conjunction with the public key to identify the node and grant it access to the data.</p> </li> <li> <p>\u4e3a\u4e86\u786e\u4fdd\u6bcf\u4e2a\u8282\u70b9\u90fd\u80fd\u8bbf\u95ee\u6b63\u786e\u7684\u6570\u636e\uff0cChef \u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u4e4b\u95f4\u4f7f\u7528\u4e86 SSL \u8bc1\u4e66\u3002</p> </li> <li>\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u4e00\u7ec4\u79c1\u94a5\u548c\u516c\u94a5\u3002\u5728 Chef \u670d\u52a1\u5668\u4e0a\uff0c\u4fdd\u5b58\u516c\u94a5\u3002</li> <li>\u8282\u70b9\u7684\u79c1\u94a5\u5c06\u5305\u542b\u5728\u53d1\u9001\u5230\u670d\u52a1\u5668\u7684 SSL \u8bc1\u4e66\u4e2d\u3002</li> <li> <p>\u670d\u52a1\u5668\u5c06\u5176\u4e0e\u516c\u94a5\u7ed3\u5408\u4f7f\u7528\u6765\u8bc6\u522b\u8282\u70b9\u5e76\u6388\u4e88\u5176\u8bbf\u95ee\u6570\u636e\u7684\u6743\u9650\u3002</p> </li> <li> <p>How is a Chef CookBook different from a Chef Recipe?</p> </li> <li> <p>Chef Recipes are a collection of resources primarily for configuring software and other infrastructure. Ruby is the language used to write recipes.</p> </li> <li> <p>In contrast, Chef cookbooks contain recipes for achieving the desired state of a node.</p> </li> <li> <p>Chef Recipe \u662f\u4e3b\u8981\u7528\u4e8e\u914d\u7f6e\u8f6f\u4ef6\u548c\u5176\u4ed6\u57fa\u7840\u8bbe\u65bd\u7684\u8d44\u6e90\u96c6\u5408\u3002Ruby \u662f\u7528\u6765\u7f16\u5199\u83dc\u8c31\u7684\u8bed\u8a00\u3002</p> </li> <li> <p>\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u53a8\u5e08\u98df\u8c31\u5305\u542b\u5b9e\u73b0\u8282\u70b9\u6240\u9700\u72b6\u6001\u7684\u98df\u8c31\u3002</p> </li> <li> <p>Explain the architecture of Docker</p> </li> <li> <p>Docker runs on a client-server architecture.</p> </li> <li>Commands are run by the Docker client service. The REST API is used to translate commands before sending them to the Docker daemon (server).</li> <li>To create Docker images and run Docker containers, the Docker daemon accepts requests and communicates with the operating system.</li> <li>Instruction templates called Docker images are used to build containers.</li> <li>A Docker container is a package that contains an application and its dependencies.</li> <li>Docker Registry is a service for storing and distributing Docker images to users.</li> </ul> <p></p> <ul> <li>Docker \u5728\u5ba2\u6237\u7aef-\u670d\u52a1\u5668\u67b6\u6784\u4e0a\u8fd0\u884c\u3002</li> <li>\u547d\u4ee4\u7531 Docker \u5ba2\u6237\u7aef\u670d\u52a1\u8fd0\u884c\u3002REST API \u7528\u4e8e\u5728\u5c06\u547d\u4ee4\u53d1\u9001\u5230 Docker \u5b88\u62a4\u7a0b\u5e8f\uff08\u670d\u52a1\u5668\uff09\u4e4b\u524d\u5bf9\u5176\u8fdb\u884c\u7ffb\u8bd1\u3002</li> <li>\u4e3a\u4e86\u521b\u5efa Docker \u6620\u50cf\u5e76\u8fd0\u884c Docker \u5bb9\u5668\uff0cDocker \u5b88\u62a4\u8fdb\u7a0b\u63a5\u53d7\u8bf7\u6c42\u5e76\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\u3002</li> <li>\u79f0\u4e3a Docker \u6620\u50cf\u7684\u6307\u4ee4\u6a21\u677f\u7528\u4e8e\u6784\u5efa\u5bb9\u5668\u3002</li> <li>Docker \u5bb9\u5668\u662f\u4e00\u4e2a\u5305\u542b\u5e94\u7528\u7a0b\u5e8f\u53ca\u5176\u4f9d\u8d56\u9879\u7684\u5305\u3002</li> <li>Docker \u6ce8\u518c\u8868\u662f\u4e00\u4e2a\u7528\u4e8e\u5b58\u50a8\u548c\u5206\u53d1 Docker \u955c\u50cf\u7ed9\u7528\u6237\u7684\u670d\u52a1\u3002</li> </ul> <p>35. What is kubectl?</p> <p>Kubectl is a command-line tool that allows users to issue commands to Kubernetes clusters. Ctl stands for \"control\" in this context. You can use the \"kubectl\" command line interface to deploy applications, inspect and manage cluster resources, and view logs.</p> <ol> <li>How do containers communicate in Kubernetes?</li> </ol> <p>In Kubernetes, Pods map containers to each other. </p> <p>Multiple containers may exist within a Pod. </p> <p>In an overlay network, Pods have a simple network hierarchy and communicate with each other in a flat fashion, so in theory, any Pod there can communicate with any other Pod.</p> <p>\u5728 Kubernetes \u4e2d\uff0cPod \u5c06\u5bb9\u5668\u76f8\u4e92\u6620\u5c04\u3002\u4e00\u4e2a Pod \u5185\u53ef\u80fd\u5b58\u5728\u591a\u4e2a\u5bb9\u5668\u3002\u5728\u8986\u76d6\u7f51\u7edc\u4e2d\uff0cPod \u5177\u6709\u7b80\u5355\u7684\u7f51\u7edc\u5c42\u6b21\u7ed3\u6784\uff0c\u5e76\u4ee5\u6241\u5e73\u7684\u65b9\u5f0f\u76f8\u4e92\u901a\u4fe1\uff0c\u56e0\u6b64\u7406\u8bba\u4e0a\uff0c\u90a3\u91cc\u7684\u4efb\u4f55 Pod \u90fd\u53ef\u4ee5\u4e0e\u4efb\u4f55\u5176\u4ed6 Pod \u901a\u4fe1\u3002</p> <p>38. Describe IaC and configuration management</p> <p>Unlike manually or through a GUI, the infrastructure as code (IaC) paradigm manages and tracks infrastructure configuration in files. This allows for more flexibility in the configuration of the infrastructure, and more importantly, changes can be clearly tracked using a version control system.</p> <p>Software programs known as configuration management systems enable consistent, reliable, and secure management of environments. By using an optimized DSL to specify the state and configuration of system elements, multiple people can collaborate and store system configurations for hundreds of servers in one place.</p> <p>Ansible has no centralized server, configuration is stored in YAML. Via SSH (or WinRM on Windows), the stateful configuration is sent to the server, where it is then executed. The downside of this approach is that managing thousands of machines can take a long time.</p> <p>\u4e0e\u624b\u52a8\u6216\u901a\u8fc7\u56fe\u5f62\u7528\u6237\u754c\u9762\u4e0d\u540c\uff0c\u57fa\u7840\u8bbe\u65bd\u5373\u4ee3\u7801 (IaC)\u8303\u5f0f\u7ba1\u7406\u548c\u8ddf\u8e2a\u6587\u4ef6\u4e2d\u7684\u57fa\u7840\u8bbe\u65bd\u914d\u7f6e\u3002\u8fd9\u4f7f\u5f97\u57fa\u7840\u8bbe\u65bd\u7684\u914d\u7f6e\u66f4\u52a0\u7075\u6d3b\uff0c\u66f4\u91cd\u8981\u7684\u662f\uff0c\u53ef\u4ee5\u4f7f\u7528\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u6e05\u6670\u5730\u8ddf\u8e2a\u66f4\u6539\u3002</p> <p>\u79f0\u4e3a\u914d\u7f6e\u7ba1\u7406\u7cfb\u7edf\u7684\u8f6f\u4ef6\u7a0b\u5e8f\u53ef\u5b9e\u73b0\u73af\u5883\u7684\u4e00\u81f4\u3001\u53ef\u9760\u4e14\u5b89\u5168\u7684\u7ba1\u7406\u3002 \u901a\u8fc7\u4f7f\u7528\u4f18\u5316\u7684 DSL \u6765\u6307\u5b9a\u7cfb\u7edf\u5143\u7d20\u7684\u72b6\u6001\u548c\u914d\u7f6e\uff0c\u591a\u4e2a\u4eba\u53ef\u4ee5\u534f\u4f5c\u5e76\u5c06\u6570\u767e\u53f0\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u914d\u7f6e\u5b58\u50a8\u5728\u4e00\u4e2a\u4f4d\u7f6e\u3002</p> <p>Ansible \u6ca1\u6709\u96c6\u4e2d\u5f0f\u670d\u52a1\u5668\uff0c\u914d\u7f6e\u5b58\u50a8\u5728 YAML \u4e2d\u3002\u901a\u8fc7 SSH\uff08\u6216 Windows \u4e0a\u7684 WinRM\uff09\uff0c\u72b6\u6001\u914d\u7f6e\u88ab\u53d1\u9001\u5230\u670d\u52a1\u5668\uff0c\u7136\u540e\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u3002</p> <p>\u8fd9\u79cd\u65b9\u6cd5\u7684\u7f3a\u70b9\u662f\u7ba1\u7406\u6570\u5343\u53f0\u673a\u5668\u53ef\u80fd\u9700\u8981\u5f88\u957f\u65f6\u95f4\u3002</p>"},{"location":"chap4/18helm2023/","title":"Helm\u6307\u5357\uff1aKubernetes\u5305\u7ba1\u7406\u5668\u7b80\u4ecb","text":"<p>\u4ec0\u4e48\u662fHelm\uff1f</p> <ul> <li>Helm\u662fKubernetes\u7684\u5305\u7ba1\u7406\u5668\uff0c\u53ef\u7b80\u5316\u5e94\u7528\u7a0b\u5e8f\u90e8\u7f72\u548c\u7ba1\u7406\u3002</li> <li>\u5b83\u4f7f\u7528\u6237\u80fd\u591f\u4f7f\u7528\u5355\u4e2a\u547d\u4ee4\u5b9a\u4e49\u3001\u5b89\u88c5\u548c\u5347\u7ea7\u590d\u6742\u7684\u5e94\u7528\u7a0b\u5e8f\u3002</li> <li>Helm \u63d0\u4f9b\u9002\u5408\u521d\u5b66\u8005\u7684\u7528\u6237\u53cb\u597d\u578b\u8bbe\u8ba1\uff0c\u4ee5\u53ca\u5927\u91cf\u968f\u65f6\u53ef\u7528\u7684Helm Chart\u4ed3\u5e93\uff0c\u53ef\u8f7b\u677e\u5b89\u88c5\u548c\u7ba1\u7406\u5404\u79cd\u5e94\u7528\u7a0b\u5e8f\u3002</li> </ul> <p>What is Helm?</p> <ul> <li>Helm is a package manager for Kubernetes that simplifies application deployment and management. </li> <li>It enables users to define, install and upgrade complex applications with a single command. </li> <li>Helm offers a user-friendly design for beginners, and a large repository of ready-to-use Helm Charts for easy installation and management of various applications.</li> </ul> <p>\u5173\u952e\u6982\u5ff5</p> <p>Helm \u4f7f\u7528 Helm Charts \u7ba1\u7406\u5e94\u7528\u7a0b\u5e8f\u7684\u90e8\u7f72\u751f\u547d\u5468\u671f\uff0c\u786e\u4fdd\u8de8\u4e0d\u540c\u73af\u5883\u548c\u7528\u6237\u7684\u4e00\u81f4\u6027\u3002</p> <p>\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u81ea\u5df1\u7684Helm Charts\u8fdb\u884c\u90e8\u7f72\uff0c\u6216\u4f7f\u7528\u6765\u81ea\u516c\u5171\u5b58\u50a8\u5e93\u7684\u7b2c\u4e09\u65b9\u548c\u5f00\u6e90\u5de5\u5177\u7684Charts\uff0c\u4f8b\u5982artifacthub\u3001bitnami charts\u3001harbor\u548c chart museum.</p> <p>Helm uses Helm Charts to manage the deployment lifecycle of applications, ensuring consistency across different environments and users. </p> <p>Users can create their own Helm Charts for deployment, or use charts from third-party and open source tools from public repositories such as artifacthub, bitnami charts, harbor, and chart museum.</p>"},{"location":"chap4/18helm2023/#helm-charts","title":"Helm Charts","text":"<p>Helm Charts\u662f\u4e00\u7ec4\u6587\u4ef6\uff0c\u63cf\u8ff0\u4e86\u5728 Kubernetes \u4e0a\u90e8\u7f72\u5e94\u7528\u7a0b\u5e8f\u6240\u9700\u7684\u8d44\u6e90\u548c\u4f9d\u8d56\u9879\u3002\u5b83\u5141\u8bb8\u6a21\u5757\u5316\u548c\u7248\u672c\u63a7\u5236\uff0c\u4f7f\u5e94\u7528\u7a0b\u5e8f\u5206\u53d1\u3001\u5171\u4eab\u548c\u7ba1\u7406\u66f4\u6613\u4e8e\u8de8\u5404\u79cd\u96c6\u7fa4\u548c\u7528\u6237\u8bbf\u95ee\u3002</p> <p>\u8be5\u5305\u7531\u591a\u4e2a\u6587\u4ef6\u548c\u76ee\u5f55\u7ec4\u6210\uff0c\u6bcf\u4e2a\u6587\u4ef6\u548c\u76ee\u5f55\u90fd\u6709\u7279\u5b9a\u7684\u529f\u80fd\u3002Helm \u8bfb\u53d6Charts\u5e76\u6839\u636e\u63d0\u4f9b\u7684\u914d\u7f6e\uff08values.yaml \u6587\u4ef6\uff09\u751f\u6210\u5fc5\u8981\u7684 Kubernetes \u6e05\u5355\u3002Helm Charts\u53ef\u4ee5\u5177\u6709\u4f9d\u8d56\u9879\uff0c\u5b58\u50a8\u5728charts\u76ee\u5f55\u4e2d\u79f0\u4e3asubcharts</p>"},{"location":"chap4/18helm2023/#chart","title":"Chart \u7ed3\u6784","text":"<ul> <li>charts: \u5b50chart\uff0c\u76ee\u5f55\u4e0b\u5b58\u653e\u4f9d\u8d56\u9879\u3002</li> <li>templates: \u8fd9\u4e9b\u7528Golang \u7f16\u5199\u7684\u6a21\u677f\u6587\u4ef6\u4e0e values.yaml \u914d\u7f6e\u6570\u636e\u5408\u5e76\u3002</li> <li>templates/NOTES.txt: \u5305\u542b\u7b80\u77ed\u4f7f\u7528\u8bf4\u660e\u7684\u7eaf\u6587\u672c\u6587\u4ef6\u3002</li> <li>crd: \u5b58\u50a8\u5c06\u5728 helm \u5b89\u88c5\u671f\u95f4\u5b89\u88c5\u7684 CRD\u3002</li> <li>Chart.yaml: \u5143\u6570\u636e\u4fe1\u606f\uff0c\u4f8b\u5982\u7248\u672c\u3001\u540d\u79f0\u3001\u641c\u7d22\u5173\u952e\u5b57\u7b49\u3002</li> <li>LICENSE\uff1aChart \u7684\u7eaf\u6587\u672c\u683c\u5f0f\u8bb8\u53ef\u8bc1\u3002</li> <li>README.md: \u4ee5\u53ef\u8bfb\u7684\u683c\u5f0f\u4f7f\u7528chart\u7684\u91cd\u8981\u63cf\u8ff0\u4fe1\u606f\u3002</li> <li>requirements.yaml \uff1aChart\u7684\u4f9d\u8d56\u914d\u7f6e\u3002</li> <li>values.yaml: Chart\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u3002</li> <li>values.schema.json\uff1a \u7528\u4e8e\u5728 value.yaml \u6587\u4ef6\u4e0a\u5f3a\u52a0\u7ed3\u6784\u7684 JSON \u67b6\u6784\u3002</li> </ul>"},{"location":"chap4/18helm2023/#helm-releases","title":"Helm releases","text":"<p>Helm \u67b6\u6784\u4e2d\u7684\u4e0b\u4e00\u4e2a\u91cd\u8981\u7ec4\u4ef6\u662freleases. Helm\u4e2d\u7684release\u8868\u793a Kubernetes \u96c6\u7fa4\u4e2d\u90e8\u7f72\u7684 Chart \u7684\u5b9e\u4f8b\u3002release\u7531\u6240\u6709Kubernetes\u5bf9\u8c61\u548c\u8d44\u6e90\u7ec4\u6210\uff0c\u4f8b\u5982\u90e8\u7f72\u3001\u670d\u52a1\u548c\u5165\u53e3\u89c4\u5219\uff0c\u5b83\u4eec\u662f\u4f5c\u4e3aChart\u4e2d\u6307\u5b9a\u914d\u7f6e\u7684\u4e00\u90e8\u5206\u521b\u5efa\u7684\u3002</p>"},{"location":"chap4/18helm2023/#helm-chart-repository","title":"Helm chart repository","text":"<p>Helm chart\u5b58\u50a8\u5e93\u6216 repos \u662f\u4e13\u7528\u7684HTTP\u670d\u52a1\u5668\uff0c\u5b83\u4e0e index.yaml \u6587\u4ef6\u4e00\u8d77\u6258\u7ba1\u548c\u63d0\u4f9bChart\uff0c\u8be5\u6587\u4ef6\u63d0\u4f9b\u6709\u5173Chart\u96c6\u5408\u53ca\u5176\u4e0b\u8f7d\u4f4d\u7f6e\u7684\u4fe1\u606f\u3002</p> <p>Helm \u5ba2\u6237\u7aef\u53ef\u4ee5\u8fde\u63a5\u5230\u591a\u4e2aChart\u5b58\u50a8\u5e93\uff0c\u6700\u521d\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6ca1\u6709\u914d\u7f6e\u3002\u4f7f\u7528\u8be5helm repo add\u547d\u4ee4\uff0c\u7528\u6237\u53ef\u4ee5\u6beb\u4e0d\u8d39\u529b\u5730\u914d\u7f6e\u548c\u6dfb\u52a0\u65b0\u7684Chart\u5b58\u50a8\u5e93\uff0c\u4ece\u800c\u53ef\u4ee5\u65e0\u7f1d\u8bbf\u95ee\u548c\u7ba1\u7406\u5176 Kubernetes \u90e8\u7f72\u7684\u5404\u79cdChart\u3002</p> <p>\u6d41\u884c\u7684Chart\u5b58\u50a8\u5e93\u6709artifcathub\u3001bitnami Charts\u3001Harbor\u548cChart Museum\u3002</p>"},{"location":"chap4/18helm2023/#chart-version","title":"Chart version","text":"<p>\u6bcf\u4e2aChart\u90fd\u5fc5\u987b\u6709\u4e00\u4e2a\u7248\u672c\u53f7\u3002\u5b58\u50a8\u5e93\u4e2d\u7684\u5305\u901a\u8fc7\u540d\u79f0\u52a0\u7248\u672c\u6765\u6807\u8bc6\u3002Helm chart\u6839\u636eSemVer2 \u89c4\u8303\u8fdb\u884c\u7248\u672c\u63a7\u5236\u3002\u4f8b\u5982\uff0c\u7248\u672c\u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u7248\u672c\uff1a1.2.3\u7684nginx\u5c06\u88ab\u547d\u540d\u4e3a\uff1anginx-1.2.3.tgz</p> <p>\u7248\u672c\u53f7\u53ef\u5728Chart.yaml\u6587\u4ef6\u4e2d\u627e\u5230\uff0c\u5e76\u7531\u5404\u79cd Helm \u5de5\u5177\uff08\u5305\u62ec CLI\uff09\u4f7f\u7528\u3002</p> <p><code>helm package</code>\u521b\u5efa\u5305\u65f6\uff0c\u8be5\u547d\u4ee4\u4f7f\u7528Chart.yaml\u4e2d\u5b9a\u4e49\u7684\u7248\u672c\u53f7\u3002\u7cfb\u7edf\u671f\u671b\u5305\u540d\u79f0\u4e2d\u7684\u7248\u672c\u53f7\u4e0eChart.yaml\u4e2d\u7684\u7248\u672c\u53f7\u76f8\u5339\u914d\uff0c\u4efb\u4f55\u5dee\u5f02\u90fd\u4f1a\u5bfc\u81f4\u9519\u8bef\u3002</p>"},{"location":"chap4/18helm2023/#chart-dependency","title":"Chart dependency","text":"<p>\u5728Helm\u4e2d\uff0c\u4e00\u4e2aChart\u53ef\u80fd\u4f9d\u8d56\u4e8e\u4efb\u610f\u6570\u91cf\u7684\u5176\u4ed6chart\u3002\u8fd9\u4e9b\u4f9d\u8d56\u9879\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u5f0f\u6dfb\u52a0 - \u901a\u8fc7\u4f7f\u7528\u4f9d\u8d56\u9879\u5b57\u6bb5\u52a8\u6001\u94fe\u63a5Chart.yaml\u6216\u5c06\u5176\u653e\u5165charts/\u76ee\u5f55\u5e76\u624b\u52a8\u7ba1\u7406\u3002</p> <p>\u4f7f\u7528 dependencies \u5b57\u6bb5\u7684\u793a\u4f8b\uff1a</p> <pre><code>dependencies:\n  - name: apache\n    version: 1.2.3\n    repository: https://example.com/charts\n  - name: mysql\n    version: 3.2.1\n    repository: https://another.example.com/charts\n</code></pre> <p>\u5b58\u653e\u5230charts\u76ee\u5f55\u7684\u793a\u4f8b\uff1a</p> <pre><code>wordpress:\n  Chart.yaml\n  # ...\n  charts/\n    apache/\n      Chart.yaml\n      # ...\n    mysql/\n      Chart.yaml\n      # ...\n</code></pre>"},{"location":"chap4/18helm2023/#release-version","title":"Release version\uff08\u53d1\u5e03\u7248\u672c\uff09","text":"<p>\u4e00\u4e2a\u7248\u672c\u53ef\u4ee5\u4fee\u6539\u591a\u6b21\u3002\u4e3a\u4e86\u8ddf\u8e2a\u8fd9\u4e9b\u53d8\u5316\uff0c\u4f7f\u7528\u4e86\u8fde\u7eed\u8ba1\u6570\u5668\u3002helm install\u521d\u59cb\u65f6\uff0c\u7248\u672c\u53f7\u8bbe\u7f6e\u4e3a 1\u3002\u6bcf\u6b21\u540e\u7eed\u5347\u7ea7\u6216\u56de\u6eda\u65f6\uff0c\u7248\u672c\u53f7\u90fd\u4f1a\u589e\u52a0 1\u3002\u5982\u679c\u9700\u8981\u56de\u6eda\u5230\u4ee5\u524d\u7684\u7248\u672c\u53f7\uff0c\u6b64\u5386\u53f2\u8bb0\u5f55\u5f88\u6709\u7528\u3002</p>"},{"location":"chap4/18helm2023/#helm-rollback","title":"Helm rollback","text":"<p>\u8be5<code>helm rollback &lt;RELEASE&gt; [REVISION] [flags]</code> \u547d\u4ee4\u53ef\u7528\u4e8e\u56de\u6eda\u5230\u8be5\u7248\u672c\u7684\u4efb\u4f55\u5148\u524d\u7248\u672c\u3002\u6ce8\u610f\uff1a\u56de\u6eda\u7248\u672c\u5c06\u6536\u5230\u65b0\u7684\u7248\u672c\u53f7\u3002</p>"},{"location":"chap4/18helm2023/#helm-sdk","title":"Helm SDK","text":"<p>Helm SDK\u662f\u6307\u76f4\u63a5\u4e0e Kubernetes API \u670d\u52a1\u5668\u4ea4\u4e92\u4ee5\u5b89\u88c5\u3001\u5347\u7ea7\u3001\u67e5\u8be2\u548c\u5220\u9664 Kubernetes \u8d44\u6e90\u7684 Go \u4ee3\u7801\u3002\u5b83\u53ef\u4ee5\u5bfc\u5165\u5230\u9879\u76ee\u4e2d\u4ee5\u4f7f\u7528 Helm \u4f5c\u4e3a\u5ba2\u6237\u7aef\u5e93\u800c\u4e0d\u662f CLI\u3002</p>"},{"location":"chap4/18helm2023/#helm","title":"Helm \u67b6\u6784","text":"<p>\u8be5\u56fe\u66f4\u597d\u5730\u89e3\u91ca\u4e86 Helm \u5982\u4f55\u4f7f\u7528chart\u548cvalues\u6587\u4ef6\u6765\u7ba1\u7406 Kubernetes \u96c6\u7fa4\u4e2d\u7684\u53d1\u5e03\uff08\u5df2\u90e8\u7f72\u7684\u8d44\u6e90\uff09\u3002</p> <p>\u6b64\u56fe\u663e\u793a\u4e86 OpenTelemetry Operator Helm chart\u5de5\u4f5c\u6d41\u7a0b\u3002</p> <p>\u5728\u8fd9\u91cc\uff0c\u60a8\u53ef\u4ee5\u770b\u5230 AWS Observability \u56e2\u961f\u5982\u4f55\u5728\u516c\u5171\u5b58\u50a8\u5e93\u4e2d\u6784\u5efa\u548c\u7ef4\u62a4 Helm chart\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06\u5176\u65e0\u7f1d\u4e0b\u8f7d\u5e76\u90e8\u7f72\u5230\u7528\u6237\u96c6\u7fa4\u3002</p> <p></p> <p>\u6b64\u56fe\u663e\u793a\u4e86 OpenTelemetry Operator Helm chart\u5de5\u4f5c\u6d41\u7a0b\u3002\u5728\u8fd9\u91cc\uff0c\u60a8\u53ef\u4ee5\u770b\u5230 AWS Observability \u56e2\u961f\u5982\u4f55\u5728\u516c\u5171\u5b58\u50a8\u5e93\u4e2d\u6784\u5efa\u548c\u7ef4\u62a4 Helm chart\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06\u5176\u65e0\u7f1d\u4e0b\u8f7d\u5e76\u90e8\u7f72\u5230\u7528\u6237\u96c6\u7fa4\u3002</p> <p>\u4e0e\u4e4b\u524d\u90e8\u7f72 OpenTelemetry Operator\u7684\u65b9\u6cd5\u76f8\u6bd4\uff0c\u6b64\u8fc7\u7a0b\u8fd8\u6709\u51e0\u4e2a\u597d\u5904\u3002</p> <ul> <li>\u6dfb\u52a0\u4e86\u5b89\u88c5/\u5378\u8f7d\u5305\u3001\u5347\u7ea7\u3001\u56de\u6eda\u548c\u81ea\u5b9a\u4e49\u5b89\u88c5\u7b49\u529f\u80fd\u3002</li> <li>\u7528\u6237\u53ef\u4ee5\u901a\u8fc7values.yaml \u6587\u4ef6\u7075\u6d3b\u5730\u914d\u7f6e\u503c\uff0c\u60a8\u53ef\u4ee5\u786e\u5b9a\u5c06\u54ea\u4e9b\u503c\u4f20\u9012\u7ed9 OpenTelemetry Operator Helm \u56fe\u8868\u914d\u7f6e\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u547d\u4ee4\u8986\u76d6\u591a\u4e2a\u503c\u3002</li> <li>\u8fd9\u662f\u5c06 Operator \u90e8\u7f72\u5230 Kubernetes \u7684\u6700\u7b80\u5355\u65b9\u6cd5\u3002</li> </ul> <p></p>"},{"location":"chap4/18helm2023/#helm_1","title":"\u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528 Helm\uff1f","text":"<p>\u5728 Kubernetes \u4e0a\u90e8\u7f72\u548c\u7ba1\u7406\u8d44\u6e90\u7684\u65b9\u6cd5\u6709\u591a\u79cd\uff1b\u4e3a\u4ec0\u4e48\u8981\u9009\u62e9 Helm\uff1f\u6d41\u884c\u7684\u66ff\u4ee3\u65b9\u6848\u662fKustomize\u3001Tanka\u548cCarvel\uff0c\u5b83\u4eec\u7684\u793e\u533a\u90fd\u4e0d\u5982 Helm \u6210\u719f\uff0c\u5e76\u4e14\u7f3a\u4e4f\u516c\u5f00\u53ef\u7528\u7684Chart\uff08\u5305\uff09\u7684\u6570\u91cf\u3002</p> <p>Helm \u56e0\u5176\u5904\u7406\u7b80\u5355\u548c\u590d\u6742\u914d\u7f6e\u3001\u7248\u672c\u63a7\u5236\u3001\u53ef\u91cd\u7528\u6027\u7b49\u7684\u80fd\u529b\u800c\u6210\u4e3a\u660e\u663e\u7684\u8d62\u5bb6\u3002</p> <p>\u8fd8\u6709\u4e00\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528Helm \u548c Kustomize\u3002 \u4ee5\u4e0b\u662f Helm \u7684\u4e3b\u8981\u4f18\u70b9\uff1a</p> <ul> <li>\u7b80\u5355\u6027\uff1a\u53ea\u9700\u4e00\u4e2a\u547d\u4ee4\u5373\u53ef\u5b9a\u4e49\u3001\u5b89\u88c5\u3001\u5347\u7ea7\u548c\u56de\u6eda\u590d\u6742\u7684 Kubernetes \u5e94\u7528\u7a0b\u5e8f\u3002\u8fd9\u6781\u5927\u5730\u7b80\u5316\u4e86Kubernetes\u8d44\u6e90\u7684\u7ba1\u7406\u548c\u90e8\u7f72\u3002</li> <li>\u53ef\u91cd\u7528\u6027\uff1aHelm Chart\u672c\u8d28\u4e0a\u662f\u9884\u5148\u914d\u7f6e\u7684 Kubernetes \u8d44\u6e90\u7684\u5305\u3002\u8fd9\u4e9b\u56fe\u8868\u53ef\u4ee5\u5728\u9879\u76ee\u4e4b\u95f4\u91cd\u590d\u4f7f\u7528\uff0c\u5e76\u4e0e\u66f4\u5e7f\u6cdb\u7684\u793e\u533a\u5171\u4eab\u3002</li> <li>\u53ef\u914d\u7f6e\u6027\uff1aHelm \u63d0\u4f9b\u4e86\u4e00\u4e2a\u9ad8\u5ea6\u53ef\u914d\u7f6e\u7684\u7ed3\u6784\uff0c\u5305\u62ec\u56fe\u8868\uff08\u6a21\u677f\uff09\u548c\u503c\uff08\u914d\u7f6e\uff09\u3002\u53ea\u9700\u66f4\u6539\u4e00\u4e9b\u53c2\u6570\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u56fe\u8868\u5728\u591a\u4e2a\u73af\u5883\uff08\u4f8b\u5982 stag/prod \u6216\u591a\u4e2a\u4e91\u63d0\u4f9b\u5546\uff09\u4e0a\u8fdb\u884c\u90e8\u7f72\u3002</li> <li>\u4e00\u81f4\u6027\uff1aHelm \u56fe\u8868\u63d0\u4f9b\u4e86\u6253\u5305\u548c\u90e8\u7f72 Kubernetes \u8d44\u6e90\u7684\u6807\u51c6\u5316\u65b9\u6cd5\u3002\u8fd9\u6709\u52a9\u4e8e\u786e\u4fdd\u4e0d\u540c\u73af\u5883\u4e4b\u95f4\u7684\u4e00\u81f4\u6027\uff0c\u5e76\u964d\u4f4e\u90e8\u7f72\u4e2d\u51fa\u73b0\u9519\u8bef\u6216\u4e0d\u4e00\u81f4\u7684\u98ce\u9669\u3002</li> <li>\u53ef\u6269\u5c55\u6027\uff1a\u4f7f\u7528 Helm\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u8c03\u6574\u6587\u4ef6\u4e2d\u7684\u503c\u8f7b\u677e\u6269\u5c55\u6216\u7f29\u5c0f Kubernetes \u5e94\u7528\u7a0b\u5e8fvalues.yaml\u3002</li> <li>\u793e\u533a\uff1aHelm \u62e5\u6709\u4e00\u4e2a\u5e9e\u5927\u4e14\u6d3b\u8dc3\u7684\u793e\u533a\uff0c\u4e0d\u65ad\u5f00\u53d1\u548c\u6539\u8fdb\u8be5\u5de5\u5177\u3002\u8fd9\u610f\u5473\u7740\u6709\u8bb8\u591a\u8d44\u6e90\u548c\u6700\u4f73\u5b9e\u8df5\u53ef\u5e2e\u52a9\u60a8\u5145\u5206\u5229\u7528 Helm\u3002</li> </ul>"},{"location":"chap4/1Linux/","title":"\u7b2c\u4e00\u8282 IT\u8fd0\u7ef4\u9762\u8bd5\u95ee\u9898\u603b\u7ed3- Linux\u57fa\u7840","text":"<p>https://www.yuque.com/docs/share/d3dd1e8e-6828-4da7-9e30-6a4f45c6fa8e</p>"},{"location":"chap4/1Linux/#linux","title":"Linux\u57fa\u7840","text":""},{"location":"chap4/1Linux/#linux_1","title":"\u7b80\u8ff0Linux\u4e3b\u6d41\u7684\u53d1\u884c\u7248\uff1f","text":"<p>Redhat\u3001CentOS\u3001Fedora\u3001SuSE\u3001Debian\u3001Ubuntu\u3001FreeBSD\u7b49\u3002</p>"},{"location":"chap4/1Linux/#linux_2","title":"\u7b80\u8ff0Linux\u542f\u52a8\u8fc7\u7a0b\uff1f","text":"<ul> <li>\u5f00\u673aBIOS\u81ea\u68c0\uff0c\u52a0\u8f7d\u786c\u76d8\u3002</li> <li>\u8bfb\u53d6MBR\uff0cMBR\u5f15\u5bfc\u3002</li> <li>grub\u5f15\u5bfc\u83dc\u5355(Boot Loader)\u3002</li> <li>\u52a0\u8f7d\u5185\u6838kernel\u3002</li> <li>\u542f\u52a8init\u8fdb\u7a0b\uff0c\u4f9d\u636einittab\u6587\u4ef6\u8bbe\u5b9a\u8fd0\u884c\u7ea7\u522b\u3002</li> <li>init\u8fdb\u7a0b\uff0c\u6267\u884crc.sysinit\u6587\u4ef6\u3002</li> <li>\u542f\u52a8\u5185\u6838\u6a21\u5757\uff0c\u6267\u884c\u4e0d\u540c\u7ea7\u522b\u7684\u811a\u672c\u7a0b\u5e8f\u3002</li> <li>\u6267\u884c<code>/etc/rc.d/rc.local</code>\u3002</li> <li>\u542f\u52a8tty\uff0c\u8fdb\u5165\u7cfb\u7edf\u767b\u9646\u754c\u9762\u3002</li> </ul>"},{"location":"chap4/1Linux/#linux_3","title":"\u7b80\u8ff0Linux\u5220\u9664\u6587\u4ef6\u7684\u539f\u7406\uff1f","text":"<p>Linux\u7cfb\u7edf\u662f\u901a\u8fc7link\u7684\u6570\u91cf\u6765\u63a7\u5236\u6587\u4ef6\u5220\u9664\u7684\uff0c\u53ea\u6709\u5f53\u4e00\u4e2a\u6587\u4ef6\u4e0d\u5b58\u5728\u4efb\u4f55link\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u6587\u4ef6\u624d\u4f1a\u88ab\u5220\u9664\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\u6bcf\u4e2a\u6587\u4ef6\u4e24\u4e2alink\u8ba1\u6570\u5668\u6765\u63a7\u5236\uff1a<code>i_count</code>\u548c<code>i_nlink</code>\u3002</p> <p>\u5f53\u4e00\u4e2a\u6587\u4ef6\u88ab\u4e00\u4e2a\u7a0b\u5e8f\u5360\u7528\u7684\u65f6\u5019<code>i_count</code>\u5c31\u52a01\u3002</p> <p>\u5f53\u6587\u4ef6\u7684\u786c\u94fe\u63a5\u591a\u4e00\u4e2a\u7684\u65f6\u5019<code>i_nlink</code>\u4e5f\u52a01\u3002</p> <p>\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\uff0c\u5c31\u662f\u8ba9\u8fd9\u4e2a\u6587\u4ef6\uff0c\u6ca1\u6709\u8fdb\u7a0b\u5360\u7528\uff0c\u540c\u65f6<code>i_link</code>\u6570\u91cf\u4e3a0\u3002</p>"},{"location":"chap4/1Linux/#linux_4","title":"\u7b80\u8ff0Linux\u8fd0\u884c\u7ea7\u522b\uff1f","text":"<ul> <li>0\uff1a\u5173\u673a\u6a21\u5f0f</li> <li>1\uff1a\u5355\u7528\u6237\u6a21\u5f0f&lt;==\u7834\u89e3root\u5bc6\u7801</li> <li>2\uff1a\u65e0\u7f51\u7edc\u652f\u6301\u7684\u591a\u7528\u6237\u6a21\u5f0f</li> <li>3\uff1a\u6709\u7f51\u7edc\u652f\u6301\u7684\u591a\u7528\u6237\u6a21\u5f0f\uff08\u6587\u672c\u6a21\u5f0f\uff0c\u5de5\u4f5c\u4e2d\u6700\u5e38\u7528\u7684\u6a21\u5f0f\uff09</li> <li>4\uff1a\u4fdd\u7559\uff0c\u672a\u4f7f\u7528</li> <li>5\uff1a\u6709\u7f51\u7edc\u652f\u6301\u7684X-windows\u652f\u6301\u591a\u7528\u6237\u6a21\u5f0f\uff08\u684c\u9762\uff09</li> <li>6\uff1a\u91cd\u65b0\u5f15\u5bfc\u7cfb\u7edf\uff0c\u5373\u91cd\u542f</li> </ul>"},{"location":"chap4/1Linux/#linux_5","title":"\u7b80\u8ff0Linux\u5e38\u89c1\u76ee\u5f55\u53ca\u5176\u4f5c\u7528\uff1f","text":"<ul> <li><code>/</code>\uff08\u6839\u76ee\u5f55\uff09\uff1aLinux\u6587\u4ef6\u7cfb\u7edf\u7684\u8d77\u70b9\uff1b</li> <li>boot\uff1a\u5b58\u653eLinux\u7cfb\u7edf\u542f\u52a8\u505a\u5fc5\u987b\u7684\u6587\u4ef6\uff1b</li> <li>var\uff1a\u5b58\u653e\u7ecf\u5e38\u53d8\u6362\u7684\u6587\u4ef6\uff1b</li> <li>home\uff1a\u666e\u901a\u7528\u6237\u7684\u5bb6\u76ee\u5f55</li> <li>root\uff1aLinux\u7cfb\u7edf\u7684root\u7528\u6237\u5bb6\u76ee\u5f55\uff1b</li> <li>bin\uff1a\u5b58\u653e\u7cfb\u7edf\u57fa\u672c\u7684\u7528\u6237\u547d\u4ee4\uff1b</li> <li>sbin\uff1a\u5b58\u653e\u7cfb\u7edf\u57fa\u672c\u7684\u7ba1\u7406\u547d\u4ee4\uff1b</li> <li>use\uff1a\u5b58\u653eLinux\u5e94\u7528\u7a0b\u5e8f\uff1b</li> <li>etc\uff1a\u5b58\u653eLinux\u7cfb\u7edf\u548c\u5404\u79cd\u7a0b\u5e8f\u7684\u914d\u7f6e\u6587\u4ef6\u3002</li> </ul>"},{"location":"chap4/1Linux/#linux_6","title":"\u7b80\u8ff0Linux\u64cd\u4f5c\u7cfb\u7edf\u5e38\u89c1\u7684\u6587\u4ef6\u7cfb\u7edf\u6709\uff1f","text":"<ul> <li>EXT3</li> <li>EXT4</li> <li>XFS</li> </ul>"},{"location":"chap4/1Linux/#linuxbuffercache","title":"\u7b80\u8ff0Linux\u7cfb\u7edf\u4e2d\u7684buffer\u548ccache\u533a\u522b\uff1f","text":"<p>buffer\u548ccache\u90fd\u662f\u5185\u5b58\u4e2d\u7684\u4e00\u5757\u533a\u57df\uff0c</p> <p>\u5f53CPU\u9700\u8981\u5199\u6570\u636e\u5230\u78c1\u76d8\u65f6\uff0c\u7531\u4e8e\u78c1\u76d8\u901f\u5ea6\u6bd4\u8f83\u6162\uff0c\u6240\u4ee5CPU\u5148\u628a\u6570\u636e\u5b58\u8fdbbuffer\uff0c\u7136\u540eCPU\u53bb\u6267\u884c\u5176\u4ed6\u4efb\u52a1\uff0cbuffer\u4e2d\u7684\u6570\u636e\u4f1a\u5b9a\u671f\u5199\u5165\u78c1\u76d8\uff1b</p> <p>\u5f53CPU\u9700\u8981\u4ece\u78c1\u76d8\u8bfb\u5165\u6570\u636e\u65f6\uff0c\u7531\u4e8e\u78c1\u76d8\u901f\u5ea6\u6bd4\u8f83\u6162\uff0c\u53ef\u4ee5\u628a\u5373\u5c06\u7528\u5230\u7684\u6570\u636e\u63d0\u524d\u5b58\u5165cache\uff0cCPU\u76f4\u63a5\u4eceCache\u4e2d\u8bfb\u53d6\u6570\u636e\u3002</p>"},{"location":"chap4/1Linux/#linuxinodeblock","title":"\u7b80\u8ff0Linux\u4e2dinode\u548cblock\uff1f","text":"<p>inode\u8282\u70b9\u662f\u4e00\u4e2a64\u5b57\u8282\u957f\u7684\u8868\uff0c\u8868\u4e2d\u5305\u542b\u4e86\u6587\u4ef6\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u5982\uff1a\u5b57\u8282\u6570\u3001\u5c5e\u4e3bUserID\u3001\u5c5e\u7ec4GroupID\u3001\u8bfb\u5199\u6267\u884c\u6743\u9650\u3001\u65f6\u95f4\u6233\u7b49\u3002</p> <p>\u5728inode\u8282\u70b9\u8868\u4e2d\u6700\u91cd\u8981\u7684\u5185\u5bb9\u662f\uff1a\u78c1\u76d8\u5730\u5740\u8868\u3002</p> <p>\u6587\u4ef6\u540d\u5b58\u653e\u5728\u76ee\u5f55\u5f53\u4e2d\uff0c\u4f46Linux\u7cfb\u7edf\u5185\u90e8\u4e0d\u4f7f\u7528\u6587\u4ef6\u540d\uff0c\u800c\u662f\u4f7f\u7528inode\u53f7\u7801\u8bc6\u522b\u6587\u4ef6\u3002\u5bf9\u4e8e\u7cfb\u7edf\u6765\u8bf4\u6587\u4ef6\u540d\u53ea\u662finode\u53f7\u7801\u4fbf\u4e8e\u8bc6\u522b\u7684\u522b\u79f0\u3002</p> <p>\u5373Linux\u6587\u4ef6\u7cfb\u7edf\u901a\u8fc7\u628ainode\u548c\u6587\u4ef6\u540d\u8fdb\u884c\u5173\u8054\u6765\u67e5\u627e\u6587\u4ef6\u3002\u5f53</p> <p>\u9700\u8981\u8bfb\u53d6\u8be5\u6587\u4ef6\u65f6\uff0c\u6587\u4ef6\u7cfb\u7edf\u5728\u5f53\u524d\u76ee\u5f55\u8868\u4e2d\u67e5\u627e\u8be5\u6587\u4ef6\u540d\u5bf9\u5e94\u7684\u9879\uff0c\u7531\u6b64\u5f97\u5230\u8be5\u6587\u4ef6\u76f8\u5bf9\u5e94\u7684inode\u8282\u70b9\u53f7\uff0c\u901a\u8fc7\u8be5inode\u8282\u70b9\u7684\u78c1\u76d8\u5730\u5740\u8868\u628a\u5206\u6563\u5b58\u653e\u7684\u6587\u4ef6\u7269\u7406\u5757\u8fde\u63a5\u6210\u6587\u4ef6\u7684\u903b\u8f91\u7ed3\u6784\u3002</p> <p>\u6587\u4ef6\u662f\u5b58\u50a8\u5728\u786c\u76d8\u4e0a\u7684\uff0c\u786c\u76d8\u7684\u6700\u5c0f\u5b58\u50a8\u5355\u4f4d\u53eb\u505a\u6247\u533asector\uff0c\u6bcf\u4e2a\u6247\u533a\u5b58\u50a8512\u5b57\u8282\u3002\u64cd\u4f5c\u7cfb\u7edf\u8bfb\u53d6\u786c\u76d8\u7684\u65f6\u5019\uff0c\u4e0d\u4f1a\u4e00\u4e2a\u4e2a\u6247\u533a\u5730\u8bfb\u53d6\uff0c\u8fd9\u6837\u6548\u7387\u592a\u4f4e\uff0c\u800c\u662f\u4e00\u6b21\u6027\u8fde\u7eed\u8bfb\u53d6\u591a\u4e2a\u6247\u533a\uff0c\u5373\u4e00\u6b21\u6027\u8bfb\u53d6\u4e00\u4e2a\u5757block\u3002\u8fd9\u79cd\u7531\u591a\u4e2a\u6247\u533a\u7ec4\u6210\u7684\u5757\uff0c\u662f\u6587\u4ef6\u5b58\u53d6\u7684\u6700\u5c0f\u5355\u4f4d\u3002\u5757\u7684\u5927\u5c0f\uff0c\u6700\u5e38\u89c1\u7684\u662f4KB\uff0c\u5373\u8fde\u7eed\u516b\u4e2asector\u7ec4\u6210\u4e00\u4e2ablock\u3002</p> <p>\u5373512\u5b57\u8282\u7ec4\u6210\u4e00\u4e2a\u6247\u533a\uff08sector\uff09\uff0c\u591a\u4e2a\u6247\u533a\u7ec4\u6210\u4e00\u4e2a\u5757\uff08block\uff09\uff0c\u5e38\u89c1\u7684\u5757\u5355\u4f4d4KB\uff0c\u5373\u8fde\u7eed\u516b\u4e2a\u6247\u533a\u7ec4\u6210\u4e00\u4e2ablock\u3002</p> <p>\u4e00\u4e2a\u6587\u4ef6\u5fc5\u987b\u5360\u7528\u4e00\u4e2ainode\uff0c\u4f46\u81f3\u5c11\u5360\u7528\u4e00\u4e2ablock\u3002</p>"},{"location":"chap4/1Linux/#linuxfsck","title":"\u7b80\u8ff0Linux\u6587\u4ef6\u7cfb\u7edf\u4fee\u590dfsck\u8fc7\u7a0b\uff1f","text":"<p>\u6210\u529f\u4fee\u590d\u6587\u4ef6\u7cfb\u7edf\u7684\u524d\u63d0\u662f\u8981\u6709\u4e24\u4e2a\u4ee5\u4e0a\u7684\u4e3b\u6587\u4ef6\u7cfb\u7edf\uff08\u5373\u4e24\u4e2a\u7cfb\u7edf\uff09\uff0c\u5e76\u4fdd\u8bc1\u5728\u4fee\u590d\u4e4b\u524d\u5378\u8f7d\u5c06\u88ab\u4fee\u590d\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u7136\u540e\u4f7f\u7528\u547d\u4ee4fsck\u5bf9\u53d7\u5230\u7834\u574f\u7684\u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u4fee\u590d\u3002</p> <p>fsck\u68c0\u67e5\u6587\u4ef6\u7cfb\u7edf\u5206\u4e3a5\u6b65\uff0c\u6bcf\u4e00\u6b65\u68c0\u67e5\u7cfb\u7edf\u4e0d\u540c\u90e8\u5206\u7684\u8fde\u63a5\u7279\u6027\u5e76\u5bf9\u4e0a\u4e00\u6b65\u8fdb\u884c\u9a8c\u8bc1\u548c\u4fee\u6539\u3002</p> <p>\u68c0\u67e5\u4ece\u8d85\u7ea7\u5757\u5f00\u59cb\u3001\u7136\u540e\u662f\u5206\u914d\u7684\u78c1\u76d8\u5757\u3001\u8def\u5f84\u540d\u3001\u76ee\u5f55\u7684\u8fde\u63a5\u6027\u3001\u94fe\u63a5\u6570\u76ee\u4ee5\u53ca\u7a7a\u95f2\u5757\u94fe\u8868\u3001inode\u3002</p>"},{"location":"chap4/1Linux/#linux_7","title":"\u7b80\u8ff0Linux\u4e2d\u8f6f\u94fe\u63a5\u548c\u786c\u94fe\u63a5\u7684\u533a\u522b\uff1f","text":"<ul> <li>\u8f6f\u94fe\u63a5</li> </ul> <p>\u8f6f\u94fe\u63a5\u7c7b\u4f3c\u4e8eWindows\u7684\u5feb\u6377\u65b9\u5f0f\u529f\u80fd\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u5feb\u901f\u8fde\u63a5\u5230\u76ee\u6807\u6587\u4ef6\u6216\u76ee\u5f55\u3002\u5373\u518d\u521b\u5efa\u4e00\u4e2a\u72ec\u7acb\u7684\u6587\u4ef6\uff0c\u800c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u8ba9\u6570\u636e\u7684\u8bfb\u53d6\u6307\u5411\u5b83\u8fde\u63a5\u7684\u90a3\u4e2a\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u3002\u4f8b\u5982\uff0c\u6587\u4ef6A\u548c\u6587\u4ef6B\u7684inode\u53f7\u7801\u867d\u7136\u4e0d\u4e00\u6837\uff0c\u4f46\u662f\u6587\u4ef6A\u7684\u5185\u5bb9\u662f\u6587\u4ef6B\u7684\u8def\u5f84\u3002\u8bfb\u53d6\u6587\u4ef6A\u65f6\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u5c06\u8bbf\u95ee\u8005\u5bfc\u5411\u6587\u4ef6B\u3002\u8fd9\u65f6\uff0c\u6587\u4ef6A\u5c31\u79f0\u4e3a\u6587\u4ef6B\u7684\u8f6f\u94fe\u63a5\u3002</p> <ul> <li>\u786c\u94fe\u63a5</li> </ul> <p>\u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u7684inode\u94fe\u63a5\u6765\u4ea7\u751f\u7684\u65b0\u7684\u6587\u4ef6\u540d\uff0c\u800c\u4e0d\u662f\u4ea7\u751f\u65b0\u7684\u6587\u4ef6\uff0c\u79f0\u4e3a\u786c\u94fe\u63a5\u3002</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2ainode\u53f7\u7801\u5bf9\u5e94\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u4f46\u662fLinux\u5141\u8bb8\u591a\u4e2a\u6587\u4ef6\u540d\u6307\u5411\u540c\u4e00\u4e2ainode\u53f7\u7801\u3002\u610f\u5473\u7740\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u6587\u4ef6\u540d\u8bbf\u95ee\u76f8\u540c\u7684\u5185\u5bb9\u3002\u521b\u5efa\u786c\u94fe\u63a5\uff0c\u6e90\u6587\u4ef6\u4e0e\u76ee\u6807\u6587\u4ef6\u7684inode\u53f7\u7801\u76f8\u540c\uff0c\u90fd\u6307\u5411\u540c\u4e00\u4e2ainode\u3002inode\u4fe1\u606f\u4e2d\u7684\u94fe\u63a5\u6570\u8fd9\u65f6\u5c31\u4f1a\u589e\u52a01\u3002</p> <p>\u5f53\u4e00\u4e2a\u6587\u4ef6\u62e5\u6709\u591a\u4e2a\u786c\u94fe\u63a5\u65f6\uff0c\u5bf9\u6587\u4ef6\u5185\u5bb9\u4fee\u6539\uff0c\u4f1a\u5f71\u54cd\u5230\u6240\u6709\u5176\u4ed6\u6587\u4ef6\u7684\u5185\u5bb9\uff1b</p> <p>\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u4e0d\u5f71\u54cd\u53e6\u4e00\u4e2a\u6587\u4ef6\u540d\u7684\u8bbf\u95ee\uff0c\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u53ea\u4f1a\u4f7f\u5f97inode\u4e2d\u7684\u94fe\u63a5\u6570\u51cf1\u3002</p> <ul> <li>\u533a\u522b</li> </ul> <p>\u8f6f\u94fe\u63a5\u4e0e\u786c\u94fe\u63a5\u6700\u5927\u7684\u533a\u522b\uff1a\u8f6f\u94fe\u63a5\u662f\u6587\u4ef6A\u6307\u5411\u6587\u4ef6B\u7684\u6587\u4ef6\u540d\uff0c\u800c\u4e0d\u662f\u6587\u4ef6B\u7684inode\u53f7\u7801\uff0c\u6587\u4ef6B\u7684inode\u94fe\u63a5\u6570\u4e0d\u4f1a\u56e0\u6b64\u53d1\u751f\u53d8\u5316\u3002</p> <p>\u4e0d\u80fd\u5bf9\u76ee\u5f55\u505a\u786c\u94fe\u63a5\uff0c\u4f46\u662f\u901a\u8fc7mkdir\u547d\u4ee4\u521b\u5efa\u4e00\u4e2a\u65b0\u76ee\u5f55\uff0c\u901a\u5e38\u5176\u786c\u94fe\u63a5\u6570\u5e94\u8be5\u67092\u4e2a\uff0c\u56e0\u4e3a\u5e38\u89c1\u7684\u76ee\u5f55\u672c\u8eab\u4e3a1\u4e2a\u786c\u94fe\u63a5\uff0c\u800c\u76ee\u5f55\u4e0b\u9762\u7684\u9690\u85cf\u76ee\u5f55.\uff08\u70b9\u53f7\uff09\u662f\u8be5\u76ee\u5f55\u7684\u53c8\u4e00\u4e2a\u786c\u94fe\u63a5\uff0c\u4e5f\u7b97\u662f1\u4e2a\u8fde\u63a5\u6570\u3002</p>"},{"location":"chap4/1Linux/#tcpudp","title":"\u7b80\u8ff0TCP\u4e09\u6b21\u63e1\u624b\uff0c\u56db\u6b21\u65ad\u5f00\uff0c\u53ca\u5176\u4f18\u70b9\u548c\u7f3a\u70b9\uff0c\u540c\u65f6\u76f8\u5bf9\u4e8eUDP\u7684\u5dee\u522b\uff1f","text":"<p>TCP\u4e0eUDP\u6982\u5ff5\uff1a</p> <ul> <li>TCP\uff1a\u4f20\u8f93\u63a7\u5236\u534f\u8bae\uff0c\u5373\u9762\u5411\u8fde\u63a5\uff1b</li> <li>UDP\uff1a\u7528\u6237\u6570\u636e\u62a5\u534f\u8bae\uff0c\u65e0\u8fde\u63a5\u7684\uff0c\u5373\u53d1\u9001\u6570\u636e\u4e4b\u524d\u4e0d\u9700\u8981\u5efa\u7acb\u8fde\u63a5</li> </ul> <p>TCP\u4e0eUDP\u7684\u4f18\u7f3a\u70b9\u4e0a\u7684\u533a\u522b\uff1a</p> <p>TCP\u7684\u4f18\u70b9\uff1a</p> <p>\u53ef\u9760\uff0c\u7a33\u5b9a\u3002TCP\u7684\u53ef\u9760\u4f53\u73b0\u5728TCP\u5728\u4f20\u9012\u6570\u636e\u4e4b\u524d\uff0c\u4f1a\u6709\u4e09\u6b21\u63e1\u624b\u6765\u5efa\u7acb\u8fde\u63a5\uff0c\u800c\u4e14\u5728\u6570\u636e\u4f20\u9012\u65f6\uff0c\u6709\u786e\u8ba4\u3001\u7a97\u53e3\u3001\u91cd\u4f20\u3001\u62e5\u585e\u63a7\u5236\u673a\u5236\uff0c\u5728\u6570\u636e\u4f20\u5b8c\u540e\uff0c\u8fd8\u4f1a\u65ad\u5f00\u8fde\u63a5\u7528\u6765\u8282\u7ea6\u7cfb\u7edf\u8d44\u6e90\u3002</p> <ul> <li>\u4e09\u6b21\u63e1\u624b\uff1a<ol> <li>\u7b2c\u4e00\u6b21\u63e1\u624b\uff0c\u4e3b\u673aA\u5411\u4e3b\u673aB\u53d1\u51fa\u4e00\u4e2a\u542b\u540c\u6b65\u5e8f\u5217\u53f7\u7684\u6807\u5fd7\u4f4d\u7684\u6570\u636e\u6bb5\u7ed9\u4e3b\u673aB \uff0c\u5411\u4e3b\u673aB\u8bf7\u6c42\u5efa\u7acb\u8fde\u63a5\u3002\u901a\u8fc7\u8fd9\u4e2a\u6570\u636e\u6bb5\uff0cA\u5411B\u58f0\u660e\u901a\u4fe1\u8bf7\u6c42\uff0c\u4ee5\u53ca\u544a\u77e5B\u53ef\u7528\u67d0\u4e2a\u5e8f\u5217\u53f7\u4f5c\u4e3a\u8d77\u59cb\u6570\u636e\u6bb5\u8fdb\u884c\u54cd\u5e94\uff1b</li> <li>\u7b2c\u4e8c\u6b21\u63e1\u624b\uff0c\u4e3b\u673aB\u6536\u5230\u4e3b\u673aA\u7684\u8bf7\u6c42\u540e\uff0c\u7528\u4e00\u5e26\u6709\u786e\u8ba4\u5e94\u7b54(ACK)\u548c\u540c\u6b65\u5e8f\u5217\u53f7(SYN)\u6807\u5fd7\u4f4d\u7684\u6570\u636e\u6bb5\u54cd\u5e94A\u3002\u901a\u8fc7\u6b64\u6570\u636e\u6bb5\uff0cB\u5411A\u58f0\u660e\u5df2\u6536\u5230A\u7684\u8bf7\u6c42\uff0cA\u53ef\u4ee5\u4f20\u8f93\u6570\u636e\u4e86\uff0c\u540c\u65f6\u544a\u77e5A\u53ef\u7528\u67d0\u4e2a\u5e8f\u5217\u53f7\u4f5c\u4e3a\u8d77\u59cb\u6570\u636e\u6bb5\u8fdb\u884c\u54cd\u5e94</li> <li>\u7b2c\u4e09\u6b21\u63e1\u624b\uff0c\u4e3b\u673aA\u6536\u5230\u4e3b\u673aB\u7684\u6570\u636e\u6bb5\u540e\uff0c\u518d\u53d1\u9001\u4e00\u4e2a\u786e\u8ba4\u5e94\u7b54\uff0c\u786e\u8ba4\u5df2\u6536\u5230\u4e3b\u673aB \u7684\u6570\u636e\u6bb5\uff0c\u4e4b\u540e\u5f00\u59cb\u6b63\u5f0f\u5b9e\u9645\u4f20\u8f93\u6570\u636e\u3002</li> </ol> </li> </ul> <p></p> <p>ACK\uff1aTCP\u62a5\u5934\u7684\u63a7\u5236\u4f4d\u4e4b\u4e00\uff0c\u5bf9\u6570\u636e\u8fdb\u884c\u786e\u8ba4\u3002\u786e\u8ba4\u7531\u76ee\u7684\u7aef\u53d1\u51fa\uff0c\u6765\u544a\u77e5\u53d1\u9001\u7aef\u8fd9\u4e2a\u5e8f\u5217\u53f7\u4e4b\u524d\u7684\u6570\u636e\u6bb5\u90fd\u6536\u5230\u4e86\u3002\u6bd4\u5982\uff0c\u786e\u8ba4\u53f7\u4e3aX\uff0c\u5219\u8868\u793a\u524dX-1\u4e2a\u6570\u636e\u6bb5\u90fd\u6536\u5230\u4e86\u3002\u53ea\u6709\u5f53ACK=1\u65f6\uff0c\u786e\u8ba4\u53f7\u624d\u6709\u6548\uff0c\u5f53ACK=0\u65f6\uff0c\u786e\u8ba4\u53f7\u65e0\u6548\uff0c\u6b64\u65f6\u4f1a\u8981\u6c42\u91cd\u4f20\u6570\u636e\uff0c\u4fdd\u8bc1\u6570\u636e\u7684\u5b8c\u6574\u6027\u3002</p> <p>SYN\uff1a\u540c\u6b65\u5e8f\u5217\u53f7\uff0c\u8fd9\u4e2a\u6807\u5fd7\u4f4d\u53ea\u6709\u5728TCP\u5efa\u7acb\u8fde\u63a5\u65f6\u624d\u4f1a\u88ab\u7f6e1\uff0c\u63e1\u624b\u5b8c\u6210\u540eSYN\u6807\u5fd7\u4f4d\u88ab\u7f6e0\u3002</p> <ul> <li> <p>\u56db\u6b21\u65ad\u5f00\uff1a</p> <ul> <li>\u5f53\u4e3b\u673aA\u5b8c\u6210\u6570\u636e\u4f20\u8f93\u540e\uff0c\u5c06\u63a7\u5236\u4f4dFIN\u7f6e1\uff0c\u63d0\u51fa\u505c\u6b62TCP\u8fde\u63a5\u7684\u8bf7\u6c42\uff1b</li> <li>\u4e3b\u673aB\u6536\u5230FIN\u540e\u5bf9\u5176\u4f5c\u51fa\u54cd\u5e94\uff0c\u786e\u8ba4\u8fd9\u4e00\u65b9\u5411\u4e0a\u7684TCP\u8fde\u63a5\u5c06\u5173\u95ed\uff0c\u5c06ACK\u7f6e1\uff1b</li> <li>\u4e3b\u673aB\u518d\u63d0\u51fa\u53cd\u65b9\u5411\u7684\u5173\u95ed\u8bf7\u6c42\uff0c\u5c06FIN\u7f6e1\uff1b</li> <li>\u4e3b\u673aA\u5bf9\u4e3b\u673aB\u7684\u8bf7\u6c42\u8fdb\u884c\u786e\u8ba4\uff0c\u5c06ACK\u7f6e1\uff0c\u53cc\u65b9\u5411\u7684\u5173\u95ed\u7ed3\u675f</li> </ul> </li> <li> <p>TCP\u7684\u7f3a\u70b9\uff1a</p> </li> </ul> <p>\u6162\u3001\u6548\u7387\u4f4e\u3001\u5360\u7528\u7cfb\u7edf\u8d44\u6e90\u9ad8\u3001\u6613\u88ab\u653b\u51fb\uff1aTCP\u5728\u4f20\u9012\u6570\u636e\u4e4b\u524d\uff0c\u8981\u5148\u5efa\u8fde\u63a5\uff0c\u9700\u8981\u6d88\u8017\u65f6\u95f4\uff0c\u800c\u4e14\u5728\u6570\u636e\u4f20\u9012\u65f6\uff0c\u786e\u8ba4\u673a\u5236\u3001\u91cd\u4f20\u673a\u5236\u3001\u62e5\u585e\u63a7\u5236\u673a\u5236\u7b49\u90fd\u4f1a\u6d88\u8017\u5927\u91cf\u7684\u65f6\u95f4\uff0c\u800c\u4e14\u8981\u5728\u6bcf\u53f0\u8bbe\u5907\u4e0a\u7ef4\u62a4\u6240\u6709\u7684\u4f20\u8f93\u8fde\u63a5\u3002</p> <p>\u540c\u65f6\uff0c\u6bcf\u4e2a\u8fde\u63a5\u90fd\u4f1a\u5360\u7528\u7cfb\u7edf\u7684CPU\u3001\u5185\u5b58\u7b49\u786c\u4ef6\u8d44\u6e90\u3002\u800c\u4e14\uff0c\u56e0\u4e3aTCP\u6709\u786e\u8ba4\u673a\u5236\u3001\u4e09\u6b21\u63e1\u624b\u673a\u5236\uff0c\u8fd9\u4e9b\u4e5f\u5bfc\u81f4TCP\u5bb9\u6613\u88ab\u4eba\u5229\u7528\uff0c\u5b9e\u73b0DOS\u3001DDOS\u3001CC\u7b49\u653b\u51fb\u3002</p> <ul> <li>DoS\uff1a\u62d2\u7edd\u670d\u52a1\uff08Denial of Servic\uff09\uff0c\u9020\u6210DoS\u7684\u653b\u51fb\u884c\u4e3a\u88ab\u79f0\u4e3aDoS\u653b\u51fb\uff0c\u5176\u76ee\u7684\u662f\u4f7f\u8ba1\u7b97\u673a\u6216\u7f51\u7edc\u65e0\u6cd5\u63d0\u4f9b\u6b63\u5e38\u7684\u670d\u52a1\u3002\u6700\u5e38\u89c1\u7684DoS\u653b\u51fb\u6709\u8ba1\u7b97\u673a\u7f51\u7edc\u5e26\u5bbd\u653b\u51fb\u548c\u8fde\u901a\u6027\u653b\u51fb\u3002</li> <li>DDOS\uff1a\u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1(DDoS:Distributed Denial of Service)\uff0cDDoS\u653b\u51fb\u6307\u501f\u52a9\u4e8e\u5ba2\u6237/\u670d\u52a1\u5668\u6280\u672f\uff0c\u5c06\u591a\u4e2a\u8ba1\u7b97\u673a\u8054\u5408\u8d77\u6765\u4f5c\u4e3a\u653b\u51fb\u5e73\u53f0\uff0c\u5bf9\u4e00\u4e2a\u6216\u591a\u4e2a\u76ee\u6807\u53d1\u52a8DDoS\u653b\u51fb\uff0c\u4ece\u800c\u6210\u500d\u5730\u63d0\u9ad8\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u7684\u5a01\u529b\u3002</li> </ul> <ul> <li>UDP\u7684\u4f18\u70b9\uff1a</li> </ul> <p>\u5feb\u3001\u6bd4TCP\u7a0d\u5b89\u5168\u3001\u6ca1\u6709TCP\u7684\u63e1\u624b\u3001\u786e\u8ba4\u3001\u7a97\u53e3\u3001\u91cd\u4f20\u3001\u62e5\u585e\u63a7\u5236\u7b49\u673a\u5236\uff0cUDP\u662f\u4e00\u4e2a\u65e0\u72b6\u6001\u7684\u4f20\u8f93\u534f\u8bae\uff0c\u6240\u4ee5\u5b83\u5728\u4f20\u9012\u6570\u636e\u65f6\u975e\u5e38\u5feb\u3002\u6ca1\u6709TCP\u7684\u8fd9\u4e9b\u673a\u5236\uff0cUDP\u88ab\u653b\u51fb\u8005\u5229\u7528\u7684\u6f0f\u6d1e\u5c31\u8981\u5c11\u4e00\u4e9b\u3002\u4f46UDP\u4e5f\u662f\u65e0\u6cd5\u907f\u514d\u653b\u51fb\u7684\uff0c\u6bd4\u5982\uff1aUDP Flood\u653b\u51fb\u3002</p> <p>UDP Flood\u653b\u51fb\u68c0\u6d4b\uff1a\u77ed\u65f6\u95f4\u5185\u5411\u7279\u5b9a\u76ee\u6807\u4e0d\u65ad\u53d1\u9001 UDP \u62a5\u6587\uff0c\u81f4\u4f7f\u76ee\u6807\u7cfb\u7edf\u8d1f\u62c5\u8fc7\u91cd\u800c\u4e0d\u80fd\u5904\u7406\u5408\u6cd5\u7684\u4f20\u8f93\u4efb\u52a1\uff0c\u5c31\u53d1\u751f\u4e86 UDP Flood\u3002\u542f\u7528 UDP Flood \u653b\u51fb\u68c0\u6d4b\u529f\u80fd\u65f6\uff0c\u8981\u6c42\u8bbe\u7f6e\u4e00\u4e2a\u8fde\u63a5\u901f\u7387\u9608\u503c\uff0c\u4e00\u65e6\u53d1\u73b0\u4fdd\u62a4\u4e3b\u673a\u54cd\u5e94\u7684 UDP \u8fde\u63a5\u901f\u7387\u8d85\u8fc7\u8be5\u503c\uff0c\u9632\u706b\u5899\u4f1a\u8f93\u51fa\u53d1\u751f UDP Flood \u653b\u51fb\u7684\u544a\u8b66\u65e5\u5fd7\uff0c\u5e76\u4e14\u6839\u636e\u7528\u6237\u7684\u914d\u7f6e\u53ef\u4ee5\u963b\u6b62\u53d1\u5f80\u8be5\u4e3b\u673a\u7684\u540e\u7eed\u8fde\u63a5\u8bf7\u6c42\u3002</p> <ul> <li>UDP\u7684\u7f3a\u70b9\uff1a</li> </ul> <p>\u4e0d\u53ef\u9760\u3001\u4e0d\u7a33\u5b9a\u3002\u56e0\u4e3aUDP\u6ca1\u6709\u90a3\u4e9b\u53ef\u9760\u7684\u673a\u5236\uff0c\u5728\u6570\u636e\u4f20\u9012\u65f6\uff0c\u5982\u679c\u7f51\u7edc\u8d28\u91cf\u4e0d\u597d\uff0c\u5c31\u4f1a\u5f88\u5bb9\u6613\u4e22\u5305\u3002</p> <ul> <li>TCP\u5e94\u7528\u573a\u666f\uff1a</li> </ul> <p>\u5f53\u5bf9\u7f51\u7edc\u901a\u8baf\u8d28\u91cf\u6709\u8981\u6c42\u7684\u65f6\u5019\uff0c\u6bd4\u5982\uff1a\u6574\u4e2a\u6570\u636e\u8981\u51c6\u786e\u65e0\u8bef\u7684\u4f20\u9012\u7ed9\u5bf9\u65b9\uff0c\u8981\u6c42\u53ef\u9760\u7684\u5e94\u7528\uff0c\u6bd4\u5982HTTP\u3001HTTPS\u3001FTP\u7b49\u4f20\u8f93\u6587\u4ef6\u7684\u534f\u8bae\uff0cPOP\u3001SMTP\u7b49\u90ae\u4ef6\u4f20\u8f93\u7684\u534f\u8bae\u3002</p> <ul> <li>UDP\u5e94\u7528\u573a\u666f\uff1a</li> </ul> <p>\u5f53\u5bf9\u7f51\u7edc\u901a\u8baf\u8d28\u91cf\u8981\u6c42\u4e0d\u9ad8\u7684\u65f6\u5019\uff0c\u8981\u6c42\u7f51\u7edc\u901a\u8baf\u901f\u5ea6\u80fd\u5c3d\u91cf\u7684\u5feb\u3002\u6bd4\u5982QQ\u8bed\u97f3\u3001QQ\u89c6\u9891\u3001TFTP \u3002</p>"},{"location":"chap4/1Linux/#tcpip","title":"\u7b80\u8ff0TCP/IP\u53ca\u5176\u4e3b\u8981\u534f\u8bae\uff1f","text":"<p>TCP/IP\u534f\u8bae\u662f\u4e00\u4e2a\u534f\u8bae\u7c07\uff0c\u5176\u4e2d\u5305\u62ec\u5f88\u591a\u534f\u8bae\u7684\u3002</p> <p>TCP/IP\u534f\u8bae\u5305\u62ec\u5e94\u7528\u5c42\u3001\u4f20\u8f93\u5c42\u3001\u7f51\u7edc\u5c42\u3001\u7f51\u7edc\u8bbf\u95ee\u5c42\uff08\u7f51\u7edc\u63a5\u53e3\u5c42\u3001\u7f51\u9645\u5c42\uff09\u3002</p> <p>\u5e94\u7528\u5c42\uff1a\u5e94\u7528\u7a0b\u5e8f\u95f4\u6c9f\u901a\u7684\u5c42</p> <ul> <li>\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae(HTTP)\uff1a\u4e07\u7ef4\u7f51\u7684\u57fa\u672c\u534f\u8bae\uff1b</li> <li>\u6587\u4ef6\u4f20\u8f93(TFTP)\uff1a\u7b80\u5355\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff1b</li> <li>\u8fdc\u7a0b\u767b\u5f55(Telnet)\uff1a\u63d0\u4f9b\u8fdc\u7a0b\u8bbf\u95ee\u5176\u5b83\u4e3b\u673a\u529f\u80fd\uff0c\u5b83\u5141\u8bb8\u7528\u6237\u767b\u5f55internet\u4e3b\u673a\uff0c\u5e76\u5728\u8fd9\u53f0\u4e3b\u673a\u4e0a\u6267\u884c\u547d\u4ee4\uff1b</li> <li>\u7f51\u7edc\u7ba1\u7406(SNMP)\uff1a\u7b80\u5355\u7f51\u7edc\u7ba1\u7406\u534f\u8bae\uff0c\u8be5\u534f\u8bae\u63d0\u4f9b\u4e86\u76d1\u63a7\u7f51\u7edc\u8bbe\u5907\u7684\u65b9\u6cd5\uff0c\u4ee5\u53ca\u914d\u7f6e\u7ba1\u7406\u3001\u7edf\u8ba1\u4fe1\u606f\u6536\u96c6\u3001\u6027\u80fd\u7ba1\u7406\u53ca\u5b89\u5168\u7ba1\u7406\u7b49\uff1b</li> <li>\u57df\u540d\u7cfb\u7edf(DNS)\uff1a\u57df\u540d\u89e3\u6790\u670d\u52a1\uff0c\u8be5\u7cfb\u7edf\u7528\u4e8e\u5728internet\u4e2d\u5c06\u57df\u540d\u53ca\u8f6c\u6362\u6210IP\u5730\u5740\uff1b</li> </ul> <p>\u4f20\u8f93\u5c42\uff1a\u63d0\u4f9b\u4e86\u8282\u70b9\u95f4\u7684\u6570\u636e\u4f20\u9001\u670d\u52a1\uff0c\u7ed9\u6570\u636e\u5305\u52a0\u5165\u4f20\u8f93\u6570\u636e\u5e76\u628a\u5b83\u4f20\u8f93\u5230\u4e0b\u4e00\u5c42\u4e2d\uff0c\u8fd9\u4e00\u5c42\u8d1f\u8d23\u4f20\u9001\u6570\u636e\uff0c\u5e76\u4e14\u786e\u5b9a\u6570\u636e\u5df2\u88ab\u9001\u8fbe\u5e76\u63a5\u6536\u3002</p> <ul> <li>\u4f20\u8f93\u63a7\u5236\u534f\u8bae\uff08TCP\uff09</li> <li>\u7528\u6237\u6570\u636e\u62a5\u534f\u8bae\uff08UDP\uff09</li> </ul> <p>\u7f51\u7edc\u5c42\uff1a\u8d1f\u8d23\u63d0\u4f9b\u57fa\u672c\u7684\u6570\u636e\u5c01\u5305\u4f20\u9001\u529f\u80fd\uff0c\u8ba9\u6bcf\u4e00\u4e2a\u6570\u636e\u5305\u90fd\u80fd\u591f\u5230\u8fbe\u76ee\u7684\u4e3b\u673a\uff08\u4f46\u4e0d\u68c0\u67e5\u662f\u5426\u88ab\u6b63\u786e\u63a5\u6536\uff09\u3002</p> <ul> <li>Internet\u534f\u8bae(IP) \uff1a\u6839\u636e\u7f51\u95f4\u62a5\u6587IP\u5730\u5740\uff0c\u4ece\u4e00\u4e2a\u7f51\u7edc\u901a\u8fc7\u8def\u7531\u5668\u4f20\u5230\u53e6\u4e00\u7f51\u7edc\uff1b</li> <li>ICMP\uff1aInternet\u63a7\u5236\u4fe1\u606f\u534f\u8bae(ICMP)\uff1b</li> <li>ARP\uff1a\u5730\u5740\u89e3\u6790\u534f\u8bae(ARP) \u2014\u2014\"\u6700\u4e0d\u5b89\u5168\u7684\u534f\u8bae\"\u3002</li> <li>RARP\uff1a\u53cd\u5411\u5730\u5740\u89e3\u6790\u534f\u8bae(RARP)\uff1a</li> </ul> <p>\u7f51\u7edc\u8bbf\u95ee\u5c42\uff1a\u53c8\u79f0\u4f5c\u4e3b\u673a\u5230\u7f51\u7edc\u5c42(host-to-network)\uff0cIP\u5730\u5740\u4e0e\u7269\u7406\u5730\u5740\u786c\u4ef6\u7684\u6620\u5c04\u53caIP\u5c01\u88c5\u6210\u5e27\uff0c\u57fa\u4e8e\u4e0d\u540c\u786c\u4ef6\u7c7b\u578b\u7684\u7f51\u7edc\u63a5\u53e3\uff0c\u7f51\u7edc\u8bbf\u95ee\u5c42\u5b9a\u4e49\u4e86\u4e0e\u7269\u7406\u4ecb\u8d28\u7684\u8fde\u63a5\u3002</p>"},{"location":"chap4/1Linux/#osi","title":"\u7b80\u8ff0OSI\u6a21\u578b\u53ca\u5176\u4e3b\u8981\u534f\u8bae\uff1f","text":"<p>OSI\u6a21\u578b\u662f\u4e00\u4e2a\u5f00\u653e\u5f0f\u7cfb\u7edf\u4e92\u8054\u53c2\u8003\u6a21\u578b\uff0c\u8be5\u6a21\u578b\u4eba\u4e3a\u7684\u5b9a\u4e49\u4e86\u4e03\u5c42\u7ed3\u6784\u3002\u7531\u4e0b\u81f3\u4e0a\u53ca\u5176\u4e3b\u8981\u4f5c\u7528\u4e3a\uff1a</p> <ul> <li>\u7269\u7406\u5c42\uff1aOSI\u7684\u7269\u7406\u5c42\u89c4\u5b9a\u4e86\u901a\u4fe1\u7aef\u70b9\u4e4b\u95f4\u7684\u673a\u68b0\u7279\u6027\u3001\u7535\u6c14\u7279\u6027\u3001\u529f\u80fd\u7279\u6027\u4ee5\u53ca\u8fc7\u7a0b\u7279\u6027\uff0c\u8be5\u5c42\u4e3a\u4e0a\u5c42\u534f\u8bae\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4f20\u8f93\u6570\u636e\u7684\u7269\u7406\u5a92\u4f53\u3002\u8be5\u5c42\u6570\u636e\u7684\u5355\u4f4d\u79f0\u4e3a\u6bd4\u7279(bit)\u3002\u5176\u4e3b\u8981\u6709\uff1aEIA/TIA\u3001RS-232\u3001EIA/TIA\u3001RS-449\u3001V.35\u3001RJ-45\u3001fddi\u4ee4\u724c\u73af\u7f51\u3002</li> <li>\u6570\u636e\u94fe\u8def\u5c42\uff1a\u5b9a\u4e49\u4e86\u5728\u5355\u4e2a\u94fe\u8def\u4e0a\u5982\u4f55\u4f20\u8f93\u6570\u636e\uff0c\u5176\u4e3b\u8981\u4f5c\u7528\u5305\u62ec\uff1a\u4f5c\u7528\u5305\u62ec\u7269\u7406\u5730\u5740\u5bfb\u5740\u3001\u6570\u636e\u7684\u6210\u5e27\u3001\u6d41\u91cf\u63a7\u5236\u3001\u6570\u636e\u7684\u68c0\u9519\u3001\u91cd\u53d1\u7b49\u3002\u8be5\u5c42\u6570\u636e\u7684\u5355\u4f4d\u79f0\u4e3a\u5e27(frame)\u3002\u5176\u4e3b\u8981\u6709\uff1aARP\u3001RARP\u3001SDLC\u3001HDLC\u3001PPP\u3001STP\u3001\u5e27\u4e2d\u7ee7\u3002</li> <li>\u7f51\u7edc\u5c42\uff1a\u5b9a\u4e49\u4e86\u7aef\u5230\u7aef\u7684\u5305\u4f20\u8f93\uff0c\u5b9a\u4e49\u4e86\u80fd\u591f\u6807\u8bc6\u6240\u6709\u7ed3\u70b9\u7684\u903b\u8f91\u5730\u5740\uff0c\u8fd8\u5b9a\u4e49\u4e86\u8def\u7531\u5b9e\u73b0\u7684\u65b9\u5f0f\u548c\u5b66\u4e60\u8def\u7531\u7684\u65b9\u5f0f\u3002\u4e3a\u4e86\u9002\u5e94\u6700\u5927\u4f20\u8f93\u5355\u5143\u957f\u5ea6\u5c0f\u4e8e\u5305\u957f\u5ea6\u7684\u4f20\u8f93\u4ecb\u8d28\uff0c\u7f51\u7edc\u5c42\u8fd8\u5b9a\u4e49\u4e86\u5982\u4f55\u5c06\u4e00\u4e2a\u5305\u5206\u89e3\u6210\u66f4\u5c0f\u7684\u5305\u7684\u5206\u6bb5\u65b9\u6cd5\u3002\u4e3b\u8981\u8d1f\u8d23\u5bfb\u627e\u5730\u5740\u548c\u8def\u7531\u9009\u62e9\uff0c\u7f51\u7edc\u5c42\u8fd8\u53ef\u4ee5\u5b9e\u73b0\u62e5\u585e\u63a7\u5236\u3001\u7f51\u9645\u4e92\u8fde\u7b49\u529f\u80fd\u3002\u8be5\u5c42\u6570\u636e\u7684\u5355\u4f4d\u79f0\u4e3a\u6570\u636e\u5305(packet)\u3002\u4e3b\u8981\u6709\uff1aIP\u3001IPX\u3001RIP\u3001OSPF\u3002</li> <li>\u4f20\u8f93\u5c42\uff1a\u4e3b\u8981\u529f\u80fd\uff1a<ul> <li>\u4e3a\u7aef\u5230\u7aef\u8fde\u63a5\u63d0\u4f9b\u4f20\u8f93\u670d\u52a1\uff1b</li> <li>\u8fd9\u79cd\u4f20\u8f93\u670d\u52a1\u5206\u4e3a\u53ef\u9760\u548c\u4e0d\u53ef\u9760\u7684\uff0c\u5176\u4e2dTCP\u662f\u5178\u578b\u7684\u53ef\u9760\u4f20\u8f93\uff0c\u800cUDP\u5219\u662f\u4e0d\u53ef\u9760\u4f20\u8f93\uff1b</li> <li>\u4e3a\u7aef\u5230\u7aef\u8fde\u63a5\u63d0\u4f9b\u6d41\u91cf\u63a7\u5236\uff0c\u5dee\u9519\u63a7\u5236\uff0c\u91cd\u65b0\u6392\u5e8f\uff0c\u670d\u52a1\u8d28\u91cf\u7b49\u7ba1\u7406\u670d\u52a1\u3002</li> </ul> </li> <li>\u4f1a\u8bdd\u5c42\uff1a\u4ed6\u5b9a\u4e49\u4e86\u5982\u4f55\u5f00\u59cb\u3001\u63a7\u5236\u548c\u7ed3\u675f\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u5373\u8d1f\u8d23\u5efa\u7acb\u548c\u65ad\u5f00\u901a\u4fe1\u8fde\u63a5\uff08\u6570\u636e\u6d41\u52a8\u7684\u903b\u8f91\u901a\u8def\uff09\u3002\u4e3b\u8981\u6709\uff1aRPC\u3001SQL\u3001NetBIOS\u3002</li> <li>\u8868\u793a\u5c42\uff1a\u5b9a\u4e49\u6570\u636e\u683c\u5f0f\u53ca\u52a0\u5bc6\u3002\u4e3b\u8981\u8d1f\u8d23\u6570\u636e\u683c\u5f0f\u7684\u8f6c\u6362\uff0c\u786e\u4fdd\u4e00\u4e2a\u7cfb\u7edf\u7684\u5e94\u7528\u5c42\u4fe1\u606f\u53ef\u88ab\u53e6\u4e00\u4e2a\u7cfb\u7edf\u5e94\u7528\u5c42\u8bfb\u53d6\u3002\u4e3b\u8981\u6709\uff1a\u52a0\u5bc6\u3001ASII\u3001TIFF\u3001JPEG\u3001HTML\u3001PICT\u3002</li> <li>\u5e94\u7528\u5c42\uff1a\u4e0e\u5176\u4ed6\u8ba1\u7b97\u673a\u8fdb\u884c\u901a\u8baf\u7684\u4e00\u4e2a\u5e94\u7528\uff0c\u5b83\u662f\u5bf9\u5e94\u5e94\u7528\u7a0b\u5e8f\u7684\u901a\u4fe1\u670d\u52a1\u7684\uff0c\u4e3a\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u670d\u52a1\u5e76\u89c4\u5b9a\u5e94\u7528\u7a0b\u5e8f\u4e2d\u901a\u4fe1\u76f8\u5173\u7684\u7ec6\u8282\u3002\u4e3b\u8981\u6709\uff1aTelnet\u3001HTTP\u3001FTP\u3001WWW\u3001NFS\u3001SMTP\u3002</li> </ul>"},{"location":"chap4/1Linux/#ipip","title":"\u7b80\u8ff0IP\u534f\u8bae\u3001IP\u5730\u5740\uff1f","text":"<p>IP\u534f\u8bae(Internet Protocol)\uff1a\u53c8\u79f0\u4e92\u8054\u7f51\u534f\u8bae\uff0c\u662f\u652f\u6301\u7f51\u95f4\u4e92\u8fde\u7684\u6570\u636e\u62a5\u534f\u8bae\u3002\u5b83\u63d0\u4f9b\u7f51\u95f4\u8fde\u63a5\u7684\u5b8c\u5584\u529f\u80fd\uff0c\u5305\u62ecIP\u6570\u636e\u5305\u89c4\u5b9a\u4e92\u8fde\u7f51\u7edc\u8303\u56f4\u5185\u7684IP\u5730\u5740\u683c\u5f0f\u3002</p> <p>\u4e3a\u4e86\u5b9e\u73b0\u8fde\u63a5\u5230\u4e92\u8054\u7f51\u4e0a\u7684\u7ed3\u70b9\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u5fc5\u987b\u4e3a\u6bcf\u4e2a\u7ed3\u70b9\uff08\u5165\u7f51\u7684\u8ba1\u7b97\u673a\uff09\u5206\u914d\u4e00\u4e2a\u5730\u5740\uff0c\u5e76\u4e14\u5e94\u5f53\u4fdd\u8bc1\u8fd9\u4e2a\u5730\u5740\u662f\u5168\u7f51\u552f\u4e00\u7684\uff0c\u8fd9\u4fbf\u662fIP\u5730\u5740\u3002</p> <p>\u76ee\u524d\u7684IP\u5730\u5740\uff08IPv4\uff1aIP\u7b2c4\u7248\u672c\uff09\u753132\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u8868\u793a\uff0c\u6bcf8\u4f4d\u4e8c\u8fdb\u5236\u6570\u4e3a\u4e00\u4e2a\u6574\u6570\uff0c\u4e2d\u95f4\u7531\u5c0f\u6570\u70b9\u95f4\u9694\uff0c\u6574\u4e2aIP\u5730\u5740\u7a7a\u95f4\u67094\u7ec48\u4f4d\u4e8c\u8fdb\u5236\u6570\uff0c\u7531\u8868\u793a\u4e3b\u673a\u6240\u5728\u7684\u7f51\u7edc\u7684\u5730\u5740\u4ee5\u53ca\u4e3b\u673a\u5728\u8be5\u7f51\u7edc\u4e2d\u7684\u6807\u8bc6\u5171\u540c\u7ec4\u6210\u3002\u4e3a\u4e86\u4fbf\u4e8e\u5bfb\u5740\u548c\u5c42\u6b21\u5316\u7684\u6784\u9020\u7f51\u7edc\uff0cIP\u5730\u5740\u88ab\u5206\u4e3aA\u3001B\u3001C\u3001D\u3001E\u4e94\u7c7b\uff0c\u5546\u4e1a\u5e94\u7528\u4e2d\u53ea\u7528\u5230A\u3001B\u3001C\u4e09\u7c7b\u3002</p> <ul> <li>A\u7c7b\u5730\u5740\uff1a\u7f51\u7edc\u6807\u8bc6\u7531\u7b2c\u4e00\u7ec48\u4f4d\u4e8c\u8fdb\u5236\u6570\u8868\u793a\uff0c\u7f51\u7edc\u4e2d\u7684\u4e3b\u673a\u6807\u8bc6\u53603\u7ec48\u4f4d\u4e8c\u8fdb\u5236\u6570\uff0c\u7f51\u7edc\u6807\u8bc6\u7684\u7b2c\u4e00\u4f4d\u4e8c\u8fdb\u5236\u6570\u53d6\u503c\u5fc5\u987b\u4e3a\"0\"\u3002A\u7c7b\u5730\u5740\u5141\u8bb8\u6709126\u4e2a\u7f51\u6bb5\uff0c\u6bcf\u4e2a\u7f51\u7edc\u5927\u7ea6\u5141\u8bb8\u67091670\u4e07\u53f0\u4e3b\u673a\uff0c\u901a\u5e38\u5206\u914d\u7ed9\u62e5\u6709\u5927\u91cf\u4e3b\u673a\u7684\u7f51\u7edc\uff08\u5982\u4e3b\u5e72\u7f51\uff09\u3002<code>1.0.0.1\uff0d127.255.255.254</code></li> <li>B\u7c7b\u5730\u5740\uff1a\u7f51\u7edc\u6807\u8bc6\u7531\u524d\u4e24\u7ec48\u4f4d\u4e8c\u8fdb\u5236\u6570\u8868\u793a\uff0c\u7f51\u7edc\u4e2d\u7684\u4e3b\u673a\u6807\u8bc6\u5360\u4e24\u7ec48\u4f4d\u4e8c\u8fdb\u5236\u6570\uff0c\u7f51\u7edc\u6807\u8bc6\u7684\u524d\u4e24\u4f4d\u4e8c\u8fdb\u5236\u6570\u53d6\u503c\u5fc5\u987b\u4e3a\"10\"\u3002B\u7c7b\u5730\u5740\u5141\u8bb8\u670916384\u4e2a\u7f51\u6bb5\uff0c\u6bcf\u4e2a\u7f51\u7edc\u5141\u8bb8\u670965533\u53f0\u4e3b\u673a\uff0c\u9002\u7528\u4e8e\u7ed3\u70b9\u6bd4\u8f83\u591a\u7684\u7f51\u7edc\uff08\u5982\u533a\u57df\u7f51\uff09\u3002<code>128.1.0.1\uff0d191.255.255.254</code></li> <li>C\u7c7b\u5730\u5740\uff1a\u7f51\u7edc\u6807\u8bc6\u7531\u524d3\u7ec48\u4f4d\u4e8c\u8fdb\u5236\u6570\u8868\u793a\uff0c\u7f51\u7edc\u4e2d\u4e3b\u673a\u6807\u8bc6\u53601\u7ec48\u4f4d\u4e8c\u8fdb\u5236\u6570\uff0c\u7f51\u7edc\u6807\u8bc6\u7684\u524d3\u4f4d\u4e8c\u8fdb\u5236\u6570\u53d6\u503c\u5fc5\u987b\u4e3a\"110\"\u3002\u5177\u6709C\u7c7b\u5730\u5740\u7684\u7f51\u7edc\u5141\u8bb8\u6709254\u53f0\u4e3b\u673a\uff0c\u9002\u7528\u4e8e\u7ed3\u70b9\u6bd4\u8f83\u5c11\u7684\u7f51\u7edc\uff08\u5982\u6821\u56ed\u7f51\uff09\u3002<code>192.0.1.1\uff0d223.255.255.254</code></li> </ul> <p>\u4e3a\u4e86\u4fbf\u4e8e\u8bb0\u5fc6\uff0c\u901a\u5e38\u4e60\u60ef\u91c7\u75284\u4e2a\u5341\u8fdb\u5236\u6570\u6765\u8868\u793a\u4e00\u4e2aIP\u5730\u5740\uff0c\u5341\u8fdb\u5236\u6570\u4e4b\u95f4\u91c7\u7528\u53e5\u70b9\".\"\u4e88\u4ee5\u5206\u9694\u3002\u8fd9\u79cdIP\u5730\u5740\u7684\u8868\u793a\u65b9\u6cd5\u4e5f\u88ab\u79f0\u4e3a\u70b9\u5206\u5341\u8fdb\u5236\u6cd5\u3002</p>"},{"location":"chap4/1Linux/#_1","title":"\u7b80\u8ff0\u9759\u6001\u8def\u7531\u548c\u52a8\u6001\u8def\u7531\u53ca\u5176\u7279\u70b9\uff1f","text":"<ul> <li>\u9759\u6001\u8def\u7531\uff1a\u7531\u7cfb\u7edf\u7ba1\u7406\u5458\u521b\u5efa\u7684\u8def\u7531\uff0c\u9002\u7528\u4e8e\u7f51\u5173\u6570\u91cf\u6709\u9650\u7684\u573a\u5408\uff0c\u4e14\u7f51\u7edc\u62d3\u6734\u7ed3\u6784\u4e0d\u7ecf\u5e38\u53d8\u5316\u7684\u7f51\u7edc\u3002\u5176\u7f3a\u70b9\u662f\u4e0d\u80fd\u52a8\u6001\u5730\u9002\u7528\u7f51\u7edc\u72b6\u51b5\u7684\u53d8\u5316\uff0c\u5f53\u7f51\u7edc\u72b6\u51b5\u53d8\u5316\u540e\u9700\u8981\u7f51\u7edc\u7ba1\u7406\u5458\u624b\u52a8\u4fee\u6539\u8def\u7531\u8868\u3002</li> <li>\u52a8\u6001\u8def\u7531\uff1a\u7531\u8def\u7531\u9009\u62e9\u534f\u8bae\u52a8\u6001\u6784\u5efa\u7684\u8def\u7531\uff0c\u8def\u7531\u534f\u8bae\u4e4b\u95f4\u901a\u8fc7\u4ea4\u6362\u5404\u81ea\u6240\u62e5\u6709\u7684\u8def\u7531\u4fe1\u606f\u5b9e\u65f6\u66f4\u65b0\u8def\u7531\u8868\u7684\u5185\u5bb9\u3002\u52a8\u6001\u8def\u7531\u53ef\u4ee5\u81ea\u52a8\u5b66\u4e60\u7f51\u7edc\u7684\u62d3\u6734\u7ed3\u6784\uff0c\u5e76\u66f4\u65b0\u8def\u7531\u8868\u3002\u5176\u7f3a\u70b9\u662f\u8def\u7531\u5e7f\u64ad\u66f4\u65b0\u4fe1\u606f\u5c06\u5360\u636e\u5927\u91cf\u7684\u7f51\u7edc\u5e26\u5bbd\u3002</li> </ul>"},{"location":"chap4/1Linux/#nat","title":"\u7b80\u8ff0NAT\u7684\u51e0\u79cd\u7c7b\u578b\uff0c\u53ca\u5176\u539f\u7406\uff1f","text":"<p>\u5e38\u89c1\u7684NAT\u4e3b\u8981\u6709DNA\u548cSNAT\u3002</p> <ul> <li>SNAT\uff1a\u6307\u5728\u6570\u636e\u5305\u4ece\u7f51\u5361\u53d1\u9001\u51fa\u53bb\u7684\u65f6\u5019\uff0c\u628a\u6570\u636e\u5305\u4e2d\u7684\u6e90\u5730\u5740\u90e8\u5206\u66ff\u6362\u4e3a\u6307\u5b9a\u7684IP\u3002\u6b64\u65f6\uff0c\u63a5\u6536\u65b9\u5c31\u8ba4\u4e3a\u6570\u636e\u5305\u7684\u6765\u6e90\u662f\u88ab\u66ff\u6362\u7684\u90a3\u4e2aIP\u7684\u4e3b\u673a\u3002</li> <li>DNAT\uff1a\u6307\u6570\u636e\u5305\u4ece\u7f51\u5361\u53d1\u9001\u51fa\u53bb\u7684\u65f6\u5019\uff0c\u4fee\u6539\u6570\u636e\u5305\u4e2d\u7684\u76ee\u7684IP\u3002\u6b64\u65f6\uff0c\u82e5\u8bbf\u95eeA\uff0c\u4f46\u56e0\u6b64DNAT\u7684\u5b58\u5728\uff0c\u6240\u6709\u8bbf\u95eeA\u7684\u6570\u636e\u5305\u7684\u76ee\u7684IP\u5168\u90e8\u4fee\u6539\u4e3aB\uff0c\u90a3\u4e48\uff0c\u5b9e\u9645\u4e0a\u8bbf\u95ee\u7684\u662fB\u3002</li> </ul>"},{"location":"chap4/1Linux/#_2","title":"\u7b80\u8ff0\u5305\u8fc7\u6ee4\u9632\u706b\u5899\u548c\u4ee3\u7406\u5e94\u7528\u9632\u706b\u5899\u7684\u533a\u522b\uff1f","text":"<ul> <li>\u5305\u8fc7\u6ee4\u9632\u706b\u5899\uff1a\u5de5\u4f5c\u5728\u7f51\u7edc\u5c42\uff0c\u6839\u636e\u5305\u5934\u4e2d\u7684\u6e90IP\u5730\u5740\u3001\u76ee\u6807IP\u5730\u5740\u3001\u534f\u8bae\u7c7b\u578b\u3001\u7aef\u53e3\u53f7\u8fdb\u884c\u8fc7\u6ee4\uff1b</li> <li>\u4ee3\u7406\u5e94\u7528\u9632\u706b\u5899\uff1a\u5de5\u4f5c\u5728\u5e94\u7528\u5c42\uff0c\u4f7f\u7528\u4ee3\u7406\u670d\u52a1\u5668\u6280\u672f\uff0c\u5c06\u5185\u7f51\u5bf9\u5916\u7f51\u7684\u8bbf\u95ee\uff0c\u53d8\u4e3a\u9632\u706b\u5899\u5bf9\u5916\u7f51\u7684\u8bbf\u95ee\uff0c\u53ef\u4ee5\u5bf9\u5305\u7684\u5185\u5bb9\u8fdb\u884c\u5206\u8fa8\uff0c\u4ece\u800c\u8fc7\u6ee4\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/","title":"\u7b2c\u4e8c\u8282 IT\u8fd0\u7ef4\u9762\u8bd5\u95ee\u9898\u603b\u7ed3-\u57fa\u7840\u670d\u52a1\u3001\u78c1\u76d8\u7ba1\u7406\u3001\u865a\u62df\u5e73\u53f0\u548c\u7cfb\u7edf\u7ba1\u7406","text":""},{"location":"chap4/2Linux_SVC/#1","title":"1\u3001\u57fa\u7840\u670d\u52a1","text":""},{"location":"chap4/2Linux_SVC/#1-1-linux","title":"1-1 \u7b80\u8ff0Linux\u4e2d\u5e38\u89c1\u7684\u7cfb\u7edf\u670d\u52a1\uff0c\u5176\u4f5c\u7528\u5206\u522b\u662f\uff1f","text":"<p>\u5e38\u89c1\u7684\u7cfb\u7edf\u670d\u52a1\u53ca\u5176\u4f5c\u7528\u6709\uff1a</p> <ul> <li>NTP/Chrony\uff1a\u7528\u4e8e\u65f6\u949f\u540c\u6b65\uff1b</li> <li>DHCP\uff1a\u52a8\u6001\u4e3b\u673a\u914d\u7f6e\u534f\u8bae\uff0c\u7528\u4e8e\u81ea\u52a8\u5206\u914d\u4e3b\u673a\u5730\u5740\uff0c\u9ed8\u8ba4\u4f7f\u7528UDP 63\u7aef\u53e3\uff1b</li> <li>DNS\uff1a\u57df\u540d\u89e3\u6790\uff0c\u8fd0\u884c\u5728UDP\u534f\u8bae\u4e4b\u4e0a\uff0c\u9ed8\u8ba4\u4f7f\u752853\u7aef\u53e3\uff1b</li> <li>NFS\uff1a\u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f9d\u8d56\u4e8eRCP\u534f\u8bae\uff0c\u5176\u57fa\u672c\u539f\u5219\u662f\u201c\u5bb9\u8bb8\u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u53ca\u670d\u52a1\u7aef\u901a\u8fc7\u4e00\u7ec4RPC\u5206\u4eab\u76f8\u540c\u7684\u6587\u4ef6\u7cfb\u7edf\u201d\uff0c\u5b83\u662f\u72ec\u7acb\u4e8e\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5bb9\u8bb8\u4e0d\u540c\u786c\u4ef6\u53ca\u64cd\u4f5c\u7cfb\u7edf\u7684\u7cfb\u7edf\u5171\u540c\u8fdb\u884c\u6587\u4ef6\u7684\u5206\u4eab\u3002</li> <li>Postfix\uff1a\u90ae\u4ef6\u670d\u52a1\uff1b</li> <li>rsync\uff1a\u8fdc\u7a0b\u6570\u636e\u5907\u4efd\u670d\u52a1\u3002</li> <li>VPN\uff1a\u865a\u62df\u4e13\u7528\u7f51\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#1-2-ftp","title":"1-2 \u7b80\u8ff0FTP\u4e3b\u8981\u7684\u5de5\u4f5c\u6a21\u5f0f\uff1f","text":"<p>FTP\u5de5\u4f5c\u6a21\u5f0f\u662f\u4ee5\u670d\u52a1\u7aef\u89d2\u5ea6\u6765\u533a\u5206\uff0c\u6709\u4e3b\u52a8\u6a21\u5f0f\u548c\u88ab\u52a8\u6a21\u5f0f\u3002</p> <ul> <li>\u4e3b\u52a8\u6a21\u5f0f\u662f\u6307\u7531FTP\u670d\u52a1\u7aef\u4e3b\u52a8\u5411\u5ba2\u6237\u7aef\u53d1\u8d77\u8fde\u63a5\uff0c\u670d\u52a1\u7aef\u7aef\u53e3\u53f7\u4e3a20\uff08\u7528\u4e8e\u4f20\u8f93\uff09\u548c21\uff08\u7528\u4e8e\u63a7\u5236\uff09\uff0c\u537320\u7aef\u53e3\u5411\u5ba2\u6237\u7aef\u7684\u4e00\u4e2a\u5927\u4e8e1024\u7684\u968f\u673a\u7aef\u53e3\u4f20\u8f93\u6570\u636e\uff1b</li> <li>\u88ab\u52a8\u6a21\u5f0f\u662f\u6307\u7531FTP\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u8d77\u8fde\u63a5\uff0c\u670d\u52a1\u7aef\u91c7\u7528\u968f\u673a\u7aef\u53e3\u7b49\u5f85\u5ba2\u6237\u7aef\u7684\u968f\u673a\u7aef\u53e3\u6765\u8bbf\u95ee\uff0c\u4ece\u800c\u4f20\u8f93\u6570\u636e\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#1-3-ftp","title":"1-3 \u7b80\u8ff0FTP\u4e24\u79cd\u767b\u5f55\u65b9\u5f0f\u4ee5\u53ca\u4e24\u79cd\u4f20\u8f93\u6a21\u5f0f\uff1f","text":"<p>FTP\u6709\u4e24\u79cd\u767b\u5f55\u65b9\u5f0f\uff1a\u533f\u540d\u767b\u5f55\u548c\u6388\u6743\u767b\u5f55\u3002</p> <p>\u4f7f\u7528\u533f\u540d\u767b\u5f55\u65f6\uff0c\u7528\u6237\u540d\u4e3a\uff1aanonymous\uff0c\u5bc6\u7801\u4e3a\uff1a\u4efb\u4f55\u5408\u6cd5email\u5730\u5740\uff1b</p> <p>\u4f7f\u7528\u6388\u6743\u767b\u5f55\u65f6\uff0c\u7528\u6237\u540d\u4e3a\u7528\u6237\u5728\u8fdc\u7a0bFTP\u7cfb\u7edf\u4e2d\u7684\u7528\u6237\u5e10\u53f7\uff0c\u5bc6\u7801\u4e3a\u7528\u6237\u5728\u8fdc\u7a0b\u7cfb\u7edf\u4e2d\u7684\u7528\u6237\u5bc6\u7801\u3002</p> <p>\u533a\u522b\uff1a\u4f7f\u7528\u533f\u540d\u767b\u5f55\u53ea\u80fd\u8bbf\u95eeFTP\u76ee\u5f55\u4e0b\u7684\u8d44\u6e90\uff0c\u9ed8\u8ba4\u914d\u7f6e\u4e0b\u53ea\u80fd\u4e0b\u8f7d\uff1b\u800c\u6388\u6743\u767b\u5f55\u8bbf\u95ee\u7684\u6743\u9650\u5927\u4e8e\u533f\u540d\u767b\u5f55\uff0c\u4e14\u4e0a\u8f7d\u3001\u4e0b\u8f7d\u5747\u53ef\u3002</p> <p>FTP\u6587\u4ef6\u4f20\u8f93\u6709\u4e24\u79cd\u6587\u4ef6\u4f20\u8f93\u6a21\u5f0f\uff1aASCII\u6a21\u5f0f\u548cbinary\u6a21\u5f0f\u3002</p> <p>ASCII\u6a21\u5f0f\u7528\u6765\u4f20\u8f93\u6587\u672c\u6587\u4ef6\uff1b\u5176\u4ed6\u6587\u4ef6\u7684\u4f20\u8f93\u4f7f\u7528binary\u6a21\u5f0f\u3002</p>"},{"location":"chap4/2Linux_SVC/#1-4-dhcp","title":"1-4 \u7b80\u8ff0DHCP\u7684\u6d41\u7a0b\uff1f","text":"<p>\u65b0\u8282\u70b9\u901a\u8fc7DHCP\u83b7\u53d6\u5730\u5740\u4fe1\u606f\u7684\u4e3b\u8981\u6d41\u7a0b\u6709\u5982\u4e0b\u56db\u4e2a\u8fc7\u7a0b\uff1a</p> <p>1\u3001\u5bfb\u627eDHCP Server</p> <p>\u5ba2\u6237\u673a\u7b2c\u4e00\u6b21\u767b\u5f55\u7f51\u7edc\u7684\u65f6\uff0c\u5411\u7f51\u7edc\u4e0a\u53d1\u51fa\u4e00\u4e2aDHCPDISCOVER\u5e7f\u64ad\uff08\u5305\u4e2d\u5305\u542b\u5ba2\u6237\u673a\u7684MAC\u5730\u5740\u548c\u8ba1\u7b97\u673a\u540d\u7b49\u4fe1\u606f\uff09\u3002\u5176\u6e90\u5730\u5740\u4e3a0.0.0.0\uff0c\u76ee\u6807\u5730\u5740\u4e3a255.255.255.255\u3002</p> <p>2\u3001\u63d0\u4f9bIP\u5730\u5740\u79df\u7528</p> <p>\u670d\u52a1\u7aef\u76d1\u542c\u5230\u5ba2\u6237\u673a\u53d1\u51fa\u7684DHCP discover\u5e7f\u64ad\u540e\uff0c\u4ece\u5269\u4f59\u5730\u5740\u6c60\u4e2d\u9009\u62e9\u6700\u524d\u9762\u7684\u7a7a\u7f6eIP\uff0c\u8fde\u540c\u5176\u5b83TCP/IP\u8bbe\u5b9a\uff0c\u901a\u8fc7\u5e7f\u64ad\u65b9\u5f0f\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\u4e00\u4e2aDHCP OFFER\u6570\u636e\u5305\uff08\u5305\u4e2d\u5305\u542bIP\u5730\u5740\u3001\u5b50\u7f51\u63a9\u7801\u3001\u5730\u5740\u79df\u671f\u7b49\u4fe1\u606f\uff09\u3002</p> <p>\u6e90IP\u5730\u5740\u4e3aDHCP Server\u7684IP\u5730\u5740\uff0c\u76ee\u6807\u5730\u5740\u4e3a255.255.255.255\u3002\u540c\u65f6\uff0cDHCP Server\u4e3a\u6b64\u5ba2\u6237\u4fdd\u7559\u5b83\u63d0\u4f9b\u7684IP\u5730\u5740\uff0c\u4ece\u800c\u4e0d\u4f1a\u4e3a\u5176\u4ed6DHCP\u5ba2\u6237\u5206\u914d\u6b64IP\u5730\u5740\u3002</p> <p>3\u3001\u63a5\u53d7IP\u79df\u7ea6</p> <p>\u5ba2\u6237\u673a\u6311\u9009\u6700\u5148\u54cd\u5e94\u7684DHCP OFFER\uff08\u4e00\u822c\u662f\u6700\u5148\u5230\u8fbe\u7684\u90a3\u4e2a\uff09\uff0c\u540c\u65f6\u5411\u7f51\u7edc\u5e7f\u64adDHCP REQUEST\u6570\u636e\u5305\uff08\u5305\u4e2d\u5305\u542b\u5ba2\u6237\u7aef\u7684MAC\u5730\u5740\u3001\u63a5\u53d7\u7684\u79df\u7ea6\u4e2d\u7684IP\u5730\u5740\u3001\u63d0\u4f9b\u6b64\u79df\u7ea6\u7684DHCP\u670d\u52a1\u5668\u5730\u5740\u7b49\uff09\uff0c\u58f0\u660e\u5c06\u63a5\u53d7\u67d0\u4e00\u53f0\u670d\u52a1\u5668\u63d0\u4f9b\u7684IP\u5730\u5740\u3002\u6b64\u65f6\uff0c\u7531\u4e8e\u8fd8\u6ca1\u6709\u5f97\u5230DHCP Server\u7684\u6700\u540e\u786e\u8ba4\uff0c\u5ba2\u6237\u7aef\u4ecd\u7136\u4f7f\u75280.0.0.0\u4e3a\u6e90IP\u5730\u5740\uff0c255.255.255.255\u4e3a\u76ee\u6807\u5730\u5740\u8fdb\u884c\u5e7f\u64ad\u3002</p> <p>4\u3001\u79df\u7ea6\u786e\u8ba4</p> <p>\u670d\u52a1\u7aef\u63a5\u6536\u5230\u5ba2\u6237\u7aef\u7684DHCP REQUEST\u4e4b\u540e\uff0c\u4f1a\u5e7f\u64ad\u8fd4\u56de\u7ed9\u5ba2\u6237\u673a\u4e00\u4e2aDHCP ACK\u6d88\u606f\u5305\uff0c\u8868\u660e\u5df2\u7ecf\u63a5\u53d7\u5ba2\u6237\u673a\u7684\u9009\u62e9\uff0c\u5e76\u5c06\u8fd9\u4e00IP\u5730\u5740\u7684\u5408\u6cd5\u79df\u7528\u4ee5\u53ca\u5176\u4ed6\u7684\u914d\u7f6e\u4fe1\u606f\u90fd\u653e\u5165\u8be5\u5e7f\u64ad\u5305\u53d1\u7ed9\u5ba2\u6237\u673a\u3002</p> <p>\u5ba2\u6237\u673a\u5728\u63a5\u6536\u5230DHCP ACK\u5e7f\u64ad\u540e\uff0c\u4f1a\u5411\u7f51\u7edc\u53d1\u9001\u4e09\u4e2a\u9488\u5bf9\u6b64IP\u5730\u5740\u7684ARP\u89e3\u6790\u8bf7\u6c42\u4ee5\u6267\u884c\u51b2\u7a81\u68c0\u6d4b\uff0c\u67e5\u8be2\u7f51\u7edc\u4e0a\u6709\u6ca1\u6709\u5176\u5b83\u673a\u5668\u4f7f\u7528\u8be5IP\u5730\u5740\uff1b\u5982\u679c\u53d1\u73b0\u8be5IP\u5730\u5740\u5df2\u7ecf\u88ab\u4f7f\u7528\uff0c\u5ba2\u6237\u673a\u4f1a\u53d1\u51fa\u4e00\u4e2aDHCP DECLINE\u6570\u636e\u5305\u7ed9DHCP Server\uff0c\u62d2\u7edd\u6b64IP\u5730\u5740\u79df\u7ea6\uff0c\u5e76\u91cd\u65b0\u53d1\u9001DHCP discover\u4fe1\u606f\u3002\u6b64\u65f6\uff0c\u5728DHCP\u670d\u52a1\u5668\u7ba1\u7406\u63a7\u5236\u53f0\u4e2d\uff0c\u4f1a\u663e\u793a\u6b64IP\u5730\u5740\u4e3aBAD_ADDRESS\u3002</p> <p>\u5982\u679c\u7f51\u7edc\u4e0a\u6ca1\u6709\u5176\u5b83\u4e3b\u673a\u4f7f\u7528\u6b64IP\u5730\u5740\uff0c\u5219\u5ba2\u6237\u673a\u7684TCP/IP\u4f7f\u7528\u79df\u7ea6\u4e2d\u63d0\u4f9b\u7684IP\u5730\u5740\u5b8c\u6210\u521d\u59cb\u5316\uff0c\u4ece\u800c\u53ef\u4ee5\u548c\u5176\u4ed6\u7f51\u7edc\u4e2d\u7684\u4e3b\u673a\u8fdb\u884c\u901a\u8baf\u3002</p>"},{"location":"chap4/2Linux_SVC/#1-5-dns","title":"1-5 \u7b80\u8ff0DNS\u67e5\u8be2\u53ef\u80fd\u9700\u8981\u54ea\u4e9b\u8fc7\u7a0b\uff1f","text":"<p>\u901a\u5e38DNS\u67e5\u8be2\u6709\u5982\u4e0b\u8fc7\u7a0b\uff0c\u4efb\u4f55\u4e00\u8fc7\u7a0b\u67e5\u8be2\u6210\u529f\u5219\u8fd4\u56de\u67e5\u8be2\u7ed3\u679c\uff0c\u4e0d\u518d\u8fdb\u884c\u4e0b\u4e00\u6b65\u67e5\u8be2\uff1a</p> <ul> <li>1\u3001\u7528\u6237\u8f93\u5165\u7f51\u5740\uff0c\u4f18\u5148\u8c03\u53d6\u672c\u5730hosts\u67e5\u8be2\u8bb0\u5f55\uff1b</li> <li>2\u3001\u4f7f\u7528\u672c\u5730dns\u7f13\u5b58\u67e5\u8be2\u8bb0\u5f55\uff1b</li> <li>3\u3001\u4f7f\u7528\u7f51\u7edc\u8bbe\u7f6e\u7684\u4e3bdns\u67e5\u8be2\u8bb0\u5f55\uff1b</li> <li>4\u3001\u4f7f\u7528dns\u670d\u52a1\u5668\u4e2d\u7684\u7f13\u5b58\uff1b</li> <li>5\u3001dns\u670d\u52a1\u5668\u8f6c\u53d1\u67e5\u8be2\uff0c\u8f6c\u53d1\u81f3\u4e0a\u4e00\u7ea7ISP DNS\u670d\u52a1\u5668\uff0c\u4f9d\u6b21\u5faa\u73af\uff1b</li> <li>6\u3001\u82e5dns\u670d\u52a1\u5668\u672a\u914d\u7f6e\u8f6c\u53d1\u67e5\u8be2\uff0c\u5219\u5c06\u67e5\u8be2\u9700\u6c42\u53d1\u81f313\u53f0\u6839dns\uff1b</li> <li>7\u3001\u8fd4\u56de\u67e5\u8be2IP\u7ed3\u679c\u7ed9\u5ba2\u6237\u7aef\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#1-6-dns","title":"1-6 \u7b80\u8ff0DNS\u5e38\u89c1\u7684\u670d\u52a1\u5668\u89d2\u8272\u7c7b\u578b\uff1f","text":"<ul> <li>\u7f13\u51b2\u57df\u540d\u670d\u52a1\u5668</li> <li>\u4e3b\u57df\u540d\u670d\u52a1\u5668</li> <li>\u4ece\u57df\u540d\u670d\u52a1\u5668</li> </ul>"},{"location":"chap4/2Linux_SVC/#1-7-nfs","title":"1-7 \u7b80\u8ff0NFS\u6587\u4ef6\u7cfb\u7edf\u53ca\u5176\u4f5c\u7528\uff1f","text":"<p>\u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf\u662f\u5e94\u7528\u5c42\u7684\u4e00\u79cd\u5e94\u7528\u670d\u52a1\uff0c\u5b83\u4e3b\u8981\u5e94\u7528\u4e8eLinux\u548cLinux\u7cfb\u7edf\u3001Linux\u548cUnix\u7cfb\u7edf\u4e4b\u95f4\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u5171\u4eab\u3002\u5bf9\u4e8e\u7528\u6237\u800c\u8a00\u53ef\u4ee5\u901a\u8fc7NFS\u65b9\u4fbf\u7684\u8bbf\u95ee\u8fdc\u5730\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f7f\u4e4b\u6210\u4e3a\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u7684\u4e00\u90e8\u5206\u3002\u91c7\u7528NFS\u4e4b\u540e\u7701\u53bb\u4e86\u767b\u5f55\u7684\u8fc7\u7a0b\uff0c\u65b9\u4fbf\u4e86\u7528\u6237\u8bbf\u95ee\u7cfb\u7edf\u8d44\u6e90\u3002</p>"},{"location":"chap4/2Linux_SVC/#1-8-samba","title":"1-8 \u7b80\u8ff0Samba\u4f5c\u7528\u53ca\u5176\u4f7f\u7528\u573a\u666f\uff1f","text":"<p>Samba\u662f\u5728Linux\u4e0a\u5b9e\u73b0SMB\u534f\u8bae\u7684\u4e00\u4e2a\u514d\u8d39\u8f6f\u4ef6\uff0c\u7531\u670d\u52a1\u5668\u53ca\u5ba2\u6237\u7aef\u7a0b\u5e8f\u6784\u6210\u3002SMB\uff08Server Messages Block\uff0c\u4fe1\u606f\u670d\u52a1\u5757\uff09\u662f\u4e00\u79cd\u5728\u5c40\u57df\u7f51\u4e0a\u5171\u4eab\u6587\u4ef6\u548c\u6253\u5370\u673a\u7684\u4e00\u79cd\u901a\u4fe1\u534f\u8bae\uff0c\u5b83\u4e3a\u5c40\u57df\u7f51\u5185\u7684\u4e0d\u540c\u8ba1\u7b97\u673a\u4e4b\u95f4\u63d0\u4f9b\u6587\u4ef6\u53ca\u6253\u5370\u673a\u7b49\u8d44\u6e90\u7684\u5171\u4eab\u670d\u52a1\u3002SMB\u534f\u8bae\u662f\u5ba2\u6237\u673a/\u670d\u52a1\u5668\u578b\u534f\u8bae\uff0c\u5ba2\u6237\u673a\u901a\u8fc7\u8be5\u534f\u8bae\u53ef\u4ee5\u8bbf\u95ee\u670d\u52a1\u5668\u4e0a\u7684\u5171\u4eab\u6587\u4ef6\u7cfb\u7edf\u3001\u6253\u5370\u673a\u53ca\u5176\u4ed6\u8d44\u6e90\u3002\u4e3b\u8981\u7528\u4e8ewindows\u4e0eLinux\u4e4b\u95f4\u7684\u6587\u4ef6\u5171\u4eab\u3002</p>"},{"location":"chap4/2Linux_SVC/#1-9-vpn","title":"1-9 \u7b80\u8ff0VPN\u6982\u5ff5\u4ee5\u53ca\u5e38\u89c1\u7684\u7c7b\u578b\uff1f","text":"<p>VPN\u662f\u6307\u5728\u516c\u5171\u7684\u7f51\u7edc\u4e0a\u5efa\u7acb\u4e13\u7528\u7f51\u7edc\u7684\u6280\u672f\uff0c\u4f46\u662f\u4e24\u4e2a\u8282\u70b9\u95f4\u5e76\u6ca1\u6709\u7269\u7406\u4e0a\u7684\u4e13\u7528\u7684\u7aef\u5230\u7aef\u94fe\u8def\uff0c\u800c\u662f\u901a\u8fc7\u5e7f\u57df\u7f51\u6216\u8005\u8fd0\u8425\u5546\u63d0\u4f9b\u7684\u7f51\u7edc\u5e73\u53f0\u4e4b\u4e0a\u7684\u903b\u8f91\u7f51\u7edc\uff0c\u7528\u6237\u6570\u636e\u5728\u903b\u8f91\u94fe\u8def\u4e2d\u4f20\u8f93\uff0c\u540c\u65f6VPN\u91c7\u7528\u8eab\u4efd\u9a8c\u8bc1\u548c\u52a0\u5bc6\u6280\u672f\uff0c\u5145\u5206\u4fdd\u8bc1\u4e86\u5b89\u5168\u6027\u3002\u5e38\u89c1\u7684VPN\u6709\uff1aIPSec VPN\u3001PPTP VPN\u3001L2TP VPN\u3001SSL VPN\u3002</p>"},{"location":"chap4/2Linux_SVC/#1-10-yum","title":"1-10 \u7b80\u8ff0YUM\u670d\u52a1\u5de5\u4f5c\u6b65\u9aa4\uff1f","text":"<p>\u5ba2\u6237\u7aef\u5728\u901a\u8fc7yum\u5b89\u88c5\u8f6f\u4ef6\u65f6\uff0c\u4f1a\u5148\u8bbf\u95eerepo\u4ed3\u5e93\uff0c\u4e0b\u8f7d\u4ed3\u5e93\u7684\u5143\u6570\u636e\uff0c\u6839\u636e\u5143\u6570\u636e\u53bb\u67e5\u8be2\u6240\u9700\u8981\u7684rpm\u53ca\u5176\u5404\u79cd\u4f9d\u8d56\u5173\u7cfb\u3002</p> <p>\u4e4b\u540e\u518d\u5728\u4ed3\u5e93\u8fdb\u884c\u76f8\u5173\u4e0b\u8f7d\uff0c\u5e76\u81ea\u52a8\u89e3\u51b3rpm\u5305\u7684\u4f9d\u8d56\u5173\u7cfb\u3002</p> <p>\u540c\u65f6repo\u4ed3\u5e93\u5e94\u8be5\u662f\u4e00\u4e2a\u6587\u4ef6\u670d\u52a1\u5668\uff0c\u4e00\u822clinux\u4e3b\u673a\u5728\u4e0b\u8f7d\u8fc7\u5143\u6570\u636e\u7684\u540c\u65f6\u4f1a\u5c06\u5176\u4fdd\u7559\u5728\u7f13\u5b58\u4e2d\uff0c\u4ee5\u4fbf\u540e\u7eed\u4f7f\u7528\u3002\u672c\u8d28\u4e0a\u662f\u5c06\u5e95\u5c42\u7684\u7269\u7406\u786c\u76d8\u62bd\u8c61\u7684\u5c01\u88c5\u8d77\u6765\uff0c\u7136\u540e\u4ee5\u903b\u8f91\u5377\u7684\u65b9\u5f0f\u5448\u73b0\u7ed9\u4e0a\u5c42\u5e94\u7528\u3002</p>"},{"location":"chap4/2Linux_SVC/#2","title":"2\u3001\u78c1\u76d8\u7ba1\u7406","text":""},{"location":"chap4/2Linux_SVC/#2-1-lvm","title":"2-1 \u7b80\u8ff0LVM\u6982\u5ff5\u53ca\u5176\u7279\u70b9\uff1f","text":"<p>LVM\u662f\u5bf9\u78c1\u76d8\u5206\u533a\u8fdb\u884c\u7ba1\u7406\u7684\u4e00\u79cd\u673a\u5236\uff0c\u5efa\u7acb\u5728\u786c\u76d8\u548c\u5206\u533a\u4e4b\u4e0a\u7684\u4e00\u4e2a\u903b\u8f91\u5c42\uff0c\u7528\u6765\u63d0\u9ad8\u78c1\u76d8\u7ba1\u7406\u7684\u7075\u6d3b\u6027\u3002\u901a\u8fc7LVM\u53ef\u5c06\u82e5\u5e72\u4e2a\u78c1\u76d8\u5206\u533a\u8fde\u63a5\u4e3a\u4e00\u4e2a\u6574\u5757\u7684\u5377\u7ec4(Volume Group)\uff0c\u5f62\u6210\u4e00\u4e2a\u5b58\u50a8\u6c60\u3002\u53ef\u4ee5\u5728\u5377\u7ec4\u4e0a\u968f\u610f\u521b\u5efa\u903b\u8f91\u5377(Logical Volumes)\uff0c\u5e76\u8fdb\u4e00\u6b65\u5728\u903b\u8f91\u5377\u4e0a\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e0e\u76f4\u63a5\u4f7f\u7528\u7269\u7406\u5b58\u50a8\u5728\u7ba1\u7406\u4e0a\u76f8\u6bd4\uff0c\u63d0\u4f9b\u4e86\u66f4\u597d\u7075\u6d3b\u6027\u3002</p> <p>\u8bbe\u8ba1\u6982\u5ff5</p> <ul> <li>\u7269\u7406\u5b58\u50a8\u4ecb\u8d28\uff08The physical media\uff09\uff1aLVM\u5b58\u50a8\u4ecb\u8d28\u53ef\u4ee5\u662f\u78c1\u76d8\u5206\u533a\u3001\u6574\u4e2a\u78c1\u76d8\u3001RAID\u9635\u5217\u6216SAN\u78c1\u76d8\uff0c\u8bbe\u5907\u5fc5\u987b\u521d\u59cb\u5316\u4e3aLVM\u7269\u7406\u5377\uff0c\u624d\u80fd\u4e0eLVM\u7ed3\u5408\u4f7f\u7528\uff1b</li> <li>\u7269\u7406\u5377PV\uff08physical volume\uff09\uff1a\u7269\u7406\u5377\u5c31\u662fLVM\u7684\u57fa\u672c\u5b58\u50a8\u903b\u8f91\u5757\uff0c\u4f46\u548c\u57fa\u672c\u7684\u7269\u7406\u5b58\u50a8\u4ecb\u8d28\uff08\u5982\u5206\u533a\u3001\u78c1\u76d8\u7b49\uff09\u6bd4\u8f83\uff0c\u5374\u5305\u542b\u6709\u4e0eLVM\u76f8\u5173\u7684\u7ba1\u7406\u53c2\u6570\uff0c\u521b\u5efa\u7269\u7406\u5377\u5b83\u53ef\u4ee5\u7528\u786c\u76d8\u5206\u533a\uff0c\u4e5f\u53ef\u4ee5\u7528\u786c\u76d8\u672c\u8eab\uff1b</li> <li>\u5377\u7ec4VG\uff08Volume Group\uff09\uff1a\u4e00\u4e2aLVM\u5377\u7ec4\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u7269\u7406\u5377\u7ec4\u6210\uff1b</li> <li>\u903b\u8f91\u5377LV\uff08logical volume\uff09\uff1aLV\u5efa\u7acb\u5728VG\u4e4b\u4e0a\uff0c\u53ef\u4ee5\u5728LV\u4e4b\u4e0a\u5efa\u7acb\u6587\u4ef6\u7cfb\u7edf\uff1b</li> <li>PE\uff08physical extents\uff09\uff1aPV\u7269\u7406\u5377\u4e2d\u53ef\u4ee5\u5206\u914d\u7684\u6700\u5c0f\u5b58\u50a8\u5355\u5143\uff0cPE\u7684\u5927\u5c0f\u662f\u53ef\u4ee5\u6307\u5b9a\u7684\uff0c\u9ed8\u8ba4\u4e3a4MB\uff1b</li> <li>LE\uff08logical extent\uff09\uff1aLV\u903b\u8f91\u5377\u4e2d\u53ef\u4ee5\u5206\u914d\u7684\u6700\u5c0f\u5b58\u50a8\u5355\u5143\uff0c\u5728\u540c\u4e00\u4e2a\u5377\u7ec4\u4e2d\uff0cLE\u7684\u5927\u5c0f\u548cPE\u662f\u76f8\u540c\u7684\uff0c\u5e76\u4e14\u4e00\u4e00\u5bf9\u5e94\u3002</li> </ul> <p>\u7279\u70b9</p> <ul> <li>\u5728\u4ece\u5377\u7ec4\u4e2d\u79fb\u9664\u4e00\u4e2a\u78c1\u76d8\u7684\u65f6\u5019\u5fc5\u987b\u4f7f\u7528reducevg\u547d\u4ee4\uff0c\u6709\u4e00\u5b9a\u7684\u9650\u5236\uff1a\u8fd9\u4e2a\u547d\u4ee4\u8981\u6c42root\u6743\u9650\uff0c\u5e76\u4e14\u4e0d\u5141\u8bb8\u5728\u5feb\u7167\u5377\u7ec4\u4e2d\u4f7f\u7528\u3002</li> <li>\u5f53\u5377\u7ec4\u4e2d\u7684\u4e00\u4e2a\u78c1\u76d8\u635f\u574f\u65f6\uff0c\u6574\u4e2a\u5377\u7ec4\u90fd\u4f1a\u53d7\u5230\u5f71\u54cd\u3002</li> <li>\u56e0\u4e3a\u52a0\u5165\u4e86\u989d\u5916\u7684\u64cd\u4f5c\uff0c\u5b58\u50a8\u6027\u80fd\u53d7\u5230\u5f71\u54cd\u3002</li> <li>\u53ef\u4ee5\u5728\u7cfb\u7edf\u8fd0\u884c\u7684\u72b6\u6001\u4e0b\u52a8\u6001\u7684\u6269\u5c55\u6587\u4ef6\u7cfb\u7edf\u7684\u5927\u5c0f\u3002</li> <li>\u6587\u4ef6\u7cfb\u7edf\u53ef\u4ee5\u8de8\u591a\u4e2a\u78c1\u76d8\uff0c\u56e0\u6b64\u6587\u4ef6\u7cfb\u7edf\u5927\u5c0f\u4e0d\u4f1a\u53d7\u7269\u7406\u78c1\u76d8\u7684\u9650\u5236\u3002</li> <li>\u53ef\u4ee5\u589e\u52a0\u65b0\u7684\u78c1\u76d8\u5230LVM\u7684\u5b58\u50a8\u6c60\u4e2d\u3002</li> <li>\u53ef\u4ee5\u4ee5\u955c\u50cf\u7684\u65b9\u5f0f\u5197\u4f59\u91cd\u8981\u7684\u6570\u636e\u5230\u591a\u4e2a\u7269\u7406\u78c1\u76d8\u3002</li> <li>\u53ef\u4ee5\u65b9\u4fbf\u7684\u5bfc\u51fa\u6574\u4e2a\u5377\u7ec4\u5230\u53e6\u5916\u4e00\u53f0\u673a\u5668\u3002</li> <li>\u4f18\u70b9</li> <li>\u7f3a\u70b9</li> </ul>"},{"location":"chap4/2Linux_SVC/#2-2-raid0raid1raid5","title":"2-2 \u7b80\u8ff0RAID0\u3001RAID1\u3001RAID5\u539f\u7406\u53ca\u7279\u70b9\u3001\u4f7f\u7528\u573a\u666f\uff1f","text":"<p>RAID\u901a\u5e38\u53ef\u4ee5\u628a\u786c\u76d8\u6574\u5408\u6210\u4e00\u4e2a\u5927\u78c1\u76d8\uff0c\u7136\u540e\u5728\u5927\u78c1\u76d8\u4e0a\u518d\u5206\u533a\uff0c\u63d0\u9ad8\u6570\u636e\u91cf\u5229\u7528\u7387\u3001\u5197\u4f59\u6027\uff0c\u6839\u636e\u5176\u7279\u70b9\u4e0d\u540c\uff0c\u5e38\u89c1\u7684\u6709RAID0\u3001RADI1\u3001RAID5\u3002</p> <p>RAID 0\uff1a\u6307\u7531\u591a\u4e2a\u76d8\u7ec4\u5408\u6210\u903b\u8f91\u4e0a\u7684\u4e00\u4e2a\u76d8\u3002</p> <ul> <li>\u4f18\u70b9\uff1a\u8bfb\u5199\u5feb\uff0c\u5bb9\u91cf\u5229\u7528\u7387\u6700\u9ad8\u3002</li> <li>\u7f3a\u70b9\uff1a\u6ca1\u6709\u5197\u4f59\uff0c\u4efb\u4f55\u4e00\u5757\u78c1\u76d8\u5931\u6548\u5c06\u5f71\u54cd\u5230\u6240\u6709\u6570\u636e\u3002</li> </ul> <p>RAID 1\uff1a\u5076\u6570\u76d8\uff0c\u8fdb\u884c\u955c\u50cf\u3002</p> <ul> <li>\u4f18\u70b9\uff1a\u6700\u9ad8\u7684\u5197\u4f59\u6027\u3002</li> <li>\u7f3a\u70b9\uff1a\u6d6a\u8d39\u8d44\u6e90\uff0c\u6210\u672c\u9ad8\uff0c\u6570\u636e\u5229\u7528\u7387\u4f4e\u3002</li> </ul> <p>RAID 5\uff1a\u5947\u6570\u76d8\uff0c\u81f3\u5c113\u5757\u78c1\u76d8\u3002\u5206\u5e03\u5f0f\u5947\u5076\u6821\u9a8c\u7684\u72ec\u7acb\u78c1\u76d8\u7ed3\u6784\uff0c\u5b83\u7684\u5947\u5076\u6821\u9a8c\u7801\u5b58\u5728\u4e8e\u6240\u6709\u78c1\u76d8\u4e0a \u4efb\u4f55\u4e00\u4e2a\u786c\u76d8\u635f\u574f\uff0c\u90fd\u53ef\u4ee5\u6839\u636e\u5176\u5b83\u786c\u76d8\u4e0a\u7684\u6821\u9a8c\u4f4d\u6765\u91cd\u5efa\u635f\u574f\u7684\u6570\u636e\u3002</p> <ul> <li>\u4f18\u70b9\uff1a\u5b9e\u73b0\u6570\u636e\u4e00\u5b9a\u7a0b\u5ea6\u7684\u5197\u4f59\uff0c\u540c\u65f6\u4e5f\u63d0\u5347\u6570\u636e\u7684\u8bfb\u5199\u6027\u80fd\u3002</li> <li> <p>\u7f3a\u70b9\uff1a\u6784\u5efa\u6b64\u6a21\u5f0f\u9700\u8981\u4e00\u5b9a\u6570\u91cf\u7684\u78c1\u76d8\u3002</p> </li> <li> <p>\u5197\u4f59\u4ece\u597d\u5230\u574f\uff1aRAID 1 &gt; RAID 10 &gt; RAID 5 &gt; RAID 0</p> </li> <li>\u6027\u80fd\u4ece\u597d\u5230\u574f\uff1aRAID 0 &gt; RAID 10 &gt; RAID 5 &gt; RAID 1</li> <li>\u6210\u672c\u4ece\u4f4e\u5230\u9ad8\uff1aRAID 0 &gt; RAID 5 &gt; RAID 1 &gt; RAID 10</li> </ul>"},{"location":"chap4/2Linux_SVC/#2-3-iscsi","title":"2-3 \u7b80\u8ff0iSCSI\u5b58\u50a8\u53ca\u5176\u4f18\u70b9\uff1f","text":"<p>iSCSI\u662fInternet\u5c0f\u578b\u8ba1\u7b97\u673a\u7cfb\u7edf\u63a5\u53e3\uff0c\u662f\u4e00\u4e2a\u57fa\u4e8eTCP/IP\u7684\u534f\u8bae\uff0c\u7528\u4e8e\u901a\u8fc7IP\u7f51\u7edc\u4eff\u771fSCSI\u9ad8\u6027\u80fd\u672c\u5730\u5b58\u50a8\u603b\u7ebf\uff0c\u4ece\u800c\u4e3a\u8fdc\u7a0b\u5b58\u50a8\u8bbe\u5907\u63d0\u4f9b\u6570\u636e\u4f20\u8f93\u548c\u7ba1\u7406\u3002iSCSI\u8de8\u672c\u5730\u548c\u5e7f\u57df\u7f51\uff0c\u901a\u8fc7\u5206\u5e03\u5f0f\u670d\u52a1\u5668\u548c\u6570\u7ec4\u63d0\u4f9b\u72ec\u7acb\u4e8e\u4f4d\u7f6e\u7684\u6570\u636e\u5b58\u50a8\u68c0\u7d22\u3002</p> <p>iSCSI\u4f18\u70b9\uff1a</p> <ul> <li>\u4f7f\u7528SAN\u6446\u8131\u4e86\u672c\u5730\u5e03\u7ebf\u9650\u5236\uff0c\u4fc3\u8fdb\u4e86\u672c\u5730\u6216\u8fdc\u7a0b\u6570\u636e\u4e2d\u5fc3\u7684\u5b58\u50a8\u6574\u5408\uff1b</li> <li>iSCSI\u7ed3\u6784\u662f\u903b\u8f91\u6027\u7684\uff0c\u4ec5\u4f7f\u7528\u8f6f\u4ef6\u914d\u7f6e\u6765\u8fdb\u884c\u65b0\u7684\u5b58\u50a8\u5206\u914d\uff0c\u65e0\u9700\u5176\u4ed6\u7535\u7f06\u548c\u7269\u7406\u78c1\u76d8\uff1b</li> <li>iSCSI\u4f7f\u7528\u591a\u4e2a\u8fdc\u7a0b\u6570\u636e\u4e2d\u5fc3\u7b80\u5316\u4e86\u6570\u636e\u590d\u5236\u3001\u8fc1\u79fb\u548c\u707e\u96be\u6062\u590d\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#2-4","title":"2-4 \u7b80\u8ff0\u6587\u4ef6\u5b58\u50a8\u3001\u5757\u5b58\u50a8\u3001\u5bf9\u8c61\u5b58\u50a8\uff1f","text":"<ul> <li>\u6587\u4ef6\u5b58\u50a8\uff1a\u5141\u8bb8\u5c06\u6570\u636e\u7ec4\u7ec7\u4e3a\u4f20\u7edf\u7684\u6587\u4ef6\u7cfb\u7edf\u3002\u6570\u636e\u4fdd\u5b58\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u8be5\u6587\u4ef6\u5177\u6709\u540d\u79f0\u548c\u4e00\u4e9b\u76f8\u5173\u7684\u5143\u6570\u636e\uff0c\u4f8b\u5982\u4fee\u6539\u65f6\u95f4\u6233\u3001\u6240\u6709\u8005\u548c\u8bbf\u95ee\u6743\u9650\u3002\u63d0\u4f9b\u57fa\u4e8e\u6587\u4ef6\u7684\u5b58\u50a8\u4f7f\u7528\u76ee\u5f55\u548c\u5b50\u76ee\u5f55\u7684\u5c42\u6b21\u7ed3\u6784\u6765\u7ec4\u7ec7\u6587\u4ef6\u7684\u5b58\u50a8\u65b9\u5f0f\u3002</li> <li>\u5757\u5b58\u50a8\uff1a\u5757\u5b58\u50a8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u50cf\u786c\u76d8\u9a71\u52a8\u5668\u4e00\u6837\u5de5\u4f5c\u7684\u5b58\u50a8\u5377\uff0c\u7ec4\u7ec7\u6210\u5927\u5c0f\u76f8\u540c\u7684\u5757\u3002\u901a\u5e38\uff0c\u8981\u4e48\u64cd\u4f5c\u7cfb\u7edf\u7528\u6587\u4ef6\u7cfb\u7edf\u683c\u5f0f\u5316\u57fa\u4e8e\u5757\u7684\u5b58\u50a8\u5377\uff0c\u8981\u4e48\u5e94\u7528\u7a0b\u5e8f(\u5982\u6570\u636e\u5e93)\u76f4\u63a5\u8bbf\u95ee\u5b83\u6765\u5b58\u50a8\u6570\u636e\u3002</li> <li>\u5bf9\u8c61\u5b58\u50a8\uff1a\u5bf9\u8c61\u5b58\u50a8\u5141\u8bb8\u5c06\u4efb\u610f\u6570\u636e\u548c\u5143\u6570\u636e\u5b58\u50a8\u4e3a\u4e00\u4e2a\u5355\u5143\uff0c\u5e76\u5728\u5e73\u9762\u5b58\u50a8\u6c60\u4e2d\u6807\u8bb0\u4e3a\u60df\u4e00\u6807\u8bc6\u7b26\u3002\u4f7f\u7528API\u5b58\u50a8\u548c\u68c0\u7d22\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5c06\u6570\u636e\u4f5c\u4e3a\u5757\u6216\u5728\u6587\u4ef6\u7cfb\u7edf\u5c42\u6b21\u7ed3\u6784\u4e2d\u8bbf\u95ee\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#3","title":"3\u3001\u865a\u62df\u5e73\u53f0","text":""},{"location":"chap4/2Linux_SVC/#3-1","title":"3-1 \u7b80\u8ff0\u4ec0\u4e48\u662f\u4e91\u8ba1\u7b97\u53ca\u5176\u57fa\u672c\u7279\u5f81\uff1f","text":"<p>\u4e91\u8ba1\u7b97\u662f\u4e00\u79cd\u91c7\u7528\u6309\u91cf\u4ed8\u8d39\u7684\u6a21\u5f0f\uff0c\u57fa\u4e8e\u865a\u62df\u5316\u6280\u672f\uff0c\u5c06\u76f8\u5e94\u8ba1\u7b97\u8d44\u6e90\uff08\u5982\u7f51\u7edc\u3001\u5b58\u50a8\u7b49\uff09\u6c60\u5316\u540e\uff0c\u63d0\u4f9b\u4fbf\u6377\u7684\u3001\u9ad8\u53ef\u7528\u7684\u3001\u9ad8\u6269\u5c55\u6027\u7684\u3001\u6309\u9700\u7684\u670d\u52a1\uff08\u5982\u8ba1\u7b97\u3001\u5b58\u50a8\u3001\u5e94\u7528\u7a0b\u5e8f\u548c\u5176\u4ed6 IT \u8d44\u6e90\uff09\u3002</p> <p>\u4e91\u8ba1\u7b97\u901a\u5e38\u6709\u5982\u4e0b\u57fa\u672c\u7279\u5f81\uff1a</p> <ul> <li>\u81ea\u4e3b\u670d\u52a1\uff1a\u53ef\u6309\u9700\u7684\u83b7\u53d6\u4e91\u7aef\u7684\u76f8\u5e94\u8d44\u6e90\uff08\u4e3b\u8981\u6307\u516c\u6709\u4e91\uff09\uff1b</li> <li>\u7f51\u8def\u8bbf\u95ee\uff1a\u53ef\u968f\u65f6\u968f\u5730\u4f7f\u7528\u4efb\u4f55\u8054\u7f51\u7ec8\u7aef\u8bbe\u5907\u63a5\u5165\u4e91\u7aef\u4ece\u800c\u4f7f\u7528\u76f8\u5e94\u8d44\u6e90\u3002</li> <li>\u8d44\u6e90\u6c60\u5316\uff1a</li> <li>\u5feb\u901f\u5f39\u6027\uff1a\u53ef\u65b9\u4fbf\u3001\u5feb\u6377\u5730\u6309\u9700\u83b7\u53d6\u548c\u91ca\u653e\u8ba1\u7b97\u8d44\u6e90\u3002</li> <li>\u6309\u91cf\u8ba1\u8d39\uff1a</li> </ul>"},{"location":"chap4/2Linux_SVC/#3-2","title":"3-2 \u7b80\u8ff0\u4e91\u8ba1\u7b97\u5e38\u89c1\u90e8\u7f72\u6a21\u5f0f\uff1f","text":"<ul> <li>\u79c1\u6709\u4e91\uff1a\u4e91\u5e73\u53f0\u8d44\u6e90\u53ea\u7ed9\u67d0\u4e2a\u5355\u4f4d\u3001\u6216\u67d0\u90e8\u5206\u7528\u6237\u5185\u90e8\u4f7f\u7528\u3002</li> <li>\u516c\u6709\u4e91\uff1a\u4e91\u5e73\u53f0\u8d44\u6e90\u5f00\u653e\u7ed9\u793e\u4f1a\u516c\u4f17\u670d\u52a1\u3002</li> <li>\u793e\u533a\u4e91\uff1a\u4e91\u5e73\u53f0\u8d44\u6e90\u7ed9\u51e0\u4e2a\u56fa\u5b9a\u7684\u5355\u4f4d\u5185\u4f7f\u7528\u3002</li> <li>\u6df7\u5408\u4e91\uff1a\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u4e0d\u540c\u7c7b\u578b\u7684\u4e91\u5e73\u53f0\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#3-3","title":"3-3 \u7b80\u8ff0\u4e91\u8ba1\u7b97\u4e09\u79cd\u670d\u52a1\u6a21\u5f0f\uff1f","text":"<ul> <li>IaaS\uff1a\u57fa\u7840\u8bbe\u65bd\u5373\u670d\u52a1\uff0c\u4e91\u670d\u52a1\u5546\u5c06IT\u7cfb\u7edf\u7684\u57fa\u7840\u8bbe\u65bd\uff08\u5982\u8ba1\u7b97\u8d44\u6e90\u3001\u5b58\u50a8\u8d44\u6e90\u3001\u7f51\u7edc\u8d44\u6e90\uff09\u6c60\u5316\u540e\u4f5c\u4e3a\u670d\u52a1\u8fdb\u884c\u552e\u5356\uff1b</li> <li>PaaS\uff1a\u5e73\u53f0\u5373\u670d\u52a1\uff0c\u4e91\u670d\u52a1\u5546\u5c06IT\u7cfb\u7edf\u7684\u5e73\u53f0\u8f6f\u4ef6\u5c42\uff08\u6570\u636e\u5e93\u3001OS\u3001\u4e2d\u95f4\u4ef6\u3001\u8fd0\u884c\u5e93\uff09\u4f5c\u4e3a\u670d\u52a1\u8fdb\u884c\u552e\u5356\uff1b</li> <li>SaaS\uff1a\u8f6f\u4ef6\u5373\u670d\u52a1\uff0c\u4e91\u670d\u52a1\u5546\u5c06IT\u7cfb\u7edf\u7684\u5e94\u7528\u8f6f\u4ef6\u5c42\u4f5c\u4e3a\u670d\u52a1\u8fdb\u884c\u552e\u5356\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#3-4","title":"3-4 \u7b80\u8ff0\u4e91\u8ba1\u7b97\u548c\u865a\u62df\u5316\u7684\u533a\u522b\uff1f","text":"<ul> <li>\u4e91\u8ba1\u7b97\uff1aIT\u80fd\u529b\u670d\u52a1\u5316\uff0c\u6309\u9700\u4f7f\u7528\uff0c\u6309\u91cf\u8ba1\u8d39\uff0c\u591a\u79df\u6237\u9694\u79bb\uff0c\u662f\u4e00\u4e2a\u7cfb\u7edf\u7684\u8f7b\u91cf\u7ea7\u7ba1\u7406\u63a7\u5236\u9762\u3002</li> <li>\u865a\u62df\u5316\uff1a\u73af\u5883\u9694\u79bb\uff0c\u8d44\u6e90\u590d\u7528\uff0c\u964d\u4f4e\u9694\u79bb\u635f\u8017\uff0c\u63d0\u5347\u8fd0\u884c\u6027\u80fd\uff0c\u63d0\u4f9b\u9ad8\u7ea7\u865a\u62df\u5316\u7279\u6027\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#3-5","title":"3-5 \u7b80\u8ff0\u79c1\u6709\u4e91\u76f8\u5bf9\u516c\u6709\u4e91\u6709\u54ea\u4e9b\u4f18\u52bf\uff1f","text":"<ul> <li>\u6570\u636e\u5b89\u5168\u6027\u66f4\u9ad8\uff1b</li> <li>\u53ef\u8282\u7701\u4e0a\u4e91\u8fc1\u79fb\u8fc7\u7a0b\u4e2d\u7684\u5927\u91cf\u6210\u672c\uff1b</li> <li>\u4e1a\u52a1\u5feb\u901f\u90e8\u7f72\uff0c\u7f29\u77ed\u4e1a\u52a1\u5468\u671f\uff1b</li> <li>\u964d\u4f4e\u4f01\u4e1a\u6210\u672c\uff0c\u81ea\u4e3b\u53ef\u63a7\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#3-6-kvm","title":"3-6 \u7b80\u8ff0\u4ec0\u4e48\u662fKVM\uff1f","text":"<p>KVM\u6307\u57fa\u4e8e\u5185\u6838\u7684\u865a\u62df\u673a\uff08Kernel-based Virtual Machine\uff09\uff0c\u5b83\u662f\u4e00\u4e2aLinux\u7684\u4e00\u4e2a\u5185\u6838\u6a21\u5757\uff0c\u8be5\u5185\u6838\u6a21\u5757\u4f7f\u5f97Linux\u53d8\u6210\u4e86\u4e00\u4e2a Hypervisor\uff0c\u4ece\u800c\u5b9e\u73b0\u865a\u62df\u5316\uff1a</p> <ul> <li>\u5b83\u7531 Quramnet \u5f00\u53d1\uff0c\u8be5\u516c\u53f8\u4e8e 2008\u5e74\u88ab Red Hat \u6536\u8d2d\u3002</li> <li>\u5b83\u652f\u6301 x86 (32 and 64 \u4f4d)\u3001s390\u3001Powerpc \u7b49 CPU\u3002</li> <li>\u5b83\u4ece Linux 2.6.20 \u8d77\u5c31\u4f5c\u4e3a\u4e00\u6a21\u5757\u88ab\u5305\u542b\u5728 Linux \u5185\u6838\u4e2d\u3002</li> <li>\u5b83\u9700\u8981\u652f\u6301\u865a\u62df\u5316\u6269\u5c55\u7684 CPU\u3002</li> <li>\u5b83\u662f\u5b8c\u5168\u5f00\u6e90\u7684\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#4","title":"4\u3001\u865a\u62df\u5e73\u53f0","text":""},{"location":"chap4/2Linux_SVC/#4-1","title":"4-1 \u7b80\u8ff0\u4ec0\u4e48\u662f\u4e91\u8ba1\u7b97\u53ca\u5176\u57fa\u672c\u7279\u5f81\uff1f","text":"<p>\u4e91\u8ba1\u7b97\u662f\u4e00\u79cd\u91c7\u7528\u6309\u91cf\u4ed8\u8d39\u7684\u6a21\u5f0f\uff0c\u57fa\u4e8e\u865a\u62df\u5316\u6280\u672f\uff0c\u5c06\u76f8\u5e94\u8ba1\u7b97\u8d44\u6e90\uff08\u5982\u7f51\u7edc\u3001\u5b58\u50a8\u7b49\uff09\u6c60\u5316\u540e\uff0c\u63d0\u4f9b\u4fbf\u6377\u7684\u3001\u9ad8\u53ef\u7528\u7684\u3001\u9ad8\u6269\u5c55\u6027\u7684\u3001\u6309\u9700\u7684\u670d\u52a1\uff08\u5982\u8ba1\u7b97\u3001\u5b58\u50a8\u3001\u5e94\u7528\u7a0b\u5e8f\u548c\u5176\u4ed6 IT \u8d44\u6e90\uff09\u3002</p> <p>\u4e91\u8ba1\u7b97\u901a\u5e38\u6709\u5982\u4e0b\u57fa\u672c\u7279\u5f81\uff1a</p> <ul> <li>\u81ea\u4e3b\u670d\u52a1\uff1a\u53ef\u6309\u9700\u7684\u83b7\u53d6\u4e91\u7aef\u7684\u76f8\u5e94\u8d44\u6e90\uff08\u4e3b\u8981\u6307\u516c\u6709\u4e91\uff09\uff1b</li> <li>\u7f51\u8def\u8bbf\u95ee\uff1a\u53ef\u968f\u65f6\u968f\u5730\u4f7f\u7528\u4efb\u4f55\u8054\u7f51\u7ec8\u7aef\u8bbe\u5907\u63a5\u5165\u4e91\u7aef\u4ece\u800c\u4f7f\u7528\u76f8\u5e94\u8d44\u6e90\u3002</li> <li>\u8d44\u6e90\u6c60\u5316\uff1a</li> <li>\u5feb\u901f\u5f39\u6027\uff1a\u53ef\u65b9\u4fbf\u3001\u5feb\u6377\u5730\u6309\u9700\u83b7\u53d6\u548c\u91ca\u653e\u8ba1\u7b97\u8d44\u6e90\u3002</li> <li>\u6309\u91cf\u8ba1\u8d39\uff1a</li> </ul>"},{"location":"chap4/2Linux_SVC/#4-2","title":"4-2 \u7b80\u8ff0\u4e91\u8ba1\u7b97\u5e38\u89c1\u90e8\u7f72\u6a21\u5f0f\uff1f","text":"<ul> <li>\u79c1\u6709\u4e91\uff1a\u4e91\u5e73\u53f0\u8d44\u6e90\u53ea\u7ed9\u67d0\u4e2a\u5355\u4f4d\u3001\u6216\u67d0\u90e8\u5206\u7528\u6237\u5185\u90e8\u4f7f\u7528\u3002</li> <li>\u516c\u6709\u4e91\uff1a\u4e91\u5e73\u53f0\u8d44\u6e90\u5f00\u653e\u7ed9\u793e\u4f1a\u516c\u4f17\u670d\u52a1\u3002</li> <li>\u793e\u533a\u4e91\uff1a\u4e91\u5e73\u53f0\u8d44\u6e90\u7ed9\u51e0\u4e2a\u56fa\u5b9a\u7684\u5355\u4f4d\u5185\u4f7f\u7528\u3002</li> <li>\u6df7\u5408\u4e91\uff1a\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u4e0d\u540c\u7c7b\u578b\u7684\u4e91\u5e73\u53f0\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#4-3","title":"4-3 \u7b80\u8ff0\u4e91\u8ba1\u7b97\u4e09\u79cd\u670d\u52a1\u6a21\u5f0f\uff1f","text":"<ul> <li>IaaS\uff1a\u57fa\u7840\u8bbe\u65bd\u5373\u670d\u52a1\uff0c\u4e91\u670d\u52a1\u5546\u5c06IT\u7cfb\u7edf\u7684\u57fa\u7840\u8bbe\u65bd\uff08\u5982\u8ba1\u7b97\u8d44\u6e90\u3001\u5b58\u50a8\u8d44\u6e90\u3001\u7f51\u7edc\u8d44\u6e90\uff09\u6c60\u5316\u540e\u4f5c\u4e3a\u670d\u52a1\u8fdb\u884c\u552e\u5356\uff1b</li> <li>PaaS\uff1a\u5e73\u53f0\u5373\u670d\u52a1\uff0c\u4e91\u670d\u52a1\u5546\u5c06IT\u7cfb\u7edf\u7684\u5e73\u53f0\u8f6f\u4ef6\u5c42\uff08\u6570\u636e\u5e93\u3001OS\u3001\u4e2d\u95f4\u4ef6\u3001\u8fd0\u884c\u5e93\uff09\u4f5c\u4e3a\u670d\u52a1\u8fdb\u884c\u552e\u5356\uff1b</li> <li>SaaS\uff1a\u8f6f\u4ef6\u5373\u670d\u52a1\uff0c\u4e91\u670d\u52a1\u5546\u5c06IT\u7cfb\u7edf\u7684\u5e94\u7528\u8f6f\u4ef6\u5c42\u4f5c\u4e3a\u670d\u52a1\u8fdb\u884c\u552e\u5356\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#4-4","title":"4-4 \u7b80\u8ff0\u4e91\u8ba1\u7b97\u548c\u865a\u62df\u5316\u7684\u533a\u522b\uff1f","text":"<ul> <li>\u4e91\u8ba1\u7b97\uff1aIT\u80fd\u529b\u670d\u52a1\u5316\uff0c\u6309\u9700\u4f7f\u7528\uff0c\u6309\u91cf\u8ba1\u8d39\uff0c\u591a\u79df\u6237\u9694\u79bb\uff0c\u662f\u4e00\u4e2a\u7cfb\u7edf\u7684\u8f7b\u91cf\u7ea7\u7ba1\u7406\u63a7\u5236\u9762\u3002</li> <li>\u865a\u62df\u5316\uff1a\u73af\u5883\u9694\u79bb\uff0c\u8d44\u6e90\u590d\u7528\uff0c\u964d\u4f4e\u9694\u79bb\u635f\u8017\uff0c\u63d0\u5347\u8fd0\u884c\u6027\u80fd\uff0c\u63d0\u4f9b\u9ad8\u7ea7\u865a\u62df\u5316\u7279\u6027\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#4-5","title":"4-5 \u7b80\u8ff0\u79c1\u6709\u4e91\u76f8\u5bf9\u516c\u6709\u4e91\u6709\u54ea\u4e9b\u4f18\u52bf\uff1f","text":"<ul> <li>\u6570\u636e\u5b89\u5168\u6027\u66f4\u9ad8\uff1b</li> <li>\u53ef\u8282\u7701\u4e0a\u4e91\u8fc1\u79fb\u8fc7\u7a0b\u4e2d\u7684\u5927\u91cf\u6210\u672c\uff1b</li> <li>\u4e1a\u52a1\u5feb\u901f\u90e8\u7f72\uff0c\u7f29\u77ed\u4e1a\u52a1\u5468\u671f\uff1b</li> <li>\u964d\u4f4e\u4f01\u4e1a\u6210\u672c\uff0c\u81ea\u4e3b\u53ef\u63a7\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#4-6-kvm","title":"4-6 \u7b80\u8ff0\u4ec0\u4e48\u662fKVM\uff1f","text":"<p>KVM\u6307\u57fa\u4e8e\u5185\u6838\u7684\u865a\u62df\u673a\uff08Kernel-based Virtual Machine\uff09\uff0c\u5b83\u662f\u4e00\u4e2aLinux\u7684\u4e00\u4e2a\u5185\u6838\u6a21\u5757\uff0c\u8be5\u5185\u6838\u6a21\u5757\u4f7f\u5f97Linux\u53d8\u6210\u4e86\u4e00\u4e2a Hypervisor\uff0c\u4ece\u800c\u5b9e\u73b0\u865a\u62df\u5316\uff1a</p> <ul> <li>\u5b83\u7531 Quramnet \u5f00\u53d1\uff0c\u8be5\u516c\u53f8\u4e8e 2008\u5e74\u88ab Red Hat \u6536\u8d2d\u3002</li> <li>\u5b83\u652f\u6301 x86 (32 and 64 \u4f4d)\u3001s390\u3001Powerpc \u7b49 CPU\u3002</li> <li>\u5b83\u4ece Linux 2.6.20 \u8d77\u5c31\u4f5c\u4e3a\u4e00\u6a21\u5757\u88ab\u5305\u542b\u5728 Linux \u5185\u6838\u4e2d\u3002</li> <li>\u5b83\u9700\u8981\u652f\u6301\u865a\u62df\u5316\u6269\u5c55\u7684 CPU\u3002</li> <li>\u5b83\u662f\u5b8c\u5168\u5f00\u6e90\u7684\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#5","title":"5\u3001\u7cfb\u7edf\u7ba1\u7406","text":""},{"location":"chap4/2Linux_SVC/#5-1-rsync","title":"5-1 \u7b80\u8ff0Rsync\u53ca\u5176\u7279\u70b9\uff1f","text":"<p>Rsync\u662fLinux\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u955c\u50cf\u5907\u4efd\u5de5\u5177\uff0c\u901a\u8fc7rsync\u53ef\u4ee5\u5c06\u672c\u5730\u7cfb\u7edf\u6570\u636e\u901a\u8fc7\u7f51\u7edc\u5907\u4efd\u5230\u4efb\u4f55\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u3002</p> <p>rysnc\u4e0d\u4ec5\u4ec5\u80fd\u5bf9\u4e0d\u540c\u4f4d\u7f6e\u7684\u6587\u4ef6\u548c\u76ee\u5f55\u8fdb\u884c\u540c\u6b65\uff0c\u8fd8\u53ef\u4ee5\u5dee\u5f02\u8ba1\u7b97\uff0c\u538b\u7f29\u4f20\u8f93\u6587\u4ef6\u6765\u6700\u5c0f\u5316\u6570\u636e\u4f20\u8f93\uff0c\u548ccp\u547d\u4ee4\u76f8\u6bd4\uff0crysnc\u7684\u4f18\u52bf\u5728\u4e8e\u9ad8\u6548\u7684\u5dee\u5f02\u7b97\u6cd5\u3002\u5e76\u4e14\uff0crysnc\u8fd8\u652f\u6301\u7f51\u7edc\u6570\u636e\u4f20\u8f93\uff0c\u5728\u590d\u5236\u6587\u4ef6\u7684\u540c\u65f6\uff0c\u4f1a\u628a\u6e90\u7aef\u4e0e\u76ee\u7684\u7aef\u7684\u6587\u4ef6\u8fdb\u884c\u6bd4\u8f83\uff0c\u53ea\u6709\u5f53\u6587\u4ef6\u4e0d\u4e00\u6837\u7684\u65f6\u5019\u5728\u8fdb\u884c\u590d\u5236\u3002\u5177\u6709\u4ee5\u4e0b\u7279\u6027\uff1a</p> <ul> <li>\u53ef\u4ee5\u955c\u50cf\u4fdd\u5b58\u6574\u4e2a\u76ee\u5f55\u6811\u548c\u6587\u4ef6\u7cfb\u7edf\u3002</li> <li>\u53ef\u4ee5\u540c\u6b65\u589e\u91cf\u6570\u636e\uff0c\u6587\u4ef6\u4f20\u8f93\u6548\u7387\u9ad8\uff0c\u540c\u6b65\u65f6\u95f4\u77ed\u3002</li> <li>\u53ef\u4ee5\u4fdd\u7559\u539f\u6709\u6587\u4ef6\u7684\u6743\u9650\u3001\u65f6\u95f4\u7b49\u5c5e\u6027\u3002</li> <li>\u52a0\u5bc6\u4f20\u8f93\u6570\u636e\uff0c\u4fdd\u8bc1\u4e86\u6570\u636e\u7684\u5b89\u5168\u6027\u3002</li> </ul>"},{"location":"chap4/2Linux_SVC/#5-2-iptables","title":"5-2 \u7b80\u8ff0iptables\u89c4\u5219\u5de5\u4f5c\u8fc7\u7a0b\uff1f","text":"<p>iptables\u9632\u706b\u5899\u662f\u4e00\u5c42\u5c42\u8fc7\u6ee4\u7684\uff0c\u5b9e\u9645\u662f\u6309\u7167\u914d\u7f6e\u89c4\u5219\u7684\u987a\u5e8f\u4ece\u4e0a\u5230\u4e0b\uff0c\u4ece\u524d\u5230\u540e\u8fdb\u884c\u8fc7\u6ee4\u7684\u3002</p> <p>\u5982\u679c\u5339\u914d\u4e0a\u4e86\u89c4\u5219\uff0c\u5373\u660e\u786e\u8868\u660e\u662f\u963b\u6b62\u8fd8\u662f\u901a\u8fc7\uff0c\u6b64\u65f6\u6570\u636e\u5305\u5c31\u4e0d\u80fd\u5411\u4e0b\u5339\u914d\u65b0\u89c4\u5219\u4e86\u3002</p> <p>\u5982\u679c\u6240\u6709\u89c4\u5219\u4e2d\u6ca1\u6709\u660e\u786e\u8868\u660e\u662f\u963b\u6b62\u8fd8\u662f\u901a\u8fc7\u8fd9\u4e2a\u6570\u636e\u5305\uff0c\u4e5f\u5c31\u662f\u6ca1\u6709\u5339\u914d\u4e0a\u89c4\u5219\uff0c\u5411\u4e0b\u8fdb\u884c\u5339\u914d\uff0c\u76f4\u5230\u5339\u914d\u9ed8\u8ba4\u89c4\u5219\u5f97\u5230\u660e\u786e\u7684\u963b\u6b62\u8fd8\u662f\u901a\u8fc7\u3002</p> <p>\u9632\u706b\u5899\u7684\u9ed8\u8ba4\u89c4\u5219\u662f\u5bf9\u5e94\u94fe\u7684\u6240\u6709\u7684\u89c4\u5219\u6267\u884c\u5b8c\u624d\u4f1a\u6267\u884c\u7684\uff0c\u5373\u6700\u540e\u6267\u884c\u7684\u89c4\u5219\u3002</p>"},{"location":"chap4/2Linux_SVC/#5-3-iptables","title":"5-3 \u7b80\u8ff0iptables\u6709\u51e0\u4e2a\u94fe\u3001\u8868\u53ca\u6bcf\u4e2a\u8868\u7684\u4f5c\u7528\uff1f","text":"<p>iptables\u67095\u4e2a\u94fe\uff1aPREROUTING\u3001INPUT\u3001FORWARD\u3001OUTPUT\u3001POSTROUTING\u3002</p> <p>iptables\u67094\u4e2a\u8868\uff1aFilter\u3001NAT\u3001Mangle\u3001RAW\u3002</p> <ul> <li>Filter\uff1a\u4e3b\u8981\u548c\u4e3b\u673a\u81ea\u8eab\u6709\u5173\uff0c\u771f\u6b63\u8d1f\u8d23\u4e3b\u673a\u9632\u706b\u5899\u529f\u80fd\uff08\u8fc7\u6ee4\u6d41\u5165\u6d41\u51fa\u4e3b\u673a\u7684\u6570\u636e\u5305\uff09\u3002filter\u8868\u662fiptables\u9ed8\u8ba4\u4f7f\u7528\u7684\u8868\u3002filter\u5b9a\u4e49\u4e86\u4e09\u4e2a\u94fe\uff08chains\uff09\uff1a<ul> <li>INPUT\uff1a\u8d1f\u8d23\u8fc7\u6ee4\u6240\u6709\u76ee\u6807\u5730\u5740\u662f\u672c\u673a\u5730\u5740\u7684\u6570\u636e\u5305\uff0c\u901a\u4fd7\u7684\u8bb2\uff0c\u5c31\u662f\u8fc7\u6ee4\u8fdb\u5165\u4e3b\u673a\u7684\u6570\u636e\u5305</li> <li>FORWARD\uff1a\u8d1f\u8d23\u8f6c\u53d1\u6d41\u7ecf\u4e3b\u673a\u7684\u6570\u636e\u5305\u3002\u8d77\u8f6c\u53d1\u7684\u4f5c\u7528\uff0c\u548cnat\u5173\u7cfb\u5f88\u5927\uff0c</li> <li>OUTPUT\uff1a\u5904\u7406\u6240\u6709\u6e90\u5730\u5740\u662f\u672c\u673a\u5730\u5740\u7684\u6570\u636e\u5305\uff0c\u901a\u4fd7\u7684\u8bb2\uff0c\u5c31\u662f\u5904\u7406\u4ece\u4e3b\u673a\u53d1\u51fa\u53bb\u7684\u6570\u636e\u5305</li> </ul> </li> </ul> <p>\u5bf9\u4e8efilter\u8868\u7684\u63a7\u5236\u662f\u5b9e\u73b0\u672c\u673a\u9632\u706b\u5899\u529f\u80fd\u7684\u91cd\u8981\u624b\u6bb5\uff0c\u7279\u522b\u662f\u5bf9INPUT\u94fe\u7684\u63a7\u5236\u3002</p> <ul> <li> <p>nat\uff1a\u8d1f\u8d23\u7f51\u7edc\u5730\u5740\u8f6c\u6362\uff0c\u5373\u6765\u6e90\u4e0e\u76ee\u7684ip\u5730\u5740\u7684port\u7684\u8f6c\u6362\uff0c\u4e00\u822c\u7528\u4e8e\u5c40\u57df\u7f51\u5171\u4eab\u4e0a\u7f51\u6216\u7279\u6b8a\u7684\u7aef\u53e3\u8f6c\u6362\u670d\u52a1\u76f8\u5173\uff0cnat\u529f\u80fd\u5c31\u76f8\u5f53\u4e8e\u7f51\u7edc\u7684acl\u63a7\u5236\u3002</p> </li> <li> <p>nat\u5b9a\u4e49\u4e86\u4e09\u4e2a\u94fe\uff08chains\uff09\uff1a</p> <ul> <li>OUTPUT\uff1a\u548c\u4e3b\u673a\u53d1\u51fa\u53bb\u7684\u6570\u636e\u5305\u6709\u5173\uff0c\u6539\u53d8\u4e3b\u673a\u53d1\u51fa\u6570\u636e\u5305\u7684\u76ee\u6807\u5730\u5740\u3002</li> <li>PREROUTING\uff1a\u5728\u6570\u636e\u5305\u5230\u8fbe\u9632\u706b\u5899\u65f6\u8fdb\u884c\u8def\u7531\u5224\u65ad\u4e4b\u524d\u6267\u884c\u7684\u89c4\u5219\u3002\u4f5c\u7528\u65f6\u6539\u53d8\u6570\u636e\u5305\u7684\u76ee\u7684\u5730\u5740\uff0c\u76ee\u7684\u7aef\u53e3\u7b49\u3002</li> <li>POSTROUTING\uff1a\u5728\u6570\u636e\u5305\u79bb\u5f00\u9632\u706b\u5899\u65f6\u8fdb\u884c\u8def\u7531\u5224\u65ad\u4e4b\u540e\u6267\u884c\u7684\u89c4\u5219\uff0c\u4f5c\u7528\u6539\u53d8\u6570\u636e\u5305\u7684\u6e90\u5730\u5740\uff0c\u6e90\u7aef\u53e3\u7b49\u3002</li> </ul> </li> </ul> <p>RAW\uff1aRAW\u8868\u53ea\u4f7f\u7528\u5728PREROUTING\u94fe\u548cOUTPUT\u94fe\u4e0a\uff0c\u56e0\u4e3a\u4f18\u5148\u7ea7\u6700\u9ad8\uff0c\u4ece\u800c\u53ef\u4ee5\u5bf9\u6536\u5230\u7684\u6570\u636e\u5305\u5728\u8fde\u63a5\u8ddf\u8e2a\u524d\u8fdb\u884c\u5904\u7406\u3002\u4e00\u4f46\u7528\u6237\u4f7f\u7528\u4e86RAW\u8868\uff0c\u5728\u67d0\u4e2a\u94fe\u4e0a\uff0cRAW\u8868\u5904\u7406\u5b8c\u540e\uff0c\u5c06\u8df3\u8fc7NAT\u8868\u548c <code>ip_conntrack</code>\u5904\u7406\uff0c\u5373\u4e0d\u518d\u505a\u5730\u5740\u8f6c\u6362\u548c\u6570\u636e\u5305\u7684\u94fe\u63a5\u8ddf\u8e2a\u5904\u7406\u4e86\u3002RAW\u8868\u53ef\u4ee5\u5e94\u7528\u5728\u90a3\u4e9b\u4e0d\u9700\u8981\u505anat\u7684\u60c5\u51b5\u4e0b\uff0c\u4ee5\u63d0\u9ad8\u6027\u80fd\u3002\u5982\u5927\u91cf\u8bbf\u95ee\u7684web\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u8ba980\u7aef\u53e3\u4e0d\u518d\u8ba9iptables\u505a\u6570\u636e\u5305\u7684\u94fe\u63a5\u8ddf\u8e2a\u5904\u7406\uff0c\u4ee5\u63d0\u9ad8\u7528\u6237\u7684\u8bbf\u95ee\u901f\u5ea6\u3002</p> <p>Mangle\uff1a\u5b9e\u73b0\u6d41\u91cf\u6574\u5f62\uff0c\u4e3b\u8981\u7528\u4e8e\u4fee\u6539\u6570\u636e\u5305\u7684ToS( Type of Service \uff0c\u670d\u52a1\u7c7b\u578b\uff09\u3001TTL(Time toLive\uff0c\u751f\u5b58\u5468\u671f\uff09\u4ee5\u53ca\u4e3a\u6570\u636e\u5305\u8bbe\u7f6e Mark \u6807\u8bb0\uff0c\u4ee5\u5b9e\u73b0 QoS(Quality of Service\uff0c\u670d\u52a1\u8d28\u91cf\uff09\u8c03\u6574\u4ee5\u53ca\u7b56\u7565\u8def\u7531\u7b49\u5e94\u7528\u3002</p>"},{"location":"chap4/2Linux_SVC/#5-4-iptables","title":"5-4 \u7b80\u8ff0iptables\u5404\u4e2a\u8868\u7684\u4f18\u5148\u7ea7\uff1f","text":"<p>4\u4e2a\u8868\u7684\u4f18\u5148\u7ea7\u7531\u9ad8\u5230\u4f4e\u7684\u987a\u5e8f\u4e3a\uff1a<code>raw--&gt;mangle--&gt;nat--&gt;filter</code></p>"},{"location":"chap4/2Linux_SVC/#5-5-iptables","title":"5-5 \u7b80\u8ff0iptables\u5904\u7406\u7ecf\u8fc7\u7684\u6570\u636e\u5305\u7684\u6d41\u7a0b\uff1f","text":"<p>iptables\u5229\u7528\u8868\u548c\u94fe\u5904\u7406\u6bcf\u4e2a\u7ecf\u8fc7\u7684\u6570\u636e\u5305\uff0c\u5177\u4f53\u6d41\u7a0b\uff08\u6b65\u9aa4\uff09\u5982\u4e0b\uff1a</p> <ul> <li>1\u3001\u6570\u636e\u5305\u5230\u8fbe\u7f51\u7edc\u63a5\u53e3\uff0c\u6bd4\u5982 eth0\u3002</li> <li>2\u3001\u8fdb\u5165 raw \u8868\u7684 PREROUTING \u94fe\uff0c\u8fd9\u4e2a\u94fe\u7684\u4f5c\u7528\u662f\u5728\u8fde\u63a5\u8ddf\u8e2a\u4e4b\u524d\u5904\u7406\u6570\u636e\u5305\u3002</li> <li>3\u3001\u5982\u679c\u8fdb\u884c\u4e86\u8fde\u63a5\u8ddf\u8e2a\uff0c\u5219\u8fdb\u884c\u5904\u7406\u3002</li> <li>4\u3001\u8fdb\u5165 mangle \u8868\u7684 PREROUTING \u94fe\uff0c\u5728\u6b64\u53ef\u4ee5\u4fee\u6539\u6570\u636e\u5305\uff0c\u6bd4\u5982 TOS \u7b49\u3002</li> <li>5\u3001\u8fdb\u5165 nat \u8868\u7684 PREROUTING \u94fe\uff0c\u53ef\u4ee5\u5728\u6b64\u505aDNAT\uff0c\u4f46\u4e0d\u505a\u8fc7\u6ee4\u3002</li> <li>6\u3001\u51b3\u5b9a\u8def\u7531\uff0c\u770b\u662f\u4ea4\u7ed9\u672c\u5730\u4e3b\u673a\u8fd8\u662f\u8f6c\u53d1\u7ed9\u5176\u5b83\u4e3b\u673a\uff0c\u5373\u51b3\u5b9a\u662f\u5426\u7ee7\u7eed\u5f80\u5185\u8fd8\u662f\u5f80\u5916\u3002</li> </ul> <p>\u5230\u4e86\u8fd9\u91cc\u9700\u8981\u5206\u4e24\u79cd\u4e0d\u540c\u7684\u60c5\u51b5\u8fdb\u884c\u8ba8\u8bba\u4e86\u3002</p> <p>\u82e5\u6570\u636e\u5305\u51b3\u5b9a\u8981\u8f6c\u53d1\u7ed9\u5176\u5b83\u4e3b\u673a\uff0c\u8fd9\u65f6\u5019\u5b83\u4f1a\u4f9d\u6b21\u7ecf\u8fc7\uff1a</p> <ul> <li>1\u3001\u8fdb\u5165 mangle \u8868\u7684 FORWARD \u94fe\uff0c\u8fd9\u91cc\u662f\u5728\u7b2c\u4e00\u6b21\u8def\u7531\uff08\u5373\u6b65\u9aa46\uff09\u51b3\u5b9a\u4e4b\u540e\uff0c\u5728\u8fdb\u884c\u6700\u540e\u7684\u8def\u7531\u51b3\u5b9a\u4e4b\u524d\uff0c\u4ecd\u7136\u53ef\u4ee5\u5bf9\u6570\u636e\u5305\u8fdb\u884c\u67d0\u4e9b\u4fee\u6539\u3002</li> <li>2\u3001\u8fdb\u5165 filter \u8868\u7684 FORWARD \u94fe\uff0c\u8fd9\u91cc\u53ef\u4ee5\u5bf9\u6240\u6709\u8f6c\u53d1\u7684\u6570\u636e\u5305\u8fdb\u884c\u8fc7\u6ee4\u3002</li> <li>3\u3001\u8fdb\u5165 mangle \u8868\u7684 POSTROUTING \u94fe\uff0c\u8fd9\u91cc\u5c06\u5b8c\u6210\u4e86\u6240\u6709\u7684\u8def\u7531\u51b3\u5b9a\uff0c\u4f46\u6570\u636e\u5305\u4ecd\u7136\u5728\u672c\u5730\u4e3b\u673a\uff0c\u8fd8\u53ef\u4ee5\u8fdb\u884c\u67d0\u4e9b\u4fee\u6539\u3002</li> <li>4\u3001\u8fdb\u5165 nat \u8868\u7684 POSTROUTING \u94fe\uff0c\u8fd9\u91cc\u4e00\u822c\u90fd\u662f\u7528\u6765\u505a SNAT \uff0c\u4e0d\u5728\u8fd9\u91cc\u8fdb\u884c\u8fc7\u6ee4\u3002</li> <li> <p>5\u3001\u8fdb\u5165\u51fa\u53bb\u7684\u7f51\u7edc\u63a5\u53e3\uff0c\u7136\u540e\u8fdb\u884c\u53d1\u9001\u3002</p> </li> <li> <p>\u53e6\u4e00\u79cd\u60c5\u51b5\u662f\uff0c\u6570\u636e\u5305\u5c31\u662f\u53d1\u7ed9\u672c\u5730\u4e3b\u673a\u7684\uff0c\u90a3\u4e48\u5b83\u4f1a\u4f9d\u6b21\u7a7f\u8fc7\uff1a</p> <ul> <li>1\u3001\u8fdb\u5165 mangle \u8868\u7684 INPUT \u94fe\uff0c\u8fd9\u91cc\u662f\u5728\u7b2c\u4e00\u6b21\u8def\u7531\uff08\u5373\u6b65\u9aa46\uff09\u51b3\u5b9a\u4e4b\u540e\uff0c\u5728\u8fdb\u884c\u6700\u540e\u7684\u8def\u7531\u51b3\u5b9a\u4e4b\u524d\uff0c\u4ecd\u7136\u53ef\u4ee5\u5bf9\u6570\u636e\u5305\u8fdb\u884c\u67d0\u4e9b\u4fee\u6539\u3002</li> <li>2\u3001\u8fdb\u5165 filter \u8868\u7684 INPUT \u94fe\uff0c\u8fd9\u91cc\u53ef\u4ee5\u5bf9\u6d41\u5165\u7684\u6240\u6709\u6570\u636e\u5305\u8fdb\u884c\u8fc7\u6ee4\uff0c\u65e0\u8bba\u5b83\u6765\u81ea\u54ea\u4e2a\u7f51\u7edc\u63a5\u53e3\u3002</li> <li>3\u3001\u4ea4\u7ed9\u672c\u5730\u4e3b\u673a\u7684\u5e94\u7528\u7a0b\u5e8f\u8fdb\u884c\u5904\u7406\u3002</li> <li>4\u3001\u5904\u7406\u5b8c\u6bd5\u540e\u8fdb\u884c\u8def\u7531\u51b3\u5b9a\uff0c\u770b\u8be5\u5f80\u90a3\u91cc\u53d1\u51fa\u3002</li> <li>5\u3001\u8fdb\u5165 raw \u8868\u7684 OUTPUT \u94fe\uff0c\u8fd9\u91cc\u662f\u5728\u8fde\u63a5\u8ddf\u8e2a\u5904\u7406\u672c\u5730\u7684\u6570\u636e\u5305\u4e4b\u524d\u3002</li> <li>6\u3001\u8fde\u63a5\u8ddf\u8e2a\u5bf9\u672c\u5730\u7684\u6570\u636e\u5305\u8fdb\u884c\u5904\u7406\u3002</li> <li>7\u3001\u8fdb\u5165 mangle \u8868\u7684 OUTPUT \u94fe\uff0c\u8fd9\u91cc\u53ef\u4ee5\u4fee\u6539\u6570\u636e\u5305\uff0c\u4f46\u4e0d\u505a\u8fc7\u6ee4\u3002</li> <li>8\u3001\u8fdb\u5165 nat \u8868\u7684 OUTPUT \u94fe\uff0c\u53ef\u4ee5\u5bf9\u9632\u706b\u5899\u81ea\u5df1\u53d1\u51fa\u7684\u6570\u636e\u505a NAT \u3002</li> <li>9\u3001\u518d\u6b21\u8fdb\u884c\u8def\u7531\u51b3\u5b9a\u3002</li> <li>10\u3001\u8fdb\u5165 filter \u8868\u7684 OUTPUT \u94fe\uff0c\u53ef\u4ee5\u5bf9\u672c\u5730\u51fa\u53bb\u7684\u6570\u636e\u5305\u8fdb\u884c\u8fc7\u6ee4\u3002</li> <li>11\u3001\u8fdb\u5165 mangle \u8868\u7684 POSTROUTING \u94fe\uff0c\u540c\u4e0a\u4e00\u79cd\u60c5\u51b5\u7684\u7b2c9\u6b65\u3002</li> <li>12\u3001\u8fdb\u5165 nat \u8868\u7684 POSTROUTING \u94fe\uff0c\u540c\u4e0a\u4e00\u79cd\u60c5\u51b5\u7684\u7b2c10\u6b65\u3002</li> <li>13\u3001\u8fdb\u5165\u51fa\u53bb\u7684\u7f51\u7edc\u63a5\u53e3\uff0c\u7136\u540e\u8fdb\u884c\u53d1\u9001\u3002</li> </ul> </li> </ul>"},{"location":"chap4/3Linux_tools/","title":"\u7b2c\u4e09\u8282 IT\u8fd0\u7ef4\u9762\u8bd5\u95ee\u9898\u603b\u7ed3-\u8fd0\u7ef4\u5de5\u5177\u3001\u5f00\u6e90\u5e94\u7528(Ceph\u3001Docker\u3001Apache\u3001Nginx\u7b49)","text":""},{"location":"chap4/3Linux_tools/#1ceph","title":"1\u3001\u5f00\u6e90\u5e94\u7528Ceph","text":""},{"location":"chap4/3Linux_tools/#1-1-ceph","title":"1-1 \u7b80\u8ff0Ceph\u7684\u4f18\u52bf\u53ca\u5176\u7279\u70b9\uff1f","text":"<p>Ceph\u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u7684\u6570\u636e\u5bf9\u8c61\u5b58\u50a8\uff0cCeph\u76f8\u5bf9\u5176\u4ed6\u5b58\u50a8\u7cfb\u7edf\u5177\u6709\u5982\u4e0b\u4f18\u52bf\uff1a</p> <ul> <li>CRUSH\u7b97\u6cd5\uff1aceph\u6452\u5f03\u4e86\u4f20\u7edf\u7684\u96c6\u4e2d\u5f0f\u5b58\u50a8\u5143\u6570\u636e\u5bfb\u5740\u7684\u65b9\u6848\uff0c\u800c\u4f7f\u7528<code>CRUSH</code>\u7b97\u6cd5\u5b8c\u6210\u6570\u636e\u7684\u5bfb\u5740\u64cd\u4f5c\u3002\u80fd\u591f\u5b9e\u73b0\u5404\u7c7b\u8d1f\u8f7d\u7684\u526f\u672c\u653e\u7f6e\u89c4\u5219\uff0c\u4f8b\u5982\u8de8\u673a\u623f\u3001\u673a\u67b6\u611f\u77e5\u7b49\u3002Crush\u7b97\u6cd5\u6709\u76f8\u5f53\u5f3a\u5927\u7684\u6269\u5c55\u6027\uff0c\u7406\u8bba\u4e0a\u652f\u6301\u6570\u5343\u4e2a\u5b58\u50a8\u8282\u70b9\uff0c\u4ece\u800c\u589e\u5f3a\u4e86Ceph\u5f39\u6027\u6269\u5c55\u548c\u9ad8\u53ef\u7528\u6027\u3002</li> <li>\u9ad8\u53ef\u7528\uff1a\u901a\u8fc7CRUSH\u7b97\u6cd5\u6307\u5b9a\u526f\u672c\u7684\u7269\u7406\u5b58\u50a8\u4f4d\u7f6e\u4ee5\u5206\u9694\u6545\u969c\u57df\uff0c\u652f\u6301\u6570\u636e\u5f3a\u4e00\u81f4\u6027\uff0cceph\u53ef\u4ee5\u5fcd\u53d7\u591a\u79cd\u6545\u969c\u573a\u666f\u5e76\u81ea\u52a8\u5c1d\u8bd5\u5e76\u884c\u4fee\u590d\u3002</li> <li>\u9ad8\u6269\u5c55\u6027\uff1aCeph\u672c\u8eab\u5e76\u6ca1\u6709\u4e3b\u63a7\u8282\u70b9\uff0c\u6269\u5c55\u8d77\u6765\u6bd4\u8f83\u5bb9\u6613\uff0c\u5e76\u4e14\u7406\u8bba\u4e0a\uff0c\u5b83\u7684\u6027\u80fd\u4f1a\u968f\u7740\u78c1\u76d8\u6570\u91cf\u7684\u589e\u52a0\u800c\u7ebf\u6027\u589e\u957f\u3002</li> <li>\u7279\u6027\u4e30\u5bcc\uff1aCeph\u652f\u6301\u4e09\u79cd\u8c03\u7528\u63a5\u53e3\uff1a\u5bf9\u8c61\u5b58\u50a8\uff0c\u5757\u5b58\u50a8\uff0c\u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u3002\u4e09\u79cd\u65b9\u5f0f\u53ef\u4ee5\u4e00\u540c\u4f7f\u7528\u3002</li> </ul> <p>Ceph\u4e3b\u8981\u7279\u70b9\u5982\u4e0b\uff1a</p> <ul> <li>\u7edf\u4e00\u5b58\u50a8\uff1b</li> <li>\u65e0\u4efb\u4f55\u5355\u70b9\u6545\u969c\uff1b</li> <li>\u6570\u636e\u591a\u4efd\u5197\u4f59\uff1b</li> <li>\u5b58\u50a8\u5bb9\u91cf\u53ef\u6269\u5c55\uff1b</li> <li>\u81ea\u52a8\u5bb9\u9519\u53ca\u6545\u969c\u81ea\u6108\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#1-2-ceph","title":"1-2 \u7b80\u8ff0Ceph\u5b58\u50a8\u4f53\u7cfb\u67b6\u6784\uff1f","text":"<p>Ceph\u4f53\u7cfb\u67b6\u6784\u4e3b\u8981\u7531RADOS\u548cRADOS GW\u548cRBD\u4ee5\u53caCephFS\u6784\u6210\u3002</p> <ul> <li>RADOS\uff08Reliable, Autonomic Distributed Object Store\uff09\u662fCeph\u7684\u5e95\u5c42\u6838\u5fc3\uff0cRADOS\u672c\u8eab\u4e5f\u662f\u5206\u5e03\u5f0f\u5b58\u50a8\u7cfb\u7edf\uff0cCEPH\u6240\u6709\u7684\u5b58\u50a8\u529f\u80fd\u90fd\u662f\u57fa\u4e8eRADOS\u5b9e\u73b0\u3002</li> </ul> <p>RADOS\u7531\u4e24\u4e2a\u7ec4\u4ef6\u7ec4\u6210\uff1aOSD\u548cMonitor\u3002</p> <ul> <li>OSD\u4e3b\u8981\u63d0\u4f9b\u5b58\u50a8\u8d44\u6e90\uff0c\u6bcf\u4e00\u4e2adisk\u3001SSD\u3001RAID group\u6216\u8005\u4e00\u4e2a\u5206\u533a\u90fd\u53ef\u4ee5\u6210\u4e3a\u4e00\u4e2aOSD\uff0c\u800c\u6bcf\u4e2aOSD\u8fd8\u5c06\u8d1f\u8d23\u5411\u8be5\u5bf9\u8c61\u7684\u590d\u6742\u8282\u70b9\u5206\u53d1\u548c\u6062\u590d\uff1b</li> <li>Monitor\u7ef4\u62a4Ceph\u96c6\u7fa4\u5e76\u76d1\u63a7Ceph\u96c6\u7fa4\u7684\u5168\u5c40\u72b6\u6001\uff0c\u63d0\u4f9b\u4e00\u81f4\u6027\u7684\u51b3\u7b56\u3002</li> </ul> <p>RADOS GW\u548cRBD\uff1aRADOS GateWay\u3001RBD\u5176\u4f5c\u7528\u662f\u5728librados\u5e93\u7684\u57fa\u7840\u4e0a\u63d0\u4f9b\u62bd\u8c61\u5c42\u6b21\u66f4\u9ad8\u3001\u66f4\u4fbf\u4e8e\u5e94\u7528\u6216\u5ba2\u6237\u7aef\u4f7f\u7528\u7684\u4e0a\u5c42\u63a5\u53e3\u3002</p> <p>\u5176\u4e2d\uff0cRADOS GW\u662f\u4e00\u4e2a\u63d0\u4f9b\u4e0eAmazon S3\u548cSwift\u517c\u5bb9\u7684RESTful API\u7684gateway\uff0c\u4ee5\u4f9b\u76f8\u5e94\u7684\u5bf9\u8c61\u5b58\u50a8\u5e94\u7528\u5f00\u53d1\u4f7f\u7528\u3002RBD\u5219\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6807\u51c6\u7684\u5757\u8bbe\u5907\u63a5\u53e3\uff0c\u5e38\u7528\u4e8e\u5728\u865a\u62df\u5316\u7684\u573a\u666f\u4e0b\u4e3a\u865a\u62df\u673a\u521b\u5efavolume\u3002</p> <p>CEPHFS\uff1aCEPHFS\u5219\u63d0\u4f9b\u4e86POSIX\u63a5\u53e3\uff0c\u7528\u6237\u53ef\u76f4\u63a5\u901a\u8fc7\u5ba2\u6237\u7aef\u6302\u8f7d\u4f7f\u7528\u3002</p>"},{"location":"chap4/3Linux_tools/#1-3-ceph-pool","title":"1-3  \u7b80\u8ff0Ceph Pool\u6709\u51e0\u79cd\u7c7b\u578b\uff1f","text":"<p>Ceph\u5b58\u50a8\u6c60Pool\u662fCeph\u5b58\u50a8\u96c6\u7fa4\u7528\u4e8e\u5b58\u50a8\u5bf9\u8c61\u7684\u903b\u8f91\u5206\u533a\u3002\u6c60\u7c7b\u578b\u786e\u5b9a\u6c60\u7528\u4e8e\u786e\u4fdd\u6570\u636e\u6301\u4e45\u6027\u7684\u4fdd\u62a4\u673a\u5236\uff0cCeph\u6709\u4e24\u79cdPool\u7c7b\u578b\uff1a</p> <p>replication\u7c7b\u578b\uff1a\u5728\u96c6\u7fa4\u4e2d\u5206\u5e03\u6bcf\u4e2a\u5bf9\u8c61\u7684\u591a\u4e2a\u526f\u672c\u3002</p> <p>erasure coding\u7c7b\u578b\uff1a\u5c06\u6bcf\u4e2a\u5bf9\u8c61\u5206\u5272\u6210\u5757\uff0c\u5e76\u5c06\u5b83\u4eec\u4e0e\u5176\u4ed6\u64e6\u9664\u7f16\u7801\u5757\u4e00\u8d77\u5206\u53d1\uff0c\u4ee5\u4f7f\u7528\u81ea\u52a8\u7ea0\u9519\u673a\u5236\u4fdd\u62a4\u5bf9\u8c61\u3002</p>"},{"location":"chap4/3Linux_tools/#1-4-ceph-poolpgodds","title":"1-4 \u7b80\u8ff0Ceph Pool\u3001PG\u3001ODDs\u7684\u5173\u7cfb\uff1f","text":"<p>Ceph\u5b58\u50a8\u6c60Pool\u662fCeph\u5b58\u50a8\u96c6\u7fa4\u7528\u4e8e\u5b58\u50a8\u5bf9\u8c61\u7684\u903b\u8f91\u5206\u533a\u3002</p> <p>Pool\u4e2d\u5b58\u5728\u4e00\u5b9a\u7684\u6570\u91cf\u7684PG\uff0cPG\u5c06\u5bf9\u8c61\u5b58\u50a8\u5728\u4e00\u7ec4\u7531CRUSH\u7b97\u6cd5\u786e\u5b9a\u7684osd\u4e2d\u3002</p> <p>Ceph\u4f7f\u7528CRUSH\u7b97\u6cd5\u5c06\u5bf9\u8c61\u5206\u914d\u7ed9\u6c60\u4e2d\u7684\u4e00\u4e2aPG\uff0c\u6839\u636e\u6c60\u7684\u914d\u7f6e\u548cCRUSH\u7b97\u6cd5\uff0cPG\u81ea\u52a8\u6620\u5c04\u5230\u4e00\u7ec4OSDs\u3002</p> <p>\u4e00\u4e2aPG\u91cc\u5305\u542b\u4e00\u5806\u5bf9\u8c61\uff0c\u4e00\u4e2a\u5bf9\u8c61\u53ea\u80fd\u5c5e\u4e8e\u4e00\u4e2aPG\u3002</p>"},{"location":"chap4/3Linux_tools/#1-4-ceph","title":"1-4 \u7b80\u8ff0Ceph\u8282\u70b9\u7684\u89d2\u8272\uff1f","text":"<p>\u6240\u6709Ceph\u5b58\u50a8\u96c6\u7fa4\u7684\u90e8\u7f72\u90fd\u59cb\u4e8e\u90e8\u7f72\u4e00\u4e2a\u4e2aCeph\u8282\u70b9\u3001\u7f51\u7edc\u548cCeph\u5b58\u50a8\u96c6\u7fa4\u3002</p> <p>Ceph\u5b58\u50a8\u96c6\u7fa4\u81f3\u5c11\u9700\u8981\u4e00\u4e2aCeph Monitor\u548c\u4e24\u4e2aOSD\u5b88\u62a4\u8fdb\u7a0b\u3002\u800c\u8fd0\u884cCeph\u6587\u4ef6\u7cfb\u7edf\u5ba2\u6237\u7aef\u65f6\uff0c\u5219\u5fc5\u987b\u8981\u6709\u5143\u6570\u636e\u670d\u52a1\u5668\uff08Metadata Server\uff09\u3002</p> <ul> <li>Ceph OSDs\uff1aCeph OSD\u5b88\u62a4\u8fdb\u7a0b\uff08 Ceph OSD \uff09\u7684\u529f\u80fd\u662f\u5b58\u50a8\u6570\u636e\uff0c\u5904\u7406\u6570\u636e\u7684\u590d\u5236\u3001\u6062\u590d\u3001\u56de\u586b\u3001\u518d\u5747\u8861\uff0c\u5e76\u901a\u8fc7\u68c0\u67e5\u5176\u4ed6OSD\u5b88\u62a4\u8fdb\u7a0b\u7684\u5fc3\u8df3\u6765\u5411Ceph Monitors\u63d0\u4f9b\u4e00\u4e9b\u76d1\u63a7\u4fe1\u606f\u3002\u5f53Ceph\u5b58\u50a8\u96c6\u7fa4\u8bbe\u5b9a\u4e3a\u67092\u4e2a\u526f\u672c\u65f6\uff0c\u81f3\u5c11\u9700\u89812\u4e2aOSD\u5b88\u62a4\u8fdb\u7a0b\uff0c\u96c6\u7fa4\u624d\u80fd\u8fbe\u5230active+clean\u72b6\u6001\uff08Ceph\u9ed8\u8ba4\u67093\u4e2a\u526f\u672c\uff09\u3002</li> <li>Monitors\uff1aCeph Monitor\u7ef4\u62a4\u7740\u5c55\u793a\u96c6\u7fa4\u72b6\u6001\u7684\u5404\u79cd\u56fe\u8868\uff0c\u5305\u62ec\u76d1\u89c6\u5668\u56fe\u3001OSD\u56fe\u3001\u5f52\u7f6e\u7ec4\uff08PG\uff09\u56fe\u3001\u548cCRUSH \u56fe\u3002</li> <li>MDSs\uff1aCeph\u5143\u6570\u636e\u670d\u52a1\u5668\uff08MDS\uff09\u4e3aCeph\u6587\u4ef6\u7cfb\u7edf\u5b58\u50a8\u5143\u6570\u636e\uff08\u4e5f\u5c31\u662f\u8bf4\uff0cCeph\u5757\u8bbe\u5907\u548cCeph \u5bf9\u8c61\u5b58\u50a8\u4e0d\u4f7f\u7528MDS\uff09\u3002\u5143\u6570\u636e\u670d\u52a1\u5668\u4f7f\u5f97POSIX\u6587\u4ef6\u7cfb\u7edf\u7684\u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u5728\u4e0d\u5bf9Ceph\u5b58\u50a8\u96c6\u7fa4\u9020\u6210\u8d1f\u62c5\u7684\u524d\u63d0\u4e0b\uff0c\u6267\u884c\u8bf8\u5982ls\u3001find\u7b49\u57fa\u672c\u547d\u4ee4\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#1-5-ceph","title":"1-5 \u7b80\u8ff0Ceph\u7684\u9002\u5e94\u573a\u666f\uff1f","text":"<p>Ceph\u7684\u5e94\u7528\u573a\u666f\u4e3b\u8981\u7531\u5b83\u7684\u67b6\u6784\u786e\u5b9a\uff0cCeph\u63d0\u4f9b\u5bf9\u8c61\u5b58\u50a8\u3001\u5757\u5b58\u50a8\u548c\u6587\u4ef6\u5b58\u50a8\u3002</p> <ul> <li>LIBRADOS\u5e94\u7528</li> </ul> <p>Librados\u63d0\u4f9b\u4e86\u5e94\u7528\u7a0b\u5e8f\u5bf9RADOS\u7684\u76f4\u63a5\u8bbf\u95ee\uff0c\u76ee\u524dLibrados\u5df2\u7ecf\u63d0\u4f9b\u4e86\u5bf9C\u3001C++\u3001Java\u3001Python\u3001Ruby\u548cPHP\u7684\u652f\u6301\u3002</p> <ul> <li>RADOSGW\u5e94\u7528</li> </ul> <p>\u6b64\u7c7b\u573a\u666f\u57fa\u4e8eLibrados\u4e4b\u4e0a\uff0c\u589e\u52a0\u4e86HTTP\u534f\u8bae\uff0c\u63d0\u4f9bRESTful\u63a5\u53e3\u5e76\u4e14\u517c\u5bb9S3\u3001Swfit\u63a5\u53e3\u3002RADOSGW\u5c06Ceph\u96c6\u7fa4\u4f5c\u4e3a\u5206\u5e03\u5f0f\u5bf9\u8c61\u5b58\u50a8\uff0c\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u3002</p> <ul> <li>RBD\u5e94\u7528</li> </ul> <p>\u6b64\u7c7b\u573a\u666f\u4e5f\u662f\u57fa\u4e8eLibrados\u4e4b\u4e0a\u7684\uff0c\u7ec6\u5206\u4e3a\u4e0b\u9762\u4e24\u79cd\u5e94\u7528\u573a\u666f\u3002</p> <p>\u7b2c\u4e00\u79cd\u5e94\u7528\u573a\u666f\u4e3a\u865a\u62df\u673a\u63d0\u4f9b\u5757\u8bbe\u5907\u3002\u901a\u8fc7Librbd\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u5757\u8bbe\u5907\uff08Container\uff09\uff0c\u7136\u540e\u901a\u8fc7QEMU/KVM\u9644\u52a0\u5230VM\u4e0a\u3002\u901a\u8fc7Container\u548cVM\u7684\u89e3\u8026\uff0c\u4f7f\u5f97\u5757\u8bbe\u5907\u53ef\u4ee5\u88ab\u7ed1\u5b9a\u5230\u4e0d\u540c\u7684VM\u4e0a\u3002</p> <p>\u7b2c\u4e8c\u79cd\u5e94\u7528\u573a\u666f\u4e3a\u4e3b\u673a\u63d0\u4f9b\u5757\u8bbe\u5907\u3002\u8fd9\u79cd\u573a\u666f\u662f\u4f20\u7edf\u610f\u4e49\u4e0a\u7684\u7406\u89e3\u7684\u5757\u5b58\u50a8\u3002</p> <p>\u4ee5\u4e0a\u4e24\u79cd\u65b9\u5f0f\u90fd\u662f\u5c06\u4e00\u4e2a\u865a\u62df\u7684\u5757\u8bbe\u5907\u5206\u7247\u5b58\u50a8\u5728RADOS\u4e2d\uff0c\u90fd\u4f1a\u5229\u7528\u6570\u636e\u6761\u5e26\u5316\u63d0\u9ad8\u6570\u636e\u5e76\u884c\u4f20\u8f93\uff0c\u90fd\u652f\u6301\u5757\u8bbe\u5907\u7684\u5feb\u7167\u3001COW\uff08Copy-On-Write\uff09\u514b\u9686\u3002\u6700\u91cd\u8981\u7684\u662fRBD\u8fd8\u652f\u6301Live migration\u3002</p> <ul> <li>CephFS\uff08Ceph\u6587\u4ef6\u7cfb\u7edf\uff09</li> </ul> <p>\u6b64\u7c7b\u5e94\u7528\u662f\u57fa\u4e8eRADOS\u5b9e\u73b0\u7684PB\u7ea7\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff0c\u5176\u4e2d\u5f15\u5165MDS\uff08Meta Date Server\uff09\uff0c\u5b83\u4e3b\u8981\u4e3a\u517c\u5bb9POSIX\u6587\u4ef6\u7cfb\u7edf\u63d0\u4f9b\u5143\u6570\u636e\uff0c\u6bd4\u5982\u6587\u4ef6\u76ee\u5f55\u548c\u6587\u4ef6\u5143\u6570\u636e\u3002</p>"},{"location":"chap4/3Linux_tools/#2dockers","title":"2\u3001Dockers","text":""},{"location":"chap4/3Linux_tools/#2-1-docker","title":"2-1 \u7b80\u8ff0Docker\u5bb9\u5668\u7684\u51e0\u79cd\u72b6\u6001\uff1f","text":"<p>Docker\u5bb9\u5668\u53ef\u4ee5\u6709\u56db\u79cd\u72b6\u6001\uff1a</p> <ul> <li>\u8fd0\u884c</li> <li>\u5df2\u6682\u505c</li> <li>\u91cd\u65b0\u542f\u52a8</li> <li>\u5df2\u9000\u51fa</li> </ul>"},{"location":"chap4/3Linux_tools/#2-2-dockerfiledockerdocker","title":"2-2 \u7b80\u8ff0Dockerfile\u3001Docker\u955c\u50cf\u548cDocker\u5bb9\u5668\u7684\u533a\u522b\uff1f","text":"<p>Dockerfile \u662f\u8f6f\u4ef6\u7684\u539f\u6750\u6599\uff0cDocker\u955c\u50cf \u662f\u8f6f\u4ef6\u7684\u4ea4\u4ed8\u54c1\uff0c\u800c Docker\u5bb9\u5668 \u5219\u53ef\u4ee5\u8ba4\u4e3a\u662f\u8f6f\u4ef6\u7684\u8fd0\u884c\u6001\u3002</p> <p>\u4ece\u5e94\u7528\u8f6f\u4ef6\u7684\u89d2\u5ea6\u6765\u770b\uff0cDockerfile\u3001Docker \u955c\u50cf\u4e0e Docker \u5bb9\u5668\u5206\u522b\u4ee3\u8868\u8f6f\u4ef6\u7684\u4e09\u4e2a\u4e0d\u540c\u9636\u6bb5\uff0cDockerfile \u9762\u5411\u5f00\u53d1\uff0cDocker \u955c\u50cf\u6210\u4e3a\u4ea4\u4ed8\u6807\u51c6\uff0cDocker \u5bb9\u5668\u5219\u6d89\u53ca\u90e8\u7f72\u4e0e\u8fd0\u7ef4\u3002</p>"},{"location":"chap4/3Linux_tools/#2-3-dockerkvm","title":"2-3 \u7b80\u8ff0Docker\u4e0eKVM\uff08\u865a\u62df\u673a\uff09\u7684\u533a\u522b\uff1f","text":"<ul> <li>\u5bb9\u5668\u90e8\u7f72\u7b80\u5355\uff0c\u865a\u62df\u673a\u90e8\u7f72\u76f8\u5bf9\u590d\u6742\u3002</li> </ul> <p>\u800cdocker\u6784\u5efa\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\uff0c\u5229\u7528\u64cd\u4f5c\u7cfb\u7edf\u7684containerization\u6280\u672f\uff0c\u6240\u4ee5docker\u751a\u81f3\u53ef\u4ee5\u5728\u865a\u62df\u673a\u4e0a\u8fd0\u884c\u3002</p> <ul> <li>\u5bb9\u5668\u79d2\u7ea7\u542f\u52a8\uff0c\u865a\u62df\u673a\u901a\u5e38\u5206\u949f\u7ea7\u542f\u52a8\u3002</li> </ul> <p>\u4f20\u7edf\u7684\u865a\u62df\u5316\u6280\u672f\u5728\u6784\u5efa\u7cfb\u7edf\u7684\u65f6\u5019\u8f83\u4e3a\u590d\u6742\uff0c\u9700\u8981\u5927\u91cf\u7684\u4eba\u529b\uff1b</p> <p>\u800cdocker\u53ef\u4ee5\u901a\u8fc7Dockfile\u6765\u6784\u5efa\u6574\u4e2a\u5bb9\u5668\uff0c\u91cd\u542f\u548c\u6784\u5efa\u901f\u5ea6\u5f88\u5feb\u3002</p> <ul> <li>\u5bb9\u5668\u9700\u8981\u7684\u8d44\u6e90\uff08\u5982\u78c1\u76d8\u3001CPU\u3001\u5185\u5b58\uff09\u76f8\u5bf9\u66f4\u5c11\u3002</li> <li>\u5bb9\u5668\u6bd4\u8f83\u8f7b\u4fbf\uff0c\u865a\u62df\u673a\u76f8\u5bf9\u8f83\u91cd\u3002</li> </ul> <p>\u865a\u62df\u5316\u7cfb\u7edf\u4e00\u822c\u90fd\u662f\u6307\u64cd\u4f5c\u7cfb\u7edf\u7ea7\u6982\u5ff5\uff0c\u6bd4\u8f83\u590d\u6742\uff0c\u79f0\u4e3a\u201c\u7cfb\u7edf\u201d\uff1b</p> <p>\u800cdocker\u5f00\u6e90\u800c\u4e14\u8f7b\u91cf\uff0c\u79f0\u4e3a\u201c\u5bb9\u5668\u201d\uff0c\u5355\u4e2a\u5bb9\u5668\u9002\u5408\u90e8\u7f72\u5c11\u91cf\u5e94\u7528\uff0c\u6bd4\u5982\u90e8\u7f72\u4e00\u4e2aredis\u3001\u4e00\u4e2amemcached\u3002</p>"},{"location":"chap4/3Linux_tools/#2-4-docker","title":"2-4 \u7b80\u8ff0Docker\u4e3b\u8981\u4f7f\u7528\u7684\u6280\u672f\uff1f","text":"<p>\u5bb9\u5668\u4e3b\u8981\u4f7f\u7528\u5982\u4e0b\u6280\u672f\uff1a</p> <ul> <li>Cgroup\uff1a\u8d44\u6e90\u63a7\u5236</li> <li>Namespace\uff1a\u8bbf\u95ee\u9694\u79bb</li> <li>rootfs\uff1a\u6587\u4ef6\u7cfb\u7edf\u9694\u79bb</li> <li>\u5bb9\u5668\u5f15\u64ce\uff08\u7528\u6237\u6001\u5de5\u5177\uff09\uff1a\u751f\u547d\u5468\u671f\u63a7\u5236</li> </ul>"},{"location":"chap4/3Linux_tools/#2-5-docker","title":"2-5 \u7b80\u8ff0Docker\u4f53\u7cfb\u67b6\u6784\uff1f","text":"<p>Docker\u4f53\u7cfb\u76f8\u5bf9\u7b80\u5355\uff0c\u4e3b\u8981\u6d89\u53ca\u5982\u4e0b5\u4e2a\u7ec4\u4ef6\uff1a</p> <ul> <li>Docker\u5ba2\u6237\u7aef \u2013 Docker</li> </ul> <p>docker\u5ba2\u6237\u7aef\u5219\u626e\u6f14\u7740docker\u670d\u52a1\u7aef\u7684\u8fdc\u7a0b\u63a7\u5236\u5668\uff0c\u53ef\u4ee5\u7528\u6765\u63a7\u5236docker\u7684\u670d\u52a1\u7aef\u8fdb\u7a0b\u3002</p> <ul> <li>Docker\u670d\u52a1\u7aef \u2013 Docker Daemon</li> </ul> <p>docker\u670d\u52a1\u7aef\u662f\u4e00\u4e2a\u670d\u52a1\u8fdb\u7a0b\uff0c\u7ba1\u7406\u7740\u6240\u6709\u7684\u5bb9\u5668\u3002</p> <ul> <li>Docker\u955c\u50cf \u2013 Image</li> </ul> <p>docker\u955c\u50cf\uff0c\u4e00\u4e2a\u80fd\u591f\u8fd0\u884c\u5728docker\u5bb9\u5668\u4e0a\u7684\u4e00\u7ec4\u7a0b\u5e8f\u6587\u4ef6\uff0c\u662f\u4e00\u4e2a\u53ea\u8bfb\u7684\u6a21\u677f\uff0c\u4e0d\u5305\u542b\u4efb\u4f55\u52a8\u6001\u6570\u636e\u3002</p> <ul> <li>Docker\u5bb9\u5668 \u2013 Docker Container</li> </ul> <p>docker\u5bb9\u5668\uff0c\u5c31\u662f\u8fd0\u884c\u7a0b\u5e8f\u7684\u8f7d\u4f53\uff0c\u5bb9\u5668\u662f\u955c\u50cf\u8fd0\u884c\u65f6\u7684\u5b9e\u4f53\u3002</p> <ul> <li>Docker\u955c\u50cf\u4ed3\u5e93 -- Registry</li> </ul> <p>Docker\u4ed3\u5e93\u662f\u96c6\u4e2d\u5b58\u653e\u955c\u50cf\u6587\u4ef6\u7684\u573a\u6240\uff0cDocker\u4ed3\u5e93\u5206\u4e3a\u516c\u5f00\u4ed3\u5e93\uff08Public\uff09\u548c\u79c1\u6709\u4ed3\u5e93\uff08Private\uff09\u4e24\u79cd\u5f62\u5f0f\u3002</p>"},{"location":"chap4/3Linux_tools/#2-6-docker","title":"2-6 \u7b80\u8ff0Docker\u5982\u4f55\u5b9e\u73b0\u7f51\u7edc\u9694\u79bb\uff1f","text":"<p>Docker\u5229\u7528\u4e86\u7f51\u7edc\u7684\u547d\u540d\u7a7a\u95f4\u7279\u6027\uff0c\u5b9e\u73b0\u4e86\u4e0d\u540c\u5bb9\u5668\u4e4b\u95f4\u7684\u7f51\u7edc\u9694\u79bb\u3002\u547d\u540d\u7a7a\u95f4\u53ef\u4ee5\u652f\u6301\u7f51\u7edc\u534f\u8bae\u6808\u7684\u591a\u4e2a\u5b9e\u4f8b\uff0c\u72ec\u7acb\u7684\u534f\u8bae\u6808\u88ab\u9694\u79bb\u5230\u4e0d\u540c\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\u3002</p> <p>\u56e0\u6b64\u5904\u4e8e\u4e0d\u540c\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u7f51\u7edc\u6808\u662f\u5b8c\u5168\u9694\u79bb\u7684\uff0c\u5f7c\u6b64\u4e4b\u95f4\u65e0\u6cd5\u901a\u4fe1\u3002\u6bcf\u4e2a\u72ec\u7acb\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\u53ef\u4ee5\u6709\u81ea\u5df1\u72ec\u7acb\u7684\u8def\u7531\u8868\u53ca\u72ec\u7acb\u7684iptables\u8bbe\u7f6e\u6765\u63d0\u4f9b\u5305\u8f6c\u53d1\u3001NAT\u53caIP\u5305\u8fc7\u6ee4\u7b49\u529f\u80fd\u3002</p>"},{"location":"chap4/3Linux_tools/#2-7-linuxdocker","title":"2-7 \u7b80\u8ff0Linux\u6587\u4ef6\u7cfb\u7edf\u548cDocker\u6587\u4ef6\u7cfb\u7edf\uff1f","text":"<p>Linux\u6587\u4ef6\u7cfb\u7edf\uff1a\u7531bootfs\u548crootfs\u7ec4\u6210\uff0c</p> <ul> <li>bootfs\u4e3b\u8981\u5305\u542bbootloader\u548ckernel\uff0c</li> <li>bootloader\u4e3b\u8981\u662f\u5f15\u5bfc\u52a0\u8f7dkernel\uff0c\u5f53kernel\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e4b\u540ebootfs\u5c31\u88ab\u5378\u8f7d\u6389\u4e86\u3002</li> <li>rootfs\u5305\u542b\u7684\u5c31\u662f\u5178\u578blinux\u7cfb\u7edf\u4e2d/dev,/proc,/bin,/etc\u7b49\u6807\u51c6\u76ee\u5f55\u3002</li> </ul> <p>Docker\u6587\u4ef6\u7cfb\u7edf\uff1aDocker\u5bb9\u5668\u662f\u5efa\u7acb\u5728Aufs\u5206\u5c42\u6587\u4ef6\u7cfb\u7edf\u57fa\u7840\u4e0a\u7684\uff0cAufs\u652f\u6301\u5c06\u4e0d\u540c\u7684\u76ee\u5f55\u6302\u8f7d\u5230\u540c\u4e00\u4e2a\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\u4e0b\uff0c\u5e76\u5b9e\u73b0\u4e00\u79cdlayer\u7684\u6982\u5ff5\u3002Aufs\u5c06\u6302\u8f7d\u5230\u540c\u4e00\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\u4e0b\u7684\u591a\u4e2a\u76ee\u5f55\u5206\u522b\u8bbe\u7f6e\u6210read-only\uff0cread-write\u4ee5\u53cawhiteout-able\u6743\u9650\u3002docker \u955c\u50cf\u4e2d\u6bcf\u4e00\u5c42\u6587\u4ef6\u7cfb\u7edf\u90fd\u662fread-only\u3002</p>"},{"location":"chap4/3Linux_tools/#2-8-docker","title":"2-8 \u7b80\u8ff0Docker\u7f51\u7edc\u6a21\u5f0f\uff1f","text":"<p>Docker\u4f7f\u7528Linux\u7684Namespaces\u6280\u672f\u6765\u8fdb\u884c\u8d44\u6e90\u9694\u79bb\uff0c\u5176\u4e2dNetwork Namespace\u5b9e\u73b0\u9694\u79bb\u7f51\u7edc\u3002</p> <p>\u4e00\u4e2aNetwork Namespace\u63d0\u4f9b\u4e86\u4e00\u4efd\u72ec\u7acb\u9694\u79bb\u7684\u7f51\u7edc\u73af\u5883\uff0c\u5305\u62ec\u7f51\u5361\u3001\u8def\u7531\u3001Iptable\u89c4\u5219\u7b49\uff0cDocker\u7f51\u7edc\u6709\u5982\u4e0b\u56db\u79cd\u6a21\u5f0f\uff1a</p> <ul> <li>host\u6a21\u5f0f\uff1ahost\u6a21\u5f0f\u4e0b\u5bb9\u5668\u5c06\u4e0d\u4f1a\u83b7\u5f97\u72ec\u7acb\u7684Network Namespace\uff0c\u8be5\u6a21\u5f0f\u4e0b\u4e0e\u5bbf\u4e3b\u673a\u5171\u7528\u4e00\u4e2aNetwork Namespace\u3002\u5bb9\u5668\u5c06\u4e0d\u4f1a\u865a\u62df\u51fa\u81ea\u5df1\u7684\u7f51\u5361\uff0c\u4e0d\u4f1a\u914d\u7f6e\u72ec\u6709\u7684IP\u7b49\uff0c\u800c\u662f\u4f7f\u7528\u5bbf\u4e3b\u673a\u7684IP\u548c\u7aef\u53e3\u3002</li> <li>container\u6a21\u5f0f\uff1aContainer \u7f51\u7edc\u6a21\u5f0f\u662f Docker \u4e2d\u4e00\u79cd\u8f83\u4e3a\u7279\u522b\u7684\u7f51\u7edc\u7684\u6a21\u5f0f\uff0c\u5904\u4e8econtainer\u6a21\u5f0f\u4e0b\u7684 Docker \u5bb9\u5668\u4f1a\u5171\u4eab\u5176\u4ed6\u5bb9\u5668\u7684\u7f51\u7edc\u73af\u5883\uff0c\u56e0\u6b64\uff0c\u4e24\u4e2a\u6216\u4ee5\u4e0a\u7684\u5bb9\u5668\u4e4b\u95f4\u4e0d\u5b58\u5728\u7f51\u7edc\u9694\u79bb\uff0c\u800c\u914d\u7f6econtainer\u6a21\u5f0f\u7684\u5bb9\u5668\u53c8\u4e0e\u5bbf\u4e3b\u673a\u4ee5\u53ca\u9664\u6b64\u4e4b\u5916\u5176\u4ed6\u7684\u5bb9\u5668\u5b58\u5728\u7f51\u7edc\u9694\u79bb\u3002</li> <li>none\u6a21\u5f0f\uff1anone\u6a21\u5f0f\u4e0b\uff0cDocker\u5bb9\u5668\u62e5\u6709\u81ea\u5df1\u7684Network Namespace\uff0c\u4f46\u662f\uff0c\u5e76\u4e0d\u4e3aDocker\u5bb9\u5668\u8fdb\u884c\u4efb\u4f55\u7f51\u7edc\u914d\u7f6e\u548c\u6784\u9020\u4efb\u4f55\u7f51\u7edc\u73af\u5883\u3002<ul> <li>Docker \u5bb9\u5668\u91c7\u7528\u4e86none \u7f51\u7edc\u6a21\u5f0f\uff0c\u90a3\u4e48\u5bb9\u5668\u5185\u90e8\u5c31\u53ea\u80fd\u4f7f\u7528loopback\u7f51\u7edc\u8bbe\u5907\uff0c\u4e0d\u4f1a\u518d\u6709\u5176\u4ed6\u7684\u7f51\u7edc\u8d44\u6e90\u3002Docker Container\u7684none\u7f51\u7edc\u6a21\u5f0f\u610f\u5473\u7740\u4e0d\u7ed9\u8be5\u5bb9\u5668\u521b\u5efa\u4efb\u4f55\u7f51\u7edc\u73af\u5883\uff0c\u5bb9\u5668\u53ea\u80fd\u4f7f\u7528127.0.0.1\u7684\u672c\u673a\u7f51\u7edc\u3002</li> </ul> </li> <li>bridge\u6a21\u5f0f\uff1abridge\u6a21\u5f0f\u662fDocker\u9ed8\u8ba4\u7684\u7f51\u7edc\u8bbe\u7f6e\uff0c\u6b64\u6a21\u5f0f\u4f1a\u4e3a\u6bcf\u4e00\u4e2a\u5bb9\u5668\u5206\u914dNetwork Namespace\u3001\u8bbe\u7f6eIP\u7b49\uff0c\u5e76\u5c06\u8be5\u5bbf\u4e3b\u673a\u4e0a\u7684Docker\u5bb9\u5668\u8fde\u63a5\u5230\u4e00\u4e2a\u865a\u62df\u7f51\u6865\u4e0a\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#2-9-docker","title":"2-9 \u7b80\u8ff0Docker\u8de8\u4e3b\u673a\u901a\u4fe1\u7684\u7f51\u7edc\u5b9e\u73b0\u65b9\u5f0f\uff1f","text":"<p>docker\u8de8\u4e3b\u673a\u901a\u4fe1\u6309\u539f\u7406\u53ef\u901a\u8fc7\u4ee5\u4e0b\u4e09\u79cd\u65b9\u5f0f\u5b9e\u73b0\uff1a</p> <ul> <li>\u76f4\u63a5\u8def\u7531\u65b9\u5f0f\uff1a\u76f4\u63a5\u5728\u4e0d\u540c\u5bbf\u4e3b\u673a\u4e4b\u95f4\u6dfb\u52a0\u9759\u6001\u8def\u7531\uff1b</li> <li>\u6865\u63a5\u65b9\u5f0f\uff08\u5982pipework\uff09\uff1a\u901a\u8fc7\u9759\u6001\u6307\u5b9a\u5bb9\u5668IP\u4e3a\u5bbf\u4e3b\u673aIP\u540c\u4e00\u4e2a\u7f51\u7edc\u7684\u5f62\u5f0f\uff0c\u5373\u53ef\u5b9e\u73b0\u3002</li> <li>Overlay\u96a7\u9053\u65b9\u5f0f\uff1a\u4f7f\u7528overlay\u7f51\u7edc\u5b9e\u73b0\uff0cOverlay\u7f51\u7edc\u6307\u5728\u73b0\u6709\u7f51\u7edc\u5c42\u4e4b\u4e0a\u53e0\u52a0\u7684\u865a\u62df\u5316\u6280\u672f\uff0c\u5b9e\u73b0\u5e94\u7528\u5728\u7f51\u7edc\u4e0a\u7684\u627f\u8f7d\uff0c\u5e76\u80fd\u4e0e\u5176\u4ed6\u7f51\u7edc\u4e1a\u52a1\u5206\u79bb\uff0c\u5e76\u4e14\u4ee5\u57fa\u4e8eIP\u7684\u7f51\u7edc\u6280\u672f\u4e3a\u4e3b\uff0c\u5982flannel\u3001ovs+gre\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#2-10-flannel","title":"2-10 \u7b80\u8ff0flannel\u7f51\u7edc\u6a21\u578b\u5b9e\u73b0\u539f\u7406\uff1f","text":"<p>Flannel\u4e3a\u6bcf\u4e2ahost\u5206\u914d\u4e00\u4e2asubnet\uff0c\u5bb9\u5668\u4ecesubnet\u4e2d\u5206\u914dIP\uff0c\u8fd9\u4e9bIP\u53ef\u4ee5\u5728host\u95f4\u8def\u7531\uff0c\u5bb9\u5668\u95f4\u65e0\u9700\u4f7f\u7528nat\u548c\u7aef\u53e3\u6620\u5c04\u5373\u53ef\u5b9e\u73b0\u8de8\u4e3b\u673a\u901a\u4fe1\u3002</p> <p>\u6bcf\u4e2asubnet\u90fd\u662f\u4ece\u4e00\u4e2a\u66f4\u5927\u7684IP\u6c60\u4e2d\u5212\u5206\u7684\uff0cflannel\u4f1a\u5728\u6bcf\u4e2a\u4e3b\u673a\u4e0a\u8fd0flanneld\u7684agent\uff0c\u8d1f\u8d23\u4ece\u6c60\u5b50\u4e2d\u5206\u914dsubnet\u3002</p> <p>Flannel\u4f7f\u7528etcd\u5b58\u653e\u7f51\u7edc\u914d\u7f6e\u3001\u5df2\u5206\u914d\u7684subnet\u3001host\u7684IP\u7b49\u4fe1\u606f\uff0cFlannel\u6570\u636e\u5305\u5728\u4e3b\u673a\u95f4\u8f6c\u53d1\u662f\u7531backend\u5b9e\u73b0\u7684\uff0c\u76ee\u524d\u5df2\u7ecf\u652f\u6301UDP\u3001VxLAN\u3001host-gw\u3001AWS VPC\u548cGCE\u8def\u7531\u7b49\u591a\u79cdbackend\u3002</p>"},{"location":"chap4/3Linux_tools/#3apache","title":"3\u3001Apache","text":""},{"location":"chap4/3Linux_tools/#3-1-apache","title":"3-1 \u7b80\u8ff0\u4ec0\u4e48\u662fApache\u670d\u52a1\u5668\uff1f","text":"<p>Apache\u670d\u52a1\u5668\u662f\u4e00\u4e2a\u975e\u5e38\u6d41\u884c\u3001\u529f\u80fd\u5f3a\u5927\u5e76\u4e14\u5f00\u6e90\u7684Web\u670d\u52a1\u5668\uff0c\u57fa\u4e8eHTTP\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\u8fd0\u884c\uff0c\u8fd9\u4e00\u534f\u8bae\u63d0\u4f9b\u4e86\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aefWeb\u6d4f\u89c8\u5668\u901a\u4fe1\u7684\u6807\u51c6\u3002\u5b83\u652f\u6301SSL\u3001CGI\u6587\u4ef6\u3001\u865a\u62df\u4e3b\u673a\u7b49\u8bb8\u591a\u529f\u80fd\u7279\u6027\u3002</p>"},{"location":"chap4/3Linux_tools/#3-2-apache","title":"3-2 \u7b80\u8ff0Apache\u865a\u62df\u4e3b\u673a\uff1f","text":"<p>Apache\u865a\u62df\u4e3b\u673a\u76f8\u5f53\u4e8e\u4e00\u4e2a\u5728\u540c\u4e00\u53f0\u670d\u52a1\u5668\u4e2d\u5374\u76f8\u4e92\u72ec\u7acb\u7684\u7ad9\u70b9\uff0c\u4ece\u800c\u5b9e\u73b0\u4e00\u53f0\u4e3b\u673a\u5bf9\u5916\u63d0\u4f9b\u591a\u4e2a web \u670d\u52a1\uff0c\u6bcf\u4e2a\u865a\u62df\u4e3b\u673a\u4e4b\u95f4\u662f\u72ec\u7acb\u7684\uff0c\u4e92\u4e0d\u5f71\u54cd\u7684\u3002</p> <p>Apache\u5177\u6709\u4e24\u79cd\u7c7b\u578b\u7684\u865a\u62df\u4e3b\u673a\uff1a\u57fa\u4e8e\u540d\u79f0\u7684\u865a\u62df\u4e3b\u673a\u548c\u57fa\u4e8eIP\u7684\u865a\u62df\u4e3b\u673a\u3002</p>"},{"location":"chap4/3Linux_tools/#3-3-apacheworker-mpmprefork-mpm","title":"3-3 \u7b80\u8ff0Apache\u7684Worker MPM\u548cPrefork MPM\u4e4b\u95f4\u7684\u533a\u522b\uff1f","text":"<p>\u5b83\u4eec\u90fd\u662fMPM\uff0cWorker\u548cPrefork\u6709\u5b83\u4eec\u5404\u81ea\u5728Apache\u4e0a\u7684\u8fd0\u884c\u673a\u5236\uff0c\u53d6\u51b3\u4e8e\u54ea\u79cd\u6a21\u5f0f\u542f\u52a8Apache\u3002Worker MPM\u548cPrefork MPM\u57fa\u672c\u7684\u533a\u522b\u5728\u4e8e\u5b83\u4eec\u4ea7\u751f\u5b50\u8fdb\u7a0b\u7684\u5904\u7406\u8fc7\u7a0b\u3002</p> <ul> <li>Prefork MPM\u4e2d\uff0c\u4e00\u4e2a\u4e3bhttpd\u8fdb\u884c\u88ab\u542f\u52a8\uff0c\u8fd9\u4e2a\u4e3b\u8fdb\u7a0b\u4f1a\u7ba1\u7406\u6240\u6709\u5176\u5b83\u5b50\u8fdb\u7a0b\u4e3a\u5ba2\u6237\u7aef\u8bf7\u6c42\u63d0\u4f9b\u670d\u52a1\u3002Worker MPM\u4e2d\u4e00\u4e2ahttpd\u8fdb\u7a0b\u88ab\u6fc0\u6d3b\uff0c\u5219\u4f1a\u4f7f\u7528\u4e0d\u540c\u7684\u7ebf\u7a0b\u6765\u4e3a\u5ba2\u6237\u7aef\u8bf7\u6c42\u63d0\u4f9b\u670d\u52a1.</li> <li>Prefork MPM\u4f7f\u7528\u591a\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u5e26\u6709\u4e00\u4e2a\u7ebf\u7a0b\uff0cWorker MPM\u4f7f\u7528\u591a\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u5e26\u6709\u591a\u4e2a\u7ebf\u7a0b\u3002</li> <li>Prefork MPM\u4e2d\u7684\u8fde\u63a5\u5904\u7406\uff0c\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u4e00\u6b21\u5904\u7406\u4e00\u4e2a\u8fde\u63a5\u800c\u5728Worker MPM\u4e2d\u6bcf\u4e00\u4e2a\u7ebf\u7a0b\u4e00\u6b21\u5904\u7406\u4e00\u4e2a\u8fde\u63a5\u3002</li> <li>\u5185\u5b58\u5360\u7528Prefork MPM\u5360\u7528\u5e9e\u5927\u7684\u5185\u5b58\uff0c\u800cWorker MPM\u5360\u7528\u66f4\u5c0f\u7684\u5185\u5b58\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4nginx","title":"4\u3001Nginx","text":""},{"location":"chap4/3Linux_tools/#4-1-nginx","title":"4-1 \u7b80\u8ff0Nginx\u662f\u4ec0\u4e48\u53ca\u5176\u4e3b\u8981\u7279\u70b9\uff1f","text":"<p>Nginx\u662f\u4e00\u6b3e\u81ea\u7531\u7684\u3001\u5f00\u6e90\u7684\u3001\u9ad8\u6027\u80fd\u7684HTTP\u670d\u52a1\u5668\u548c\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\u3002\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2aHTTP\u670d\u52a1\u5668\u8fdb\u884c\u7f51\u7ad9\u7684\u53d1\u5e03\u5904\u7406\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u53cd\u5411\u4ee3\u7406\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\u7684\u5b9e\u73b0\u3002\u5176\u4e3b\u8981\u7279\u70b9\u6709\uff1a</p> <ul> <li>\u5360\u6709\u5185\u5b58\u5c11\uff0c\u5e76\u53d1\u80fd\u529b\u5f3a\u3002</li> <li>Nginx\u4f7f\u7528\u57fa\u4e8e\u4e8b\u4ef6\u9a71\u52a8\u67b6\u6784\uff0c\u4f7f\u5f97\u5176\u53ef\u4ee5\u652f\u6301\u6570\u4ee5\u767e\u4e07\u7ea7\u522b\u7684TCP\u8fde\u63a5\u3002</li> <li>\u9ad8\u5ea6\u7684\u6a21\u5757\u5316\u548c\u81ea\u7531\u8f6f\u4ef6\u8bb8\u53ef\u8bc1\u4f7f\u5f97\u7b2c\u4e09\u65b9\u6a21\u5757\u975e\u5e38\u4e30\u5bcc\u3002</li> <li>Nginx\u662f\u4e00\u4e2a\u8de8\u5e73\u53f0\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u8fd0\u884c\u5728Linux\uff0cWindows\uff0cFreeBSD\uff0cSolaris\uff0cAIX\uff0cMac OS\u7b49\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4-2-nginxapache","title":"4-2 \u7b80\u8ff0Nginx\u548cApache\u7684\u5dee\u5f02\uff1f","text":"<ul> <li>Nginx\u662f\u4e00\u4e2a\u57fa\u4e8e\u4e8b\u4ef6\u7684Web\u670d\u52a1\u5668\uff0cApache\u662f\u4e00\u4e2a\u57fa\u4e8e\u6d41\u7a0b\u7684\u670d\u52a1\u5668\uff1b</li> <li>Nginx\u6240\u6709\u8bf7\u6c42\u90fd\u7531\u4e00\u4e2a\u7ebf\u7a0b\u5904\u7406\uff0cApache\u5355\u4e2a\u7ebf\u7a0b\u5904\u7406\u5355\u4e2a\u8bf7\u6c42\uff1b</li> <li>Nginx\u907f\u514d\u5b50\u8fdb\u7a0b\u7684\u6982\u5ff5\uff0cApache\u662f\u57fa\u4e8e\u5b50\u8fdb\u7a0b\u7684\uff1b</li> <li>Nginx\u5728\u5185\u5b58\u6d88\u8017\u548c\u8fde\u63a5\u65b9\u9762\u66f4\u597d\uff0cApache\u5728\u5185\u5b58\u6d88\u8017\u548c\u8fde\u63a5\u65b9\u9762\u4e00\u822c\uff1b</li> <li>Nginx\u7684\u6027\u80fd\u548c\u53ef\u4f38\u7f29\u6027\u4e0d\u4f9d\u8d56\u4e8e\u786c\u4ef6\uff0cApache\u4f9d\u8d56\u4e8eCPU\u548c\u5185\u5b58\u7b49\u786c\u4ef6\uff1b</li> <li>Nginx\u652f\u6301\u70ed\u90e8\u7f72\uff0cApache\u4e0d\u652f\u6301\u70ed\u90e8\u7f72\uff1b</li> <li>Nginx\u5bf9\u4e8e\u9759\u6001\u6587\u4ef6\u5904\u7406\u5177\u6709\u66f4\u9ad8\u6548\u7387\uff0cApache\u76f8\u5bf9\u4e00\u822c\uff1b</li> <li>Nginx\u5728\u53cd\u5411\u4ee3\u7406\u573a\u666f\u5177\u6709\u660e\u663e\u4f18\u52bf\uff0cApache\u76f8\u5bf9\u4e00\u822c\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4-3-nginx","title":"4-3 \u7b80\u8ff0Nginx\u4e3b\u8981\u5e94\u7528\u7684\u573a\u666f\uff1f","text":"<p>\u57fa\u4e8eNginx\u7684\u7279\u6027\uff0cNginx\u7684\u5e94\u7528\u573a\u666f\u4e3b\u8981\u6709\uff1a</p> <ul> <li>http\u670d\u52a1\u5668\uff1aNginx\u662f\u4e00\u4e2ahttp\u670d\u52a1\u53ef\u4ee5\u72ec\u7acb\u63d0\u4f9bhttp\u670d\u52a1\uff0c\u53ef\u4ee5\u505a\u7f51\u9875\u9759\u6001\u670d\u52a1\u5668\u3002</li> <li>\u865a\u62df\u4e3b\u673a\uff1a\u53ef\u4ee5\u5b9e\u73b0\u5728\u4e00\u53f0\u670d\u52a1\u5668\u865a\u62df\u51fa\u591a\u4e2a\u7f51\u7ad9</li> <li>\u6b63\u53cd\u4ee3\u7406\uff1a\u8d1f\u8f7d\u5747\u8861\u6216\u52a0\u901f\uff0c\u5f53\u7f51\u7ad9\u7684\u8bbf\u95ee\u91cf\u8fbe\u5230\u4e00\u5b9a\u7a0b\u5ea6\u540e\uff0c\u5355\u53f0\u670d\u52a1\u5668\u4e0d\u80fd\u6ee1\u8db3\u7528\u6237\u7684\u8bf7\u6c42\u65f6\uff0c\u9700\u8981\u7528\u591a\u53f0\u670d\u52a1\u5668\u96c6\u7fa4\u53ef\u4ee5\u4f7f\u7528Nginx\u505a\u53cd\u5411\u4ee3\u7406\uff0c\u5e76\u4e14\u591a\u53f0\u670d\u52a1\u5668\u53ef\u4ee5\u5e73\u5747\u5206\u62c5\u8d1f\u8f7d\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4-4-nginx-http","title":"4-4 \u7b80\u8ff0Nginx HTTP\u8fde\u63a5\u548c\u8bf7\u6c42\u7684\u5173\u7cfb\uff1f","text":"<p>HTTP\u662f\u5efa\u7acb\u5728TCP\u4e0a\uff0c\u4e00\u6b21HTTP\u8bf7\u6c42\u9700\u8981\u5148\u5efa\u7acbTCP\u4e09\u6b21\u63e1\u624b\uff08\u79f0\u4e3aTCP\u8fde\u63a5\uff09\uff0c\u5728\u8fde\u63a5\u7684\u57fa\u7840\u4e0a\u518d\u8fdb\u884cHTTP\u8bf7\u6c42\u3002</p> <p>HTTP\u8bf7\u6c42\u5efa\u7acb\u5728\u4e00\u6b21TCP\u8fde\u63a5\u57fa\u7840\u4e0a\uff0c\u5bf9\u4e8eHTTP\u4f1a\u8bdd\uff0c\u4e00\u6b21TCP\u8fde\u63a5\u53ef\u4ee5\u5efa\u7acb\u591a\u6b21HTTP\u8bf7\u6c42\u3002</p>"},{"location":"chap4/3Linux_tools/#4-5-nginx","title":"4-5 \u7b80\u8ff0Nginx\u652f\u6301\u54ea\u4e9b\u8bbf\u95ee\u63a7\u5236\u65b9\u5f0f\uff1f","text":"<ul> <li>\u8fde\u63a5\u9650\u5236\uff1aNginx\u81ea\u5e26\u7684<code>limit_conn_module</code>\u6a21\u5757\uff08TCP\u8fde\u63a5\u9891\u7387\u9650\u5236\u6a21\u5757\uff09\u548c<code>limit_req_mudule</code>\u6a21\u5757\uff08HTTP\u8bf7\u6c42\u9891\u7387\u9650\u5236\u6a21\u5757\uff09\u652f\u6301\u5bf9\u8fde\u63a5\u9891\u7387\u4ee5\u53ca\u8bf7\u6c42\u9891\u7387\u3001\u6765\u6e90\u8fdb\u884c\u9650\u5236\uff0c\u901a\u5e38\u53ef\u53ef\u4ee5\u7528\u6765\u9632\u6b62DDOS\u653b\u51fb\u3002</li> <li>IP\u9650\u5236\uff1aNginx\u4f7f\u7528<code>http_access_module</code>\u6a21\u5757\u53ef\u5b9e\u73b0\u57fa\u4e8eIP\u7684\u8bbf\u95ee\u63a7\u5236\uff0c\u4f46\u901a\u8fc7\u4ee3\u7406\u53ef\u4ee5\u7ed5\u8fc7\u9650\u5236\u3002</li> <li>\u8d26\u53f7\u9650\u5236\uff1aNginx\u4f7f\u7528<code>http_auth_basic_module</code>\u6a21\u5757\u53ef\u5b9e\u73b0\u7528\u6237\u5bc6\u7801\u7684\u767b\u5f55\u9650\u5236\u3002</li> <li>\u6d41\u91cf\u9650\u5236\uff1aNginx\u4f7f\u7528<code>http_core_moduleblock</code>\u6a21\u5757\u53ef\u5b9e\u73b0\u5ba2\u6237\u7aef\u4f20\u9001\u54cd\u5e94\u7684\u901f\u7387\u9650\u5236\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4-6-nginx-masterworker","title":"4-6 \u7b80\u8ff0Nginx Master\u8fdb\u7a0b\u548cWorker\u8282\u70b9\uff1f","text":"<p>master\u8fdb\u7a0b\u4e3b\u8981\u7528\u6765\u7ba1\u7406worker\u8fdb\u7a0b\uff0c\u5305\u542b\uff1a</p> <ul> <li>\u63a5\u6536\u6765\u81ea\u5916\u754c\u7684\u4fe1\u53f7\uff0c</li> <li>\u5411\u5404worker\u8fdb\u7a0b\u53d1\u9001\u4fe1\u53f7\uff0c</li> <li>\u76d1\u63a7worker\u8fdb\u7a0b\u7684\u8fd0\u884c\u72b6\u6001\uff0c\u5f53worker\u8fdb\u7a0b\u9000\u51fa\u540e(\u5f02\u5e38\u60c5\u51b5\u4e0b)\uff0c\u4f1a\u81ea\u52a8\u91cd\u65b0\u542f\u52a8\u65b0\u7684worker\u8fdb\u7a0b\u3002</li> </ul> <p>worker\u8fdb\u7a0b\u5219\u662f\u5904\u7406\u57fa\u672c\u7684\u7f51\u7edc\u4e8b\u4ef6\u3002</p> <p>\u591a\u4e2aworker\u8fdb\u7a0b\u4e4b\u95f4\u662f\u5bf9\u7b49\u7684\uff0c\u4ed6\u4eec\u540c\u7b49\u7ade\u4e89\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u5404\u8fdb\u7a0b\u4e92\u76f8\u4e4b\u95f4\u662f\u72ec\u7acb\u7684\u3002\u4e00\u4e2a\u8bf7\u6c42\uff0c\u53ea\u53ef\u80fd\u5728\u4e00\u4e2aworker\u8fdb\u7a0b\u4e2d\u5904\u7406\uff0c\u4e00\u4e2aworker\u8fdb\u7a0b\uff0c\u4e0d\u53ef\u80fd\u5904\u7406\u5176\u5b83\u8fdb\u7a0b\u7684\u8bf7\u6c42\u3002</p>"},{"location":"chap4/3Linux_tools/#4-7-nginxhttp","title":"4-7 \u7b80\u8ff0Nginx\u5982\u4f55\u5904\u7406HTTP\u8bf7\u6c42\uff1f","text":"<ul> <li>\u9996\u5148\uff0cNginx \u5728\u542f\u52a8\u65f6\uff0c\u4f1a\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\uff0c\u83b7\u53d6\u9700\u8981\u76d1\u542c\u7684\u7aef\u53e3\u4e0e IP \u5730\u5740\uff0c\u7136\u540e\u5728 Nginx \u7684 Master \u8fdb\u7a0b\u91cc\u9762\u5148\u521d\u59cb\u5316\u597d\u8fd9\u4e2a\u76d1\u63a7\u7684Socket\uff08\u521b\u5efa Socket\uff0c\u8bbe\u7f6e addr\u3001\u7ed1\u5b9aip\u548c\u7aef\u53e3\uff0c\u7136\u540elisten \u76d1\u542c)\u3002</li> <li>\u7136\u540e\uff0c\u518d fork \u51fa\u591a\u4e2a\u5b50\u8fdb\u7a0b\u51fa\u6765\u3002</li> <li>\u4e4b\u540e\uff0c\u5b50\u8fdb\u7a0b\u4f1a\u7ade\u4e89 accept \u65b0\u7684\u8fde\u63a5\u3002<ul> <li>\u6b64\u65f6\uff0c\u5ba2\u6237\u7aef\u5c31\u53ef\u4ee5\u5411 nginx \u53d1\u8d77\u8fde\u63a5\u4e86\u3002</li> <li>\u5f53\u5ba2\u6237\u7aef\u4e0enginx\u5b8c\u6210TCP\u4e09\u6b21\u63e1\u624b\uff0c\u4e0e nginx \u5efa\u7acb\u597d\u4e00\u4e2a\u8fde\u63a5\u540e\u3002</li> <li>\u6b64\u65f6\uff0c\u67d0\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u4f1a accept \u6210\u529f\uff0c\u5f97\u5230\u8fd9\u4e2a\u5efa\u7acb\u597d\u7684\u8fde\u63a5\u7684 Socket \uff0c\u7136\u540e\u521b\u5efa nginx \u5bf9\u8fde\u63a5\u7684\u5c01\u88c5\u3002</li> </ul> </li> <li>\u63a5\u7740\uff0c\u8bbe\u7f6e\u8bfb\u5199\u4e8b\u4ef6\u5904\u7406\u51fd\u6570\uff0c\u5e76\u6dfb\u52a0\u8bfb\u5199\u4e8b\u4ef6\u6765\u4e0e\u5ba2\u6237\u7aef\u8fdb\u884c\u6570\u636e\u7684\u4ea4\u6362\u3002</li> <li>\u6700\u540e\uff0cNginx \u6216\u5ba2\u6237\u7aef\u6765\u4e3b\u52a8\u5173\u6389\u8fde\u63a5\uff0c\u5b8c\u6210\u6574\u4e2aHTTP\u8bf7\u6c42\u7684\u5904\u7406\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4-8-nginxhttp","title":"4-8 \u7b80\u8ff0Nginx\u5bf9\u4e8eHTTP\u8bf7\u6c42\u91c7\u7528\u54ea\u4e24\u79cd\u673a\u5236\u8fdb\u884c\u5904\u7406\uff1f","text":"<p>Nginx \u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684 Web \u670d\u52a1\u5668\uff0c\u80fd\u591f\u540c\u65f6\u5904\u7406\u5927\u91cf\u7684\u5e76\u53d1\u8bf7\u6c42\u3002\u5b83\u7ed3\u5408\u591a\u8fdb\u7a0b\u673a\u5236\u548c\u5f02\u6b65\u975e\u963b\u585e\u673a\u5236 \u3002</p> <ul> <li> <p>\u591a\u8fdb\u7a0b\u673a\u5236\uff1a\u670d\u52a1\u5668\u6bcf\u5f53\u6536\u5230\u4e00\u4e2a\u5ba2\u6237\u7aef\u8bf7\u6c42\u65f6\uff0c\u5c31\u6709\u670d\u52a1\u5668\u4e3b\u8fdb\u7a0b \uff08master process\uff09\u751f\u6210\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff08worker process\uff09\u548c\u5ba2\u6237\u7aef\u5efa\u7acb\u8fde\u63a5\u8fdb\u884c\u4ea4\u4e92\uff0c\u76f4\u5230\u8fde\u63a5\u65ad\u5f00\uff0c\u8be5\u5b50\u8fdb\u7a0b\u5c31\u7ed3\u675f\u4e86\u3002</p> <ul> <li>\u4f7f\u7528\u8fdb\u7a0b\u7684\u597d\u5904\u662f\u5404\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u76f8\u4e92\u72ec\u7acb\uff0c\u4e0d\u9700\u8981\u52a0\u9501\uff0c\u51cf\u5c11\u4e86\u4f7f\u7528\u9501\u5bf9\u6027\u80fd\u9020\u6210\u5f71\u54cd\u3002</li> <li>\u5176\u6b21\uff0c\u91c7\u7528\u72ec\u7acb\u7684\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u8ba9\u8fdb\u7a0b\u4e92\u76f8\u4e4b\u95f4\u4e0d\u4f1a\u5f71\u54cd \uff0c\u5982\u679c\u4e00\u4e2a\u8fdb\u7a0b\u53d1\u751f\u5f02\u5e38\u9000\u51fa\u65f6\uff0c\u5176\u5b83\u8fdb\u7a0b\u6b63\u5e38\u5de5\u4f5c\uff0cmaster\u8fdb\u7a0b\u5219\u5f88\u5feb\u542f\u52a8\u65b0\u7684worker\u8fdb\u7a0b\uff0c\u786e\u4fdd\u670d\u52a1\u4e0d\u4f1a\u4e2d\u65ad\uff0c\u4ece\u800c\u5c06\u98ce\u9669\u964d\u5230\u6700\u4f4e\u3002</li> <li>\u7f3a\u70b9\u662f\u64cd\u4f5c\u7cfb\u7edf\u751f\u6210\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u9700\u8981\u8fdb\u884c \u5185\u5b58\u590d\u5236\u7b49\u64cd\u4f5c\uff0c\u5728\u8d44\u6e90\u548c\u65f6\u95f4\u4e0a\u4f1a\u4ea7\u751f\u4e00\u5b9a\u7684\u5f00\u9500\u3002\u5f53\u6709\u5927\u91cf\u8bf7\u6c42\u65f6\uff0c\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u6027\u80fd\u4e0b\u964d \u3002</li> </ul> </li> <li> <p>\u5f02\u6b65\u975e\u963b\u585e\u673a\u5236\uff1a\u6bcf\u4e2a\u5de5\u4f5c\u8fdb\u7a0b\u4f7f\u7528\u5f02\u6b65\u975e\u963b\u585e\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5904\u7406\u591a\u4e2a\u5ba2\u6237\u7aef\u8bf7\u6c42 \u3002</p> <ul> <li>\u5f53\u67d0\u4e2a\u5de5\u4f5c\u8fdb\u7a0b\u63a5\u6536\u5230\u5ba2\u6237\u7aef\u8bf7\u6c42\u4ee5\u540e\uff0c\u8c03\u7528 IO \u8fdb\u884c\u5904\u7406\uff0c\u5982\u679c\u4e0d\u80fd\u7acb\u5373\u5f97\u5230\u7ed3\u679c\uff0c\u5c31\u53bb\u5904\u7406\u5176\u4ed6\u8bf7\u6c42\uff08\u5373\u4e3a\u975e\u963b\u585e \uff09\u3002\u800c\u5ba2\u6237\u7aef\u5728\u6b64\u671f\u95f4\u4e5f\u65e0\u9700\u7b49\u5f85\u54cd\u5e94\uff0c\u53ef\u4ee5\u8fdb\u884c\u5176\u4ed6\u4efb\u52a1\uff08\u5373\u4e3a \u5f02\u6b65 \uff09\u3002</li> <li>\u5f53IO\u8fd4\u56de\u65f6\uff0c\u5c31\u4f1a\u901a\u77e5\u6b64\u5de5\u4f5c\u8fdb\u7a0b\u3002\u8be5\u8fdb\u7a0b\u5f97\u5230\u901a\u77e5\uff0c\u6682\u65f6\u6302\u8d77\u5f53\u524d\u5904\u7406\u7684\u4e8b\u52a1\u53bb\u54cd\u5e94\u5ba2\u6237\u7aef\u8bf7\u6c42\u3002</li> </ul> </li> </ul>"},{"location":"chap4/3Linux_tools/#4-9-nginx","title":"4-9 \u7b80\u8ff0Nginx\u652f\u6301\u54ea\u4e9b\u7c7b\u578b\u7684\u865a\u62df\u4e3b\u673a\uff1f","text":"<p>\u5bf9\u4e8eNginx\u800c\u8a00\uff0c\u6bcf\u4e00\u4e2a\u865a\u62df\u4e3b\u673a\u76f8\u5f53\u4e8e\u4e00\u4e2a\u5728\u540c\u4e00\u53f0\u670d\u52a1\u5668\u4e2d\u5374\u76f8\u4e92\u72ec\u7acb\u7684\u7ad9\u70b9\uff0c\u4ece\u800c\u5b9e\u73b0\u4e00\u53f0\u4e3b\u673a\u5bf9\u5916\u63d0\u4f9b\u591a\u4e2a web \u670d\u52a1\uff0c\u6bcf\u4e2a\u865a\u62df\u4e3b\u673a\u4e4b\u95f4\u662f\u72ec\u7acb\u7684\uff0c\u4e92\u4e0d\u5f71\u54cd\u7684\u3002\u901a\u8fc7 Nginx \u53ef\u4ee5\u5b9e\u73b0\u865a\u62df\u4e3b\u673a\u7684\u914d\u7f6e\uff0cNginx \u652f\u6301\u4e09\u79cd\u7c7b\u578b\u7684\u865a\u62df\u4e3b\u673a\u914d\u7f6e\uff1a</p> <ul> <li>\u57fa\u4e8e IP \u7684\u865a\u62df\u4e3b\u673a\uff08\u8f83\u5c11\u4f7f\u7528\uff09</li> <li>\u57fa\u4e8e\u57df\u540d\u7684\u865a\u62df\u4e3b\u673a</li> <li>\u57fa\u4e8e\u7aef\u53e3\u7684\u865a\u62df\u4e3b\u673a</li> </ul>"},{"location":"chap4/3Linux_tools/#4-10-nginx","title":"4-10 \u7b80\u8ff0Nginx\u7f13\u5b58\u53ca\u5176\u4f5c\u7528\uff1f","text":"<p>\u7f13\u5b58\u5bf9\u4e8eWeb\u81f3\u5173\u91cd\u8981\uff0c\u5c24\u5176\u5bf9\u4e8e\u5927\u578b\u9ad8\u8d1f\u8f7dWeb\u7ad9\u70b9\u3002</p> <p>Nginx\u7f13\u5b58\u53ef\u4f5c\u4e3a\u6027\u80fd\u4f18\u5316\u7684\u4e00\u4e2a\u91cd\u8981\u624b\u6bb5\uff0c\u53ef\u4ee5\u6781\u5927\u51cf\u8f7b\u540e\u7aef\u670d\u52a1\u5668\u7684\u8d1f\u8f7d\u3002\u901a\u5e38\u5bf9\u4e8e\u9759\u6001\u8d44\u6e90\uff0c\u5373\u8f83\u5c11\u7ecf\u5e38\u66f4\u65b0\u7684\u8d44\u6e90\uff0c\u5982\u56fe\u7247\uff0ccss\u6216js\u7b49\u8fdb\u884c\u7f13\u5b58\uff0c\u4ece\u800c\u5728\u6bcf\u6b21\u5237\u65b0\u6d4f\u89c8\u5668\u7684\u65f6\u5019\uff0c\u4e0d\u7528\u91cd\u65b0\u8bf7\u6c42\uff0c\u800c\u662f\u4ece\u7f13\u5b58\u91cc\u9762\u8bfb\u53d6\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u51cf\u8f7b\u670d\u52a1\u5668\u7684\u538b\u529b\u3002</p>"},{"location":"chap4/3Linux_tools/#4-11-nginx","title":"4-11 \u7b80\u8ff0Nginx\u4f5c\u4e3a\u4ee3\u7406\u7f13\u5b58\u540e\uff0c\u5ba2\u6237\u7aef\u8bbf\u95ee\u7684\u8fc7\u7a0b\uff1f","text":"<p>\u4f7f\u7528Nginx\u4f5c\u4e3a\u4ee3\u7406\u7f13\u5b58\u540e\uff0c\u53ef\u52a0\u5feb\u5ba2\u6237\u7aef\u7684\u8bbf\u95ee\uff0c\u5176\u8fc7\u7a0b\u5927\u81f4\u5982\u4e0b\uff1a</p> <ul> <li>1\u3001\u7b2c\u4e00\u6b65\uff1a\u5ba2\u6237\u7aef\u7b2c\u4e00\u6b21\u5411Nginx\u8bf7\u6c42\u6570\u636eA\uff1b</li> <li>2\u3001\u7b2c\u4e8c\u6b65\uff1a\u5f53Nginx\u53d1\u73b0\u7f13\u5b58\u4e2d\u6ca1\u6709\u6570\u636eA\u65f6\uff0c\u4f1a\u5411\u670d\u52a1\u7aef\u8bf7\u6c42\u6570\u636eA\uff1b</li> <li>3\u3001\u7b2c\u4e09\u6b65\uff1a\u670d\u52a1\u7aef\u63a5\u6536\u5230Nginx\u53d1\u6765\u7684\u8bf7\u6c42\uff0c\u5219\u8fd4\u56de\u6570\u636eA\u5230Nginx\uff0c\u5e76\u4e14\u7f13\u5b58\u5728Nginx\uff1b</li> <li>4\u3001\u7b2c\u56db\u6b65\uff1aNginx\u8fd4\u56de\u6570\u636eA\u7ed9\u5ba2\u6237\u7aef\u5e94\u7528\uff1b</li> <li>5\u3001\u7b2c\u4e94\u6b65\uff1a\u5ba2\u6237\u7aef\u7b2c\u4e8c\u6b21\u5411Nginx\u8bf7\u6c42\u6570\u636eA\uff1b</li> <li>6\u3001\u7b2c\u516d\u6b65\uff1a\u5f53Nginx\u53d1\u73b0\u7f13\u5b58\u4e2d\u5b58\u5728\u6570\u636eA\u65f6\uff0c\u5219\u4e0d\u4f1a\u8bf7\u6c42\u670d\u52a1\u7aef\uff1b</li> <li>7\u3001\u7b2c\u4e03\u6b65\uff1aNginx\u628a\u7f13\u5b58\u4e2d\u7684\u6570\u636eA\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u5e94\u7528\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4-12-nginx","title":"4-12 \u7b80\u8ff0Nginx\u4ee3\u7406\u53ca\u5176\u7c7b\u578b\uff1f","text":"<p>\u4ee3\u7406\uff08forward\uff09\u662f\u4e00\u4e2a\u4f4d\u4e8e\u5ba2\u6237\u7aef\u548c\u539f\u59cb\u670d\u52a1\u5668(origin server)\u4e4b\u95f4\u7684\u670d\u52a1\u5668\uff0c\u5373\u4ee3\u7406\u670d\u52a1\u5668\u3002</p> <p>\u4e3a\u4e86\u4ece\u539f\u59cb\u670d\u52a1\u5668\u53d6\u5f97\u5185\u5bb9\uff0c\u5ba2\u6237\u7aef\u5411\u4ee3\u7406\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u5e76\u6307\u5b9a\u76ee\u6807\u539f\u59cb\u670d\u52a1\u5668\uff0c\u7136\u540e\u4ee3\u7406\u670d\u52a1\u5668\u5411\u539f\u59cb\u670d\u52a1\u5668\u8f6c\u4ea4\u8bf7\u6c42\u5e76\u5c06\u83b7\u5f97\u7684\u5185\u5bb9\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002</p> <p>\u5176\u901a\u5e38\u6709\u5982\u4e0b\u4e09\u79cd\u4ee3\u7406\u6a21\u5f0f\uff1a</p> <ul> <li>\u6b63\u5411\u4ee3\u7406\uff08forward proxy\uff09\uff1a \u4e00\u4e2a\u4f4d\u4e8e\u5ba2\u6237\u7aef\u548c\u539f\u59cb\u670d\u52a1\u5668(origin server)\u4e4b\u95f4\u7684\u670d\u52a1\u5668\uff0c\u4e3a\u4e86\u4ece\u539f\u59cb\u670d\u52a1\u5668\u53d6\u5f97\u5185\u5bb9\uff0c\u5ba2\u6237\u7aef\u5411\u4ee3\u7406\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u5e76\u6307\u5b9a\u76ee\u6807(\u539f\u59cb\u670d\u52a1\u5668)\uff0c\u7136\u540e\u4ee3\u7406\u5411\u539f\u59cb\u670d\u52a1\u5668\u8f6c\u4ea4\u8bf7\u6c42\u5e76\u5c06\u83b7\u5f97\u7684\u5185\u5bb9\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002<ul> <li>\u5ba2\u6237\u7aef =&gt; \u539f\u59cb\u670d\u52a1\u5668(origin server)</li> </ul> </li> <li>\u53cd\u5411\u4ee3\u7406\uff08reverse proxy\uff09\uff1a\u6307\u4ee5\u4ee3\u7406\u670d\u52a1\u5668\u6765\u63a5\u53d7 Internet\u4e0a\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u7136\u540e\u5c06\u8bf7\u6c42\uff0c\u53d1\u7ed9\u5185\u90e8\u7f51\u7edc\u4e0a\u7684\u670d\u52a1\u5668\u5e76\u5c06\u4ece\u670d\u52a1\u5668\u4e0a\u5f97\u5230\u7684\u7ed3\u679c\u8fd4\u56de\u7ed9 Internet \u4e0a\u8bf7\u6c42\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\uff0c\u6b64\u65f6\u4ee3\u7406\u670d\u52a1\u5668\u5bf9\u5916\u5c31\u8868\u73b0\u4e3a\u4e00\u4e2a\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\u3002</li> <li>\u900f\u660e\u4ee3\u7406</li> </ul>"},{"location":"chap4/3Linux_tools/#4-13-nginx","title":"4-13 \u7b80\u8ff0Nginx\u76d7\u94fe\u53ca\u5982\u4f55\u9632\u62a4\uff1f","text":"<p>\u76d7\u94fe \u6307\u7684\u662f\u5728\u81ea\u5df1\u7684\u754c\u9762\u5c55\u793a\u975e\u672c\u670d\u52a1\u5668\u4e0a\u7684\u5185\u5bb9\uff0c\u901a\u8fc7\u6280\u672f\u624b\u6bb5\u83b7\u5f97\u5176\u4ed6\u670d\u52a1\u5668\u7684\u8d44\u6e90\u3002\u7ed5\u8fc7\u4ed6\u4eba\u8d44\u6e90\u5c55\u793a\u9875\u9762\uff0c\u5728\u81ea\u5df1\u9875\u9762\u5411\u7528\u6237\u63d0\u4f9b\u6b64\u5185\u5bb9\uff0c\u4ece\u800c\u51cf\u8f7b\u81ea\u5df1\u670d\u52a1\u5668\u7684\u8d1f\u62c5\uff0c\u56e0\u4e3a\u771f\u5b9e\u7684\u7a7a\u95f4\u548c\u6d41\u91cf\u6765\u81ea\u5176\u4ed6\u670d\u52a1\u5668\u3002</p> <p>\u56e0\u6b64\uff0c\u901a\u5e38\u4e3a\u4e86\u907f\u514d\u88ab\u76d7\u94fe\uff0c\u901a\u5e38Web\u670d\u52a1\u5668\u5efa\u8bae\u914d\u7f6e\u9632\u76d7\u94fe\u3002Nginx\u9632\u76d7\u94fe\u5176\u4e3b\u8981\u9632\u76d7\u94fe\u601d\u8def\u662f\u80fd\u533a\u522b\u54ea\u4e9b\u8bf7\u6c42\u662f\u975e\u6b63\u5e38\u7528\u6237\u8bf7\u6c42\uff0c\u5bf9\u4e8e\u975e\u6b63\u5e38\u7528\u6237\u7684\u8bf7\u6c42\u76f4\u63a5\u53cd\u9988403\u6216\u91cd\u5b9a\u5411\u81f3\u5176\u4ed6\u9875\u9762\u3002</p>"},{"location":"chap4/3Linux_tools/#4-14-nginx","title":"4-14 \u7b80\u8ff0Nginx\u8d1f\u8f7d\u5747\u8861\u7684\u610f\u4e49\uff1f","text":"<p>\u8d1f\u8f7d\u5747\u8861\u662f\u5c06\u8d1f\u8f7d\u5206\u644a\u5230\u591a\u4e2a\u64cd\u4f5c\u5355\u5143\u4e0a\u6267\u884c\uff0c\u4ece\u800c\u63d0\u9ad8\u670d\u52a1\u7684\u53ef\u7528\u6027\u548c\u54cd\u5e94\u901f\u5ea6\uff0c\u5e26\u7ed9\u7528\u6237\u66f4\u597d\u7684\u4f53\u9a8c\u3002</p> <p>\u5bf9\u4e8eWeb\u5e94\u7528\uff0c\u901a\u8fc7\u8d1f\u8f7d\u5747\u8861\uff0c\u53ef\u4ee5\u5c06\u4e00\u53f0\u670d\u52a1\u5668\u7684\u5de5\u4f5c\u6269\u5c55\u5230\u591a\u53f0\u670d\u52a1\u5668\u4e2d\u6267\u884c\uff0c\u63d0\u9ad8\u6574\u4e2a\u7f51\u7ad9\u7684\u8d1f\u8f7d\u80fd\u529b\u3002\u5176\u672c\u8d28\u91c7\u7528\u4e00\u4e2a\u8c03\u5ea6\u8005\uff0c\u4fdd\u8bc1\u6240\u6709\u540e\u7aef\u670d\u52a1\u5668\u90fd\u5c06\u6027\u80fd\u5145\u5206\u53d1\u6325\uff0c\u4ece\u800c\u4fdd\u6301\u670d\u52a1\u5668\u96c6\u7fa4\u7684\u6574\u4f53\u6027\u80fd\u6700\u4f18\uff0c\u8fd9\u5c31\u662f\u8d1f\u8f7d\u5747\u8861\u3002</p>"},{"location":"chap4/3Linux_tools/#4-15-nginx","title":"4-15 \u7b80\u8ff0Nginx\u8d1f\u8f7d\u5747\u8861\u7684\u4f18\u52bf\uff1f","text":"<p>Nginx\u4f5c\u4e3a\u8d1f\u8f7d\u5747\u8861\u5668\u5177\u6709\u6781\u5927\u7684\u4f18\u52bf\uff0c\u4e3b\u8981\u4f53\u73b0\u5728\uff1a</p> <ul> <li>\u9ad8\u5e76\u53d1\u8fde\u63a5</li> <li>\u5185\u5b58\u6d88\u8017\u5c11</li> <li>\u914d\u7f6e\u6587\u4ef6\u975e\u5e38\u7b80\u5355</li> <li>\u6210\u672c\u4f4e\u5ec9</li> <li>\u652f\u6301Rewrite\u91cd\u5199\u89c4\u5219</li> <li>\u5185\u7f6e\u7684\u5065\u5eb7\u68c0\u67e5\u529f\u80fd</li> <li>\u8282\u7701\u5e26\u5bbd</li> <li>\u7a33\u5b9a\u6027\u9ad8</li> </ul>"},{"location":"chap4/3Linux_tools/#4-16-nginx","title":"4-16 \u7b80\u8ff0Nginx\u8d1f\u8f7d\u5747\u8861\u4e3b\u8981\u7684\u5747\u8861\u673a\u5236\uff08\u7b56\u7565\uff09\uff1f","text":"<p>Nginx\u4f5c\u4e3a\u8d1f\u8f7d\u5747\u8861\u5668\u5177\u6709\u6781\u5927\u7684\u4f18\u52bf\uff0c\u5176\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u53ef\u4ee5\u5212\u5206\u4e3a\u4e24\u5927\u7c7b\uff1a\u5185\u7f6e\u7b56\u7565\u548c\u6269\u5c55\u7b56\u7565\uff0c\u6269\u5c55\u7b56\u7565\u4e3a\u7b2c\u4e09\u65b9\u63d0\u4f9b\u3002</p> <p>\u5185\u7f6e\u7b56\u7565</p> <ul> <li>\u8f6e\u8be2\uff08\u9ed8\u8ba4\uff09\uff1aNginx\u6839\u636e\u8bf7\u6c42\u6b21\u6570\uff0c\u5c06\u6bcf\u4e2a\u8bf7\u6c42\u5747\u5300\u5206\u914d\u5230\u6bcf\u53f0\u670d\u52a1\u5668\uff1b</li> <li>weight\uff1a\u52a0\u6743\u8f6e\u8be2\uff0c\u52a0\u6743\u8f6e\u8be2\u5219\u662f\u5728\u7b2c\u4e00\u79cd\u8f6e\u8be2\u7684\u57fa\u7840\u4e0a\u5bf9\u540e\u53f0\u7684\u6bcf\u53f0\u670d\u52a1\u8d4b\u4e88\u6743\u91cd\uff0c\u670d\u52a1\u5668\u7684\u6743\u91cd\u6bd4\u4f8b\u8d8a\u5927\uff0c\u88ab\u5206\u53d1\u5230\u7684\u6982\u7387\u4e5f\u5c31\u8d8a\u5927\u3002</li> <li><code>least_conn</code>\uff1a\u6700\u5c11\u8fde\u63a5\uff0c\u5c06\u8bf7\u6c42\u5206\u914d\u7ed9\u8fde\u63a5\u6570\u6700\u5c11\u7684\u670d\u52a1\u5668\u3002Nginx\u4f1a\u7edf\u8ba1\u54ea\u4e9b\u670d\u52a1\u5668\u7684\u8fde\u63a5\u6570\u6700\u5c11\u3002</li> <li><code>ip_hash</code>\uff1aIP \u54c8\u5e0c\uff0c\u7ed1\u5b9a\u5904\u7406\u8bf7\u6c42\u7684\u670d\u52a1\u5668\u3002\u7b2c\u4e00\u6b21\u8bf7\u6c42\u65f6\uff0c\u6839\u636e\u8be5\u5ba2\u6237\u7aef\u7684IP\u7b97\u51fa\u4e00\u4e2aHASH\u503c\uff0c\u5c06\u8bf7\u6c42\u5206\u914d\u5230\u96c6\u7fa4\u4e2d\u7684\u67d0\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u3002\u540e\u9762\u8be5\u5ba2\u6237\u7aef\u7684\u6240\u6709\u8bf7\u6c42\uff0c\u90fd\u5c06\u901a\u8fc7HASH\u7b97\u6cd5\uff0c\u627e\u5230\u4e4b\u524d\u5904\u7406\u8fd9\u53f0\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u670d\u52a1\u5668\uff0c\u7136\u540e\u5c06\u8bf7\u6c42\u4ea4\u7ed9\u5b83\u6765\u5904\u7406\u3002</li> </ul> <p>\u6269\u5c55\u7b56\u7565</p> <ul> <li>fair\uff1a\u6309\u540e\u7aef\u670d\u52a1\u5668\u7684\u54cd\u5e94\u65f6\u95f4\u6765\u5206\u914d\u8bf7\u6c42\uff0c\u54cd\u5e94\u65f6\u95f4\u77ed\u7684\u4f18\u5148\u5206\u914d\u3002</li> <li><code>url_hash</code>\uff1a\u6309\u8bbf\u95eeurl\u7684hash\u7ed3\u679c\u6765\u5206\u914d\u8bf7\u6c42\uff0c\u4f7f\u6bcf\u4e2aurl\u5b9a\u5411\u5230\u540c\u4e00\u4e2a\u540e\u7aef\u670d\u52a1\u5668\uff0c\u540e\u7aef\u670d\u52a1\u5668\u4e3a\u7f13\u5b58\u65f6\u6bd4\u8f83\u6709\u6548\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4-17-nginxrs","title":"4-17 \u7b80\u8ff0Nginx\u8d1f\u8f7d\u5747\u8861\uff08\u53cd\u5411\u4ee3\u7406\uff09\u901a\u8fc7\u4ec0\u4e48\u65b9\u5f0f\u5b9e\u73b0\u540e\u7aefRS\u7684\u5065\u5eb7\u68c0\u67e5\uff1f","text":"<p>nginx\u8d1f\u8f7d\u5747\u8861\uff08\u53cd\u5411\u4ee3\u7406\uff09\u5305\u542b\u5185\u7f6e\u7684\u6216\u7b2c\u4e09\u65b9\u6269\u5c55\u6765\u5b9e\u73b0\u670d\u52a1\u5668\u5065\u5eb7\u68c0\u6d4b\u7684\u3002</p> <p>\u5982\u679c\u540e\u7aef\u67d0\u53f0\u670d\u52a1\u5668\u54cd\u5e94\u5931\u8d25\uff0cnginx\u4f1a\u6807\u8bb0\u8be5\u53f0\u670d\u52a1\u5668\u5931\u6548\uff0c\u5728\u7279\u5b9a\u65f6\u95f4\u5185\uff0c\u8bf7\u6c42\u4e0d\u5206\u53d1\u5230\u8be5\u53f0\u4e0a\u3002</p> <ul> <li><code>fail_timeout</code>\uff1a\u8be5\u6307\u4ee4\u5b9a\u4e49\u4e86\u591a\u957f\u65f6\u95f4\u670d\u52a1\u5668\u5c06\u88ab\u6807\u8bb0\u4e3a\u5931\u8d25\u3002\u5728<code>fail_timeout</code>\u540e\uff0c\u670d\u52a1\u5668\u8fd8\u662ffailed\uff0cnginx\u5c06\u68c0\u6d4b\u8be5\u670d\u52a1\u5668\u662f\u5426\u5b58\u6d3b\uff0c\u5982\u679c\u63a2\u6d4b\u6210\u529f\uff0c\u5c06\u6807\u8bb0\u4e3a\u6d3b\u7684\u3002</li> <li><code>max_fails</code>\uff1a\u8be5\u6307\u4ee4\u8bbe\u7f6e\u5728<code>fail_timeout</code>\u671f\u95f4\u5185\u8fde\u7eed\u7684\u5931\u8d25\u5c1d\u8bd5\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c<code>max_fails</code>\u4e3a1\u3002\u5982\u679c\u88ab\u8bbe\u7f6e\u4e3a0\uff0c\u8be5\u670d\u52a1\u5668\u7684\u5065\u5eb7\u68c0\u6d4b\u5c06\u7981\u7528\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4-18-nginx","title":"4-18 \u7b80\u8ff0Nginx\u52a8\u9759\u5206\u79bb\uff1f","text":"<p>\u4e3a\u4e86\u63d0\u9ad8\u7f51\u7ad9\u7684\u54cd\u5e94\u901f\u5ea6\uff0c\u51cf\u8f7b\u7a0b\u5e8f\u670d\u52a1\u5668\uff08Tomcat\uff0cJboss\u7b49\uff09\u7684\u8d1f\u8f7d\uff0c\u5bf9\u4e8e\u9759\u6001\u8d44\u6e90\uff0c\u5982\u56fe\u7247\u3001js\u3001css\u7b49\u6587\u4ef6\uff0c\u53ef\u4ee5\u5728\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\u4e2d\u8fdb\u884c\u7f13\u5b58\uff0c\u8fd9\u6837\u6d4f\u89c8\u5668\u5728\u8bf7\u6c42\u4e00\u4e2a\u9759\u6001\u8d44\u6e90\u65f6\uff0c\u4ee3\u7406\u670d\u52a1\u5668\u5c31\u53ef\u4ee5\u76f4\u63a5\u5904\u7406\uff0c\u800c\u4e0d\u7528\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u540e\u7aef\u670d\u52a1\u5668\u3002\u5bf9\u4e8e\u7528\u6237\u8bf7\u6c42\u7684\u52a8\u6001\u6587\u4ef6\uff0c\u5982servlet\u3001jsp\uff0c\u5219\u8f6c\u53d1\u7ed9Tomcat\uff0cJboss\u670d\u52a1\u5668\u5904\u7406\uff0c\u8fd9\u5c31\u662f\u52a8\u9759\u5206\u79bb\u3002\u5373\u52a8\u6001\u6587\u4ef6\u4e0e\u9759\u6001\u6587\u4ef6\u7684\u5206\u79bb\u3002</p>"},{"location":"chap4/3Linux_tools/#4-19-nginx","title":"4-19 \u7b80\u8ff0Nginx\u540c\u6e90\u7b56\u7565\uff1f","text":"<p>\u540c\u6e90\u7b56\u7565\u662f\u4e00\u4e2a\u5b89\u5168\u7b56\u7565\u3002\u540c\u6e90\uff0c\u6307\u7684\u662f\u534f\u8bae\uff0c\u57df\u540d\uff0c\u7aef\u53e3\u76f8\u540c\u3002\u6d4f\u89c8\u5668\u5904\u4e8e\u5b89\u5168\u65b9\u9762\u7684\u8003\u8651\uff0c\u53ea\u5141\u8bb8\u672c\u57df\u540d\u4e0b\u7684\u63a5\u53e3\u4ea4\u4e92\uff0c\u4e0d\u540c\u6e90\u7684\u5ba2\u6237\u7aef\u811a\u672c\uff0c\u5728\u6ca1\u6709\u660e\u786e\u6388\u6743\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u80fd\u8bfb\u5199\u5bf9\u65b9\u7684\u8d44\u6e90\u3002</p>"},{"location":"chap4/3Linux_tools/#4-20-nginx","title":"4-20 \u7b80\u8ff0Nginx\u8de8\u57df\u53ca\u5982\u4f55\u5b9e\u73b0\uff1f","text":"<p>\u4ece\u4e00\u4e2a\u57df\u540d\u7684\u7f51\u9875\u53bb\u8bf7\u6c42\u53e6\u4e00\u4e2a\u57df\u540d\u7684\u8d44\u6e90\uff0c\u6216\u4efb\u4f55\u534f\u8bae\u3001\u57df\u540d\u3001\u7aef\u53e3\u6709\u4e00\u5904\u4e0d\u540c\u7684\u8bf7\u6c42\uff0c\u5c31\u88ab\u5f53\u4f5c\u662f\u8de8\u57df\uff0c\u5373\u90fd\u88ab\u5f53\u6210\u4e0d\u540c\u6e90\u3002 \u901a\u5e38\u57fa\u4e8e\u5b89\u5168\u8003\u8651\uff0cNginx\u542f\u7528\u4e86\u540c\u6e90\u7b56\u7565\uff0c\u5373\u9650\u5236\u4e86\u4ece\u540c\u4e00\u4e2a\u6e90\u52a0\u8f7d\u7684\u6587\u6863\u6216\u811a\u672c\u5982\u4f55\u4e0e\u6765\u81ea\u53e6\u4e00\u4e2a\u6e90\u7684\u8d44\u6e90\u8fdb\u884c\u4ea4\u4e92\u3002\u8fd9\u662f\u4e00\u4e2a\u7528\u4e8e\u9694\u79bb\u6f5c\u5728\u6076\u610f\u6587\u4ef6\u7684\u91cd\u8981\u5b89\u5168\u673a\u5236\u3002</p> <p>Nginx\u82e5\u8981\u5b9e\u73b0\u8de8\u57df\u8bbf\u95ee\uff0c\u53ef\u901a\u8fc7JSONP\u548cCORS\u8fdb\u884c\u5b9e\u73b0\u3002</p>"},{"location":"chap4/3Linux_tools/#4-21-nginx","title":"4-21 \u7b80\u8ff0Nginx\u91cd\u5b9a\u5411\u53ca\u5176\u4f7f\u7528\u7684\u573a\u666f\uff1f","text":"<p>\u91cd\u5b9a\u5411(Redirect)\u6307\u901a\u8fc7\u5404\u79cd\u65b9\u6cd5\u5c06\u5404\u79cd\u7f51\u7edc\u8bf7\u6c42\u91cd\u65b0\u5b9a\u4e2a\u65b9\u5411\u8f6c\u5230\u5176\u5b83\u4f4d\u7f6e\uff08\u5982\uff1a\u7f51\u9875\u91cd\u5b9a\u5411\u3001\u57df\u540d\u7684\u91cd\u5b9a\u5411\u3001\u8def\u7531\u9009\u62e9\u7684\u53d8\u5316\u4e5f\u662f\u5bf9\u6570\u636e\u62a5\u6587\u7ecf\u7531\u8def\u5f84\u7684\u4e00\u79cd\u91cd\u5b9a\u5411\uff09\u3002</p> <p>URL\u91cd\u5199\u662f\u6307\u901a\u8fc7\u914d\u7f6econf\u6587\u4ef6\uff0c\u4ee5\u8ba9\u7f51\u7ad9\u7684URL\u4e2d\u8fbe\u5230\u67d0\u79cd\u72b6\u6001\u65f6\u5219\u5b9a\u5411/\u8df3\u8f6c\u5230\u67d0\u4e2a\u89c4\u5219\uff0c\u6bd4\u5982\u5e38\u89c1\u7684\u4f2a\u9759\u6001\u3001301\u91cd\u5b9a\u5411\u3001\u6d4f\u89c8\u5668\u5b9a\u5411\u7b49\u3002\u5f53\u5ba2\u6237\u7aef\u6d4f\u89c8\u67d0\u4e2a\u7f51\u5740\u65f6\uff0c\u5c06\u5176\u8bbf\u95ee\u5bfc\u5411\u5230\u53e6\u4e00\u4e2a\u7f51\u5740\u7684\u6280\u672f\u3002</p> <p>\u5176\u4e3b\u8981\u573a\u666f\u6709\u5982\u4e0b\u4e24\u4e2a\uff1a</p> <ul> <li>\u5c06\u4e00\u4e32\u5f88\u957f\u7684\u7f51\u5740\uff0c\u8f6c\u6210\u8f83\u77ed\u7684\u7f51\u5740\uff0c\u4ece\u800c\u5b9e\u73b0\u4fbf\u4e8e\u4f20\u64ad\u3001\u6613\u4e8e\u8bb0\u5fc6\u3002</li> <li>\u8c03\u6574\u6216\u66f4\u6362Web\u670d\u52a1\u5668\uff0c\u7f51\u5740\uff08\u57df\u540d\uff09\u53c8\u5fc5\u987b\u8981\u53d8\u66f4\uff08\u5982\u8bbf\u95ee\u76ee\u5f55\u3001\u8bbf\u95ee\u6269\u5c55\u540dHTML\u53d8\u4e3aPHP\u3001\u8bbf\u95ee\u57df\u540d\uff09\uff0c\u4e3a\u4e86\u80fd\u4f7f\u65e7\u7684\u8bbf\u95ee\u4f9d\u65e7\u751f\u6548\uff0c\u4ece\u800c\u5b9e\u73b0\u81ea\u52a8\u91cd\u5b9a\u5411\u5230\u65b0\u7684\u7f51\u7ad9\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4-22-nginx","title":"4-22 \u7b80\u8ff0Nginx\u5730\u5740\u91cd\u5199\u3001\u5730\u5740\u8f6c\u53d1\u3001\u53cd\u5411\u4ee3\u7406\uff1f","text":"<ul> <li>\u5730\u5740\u91cd\u5199\uff1a\u4e3a\u4e86\u5b9e\u73b0\u5730\u5740\u7684\u6807\u51c6\u5316\uff0c\u5982\u5730\u5740\u680f\u4e2d\u4e2d\u8f93\u5165 www.baidu.com. \u4e5f\u53ef\u4ee5\u8f93\u5165 www.baidu.cn\u3002\u6700\u540e\u90fd\u4f1a\u88ab\u91cd\u5199\u5230 www.baidu.com \u4e0a\u3002\u6d4f\u89c8\u5668\u7684\u5730\u5740\u680f\u4e5f\u4f1a\u663e\u793awww.baidu.com\u3002\u5373nginx\u628a\u6536\u5230\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u5185\u5bb9\u6240\u5bf9\u5e94\u7684\u670d\u52a1\u5668\u5730\u5740\u53d1\u7ed9\u5ba2\u6237\u7aef\uff0c\u8ba9\u5ba2\u6237\u7aef\u81ea\u5df1\u53bb\u83b7\u53d6\uff0cnginx\u540c\u65f6\u8fd4\u56de302\u6b63\u786e\u4fe1\u606f\u3002</li> <li>\u5730\u5740\u8f6c\u53d1\uff1a\u6307\u5728\u7f51\u7edc\u6570\u636e\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u6570\u636e\u5206\u7ec4\u5230\u8fbe\u8def\u7531\u5668\u6216\u6865\u63a5\u5668\u540e\uff0c\u8be5\u8bbe\u5907\u901a\u8fc7\u68c0\u67e5\u5206\u7ec4\u5730\u5740\u5e76\u5c06\u6570\u636e\u8f6c\u53d1\u5230\u6700\u8fd1\u7684\u5c40\u57df\u7f51\u7684\u8fc7\u7a0b\u3002</li> <li>\u53cd\u5411\u4ee3\u7406\uff1a\u5f53\u6d4f\u89c8\u5668\u8bbf\u95ee\u7f51\u7ad9\u65f6\uff0cnginx\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\u4f1a\u4ee3\u66ff\u5ba2\u6237\u7aef\u5411\u540e\u7aef\u670d\u52a1\u5668\u67e5\u627e\u6240\u9700\u7684\u5185\u5bb9\uff0c\u7136\u540enginx\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\u4f1a\u628a\u67e5\u627e\u7684\u5185\u5bb9\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4-24-nginx","title":"4-24 \u7b80\u8ff0Nginx\u5730\u5740\u91cd\u5199\u548c\u5730\u5740\u8f6c\u53d1\u7684\u5dee\u5f02\uff1f","text":"<p>\u5730\u5740\u91cd\u5199\u548c\u5730\u5740\u8f6c\u53d1\u6709\u4ee5\u4e0b\u4e0d\u540c\u70b9\uff1a</p> <ul> <li>\u5730\u5740\u91cd\u5199\u4f1a\u6539\u53d8\u6d4f\u89c8\u5668\u4e2d\u7684\u5730\u5740\uff0c\u4f7f\u4e4b\u53d8\u6210\u91cd\u5199\u6210\u6d4f\u89c8\u5668\u6700\u65b0\u7684\u5730\u5740\u3002\u800c\u5730\u5740\u8f6c\u53d1\u4e0d\u4f1a\u6539\u53d8\u6d4f\u89c8\u5668\u7684\u5730\u5740\u7684\u3002</li> <li>\u5730\u5740\u91cd\u5199\u4f1a\u4ea7\u751f\u4e24\u6b21\u8bf7\u6c42\uff0c\u800c\u5730\u5740\u8f6c\u53d1\u53ea\u4f1a\u6709\u4e00\u6b21\u8bf7\u6c42\u3002</li> <li>\u5730\u5740\u8f6c\u53d1\u4e00\u822c\u53d1\u751f\u5728\u540c\u4e00\u7ad9\u70b9\u9879\u76ee\u5185\u90e8\uff0c\u800c\u5730\u5740\u91cd\u5199\u4e14\u4e0d\u53d7\u9650\u5236\u3002</li> <li>\u5730\u5740\u8f6c\u53d1\u7684\u901f\u5ea6\u6bd4\u5730\u5740\u91cd\u5b9a\u5411\u5feb\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4-25-nginx-301302","title":"4-25 \u7b80\u8ff0Nginx 301\u548c302\u91cd\u5b9a\u5411\u53ca\u5176\u533a\u522b\uff1f","text":"<p>301\u548c302\u72b6\u6001\u7801\u90fd\u8868\u793a\u91cd\u5b9a\u5411\uff0c\u8868\u793a\u6d4f\u89c8\u5668\u5728\u62ff\u5230\u670d\u52a1\u5668\u8fd4\u56de\u7684\u8fd9\u4e2a\u72b6\u6001\u7801\u540e\u4f1a\u81ea\u52a8\u8df3\u8f6c\u5230\u4e00\u4e2a\u65b0\u7684URL\u5730\u5740\uff0c\u8fd9\u4e2a\u5730\u5740\u53ef\u4ee5\u4ece\u54cd\u5e94\u7684Location\u9996\u90e8\u4e2d\u83b7\u53d6\uff08\u5ba2\u6237\u7aef\u8f93\u5165\u7684\u5730\u5740A\u77ac\u95f4\u53d8\u6210\u4e86\u53e6\u4e00\u4e2a\u5730\u5740B\uff09\u3002</p> <p>\u5176\u4e3b\u8981\u5dee\u5f02\u4e3a\uff1a</p> <ul> <li>301\uff1a\u4ee3\u8868\u6c38\u4e45\u6027\u8f6c\u79fb(Permanently Moved)\uff1a\u65e7\u5730\u5740A\u7684\u8d44\u6e90\u5df2\u7ecf\u88ab\u6c38\u4e45\u5730\u79fb\u9664\u4e86\uff08\u8fd9\u4e2a\u8d44\u6e90\u4e0d\u53ef\u8bbf\u95ee\u4e86\uff09\uff0c\u641c\u7d22\u5f15\u64ce\u5728\u6293\u53d6\u65b0\u5185\u5bb9\u7684\u540c\u65f6\u4e5f\u5c06\u65e7\u7684\u7f51\u5740\u4ea4\u6362\u4e3a\u91cd\u5b9a\u5411\u4e4b\u540e\u7684\u7f51\u5740\uff1b</li> <li>302\uff1a\u4ee3\u8868\u6682\u65f6\u6027\u8f6c\u79fb(Temporarily Moved)\uff1a\u65e7\u5730\u5740A\u7684\u8d44\u6e90\u8fd8\u5728\uff08\u4ecd\u7136\u53ef\u4ee5\u8bbf\u95ee\uff09\uff0c\u8fd9\u4e2a\u91cd\u5b9a\u5411\u53ea\u662f\u4e34\u65f6\u5730\u4ece\u65e7\u5730\u5740A\u8df3\u8f6c\u5230\u5730\u5740B\uff0c\u641c\u7d22\u5f15\u64ce\u4f1a\u6293\u53d6\u65b0\u7684\u5185\u5bb9\u800c\u4fdd\u5b58\u65e7\u7684\u7f51\u5740\u3002</li> </ul>"},{"location":"chap4/3Linux_tools/#4-26-nginx","title":"4-26 \u7b80\u8ff0Nginx\u9ad8\u53ef\u7528\u7684\u5e38\u89c1\u65b9\u6848\uff1f","text":"<p>Keepalived + Nginx \u5b9e\u73b0Nginx\u7684\u9ad8\u53ef\u7528\uff1a\u901a\u8fc7Keepalived\u6765\u5b9e\u73b0\u540c\u4e00\u4e2a\u865a\u62dfIP\u6620\u5c04\u5230\u591a\u53f0Nginx\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u4ece\u800c\u5b9e\u73b0Nginx\u7684\u9ad8\u53ef\u7528\u6027\u3002</p> <p>Heartbeat + Nginx \u5b9e\u73b0Nginx\u7684\u9ad8\u53ef\u7528\uff1a\u901a\u8fc7Heartbeat\u7684\u5fc3\u8df3\u68c0\u6d4b\u548c\u8d44\u6e90\u63a5\u7ba1\u3001\u96c6\u7fa4\u4e2d\u670d\u52a1\u7684\u76d1\u6d4b\u3001\u5931\u6548\u5207\u6362\u7b49\u529f\u80fd\uff0c\u7ed3\u5408Nginx\u6765\u5b9e\u73b0\u9ad8\u53ef\u7528\u6027\u3002</p>"},{"location":"chap4/3Linux_tools/#4-27-sslhttps","title":"4-27 \u7b80\u8ff0SSL\u548cHTTPS\uff1f","text":"<p>SSL\uff08Secure Socket Layer\uff09\u5b89\u5168\u5957\u63a5\u5b57\u5c42\u662f\u4e00\u79cd\u6570\u5b57\u8bc1\u4e66\uff0c\u5b83\u4f7f\u7528ssl\u534f\u8bae\u5728\u6d4f\u89c8\u5668\u548cweb server\u4e4b\u95f4\u5efa\u7acb\u4e00\u6761\u5b89\u5168\u901a\u9053\uff0c\u6570\u636e\u4fe1\u606f\u5728client\u4e0eserver\u4e4b\u95f4\u7684\u5b89\u5168\u4f20\u8f93\u3002</p> <p>HTTPS\uff08Hypertext Transfer Protocol Secure\uff09\u662f\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\u548cSSL/TLS\u7684\u7ec4\u5408\uff0c\u7528\u4ee5\u63d0\u4f9b\u52a0\u5bc6\u901a\u8baf\u53ca\u5bf9\u7f51\u7edc\u670d\u52a1\u5668\u8eab\u4efd\u7684\u9274\u5b9a\u3002</p> <p>HTTPS\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3aHTTP over SSL\uff0c\u5373HTTP\u8fde\u63a5\u5efa\u7acb\u5728SSL\u5b89\u5168\u8fde\u63a5\u4e4b\u4e0a\u3002</p>"},{"location":"chap4/4Linux_db_dia/","title":"\u7b2c\u56db\u8282 IT\u8fd0\u7ef4\u9762\u8bd5\u95ee\u9898\u603b\u7ed3-\u6570\u636e\u5e93\u3001\u76d1\u63a7\u3001\u7f51\u7edc\u7ba1\u7406","text":""},{"location":"chap4/4Linux_db_dia/#1","title":"1 \u6570\u636e\u5e93","text":""},{"location":"chap4/4Linux_db_dia/#1-1-nosql","title":"1-1 \u7b80\u8ff0NoSQL\u662f\u4ec0\u4e48\uff1f","text":"<p>NoSQL\uff0c\u6307\u7684\u662f\u975e\u5173\u7cfb\u578b\u7684\u6570\u636e\u5e93\u3002NoSQL \u6709\u65f6\u4e5f\u79f0\u4f5c Not Only SQL\uff08\u610f\u5373\"\u4e0d\u4ec5\u4ec5\u662fSQL\"\uff09 \u7684\u7f29\u5199\uff0c\u5176\u663e\u8457\u7279\u70b9\u662f\u4e0d\u4f7f\u7528SQL\u4f5c\u4e3a\u67e5\u8be2\u8bed\u8a00\uff0c\u6570\u636e\u5b58\u50a8\u4e0d\u9700\u8981\u7279\u5b9a\u7684\u8868\u683c\u6a21\u5f0f\u3002</p>"},{"location":"chap4/4Linux_db_dia/#1-2-nosqlsql","title":"1-2 \u7b80\u8ff0NoSQL\uff08\u975e\u5173\u7cfb\u578b\uff09\u6570\u636e\u5e93\u548cSQL\uff08\u5173\u7cfb\u578b\uff09\u6570\u636e\u5e93\u7684\u533a\u522b\uff1f","text":"<p>NoSQL\u548cSQL\u7684\u4e3b\u8981\u533a\u522b\u6709\u5982\u4e0b\u533a\u522b\uff1a</p> <p>\u5b58\u50a8\u65b9\u5f0f\uff1a</p> <ul> <li>\u5173\u7cfb\u578b\u6570\u636e\u5e93\u662f\u8868\u683c\u5f0f\u7684\uff0c\u56e0\u6b64\u5b58\u50a8\u5728\u8868\u7684\u884c\u548c\u5217\u4e2d\u3002\u4ed6\u4eec\u4e4b\u95f4\u5f88\u5bb9\u6613\u5173\u8054\u534f\u4f5c\u5b58\u50a8\uff0c\u63d0\u53d6\u6570\u636e\u5f88\u65b9\u4fbf\u3002</li> <li>NoSQL\u6570\u636e\u5e93\u5219\u4e0e\u5176\u76f8\u53cd\uff0c\u5b83\u662f\u5927\u5757\u7684\u7ec4\u5408\u5728\u4e00\u8d77\u3002\u901a\u5e38\u5b58\u50a8\u5728\u6570\u636e\u96c6\u4e2d\uff0c\u5c31\u50cf\u6587\u6863\u3001\u952e\u503c\u5bf9\u6216\u8005\u56fe\u7ed3\u6784\u3002</li> </ul> <p>\u5b58\u50a8\u7ed3\u6784</p> <ul> <li>\u5173\u7cfb\u578b\u6570\u636e\u5e93\u5bf9\u5e94\u7684\u662f\u7ed3\u6784\u5316\u6570\u636e\uff0c\u6570\u636e\u8868\u90fd\u9884\u5148\u5b9a\u4e49\u4e86\u7ed3\u6784\uff08\u5217\u7684\u5b9a\u4e49\uff09\uff0c\u7ed3\u6784\u63cf\u8ff0\u4e86\u6570\u636e\u7684\u5f62\u5f0f\u548c\u5185\u5bb9\u3002\u9884\u5b9a\u4e49\u7ed3\u6784\u5e26\u6765\u4e86\u53ef\u9760\u6027\u548c\u7a33\u5b9a\u6027\uff0c\u4f46\u662f\u4fee\u6539\u8fd9\u4e9b\u6570\u636e\u6bd4\u8f83\u56f0\u96be\u3002</li> <li>NoSQL\u6570\u636e\u5e93\u57fa\u4e8e\u52a8\u6001\u7ed3\u6784\uff0c\u4f7f\u7528\u4e0e\u975e\u7ed3\u6784\u5316\u6570\u636e\u3002\u7531\u4e8eNoSQL\u6570\u636e\u5e93\u662f\u52a8\u6001\u7ed3\u6784\uff0c\u53ef\u4ee5\u5f88\u5bb9\u6613\u9002\u5e94\u6570\u636e\u7c7b\u578b\u548c\u7ed3\u6784\u7684\u53d8\u5316\u3002</li> </ul> <p>\u5b58\u50a8\u89c4\u8303</p> <ul> <li>\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u6570\u636e\u5b58\u50a8\u4e3a\u4e86\u66f4\u9ad8\u7684\u89c4\u8303\u6027\uff0c\u628a\u6570\u636e\u5206\u5272\u4e3a\u6700\u5c0f\u7684\u5173\u7cfb\u8868\u4ee5\u907f\u514d\u91cd\u590d\uff0c\u83b7\u5f97\u7cbe\u7b80\u7684\u7a7a\u95f4\u5229\u7528\u3002</li> <li>NoSQL\u6570\u636e\u5b58\u50a8\u5728\u5e73\u9762\u6570\u636e\u96c6\u4e2d\uff0c\u6570\u636e\u7ecf\u5e38\u53ef\u80fd\u4f1a\u91cd\u590d\u3002\u5355\u4e2a\u6570\u636e\u5e93\u5f88\u5c11\u88ab\u5206\u9694\u5f00\uff0c\u800c\u662f\u5b58\u50a8\u6210\u4e86\u4e00\u4e2a\u6574\u4f53\uff0c\u8fd9\u6837\u6574\u5757\u6570\u636e\u66f4\u52a0\u4fbf\u4e8e\u8bfb\u5199 \u3002</li> </ul> <p>\u5b58\u50a8\u6269\u5c55</p> <ul> <li>\u5173\u7cfb\u578b\u6570\u636e\u5e93\u6570\u636e\u5b58\u50a8\u5728\u5173\u7cfb\u8868\u4e2d\uff0c\u64cd\u4f5c\u7684\u6027\u80fd\u74f6\u9888\u53ef\u80fd\u6d89\u53ca\u5230\u591a\u4e2a\u8868\uff0c\u9700\u8981\u901a\u8fc7\u63d0\u5347\u8ba1\u7b97\u673a\u6027\u80fd\u6765\u514b\u670d\uff0c\u56e0\u6b64\u66f4\u591a\u662f\u91c7\u7528\u7eb5\u5411\u6269\u5c55</li> <li>NoSQL\u6570\u636e\u5e93\u662f\u6a2a\u5411\u6269\u5c55\u7684\uff0c\u5b83\u7684\u5b58\u50a8\u5929\u7136\u5c31\u662f\u5206\u5e03\u5f0f\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7\u7ed9\u8d44\u6e90\u6c60\u6dfb\u52a0\u66f4\u591a\u7684\u666e\u901a\u6570\u636e\u5e93\u670d\u52a1\u5668\u6765\u5206\u62c5\u8d1f\u8f7d\u3002</li> </ul> <p>\u67e5\u8be2\u65b9\u5f0f</p> <ul> <li>\u5173\u7cfb\u578b\u6570\u636e\u5e93\u901a\u8fc7\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00\u6765\u64cd\u4f5c\u6570\u636e\u5e93\uff08\u5373\u901a\u5e38\u8bf4\u7684SQL\uff09\u3002SQL\u652f\u6301\u6570\u636e\u5e93CURD\u64cd\u4f5c\u7684\u529f\u80fd\u975e\u5e38\u5f3a\u5927\uff0c\u662f\u4e1a\u754c\u7684\u6807\u51c6\u7528\u6cd5\u3002</li> <li>NoSQL\u67e5\u8be2\u4ee5\u5757\u4e3a\u5355\u5143\u64cd\u4f5c\u6570\u636e\uff0c\u4f7f\u7528\u7684\u662f\u975e\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00\uff08UnQl\uff09\uff0c\u5b83\u662f\u6ca1\u6709\u6807\u51c6\u7684\u3002</li> <li>\u5173\u7cfb\u578b\u6570\u636e\u5e93\u8868\u4e2d\u4e3b\u952e\u7684\u6982\u5ff5\u5bf9\u5e94NoSQL\u4e2d\u5b58\u50a8\u6587\u6863\u7684ID\u3002</li> <li>\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4f7f\u7528\u9884\u5b9a\u4e49\u4f18\u5316\u65b9\u5f0f\uff08\u6bd4\u5982\u7d22\u5f15\uff09\u6765\u52a0\u5feb\u67e5\u8be2\u64cd\u4f5c\uff0c\u800cNoSQL\u66f4\u7b80\u5355\u66f4\u7cbe\u786e\u7684\u6570\u636e\u8bbf\u95ee\u6a21\u5f0f\u3002</li> </ul> <p>\u4e8b\u52a1</p> <ul> <li>\u5173\u7cfb\u578b\u6570\u636e\u5e93\u9075\u5faaACID\u89c4\u5219\uff08\u539f\u5b50\u6027(Atomicity)\u3001\u4e00\u81f4\u6027(Consistency)\u3001\u9694\u79bb\u6027(Isolation)\u3001\u6301\u4e45\u6027(Durability)\uff09\u3002</li> <li>NoSQL\u6570\u636e\u5e93\u9075\u5faaBASE\u539f\u5219\uff08\u57fa\u672c\u53ef\u7528\uff08Basically Availble\uff09\u3001\u8f6f/\u67d4\u6027\u4e8b\u52a1\uff08Soft-state \uff09\u3001\u6700\u7ec8\u4e00\u81f4\u6027\uff08Eventual Consistency\uff09\uff09\u3002</li> <li>\u7531\u4e8e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u6570\u636e\u5f3a\u4e00\u81f4\u6027\uff0c\u6240\u4ee5\u5bf9\u4e8b\u52a1\u7684\u652f\u6301\u5f88\u597d\u3002\u5173\u7cfb\u578b\u6570\u636e\u5e93\u652f\u6301\u5bf9\u4e8b\u52a1\u539f\u5b50\u6027\u7ec6\u7c92\u5ea6\u63a7\u5236\uff0c\u5e76\u4e14\u6613\u4e8e\u56de\u6eda\u4e8b\u52a1\u3002</li> <li>NoSQL\u6570\u636e\u5e93\u662f\u5728CAP\uff08\u4e00\u81f4\u6027\u3001\u53ef\u7528\u6027\u3001\u5206\u533a\u5bb9\u5fcd\u5ea6\uff09\u4e2d\u4efb\u9009\u4e24\u9879\uff0c\u56e0\u4e3a\u57fa\u4e8e\u8282\u70b9\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u4e0d\u53ef\u80fd\u540c\u65f6\u5168\u90e8\u6ee1\u8db3\uff0c\u6240\u4ee5\u5bf9\u4e8b\u52a1\u7684\u652f\u6301\u4e0d\u662f\u5f88\u597d\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#1-3-nosqlsql","title":"1-3 \u7b80\u8ff0NoSQL\uff08\u975e\u5173\u7cfb\u578b\uff09\u6570\u636e\u5e93\u548cSQL\uff08\u5173\u7cfb\u578b\uff09\u6570\u636e\u5e93\u7684\u5404\u81ea\u4e3b\u8981\u4ee3\u8868\uff1f","text":"<ul> <li>SQL\uff1aMariaDB\u3001MySQL\u3001SQLite\u3001SQLServer\u3001Oracle\u3001PostgreSQL\u3002</li> <li>NoSQL\u4ee3\u8868\uff1aRedis\u3001MongoDB\u3001Memcache\u3001HBASE\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2mongodb","title":"2\u3001MongoDB","text":""},{"location":"chap4/4Linux_db_dia/#2-1-mongodb","title":"2-1 \u7b80\u8ff0MongoDB\u53ca\u5176\u7279\u70b9\uff1f","text":"<p>MongoDB\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u3001\u57fa\u4e8e\u5206\u5e03\u5f0f\u7684\u3001\u9762\u5411\u6587\u6863\u5b58\u50a8\u7684\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u3002\u662f\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u5f53\u4e2d\u529f\u80fd\u6700\u4e30\u5bcc\u3001\u6700\u50cf\u5173\u7cfb\u6570\u636e\u5e93\u7684\u3002\u5176\u4e3b\u8981\u7279\u70b9\u5982\u4e0b\uff1a</p> <ul> <li>\u67e5\u8be2\u4e30\u5bcc\uff1aMongoDB\u6700\u5927\u7684\u7279\u70b9\u662f\u652f\u6301\u7684\u67e5\u8be2\u8bed\u8a00\u975e\u5e38\u5f3a\u5927\uff0c\u5176\u8bed\u6cd5\u6709\u70b9\u7c7b\u4f3c\u4e8e\u9762\u5411\u5bf9\u8c61\u7684\u67e5\u8be2\u8bed\u8a00\uff0c\u51e0\u4e4e\u53ef\u4ee5\u5b9e\u73b0\u7c7b\u4f3c\u5173\u7cfb\u6570\u636e\u5e93\u5355\u8868\u67e5\u8be2\u7684\u7edd\u5927\u90e8\u5206\u529f\u80fd\uff0c\u800c\u4e14\u8fd8\u652f\u6301\u5bf9\u6570\u636e\u5efa\u7acb\u7d22\u5f15\u3002</li> <li>\u9762\u5411\u6587\u6863\uff1a\u6587\u6863\u5c31\u662f\u5b58\u50a8\u5728MongoDB\u4e2d\u7684\u4e00\u6761\u8bb0\u5f55,\u662f\u4e00\u4e2a\u7531\u952e\u503c\u5bf9\u7ec4\u6210\u7684\u6570\u636e\u7ed3\u6784\u3002</li> <li>\u6a21\u5f0f\u81ea\u7531\uff1aMongoDB\u6bcf\u4e00\u4e2aDocument\u90fd\u5305\u542b\u4e86\u5143\u6570\u636e\u4fe1\u606f\uff0c\u6bcf\u4e2a\u6587\u6863\u4e4b\u95f4\u4e0d\u5f3a\u8feb\u8981\u6c42\u4f7f\u7528\u76f8\u540c\u7684\u683c\u5f0f\uff0c\u540c\u65f6\u4ed6\u4eec\u4e5f\u652f\u6301\u5404\u79cd\u7d22\u5f15\u3002</li> <li>\u9ad8\u53ef\u7528\u6027\uff1aMongoDB\u652f\u6301\u5728\u590d\u5236\u96c6(Replica Set)\u901a\u8fc7\u5f02\u6b65\u590d\u5236\u8fbe\u5230\u6545\u969c\u8f6c\u79fb\uff0c\u81ea\u52a8\u6062\u590d\uff0c\u96c6\u7fa4\u4e2d\u4e3b\u670d\u52a1\u5668\u5d29\u6e83\u505c\u6b62\u670d\u52a1\u548c\u4e22\u5931\u6570\u636e\uff0c\u5907\u4efd\u670d\u52a1\u5668\u901a\u8fc7\u9009\u4e3e\u83b7\u5f97\u5927\u591a\u6570\u6295\u7968\u6210\u4e3a\u4e3b\u8282\u70b9\uff0c\u4ee5\u6b64\u6765\u5b9e\u73b0\u9ad8\u53ef\u7528\u3002</li> <li>\u6c34\u5e73\u62d3\u5c55\uff1aMongoDB\u652f\u6301\u5206\u7247\u6280\u672f\uff0c\u5b83\u80fd\u591f\u652f\u6301\u5e76\u884c\u5904\u7406\u548c\u6c34\u5e73\u6269\u5c55\u3002</li> <li>\u652f\u6301\u4e30\u5bcc\uff1aMongoDB\u53e6\u5916\u8fd8\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684BSON\u6570\u636e\u7c7b\u578b\uff0c\u8fd8\u6709MongoDB\u7684\u5b98\u65b9\u4e0d\u540c\u8bed\u8a00\u7684driver\u652f\u6301(C/C++\u3001C#\u3001Java\u3001Node.js\u3001Perl\u3001PHP\u3001Python\u3001Ruby\u3001Scala)\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-2-mongodb","title":"2-2 \u7b80\u8ff0MongoDB\u7684\u4f18\u52bf\u6709\u54ea\u4e9b\uff1f","text":"<ul> <li>\u9762\u5411\u6587\u6863\u7684\u5b58\u50a8\uff1a\u4ee5 JSON \u683c\u5f0f\u7684\u6587\u6863\u4fdd\u5b58\u6570\u636e\u3002</li> <li>\u4efb\u4f55\u5c5e\u6027\u90fd\u53ef\u4ee5\u5efa\u7acb\u7d22\u5f15\u3002</li> <li>\u590d\u5236\u4ee5\u53ca\u9ad8\u53ef\u6269\u5c55\u6027\u3002</li> <li>\u81ea\u52a8\u5206\u7247\u3002</li> <li>\u4e30\u5bcc\u7684\u67e5\u8be2\u529f\u80fd\u3002</li> <li>\u5feb\u901f\u7684\u5373\u65f6\u66f4\u65b0\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-3-mongodb","title":"2-3 \u7b80\u8ff0MongoDB\u9002\u5e94\u7684\u573a\u666f\u548c\u4e0d\u9002\u7528\u7684\u573a\u666f\uff1f","text":"<p>MongoDB\u5c5e\u4e8e\u5178\u578b\u7684\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u3002</p> <p>\u4e3b\u8981\u9002\u5e94\u573a\u666f</p> <ul> <li>\u7f51\u7ad9\u5b9e\u65f6\u6570\u636e\uff1aMongoDB \u975e\u5e38\u9002\u5408\u5b9e\u65f6\u7684\u63d2\u5165\uff0c\u66f4\u65b0\u4e0e\u67e5\u8be2\uff0c\u5e76\u5177\u5907\u7f51\u7ad9\u5b9e\u65f6\u6570\u636e\u5b58\u50a8\u6240\u9700\u7684\u590d\u5236\u53ca\u9ad8\u5ea6\u4f38\u7f29\u6027</li> <li>\u6570\u636e\u7f13\u5b58\uff1a\u7531\u4e8e\u6027\u80fd\u5f88\u9ad8\uff0cMongoDB \u4e5f\u9002\u5408\u4f5c\u4e3a\u4fe1\u606f\u57fa\u7840\u8bbe\u65bd\u7684\u7f13\u5b58\u5c42\u3002\u5728\u7cfb\u7edf\u91cd\u542f\u4e4b\u540e\uff0c\u7531 MongoDB \u642d\u5efa\u7684\u6301\u4e45\u5316\u7f13\u5b58\u5c42\u53ef\u4ee5\u907f\u514d\u4e0b\u5c42\u7684\u6570\u636e\u6e90\u8fc7\u8f7d\u3002</li> <li>\u9ad8\u4f38\u7f29\u6027\u573a\u666f\uff1aMongoDB \u975e\u5e38\u9002\u5408\u7531\u6570\u5341\u6216\u6570\u767e\u53f0\u670d\u52a1\u5668\u7ec4\u6210\u7684\u6570\u636e\u5e93\u3002</li> <li>\u5bf9\u8c61\u6216 JSON \u6570\u636e\u5b58\u50a8\uff1aMongoDB \u7684 BSON \u6570\u636e\u683c\u5f0f\u975e\u5e38\u9002\u5408\u6587\u6863\u5316\u683c\u5f0f\u7684\u5b58\u50a8\u53ca\u67e5\u8be2\u3002</li> </ul> <p>\u4e0d\u9002\u5e94\u573a\u666f</p> <ul> <li>\u9ad8\u5ea6\u4e8b\u52a1\u6027\u7cfb\u7edf\uff1a\u4f8b\u5982\u94f6\u884c\u6216\u4f1a\u8ba1\u7cfb\u7edf\u3002\u4f20\u7edf\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u76ee\u524d\u8fd8\u662f\u66f4\u9002\u7528\u4e8e\u9700\u8981\u5927\u91cf\u539f\u5b50\u6027\u590d\u6742\u4e8b\u52a1\u7684\u5e94\u7528\u7a0b\u5e8f\u3002</li> <li>\u4f20\u7edf\u7684\u5546\u4e1a\u667a\u80fd\u5e94\u7528\uff1a\u9488\u5bf9\u7279\u5b9a\u95ee\u9898\u7684 BI \u6570\u636e\u5e93\u4f1a\u5bf9\u4ea7\u751f\u9ad8\u5ea6\u4f18\u5316\u7684\u67e5\u8be2\u65b9\u5f0f\u3002\u5bf9\u4e8e\u6b64\u7c7b\u5e94\u7528\uff0c\u6570\u636e\u4ed3\u5e93\u53ef\u80fd\u662f\u66f4\u5408\u9002\u7684\u9009\u62e9\u3002</li> <li>\u9700\u8981\u590d\u6742 SQL \u67e5\u8be2\u7684\u573a\u666f\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-4-mongodb","title":"2-4 \u7b80\u8ff0MongoDB\u4e2d\u7684\u5e93\u3001\u96c6\u5408\u3001\u6587\u6863\uff1f","text":"<ul> <li>\u5e93\uff1aMongoDB\u53ef\u4ee5\u5efa\u7acb\u591a\u4e2a\u6570\u636e\u5e93\uff0cMongoDB\u9ed8\u8ba4\u6570\u636e\u5e93\u4e3a\"db\"\u3002MongoDB\u7684\u5355\u4e2a\u5b9e\u4f8b\u53ef\u4ee5\u5bb9\u7eb3\u591a\u4e2a\u72ec\u7acb\u7684\u6570\u636e\u5e93\uff0c\u6bcf\u4e00\u4e2a\u90fd\u6709\u81ea\u5df1\u7684\u96c6\u5408\u548c\u6743\u9650\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4e5f\u653e\u7f6e\u5728\u4e0d\u540c\u7684\u6587\u4ef6\u4e2d\u3002</li> <li>\u96c6\u5408\uff1aMongoDB\u96c6\u5408\u5c31\u662f MongoDB \u6587\u6863\u7ec4\uff0c\u7c7b\u4f3c\u4e8e RDBMS \uff08\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u7684\u8868\u683c\uff09\u3002\u96c6\u5408\u5b58\u5728\u4e8e\u6570\u636e\u5e93\u4e2d\uff0c\u96c6\u5408\u6ca1\u6709\u56fa\u5b9a\u7684\u7ed3\u6784\u3002</li> <li>\u6587\u6863\uff1aMongoDB\u7684Document\u662f\u4e00\u7ec4\u952e\u503c(key-value)\u5bf9(\u5373 BSON)\uff0c\u76f8\u5f53\u4e8e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u884c\u3002\u4e14\u4e0d\u9700\u8981\u8bbe\u7f6e\u76f8\u540c\u7684\u5b57\u6bb5\uff0c\u5e76\u4e14\u76f8\u540c\u7684\u5b57\u6bb5\u4e0d\u9700\u8981\u76f8\u540c\u7684\u6570\u636e\u7c7b\u578b\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-5-mongodb","title":"2-5 \u7b80\u8ff0MongoDB\u652f\u6301\u7684\u5e38\u89c1\u6570\u636e\u7c7b\u578b\uff1f","text":"<p>MongoDB\u652f\u6301\u4e30\u5bcc\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5e38\u89c1\u7684\u6709\uff1a</p> <ul> <li>String\uff1a\u5b57\u7b26\u4e32\u3002\u5b58\u50a8\u6570\u636e\u5e38\u7528\u7684\u6570\u636e\u7c7b\u578b\u3002</li> <li>Integer\uff1a\u6574\u578b\u6570\u503c\u3002\u7528\u4e8e\u5b58\u50a8\u6570\u503c\u3002</li> <li>Boolean\uff1a\u5e03\u5c14\u503c\u3002\u7528\u4e8e\u5b58\u50a8\u5e03\u5c14\u503c\uff08\u771f/\u5047\uff09\u3002</li> <li>Array\uff1a\u7528\u4e8e\u5c06\u6570\u7ec4\u6216\u5217\u8868\u6216\u591a\u4e2a\u503c\u5b58\u50a8\u4e3a\u4e00\u4e2a\u952e\u3002</li> <li>Date\uff1a\u65e5\u671f\u65f6\u95f4\u3002\u7528 UNIX \u65f6\u95f4\u683c\u5f0f\u6765\u5b58\u50a8\u5f53\u524d\u65e5\u671f\u6216\u65f6\u95f4\u3002</li> <li>Binary Data\uff1a\u4e8c\u8fdb\u5236\u6570\u636e\u3002\u7528\u4e8e\u5b58\u50a8\u4e8c\u8fdb\u5236\u6570\u636e\u3002</li> <li>Code\uff1a\u4ee3\u7801\u7c7b\u578b\u3002\u7528\u4e8e\u5728\u6587\u6863\u4e2d\u5b58\u50a8 JavaScript \u4ee3\u7801\u3002</li> <li>Regular expression\uff1a\u6b63\u5219\u8868\u8fbe\u5f0f\u7c7b\u578b\u3002\u7528\u4e8e\u5b58\u50a8\u6b63\u5219\u8868\u8fbe\u5f0f</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-6-mongodb","title":"2-6 \u7b80\u8ff0MongoDB\u7d22\u5f15\u53ca\u5176\u4f5c\u7528\uff1f","text":"<p>\u7d22\u5f15\u901a\u5e38\u80fd\u591f\u6781\u5927\u7684\u63d0\u9ad8\u67e5\u8be2\u7684\u6548\u7387\uff0c\u5982\u679c\u6ca1\u6709\u7d22\u5f15\uff0cMongoDB\u5728\u8bfb\u53d6\u6570\u636e\u65f6\u5fc5\u987b\u626b\u63cf\u96c6\u5408\u4e2d\u7684\u6bcf\u4e2a\u6587\u4ef6\u5e76\u9009\u53d6\u90a3\u4e9b\u7b26\u5408\u67e5\u8be2\u6761\u4ef6\u7684\u8bb0\u5f55\u3002</p> <p>\u8fd9\u79cd\u626b\u63cf\u5168\u96c6\u5408\u7684\u67e5\u8be2\u6548\u7387\u662f\u975e\u5e38\u4f4e\u7684\uff0c\u7279\u522b\u5728\u5904\u7406\u5927\u91cf\u7684\u6570\u636e\u65f6\uff0c\u67e5\u8be2\u53ef\u80fd\u8981\u82b1\u8d39\u51e0\u5341\u79d2\u751a\u81f3\u51e0\u5206\u949f\uff0c\u8fd9\u5bf9\u7f51\u7ad9\u7684\u6027\u80fd\u662f\u975e\u5e38\u81f4\u547d\u7684\u3002</p> <p>\u7d22\u5f15\u662f\u7279\u6b8a\u7684\u6570\u636e\u7ed3\u6784\uff0c\u7d22\u5f15\u5b58\u50a8\u5728\u4e00\u4e2a\u6613\u4e8e\u904d\u5386\u8bfb\u53d6\u7684\u6570\u636e\u96c6\u5408\u4e2d\uff0c\u7d22\u5f15\u662f\u5bf9\u6570\u636e\u5e93\u8868\u4e2d\u4e00\u5217\u6216\u591a\u5217\u7684\u503c\u8fdb\u884c\u6392\u5e8f\u7684\u4e00\u79cd\u7ed3\u6784\u3002</p>"},{"location":"chap4/4Linux_db_dia/#2-7-mongodb","title":"2-7 \u7b80\u8ff0MongoDB\u5e38\u89c1\u7684\u7d22\u5f15\u6709\u54ea\u4e9b\uff1f","text":"<p>MongoDB\u5e38\u89c1\u7684\u7d22\u5f15\u6709\uff1a</p> <ul> <li>\u5355\u5b57\u6bb5\u7d22\u5f15\uff08Single Field Indexes\uff09</li> <li>\u7b26\u5408\u7d22\u5f15\uff08Compound Indexes\uff09</li> <li>\u591a\u952e\u7d22\u5f15\uff08Multikey Indexes\uff09</li> <li>\u5168\u6587\u7d22\u5f15\uff08Text Indexes\uff09</li> <li>Hash\u7d22\u5f15\uff08Hash Indexes\uff09</li> <li>\u901a\u914d\u7b26\u7d22\u5f15\uff08Wildcard Indexes\uff09</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-8-mongodb","title":"2-8 \u7b80\u8ff0MongoDB\u590d\u5236\uff08\u672c\uff09\u96c6\u539f\u7406\uff1f","text":"<p>mongodb\u7684\u590d\u5236\u81f3\u5c11\u9700\u8981\u4e24\u4e2a\u8282\u70b9\u3002\u5176\u4e2d\u4e00\u4e2a\u662f\u4e3b\u8282\u70b9\uff0c\u8d1f\u8d23\u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42\uff0c\u5176\u4f59\u7684\u90fd\u662f\u4ece\u8282\u70b9\uff0c\u8d1f\u8d23\u590d\u5236\u4e3b\u8282\u70b9\u4e0a\u7684\u6570\u636e\u3002</p> <p>mongodb\u5404\u4e2a\u8282\u70b9\u5e38\u89c1\u7684\u642d\u914d\u65b9\u5f0f\u4e3a\uff1a\u4e00\u4e3b\u4e00\u4ece\u3001\u4e00\u4e3b\u591a\u4ece\u3002</p> <p>\u4e3b\u8282\u70b9\u8bb0\u5f55\u5728\u5176\u4e0a\u7684\u6240\u6709\u64cd\u4f5coplog\uff0c\u4ece\u8282\u70b9\u5b9a\u671f\u8f6e\u8be2\u4e3b\u8282\u70b9\u83b7\u53d6\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u7136\u540e\u5bf9\u81ea\u5df1\u7684\u6570\u636e\u526f\u672c\u6267\u884c\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u4ece\u800c\u4fdd\u8bc1\u4ece\u8282\u70b9\u7684\u6570\u636e\u4e0e\u4e3b\u8282\u70b9\u4e00\u81f4\u3002</p>"},{"location":"chap4/4Linux_db_dia/#2-9-mongodb","title":"2-9 \u7b80\u8ff0MongoDB\u7684\u590d\u5236\u8fc7\u7a0b\uff1f","text":"<p>Primary\u8282\u70b9\u5199\u5165\u6570\u636e\uff0cSecondary\u901a\u8fc7\u8bfb\u53d6Primary\u7684oplog\uff08\u5373Primary\u7684<code>oplog.rs</code>\u8868\uff09\u5f97\u5230\u590d\u5236\u4fe1\u606f\uff0c\u5f00\u59cb\u590d\u5236\u6570\u636e\u5e76\u4e14\u5c06\u590d\u5236\u4fe1\u606f\u5199\u5165\u5230\u81ea\u5df1\u7684oplog\u3002</p> <p>\u5982\u679c\u67d0\u4e2a\u64cd\u4f5c\u5931\u8d25\uff0c\u5219\u5907\u4efd\u8282\u70b9\u505c\u6b62\u4ece\u5f53\u524d\u6570\u636e\u6e90\u590d\u5236\u6570\u636e\u3002\u5982\u679c\u67d0\u4e2a\u5907\u4efd\u8282\u70b9\u7531\u4e8e\u67d0\u4e9b\u539f\u56e0\u6302\u6389\u4e86\uff0c\u5f53\u91cd\u65b0\u542f\u52a8\u540e\uff0c\u5c31\u4f1a\u81ea\u52a8\u4eceoplog\u7684\u6700\u540e\u4e00\u4e2a\u64cd\u4f5c\u5f00\u59cb\u540c\u6b65\u3002</p> <p>\u540c\u6b65\u5b8c\u6210\u540e\uff0c\u5c06\u4fe1\u606f\u5199\u5165\u81ea\u5df1\u7684oplog\uff0c\u7531\u4e8e\u590d\u5236\u64cd\u4f5c\u662f\u5148\u590d\u5236\u6570\u636e\uff0c\u590d\u5236\u5b8c\u6210\u540e\u518d\u5199\u5165oplog\uff0c\u6709\u53ef\u80fd\u76f8\u540c\u7684\u64cd\u4f5c\u4f1a\u540c\u6b65\u4e24\u4efd\uff0cMongoDB\u8bbe\u5b9a\u5c06oplog\u7684\u540c\u4e00\u4e2a\u64cd\u4f5c\u6267\u884c\u591a\u6b21\uff0c\u4e0e\u6267\u884c\u4e00\u6b21\u7684\u6548\u679c\u662f\u4e00\u6837\u7684\u3002</p> <p>\u5f53Primary\u8282\u70b9\u5b8c\u6210\u6570\u636e\u64cd\u4f5c\u540e\uff0cSecondary\u7684\u6570\u636e\u540c\u6b65\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>1\u3001\u68c0\u67e5\u81ea\u5df1local\u5e93\u7684<code>oplog.rs</code>\u96c6\u5408\u627e\u51fa\u6700\u8fd1\u7684\u65f6\u95f4\u6233\u3002</li> <li>2\u3001\u68c0\u67e5Primary\u8282\u70b9local\u5e93<code>oplog.rs</code>\u96c6\u5408\uff0c\u627e\u51fa\u5927\u4e8e\u6b64\u65f6\u95f4\u6233\u7684\u8bb0\u5f55\u3002</li> <li>3\u3001\u5c06\u627e\u5230\u7684\u8bb0\u5f55\u63d2\u5165\u5230\u81ea\u5df1\u7684<code>oplog.rs</code>\u96c6\u5408\u4e2d\uff0c\u5e76\u6267\u884c\u8fd9\u4e9b\u64cd\u4f5c\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-10-mongodb","title":"2-10 \u7b80\u8ff0MongoDB\u526f\u672c\u96c6\u53ca\u5176\u7279\u70b9\uff1f","text":"<p>MongoDB\u526f\u672c\u96c6\u662f\u4e00\u7ec4Mongod\u7ef4\u62a4\u76f8\u540c\u6570\u636e\u96c6\u7684\u5b9e\u4f8b\uff0c\u526f\u672c\u96c6\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u6570\u636e\u627f\u8f7d\u70b9\u548c\u591a\u4e2a\u4ef2\u88c1\u70b9\u3002</p> <p>\u5728\u627f\u8f7d\u6570\u636e\u7684\u8282\u70b9\u4e2d\uff0c\u4ec5\u6709\u4e00\u4e2a\u8282\u70b9\u88ab\u89c6\u4e3a\u4e3b\u8282\u70b9\uff0c\u5176\u4ed6\u8282\u70b9\u79f0\u4e3a\u6b21\u8282\u70b9\u3002</p> <p>\u4e3b\u8981\u7279\u70b9\uff1a</p> <ul> <li>N \u4e2a\u8282\u70b9\u7684\u96c6\u7fa4\uff0c\u4efb\u4f55\u8282\u70b9\u53ef\u4f5c\u4e3a\u4e3b\u8282\u70b9\uff0c\u7531\u9009\u4e3e\u4ea7\u751f\uff1b</li> <li>\u6700\u5c0f\u6784\u6210\u662f\uff1aprimary\uff0csecondary\uff0carbiter\uff0c\u4e00\u822c\u90e8\u7f72\u662f\uff1aprimary\uff0c2 secondary\u3002</li> <li>\u6240\u6709\u5199\u5165\u64cd\u4f5c\u90fd\u5728\u4e3b\u8282\u70b9\u4e0a\uff0c\u540c\u65f6\u5177\u6709\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\uff0c\u81ea\u52a8\u6062\u590d\uff1b</li> <li>\u6210\u5458\u6570\u5e94\u8be5\u4e3a\u5947\u6570\uff0c\u5982\u679c\u4e3a\u5076\u6570\u7684\u60c5\u51b5\u4e0b\u6dfb\u52a0arbiter\uff0carbiter\u4e0d\u4fdd\u5b58\u6570\u636e\uff0c\u53ea\u6295\u7968\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-11-mongodb","title":"2-11 \u7b80\u8ff0MongoDB\u6709\u54ea\u4e9b\u7279\u6b8a\u6210\u5458\uff1f","text":"<p>MongoDB\u4e2dSecondary\u89d2\u8272\u5b58\u5728\u4e00\u4e9b\u7279\u6b8a\u7684\u6210\u5458\u7c7b\u578b\uff1a</p> <ul> <li>Priority 0\uff08\u4f18\u5148\u7ea70\u578b\uff09\uff1a\u4e0d\u80fd\u5347\u4e3a\u4e3b\uff0c\u53ef\u4ee5\u7528\u4e8e\u591a\u6570\u636e\u4e2d\u5fc3\u573a\u666f\uff1b</li> <li>Hidden\uff08\u9690\u85cf\u578b\uff09\uff1a\u5bf9\u5ba2\u6237\u7aef\u6765\u8bf4\u662f\u4e0d\u53ef\u89c1\u7684\uff0c\u4e00\u822c\u7528\u4f5c\u5907\u4efd\u6216\u7edf\u8ba1\u62a5\u544a\u7528\uff1b</li> <li>Delayed\uff08\u5ef6\u8fdf\u578b\uff09\uff1a\u6570\u636e\u6bd4\u526f\u96c6\u665a\uff0c\u4e00\u822c\u7528\u4f5c rolling backup \u6216\u5386\u53f2\u5feb\u7167\u3002</li> <li>Vote\uff08\u6295\u7968\u578b\uff09\uff1a\u4ec5\u53c2\u4e0e\u6295\u7968\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-12-mongodb","title":"2-12 \u7b80\u8ff0MongoDB\u5206\u7247\u96c6\u7fa4\uff1f","text":"<p>MongoDB\u5206\u7247\u96c6\u7fa4\uff08Sharded Cluster\uff09\uff1a\u4e3b\u8981\u5229\u7528\u5206\u7247\u6280\u672f\uff0c\u4f7f\u6570\u636e\u5206\u6563\u5b58\u50a8\u5230\u591a\u4e2a\u5206\u7247\uff08Shard\uff09\u4e0a\uff0c\u6765\u5b9e\u73b0\u9ad8\u53ef\u6269\u5c55\u6027\u3002</p> <p>\u5206\u7247\u662f\u5c06\u6570\u636e\u6c34\u5e73\u5207\u5206\u5230\u4e0d\u540c\u7684\u7269\u7406\u8282\u70b9\u3002\u5f53\u6570\u636e\u91cf\u8d8a\u6765\u8d8a\u5927\u65f6\uff0c\u5355\u53f0\u673a\u5668\u6709\u53ef\u80fd\u65e0\u6cd5\u5b58\u50a8\u6570\u636e\u6216\u8bfb\u53d6\u5199\u5165\u541e\u5410\u91cf\u6709\u6240\u964d\u4f4e\uff0c\u5229\u7528\u5206\u7247\u6280\u672f\u53ef\u4ee5\u6dfb\u52a0\u66f4\u591a\u7684\u673a\u5668\u6765\u5e94\u5bf9\u6570\u636e\u91cf\u589e\u52a0\u4ee5\u53ca\u8bfb\u5199\u64cd\u4f5c\u7684\u8981\u6c42\u3002</p>"},{"location":"chap4/4Linux_db_dia/#2-13-mongodb","title":"2-13 \u7b80\u8ff0MongoDB\u5206\u7247\u96c6\u7fa4\u76f8\u5bf9\u526f\u672c\u96c6\u7684\u4f18\u52bf\uff1f","text":"<p>MongoDB\u5206\u7247\u96c6\u7fa4\u4e3b\u8981\u53ef\u4ee5\u89e3\u51b3\u526f\u672c\u96c6\u5982\u4e0b\u7684\u4e0d\u8db3\uff1a</p> <ul> <li>\u526f\u672c\u96c6\u6240\u6709\u7684\u5199\u5165\u64cd\u4f5c\u90fd\u4f4d\u4e8e\u4e3b\u8282\u70b9\uff1b</li> <li>\u5ef6\u8fdf\u7684\u654f\u611f\u6570\u636e\u4f1a\u5728\u4e3b\u8282\u70b9\u67e5\u8be2\uff1b</li> <li>\u5355\u4e2a\u526f\u672c\u96c6\u9650\u5236\u572812\u4e2a\u8282\u70b9\uff1b</li> <li>\u5f53\u8bf7\u6c42\u91cf\u5de8\u5927\u65f6\u4f1a\u51fa\u73b0\u5185\u5b58\u4e0d\u8db3\uff1b</li> <li>\u672c\u5730\u78c1\u76d8\u4e0d\u8db3\uff1b</li> <li>\u5782\u76f4\u6269\u5c55\u4ef7\u683c\u6602\u8d35\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-14-mongodb","title":"2-14 \u7b80\u8ff0MongoDB\u5206\u7247\u96c6\u7fa4\u7684\u4f18\u52bf\uff1f","text":"<p>MongoDB\u5206\u7247\u96c6\u7fa4\u4e3b\u8981\u6709\u5982\u4e0b\u4f18\u52bf\uff1a</p> <ul> <li>\u4f7f\u7528\u5206\u7247\u51cf\u5c11\u4e86\u6bcf\u4e2a\u5206\u7247\u9700\u8981\u5904\u7406\u7684\u8bf7\u6c42\u6570\uff1a\u901a\u8fc7\u6c34\u5e73\u6269\u5c55\uff0c\u7fa4\u96c6\u53ef\u4ee5\u63d0\u9ad8\u81ea\u5df1\u7684\u5b58\u50a8\u5bb9\u91cf\u3002\u6bd4\u5982\uff0c\u5f53\u63d2\u5165\u4e00\u6761\u6570\u636e\u65f6\uff0c\u5e94\u7528\u53ea\u9700\u8981\u8bbf\u95ee\u5b58\u50a8\u8fd9\u6761\u6570\u636e\u7684\u5206\u7247\u3002</li> <li>\u4f7f\u7528\u5206\u7247\u51cf\u5c11\u4e86\u6bcf\u4e2a\u5206\u7247\u5b58\u50a8\u7684\u6570\u636e\uff1a<ul> <li>\u5206\u7247\u7684\u4f18\u52bf\u5728\u4e8e\u63d0\u4f9b\u7c7b\u4f3c\u7ebf\u6027\u589e\u957f\u7684\u67b6\u6784\uff0c\u63d0\u9ad8\u6570\u636e\u53ef\u7528\u6027\uff0c\u63d0\u9ad8\u5927\u578b\u6570\u636e\u5e93\u67e5\u8be2\u670d\u52a1\u5668\u7684\u6027\u80fd\u3002</li> <li>\u5f53MongoDB\u5355\u70b9\u6570\u636e\u5e93\u670d\u52a1\u5668\u5b58\u50a8\u6210\u4e3a\u74f6\u9888\u3001\u5355\u70b9\u6570\u636e\u5e93\u670d\u52a1\u5668\u7684\u6027\u80fd\u6210\u4e3a\u74f6\u9888\u6216\u9700\u8981\u90e8\u7f72\u5927\u578b\u5e94\u7528\u4ee5\u5145\u5206\u5229\u7528\u5185\u5b58\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u5206\u7247\u6280\u672f\u3002</li> </ul> </li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-15-mongodb","title":"2-15 \u7b80\u8ff0MongoDB\u5206\u7247\u96c6\u7fa4\u7684\u67b6\u6784\u7ec4\u4ef6\uff1f","text":"<p>MongoDB\u67b6\u6784\u7ec4\u4ef6\u4e3b\u8981\u6709\uff1a</p> <ul> <li>Shard\uff1a\u7528\u4e8e\u5b58\u50a8\u5b9e\u9645\u7684\u6570\u636e\u5757\uff0c\u5b9e\u9645\u751f\u4ea7\u73af\u5883\u4e2d\u4e00\u4e2ashard server\u89d2\u8272\u53ef\u7531\u51e0\u53f0\u673a\u5668\u7ec4\u6210\u4e00\u4e2areplica set\u627f\u62c5\uff0c\u9632\u6b62\u4e3b\u673a\u5355\u70b9\u6545\u969c\u3002</li> <li>Config Server\uff1amongod\u5b9e\u4f8b\uff0c\u5b58\u50a8\u4e86\u6574\u4e2a ClusterMetadata\uff0c\u5176\u4e2d\u5305\u62ec chunk\u4fe1\u606f\u3002</li> <li>Query Routers\uff1a\u524d\u7aef\u8def\u7531\uff0c\u5ba2\u6237\u7aef\u7531\u6b64\u63a5\u5165\uff0c\u4e14\u8ba9\u6574\u4e2a\u96c6\u7fa4\u770b\u4e0a\u53bb\u50cf\u5355\u4e00\u6570\u636e\u5e93\uff0c\u524d\u7aef\u5e94\u7528\u53ef\u4ee5\u900f\u660e\u4f7f\u7528\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-16-mongodb","title":"2-16 \u7b80\u8ff0MongoDB\u5206\u7247\u96c6\u7fa4\u548c\u526f\u672c\u96c6\u7fa4\u7684\u533a\u522b\uff1f","text":"<p>\u526f\u672c\u96c6\u4e0d\u662f\u4e3a\u4e86\u63d0\u9ad8\u8bfb\u6027\u80fd\u5b58\u5728\u7684\uff0c\u5728\u8fdb\u884coplog\u7684\u65f6\u5019\uff0c\u8bfb\u64cd\u4f5c\u662f\u88ab\u963b\u585e\u7684\uff1b</p> <p>\u63d0\u9ad8\u8bfb\u53d6\u6027\u80fd\u5e94\u8be5\u4f7f\u7528\u5206\u7247\u548c\u7d22\u5f15\uff0c\u5b83\u7684\u5b58\u5728\u66f4\u591a\u662f\u4f5c\u4e3a\u6570\u636e\u5197\u4f59\uff0c\u5907\u4efd\u3002</p>"},{"location":"chap4/4Linux_db_dia/#2-17-mongodb","title":"2-17 \u7b80\u8ff0MongoDB\u7684\u51e0\u79cd\u5206\u7247\u7b56\u7565\u53ca\u5176\u76f8\u4e92\u4e4b\u95f4\u7684\u5dee\u5f02\uff1f","text":"<p>MongoDB\u7684\u6570\u636e\u5212\u5206\u662f\u57fa\u4e8e\u96c6\u5408\u7ea7\u522b\u4e3a\u6807\u51c6\uff0c\u901a\u8fc7shard key\u6765\u5212\u5206\u96c6\u5408\u6570\u636e\u3002\u4e3b\u8981\u5206\u7247\u7b56\u7565\u6709\u5982\u4e0b\u4e09\u79cd\uff1a</p> <ul> <li>\u8303\u56f4\u5212\u5206\uff1a\u901a\u8fc7shard key\u503c\u5c06\u6570\u636e\u96c6\u5212\u5206\u5230\u4e0d\u540c\u7684\u8303\u56f4\u5c31\u79f0\u4e3a\u57fa\u4e8e\u8303\u56f4\u5212\u5206\u3002\u5bf9\u4e8e\u6570\u503c\u578b\u7684shard key\uff1a\u53ef\u4ee5\u865a\u6784\u4e00\u6761\u4ece\u8d1f\u65e0\u7a77\u5230\u6b63\u65e0\u7a77\u7684\u76f4\u7ebf\uff08\u7406\u89e3\u4e3ax\u8f74\uff09\uff0c\u6bcf\u4e2ashard key \u503c\u90fd\u843d\u5728\u8fd9\u6761\u76f4\u7ebf\u7684\u67d0\u4e2a\u70b9\u4e0a\uff0c\u7136\u540eMongoDB\u628a\u8fd9\u6761\u7ebf\u5212\u5206\u4e3a\u8bb8\u591a\u66f4\u5c0f\u7684\u6ca1\u6709\u91cd\u590d\u7684\u8303\u56f4\u6210\u4e3a\u5757\uff08chunks\uff09\uff0c\u4e00\u4e2achunk\u5c31\u662f\u67d0\u4e9b\u6700\u5c0f\u503c\u5230\u6700\u5927\u503c\u7684\u8303\u56f4\u3002</li> <li>\u6563\u5217\u5212\u5206\uff1aMongoDB\u8ba1\u7b97\u6bcf\u4e2a\u5b57\u6bb5\u7684hash\u503c\uff0c\u7136\u540e\u7528\u8fd9\u4e9bhash\u503c\u5efa\u7acbchunks\u3002\u57fa\u4e8e\u6563\u5217\u503c\u7684\u6570\u636e\u5206\u5e03\u6709\u52a9\u4e8e\u66f4\u5747\u5300\u7684\u6570\u636e\u5206\u5e03\uff0c\u5c24\u5176\u662f\u5728shard key\u5355\u8c03\u53d8\u5316\u7684\u6570\u636e\u96c6\u4e2d\u3002\u3001</li> <li>\u81ea\u5b9a\u4e49\u6807\u7b7e\u5212\u5206\uff1aMongoDB\u652f\u6301\u901a\u8fc7\u81ea\u5b9a\u4e49\u6807\u7b7e\u6807\u8bb0\u5206\u7247\u7684\u65b9\u5f0f\u76f4\u63a5\u5e73\u8861\u6570\u636e\u5206\u5e03\u7b56\u7565\uff0c\u53ef\u4ee5\u521b\u5efa\u6807\u7b7e\u5e76\u4e14\u5c06\u5b83\u4eec\u4e0eshard key\u503c\u7684\u8303\u56f4\u8fdb\u884c\u5173\u8054\uff0c\u7136\u540e\u5206\u914d\u8fd9\u4e9b\u6807\u7b7e\u5230\u5404\u4e2a\u5206\u7247\u4e0a\uff0c\u6700\u7ec8\u5e73\u8861\u5668\u8f6c\u79fb\u5e26\u6709\u6807\u7b7e\u6807\u8bb0\u7684\u6570\u636e\u5230\u5bf9\u5e94\u7684\u5206\u7247\u4e0a\uff0c\u786e\u4fdd\u96c6\u7fa4\u603b\u662f\u6309\u6807\u7b7e\u63cf\u8ff0\u7684\u90a3\u6837\u8fdb\u884c\u6570\u636e\u5206\u5e03\u3002\u6807\u7b7e\u662f\u63a7\u5236\u5e73\u8861\u5668\u884c\u4e3a\u53ca\u96c6\u7fa4\u4e2d\u5757\u5206\u5e03\u7684\u4e3b\u8981\u65b9\u6cd5\u3002</li> </ul> <p>\u5dee\u5f02\uff1a</p> <ul> <li>\u57fa\u4e8e\u8303\u56f4\u5212\u5206\u5bf9\u4e8e\u8303\u56f4\u67e5\u8be2\u6bd4\u8f83\u9ad8\u6548\u3002\u5047\u8bbe\u5728shard key\u4e0a\u8fdb\u884c\u8303\u56f4\u67e5\u8be2\uff0c\u67e5\u8be2\u8def\u7531\u5f88\u5bb9\u6613\u80fd\u591f\u77e5\u9053\u54ea\u4e9b\u5757\u4e0e\u8fd9\u4e2a\u8303\u56f4\u91cd\u53e0\uff0c\u7136\u540e\u628a\u76f8\u5173\u67e5\u8be2\u6309\u7167\u8fd9\u4e2a\u8def\u7ebf\u53d1\u9001\u5230\u4ec5\u4ec5\u5305\u542b\u8fd9\u4e9bchunks\u7684\u5206\u7247\u3002</li> <li>\u57fa\u4e8e\u8303\u56f4\u5212\u5206\u5f88\u5bb9\u6613\u5bfc\u81f4\u6570\u636e\u4e0d\u5747\u5300\u5206\u5e03\uff0c\u8fd9\u6837\u4f1a\u524a\u5f31\u5206\u7247\u96c6\u7fa4\u7684\u529f\u80fd\u3002</li> <li>\u57fa\u4e8e\u6563\u5217\u5212\u5206\u662f\u4ee5\u727a\u7272\u9ad8\u6548\u8303\u56f4\u67e5\u8be2\u4e3a\u4ee3\u4ef7\uff0c\u5b83\u80fd\u591f\u5747\u5300\u7684\u5206\u5e03\u6570\u636e\uff0c\u6563\u5217\u503c\u80fd\u591f\u4fdd\u8bc1\u6570\u636e\u968f\u673a\u5206\u5e03\u5230\u5404\u4e2a\u5206\u7247\u4e0a\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#2-18-mongodb","title":"2-18 \u7b80\u8ff0MongoDB\u5206\u7247\u96c6\u7fa4\u91c7\u53d6\u4ec0\u4e48\u65b9\u5f0f\u786e\u4fdd\u6570\u636e\u5206\u5e03\u7684\u5e73\u8861\uff1f","text":"<p>\u65b0\u52a0\u5165\u7684\u6570\u636e\u53ca\u670d\u52a1\u5668\u90fd\u4f1a\u5bfc\u81f4\u96c6\u7fa4\u6570\u636e\u5206\u5e03\u4e0d\u5e73\u8861\uff0cMongoDB\u91c7\u7528\u4e24\u79cd\u65b9\u5f0f\u786e\u4fdd\u6570\u636e\u5206\u5e03\u7684\u5e73\u8861\uff1a</p> <ul> <li>\u62c6\u5206</li> </ul> <p>\u62c6\u5206\u662f\u4e00\u4e2a\u540e\u53f0\u8fdb\u7a0b\uff0c\u9632\u6b62\u5757\u53d8\u5f97\u592a\u5927\u3002\u5f53\u4e00\u4e2a\u5757\u589e\u957f\u5230\u6307\u5b9a\u5757\u5927\u5c0f\u7684\u65f6\u5019\uff0c\u62c6\u5206\u8fdb\u7a0b\u5c31\u4f1a\u5757\u4e00\u5206\u4e3a\u4e8c\uff0c\u6574\u4e2a\u62c6\u5206\u8fc7\u7a0b\u662f\u9ad8\u6548\u7684\u3002\u4e0d\u4f1a\u6d89\u53ca\u5230\u6570\u636e\u7684\u8fc1\u79fb\u7b49\u64cd\u4f5c\u3002</p> <ul> <li>\u5e73\u8861</li> </ul> <p>\u5e73\u8861\u5668\u662f\u4e00\u4e2a\u540e\u53f0\u8fdb\u7a0b\uff0c\u7ba1\u7406\u5757\u7684\u8fc1\u79fb\u3002\u5e73\u8861\u5668\u80fd\u591f\u8fd0\u884c\u5728\u96c6\u7fa4\u4efb\u4f55\u7684mongd\u5b9e\u4f8b\u4e0a\u3002\u5f53\u96c6\u7fa4\u4e2d\u6570\u636e\u5206\u5e03\u4e0d\u5747\u5300\u65f6\uff0c\u5e73\u8861\u5668\u5c31\u4f1a\u5c06\u67d0\u4e2a\u5206\u7247\u4e2d\u6bd4\u8f83\u591a\u7684\u5757\u8fc1\u79fb\u5230\u62e5\u6709\u5757\u8f83\u5c11\u7684\u5206\u7247\u4e2d\uff0c\u76f4\u5230\u6570\u636e\u5206\u7247\u5e73\u8861\u4e3a\u6b62\u3002</p> <p>\u5206\u7247\u91c7\u7528\u540e\u53f0\u64cd\u4f5c\u7684\u65b9\u5f0f\u7ba1\u7406\u7740\u6e90\u5206\u7247\u548c\u76ee\u6807\u5206\u7247\u4e4b\u95f4\u5757\u7684\u8fc1\u79fb\u3002\u5728\u8fc1\u79fb\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6e90\u5206\u7247\u4e2d\u7684\u5757\u4f1a\u5c06\u6240\u6709\u6587\u6863\u53d1\u9001\u5230\u76ee\u6807\u5206\u7247\u4e2d\uff0c\u7136\u540e\u76ee\u6807\u5206\u7247\u4f1a\u83b7\u53d6\u5e76\u5e94\u7528\u8fd9\u4e9b\u53d8\u5316\u3002\u6700\u540e\uff0c\u66f4\u65b0\u914d\u7f6e\u670d\u52a1\u5668\u4e0a\u5173\u4e8e\u5757\u4f4d\u7f6e\u5143\u6570\u636e\u3002</p>"},{"location":"chap4/4Linux_db_dia/#2-19-mongodb","title":"2-19 \u7b80\u8ff0MongoDB\u5907\u4efd\u53ca\u6062\u590d\u65b9\u5f0f\uff1f","text":"<p>mongodb\u5907\u4efd\u6062\u590d\u65b9\u5f0f\u901a\u5e38\u6709\u4ee5\u4e0b\u4e09\u79cd\uff1a</p> <p>\u6587\u4ef6\u5feb\u7167\u65b9\u5f0f\uff1a\u6b64\u65b9\u5f0f\u76f8\u5bf9\u7b80\u5355\uff0c\u9700\u8981\u7cfb\u7edf\u6587\u4ef6\u652f\u6301\u5feb\u7167\u548c<code>mongod</code>\u5fc5\u987b\u542f\u7528<code>journal</code>\u3002</p> <p>\u53ef\u4ee5\u5728\u4efb\u4f55\u65f6\u523b\u521b\u5efa\u5feb\u7167\u3002\u6062\u590d\u65f6\uff0c\u786e\u4fdd\u6ca1\u6709\u8fd0\u884cmongod\uff0c\u6267\u884c\u5feb\u7167\u6062\u590d\u64cd\u4f5c\u547d\u4ee4\uff0c\u7136\u540e\u542f\u52a8mongod\u8fdb\u7a0b\uff0cmongod\u5c06\u91cd\u653ejournal\u65e5\u5fd7\u3002</p> <p>\u590d\u5236\u6570\u636e\u6587\u4ef6\u65b9\u5f0f\uff1a</p> <p>\u76f4\u63a5\u62f7\u8d1d\u6570\u636e\u76ee\u5f55\u4e0b\u7684\u4e00\u5207\u6587\u4ef6\uff0c\u4f46\u662f\u5728\u62f7\u8d1d\u8fc7\u7a0b\u4e2d\u5fc5\u987b\u963b\u6b62\u6570\u636e\u6587\u4ef6\u53d1\u751f\u66f4\u6539\u3002\u56e0\u6b64\u9700\u8981\u5bf9\u6570\u636e\u5e93\u52a0\u9501\uff0c\u4ee5\u9632\u6b62\u6570\u636e\u5199\u5165\u3002\u6062\u590d\u65f6\uff0c\u786e\u4fddmongod\u6ca1\u6709\u8fd0\u884c\uff0c\u6e05\u7a7a\u6570\u636e\u76ee\u5f55\uff0c\u5c06\u5907\u4efd\u7684\u6570\u636e\u62f7\u8d1d\u5230\u6570\u636e\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u542f\u52a8<code>mongod</code>\u3002</p> <p>\u4f7f\u7528mongodump\u548cmongorestore\u65b9\u5f0f\uff1a</p> <p>\u5728Mongodb\u4e2d\u6211\u4eec\u4f7f\u7528mongodump\u547d\u4ee4\u6765\u5907\u4efdMongoDB\u6570\u636e\u3002\u8be5\u547d\u4ee4\u53ef\u4ee5\u5bfc\u51fa\u6240\u6709\u6570\u636e\u5230\u6307\u5b9a\u76ee\u5f55\u4e2d\u3002\u6062\u590d\u65f6\uff0c\u4f7f\u7528mongorestore\u547d\u4ee4\u6765\u6062\u590dMongoDB\u6570\u636e\u3002\u8be5\u547d\u4ee4\u53ef\u4ee5\u4ece\u6307\u5b9a\u76ee\u5f55\u6062\u590d\u76f8\u5e94\u6570\u636e\u3002</p>"},{"location":"chap4/4Linux_db_dia/#2-20-mongodb","title":"2-20 \u7b80\u8ff0MongoDB\u7684\u805a\u5408\u64cd\u4f5c\uff1f","text":"<p>\u805a\u5408\u64cd\u4f5c\u80fd\u591f\u5904\u7406\u6570\u636e\u8bb0\u5f55\u5e76\u8fd4\u56de\u8ba1\u7b97\u7ed3\u679c\u3002\u805a\u5408\u64cd\u4f5c\u80fd\u5c06\u591a\u4e2a\u6587\u6863\u4e2d\u7684\u503c\u7ec4\u5408\u8d77\u6765\uff0c\u5bf9\u6210\u7ec4\u6570\u636e\u6267\u884c\u5404\u79cd\u64cd\u4f5c\uff0c\u8fd4\u56de\u5355\u4e00\u7684\u7ed3\u679c\u3002\u5b83\u76f8\u5f53\u4e8e SQL \u4e2d\u7684 <code>count(*)</code> \u7ec4\u5408 group by\u3002\u5bf9\u4e8e MongoDB \u4e2d\u7684\u805a\u5408\u64cd\u4f5c\uff0c\u5e94\u8be5\u4f7f\u7528aggregate()\u65b9\u6cd5\u3002</p>"},{"location":"chap4/4Linux_db_dia/#2-21-mongodbgridfs","title":"2-21 \u7b80\u8ff0MongoDB\u4e2d\u7684GridFS\u673a\u5236\uff1f","text":"<p>GridFS\u662f\u4e00\u79cd\u5c06\u5927\u578b\u6587\u4ef6\u5b58\u50a8\u5728MongoDB\u4e2d\u7684\u6587\u4ef6\u89c4\u8303\u3002\u4f7f\u7528GridFS\u53ef\u4ee5\u5c06\u5927\u6587\u4ef6\u5206\u9694\u6210\u591a\u4e2a\u5c0f\u6587\u6863\u5b58\u653e\uff0c\u8fd9\u6837\u6211\u4eec\u80fd\u591f\u6709\u6548\u7684\u4fdd\u5b58\u5927\u6587\u6863\uff0c\u800c\u4e14\u89e3\u51b3\u4e86BSON\u5bf9\u8c61\u6709\u9650\u5236\u7684\u95ee\u9898\u3002</p>"},{"location":"chap4/4Linux_db_dia/#2-22-mongodb","title":"2-22 \u7b80\u8ff0MongoDB\u9488\u5bf9\u67e5\u8be2\u4f18\u5316\u7684\u63aa\u65bd\uff1f","text":"<p>MongoDB\u67e5\u8be2\u4f18\u5316\u5927\u81f4\u53ef\u80fd\u4ece\u5982\u4e0b\u6b65\u9aa4\u7740\u624b\uff1a</p> <ul> <li>\u7b2c\u4e00\u6b65\uff1a\u627e\u51fa\u6162\u901f\u67e5\u8be2</li> </ul> <p>\u5982\u4e0b\u65b9\u5f0f\u5f00\u542f\u5185\u7f6e\u7684\u67e5\u8be2\u5206\u6790\u5668,\u8bb0\u5f55\u8bfb\u5199\u64cd\u4f5c\u6548\u7387\uff1a</p> <p><code>db.setProfilingLevel(n,{m})</code>, n\u7684\u53d6\u503c\u53ef\u90090,1,2\uff1b</p> <p>\u67e5\u8be2\u76d1\u63a7\u7ed3\u679c\uff1a\u76d1\u63a7\u7ed3\u679c\u4fdd\u5b58\u5728\u4e00\u4e2a\u7279\u6b8a\u7684\u96c6\u5408<code>system.profile</code>\u91cc\u3002</p> <ul> <li>0\uff1a\u9ed8\u8ba4\u503c\uff0c\u8868\u793a\u4e0d\u8bb0\u5f55\uff1b</li> <li>1\uff1a\u8868\u793a\u8bb0\u5f55\u6162\u901f\u64cd\u4f5c\uff0c\u5982\u679c\u503c\u4e3a1\uff0cm\u5fc5\u987b\u8d4b\u503c\u5355\u4f4d\u4e3ams\uff0c\u7528\u4e8e\u5b9a\u4e49\u6162\u901f\u67e5\u8be2\u65f6\u95f4\u7684\u9608\u503c\uff1b</li> <li>2\uff1a\u8868\u793a\u8bb0\u5f55\u6240\u6709\u7684\u8bfb\u5199\u64cd\u4f5c\u3002</li> </ul> <p>\u7b2c\u4e8c\u6b65\uff1a\u5206\u6790\u6162\u901f\u67e5\u8be2</p> <p>\u627e\u51fa\u6162\u901f\u67e5\u8be2\u7684\u539f\u56e0\uff0c\u901a\u5e38\u53ef\u80fd\u7684\u539f\u56e0\u6709\uff1a\u5e94\u7528\u7a0b\u5e8f\u8bbe\u8ba1\u4e0d\u5408\u7406\u3001\u4e0d\u6b63\u786e\u7684\u6570\u636e\u6a21\u578b\u3001\u786c\u4ef6\u914d\u7f6e\u95ee\u9898\u3001\u7f3a\u5c11\u7d22\u5f15\u7b49</p> <p>\u7b2c\u4e09\u90e8\uff1a\u6839\u636e\u4e0d\u540c\u7684\u5206\u6790\u7ed3\u679c\u8fdb\u884c\u4f18\u5316\uff0c\u5982\u5efa\u7acb\u7d22\u5f15\u3002</p>"},{"location":"chap4/4Linux_db_dia/#2-23-mongodbfsync","title":"2-23 \u7b80\u8ff0MongoDB\u7684\u66f4\u65b0\u64cd\u4f5c\u662f\u5426\u4f1a\u7acb\u523bfsync\u5230\u78c1\u76d8\uff1f","text":"<p>\u4e0d\u4f1a\uff0c\u78c1\u76d8\u5199\u64cd\u4f5c\u9ed8\u8ba4\u662f\u5ef6\u65f6\u6267\u884c\u7684\uff0c\u5199\u64cd\u4f5c\u53ef\u80fd\u5728\u4e24\u4e09\u79d2\uff08\u9ed8\u8ba4\u572860\u79d2\u5185\uff09\u540e\u5230\u8fbe\u78c1\u76d8\uff0c\u53ef\u901a\u8fc7syncPeriodSecs\u53c2\u6570\u8fdb\u884c\u914d\u7f6e\u3002</p>"},{"location":"chap4/4Linux_db_dia/#3mysql","title":"3\u3001MySQL","text":""},{"location":"chap4/4Linux_db_dia/#3-1-mysql","title":"3-1 \u7b80\u8ff0MySQL\u7d22\u5f15\u53ca\u5176\u4f5c\u7528\uff1f","text":"<p>\u662f\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u4e2d\u4e00\u4e2a\u6392\u5e8f\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6839\u636e\u4e0d\u540c\u7684\u5b58\u50a8\u5f15\u64ce\u7d22\u5f15\u5206\u4e3aHash\u7d22\u5f15\u3001B+\u6811\u7d22\u5f15\u7b49\u3002\u5e38\u89c1\u7684InnoDB\u5b58\u50a8\u5f15\u64ce\u7684\u9ed8\u8ba4\u7d22\u5f15\u5b9e\u73b0\u4e3a\uff1a<code>B+\u6811\u7d22\u5f15</code>\u3002</p> <p>\u7d22\u5f15\u53ef\u4ee5\u534f\u52a9\u5feb\u901f\u67e5\u8be2\u3001\u66f4\u65b0\u6570\u636e\u5e93\u8868\u4e2d\u6570\u636e\u3002</p>"},{"location":"chap4/4Linux_db_dia/#3-2-mysql","title":"3-2 \u7b80\u8ff0MySQL\u4e2d\u4ec0\u4e48\u662f\u4e8b\u52a1\uff1f","text":"<p>\u4e8b\u52a1\u662f\u4e00\u7cfb\u5217\u7684\u64cd\u4f5c\uff0c\u9700\u8981\u8981\u7b26\u5408ACID\u7279\u6027\uff0c\u5373\uff1a\u4e8b\u52a1\u4e2d\u7684\u64cd\u4f5c\u8981\u4e48\u5168\u90e8\u6210\u529f\uff0c\u8981\u4e48\u5168\u90e8\u5931\u8d25\u3002</p>"},{"location":"chap4/4Linux_db_dia/#3-3-mysql","title":"3-3 \u7b80\u8ff0MySQL\u4e8b\u52a1\u4e4b\u95f4\u7684\u9694\u79bb\uff1f","text":"<p>MySQL\u4e8b\u52a1\u652f\u6301\u5982\u4e0b\u56db\u79cd\u9694\u79bb\uff1a</p> <ul> <li>\u672a\u63d0\u4ea4\u8bfb(Read Uncommitted)\uff1a\u5141\u8bb8\u810f\u8bfb\uff0c\u5176\u4ed6\u4e8b\u52a1\u53ea\u8981\u4fee\u6539\u4e86\u6570\u636e\uff0c\u5373\u4f7f\u672a\u63d0\u4ea4\uff0c\u672c\u4e8b\u52a1\u4e5f\u80fd\u770b\u5230\u4fee\u6539\u540e\u7684\u6570\u636e\u503c\u3002\u4e5f\u5c31\u662f\u53ef\u80fd\u8bfb\u53d6\u5230\u5176\u4ed6\u4f1a\u8bdd\u4e2d\u672a\u63d0\u4ea4\u4e8b\u52a1\u4fee\u6539\u7684\u6570\u636e\u3002</li> <li>\u63d0\u4ea4\u8bfb(Read Committed)\uff1a\u53ea\u80fd\u8bfb\u53d6\u5230\u5df2\u7ecf\u63d0\u4ea4\u7684\u6570\u636e\u3002Oracle\u7b49\u591a\u6570\u6570\u636e\u5e93\u9ed8\u8ba4\u90fd\u662f\u8be5\u7ea7\u522b (\u4e0d\u91cd\u590d\u8bfb)\u3002</li> <li>\u53ef\u91cd\u590d\u8bfb(Repeated Read)\uff1a\u53ef\u91cd\u590d\u8bfb\u3002\u65e0\u8bba\u5176\u4ed6\u4e8b\u52a1\u662f\u5426\u4fee\u6539\u5e76\u63d0\u4ea4\u4e86\u6570\u636e\uff0c\u5728\u8fd9\u4e2a\u4e8b\u52a1\u4e2d\u770b\u5230\u7684\u6570\u636e\u503c\u59cb\u7ec8\u4e0d\u53d7\u5176\u4ed6\u4e8b\u52a1\u5f71\u54cd\u3002</li> <li>\u4e32\u884c\u8bfb(Serializable)\uff1a\u5b8c\u5168\u4e32\u884c\u5316\u7684\u8bfb\uff0c\u6bcf\u6b21\u8bfb\u90fd\u9700\u8981\u83b7\u5f97\u8868\u7ea7\u5171\u4eab\u9501\uff0c\u8bfb\u5199\u76f8\u4e92\u90fd\u4f1a\u963b\u585e\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#3-4-mysql","title":"3-4 \u7b80\u8ff0MySQL\u9501\u53ca\u5176\u4f5c\u7528\uff1f","text":"<p>\u9501\u673a\u5236\u662f\u4e3a\u4e86\u907f\u514d\uff0c\u5728\u6570\u636e\u5e93\u6709\u5e76\u53d1\u4e8b\u52a1\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751f\u6570\u636e\u7684\u4e0d\u4e00\u81f4\u800c\u8bde\u751f\u7684\u7684\u4e00\u4e2a\u673a\u5236\u3002\u9501\u4ece\u7c7b\u522b\u4e0a\u5206\u4e3a\uff1a</p> <ul> <li>\u5171\u4eab\u9501\uff1a\u53c8\u53eb\u505a\u8bfb\u9501\uff0c\u5f53\u7528\u6237\u8981\u8fdb\u884c\u6570\u636e\u7684\u8bfb\u53d6\u65f6\uff0c\u5bf9\u6570\u636e\u52a0\u4e0a\u5171\u4eab\u9501\uff0c\u5171\u4eab\u9501\u53ef\u4ee5\u540c\u65f6\u52a0\u4e0a\u591a\u4e2a\u3002</li> <li>\u6392\u4ed6\u9501\uff1a\u53c8\u53eb\u505a\u5199\u9501\uff0c\u5f53\u7528\u6237\u8981\u8fdb\u884c\u6570\u636e\u7684\u5199\u5165\u65f6\uff0c\u5bf9\u6570\u636e\u52a0\u4e0a\u6392\u4ed6\u9501\uff0c\u6392\u4ed6\u9501\u53ea\u53ef\u4ee5\u52a0\u4e00\u4e2a\uff0c\u4ed6\u548c\u5176\u4ed6\u7684\u6392\u4ed6\u9501,\u5171\u4eab\u9501\u90fd\u76f8\u65a5\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#3-5-mysql","title":"3-5 \u7b80\u8ff0MySQL\u8868\u4e2d\u4e3a\u4ec0\u4e48\u5efa\u8bae\u6dfb\u52a0\u4e3b\u952e\uff1f","text":"<p>\u4e3b\u952e\u662f\u6570\u636e\u5e93\u786e\u4fdd\u6570\u636e\u884c\u5728\u6574\u5f20\u8868\u552f\u4e00\u6027\u7684\u4fdd\u969c\uff0c\u5373\u4f7f\u6570\u636e\u5e93\u4e2d\u8868\u6ca1\u6709\u4e3b\u952e\uff0c\u4e5f\u5efa\u8bae\u6dfb\u52a0\u4e00\u4e2a\u81ea\u589e\u957f\u7684ID\u5217\u4f5c\u4e3a\u4e3b\u952e\uff0c\u8bbe\u5b9a\u4e86\u4e3b\u952e\u4e4b\u540e\uff0c\u5728\u540e\u7eed\u7684\u5220\u6539\u67e5\u7684\u65f6\u5019\u53ef\u80fd\u66f4\u52a0\u5feb\u901f\u4ee5\u53ca\u786e\u4fdd\u64cd\u4f5c\u6570\u636e\u8303\u56f4\u5b89\u5168\u3002</p>"},{"location":"chap4/4Linux_db_dia/#3-6-mysql","title":"3-6 \u7b80\u8ff0MySQL\u6240\u652f\u6301\u7684\u5b58\u50a8\u5f15\u64ce\uff1f","text":"<p>MySQL\u652f\u6301\u591a\u79cd\u5b58\u50a8\u5f15\u64ce\uff0c\u5e38\u89c1\u7684\u6709InnoDB\u3001MyISAM\u3001Memory\u3001Archive\u7b49\u3002\u901a\u5e38\u4f7f\u7528InnoDB\u5f15\u64ce\u90fd\u662f\u6700\u5408\u9002\u7684\uff0cInnoDB\u4e5f\u662fMySQL\u7684\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\u3002</p>"},{"location":"chap4/4Linux_db_dia/#3-7-mysql-innodbmyisam","title":"3-7 \u7b80\u8ff0MySQL InnoDB\u5f15\u64ce\u548cMyISAM\u5f15\u64ce\u7684\u5dee\u5f02\uff1f","text":"<ul> <li>InnoDB\u652f\u6301\u4e8b\u7269\uff0c\u800cMyISAM\u4e0d\u652f\u6301\u4e8b\u7269\u3002</li> <li>InnoDB\u652f\u6301\u884c\u7ea7\u9501\uff0c\u800cMyISAM\u652f\u6301\u8868\u7ea7\u9501\u3002</li> <li>InnoDB\u652f\u6301MVCC, \u800cMyISAM\u4e0d\u652f\u6301\u3002</li> <li>InnoDB\u652f\u6301\u5916\u952e\uff0c\u800cMyISAM\u4e0d\u652f\u6301\u3002</li> <li>InnoDB\u4e0d\u652f\u6301\u5168\u6587\u7d22\u5f15\uff0c\u800cMyISAM\u652f\u6301\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#3-8-mysql","title":"3-8 \u7b80\u8ff0MySQL\u4e3b\u4ece\u590d\u5236\u8fc7\u7a0b\uff1f","text":"<ul> <li>1\u3001Slave\u4e0a\u9762\u7684IO\u7ebf\u7a0b\u8fde\u63a5\u4e0aMaster\uff0c\u5e76\u8bf7\u6c42\u4ece\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6\u7684\u6307\u5b9a\u4f4d\u7f6e\uff08\u6216\u8005\u4ece\u6700\u5f00\u59cb\u7684\u65e5\u5fd7\uff09\u4e4b\u540e\u7684\u65e5\u5fd7\u5185\u5bb9\uff1b</li> <li>2\u3001Master\u63a5\u6536\u5230\u6765\u81eaSlave\u7684IO\u7ebf\u7a0b\u7684\u8bf7\u6c42\u540e\uff0c\u901a\u8fc7\u8d1f\u8d23\u590d\u5236\u7684IO\u7ebf\u7a0b\u6839\u636e\u8bf7\u6c42\u4fe1\u606f\u8bfb\u53d6\u6307\u5b9a\u65e5\u5fd7\u6307\u5b9a\u4f4d\u7f6e\u4e4b\u540e\u7684\u65e5\u5fd7\u4fe1\u606f\uff0c\u8fd4\u56de\u7ed9Slave\u7aef\u7684IO\u7ebf\u7a0b\u3002\u8fd4\u56de\u4fe1\u606f\u4e2d\u9664\u4e86\u65e5\u5fd7\u6240\u5305\u542b\u7684\u4fe1\u606f\u4e4b\u5916\uff0c\u8fd8\u5305\u62ec\u672c\u6b21\u8fd4\u56de\u7684\u4fe1\u606f\u5728Master\u7aef<code>binary log</code>\u6587\u4ef6\u7684\u540d\u79f0\u4ee5\u53ca\u5728<code>Binary log</code>\u4e2d\u7684\u4f4d\u7f6e\uff1b</li> <li>3\u3001Slave\u7684IO\u7ebf\u7a0b\u6536\u5230\u4fe1\u606f\u540e\uff0c\u5c06\u63a5\u6536\u5230\u7684\u65e5\u5fd7\u5185\u5bb9\u4f9d\u6b21\u5199\u5165\u5230Slave\u7aef\u7684RelayLog\u6587\u4ef6\uff08<code>mysql-relay-lin.xxxxx</code>\uff09\u7684\u6700\u672b\u7aef\uff0c\u5e76\u5c06\u8bfb\u53d6\u5230\u7684Master\u7aef\u7684<code>bin-log</code>\u7684\u6587\u4ef6\u540d\u548c\u4f4d\u7f6e\u8bb0\u5f55\u5230master-info\u6587\u4ef6\u4e2d\uff0c\u4ee5\u4fbf\u5728\u4e0b\u4e00\u6b21\u8bfb\u53d6\u7684\u65f6\u5019\u80fd\u591f\u660e\u786e\u77e5\u9053\u4ece\u4ec0\u4e48\u4f4d\u7f6e\u5f00\u59cb\u8bfb\u53d6\u65e5\u5fd7\uff1b</li> <li>4\u3001Slave\u7684SQL\u7ebf\u7a0b\u68c0\u6d4b\u5230Relay Log\u4e2d\u65b0\u589e\u52a0\u4e86\u5185\u5bb9\u540e\uff0c\u4f1a\u9a6c\u4e0a\u89e3\u6790\u8be5Log\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u6210\u4e3a\u5728Master\u7aef\u771f\u5b9e\u6267\u884c\u65f6\u5019\u7684\u90a3\u4e9b\u53ef\u6267\u884c\u7684\u67e5\u8be2\u6216\u64cd\u4f5c\u8bed\u53e5\uff0c\u5e76\u5728\u81ea\u8eab\u6267\u884c\u90a3\u4e9b\u67e5\u8be2\u6216\u64cd\u4f5c\u8bed\u53e5\uff0c\u8fd9\u6837\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u5728master\u7aef\u548cSlave\u7aef\u6267\u884c\u4e86\u540c\u6837\u7684\u67e5\u8be2\u6216\u64cd\u4f5c\u8bed\u53e5\uff0c\u6240\u4ee5\u4e24\u7aef\u7684\u6570\u636e\u662f\u5b8c\u5168\u4e00\u6837\u7684\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#3-9-mysql","title":"3-9 \u7b80\u8ff0MySQL\u5e38\u89c1\u7684\u8bfb\u5199\u5206\u79bb\u65b9\u6848\uff1f","text":"<p>MySQL+Amoeba\u8bfb\u5199\u5206\u79bb\u65b9\u6848\uff1aAmoeba(\u53d8\u5f62\u866b)\u9879\u76ee\uff0c\u8fd9\u4e2a\u5de5\u5177\u81f4\u529b\u4e8eMySQL\u7684\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u524d\u7aef\u4ee3\u7406\u5c42\uff0c\u5b83\u4e3b\u8981\u5728\u5e94\u7528\u5c42\u8bbf\u95eeMySQL\u7684\u65f6\u5019\u5145\u5f53SQL\u8def\u7531\u529f\u80fd\u3002</p> <p>\u5177\u6709\u8d1f\u8f7d\u5747\u8861\u3001\u9ad8\u53ef\u7528\u6027\u3001SQL \u8fc7\u6ee4\u3001\u8bfb\u5199\u5206\u79bb\u3001\u53ef\u8def\u7531\u76f8\u5173\u7684\u5230\u76ee\u6807\u6570\u636e\u5e93\u3001\u53ef\u5e76\u53d1\u8bf7\u6c42\u591a\u53f0\u6570\u636e\u5e93\u5408\u5e76\u7ed3\u679c\u3002\u901a\u8fc7Amoeba\u4f60\u80fd\u591f\u5b8c\u6210\u591a\u6570\u636e\u6e90\u7684\u9ad8\u53ef\u7528\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u6570\u636e\u5207\u7247\u3001\u8bfb\u5199\u5206\u79bb\u7684\u529f\u80fd\u3002</p> <p>MySQL+MMM\u8bfb\u5199\u5206\u79bb\u65b9\u6848\uff1aMMM\u5373Multi-Master Replication Manager for MySQL\uff0cmysql\u591a\u4e3b\u590d\u5236\u7ba1\u7406\u5668\u662f\u5173\u4e8emysql\u4e3b\u4e3b\u590d\u5236\u914d\u7f6e\u7684\u76d1\u63a7\u3001\u6545\u969c\u8f6c\u79fb\u548c\u7ba1\u7406\u7684\u4e00\u5957\u53ef\u4f38\u7f29\u7684\u811a\u672c\u5957\u4ef6(\u5728\u4efb\u4f55\u65f6\u5019\u53ea\u6709\u4e00\u4e2a\u8282\u70b9\u53ef\u4ee5\u88ab\u5199\u5165)\u3002MMM\u4e5f\u80fd\u5bf9\u4ece\u670d\u52a1\u5668\u8fdb\u884c\u8bfb\u8d1f\u8f7d\u5747\u8861\uff0c\u901a\u8fc7MMM\u65b9\u6848\u80fd\u5b9e\u73b0\u670d\u52a1\u5668\u7684\u6545\u969c\u8f6c\u79fb\uff0c\u4ece\u800c\u5b9e\u73b0mysql\u7684\u9ad8\u53ef\u7528\u3002MMM\u4e0d\u4ec5\u80fd\u63d0\u4f9b\u6d6e\u52a8IP\u7684\u529f\u80fd\uff0c\u5982\u679c\u5f53\u524d\u7684\u4e3b\u670d\u52a1\u5668\u6302\u6389\u540e\uff0c\u4f1a\u5c06\u4f60\u540e\u7aef\u7684\u4ece\u670d\u52a1\u5668\u81ea\u52a8\u8f6c\u5411\u65b0\u7684\u4e3b\u670d\u52a1\u5668\u8fdb\u884c\u540c\u6b65\u590d\u5236\uff0c\u4e0d\u7528\u624b\u5de5\u66f4\u6539\u540c\u6b65\u914d\u7f6e\u3002</p>"},{"location":"chap4/4Linux_db_dia/#3-10-mysql","title":"3-10 \u7b80\u8ff0MySQL\u5e38\u89c1\u7684\u9ad8\u53ef\u7528\u65b9\u6848\uff1f","text":"<ul> <li>MySQL\u4e3b\u4ece\u590d\u5236\uff1aMysql\u5185\u5efa\u7684\u590d\u5236\u529f\u80fd\u662f\u6784\u5efa\u5927\u578b\uff0c\u9ad8\u6027\u80fd\u5e94\u7528\u7a0b\u5e8f\u7684\u57fa\u7840\u3002\u5c06Mysql\u7684\u6570\u636e\u5206\u5e03\u5728\u591a\u4e2a\u8282\u70b9\uff08slaves\uff09\u4e4b\u4e0a\uff0c\u590d\u5236\u8fc7\u7a0b\u4e2d\u4e00\u4e2a\u670d\u52a1\u5668\u5145\u5f53\u4e3b\u670d\u52a1\u5668\uff0c\u800c\u4e00\u4e2a\u6216\u591a\u4e2a\u5176\u5b83\u670d\u52a1\u5668\u5145\u5f53\u4ece\u670d\u52a1\u5668\u3002\u4e3b\u670d\u52a1\u5668\u5c06\u66f4\u65b0\u5199\u5165\u4e8c\u8fdb\u5236\u65e5\u5fd7\u6587\u4ef6\uff0c\u5e76\u7ef4\u62a4\u6587\u4ef6\u7684\u4e00\u4e2a\u7d22\u5f15\u4ee5\u8ddf\u8e2a\u65e5\u5fd7\u5faa\u73af\u3002\u8fd9\u4e9b\u65e5\u5fd7\u53ef\u4ee5\u8bb0\u5f55\u53d1\u9001\u5230\u4ece\u670d\u52a1\u5668\u7684\u66f4\u65b0\u3002</li> <li>MySQL\u53cc\u4e3b\uff1a\u53c2\u8003MySQL\u4e3b\u4ece\u590d\u5236\u3002</li> <li>MySQL\u53cc\u4e3b\u591a\u4ece\uff1a\u53c2\u8003MySQL\u4e3b\u4ece\u590d\u5236\u3002\u3001</li> <li>MySQL\u590d\u5236+Keepalived\u9ad8\u53ef\u7528\uff1aMySQL\u81ea\u8eab\u7684\u590d\u5236\uff0c\u5bf9\u5916\u57fa\u4e8eKeepalived\u6280\u672f\uff0c\u66b4\u9732\u4e00\u4e2aVIP\uff0c\u4ece\u800c\u5b9e\u73b0\u9ad8\u53ef\u7528\u3002</li> <li>Heartbeat + MySQL \u5b9e\u73b0MySQL\u7684\u9ad8\u53ef\u7528\uff1a\u901a\u8fc7Heartbeat\u7684\u5fc3\u8df3\u68c0\u6d4b\u548c\u8d44\u6e90\u63a5\u7ba1\u3001\u96c6\u7fa4\u4e2d\u670d\u52a1\u7684\u76d1\u6d4b\u3001\u5931\u6548\u5207\u6362\u7b49\u529f\u80fd\uff0c\u7ed3\u5408MySQL\u6765\u5b9e\u73b0\u9ad8\u53ef\u7528\u6027\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#3-11-mysql","title":"3-11 \u7b80\u8ff0MySQL\u5e38\u89c1\u7684\u4f18\u5316\u63aa\u65bd\uff1f","text":"<p>MySQL\u53ef\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u4f18\u5316\uff1a</p> <ul> <li>1\u3001\u5f00\u542f\u67e5\u8be2\u7f13\u5b58\uff0c\u4f18\u5316\u67e5\u8be2\u3002</li> <li>2\u3001\u4f7f\u7528explain\u5224\u65adselect\u67e5\u8be2\uff0c\u4ece\u800c\u5206\u6790\u67e5\u8be2\u8bed\u53e5\u6216\u662f\u8868\u7ed3\u6784\u7684\u6027\u80fd\u74f6\u9888\uff0c\u7136\u540e\u6709\u9488\u5bf9\u6027\u7684\u8fdb\u884c\u4f18\u5316\u3002</li> <li>3\u3001\u4e3a\u641c\u7d22\u5b57\u6bb5\u5efa\u7d22\u5f15</li> <li>4\u3001\u5bf9\u4e8e\u6709\u9650\u5b9a\u8303\u56f4\u53d6\u503c\u7684\u5b57\u6bb5\uff0c\u63a8\u8350\u4f7f\u7528 ENUM \u800c\u4e0d\u662f VARCHAR\u3002</li> <li>5\u3001\u5782\u76f4\u5206\u8868\u3002</li> <li>6\u3001\u9009\u62e9\u6b63\u786e\u7684\u5b58\u50a8\u5f15\u64ce\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#3-12-mysql","title":"3-12 \u7b80\u8ff0MySQL\u5e38\u89c1\u5907\u4efd\u65b9\u5f0f\u548c\u5de5\u5177\uff1f","text":"<ul> <li>MySQL\u81ea\u5e26</li> </ul> <p>mysqldump\uff1amysqldump\u652f\u6301\u57fa\u4e8einnodb\u7684\u70ed\u5907\u4efd\uff0c\u4f7f\u7528mysqldump\u5b8c\u5168\u5907\u4efd+\u4e8c\u8fdb\u5236\u65e5\u5fd7\u53ef\u4ee5\u5b9e\u73b0\u57fa\u4e8e\u65f6\u95f4\u70b9\u7684\u6062\u590d\uff0c\u901a\u5e38\u9002\u5408\u5907\u4efd\u6570\u636e\u6bd4\u8f83\u5c0f\u7684\u573a\u666f \u3002</p> <ul> <li>\u7cfb\u7edf\u5c42\u9762</li> </ul> <p>tar\u5907\u4efd\uff1a\u53ef\u4ee5\u4f7f\u7528tar\u4e4b\u7c7b\u7684\u7cfb\u7edf\u547d\u4ee4\u5bf9\u6574\u4e2a\u6570\u636e\u5e93\u76ee\u5f55\u8fdb\u884c\u6253\u5305\u5907\u4efd\u3002</p> <p>lvm\u5feb\u7167\u5907\u4efd\uff1a\u53ef\u57fa\u4e8e\u6587\u4ef6\u7cfb\u7edf\u7684LVM\u5236\u4f5c\u5feb\u7167\uff0c\u8fdb\u884c\u5bf9\u6574\u4e2a\u6570\u636e\u5e93\u76ee\u5f55\u6240\u5728\u7684\u903b\u8f91\u5377\u5907\u4efd\u3002</p> <ul> <li>\u7b2c\u4e09\u65b9\u5907\u4efd\u5de5\u5177</li> </ul> <p>\u53ef\u4f7f\u7528\u5176\u4ed6\u7b2c\u4e09\u65b9\u5de5\u5177\u8fdb\u884c\u5907\u4efd\uff0c\u5982xtrabackup\u5de5\u5177\uff0c\u8be5\u5de5\u5177\u652f\u6301innodb\u7684\u7269\u7406\u70ed\u5907\u4efd\uff0c\u652f\u6301\u5b8c\u5168\u5907\u4efd\u3001\u589e\u91cf\u5907\u4efd\uff0c\u800c\u4e14\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u652f\u6301innodb\u5b58\u50a8\u5f15\u8d77\u7684\u6570\u636e\u5728\u4e0d\u540c\u6570\u636e\u5e93\u4e4b\u95f4\u8fc1\u79fb\uff0c\u652f\u6301\u590d\u5236\u6a21\u5f0f\u4e0b\u7684\u4ece\u673a\u5907\u4efd\u6062\u590d\u5907\u4efd\u6062\u590d\u3002</p>"},{"location":"chap4/4Linux_db_dia/#4","title":"4\u3001\u76d1\u63a7","text":""},{"location":"chap4/4Linux_db_dia/#4-1","title":"4-1 \u7b80\u8ff0\u5e38\u89c1\u7684\u76d1\u63a7\u8f6f\u4ef6\uff1f","text":"<p>\u5e38\u89c1\u7684\u76d1\u63a7\u8f6f\u4ef6\u6709\uff1a</p> <ul> <li>Cacti\uff1a\u662f\u4e00\u5957\u57fa\u4e8ePHP\u3001MySQL\u3001SNMP\u53caRRDTool\u5f00\u53d1\u7684\u7f51\u7edc\u6d41\u91cf\u76d1\u6d4b\u56fe\u5f62\u5206\u6790\u5de5\u5177\u3002</li> <li>Zabbix\uff1aZabbix\u662f\u4e00\u4e2a\u4f01\u4e1a\u7ea7\u7684\u9ad8\u5ea6\u96c6\u6210\u5f00\u6e90\u76d1\u63a7\u8f6f\u4ef6\uff0c\u63d0\u4f9b\u5206\u5e03\u5f0f\u76d1\u63a7\u89e3\u51b3\u65b9\u6848\u3002\u53ef\u4ee5\u7528\u6765\u76d1\u63a7\u8bbe\u5907\u3001\u670d\u52a1\u7b49\u53ef\u7528\u6027\u548c\u6027\u80fd\u3002</li> <li>Open-falcon\uff1a<code>open-falcon</code>\u662f\u4e00\u6b3e\u7528golang\u548cpython\u5199\u7684\u76d1\u63a7\u7cfb\u7edf\uff0c\u7531\u5c0f\u7c73\u542f\u52a8\u8fd9\u4e2a\u9879\u76ee\u3002</li> <li>Prometheus\uff1aPrometheus\u662f\u7531SoundCloud\u5f00\u53d1\u7684\u5f00\u6e90\u76d1\u63a7\u62a5\u8b66\u7cfb\u7edf\u548c\u65f6\u5e8f\u5217\u6570\u636e\u5e93(TSDB)\u3002Prometheus\u4f7f\u7528Go\u8bed\u8a00\u5f00\u53d1\uff0c\u662fGoogle BorgMon\u76d1\u63a7\u7cfb\u7edf\u7684\u5f00\u6e90\u7248\u672c\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#4-2-prometheus","title":"4-2 \u7b80\u8ff0Prometheus\u53ca\u5176\u4e3b\u8981\u7279\u6027\uff1f","text":"<p>Prometheus\u662f\u4e00\u4e2a\u5df2\u52a0\u5165CNCF\u7684\u5f00\u6e90\u76d1\u63a7\u62a5\u8b66\u7cfb\u7edf\u548c\u65f6\u5e8f\u5217\u6570\u636e\u5e93\u9879\u76ee\uff0c\u901a\u8fc7\u4e0d\u540c\u7684\u7ec4\u4ef6\u5b8c\u6210\u6570\u636e\u7684\u91c7\u96c6\uff0c\u6570\u636e\u7684\u5b58\u50a8\u548c\u544a\u8b66\u3002</p> <p>Prometheus\u4e3b\u8981\u7279\u6027\uff1a</p> <ul> <li>\u591a\u7ef4\u6570\u636e\u6a21\u578b<ul> <li>\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u901a\u8fc7 metric \u540d\u548c\u952e\u503c\u5bf9\u6765\u533a\u5206\u3002</li> <li>\u6240\u6709\u7684 metrics \u90fd\u53ef\u4ee5\u8bbe\u7f6e\u4efb\u610f\u7684\u591a\u7ef4\u6807\u7b7e\u3002</li> <li>\u6570\u636e\u6a21\u578b\u66f4\u968f\u610f\uff0c\u4e0d\u9700\u8981\u523b\u610f\u8bbe\u7f6e\u4e3a\u4ee5\u70b9\u5206\u9694\u7684\u5b57\u7b26\u4e32\u3002</li> <li>\u53ef\u4ee5\u5bf9\u6570\u636e\u6a21\u578b\u8fdb\u884c\u805a\u5408\uff0c\u5207\u5272\u548c\u5207\u7247\u64cd\u4f5c\u3002</li> <li>\u652f\u6301\u53cc\u7cbe\u5ea6\u6d6e\u70b9\u7c7b\u578b\uff0c\u6807\u7b7e\u53ef\u4ee5\u8bbe\u4e3a\u5168 unicode\u3002</li> </ul> </li> <li>\u7075\u6d3b\u7684\u67e5\u8be2\u8bed\u53e5\uff08PromQL\uff09\uff0c\u53ef\u4ee5\u5229\u7528\u591a\u7ef4\u6570\u636e\u5b8c\u6210\u590d\u6742\u7684\u67e5\u8be2</li> <li>Prometheus server \u662f\u4e00\u4e2a\u5355\u72ec\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u4f9d\u8d56\uff08\u4efb\u4f55\u5206\u5e03\u5f0f\uff09\u5b58\u50a8\uff0c\u652f\u6301 local \u548c remote \u4e0d\u540c\u6a21\u578b</li> <li>\u91c7\u7528 http \u534f\u8bae\uff0c\u4f7f\u7528 pull \u6a21\u5f0f\uff0c\u62c9\u53d6\u6570\u636e\uff0c\u6216\u8005\u901a\u8fc7\u4e2d\u95f4\u7f51\u5173\u63a8\u9001\u65b9\u5f0f\u91c7\u96c6\u6570\u636e</li> <li>\u76d1\u63a7\u76ee\u6807\uff0c\u53ef\u4ee5\u91c7\u7528\u670d\u52a1\u53d1\u73b0\u6216\u9759\u6001\u914d\u7f6e\u7684\u65b9\u5f0f</li> <li>\u652f\u6301\u591a\u79cd\u7edf\u8ba1\u6570\u636e\u6a21\u578b\uff0c\u56fe\u5f62\u5316\u53cb\u597d</li> <li>\u9ad8\u6548\uff1a\u4e00\u4e2a Prometheus server \u53ef\u4ee5\u5904\u7406\u6570\u767e\u4e07\u7684 metrics</li> <li>\u9002\u7528\u4e8e\u4ee5\u673a\u5668\u4e3a\u4e2d\u5fc3\u7684\u76d1\u63a7\u4ee5\u53ca\u9ad8\u5ea6\u52a8\u6001\u9762\u5411\u670d\u52a1\u67b6\u6784\u7684\u76d1\u63a7</li> </ul>"},{"location":"chap4/4Linux_db_dia/#4-3-prometheus","title":"4-3 \u7b80\u8ff0Prometheus\u4e3b\u8981\u7ec4\u4ef6\u53ca\u5176\u529f\u80fd\uff1f","text":"<p>Prometheus \u7684\u4e3b\u8981\u6a21\u5757\u5305\u542b\uff1aprometheus server, exporters, push gateway, PromQL, Alertmanager, WebUI \u7b49\u3002</p> <ul> <li>1\u3001prometheus server\uff1a\u5b9a\u671f\u4ece\u9759\u6001\u914d\u7f6e\u7684 targets \u6216\u8005\u670d\u52a1\u53d1\u73b0\uff08\u4e3b\u8981\u662fDNS\u3001consul\u3001k8s\u3001mesos\u7b49\uff09\u7684 targets \u62c9\u53d6\u6570\u636e\uff0c\u7528\u4e8e\u6536\u96c6\u548c\u5b58\u50a8\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u3002</li> <li>2\u3001exporters\uff1a\u8d1f\u8d23\u5411prometheus server\u505a\u6570\u636e\u6c47\u62a5\uff0c\u66b4\u9732\u4e00\u4e2ahttp\u670d\u52a1\u7684\u63a5\u53e3\u7ed9Prometheus server\u5b9a\u65f6\u6293\u53d6\u3002\u800c\u4e0d\u540c\u7684\u6570\u636e\u6c47\u62a5\u7531\u4e0d\u540c\u7684<code>exporters</code>\u5b9e\u73b0\uff0c\u6bd4\u5982\u76d1\u63a7\u4e3b\u673a\u6709<code>node-exporters</code>\uff0c<code>mysql</code>\u6709<code>MySQL server exporter</code>\u3002</li> <li>3\u3001push gateway\uff1a\u4e3b\u8981\u4f7f\u7528\u573a\u666f\u4e3a\uff0c\u5f53Prometheus \u91c7\u7528 pull \u6a21\u5f0f\uff0c\u53ef\u80fd\u7531\u4e8e\u4e0d\u5728\u4e00\u4e2a\u5b50\u7f51\u6216\u8005\u9632\u706b\u5899\u539f\u56e0\uff0c\u5bfc\u81f4 Prometheus \u65e0\u6cd5\u76f4\u63a5\u62c9\u53d6\u5404\u4e2a target \u6570\u636e\u3002\u6b64\u65f6\u9700\u8981push gateway\u63a5\u5165\uff0c\u4ee5\u4fbf\u4e8e\u5728\u76d1\u63a7\u4e1a\u52a1\u6570\u636e\u7684\u65f6\u5019\uff0c\u5c06\u4e0d\u540c\u6570\u636e\u6c47\u603b, \u7531 Prometheus \u7edf\u4e00\u6536\u96c6\u3002\u5b9e\u73b0\u673a\u5236\u7c7b\u4f3c\u4e8ezabbix-proxy\u529f\u80fd\u3002</li> <li>4\u3001Alertmanager\uff1a\u4ece Prometheus server \u7aef\u63a5\u6536\u5230 alerts \u540e\uff0c\u4f1a\u8fdb\u884c\u53bb\u9664\u91cd\u590d\u6570\u636e\uff0c\u5206\u7ec4\uff0c\u5e76\u8def\u7531\u5230\u5bf9\u6536\u7684\u63a5\u53d7\u65b9\u5f0f\uff0c\u53d1\u51fa\u62a5\u8b66\uff0c\u5373\u4e3b\u8981\u5b9e\u73b0prometheus\u7684\u544a\u8b66\u529f\u80fd\u3002AlertManager\u7684\u6574\u4f53\u5de5\u4f5c\u6d41\u7a0b\u5982\u4e0b\u56fe\u6240\u793a:</li> <li>5\u3001webui\uff1aPrometheus\u5185\u7f6e\u4e00\u4e2a\u7b80\u5355\u7684Web\u63a7\u5236\u53f0\uff0c\u53ef\u4ee5\u67e5\u8be2\u6307\u6807\uff0c\u67e5\u770b\u914d\u7f6e\u4fe1\u606f\u6216\u8005Service Discovery\u7b49\uff0c\u5b9e\u8df5\u4e2d\u901a\u5e38\u7ed3\u5408Grafana\uff0cPrometheus\u4ec5\u4f5c\u4e3aGrafana\u7684\u6570\u636e\u6e90\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#4-4-prometheus","title":"4-4 \u7b80\u8ff0Prometheus\u7684\u673a\u5236\uff1f","text":"<p>Prometheus\u7b80\u5355\u673a\u5236\u5982\u4e0b\uff1a</p> <ul> <li>Prometheus\u4ee5\u5176Server\u4e3a\u6838\u5fc3\uff0c\u7528\u4e8e\u6536\u96c6\u548c\u5b58\u50a8\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u3002Prometheus Server \u4ece\u76d1\u63a7\u76ee\u6807\u4e2d\u62c9\u53d6\u6570\u636e\uff0c\u6216\u901a\u8fc7push gateway\u95f4\u63a5\u7684\u628a\u76d1\u63a7\u76ee\u6807\u7684\u76d1\u63a7\u6570\u636e\u5b58\u50a8\u5230\u672c\u5730HDD/SSD\u4e2d\u3002</li> <li>\u7528\u6237\u63a5\u53e3\u754c\u9762\u901a\u8fc7\u5404\u79cdUI\u4f7f\u7528PromQL\u67e5\u8be2\u8bed\u8a00\u4eceServer\u83b7\u53d6\u6570\u636e\u3002</li> <li>\u4e00\u65e6Server\u68c0\u6d4b\u5230\u5f02\u5e38\uff0c\u4f1a\u63a8\u9001\u544a\u8b66\u5230AlertManager\uff0c\u7531\u544a\u8b66\u7ba1\u7406\u8d1f\u8d23\u53bb\u901a\u77e5\u76f8\u5173\u65b9\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#4-5-prometheus","title":"4-5 \u7b80\u8ff0Prometheus\u4e2d\u4ec0\u4e48\u662f\u65f6\u5e8f\u6570\u636e\uff1f","text":"<p>Prometheus \u5b58\u50a8\u7684\u662f\u65f6\u5e8f\u6570\u636e,\uff0c\u65f6\u5e8f\u6570\u636e\u662f\u6307\u6309\u7167\u76f8\u540c\u65f6\u5e8f(\u76f8\u540c\u7684\u540d\u5b57\u548c\u6807\u7b7e)\uff0c\u4ee5\u65f6\u95f4\u7ef4\u5ea6\u5b58\u50a8\u8fde\u7eed\u7684\u6570\u636e\u7684\u96c6\u5408\u3002\u65f6\u5e8f(time series) \u662f\u7531\u540d\u5b57(Metric)\uff0c\u4ee5\u53ca\u4e00\u7ec4 key/value \u6807\u7b7e\u5b9a\u4e49\u7684\uff0c\u5177\u6709\u76f8\u540c\u7684\u540d\u5b57\u4ee5\u53ca\u6807\u7b7e\u5c5e\u4e8e\u76f8\u540c\u65f6\u5e8f\u3002</p>"},{"location":"chap4/4Linux_db_dia/#4-6-prometheus","title":"4-6 \u7b80\u8ff0Prometheus\u65f6\u5e8f\u6570\u636e\u6709\u54ea\u4e9b\u7c7b\u578b\uff1f","text":"<p>Prometheus \u65f6\u5e8f\u6570\u636e\u5206\u4e3a Counter, Gauge, Histogram, Summary \u56db\u79cd\u7c7b\u578b\u3002</p> <ul> <li>Counter\uff1a\u8ba1\u6570\u5668\u8868\u793a\u6536\u96c6\u7684\u6570\u636e\u662f\u6309\u7167\u67d0\u4e2a\u8d8b\u52bf\uff08\u589e\u52a0\uff0f\u51cf\u5c11\uff09\u4e00\u76f4\u53d8\u5316\u7684\uff0c\u901a\u5e38\u7528\u5b83\u8bb0\u5f55\u670d\u52a1\u8bf7\u6c42\u603b\u91cf\uff0c\u9519\u8bef\u603b\u6570\u7b49\u3002</li> <li>Gauge\uff1a\u8ba1\u91cf\u5668\u8868\u793a\u641c\u96c6\u7684\u6570\u636e\u662f\u4e00\u4e2a\u77ac\u65f6\u7684\uff0c\u4e0e\u65f6\u95f4\u6ca1\u6709\u5173\u7cfb\uff0c\u53ef\u4ee5\u4efb\u610f\u53d8\u9ad8\u53d8\u4f4e\uff0c\u5f80\u5f80\u53ef\u4ee5\u7528\u6765\u8bb0\u5f55\u5185\u5b58\u4f7f\u7528\u7387\u3001\u78c1\u76d8\u4f7f\u7528\u7387\u7b49\u3002</li> <li>Histogram\uff1a\u76f4\u65b9\u56fe Histogram \u4e3b\u8981\u7528\u4e8e\u5bf9\u4e00\u6bb5\u65f6\u95f4\u8303\u56f4\u5185\u7684\u6570\u636e\u8fdb\u884c\u91c7\u6837\uff0c\uff08\u901a\u5e38\u662f\u8bf7\u6c42\u6301\u7eed\u65f6\u95f4\u6216\u54cd\u5e94\u5927\u5c0f\uff09\uff0c\u5e76\u80fd\u591f\u5bf9\u5176\u6307\u5b9a\u533a\u95f4\u4ee5\u53ca\u603b\u6570\u8fdb\u884c\u7edf\u8ba1\uff0c\u901a\u5e38\u6211\u4eec\u7528\u5b83\u8ba1\u7b97\u5206\u4f4d\u6570\u7684\u76f4\u65b9\u56fe\u3002</li> <li>Summary\uff1a\u6c47\u603bSummary \u548c \u76f4\u65b9\u56feHistogram \u7c7b\u4f3c\uff0c\u4e3b\u8981\u7528\u4e8e\u8868\u793a\u4e00\u6bb5\u65f6\u95f4\u5185\u6570\u636e\u91c7\u6837\u7ed3\u679c\uff0c\uff08\u901a\u5e38\u662f\u8bf7\u6c42\u6301\u7eed\u65f6\u95f4\u6216\u54cd\u5e94\u5927\u5c0f\uff09\uff0c\u5b83\u76f4\u63a5\u5b58\u50a8\u4e86 quantile \u6570\u636e\uff0c\u800c\u4e0d\u662f\u6839\u636e\u7edf\u8ba1\u533a\u95f4\u8ba1\u7b97\u51fa\u6765\u7684\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#5zabbix","title":"5\u3001\u7b80\u8ff0Zabbix\u53ca\u5176\u4f18\u52bf\uff1f","text":"<p>Zabbix\u662f\u4e00\u4e2a\u4f01\u4e1a\u7ea7\u7684\u9ad8\u5ea6\u96c6\u6210\u5f00\u6e90\u76d1\u63a7\u8f6f\u4ef6\uff0c\u63d0\u4f9b\u5206\u5e03\u5f0f\u76d1\u63a7\u89e3\u51b3\u65b9\u6848\u3002\u53ef\u4ee5\u7528\u6765\u76d1\u63a7\u8bbe\u5907\u3001\u670d\u52a1\u7b49\u53ef\u7528\u6027\u548c\u6027\u80fd\u3002\u5176\u4e3b\u8981\u4f18\u52bf\u6709\uff1a</p> <ul> <li>\u81ea\u7531\u5f00\u653e\u6e90\u4ee3\u7801\u4ea7\u54c1\uff0c\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u4efb\u610f\u4fee\u6539\u548c\u4e8c\u6b21\u5f00\u53d1\uff0c\u91c7\u7528GPL\u534f\u8bae\uff1b</li> <li>\u5b89\u88c5\u548c\u914d\u7f6e\u7b80\u5355\uff1b</li> <li>\u642d\u5efa\u73af\u5883\u7b80\u5355\uff0c\u57fa\u4e8e\u5f00\u6e90\u8f6f\u4ef6\u6784\u5efa\u5e73\u53f0\uff1b</li> <li>\u5b8c\u5168\u652f\u6301Linux\u3001Unix\u3001Windows\u3001AIX\u3001BSD\u7b49\u5e73\u53f0\uff0c\u91c7\u7528C\u8bed\u8a00\u7f16\u7801\uff0c\u7cfb\u7edf\u5360\u7528\u5c0f\uff0c\u6570\u636e\u91c7\u96c6\u6027\u80fd\u548c\u901f\u5ea6\u975e\u5e38\u5feb\uff1b</li> <li>\u6570\u636e\u91c7\u96c6\u6301\u4e45\u5b58\u50a8\u5230\u6570\u636e\u5e93\uff0c\u4fbf\u4e8e\u5bf9\u76d1\u63a7\u6570\u636e\u7684\u4e8c\u6b21\u5206\u6790\uff1b</li> <li>\u975e\u5e38\u4e30\u5bcc\u7684\u6269\u5c55\u80fd\u529b\uff0c\u8f7b\u677e\u5b9e\u73b0\u81ea\u5b9a\u4e49\u76d1\u63a7\u9879\u548c\u5b9e\u73b0\u6570\u636e\u91c7\u96c6\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#5-1-zabbix","title":"5-1 \u7b80\u8ff0Zabbix\u4f53\u7cfb\u67b6\u6784\uff1f","text":"<p>Zabbix\u4f53\u7cfb\u76f8\u5bf9\u6e05\u6670\uff0c\u5176\u4e3b\u8981\u7ec4\u4ef6\u6709\uff1a</p> <ul> <li>Zabbix Server\uff1a\u8d1f\u8d23\u63a5\u6536agent\u53d1\u9001\u7684\u62a5\u544a\u4fe1\u606f\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u6240\u6709\u914d\u7f6e\u3001\u7edf\u8ba1\u6570\u636e\u53ca\u64cd\u4f5c\u6570\u636e\u5747\u7531\u5176\u7ec4\u7ec7\u8fdb\u884c\u3002</li> <li>Database Storage\uff1a\u4e13\u7528\u4e8e\u5b58\u50a8\u6240\u6709\u914d\u7f6e\u4fe1\u606f\uff0c\u4ee5\u53ca\u6709zabbix\u6536\u96c6\u7684\u6570\u636e\u3002</li> <li>Web interface\uff08frontend\uff09\uff1azabbix\u7684GUI\u63a5\u53e3\uff0c\u901a\u5e38\u4e0eserver\u8fd0\u884c\u5728\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u3002</li> <li>Proxy\uff1a\u53ef\u9009\u7ec4\u4ef6\uff0c\u5e38\u7528\u4e8e\u5206\u5e03\u5f0f\u76d1\u63a7\u73af\u5883\u4e2d\uff0c\u4ee3\u7406Server\u6536\u96c6\u90e8\u5206\u88ab\u76d1\u63a7\u6570\u636e\u5e76\u7edf\u4e00\u53d1\u5f80Server\u7aef\u3002</li> <li>Agent\uff1a\u90e8\u7f72\u5728\u88ab\u76d1\u63a7\u4e3b\u673a\u4e0a\uff0c\u8d1f\u8d23\u6536\u96c6\u672c\u5730\u6570\u636e\u5e76\u53d1\u5f80Server\u7aef\u6216\u8005Proxy\u7aef\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#5-2-zabbix","title":"5-2 \u7b80\u8ff0Zabbix\u6240\u652f\u6301\u7684\u76d1\u63a7\u65b9\u5f0f\uff1f","text":"<p>\u76ee\u524d\u7531zabbix\u63d0\u4f9b\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u4ee5\u4e0b\u4e8b\u9879\u7c7b\u578b\u7684\u652f\u6301\uff1a</p> <ul> <li>Zabbix agent checks\uff1a\u8fd9\u4e9b\u5ba2\u6237\u7aef\u6765\u8fdb\u884c\u6570\u636e\u91c7\u96c6\uff0c\u53c8\u5206\u4e3aZabbix agent\uff08\u88ab\u52a8\u6a21\u5f0f\uff1a\u5ba2\u6237\u7aef\u7b49\u7740\u670d\u52a1\u5668\u7aef\u6765\u8981\u6570\u636e\uff09\uff0cZabbix agent (active)\uff08\u4e3b\u52a8\u6a21\u5f0f\uff1a\u5ba2\u6237\u7aef\u4e3b\u52a8\u53d1\u9001\u6570\u636e\u5230\u670d\u52a1\u5668\u7aef\uff09</li> <li>SNMP agent checks\uff1aSNMP\u65b9\u5f0f\uff0c\u5982\u679c\u8981\u76d1\u63a7\u6253\u5370\u673a\u7f51\u7edc\u8bbe\u5907\u7b49\u652f\u6301SNMP\u8bbe\u5907\u7684\u8bdd\uff0c\u4f46\u662f\u53c8\u4e0d\u80fd\u5b89\u88c5agent\u7684\u8bbe\u5907\u3002</li> <li>SNMP traps \uff1a</li> <li>IPMI checks\uff1aIPMI\u5373\u667a\u80fd\u5e73\u53f0\u7ba1\u7406\u63a5\u53e3\uff0c\u73b0\u5728\u662f\u4e1a\u754c\u901a\u8fc7\u7684\u6807\u51c6\u3002\u7528\u6237\u53ef\u4ee5\u5229\u7528IPMI\u76d1\u89c6\u670d\u52a1\u5668\u7684\u7269\u7406\u7279\u6027\uff0c\u5982\u6e29\u5ea6\u3001\u7535\u538b\u3001\u7535\u6247\u5de5\u4f5c\u72b6\u6001\u3001\u7535\u6e90\u4f9b\u5e94\u4ee5\u53ca\u673a\u7bb1\u5165\u4fb5\u7b49\u3002</li> </ul>"},{"location":"chap4/4Linux_db_dia/#5-3-zabbix","title":"5-3 \u7b80\u8ff0Zabbix\u5206\u5e03\u5f0f\u53ca\u5176\u9002\u5e94\u573a\u666f\uff1f","text":"<p>zabbix proxy \u53ef\u4ee5\u4ee3\u66ff zabbix server \u6536\u96c6\u6027\u80fd\u548c\u53ef\u7528\u6027\u6570\u636e,\u7136\u540e\u628a\u6570\u636e\u6c47\u62a5\u7ed9 zabbix server\uff0c\u5e76\u4e14\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5206\u62c5\u4e86zabbix server \u7684\u538b\u529b\u3002</p> <p>\u6b64\u5916\uff0c\u5f53\u6240\u6709agents\u548cproxy\u62a5\u544a\u7ed9\u4e00\u4e2aZabbix server\u5e76\u4e14\u6240\u6709\u6570\u636e\u90fd\u96c6\u4e2d\u6536\u96c6\u65f6\uff0c\u4f7f\u7528proxy\u662f\u5b9e\u73b0\u96c6\u4e2d\u5f0f\u548c\u5206\u5e03\u5f0f\u76d1\u63a7\u7684\u6700\u7b80\u5355\u65b9\u6cd5\u3002</p> <p>zabbix proxy \u4f7f\u7528\u573a\u666f:</p> <ul> <li>\u76d1\u63a7\u8fdc\u7a0b\u533a\u57df\u8bbe\u5907</li> <li>\u76d1\u63a7\u672c\u5730\u7f51\u7edc\u4e0d\u7a33\u5b9a\u533a\u57df</li> <li>\u5f53 zabbix \u76d1\u63a7\u4e0a\u5343\u8bbe\u5907\u65f6,\u4f7f\u7528\u5b83\u6765\u51cf\u8f7b server \u7684\u538b\u529b</li> <li>\u7b80\u5316\u5206\u5e03\u5f0f\u76d1\u63a7\u7684\u7ef4\u62a4</li> </ul>"},{"location":"chap4/5k8s_OpenShift/","title":"\u7b2c\u4e94\u8282 IT\u8fd0\u7ef4\u9762\u8bd5\u95ee\u9898\u603b\u7ed3-\u7b80\u8ff0Etcd\u3001Kubernetes\u3001Lvs\u3001HAProxy\u7b49","text":""},{"location":"chap4/5k8s_OpenShift/#1etcd","title":"1\u3001ETCD","text":""},{"location":"chap4/5k8s_OpenShift/#1-1-etcd","title":"1-1 \u7b80\u8ff0ETCD\u53ca\u5176\u7279\u70b9\uff1f","text":"<p>etcd \u662f CoreOS \u56e2\u961f\u53d1\u8d77\u7684\u5f00\u6e90\u9879\u76ee\uff0c\u662f\u4e00\u4e2a\u7ba1\u7406\u914d\u7f6e\u4fe1\u606f\u548c\u670d\u52a1\u53d1\u73b0\uff08service discovery\uff09\u7684\u9879\u76ee\uff0c\u5b83\u7684\u76ee\u6807\u662f\u6784\u5efa\u4e00\u4e2a\u9ad8\u53ef\u7528\u7684\u5206\u5e03\u5f0f\u952e\u503c\uff08key-value\uff09\u6570\u636e\u5e93\uff0c\u57fa\u4e8e Go \u8bed\u8a00\u5b9e\u73b0\u3002</p> <p>\u7279\u70b9\uff1a</p> <ul> <li>\u7b80\u5355\uff1a\u652f\u6301 REST \u98ce\u683c\u7684 HTTP+JSON API</li> <li>\u5b89\u5168\uff1a\u652f\u6301 HTTPS \u65b9\u5f0f\u7684\u8bbf\u95ee</li> <li>\u5feb\u901f\uff1a\u652f\u6301\u5e76\u53d1 1k/s \u7684\u5199\u64cd\u4f5c</li> <li>\u53ef\u9760\uff1a\u652f\u6301\u5206\u5e03\u5f0f\u7ed3\u6784\uff0c\u57fa\u4e8e Raft \u7684\u4e00\u81f4\u6027\u7b97\u6cd5\uff0cRaft \u662f\u4e00\u5957\u901a\u8fc7\u9009\u4e3e\u4e3b\u8282\u70b9\u6765\u5b9e\u73b0\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e00\u81f4\u6027\u7684\u7b97\u6cd5\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#1-2-etcd","title":"1-2 \u7b80\u8ff0ETCD\u9002\u5e94\u7684\u573a\u666f\uff1f","text":"<p>etcd\u57fa\u4e8e\u5176\u4f18\u79c0\u7684\u7279\u70b9\uff0c\u53ef\u5e7f\u6cdb\u7684\u5e94\u7528\u4e8e\u4ee5\u4e0b\u573a\u666f\uff1a</p> <ul> <li>\u670d\u52a1\u53d1\u73b0(Service Discovery)\uff1a\u670d\u52a1\u53d1\u73b0\u4e3b\u8981\u89e3\u51b3\u5728\u540c\u4e00\u4e2a\u5206\u5e03\u5f0f\u96c6\u7fa4\u4e2d\u7684\u8fdb\u7a0b\u6216\u670d\u52a1\uff0c\u8981\u5982\u4f55\u624d\u80fd\u627e\u5230\u5bf9\u65b9\u5e76\u5efa\u7acb\u8fde\u63a5\u3002\u672c\u8d28\u4e0a\u6765\u8bf4\uff0c\u670d\u52a1\u53d1\u73b0\u5c31\u662f\u60f3\u8981\u4e86\u89e3\u96c6\u7fa4\u4e2d\u662f\u5426\u6709\u8fdb\u7a0b\u5728\u76d1\u542cudp\u6216tcp\u7aef\u53e3\uff0c\u5e76\u4e14\u901a\u8fc7\u540d\u5b57\u5c31\u53ef\u4ee5\u67e5\u627e\u548c\u8fde\u63a5\u3002</li> <li>\u6d88\u606f\u53d1\u5e03\u4e0e\u8ba2\u9605\uff1a\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u6700\u9002\u7528\u7684\u4e00\u79cd\u7ec4\u4ef6\u95f4\u901a\u4fe1\u65b9\u5f0f\u5c31\u662f\u6d88\u606f\u53d1\u5e03\u4e0e\u8ba2\u9605\u3002\u5373\u6784\u5efa\u4e00\u4e2a\u914d\u7f6e\u5171\u4eab\u4e2d\u5fc3\uff0c\u6570\u636e\u63d0\u4f9b\u8005\u5728\u8fd9\u4e2a\u914d\u7f6e\u4e2d\u5fc3\u53d1\u5e03\u6d88\u606f\uff0c\u800c\u6d88\u606f\u4f7f\u7528\u8005\u5219\u8ba2\u9605\u4ed6\u4eec\u5173\u5fc3\u7684\u4e3b\u9898\uff0c\u4e00\u65e6\u4e3b\u9898\u6709\u6d88\u606f\u53d1\u5e03\uff0c\u5c31\u4f1a\u5b9e\u65f6\u901a\u77e5\u8ba2\u9605\u8005\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u505a\u5230\u5206\u5e03\u5f0f\u7cfb\u7edf\u914d\u7f6e\u7684\u96c6\u4e2d\u5f0f\u7ba1\u7406\u4e0e\u52a8\u6001\u66f4\u65b0\u3002\u5e94\u7528\u4e2d\u7528\u5230\u7684\u4e00\u4e9b\u914d\u7f6e\u4fe1\u606f\u653e\u5230etcd\u4e0a\u8fdb\u884c\u96c6\u4e2d\u7ba1\u7406\u3002</li> <li>\u8d1f\u8f7d\u5747\u8861\uff1a\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u670d\u52a1\u7684\u9ad8\u53ef\u7528\u4ee5\u53ca\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c\u901a\u5e38\u90fd\u4f1a\u628a\u6570\u636e\u548c\u670d\u52a1\u90e8\u7f72\u591a\u4efd\uff0c\u4ee5\u6b64\u8fbe\u5230\u5bf9\u7b49\u670d\u52a1\uff0c\u5373\u4f7f\u5176\u4e2d\u7684\u67d0\u4e00\u4e2a\u670d\u52a1\u5931\u6548\u4e86\uff0c\u4e5f\u4e0d\u5f71\u54cd\u4f7f\u7528\u3002etcd\u672c\u8eab\u5206\u5e03\u5f0f\u67b6\u6784\u5b58\u50a8\u7684\u4fe1\u606f\u8bbf\u95ee\u652f\u6301\u8d1f\u8f7d\u5747\u8861\u3002etcd\u96c6\u7fa4\u5316\u4ee5\u540e\uff0c\u6bcf\u4e2aetcd\u7684\u6838\u5fc3\u8282\u70b9\u90fd\u53ef\u4ee5\u5904\u7406\u7528\u6237\u7684\u8bf7\u6c42\u3002\u6240\u4ee5\uff0c\u628a\u6570\u636e\u91cf\u5c0f\u4f46\u662f\u8bbf\u95ee\u9891\u7e41\u7684\u6d88\u606f\u6570\u636e\u76f4\u63a5\u5b58\u50a8\u5230etcd\u4e2d\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u7684\u6548\u679c\u3002</li> <li>\u5206\u5e03\u5f0f\u901a\u77e5\u4e0e\u534f\u8c03\uff1a\u4e0e\u6d88\u606f\u53d1\u5e03\u548c\u8ba2\u9605\u7c7b\u4f3c\uff0c\u90fd\u7528\u5230\u4e86etcd\u4e2d\u7684Watcher\u673a\u5236\uff0c\u901a\u8fc7\u6ce8\u518c\u4e0e\u5f02\u6b65\u901a\u77e5\u673a\u5236\uff0c\u5b9e\u73b0\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u4e0d\u540c\u7cfb\u7edf\u4e4b\u95f4\u7684\u901a\u77e5\u4e0e\u534f\u8c03\uff0c\u4ece\u800c\u5bf9\u6570\u636e\u53d8\u66f4\u505a\u5230\u5b9e\u65f6\u5904\u7406\u3002</li> <li>\u5206\u5e03\u5f0f\u9501\uff1a\u56e0\u4e3aetcd\u4f7f\u7528Raft\u7b97\u6cd5\u4fdd\u6301\u4e86\u6570\u636e\u7684\u5f3a\u4e00\u81f4\u6027\uff0c\u67d0\u6b21\u64cd\u4f5c\u5b58\u50a8\u5230\u96c6\u7fa4\u4e2d\u7684\u503c\u5fc5\u7136\u662f\u5168\u5c40\u4e00\u81f4\u7684\uff0c\u6240\u4ee5\u5f88\u5bb9\u6613\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501\u3002\u9501\u670d\u52a1\u6709\u4e24\u79cd\u4f7f\u7528\u65b9\u5f0f\uff0c\u4e00\u662f\u4fdd\u6301\u72ec\u5360\uff0c\u4e8c\u662f\u63a7\u5236\u65f6\u5e8f\u3002</li> <li>\u96c6\u7fa4\u76d1\u63a7\u4e0eLeader\u7ade\u9009\uff1a\u901a\u8fc7etcd\u6765\u8fdb\u884c\u76d1\u63a7\u5b9e\u73b0\u8d77\u6765\u975e\u5e38\u7b80\u5355\u5e76\u4e14\u5b9e\u65f6\u6027\u5f3a\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#2-haproxy","title":"2\u3001 HAProxy","text":""},{"location":"chap4/5k8s_OpenShift/#2-1-haproxy","title":"2-1 \u7b80\u8ff0HAProxy\u53ca\u5176\u7279\u6027\uff1f","text":"<p>HAProxy\u662f\u53ef\u63d0\u4f9b\u9ad8\u53ef\u7528\u6027\u3001\u8d1f\u8f7d\u5747\u8861\u4ee5\u53ca\u57fa\u4e8eTCP\u548cHTTP\u5e94\u7528\u7684\u4ee3\u7406\uff0c\u662f\u514d\u8d39\u3001\u5feb\u901f\u5e76\u4e14\u53ef\u9760\u7684\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\u3002HAProxy\u975e\u5e38\u9002\u7528\u4e8e\u5e76\u53d1\u5927\uff08\u5e76\u53d1\u8fbe1w\u4ee5\u4e0a\uff09web\u7ad9\u70b9\uff0c\u8fd9\u4e9b\u7ad9\u70b9\u901a\u5e38\u53c8\u9700\u8981\u4f1a\u8bdd\u4fdd\u6301\u6216\u4e03\u5c42\u5904\u7406\u3002HAProxy\u7684\u8fd0\u884c\u6a21\u5f0f\u4f7f\u5f97\u5b83\u53ef\u4ee5\u5f88\u7b80\u5355\u5b89\u5168\u7684\u6574\u5408\u81f3\u5f53\u524d\u7684\u67b6\u6784\u4e2d\uff0c\u540c\u65f6\u53ef\u4ee5\u4fdd\u62a4web\u670d\u52a1\u5668\u4e0d\u88ab\u66b4\u9732\u5230\u7f51\u7edc\u4e0a\u3002</p> <p>HAProxy\u7684\u4e3b\u8981\u7279\u6027\u6709\uff1a</p> <ul> <li>\u53ef\u9760\u6027\u548c\u7a33\u5b9a\u6027\u975e\u5e38\u597d\uff0c\u53ef\u4ee5\u4e0e\u786c\u4ef6\u7ea7\u7684F5\u8d1f\u8f7d\u5747\u8861\u8bbe\u5907\u76f8\u5ab2\u7f8e\uff1b</li> <li>\u6700\u9ad8\u53ef\u4ee5\u540c\u65f6\u7ef4\u62a440000-50000\u4e2a\u5e76\u53d1\u8fde\u63a5\uff0c\u5355\u4f4d\u65f6\u95f4\u5185\u5904\u7406\u7684\u6700\u5927\u8bf7\u6c42\u6570\u4e3a20000\u4e2a\uff0c\u6700\u5927\u5904\u7406\u80fd\u529b\u53ef\u8fbe10Git/s\uff1b</li> <li>\u652f\u6301\u591a\u8fbe8\u79cd\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0c\u540c\u65f6\u4e5f\u652f\u6301\u4f1a\u8bdd\u4fdd\u6301\uff1b</li> <li>\u652f\u6301\u865a\u673a\u4e3b\u673a\u529f\u80fd\uff0c\u4ece\u800c\u5b9e\u73b0web\u8d1f\u8f7d\u5747\u8861\u66f4\u52a0\u7075\u6d3b\uff1b</li> <li>\u652f\u6301\u8fde\u63a5\u62d2\u7edd\u3001\u5168\u900f\u660e\u4ee3\u7406\u7b49\u72ec\u7279\u7684\u529f\u80fd\uff1b</li> <li>\u62e5\u6709\u5f3a\u5927\u7684ACL\u652f\u6301\uff0c\u7528\u4e8e\u8bbf\u95ee\u63a7\u5236\uff1b</li> <li>\u5176\u72ec\u7279\u7684\u5f39\u6027\u4e8c\u53c9\u6811\u6570\u636e\u7ed3\u6784\uff0c\u4f7f\u6570\u636e\u7ed3\u6784\u7684\u590d\u6742\u6027\u4e0a\u5347\u5230\u4e860(1)\uff0c\u5373\u6570\u636e\u7684\u67e5\u5bfb\u901f\u5ea6\u4e0d\u4f1a\u968f\u7740\u6570\u636e\u6761\u76ee\u7684\u589e\u52a0\u800c\u901f\u5ea6\u6709\u6240\u4e0b\u964d\uff1b</li> <li>\u652f\u6301\u5ba2\u6237\u7aef\u7684keepalive\u529f\u80fd\uff0c\u51cf\u5c11\u5ba2\u6237\u7aef\u4e0ehaproxy\u7684\u591a\u6b21\u4e09\u6b21\u63e1\u624b\u5bfc\u81f4\u8d44\u6e90\u6d6a\u8d39\uff0c\u8ba9\u591a\u4e2a\u8bf7\u6c42\u5728\u4e00\u4e2atcp\u8fde\u63a5\u4e2d\u5b8c\u6210\uff1b</li> <li>\u652f\u6301TCP\u52a0\u901f\uff0c\u96f6\u590d\u5236\u529f\u80fd\uff0c\u7c7b\u4f3c\u4e8emmap\u673a\u5236\uff1b</li> <li>\u652f\u6301\u54cd\u5e94\u6c60\uff08response buffering\uff09\uff1b</li> <li>\u652f\u6301RDP\u534f\u8bae\uff1b</li> <li>\u57fa\u4e8e\u6e90\u7684\u7c98\u6027\uff0c\u7c7b\u4f3cnginx\u7684<code>ip_hash</code>\u529f\u80fd\uff0c\u628a\u6765\u81ea\u540c\u4e00\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u5728\u4e00\u5b9a\u65f6\u95f4\u5185\u59cb\u7ec8\u8c03\u5ea6\u5230\u4e0a\u6e38\u7684\u540c\u4e00\u670d\u52a1\u5668\uff1b</li> <li>\u66f4\u597d\u7edf\u8ba1\u6570\u636e\u63a5\u53e3\uff0c\u5176web\u63a5\u53e3\u663e\u793a\u540e\u7aef\u96c6\u7fa4\u4e2d\u5404\u4e2a\u670d\u52a1\u5668\u7684\u63a5\u6536\u3001\u53d1\u9001\u3001\u62d2\u7edd\u3001\u9519\u8bef\u7b49\u6570\u636e\u7684\u7edf\u8ba1\u4fe1\u606f\uff1b</li> <li>\u8be6\u7ec6\u7684\u5065\u5eb7\u72b6\u6001\u68c0\u6d4b\uff0cweb\u63a5\u53e3\u4e2d\u6709\u5173\u4e8e\u5bf9\u4e0a\u6e38\u670d\u52a1\u5668\u7684\u5065\u5eb7\u68c0\u6d4b\u72b6\u6001\uff0c\u5e76\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7684\u7ba1\u7406\u529f\u80fd\uff1b</li> <li>\u57fa\u4e8e\u6d41\u91cf\u7684\u5065\u5eb7\u8bc4\u4f30\u673a\u5236\uff1b</li> <li>\u57fa\u4e8ehttp\u8ba4\u8bc1\uff1b</li> <li>\u57fa\u4e8e\u547d\u4ee4\u884c\u7684\u7ba1\u7406\u63a5\u53e3\uff1b</li> <li>\u65e5\u5fd7\u5206\u6790\u5668\uff0c\u53ef\u5bf9\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#2-2-haproxy","title":"2-2 \u7b80\u8ff0HAProxy\u5e38\u89c1\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff1f","text":"<p>HAProxy\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u975e\u5e38\u591a\uff0c\u5e38\u89c1\u7684\u6709\u5982\u4e0b8\u79cd\uff1a</p> <ul> <li>roundrobin\uff1a\u8868\u793a\u7b80\u5355\u7684\u8f6e\u8be2\u3002</li> <li>static-rr\uff1a\u8868\u793a\u6839\u636e\u6743\u91cd\u3002</li> <li>leastconn\uff1a\u8868\u793a\u6700\u5c11\u8fde\u63a5\u8005\u5148\u5904\u7406\u3002</li> <li>source\uff1a\u8868\u793a\u6839\u636e\u8bf7\u6c42\u7684\u6e90IP\uff0c\u7c7b\u4f3cNginx\u7684<code>IP_hash</code>\u673a\u5236\u3002</li> <li>ri\uff1a\u8868\u793a\u6839\u636e\u8bf7\u6c42\u7684URI\u3002</li> <li><code>rl_param</code>\uff1a\u8868\u793a\u6839\u636eHTTP\u8bf7\u6c42\u5934\u6765\u9501\u5b9a\u6bcf\u4e00\u6b21HTTP\u8bf7\u6c42\u3002</li> <li><code>rdp-cookie(name)</code>\uff1a\u8868\u793a\u6839\u636e\u636ecookie(name)\u6765\u9501\u5b9a\u5e76\u54c8\u5e0c\u6bcf\u4e00\u6b21TCP\u8bf7\u6c42\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#2-3","title":"2-3 \u7b80\u8ff0\u8d1f\u8f7d\u5747\u8861\u56db\u5c42\u548c\u4e03\u5c42\u7684\u533a\u522b\uff1f","text":"<ul> <li> <p>\u56db\u5c42\u8d1f\u8f7d\u5747\u8861\u5668\u4e5f\u79f0\u4e3a4\u5c42\u4ea4\u6362\u673a\uff0c\u4e3b\u8981\u901a\u8fc7\u5206\u6790IP\u5c42\u53caTCP/UDP\u5c42\u7684\u6d41\u91cf\u5b9e\u73b0\u57fa\u4e8eIP\u52a0\u7aef\u53e3\u7684\u8d1f\u8f7d\u5747\u8861\uff0c\u5982\u5e38\u89c1\u7684LVS\u3001F5\u7b49\uff1b</p> </li> <li> <p>\u4e03\u5c42\u8d1f\u8f7d\u5747\u8861\u5668\u4e5f\u79f0\u4e3a7\u5c42\u4ea4\u6362\u673a\uff0c\u4f4d\u4e8eOSI\u7684\u6700\u9ad8\u5c42\uff0c\u5373\u5e94\u7528\u5c42\uff0c\u6b64\u8d1f\u8f7d\u5747\u8861\u5668\u652f\u6301\u591a\u79cd\u534f\u8bae\uff0c\u5982HTTP\u3001FTP\u3001SMTP\u7b49\u30027\u5c42\u8d1f\u8f7d\u5747\u8861\u5668\u53ef\u6839\u636e\u62a5\u6587\u5185\u5bb9\uff0c\u914d\u5408\u4e00\u5b9a\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u6765\u9009\u62e9\u540e\u7aef\u670d\u52a1\u5668\uff0c\u5373\u201c\u5185\u5bb9\u4ea4\u6362\u5668\u201d\u3002\u5982\u5e38\u89c1\u7684HAProxy\u3001Nginx\u3002</p> </li> </ul>"},{"location":"chap4/5k8s_OpenShift/#2-4-lvsnginxhaproxy","title":"2-4 \u7b80\u8ff0LVS\u3001Nginx\u3001HAproxy\u7684\u4ec0\u4e48\u5f02\u540c\uff1f","text":"<ul> <li> <p>\u76f8\u540c\uff1a\u4e09\u8005\u90fd\u662f\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u4ea7\u54c1\u3002</p> </li> <li> <p>\u533a\u522b\uff1a</p> <ul> <li>LVS\u57fa\u4e8eLinux\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u73b0\u8f6f\u8d1f\u8f7d\u5747\u8861\uff0c\u800cHAProxy\u548cNginx\u662f\u57fa\u4e8e\u7b2c\u4e09\u65b9\u5e94\u7528\u5b9e\u73b0\u7684\u8f6f\u8d1f\u8f7d\u5747\u8861\uff1b</li> <li>LVS\u662f\u53ef\u5b9e\u73b04\u5c42\u7684IP\u8d1f\u8f7d\u5747\u8861\u6280\u672f\uff0c\u65e0\u6cd5\u5b9e\u73b0\u57fa\u4e8e\u76ee\u5f55\u3001URL\u7684\u8f6c\u53d1\u3002\u800cHAProxy\u548cNginx\u90fd\u53ef\u4ee5\u5b9e\u73b04\u5c42\u548c7\u5c42\u6280\u672f\uff0cHAProxy\u53ef\u63d0\u4f9bTCP\u548cHTTP\u5e94\u7528\u7684\u8d1f\u8f7d\u5747\u8861\u7efc\u5408\u89e3\u51b3\u65b9\u6848\uff1b</li> <li>LVS\u56e0\u4e3a\u5de5\u4f5c\u5728ISO\u6a21\u578b\u7684\u7b2c\u56db\u5c42\uff0c\u5176\u72b6\u6001\u76d1\u6d4b\u529f\u80fd\u5355\u4e00\uff0c\u800cHAProxy\u5728\u72b6\u76d1\u6d4b\u65b9\u9762\u529f\u80fd\u66f4\u4e30\u5bcc\u3001\u5f3a\u5927\uff0c\u53ef\u652f\u6301\u7aef\u53e3\u3001URL\u3001\u811a\u672c\u7b49\u591a\u79cd\u72b6\u6001\u68c0\u6d4b\u65b9\u5f0f\uff1b</li> <li>HAProxy\u529f\u80fd\u5f3a\u5927\uff0c\u4f46\u6574\u4f53\u6027\u80fd\u4f4e\u4e8e4\u5c42\u6a21\u5f0f\u7684LVS\u8d1f\u8f7d\u5747\u8861\u3002</li> <li>Nginx\u4e3b\u8981\u7528\u4e8eWeb\u670d\u52a1\u5668\u6216\u7f13\u5b58\u670d\u52a1\u5668\u3002</li> </ul> </li> </ul>"},{"location":"chap4/5k8s_OpenShift/#3heartbeat-and-keepalived","title":"3\u3001Heartbeat and Keepalived","text":""},{"location":"chap4/5k8s_OpenShift/#3-1-heartbeat","title":"3-1 \u7b80\u8ff0Heartbeat\uff1f","text":"<p>Heartbeat\u662fLinux-HA\u9879\u76ee\u4e2d\u7684\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u5b83\u63d0\u4f9b\u4e86\u5fc3\u8df3\u68c0\u6d4b\u548c\u8d44\u6e90\u63a5\u7ba1\u3001\u96c6\u7fa4\u4e2d\u670d\u52a1\u7684\u76d1\u6d4b\u3001\u5931\u6548\u5207\u6362\u7b49\u529f\u80fd\u3002</p> <p>heartbeat\u6700\u6838\u5fc3\u7684\u529f\u80fd\u5305\u62ec\u4e24\u4e2a\u90e8\u5206\uff0c\u5fc3\u8df3\u76d1\u6d4b\u548c\u8d44\u6e90\u63a5\u7ba1\u3002</p> <p>\u5fc3\u8df3\u76d1\u6d4b\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u94fe\u8def\u548c\u4e32\u53e3\u8fdb\u884c\uff0c\u800c\u4e14\u652f\u6301\u5197\u4f59\u94fe\u8def\uff0c\u5b83\u4eec\u4e4b\u95f4\u76f8\u4e92\u53d1\u9001\u62a5\u6587\u6765\u544a\u8bc9\u5bf9\u65b9\u81ea\u5df1\u5f53\u524d\u7684\u72b6\u6001\uff0c\u5982\u679c\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u5185\u672a\u6536\u5230\u5bf9\u65b9\u53d1\u9001\u7684\u62a5\u6587\uff0c\u90a3\u4e48\u5c31\u8ba4\u4e3a\u5bf9\u65b9\u5931\u6548\uff0c\u8fd9\u65f6\u9700\u542f\u52a8\u8d44\u6e90\u63a5\u7ba1\u6a21\u5757\u6765\u63a5\u7ba1\u8fd0\u884c\u5728\u5bf9\u65b9\u4e3b\u673a\u4e0a\u7684\u8d44\u6e90\u6216\u8005\u670d\u52a1\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#3-2-keepalived","title":"3-2 \u7b80\u8ff0Keepalived\u53ca\u5176\u5de5\u4f5c\u539f\u7406\uff1f","text":"<p>Keepalived \u662f\u4e00\u4e2a\u57fa\u4e8eVRRP\u534f\u8bae\u6765\u5b9e\u73b0\u7684LVS\u670d\u52a1\u9ad8\u53ef\u7528\u65b9\u6848\uff0c\u53ef\u4ee5\u89e3\u51b3\u9759\u6001\u8def\u7531\u51fa\u73b0\u7684\u5355\u70b9\u6545\u969c\u95ee\u9898\u3002</p> <p>\u5728\u4e00\u4e2aLVS\u670d\u52a1\u96c6\u7fa4\u4e2d\u901a\u5e38\u6709\u4e3b\u670d\u52a1\u5668\uff08MASTER\uff09\u548c\u5907\u4efd\u670d\u52a1\u5668\uff08BACKUP\uff09\u4e24\u79cd\u89d2\u8272\u7684\u670d\u52a1\u5668\uff0c\u4f46\u662f\u5bf9\u5916\u8868\u73b0\u4e3a\u4e00\u4e2a\u865a\u62dfIP\uff0c\u4e3b\u670d\u52a1\u5668\u4f1a\u53d1\u9001VRRP\u901a\u544a\u4fe1\u606f\u7ed9\u5907\u4efd\u670d\u52a1\u5668\uff0c\u5f53\u5907\u4efd\u670d\u52a1\u5668\u6536\u4e0d\u5230VRRP\u6d88\u606f\u7684\u65f6\u5019\uff0c\u5373\u4e3b\u670d\u52a1\u5668\u5f02\u5e38\u7684\u65f6\u5019\uff0c\u5907\u4efd\u670d\u52a1\u5668\u5c31\u4f1a\u63a5\u7ba1\u865a\u62dfIP\uff0c\u7ee7\u7eed\u63d0\u4f9b\u670d\u52a1\uff0c\u4ece\u800c\u4fdd\u8bc1\u4e86\u9ad8\u53ef\u7528\u6027\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#3-3-keepalived","title":"3-3 \u7b80\u8ff0Keepalived\u4f53\u7cfb\u4e3b\u8981\u6a21\u5757\u53ca\u5176\u4f5c\u7528\uff1f","text":"<p>keepalived\u4f53\u7cfb\u67b6\u6784\u4e2d\u4e3b\u8981\u6709\u4e09\u4e2a\u6a21\u5757\uff0c\u5206\u522b\u662fcore\u3001check\u548cvrrp\u3002</p> <ul> <li>core\u6a21\u5757\u4e3akeepalived\u7684\u6838\u5fc3\uff0c\u8d1f\u8d23\u4e3b\u8fdb\u7a0b\u7684\u542f\u52a8\u3001\u7ef4\u62a4\u53ca\u5168\u5c40\u914d\u7f6e\u6587\u4ef6\u7684\u52a0\u8f7d\u548c\u89e3\u6790\u3002</li> <li>vrrp\u6a21\u5757\u662f\u6765\u5b9e\u73b0VRRP\u534f\u8bae\u7684\u3002</li> <li>check\u8d1f\u8d23\u5065\u5eb7\u68c0\u67e5\uff0c\u5e38\u89c1\u7684\u65b9\u5f0f\u6709\u7aef\u53e3\u68c0\u67e5\u53caURL\u68c0\u67e5\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#3-4-keepalived","title":"3-4 \u7b80\u8ff0Keepalived\u5982\u4f55\u901a\u8fc7\u5065\u5eb7\u68c0\u67e5\u6765\u4fdd\u8bc1\u9ad8\u53ef\u7528\uff1f","text":"<p>Keepalived\u5de5\u4f5c\u5728TCP/IP\u6a21\u578b\u7684\u7b2c\u4e09\u3001\u56db\u548c\u4e94\u5c42\uff0c\u5373\u7f51\u7edc\u5c42\u3001\u4f20\u8f93\u5c42\u548c\u5e94\u7528\u5c42\u3002</p> <ul> <li>\u7f51\u7edc\u5c42\uff0cKeepalived\u91c7\u7528ICMP\u534f\u8bae\u5411\u670d\u52a1\u5668\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u53d1\u9001\u4e00\u4e2aICMP\u7684\u6570\u636e\u5305\uff0c\u5982\u679c\u67d0\u4e2a\u8282\u70b9\u6ca1\u6709\u8fd4\u56de\u54cd\u5e94\u6570\u636e\u5305\uff0c\u5219\u8ba4\u4e3a\u6b64\u8282\u70b9\u53d1\u751f\u4e86\u6545\u969c\uff0cKeepalived\u5c06\u62a5\u544a\u6b21\u8282\u70b9\u5931\u6548\uff0c\u5e76\u4ece\u670d\u52a1\u5668\u96c6\u7fa4\u4e2d\u5254\u9664\u6545\u969c\u8282\u70b9\u3002</li> <li>\u4f20\u8f93\u5c42\uff0cKeepalived\u5229\u7528TCP\u7684\u7aef\u53e3\u8fde\u63a5\u548c\u626b\u63cf\u6280\u672f\u6765\u5224\u65ad\u96c6\u7fa4\u8282\u70b9\u662f\u5426\u6b63\u5e38\u3002\u5982\u5e38\u89c1\u7684web\u670d\u52a1\u9ed8\u8ba4\u7aef\u53e380\uff0cssh\u9ed8\u8ba4\u7aef\u53e322\u7b49\u3002Keepalived\u4e00\u65e6\u5728\u4f20\u8f93\u5c42\u63a2\u6d4b\u5230\u76f8\u5e94\u7aef\u53e3\u6ca1\u7528\u54cd\u5e94\u6570\u636e\u8fd4\u56de\uff0c\u5219\u8ba4\u4e3a\u6b64\u7aef\u53e3\u53d1\u751f\u5f02\u5e38\uff0c\u4ece\u800c\u5c06\u6b64\u7aef\u53e3\u5bf9\u5e94\u7684\u8282\u70b9\u4ece\u670d\u52a1\u5668\u96c6\u7fa4\u4e2d\u5254\u9664\u3002</li> <li>\u5e94\u7528\u5c42\uff0c\u53ef\u4ee5\u8fd0\u884cFTP\u3001telnet\u3001smtp\u3001dns\u7b49\u5404\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u9ad8\u5c42\u534f\u8bae\uff0cKeepalived\u7684\u8fd0\u884c\u65b9\u5f0f\u4e5f\u66f4\u52a0\u5168\u9762\u5316\u548c\u590d\u6742\u5316\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u81ea\u5b9a\u4e49Keepalived\u7684\u5de5\u4f5c\u65b9\u5f0f\uff0c\u6765\u8bbe\u5b9a\u76d1\u6d4b\u5404\u79cd\u7a0b\u5e8f\u6216\u670d\u52a1\u662f\u5426\u6b63\u5e38\uff0c\u82e5\u76d1\u6d4b\u7ed3\u679c\u4e0e\u8bbe\u5b9a\u7684\u6b63\u5e38\u7ed3\u679c\u4e0d\u4e00\u81f4\uff0c\u5c06\u6b64\u670d\u52a1\u5bf9\u5e94\u7684\u8282\u70b9\u4ece\u670d\u52a1\u5668\u96c6\u7fa4\u4e2d\u5254\u9664\u3002</li> </ul> <p>Keepalived\u901a\u8fc7\u5b8c\u6574\u7684\u5065\u5eb7\u68c0\u67e5\u673a\u5236\uff0c\u4fdd\u8bc1\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u8282\u70b9\u5747\u6709\u6548\u4ece\u800c\u5b9e\u73b0\u9ad8\u53ef\u7528\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#4-lvs","title":"4\u3001 LVS","text":""},{"location":"chap4/5k8s_OpenShift/#4-1-lvs","title":"4-1 \u7b80\u8ff0LVS\u7684\u6982\u5ff5\u53ca\u5176\u4f5c\u7528\uff1f","text":"<p>LVS\u662flinux virtual server\u7684\u7b80\u5199linux\u865a\u62df\u670d\u52a1\u5668\uff0c\u662f\u4e00\u4e2a\u865a\u62df\u7684\u670d\u52a1\u5668\u96c6\u7fa4\u7cfb\u7edf\uff0c\u53ef\u4ee5\u5728unix/linux\u5e73\u53f0\u4e0b\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u96c6\u7fa4\u529f\u80fd\u3002</p> <p>LVS\u7684\u4e3b\u8981\u4f5c\u7528\u662f\uff1a\u901a\u8fc7LVS\u63d0\u4f9b\u7684\u8d1f\u8f7d\u5747\u8861\u6280\u672f\u5b9e\u73b0\u4e00\u4e2a\u9ad8\u6027\u80fd\u3001\u9ad8\u53ef\u7528\u7684\u670d\u52a1\u5668\u7fa4\u96c6\u3002\u56e0\u6b64LVS\u4e3b\u8981\u53ef\u4ee5\u5b9e\u73b0\uff1a</p> <ul> <li>\u628a\u5355\u53f0\u8ba1\u7b97\u673a\u65e0\u6cd5\u627f\u53d7\u7684\u5927\u89c4\u6a21\u7684\u5e76\u53d1\u8bbf\u95ee\u6216\u6570\u636e\u6d41\u91cf\u5206\u62c5\u5230\u591a\u53f0\u8282\u70b9\u8bbe\u5907\u4e0a\u5206\u522b\u5904\u7406\uff0c\u51cf\u5c11\u7528\u6237\u7b49\u5f85\u54cd\u5e94\u7684\u65f6\u95f4\uff0c\u63d0\u5347\u7528\u6237\u4f53\u9a8c\u3002</li> <li>\u5355\u4e2a\u91cd\u8d1f\u8f7d\u7684\u8fd0\u7b97\u5206\u62c5\u5230\u591a\u53f0\u8282\u70b9\u8bbe\u5907\u4e0a\u505a\u5e76\u884c\u5904\u7406\uff0c\u6bcf\u4e2a\u8282\u70b9\u8bbe\u5907\u5904\u7406\u7ed3\u675f\u540e\uff0c\u5c06\u7ed3\u679c\u6c47\u603b\uff0c\u8fd4\u56de\u7ed9\u7528\u6237\uff0c\u7cfb\u7edf\u5904\u7406\u80fd\u529b\u5f97\u5230\u5927\u5e45\u5ea6\u63d0\u9ad8\u3002</li> <li>7*24\u5c0f\u65f6\u7684\u670d\u52a1\u4fdd\u8bc1\uff0c\u4efb\u610f\u4e00\u4e2a\u6216\u591a\u4e2a\u8bbe\u5907\u8282\u70b9\u8bbe\u5907\u5b95\u673a\uff0c\u4e0d\u80fd\u5f71\u54cd\u5230\u4e1a\u52a1\u3002\u5728\u8d1f\u8f7d\u5747\u8861\u96c6\u7fa4\u4e2d\uff0c\u6240\u6709\u8ba1\u7b97\u673a\u8282\u70b9\u90fd\u5e94\u8be5\u63d0\u4f9b\u76f8\u540c\u7684\u670d\u52a1\uff0c\u96c6\u7fa4\u8d1f\u8f7d\u5747\u8861\u83b7\u53d6\u6240\u6709\u5bf9\u8be5\u670d\u52a1\u7684\u5982\u7ad9\u8bf7\u6c42\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#4-2-lvs","title":"4-2 \u7b80\u8ff0LVS\u7684\u5de5\u4f5c\u6a21\u5f0f\u53ca\u5176\u5de5\u4f5c\u8fc7\u7a0b\uff1f","text":"<p>LVS \u6709\u4e09\u79cd\u8d1f\u8f7d\u5747\u8861\u7684\u6a21\u5f0f\uff0c\u5206\u522b\u662fVS/NAT\uff08nat \u6a21\u5f0f\uff09\u3001VS/DR\uff08\u8def\u7531\u6a21\u5f0f\uff09\u3001VS/TUN\uff08\u96a7\u9053\u6a21\u5f0f\uff09\u3002</p> <p>NAT\u6a21\u5f0f\uff08VS-NAT\uff09</p> <ul> <li>\u539f\u7406\uff1a\u9996\u5148\u8d1f\u8f7d\u5747\u8861\u5668\u63a5\u6536\u5230\u5ba2\u6237\u7684\u8bf7\u6c42\u6570\u636e\u5305\u65f6\uff0c\u6839\u636e\u8c03\u5ea6\u7b97\u6cd5\u51b3\u5b9a\u5c06\u8bf7\u6c42\u53d1\u9001\u7ed9\u54ea\u4e2a\u540e\u7aef\u7684\u771f\u5b9e\u670d\u52a1\u5668\uff08RS\uff09\u3002\u7136\u540e\u8d1f\u8f7d\u5747\u8861\u5668\u5c31\u628a\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\u6570\u636e\u5305\u7684\u76ee\u6807IP\u5730\u5740\u53ca\u7aef\u53e3\u6539\u6210\u540e\u7aef\u771f\u5b9e\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff08RIP\uff09\u3002\u771f\u5b9e\u670d\u52a1\u5668\u54cd\u5e94\u5b8c\u8bf7\u6c42\u540e\uff0c\u67e5\u770b\u9ed8\u8ba4\u8def\u7531\uff0c\u628a\u54cd\u5e94\u540e\u7684\u6570\u636e\u5305\u53d1\u9001\u7ed9\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u5728\u63a5\u6536\u5230\u54cd\u5e94\u5305\u540e\uff0c\u628a\u5305\u7684\u6e90\u5730\u5740\u6539\u6210\u865a\u62df\u5730\u5740\uff08VIP\uff09\u7136\u540e\u53d1\u9001\u56de\u7ed9\u5ba2\u6237\u7aef\u3002</li> <li>\u4f18\u70b9\uff1a\u96c6\u7fa4\u4e2d\u7684\u670d\u52a1\u5668\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u652f\u6301TCP/IP\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u53ea\u8981\u8d1f\u8f7d\u5747\u8861\u5668\u6709\u4e00\u4e2a\u5408\u6cd5\u7684IP\u5730\u5740\u3002</li> <li>\u7f3a\u70b9\uff1a\u6269\u5c55\u6027\u6709\u9650\uff0c\u5f53\u670d\u52a1\u5668\u8282\u70b9\u589e\u957f\u8fc7\u591a\u65f6\uff0c\u7531\u4e8e\u6240\u6709\u7684\u8bf7\u6c42\u548c\u5e94\u7b54\u90fd\u9700\u8981\u7ecf\u8fc7\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u56e0\u6b64\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6210\u4e3a\u6574\u4e2a\u7cfb\u7edf\u7684\u74f6\u9888\u3002</li> </ul> <p>IP\u96a7\u9053\u6a21\u5f0f\uff08VS-TUN\uff09</p> <ul> <li>\u539f\u7406\uff1a\u9996\u5148\u8d1f\u8f7d\u5747\u8861\u5668\u63a5\u6536\u5230\u5ba2\u6237\u7684\u8bf7\u6c42\u6570\u636e\u5305\u65f6\uff0c\u6839\u636e\u8c03\u5ea6\u7b97\u6cd5\u51b3\u5b9a\u5c06\u8bf7\u6c42\u53d1\u9001\u7ed9\u54ea\u4e2a\u540e\u7aef\u7684\u771f\u5b9e\u670d\u52a1\u5668\uff08RS\uff09\u3002\u7136\u540e\u8d1f\u8f7d\u5747\u8861\u5668\u5c31\u628a\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\u62a5\u6587\u5c01\u88c5\u4e00\u5c42IP\u96a7\u9053\uff08T-IP\uff09\u8f6c\u53d1\u5230\u771f\u5b9e\u670d\u52a1\u5668\uff08RS\uff09\u3002\u771f\u5b9e\u670d\u52a1\u5668\u54cd\u5e94\u5b8c\u8bf7\u6c42\u540e\uff0c\u67e5\u770b\u9ed8\u8ba4\u8def\u7531\uff0c\u628a\u54cd\u5e94\u540e\u7684\u6570\u636e\u5305\u76f4\u63a5\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\uff0c\u4e0d\u9700\u8981\u7ecf\u8fc7\u8d1f\u8f7d\u5747\u8861\u5668\u3002</li> <li>\u4f18\u70b9\uff1a\u8d1f\u8f7d\u5747\u8861\u5668\u53ea\u8d1f\u8d23\u5c06\u8bf7\u6c42\u5305\u5206\u53d1\u7ed9\u540e\u7aef\u8282\u70b9\u670d\u52a1\u5668\uff0c\u800cRS\u5c06\u5e94\u7b54\u5305\u76f4\u63a5\u53d1\u7ed9\u7528\u6237\u3002\u6240\u4ee5\uff0c\u51cf\u5c11\u4e86\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u5927\u91cf\u6570\u636e\u6d41\u52a8\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u4e0d\u518d\u662f\u7cfb\u7edf\u7684\u74f6\u9888\uff0c\u4e5f\u80fd\u5904\u7406\u5f88\u5de8\u5927\u7684\u8bf7\u6c42\u91cf\u3002</li> <li>\u7f3a\u70b9\uff1a\u96a7\u9053\u6a21\u5f0f\u7684RS\u8282\u70b9\u9700\u8981\u5408\u6cd5IP\uff0c\u8fd9\u79cd\u65b9\u5f0f\u9700\u8981\u6240\u6709\u7684\u670d\u52a1\u5668\u652f\u6301\u201cIP Tunneling\u201d\u3002</li> </ul> <p>\u76f4\u63a5\u8def\u7531\u6a21\u5f0f\uff08VS-DR\uff09</p> <ul> <li>\u539f\u7406\uff1a\u9996\u5148\u8d1f\u8f7d\u5747\u8861\u5668\u63a5\u6536\u5230\u5ba2\u6237\u7684\u8bf7\u6c42\u6570\u636e\u5305\u65f6\uff0c\u6839\u636e\u8c03\u5ea6\u7b97\u6cd5\u51b3\u5b9a\u5c06\u8bf7\u6c42\u53d1\u9001\u7ed9\u54ea\u4e2a\u540e\u7aef\u7684\u771f\u5b9e\u670d\u52a1\u5668\uff08RS\uff09\u3002\u7136\u540e\u8d1f\u8f7d\u5747\u8861\u5668\u5c31\u628a\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\u6570\u636e\u5305\u7684\u76ee\u6807MAC\u5730\u5740\u6539\u6210\u540e\u7aef\u771f\u5b9e\u670d\u52a1\u5668\u7684MAC\u5730\u5740\uff08R-MAC\uff09\u3002\u771f\u5b9e\u670d\u52a1\u5668\u54cd\u5e94\u5b8c\u8bf7\u6c42\u540e\uff0c\u67e5\u770b\u9ed8\u8ba4\u8def\u7531\uff0c\u628a\u54cd\u5e94\u540e\u7684\u6570\u636e\u5305\u76f4\u63a5\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\uff0c\u4e0d\u9700\u8981\u7ecf\u8fc7\u8d1f\u8f7d\u5747\u8861\u5668\u3002</li> <li>\u4f18\u70b9\uff1a\u8d1f\u8f7d\u5747\u8861\u5668\u53ea\u8d1f\u8d23\u5c06\u8bf7\u6c42\u5305\u5206\u53d1\u7ed9\u540e\u7aef\u8282\u70b9\u670d\u52a1\u5668\uff0c\u800cRS\u5c06\u5e94\u7b54\u5305\u76f4\u63a5\u53d1\u7ed9\u7528\u6237\u3002\u6240\u4ee5\uff0c\u51cf\u5c11\u4e86\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u5927\u91cf\u6570\u636e\u6d41\u52a8\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u4e0d\u518d\u662f\u7cfb\u7edf\u7684\u74f6\u9888\uff0c\u4e5f\u80fd\u5904\u7406\u5f88\u5de8\u5927\u7684\u8bf7\u6c42\u91cf\u3002</li> <li>\u7f3a\u70b9\uff1a\u9700\u8981\u8d1f\u8f7d\u5747\u8861\u5668\u4e0e\u771f\u5b9e\u670d\u52a1\u5668RS\u90fd\u6709\u4e00\u5757\u7f51\u5361\u8fde\u63a5\u5230\u540c\u4e00\u7269\u7406\u7f51\u6bb5\u4e0a\uff0c\u5fc5\u987b\u5728\u540c\u4e00\u4e2a\u5c40\u57df\u7f51\u73af\u5883\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#4-3-lvs","title":"4-3 \u7b80\u8ff0LVS\u8c03\u5ea6\u5668\u5e38\u89c1\u7b97\u6cd5\uff08\u5747\u8861\u7b56\u7565\uff09\uff1f","text":"<p>LVS\u8c03\u5ea6\u5668\u7528\u7684\u8c03\u5ea6\u65b9\u6cd5\u57fa\u672c\u5206\u4e3a\u4e24\u7c7b\uff1a</p> <p>\u56fa\u5b9a\u8c03\u5ea6\u7b97\u6cd5\uff1arr\uff0cwrr\uff0cdh\uff0csh</p> <ul> <li>rr\uff1a\u8f6e\u8be2\u7b97\u6cd5\uff0c\u5c06\u8bf7\u6c42\u4f9d\u6b21\u5206\u914d\u7ed9\u4e0d\u540c\u7684rs\u8282\u70b9\uff0c\u5373RS\u8282\u70b9\u4e2d\u5747\u644a\u5206\u914d\u3002\u9002\u5408\u4e8eRS\u6240\u6709\u8282\u70b9\u5904\u7406\u6027\u80fd\u63a5\u8fd1\u7684\u60c5\u51b5\u3002</li> <li>wrr\uff1a\u52a0\u6743\u8f6e\u8bad\u8c03\u5ea6\uff0c\u4f9d\u636e\u4e0d\u540cRS\u7684\u6743\u503c\u5206\u914d\u4efb\u52a1\u3002\u6743\u503c\u8f83\u9ad8\u7684RS\u5c06\u4f18\u5148\u83b7\u5f97\u4efb\u52a1\uff0c\u5e76\u4e14\u5206\u914d\u5230\u7684\u8fde\u63a5\u6570\u5c06\u6bd4\u6743\u503c\u4f4e\u7684RS\u66f4\u591a\u3002\u76f8\u540c\u6743\u503c\u7684RS\u5f97\u5230\u76f8\u540c\u6570\u76ee\u7684\u8fde\u63a5\u6570\u3002</li> <li>dh\uff1a\u76ee\u7684\u5730\u5740\u54c8\u5e0c\u8c03\u5ea6\uff08destination hashing\uff09\u4ee5\u76ee\u7684\u5730\u5740\u4e3a\u5173\u952e\u5b57\u67e5\u627e\u4e00\u4e2a\u9759\u6001hash\u8868\u6765\u83b7\u5f97\u6240\u9700RS\u3002</li> <li>sh\uff1a\u6e90\u5730\u5740\u54c8\u5e0c\u8c03\u5ea6\uff08source hashing\uff09\u4ee5\u6e90\u5730\u5740\u4e3a\u5173\u952e\u5b57\u67e5\u627e\u4e00\u4e2a\u9759\u6001hash\u8868\u6765\u83b7\u5f97\u9700\u8981\u7684RS\u3002</li> </ul> <p>\u52a8\u6001\u8c03\u5ea6\u7b97\u6cd5\uff1awlc\uff0clc\uff0clblc\uff0clblcr</p> <ul> <li>wlc\uff1a\u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u6570\u8c03\u5ea6\uff0c\u5047\u8bbe\u5404\u53f0RS\u7684\u6743\u503c\u4f9d\u6b21\u4e3aWi\uff0c\u5f53\u524dtcp\u8fde\u63a5\u6570\u4f9d\u6b21\u4e3aTi\uff0c\u4f9d\u6b21\u53bbTi/Wi\u4e3a\u6700\u5c0f\u7684RS\u4f5c\u4e3a\u4e0b\u4e00\u4e2a\u5206\u914d\u7684RS\u3002</li> <li>lc\uff1a\u6700\u5c0f\u8fde\u63a5\u6570\u8c03\u5ea6\uff08least-connection\uff09\uff0cIPVS\u8868\u5b58\u50a8\u4e86\u6240\u6709\u6d3b\u52a8\u7684\u8fde\u63a5\u3002LB\u4f1a\u6bd4\u8f83\u5c06\u8fde\u63a5\u8bf7\u6c42\u53d1\u9001\u5230\u5f53\u524d\u8fde\u63a5\u6700\u5c11\u7684RS\u3002</li> <li>lblc\uff1a\u57fa\u4e8e\u5730\u5740\u7684\u6700\u5c0f\u8fde\u63a5\u6570\u8c03\u5ea6\uff08locality-based least-connection\uff09\uff1a\u5c06\u6765\u81ea\u540c\u4e00\u4e2a\u76ee\u7684\u5730\u5740\u7684\u8bf7\u6c42\u5206\u914d\u7ed9\u540c\u4e00\u53f0RS\uff0c\u6b64\u65f6\u8fd9\u53f0\u670d\u52a1\u5668\u662f\u5c1a\u672a\u6ee1\u8d1f\u8377\u7684\u3002\u5426\u5219\u5c31\u5c06\u8fd9\u4e2a\u8bf7\u6c42\u5206\u914d\u7ed9\u8fde\u63a5\u6570\u6700\u5c0f\u7684RS\uff0c\u5e76\u4ee5\u5b83\u4f5c\u4e3a\u4e0b\u4e00\u6b21\u5206\u914d\u7684\u9996\u5148\u8003\u8651\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#4-4-lvsnginxhaproxy","title":"4-4 \u7b80\u8ff0LVS\u3001Nginx\u3001HAProxy\u5404\u81ea\u4f18\u7f3a\u70b9\uff1f","text":"<p>Nginx\u7684\u4f18\u70b9\uff1a</p> <ul> <li>\u5de5\u4f5c\u5728\u7f51\u7edc\u76847\u5c42\u4e4b\u4e0a\uff0c\u53ef\u4ee5\u9488\u5bf9http\u5e94\u7528\u505a\u4e00\u4e9b\u5206\u6d41\u7684\u7b56\u7565\uff0c\u6bd4\u5982\u9488\u5bf9\u57df\u540d\u3001\u76ee\u5f55\u7ed3\u6784\u3002Nginx\u6b63\u5219\u89c4\u5219\u6bd4HAProxy\u66f4\u4e3a\u5f3a\u5927\u548c\u7075\u6d3b\u3002</li> <li>Nginx\u5bf9\u7f51\u7edc\u7a33\u5b9a\u6027\u7684\u4f9d\u8d56\u975e\u5e38\u5c0f\uff0c\u7406\u8bba\u4e0a\u80fdping\u901a\u5c31\u5c31\u80fd\u8fdb\u884c\u8d1f\u8f7d\u529f\u80fd\uff0cLVS\u5bf9\u7f51\u7edc\u7a33\u5b9a\u6027\u4f9d\u8d56\u6bd4\u8f83\u5927\uff0c\u7a33\u5b9a\u8981\u6c42\u76f8\u5bf9\u66f4\u9ad8\u3002</li> <li>Nginx\u5b89\u88c5\u548c\u914d\u7f6e\u3001\u6d4b\u8bd5\u6bd4\u8f83\u7b80\u5355\u3001\u65b9\u4fbf\uff0c\u6709\u6e05\u6670\u7684\u65e5\u5fd7\u7528\u4e8e\u6392\u67e5\u548c\u7ba1\u7406\uff0cLVS\u7684\u914d\u7f6e\u3001\u6d4b\u8bd5\u5c31\u8981\u82b1\u6bd4\u8f83\u957f\u7684\u65f6\u95f4\u4e86\u3002</li> <li>\u53ef\u4ee5\u627f\u62c5\u9ad8\u8d1f\u8f7d\u538b\u529b\u4e14\u7a33\u5b9a\uff0c\u4e00\u822c\u80fd\u652f\u6491\u51e0\u4e07\u6b21\u7684\u5e76\u53d1\u91cf\uff0c\u8d1f\u8f7d\u5ea6\u6bd4LVS\u76f8\u5bf9\u5c0f\u4e9b\u3002</li> <li>Nginx\u53ef\u4ee5\u901a\u8fc7\u7aef\u53e3\u68c0\u6d4b\u5230\u670d\u52a1\u5668\u5185\u90e8\u7684\u6545\u969c\uff0c\u6bd4\u5982\u6839\u636e\u670d\u52a1\u5668\u5904\u7406\u7f51\u9875\u8fd4\u56de\u7684\u72b6\u6001\u7801\u3001\u8d85\u65f6\u7b49\u7b49\u3002</li> <li>Nginx\u4e0d\u4ec5\u4ec5\u662f\u4e00\u6b3e\u4f18\u79c0\u7684\u8d1f\u8f7d\u5747\u8861\u5668/\u53cd\u5411\u4ee3\u7406\u8f6f\u4ef6\uff0c\u5b83\u540c\u65f6\u4e5f\u662f\u529f\u80fd\u5f3a\u5927\u7684Web\u5e94\u7528\u670d\u52a1\u5668\u3002</li> <li>Nginx\u4f5c\u4e3aWeb\u53cd\u5411\u52a0\u901f\u7f13\u5b58\u8d8a\u6765\u8d8a\u6210\u719f\u4e86\uff0c\u901f\u5ea6\u6bd4\u4f20\u7edf\u7684Squid\u670d\u52a1\u5668\u66f4\u5feb\uff0c\u5f88\u591a\u573a\u666f\u4e0b\u90fd\u5c06\u5176\u4f5c\u4e3a\u53cd\u5411\u4ee3\u7406\u52a0\u901f\u5668\u3002</li> <li>Nginx\u4f5c\u4e3a\u9759\u6001\u7f51\u9875\u548c\u56fe\u7247\u670d\u52a1\u5668\uff0c\u8fd9\u65b9\u9762\u7684\u6027\u80fd\u975e\u5e38\u4f18\u79c0\uff0c\u540c\u65f6\u7b2c\u4e09\u65b9\u6a21\u5757\u4e5f\u5f88\u591a\u3002</li> </ul> <p>Nginx\u7684\u7f3a\u70b9\uff1a</p> <ul> <li>Nginx\u4ec5\u80fd\u652f\u6301http\u3001https\u548cEmail\u534f\u8bae\uff0c\u8fd9\u6837\u5c31\u5728\u9002\u7528\u8303\u56f4\u4e0a\u9762\u5c0f\u4e9b\u3002</li> <li>\u5bf9\u540e\u7aef\u670d\u52a1\u5668\u7684\u5065\u5eb7\u68c0\u67e5\uff0c\u53ea\u652f\u6301\u901a\u8fc7\u7aef\u53e3\u6765\u68c0\u6d4b\uff0c\u4e0d\u652f\u6301\u901a\u8fc7url\u6765\u68c0\u6d4b\u3002</li> <li>\u4e0d\u652f\u6301Session\u7684\u76f4\u63a5\u4fdd\u6301\uff0c\u9700\u8981\u901a\u8fc7<code>ip_hash</code>\u6765\u89e3\u51b3\u3002</li> </ul> <p>LVS\u7684\u4f18\u70b9\uff1a</p> <ul> <li>\u6297\u8d1f\u8f7d\u80fd\u529b\u5f3a\u3001\u662f\u5de5\u4f5c\u5728\u7f51\u7edc4\u5c42\u4e4b\u4e0a\u4ec5\u4f5c\u5206\u53d1\u4e4b\u7528\uff0c\u6ca1\u6709\u6d41\u91cf\u7684\u4ea7\u751f\u3002\u56e0\u6b64\u8d1f\u8f7d\u5747\u8861\u8f6f\u4ef6\u91cc\u7684\u6027\u80fd\u6700\u5f3a\u7684\uff0c\u5bf9\u5185\u5b58\u548ccpu\u8d44\u6e90\u6d88\u8017\u6bd4\u8f83\u4f4e\u3002</li> <li>LVS\u5de5\u4f5c\u7a33\u5b9a\uff0c\u56e0\u4e3a\u5176\u672c\u8eab\u6297\u8d1f\u8f7d\u80fd\u529b\u5f88\u5f3a\uff0c\u81ea\u8eab\u6709\u5b8c\u6574\u7684\u53cc\u673a\u70ed\u5907\u65b9\u6848\u3002</li> <li>\u65e0\u6d41\u91cf\uff0cLVS\u53ea\u5206\u53d1\u8bf7\u6c42\uff0c\u800c\u6d41\u91cf\u5e76\u4e0d\u4ece\u5b83\u672c\u8eab\u51fa\u53bb\uff0c\u8fd9\u70b9\u4fdd\u8bc1\u4e86\u5747\u8861\u5668IO\u7684\u6027\u80fd\u4e0d\u4f1a\u6536\u5230\u5927\u6d41\u91cf\u7684\u5f71\u54cd\u3002</li> <li>\u5e94\u7528\u8303\u56f4\u8f83\u5e7f\uff0c\u56e0\u4e3aLVS\u5de5\u4f5c\u57284\u5c42\uff0c\u6240\u4ee5\u5b83\u51e0\u4e4e\u53ef\u5bf9\u6240\u6709\u5e94\u7528\u505a\u8d1f\u8f7d\u5747\u8861\uff0c\u5305\u62echttp\u3001\u6570\u636e\u5e93\u7b49\u3002</li> </ul> <p>LVS\u7684\u7f3a\u70b9\u662f\uff1a</p> <ul> <li>\u8f6f\u4ef6\u672c\u8eab\u4e0d\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\u5904\u7406\uff0c\u4e0d\u80fd\u505a\u52a8\u9759\u5206\u79bb\u3002\u76f8\u5bf9\u6765\u8bf4\uff0cNginx/HAProxy+Keepalived\u5219\u5177\u6709\u660e\u663e\u7684\u4f18\u52bf\u3002</li> <li>\u5982\u679c\u662f\u7f51\u7ad9\u5e94\u7528\u6bd4\u8f83\u5e9e\u5927\u7684\u8bdd\uff0cLVS/DR+Keepalived\u5b9e\u65bd\u8d77\u6765\u5c31\u6bd4\u8f83\u590d\u6742\u4e86\u3002\u76f8\u5bf9\u6765\u8bf4\uff0cNginx/HAProxy+Keepalived\u5c31\u7b80\u5355\u591a\u4e86\u3002</li> </ul> <p>HAProxy\u7684\u4f18\u70b9\uff1a</p> <ul> <li>HAProxy\u4e5f\u662f\u652f\u6301\u865a\u62df\u4e3b\u673a\u7684\u3002</li> <li>HAProxy\u7684\u4f18\u70b9\u80fd\u591f\u8865\u5145Nginx\u7684\u4e00\u4e9b\u7f3a\u70b9\uff0c\u6bd4\u5982\u652f\u6301Session\u7684\u4fdd\u6301\uff0cCookie\u7684\u5f15\u5bfc\uff0c\u540c\u65f6\u652f\u6301\u901a\u8fc7\u83b7\u53d6\u6307\u5b9a\u7684url\u6765\u68c0\u6d4b\u540e\u7aef\u670d\u52a1\u5668\u7684\u72b6\u6001\u3002</li> <li>HAProxy\u8ddfLVS\u7c7b\u4f3c\uff0c\u672c\u8eab\u5c31\u53ea\u662f\u4e00\u6b3e\u8d1f\u8f7d\u5747\u8861\u8f6f\u4ef6\uff0c\u5355\u7eaf\u4ece\u6548\u7387\u4e0a\u6765\u8bb2HAProxy\u4f1a\u6bd4Nginx\u6709\u66f4\u51fa\u8272\u7684\u8d1f\u8f7d\u5747\u8861\u901f\u5ea6\uff0c\u5728\u5e76\u53d1\u5904\u7406\u4e0a\u4e5f\u662f\u4f18\u4e8eNginx\u7684\u3002</li> <li>HAProxy\u652f\u6301TCP\u534f\u8bae\u7684\u8d1f\u8f7d\u5747\u8861\u8f6c\u53d1\u3002</li> </ul> <p>4-5 \u7b80\u8ff0\u4ee3\u7406\u670d\u52a1\u5668\u7684\u6982\u5ff5\u53ca\u5176\u4f5c\u7528\uff1f</p> <p>\u4ee3\u7406\u670d\u52a1\u5668\u662f\u4e00\u4e2a\u4f4d\u4e8e\u5ba2\u6237\u7aef\u548c\u539f\u59cb\uff08\u8d44\u6e90\uff09\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u670d\u52a1\u5668\uff0c\u4e3a\u4e86\u4ece\u539f\u59cb\u670d\u52a1\u5668\u53d6\u5f97\u5185\u5bb9\uff0c\u5ba2\u6237\u7aef\u5411\u4ee3\u7406\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u5e76\u6307\u5b9a\u76ee\u6807\u539f\u59cb\u670d\u52a1\u5668\uff0c\u7136\u540e\u4ee3\u7406\u670d\u52a1\u5668\u5411\u539f\u59cb\u670d\u52a1\u5668\u8f6c\u4ea4\u8bf7\u6c42\u5e76\u5c06\u83b7\u5f97\u7684\u5185\u5bb9\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002</p> <p>\u5176\u4e3b\u8981\u4f5c\u7528\u6709\uff1a</p> <ul> <li>\u8d44\u6e90\u83b7\u53d6\uff1a\u4ee3\u66ff\u5ba2\u6237\u7aef\u5b9e\u73b0\u4ece\u539f\u59cb\u670d\u52a1\u5668\u7684\u8d44\u6e90\u83b7\u53d6\uff1b</li> <li>\u52a0\u901f\u8bbf\u95ee\uff1a\u4ee3\u7406\u670d\u52a1\u5668\u53ef\u80fd\u79bb\u539f\u59cb\u670d\u52a1\u5668\u66f4\u8fd1\uff0c\u4ece\u800c\u8d77\u5230\u4e00\u5b9a\u7684\u52a0\u901f\u4f5c\u7528\uff1b</li> <li>\u7f13\u5b58\u4f5c\u7528\uff1a\u4ee3\u7406\u670d\u52a1\u5668\u4fdd\u5b58\u4ece\u539f\u59cb\u670d\u52a1\u5668\u6240\u83b7\u53d6\u7684\u8d44\u6e90\uff0c\u4ece\u800c\u5b9e\u73b0\u5ba2\u6237\u7aef\u5feb\u901f\u7684\u83b7\u53d6\uff1b</li> <li>\u9690\u85cf\u771f\u5b9e\u5730\u5740\uff1a\u4ee3\u7406\u670d\u52a1\u5668\u4ee3\u66ff\u5ba2\u6237\u7aef\u53bb\u83b7\u53d6\u539f\u59cb\u670d\u52a1\u5668\u8d44\u6e90\uff0c\u4ece\u800c\u9690\u85cf\u5ba2\u6237\u7aef\u771f\u5b9e\u4fe1\u606f\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#5","title":"5\u3001\u9ad8\u53ef\u7528\u96c6\u7fa4","text":""},{"location":"chap4/5k8s_OpenShift/#5-1","title":"5-1 \u7b80\u8ff0\u9ad8\u53ef\u7528\u96c6\u7fa4\u53ef\u901a\u8fc7\u54ea\u4e24\u4e2a\u7ef4\u5ea6\u8861\u91cf\u9ad8\u53ef\u7528\u6027\uff0c\u5404\u81ea\u542b\u4e49\u662f\u4ec0\u4e48\uff1f","text":"<ul> <li>RTO\uff08Recovery Time Objective\uff09\uff1aRTO\u6307\u670d\u52a1\u6062\u590d\u7684\u65f6\u95f4\uff0c\u6700\u4f73\u7684\u60c5\u51b5\u662f 0\uff0c\u5373\u670d\u52a1\u7acb\u5373\u6062\u590d\uff1b\u6700\u574f\u662f\u65e0\u7a77\u5927\uff0c\u5373\u670d\u52a1\u6c38\u8fdc\u65e0\u6cd5\u6062\u590d\uff1b</li> <li>RPO\uff08Recovery Point Objective\uff09\uff1aRPO \u6307\u6307\u5f53\u707e\u96be\u53d1\u751f\u65f6\u5141\u8bb8\u4e22\u5931\u7684\u6570\u636e\u91cf\uff0c0 \u610f\u5473\u7740\u4f7f\u7528\u540c\u6b65\u7684\u6570\u636e\uff0c\u5927\u4e8e 0 \u610f\u5473\u7740\u6709\u6570\u636e\u4e22\u5931\uff0c\u5982\u201cRPO=1 d\u201d\u6307\u6062\u590d\u65f6\u4f7f\u7528\u4e00\u5929\u524d\u7684\u6570\u636e\uff0c\u90a3\u4e48\u4e00\u5929\u4e4b\u5185\u7684\u6570\u636e\u5c31\u4e22\u5931\u4e86\u3002\u56e0\u6b64\uff0c\u6062\u590d\u7684\u6700\u4f73\u60c5\u51b5\u662f RTO = RPO = 0\uff0c\u51e0\u4e4e\u65e0\u6cd5\u5b9e\u73b0\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#5-2-cap","title":"5-2 \u7b80\u8ff0\u4ec0\u4e48\u662fCAP\u7406\u8bba\uff1f","text":"<p>CAP\u7406\u8bba\u6307\u51fa\u4e86\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u9700\u8981\u6ee1\u8db3\u7684\u4e09\u4e2a\u6761\u4ef6\uff0c\u4e3b\u8981\u5305\u62ec\uff1a</p> <ul> <li>Consistency\uff08\u4e00\u81f4\u6027\uff09\uff1a\u6240\u6709\u8282\u70b9\u5728\u540c\u4e00\u65f6\u95f4\u5177\u6709\u76f8\u540c\u7684\u6570\u636e\uff1b</li> <li>Availability\uff08\u53ef\u7528\u6027\uff09\uff1a\u4fdd\u8bc1\u6bcf\u4e2a\u8bf7\u6c42\u4e0d\u7ba1\u6210\u529f\u6216\u8005\u5931\u8d25\u90fd\u6709\u54cd\u5e94\uff1b</li> <li>Partition tolerance\uff08\u5206\u533a\u5bb9\u9519\u6027\uff09\uff1a\u7cfb\u7edf\u4e2d\u4efb\u610f\u4fe1\u606f\u7684\u4e22\u5931\u6216\u5931\u8d25\u4e0d\u5f71\u54cd\u7cfb\u7edf\u7684\u7ee7\u7eed\u8fd0\u884c\u3002</li> </ul> <p>CAP \u7406\u8bba\u7684\u6838\u5fc3\u662f\uff1a\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0d\u53ef\u80fd\u540c\u65f6\u5f88\u597d\u7684\u6ee1\u8db3\u4e00\u81f4\u6027\uff0c\u53ef\u7528\u6027\u548c\u5206\u533a\u5bb9\u9519\u6027\u8fd9\u4e09\u4e2a\u9700\u6c42\uff0c\u6700\u591a\u53ea\u80fd\u540c\u65f6\u8f83\u597d\u7684\u6ee1\u8db3\u4e24\u4e2a\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#5-3-acid","title":"5-3 \u7b80\u8ff0\u4ec0\u4e48\u662fACID\u7406\u8bba\uff1f","text":"<ul> <li>\u539f\u5b50\u6027(Atomicity)\uff1a\u6574\u4f53\u4e0d\u53ef\u5206\u5272\u6027\uff0c\u8981\u4e48\u5168\u505a\u8981\u4e0d\u5168\u4e0d\u505a\uff1b</li> <li>\u4e00\u81f4\u6027(Consistency)\uff1a\u4e8b\u52a1\u6267\u884c\u524d\u3001\u540e\u6570\u636e\u5e93\u72b6\u6001\u5747\u4e00\u81f4\uff1b</li> <li>\u9694\u79bb\u6027(Isolation)\uff1a\u5728\u4e8b\u52a1\u672a\u63d0\u4ea4\u524d\uff0c\u5b83\u64cd\u4f5c\u7684\u6570\u636e\uff0c\u5bf9\u5176\u5b83\u7528\u6237\u4e0d\u53ef\u89c1\uff1b</li> <li>\u6301\u4e45\u6027 (Durable)\uff1a\u4e00\u65e6\u4e8b\u52a1\u6210\u529f\uff0c\u5c06\u8fdb\u884c\u6c38\u4e45\u7684\u53d8\u66f4\uff0c\u8bb0\u5f55\u4e0eredo\u65e5\u5fd7\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6kubernetes","title":"6\u3001Kubernetes","text":""},{"location":"chap4/5k8s_OpenShift/#6-1-kubernetes","title":"6-1 \u7b80\u8ff0\u4ec0\u4e48\u662fKubernetes\uff1f","text":"<p>Kubernetes\u662f\u4e00\u4e2a\u5168\u65b0\u7684\u57fa\u4e8e\u5bb9\u5668\u6280\u672f\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u652f\u6491\u5e73\u53f0\u3002\u662fGoogle\u5f00\u6e90\u7684\u5bb9\u5668\u96c6\u7fa4\u7ba1\u7406\u7cfb\u7edf\uff08\u8c37\u6b4c\u5185\u90e8:Borg\uff09\u3002</p> <p>\u5728Docker\u6280\u672f\u7684\u57fa\u7840\u4e0a\uff0c\u4e3a\u5bb9\u5668\u5316\u7684\u5e94\u7528\u63d0\u4f9b\u90e8\u7f72\u8fd0\u884c\u3001\u8d44\u6e90\u8c03\u5ea6\u3001\u670d\u52a1\u53d1\u73b0\u548c\u52a8\u6001\u4f38\u7f29\u7b49\u4e00\u7cfb\u5217\u5b8c\u6574\u529f\u80fd\uff0c\u63d0\u9ad8\u4e86\u5927\u89c4\u6a21\u5bb9\u5668\u96c6\u7fa4\u7ba1\u7406\u7684\u4fbf\u6377\u6027\u3002\u5e76\u4e14\u5177\u6709\u5b8c\u5907\u7684\u96c6\u7fa4\u7ba1\u7406\u80fd\u529b\uff0c\u591a\u5c42\u6b21\u7684\u5b89\u5168\u9632\u62a4\u548c\u51c6\u5165\u673a\u5236\u3001\u591a\u79df\u6237\u5e94\u7528\u652f\u6491\u80fd\u529b\u3001\u900f\u660e\u7684\u670d\u52a1\u6ce8\u518c\u548c\u53d1\u73b0\u673a\u5236\u3001\u5167\u5efa\u667a\u80fd\u8d1f\u8f7d\u5747\u8861\u5668\u3001\u5f3a\u5927\u7684\u6545\u969c\u53d1\u73b0\u548c\u81ea\u6211\u4fee\u590d\u80fd\u529b\u3001\u670d\u52a1\u6eda\u52a8\u5347\u7ea7\u548c\u5728\u7ebf\u6269\u5bb9\u80fd\u529b\u3001\u53ef\u6269\u5c55\u7684\u8d44\u6e90\u81ea\u52a8\u8c03\u5ea6\u673a\u5236\u4ee5\u53ca\u591a\u7c92\u5ea6\u7684\u8d44\u6e90\u914d\u989d\u7ba1\u7406\u80fd\u529b\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-2-kubernetesdocker","title":"6-2 \u7b80\u8ff0Kubernetes\u548cDocker\u7684\u5173\u7cfb\uff1f","text":"<p>Docker \u63d0\u4f9b\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406\u548c\uff0cDocker \u955c\u50cf\u6784\u5efa\u8fd0\u884c\u65f6\u5bb9\u5668\u3002\u5b83\u7684\u4e3b\u8981\u4f18\u70b9\u662f\u5c06\u5c06\u8f6f\u4ef6/\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u6240\u9700\u7684\u8bbe\u7f6e\u548c\u4f9d\u8d56\u9879\u6253\u5305\u5230\u4e00\u4e2a\u5bb9\u5668\u4e2d\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u53ef\u79fb\u690d\u6027\u7b49\u4f18\u70b9\u3002</p> <p>Kubernetes \u7528\u4e8e\u5173\u8054\u548c\u7f16\u6392\u5728\u591a\u4e2a\u4e3b\u673a\u4e0a\u8fd0\u884c\u7684\u5bb9\u5668\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-3-kubernetesminikubekubectlkubelet","title":"6-3 \u7b80\u8ff0Kubernetes\u4e2d\u4ec0\u4e48\u662fMinikube\u3001Kubectl\u3001Kubelet\uff1f","text":"<ul> <li>Minikube \u662f\u4e00\u79cd\u53ef\u4ee5\u5728\u672c\u5730\u8f7b\u677e\u8fd0\u884c\u4e00\u4e2a\u5355\u8282\u70b9 Kubernetes \u7fa4\u96c6\u7684\u5de5\u5177\u3002</li> <li>Kubectl \u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u53ef\u4ee5\u4f7f\u7528\u8be5\u5de5\u5177\u63a7\u5236Kubernetes\u96c6\u7fa4\u7ba1\u7406\u5668\uff0c\u5982\u68c0\u67e5\u7fa4\u96c6\u8d44\u6e90\uff0c\u521b\u5efa\u3001\u5220\u9664\u548c\u66f4\u65b0\u7ec4\u4ef6\uff0c\u67e5\u770b\u5e94\u7528\u7a0b\u5e8f\u3002</li> <li>Kubelet \u662f\u4e00\u4e2a\u4ee3\u7406\u670d\u52a1\uff0c\u5b83\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u5e76\u4f7f\u4ece\u670d\u52a1\u5668\u4e0e\u4e3b\u670d\u52a1\u5668\u901a\u4fe1\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-4-kubernetes","title":"6-4 \u7b80\u8ff0Kubernetes\u5e38\u89c1\u7684\u90e8\u7f72\u65b9\u5f0f\uff1f","text":"<p>\u5e38\u89c1\u7684Kubernetes\u90e8\u7f72\u65b9\u5f0f\u6709\uff1a</p> <ul> <li>kubeadm\uff1a\u4e5f\u662f\u63a8\u8350\u7684\u4e00\u79cd\u90e8\u7f72\u65b9\u5f0f\uff1b</li> <li>\u4e8c\u8fdb\u5236\uff1a</li> <li>minikube\uff1a\u5728\u672c\u5730\u8f7b\u677e\u8fd0\u884c\u4e00\u4e2a\u5355\u8282\u70b9 Kubernetes \u7fa4\u96c6\u7684\u5de5\u5177\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-5-kubernetes","title":"6-5 \u7b80\u8ff0Kubernetes\u5982\u4f55\u5b9e\u73b0\u96c6\u7fa4\u7ba1\u7406\uff1f","text":"<p>\u5728\u96c6\u7fa4\u7ba1\u7406\u65b9\u9762\uff0cKubernetes\u5c06\u96c6\u7fa4\u4e2d\u7684\u673a\u5668\u5212\u5206\u4e3a\u4e00\u4e2aMaster\u8282\u70b9\u548c\u4e00\u7fa4\u5de5\u4f5c\u8282\u70b9Node\u3002</p> <p>\u5176\u4e2d\uff0c\u5728Master\u8282\u70b9\u8fd0\u884c\u7740\u96c6\u7fa4\u7ba1\u7406\u76f8\u5173\u7684\u4e00\u7ec4\u8fdb\u7a0b<code>kube-apiserver</code>\u3001<code>kube-controller-manager</code>\u548c<code>kube-scheduler</code>\uff0c\u8fd9\u4e9b\u8fdb\u7a0b\u5b9e\u73b0\u4e86\u6574\u4e2a\u96c6\u7fa4\u7684\u8d44\u6e90\u7ba1\u7406\u3001Pod\u8c03\u5ea6\u3001\u5f39\u6027\u4f38\u7f29\u3001\u5b89\u5168\u63a7\u5236\u3001\u7cfb\u7edf\u76d1\u63a7\u548c\u7ea0\u9519\u7b49\u7ba1\u7406\u80fd\u529b\uff0c\u5e76\u4e14\u90fd\u662f\u5168\u81ea\u52a8\u5b8c\u6210\u7684\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-6-kubernetes","title":"6-6 \u7b80\u8ff0Kubernetes\u7684\u4f18\u52bf\u3001\u9002\u5e94\u573a\u666f\u53ca\u5176\u7279\u70b9\uff1f","text":"<p>Kubernetes\u4f5c\u4e3a\u4e00\u4e2a\u5b8c\u5907\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u652f\u6491\u5e73\u53f0\uff0c\u5176\u4e3b\u8981\u4f18\u52bf\uff1a</p> <ul> <li>\u5bb9\u5668\u7f16\u6392</li> <li>\u8f7b\u91cf\u7ea7</li> <li>\u5f00\u6e90</li> <li>\u5f39\u6027\u4f38\u7f29</li> <li>\u8d1f\u8f7d\u5747\u8861</li> </ul> <p>Kubernetes\u5e38\u89c1\u573a\u666f\uff1a</p> <ul> <li>\u5feb\u901f\u90e8\u7f72\u5e94\u7528</li> <li>\u5feb\u901f\u6269\u5c55\u5e94\u7528</li> <li>\u65e0\u7f1d\u5bf9\u63a5\u65b0\u7684\u5e94\u7528\u529f\u80fd</li> <li>\u8282\u7701\u8d44\u6e90\uff0c\u4f18\u5316\u786c\u4ef6\u8d44\u6e90\u7684\u4f7f\u7528</li> </ul> <p>Kubernetes\u76f8\u5173\u7279\u70b9\uff1a</p> <ul> <li>\u53ef\u79fb\u690d: \u652f\u6301\u516c\u6709\u4e91\u3001\u79c1\u6709\u4e91\u3001\u6df7\u5408\u4e91\u3001\u591a\u91cd\u4e91\uff08multi-cloud\uff09\u3002</li> <li>\u53ef\u6269\u5c55: \u6a21\u5757\u5316,\u3001\u63d2\u4ef6\u5316\u3001\u53ef\u6302\u8f7d\u3001\u53ef\u7ec4\u5408\u3002</li> <li>\u81ea\u52a8\u5316: \u81ea\u52a8\u90e8\u7f72\u3001\u81ea\u52a8\u91cd\u542f\u3001\u81ea\u52a8\u590d\u5236\u3001\u81ea\u52a8\u4f38\u7f29/\u6269\u5c55\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-7-kubernetes","title":"6-7 \u7b80\u8ff0Kubernetes\u7684\u7f3a\u70b9\u6216\u5f53\u524d\u7684\u4e0d\u8db3\u4e4b\u5904\uff1f","text":"<p>Kubernetes\u5f53\u524d\u5b58\u5728\u7684\u7f3a\u70b9\uff08\u4e0d\u8db3\uff09\u5982\u4e0b\uff1a</p> <ul> <li>\u5b89\u88c5\u8fc7\u7a0b\u548c\u914d\u7f6e\u76f8\u5bf9\u56f0\u96be\u590d\u6742\u3002</li> <li>\u7ba1\u7406\u670d\u52a1\u76f8\u5bf9\u7e41\u7410\u3002</li> <li>\u8fd0\u884c\u548c\u7f16\u8bd1\u9700\u8981\u5f88\u591a\u65f6\u95f4\u3002</li> <li>\u5b83\u6bd4\u5176\u4ed6\u66ff\u4ee3\u54c1\u66f4\u6602\u8d35\u3002</li> <li>\u5bf9\u4e8e\u7b80\u5355\u7684\u5e94\u7528\u7a0b\u5e8f\u6765\u8bf4\uff0c\u53ef\u80fd\u4e0d\u9700\u8981\u6d89\u53caKubernetes\u5373\u53ef\u6ee1\u8db3\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-8-kubernetes","title":"6-8 \u7b80\u8ff0Kubernetes\u76f8\u5173\u57fa\u7840\u6982\u5ff5\uff1f","text":"<ul> <li>master\uff1ak8s\u96c6\u7fa4\u7684\u7ba1\u7406\u8282\u70b9\uff0c\u8d1f\u8d23\u7ba1\u7406\u96c6\u7fa4\uff0c\u63d0\u4f9b\u96c6\u7fa4\u7684\u8d44\u6e90\u6570\u636e\u8bbf\u95ee\u5165\u53e3\u3002\u62e5\u6709Etcd\u5b58\u50a8\u670d\u52a1\uff08\u53ef\u9009\uff09\uff0c\u8fd0\u884cApi Server\u8fdb\u7a0b\uff0cController Manager\u670d\u52a1\u8fdb\u7a0b\u53caScheduler\u670d\u52a1\u8fdb\u7a0b\u3002</li> <li>node\uff08worker\uff09\uff1aNode\uff08worker\uff09\u662fKubernetes\u96c6\u7fa4\u67b6\u6784\u4e2d\u8fd0\u884cPod\u7684\u670d\u52a1\u8282\u70b9\uff0c\u662fKubernetes\u96c6\u7fa4\u64cd\u4f5c\u7684\u5355\u5143\uff0c\u7528\u6765\u627f\u8f7d\u88ab\u5206\u914dPod\u7684\u8fd0\u884c\uff0c\u662fPod\u8fd0\u884c\u7684\u5bbf\u4e3b\u673a\u3002\u8fd0\u884cdocker eninge\u670d\u52a1\uff0c\u5b88\u62a4\u8fdb\u7a0bkunelet\u53ca\u8d1f\u8f7d\u5747\u8861\u5668kube-proxy\u3002</li> <li>pod\uff1a\u8fd0\u884c\u4e8eNode\u8282\u70b9\u4e0a\uff0c\u82e5\u5e72\u76f8\u5173\u5bb9\u5668\u7684\u7ec4\u5408\u3002Pod\u5185\u5305\u542b\u7684\u5bb9\u5668\u8fd0\u884c\u5728\u540c\u4e00\u5bbf\u4e3b\u673a\u4e0a\uff0c\u4f7f\u7528\u76f8\u540c\u7684\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\u3001IP\u5730\u5740\u548c\u7aef\u53e3\uff0c\u80fd\u591f\u901a\u8fc7localhost\u8fdb\u884c\u901a\u4fe1\u3002Pod\u662fKurbernetes\u8fdb\u884c\u521b\u5efa\u3001\u8c03\u5ea6\u548c\u7ba1\u7406\u7684\u6700\u5c0f\u5355\u4f4d\uff0c\u5b83\u63d0\u4f9b\u4e86\u6bd4\u5bb9\u5668\u66f4\u9ad8\u5c42\u6b21\u7684\u62bd\u8c61\uff0c\u4f7f\u5f97\u90e8\u7f72\u548c\u7ba1\u7406\u66f4\u52a0\u7075\u6d3b\u3002\u4e00\u4e2aPod\u53ef\u4ee5\u5305\u542b\u4e00\u4e2a\u5bb9\u5668\u6216\u8005\u591a\u4e2a\u76f8\u5173\u5bb9\u5668\u3002</li> <li>label\uff1aKubernetes\u4e2d\u7684Label\u5b9e\u8d28\u662f\u4e00\u7cfb\u5217\u7684Key/Value\u952e\u503c\u5bf9\uff0c\u5176\u4e2dkey\u4e0evalue\u53ef\u81ea\u5b9a\u4e49\u3002Label\u53ef\u4ee5\u9644\u52a0\u5230\u5404\u79cd\u8d44\u6e90\u5bf9\u8c61\u4e0a\uff0c\u5982Node\u3001Pod\u3001Service\u3001RC\u7b49\u3002\u4e00\u4e2a\u8d44\u6e90\u5bf9\u8c61\u53ef\u4ee5\u5b9a\u4e49\u4efb\u610f\u6570\u91cf\u7684Label\uff0c\u540c\u4e00\u4e2aLabel\u4e5f\u53ef\u4ee5\u88ab\u6dfb\u52a0\u5230\u4efb\u610f\u6570\u91cf\u7684\u8d44\u6e90\u5bf9\u8c61\u4e0a\u53bb\u3002Kubernetes\u901a\u8fc7Label Selector\uff08\u6807\u7b7e\u9009\u62e9\u5668\uff09\u67e5\u8be2\u548c\u7b5b\u9009\u8d44\u6e90\u5bf9\u8c61\u3002</li> <li>Replication Controller\uff1aReplication Controller\u7528\u6765\u7ba1\u7406Pod\u7684\u526f\u672c\uff0c\u4fdd\u8bc1\u96c6\u7fa4\u4e2d\u5b58\u5728\u6307\u5b9a\u6570\u91cf\u7684Pod\u526f\u672c\u3002\u96c6\u7fa4\u4e2d\u526f\u672c\u7684\u6570\u91cf\u5927\u4e8e\u6307\u5b9a\u6570\u91cf\uff0c\u5219\u4f1a\u505c\u6b62\u6307\u5b9a\u6570\u91cf\u4e4b\u5916\u7684\u591a\u4f59\u5bb9\u5668\u6570\u91cf\u3002\u53cd\u4e4b\uff0c\u5219\u4f1a\u542f\u52a8\u5c11\u4e8e\u6307\u5b9a\u6570\u91cf\u4e2a\u6570\u7684\u5bb9\u5668\uff0c\u4fdd\u8bc1\u6570\u91cf\u4e0d\u53d8\u3002Replication Controller\u662f\u5b9e\u73b0\u5f39\u6027\u4f38\u7f29\u3001\u52a8\u6001\u6269\u5bb9\u548c\u6eda\u52a8\u5347\u7ea7\u7684\u6838\u5fc3\u3002</li> <li>Deployment\uff1aDeployment\u5728\u5185\u90e8\u4f7f\u7528\u4e86RS\u6765\u5b9e\u73b0\u76ee\u7684\uff0cDeployment\u76f8\u5f53\u4e8eRC\u7684\u4e00\u6b21\u5347\u7ea7\uff0c\u5176\u6700\u5927\u7684\u7279\u8272\u4e3a\u53ef\u4ee5\u968f\u65f6\u83b7\u77e5\u5f53\u524dPod\u7684\u90e8\u7f72\u8fdb\u5ea6\u3002</li> <li>HPA\uff08Horizontal Pod Autoscaler\uff09\uff1aPod\u7684\u6a2a\u5411\u81ea\u52a8\u6269\u5bb9\uff0c\u4e5f\u662fKubernetes\u7684\u4e00\u79cd\u8d44\u6e90\uff0c\u901a\u8fc7\u8ffd\u8e2a\u5206\u6790RC\u63a7\u5236\u7684\u6240\u6709Pod\u76ee\u6807\u7684\u8d1f\u8f7d\u53d8\u5316\u60c5\u51b5\uff0c\u6765\u786e\u5b9a\u662f\u5426\u9700\u8981\u9488\u5bf9\u6027\u7684\u8c03\u6574Pod\u526f\u672c\u6570\u91cf\u3002</li> <li>Service\uff1aService\u5b9a\u4e49\u4e86Pod\u7684\u903b\u8f91\u96c6\u5408\u548c\u8bbf\u95ee\u8be5\u96c6\u5408\u7684\u7b56\u7565\uff0c\u662f\u771f\u5b9e\u670d\u52a1\u7684\u62bd\u8c61\u3002Service\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7edf\u4e00\u7684\u670d\u52a1\u8bbf\u95ee\u5165\u53e3\u4ee5\u53ca\u670d\u52a1\u4ee3\u7406\u548c\u53d1\u73b0\u673a\u5236\uff0c\u5173\u8054\u591a\u4e2a\u76f8\u540cLabel\u7684Pod\uff0c\u7528\u6237\u4e0d\u9700\u8981\u4e86\u89e3\u540e\u53f0Pod\u662f\u5982\u4f55\u8fd0\u884c\u3002</li> <li>Volume\uff1aVolume\u662fPod\u4e2d\u80fd\u591f\u88ab\u591a\u4e2a\u5bb9\u5668\u8bbf\u95ee\u7684\u5171\u4eab\u76ee\u5f55\uff0cKubernetes\u4e2d\u7684Volume\u662f\u5b9a\u4e49\u5728Pod\u4e0a\uff0c\u53ef\u4ee5\u88ab\u4e00\u4e2a\u6216\u591a\u4e2aPod\u4e2d\u7684\u5bb9\u5668\u6302\u8f7d\u5230\u67d0\u4e2a\u76ee\u5f55\u4e0b\u3002</li> <li>Namespace\uff1aNamespace\u7528\u4e8e\u5b9e\u73b0\u591a\u79df\u6237\u7684\u8d44\u6e90\u9694\u79bb\uff0c\u53ef\u5c06\u96c6\u7fa4\u5185\u90e8\u7684\u8d44\u6e90\u5bf9\u8c61\u5206\u914d\u5230\u4e0d\u540c\u7684Namespace\u4e2d\uff0c\u5f62\u6210\u903b\u8f91\u4e0a\u7684\u4e0d\u540c\u9879\u76ee\u3001\u5c0f\u7ec4\u6216\u7528\u6237\u7ec4\uff0c\u4fbf\u4e8e\u4e0d\u540c\u7684Namespace\u5728\u5171\u4eab\u4f7f\u7528\u6574\u4e2a\u96c6\u7fa4\u7684\u8d44\u6e90\u7684\u540c\u65f6\u8fd8\u80fd\u88ab\u5206\u522b\u7ba1\u7406\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-9-kubernetes","title":"6-9 \u7b80\u8ff0Kubernetes\u96c6\u7fa4\u76f8\u5173\u7ec4\u4ef6\uff1f","text":"<p>Kubernetes Master\u63a7\u5236\u7ec4\u4ef6\uff0c\u8c03\u5ea6\u7ba1\u7406\u6574\u4e2a\u7cfb\u7edf\uff08\u96c6\u7fa4\uff09\uff0c\u5305\u542b\u5982\u4e0b\u7ec4\u4ef6:</p> <ul> <li>Kubernetes API Server\uff1a\u4f5c\u4e3aKubernetes\u7cfb\u7edf\u7684\u5165\u53e3\uff0c\u5176\u5c01\u88c5\u4e86\u6838\u5fc3\u5bf9\u8c61\u7684\u589e\u5220\u6539\u67e5\u64cd\u4f5c\uff0c\u4ee5RESTful API\u63a5\u53e3\u65b9\u5f0f\u63d0\u4f9b\u7ed9\u5916\u90e8\u5ba2\u6237\u548c\u5185\u90e8\u7ec4\u4ef6\u8c03\u7528\uff0c\u96c6\u7fa4\u5185\u5404\u4e2a\u529f\u80fd\u6a21\u5757\u4e4b\u95f4\u6570\u636e\u4ea4\u4e92\u548c\u901a\u4fe1\u7684\u4e2d\u5fc3\u67a2\u7ebd\u3002</li> <li>Kubernetes Scheduler\uff1a\u4e3a\u65b0\u5efa\u7acb\u7684Pod\u8fdb\u884c\u8282\u70b9(node)\u9009\u62e9(\u5373\u5206\u914d\u673a\u5668)\uff0c\u8d1f\u8d23\u96c6\u7fa4\u7684\u8d44\u6e90\u8c03\u5ea6\u3002</li> <li>Kubernetes Controller\uff1a\u8d1f\u8d23\u6267\u884c\u5404\u79cd\u63a7\u5236\u5668\uff0c\u76ee\u524d\u5df2\u7ecf\u63d0\u4f9b\u4e86\u5f88\u591a\u63a7\u5236\u5668\u6765\u4fdd\u8bc1Kubernetes\u7684\u6b63\u5e38\u8fd0\u884c\u3002</li> <li>Replication Controller\uff1a\u7ba1\u7406\u7ef4\u62a4Replication Controller\uff0c\u5173\u8054Replication Controller\u548cPod\uff0c\u4fdd\u8bc1Replication Controller\u5b9a\u4e49\u7684\u526f\u672c\u6570\u91cf\u4e0e\u5b9e\u9645\u8fd0\u884cPod\u6570\u91cf\u4e00\u81f4\u3002</li> <li>Node Controller\uff1a\u7ba1\u7406\u7ef4\u62a4Node\uff0c\u5b9a\u671f\u68c0\u67e5Node\u7684\u5065\u5eb7\u72b6\u6001\uff0c\u6807\u8bc6\u51fa(\u5931\u6548|\u672a\u5931\u6548)\u7684Node\u8282\u70b9\u3002</li> <li>Namespace Controller\uff1a\u7ba1\u7406\u7ef4\u62a4Namespace\uff0c\u5b9a\u671f\u6e05\u7406\u65e0\u6548\u7684Namespace\uff0c\u5305\u62ecNamesapce\u4e0b\u7684API\u5bf9\u8c61\uff0c\u6bd4\u5982Pod\u3001Service\u7b49\u3002</li> <li>Service Controller\uff1a\u7ba1\u7406\u7ef4\u62a4Service\uff0c\u63d0\u4f9b\u8d1f\u8f7d\u4ee5\u53ca\u670d\u52a1\u4ee3\u7406\u3002</li> <li>EndPoints Controller\uff1a\u7ba1\u7406\u7ef4\u62a4Endpoints\uff0c\u5173\u8054Service\u548cPod\uff0c\u521b\u5efaEndpoints\u4e3aService\u7684\u540e\u7aef\uff0c\u5f53Pod\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u5b9e\u65f6\u66f4\u65b0Endpoints\u3002</li> <li>Service Account Controller\uff1a\u7ba1\u7406\u7ef4\u62a4Service Account\uff0c\u4e3a\u6bcf\u4e2aNamespace\u521b\u5efa\u9ed8\u8ba4\u7684Service Account\uff0c\u540c\u65f6\u4e3aService Account\u521b\u5efaService Account Secret\u3002</li> <li>Persistent Volume Controller\uff1a\u7ba1\u7406\u7ef4\u62a4Persistent Volume\u548cPersistent Volume Claim\uff0c\u4e3a\u65b0\u7684Persistent Volume Claim\u5206\u914dPersistent Volume\u8fdb\u884c\u7ed1\u5b9a\uff0c\u4e3a\u91ca\u653e\u7684Persistent Volume\u6267\u884c\u6e05\u7406\u56de\u6536\u3002</li> <li>Daemon Set Controller\uff1a\u7ba1\u7406\u7ef4\u62a4Daemon Set\uff0c\u8d1f\u8d23\u521b\u5efaDaemon Pod\uff0c\u4fdd\u8bc1\u6307\u5b9a\u7684Node\u4e0a\u6b63\u5e38\u7684\u8fd0\u884cDaemon Pod\u3002</li> <li>Deployment Controller\uff1a\u7ba1\u7406\u7ef4\u62a4Deployment\uff0c\u5173\u8054Deployment\u548cReplication Controller\uff0c\u4fdd\u8bc1\u8fd0\u884c\u6307\u5b9a\u6570\u91cf\u7684Pod\u3002\u5f53Deployment\u66f4\u65b0\u65f6\uff0c\u63a7\u5236\u5b9e\u73b0Replication Controller\u548cPod\u7684\u66f4\u65b0\u3002</li> <li>Job Controller\uff1a\u7ba1\u7406\u7ef4\u62a4Job\uff0c\u4e3aJod\u521b\u5efa\u4e00\u6b21\u6027\u4efb\u52a1Pod\uff0c\u4fdd\u8bc1\u5b8c\u6210Job\u6307\u5b9a\u5b8c\u6210\u7684\u4efb\u52a1\u6570\u76ee</li> <li>Pod Autoscaler Controller\uff1a\u5b9e\u73b0Pod\u7684\u81ea\u52a8\u4f38\u7f29\uff0c\u5b9a\u65f6\u83b7\u53d6\u76d1\u63a7\u6570\u636e\uff0c\u8fdb\u884c\u7b56\u7565\u5339\u914d\uff0c\u5f53\u6ee1\u8db3\u6761\u4ef6\u65f6\u6267\u884cPod\u7684\u4f38\u7f29\u52a8\u4f5c\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-10-kubernetes-rc","title":"6-10 \u7b80\u8ff0Kubernetes RC\u7684\u673a\u5236\uff1f","text":"<p>Replication Controller\u7528\u6765\u7ba1\u7406Pod\u7684\u526f\u672c\uff0c\u4fdd\u8bc1\u96c6\u7fa4\u4e2d\u5b58\u5728\u6307\u5b9a\u6570\u91cf\u7684Pod\u526f\u672c\u3002</p> <p>\u5f53\u5b9a\u4e49\u4e86RC\u5e76\u63d0\u4ea4\u81f3Kubernetes\u96c6\u7fa4\u4e2d\u4e4b\u540e\uff0cMaster\u8282\u70b9\u4e0a\u7684Controller Manager\u7ec4\u4ef6\u83b7\u6089\uff0c\u5e76\u540c\u65f6\u5de1\u68c0\u7cfb\u7edf\u4e2d\u5f53\u524d\u5b58\u6d3b\u7684\u76ee\u6807Pod\uff0c\u5e76\u786e\u4fdd\u76ee\u6807Pod\u5b9e\u4f8b\u7684\u6570\u91cf\u521a\u597d\u7b49\u4e8e\u6b64RC\u7684\u671f\u671b\u503c\uff0c\u82e5\u5b58\u5728\u8fc7\u591a\u7684Pod\u526f\u672c\u5728\u8fd0\u884c\uff0c\u7cfb\u7edf\u4f1a\u505c\u6b62\u4e00\u4e9bPod\uff0c\u53cd\u4e4b\u5219\u81ea\u52a8\u521b\u5efa\u4e00\u4e9bPod\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-11-kubernetes-replica-set-replication-controller","title":"6-11 \u7b80\u8ff0Kubernetes Replica Set \u548c Replication Controller \u4e4b\u95f4\u6709\u4ec0\u4e48\u533a\u522b\uff1f","text":"<p>Replica Set \u548c Replication Controller \u7c7b\u4f3c\uff0c\u90fd\u662f\u786e\u4fdd\u5728\u4efb\u4f55\u7ed9\u5b9a\u65f6\u95f4\u8fd0\u884c\u6307\u5b9a\u6570\u91cf\u7684 Pod \u526f\u672c\u3002\u4e0d\u540c\u4e4b\u5904\u5728\u4e8eRS \u4f7f\u7528\u57fa\u4e8e\u96c6\u5408\u7684\u9009\u62e9\u5668\uff0c\u800c Replication Controller \u4f7f\u7528\u57fa\u4e8e\u6743\u9650\u7684\u9009\u62e9\u5668\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-12-kube-proxy","title":"6-12 \u7b80\u8ff0kube-proxy\u4f5c\u7528\uff1f","text":"<p>kube-proxy \u8fd0\u884c\u5728\u6240\u6709\u8282\u70b9\u4e0a\uff0c\u5b83\u76d1\u542c apiserver \u4e2d service \u548c endpoint \u7684\u53d8\u5316\u60c5\u51b5\uff0c\u521b\u5efa\u8def\u7531\u89c4\u5219\u4ee5\u63d0\u4f9b\u670d\u52a1 IP \u548c\u8d1f\u8f7d\u5747\u8861\u529f\u80fd\u3002</p> <p>\u7b80\u5355\u7406\u89e3\u6b64\u8fdb\u7a0b\u662fService\u7684\u900f\u660e\u4ee3\u7406\u517c\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u5176\u6838\u5fc3\u529f\u80fd\u662f\u5c06\u5230\u67d0\u4e2aService\u7684\u8bbf\u95ee\u8bf7\u6c42\u8f6c\u53d1\u5230\u540e\u7aef\u7684\u591a\u4e2aPod\u5b9e\u4f8b\u4e0a\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-13-kube-proxy-iptables","title":"6-13 \u7b80\u8ff0kube-proxy iptables\u539f\u7406\uff1f","text":"<p>Kubernetes\u4ece1.2\u7248\u672c\u5f00\u59cb\uff0c\u5c06iptables\u4f5c\u4e3akube-proxy\u7684\u9ed8\u8ba4\u6a21\u5f0f\u3002</p> <p><code>iptables</code>\u6a21\u5f0f\u4e0b\u7684<code>kube-proxy</code>\u4e0d\u518d\u8d77\u5230<code>Proxy</code>\u7684\u4f5c\u7528\uff0c\u5176\u6838\u5fc3\u529f\u80fd\uff1a\u901a\u8fc7API Server\u7684Watch\u63a5\u53e3\u5b9e\u65f6\u8ddf\u8e2aService\u4e0eEndpoint\u7684\u53d8\u66f4\u4fe1\u606f\uff0c\u5e76\u66f4\u65b0\u5bf9\u5e94\u7684iptables\u89c4\u5219\uff0cClient\u7684\u8bf7\u6c42\u6d41\u91cf\u5219\u901a\u8fc7iptables\u7684NAT\u673a\u5236\u201c\u76f4\u63a5\u8def\u7531\u201d\u5230\u76ee\u6807Pod\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-14-kube-proxy-ipvs","title":"6-14 \u7b80\u8ff0kube-proxy ipvs\u539f\u7406\uff1f","text":"<p>IPVS\u5728Kubernetes1.11\u4e2d\u5347\u7ea7\u4e3aGA\u7a33\u5b9a\u7248\u3002IPVS\u5219\u4e13\u95e8\u7528\u4e8e\u9ad8\u6027\u80fd\u8d1f\u8f7d\u5747\u8861\uff0c\u5e76\u4f7f\u7528\u66f4\u9ad8\u6548\u7684\u6570\u636e\u7ed3\u6784\uff08Hash\u8868\uff09\uff0c\u5141\u8bb8\u51e0\u4e4e\u65e0\u9650\u7684\u89c4\u6a21\u6269\u5f20\uff0c\u56e0\u6b64\u88abkube-proxy\u91c7\u7eb3\u4e3a\u6700\u65b0\u6a21\u5f0f\u3002</p> <p>\u5728IPVS\u6a21\u5f0f\u4e0b\uff0c\u4f7f\u7528iptables\u7684\u6269\u5c55ipset\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u8c03\u7528iptables\u6765\u751f\u6210\u89c4\u5219\u94fe\u3002iptables\u89c4\u5219\u94fe\u662f\u4e00\u4e2a\u7ebf\u6027\u7684\u6570\u636e\u7ed3\u6784\uff0cipset\u5219\u5f15\u5165\u4e86\u5e26\u7d22\u5f15\u7684\u6570\u636e\u7ed3\u6784\uff0c\u56e0\u6b64\u5f53\u89c4\u5219\u5f88\u591a\u65f6\uff0c\u4e5f\u53ef\u4ee5\u5f88\u9ad8\u6548\u5730\u67e5\u627e\u548c\u5339\u914d\u3002</p> <p>\u53ef\u4ee5\u5c06ipset\u7b80\u5355\u7406\u89e3\u4e3a\u4e00\u4e2aIP\uff08\u6bb5\uff09\u7684\u96c6\u5408\uff0c\u8fd9\u4e2a\u96c6\u5408\u7684\u5185\u5bb9\u53ef\u4ee5\u662fIP\u5730\u5740\u3001IP\u7f51\u6bb5\u3001\u7aef\u53e3\u7b49\uff0ciptables\u53ef\u4ee5\u76f4\u63a5\u6dfb\u52a0\u89c4\u5219\u5bf9\u8fd9\u4e2a\u201c\u53ef\u53d8\u7684\u96c6\u5408\u201d\u8fdb\u884c\u64cd\u4f5c\uff0c\u8fd9\u6837\u505a\u7684\u597d\u5904\u5728\u4e8e\u53ef\u4ee5\u5927\u5927\u51cf\u5c11iptables\u89c4\u5219\u7684\u6570\u91cf\uff0c\u4ece\u800c\u51cf\u5c11\u6027\u80fd\u635f\u8017\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-15-kube-proxy-ipvsiptables","title":"6-15 \u7b80\u8ff0kube-proxy ipvs\u548ciptables\u7684\u5f02\u540c\uff1f","text":"<p>iptables\u4e0eIPVS\u90fd\u662f\u57fa\u4e8eNetfilter\u5b9e\u73b0\u7684\uff0c\u4f46\u56e0\u4e3a\u5b9a\u4f4d\u4e0d\u540c\uff0c\u4e8c\u8005\u6709\u7740\u672c\u8d28\u7684\u5dee\u522b\uff1aiptables\u662f\u4e3a\u9632\u706b\u5899\u800c\u8bbe\u8ba1\u7684\uff1bIPVS\u5219\u4e13\u95e8\u7528\u4e8e\u9ad8\u6027\u80fd\u8d1f\u8f7d\u5747\u8861\uff0c\u5e76\u4f7f\u7528\u66f4\u9ad8\u6548\u7684\u6570\u636e\u7ed3\u6784\uff08Hash\u8868\uff09\uff0c\u5141\u8bb8\u51e0\u4e4e\u65e0\u9650\u7684\u89c4\u6a21\u6269\u5f20\u3002</p> <p>\u4e0eiptables\u76f8\u6bd4\uff0cIPVS\u62e5\u6709\u4ee5\u4e0b\u660e\u663e\u4f18\u52bf\uff1a</p> <ul> <li>1\u3001\u4e3a\u5927\u578b\u96c6\u7fa4\u63d0\u4f9b\u4e86\u66f4\u597d\u7684\u53ef\u6269\u5c55\u6027\u548c\u6027\u80fd\uff1b</li> <li>2\u3001\u652f\u6301\u6bd4iptables\u66f4\u590d\u6742\u7684\u590d\u5236\u5747\u8861\u7b97\u6cd5\uff08\u6700\u5c0f\u8d1f\u8f7d\u3001\u6700\u5c11\u8fde\u63a5\u3001\u52a0\u6743\u7b49\uff09\uff1b</li> <li>3\u3001\u652f\u6301\u670d\u52a1\u5668\u5065\u5eb7\u68c0\u67e5\u548c\u8fde\u63a5\u91cd\u8bd5\u7b49\u529f\u80fd\uff1b</li> <li>4\u3001\u53ef\u4ee5\u52a8\u6001\u4fee\u6539ipset\u7684\u96c6\u5408\uff0c\u5373\u4f7fiptables\u7684\u89c4\u5219\u6b63\u5728\u4f7f\u7528\u8fd9\u4e2a\u96c6\u5408\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-16-kubernetespod","title":"6-16 \u7b80\u8ff0Kubernetes\u4e2d\u4ec0\u4e48\u662f\u9759\u6001Pod\uff1f","text":"<p>\u9759\u6001pod\u662f\u7531kubelet\u8fdb\u884c\u7ba1\u7406\u7684\u4ec5\u5b58\u5728\u4e8e\u7279\u5b9aNode\u7684Pod\u4e0a\uff0c\u4ed6\u4eec\u4e0d\u80fd\u901a\u8fc7API Server\u8fdb\u884c\u7ba1\u7406\uff0c\u65e0\u6cd5\u4e0eReplicationController\u3001Deployment\u6216\u8005DaemonSet\u8fdb\u884c\u5173\u8054\uff0c\u5e76\u4e14kubelet\u65e0\u6cd5\u5bf9\u4ed6\u4eec\u8fdb\u884c\u5065\u5eb7\u68c0\u67e5\u3002</p> <p>\u9759\u6001Pod\u603b\u662f\u7531kubelet\u8fdb\u884c\u521b\u5efa\uff0c\u5e76\u4e14\u603b\u662f\u5728kubelet\u6240\u5728\u7684Node\u4e0a\u8fd0\u884c\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-17-kubernetespod","title":"6-17 \u7b80\u8ff0Kubernetes\u4e2dPod\u53ef\u80fd\u4f4d\u4e8e\u7684\u72b6\u6001\uff1f","text":"<ul> <li>Pending\uff1aAPI Server\u5df2\u7ecf\u521b\u5efa\u8be5Pod\uff0c\u4e14Pod\u5185\u8fd8\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u5bb9\u5668\u7684\u955c\u50cf\u6ca1\u6709\u521b\u5efa\uff0c\u5305\u62ec\u6b63\u5728\u4e0b\u8f7d\u955c\u50cf\u7684\u8fc7\u7a0b\u3002</li> <li>Running\uff1aPod\u5185\u6240\u6709\u5bb9\u5668\u5747\u5df2\u521b\u5efa\uff0c\u4e14\u81f3\u5c11\u6709\u4e00\u4e2a\u5bb9\u5668\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u3001\u6b63\u5728\u542f\u52a8\u72b6\u6001\u6216\u6b63\u5728\u91cd\u542f\u72b6\u6001\u3002</li> <li>Succeeded\uff1aPod\u5185\u6240\u6709\u5bb9\u5668\u5747\u6210\u529f\u6267\u884c\u9000\u51fa\uff0c\u4e14\u4e0d\u4f1a\u91cd\u542f\u3002</li> <li>Failed\uff1aPod\u5185\u6240\u6709\u5bb9\u5668\u5747\u5df2\u9000\u51fa\uff0c\u4f46\u81f3\u5c11\u6709\u4e00\u4e2a\u5bb9\u5668\u9000\u51fa\u4e3a\u5931\u8d25\u72b6\u6001\u3002</li> <li>Unknown\uff1a\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u65e0\u6cd5\u83b7\u53d6\u8be5Pod\u72b6\u6001\uff0c\u53ef\u80fd\u7531\u4e8e\u7f51\u7edc\u901a\u4fe1\u4e0d\u7545\u5bfc\u81f4</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-18-kubernetespod","title":"6-18 \u7b80\u8ff0Kubernetes\u521b\u5efa\u4e00\u4e2aPod\u7684\u4e3b\u8981\u6d41\u7a0b\uff1f","text":"<p>Kubernetes\u4e2d\u521b\u5efa\u4e00\u4e2aPod\u6d89\u53ca\u591a\u4e2a\u7ec4\u4ef6\u4e4b\u95f4\u8054\u52a8\uff0c\u4e3b\u8981\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>1\u3001\u5ba2\u6237\u7aef\u63d0\u4ea4Pod\u7684\u914d\u7f6e\u4fe1\u606f\uff08\u53ef\u4ee5\u662fyaml\u6587\u4ef6\u5b9a\u4e49\u7684\u4fe1\u606f\uff09\u5230kube-apiserver\u3002</li> <li>2\u3001Apiserver\u6536\u5230\u6307\u4ee4\u540e\uff0c\u901a\u77e5\u7ed9controller-manager\u521b\u5efa\u4e00\u4e2a\u8d44\u6e90\u5bf9\u8c61\u3002</li> <li>3\u3001Controller-manager\u901a\u8fc7api-server\u5c06pod\u7684\u914d\u7f6e\u4fe1\u606f\u5b58\u50a8\u5230ETCD\u6570\u636e\u4e2d\u5fc3\u4e2d\u3002</li> <li>4\u3001Kube-scheduler\u68c0\u6d4b\u5230pod\u4fe1\u606f\u4f1a\u5f00\u59cb\u8c03\u5ea6\u9884\u9009\uff0c\u4f1a\u5148\u8fc7\u6ee4\u6389\u4e0d\u7b26\u5408Pod\u8d44\u6e90\u914d\u7f6e\u8981\u6c42\u7684\u8282\u70b9\uff0c\u7136\u540e\u5f00\u59cb\u8c03\u5ea6\u8c03\u4f18\uff0c\u4e3b\u8981\u662f\u6311\u9009\u51fa\u66f4\u9002\u5408\u8fd0\u884cpod\u7684\u8282\u70b9\uff0c\u7136\u540e\u5c06pod\u7684\u8d44\u6e90\u914d\u7f6e\u5355\u53d1\u9001\u5230node\u8282\u70b9\u4e0a\u7684kubelet\u7ec4\u4ef6\u4e0a\u3002</li> <li>5\u3001Kubelet\u6839\u636escheduler\u53d1\u6765\u7684\u8d44\u6e90\u914d\u7f6e\u5355\u8fd0\u884cpod\uff0c\u8fd0\u884c\u6210\u529f\u540e\uff0c\u5c06pod\u7684\u8fd0\u884c\u4fe1\u606f\u8fd4\u56de\u7ed9scheduler\uff0cscheduler\u5c06\u8fd4\u56de\u7684pod\u8fd0\u884c\u72b6\u51b5\u7684\u4fe1\u606f\u5b58\u50a8\u5230etcd\u6570\u636e\u4e2d\u5fc3\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-19-kubernetespod","title":"6-19 \u7b80\u8ff0Kubernetes\u4e2dPod\u7684\u91cd\u542f\u7b56\u7565\uff1f","text":"<p>Pod\u91cd\u542f\u7b56\u7565\uff08RestartPolicy\uff09\u5e94\u7528\u4e8ePod\u5185\u7684\u6240\u6709\u5bb9\u5668\uff0c\u5e76\u4e14\u4ec5\u5728Pod\u6240\u5904\u7684Node\u4e0a\u7531kubelet\u8fdb\u884c\u5224\u65ad\u548c\u91cd\u542f\u64cd\u4f5c\u3002\u5f53\u67d0\u4e2a\u5bb9\u5668\u5f02\u5e38\u9000\u51fa\u6216\u8005\u5065\u5eb7\u68c0\u67e5\u5931\u8d25\u65f6\uff0ckubelet\u5c06\u6839\u636eRestartPolicy\u7684\u8bbe\u7f6e\u6765\u8fdb\u884c\u76f8\u5e94\u64cd\u4f5c\u3002</p> <p>Pod\u7684\u91cd\u542f\u7b56\u7565\u5305\u62ecAlways\u3001OnFailure\u548cNever\uff0c\u9ed8\u8ba4\u503c\u4e3aAlways\u3002</p> <ul> <li>Always\uff1a\u5f53\u5bb9\u5668\u5931\u6548\u65f6\uff0c\u7531kubelet\u81ea\u52a8\u91cd\u542f\u8be5\u5bb9\u5668\uff1b</li> <li>OnFailure\uff1a\u5f53\u5bb9\u5668\u7ec8\u6b62\u8fd0\u884c\u4e14\u9000\u51fa\u7801\u4e0d\u4e3a0\u65f6\uff0c\u7531kubelet\u81ea\u52a8\u91cd\u542f\u8be5\u5bb9\u5668\uff1b</li> <li>Never\uff1a\u4e0d\u8bba\u5bb9\u5668\u8fd0\u884c\u72b6\u6001\u5982\u4f55\uff0ckubelet\u90fd\u4e0d\u4f1a\u91cd\u542f\u8be5\u5bb9\u5668\u3002</li> </ul> <p>\u540c\u65f6Pod\u7684\u91cd\u542f\u7b56\u7565\u4e0e\u63a7\u5236\u65b9\u5f0f\u5173\u8054\uff0c\u5f53\u524d\u53ef\u7528\u4e8e\u7ba1\u7406Pod\u7684\u63a7\u5236\u5668\u5305\u62ecReplicationController\u3001Job\u3001DaemonSet\u53ca\u76f4\u63a5\u7ba1\u7406kubelet\u7ba1\u7406\uff08\u9759\u6001Pod\uff09\u3002</p> <p>\u4e0d\u540c\u63a7\u5236\u5668\u7684\u91cd\u542f\u7b56\u7565\u9650\u5236\u5982\u4e0b\uff1a</p> <ul> <li>RC\u548cDaemonSet\uff1a\u5fc5\u987b\u8bbe\u7f6e\u4e3aAlways\uff0c\u9700\u8981\u4fdd\u8bc1\u8be5\u5bb9\u5668\u6301\u7eed\u8fd0\u884c\uff1b</li> <li>Job\uff1aOnFailure\u6216Never\uff0c\u786e\u4fdd\u5bb9\u5668\u6267\u884c\u5b8c\u6210\u540e\u4e0d\u518d\u91cd\u542f\uff1b</li> <li>kubelet\uff1a\u5728Pod\u5931\u6548\u65f6\u91cd\u542f\uff0c\u4e0d\u8bba\u5c06RestartPolicy\u8bbe\u7f6e\u4e3a\u4f55\u503c\uff0c\u4e5f\u4e0d\u4f1a\u5bf9Pod\u8fdb\u884c\u5065\u5eb7\u68c0\u67e5\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-20-kubernetespod","title":"6-20 \u7b80\u8ff0Kubernetes\u4e2dPod\u7684\u5065\u5eb7\u68c0\u67e5\u65b9\u5f0f\uff1f","text":"<p>\u5bf9Pod\u7684\u5065\u5eb7\u68c0\u67e5\u53ef\u4ee5\u901a\u8fc7\u4e24\u7c7b\u63a2\u9488\u6765\u68c0\u67e5\uff1aLivenessProbe\u548cReadinessProbe\u3002</p> <ul> <li>LivenessProbe\u63a2\u9488\uff1a\u7528\u4e8e\u5224\u65ad\u5bb9\u5668\u662f\u5426\u5b58\u6d3b\uff08running\u72b6\u6001\uff09\uff0c\u5982\u679cLivenessProbe\u63a2\u9488\u63a2\u6d4b\u5230\u5bb9\u5668\u4e0d\u5065\u5eb7\uff0c\u5219kubelet\u5c06\u6740\u6389\u8be5\u5bb9\u5668\uff0c\u5e76\u6839\u636e\u5bb9\u5668\u7684\u91cd\u542f\u7b56\u7565\u505a\u76f8\u5e94\u5904\u7406\u3002\u82e5\u4e00\u4e2a\u5bb9\u5668\u4e0d\u5305\u542bLivenessProbe\u63a2\u9488\uff0ckubelet\u8ba4\u4e3a\u8be5\u5bb9\u5668\u7684LivenessProbe\u63a2\u9488\u8fd4\u56de\u503c\u7528\u4e8e\u662f\u201cSuccess\u201d\u3002</li> <li>ReadineeProbe\u63a2\u9488\uff1a\u7528\u4e8e\u5224\u65ad\u5bb9\u5668\u662f\u5426\u542f\u52a8\u5b8c\u6210\uff08ready\u72b6\u6001\uff09\u3002\u5982\u679cReadinessProbe\u63a2\u9488\u63a2\u6d4b\u5230\u5931\u8d25\uff0c\u5219Pod\u7684\u72b6\u6001\u5c06\u88ab\u4fee\u6539\u3002Endpoint Controller\u5c06\u4eceService\u7684Endpoint\u4e2d\u5220\u9664\u5305\u542b\u8be5\u5bb9\u5668\u6240\u5728Pod\u7684Eenpoint\u3002</li> <li>startupProbe\u63a2\u9488\uff1a\u542f\u52a8\u68c0\u67e5\u673a\u5236\uff0c\u5e94\u7528\u4e00\u4e9b\u542f\u52a8\u7f13\u6162\u7684\u4e1a\u52a1\uff0c\u907f\u514d\u4e1a\u52a1\u957f\u65f6\u95f4\u542f\u52a8\u800c\u88ab\u4e0a\u9762\u4e24\u7c7b\u63a2\u9488kill\u6389\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-21-kubernetes-podlivenessprobe","title":"6-21 \u7b80\u8ff0Kubernetes Pod\u7684LivenessProbe\u63a2\u9488\u7684\u5e38\u89c1\u65b9\u5f0f\uff1f","text":"<p>kubelet\u5b9a\u671f\u6267\u884cLivenessProbe\u63a2\u9488\u6765\u8bca\u65ad\u5bb9\u5668\u7684\u5065\u5eb7\u72b6\u6001\uff0c\u901a\u5e38\u6709\u4ee5\u4e0b\u4e09\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li>ExecAction\uff1a\u5728\u5bb9\u5668\u5185\u6267\u884c\u4e00\u4e2a\u547d\u4ee4\uff0c\u82e5\u8fd4\u56de\u7801\u4e3a0\uff0c\u5219\u8868\u660e\u5bb9\u5668\u5065\u5eb7\u3002</li> <li>TCPSocketAction\uff1a\u901a\u8fc7\u5bb9\u5668\u7684IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u6267\u884cTCP\u68c0\u67e5\uff0c\u82e5\u80fd\u5efa\u7acbTCP\u8fde\u63a5\uff0c\u5219\u8868\u660e\u5bb9\u5668\u5065\u5eb7\u3002</li> <li>HTTPGetAction\uff1a\u901a\u8fc7\u5bb9\u5668\u7684IP\u5730\u5740\u3001\u7aef\u53e3\u53f7\u53ca\u8def\u5f84\u8c03\u7528HTTP Get\u65b9\u6cd5\uff0c\u82e5\u54cd\u5e94\u7684\u72b6\u6001\u7801\u5927\u4e8e\u7b49\u4e8e200\u4e14\u5c0f\u4e8e400\uff0c\u5219\u8868\u660e\u5bb9\u5668\u5065\u5eb7\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-22-kubernetes-pod","title":"6-22 \u7b80\u8ff0Kubernetes Pod\u7684\u5e38\u89c1\u8c03\u5ea6\u65b9\u5f0f\uff1f","text":"<p>Kubernetes\u4e2d\uff0cPod\u901a\u5e38\u662f\u5bb9\u5668\u7684\u8f7d\u4f53\uff0c\u4e3b\u8981\u6709\u5982\u4e0b\u5e38\u89c1\u8c03\u5ea6\u65b9\u5f0f\uff1a</p> <ul> <li>Deployment\u6216RC\uff1a\u8be5\u8c03\u5ea6\u7b56\u7565\u4e3b\u8981\u529f\u80fd\u5c31\u662f\u81ea\u52a8\u90e8\u7f72\u4e00\u4e2a\u5bb9\u5668\u5e94\u7528\u7684\u591a\u4efd\u526f\u672c\uff0c\u4ee5\u53ca\u6301\u7eed\u76d1\u63a7\u526f\u672c\u7684\u6570\u91cf\uff0c\u5728\u96c6\u7fa4\u5185\u59cb\u7ec8\u7ef4\u6301\u7528\u6237\u6307\u5b9a\u7684\u526f\u672c\u6570\u91cf\u3002</li> <li>NodeSelector\uff1a\u5b9a\u5411\u8c03\u5ea6\uff0c\u5f53\u9700\u8981\u624b\u52a8\u6307\u5b9a\u5c06Pod\u8c03\u5ea6\u5230\u7279\u5b9aNode\u4e0a\uff0c\u53ef\u4ee5\u901a\u8fc7Node\u7684\u6807\u7b7e\uff08Label\uff09\u548cPod\u7684nodeSelector\u5c5e\u6027\u76f8\u5339\u914d\u3002</li> <li>NodeAffinity\u4eb2\u548c\u6027\u8c03\u5ea6\uff1a\u4eb2\u548c\u6027\u8c03\u5ea6\u673a\u5236\u6781\u5927\u7684\u6269\u5c55\u4e86Pod\u7684\u8c03\u5ea6\u80fd\u529b\uff0c\u76ee\u524d\u6709\u4e24\u79cd\u8282\u70b9\u4eb2\u548c\u529b\u8868\u8fbe\uff1a</li> <li>requiredDuringSchedulingIgnoredDuringExecution\uff1a\u786c\u89c4\u5219\uff0c\u5fc5\u987b\u6ee1\u8db3\u6307\u5b9a\u7684\u89c4\u5219\uff0c\u8c03\u5ea6\u5668\u624d\u53ef\u4ee5\u8c03\u5ea6Pod\u81f3Node\u4e0a\uff08\u7c7b\u4f3cnodeSelector\uff0c\u8bed\u6cd5\u4e0d\u540c\uff09\u3002</li> <li>preferredDuringSchedulingIgnoredDuringExecution\uff1a\u8f6f\u89c4\u5219\uff0c\u4f18\u5148\u8c03\u5ea6\u81f3\u6ee1\u8db3\u7684Node\u7684\u8282\u70b9\uff0c\u4f46\u4e0d\u5f3a\u6c42\uff0c\u591a\u4e2a\u4f18\u5148\u7ea7\u89c4\u5219\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u6743\u91cd\u503c\u3002</li> <li>Taints\u548cTolerations\uff08\u6c61\u70b9\u548c\u5bb9\u5fcd\uff09\uff1a</li> <li>Taint\uff1a\u4f7fNode\u62d2\u7edd\u7279\u5b9aPod\u8fd0\u884c\uff1b</li> <li>Toleration\uff1a\u4e3aPod\u7684\u5c5e\u6027\uff0c\u8868\u793aPod\u80fd\u5bb9\u5fcd\uff08\u8fd0\u884c\uff09\u6807\u6ce8\u4e86Taint\u7684Node\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-23-kubernetesinit-container","title":"6-23 \u7b80\u8ff0Kubernetes\u521d\u59cb\u5316\u5bb9\u5668\uff08init container\uff09\uff1f","text":"<p><code>init container</code>\u7684\u8fd0\u884c\u65b9\u5f0f\u4e0e\u5e94\u7528\u5bb9\u5668\u4e0d\u540c\uff0c\u5b83\u4eec\u5fc5\u987b\u5148\u4e8e\u5e94\u7528\u5bb9\u5668\u6267\u884c\u5b8c\u6210\uff0c\u5f53\u8bbe\u7f6e\u4e86\u591a\u4e2ainit container\u65f6\uff0c\u5c06\u6309\u987a\u5e8f\u9010\u4e2a\u8fd0\u884c\uff0c\u5e76\u4e14\u53ea\u6709\u524d\u4e00\u4e2ainit container\u8fd0\u884c\u6210\u529f\u540e\u624d\u80fd\u8fd0\u884c\u540e\u4e00\u4e2ainit container\u3002</p> <p>\u5f53\u6240\u6709init container\u90fd\u6210\u529f\u8fd0\u884c\u540e\uff0cKubernetes\u624d\u4f1a\u521d\u59cb\u5316Pod\u7684\u5404\u79cd\u4fe1\u606f\uff0c\u5e76\u5f00\u59cb\u521b\u5efa\u548c\u8fd0\u884c\u5e94\u7528\u5bb9\u5668\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-24-kubernetes-deployment","title":"6-24 \u7b80\u8ff0Kubernetes deployment\u5347\u7ea7\u8fc7\u7a0b\uff1f","text":"<ul> <li>\u521d\u59cb\u521b\u5efaDeployment\u65f6\uff0c\u7cfb\u7edf\u521b\u5efa\u4e86\u4e00\u4e2aReplicaSet\uff0c\u5e76\u6309\u7528\u6237\u7684\u9700\u6c42\u521b\u5efa\u4e86\u5bf9\u5e94\u6570\u91cf\u7684Pod\u526f\u672c\u3002</li> <li>\u5f53\u66f4\u65b0Deployment\u65f6\uff0c\u7cfb\u7edf\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684ReplicaSet\uff0c\u5e76\u5c06\u5176\u526f\u672c\u6570\u91cf\u6269\u5c55\u52301\uff0c\u7136\u540e\u5c06\u65e7ReplicaSet\u7f29\u51cf\u4e3a2\u3002</li> <li>\u4e4b\u540e\uff0c\u7cfb\u7edf\u7ee7\u7eed\u6309\u7167\u76f8\u540c\u7684\u66f4\u65b0\u7b56\u7565\u5bf9\u65b0\u65e7\u4e24\u4e2aReplicaSet\u8fdb\u884c\u9010\u4e2a\u8c03\u6574\u3002</li> <li>\u6700\u540e\uff0c\u65b0\u7684ReplicaSet\u8fd0\u884c\u4e86\u5bf9\u5e94\u4e2a\u65b0\u7248\u672cPod\u526f\u672c\uff0c\u65e7\u7684ReplicaSet\u526f\u672c\u6570\u91cf\u5219\u7f29\u51cf\u4e3a0\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-25-kubernetes-deployment","title":"6-25 \u7b80\u8ff0Kubernetes deployment\u5347\u7ea7\u7b56\u7565\uff1f","text":"<p>\u5728Deployment\u7684\u5b9a\u4e49\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7spec.strategy\u6307\u5b9aPod\u66f4\u65b0\u7684\u7b56\u7565\uff0c\u76ee\u524d\u652f\u6301\u4e24\u79cd\u7b56\u7565\uff1aRecreate\uff08\u91cd\u5efa\uff09\u548cRollingUpdate\uff08\u6eda\u52a8\u66f4\u65b0\uff09\uff0c\u9ed8\u8ba4\u503c\u4e3aRollingUpdate\u3002</p> <ul> <li>Recreate\uff1a\u8bbe\u7f6e<code>spec.strategy.type=Recreate</code>\uff0c\u8868\u793aDeployment\u5728\u66f4\u65b0Pod\u65f6\uff0c\u4f1a\u5148\u6740\u6389\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684Pod\uff0c\u7136\u540e\u521b\u5efa\u65b0\u7684Pod\u3002</li> <li>RollingUpdate\uff1a\u8bbe\u7f6e<code>spec.strategy.type=RollingUpdate</code>\uff0c\u8868\u793aDeployment\u4f1a\u4ee5\u6eda\u52a8\u66f4\u65b0\u7684\u65b9\u5f0f\u6765\u9010\u4e2a\u66f4\u65b0Pod\u3002\u540c\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e<code>spec.strategy.rollingUpdate</code>\u4e0b\u7684\u4e24\u4e2a\u53c2\u6570\uff08<code>maxUnavailable\u548cmaxSurge</code>\uff09\u6765\u63a7\u5236\u6eda\u52a8\u66f4\u65b0\u7684\u8fc7\u7a0b\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-26-kubernetes-daemonset","title":"6-26 \u7b80\u8ff0Kubernetes DaemonSet\u7c7b\u578b\u7684\u8d44\u6e90\u7279\u6027\uff1f","text":"<p>DaemonSet\u8d44\u6e90\u5bf9\u8c61\u4f1a\u5728\u6bcf\u4e2aKubernetes\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u5e76\u4e14\u6bcf\u4e2a\u8282\u70b9\u53ea\u80fd\u8fd0\u884c\u4e00\u4e2apod\uff0c\u8fd9\u662f\u5b83\u548cdeployment\u8d44\u6e90\u5bf9\u8c61\u7684\u6700\u5927\u4e5f\u662f\u552f\u4e00\u7684\u533a\u522b\u3002\u56e0\u6b64\uff0c\u5728\u5b9a\u4e49yaml\u6587\u4ef6\u4e2d\uff0c\u4e0d\u652f\u6301\u5b9a\u4e49replicas\u3002</p> <p>\u5b83\u7684\u4e00\u822c\u4f7f\u7528\u573a\u666f\u5982\u4e0b\uff1a</p> <ul> <li>\u5728\u53bb\u505a\u6bcf\u4e2a\u8282\u70b9\u7684\u65e5\u5fd7\u6536\u96c6\u5de5\u4f5c\u3002</li> <li>\u76d1\u63a7\u6bcf\u4e2a\u8282\u70b9\u7684\u7684\u8fd0\u884c\u72b6\u6001\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-27-kubernetes","title":"6-27 \u7b80\u8ff0Kubernetes\u81ea\u52a8\u6269\u5bb9\u673a\u5236\uff1f","text":"<p>Kubernetes\u4f7f\u7528Horizontal Pod Autoscaler\uff08HPA\uff09\u7684\u63a7\u5236\u5668\u5b9e\u73b0\u57fa\u4e8eCPU\u4f7f\u7528\u7387\u8fdb\u884c\u81ea\u52a8Pod\u6269\u7f29\u5bb9\u7684\u529f\u80fd\u3002HPA\u63a7\u5236\u5668\u5468\u671f\u6027\u5730\u76d1\u6d4b\u76ee\u6807Pod\u7684\u8d44\u6e90\u6027\u80fd\u6307\u6807\uff0c\u5e76\u4e0eHPA\u8d44\u6e90\u5bf9\u8c61\u4e2d\u7684\u6269\u7f29\u5bb9\u6761\u4ef6\u8fdb\u884c\u5bf9\u6bd4\uff0c\u5728\u6ee1\u8db3\u6761\u4ef6\u65f6\u5bf9Pod\u526f\u672c\u6570\u91cf\u8fdb\u884c\u8c03\u6574\u3002</p> <ul> <li>HPA\u539f\u7406</li> </ul> <p>Kubernetes\u4e2d\u7684\u67d0\u4e2aMetrics Server\uff08Heapster\u6216\u81ea\u5b9a\u4e49Metrics Server\uff09\u6301\u7eed\u91c7\u96c6\u6240\u6709Pod\u526f\u672c\u7684\u6307\u6807\u6570\u636e\u3002HPA\u63a7\u5236\u5668\u901a\u8fc7Metrics Server\u7684API\uff08Heapster\u7684API\u6216\u805a\u5408API\uff09\u83b7\u53d6\u8fd9\u4e9b\u6570\u636e\uff0c\u57fa\u4e8e\u7528\u6237\u5b9a\u4e49\u7684\u6269\u7f29\u5bb9\u89c4\u5219\u8fdb\u884c\u8ba1\u7b97\uff0c\u5f97\u5230\u76ee\u6807Pod\u526f\u672c\u6570\u91cf\u3002</p> <p>\u5f53\u76ee\u6807Pod\u526f\u672c\u6570\u91cf\u4e0e\u5f53\u524d\u526f\u672c\u6570\u91cf\u4e0d\u540c\u65f6\uff0cHPA\u63a7\u5236\u5668\u5c31\u5411Pod\u7684\u526f\u672c\u63a7\u5236\u5668\uff08Deployment\u3001RC\u6216ReplicaSet\uff09\u53d1\u8d77scale\u64cd\u4f5c\uff0c\u8c03\u6574Pod\u7684\u526f\u672c\u6570\u91cf\uff0c\u5b8c\u6210\u6269\u7f29\u5bb9\u64cd\u4f5c\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-28-kubernetes-service","title":"6-28 \u7b80\u8ff0Kubernetes Service\u7c7b\u578b\uff1f","text":"<p>\u901a\u8fc7\u521b\u5efaService\uff0c\u53ef\u4ee5\u4e3a\u4e00\u7ec4\u5177\u6709\u76f8\u540c\u529f\u80fd\u7684\u5bb9\u5668\u5e94\u7528\u63d0\u4f9b\u4e00\u4e2a\u7edf\u4e00\u7684\u5165\u53e3\u5730\u5740\uff0c\u5e76\u4e14\u5c06\u8bf7\u6c42\u8d1f\u8f7d\u5206\u53d1\u5230\u540e\u7aef\u7684\u5404\u4e2a\u5bb9\u5668\u5e94\u7528\u4e0a\u3002\u5176\u4e3b\u8981\u7c7b\u578b\u6709\uff1a</p> <ul> <li>ClusterIP\uff1a\u865a\u62df\u7684\u670d\u52a1IP\u5730\u5740\uff0c\u8be5\u5730\u5740\u7528\u4e8eKubernetes\u96c6\u7fa4\u5185\u90e8\u7684Pod\u8bbf\u95ee\uff0c\u5728Node\u4e0akube-proxy\u901a\u8fc7\u8bbe\u7f6e\u7684iptables\u89c4\u5219\u8fdb\u884c\u8f6c\u53d1\uff1b</li> <li>NodePort\uff1a\u4f7f\u7528\u5bbf\u4e3b\u673a\u7684\u7aef\u53e3\uff0c\u4f7f\u80fd\u591f\u8bbf\u95ee\u5404Node\u7684\u5916\u90e8\u5ba2\u6237\u7aef\u901a\u8fc7Node\u7684IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u5c31\u80fd\u8bbf\u95ee\u670d\u52a1\uff1b</li> <li>LoadBalancer\uff1a\u4f7f\u7528\u5916\u63a5\u8d1f\u8f7d\u5747\u8861\u5668\u5b8c\u6210\u5230\u670d\u52a1\u7684\u8d1f\u8f7d\u5206\u53d1\uff0c\u9700\u8981\u5728spec.status.loadBalancer\u5b57\u6bb5\u6307\u5b9a\u5916\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u7684IP\u5730\u5740\uff0c\u901a\u5e38\u7528\u4e8e\u516c\u6709\u4e91\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-29-kubernetes-service","title":"6-29 \u7b80\u8ff0Kubernetes Service\u5206\u53d1\u540e\u7aef\u7684\u7b56\u7565\uff1f","text":"<p>Service\u8d1f\u8f7d\u5206\u53d1\u7684\u7b56\u7565\u6709\uff1aRoundRobin\u548cSessionAffinity</p> <ul> <li>RoundRobin\uff1a\u9ed8\u8ba4\u4e3a\u8f6e\u8be2\u6a21\u5f0f\uff0c\u5373\u8f6e\u8be2\u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230\u540e\u7aef\u7684\u5404\u4e2aPod\u4e0a\u3002</li> <li>SessionAffinity\uff1a\u57fa\u4e8e\u5ba2\u6237\u7aefIP\u5730\u5740\u8fdb\u884c\u4f1a\u8bdd\u4fdd\u6301\u7684\u6a21\u5f0f\uff0c\u5373\u7b2c1\u6b21\u5c06\u67d0\u4e2a\u5ba2\u6237\u7aef\u53d1\u8d77\u7684\u8bf7\u6c42\u8f6c\u53d1\u5230\u540e\u7aef\u7684\u67d0\u4e2aPod\u4e0a\uff0c\u4e4b\u540e\u4ece\u76f8\u540c\u7684\u5ba2\u6237\u7aef\u53d1\u8d77\u7684\u8bf7\u6c42\u90fd\u5c06\u88ab\u8f6c\u53d1\u5230\u540e\u7aef\u76f8\u540c\u7684Pod\u4e0a\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-30-kubernetes-headless-service","title":"6-30 \u7b80\u8ff0Kubernetes Headless Service\uff1f","text":"<p>\u5728\u67d0\u4e9b\u5e94\u7528\u573a\u666f\u4e2d\uff0c\u82e5\u9700\u8981\u4eba\u4e3a\u6307\u5b9a\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u4e0d\u4f7f\u7528Service\u63d0\u4f9b\u7684\u9ed8\u8ba4\u8d1f\u8f7d\u5747\u8861\u7684\u529f\u80fd\uff0c\u6216\u8005\u5e94\u7528\u7a0b\u5e8f\u5e0c\u671b\u77e5\u9053\u5c5e\u4e8e\u540c\u7ec4\u670d\u52a1\u7684\u5176\u4ed6\u5b9e\u4f8b\u3002</p> <p>Kubernetes\u63d0\u4f9b\u4e86Headless Service\u6765\u5b9e\u73b0\u8fd9\u79cd\u529f\u80fd\uff0c\u5373\u4e0d\u4e3aService\u8bbe\u7f6eClusterIP\uff08\u5165\u53e3IP\u5730\u5740\uff09\uff0c\u4ec5\u901a\u8fc7Label Selector\u5c06\u540e\u7aef\u7684Pod\u5217\u8868\u8fd4\u56de\u7ed9\u8c03\u7528\u7684\u5ba2\u6237\u7aef\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-31-kubernetes","title":"6-31 \u7b80\u8ff0Kubernetes\u5916\u90e8\u5982\u4f55\u8bbf\u95ee\u96c6\u7fa4\u5185\u7684\u670d\u52a1\uff1f","text":"<p>\u5bf9\u4e8eKubernetes\uff0c\u96c6\u7fa4\u5916\u7684\u5ba2\u6237\u7aef\u9ed8\u8ba4\u60c5\u51b5\uff0c\u65e0\u6cd5\u901a\u8fc7Pod\u7684IP\u5730\u5740\u6216\u8005Service\u7684\u865a\u62dfIP\u5730\u5740:\u865a\u62df\u7aef\u53e3\u53f7\u8fdb\u884c\u8bbf\u95ee\u3002\u901a\u5e38\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u8fdb\u884c\u8bbf\u95eeKubernetes\u96c6\u7fa4\u5185\u7684\u670d\u52a1\uff1a</p> <ul> <li>\u6620\u5c04Pod\u5230\u7269\u7406\u673a\uff1a\u5c06Pod\u7aef\u53e3\u53f7\u6620\u5c04\u5230\u5bbf\u4e3b\u673a\uff0c\u5373\u5728Pod\u4e2d\u91c7\u7528hostPort\u65b9\u5f0f\uff0c\u4ee5\u4f7f\u5ba2\u6237\u7aef\u5e94\u7528\u80fd\u591f\u901a\u8fc7\u7269\u7406\u673a\u8bbf\u95ee\u5bb9\u5668\u5e94\u7528\u3002</li> <li>\u6620\u5c04Service\u5230\u7269\u7406\u673a\uff1a\u5c06Service\u7aef\u53e3\u53f7\u6620\u5c04\u5230\u5bbf\u4e3b\u673a\uff0c\u5373\u5728Service\u4e2d\u91c7\u7528nodePort\u65b9\u5f0f\uff0c\u4ee5\u4f7f\u5ba2\u6237\u7aef\u5e94\u7528\u80fd\u591f\u901a\u8fc7\u7269\u7406\u673a\u8bbf\u95ee\u5bb9\u5668\u5e94\u7528\u3002</li> <li>\u6620\u5c04Sercie\u5230LoadBalancer\uff1a\u901a\u8fc7\u8bbe\u7f6eLoadBalancer\u6620\u5c04\u5230\u4e91\u670d\u52a1\u5546\u63d0\u4f9b\u7684LoadBalancer\u5730\u5740\u3002\u8fd9\u79cd\u7528\u6cd5\u4ec5\u7528\u4e8e\u5728\u516c\u6709\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u7684\u4e91\u5e73\u53f0\u4e0a\u8bbe\u7f6eService\u7684\u573a\u666f\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-32-kubernetes-ingress","title":"6-32 \u7b80\u8ff0Kubernetes ingress\uff1f","text":"<p>Kubernetes\u7684Ingress\u8d44\u6e90\u5bf9\u8c61\uff0c\u7528\u4e8e\u5c06\u4e0d\u540cURL\u7684\u8bbf\u95ee\u8bf7\u6c42\u8f6c\u53d1\u5230\u540e\u7aef\u4e0d\u540c\u7684Service\uff0c\u4ee5\u5b9e\u73b0HTTP\u5c42\u7684\u4e1a\u52a1\u8def\u7531\u673a\u5236\u3002</p> <p>Kubernetes\u4f7f\u7528\u4e86<code>Ingress</code>\u7b56\u7565\u548c<code>Ingress Controller</code>\uff0c\u4e24\u8005\u7ed3\u5408\u5e76\u5b9e\u73b0\u4e86\u4e00\u4e2a\u5b8c\u6574\u7684Ingress\u8d1f\u8f7d\u5747\u8861\u5668\u3002\u4f7f\u7528Ingress\u8fdb\u884c\u8d1f\u8f7d\u5206\u53d1\u65f6\uff0cIngress Controller\u57fa\u4e8eIngress\u89c4\u5219\u5c06\u5ba2\u6237\u7aef\u8bf7\u6c42\u76f4\u63a5\u8f6c\u53d1\u5230Service\u5bf9\u5e94\u7684\u540e\u7aefEndpoint\uff08Pod\uff09\u4e0a\uff0c\u4ece\u800c\u8df3\u8fc7<code>kube-proxy</code>\u7684\u8f6c\u53d1\u529f\u80fd\uff0c<code>kube-proxy</code>\u4e0d\u518d\u8d77\u4f5c\u7528\uff0c\u5168\u8fc7\u7a0b\u4e3a\uff1a<code>ingress controller + ingress \u89c4\u5219 ----&gt; services</code>\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-33-kubernetes","title":"6-33 \u7b80\u8ff0Kubernetes\u955c\u50cf\u7684\u4e0b\u8f7d\u7b56\u7565\uff1f","text":"<p>K8s\u7684\u955c\u50cf\u4e0b\u8f7d\u7b56\u7565\u6709\u4e09\u79cd\uff1aAlways\u3001Never\u3001IFNotPresent\u3002</p> <ul> <li>Always\uff1a\u955c\u50cf\u6807\u7b7e\u4e3alatest\u65f6\uff0c\u603b\u662f\u4ece\u6307\u5b9a\u7684\u4ed3\u5e93\u4e2d\u83b7\u53d6\u955c\u50cf\u3002</li> <li>Never\uff1a\u7981\u6b62\u4ece\u4ed3\u5e93\u4e2d\u4e0b\u8f7d\u955c\u50cf\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ea\u80fd\u4f7f\u7528\u672c\u5730\u955c\u50cf\u3002</li> <li>IfNotPresent\uff1a\u4ec5\u5f53\u672c\u5730\u6ca1\u6709\u5bf9\u5e94\u955c\u50cf\u65f6\uff0c\u624d\u4ece\u76ee\u6807\u4ed3\u5e93\u4e2d\u4e0b\u8f7d\u3002\u9ed8\u8ba4\u7684\u955c\u50cf\u4e0b\u8f7d\u7b56\u7565\u662f\uff1a\u5f53\u955c\u50cf\u6807\u7b7e\u662flatest\u65f6\uff0c\u9ed8\u8ba4\u7b56\u7565\u662fAlways\uff1b\u5f53\u955c\u50cf\u6807\u7b7e\u662f\u81ea\u5b9a\u4e49\u65f6\uff08\u4e5f\u5c31\u662f\u6807\u7b7e\u4e0d\u662flatest\uff09\uff0c\u90a3\u4e48\u9ed8\u8ba4\u7b56\u7565\u662fIfNotPresent\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-34-kubernetes","title":"6-34 \u7b80\u8ff0Kubernetes\u7684\u8d1f\u8f7d\u5747\u8861\u5668\uff1f","text":"<p>\u8d1f\u8f7d\u5747\u8861\u5668\u662f\u66b4\u9732\u670d\u52a1\u7684\u6700\u5e38\u89c1\u548c\u6807\u51c6\u65b9\u5f0f\u4e4b\u4e00\u3002</p> <p>\u6839\u636e\u5de5\u4f5c\u73af\u5883\u4f7f\u7528\u4e24\u79cd\u7c7b\u578b\u7684\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u5373\u5185\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u6216\u5916\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u3002\u5185\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u81ea\u52a8\u5e73\u8861\u8d1f\u8f7d\u5e76\u4f7f\u7528\u6240\u9700\u914d\u7f6e\u5206\u914d\u5bb9\u5668\uff0c\u800c\u5916\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6d41\u91cf\u4ece\u5916\u90e8\u8d1f\u8f7d\u5f15\u5bfc\u81f3\u540e\u7aef\u5bb9\u5668\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-35-kubernetesapi-server","title":"6-35 \u7b80\u8ff0Kubernetes\u5404\u6a21\u5757\u5982\u4f55\u4e0eAPI Server\u901a\u4fe1\uff1f","text":"<p>Kubernetes API Server\u4f5c\u4e3a\u96c6\u7fa4\u7684\u6838\u5fc3\uff0c\u8d1f\u8d23\u96c6\u7fa4\u5404\u529f\u80fd\u6a21\u5757\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u96c6\u7fa4\u5185\u7684\u5404\u4e2a\u529f\u80fd\u6a21\u5757\u901a\u8fc7API Server\u5c06\u4fe1\u606f\u5b58\u5165etcd\uff0c\u5f53\u9700\u8981\u83b7\u53d6\u548c\u64cd\u4f5c\u8fd9\u4e9b\u6570\u636e\u65f6\uff0c\u5219\u901a\u8fc7API Server\u63d0\u4f9b\u7684REST\u63a5\u53e3\uff08\u7528GET\u3001LIST\u6216WATCH\u65b9\u6cd5\uff09\u6765\u5b9e\u73b0\uff0c\u4ece\u800c\u5b9e\u73b0\u5404\u6a21\u5757\u4e4b\u95f4\u7684\u4fe1\u606f\u4ea4\u4e92\u3002</p> <p>\u5982kubelet\u8fdb\u7a0b\u4e0eAPI Server\u7684\u4ea4\u4e92\uff1a\u6bcf\u4e2aNode\u4e0a\u7684kubelet\u6bcf\u9694\u4e00\u4e2a\u65f6\u95f4\u5468\u671f\uff0c\u5c31\u4f1a\u8c03\u7528\u4e00\u6b21API Server\u7684REST\u63a5\u53e3\u62a5\u544a\u81ea\u8eab\u72b6\u6001\uff0cAPI Server\u5728\u63a5\u6536\u5230\u8fd9\u4e9b\u4fe1\u606f\u540e\uff0c\u4f1a\u5c06\u8282\u70b9\u72b6\u6001\u4fe1\u606f\u66f4\u65b0\u5230etcd\u4e2d\u3002</p> <p>\u5982<code>kube-controller-manager</code>\u8fdb\u7a0b\u4e0eAPI Server\u7684\u4ea4\u4e92\uff1a<code>kube-controller-manager</code>\u4e2d\u7684Node Controller\u6a21\u5757\u901a\u8fc7API Server\u63d0\u4f9b\u7684Watch\u63a5\u53e3\u5b9e\u65f6\u76d1\u63a7Node\u7684\u4fe1\u606f\uff0c\u5e76\u505a\u76f8\u5e94\u5904\u7406\u3002</p> <p>\u5982<code>kube-scheduler</code>\u8fdb\u7a0b\u4e0eAPI Server\u7684\u4ea4\u4e92\uff1aScheduler\u901a\u8fc7API Server\u7684Watch\u63a5\u53e3\u76d1\u542c\u5230\u65b0\u5efaPod\u526f\u672c\u7684\u4fe1\u606f\u540e\uff0c\u4f1a\u68c0\u7d22\u6240\u6709\u7b26\u5408\u8be5Pod\u8981\u6c42\u7684Node\u5217\u8868\uff0c\u5f00\u59cb\u6267\u884cPod\u8c03\u5ea6\u903b\u8f91\uff0c\u5728\u8c03\u5ea6\u6210\u529f\u540e\u5c06Pod\u7ed1\u5b9a\u5230\u76ee\u6807\u8282\u70b9\u4e0a\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-36-kubernetes-scheduler","title":"6-36 \u7b80\u8ff0Kubernetes Scheduler\u4f5c\u7528\u53ca\u5b9e\u73b0\u539f\u7406\uff1f","text":"<p>Kubernetes Scheduler\u662f\u8d1f\u8d23Pod\u8c03\u5ea6\u7684\u91cd\u8981\u529f\u80fd\u6a21\u5757\uff0cKubernetes Scheduler\u5728\u6574\u4e2a\u7cfb\u7edf\u4e2d\u627f\u62c5\u4e86\u201c\u627f\u4e0a\u542f\u4e0b\u201d\u7684\u91cd\u8981\u529f\u80fd\uff0c\u201c\u627f\u4e0a\u201d\u662f\u6307\u5b83\u8d1f\u8d23\u63a5\u6536Controller Manager\u521b\u5efa\u7684\u65b0Pod\uff0c\u4e3a\u5176\u8c03\u5ea6\u81f3\u76ee\u6807Node\uff1b\u201c\u542f\u4e0b\u201d\u662f\u6307\u8c03\u5ea6\u5b8c\u6210\u540e\uff0c\u76ee\u6807Node\u4e0a\u7684kubelet\u670d\u52a1\u8fdb\u7a0b\u63a5\u7ba1\u540e\u7ee7\u5de5\u4f5c\uff0c\u8d1f\u8d23Pod\u63a5\u4e0b\u6765\u751f\u547d\u5468\u671f\u3002</p> <p>Kubernetes Scheduler\u7684\u4f5c\u7528\u662f\u5c06\u5f85\u8c03\u5ea6\u7684Pod\uff08API\u65b0\u521b\u5efa\u7684Pod\u3001Controller Manager\u4e3a\u8865\u8db3\u526f\u672c\u800c\u521b\u5efa\u7684Pod\u7b49\uff09\u6309\u7167\u7279\u5b9a\u7684\u8c03\u5ea6\u7b97\u6cd5\u548c\u8c03\u5ea6\u7b56\u7565\u7ed1\u5b9a\uff08Binding\uff09\u5230\u96c6\u7fa4\u4e2d\u67d0\u4e2a\u5408\u9002\u7684Node\u4e0a\uff0c\u5e76\u5c06\u7ed1\u5b9a\u4fe1\u606f\u5199\u5165etcd\u4e2d\u3002</p> <p>\u5728\u6574\u4e2a\u8c03\u5ea6\u8fc7\u7a0b\u4e2d\u6d89\u53ca\u4e09\u4e2a\u5bf9\u8c61\uff0c\u5206\u522b\u662f\u5f85\u8c03\u5ea6Pod\u5217\u8868\u3001\u53ef\u7528Node\u5217\u8868\uff0c\u4ee5\u53ca\u8c03\u5ea6\u7b97\u6cd5\u548c\u7b56\u7565\u3002</p> <p>Kubernetes Scheduler\u901a\u8fc7\u8c03\u5ea6\u7b97\u6cd5\u8c03\u5ea6\u4e3a\u5f85\u8c03\u5ea6Pod\u5217\u8868\u4e2d\u7684\u6bcf\u4e2aPod\u4eceNode\u5217\u8868\u4e2d\u9009\u62e9\u4e00\u4e2a\u6700\u9002\u5408\u7684Node\u6765\u5b9e\u73b0Pod\u7684\u8c03\u5ea6\u3002\u968f\u540e\uff0c\u76ee\u6807\u8282\u70b9\u4e0a\u7684kubelet\u901a\u8fc7API Server\u76d1\u542c\u5230Kubernetes Scheduler\u4ea7\u751f\u7684Pod\u7ed1\u5b9a\u4e8b\u4ef6\uff0c\u7136\u540e\u83b7\u53d6\u5bf9\u5e94\u7684Pod\u6e05\u5355\uff0c\u4e0b\u8f7dImage\u955c\u50cf\u5e76\u542f\u52a8\u5bb9\u5668\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-37-kubernetes-schedulerpodworker","title":"6-37 \u7b80\u8ff0Kubernetes Scheduler\u4f7f\u7528\u54ea\u4e24\u79cd\u7b97\u6cd5\u5c06Pod\u7ed1\u5b9a\u5230worker\u8282\u70b9\uff1f","text":"<p>Kubernetes Scheduler\u6839\u636e\u5982\u4e0b\u4e24\u79cd\u8c03\u5ea6\u7b97\u6cd5\u5c06 Pod \u7ed1\u5b9a\u5230\u6700\u5408\u9002\u7684\u5de5\u4f5c\u8282\u70b9\uff1a</p> <ul> <li>\u9884\u9009\uff08Predicates\uff09\uff1a\u8f93\u5165\u662f\u6240\u6709\u8282\u70b9\uff0c\u8f93\u51fa\u662f\u6ee1\u8db3\u9884\u9009\u6761\u4ef6\u7684\u8282\u70b9\u3002kube-scheduler\u6839\u636e\u9884\u9009\u7b56\u7565\u8fc7\u6ee4\u6389\u4e0d\u6ee1\u8db3\u7b56\u7565\u7684Nodes\u3002\u5982\u679c\u67d0\u8282\u70b9\u7684\u8d44\u6e90\u4e0d\u8db3\u6216\u8005\u4e0d\u6ee1\u8db3\u9884\u9009\u7b56\u7565\u7684\u6761\u4ef6\u5219\u65e0\u6cd5\u901a\u8fc7\u9884\u9009\u3002\u5982\u201cNode\u7684label\u5fc5\u987b\u4e0ePod\u7684Selector\u4e00\u81f4\u201d\u3002</li> <li>\u4f18\u9009\uff08Priorities\uff09\uff1a\u8f93\u5165\u662f\u9884\u9009\u9636\u6bb5\u7b5b\u9009\u51fa\u7684\u8282\u70b9\uff0c\u4f18\u9009\u4f1a\u6839\u636e\u4f18\u5148\u7b56\u7565\u4e3a\u901a\u8fc7\u9884\u9009\u7684Nodes\u8fdb\u884c\u6253\u5206\u6392\u540d\uff0c\u9009\u62e9\u5f97\u5206\u6700\u9ad8\u7684Node\u3002\u4f8b\u5982\uff0c\u8d44\u6e90\u8d8a\u5bcc\u88d5\u3001\u8d1f\u8f7d\u8d8a\u5c0f\u7684Node\u53ef\u80fd\u5177\u6709\u8d8a\u9ad8\u7684\u6392\u540d\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-38-kubernetes-kubelet","title":"6-38 \u7b80\u8ff0Kubernetes kubelet\u7684\u4f5c\u7528\uff1f","text":"<p>\u5728Kubernetes\u96c6\u7fa4\u4e2d\uff0c\u5728\u6bcf\u4e2aNode\uff08\u53c8\u79f0Worker\uff09\u4e0a\u90fd\u4f1a\u542f\u52a8\u4e00\u4e2akubelet\u670d\u52a1\u8fdb\u7a0b\u3002\u8be5\u8fdb\u7a0b\u7528\u4e8e\u5904\u7406Master\u4e0b\u53d1\u5230\u672c\u8282\u70b9\u7684\u4efb\u52a1\uff0c\u7ba1\u7406Pod\u53caPod\u4e2d\u7684\u5bb9\u5668\u3002\u6bcf\u4e2akubelet\u8fdb\u7a0b\u90fd\u4f1a\u5728API Server\u4e0a\u6ce8\u518c\u8282\u70b9\u81ea\u8eab\u7684\u4fe1\u606f\uff0c\u5b9a\u671f\u5411Master\u6c47\u62a5\u8282\u70b9\u8d44\u6e90\u7684\u4f7f\u7528\u60c5\u51b5\uff0c\u5e76\u901a\u8fc7cAdvisor\u76d1\u63a7\u5bb9\u5668\u548c\u8282\u70b9\u8d44\u6e90\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-39-kubernetes-kubeletworker","title":"6-39 \u7b80\u8ff0Kubernetes kubelet\u76d1\u63a7Worker\u8282\u70b9\u8d44\u6e90\u662f\u4f7f\u7528\u4ec0\u4e48\u7ec4\u4ef6\u6765\u5b9e\u73b0\u7684\uff1f","text":"<p>kubelet\u4f7f\u7528cAdvisor\u5bf9worker\u8282\u70b9\u8d44\u6e90\u8fdb\u884c\u76d1\u63a7\u3002\u5728 Kubernetes \u7cfb\u7edf\u4e2d\uff0ccAdvisor \u5df2\u88ab\u9ed8\u8ba4\u96c6\u6210\u5230 kubelet \u7ec4\u4ef6\u5185\uff0c\u5f53 kubelet \u670d\u52a1\u542f\u52a8\u65f6\uff0c\u5b83\u4f1a\u81ea\u52a8\u542f\u52a8 cAdvisor \u670d\u52a1\uff0c\u7136\u540e cAdvisor \u4f1a\u5b9e\u65f6\u91c7\u96c6\u6240\u5728\u8282\u70b9\u7684\u6027\u80fd\u6307\u6807\u53ca\u5728\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\u5bb9\u5668\u7684\u6027\u80fd\u6307\u6807\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-40-kubernetes","title":"6-40 \u7b80\u8ff0Kubernetes\u5982\u4f55\u4fdd\u8bc1\u96c6\u7fa4\u7684\u5b89\u5168\u6027\uff1f","text":"<p>Kubernetes\u901a\u8fc7\u4e00\u7cfb\u5217\u673a\u5236\u6765\u5b9e\u73b0\u96c6\u7fa4\u7684\u5b89\u5168\u63a7\u5236\uff0c\u4e3b\u8981\u6709\u5982\u4e0b\u4e0d\u540c\u7684\u7ef4\u5ea6\uff1a</p> <ul> <li>\u57fa\u7840\u8bbe\u65bd\u65b9\u9762\uff1a\u4fdd\u8bc1\u5bb9\u5668\u4e0e\u5176\u6240\u5728\u5bbf\u4e3b\u673a\u7684\u9694\u79bb\uff1b</li> <li>\u6743\u9650\u65b9\u9762\uff1a<ul> <li>\u6700\u5c0f\u6743\u9650\u539f\u5219\uff1a\u5408\u7406\u9650\u5236\u6240\u6709\u7ec4\u4ef6\u7684\u6743\u9650\uff0c\u786e\u4fdd\u7ec4\u4ef6\u53ea\u6267\u884c\u5b83\u88ab\u6388\u6743\u7684\u884c\u4e3a\uff0c\u901a\u8fc7\u9650\u5236\u5355\u4e2a\u7ec4\u4ef6\u7684\u80fd\u529b\u6765\u9650\u5236\u5b83\u7684\u6743\u9650\u8303\u56f4\u3002</li> <li>\u7528\u6237\u6743\u9650\uff1a\u5212\u5206\u666e\u901a\u7528\u6237\u548c\u7ba1\u7406\u5458\u7684\u89d2\u8272\u3002</li> </ul> </li> <li>\u96c6\u7fa4\u65b9\u9762\uff1a<ul> <li>API Server\u7684\u8ba4\u8bc1\u6388\u6743\uff1aKubernetes\u96c6\u7fa4\u4e2d\u6240\u6709\u8d44\u6e90\u7684\u8bbf\u95ee\u548c\u53d8\u66f4\u90fd\u662f\u901a\u8fc7Kubernetes API Server\u6765\u5b9e\u73b0\u7684\uff0c\u56e0\u6b64\u9700\u8981\u5efa\u8bae\u91c7\u7528\u66f4\u5b89\u5168\u7684HTTPS\u6216Token\u6765\u8bc6\u522b\u548c\u8ba4\u8bc1\u5ba2\u6237\u7aef\u8eab\u4efd\uff08Authentication\uff09\uff0c\u4ee5\u53ca\u968f\u540e\u8bbf\u95ee\u6743\u9650\u7684\u6388\u6743\uff08Authorization\uff09\u73af\u8282\u3002</li> <li>API Server\u7684\u6388\u6743\u7ba1\u7406\uff1a\u901a\u8fc7\u6388\u6743\u7b56\u7565\u6765\u51b3\u5b9a\u4e00\u4e2aAPI\u8c03\u7528\u662f\u5426\u5408\u6cd5\u3002\u5bf9\u5408\u6cd5\u7528\u6237\u8fdb\u884c\u6388\u6743\u5e76\u4e14\u968f\u540e\u5728\u7528\u6237\u8bbf\u95ee\u65f6\u8fdb\u884c\u9274\u6743\uff0c\u5efa\u8bae\u91c7\u7528\u66f4\u5b89\u5168\u7684RBAC\u65b9\u5f0f\u6765\u63d0\u5347\u96c6\u7fa4\u5b89\u5168\u6388\u6743\u3002</li> <li>\u654f\u611f\u6570\u636e\u5f15\u5165Secret\u673a\u5236\uff1a\u5bf9\u4e8e\u96c6\u7fa4\u654f\u611f\u6570\u636e\u5efa\u8bae\u4f7f\u7528Secret\u65b9\u5f0f\u8fdb\u884c\u4fdd\u62a4\u3002</li> <li>AdmissionControl\uff08\u51c6\u5165\u673a\u5236\uff09\uff1a\u5bf9kubernetes api\u7684\u8bf7\u6c42\u8fc7\u7a0b\u4e2d\uff0c\u987a\u5e8f\u4e3a\uff1a\u5148\u7ecf\u8fc7\u8ba4\u8bc1 &amp; \u6388\u6743\uff0c\u7136\u540e\u6267\u884c\u51c6\u5165\u64cd\u4f5c\uff0c\u6700\u540e\u5bf9\u76ee\u6807\u5bf9\u8c61\u8fdb\u884c\u64cd\u4f5c\u3002</li> </ul> </li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-41-kubernetes","title":"6-41 \u7b80\u8ff0Kubernetes\u51c6\u5165\u673a\u5236\uff1f","text":"<p>\u5728\u5bf9\u96c6\u7fa4\u8fdb\u884c\u8bf7\u6c42\u65f6\uff0c\u6bcf\u4e2a\u51c6\u5165\u63a7\u5236\u4ee3\u7801\u90fd\u6309\u7167\u4e00\u5b9a\u987a\u5e8f\u6267\u884c\u3002\u5982\u679c\u6709\u4e00\u4e2a\u51c6\u5165\u63a7\u5236\u62d2\u7edd\u4e86\u6b64\u6b21\u8bf7\u6c42\uff0c\u90a3\u4e48\u6574\u4e2a\u8bf7\u6c42\u7684\u7ed3\u679c\u5c06\u4f1a\u7acb\u5373\u8fd4\u56de\uff0c\u5e76\u63d0\u793a\u7528\u6237\u76f8\u5e94\u7684error\u4fe1\u606f\u3002</p> <p>\u51c6\u5165\u63a7\u5236\uff08AdmissionControl\uff09\u51c6\u5165\u63a7\u5236\u672c\u8d28\u4e0a\u4e3a\u4e00\u6bb5\u51c6\u5165\u4ee3\u7801\uff0c\u5728\u5bf9kubernetes api\u7684\u8bf7\u6c42\u8fc7\u7a0b\u4e2d\uff0c\u987a\u5e8f\u4e3a\uff1a\u5148\u7ecf\u8fc7\u8ba4\u8bc1 &amp; \u6388\u6743\uff0c\u7136\u540e\u6267\u884c\u51c6\u5165\u64cd\u4f5c\uff0c\u6700\u540e\u5bf9\u76ee\u6807\u5bf9\u8c61\u8fdb\u884c\u64cd\u4f5c\u3002\u5e38\u7528\u7ec4\u4ef6\uff08\u63a7\u5236\u4ee3\u7801\uff09\u5982\u4e0b\uff1a</p> <ul> <li>AlwaysAdmit\uff1a\u5141\u8bb8\u6240\u6709\u8bf7\u6c42</li> <li>AlwaysDeny\uff1a\u7981\u6b62\u6240\u6709\u8bf7\u6c42\uff0c\u591a\u7528\u4e8e\u6d4b\u8bd5\u73af\u5883\u3002</li> <li>ServiceAccount\uff1a\u5b83\u5c06serviceAccounts\u5b9e\u73b0\u4e86\u81ea\u52a8\u5316\uff0c\u5b83\u4f1a\u8f85\u52a9serviceAccount\u505a\u4e00\u4e9b\u4e8b\u60c5\uff0c\u6bd4\u5982\u5982\u679cpod\u6ca1\u6709serviceAccount\u5c5e\u6027\uff0c\u5b83\u4f1a\u81ea\u52a8\u6dfb\u52a0\u4e00\u4e2adefault\uff0c\u5e76\u786e\u4fddpod\u7684serviceAccount\u59cb\u7ec8\u5b58\u5728\u3002</li> <li>LimitRanger\uff1a\u89c2\u5bdf\u6240\u6709\u7684\u8bf7\u6c42\uff0c\u786e\u4fdd\u6ca1\u6709\u8fdd\u53cd\u5df2\u7ecf\u5b9a\u4e49\u597d\u7684\u7ea6\u675f\u6761\u4ef6\uff0c\u8fd9\u4e9b\u6761\u4ef6\u5b9a\u4e49\u5728namespace\u4e2dLimitRange\u5bf9\u8c61\u4e2d\u3002</li> <li>NamespaceExists\uff1a\u89c2\u5bdf\u6240\u6709\u7684\u8bf7\u6c42\uff0c\u5982\u679c\u8bf7\u6c42\u5c1d\u8bd5\u521b\u5efa\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684namespace\uff0c\u5219\u8fd9\u4e2a\u8bf7\u6c42\u88ab\u62d2\u7edd\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-42-kubernetes-rbac","title":"6-42 \u7b80\u8ff0Kubernetes RBAC\u53ca\u5176\u7279\u70b9\uff08\u4f18\u52bf\uff09\uff1f","text":"<p>RBAC\u662f\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236\uff0c\u662f\u4e00\u79cd\u57fa\u4e8e\u4e2a\u4eba\u7528\u6237\u7684\u89d2\u8272\u6765\u7ba1\u7406\u5bf9\u8ba1\u7b97\u673a\u6216\u7f51\u7edc\u8d44\u6e90\u7684\u8bbf\u95ee\u7684\u65b9\u6cd5\u3002</p> <p>\u76f8\u5bf9\u4e8e\u5176\u4ed6\u6388\u6743\u6a21\u5f0f\uff0cRBAC\u5177\u6709\u5982\u4e0b\u4f18\u52bf\uff1a</p> <ul> <li>\u5bf9\u96c6\u7fa4\u4e2d\u7684\u8d44\u6e90\u548c\u975e\u8d44\u6e90\u6743\u9650\u5747\u6709\u5b8c\u6574\u7684\u8986\u76d6\u3002</li> <li>\u6574\u4e2aRBAC\u5b8c\u5168\u7531\u51e0\u4e2aAPI\u5bf9\u8c61\u5b8c\u6210\uff0c \u540c\u5176\u4ed6API\u5bf9\u8c61\u4e00\u6837\uff0c \u53ef\u4ee5\u7528kubectl\u6216API\u8fdb\u884c\u64cd\u4f5c\u3002</li> <li>\u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u8fdb\u884c\u8c03\u6574\uff0c\u65e0\u987b\u91cd\u65b0\u542f\u52a8API Server\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-43-kubernetes-secret","title":"6-43 \u7b80\u8ff0Kubernetes Secret\u4f5c\u7528\uff1f","text":"<p>Secret\u5bf9\u8c61\uff0c\u4e3b\u8981\u4f5c\u7528\u662f\u4fdd\u7ba1\u79c1\u5bc6\u6570\u636e\uff0c\u6bd4\u5982\u5bc6\u7801\u3001OAuth Tokens\u3001SSH Keys\u7b49\u4fe1\u606f\u3002\u5c06\u8fd9\u4e9b\u79c1\u5bc6\u4fe1\u606f\u653e\u5728Secret\u5bf9\u8c61\u4e2d\u6bd4\u76f4\u63a5\u653e\u5728Pod\u6216Docker Image\u4e2d\u66f4\u5b89\u5168\uff0c\u4e5f\u66f4\u4fbf\u4e8e\u4f7f\u7528\u548c\u5206\u53d1\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-44-kubernetes-secret","title":"6-44 \u7b80\u8ff0Kubernetes Secret\u6709\u54ea\u4e9b\u4f7f\u7528\u65b9\u5f0f\uff1f","text":"<p>\u521b\u5efa\u5b8csecret\u4e4b\u540e\uff0c\u53ef\u901a\u8fc7\u5982\u4e0b\u4e09\u79cd\u65b9\u5f0f\u4f7f\u7528\uff1a</p> <ul> <li>\u5728\u521b\u5efaPod\u65f6\uff0c\u901a\u8fc7\u4e3aPod\u6307\u5b9aService Account\u6765\u81ea\u52a8\u4f7f\u7528\u8be5Secret\u3002</li> <li>\u901a\u8fc7\u6302\u8f7d\u8be5Secret\u5230Pod\u6765\u4f7f\u7528\u5b83\u3002</li> <li>\u5728Docker\u955c\u50cf\u4e0b\u8f7d\u65f6\u4f7f\u7528\uff0c\u901a\u8fc7\u6307\u5b9aPod\u7684spc.ImagePullSecrets\u6765\u5f15\u7528\u5b83\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-45-kubernetes-podsecuritypolicy","title":"6-45 \u7b80\u8ff0Kubernetes PodSecurityPolicy\u673a\u5236\uff1f","text":"<p>Kubernetes PodSecurityPolicy\u662f\u4e3a\u4e86\u66f4\u7cbe\u7ec6\u5730\u63a7\u5236Pod\u5bf9\u8d44\u6e90\u7684\u4f7f\u7528\u65b9\u5f0f\u4ee5\u53ca\u63d0\u5347\u5b89\u5168\u7b56\u7565\u3002</p> <p>\u5728\u5f00\u542fPodSecurityPolicy\u51c6\u5165\u63a7\u5236\u5668\u540e\uff0cKubernetes\u9ed8\u8ba4\u4e0d\u5141\u8bb8\u521b\u5efa\u4efb\u4f55Pod\uff0c\u9700\u8981\u521b\u5efaPodSecurityPolicy\u7b56\u7565\u548c\u76f8\u5e94\u7684RBAC\u6388\u6743\u7b56\u7565\uff08Authorizing Policies\uff09\uff0cPod\u624d\u80fd\u521b\u5efa\u6210\u529f\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-46-kubernetes-podsecuritypolicy","title":"6-46 \u7b80\u8ff0Kubernetes PodSecurityPolicy\u673a\u5236\u80fd\u5b9e\u73b0\u54ea\u4e9b\u5b89\u5168\u7b56\u7565\uff1f","text":"<p>\u5728PodSecurityPolicy\u5bf9\u8c61\u4e2d\u53ef\u4ee5\u8bbe\u7f6e\u4e0d\u540c\u5b57\u6bb5\u6765\u63a7\u5236Pod\u8fd0\u884c\u65f6\u7684\u5404\u79cd\u5b89\u5168\u7b56\u7565\uff0c\u5e38\u89c1\u7684\u6709\uff1a</p> <ul> <li>\u7279\u6743\u6a21\u5f0f\uff1aprivileged\u662f\u5426\u5141\u8bb8Pod\u4ee5\u7279\u6743\u6a21\u5f0f\u8fd0\u884c\u3002</li> <li>\u5bbf\u4e3b\u673a\u8d44\u6e90\uff1a\u63a7\u5236Pod\u5bf9\u5bbf\u4e3b\u673a\u8d44\u6e90\u7684\u63a7\u5236\uff0c\u5982hostPID\uff1a\u662f\u5426\u5141\u8bb8Pod\u5171\u4eab\u5bbf\u4e3b\u673a\u7684\u8fdb\u7a0b\u7a7a\u95f4\u3002</li> <li>\u7528\u6237\u548c\u7ec4\uff1a\u8bbe\u7f6e\u8fd0\u884c\u5bb9\u5668\u7684\u7528\u6237ID\uff08\u8303\u56f4\uff09\u6216\u7ec4\uff08\u8303\u56f4\uff09\u3002</li> <li>\u63d0\u5347\u6743\u9650\uff1aAllowPrivilegeEscalation\uff1a\u8bbe\u7f6e\u5bb9\u5668\u5185\u7684\u5b50\u8fdb\u7a0b\u662f\u5426\u53ef\u4ee5\u63d0\u5347\u6743\u9650\uff0c\u901a\u5e38\u5728\u8bbe\u7f6e\u975eroot\u7528\u6237\uff08MustRunAsNonRoot\uff09\u65f6\u8fdb\u884c\u8bbe\u7f6e\u3002</li> <li>SELinux\uff1a\u8fdb\u884cSELinux\u7684\u76f8\u5173\u914d\u7f6e\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-47-kubernetes","title":"6-47 \u7b80\u8ff0Kubernetes\u7f51\u7edc\u6a21\u578b\uff1f","text":"<p>Kubernetes\u7f51\u7edc\u6a21\u578b\u4e2d\u6bcf\u4e2aPod\u90fd\u62e5\u6709\u4e00\u4e2a\u72ec\u7acb\u7684IP\u5730\u5740\uff0c\u5e76\u5047\u5b9a\u6240\u6709Pod\u90fd\u5728\u4e00\u4e2a\u53ef\u4ee5\u76f4\u63a5\u8fde\u901a\u7684\u3001\u6241\u5e73\u7684\u7f51\u7edc\u7a7a\u95f4\u4e2d\u3002\u6240\u4ee5\u4e0d\u7ba1\u5b83\u4eec\u662f\u5426\u8fd0\u884c\u5728\u540c\u4e00\u4e2aNode\uff08\u5bbf\u4e3b\u673a\uff09\u4e2d\uff0c\u90fd\u8981\u6c42\u5b83\u4eec\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u5bf9\u65b9\u7684IP\u8fdb\u884c\u8bbf\u95ee\u3002\u8bbe\u8ba1\u8fd9\u4e2a\u539f\u5219\u7684\u539f\u56e0\u662f\uff0c\u7528\u6237\u4e0d\u9700\u8981\u989d\u5916\u8003\u8651\u5982\u4f55\u5efa\u7acbPod\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u4e5f\u4e0d\u9700\u8981\u8003\u8651\u5982\u4f55\u5c06\u5bb9\u5668\u7aef\u53e3\u6620\u5c04\u5230\u4e3b\u673a\u7aef\u53e3\u7b49\u95ee\u9898\u3002</p> <p>\u540c\u65f6\u4e3a\u6bcf\u4e2aPod\u90fd\u8bbe\u7f6e\u4e00\u4e2aIP\u5730\u5740\u7684\u6a21\u578b\u4f7f\u5f97\u540c\u4e00\u4e2aPod\u5185\u7684\u4e0d\u540c\u5bb9\u5668\u4f1a\u5171\u4eab\u540c\u4e00\u4e2a\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\uff0c\u4e5f\u5c31\u662f\u540c\u4e00\u4e2aLinux\u7f51\u7edc\u534f\u8bae\u6808\u3002\u8fd9\u5c31\u610f\u5473\u7740\u540c\u4e00\u4e2aPod\u5185\u7684\u5bb9\u5668\u53ef\u4ee5\u901a\u8fc7localhost\u6765\u8fde\u63a5\u5bf9\u65b9\u7684\u7aef\u53e3\u3002</p> <p>\u5728Kubernetes\u7684\u96c6\u7fa4\u91cc\uff0cIP\u662f\u4ee5Pod\u4e3a\u5355\u4f4d\u8fdb\u884c\u5206\u914d\u7684\u3002\u4e00\u4e2aPod\u5185\u90e8\u7684\u6240\u6709\u5bb9\u5668\u5171\u4eab\u4e00\u4e2a\u7f51\u7edc\u5806\u6808\uff08\u76f8\u5f53\u4e8e\u4e00\u4e2a\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\uff0c\u5b83\u4eec\u7684IP\u5730\u5740\u3001\u7f51\u7edc\u8bbe\u5907\u3001\u914d\u7f6e\u7b49\u90fd\u662f\u5171\u4eab\u7684\uff09\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-48-kubernetes-cni","title":"6-48 \u7b80\u8ff0Kubernetes CNI\u6a21\u578b\uff1f","text":"<p>CNI\u63d0\u4f9b\u4e86\u4e00\u79cd\u5e94\u7528\u5bb9\u5668\u7684\u63d2\u4ef6\u5316\u7f51\u7edc\u89e3\u51b3\u65b9\u6848\uff0c\u5b9a\u4e49\u5bf9\u5bb9\u5668\u7f51\u7edc\u8fdb\u884c\u64cd\u4f5c\u548c\u914d\u7f6e\u7684\u89c4\u8303\uff0c\u901a\u8fc7\u63d2\u4ef6\u7684\u5f62\u5f0f\u5bf9CNI\u63a5\u53e3\u8fdb\u884c\u5b9e\u73b0\u3002CNI\u4ec5\u5173\u6ce8\u5728\u521b\u5efa\u5bb9\u5668\u65f6\u5206\u914d\u7f51\u7edc\u8d44\u6e90\uff0c\u548c\u5728\u9500\u6bc1\u5bb9\u5668\u65f6\u5220\u9664\u7f51\u7edc\u8d44\u6e90\u3002</p> <p>\u5728CNI\u6a21\u578b\u4e2d\u53ea\u6d89\u53ca\u4e24\u4e2a\u6982\u5ff5\uff1a\u5bb9\u5668\u548c\u7f51\u7edc\u3002</p> <ul> <li>\u5bb9\u5668\uff08Container\uff09\uff1a\u662f\u62e5\u6709\u72ec\u7acbLinux\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\u7684\u73af\u5883\uff0c\u4f8b\u5982\u4f7f\u7528Docker\u6216rkt\u521b\u5efa\u7684\u5bb9\u5668\u3002\u5bb9\u5668\u9700\u8981\u62e5\u6709\u81ea\u5df1\u7684Linux\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\uff0c\u8fd9\u662f\u52a0\u5165\u7f51\u7edc\u7684\u5fc5\u8981\u6761\u4ef6\u3002</li> <li>\u7f51\u7edc\uff08Network\uff09\uff1a\u8868\u793a\u53ef\u4ee5\u4e92\u8fde\u7684\u4e00\u7ec4\u5b9e\u4f53\uff0c\u8fd9\u4e9b\u5b9e\u4f53\u62e5\u6709\u5404\u81ea\u72ec\u7acb\u3001\u552f\u4e00\u7684IP\u5730\u5740\uff0c\u53ef\u4ee5\u662f\u5bb9\u5668\u3001\u7269\u7406\u673a\u6216\u8005\u5176\u4ed6\u7f51\u7edc\u8bbe\u5907\uff08\u6bd4\u5982\u8def\u7531\u5668\uff09\u7b49\u3002</li> </ul> <p>\u5bf9\u5bb9\u5668\u7f51\u7edc\u7684\u8bbe\u7f6e\u548c\u64cd\u4f5c\u90fd\u901a\u8fc7\u63d2\u4ef6\uff08Plugin\uff09\u8fdb\u884c\u5177\u4f53\u5b9e\u73b0\uff0cCNI\u63d2\u4ef6\u5305\u62ec\u4e24\u79cd\u7c7b\u578b\uff1aCNI Plugin\u548cIPAM\uff08IP Address  Management\uff09Plugin\u3002</p> <p>CNI Plugin\u8d1f\u8d23\u4e3a\u5bb9\u5668\u914d\u7f6e\u7f51\u7edc\u8d44\u6e90\uff0cIPAM Plugin\u8d1f\u8d23\u5bf9\u5bb9\u5668\u7684IP\u5730\u5740\u8fdb\u884c\u5206\u914d\u548c\u7ba1\u7406\u3002IPAM Plugin\u4f5c\u4e3aCNI Plugin\u7684\u4e00\u90e8\u5206\uff0c\u4e0eCNI Plugin\u534f\u540c\u5de5\u4f5c\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-49-kubernetes","title":"6-49 \u7b80\u8ff0Kubernetes\u7f51\u7edc\u7b56\u7565\uff1f","text":"<p>\u4e3a\u5b9e\u73b0\u7ec6\u7c92\u5ea6\u7684\u5bb9\u5668\u95f4\u7f51\u7edc\u8bbf\u95ee\u9694\u79bb\u7b56\u7565\uff0cKubernetes\u5f15\u5165Network Policy\u3002</p> <p>Network Policy\u7684\u4e3b\u8981\u529f\u80fd\u662f\u5bf9Pod\u95f4\u7684\u7f51\u7edc\u901a\u4fe1\u8fdb\u884c\u9650\u5236\u548c\u51c6\u5165\u63a7\u5236\uff0c\u8bbe\u7f6e\u5141\u8bb8\u8bbf\u95ee\u6216\u7981\u6b62\u8bbf\u95ee\u7684\u5ba2\u6237\u7aefPod\u5217\u8868\u3002<code>Network Policy</code>\u5b9a\u4e49\u7f51\u7edc\u7b56\u7565\uff0c\u914d\u5408\u7b56\u7565\u63a7\u5236\u5668\uff08<code>Policy Controller</code>\uff09\u8fdb\u884c\u7b56\u7565\u7684\u5b9e\u73b0\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-50-kubernetes","title":"6-50 \u7b80\u8ff0Kubernetes\u7f51\u7edc\u7b56\u7565\u539f\u7406\uff1f","text":"<p>Network Policy\u7684\u5de5\u4f5c\u539f\u7406\u4e3b\u8981\u4e3a\uff1apolicy controller\u9700\u8981\u5b9e\u73b0\u4e00\u4e2aAPI Listener\uff0c\u76d1\u542c\u7528\u6237\u8bbe\u7f6e\u7684Network Policy\u5b9a\u4e49\uff0c\u5e76\u5c06\u7f51\u7edc\u8bbf\u95ee\u89c4\u5219\u901a\u8fc7\u5404Node\u7684Agent\u8fdb\u884c\u5b9e\u9645\u8bbe\u7f6e\uff08Agent\u5219\u9700\u8981\u901a\u8fc7CNI\u7f51\u7edc\u63d2\u4ef6\u5b9e\u73b0\uff09\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-51-kubernetesflannel","title":"6-51 \u7b80\u8ff0Kubernetes\u4e2dflannel\u7684\u4f5c\u7528\uff1f","text":"<p>Flannel\u53ef\u4ee5\u7528\u4e8eKubernetes\u5e95\u5c42\u7f51\u7edc\u7684\u5b9e\u73b0\uff0c\u4e3b\u8981\u4f5c\u7528\u6709\uff1a</p> <ul> <li>\u5b83\u80fd\u534f\u52a9Kubernetes\uff0c\u7ed9\u6bcf\u4e00\u4e2aNode\u4e0a\u7684Docker\u5bb9\u5668\u90fd\u5206\u914d\u4e92\u76f8\u4e0d\u51b2\u7a81\u7684IP\u5730\u5740\u3002</li> <li>\u5b83\u80fd\u5728\u8fd9\u4e9bIP\u5730\u5740\u4e4b\u95f4\u5efa\u7acb\u4e00\u4e2a\u8986\u76d6\u7f51\u7edc\uff08Overlay Network\uff09\uff0c\u901a\u8fc7\u8fd9\u4e2a\u8986\u76d6\u7f51\u7edc\uff0c\u5c06\u6570\u636e\u5305\u539f\u5c01\u4e0d\u52a8\u5730\u4f20\u9012\u5230\u76ee\u6807\u5bb9\u5668\u5185\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-52-kubernetes-calico","title":"6-52 \u7b80\u8ff0Kubernetes Calico\u7f51\u7edc\u7ec4\u4ef6\u5b9e\u73b0\u539f\u7406\uff1f","text":"<p>Calico\u662f\u4e00\u4e2a\u57fa\u4e8eBGP\u7684\u7eaf\u4e09\u5c42\u7684\u7f51\u7edc\u65b9\u6848\uff0c\u4e0eOpenStack\u3001Kubernetes\u3001AWS\u3001GCE\u7b49\u4e91\u5e73\u53f0\u90fd\u80fd\u591f\u826f\u597d\u5730\u96c6\u6210\u3002</p> <p>Calico\u5728\u6bcf\u4e2a\u8ba1\u7b97\u8282\u70b9\u90fd\u5229\u7528Linux Kernel\u5b9e\u73b0\u4e86\u4e00\u4e2a\u9ad8\u6548\u7684vRouter\u6765\u8d1f\u8d23\u6570\u636e\u8f6c\u53d1\u3002\u6bcf\u4e2avRouter\u90fd\u901a\u8fc7BGP\u534f\u8bae\u628a\u5728\u672c\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\u5bb9\u5668\u7684\u8def\u7531\u4fe1\u606f\u5411\u6574\u4e2aCalico\u7f51\u7edc\u5e7f\u64ad\uff0c\u5e76\u81ea\u52a8\u8bbe\u7f6e\u5230\u8fbe\u5176\u4ed6\u8282\u70b9\u7684\u8def\u7531\u8f6c\u53d1\u89c4\u5219\u3002</p> <p>Calico\u4fdd\u8bc1\u6240\u6709\u5bb9\u5668\u4e4b\u95f4\u7684\u6570\u636e\u6d41\u91cf\u90fd\u662f\u901a\u8fc7IP\u8def\u7531\u7684\u65b9\u5f0f\u5b8c\u6210\u4e92\u8054\u4e92\u901a\u7684\u3002Calico\u8282\u70b9\u7ec4\u7f51\u65f6\u53ef\u4ee5\u76f4\u63a5\u5229\u7528\u6570\u636e\u4e2d\u5fc3\u7684\u7f51\u7edc\u7ed3\u6784\uff08L2\u6216\u8005L3\uff09\uff0c\u4e0d\u9700\u8981\u989d\u5916\u7684NAT\u3001\u96a7\u9053\u6216\u8005Overlay Network\uff0c\u6ca1\u6709\u989d\u5916\u7684\u5c01\u5305\u89e3\u5305\uff0c\u80fd\u591f\u8282\u7ea6CPU\u8fd0\u7b97\uff0c\u63d0\u9ad8\u7f51\u7edc\u6548\u7387\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-53-kubernetes","title":"6-53 \u7b80\u8ff0Kubernetes\u5171\u4eab\u5b58\u50a8\u7684\u4f5c\u7528\uff1f","text":"<p>Kubernetes\u5bf9\u4e8e\u6709\u72b6\u6001\u7684\u5bb9\u5668\u5e94\u7528\u6216\u8005\u5bf9\u6570\u636e\u9700\u8981\u6301\u4e45\u5316\u7684\u5e94\u7528\uff0c\u56e0\u6b64\u9700\u8981\u66f4\u52a0\u53ef\u9760\u7684\u5b58\u50a8\u6765\u4fdd\u5b58\u5e94\u7528\u4ea7\u751f\u7684\u91cd\u8981\u6570\u636e\uff0c\u4ee5\u4fbf\u5bb9\u5668\u5e94\u7528\u5728\u91cd\u5efa\u4e4b\u540e\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528\u4e4b\u524d\u7684\u6570\u636e\u3002\u56e0\u6b64\u9700\u8981\u4f7f\u7528\u5171\u4eab\u5b58\u50a8\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-54-kubernetes","title":"6-54 \u7b80\u8ff0Kubernetes\u6570\u636e\u6301\u4e45\u5316\u7684\u65b9\u5f0f\u6709\u54ea\u4e9b\uff1f","text":"<p>Kubernetes\u901a\u8fc7\u6570\u636e\u6301\u4e45\u5316\u6765\u6301\u4e45\u5316\u4fdd\u5b58\u91cd\u8981\u6570\u636e\uff0c\u5e38\u89c1\u7684\u65b9\u5f0f\u6709\uff1a</p> <ul> <li> <p>EmptyDir\uff08\u7a7a\u76ee\u5f55\uff09\uff1a\u6ca1\u6709\u6307\u5b9a\u8981\u6302\u8f7d\u5bbf\u4e3b\u673a\u4e0a\u7684\u67d0\u4e2a\u76ee\u5f55\uff0c\u76f4\u63a5\u7531Pod\u5185\u4fdd\u90e8\u6620\u5c04\u5230\u5bbf\u4e3b\u673a\u4e0a\u3002\u7c7b\u4f3c\u4e8edocker\u4e2d\u7684manager volume\u3002</p> <ul> <li>\u573a\u666f\uff1a<ul> <li>\u53ea\u9700\u8981\u4e34\u65f6\u5c06\u6570\u636e\u4fdd\u5b58\u5728\u78c1\u76d8\u4e0a\uff0c\u6bd4\u5982\u5728\u5408\u5e76/\u6392\u5e8f\u7b97\u6cd5\u4e2d\uff1b</li> <li>\u4f5c\u4e3a\u4e24\u4e2a\u5bb9\u5668\u7684\u5171\u4eab\u5b58\u50a8\u3002</li> </ul> </li> <li>\u7279\u6027\uff1a<ul> <li>\u540c\u4e2apod\u91cc\u9762\u7684\u4e0d\u540c\u5bb9\u5668\uff0c\u5171\u4eab\u540c\u4e00\u4e2a\u6301\u4e45\u5316\u76ee\u5f55\uff0c\u5f53pod\u8282\u70b9\u5220\u9664\u65f6\uff0cvolume\u7684\u6570\u636e\u4e5f\u4f1a\u88ab\u5220\u9664\u3002</li> <li>emptyDir\u7684\u6570\u636e\u6301\u4e45\u5316\u7684\u751f\u547d\u5468\u671f\u548c\u4f7f\u7528\u7684pod\u4e00\u81f4\uff0c\u4e00\u822c\u662f\u4f5c\u4e3a\u4e34\u65f6\u5b58\u50a8\u4f7f\u7528\u3002</li> </ul> </li> </ul> </li> <li> <p>Hostpath\uff1a\u5c06\u5bbf\u4e3b\u673a\u4e0a\u5df2\u5b58\u5728\u7684\u76ee\u5f55\u6216\u6587\u4ef6\u6302\u8f7d\u5230\u5bb9\u5668\u5185\u90e8\u3002\u7c7b\u4f3c\u4e8edocker\u4e2d\u7684bind mount\u6302\u8f7d\u65b9\u5f0f\u3002</p> <ul> <li>\u7279\u6027\uff1a\u589e\u52a0\u4e86pod\u4e0e\u8282\u70b9\u4e4b\u95f4\u7684\u8026\u5408\u3002</li> </ul> </li> </ul> <p>PersistentVolume\uff08\u7b80\u79f0PV\uff09\uff1a\u5982\u57fa\u4e8eNFS\u670d\u52a1\u7684PV\uff0c\u4e5f\u53ef\u4ee5\u57fa\u4e8eGFS\u7684PV\u3002\u5b83\u7684\u4f5c\u7528\u662f\u7edf\u4e00\u6570\u636e\u6301\u4e45\u5316\u76ee\u5f55\uff0c\u65b9\u4fbf\u7ba1\u7406\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-55-kubernetes-pvpvc","title":"6-55 \u7b80\u8ff0Kubernetes PV\u548cPVC\uff1f","text":"<p>PV\u662f\u5bf9\u5e95\u5c42\u7f51\u7edc\u5171\u4eab\u5b58\u50a8\u7684\u62bd\u8c61\uff0c\u5c06\u5171\u4eab\u5b58\u50a8\u5b9a\u4e49\u4e3a\u4e00\u79cd\u201c\u8d44\u6e90\u201d\u3002</p> <p>PVC\u5219\u662f\u7528\u6237\u5bf9\u5b58\u50a8\u8d44\u6e90\u7684\u4e00\u4e2a\u201c\u7533\u8bf7\u201d\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-56-kubernetes-pv","title":"6-56 \u7b80\u8ff0Kubernetes PV\u751f\u547d\u5468\u671f\u5185\u7684\u9636\u6bb5\uff1f","text":"<p>\u67d0\u4e2aPV\u5728\u751f\u547d\u5468\u671f\u4e2d\u53ef\u80fd\u5904\u4e8e\u4ee5\u4e0b4\u4e2a\u9636\u6bb5\uff08Phaes\uff09\u4e4b\u4e00\u3002</p> <ul> <li>Available\uff1a\u53ef\u7528\u72b6\u6001\uff0c\u8fd8\u672a\u4e0e\u67d0\u4e2aPVC\u7ed1\u5b9a\u3002</li> <li>Bound\uff1a\u5df2\u4e0e\u67d0\u4e2aPVC\u7ed1\u5b9a\u3002</li> <li>Released\uff1a\u7ed1\u5b9a\u7684PVC\u5df2\u7ecf\u5220\u9664\uff0c\u8d44\u6e90\u5df2\u91ca\u653e\uff0c\u4f46\u6ca1\u6709\u88ab\u96c6\u7fa4\u56de\u6536\u3002</li> <li>Failed\uff1a\u81ea\u52a8\u8d44\u6e90\u56de\u6536\u5931\u8d25\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-57-kubernetes","title":"6-57 \u7b80\u8ff0Kubernetes\u6240\u652f\u6301\u7684\u5b58\u50a8\u4f9b\u5e94\u6a21\u5f0f\uff1f","text":"<p>Kubernetes\u652f\u6301\u4e24\u79cd\u8d44\u6e90\u7684\u5b58\u50a8\u4f9b\u5e94\u6a21\u5f0f\uff1a\u9759\u6001\u6a21\u5f0f\uff08Static\uff09\u548c\u52a8\u6001\u6a21\u5f0f\uff08Dynamic\uff09\u3002</p> <ul> <li>\u9759\u6001\u6a21\u5f0f\uff1a\u96c6\u7fa4\u7ba1\u7406\u5458\u624b\u5de5\u521b\u5efa\u8bb8\u591aPV\uff0c\u5728\u5b9a\u4e49PV\u65f6\u9700\u8981\u5c06\u540e\u7aef\u5b58\u50a8\u7684\u7279\u6027\u8fdb\u884c\u8bbe\u7f6e\u3002</li> <li>\u52a8\u6001\u6a21\u5f0f\uff1a\u96c6\u7fa4\u7ba1\u7406\u5458\u65e0\u987b\u624b\u5de5\u521b\u5efaPV\uff0c\u800c\u662f\u901a\u8fc7StorageClass\u7684\u8bbe\u7f6e\u5bf9\u540e\u7aef\u5b58\u50a8\u8fdb\u884c\u63cf\u8ff0\uff0c\u6807\u8bb0\u4e3a\u67d0\u79cd\u7c7b\u578b\u3002\u6b64\u65f6\u8981\u6c42PVC\u5bf9\u5b58\u50a8\u7684\u7c7b\u578b\u8fdb\u884c\u58f0\u660e\uff0c\u7cfb\u7edf\u5c06\u81ea\u52a8\u5b8c\u6210PV\u7684\u521b\u5efa\u53ca\u4e0ePVC\u7684\u7ed1\u5b9a\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-58-kubernetes-csi","title":"6-58  \u7b80\u8ff0Kubernetes CSI\u6a21\u578b\uff1f","text":"<p>Kubernetes CSI\u662fKubernetes\u63a8\u51fa\u4e0e\u5bb9\u5668\u5bf9\u63a5\u7684\u5b58\u50a8\u63a5\u53e3\u6807\u51c6\uff0c\u5b58\u50a8\u63d0\u4f9b\u65b9\u53ea\u9700\u8981\u57fa\u4e8e\u6807\u51c6\u63a5\u53e3\u8fdb\u884c\u5b58\u50a8\u63d2\u4ef6\u7684\u5b9e\u73b0\uff0c\u5c31\u80fd\u4f7f\u7528Kubernetes\u7684\u539f\u751f\u5b58\u50a8\u673a\u5236\u4e3a\u5bb9\u5668\u63d0\u4f9b\u5b58\u50a8\u670d\u52a1\u3002CSI\u4f7f\u5f97\u5b58\u50a8\u63d0\u4f9b\u65b9\u7684\u4ee3\u7801\u80fd\u548cKubernetes\u4ee3\u7801\u5f7b\u5e95\u89e3\u8026\uff0c\u90e8\u7f72\u4e5f\u4e0eKubernetes\u6838\u5fc3\u7ec4\u4ef6\u5206\u79bb\uff0c\u663e\u7136\uff0c\u5b58\u50a8\u63d2\u4ef6\u7684\u5f00\u53d1\u7531\u63d0\u4f9b\u65b9\u81ea\u884c\u7ef4\u62a4\uff0c\u5c31\u80fd\u4e3aKubernetes\u7528\u6237\u63d0\u4f9b\u66f4\u591a\u7684\u5b58\u50a8\u529f\u80fd\uff0c\u4e5f\u66f4\u52a0\u5b89\u5168\u53ef\u9760\u3002</p> <p>CSI\u5305\u62ecCSI Controller\u548cCSI Node\uff1a</p> <ul> <li>CSI Controller\u7684\u4e3b\u8981\u529f\u80fd\u662f\u63d0\u4f9b\u5b58\u50a8\u670d\u52a1\u89c6\u89d2\u5bf9\u5b58\u50a8\u8d44\u6e90\u548c\u5b58\u50a8\u5377\u8fdb\u884c\u7ba1\u7406\u548c\u64cd\u4f5c\u3002</li> <li>CSI Node\u7684\u4e3b\u8981\u529f\u80fd\u662f\u5bf9\u4e3b\u673a\uff08Node\uff09\u4e0a\u7684Volume\u8fdb\u884c\u7ba1\u7406\u548c\u64cd\u4f5c\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-59-kubernetes-worker","title":"6-59 \u7b80\u8ff0Kubernetes Worker\u8282\u70b9\u52a0\u5165\u96c6\u7fa4\u7684\u8fc7\u7a0b\uff1f","text":"<p>\u901a\u5e38\u9700\u8981\u5bf9Worker\u8282\u70b9\u8fdb\u884c\u6269\u5bb9\uff0c\u4ece\u800c\u5c06\u5e94\u7528\u7cfb\u7edf\u8fdb\u884c\u6c34\u5e73\u6269\u5c55\u3002\u4e3b\u8981\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>1\u3001\u5728\u8be5Node\u4e0a\u5b89\u88c5Docker\u3001kubelet\u548ckube-proxy\u670d\u52a1\uff1b</li> <li>2\u3001\u7136\u540e\u914d\u7f6ekubelet\u548ckubeproxy\u7684\u542f\u52a8\u53c2\u6570\uff0c\u5c06Master URL\u6307\u5b9a\u4e3a\u5f53\u524dKubernetes\u96c6\u7fa4Master\u7684\u5730\u5740\uff0c\u6700\u540e\u542f\u52a8\u8fd9\u4e9b\u670d\u52a1\uff1b</li> <li>3\u3001\u901a\u8fc7kubelet\u9ed8\u8ba4\u7684\u81ea\u52a8\u6ce8\u518c\u673a\u5236\uff0c\u65b0\u7684Worker\u5c06\u4f1a\u81ea\u52a8\u52a0\u5165\u73b0\u6709\u7684Kubernetes\u96c6\u7fa4\u4e2d\uff1b</li> <li>4\u3001Kubernetes Master\u5728\u63a5\u53d7\u4e86\u65b0Worker\u7684\u6ce8\u518c\u4e4b\u540e\uff0c\u4f1a\u81ea\u52a8\u5c06\u5176\u7eb3\u5165\u5f53\u524d\u96c6\u7fa4\u7684\u8c03\u5ea6\u8303\u56f4\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#6-60-kubernetes-pod","title":"6-60 \u7b80\u8ff0Kubernetes Pod\u5982\u4f55\u5b9e\u73b0\u5bf9\u8282\u70b9\u7684\u8d44\u6e90\u63a7\u5236\uff1f","text":"<p>Kubernetes\u96c6\u7fa4\u91cc\u7684\u8282\u70b9\u63d0\u4f9b\u7684\u8d44\u6e90\u4e3b\u8981\u662f\u8ba1\u7b97\u8d44\u6e90\uff0c\u8ba1\u7b97\u8d44\u6e90\u662f\u53ef\u8ba1\u91cf\u7684\u80fd\u88ab\u7533\u8bf7\u3001\u5206\u914d\u548c\u4f7f\u7528\u7684\u57fa\u7840\u8d44\u6e90\u3002\u5f53\u524dKubernetes\u96c6\u7fa4\u4e2d\u7684\u8ba1\u7b97\u8d44\u6e90\u4e3b\u8981\u5305\u62ecCPU\u3001GPU\u53caMemory\u3002CPU\u4e0eMemory\u662f\u88abPod\u4f7f\u7528\u7684\uff0c\u56e0\u6b64\u5728\u914d\u7f6ePod\u65f6\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570CPU Request\u53caMemory Request\u4e3a\u5176\u4e2d\u7684\u6bcf\u4e2a\u5bb9\u5668\u6307\u5b9a\u6240\u9700\u4f7f\u7528\u7684CPU\u4e0eMemory\u91cf\uff0cKubernetes\u4f1a\u6839\u636eRequest\u7684\u503c\u53bb\u67e5\u627e\u6709\u8db3\u591f\u8d44\u6e90\u7684Node\u6765\u8c03\u5ea6\u6b64Pod\u3002</p> <p>\u901a\u5e38\uff0c\u4e00\u4e2a\u7a0b\u5e8f\u6240\u4f7f\u7528\u7684CPU\u4e0eMemory\u662f\u4e00\u4e2a\u52a8\u6001\u7684\u91cf\uff0c\u786e\u5207\u5730\u8bf4\uff0c\u662f\u4e00\u4e2a\u8303\u56f4\uff0c\u8ddf\u5b83\u7684\u8d1f\u8f7d\u5bc6\u5207\u76f8\u5173\uff1a\u8d1f\u8f7d\u589e\u52a0\u65f6\uff0cCPU\u548cMemory\u7684\u4f7f\u7528\u91cf\u4e5f\u4f1a\u589e\u52a0\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-61-kubernetes-requestslimitspod","title":"6-61 \u7b80\u8ff0Kubernetes Requests\u548cLimits\u5982\u4f55\u5f71\u54cdPod\u7684\u8c03\u5ea6\uff1f","text":"<p>\u5f53\u4e00\u4e2aPod\u521b\u5efa\u6210\u529f\u65f6\uff0cKubernetes\u8c03\u5ea6\u5668\uff08Scheduler\uff09\u4f1a\u4e3a\u8be5Pod\u9009\u62e9\u4e00\u4e2a\u8282\u70b9\u6765\u6267\u884c\u3002</p> <p>\u5bf9\u4e8e\u6bcf\u79cd\u8ba1\u7b97\u8d44\u6e90\uff08CPU\u548cMemory\uff09\u800c\u8a00\uff0c\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u4e00\u4e2a\u80fd\u7528\u4e8e\u8fd0\u884cPod\u7684\u6700\u5927\u5bb9\u91cf\u503c\u3002</p> <p>\u8c03\u5ea6\u5668\u5728\u8c03\u5ea6\u65f6\uff0c\u9996\u5148\u8981\u786e\u4fdd\u8c03\u5ea6\u540e\u8be5\u8282\u70b9\u4e0a\u6240\u6709Pod\u7684CPU\u548c\u5185\u5b58\u7684Requests\u603b\u548c\uff0c\u4e0d\u8d85\u8fc7\u8be5\u8282\u70b9\u80fd\u63d0\u4f9b\u7ed9Pod\u4f7f\u7528\u7684CPU\u548cMemory\u7684\u6700\u5927\u5bb9\u91cf\u503c\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-62-kubernetes-metric-service","title":"6-62 \u7b80\u8ff0Kubernetes Metric Service\uff1f","text":"<p>\u5728Kubernetes\u4ece1.10\u7248\u672c\u540e\u91c7\u7528Metrics Server\u4f5c\u4e3a\u9ed8\u8ba4\u7684\u6027\u80fd\u6570\u636e\u91c7\u96c6\u548c\u76d1\u63a7\uff0c\u4e3b\u8981\u7528\u4e8e\u63d0\u4f9b\u6838\u5fc3\u6307\u6807\uff08Core Metrics\uff09\uff0c\u5305\u62ecNode\u3001Pod\u7684CPU\u548c\u5185\u5b58\u4f7f\u7528\u6307\u6807\u3002</p> <p>\u5bf9\u5176\u4ed6\u81ea\u5b9a\u4e49\u6307\u6807\uff08Custom Metrics\uff09\u7684\u76d1\u63a7\u5219\u7531Prometheus\u7b49\u7ec4\u4ef6\u6765\u5b8c\u6210\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-63-kubernetesefk","title":"6-63 \u7b80\u8ff0Kubernetes\u4e2d\uff0c\u5982\u4f55\u4f7f\u7528EFK\u5b9e\u73b0\u65e5\u5fd7\u7684\u7edf\u4e00\u7ba1\u7406\uff1f","text":"<p>\u5728Kubernetes\u96c6\u7fa4\u73af\u5883\u4e2d\uff0c\u901a\u5e38\u4e00\u4e2a\u5b8c\u6574\u7684\u5e94\u7528\u6216\u670d\u52a1\u6d89\u53ca\u7ec4\u4ef6\u8fc7\u591a\uff0c\u5efa\u8bae\u5bf9\u65e5\u5fd7\u7cfb\u7edf\u8fdb\u884c\u96c6\u4e2d\u5316\u7ba1\u7406\uff0c\u901a\u5e38\u91c7\u7528EFK\u5b9e\u73b0\u3002</p> <p>EFK\u662f Elasticsearch\u3001Fluentd \u548c Kibana \u7684\u7ec4\u5408\uff0c\u5176\u5404\u7ec4\u4ef6\u529f\u80fd\u5982\u4e0b\uff1a</p> <ul> <li>Elasticsearch\uff1a\u662f\u4e00\u4e2a\u641c\u7d22\u5f15\u64ce\uff0c\u8d1f\u8d23\u5b58\u50a8\u65e5\u5fd7\u5e76\u63d0\u4f9b\u67e5\u8be2\u63a5\u53e3\uff1b</li> <li>Fluentd\uff1a\u8d1f\u8d23\u4ece Kubernetes \u641c\u96c6\u65e5\u5fd7\uff0c\u6bcf\u4e2anode\u8282\u70b9\u4e0a\u9762\u7684fluentd\u76d1\u63a7\u5e76\u6536\u96c6\u8be5\u8282\u70b9\u4e0a\u9762\u7684\u7cfb\u7edf\u65e5\u5fd7\uff0c\u5e76\u5c06\u5904\u7406\u8fc7\u540e\u7684\u65e5\u5fd7\u4fe1\u606f\u53d1\u9001\u7ed9Elasticsearch\uff1b</li> <li>Kibana\uff1a\u63d0\u4f9b\u4e86\u4e00\u4e2a Web GUI\uff0c\u7528\u6237\u53ef\u4ee5\u6d4f\u89c8\u548c\u641c\u7d22\u5b58\u50a8\u5728 Elasticsearch \u4e2d\u7684\u65e5\u5fd7\u3002</li> </ul> <p>\u901a\u8fc7\u5728\u6bcf\u53f0node\u4e0a\u90e8\u7f72\u4e00\u4e2a\u4ee5DaemonSet\u65b9\u5f0f\u8fd0\u884c\u7684fluentd\u6765\u6536\u96c6\u6bcf\u53f0node\u4e0a\u7684\u65e5\u5fd7\u3002Fluentd\u5c06docker\u65e5\u5fd7\u76ee\u5f55<code>/var/lib/docker/containers</code>\u548c<code>/var/log</code>\u76ee\u5f55\u6302\u8f7d\u5230Pod\u4e2d\uff0c\u7136\u540ePod\u4f1a\u5728node\u8282\u70b9\u7684<code>/var/log/pods</code>\u76ee\u5f55\u4e2d\u521b\u5efa\u65b0\u7684\u76ee\u5f55\uff0c\u53ef\u4ee5\u533a\u522b\u4e0d\u540c\u7684\u5bb9\u5668\u65e5\u5fd7\u8f93\u51fa\uff0c\u8be5\u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\u94fe\u63a5\u5230<code>/var/lib/docker/contianers</code>\u76ee\u5f55\u4e0b\u7684\u5bb9\u5668\u65e5\u5fd7\u8f93\u51fa\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-64-kubernetes","title":"6-64 \u7b80\u8ff0Kubernetes\u5982\u4f55\u8fdb\u884c\u4f18\u96c5\u7684\u8282\u70b9\u5173\u673a\u7ef4\u62a4\uff1f","text":"<p>\u7531\u4e8eKubernetes\u8282\u70b9\u8fd0\u884c\u5927\u91cfPod\uff0c\u56e0\u6b64\u5728\u8fdb\u884c\u5173\u673a\u7ef4\u62a4\u4e4b\u524d\uff0c\u5efa\u8bae\u5148\u4f7f\u7528kubectl drain\u5c06\u8be5\u8282\u70b9\u7684Pod\u8fdb\u884c\u9a71\u9010\uff0c\u7136\u540e\u8fdb\u884c\u5173\u673a\u7ef4\u62a4\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-65-kubernetes","title":"6-65 \u7b80\u8ff0Kubernetes\u96c6\u7fa4\u8054\u90a6\uff1f","text":"<p>Kubernetes\u96c6\u7fa4\u8054\u90a6\u53ef\u4ee5\u5c06\u591a\u4e2aKubernetes\u96c6\u7fa4\u4f5c\u4e3a\u4e00\u4e2a\u96c6\u7fa4\u8fdb\u884c\u7ba1\u7406\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u5728\u4e00\u4e2a\u6570\u636e\u4e2d\u5fc3/\u4e91\u4e2d\u521b\u5efa\u591a\u4e2aKubernetes\u96c6\u7fa4\uff0c\u5e76\u4f7f\u7528\u96c6\u7fa4\u8054\u90a6\u5728\u4e00\u4e2a\u5730\u65b9\u63a7\u5236/\u7ba1\u7406\u6240\u6709\u96c6\u7fa4\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#6-66-helm","title":"6-66 \u7b80\u8ff0Helm\u53ca\u5176\u4f18\u52bf\uff1f","text":"<p>Helm \u662f Kubernetes \u7684\u8f6f\u4ef6\u5305\u7ba1\u7406\u5de5\u5177\u3002\u7c7b\u4f3c Ubuntu \u4e2d\u4f7f\u7528\u7684apt\u3001Centos\u4e2d\u4f7f\u7528\u7684yum \u6216\u8005Python\u4e2d\u7684 pip \u4e00\u6837\u3002</p> <p>Helm\u80fd\u591f\u5c06\u4e00\u7ec4K8S\u8d44\u6e90\u6253\u5305\u7edf\u4e00\u7ba1\u7406, \u662f\u67e5\u627e\u3001\u5171\u4eab\u548c\u4f7f\u7528\u4e3aKubernetes\u6784\u5efa\u7684\u8f6f\u4ef6\u7684\u6700\u4f73\u65b9\u5f0f\u3002</p> <p>Helm\u4e2d\u901a\u5e38\u6bcf\u4e2a\u5305\u79f0\u4e3a\u4e00\u4e2aChart\uff0c\u4e00\u4e2aChart\u662f\u4e00\u4e2a\u76ee\u5f55\uff08\u4e00\u822c\u60c5\u51b5\u4e0b\u4f1a\u5c06\u76ee\u5f55\u8fdb\u884c\u6253\u5305\u538b\u7f29\uff0c\u5f62\u6210name-version.tgz\u683c\u5f0f\u7684\u5355\u4e00\u6587\u4ef6\uff0c\u65b9\u4fbf\u4f20\u8f93\u548c\u5b58\u50a8\uff09\u3002</p> <p>Helm\u4f18\u52bf</p> <p>\u5728 Kubernetes\u4e2d\u90e8\u7f72\u4e00\u4e2a\u53ef\u4ee5\u4f7f\u7528\u7684\u5e94\u7528\uff0c\u9700\u8981\u6d89\u53ca\u5230\u5f88\u591a\u7684 Kubernetes \u8d44\u6e90\u7684\u5171\u540c\u534f\u4f5c\u3002\u4f7f\u7528helm\u5219\u5177\u6709\u5982\u4e0b\u4f18\u52bf\uff1a</p> <ul> <li>\u7edf\u4e00\u7ba1\u7406\u3001\u914d\u7f6e\u548c\u66f4\u65b0\u8fd9\u4e9b\u5206\u6563\u7684 k8s \u7684\u5e94\u7528\u8d44\u6e90\u6587\u4ef6\uff1b</li> <li>\u5206\u53d1\u548c\u590d\u7528\u4e00\u5957\u5e94\u7528\u6a21\u677f\uff1b</li> <li>\u5c06\u5e94\u7528\u7684\u4e00\u7cfb\u5217\u8d44\u6e90\u5f53\u505a\u4e00\u4e2a\u8f6f\u4ef6\u5305\u7ba1\u7406\u3002</li> <li>\u5bf9\u4e8e\u5e94\u7528\u53d1\u5e03\u8005\u800c\u8a00\uff0c\u53ef\u4ee5\u901a\u8fc7 Helm \u6253\u5305\u5e94\u7528\u3001\u7ba1\u7406\u5e94\u7528\u4f9d\u8d56\u5173\u7cfb\u3001\u7ba1\u7406\u5e94\u7528\u7248\u672c\u5e76\u53d1\u5e03\u5e94\u7528\u5230\u8f6f\u4ef6\u4ed3\u5e93\u3002</li> <li>\u5bf9\u4e8e\u4f7f\u7528\u8005\u800c\u8a00\uff0c\u4f7f\u7528 Helm \u540e\u4e0d\u7528\u9700\u8981\u7f16\u5199\u590d\u6742\u7684\u5e94\u7528\u90e8\u7f72\u6587\u4ef6\uff0c\u53ef\u4ee5\u4ee5\u7b80\u5355\u7684\u65b9\u5f0f\u5728 Kubernetes \u4e0a\u67e5\u627e\u3001\u5b89\u88c5\u3001\u5347\u7ea7\u3001\u56de\u6eda\u3001\u5378\u8f7d\u5e94\u7528\u7a0b\u5e8f\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#7openshift","title":"7\u3001OpenShift","text":""},{"location":"chap4/5k8s_OpenShift/#7-1-openshift","title":"7-1 \u7b80\u8ff0OpenShift\u53ca\u5176\u7279\u6027\uff1f","text":"<p>OpenShift\u662f\u4e00\u4e2a\u5bb9\u5668\u5e94\u7528\u7a0b\u5e8f\u5e73\u53f0\uff0c\u7528\u4e8e\u5728\u5b89\u5168\u7684\u3001\u53ef\u4f38\u7f29\u7684\u8d44\u6e90\u4e0a\u90e8\u7f72\u65b0\u5e94\u7528\u7a0b\u5e8f\uff0c\u800c\u914d\u7f6e\u548c\u7ba1\u7406\u5f00\u9500\u6700\u5c0f\u3002</p> <p>OpenShift\u6784\u5efa\u4e8eRed Hat Enterprise Linux\u3001Docker\u548cKubernetes\u4e4b\u4e0a\uff0c\u4e3a\u4f01\u4e1a\u7ea7\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5b89\u5168\u4e14\u53ef\u4f38\u7f29\u7684\u591a\u79df\u6237\u64cd\u4f5c\u7cfb\u7edf\uff0c\u540c\u65f6\u8fd8\u63d0\u4f9b\u4e86\u96c6\u6210\u7684\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u65f6\u548c\u5e93\u3002</p> <p>\u5176\u4e3b\u8981\u7279\u6027\uff1a</p> <ul> <li>\u81ea\u52a9\u670d\u52a1\u5e73\u53f0\uff1aOpenShift\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u4f7f\u7528Source-to-Image(S2I)\u4ece\u6a21\u677f\u6216\u81ea\u5df1\u7684\u6e90\u4ee3\u7801\u7ba1\u7406\u5b58\u50a8\u5e93\u521b\u5efa\u5e94\u7528\u7a0b\u5e8f\u3002\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u4e3a\u7528\u6237\u548c\u9879\u76ee\u5b9a\u4e49\u8d44\u6e90\u914d\u989d\u548c\u9650\u5236\uff0c\u4ee5\u63a7\u5236\u7cfb\u7edf\u8d44\u6e90\u7684\u4f7f\u7528\u3002</li> <li>\u591a\u8bed\u8a00\u652f\u6301\uff1aOpenShift\u652f\u6301Java\u3001Node.js\u3001PHP\u3001Perl\u4ee5\u53ca\u76f4\u63a5\u6765\u81eaRed Hat\u7684Ruby\u3002OpenShift\u8fd8\u652f\u6301\u4e2d\u95f4\u4ef6\u4ea7\u54c1\uff0c\u5982Apache httpd\u3001Apache Tomcat\u3001JBoss EAP\u3001ActiveMQ\u548cFuse\u3002</li> <li>\u81ea\u52a8\u5316\uff1aOpenShift\u63d0\u4f9b\u5e94\u7528\u7a0b\u5e8f\u751f\u547d\u5468\u671f\u7ba1\u7406\u529f\u80fd\uff0c\u5f53\u4e0a\u6e38\u6e90\u6216\u5bb9\u5668\u6620\u50cf\u53d1\u751f\u66f4\u6539\u65f6\uff0c\u53ef\u4ee5\u81ea\u52a8\u91cd\u65b0\u6784\u5efa\u548c\u91cd\u65b0\u90e8\u7f72\u5bb9\u5668\u3002\u6839\u636e\u8c03\u5ea6\u548c\u7b56\u7565\u6269\u5c55\u6216\u6545\u969c\u8f6c\u79fb\u5e94\u7528\u7a0b\u5e8f\u3002</li> <li>\u7528\u6237\u754c\u9762\uff1aOpenShift\u63d0\u4f9b\u7528\u4e8e\u90e8\u7f72\u548c\u76d1\u89c6\u5e94\u7528\u7a0b\u5e8f\u7684web UI\uff0c\u4ee5\u53ca\u7528\u4e8e\u8fdc\u7a0b\u7ba1\u7406\u5e94\u7528\u7a0b\u5e8f\u548c\u8d44\u6e90\u7684CLi\u3002</li> <li>\u534f\u4f5c\uff1aOpenShift\u5141\u8bb8\u5728\u7ec4\u7ec7\u5185\u6216\u4e0e\u66f4\u5927\u7684\u793e\u533a\u5171\u4eab\u9879\u76ee\u3002</li> <li>\u53ef\u4f38\u7f29\u6027\u548c\u9ad8\u53ef\u7528\u6027\uff1aOpenShift\u63d0\u4f9b\u4e86\u5bb9\u5668\u591a\u79df\u6237\u548c\u4e00\u4e2a\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u5e73\u53f0\uff0c\u5176\u4e2d\u5305\u62ec\u5f39\u6027\uff0c\u9ad8\u53ef\u7528\u6027\uff0c\u4ee5\u4fbf\u5e94\u7528\u7a0b\u5e8f\u80fd\u591f\u5728\u7269\u7406\u673a\u5668\u5b95\u673a\u7b49\u4e8b\u4ef6\u4e2d\u5b58\u6d3b\u4e0b\u6765\u3002OpenShift\u63d0\u4f9b\u4e86\u5bf9\u5bb9\u5668\u5065\u5eb7\u72b6\u51b5\u7684\u81ea\u52a8\u53d1\u73b0\u548c\u81ea\u52a8\u91cd\u65b0\u90e8\u7f72\u3002</li> <li>\u5bb9\u5668\u53ef\u79fb\u690d\u6027\uff1a\u5728OpenShift\u4e2d\uff0c\u5e94\u7528\u7a0b\u5e8f\u548c\u670d\u52a1\u4f7f\u7528\u6807\u51c6\u5bb9\u5668\u6620\u50cf\u8fdb\u884c\u6253\u5305\uff0c\u7ec4\u5408\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528Kubernetes\u8fdb\u884c\u7ba1\u7406\u3002\u8fd9\u4e9b\u6620\u50cf\u53ef\u4ee5\u90e8\u7f72\u5230\u57fa\u4e8e\u8fd9\u4e9b\u57fa\u7840\u6280\u672f\u7684\u5176\u4ed6\u5e73\u53f0\u4e0a\u3002</li> <li>\u5f00\u6e90\uff1a\u6ca1\u6709\u5382\u5546\u9501\u5b9a\u3002</li> <li>\u5b89\u5168\u6027\uff1aOpenShift\u4f7f\u7528SELinux\u63d0\u4f9b\u591a\u5c42\u5b89\u5168\u6027\u3001\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236\u4ee5\u53ca\u4e0e\u5916\u90e8\u8eab\u4efd\u9a8c\u8bc1\u7cfb\u7edf(\u5982LDAP\u548cOAuth)\u96c6\u6210\u7684\u80fd\u529b\u3002</li> <li>\u52a8\u6001\u5b58\u50a8\u7ba1\u7406\uff1aOpenShift\u4f7f\u7528Kubernetes\u6301\u4e45\u5377\u548c\u6301\u4e45\u5377\u58f0\u660e\u7684\u65b9\u5f0f\u4e3a\u5bb9\u5668\u6570\u636e\u63d0\u4f9b\u9759\u6001\u548c\u52a8\u6001\u5b58\u50a8\u7ba1\u7406</li> <li>\u57fa\u4e8e\u4e91(\u6216\u4e0d\u57fa\u4e8e\u4e91)\uff1a\u53ef\u4ee5\u5728\u88f8\u673a\u670d\u52a1\u5668\u3001\u6d3b\u6765\u81ea\u591a\u4e2a\u4f9b\u5e94\u5546\u7684hypervisor\u548c\u5927\u591a\u6570IaaS\u4e91\u63d0\u4f9b\u5546\u4e0a\u90e8\u7f72OpenShift\u5bb9\u5668\u5e73\u53f0\u3002</li> <li>\u4f01\u4e1a\u7ea7\uff1aRed Hat\u652f\u6301OpenShift\u3001\u9009\u5b9a\u7684\u5bb9\u5668\u6620\u50cf\u548c\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u65f6\u3002\u53ef\u4fe1\u7684\u7b2c\u4e09\u65b9\u5bb9\u5668\u6620\u50cf\u3001\u8fd0\u884c\u65f6\u548c\u5e94\u7528\u7a0b\u5e8f\u7531Red Hat\u8ba4\u8bc1\u3002\u53ef\u4ee5\u5728OpenShift\u63d0\u4f9b\u7684\u9ad8\u53ef\u7528\u6027\u7684\u5f3a\u5316\u5b89\u5168\u73af\u5883\u4e2d\u8fd0\u884c\u5185\u90e8\u6216\u7b2c\u4e09\u65b9\u5e94\u7528\u7a0b\u5e8f\u3002</li> <li>\u65e5\u5fd7\u805a\u5408\u548cmetrics\uff1a\u53ef\u4ee5\u5728\u4e2d\u5fc3\u8282\u70b9\u6536\u96c6\u3001\u805a\u5408\u548c\u5206\u6790\u90e8\u7f72\u5728OpenShift\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u65e5\u5fd7\u4fe1\u606f\u3002OpenShift\u80fd\u591f\u5b9e\u65f6\u6536\u96c6\u5173\u4e8e\u5e94\u7528\u7a0b\u5e8f\u7684\u5ea6\u91cf\u548c\u8fd0\u884c\u65f6\u4fe1\u606f\uff0c\u5e76\u5e2e\u52a9\u4e0d\u65ad\u4f18\u5316\u6027\u80fd\u3002</li> <li>\u5176\u4ed6\u7279\u6027\uff1aOpenShift\u652f\u6301\u5fae\u670d\u52a1\u4f53\u7cfb\u7ed3\u6784\uff0cOpenShift\u7684\u672c\u5730\u7279\u6027\u8db3\u4ee5\u652f\u6301DevOps\u6d41\u7a0b\uff0c\u5f88\u5bb9\u6613\u4e0e\u6807\u51c6\u548c\u5b9a\u5236\u7684\u6301\u7eed\u96c6\u6210/\u6301\u7eed\u90e8\u7f72\u5de5\u5177\u96c6\u6210\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#7-2-openshift-projects","title":"7-2 \u7b80\u8ff0OpenShift projects\u53ca\u5176\u4f5c\u7528\uff1f","text":"<p>OpenShift\u7ba1\u7406projects\u548cusers\u3002\u4e00\u4e2aprojects\u5bf9Kubernetes\u8d44\u6e90\u8fdb\u884c\u5206\u7ec4\uff0c\u4ee5\u4fbf\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u8bbf\u95ee\u6743\u9650\u3002\u8fd8\u53ef\u4ee5\u4e3aprojects\u5206\u914d\u914d\u989d\uff0c\u4ece\u800c\u9650\u5236\u4e86\u5df2\u5b9a\u4e49\u7684pod\u3001volumes\u3001services\u548c\u5176\u4ed6\u8d44\u6e90\u3002</p> <p>project\u5141\u8bb8\u4e00\u7ec4\u7528\u6237\u72ec\u7acb\u4e8e\u5176\u4ed6\u7ec4\u7ec4\u7ec7\u548c\u7ba1\u7406\u5176\u5185\u5bb9\uff0c\u5fc5\u987b\u5141\u8bb8\u7528\u6237\u8bbf\u95ee\u9879\u76ee\u3002\u5982\u679c\u5141\u8bb8\u521b\u5efa\u9879\u76ee\uff0c\u7528\u6237\u5c06\u81ea\u52a8\u8bbf\u95ee\u81ea\u5df1\u7684\u9879\u76ee\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#7-3-openshift","title":"7-3 \u7b80\u8ff0OpenShift\u9ad8\u53ef\u7528\u7684\u5b9e\u73b0\uff1f","text":"<p>OpenShift\u5e73\u53f0\u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027(HA)\u6709\u4e24\u4e2a\u4e0d\u540c\u7684\u65b9\u9762\uff1a</p> <p>OpenShift\u57fa\u7840\u8bbe\u65bd\u672c\u8eab\u7684HA(\u5373\u4e3b\u673a)\uff1b</p> <p>\u4ee5\u53ca\u5728OpenShift\u96c6\u7fa4\u4e2d\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u7684HA\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cOpenShift\u4e3amaster\u8282\u70b9\u63d0\u4f9b\u4e86\u5b8c\u5168\u652f\u6301\u7684\u672c\u673aHA\u673a\u5236\u3002\u5bf9\u4e8e\u5e94\u7528\u7a0b\u5e8f\u6216\u201cpods\u201d\uff0c\u5982\u679cpod\u56e0\u4efb\u4f55\u539f\u56e0\u4e22\u5931\uff0cKubernetes\u5c06\u8c03\u5ea6\u53e6\u4e00\u4e2a\u526f\u672c\uff0c\u5c06\u5176\u8fde\u63a5\u5230\u670d\u52a1\u5c42\u548c\u6301\u4e45\u5b58\u50a8\u3002\u5982\u679c\u6574\u4e2a\u8282\u70b9\u4e22\u5931\uff0cKubernetes\u4f1a\u4e3a\u5b83\u6240\u6709\u7684pod\u5b89\u6392\u66ff\u6362\u8282\u70b9\uff0c\u6700\u7ec8\u6240\u6709\u7684\u5e94\u7528\u7a0b\u5e8f\u90fd\u4f1a\u91cd\u65b0\u53ef\u7528\u3002pod\u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u8d1f\u8d23\u5b83\u4eec\u81ea\u5df1\u7684\u72b6\u6001\uff0c\u56e0\u6b64\u5b83\u4eec\u9700\u8981\u81ea\u5df1\u7ef4\u62a4\u5e94\u7528\u7a0b\u5e8f\u72b6\u6001(\u5982HTTP\u4f1a\u8bdd\u590d\u5236\u6216\u6570\u636e\u5e93\u590d\u5236)\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#7-4-openshiftsdn","title":"7-4 \u7b80\u8ff0OpenShift\u7684SDN\u7f51\u7edc\u5b9e\u73b0\uff1f","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cDocker\u7f51\u7edc\u4f7f\u7528\u4ec5\u4f7f\u7528\u4e3b\u673a\u865a\u673a\u7f51\u6865bridge\uff0c\u4e3b\u673a\u5185\u7684\u6240\u6709\u5bb9\u5668\u90fd\u8fde\u63a5\u81f3\u8be5\u7f51\u6865\u3002\u8fde\u63a5\u5230\u6b64\u6865\u7684\u6240\u6709\u5bb9\u5668\u90fd\u53ef\u4ee5\u5f7c\u6b64\u901a\u4fe1\uff0c\u4f46\u4e0d\u80fd\u4e0e\u4e0d\u540c\u4e3b\u673a\u4e0a\u7684\u5bb9\u5668\u901a\u4fe1\u3002</p> <p>\u4e3a\u4e86\u652f\u6301\u8de8\u96c6\u7fa4\u7684\u5bb9\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\uff0cOpenShift\u5bb9\u5668\u5e73\u53f0\u4f7f\u7528\u4e86\u8f6f\u4ef6\u5b9a\u4e49\u7684\u7f51\u7edc(SDN)\u65b9\u6cd5\u3002\u8f6f\u4ef6\u5b9a\u4e49\u7684\u7f51\u7edc\u662f\u4e00\u79cd\u7f51\u7edc\u6a21\u578b\uff0c\u5b83\u901a\u8fc7\u51e0\u4e2a\u7f51\u7edc\u5c42\u7684\u62bd\u8c61\u6765\u7ba1\u7406\u7f51\u7edc\u670d\u52a1\u3002SDN\u5c06\u5904\u7406\u6d41\u91cf\u7684\u8f6f\u4ef6(\u79f0\u4e3a\u63a7\u5236\u5e73\u9762)\u548c\u8def\u7531\u6d41\u91cf\u7684\u5e95\u5c42\u673a\u5236(\u79f0\u4e3a\u6570\u636e\u5e73\u9762)\u89e3\u8026\u3002SDN\u652f\u6301\u63a7\u5236\u5e73\u9762\u548c\u6570\u636e\u5e73\u9762\u4e4b\u95f4\u7684\u901a\u4fe1\u3002</p> <p>\u5728OpenShift\u4e2d\uff0c\u53ef\u4ee5\u4e3apod\u7f51\u7edc\u914d\u7f6e\u4e09\u4e2aSDN\u63d2\u4ef6:</p> <ul> <li>1\u3001ovs-subnet\uff1a\u9ed8\u8ba4\u63d2\u4ef6\uff0c\u5b50\u7f51\u63d0\u4f9b\u4e86\u4e00\u4e2aflat pod\u7f51\u7edc\uff0c\u5176\u4e2d\u6bcf\u4e2apod\u53ef\u4ee5\u4e0e\u5176\u4ed6pod\u548cservice\u901a\u4fe1\u3002</li> <li>2\u3001ovs-multitenant\uff1a\u8be5\u4e3apod\u548c\u670d\u52a1\u63d0\u4f9b\u4e86\u989d\u5916\u7684\u9694\u79bb\u5c42\u3002\u5f53\u4f7f\u7528\u6b64\u63d2\u4ef6\u65f6\uff0c\u6bcf\u4e2aproject\u63a5\u6536\u4e00\u4e2a\u60df\u4e00\u7684\u865a\u62df\u7f51\u7edcID (VNID)\uff0c\u8be5ID\u6807\u8bc6\u6765\u81ea\u5c5e\u4e8e\u8be5project\u7684pod\u7684\u6d41\u91cf\u3002\u901a\u8fc7\u4f7f\u7528VNID\uff0c\u6765\u81ea\u4e0d\u540cproject\u7684pod\u4e0d\u80fd\u4e0e\u5176\u4ed6project\u7684pod\u548cservice\u901a\u4fe1\u3002</li> <li>3\u3001ovs-network policy\uff1a\u6b64\u63d2\u4ef6\u5141\u8bb8\u7ba1\u7406\u5458\u4f7f\u7528NetworkPolicy\u5bf9\u8c61\u5b9a\u4e49\u81ea\u5df1\u7684\u9694\u79bb\u7b56\u7565\u3002</li> </ul> <p>cluster network\u7531OpenShift SDN\u5efa\u7acb\u548c\u7ef4\u62a4\uff0c\u5b83\u4f7f\u7528Open vSwitch\u521b\u5efaoverlay\u7f51\u7edc\uff0cmaster\u8282\u70b9\u4e0d\u80fd\u901a\u8fc7\u96c6\u7fa4\u7f51\u7edc\u8bbf\u95ee\u5bb9\u5668\uff0c\u9664\u975emaster\u540c\u65f6\u4e5f\u4e3anode\u8282\u70b9\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#7-5-openshift","title":"7-5 \u7b80\u8ff0OpenShift\u89d2\u8272\u53ca\u5176\u4f5c\u7528\uff1f","text":"<p>OpenShift\u7684\u89d2\u8272\u5177\u6709\u4e0d\u540c\u7ea7\u522b\u7684\u8bbf\u95ee\u548c\u7b56\u7565\uff0c\u5305\u62ec\u96c6\u7fa4\u548c\u672c\u5730\u7b56\u7565\u3002user\u548cgroup\u53ef\u4ee5\u540c\u65f6\u4e0e\u591a\u4e2arole\u5173\u8054\u3002</p>"},{"location":"chap4/5k8s_OpenShift/#7-6-openshift","title":"7-6 \u7b80\u8ff0OpenShift\u652f\u6301\u54ea\u4e9b\u8eab\u4efd\u9a8c\u8bc1\uff1f","text":"<p>OpenShift\u5bb9\u5668\u5e73\u53f0\u652f\u6301\u7684\u5176\u4ed6\u8ba4\u8bc1\u7c7b\u578b\u5305\u62ec:</p> <ul> <li>Basic Authentication (Remote)\uff1a\u4e00\u79cd\u901a\u7528\u7684\u540e\u7aef\u96c6\u6210\u673a\u5236\uff0c\u5141\u8bb8\u7528\u6237\u4f7f\u7528\u9488\u5bf9\u8fdc\u7a0b\u6807\u8bc6\u63d0\u4f9b\u8005\u9a8c\u8bc1\u7684\u51ed\u636e\u767b\u5f55\u5230OpenShift\u5bb9\u5668\u5e73\u53f0\u3002\u7528\u6237\u5c06\u4ed6\u4eec\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u53d1\u9001\u5230OpenShift\u5bb9\u5668\u5e73\u53f0\uff0cOpenShift\u5e73\u53f0\u901a\u8fc7\u5230\u670d\u52a1\u5668\u7684\u8bf7\u6c42\u9a8c\u8bc1\u8fd9\u4e9b\u51ed\u636e\uff0c\u5e76\u5c06\u51ed\u636e\u4f5c\u4e3a\u57fa\u672c\u7684Auth\u5934\u4f20\u9012\u3002\u8fd9\u8981\u6c42\u7528\u6237\u5728\u767b\u5f55\u8fc7\u7a0b\u4e2d\u5411OpenShift\u5bb9\u5668\u5e73\u53f0\u8f93\u5165\u4ed6\u4eec\u7684\u51ed\u636e\u3002</li> <li>Request Header Authentication\uff1a\u7528\u6237\u4f7f\u7528\u8bf7\u6c42\u5934\u503c(\u5982X-RemoteUser)\u767b\u5f55\u5230OpenShift\u5bb9\u5668\u5e73\u53f0\u3002\u5b83\u901a\u5e38\u4e0e\u8eab\u4efd\u9a8c\u8bc1\u4ee3\u7406\u7ed3\u5408\u4f7f\u7528\uff0c\u8eab\u4efd\u9a8c\u8bc1\u4ee3\u7406\u5bf9\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u7136\u540e\u901a\u8fc7\u8bf7\u6c42\u5934\u503c\u4e3aOpenShift\u5bb9\u5668\u5e73\u53f0\u63d0\u4f9b\u7528\u6237\u6807\u8bc6\u3002</li> <li>Keystone Authentication\uff1aKeystone\u662f\u4e00\u4e2aOpenStack\u9879\u76ee\uff0c\u63d0\u4f9b\u6807\u8bc6\u3001\u4ee4\u724c\u3001\u76ee\u5f55\u548c\u7b56\u7565\u670d\u52a1\u3002OpenShift\u5bb9\u5668\u5e73\u53f0\u4e0eKeystone\u96c6\u6210\uff0c\u901a\u8fc7\u914d\u7f6eOpenStack Keystone v3\u670d\u52a1\u5668\u5c06\u7528\u6237\u5b58\u50a8\u5728\u5185\u90e8\u6570\u636e\u5e93\u4e2d\uff0c\u4ece\u800c\u652f\u6301\u5171\u4eab\u8eab\u4efd\u9a8c\u8bc1\u3002\u8fd9\u79cd\u914d\u7f6e\u5141\u8bb8\u7528\u6237\u4f7f\u7528Keystone\u51ed\u8bc1\u767b\u5f55OpenShift\u5bb9\u5668\u5e73\u53f0\u3002</li> <li>LDAP Authentication\uff1a\u7528\u6237\u4f7f\u7528\u4ed6\u4eec\u7684LDAP\u51ed\u8bc1\u767b\u5f55\u5230OpenShift\u5bb9\u5668\u5e73\u53f0\u3002\u5728\u8eab\u4efd\u9a8c\u8bc1\u671f\u95f4\uff0cLDAP\u76ee\u5f55\u5c06\u641c\u7d22\u4e0e\u63d0\u4f9b\u7684\u7528\u6237\u540d\u5339\u914d\u7684\u6761\u76ee\u3002\u5982\u679c\u627e\u5230\u5339\u914d\u9879\uff0c\u5219\u5c1d\u8bd5\u4f7f\u7528\u6761\u76ee\u7684\u4e13\u6709\u540d\u79f0(DN)\u548c\u63d0\u4f9b\u7684\u5bc6\u7801\u8fdb\u884c\u7b80\u5355\u7ed1\u5b9a\u3002</li> <li>GitHub Authentication\uff1aGitHub\u4f7f\u7528OAuth\uff0c\u5b83\u5141\u8bb8\u4e0eOpenShift\u5bb9\u5668\u5e73\u53f0\u96c6\u6210\u4f7f\u7528OAuth\u8eab\u4efd\u9a8c\u8bc1\u6765\u4fc3\u8fdb\u4ee4\u724c\u4ea4\u6362\u6d41\u3002\u8fd9\u5141\u8bb8\u7528\u6237\u4f7f\u7528\u4ed6\u4eec\u7684GitHub\u51ed\u8bc1\u767b\u5f55\u5230OpenShift\u5bb9\u5668\u5e73\u53f0\u3002\u4e3a\u4e86\u9632\u6b62\u4f7f\u7528GitHub\u7528\u6237id\u7684\u672a\u6388\u6743\u7528\u6237\u767b\u5f55\u5230OpenShift\u5bb9\u5668\u5e73\u53f0\u96c6\u7fa4\uff0c\u53ef\u4ee5\u5c06\u8bbf\u95ee\u6743\u9650\u9650\u5236\u5728\u7279\u5b9a\u7684GitHub\u7ec4\u7ec7\u4e2d\u3002</li> </ul>"},{"location":"chap4/5k8s_OpenShift/#8","title":"8\u3001\u7b80\u8ff0\u4ec0\u4e48\u662f\u4e2d\u95f4\u4ef6\uff1f","text":"<p>\u4e2d\u95f4\u4ef6\u662f\u4e00\u79cd\u72ec\u7acb\u7684\u7cfb\u7edf\u8f6f\u4ef6\u6216\u670d\u52a1\u7a0b\u5e8f\uff0c\u5206\u5e03\u5f0f\u5e94\u7528\u8f6f\u4ef6\u501f\u52a9\u8fd9\u79cd\u8f6f\u4ef6\u5728\u4e0d\u540c\u7684\u6280\u672f\u4e4b\u95f4\u5171\u4eab\u8d44\u6e90\u3002\u901a\u5e38\u4f4d\u4e8e\u5ba2\u6237\u673a/\u670d\u52a1\u5668\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u95f4\uff0c\u662f\u8fde\u63a5\u4e24\u4e2a\u72ec\u7acb\u5e94\u7528\u7a0b\u5e8f\u6216\u72ec\u7acb\u7cfb\u7edf\u7684\u8f6f\u4ef6\u3002</p> <p>\u901a\u8fc7\u4e2d\u95f4\u4ef6\u5b9e\u73b0\u4e24\u4e2a\u4e0d\u540c\u7cfb\u7edf\u4e4b\u95f4\u7684\u4fe1\u606f\u4ea4\u6362\u3002</p>"},{"location":"chap4/6Py_interview/","title":"\u7b2c\u516d\u8282 Python\u9762\u8bd5","text":""},{"location":"chap4/6Py_interview/#1","title":"1. \u662f\u4ec0\u4e48","text":""},{"location":"chap4/6Py_interview/#1-1-picklingunpickling","title":"1-1 \u4ec0\u4e48\u662fpickling\u548cunpickling\uff1f","text":"<p>Pickle\u6a21\u5757\u8bfb\u5165\u4efb\u4f55Python\u5bf9\u8c61\uff0c\u5c06\u5b83\u4eec\u8f6c\u6362\u6210\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u4f7f\u7528dump\u51fd\u6570\u5c06\u5176\u8f6c\u50a8\u5230\u4e00\u4e2a\u6587\u4ef6\u4e2d\u2014\u2014\u8fd9\u4e2a\u8fc7\u7a0b\u53eb\u505apickling\u3002\u53cd\u4e4b\u4ece\u5b58\u50a8\u7684\u5b57\u7b26\u4e32\u6587\u4ef6\u4e2d\u63d0\u53d6\u539f\u59cbPython\u5bf9\u8c61\u7684\u8fc7\u7a0b\uff0c\u53eb\u505aunpickling\u3002</p>"},{"location":"chap4/6Py_interview/#1-2-python","title":"1-2 \u4ec0\u4e48\u662fPython\u88c5\u9970\u5668\uff1f","text":"<p>Python\u88c5\u9970\u5668\u662fPython\u4e2d\u7684\u7279\u6709\u53d8\u52a8\uff0c\u53ef\u4ee5\u4f7f\u4fee\u6539\u51fd\u6570\u53d8\u5f97\u66f4\u5bb9\u6613\u3002</p>"},{"location":"chap4/6Py_interview/#1-3-lambda","title":"1-3 Lambda\u51fd\u6570\u662f\u4ec0\u4e48\uff1f","text":"<p>\u8fd9\u662f\u4e00\u4e2a\u5e38\u88ab\u7528\u4e8e\u4ee3\u7801\u4e2d\u7684\u5355\u4e2a\u8868\u8fbe\u5f0f\u7684\u533f\u540d\u51fd\u6570\u3002</p>"},{"location":"chap4/6Py_interview/#1-4-argskwargs","title":"1-4  <code>*args</code>\uff0c<code>**kwargs</code>\uff1f\u53c2\u6570\u662f\u4ec0\u4e48\uff1f","text":"<p>\u5982\u679c\u6211\u4eec\u4e0d\u786e\u5b9a\u8981\u5f80\u51fd\u6570\u4e2d\u4f20\u5165\u591a\u5c11\u4e2a\u53c2\u6570\uff0c\u6216\u8005\u6211\u4eec\u60f3\u5f80\u51fd\u6570\u4e2d\u4ee5\u5217\u8868\u548c\u5143\u7ec4\u7684\u5f62\u5f0f\u4f20\u53c2\u6570\u65f6\uff0c\u90a3\u5c31\u4f7f\u8981\u7528<code>*args</code>\uff1b\u5982\u679c\u6211\u4eec\u4e0d\u77e5\u9053\u8981\u5f80\u51fd\u6570\u4e2d\u4f20\u5165\u591a\u5c11\u4e2a\u5173\u952e\u8bcd\u53c2\u6570\uff0c\u6216\u8005\u60f3\u4f20\u5165\u5b57\u5178\u7684\u503c\u4f5c\u4e3a\u5173\u952e\u8bcd\u53c2\u6570\u65f6\uff0c\u90a3\u5c31\u8981\u4f7f\u7528<code>**kwargs</code>\u3002</p>"},{"location":"chap4/6Py_interview/#1-5-unittest","title":"1-5 unittest\u662f\u4ec0\u4e48\uff1f","text":"<p>\u5728Python\u4e2d\uff0cunittest\u662fPython\u4e2d\u7684\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\u3002\u5b83\u62e5\u6709\u652f\u6301\u5171\u4eab\u642d\u5efa\u3001\u81ea\u52a8\u6d4b\u8bd5\u3001\u5728\u6d4b\u8bd5\u4e2d\u6682\u505c\u4ee3\u7801\u3001\u5c06\u4e0d\u540c\u6d4b\u8bd5\u8fed\u4ee3\u6210\u4e00\u7ec4\uff0c\u7b49\u7b49\u7684\u529f\u80fd\u3002</p>"},{"location":"chap4/6Py_interview/#1-6","title":"1-6 \u6784\u9020\u5668\u662f\u4ec0\u4e48\uff1f","text":"<p>\u6784\u9020\u5668\u662f\u5b9e\u73b0\u8fed\u4ee3\u5668\u7684\u4e00\u79cd\u673a\u5236\u3002\u5b83\u529f\u80fd\u7684\u5b9e\u73b0\u4f9d\u8d56\u4e8eyield\u8868\u8fbe\u5f0f\uff0c\u9664\u6b64\u4e4b\u5916\u5b83\u8ddf\u666e\u901a\u7684\u51fd\u6570\u6ca1\u6709\u4e24\u6837\u3002</p>"},{"location":"chap4/6Py_interview/#1-7-doc-string","title":"1-7 doc string\u662f\u4ec0\u4e48\uff1f","text":"<p>Python\u4e2d\u6587\u6863\u5b57\u7b26\u4e32\u88ab\u79f0\u4e3adocstring\uff0c\u5b83\u5728Python\u4e2d\u7684\u4f5c\u7528\u662f\u4e3a\u51fd\u6570\u3001\u6a21\u5757\u548c\u7c7b\u6ce8\u91ca\u751f\u6210\u6587\u6863\u3002</p>"},{"location":"chap4/6Py_interview/#1-8","title":"1-8 \u8d1f\u7d22\u5f15\u662f\u4ec0\u4e48\uff1f","text":"<p>Python\u4e2d\u7684\u5e8f\u5217\u7d22\u5f15\u53ef\u4ee5\u662f\u6b63\u4e5f\u53ef\u4ee5\u662f\u8d1f\u3002\u5982\u679c\u662f\u6b63\u7d22\u5f15\uff0c0\u662f\u5e8f\u5217\u4e2d\u7684\u7b2c\u4e00\u4e2a\u7d22\u5f15\uff0c1\u662f\u7b2c\u4e8c\u4e2a\u7d22\u5f15\u3002\u5982\u679c\u662f\u8d1f\u7d22\u5f15\uff0c<code>\uff08-1\uff09</code>\u662f\u6700\u540e\u4e00\u4e2a\u7d22\u5f15\u800c<code>\uff08-2\uff09</code>\u662f\u5012\u6570\u7b2c\u4e8c\u4e2a\u7d22\u5f15\u3002</p>"},{"location":"chap4/6Py_interview/#1-9","title":"1-9 \u6a21\u5757\u548c\u5305\u662f\u4ec0\u4e48\uff1f","text":"<p>\u5728Python\u4e2d\uff0c\u6a21\u5757\u662f\u642d\u5efa\u7a0b\u5e8f\u7684\u4e00\u79cd\u65b9\u5f0f\u3002\u6bcf\u4e00\u4e2aPython\u4ee3\u7801\u6587\u4ef6\u90fd\u662f\u4e00\u4e2a\u6a21\u5757\uff0c\u5e76\u53ef\u4ee5\u5f15\u7528\u5176\u4ed6\u7684\u6a21\u5757\uff0c\u6bd4\u5982\u5bf9\u8c61\u548c\u5c5e\u6027\u3002</p> <p>\u4e00\u4e2a\u5305\u542b\u8bb8\u591aPython\u4ee3\u7801\u7684\u6587\u4ef6\u5939\u662f\u4e00\u4e2a\u5305\u3002\u4e00\u4e2a\u5305\u53ef\u4ee5\u5305\u542b\u6a21\u5757\u548c\u5b50\u6587\u4ef6\u5939\u3002</p>"},{"location":"chap4/6Py_interview/#1-10","title":"1-10 \u5783\u573e\u56de\u6536\u662f\u4ec0\u4e48\uff1f","text":"<p>\u5728Python\u4e2d\uff0c\u4e3a\u4e86\u89e3\u51b3\u5185\u5b58\u6cc4\u9732\u95ee\u9898\uff0c\u91c7\u7528\u4e86\u5bf9\u8c61\u5f15\u7528\u8ba1\u6570\uff0c\u5e76\u57fa\u4e8e\u5f15\u7528\u8ba1\u6570\u5b9e\u73b0\u81ea\u52a8\u5783\u573e\u56de\u6536\u3002</p>"},{"location":"chap4/6Py_interview/#1-11-csrf","title":"1-11 CSRF\u662f\u4ec0\u4e48\uff1f","text":"<p>CSRF\u662f\u4f2a\u9020\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u4e00\u79cd\u653b\u51fb\uff0cCSRF\u7684\u82f1\u6587\u5168\u79f0\u662fCross Site Request Forgery\uff0c\u5b57\u9762\u4e0a\u7684\u610f\u601d\u662f\u8de8\u7ad9\u70b9\u4f2a\u9020\u8bf7\u6c42\u3002</p>"},{"location":"chap4/6Py_interview/#2how","title":"2\u3001HOW","text":""},{"location":"chap4/6Py_interview/#2-1-python","title":"2-1 \u5982\u4f55\u5728Python\u4e2d\u62f7\u8d1d\u4e00\u4e2a\u5bf9\u8c61\uff1f","text":"<p>\u5982\u679c\u8981\u5728Python\u4e2d\u62f7\u8d1d\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5927\u591a\u65f6\u5019\u4f60\u53ef\u4ee5\u7528<code>copy.copy()</code>\u6216\u8005<code>copy.deepcopy()</code>\u3002\u4f46\u5e76\u4e0d\u662f\u6240\u6709\u7684\u5bf9\u8c61\u90fd\u53ef\u4ee5\u88ab\u62f7\u8d1d\u3002</p>"},{"location":"chap4/6Py_interview/#2-2-python","title":"2-2 \u5982\u4f55\u7528Python\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\uff1f","text":"<p>\u4f7f\u7528\u51fd\u6570<code>os.remove(\"file\")</code></p>"},{"location":"chap4/6Py_interview/#2-3","title":"2-3 \u5982\u4f55\u5c06\u4e00\u4e2a\u6570\u5b57\u8f6c\u6362\u6210\u4e00\u4e2a\u5b57\u7b26\u4e32\uff1f","text":"<p>\u4f60\u53ef\u4ee5\u4f7f\u7528\u81ea\u5e26\u51fd\u6570<code>str()</code>\u5c06\u4e00\u4e2a\u6570\u5b57\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u8981\u516b\u8fdb\u5236\u6216\u8005\u5341\u516d\u8fdb\u5236\u6570\uff0c\u53ef\u4ee5\u7528<code>oct()</code>\u6216<code>hex()</code>\u3002</p>"},{"location":"chap4/6Py_interview/#2-4-python","title":"2-4 Python\u662f\u5982\u4f55\u8fdb\u884c\u5185\u5b58\u7ba1\u7406\u7684\uff1f","text":"<p>Python\u7684\u5185\u5b58\u7ba1\u7406\u662f\u7531\u79c1\u6709heap\u7a7a\u95f4\u7ba1\u7406\u7684\u3002\u6240\u6709\u7684Python\u5bf9\u8c61\u548c\u6570\u636e\u7ed3\u6784\u90fd\u5728\u4e00\u4e2a\u79c1\u6709heap\u4e2d\u3002\u7a0b\u5e8f\u5458\u6ca1\u6709\u8bbf\u95ee\u8be5heap\u7684\u6743\u9650\uff0c\u53ea\u6709\u89e3\u91ca\u5668\u624d\u80fd\u5bf9\u5b83\u8fdb\u884c\u64cd\u4f5c\u3002</p> <p>\u4e3aPython\u7684heap\u7a7a\u95f4\u5206\u914d\u5185\u5b58\u662f\u7531Python\u7684\u5185\u5b58\u7ba1\u7406\u6a21\u5757\u8fdb\u884c\u7684\uff0c\u5176\u6838\u5fc3API\u4f1a\u63d0\u4f9b\u4e00\u4e9b\u8bbf\u95ee\u8be5\u6a21\u5757\u7684\u65b9\u6cd5\u4f9b\u7a0b\u5e8f\u5458\u4f7f\u7528\u3002</p> <p>Python\u6709\u81ea\u5e26\u7684\u5783\u573e\u56de\u6536\u7cfb\u7edf\uff0c\u5b83\u56de\u6536\u5e76\u91ca\u653e\u6ca1\u6709\u88ab\u4f7f\u7528\u7684\u5185\u5b58\uff0c\u8ba9\u5b83\u4eec\u80fd\u591f\u88ab\u5176\u4ed6\u7a0b\u5e8f\u4f7f\u7528\u3002</p>"},{"location":"chap4/6Py_interview/#2-5-tuplelist","title":"2-5 \u5982\u4f55\u5b9e\u73b0tuple\u548clist\u7684\u8f6c\u6362\uff1f","text":"<ul> <li>\u4ee5list\u4f5c\u4e3a\u53c2\u6570\u5c06tuple\u7c7b\u521d\u59cb\u5316\uff0c\u5c06\u8fd4\u56detuple\u7c7b\u578b</li> <li>\u4ee5tuple\u4f5c\u4e3a\u53c2\u6570\u5c06list\u7c7b\u521d\u59cb\u5316\uff0c\u5c06\u8fd4\u56delist\u7c7b\u578b</li> </ul>"},{"location":"chap4/6Py_interview/#2-6-python","title":"2-6 Python\u91cc\u9762\u5982\u4f55\u751f\u6210\u968f\u673a\u6570\uff1f","text":"<p>\u5728python\u4e2d\u7528\u4e8e\u751f\u6210\u968f\u673a\u6570\u7684\u6a21\u5757\u662frandom\uff0c\u5728\u4f7f\u7528\u524d\u9700\u8981import. \u5982\u4e0b\u4f8b\u5b50\u53ef\u4ee5\u914c\u60c5\u5217\u4e3e\uff1a</p> <ul> <li><code>random.random()</code>\uff1a\u751f\u6210\u4e00\u4e2a<code>0-1</code>\u4e4b\u95f4\u7684\u968f\u673a\u6d6e\u70b9\u6570</li> <li><code>random.uniform(a, b)</code>\uff1a\u751f\u6210<code>[a,b]</code>\u4e4b\u95f4\u7684\u6d6e\u70b9\u6570</li> <li><code>random.randint(a, b)</code>\uff1a\u751f\u6210<code>[a,b]</code>\u4e4b\u95f4\u7684\u6574\u6570</li> <li><code>random.randrange(a, b, step)</code>\uff1a\u5728\u6307\u5b9a\u7684\u96c6\u5408<code>[a,b)</code>\u4e2d\uff0c\u4ee5step\u4e3a\u57fa\u6570\u968f\u673a\u53d6\u4e00\u4e2a\u6570</li> <li><code>random.choice(sequence)</code>\uff1a\u4ece\u7279\u5b9a\u5e8f\u5217\u4e2d\u968f\u673a\u53d6\u4e00\u4e2a\u5143\u7d20\uff0c\u8fd9\u91cc\u7684\u5e8f\u5217\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\uff0c\u5217\u8868\uff0c\u5143\u7ec4\u7b49</li> </ul>"},{"location":"chap4/6Py_interview/#2-7-function","title":"2-7 \u5982\u4f55\u5728\u4e00\u4e2afunction\u91cc\u9762\u8bbe\u7f6e\u4e00\u4e2a\u5168\u5c40\u7684\u53d8\u91cf","text":"<p>\u5982\u679c\u8981\u7ed9\u5168\u5c40\u53d8\u91cf\u5728\u4e00\u4e2a\u51fd\u6570\u91cc\u8d4b\u503c\uff0c\u5fc5\u987b\u4f7f\u7528global\u8bed\u53e5\u3002</p> <p><code>global VarName</code>\u7684\u8868\u8fbe\u5f0f\u4f1a\u544a\u8bc9Python\uff0c VarName\u662f\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\uff0c\u8fd9\u6837Python\u5c31\u4e0d\u4f1a\u5728\u5c40\u90e8\u547d\u540d\u7a7a\u95f4\u91cc\u5bfb\u627e\u8fd9\u4e2a\u53d8\u91cf\u4e86</p>"},{"location":"chap4/6Py_interview/#2-8-python23python","title":"2-8 Python\u5982\u4f55\u5b9e\u73b0\u5355\u4f8b\u6a21\u5f0f\uff1f\u5176\u4ed623\u79cd\u8bbe\u8ba1\u6a21\u5f0fpython\u5982\u4f55\u5b9e\u73b0\uff1f","text":"<p>\u5355\u4f8b\u6a21\u5f0f\u4e3b\u8981\u6709\u56db\u79cd\u65b9\u6cd5\uff1a<code>__new__</code>\u3001\u5171\u4eab\u5c5e\u6027\u3001\u88c5\u9970\u5668\u3001import\u3002</p> <p>\u5176\u4ed623\u79cd\u8bbe\u8ba1\u6a21\u5f0f\u53ef\u57fa\u672c\u5206\u4e3a\u521b\u5efa\u578b\u3001\u7ed3\u6784\u578b\u548c\u884c\u4e3a\u578b\u6a21\u5f0f\u3002</p> <p>\u521b\u5efa\u6a21\u5f0f\uff0c\u63d0\u4f9b\u5b9e\u4f8b\u5316\u7684\u65b9\u6cd5\uff0c\u4e3a\u9002\u5408\u7684\u72b6\u51b5\u63d0\u4f9b\u76f8\u5e94\u7684\u5bf9\u8c61\u521b\u5efa\u65b9\u6cd5\u3002</p> <p>\u7ed3\u6784\u5316\u6a21\u5f0f\uff0c\u901a\u5e38\u7528\u6765\u5904\u7406\u5b9e\u4f53\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u4f7f\u5f97\u8fd9\u4e9b\u5b9e\u4f53\u80fd\u591f\u66f4\u597d\u5730\u534f\u540c\u5de5\u4f5c\u3002</p> <p>\u884c\u4e3a\u6a21\u5f0f\uff0c\u7528\u4e8e\u5728\u4e0d\u540c\u7684\u5b9e\u4f53\u5efa\u8fdb\u884c\u901a\u4fe1\uff0c\u4e3a\u5b9e\u4f53\u4e4b\u95f4\u7684\u901a\u4fe1\u63d0\u4f9b\u66f4\u5bb9\u6613\uff0c\u66f4\u7075\u6d3b\u7684\u901a\u4fe1\u65b9\u6cd5\u3002</p> <p>\u5404\u6a21\u5f0f\u7684\u5b9e\u73b0\u53ef\u6839\u636e\u5176\u7279\u70b9\u7f16\u5199\u4ee3\u7801\uff08\u9650\u4e8e\u7bc7\u5e45\uff0c\u6b64\u5904\u4e0d\u505a\u793a\u4f8b\uff09</p>"},{"location":"chap4/6Py_interview/#2-9","title":"2-9 \u5982\u4f55\u5224\u65ad\u5355\u5411\u94fe\u8868\u4e2d\u662f\u5426\u6709\u73af","text":"<p>\u9996\u5148\u904d\u5386\u94fe\u8868\uff0c\u5bfb\u627e\u662f\u5426\u6709\u76f8\u540c\u5730\u5740\uff0c\u501f\u6b64\u5224\u65ad\u94fe\u8868\u4e2d\u662f\u5426\u6709\u73af\u3002\u5982\u679c\u7a0b\u5e8f\u8fdb\u5165\u6b7b\u5faa\u73af\uff0c\u5219\u9700\u8981\u4e00\u5757\u7a7a\u95f4\u6765\u5b58\u50a8\u6307\u9488\uff0c\u904d\u5386\u65b0\u6307\u9488\u65f6\u5c06\u5176\u548c\u50a8\u5b58\u7684\u65e7\u6307\u9488\u6bd4\u5bf9\uff0c\u82e5\u6709\u76f8\u540c\u6307\u9488\uff0c\u5219\u8be5\u94fe\u8868\u6709\u73af\uff0c\u5426\u5219\u5c06\u8fd9\u4e2a\u65b0\u6307\u9488\u5b58\u4e0b\u6765\u540e\u7ee7\u7eed\u5f80\u4e0b\u8bfb\u53d6\uff0c\u76f4\u5230\u9047\u89c1NULL\uff0c\u8fd9\u8bf4\u660e\u8fd9\u4e2a\u94fe\u8868\u65e0\u73af\u3002</p>"},{"location":"chap4/6Py_interview/#2-10","title":"2-10 \u5982\u4f55\u904d\u5386\u4e00\u4e2a\u5185\u90e8\u672a\u77e5\u7684\u6587\u4ef6\u5939\uff1f","text":"<p>\u5e38\u7528\u7684\u6709\u4ee5\u4e0b\u8fd9\u51e0\u79cd\u529e\u6cd5\uff1a<code>os.path.walk()</code>\uff0c<code>os.walk(</code>)\uff0c<code>listdir</code></p>"},{"location":"chap4/6Py_interview/#2-11-mysql","title":"2-11 mysql\u6570\u636e\u5e93\u5982\u4f55\u5206\u533a\u3001\u5206\u8868\uff1f","text":"<p>\u5206\u8868\u53ef\u4ee5\u901a\u8fc7\u4e09\u79cd\u65b9\u5f0f\uff1amysql\u96c6\u7fa4\u3001\u81ea\u5b9a\u4e49\u89c4\u5219\u548cmerge\u5b58\u50a8\u5f15\u64ce\u3002</p> <p>\u5206\u533a\u6709\u56db\u7c7b\uff1a</p> <ul> <li>RANGE \u5206\u533a\uff1a\u57fa\u4e8e\u5c5e\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u8fde\u7eed\u533a\u95f4\u7684\u5217\u503c\uff0c\u628a\u591a\u884c\u5206\u914d\u7ed9\u5206\u533a\u3002</li> <li>LIST \u5206\u533a\uff1a\u7c7b\u4f3c\u4e8e\u6309RANGE\u5206\u533a\uff0c\u533a\u522b\u5728\u4e8eLIST\u5206\u533a\u662f\u57fa\u4e8e\u5217\u503c\u5339\u914d\u4e00\u4e2a\u79bb\u6563\u503c\u96c6\u5408\u4e2d\u7684\u67d0\u4e2a\u503c\u6765\u8fdb\u884c\u9009\u62e9\u3002</li> <li>HASH\u5206\u533a\uff1a\u57fa\u4e8e\u7528\u6237\u5b9a\u4e49\u7684\u8868\u8fbe\u5f0f\u7684\u8fd4\u56de\u503c\u6765\u8fdb\u884c\u9009\u62e9\u7684\u5206\u533a\uff0c\u8be5\u8868\u8fbe\u5f0f\u4f7f\u7528\u5c06\u8981\u63d2\u5165\u5230\u8868\u4e2d\u7684\u8fd9\u4e9b\u884c\u7684\u5217\u503c\u8fdb\u884c\u8ba1\u7b97\u3002\u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u5305\u542bMySQL \u4e2d\u6709\u6548\u7684\u3001\u4ea7\u751f\u975e\u8d1f\u6574\u6570\u503c\u7684\u4efb\u4f55\u8868\u8fbe\u5f0f\u3002</li> <li>KEY \u5206\u533a\uff1a\u7c7b\u4f3c\u4e8e\u6309HASH\u5206\u533a\uff0c\u533a\u522b\u5728\u4e8eKEY\u5206\u533a\u53ea\u652f\u6301\u8ba1\u7b97\u4e00\u5217\u6216\u591a\u5217\uff0c\u4e14MySQL \u670d\u52a1\u5668\u63d0\u4f9b\u5176\u81ea\u8eab\u7684\u54c8\u5e0c\u51fd\u6570\u3002\u5fc5\u987b\u6709\u4e00\u5217\u6216\u591a\u5217\u5305\u542b\u6574\u6570\u503c\u3002</li> </ul>"},{"location":"chap4/6Py_interview/#2-12","title":"2-12 \u5982\u4f55\u5bf9\u67e5\u8be2\u547d\u4ee4\u8fdb\u884c\u4f18\u5316\uff1f","text":"<ul> <li>a. \u5e94\u5c3d\u91cf\u907f\u514d\u5168\u8868\u626b\u63cf\uff0c\u9996\u5148\u5e94\u8003\u8651\u5728 where \u53ca order by \u6d89\u53ca\u7684\u5217\u4e0a\u5efa\u7acb\u7d22\u3002</li> <li>b. \u5e94\u5c3d\u91cf\u907f\u514d\u5728 where \u5b50\u53e5\u4e2d\u5bf9\u5b57\u6bb5\u8fdb\u884c null \u503c\u5224\u65ad\uff0c\u907f\u514d\u4f7f\u7528<code>!=</code>\u6216<code>&lt;&gt;</code>\u64cd\u4f5c\u7b26\uff0c\u907f\u514d\u4f7f\u7528 or \u8fde\u63a5\u6761\u4ef6\uff0c\u6216\u5728where\u5b50\u53e5\u4e2d\u4f7f\u7528\u53c2\u6570\u3001\u5bf9\u5b57\u6bb5\u8fdb\u884c\u8868\u8fbe\u5f0f\u6216\u51fd\u6570\u64cd\u4f5c\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u6743\u6807\u626b\u63cf</li> <li>c. \u4e0d\u8981\u5728 where \u5b50\u53e5\u4e2d\u7684\u201c=\u201d\u5de6\u8fb9\u8fdb\u884c\u51fd\u6570\u3001\u7b97\u672f\u8fd0\u7b97\u6216\u5176\u4ed6\u8868\u8fbe\u5f0f\u8fd0\u7b97\uff0c\u5426\u5219\u7cfb\u7edf\u5c06\u53ef\u80fd\u65e0\u6cd5\u6b63\u786e\u4f7f\u7528\u7d22\u5f15\u3002</li> <li>d. \u4f7f\u7528\u7d22\u5f15\u5b57\u6bb5\u4f5c\u4e3a\u6761\u4ef6\u65f6\uff0c\u5982\u679c\u8be5\u7d22\u5f15\u662f\u590d\u5408\u7d22\u5f15\uff0c\u90a3\u4e48\u5fc5\u987b\u4f7f\u7528\u5230\u8be5\u7d22\u5f15\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u4f5c\u4e3a\u6761\u4ef6\u65f6\u624d\u80fd\u4fdd\u8bc1\u7cfb\u7edf\u4f7f\u7528\u8be5\u7d22\u5f15\uff0c\u5426\u5219\u8be5\u7d22\u5f15\u5c06\u4e0d\u4f1a\u88ab\u4f7f\u7528\u3002</li> <li>e. \u5f88\u591a\u65f6\u5019\u53ef\u8003\u8651\u7528 exists \u4ee3\u66ff in</li> <li>f. \u5c3d\u91cf\u4f7f\u7528\u6570\u5b57\u578b\u5b57\u6bb5</li> <li>g. \u5c3d\u53ef\u80fd\u7684\u4f7f\u7528 <code>varchar/nvarchar</code> \u4ee3\u66ff <code>char/nchar</code></li> <li>h. \u4efb\u4f55\u5730\u65b9\u90fd\u4e0d\u8981\u4f7f\u7528 <code>select * from t</code> \uff0c\u7528\u5177\u4f53\u7684\u5b57\u6bb5\u5217\u8868\u4ee3\u66ff<code>\u201c*\u201d</code>\uff0c\u4e0d\u8981\u8fd4\u56de\u7528\u4e0d\u5230\u7684\u4efb\u4f55\u5b57\u6bb5\u3002</li> <li>i. \u5c3d\u91cf\u4f7f\u7528\u8868\u53d8\u91cf\u6765\u4ee3\u66ff\u4e34\u65f6\u8868\u3002</li> <li>j. \u907f\u514d\u9891\u7e41\u521b\u5efa\u548c\u5220\u9664\u4e34\u65f6\u8868\uff0c\u4ee5\u51cf\u5c11\u7cfb\u7edf\u8868\u8d44\u6e90\u7684\u6d88\u8017\u3002</li> <li>k. \u5c3d\u91cf\u907f\u514d\u4f7f\u7528\u6e38\u6807\uff0c\u56e0\u4e3a\u6e38\u6807\u7684\u6548\u7387\u8f83\u5dee\u3002</li> <li>l. \u5728\u6240\u6709\u7684\u5b58\u50a8\u8fc7\u7a0b\u548c\u89e6\u53d1\u5668\u7684\u5f00\u59cb\u5904\u8bbe\u7f6e <code>SET NOCOUNT ON</code>\uff0c\u5728\u7ed3\u675f\u65f6\u8bbe\u7f6e SET NOCOUNT OFF</li> <li>m. \u5c3d\u91cf\u907f\u514d\u5927\u4e8b\u52a1\u64cd\u4f5c\uff0c\u63d0\u9ad8\u7cfb\u7edf\u5e76\u53d1\u80fd\u529b\u3002</li> <li>n. \u5c3d\u91cf\u907f\u514d\u5411\u5ba2\u6237\u7aef\u8fd4\u56de\u5927\u6570\u636e\u91cf\uff0c\u82e5\u6570\u636e\u91cf\u8fc7\u5927\uff0c\u5e94\u8be5\u8003\u8651\u76f8\u5e94\u9700\u6c42\u662f\u5426\u5408\u7406\u3002</li> </ul>"},{"location":"chap4/6Py_interview/#2-13","title":"2-13 \u5982\u4f55\u7406\u89e3\u5f00\u6e90\uff1f","text":"<p>\u5f00\u6e90\uff0c\u5373\u5f00\u653e\u6e90\u4ee3\u7801\u3002\u5f00\u6e90\u8bde\u751f\u4e8e\u8f6f\u4ef6\u884c\u4e1a\uff0c\u5b83\u4e0d\u4ec5\u4ec5\u4ee3\u8868\u8f6f\u4ef6\u6e90\u4ee3\u7801\u7684\u5f00\u653e\uff0c\u672c\u8eab\u5373\u610f\u5473\u7740\u81ea\u7531\u3001\u5171\u4eab\u548c\u5145\u5206\u5229\u7528\u8d44\u6e90\u3002\u5f00\u6e90\u662f\u4e00\u79cd\u7cbe\u795e\uff0c\u662f\u4e00\u79cd\u6587\u5316\uff0c\u5982\u4eca\u5df2\u7ecf\u6210\u4e3a\u8f6f\u4ef6\u4e1a\u53d1\u5c55\u7684\u5927\u52bf\u6240\u8d8b\u3002</p>"},{"location":"chap4/6Py_interview/#2-14-mvcmtv","title":"2-14 \u5982\u4f55\u7406\u89e3MVC/MTV\u6846\u67b6\uff1f","text":"<p>MVC\u5c31\u662f\u628aWeb\u5e94\u7528\u5206\u4e3a\u6a21\u578b\uff08M\uff09\uff0c\u63a7\u5236\u5668\uff08C\uff09\u548c\u89c6\u56fe\uff08V\uff09\u4e09\u5c42\uff0c\u4ed6\u4eec\u4e4b\u95f4\u4ee5\u4e00\u79cd\u63d2\u4ef6\u5f0f\u7684\u3001\u677e\u8026\u5408\u7684\u65b9\u5f0f\u8fde\u63a5\u5728\u4e00\u8d77\u3002MTV\u6a21\u5f0f\u672c\u8d28\u4e0a\u548cMVC\u662f\u4e00\u6837\u7684\uff0c\u4e5f\u662f\u4e3a\u4e86\u5404\u7ec4\u4ef6\u95f4\u4fdd\u6301\u677e\u8026\u5408\u5173\u7cfb\uff0c\u53ea\u662f\u5b9a\u4e49\u4e0a\u6709\u4e9b\u8bb8\u4e0d\u540c\u3002</p>"},{"location":"chap4/6Py_interview/#2-15-mssql","title":"2-15 MSSQL\u7684\u6b7b\u9501\u662f\u5982\u4f55\u4ea7\u751f\u7684\uff1f","text":"<p>\u5982\u4e0b\u662f\u6b7b\u9501\u4ea7\u751f\u7684\u56db\u4e2a\u5fc5\u8981\u6761\u4ef6\uff1a</p> <p>\u4e92\u65a5\u6761\u4ef6\uff1a\u6307\u8fdb\u7a0b\u5bf9\u6240\u5206\u914d\u5230\u7684\u8d44\u6e90\u8fdb\u884c\u6392\u5b83\u6027\u4f7f\u7528\uff0c\u5373\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u67d0\u8d44\u6e90\u53ea\u7531\u4e00\u4e2a\u8fdb\u7a0b\u5360\u7528\u3002\u5982\u679c\u6b64\u65f6\u8fd8\u6709\u5176\u5b83\u8fdb\u7a0b\u8bf7\u6c42\u8d44\u6e90\uff0c\u5219\u8bf7\u6c42\u8005\u53ea\u80fd\u7b49\u5f85\uff0c\u76f4\u81f3\u5360\u6709\u8d44\u6e90\u7684\u8fdb\u7a0b\u7528\u6bd5\u91ca\u653e\u3002</p> <p>\u8bf7\u6c42\u548c\u4fdd\u6301\u6761\u4ef6\uff1a\u6307\u8fdb\u7a0b\u5df2\u7ecf\u4fdd\u6301\u81f3\u5c11\u4e00\u4e2a\u8d44\u6e90\uff0c\u4f46\u53c8\u63d0\u51fa\u4e86\u65b0\u7684\u8d44\u6e90\u8bf7\u6c42\uff0c\u800c\u8be5\u8d44\u6e90\u5df2\u88ab\u5176\u5b83\u8fdb\u7a0b\u5360\u6709\uff0c\u6b64\u65f6\u8bf7\u6c42\u8fdb\u7a0b\u963b\u585e\uff0c\u4f46\u53c8\u5bf9\u81ea\u5df1\u5df2\u83b7\u5f97\u7684\u5176\u5b83\u8d44\u6e90\u4fdd\u6301\u4e0d\u653e\u3002</p> <p>\u4e0d\u5265\u593a\u6761\u4ef6\uff1a\u6307\u8fdb\u7a0b\u5df2\u83b7\u5f97\u7684\u8d44\u6e90\uff0c\u5728\u672a\u4f7f\u7528\u5b8c\u4e4b\u524d\uff0c\u4e0d\u80fd\u88ab\u5265\u593a\uff0c\u53ea\u80fd\u5728\u4f7f\u7528\u5b8c\u65f6\u7531\u81ea\u5df1\u91ca\u653e\u3002</p> <p>\u73af\u8def\u7b49\u5f85\u6761\u4ef6\uff1a\u6307\u5728\u53d1\u751f\u6b7b\u9501\u65f6\uff0c\u5fc5\u7136\u5b58\u5728\u4e00\u4e2a\u8fdb\u7a0b\u2014\u2014\u8d44\u6e90\u7684\u73af\u5f62\u94fe\uff0c\u5373\u8fdb\u7a0b\u96c6\u5408{P0\uff0cP1\uff0cP2\uff0c\u00b7\u00b7\u00b7\uff0cPn}\u4e2d\u7684P0\u6b63\u5728\u7b49\u5f85\u4e00\u4e2aP1\u5360\u7528\u7684\u8d44\u6e90\uff1bP1\u6b63\u5728\u7b49\u5f85P2\u5360\u7528\u7684\u8d44\u6e90\uff0c\u2026\u2026\uff0cPn\u6b63\u5728\u7b49\u5f85\u5df2\u88abP0\u5360\u7528\u7684\u8d44\u6e90\u3002</p>"},{"location":"chap4/6Py_interview/#2-16-sql","title":"2-16 Sql\u6ce8\u5165\u662f\u5982\u4f55\u4ea7\u751f\u7684\uff0c\u5982\u4f55\u9632\u6b62\uff1f","text":"<p>\u7a0b\u5e8f\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u4e0d\u6ce8\u610f\u89c4\u8303\u4e66\u5199sql\u8bed\u53e5\u548c\u5bf9\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7\u5168\u5c40\u53d8\u91cfPOST\u548cGET\u63d0\u4ea4\u4e00\u4e9bsql\u8bed\u53e5\u6b63\u5e38\u6267\u884c\u3002\u4ea7\u751fSql\u6ce8\u5165\u3002\u4e0b\u9762\u662f\u9632\u6b62\u529e\u6cd5\uff1a</p> <ul> <li>a. \u8fc7\u6ee4\u6389\u4e00\u4e9b\u5e38\u89c1\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u5173\u952e\u5b57\uff0c\u6216\u8005\u901a\u8fc7\u7cfb\u7edf\u51fd\u6570\u6765\u8fdb\u884c\u8fc7\u6ee4\u3002</li> <li>b. \u5728PHP\u914d\u7f6e\u6587\u4ef6\u4e2d\u5c06<code>Register_globals=off;</code>\u8bbe\u7f6e\u4e3a\u5173\u95ed\u72b6\u6001</li> <li>c. SQL\u8bed\u53e5\u4e66\u5199\u7684\u65f6\u5019\u5c3d\u91cf\u4e0d\u8981\u7701\u7565\u5c0f\u5f15\u53f7(tab\u952e\u4e0a\u9762\u90a3\u4e2a)\u548c\u5355\u5f15\u53f7</li> <li>d. \u63d0\u9ad8\u6570\u636e\u5e93\u547d\u540d\u6280\u5de7\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u91cd\u8981\u7684\u5b57\u6bb5\u6839\u636e\u7a0b\u5e8f\u7684\u7279\u70b9\u547d\u540d\uff0c\u53d6\u4e0d\u6613\u88ab\u731c\u5230\u7684</li> <li>e. \u5bf9\u4e8e\u5e38\u7528\u7684\u65b9\u6cd5\u52a0\u4ee5\u5c01\u88c5\uff0c\u907f\u514d\u76f4\u63a5\u66b4\u6f0fSQL\u8bed\u53e5</li> <li>f. \u5f00\u542fPHP\u5b89\u5168\u6a21\u5f0f\uff1a<code>Safe_mode=on</code>;</li> <li>g. \u6253\u5f00<code>magic_quotes_gpc</code>\u6765\u9632\u6b62SQL\u6ce8\u5165</li> <li>h. \u63a7\u5236\u9519\u8bef\u4fe1\u606f\uff1a\u5173\u95ed\u9519\u8bef\u63d0\u793a\u4fe1\u606f\uff0c\u5c06\u9519\u8bef\u4fe1\u606f\u5199\u5230\u7cfb\u7edf\u65e5\u5fd7\u3002</li> <li>i. \u4f7f\u7528mysqli\u6216pdo\u9884\u5904\u7406\u3002</li> </ul>"},{"location":"chap4/6Py_interview/#2-17-xxs","title":"2-17 xxs\u5982\u4f55\u9884\u9632\uff1f","text":"<p>XSS\u6f0f\u6d1e\u96be\u4ee5\u68c0\u6d4b\uff0c\u4f46\u662f\u4e3a\u4e86WEB\u5b89\u5168\u4ecd\u9700\u8981\u5c3d\u529b\u907f\u514d\uff1a</p> <p>\u9488\u5bf9\u53cd\u5c04\u578b\u548c\u5b58\u50a8\u578bXSS\uff0c\u9700\u8981\u670d\u52a1\u7aef\u548c\u524d\u7aef\u5171\u540c\u9884\u9632\uff0c\u9488\u5bf9\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\u505a\u89e3\u6790\u548c\u8f6c\u4e49\uff0c\u5bf9\u4e8e\u524d\u7aef\u5f00\u53d1\u800c\u8a00\uff0c\u5219\u662f\u5584\u4e8e\u4f7f\u7528escape\uff0c\u9488\u5bf9data URI\u5185\u5bb9\u505a\u6b63\u5219\u5224\u65ad\uff0c\u7981\u6b62\u7528\u6237\u8f93\u5165\u975e\u663e\u793a\u4fe1\u606f\u3002</p> <p>\u5bf9\u4e8eDOM XSS\uff0c\u7531\u4e8e\u9020\u6210XSS\u7684\u539f\u56e0\u5728\u4e8e\u7528\u6237\u7684\u8f93\u5165\uff0c\u56e0\u6b64\u5728\u524d\u7aef\uff0c\u9700\u8981\u7279\u522b\u6ce8\u610f\u7528\u6237\u8f93\u5165\u6e90\uff0c\u5e76\u5bf9\u53ef\u80fd\u9020\u6210\u7684XSS\u7684\u64cd\u4f5c\u9700\u8981\u8fdb\u884c\u5b57\u4e32\u8f6c\u4e49\u3002</p>"},{"location":"chap4/6Py_interview/#2-18","title":"2-18 \u5982\u4f55\u751f\u6210\u5171\u4eab\u79d8\u94a5\uff1f \u5982\u4f55\u9632\u8303\u4e2d\u95f4\u4eba\u653b\u51fb\uff1f","text":"<p>\u5bc6\u94a5\u7684\u751f\u6210\u662f\u901a\u8fc7\u4f7f\u7528\u5168\u5c40\u914d\u7f6e\u547d\u4ee4\u5b8c\u6210\u7684\uff1a\u5bf9\u4e8e\u4e0d\u53ef\u8f93\u51fa\u5bc6\u94a5\u662f<code>&lt;crypto key generate rsa label {label string}</code>\uff0c\u800c\u5bf9\u4e8e\u53ef\u8f93\u51fa\u5bc6\u94a5\u5219\u662f&lt;<code>crypto key generate rsa exportable label {label string}&gt;</code>\u3002\u6807\u8bb0\uff08label\uff09\u662f\u53ef\u9009\u62e9\u7684\uff1b\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u6807\u8bb0\uff0c\u90a3\u4e48\u5bc6\u94a5\u540d\u79f0\u5c06\u662f<code>hostname.domain-name</code>\u3002</p> <p>\u5bf9\u4e8e\u4e2d\u95f4\u4eba\u7684\u653b\u51fb\uff0c\u53ef\u4ee5\u91c7\u7528\u5982\u4e0b\u9632\u8303\u624b\u6bb5\uff1a</p> <ul> <li>a. \u901a\u8fc7\u91c7\u7528\u52a8\u6001ARP\u68c0\u6d4b\u3001DHCP Snooping\u7b49\u63a7\u5236\u64cd\u4f5c\u6765\u52a0\u5f3a\u7f51\u7edc\u57fa\u7840\u8bbe\u65bd</li> <li>b. \u91c7\u7528\u4f20\u8f93\u52a0\u5bc6</li> <li>c. \u4f7f\u7528CASBs\uff08\u4e91\u8bbf\u95ee\u5b89\u5168\u4ee3\u7406\uff09</li> <li>d. \u521b\u5efaRASP\uff08\u5b9e\u65f6\u5e94\u7528\u7a0b\u5e8f\u81ea\u6211\u4fdd\u62a4\uff09</li> <li>e. \u963b\u6b62\u81ea\u7b7e\u540d\u8bc1\u4e66</li> <li>f. \u5f3a\u5236\u4f7f\u7528SSL pinning</li> <li>g.  \u5b89\u88c5DAM\uff08\u6570\u636e\u5e93\u6d3b\u52a8\u76d1\u63a7\uff09</li> </ul>"},{"location":"chap4/6Py_interview/#3difference","title":"3\u3001Difference","text":""},{"location":"chap4/6Py_interview/#3-1","title":"3-1 \u6570\u7ec4\u548c\u5143\u7ec4\u4e4b\u95f4\u7684\u533a\u522b\uff1f","text":"<p>\u6570\u7ec4\u5728python\u4e2d\u53eb\u4f5c\u5217\u8868\u3002\u5217\u8868\u53ef\u4ee5\u4fee\u6539\uff0c\u800c\u5143\u7ec4\u4e0d\u53ef\u4ee5\u4fee\u6539\uff0c\u5982\u679c\u5143\u7ec4\u4e2d\u4ec5\u6709\u4e00\u4e2a\u5143\u7d20\uff0c\u5219\u8981\u5728\u5143\u7d20\u540e\u52a0\u4e0a\u9017\u53f7\u3002</p> <p>\u5143\u7ec4\u548c\u5217\u8868\u7684\u67e5\u8be2\u65b9\u5f0f\u4e00\u6837\u3002\u5143\u7ec4\u53ea\u53ef\u8bfb\u4e0d\u53ef\u4fee\u6539\uff0c\u5982\u679c\u7a0b\u5e8f\u4e2d\u7684\u6570\u636e\u4e0d\u5141\u8bb8\u4fee\u6539\u53ef\u7528\u5143\u7ec4\u3002</p>"},{"location":"chap4/6Py_interview/#3-2-_new__init_","title":"3-2  <code>_new_</code>\u548c<code>_init_</code>\u7684\u533a\u522b\uff1f","text":"<ul> <li><code>__init__</code>\u662f\u5f53\u5b9e\u4f8b\u5bf9\u8c61\u521b\u5efa\u5b8c\u6210\u540e\u88ab\u8c03\u7528\u7684\uff0c\u7136\u540e\u8bbe\u7f6e\u5bf9\u8c61\u5c5e\u6027\u7684\u4e00\u4e9b\u521d\u59cb\u503c\u3002</li> <li><code>__new__</code>\u662f\u5728\u5b9e\u4f8b\u521b\u5efa\u4e4b\u524d\u88ab\u8c03\u7528\u7684\uff0c\u56e0\u4e3a\u5b83\u7684\u4efb\u52a1\u5c31\u662f\u521b\u5efa\u5b9e\u4f8b\u7136\u540e\u8fd4\u56de\u8be5\u5b9e\u4f8b\uff0c\u662f\u4e2a\u9759\u6001\u65b9\u6cd5\u3002</li> </ul> <p>\u4e5f\u5c31\u662f\uff0c<code>__new__</code>\u5728<code>__init__</code>\u4e4b\u524d\u88ab\u8c03\u7528\uff0c<code>__new__</code>\u7684\u8fd4\u56de\u503c\uff08\u5b9e\u4f8b\uff09\u5c06\u4f20\u9012\u7ed9<code>__init__</code>\u65b9\u6cd5\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u7136\u540e<code>__init__</code>\u7ed9\u8fd9\u4e2a\u5b9e\u4f8b\u8bbe\u7f6e\u4e00\u4e9b\u53c2\u6570\u3002</p>"},{"location":"chap4/6Py_interview/#3-3-python","title":"3-3 Python\u4e2d\u5355\u4e0b\u5212\u7ebf\u548c\u53cc\u4e0b\u5212\u7dab\u7684\u533a\u522b\uff1f","text":"<ul> <li>\"\u5355\u4e0b\u5212\u7ebf\" \u5f00\u59cb\u7684\u6210\u5458\u53d8\u91cf\u53eb\u505a\u4fdd\u62a4\u53d8\u91cf\uff0c\u610f\u601d\u662f\u53ea\u6709\u7c7b\u5bf9\u8c61\u548c\u5b50\u7c7b\u5bf9\u8c61\u81ea\u5df1\u80fd\u8bbf\u95ee\u5230\u8fd9\u4e9b\u53d8\u91cf\uff1b</li> <li>\"\u53cc\u4e0b\u5212\u7ebf\" \u5f00\u59cb\u7684\u662f\u79c1\u6709\u6210\u5458\uff0c\u610f\u601d\u662f\u53ea\u6709\u7c7b\u5bf9\u8c61\u81ea\u5df1\u80fd\u8bbf\u95ee\uff0c\u8fde\u5b50\u7c7b\u5bf9\u8c61\u4e5f\u4e0d\u80fd\u8bbf\u95ee\u5230\u8fd9\u4e2a\u6570\u636e\u3002</li> </ul>"},{"location":"chap4/6Py_interview/#3-4","title":"3-4 \u6d45\u62f7\u8d1d\u4e0e\u6df1\u62f7\u8d1d\u7684\u533a\u522b\u662f\uff1f","text":"<p>\u5728python\u4e2d\uff0c\u5bf9\u8c61\u8d4b\u503c\u5b9e\u9645\u4e0a\u662f\u5bf9\u8c61\u7684\u5f15\u7528\u3002</p> <p>\u6d45\u62f7\u8d1d\uff0c\u6ca1\u6709\u62f7\u8d1d\u5b50\u5bf9\u8c61\uff0c\u6240\u4ee5\u539f\u59cb\u6570\u636e\u6539\u53d8\uff0c\u5b50\u5bf9\u8c61\u4f1a\u6539\u53d8\uff0c\u800c\u6df1\u62f7\u8d1d\uff0c\u5305\u542b\u5bf9\u8c61\u91cc\u9762\u7684\u81ea\u5bf9\u8c61\u7684\u62f7\u8d1d\uff0c\u6240\u4ee5\u539f\u59cb\u5bf9\u8c61\u7684\u6539\u53d8\u4e0d\u4f1a\u9020\u6210\u6df1\u62f7\u8d1d\u91cc\u4efb\u4f55\u5b50\u5143\u7d20\u7684\u6539\u53d8\u3002</p>"},{"location":"chap4/6Py_interview/#3-5","title":"3-5 \u4f7f\u7528\u88c5\u9970\u5668\u7684\u5355\u4f8b\u548c\u4f7f\u7528\u5176\u4ed6\u65b9\u6cd5\u7684\u5355\u4f8b\uff0c\u5728\u540e\u7eed\u4f7f\u7528\u4e2d\uff0c\u6709\u4f55\u533a\u522b\uff1f","text":"<p>Import\u65b9\u6cd5\u6539\u53d8\u4e86\u7c7b\u672c\u8eab\uff0cnew\u65b9\u6cd5\uff0c\u4f46\u662f\u53ea\u662f\u628a\u6240\u6709\u5b9e\u4f8b\u5bf9\u8c61\u5171\u4eab\u5c5e\u6027\uff0c\u6bcf\u6b21\u4ea7\u751f\u4e00\u4e2a\u65b0\u5bf9\u8c61\u3002\u7b97\u4f5c\u4f2a\u5355\u4f8b\uff0c\u5171\u4eab\u5c5e\u6027\u65b9\u6cd5\u5b9e\u4f8b\u5316\u4e86\u8bb8\u591a\u4e2a\u76f8\u540c\u5c5e\u6027\u3002\u6240\u4ee5\uff0c\u88c5\u9970\u5668\u65b9\u6cd5\u6700\u4e3a\u5b9e\u7528\u3002</p>"},{"location":"chap4/6Py_interview/#3-6","title":"3-6 \u591a\u8fdb\u7a0b\u4e0e\u591a\u7ebf\u7a0b\u7684\u533a\u522b\uff1f","text":"<p>a. \u7b80\u800c\u8a00\u4e4b,\u4e00\u4e2a\u7a0b\u5e8f\u81f3\u5c11\u6709\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u81f3\u5c11\u6709\u4e00\u4e2a\u7ebf\u7a0b\u3002</p> <p>b. \u7ebf\u7a0b\u7684\u5212\u5206\u5c3a\u5ea6\u5c0f\u4e8e\u8fdb\u7a0b\uff0c\u4f7f\u5f97\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u7684\u5e76\u53d1\u6027\u9ad8\u3002</p> <p>c. \u53e6\u5916\uff0c\u8fdb\u7a0b\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u62e5\u6709\u72ec\u7acb\u7684\u5185\u5b58\u5355\u5143\uff0c\u800c\u591a\u4e2a\u7ebf\u7a0b\u5171\u4eab\u5185\u5b58\uff0c\u4ece\u800c\u6781\u5927\u5730\u63d0\u9ad8\u4e86\u7a0b\u5e8f\u7684\u8fd0\u884c\u6548\u7387\u3002</p> <p>d. \u7ebf\u7a0b\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u4e0e\u8fdb\u7a0b\u8fd8\u662f\u6709\u533a\u522b\u7684\u3002\u6bcf\u4e2a\u72ec\u7acb\u7684\u7ebf\u7a0b\u6709\u4e00\u4e2a\u7a0b\u5e8f\u8fd0\u884c\u7684\u5165\u53e3\u3001\u987a\u5e8f\u6267\u884c\u5e8f\u5217\u548c\u7a0b\u5e8f\u7684\u51fa\u53e3\u3002\u4f46\u662f\u7ebf\u7a0b\u4e0d\u80fd\u591f\u72ec\u7acb\u6267\u884c\uff0c\u5fc5\u987b\u4f9d\u5b58\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u7531\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u591a\u4e2a\u7ebf\u7a0b\u6267\u884c\u63a7\u5236\u3002</p> <p>e. \u4ece\u903b\u8f91\u89d2\u5ea6\u6765\u770b\uff0c\u591a\u7ebf\u7a0b\u7684\u610f\u4e49\u5728\u4e8e\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u6709\u591a\u4e2a\u6267\u884c\u90e8\u5206\u53ef\u4ee5\u540c\u65f6\u6267\u884c\u3002\u4f46\u64cd\u4f5c\u7cfb\u7edf\u5e76\u6ca1\u6709\u5c06\u591a\u4e2a\u7ebf\u7a0b\u770b\u505a\u591a\u4e2a\u72ec\u7acb\u7684\u5e94\u7528\uff0c\u6765\u5b9e\u73b0\u8fdb\u7a0b\u7684\u8c03\u5ea6\u548c\u7ba1\u7406\u4ee5\u53ca\u8d44\u6e90\u5206\u914d\u3002\u8fd9\u5c31\u662f\u8fdb\u7a0b\u548c\u7ebf\u7a0b\u7684\u91cd\u8981\u533a\u522b\u3002</p>"},{"location":"chap4/6Py_interview/#3-7-selectepoll","title":"3-7 select\u548cepoll\u7684\u533a\u522b\uff1f","text":"<p>a. select\u5b9e\u73b0\u9700\u8981\u81ea\u5df1\u4e0d\u65ad\u8f6e\u8be2\u6240\u6709fd\u96c6\u5408\uff0c\u76f4\u5230\u8bbe\u5907\u5c31\u7eea\uff0c\u671f\u95f4\u53ef\u80fd\u8981\u7761\u7720\u548c\u5524\u9192\u591a\u6b21\u4ea4\u66ff\u3002\u800cepoll\u5176\u5b9e\u4e5f\u9700\u8981\u8c03\u7528<code>epoll_wait</code>\u4e0d\u65ad\u8f6e\u8be2\u5c31\u7eea\u94fe\u8868\uff0c\u671f\u95f4\u4e5f\u53ef\u80fd\u591a\u6b21\u7761\u7720\u548c\u5524\u9192\u4ea4\u66ff\uff0c\u4f46\u662f\u5b83\u662f\u8bbe\u5907\u5c31\u7eea\u65f6\uff0c\u8c03\u7528\u56de\u8c03\u51fd\u6570\uff0c\u628a\u5c31\u7eeafd\u653e\u5165\u5c31\u7eea\u94fe\u8868\u4e2d\uff0c\u5e76\u5524\u9192\u5728epoll_wait\u4e2d\u8fdb\u5165\u7761\u7720\u7684\u8fdb\u7a0b\u3002\u867d\u7136\u90fd\u8981\u7761\u7720\u548c\u4ea4\u66ff\uff0c\u4f46\u662fselect\u5728\u201c\u9192\u7740\u201d\u7684\u65f6\u5019\u8981\u904d\u5386\u6574\u4e2afd\u96c6\u5408\uff0c\u800cepoll\u5728\u201c\u9192\u7740\u201d\u7684\u65f6\u5019\u53ea\u8981\u5224\u65ad\u4e00\u4e0b\u5c31\u7eea\u94fe\u8868\u662f\u5426\u4e3a\u7a7a\u5c31\u884c\u4e86\uff0c\u8fd9\u8282\u7701\u4e86\u5927\u91cf\u7684CPU\u65f6\u95f4\u3002</p> <p>b. select\u6bcf\u6b21\u8c03\u7528\u90fd\u8981\u628afd\u96c6\u5408\u4ece\u7528\u6237\u6001\u5f80\u5185\u6838\u6001\u62f7\u8d1d\u4e00\u6b21\uff0c\u5e76\u4e14\u8981\u628acurrent\u5f80\u8bbe\u5907\u7b49\u5f85\u961f\u5217\u4e2d\u6302\u4e00\u6b21\uff0c\u800cepoll\u53ea\u8981\u4e00\u6b21\u62f7\u8d1d\uff0c\u800c\u4e14\u628acurrent\u5f80\u7b49\u5f85\u961f\u5217\u4e0a\u6302\u4e5f\u53ea\u6302\u4e00\u6b21\uff08\u5728epoll_wait\u7684\u5f00\u59cb\uff0c\u6ce8\u610f\u8fd9\u91cc\u7684\u7b49\u5f85\u961f\u5217\u5e76\u4e0d\u662f\u8bbe\u5907\u7b49\u5f85\u961f\u5217\uff0c\u53ea\u662f\u4e00\u4e2aepoll\u5185\u90e8\u5b9a\u4e49\u7684\u7b49\u5f85\u961f\u5217\uff09\u3002\u8fd9\u4e5f\u80fd\u8282\u7701\u4e0d\u5c11\u7684\u5f00\u9500\u3002</p>"},{"location":"chap4/6Py_interview/#3-8-tcpudp","title":"3-8 TCP\u548cUDP\u7684\u533a\u522b\uff1f\u8fb9\u7f18\u89e6\u53d1\u548c\u6c34\u5e73\u89e6\u53d1\u7684\u533a\u522b\uff1f","text":"<p>a. \u57fa\u672c\u533a\u522b\uff1a</p> <ul> <li>\u57fa\u4e8e\u8fde\u63a5\u4e0e\u65e0\u8fde\u63a5</li> <li>TCP\u8981\u6c42\u7cfb\u7edf\u8d44\u6e90\u8f83\u591a\uff0cUDP\u8f83\u5c11\uff1b </li> <li>UDP\u7a0b\u5e8f\u7ed3\u6784\u8f83\u7b80\u5355 </li> <li>\u6d41\u6a21\u5f0f\uff08TCP\uff09\u4e0e\u6570\u636e\u62a5\u6a21\u5f0f(UDP); </li> <li>TCP\u4fdd\u8bc1\u6570\u636e\u6b63\u786e\u6027\uff0cUDP\u53ef\u80fd\u4e22\u5305 </li> <li>TCP\u4fdd\u8bc1\u6570\u636e\u987a\u5e8f\uff0cUDP\u4e0d\u4fdd\u8bc1 </li> </ul> <p>b. \u7f16\u7a0b\u4e2d\u7684\u533a\u522b</p> <ul> <li>socket()\u7684\u53c2\u6570\u4e0d\u540c </li> <li>UDP Server\u4e0d\u9700\u8981\u8c03\u7528listen\u548caccept </li> <li>UDP\u6536\u53d1\u6570\u636e\u7528sendto/recvfrom\u51fd\u6570 </li> <li>TCP\uff1a\u5730\u5740\u4fe1\u606f\u5728connect/accept\u65f6\u786e\u5b9a </li> <li>UDP\uff1a\u5728sendto/recvfrom\u51fd\u6570\u4e2d\u6bcf\u6b21\u5747 \u9700\u6307\u5b9a\u5730\u5740\u4fe1\u606f </li> <li>UDP\uff1ashutdown\u51fd\u6570\u65e0\u6548</li> </ul>"},{"location":"chap4/6Py_interview/#3-9-httpgetpost","title":"3-9 HTTP\u8fde\u63a5\uff1aget\u548cpost\u7684\u533a\u522b\uff1f","text":"<p>GET\u8bf7\u6c42\uff0c\u8bf7\u6c42\u7684\u6570\u636e\u4f1a\u9644\u52a0\u5728URL\u4e4b\u540e\uff0c\u4ee5?\u5206\u5272URL\u548c\u4f20\u8f93\u6570\u636e\uff0c\u591a\u4e2a\u53c2\u6570\u7528&amp;\u8fde\u63a5\u3002URL\u7684\u7f16\u7801\u683c\u5f0f\u91c7\u7528\u7684\u662fASCII\u7f16\u7801\uff0c\u800c\u4e0d\u662funiclde\uff0c\u5373\u662f\u8bf4\u6240\u6709\u7684\u975eASCII\u5b57\u7b26\u90fd\u8981\u7f16\u7801\u4e4b\u540e\u518d\u4f20\u8f93\u3002</p> <p>POST\u8bf7\u6c42\uff1aPOST\u8bf7\u6c42\u4f1a\u628a\u8bf7\u6c42\u7684\u6570\u636e\u653e\u7f6e\u5728HTTP\u8bf7\u6c42\u5305\u7684\u5305\u4f53\u4e2d\u3002\u4e0a\u9762\u7684item=bandsaw\u5c31\u662f\u5b9e\u9645\u7684\u4f20\u8f93\u6570\u636e\u3002</p> <p>\u56e0\u6b64\uff0cGET\u8bf7\u6c42\u7684\u6570\u636e\u4f1a\u66b4\u9732\u5728\u5730\u5740\u680f\u4e2d\uff0c\u800cPOST\u8bf7\u6c42\u5219\u4e0d\u4f1a\u3002</p>"},{"location":"chap4/6Py_interview/#3-10-varcharchar","title":"3-10 varchar\u4e0echar\u7684\u533a\u522b\uff1f","text":"<p>char \u957f\u5ea6\u662f\u56fa\u5b9a\u7684\uff0c\u4e0d\u7ba1\u4f60\u5b58\u50a8\u7684\u6570\u636e\u662f\u591a\u5c11\u4ed6\u90fd\u4f1a\u90fd\u56fa\u5b9a\u7684\u957f\u5ea6\u3002\u800cvarchar\u5219\u5904\u53ef\u53d8\u957f\u5ea6\u4f46\u4ed6\u8981\u5728\u603b\u957f\u5ea6\u4e0a\u52a01\u5b57\u7b26\uff0c\u8fd9\u4e2a\u7528\u6765\u5b58\u50a8\u4f4d\u7f6e\u3002</p> <p>\u6240\u4ee5\u5728\u5904\u7406\u901f\u5ea6\u4e0achar\u8981\u6bd4varchar\u5feb\u901f\u5f88\u591a\uff0c\u4f46\u662f\u5bf9\u8d39\u5b58\u50a8\u7a7a\u95f4\uff0c\u6240\u4ee5\u5bf9\u5b58\u50a8\u4e0d\u5927\uff0c\u4f46\u5728\u901f\u5ea6\u4e0a\u6709\u8981\u6c42\u7684\u53ef\u4ee5\u4f7f\u7528char\u7c7b\u578b\uff0c\u53cd\u4e4b\u53ef\u4ee5\u7528varchar\u7c7b\u578b\u3002</p>"},{"location":"chap4/6Py_interview/#3-11-btreehash","title":"3-11 BTree\u7d22\u5f15\u548chash\u7d22\u5f15\u7684\u533a\u522b\uff1f","text":"<p>Hash \u7d22\u5f15\u56e0\u5176\u7ed3\u6784\u7684\u7279\u6b8a\u6027\uff0c\u5176\u68c0\u7d22\u6548\u7387\u975e\u5e38\u9ad8\uff0c\u7d22\u5f15\u7684\u68c0\u7d22\u53ef\u4ee5\u4e00\u6b21\u5b9a\u4f4d\uff0c\u4e0d\u50cfB-Tree \u7d22\u5f15\u9700\u8981\u4ece\u6839\u8282\u70b9\u5230\u679d\u8282\u70b9\uff0c\u6700\u540e\u624d\u80fd\u8bbf\u95ee\u5230\u9875\u8282\u70b9\u8fd9\u6837\u591a\u6b21\u7684IO\u8bbf\u95ee\uff0c\u6240\u4ee5 Hash \u7d22\u5f15\u7684\u67e5\u8be2\u6548\u7387\u8981\u8fdc\u9ad8\u4e8e B-Tree \u7d22\u5f15\u3002\u4f46\u4e5f\u6709\u5982\u4e0b\u660e\u663e\u7684\u7f3a\u70b9\uff1a</p> <ul> <li>a. Hash \u7d22\u5f15\u4ec5\u4ec5\u80fd\u6ee1\u8db3<code>\"=\"</code>,\"IN\"\u548c<code>\"&lt;=&gt;\"</code>\u67e5\u8be2\uff0c\u4e0d\u80fd\u4f7f\u7528\u8303\u56f4\u67e5\u8be2\u3002</li> <li>b. Hash \u7d22\u5f15\u65e0\u6cd5\u88ab\u7528\u6765\u907f\u514d\u6570\u636e\u7684\u6392\u5e8f\u64cd\u4f5c\u3002</li> <li>c. Hash \u7d22\u5f15\u4e0d\u80fd\u5229\u7528\u90e8\u5206\u7d22\u5f15\u952e\u67e5\u8be2\u3002</li> <li>d. Hash \u7d22\u5f15\u5728\u4efb\u4f55\u65f6\u5019\u90fd\u4e0d\u80fd\u907f\u514d\u8868\u626b\u63cf\u3002</li> <li>e. Hash \u7d22\u5f15\u9047\u5230\u5927\u91cfHash\u503c\u76f8\u7b49\u7684\u60c5\u51b5\u540e\u6027\u80fd\u5e76\u4e0d\u4e00\u5b9a\u5c31\u4f1a\u6bd4B-Tree\u7d22\u5f15\u9ad8\u3002</li> </ul>"},{"location":"chap4/6Py_interview/#3-12-primary-keyunique","title":"3-12 primary key\u548cunique\u7684\u533a\u522b\uff1f","text":"<p>a. \u4f5c\u4e3aPrimary Key\u7684\u57df/\u57df\u7ec4\u4e0d\u80fd\u4e3anull\uff0c\u800cUnique Key\u53ef\u4ee5\u3002 </p> <p>b. \u5728\u4e00\u4e2a\u8868\u4e2d\u53ea\u80fd\u6709\u4e00\u4e2aPrimary Key\uff0c\u800c\u591a\u4e2aUnique Key\u53ef\u4ee5\u540c\u65f6\u5b58\u5728\u3002 </p> <p>C. \u903b\u8f91\u8bbe\u8ba1\u4e0a\u8bb2\uff0cPrimary Key\u4e00\u822c\u5728\u903b\u8f91\u8bbe\u8ba1\u4e2d\u7528\u4f5c\u8bb0\u5f55\u6807\u8bc6\uff0c\u8fd9\u4e5f\u662f\u8bbe\u7f6ePrimary Key\u7684\u672c\u6765\u7528\u610f\uff0c\u800cUnique Key\u53ea\u662f\u4e3a\u4e86\u4fdd\u8bc1\u57df/\u57df\u7ec4\u7684\u552f\u4e00\u6027\u3002 </p>"},{"location":"chap4/6Py_interview/#3-13-ecbcbc","title":"3-13 ecb\u548ccbc\u6a21\u5f0f\u6709\u4ec0\u4e48\u533a\u522b\uff1f","text":"<p>ECB\uff1a\u662f\u4e00\u79cd\u57fa\u7840\u7684\u52a0\u5bc6\u65b9\u5f0f\uff0c\u5bc6\u6587\u88ab\u5206\u5272\u6210\u5206\u7ec4\u957f\u5ea6\u76f8\u7b49\u7684\u5757\uff08\u4e0d\u8db3\u8865\u9f50\uff09\uff0c\u7136\u540e\u5355\u72ec\u4e00\u4e2a\u4e2a\u52a0\u5bc6\uff0c\u4e00\u4e2a\u4e2a\u8f93\u51fa\u7ec4\u6210\u5bc6\u6587\u3002</p> <p>CBC\uff1a\u662f\u4e00\u79cd\u5faa\u73af\u6a21\u5f0f\uff0c\u524d\u4e00\u4e2a\u5206\u7ec4\u7684\u5bc6\u6587\u548c\u5f53\u524d\u5206\u7ec4\u7684\u660e\u6587\u5f02\u6216\u64cd\u4f5c\u540e\u518d\u52a0\u5bc6\uff0c\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u589e\u5f3a\u7834\u89e3\u96be\u5ea6\u3002ECB\u548cCBC\u7684\u52a0\u5bc6\u7ed3\u679c\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u4e24\u8005\u7684\u6a21\u5f0f\u4e0d\u540c\uff0c\u800c\u4e14CBC\u4f1a\u5728\u7b2c\u4e00\u4e2a\u5bc6\u7801\u5757\u8fd0\u7b97\u65f6\u52a0\u5165\u4e00\u4e2a\u521d\u59cb\u5316\u5411\u91cf\u3002 </p>"},{"location":"chap4/6Py_interview/#3-14","title":"3-14 \u5bf9\u79f0\u52a0\u5bc6\u4e0e\u975e\u5bf9\u79f0\u52a0\u5bc6\u7684\u533a\u522b\uff1f","text":"<p>\u5bf9\u79f0\u52a0\u5bc6\uff0c\u9700\u8981\u5bf9\u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u76f8\u540c\u5bc6\u94a5\u7684\u52a0\u5bc6\u7b97\u6cd5\u3002\u7531\u4e8e\u5176\u901f\u5ea6\u5feb\uff0c\u5bf9\u79f0\u6027\u52a0\u5bc6\u901a\u5e38\u5728\u6d88\u606f\u53d1\u9001\u65b9\u9700\u8981\u52a0\u5bc6\u5927\u91cf\u6570\u636e\u65f6\u4f7f\u7528\u3002\u6240\u4ee5\uff0c\u5bf9\u79f0\u6027\u52a0\u5bc6\u4e5f\u79f0\u4e3a\u5bc6\u94a5\u52a0\u5bc6\u3002</p> <p>\u800c\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u9700\u8981\u4e24\u4e2a\u5bc6\u94a5\uff1a\u516c\u5f00\u5bc6\u94a5\u548c\u79c1\u6709\u5bc6\u94a5\u3002\u516c\u5f00\u5bc6\u94a5\u4e0e\u79c1\u6709\u5bc6\u94a5\u662f\u4e00\u5bf9\uff0c\u5982\u679c\u7528\u516c\u5f00\u5bc6\u94a5\u5bf9\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\uff0c\u53ea\u6709\u7528\u5bf9\u5e94\u7684\u79c1\u6709\u5bc6\u94a5\u624d\u80fd\u89e3\u5bc6\uff1b\u5982\u679c\u7528\u79c1\u6709\u5bc6\u94a5\u5bf9\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\uff0c\u90a3\u4e48\u53ea\u6709\u7528\u5bf9\u5e94\u7684\u516c\u5f00\u5bc6\u94a5\u624d\u80fd\u89e3\u5bc6\u3002</p>"},{"location":"chap4/6Py_interview/#3-15-xrangerange","title":"3-15 Xrange\u548crange\u7684\u533a\u522b\uff1f","text":"<p><code>range([start,] stop[, step])</code>\uff0c\u6839\u636estart\u4e0estop\u6307\u5b9a\u7684\u8303\u56f4\u4ee5\u53castep\u8bbe\u5b9a\u7684\u6b65\u957f\uff0c\u751f\u6210\u4e00\u4e2a\u5e8f\u5217\u3002</p> <p>xrange \u7528\u6cd5\u4e0e range \u5b8c\u5168\u76f8\u540c\uff0c\u6240\u4e0d\u540c\u7684\u662f\u751f\u6210\u7684\u4e0d\u662f\u4e00\u4e2alist\u5bf9\u8c61\uff0c\u800c\u662f\u4e00\u4e2a\u751f\u6210\u5668\u3002\u8981\u751f\u6210\u5f88\u5927\u7684\u6570\u5b57\u5e8f\u5217\u7684\u65f6\u5019\uff0c\u7528xrange\u4f1a\u6bd4range\u6027\u80fd\u4f18\u5f88\u591a\uff0c\u56e0\u4e3a\u4e0d\u9700\u8981\u4e00\u4e0a\u6765\u5c31\u5f00\u8f9f\u4e00\u5757\u5f88\u5927\u7684\u5185\u5b58\u7a7a\u95f4\u3002</p> <p>range\u4f1a\u76f4\u63a5\u751f\u6210\u4e00\u4e2alist\u5bf9\u8c61\uff0c\u800cxrange\u5219\u4e0d\u4f1a\u76f4\u63a5\u751f\u6210\u4e00\u4e2alist\uff0c\u800c\u662f\u6bcf\u6b21\u8c03\u7528\u8fd4\u56de\u5176\u4e2d\u7684\u4e00\u4e2a\u503c\u3002</p>"},{"location":"chap4/6Py_interview/#3-16-ossys","title":"3-16 os\u4e0esys\u6a21\u5757\u7684\u533a\u522b\uff1f","text":"<p>\u524d\u8005\u63d0\u4f9b\u4e86\u4e00\u79cd\u65b9\u4fbf\u7684\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u51fd\u6570\u7684\u65b9\u6cd5\u3002\u540e\u8005\u63d0\u4f9b\u8bbf\u95ee\u7531\u89e3\u91ca\u5668\u4f7f\u7528\u6216\u7ef4\u62a4\u7684\u53d8\u91cf\u548c\u4e0e\u89e3\u91ca\u5668\u8fdb\u884c\u4ea4\u4e92\u7684\u51fd\u6570\u3002</p> <p>3-17 NoSQL\u548c\u5173\u7cfb\u6570\u636e\u5e93\u7684\u533a\u522b\uff1f</p> <p>a. SQL\u6570\u636e\u5b58\u5728\u7279\u5b9a\u7ed3\u6784\u7684\u8868\u4e2d\uff1b\u800cNoSQL\u5219\u66f4\u52a0\u7075\u6d3b\u548c\u53ef\u6269\u5c55\uff0c\u5b58\u50a8\u65b9\u5f0f\u53ef\u4ee5\u7701\u662fJSON\u6587\u6863\u3001\u54c8\u5e0c\u8868\u6216\u8005\u5176\u4ed6\u65b9\u5f0f\u3002</p> <p>b. \u5728SQL\u4e2d\uff0c\u5fc5\u987b\u5b9a\u4e49\u597d\u8868\u548c\u5b57\u6bb5\u7ed3\u6784\u540e\u624d\u80fd\u6dfb\u52a0\u6570\u636e\uff0c\u4f8b\u5982\u5b9a\u4e49\u8868\u7684\u4e3b\u952e(primary key)\uff0c\u7d22\u5f15(index),\u89e6\u53d1\u5668(trigger),\u5b58\u50a8\u8fc7\u7a0b(stored procedure)\u7b49\u3002\u8868\u7ed3\u6784\u53ef\u4ee5\u5728\u88ab\u5b9a\u4e49\u4e4b\u540e\u66f4\u65b0\uff0c\u4f46\u662f\u5982\u679c\u6709\u6bd4\u8f83\u5927\u7684\u7ed3\u6784\u53d8\u66f4\u7684\u8bdd\u5c31\u4f1a\u53d8\u5f97\u6bd4\u8f83\u590d\u6742\u3002\u5728NoSQL\u4e2d\uff0c\u6570\u636e\u53ef\u4ee5\u5728\u4efb\u4f55\u65f6\u5019\u4efb\u4f55\u5730\u65b9\u6dfb\u52a0\uff0c\u4e0d\u9700\u8981\u5148\u5b9a\u4e49\u8868\u3002</p> <p>c. SQL\u4e2d\u5982\u679c\u9700\u8981\u589e\u52a0\u5916\u90e8\u5173\u8054\u6570\u636e\u7684\u8bdd\uff0c\u89c4\u8303\u5316\u505a\u6cd5\u662f\u5728\u539f\u8868\u4e2d\u589e\u52a0\u4e00\u4e2a\u5916\u952e\uff0c\u5173\u8054\u5916\u90e8\u6570\u636e\u8868\u3002\u800c\u5728NoSQL\u4e2d\u9664\u4e86\u8fd9\u79cd\u89c4\u8303\u5316\u7684\u5916\u90e8\u6570\u636e\u8868\u505a\u6cd5\u4ee5\u5916\uff0c\u6211\u4eec\u8fd8\u80fd\u7528\u5982\u4e0b\u7684\u975e\u89c4\u8303\u5316\u65b9\u5f0f\u628a\u5916\u90e8\u6570\u636e\u76f4\u63a5\u653e\u5230\u539f\u6570\u636e\u96c6\u4e2d\uff0c\u4ee5\u63d0\u9ad8\u67e5\u8be2\u6548\u7387\u3002\u7f3a\u70b9\u4e5f\u6bd4\u8f83\u660e\u663e\uff0c\u66f4\u65b0\u5ba1\u6838\u4eba\u6570\u636e\u7684\u65f6\u5019\u5c06\u4f1a\u6bd4\u8f83\u9ebb\u70e6\u3002</p> <p>d. SQL\u4e2d\u53ef\u4ee5\u4f7f\u7528JOIN\u8868\u94fe\u63a5\u65b9\u5f0f\u5c06\u591a\u4e2a\u5173\u7cfb\u6570\u636e\u8868\u4e2d\u7684\u6570\u636e\u7528\u4e00\u6761\u7b80\u5355\u7684\u67e5\u8be2\u8bed\u53e5\u67e5\u8be2\u51fa\u6765\u3002NoSQL\u6682\u672a\u63d0\u4f9b\u7c7b\u4f3cJOIN\u7684\u67e5\u8be2\u65b9\u5f0f\u5bf9\u591a\u4e2a\u6570\u636e\u96c6\u4e2d\u7684\u6570\u636e\u505a\u67e5\u8be2\u3002\u6240\u4ee5\u5927\u90e8\u5206NoSQL\u4f7f\u7528\u975e\u89c4\u8303\u5316\u7684\u6570\u636e\u5b58\u50a8\u65b9\u5f0f\u5b58\u50a8\u6570\u636e\u3002</p> <p>e. SQL\u4e2d\u4e0d\u5141\u8bb8\u5220\u9664\u5df2\u7ecf\u88ab\u4f7f\u7528\u7684\u5916\u90e8\u6570\u636e\uff0c\u800cNoSQL\u4e2d\u5219\u6ca1\u6709\u8fd9\u79cd\u5f3a\u8026\u5408\u7684\u6982\u5ff5\uff0c\u53ef\u4ee5\u968f\u65f6\u5220\u9664\u4efb\u4f55\u6570\u636e\u3002</p> <p>f. SQL\u4e2d\u5982\u679c\u591a\u5f20\u8868\u6570\u636e\u9700\u8981\u540c\u6279\u6b21\u88ab\u66f4\u65b0\uff0c\u5373\u5982\u679c\u5176\u4e2d\u4e00\u5f20\u8868\u66f4\u65b0\u5931\u8d25\u7684\u8bdd\u5176\u4ed6\u8868\u4e5f\u4e0d\u80fd\u66f4\u65b0\u6210\u529f\u3002\u8fd9\u79cd\u573a\u666f\u53ef\u4ee5\u901a\u8fc7\u4e8b\u52a1\u6765\u63a7\u5236\uff0c\u53ef\u4ee5\u5728\u6240\u6709\u547d\u4ee4\u5b8c\u6210\u540e\u518d\u7edf\u4e00\u63d0\u4ea4\u4e8b\u52a1\u3002\u800cNoSQL\u4e2d\u6ca1\u6709\u4e8b\u52a1\u8fd9\u4e2a\u6982\u5ff5\uff0c\u6bcf\u4e00\u4e2a\u6570\u636e\u96c6\u7684\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u7ea7\u7684\u3002</p> <p>g. \u5728\u76f8\u540c\u6c34\u5e73\u7684\u7cfb\u7edf\u8bbe\u8ba1\u7684\u524d\u63d0\u4e0b\uff0c\u56e0\u4e3aNoSQL\u4e2d\u7701\u7565\u4e86JOIN\u67e5\u8be2\u7684\u6d88\u8017\uff0c\u6545\u7406\u8bba\u4e0a\u6027\u80fd\u4e0a\u662f\u4f18\u4e8eSQL\u7684\u3002</p>"},{"location":"chap4/6Py_interview/#4practice","title":"4\u3001Practice","text":""},{"location":"chap4/6Py_interview/#4-1","title":"4-1 \u8865\u5145\u7f3a\u5931\u7684\u4ee3\u7801","text":"<pre><code>def print_directory_contents(sPath) :\n    \"\"\"\n    \u8fd4\u56de\u8be5\u6587\u4ef6\u5939\u4e2d\u6587\u4ef6\u7684\u8def\u5f84\n    \"\"\"\n</code></pre> <pre><code>def print_directory_contents(sPath):\n   import os                                       \n   for sChild in os.listdir(sPath):                \n       sChildPath = os.path.join(sPath,sChild)\n       if os.path.isdir(sChildPath):\n           print_directory_contents(sChildPath)\n       else:\n           print sChildPath\n</code></pre>"},{"location":"chap4/6Py_interview/#4-2","title":"4-2 \u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\u7684\u8f93\u51fa\u7ed3\u679c\u662f\u4ec0\u4e48\uff1f\u8bf7\u89e3\u91ca\u3002","text":"<pre><code>list1 = [10, 'a']list2 = [123]list3 = [10, 'a']\n</code></pre> <p>\u65b0\u7684\u9ed8\u8ba4\u5217\u8868\u53ea\u5728\u51fd\u6570\u88ab\u5b9a\u4e49\u7684\u90a3\u4e00\u523b\u521b\u5efa\u4e00\u6b21\u3002\u5f53extendList\u88ab\u6ca1\u6709\u6307\u5b9a\u7279\u5b9a\u53c2\u6570list\u8c03\u7528\u65f6\uff0c\u8fd9\u7ec4list\u7684\u503c\u968f\u540e\u5c06\u88ab\u4f7f\u7528\u3002\u8fd9\u662f\u56e0\u4e3a\u5e26\u6709\u9ed8\u8ba4\u53c2\u6570\u7684\u8868\u8fbe\u5f0f\u5728\u51fd\u6570\u88ab\u5b9a\u4e49\u7684\u65f6\u5019\u88ab\u8ba1\u7b97\uff0c\u4e0d\u662f\u5728\u8c03\u7528\u7684\u65f6\u5019\u88ab\u8ba1\u7b97\u3002</p>"},{"location":"chap4/6Py_interview/#4-3","title":"4-3 \u4e0b\u9762\u7684\u4ee3\u7801\u80fd\u591f\u8fd0\u884c\u4e48\uff1f\u8bf7\u89e3\u91ca\uff1f","text":"<pre><code>d = DefaultDict()\nd['florp'] = 127\n</code></pre> <p>\u80fd\u591f\u8fd0\u884c\u3002\u5f53key\u7f3a\u5931\u65f6\uff0c\u6267\u884cDefaultDict\u7c7b\uff0c\u5b57\u5178\u7684\u5b9e\u4f8b\u5c06\u81ea\u52a8\u5b9e\u4f8b\u5316\u8fd9\u4e2a\u6570\u5217\u3002</p>"},{"location":"chap4/6Py_interview/#4-4","title":"4-4  \u5c06\u51fd\u6570\u6309\u7167\u6267\u884c\u6548\u7387\u9ad8\u4f4e\u6392\u5e8f\uff0c\u5e76\u8bc1\u660e\u81ea\u5df1\u7684\u7b54\u6848\u662f\u6b63\u786e\u7684\u3002","text":"<p>\u6309\u6267\u884c\u6548\u7387\u4ece\u9ad8\u5230\u4f4e\u6392\u5217\uff1af2\u3001f1\u548cf3\u3002\u8981\u8bc1\u660e\u8fd9\u4e2a\u7b54\u6848\u662f\u6b63\u786e\u7684\uff0c\u4f60\u5e94\u8be5\u77e5\u9053\u5982\u4f55\u5206\u6790\u81ea\u5df1\u4ee3\u7801\u7684\u6027\u80fd\u3002Python\u4e2d\u6709\u4e00\u4e2a\u5f88\u597d\u7684\u7a0b\u5e8f\u5206\u6790\u5305\uff0c\u53ef\u4ee5\u6ee1\u8db3\u8fd9\u4e2a\u9700\u6c42\u3002 </p> <p></p>"},{"location":"chap4/7Pro_interview/","title":"\u7b2c\u4e03\u8282 prometheus\uff1a\u8981\u70b9\u603b\u7ed3\u53ca\u9762\u8bd5","text":""},{"location":"chap4/7Pro_interview/#1","title":"1\u3001\u8981\u70b9\u603b\u7ed3","text":""},{"location":"chap4/7Pro_interview/#1-1","title":"1-1 \u7b80\u4ecb","text":"<p>Prometheus\u662f\u4e00\u6b3e\u5f00\u6e90\u7684\u76d1\u63a7\u548c\u544a\u8b66\u5de5\u5177\uff0c\u7528\u4e8e\u65f6\u5e8f\u6570\u636e\u7684\u5b58\u50a8\u548c\u67e5\u8be2\u3002Prometheus\u9002\u7528\u4e8e\u7edf\u8ba1\u76f8\u5173\u7684\u6307\u6807\uff0c\u4f46\u4e0d\u9002\u5408\u8bb0\u5f55\u590d\u6742\u7684\u7ec6\u8282\u4fe1\u606f\u3002</p>"},{"location":"chap4/7Pro_interview/#1-2","title":"1-2 \u4e3b\u8981\u7279\u5f81","text":"<ul> <li>\u591a\u7ef4\u7684\u6570\u636e\u6a21\u578b\uff1b</li> <li>\u7075\u6d3b\u7684\u67e5\u8be2\u8bed\u8a00\uff1b</li> <li>\u4e0d\u4f9d\u8d56\u5206\u5e03\u5f0f\u5b58\u50a8\uff0c\u5355\u4e2a\u670d\u52a1\u5668\u8282\u70b9\u662f\u81ea\u4e3b\u7684\uff1b</li> <li>\u57fa\u4e8eHTTP\u7684\u6570\u636e\u62c9\u53d6\uff1b</li> <li>\u901a\u8fc7\u4e2d\u95f4\u7f51\u5173\u63a8\u9001\u6570\u636e\uff1b</li> <li>\u901a\u8fc7\u9759\u6001\u914d\u7f6e\u548c\u670d\u52a1\u53d1\u73b0\u76d1\u63a7\u76ee\u6807\uff1b</li> <li>\u591a\u6837\u5316\u7684\u6570\u636e\u754c\u9762\u3002</li> </ul>"},{"location":"chap4/7Pro_interview/#1-3","title":"1-3 \u91cd\u8981\u7ec4\u4ef6","text":"<ul> <li>Prometheus server\uff1a\u6700\u91cd\u8981\u7684\u7ec4\u4ef6\uff0c\u7528\u4e8e\u6293\u53d6\u53ca\u5b58\u50a8\u6570\u636e\uff1b</li> <li>client libraries\uff1a\u5ba2\u6237\u7aef\u5e93</li> <li>push gateway\uff1a\u4e2d\u95f4\u7f51\u5173\uff0c\u7528\u6765\u652f\u6301\u77ed\u751f\u547d\u5468\u671f\u7684\u670d\u52a1</li> <li>exporters\uff1a\u7279\u5b9a\u76ee\u7684\u7684\u6570\u636e\u6e90</li> <li>alertmanager\uff1a\u7528\u4e8e\u5904\u7406\u544a\u4fe1\u606f</li> <li>\u5404\u79cd\u652f\u6301\u7684\u5de5\u5177</li> </ul>"},{"location":"chap4/7Pro_interview/#1-4","title":"1-4 \u57fa\u7840\u67b6\u6784","text":"<p>\u4e3b\u8981\u6d41\u7a0b\uff1a</p> <ol> <li>\u6570\u636e\u6293\u53d6\u3002Prometheus server\u4ece\u76d1\u63a7\u76ee\u6807\uff08targets\uff09\u4e2d\u62c9\u53d6\u6570\u636e\u3002targets\u5305\u62ec\uff1a<ul> <li><code>short-lived jobs</code>\uff0c\u7531\u4e8e\u670d\u52a1\u65f6\u95f4\u5f88\u77ed\uff0c\u6240\u4ee5\u77ed\u671f\u670d\u52a1\u5728\u670d\u52a1\u7ed3\u675f\u65f6\u5c06\u6570\u636e\u63a8\u9001\u7ed9<code>Pushgateway</code>\uff0c<code>Prometheus server</code>\u4ece<code>Pushgateway</code>\u4e2d\u6293\u53d6\u6570\u636e\uff1b</li> <li>exporters\uff1a\u7528\u4e8e\u7b2c\u4e09\u65b9\u7684\u670d\u52a1\u7ed9Prometheus\uff1b</li> <li>Service discovery\uff1aconsul\u3001DNS\u7b49\u670d\u52a1\u53d1\u73b0\u3002</li> </ul> </li> <li>\u6570\u636e\u5b58\u50a8\u3002Prometheus server\u7528\u4e8e\u5b58\u50a8\u6293\u53d6\u5230\u7684\u6307\u6807\u3002\u6570\u636e\u53ef\u4ee5\u5b58\u50a8\u5230\u672c\u5730\u786c\u76d8\u6216\u8005\u4e91\u7aef\u3002</li> <li>\u544a\u8b66\u3002Prometheus\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6erule\u5b9e\u73b0\u544a\u8b66\u3002\u5f53\u6ee1\u8db3\u7279\u5b9a\u6761\u4ef6\u65f6\uff0c\u5c06alert\u63a8\u9001\u5230AlertManager\u3002</li> <li>\u6570\u636e\u67e5\u8be2\u548c\u663e\u793a\u3002\u901a\u8fc7PromQL\u67e5\u8be2\uff0c\u901a\u8fc7Prometheus webUI\u6216grafana\u7b49\u5176\u4ed6\u5de5\u5177\u6765\u53ef\u89c6\u5316\u663e\u793a\u6570\u636e</li> </ol>"},{"location":"chap4/7Pro_interview/#2","title":"2\u3001\u57fa\u672c\u6982\u5ff5","text":""},{"location":"chap4/7Pro_interview/#2-1","title":"2-1 \u6570\u636e\u6a21\u578b","text":"<p>Prometheus\u4ee5\u65f6\u95f4\u5e8f\u5217\u7684\u5f62\u5f0f\u5b58\u50a8\u6570\u636e\uff0c\u4ee5\u540d\u79f0\u548c\u952e\u503c\u5bf9\u6807\u7b7e\u4e3a\u552f\u4e00\u6807\u8bc6\uff0c\u4e0d\u540c\u6807\u8bc6\u4ee3\u8868\u4e0d\u540c\u7684\u65f6\u95f4\u5e8f\u5217\u3002</p> <p>\u6307\u6807\u540d\u79f0\uff08metric name\uff09\uff1a</p> <p>\u6307\u6807\u540d\u79f0\u7528\u6765\u6307\u5b9a\u6d4b\u91cf\u6307\u6807\u7684\u529f\u80fd\u3002\u5b83\u5fc5\u987b\u6ee1\u8db3<code>[a-zA-Z_:][a-zA-Z0-9_:]*</code>\u3002</p> <p>\u6807\u7b7e\uff08label\uff09\uff1a</p> <p>\u6807\u7b7e\u7684\u5e94\u7528\u4fdd\u8bc1\u4e86Prometheus\u6570\u636e\u7684\u591a\u7ef4\u6027\u3002\u5bf9\u4e8e\u540c\u4e00\u4e2a\u6307\u6807\u540d\u79f0\uff0c\u4e0d\u540c\u6807\u7b7e\u7684\u7ec4\u5408\u4ee3\u8868\u4e86\u4e0d\u540c\u7ef4\u5ea6\u7684\u6570\u636e\u3002\u67e5\u8be2\u8bed\u53e5\u652f\u6301\u57fa\u4e8e\u6807\u7b7e\u8fdb\u884c\u8fc7\u6ee4\u548c\u805a\u5408\u3002\u6807\u7b7e\u7684\u589e\u5220\u4e5f\u4ee3\u8868\u4e86\u65f6\u5e8f\u6570\u636e\u7684\u589e\u5220\u3002</p> <p>\u6807\u7b7e\u540d\u8981\u6c42\u5339\u914d<code>[a-zA-Z_][a-zA-Z0-9_]*</code>\uff0c\u4f46\u662f\u201c_\u201d\u5f00\u5934\u7684\u6807\u7b7e\u9884\u7559\u7ed9\u5185\u90e8\u4f7f\u7528\uff1b\u6807\u7b7e\u503c\u53ef\u4ee5\u5305\u542b\u4efb\u610fUnicode\u5b57\u7b26\u3002</p> <p>\u6837\u672c\uff08sample\uff09\uff1a</p> <p>\u6837\u672c\u662f\u65f6\u5e8f\u6570\u636e\u5728\u4e00\u4e2a\u65f6\u95f4\u70b9\u7684\u6570\u503c\uff0c\u662f\u65f6\u5e8f\u6570\u636e\u7684\u7ec4\u6210\u5143\u7d20\u3002\u6837\u672c\u5305\u542b\u4e00\u4e2afloat64\u7684\u6570\u503c\uff0c\u548c\u4e00\u4e2a\u6beb\u79d2\u7ea7\u7684\u65f6\u95f4\u6233\u3002</p> <p>\u683c\u5f0f\uff1a</p> <pre><code>&lt;metric name&gt;{&lt;label name&gt;=&lt;label value&gt;, ...}\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>api_http_requests_total{method=\"POST\", handler=\"/messages\"}\n</code></pre>"},{"location":"chap4/7Pro_interview/#2-2","title":"2-2 \u6307\u6807\u7c7b\u578b\uff1a","text":"<p>Prometheus\u5ba2\u6237\u7aef\u652f\u63014\u4e2d\u6570\u636e\u683c\u5f0f\u3002</p> <p>\u8ba1\u6570\u5668\uff08counter\uff09\uff1a</p> <p>\u8ba1\u6570\u5668\u662f\u4e00\u79cd\u7d2f\u52a0\u7684\u6307\u6807\uff0c\u7528\u6765\u8868\u793a\u53ea\u589e\u4e0d\u51cf\u7684\u6570\u636e\u3002\u9002\u7528\u4e8e\u8bb0\u5f55\u8bf7\u6c42\u6b21\u6570\u7b49\u6307\u6807\u3002</p> <p>\u4eea\u8868\u503c\uff08gauge\uff09\uff1a</p> <p>\u4eea\u8868\u503c\u8868\u793a\u6570\u503c\u53ef\u4ee5\u4efb\u610f\u589e\u51cf\u7684\u6307\u6807\uff0c\u9002\u7528\u4e8e\u8bb0\u5f55\u5185\u5b58\u4f7f\u7528\u7387\u7b49\u6307\u6807\u3002</p> <p>\u76f4\u65b9\u56fe\uff08histogram\uff09\uff1a</p> <p>\u76f4\u65b9\u56fe\u4e3b\u8981\u7528\u4e8e\u8868\u793a\u5728\u4e00\u6bb5\u65f6\u95f4\u8303\u56f4\u5185\u5bf9\u6570\u636e\u8fdb\u884c\u91c7\u6837\uff0c\u5e76\u5bf9\u6307\u5b9a\u533a\u95f4\u548c\u603b\u6570\u8fdb\u884c\u7edf\u8ba1\u3002\u901a\u5e38\u7528\u6765\u7edf\u8ba1\u8bf7\u6c42\u65f6\u95f4\u6216\u8005\u54cd\u5e94\u5927\u5c0f\u7b49\u6570\u636e\u3002</p> <p>\u76f4\u65b9\u56fe\u901a\u8fc7\u6307\u6807\u7684basename\u66b4\u9732\u4e00\u7cfb\u5217\u7684\u65f6\u5e8f\u6570\u636e\uff1a</p> <ol> <li>\u89c2\u5bdf\u503c\u5728\u89c2\u5bdf\u533a\u95f4\u7684\u8ba1\u6570\u503c\uff0c\u663e\u793a\u4e3a<code>&lt;basename&gt;_bucket{le=\"&lt;upper inclusive bound&gt;\"}</code>\u7684\u5f62\u5f0f\uff1b</li> <li>\u89c2\u5bdf\u503c\u7684\u6c47\u603b\u503c\uff0c\u663e\u793a\u4e3a<code>&lt;basename&gt;_sum</code>\uff1b</li> <li>\u89c2\u5bdf\u503c\u7684\u8ba1\u6570\u503c\uff0c\u663e\u793a\u4e3a<code>&lt;basename&gt;_count\uff0c\u7b49\u6548\u4e8e&lt;basename&gt;_bucket{le=\"+Inf\"}</code>\u3002</li> </ol> <p>\u4f7f\u7528<code>histo_quantile()</code>\u51fd\u6570\u53ef\u4ee5\u8ba1\u7b97\u76f4\u65b9\u56fe\u7684\u5206\u4f4d\u6570\u3002</p> <p>\u4ecePrometheus\u7684metrics\u8def\u5f84\u4e0b\uff0c\u53ef\u4ee5\u770b\u5230<code>Prometheus</code>\u4e2d\u7684\u6307\u6807\uff0c\u76f4\u65b9\u56fe\u793a\u4f8b\uff1a</p> <pre><code># HELP prometheus_http_response_size_bytes Histogram of response size for HTTP requests.\n# TYPE prometheus_http_response_size_bytes histogram\nprometheus_http_response_size_bytes_bucket{handler=\"/\",le=\"100\"} 1\nprometheus_http_response_size_bytes_bucket{handler=\"/\",le=\"1000\"} 1\nprometheus_http_response_size_bytes_bucket{handler=\"/\",le=\"10000\"} 1\nprometheus_http_response_size_bytes_bucket{handler=\"/\",le=\"100000\"} 1\nprometheus_http_response_size_bytes_bucket{handler=\"/\",le=\"1e+06\"} 1\nprometheus_http_response_size_bytes_bucket{handler=\"/\",le=\"1e+07\"} 1\nprometheus_http_response_size_bytes_bucket{handler=\"/\",le=\"1e+08\"} 1\nprometheus_http_response_size_bytes_bucket{handler=\"/\",le=\"1e+09\"} 1\nprometheus_http_response_size_bytes_bucket{handler=\"/\",le=\"+Inf\"} 1\nprometheus_http_response_size_bytes_sum{handler=\"/\"} 29\nprometheus_http_response_size_bytes_count{handler=\"/\"} 1\n</code></pre> <p>\u6982\u8981\uff08summary\uff09\uff1a</p> <p>\u6982\u8981\u548c\u76f4\u65b9\u56fe\u7c7b\u4f3c\uff0c\u4e5f\u662f\u4e00\u79cd\u603b\u7ed3\u6027\u7684\u89c2\u5bdf\u6837\u672c\uff0c\u4f8b\u5982\u8bf7\u6c42\u65f6\u95f4\u548c\u54cd\u5e94\u5927\u5c0f\u3002\u5b83\u9664\u4e86\u63d0\u4f9b\u89c2\u5bdf\u503c\u7684\u603b\u7684\u8ba1\u6570\u503c\u548c\u6c47\u603b\u503c\uff0c\u8fd8\u53ef\u4ee5\u8ba1\u7b97\u5206\u4f4d\u6570\u3002</p> <p>\u6982\u8981\u4e5f\u901a\u8fc7\u6307\u6807\u7684basename\u66b4\u9732\u4e00\u7cfb\u5217\u7684\u65f6\u5e8f\u6570\u636e\uff1a</p> <ol> <li>\u89c2\u5bdf\u503c\u7684\u4e2d\u4f4d\u6570\uff0c\u663e\u793a\u4e3a<code>&lt;basename&gt;{quantile=\"&lt;\u03c6&gt;\"}\uff0c(0 \u2264 \u03c6 \u2264 1)</code>\uff1b</li> <li>\u89c2\u5bdf\u503c\u7684\u6c47\u603b\u503c\uff0c\u663e\u793a\u4e3a<code>&lt;basename&gt;_sum</code>\uff1b</li> <li>\u89c2\u5bdf\u503c\u7684\u8ba1\u6570\u503c\uff0c\u663e\u793a\u4e3a<code>&lt;basename&gt;_count</code>\u3002</li> </ol> <p>\u793a\u4f8b\uff1a</p> <pre><code># HELP go_gc_duration_seconds A summary of the GC invocation durations.\n# TYPE go_gc_duration_seconds summary\ngo_gc_duration_seconds{quantile=\"0\"} 2.9743e-05\ngo_gc_duration_seconds{quantile=\"0.25\"} 6.9639e-05\ngo_gc_duration_seconds{quantile=\"0.5\"} 0.000105693\ngo_gc_duration_seconds{quantile=\"0.75\"} 0.000173332\ngo_gc_duration_seconds{quantile=\"1\"} 0.02720063\ngo_gc_duration_seconds_sum 0.083278187\ngo_gc_duration_seconds_count 346\n</code></pre>"},{"location":"chap4/7Pro_interview/#2-3-jobinstance","title":"2-3 Job\u548cInstance","text":"<p>\u4e00\u4e2a\u5355\u72ec\u7684\u6293\u53d6\u76ee\u6807\u662f\u4e00\u4e2aInstance\uff0c\u4e00\u7ec4\u76f8\u540c\u7c7b\u578b\u7684Instance\u7ec4\u6210\u4e00\u4e2ajob\u3002\u4f8b\u5982\uff1a</p> <p><code>job: api-server</code></p> <ul> <li>instance 1: 1.2.3.4:5670</li> <li>instance 2: 1.2.3.4:5671</li> <li>instance 3: 5.6.7.8:5670</li> <li>instance 4: 5.6.7.8:5671</li> </ul> <p>Prometheus\u6293\u53d6\u6307\u6807\u7684\u65f6\u5019\uff0c\u4f1a\u81ea\u52a8\u751f\u6210\u4e00\u4e9b\u6807\u7b7e\uff0c\u5305\u62ecjob\u548cinstance\u3002</p> <ul> <li><code>job</code>\uff1a\u914d\u7f6e\u6587\u4ef6\u4e2d\u8be5\u6293\u53d6\u76ee\u6807\u5f52\u5c5e\u7684job\u3002</li> <li><code>instance\uff1a&lt;host&gt;:&lt;port&gt;</code>\u5f62\u5f0f\u7684\u6293\u53d6\u76ee\u6807\u7684url\u3002</li> </ul> <p>\u5bf9\u4e8e\u6bcf\u4e2a\u6293\u53d6\u76ee\u6807\uff0cPrometheus\u4f1a\u81ea\u52a8\u751f\u6210\u4e00\u4e9b\u65f6\u5e8f\u6570\u636e\uff1a</p> <ul> <li><code>up{job=\"&lt;job-name&gt;\", instance=\"&lt;instance-id&gt;\"}</code>\uff1a\u5224\u65ad\u5b9e\u4f8b\u662f\u5426\u53ef\u7528\uff0c\u53ef\u7528\u4e3a1\uff0c\u4e0d\u53ef\u7528\u4e3a0\uff1b</li> <li><code>scrape_duration_seconds{job=\"&lt;job-name&gt;\", instance=\"&lt;instance-id&gt;\"}</code>\uff1a\u4ece\u8be5\u6570\u636e\u96c6\u6293\u53d6\u6570\u636e\u7684\u65f6\u95f4\u5f00\u9500\u3002</li> <li><code>scrape_samples_post_metric_relabeling{job=\"&lt;job-name&gt;\", instance=\"&lt;instance-id&gt;\"}</code>\uff1a\u8868\u793a\u91c7\u7528\u91cd\u5b9a\u4e49\u6807\u7b7e\u64cd\u4f5c\u540e\u4ecd\u7136\u5269\u4f59\u7684\u6837\u672c\u6570\u3002</li> <li><code>scrape_samples_scraped{job=\"&lt;job-name&gt;\", instance=\"&lt;instance-id&gt;\"}</code>\uff1a\u4ece\u8be5\u6570\u636e\u6e90\u6293\u53d6\u5230\u7684\u6837\u672c\u6570\u91cf\u3002</li> </ul>"},{"location":"chap4/7Pro_interview/#3","title":"3\u3001\u914d\u7f6e","text":"<p>Prometheus\u6709\u4e24\u79cd\u914d\u7f6e\u65b9\u5f0f\uff1a\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\u914d\u7f6e\uff0c\u4ee5\u53ca\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u914d\u7f6e\u3002</p> <p>\u547d\u4ee4\u884c\u53c2\u6570\u4e3b\u8981\u7528\u4e8e\u914d\u7f6e\u7cfb\u7edf\u53c2\u6570\uff08\u4f8b\u5982\uff1a\u5b58\u50a8\u4f4d\u7f6e\uff0c\u4fdd\u7559\u5728\u78c1\u76d8\u548c\u5185\u5b58\u4e2d\u7684\u6570\u636e\u91cf\u5927\u5c0f\u7b49\uff09\uff0c\u53ef\u4ee5\u901a\u8fc7<code>./prometheus -h</code>\u547d\u4ee4\u67e5\u770b\u5168\u90e8\u547d\u4ee4\u884c\u53c2\u6570\u3002</p> <p>\u914d\u7f6e\u6587\u4ef6\u5219\u7528\u6765\u5b9a\u4e49\u6293\u53d6\u76ee\u6807\u76f8\u5173\u7684\u4e00\u7cfb\u5217\u4fe1\u606f\uff0c\u5e76\u5236\u5b9a\u52a0\u8f7d\u7684rule\u6587\u4ef6\uff0c\u9ed8\u8ba4\u4e3a<code>prometheus.yml</code>\u6587\u4ef6\u3002</p> <p>\u5728<code>--web.enable-lifecycle</code>\u5f00\u542f\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u901a\u8fc7\u7ed9<code>Prometheus server</code>\u53d1\u9001<code>SIGHUP</code>\u6216\u8005\u5411<code>/-/reload</code>\u8def\u5f84\u53d1\u9001\u4e00\u6761HTTP post\u8bf7\u6c42\uff0c\u8ba9\u8fd0\u884c\u4e2d\u7684<code>Prometheus</code>\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\uff0c\u4ee5\u53ca\u914d\u7f6e\u7684rule\u6587\u4ef6\u3002</p> <p>\u5982\u4e0b\u4e3b\u8981\u63cf\u8ff0\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u3002</p>"},{"location":"chap4/7Pro_interview/#3-1","title":"3-1 \u5168\u5c40\u914d\u7f6e","text":"<p>global\u6807\u7b7e\u4e0b\u7684\u914d\u7f6e\uff0c\u4f1a\u4f5c\u7528\u5230\u6240\u6709\u7684\u6293\u53d6\u76ee\u6807\u3002\u67094\u79cd\u914d\u7f6e</p> <ul> <li><code>scrape_interval</code>\uff1a\u62c9\u53d6 targets\u7684\u9ed8\u8ba4\u65f6\u95f4\u95f4\u9694\u3002</li> <li><code>scrape_timeout</code>\uff1a\u62c9\u53d6\u4e00\u4e2a target \u7684\u8d85\u65f6\u65f6\u95f4\u3002</li> <li><code>evaluation_interval</code>\uff1a\u8bc4\u4f30rules\u7684\u65f6\u95f4\u95f4\u9694\u3002</li> <li><code>external_labels</code>\uff1a\u548c\u5916\u90e8\u7cfb\u7edf\u4ea4\u6d41\u65f6\uff0c\u6dfb\u52a0\u5230\u6570\u636e\u4e2d\u7684\u6807\u7b7e\u3002</li> </ul> <p>\u683c\u5f0f\u548c\u9ed8\u8ba4\u503c\uff1a</p> <pre><code>global:\n  # How frequently to scrape targets by default.\n  [ scrape_interval: &lt;duration&gt; | default = 1m ]\n\n  # How long until a scrape request times out.\n  [ scrape_timeout: &lt;duration&gt; | default = 10s ]\n\n  # How frequently to evaluate rules.\n  [ evaluation_interval: &lt;duration&gt; | default = 1m ]\n\n  # The labels to add to any time series or alerts when communicating with\n  # external systems (federation, remote storage, Alertmanager).\n  external_labels:\n    [ &lt;labelname&gt;: &lt;labelvalue&gt; ... ]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>global:\n  scrape_interval: 15s\n  scrape_timeout: 10s\n  evaluation_interval: 15s\n</code></pre>"},{"location":"chap4/7Pro_interview/#3-2","title":"3-2 \u89c4\u5219\u6587\u4ef6\u914d\u7f6e","text":"<p><code>rule_files</code>\u6807\u7b7e\u4e0b\u7684\u914d\u7f6e\uff0c\u5b83\u6307\u5b9a\u4e86\u4e00\u7cfb\u5217\u7684rules \u6587\u4ef6\u3002</p> <p>\u683c\u5f0f\uff1a</p> <pre><code># Rule files specifies a list of globs. Rules and alerts are read from\n# all matching files.\nrule_files:\n  [ - &lt;filepath_glob&gt; ... ]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>rule_files:\n  - \"rules/simple.rules\"\n  - \"rules/rules/*.rules\"\n</code></pre>"},{"location":"chap4/7Pro_interview/#3-3","title":"3-3 \u6293\u53d6\u914d\u7f6e","text":"<p><code>scrape_configs</code>\u8282\u70b9\u4e0b\u7684\u914d\u7f6e\u3002\u4e3b\u8981\u7528\u6765\u914d\u7f6e\u62c9\u53d6\u7684\u6570\u636e\u3002</p> <p>\u683c\u5f0f\uff1a</p> <pre><code># A list of scrape configurations.\nscrape_configs:\n  [ - &lt;scrape_config&gt; ... ]\n</code></pre> <p><code>scrape_config</code>\uff1a</p> <p><code>scrape_config</code>\u4e2d\u5305\u542b\u5982\u4e0b\u6807\u7b7e\uff1a</p> <ul> <li><code>job_name</code>\uff1a\u4efb\u52a1\u540d\u79f0</li> <li><code>honor_labels</code>\uff1a \u7528\u4e8e\u89e3\u51b3\u62c9\u53d6\u7684\u6570\u636e\u4e2d\u6807\u7b7e\u548c\u670d\u52a1\u7aef\u4fa7\u6807\u7b7e\uff08Prometheus\u81ea\u52a8\u751f\u6210\u7684job\u548cinstance\uff09\u6709\u51b2\u7a81\u7684\u60c5\u51b5\u3002\u5f53\u8bbe\u7f6e\u4e3a true, \u4ee5\u62c9\u53d6\u6570\u636e\u4e2d\u7684\u6807\u7b7e\u4e3a\u51c6\uff0c\u5ffd\u7565\u670d\u52a1\u5668\u7aef\u914d\u7f6e\u7684\u6807\u7b7e\uff1b\u8bbe\u7f6e\u4e3afalse\u5219\u6807\u7b7e\u4ee5\u670d\u52a1\u914d\u7f6e\u4e3a\u51c6\uff0c\u5e76\u5c06\u6293\u53d6\u6570\u636e\u4e2d\u7684\u6807\u7b7e\u91cd\u547d\u540d\u4e3a<code>exported_&lt;original-label&gt;</code>\uff0c\u4f8b\u5982exported_instance\u3002\u5f53\u7136\uff0c\u5168\u5c40\u914d\u7f6e\u4e2d\u7684external_labels\u4e0d\u53d7\u6b64\u6807\u7b7e\u7684\u5f71\u54cd\uff0cexternal_labels\u53ea\u5728\u65f6\u5e8f\u6570\u636e\u6ca1\u6709external_labels\u4e2d\u914d\u7f6e\u7684\u6807\u7b7e\u7684\u60c5\u51b5\u4e0b\uff0c\u624d\u4f1a\u751f\u6548\u3002honor_labels\u7684\u9ed8\u8ba4\u503c\u4e3afalse\u3002</li> <li>params\uff1a\u6570\u636e\u62c9\u53d6\u8bbf\u95ee\u65f6\u5e26\u7684\u8bf7\u6c42\u53c2\u6570</li> <li><code>scrape_interval</code>\uff1a \u62c9\u53d6\u65f6\u95f4\u95f4\u9694</li> <li><code>scrape_timeout</code>: \u62c9\u53d6\u8d85\u65f6\u65f6\u95f4</li> <li><code>metrics_path</code>\uff1a \u62c9\u53d6\u8282\u70b9\u7684 metric \u8def\u5f84</li> <li><code>scheme</code>\uff1a \u62c9\u53d6\u6570\u636e\u8bbf\u95ee\u534f\u8bae</li> <li><code>sample_limit</code>\uff1a \u88ab\u6293\u53d6\u6570\u636e\u7684\u6807\u7b7e\u4e2a\u6570\u9650\u5236\u3002\u5982\u679c\u6307\u6807\u7684\u6807\u7b7e\u5728relabel\u4e4b\u540e\u8d85\u8fc7\u9650\u5236\uff08\u5927\u4e8e\u6216\u7b49\u4e8e\u9650\u5236\u503c\uff09\uff0c\u8be5\u6570\u636e\u5c06\u88ab\u5ffd\u7565\uff0c\u4e0d\u5165\u5b58\u50a8\uff1b\u9ed8\u8ba4\u503c\u4e3a0\uff0c\u8868\u793a\u6ca1\u6709\u9650\u5236</li> <li><code>relabel_configs</code>\uff1a \u62c9\u53d6\u6570\u636e\u91cd\u7f6e\u6807\u7b7e\u914d\u7f6e</li> <li><code>metric_relabel_configs</code>\uff1ametric\u91cd\u7f6e\u6807\u7b7e\u914d\u7f6e</li> </ul> <p>\u793a\u4f8b\uff1a</p> <pre><code>\nscrape_configs:\n- job_name: node\n  metrics_path: /metrics\n  scheme: http\n  static_configs:\n  - targets:\n    - 10.1.204.109:9100\n    labels:\n      instance: service1\n  - targets:\n    - 10.1.205.235:9100\n    labels:\n      instance: private\n- job_name: consul-knowledge\n  metrics_path: /actuator/prometheus\n  scheme: http\n  consul_sd_configs:\n  - server: 10.1.204.79:8500\n    tag_separator: ','\n    scheme: http\n    allow_stale: true\n    refresh_interval: 30s\n    services:\n    - knowledge-service\n    - gateway-service\n</code></pre> <p>\u5b8c\u6574\u7684<code>scrape_configs</code>\u7684\u914d\u7f6e\u53c2\u8003\u5b98\u7f51\uff1a<code>scrape_config</code></p>"},{"location":"chap4/7Pro_interview/#3-4","title":"3-4 \u544a\u8b66\u914d\u7f6e","text":"<p>alerting\u8282\u70b9\u4e0b\u7684\u914d\u7f6e\uff0c\u7528\u6765\u6307\u5b9aAlertmanager\u76f8\u5173\u7684\u914d\u7f6e\u3002</p> <p>\u683c\u5f0f\u548c\u5305\u542b\u7684\u6807\u7b7e\uff1a</p> <pre><code># Alerting specifies settings related to the Alertmanager.\nalerting:\n  alert_relabel_configs:\n    [ - &lt;relabel_config&gt; ... ]\n  alertmanagers:\n    [ - &lt;alertmanager_config&gt; ... ]\n</code></pre>"},{"location":"chap4/7Pro_interview/#3-5","title":"3-5 \u8fdc\u7a0b\u8bfb\u5199\u914d\u7f6e","text":"<p><code>remote_write</code>\u8282\u70b9\u4e3b\u8981\u7528\u4e8e\u53ef\u5199\u8fdc\u7a0b\u5b58\u50a8\u914d\u7f6e\uff0c\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u53c2\u6570\uff1a</p> <ul> <li>url: \u8bbf\u95ee\u5730\u5740</li> <li><code>remote_timeout</code>: \u8bf7\u6c42\u8d85\u65f6\u65f6\u95f4</li> <li><code>write_relabel_configs</code>: \u6807\u7b7e\u91cd\u7f6e\u914d\u7f6e, \u62c9\u53d6\u5230\u7684\u6570\u636e\uff0c\u7ecf\u8fc7\u91cd\u7f6e\u5904\u7406\u540e\uff0c\u53d1\u9001\u7ed9\u8fdc\u7a0b\u5b58\u50a8</li> </ul> <p><code>remote_read</code>\u8282\u70b9\u4e3b\u8981\u7528\u4e8e\u53ef\u8bfb\u8fdc\u7a0b\u5b58\u50a8\u914d\u7f6e\uff0c\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u53c2\u6570\uff1a</p> <ul> <li>url: \u8bbf\u95ee\u5730\u5740</li> <li><code>remote_timeout</code>: \u8bf7\u6c42\u8d85\u65f6\u65f6\u95f4</li> </ul> <p>\u8be6\u7ec6\u7684\u6807\u7b7e\u4fe1\u606f\u53c2\u8003\u5b98\u7f51\uff1ahttps://prometheus.io/docs/prometheus/latest/configuration/configuration/#remote_write</p>"},{"location":"chap4/7Pro_interview/#4","title":"4\u3001\u544a\u8b66\u6a21\u5757","text":"<p>\u544a\u8b66\u6a21\u5757\u5206\u4e3a\u4e24\u90e8\u5206\u3002Prometheus Server\u4e2d\u7684\u544a\u8b66\u89c4\u5219\u7528\u6765\u7ed9Alertmanager\u53d1\u9001\u544a\u8b66\uff1bAlertmanager\u8d1f\u8d23\u7ba1\u7406\u544a\u8b66\uff0c\u5305\u62ec\u544a\u8b66\u7684\u6c89\u9ed8\u3001\u6291\u5236\u3001\u6c47\u805a\u4ee5\u53ca\u901a\u8fc7\u90ae\u4ef6\u3001PagerDuty\u6216HipChat\u7b49\u65b9\u5f0f\u6765\u53d1\u9001\u544a\u8b66\u3002</p> <p>\u521b\u5efa\u544a\u8b66\u53ca\u63d0\u793a\u7684\u4e3b\u8981\u6d41\u7a0b\uff1a</p> <ol> <li>\u521b\u5efa\u5e76\u914d\u7f6eAlertmanager\uff1b</li> <li>\u5efa\u7acbPrometheus\u548cAlertmanager\u7684\u8054\u7cfb\uff1b</li> <li>\u5728Prometheus\u521b\u5efa\u544a\u8b66\u89c4\u5219\u3002</li> </ol>"},{"location":"chap4/7Pro_interview/#4-1-alertmanager","title":"4-1 Alertmanager","text":"<p>Alertmanager\u7528\u4e8e\u63a5\u53d7\u548c\u5904\u7406\u5ba2\u6237\u7aef\u53d1\u6765\u7684\u544a\u8b66\u6d88\u606f\uff0c\u4f8b\u5982Prometheus server\u53d1\u9001\u7684\u544a\u8b66\u3002\u5b83\u4e3b\u8981\u8d1f\u8d23\u544a\u8b66\u6d88\u606f\u7684\u53bb\u91cd\u3001\u5206\u7ec4\u3001\u8def\u7531\uff0c\u4ee5\u53ca\u6c89\u9ed8\u548c\u6d88\u9664\u544a\u8b66\u3002Alertmanager\u5728Prometheus\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u914d\u7f6e\u3002</p> <p>\u5206\u7ec4Grouping\uff1a</p> <p>\u5206\u7ec4\u529f\u80fd\u662f\u628a\u5177\u6709\u76f8\u4f3c\u884c\u653f\u7684\u544a\u8b66\u5f52\u7c7b\u5230\u4e00\u4e2a\u901a\u77e5\u4e2d\u3002\u8fd9\u4e2a\u529f\u80fd\u5728\u53d1\u751f\u505c\u7535\u3001\u65ad\u7f51\u4e4b\u7c7b\u7684\u4e8b\u6545\uff0c\u5bfc\u81f4\u5f88\u591a\u7cfb\u7edf\u540c\u65f6\u6545\u969c\u3001\u51fa\u73b0\u5927\u91cf\u544a\u8b66\u7684\u60c5\u51b5\u4e0b\uff0c\u4f5c\u7528\u975e\u5e38\u663e\u8457\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7528\u6237\u53ef\u4ee5\u5bf9\u544a\u8b66\u6309\u96c6\u7fa4\u6216\u8005\u544a\u8b66\u540d\u5b57\u5206\u7ec4\uff0c\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6536\u5230\u5927\u91cf\u91cd\u590d\u7684\u544a\u8b66\u6d88\u606f\u3002</p> <p>\u8b66\u62a5\u5206\u7ec4\uff0c\u5206\u7ec4\u901a\u77e5\u7684\u65f6\u95f4\uff0c\u548c\u901a\u77e5\u7684\u63a5\u53d7\u8005\u662f\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u7531\u4e00\u4e2a\u8def\u7531\u6811\u914d\u7f6e\u7684\u3002</p> <p>\u6291\u5236Inhibition\uff1a</p> <p>\u6291\u5236\u529f\u80fd\u7528\u6765\u5728\u4e00\u4e9b\u7279\u5b9a\u544a\u8b66\u5df2\u7ecf\u4ea7\u751f\u7684\u60c5\u51b5\u4e0b\uff0c\u6291\u5236\u53e6\u5916\u4e00\u4e9b\u7279\u5b9a\u544a\u8b66\u7684\u901a\u77e5\u3002\u4f8b\u5982\u4e00\u4e2a\u901a\u77e5\u96c6\u7fa4\u4e0d\u53ef\u7528\u7684\u544a\u8b66\u89e6\u53d1\u7684\u65f6\u5019\uff0c\u5176\u4ed6\u7684\u5173\u4e8e\u8fd9\u4e2a\u544a\u8b66\u4e2d\u7684\u670d\u52a1\u6216\u8005\u673a\u5668\u4e0d\u53ef\u7528\u7684\u544a\u8b66\u5c31\u53ef\u4ee5\u88ab\u6291\u5236\u3002</p> <p>\u6c89\u9ed8Silences\uff1a</p> <p>\u6c89\u9ed8\u7528\u6765\u8bbe\u7f6e\u5728\u7ed9\u5b9a\u65f6\u95f4\u5185\u5ffd\u7565\u544a\u8b66\u3002\u6c89\u9ed8\u529f\u80fd\u662f\u5728matchers\u4e2d\u8fdb\u884c\u914d\u7f6e\u7684\uff0c\u548c\u8def\u6709\u6811\u76f8\u4f3c\u3002\u63a5\u53d7\u5230\u7684\u544a\u8b66\u4f1a\u88ab\u68c0\u67e5\u662f\u5426\u548c\u6d3b\u8dc3\u7684slience\u76f8\u7b49\u6216\u8005\u76f8\u5339\u914d\uff0c\u5982\u679c\u662f\u7684\u8bdd\u8fd9\u4e9b\u544a\u8b66\u4e0d\u4f1a\u53d1\u9001\u901a\u77e5\u3002</p>"},{"location":"chap4/7Pro_interview/#5","title":"5\u3001\u67e5\u8be2","text":""},{"location":"chap4/7Pro_interview/#5-1","title":"5-1 \u6570\u636e\u7c7b\u578b","text":"<ul> <li>\u77ac\u65f6\u5411\u91cf\uff1a\u4f8b\u5982<code>http_request_total</code></li> <li>\u8303\u56f4\u5411\u91cf\uff1a\u4f8b\u5982\uff1a<code>http_request_total[5m]</code>\u3002\u65f6\u95f4\u5355\u4f4d\uff1a[s,m,h,d,w,y]</li> <li>\u6807\u91cf\uff1a\u4f8b\u5982\uff1a\u51fd\u6570up\u7684\u503c</li> <li>\u5b57\u7b26\u4e32\uff1a\u6682\u672a\u542f\u7528</li> </ul>"},{"location":"chap4/7Pro_interview/#5-2","title":"5-2 \u64cd\u4f5c\u7b26","text":"<p>\u4e8c\u5143\u64cd\u4f5c\u7b26\uff1a</p> <ul> <li>\u7b97\u672f\u4e8c\u5143\u8fd0\u7b97\u7b26\uff1a<code>+, -, *, /, %, ^</code></li> <li>\u6bd4\u8f83\u4e8c\u5143\u64cd\u4f5c\u7b26\uff1a<code>==, !=, &gt;, &lt;, &gt;=, &lt;=</code></li> <li>\u903b\u8f91/\u96c6\u5408\u4e8c\u5143\u64cd\u4f5c\u7b26\uff1a<code>and, or, unless</code></li> </ul> <p>\u805a\u5408\u64cd\u4f5c\u7b26\uff1a</p> <ul> <li>sum \uff0cmax \uff0cmin \uff0cavg\uff0cstddev (\u6c42\u6807\u51c6\u5dee)\uff0cstdvar (\u6c42\u65b9\u5dee)\uff0c</li> <li>count \uff0c<code>count_values</code> (\u7edf\u8ba1\u76f8\u540c\u6570\u636e\u503c\u7684\u5143\u7d20\u6570\u91cf)\uff0cbottomk (\u6837\u672c\u503c\u7b2ck\u4e2a\u6700\u5c0f\u503c)\uff0c</li> <li>topk (\u6837\u672c\u503c\u7b2ck\u4e2a\u6700\u5927\u503c)\uff0cquantile (\u7edf\u8ba1\u5206\u4f4d\u6570)</li> </ul> <p>\u4e8c\u5143\u8fd0\u7b97\u7b26\u7684\u4f18\u5148\u7ea7\uff1a</p> <p>\u4e8c\u5143\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u4ece\u9ad8\u5230\u4f4e\uff1a</p> <ul> <li>^</li> <li>*, /, %</li> <li>+, -</li> <li>==, !=, &lt;=, &lt;, &gt;=, &gt;</li> <li>and, unless</li> <li>or</li> </ul>"},{"location":"chap4/7Pro_interview/#5-3","title":"5-3 \u51fd\u6570","text":"<p>\u53c2\u6570\u8fc7\u591a\uff0c\u8be6\u60c5\u53c2\u8003\u5b98\u65b9\u6587\u6863\uff1aPrometheus-Functions</p> <p>\u793a\u4f8b\uff1a</p> <ul> <li><code>increase(v range-vector)</code>\uff1av\u662f\u53c2\u6570\u503c\uff0crange-vector\u662f\u53c2\u6570\u7c7b\u578b\uff0c\u4f8b\u5982\uff1a<code>increase(http_request_total{job=\u201dprometheus\u201d}[1m])</code></li> <li><code>year(v=vector(time()) instant-vector)</code>\uff1avector(time())\u8868\u793a\u9ed8\u8ba4\u503c\uff0c\u6709\u9ed8\u8ba4\u503c\u7684\u51fd\u6570\u53ef\u4ee5\u4e0d\u4f20\u53c2\u6570</li> </ul>"},{"location":"chap4/7Pro_interview/#6prometheus","title":"6\u3001prometheus\u4e4b\u9762\u8bd5\u9898","text":""},{"location":"chap4/7Pro_interview/#6-1","title":"6-1 \u5168\u5c40\u914d\u7f6e","text":"<p>global\u6807\u7b7e\u4e0b\u7684\u914d\u7f6e\uff0c\u4f1a\u4f5c\u7528\u5230\u6240\u6709\u7684\u6293\u53d6\u76ee\u6807\u3002\u67094\u79cd\u914d\u7f6e</p> <ul> <li><code>scrape_interval</code>\uff1a\u62c9\u53d6 targets\u7684\u9ed8\u8ba4\u65f6\u95f4\u95f4\u9694\u3002</li> <li><code>scrape_timeout</code>\uff1a\u62c9\u53d6\u4e00\u4e2a target \u7684\u8d85\u65f6\u65f6\u95f4\u3002</li> <li><code>evaluation_interval</code>\uff1a\u8bc4\u4f30rules\u7684\u65f6\u95f4\u95f4\u9694\u3002</li> <li><code>external_labels</code>\uff1a\u548c\u5916\u90e8\u7cfb\u7edf\u4ea4\u6d41\u65f6\uff0c\u6dfb\u52a0\u5230\u6570\u636e\u4e2d\u7684\u6807\u7b7e\u3002</li> </ul> <pre><code>global:\n  scrape_interval: 15s\n  scrape_timeout: 10s\n  evaluation_interval: 15s\u3000\n</code></pre>"},{"location":"chap4/7Pro_interview/#6-2","title":"6-2 \u89c4\u5219\u6587\u4ef6\u914d\u7f6e","text":"<p><code>rule_files</code> \u6807\u7b7e\u4e0b\u7684\u914d\u7f6e\uff0c\u5b83\u6307\u5b9a\u4e86\u4e00\u7cfb\u5217\u7684rules \u6587\u4ef6\u3002</p> <pre><code>rule_files:\n  - \"rules/simple.rules\"\n  - \"rules/rules/*.rules\"\n</code></pre>"},{"location":"chap4/7Pro_interview/#6-3","title":"6-3 \u6293\u53d6\u914d\u7f6e","text":"<p><code>scrape_configs</code>\u8282\u70b9\u4e0b\u7684\u914d\u7f6e\u3002\u4e3b\u8981\u7528\u6765\u914d\u7f6e\u62c9\u53d6\u7684\u6570\u636e\u3002\u3001</p> <pre><code>scrape_configs:\n- job_name: node\n  metrics_path: /metrics\n  scheme: http\n  static_configs:\n  - targets:\n    - 10.1.204.109:9100\n    labels:\n      instance: service1\n  - targets:\n    - 10.1.205.235:9100\n    labels:\n      instance: private\n- job_name: consul-knowledge\n  metrics_path: /actuator/prometheus\n  scheme: http\n  consul_sd_configs:\n  - server: 10.1.204.79:8500\n    tag_separator: ','\n    scheme: http\n    allow_stale: true\n    refresh_interval: 30s\n    services:\n    - knowledge-service\n    - gateway-service\n</code></pre>"},{"location":"chap4/7Pro_interview/#6-4","title":"6-4 \u544a\u8b66\u914d\u7f6e","text":"<p>alerting\u8282\u70b9\u4e0b\u7684\u914d\u7f6e\uff0c\u7528\u6765\u6307\u5b9aAlertmanager\u76f8\u5173\u7684\u914d\u7f6e\u3002</p> <pre><code># Alerting specifies settings related to the Alertmanager.\nalerting:\n  alert_relabel_configs:\n    [ - &lt;relabel_config&gt; ... ]\n  alertmanagers:\n    [ - &lt;alertmanager_config&gt; ... ]\n</code></pre>"},{"location":"chap4/7Pro_interview/#6-5","title":"6-5 \u670d\u52a1\u53d1\u73b0\u914d\u7f6e","text":"<p>prometheus\u670d\u52a1\u53d1\u73b0\uff1a</p> <pre><code>- job_name: kubernetes-nodes\nkubernetes_sd_configs:\n- role: node\n</code></pre>"},{"location":"chap4/7Pro_interview/#6-6-prometheus","title":"6-6 prometheus\u70ed\u66f4\u65b0\uff1a","text":"<p><code>curl -X POST \u201chttp://10.102.74.90:9000/-/reload\u201d</code></p>"},{"location":"chap4/8Data_ana_interview1/","title":"L8 Data Analyst Interview","text":""},{"location":"chap4/8Data_ana_interview1/#1what-are-the-important-responsibilities-of-a-data-analyst","title":"1\u3001What are the important responsibilities of a data analyst?","text":"<ul> <li>Collect and interpret data from multiple sources and analyze results.</li> <li>Filter and \u201cclean\u201d data gathered from multiple sources.</li> <li>Offer support to every aspect of data analysis.</li> <li>Analyze complex datasets and identify the hidden patterns in them.</li> <li>Keep databases secured.</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#2what-does-data-cleansing-mean-what-are-the-best-ways-to-practice-this","title":"2\u3001What does \u201cData Cleansing\u201d mean? What are the best ways to practice this?","text":"<p>The best ways to clean data are:</p> <ul> <li>Segregating data, according to their respective attributes.</li> <li>Breaking large chunks of data into small datasets and then cleaning them.</li> <li>Analyzing the statistics of each data column.</li> <li>Creating a set of utility functions or scripts for dealing with common cleaning tasks.</li> <li>Keeping track of all the data cleansing operations to facilitate easy addition or removal from the datasets, if required.</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#3-name-the-best-tools-used-for-data-analysis","title":"3\u3001 Name the best tools used for data analysis.","text":"<ul> <li>Tableau</li> <li>Google Fusion Tables</li> <li>Google Search Operators</li> <li>KNIME</li> <li>RapidMiner</li> <li>Solver</li> <li>OpenRefine</li> <li>NodeXL</li> <li>io</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#4what-is-the-difference-between-data-profiling-and-data-mining","title":"4\u3001What is the difference between data profiling and data mining?","text":"<p>Data Profiling focuses on analyzing individual attributes of data, thereby providing valuable information on data attributes such as data type, frequency, length, along with their discrete values and value ranges. </p> <p>On the contrary, data mining aims to identify unusual records, analyze data clusters, and sequence discovery, to name a few.</p>"},{"location":"chap4/8Data_ana_interview1/#5what-is-knn-imputation-method","title":"5\u3001What is KNN imputation method?","text":"<p>KNN imputation method seeks to impute the values of the missing attributes using those attribute values that are nearest to the missing attribute values.</p> <p>The similarity between two attribute values is determined using the distance function.</p>"},{"location":"chap4/8Data_ana_interview1/#6what-should-a-data-analyst-do-with-missing-or-suspected-data","title":"6\u3001What should a data analyst do with missing or suspected data?","text":"<ul> <li>Use data analysis strategies like deletion method, single imputation methods, and model-based methods to detect missing data.</li> <li>Prepare a validation report containing all information about the suspected or missing data.</li> <li>Scrutinize the suspicious data to assess their validity.</li> <li>Replace all the invalid data (if any) with a proper validation code.</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#7-name-the-different-data-validation-methods-used-by-data-analysts","title":"7. Name the different data validation methods used by data analysts.","text":"<ul> <li>Field Level Validation \u2013 In this method, data validation is done in each field as and when a user enters the data. It helps to correct the errors as you go.</li> <li>Form Level Validation \u2013 In this method, the data is validated after the user completes the form and submits it. It checks the entire data entry form at once, validates all the fields in it, and highlights the errors (if any) so that the user can correct it. </li> <li>Data Saving Validation \u2013 This data validation technique is used during the process of saving an actual file or database record. Usually, it is done when multiple data entry forms must be validated. </li> <li>Search Criteria Validation \u2013 This validation technique is used to offer the user accurate and related matches for their searched keywords or phrases. The main purpose of this validation method is to ensure that the user\u2019s search queries can return the most relevant results.</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#8-define-outlier","title":"8. Define Outlier","text":"<p>There are two kinds of outliers \u2013 Univariate and Multivariate.</p> <p>The two methods used for detecting outliers are:</p> <ul> <li>Box plot method \u2013 According to this method, if the value is higher or lesser than <code>1.5*IQR</code> (interquartile range), such that it lies above the upper quartile (Q3) or below the lower quartile (Q1), the value is an outlier.</li> <li>Standard deviation method \u2013 This method states that if a value is higher or lower than mean <code>\u00b1 (3*standard deviation)</code>, it is an outlier.</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#9-what-is-clustering-name-the-properties-of-clustering-algorithms","title":"9. What is \u201cClustering?\u201d Name the properties of clustering algorithms.","text":"<p>Clustering is a method in which data is classified into clusters and groups. A clustering algorithm has the following properties:</p> <ul> <li>Hierarchical or flat</li> <li>Hard and soft</li> <li>Iterative</li> <li>Disjunctive</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#10-what-is-k-mean-algorithm","title":"10. What is K-mean Algorithm?","text":"<p>K-mean is a partitioning technique in which objects are categorized into K groups. </p> <p>In this algorithm, the clusters are spherical with the data points are aligned around that cluster, and the variance of the clusters is similar to one another.</p>"},{"location":"chap4/8Data_ana_interview1/#11-define-collaborative-filtering","title":"11. Define \u201cCollaborative Filtering\u201d.","text":"<p>Collaborative filtering is an algorithm that creates a recommendation system based on the behavioral data of a user. </p> <p>For instance, online shopping sites usually compile a list of items under \u201crecommended for you\u201d based on your browsing history and previous purchases. The crucial components of this algorithm include users, objects, and their interest.</p>"},{"location":"chap4/8Data_ana_interview1/#12-name-the-statistical-methods-that-are-highly-beneficial-for-data-analysts","title":"12. Name the statistical methods that are highly beneficial for data analysts?","text":"<p>The statistical methods that are mostly used by data analysts are:</p> <ul> <li>Bayesian method</li> <li>Markov process</li> <li>Simplex algorithm</li> <li>Imputation</li> <li>Spatial and cluster processes</li> <li>Rank statistics, percentile, outliers detection</li> <li>Mathematical optimization</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#13-what-is-an-n-gram","title":"13. What is an N-gram?","text":"<p>An n-gram is a connected sequence of n items in a given text or speech. </p> <p>Precisely, an N-gram is a probabilistic language model used to predict the next item in a particular sequence, as in <code>(n-1)</code>.</p>"},{"location":"chap4/8Data_ana_interview1/#14-what-is-a-hash-table-collision-how-can-it-be-prevented","title":"14. What is a hash table collision? How can it be prevented?","text":"<p>When two separate keys hash to a common value, a hash table collision occurs. This means that two different data cannot be stored in the same slot.</p> <p>Hash collisions can be avoided by:</p> <ul> <li>Separate chaining \u2013 In this method, a data structure is used to store multiple items hashing to a common slot.</li> <li>Open addressing \u2013 This method seeks out empty slots and stores the item in the first empty slot available.</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#15-define-time-series-analysis","title":"15. Define \u201cTime Series Analysis\u201d.","text":"<p>Series analysis can usually be performed in two domains \u2013 time domain and frequency domain.</p> <p>Time series analysis is the method where the output forecast of a process is done by analyzing the data collected in the past using techniques like exponential smoothening, log-linear regression method, etc.</p>"},{"location":"chap4/8Data_ana_interview1/#16-how-should-you-tackle-multi-source-problems","title":"16. How should you tackle multi-source problems?","text":"<ul> <li>Identify similar data records and combine them into one record that will contain all the useful attributes, minus the redundancy.</li> <li>Facilitate schema integration through schema restructuring.</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#17-mention-the-steps-of-a-data-analysis-project","title":"17. Mention the steps of a Data Analysis project.","text":"<ul> <li>The foremost requirement of a Data Analysis project is an in-depth understanding of the business requirements. </li> <li>The second step is to identify the most relevant data sources that best fit the business requirements and obtain the data from reliable and verified sources. </li> <li>The third step involves exploring the datasets, cleaning the data, and organizing the same to gain a better understanding of the data at hand. </li> <li>In the fourth step, Data Analysts must validate the data.</li> <li>The fifth step involves implementing and tracking the datasets.</li> <li>The final step is to create a list of the most probable outcomes and iterate until the desired results are accomplished.</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#18-what-are-the-problems-that-a-data-analyst-can-encounter-while-performing-data-analysis","title":"18. What are the problems that a Data Analyst can encounter while performing data analysis?","text":"<ul> <li>Presence of duplicate entries and spelling mistakes. These errors can hamper data quality.</li> <li>Poor quality data acquired from unreliable sources. In such a case, a Data Analyst will have to spend a significant amount of time in cleansing the data. </li> <li>Data extracted from multiple sources may vary in representation. Once the collected data is combined after being cleansed and organized, the variations in data representation may cause a delay in the analysis process.</li> <li>Incomplete data is another major challenge in the data analysis process. It would inevitably lead to erroneous or faulty results. </li> </ul>"},{"location":"chap4/8Data_ana_interview1/#19-what-are-the-characteristics-of-a-good-data-model","title":"19. What are the characteristics of a good data model?","text":"<ul> <li>It should have predictable performance so that the outcomes can be estimated accurately, or at least, with near accuracy.</li> <li>It should be adaptive and responsive to changes so that it can accommodate the growing business needs from time to time. </li> <li>It should be capable of scaling in proportion to the changes in data. </li> <li>It should be consumable to allow clients/customers to reap tangible and profitable results.</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#20-differentiate-between-variance-and-covariance","title":"20. Differentiate between variance and covariance.","text":"<p>Variance and covariance are both statistical terms. </p> <p>Variance depicts how distant two numbers (quantities) are in relation to the mean value. So, you will only know the magnitude of the relationship between the two quantities (how much the data is spread around the mean). </p> <p>On the contrary, covariance depicts how two random variables will change together. </p> <p>Thus, covariance gives both the direction and magnitude of how two quantities vary with respect to each other.</p>"},{"location":"chap4/8Data_ana_interview1/#21-explain-normal-distribution","title":"21. Explain \u201cNormal Distribution.\u201d","text":"<p>Normal distribution, better known as the Bell Curve or Gaussian curve, refers to a probability function that describes and measures how the values of a variable are distributed, that is, how they differ in their means and their standard deviations. </p> <p>In the curve, the distribution is symmetric. While most of the observations cluster around the central peak, probabilities for the values steer further away from the mean, tapering off equally in both directions.</p>"},{"location":"chap4/8Data_ana_interview1/#22-explain-univariate-bivariate-and-multivariate-analysis","title":"22. Explain univariate, bivariate, and multivariate analysis.","text":"<p>Univariate analysis refers to a descriptive statistical technique that is applied to datasets containing a single variable. The univariate analysis considers the range of values and also the central tendency of the values. </p> <p>Bivariate analysis simultaneously analyzes two variables to explore the possibilities of an empirical relationship between them. It tries to determine if there is an association between the two variables and the strength of the association, or if there are any differences between the variables and what is the importance of these differences.  </p> <p>Multivariate analysis is an extension of bivariate analysis. Based on the principles of multivariate statistics, the multivariate analysis observes and analyzes multiple variables (two or more independent variables) simultaneously to predict the value of a dependent variable for the individual subjects.</p>"},{"location":"chap4/8Data_ana_interview1/#23-explain-the-difference-between-r-squared-and-adjusted-r-squared","title":"23. Explain the difference between R-Squared and Adjusted R-Squared.","text":"<p>The R-Squared technique is a statistical measure of the proportion of variation in the dependent variables, as explained by the independent variables. </p> <p>The Adjusted R-Squared is essentially a modified version of R-squared, adjusted for the number of predictors in a model. It provides the percentage of variation explained by the specific independent variables that have a direct impact on the dependent variables.</p>"},{"location":"chap4/8Data_ana_interview1/#24-what-are-the-advantages-of-version-control","title":"24. What are the advantages of version control?","text":"<ul> <li>It allows you to compare files, identify differences, and consolidate the changes seamlessly. </li> <li>It helps to keep track of application builds by identifying which version is under which category \u2013 development, testing, QA, and production.</li> <li>It maintains a complete history of project files that comes in handy if ever there\u2019s a central server breakdown.</li> <li>It is excellent for storing and maintaining multiple versions and variants of code files securely.</li> <li>It allows you to see the changes made in the content of different files.</li> </ul>"},{"location":"chap4/8Data_ana_interview1/#25-how-can-a-data-analyst-highlight-cells-containing-negative-values-in-an-excel-sheet","title":"25. How can a Data Analyst highlight cells containing negative values in an Excel sheet?","text":"<ul> <li>First, select the cells that have negative values.</li> <li>Now, go to the Home tab and choose the Conditional Formatting option.</li> <li>Then, go to the Highlight Cell Rules and select the Less Than option.</li> <li>In the final step, you must go to the dialog box of the Less Than option and enter \u201c0\u201d as the value.</li> </ul>"},{"location":"chap4/8Data_ana_interview2/","title":"\u7b2c\u516b\u8282 \u5206\u6790\u5c97\u7b14\u8bd5/\u9762\u8bd5\u77e5\u8bc6\u70b9","text":""},{"location":"chap4/8Data_ana_interview2/#1","title":"\u77e5\u8bc6\u70b91\uff1a\u8d1d\u53f6\u65af\u516c\u5f0f","text":"<p>\u8d1d\u53f6\u65af\u516c\u5f0f\uff1a<code>P(B|A)=P(A|B)*P(B)/P(A)</code></p> <p>\u5176\u4e2dP(A)\u53ef\u4ee5\u5c55\u5f00\u4e3a</p> <pre><code>P(A)=P(A|B1)P(B1)+P(A|B2)P(B2)+...+P(A|Bn)*P(Bn)\n</code></pre>"},{"location":"chap4/8Data_ana_interview2/#2","title":"\u77e5\u8bc6\u70b92\uff1a\u5173\u8054\u89c4\u5219\u5206\u6790","text":"<p>\u4e3b\u8981\u8003\u7684\u662f\u652f\u6301\u5ea6\u548c\u7f6e\u4fe1\u5ea6\u3002</p> <p> </p>"},{"location":"chap4/8Data_ana_interview2/#3","title":"\u77e5\u8bc6\u70b93\uff1a\u805a\u7c7b","text":"<p>\u805a\u7c7b\u4e4b\u95f4\u7c7b\u7684\u5ea6\u91cf\u662f\u5206\u8ddd\u79bb\u548c\u76f8\u4f3c\u7cfb\u6570\u6765\u5ea6\u91cf\u7684\uff0c\u8ddd\u79bb\u7528\u6765\u5ea6\u91cf\u6837\u54c1\u4e4b\u95f4\u7684\u76f8\u4f3c\u6027\uff08K-means\u805a\u7c7b\uff0c\u7cfb\u7edf\u805a\u7c7b\u4e2d\u7684Q\u578b\u805a\u7c7b\uff09\uff0c\u76f8\u4f3c\u7cfb\u6570\u7528\u6765\u5ea6\u91cf\u53d8\u91cf\u4e4b\u95f4\u7684\u76f8\u4f3c\u6027\uff08\u7cfb\u7edf\u805a\u7c7b\u4e2d\u7684R\u578b\u805a\u7c7b\uff09\u3002</p> <p>\u6700\u5e38\u7528\u7684\u662fK-means\u805a\u7c7b\uff0c\u9002\u7528\u4e8e\u5927\u6837\u672c\uff0c\u4f46\u9700\u8981\u4e8b\u5148\u6307\u5b9a\u5206\u4e3aK\u4e2a\u7c7b\u3002</p> <p>\u5904\u7406\u6b65\u9aa4\uff1a</p> <ul> <li>1\uff09\u3001\u4ecen\u4e2a\u6570\u636e\u5bf9\u8c61\u4e2d\u4efb\u610f\u9009\u51fak\u4e2a\u5bf9\u8c61\u4f5c\u4e3a\u521d\u59cb\u7684\u805a\u7c7b\u4e2d\u5fc3</li> <li>2\uff09\u3001\u8ba1\u7b97\u5269\u4f59\u7684\u5404\u4e2a\u5bf9\u8c61\u5230\u805a\u7c7b\u4e2d\u5fc3\u7684\u8ddd\u79bb\uff0c\u5c06\u5b83\u5212\u5206\u7ed9\u6700\u8fd1\u7684\u7c07</li> <li>3\uff09\u3001\u91cd\u65b0\u8ba1\u7b97\u6bcf\u4e00\u7c07\u7684\u5e73\u5747\u503c\uff08\u4e2d\u5fc3\u5bf9\u8c61\uff09</li> <li>4\uff09\u3001\u5faa\u73af2-3\u76f4\u5230\u6bcf\u4e2a\u805a\u7c7b\u4e0d\u518d\u53d1\u751f\u53d8\u5316\u4e3a\u6b62\u3002</li> </ul> <p>\u7cfb\u7edf\u805a\u7c7b\u9002\u7528\u4e8e\u5c0f\u6837\u672c\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#4","title":"\u77e5\u8bc6\u70b94\uff1a\u5206\u7c7b","text":"<p>\u6709\u76d1\u7763\u5c31\u662f\u7ed9\u7684\u6837\u672c\u90fd\u6709\u6807\u7b7e\uff0c\u5206\u7c7b\u7684\u8bad\u7ec3\u6837\u672c\u5fc5\u987b\u6709\u6807\u7b7e\uff0c\u6240\u4ee5\u5206\u7c7b\u7b97\u6cd5\u90fd\u662f\u6709\u76d1\u7763\u7b97\u6cd5\u3002</p> <p>\u76d1\u7763\u673a\u5668\u5b66\u4e60\u95ee\u9898\u65e0\u975e\u5c31\u662f\u201cminimizeyour error while regularizing your parameters\u201d\uff0c\u4e5f\u5c31\u662f\u5728\u89c4\u5219\u5316\u53c2\u6570\u7684\u540c\u65f6\u6700\u5c0f\u5316\u8bef\u5dee\u3002</p> <p>\u6700\u5c0f\u5316\u8bef\u5dee\u662f\u4e3a\u4e86\u8ba9\u6211\u4eec\u7684\u6a21\u578b\u62df\u5408\u6211\u4eec\u7684\u8bad\u7ec3\u6570\u636e\uff0c\u800c\u89c4\u5219\u5316\u53c2\u6570\u662f\u9632\u6b62\u6211\u4eec\u7684\u6a21\u578b\u8fc7\u5206\u62df\u5408\u6211\u4eec\u7684\u8bad\u7ec3\u6570\u636e\uff0c\u63d0\u9ad8\u6cdb\u5316\u80fd\u529b\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#1_1","title":"1.\u6734\u7d20\u8d1d\u53f6\u65af","text":"<p>1\uff09\u57fa\u7840\u601d\u60f3\uff1a</p> <p>\u5bf9\u4e8e\u7ed9\u51fa\u7684\u5f85\u5206\u7c7b\u9879\uff0c\u6c42\u89e3\u5728\u6b64\u9879\u51fa\u73b0\u7684\u6761\u4ef6\u4e0b\u5404\u4e2a\u7c7b\u522b\u51fa\u73b0\u7684\u6982\u7387\uff0c\u54ea\u4e2a\u6700\u5927\uff0c\u5c31\u8ba4\u4e3a\u6b64\u5206\u7c7b\u9879\u5c5e\u4e8e\u54ea\u4e2a\u7c7b\u522b\u3002</p> <p>2\uff09\u4f18\u70b9\uff1a</p> <p>\u53ef\u4ee5\u548c\u51b3\u7b56\u6811\u3001\u795e\u7ecf\u7f51\u7edc\u5206\u7c7b\u7b97\u6cd5\u76f8\u5ab2\u7f8e\uff0c\u80fd\u8fd0\u7528\u4e8e\u5927\u578b\u6570\u636e\u5e93\u4e2d\u3002</p> <p>\u65b9\u6cd5\u7b80\u5355\uff0c\u5206\u7c7b\u51c6\u786e\u7387\u9ad8\uff0c\u901f\u5ea6\u5feb\uff0c\u6240\u9700\u4f30\u8ba1\u7684\u53c2\u6570\u5c11\uff0c\u5bf9\u4e8e\u7f3a\u5931\u6570\u636e\u4e0d\u654f\u611f\u3002</p> <p>3\uff09\u7f3a\u70b9\uff1a</p> <p>\u5047\u8bbe\u4e00\u4e2a\u5c5e\u6027\u5bf9\u5b9a\u7c7b\u7684\u5f71\u54cd\u72ec\u7acb\u4e8e\u5176\u4ed6\u7684\u5c5e\u6027\u503c\uff0c\u8fd9\u5f80\u5f80\u5e76\u4e0d\u6210\u7acb\u3002\uff08\u559c\u6b22\u5403\u756a\u8304\u3001\u9e21\u86cb\uff0c\u5374\u4e0d\u559c\u6b22\u5403\u756a\u8304\u7092\u86cb\uff09\u3002</p> <p>\u9700\u8981\u77e5\u9053\u5148\u9a8c\u6982\u7387\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#2_1","title":"2.\u51b3\u7b56\u6811","text":"<p>1\uff09\u57fa\u7840\u601d\u60f3\uff1a</p> <p>\u51b3\u7b56\u6811\u662f\u4e00\u79cd\u7b80\u5355\u4f46\u5e7f\u6cdb\u4f7f\u7528\u7684\u5206\u7c7b\u5668\uff0c\u5b83\u901a\u8fc7\u8bad\u7ec3\u6570\u636e\u6784\u5efa\u51b3\u7b56\u6811\uff0c\u5bf9\u672a\u77e5\u7684\u6570\u636e\u8fdb\u884c\u5206\u7c7b\u3002\u51b3\u7b56\u6811\u7684\u6bcf\u4e2a\u5185\u90e8\u8282\u70b9\u8868\u793a\u5728\u4e00\u4e2a\u5c5e\u6027\u4e0a\u7684\u6d4b\u8bd5\uff0c\u6bcf\u4e2a\u5206\u679d\u4ee3\u8868\u8be5\u6d4b\u8bd5\u7684\u4e00\u4e2a\u8f93\u51fa\uff0c\u800c\u6bcf\u4e2a\u53f6\u7ed3\u70b9\u5b58\u653e\u7740\u4e00\u4e2a\u7c7b\u6807\u53f7\u3002</p> <p>\u5728\u51b3\u7b56\u6811\u7b97\u6cd5\u4e2d\uff0cID3\u57fa\u4e8e\u4fe1\u606f\u589e\u76ca\u4f5c\u4e3a\u5c5e\u6027\u9009\u62e9\u7684\u5ea6\u91cf\uff0cC4.5\u57fa\u4e8e\u4fe1\u606f\u589e\u76ca\u6bd4\u4f5c\u4e3a\u5c5e\u6027\u9009\u62e9\u7684\u5ea6\u91cf\uff0cCART\u57fa\u4e8e\u57fa\u5c3c\u6307\u6570\u4f5c\u4e3a\u5c5e\u6027\u9009\u62e9\u7684\u5ea6\u91cf\u3002</p> <p>2\uff09\u4f18\u70b9 \uff1a</p> <p>\u4e0d\u9700\u8981\u4efb\u4f55\u9886\u57df\u77e5\u8bc6\u6216\u53c2\u6570\u5047\u8bbe\u3002</p> <p>\u9002\u5408\u9ad8\u7ef4\u6570\u636e\u3002</p> <p>\u7b80\u5355\u6613\u4e8e\u7406\u89e3\u3002</p> <p>3\uff09\u7f3a\u70b9\uff1a</p> <p>\u5bf9\u4e8e\u5404\u7c7b\u522b\u6837\u672c\u6570\u91cf\u4e0d\u4e00\u81f4\u6570\u636e\uff0c\u4fe1\u606f\u589e\u76ca\u504f\u5411\u4e8e\u90a3\u4e9b\u5177\u6709\u66f4\u591a\u6570\u503c\u7684\u7279\u5f81\u3002</p> <p>\u6613\u4e8e\u8fc7\u62df\u5408\u3002</p> <p>\u5ffd\u7565\u5c5e\u6027\u4e4b\u95f4\u7684\u76f8\u5173\u6027\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#3_1","title":"3.\u652f\u6301\u5411\u91cf\u673a","text":"<p>1\uff09\u57fa\u7840\u601d\u60f3\uff1a</p> <p>\u652f\u6301\u5411\u91cf\u673a\u628a\u5206\u7c7b\u95ee\u9898\u8f6c\u5316\u4e3a\u5bfb\u627e\u5206\u7c7b\u5e73\u9762\u7684\u95ee\u9898\uff0c\u5e76\u901a\u8fc7\u6700\u5927\u5316\u5206\u7c7b\u8fb9\u754c\u70b9\u8ddd\u79bb\u5206\u7c7b\u5e73\u9762\u7684\u8ddd\u79bb\u6765\u5b9e\u73b0\u5206\u7c7b\u3002</p> <p>2\uff09\u4f18\u70b9 \uff1a</p> <p>\u53ef\u4ee5\u89e3\u51b3\u5c0f\u6837\u672c\u4e0b\u673a\u5668\u5b66\u4e60\u7684\u95ee\u9898\u3002</p> <p>\u63d0\u9ad8\u6cdb\u5316\u6027\u80fd\u3002</p> <p>\u53ef\u4ee5\u89e3\u51b3\u6587\u672c\u5206\u7c7b\u3001\u6587\u5b57\u8bc6\u522b\u3001\u56fe\u50cf\u5206\u7c7b\u7b49\u65b9\u9762\u4ecd\u53d7\u6b22\u8fce\u3002</p> <p>\u907f\u514d\u795e\u7ecf\u7f51\u7edc\u7ed3\u6784\u9009\u62e9\u548c\u5c40\u90e8\u6781\u5c0f\u7684\u95ee\u9898\u3002</p> <p>3\uff09\u7f3a\u70b9\uff1a</p> <p>\u7f3a\u5931\u6570\u636e\u654f\u611f\u3002</p> <p>\u5185\u5b58\u6d88\u8017\u5927\uff0c\u96be\u4ee5\u89e3\u91ca\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#4k","title":"4.K\u8fd1\u90bb","text":"<p>1\uff09\u57fa\u7840\u601d\u60f3\uff1a</p> <p>\u901a\u8fc7\u8ba1\u7b97\u6bcf\u4e2a\u8bad\u7ec3\u6837\u4f8b\u5230\u5f85\u5206\u7c7b\u6837\u54c1\u7684\u8ddd\u79bb\uff0c\u53d6\u548c\u5f85\u5206\u7c7b\u6837\u54c1\u8ddd\u79bb\u6700\u8fd1\u7684K\u4e2a\u8bad\u7ec3\u6837\u4f8b\uff0cK\u4e2a\u6837\u54c1\u4e2d\u54ea\u4e2a\u7c7b\u522b\u7684\u8bad\u7ec3\u6837\u4f8b\u5360\u591a\u6570\uff0c\u5219\u5f85\u5206\u7c7b\u6837\u54c1\u5c31\u5c5e\u4e8e\u54ea\u4e2a\u7c7b\u522b\u3002</p> <p>2\uff09\u4f18\u70b9 \uff1a \u9002\u7528\u4e8e\u6837\u672c\u5bb9\u91cf\u6bd4\u8f83\u5927\u7684\u5206\u7c7b\u95ee\u9898</p> <p>3\uff09\u7f3a\u70b9\uff1a \u8ba1\u7b97\u91cf\u592a\u5927</p> <p>\u5bf9\u4e8e\u6837\u672c\u91cf\u8f83\u5c0f\u7684\u5206\u7c7b\u95ee\u9898\uff0c\u4f1a\u4ea7\u751f\u8bef\u5206\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#5lr","title":"5.\u903b\u8f91\u56de\u5f52\uff08LR\uff09","text":"<p>1\uff09\u57fa\u7840\u601d\u60f3\uff1a</p> <p>\u56de\u5f52\u6a21\u578b\u4e2d\uff0cy\u662f\u4e00\u4e2a\u5b9a\u578b\u53d8\u91cf\uff0c\u6bd4\u5982<code>y=0</code>\u6216<code>1</code>\uff0c<code>logistic</code>\u65b9\u6cd5\u4e3b\u8981\u5e94\u7528\u4e8e\u7814\u7a76\u67d0\u4e9b\u4e8b\u4ef6\u53d1\u751f\u7684\u6982\u7387\u3002</p> <p>2\uff09\u4f18\u70b9 \uff1a</p> <p>\u901f\u5ea6\u5feb\uff0c\u9002\u5408\u4e8c\u5206\u7c7b\u95ee\u9898\u3002</p> <p>\u7b80\u5355\u6613\u4e8e\u7406\u89e3\uff0c\u76f4\u63a5\u770b\u5230\u5404\u4e2a\u7279\u5f81\u7684\u6743\u91cd\u3002</p> <p>\u80fd\u5bb9\u6613\u5730\u66f4\u65b0\u6a21\u578b\u5438\u6536\u65b0\u7684\u6570\u636e\u3002</p> <p>3\uff09\u7f3a\u70b9\uff1a</p> <p>\u5bf9\u6570\u636e\u548c\u573a\u666f\u7684\u9002\u5e94\u80fd\u529b\u6709\u5c40\u9650\uff0c\u4e0d\u5982\u51b3\u7b56\u6811\u7b97\u6cd5\u9002\u5e94\u6027\u90a3\u4e48\u5f3a</p>"},{"location":"chap4/8Data_ana_interview2/#5","title":"\u77e5\u8bc6\u70b95\uff1a\u5206\u7c7b\u7684\u8bc4\u5224\u6307\u6807","text":"<p>\u51c6\u786e\u7387\u548c\u53ec\u56de\u7387\u5e7f\u6cdb\u7528\u4e8e\u4fe1\u606f\u68c0\u7d22\u548c\u7edf\u8ba1\u5206\u7c7b\u9886\u57df</p> <ul> <li>\u51c6\u786e\u7387\uff08precision rate\uff09\uff1a\u63d0\u53d6\u51fa\u7684\u6b63\u786e\u4fe1\u606f\u6761\u6570/\u63d0\u53d6\u51fa\u7684\u4fe1\u606f\u6761\u6570</li> <li>\u53ec\u56de\u7387\uff08recall rate\uff09\uff1a\u63d0\u53d6\u51fa\u7684\u6b63\u786e\u4fe1\u606f\u6761\u6570/\u6837\u672c\u4e2d\u7684\u4fe1\u606f\u6761\u6570</li> </ul> <p> </p> <p>ROC\u548cAUC\u662f\u8bc4\u4ef7\u5206\u7c7b\u5668\u7684\u6307\u6807</p>"},{"location":"chap4/8Data_ana_interview2/#3roc","title":"3\uff09ROC\u66f2\u7ebf\uff1a","text":"<p>True Positive Rate ( TPR\uff0c\u771f\u6b63\u7387 ) = TP / [ TP + FN] \uff0cTPR\u4ee3\u8868\u9884\u6d4b\u4e3a\u6b63\u5b9e\u9645\u4e5f\u4e3a\u6b63\u5360\u603b\u6b63\u5b9e\u4f8b\u7684\u6bd4\u4f8b</p> <p>False Positive Rate( FPR\uff0c\u5047\u6b63\u7387 ) = FP / [ FP + TN] \uff0cFPR\u4ee3\u8868\u9884\u6d4b\u4e3a\u6b63\u4f46\u5b9e\u9645\u4e3a\u8d1f\u5360\u603b\u8d1f\u5b9e\u4f8b\u7684\u6bd4\u4f8b</p> <p>\u5728ROC \u7a7a\u95f4\u4e2d\uff0c\u6bcf\u4e2a\u70b9\u7684\u6a2a\u5750\u6807\u662fFPR\uff0c\u7eb5\u5750\u6807\u662fTPR</p> <p> </p>"},{"location":"chap4/8Data_ana_interview2/#4aucaucarea-under-curve","title":"4\uff09AUC\uff1aAUC\uff08Area Under Curve\uff09","text":"<p>\u88ab\u5b9a\u4e49\u4e3aROC\u66f2\u7ebf\u4e0b\u7684\u9762\u79ef\uff0c\u663e\u7136\u8fd9\u4e2a\u9762\u79ef\u7684\u6570\u503c\u4e0d\u4f1a\u5927\u4e8e1\u3002</p> <p>\u53c8\u7531\u4e8eROC\u66f2\u7ebf\u4e00\u822c\u90fd\u5904\u4e8ey=x\u8fd9\u6761\u76f4\u7ebf\u7684\u4e0a\u65b9\uff0c\u6240\u4ee5AUC\u7684\u53d6\u503c\u8303\u56f4\u57280.5\u548c1\u4e4b\u95f4\u3002</p> <p>\u4f7f\u7528AUC\u503c\u4f5c\u4e3a\u8bc4\u4ef7\u6807\u51c6\u662f\u56e0\u4e3a\u5f88\u591a\u65f6\u5019ROC\u66f2\u7ebf\u5e76\u4e0d\u80fd\u6e05\u6670\u7684\u8bf4\u660e\u54ea\u4e2a\u5206\u7c7b\u5668\u7684\u6548\u679c\u66f4\u597d\uff0c\u800cAUC\u4f5c\u4e3a\u6570\u503c\u53ef\u4ee5\u76f4\u89c2\u7684\u8bc4\u4ef7\u5206\u7c7b\u5668\u7684\u597d\u574f\uff0c\u503c\u8d8a\u5927\u8d8a\u597d\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#5_1","title":"5\uff09\u5982\u4f55\u907f\u514d\u8fc7\u62df\u5408\uff1f","text":"<p>\u8fc7\u62df\u5408\u8868\u73b0\u5728\u8bad\u7ec3\u6570\u636e\u4e0a\u7684\u8bef\u5dee\u975e\u5e38\u5c0f\uff0c\u800c\u5728\u6d4b\u8bd5\u6570\u636e\u4e0a\u8bef\u5dee\u53cd\u800c\u589e\u5927\u3002\u5176\u539f\u56e0\u4e00\u822c\u662f\u6a21\u578b\u8fc7\u4e8e\u590d\u6742\uff0c\u8fc7\u5206\u5f97\u53bb\u62df\u5408\u6570\u636e\u7684\u566a\u58f0\u548coutliers\u3002</p> <p>\u5e38\u89c1\u7684\u89e3\u51b3\u529e\u6cd5\u662f\u6b63\u5219\u5316\u662f\uff1a\u589e\u5927\u6570\u636e\u96c6\uff0c\u6b63\u5219\u5316</p> <p>\u6b63\u5219\u5316\u65b9\u6cd5\u662f\u6307\u5728\u8fdb\u884c\u76ee\u6807\u51fd\u6570\u6216\u4ee3\u4ef7\u51fd\u6570\u4f18\u5316\u65f6\uff0c\u5728\u76ee\u6807\u51fd\u6570\u6216\u4ee3\u4ef7\u51fd\u6570\u540e\u9762\u52a0\u4e0a\u4e00\u4e2a\u6b63\u5219\u9879\uff0c\u4e00\u822c\u6709L1\u6b63\u5219\u4e0eL2\u6b63\u5219\u7b49\u3002\u89c4\u5219\u5316\u9879\u7684\u5f15\u5165\uff0c\u5728\u8bad\u7ec3\uff08\u6700\u5c0f\u5316cost\uff09\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5f53\u67d0\u4e00\u7ef4\u7684\u7279\u5f81\u6240\u5bf9\u5e94\u7684\u6743\u91cd\u8fc7\u5927\u65f6\uff0c\u800c\u6b64\u65f6\u6a21\u578b\u7684\u9884\u6d4b\u548c\u771f\u5b9e\u6570\u636e\u4e4b\u95f4\u8ddd\u79bb\u5f88\u5c0f\uff0c\u901a\u8fc7\u89c4\u5219\u5316\u9879\u5c31\u53ef\u4ee5\u4f7f\u6574\u4f53\u7684cost\u53d6\u8f83\u5927\u7684\u503c\uff0c\u4ece\u800c\u5728\u8bad\u7ec3\u7684\u8fc7\u7a0b\u4e2d\u907f\u514d\u4e86\u53bb\u9009\u62e9\u90a3\u4e9b\u67d0\u4e00\u7ef4\uff08\u6216\u51e0\u7ef4\uff09\u7279\u5f81\u7684\u6743\u91cd\u8fc7\u5927\u7684\u60c5\u51b5\uff0c\u5373\u8fc7\u5206\u4f9d\u8d56\u67d0\u4e00\u7ef4\uff08\u6216\u51e0\u7ef4\uff09\u7684\u7279\u5f81\u3002</p> <p>L1\u6b63\u5219\u4e0eL2\u6b63\u5219\u533a\u522b\uff1a</p> <p>L1\uff1a\u8ba1\u7b97\u7edd\u5bf9\u503c\u4e4b\u548c\uff0c\u7528\u4ee5\u4ea7\u751f\u7a00\u758f\u6027\uff08\u4f7f\u53c2\u6570\u77e9\u9635\u4e2d\u5927\u90e8\u5206\u5143\u7d20\u53d8\u4e3a0\uff09\uff0c\u56e0\u4e3a\u5b83\u662fL0\u8303\u5f0f\u7684\u4e00\u4e2a\u6700\u4f18\u51f8\u8fd1\u4f3c\uff0c\u5bb9\u6613\u4f18\u5316\u6c42\u89e3\uff1b</p> <p>L2\uff1a\u8ba1\u7b97\u5e73\u65b9\u548c\u518d\u5f00\u6839\u53f7\uff0cL2\u8303\u6570\u66f4\u591a\u662f\u9632\u6b62\u8fc7\u62df\u5408\uff0c\u5e76\u4e14\u8ba9\u4f18\u5316\u6c42\u89e3\u53d8\u5f97\u7a33\u5b9a\u5f88\u5feb\u901f\uff1b</p> <p>\u6240\u4ee5\u4f18\u5148\u4f7f\u7528L2 norm\u662f\u6bd4\u8f83\u597d\u7684\u9009\u62e9\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#6","title":"\u77e5\u8bc6\u70b96\uff1a\u4e8c\u53c9\u6811\uff08\u524d\u3001\u4e2d\u3001\u540e\u904d\u5386\uff09","text":"<p>\uff08\u8fd9\u91cc\u7684\u524d\u4e2d\u540e\u662f\u6307\u7684\u6839\u8282\u70b9\u7684\u904d\u5386\u6b21\u5e8f\uff09</p> <p>1\uff09\u524d\u5e8f\u904d\u5386\uff08DLR\uff09\uff0c\u9996\u5148\u8bbf\u95ee\u6839\u7ed3\u70b9\uff0c\u7136\u540e\u904d\u5386\u5de6\u5b50\u6811\uff0c\u6700\u540e\u904d\u5386\u53f3\u5b50\u6811\uff1b</p> <p>2\uff09\u4e2d\u5e8f\u904d\u5386\uff08LDR\uff09\uff0c\u9996\u5148\u904d\u5386\u5de6\u5b50\u6811\uff0c\u7136\u540e\u8bbf\u95ee\u6839\u7ed3\u70b9\uff0c\u6700\u540e\u904d\u5386\u53f3\u5b50\u6811\uff1b</p> <p>3\uff09\u540e\u5e8f\u904d\u5386\uff08LRD\uff09\uff0c\u9996\u5148\u904d\u5386\u5de6\u5b50\u6811\uff0c\u7136\u540e\u8bbf\u95ee\u904d\u5386\u53f3\u5b50\u6811\uff0c\u6700\u540e\u8bbf\u95ee\u6839\u7ed3\u70b9\u3002</p> <p> </p>"},{"location":"chap4/8Data_ana_interview2/#7","title":"\u77e5\u8bc6\u70b97\uff1a\u51e0\u79cd\u57fa\u672c\u6392\u5e8f\u7b97\u6cd5","text":""},{"location":"chap4/8Data_ana_interview2/#1bubble-sort","title":"1\uff09\u5192\u6ce1\u6392\u5e8f\uff08Bubble Sort\uff09","text":"<p>\u5192\u6ce1\u6392\u5e8f\u65b9\u6cd5\u662f\u6700\u7b80\u5355\u7684\u6392\u5e8f\u65b9\u6cd5\u3002\u8fd9\u79cd\u65b9\u6cd5\u7684\u57fa\u672c\u601d\u60f3\u662f\uff0c\u5c06\u5f85\u6392\u5e8f\u7684\u5143\u7d20\u770b\u4f5c\u662f\u7ad6\u7740\u6392\u5217\u7684\u201c\u6c14\u6ce1\u201d\uff0c\u8f83\u5c0f\u7684\u5143\u7d20\u6bd4\u8f83\u8f7b\uff0c\u4ece\u800c\u8981\u5f80\u4e0a\u6d6e\u3002</p> <p>\u5192\u6ce1\u6392\u5e8f\u662f\u7a33\u5b9a\u7684\u3002\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n^2)\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#2insertion-sort","title":"2\uff09\u63d2\u5165\u6392\u5e8f\uff08Insertion Sort\uff09","text":"<p>\u63d2\u5165\u6392\u5e8f\u7684\u57fa\u672c\u601d\u60f3\u662f\uff0c\u7ecf\u8fc7i-1\u904d\u5904\u7406\u540e\uff0c<code>L[1..i-1]</code>\u5df1\u6392\u597d\u5e8f\u3002\u7b2ci\u904d\u5904\u7406\u4ec5\u5c06L[i]\u63d2\u5165L[1..i-1]\u7684\u9002\u5f53\u4f4d\u7f6e\uff0c\u4f7f\u5f97<code>L[1..i]</code>\u53c8\u662f\u6392\u597d\u5e8f\u7684\u5e8f\u5217\u3002</p> <p>\u76f4\u63a5\u63d2\u5165\u6392\u5e8f\u662f\u7a33\u5b9a\u7684\u3002\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n^2)\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#3_2","title":"3\uff09\u5806\u6392\u5e8f","text":"<p>\u5806\u6392\u5e8f\u662f\u4e00\u79cd\u6811\u5f62\u9009\u62e9\u6392\u5e8f\uff0c\u5728\u6392\u5e8f\u8fc7\u7a0b\u4e2d\uff0c\u5c06<code>A[n]</code>\u770b\u6210\u662f\u5b8c\u5168\u4e8c\u53c9\u6811\u7684\u987a\u5e8f\u5b58\u50a8\u7ed3\u6784\uff0c\u5229\u7528\u5b8c\u5168\u4e8c\u53c9\u6811\u4e2d\u53cc\u4eb2\u7ed3\u70b9\u548c\u5b69\u5b50\u7ed3\u70b9\u4e4b\u95f4\u7684\u5185\u5728\u5173\u7cfb\u6765\u9009\u62e9\u6700\u5c0f\u7684\u5143\u7d20\u3002</p> <p>\u5806\u6392\u5e8f\u662f\u4e0d\u7a33\u5b9a\u7684\u3002\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6<code>O(nlog n)</code>\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#4_1","title":"4\uff09\u5feb\u901f\u6392\u5e8f","text":"<p>\u5feb\u901f\u6392\u5e8f\u662f\u5bf9\u5192\u6ce1\u6392\u5e8f\u7684\u4e00\u79cd\u672c\u8d28\u6539\u8fdb\u3002\u5feb\u901f\u6392\u5e8f\u901a\u8fc7\u4e00\u8d9f\u626b\u63cf\uff0c\u5c31\u80fd\u786e\u4fdd\u67d0\u4e2a\u6570\uff08\u4ee5\u5b83\u4e3a\u57fa\u51c6\u70b9\u5427\uff09\u7684\u5de6\u8fb9\u5404\u6570\u90fd\u6bd4\u5b83\u5c0f\uff0c\u53f3\u8fb9\u5404\u6570\u90fd\u6bd4\u5b83\u5927\u3002</p> <p>\u5feb\u901f\u6392\u5e8f\u662f\u4e0d\u7a33\u5b9a\u7684\u3002\u6700\u7406\u60f3\u60c5\u51b5\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6O(nlog2n)\uff0c\u6700\u574f<code>O(n ^2)</code>\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#8sql","title":"\u77e5\u8bc6\u70b98\uff1aSQL\u77e5\u8bc6","text":""},{"location":"chap4/8Data_ana_interview2/#1innerfull","title":"1\uff09\u5de6\u8fde\u63a5\u3001\u53f3\u8fde\u63a5\u3001inner\u8fde\u63a5\uff0cfull\u8fde\u63a5","text":""},{"location":"chap4/8Data_ana_interview2/#2_2","title":"2\uff09\u4fee\u6539\u8868\uff1a","text":"<ul> <li><code>alter table \u6559\u5e08 add \u5956\u91d1 int</code></li> <li><code>alter table \u6559\u5e08 drop \u5956\u91d1</code></li> <li><code>alter table \u6559\u5e08 rename \u5956\u91d1 to \u6d25\u8d34</code></li> </ul>"},{"location":"chap4/8Data_ana_interview2/#3_3","title":"3\uff09\u8868\u6743\u9650\u7684\u8d4b\u4e88","text":""},{"location":"chap4/8Data_ana_interview2/#4_2","title":"4\uff09\u600e\u6837\u6e05\u7a7a\u8868\u6570\u636e\uff0c\u4f46\u4e0d\u5220\u9664\u8868\u7ed3\u6784","text":"<p><code>delete from tablename\u6216\u8005delete * from table_name</code></p> <p><code>truncate table tablename</code></p>"},{"location":"chap4/8Data_ana_interview2/#5_2","title":"5\uff09\u5916\u952e\u80fd\u4e0d\u80fd\u4e3a\u7a7a","text":"<p>\u5916\u952e\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u4e3a\u7a7a\u8868\u793a\u5176\u503c\u8fd8\u6ca1\u6709\u786e\u5b9a\uff1b</p> <p>\u5982\u679c\u4e0d\u4e3a\u7a7a\uff0c\u521a\u5fc5\u987b\u4e3a\u4e3b\u952e\u76f8\u540c\u3002</p>"},{"location":"chap4/8Data_ana_interview2/#9","title":"\u77e5\u8bc6\u70b99\uff1a\u7edf\u8ba1\u5b66\u57fa\u7840\u77e5\u8bc6","text":"<p>1\uff09\u56db\u5206\u4f4d\u6781\u5dee\u3001\u5de6\u53f3\u504f\u5206\u5e03\u3001p\u503c</p> <p>2\uff09\u65b9\u5dee\u5206\u6790\uff1a \u7528\u4e8e\u4e24\u4e2a\u53ca\u4e24\u4e2a\u4ee5\u4e0a\u6837\u672c\u5747\u6570\u5dee\u522b\u7684\u663e\u8457\u6027\u68c0\u9a8c\uff0c\u57fa\u672c\u601d\u60f3\u662f\uff1a\u901a\u8fc7\u5206\u6790\u7814\u7a76\u4e0d\u540c\u6765\u6e90\u7684\u53d8\u5f02\u5bf9\u603b\u53d8\u5f02\u7684\u8d21\u732e\u5927\u5c0f\uff0c\u4ece\u800c\u786e\u5b9a\u63a7\u5236\u53d8\u91cf\u5bf9\u7814\u7a76\u7ed3\u679c\u5f71\u54cd\u529b\u7684\u5927\u5c0f\u3002</p> <p>3\uff09\u4e3b\u6210\u5206\u5206\u6790\uff1a</p> <p>\u662f\u4e00\u79cd\u7edf\u8ba1\u65b9\u6cd5\u3002\u901a\u8fc7\u6b63\u4ea4\u53d8\u6362\u5c06\u4e00\u7ec4\u53ef\u80fd\u5b58\u5728\u76f8\u5173\u6027\u7684\u53d8\u91cf\u8f6c\u6362\u4e3a\u4e00\u7ec4\u7ebf\u6027\u4e0d\u76f8\u5173\u7684\u53d8\u91cf\uff0c\u8f6c\u6362\u540e\u7684\u8fd9\u7ec4\u53d8\u91cf\u53eb\u4e3b\u6210\u5206\u3002</p> <p>4\uff09\u5e78\u5b58\u8005\u504f\u5dee\uff1a</p> <p>\u610f\u601d\u662f\u6307\uff0c\u5f53\u53d6\u5f97\u8d44\u8baf\u7684\u6e20\u9053\uff0c\u4ec5\u6765\u81ea\u4e8e\u5e78\u5b58\u8005\u65f6\uff08\u56e0\u4e3a\u6b7b\u4eba\u4e0d\u4f1a\u8bf4\u8bdd\uff09\uff0c\u6b64\u8d44\u8baf\u53ef\u80fd\u4f1a\u5b58\u5728\u4e0e\u5b9e\u9645\u60c5\u51b5\u4e0d\u540c\u7684\u504f\u5dee\u3002</p>"},{"location":"chap4/9Data_ML_interview/","title":"L9 Top 50 Machine Learning Interview Questions &amp; Answers","text":""},{"location":"chap4/9Data_ML_interview/#1-what-is-machine-learning","title":"1) What is Machine learning?","text":"<p>Machine learning is a branch of computer science which deals with system programming in order to automatically learn and improve with experience.  For example: Robots are programed so that they can perform the task based on data they gather from sensors. It automatically learns programs from data.</p>"},{"location":"chap4/9Data_ML_interview/#2-mention-the-difference-between-data-mining-and-machine-learning","title":"2) Mention the difference between Data Mining and Machine learning?","text":"<p>Machine learning relates with the study, design and development of the algorithms that give computers the capability to learn without being explicitly programmed.  While, data mining can be defined as the process in which the unstructured data tries to extract knowledge or unknown interesting patterns.  During this process machine, learning algorithms are used.</p>"},{"location":"chap4/9Data_ML_interview/#3-what-is-overfitting-in-machine-learning","title":"3) What is \u2018Overfitting\u2019 in Machine learning?","text":"<p>In machine learning, when a statistical model describes random error or noise instead of underlying relationship \u2018overfitting\u2019 occurs.  When a model is excessively complex, overfitting is normally observed, because of having too many parameters with respect to the number of training data types. The model exhibits poor performance which has been overfit.</p>"},{"location":"chap4/9Data_ML_interview/#4-why-overfitting-happens","title":"4) Why overfitting happens?","text":"<p>The possibility of overfitting exists as the criteria used for training the model is not the same as the criteria used to judge the efficacy of a model.</p>"},{"location":"chap4/9Data_ML_interview/#5-how-can-you-avoid-overfitting","title":"5) How can you avoid overfitting ?","text":"<p>By using a lot of data overfitting can be avoided, overfitting happens relatively as you have a small dataset, and you try to learn from it. But if you have a small database and you are forced to come with a model based on that. In such situation, you can use a technique known as cross validation. In this method the dataset splits into two section, testing and training datasets, the testing dataset will only test the model while, in training dataset, the datapoints will come up with the model.</p> <p>In this technique,  a model is usually given a dataset of a known data on which training (training data set) is run and a dataset of unknown data against which the model is tested. The idea of cross validation is to define a dataset to \u201ctest\u201d the model in the training phase.</p>"},{"location":"chap4/9Data_ML_interview/#6-what-is-inductive-machine-learning","title":"6) What is inductive machine learning?","text":"<p>The inductive machine learning involves the process of learning by examples, where a system, from a set of observed instances tries to induce a general rule.</p>"},{"location":"chap4/9Data_ML_interview/#7-what-are-the-five-popular-algorithms-of-machine-learning","title":"7) What are the five popular algorithms of Machine Learning?","text":"<ul> <li>Decision Trees</li> <li>Neural Networks (back propagation)</li> <li>Probabilistic networks</li> <li>Nearest Neighbor</li> <li>Support vector machines</li> </ul>"},{"location":"chap4/9Data_ML_interview/#8-what-are-the-different-algorithm-techniques-in-machine-learning","title":"8) What are the different Algorithm techniques in Machine Learning?","text":"<p>The different types of techniques in Machine Learning are</p> <ul> <li>Supervised Learning</li> <li>Unsupervised Learning</li> <li>Semi-supervised Learning</li> <li>Reinforcement Learning</li> <li>Transduction</li> <li>Learning to Learn</li> </ul>"},{"location":"chap4/9Data_ML_interview/#9-what-are-the-three-stages-to-build-the-hypotheses-or-model-in-machine-learning","title":"9) What are the three stages to build the hypotheses or model in machine learning?","text":"<ul> <li>Model building</li> <li>Model testing</li> <li>Applying the model</li> </ul>"},{"location":"chap4/9Data_ML_interview/#10-what-is-the-standard-approach-to-supervised-learning","title":"10) What is the standard approach to supervised learning?","text":"<p>The standard approach to supervised learning is to split the set of example into the training set and the test.</p>"},{"location":"chap4/9Data_ML_interview/#11-what-is-training-set-and-test-set","title":"11) What is \u2018Training set\u2019 and \u2018Test set\u2019?","text":"<p>In various areas of information science like machine learning, a set of data is used to discover the potentially predictive relationship known as \u2018Training Set\u2019. Training set is an examples given to the learner, while Test set is used to test the accuracy of the hypotheses generated by the learner, and it is the set of example held back from the learner. Training set are distinct from Test set.</p>"},{"location":"chap4/9Data_ML_interview/#12-list-down-various-approaches-for-machine-learning","title":"12) List down various approaches for machine learning?","text":"<p>The different approaches in Machine Learning are</p> <ul> <li>Concept Vs Classification Learning</li> <li>Symbolic Vs Statistical Learning</li> <li>Inductive Vs Analytical Learning</li> </ul>"},{"location":"chap4/9Data_ML_interview/#13-what-is-not-machine-learning","title":"13) What is not Machine Learning?","text":"<ul> <li>Artificial Intelligence</li> <li>Rule based inference</li> </ul>"},{"location":"chap4/9Data_ML_interview/#14-explain-what-is-the-function-of-unsupervised-learning","title":"14) Explain what is the function of \u2018Unsupervised Learning\u2019?","text":"<ul> <li>Find clusters of the data</li> <li>Find low-dimensional representations of the data</li> <li>Find interesting directions in data</li> <li>Interesting coordinates and correlations</li> <li>Find novel observations/ database cleaning</li> </ul>"},{"location":"chap4/9Data_ML_interview/#15-explain-what-is-the-function-of-supervised-learning","title":"15) Explain what is the function of \u2018Supervised Learning\u2019?","text":"<ul> <li>Classifications</li> <li>Speech recognition</li> <li>Regression</li> <li>Predict time series</li> <li>Annotate strings</li> </ul>"},{"location":"chap4/9Data_ML_interview/#16-what-is-algorithm-independent-machine-learning","title":"16) What is algorithm independent machine learning?","text":"<p>Machine learning in where mathematical foundations is independent of any particular classifier or learning algorithm is referred as algorithm independent machine learning?</p>"},{"location":"chap4/9Data_ML_interview/#17-what-is-the-difference-between-artificial-learning-and-machine-learning","title":"17) What is the difference between artificial learning and machine learning?","text":"<p>Designing and developing algorithms according to the behaviours based on empirical data are known as Machine Learning.  While artificial intelligence in addition to machine learning, it also covers other aspects like knowledge representation, natural language processing, planning, robotics etc.</p>"},{"location":"chap4/9Data_ML_interview/#18-what-is-classifier-in-machine-learning","title":"18) What is classifier in machine learning?","text":"<p>A classifier in a Machine Learning is a system that inputs a vector of discrete or continuous feature values and outputs a single discrete value, the class.</p>"},{"location":"chap4/9Data_ML_interview/#19-what-are-the-advantages-of-naive-bayes","title":"19) What are the advantages of Naive Bayes?","text":"<p>In Na\u00efve Bayes classifier will converge quicker than discriminative models like logistic regression, so you need less training data.  The main advantage is that it can\u2019t learn interactions between features.</p>"},{"location":"chap4/9Data_ML_interview/#20-in-what-areas-pattern-recognition-is-used","title":"20) In what areas Pattern Recognition is used?","text":"<p>Pattern Recognition can be used in</p> <ul> <li>Computer Vision</li> <li>Speech Recognition</li> <li>Data Mining</li> <li>Statistics</li> <li>Informal Retrieval</li> <li>Bio-Informatics</li> </ul>"},{"location":"chap4/9Data_ML_interview/#21-what-is-genetic-programming","title":"21) What is Genetic Programming?","text":"<p>Genetic programming is one of the two techniques used in machine learning. The model is based on the testing and selecting the best choice among a set of results.</p>"},{"location":"chap4/9Data_ML_interview/#22-what-is-inductive-logic-programming-in-machine-learning","title":"22) What is Inductive Logic Programming in Machine Learning?","text":"<p>Inductive Logic Programming (ILP) is a subfield of machine learning which uses logical programming representing background knowledge and examples.</p>"},{"location":"chap4/9Data_ML_interview/#23-what-is-model-selection-in-machine-learning","title":"23) What is Model Selection in Machine Learning?","text":"<p>The process of selecting models among different mathematical models, which are used to describe the same data set is known as Model Selection. Model selection is applied to the fields of statistics, machine learning and data mining.</p>"},{"location":"chap4/9Data_ML_interview/#24-what-are-the-two-methods-used-for-the-calibration-in-supervised-learning","title":"24) What are the two methods used for the calibration in Supervised Learning?","text":"<p>The two methods used for predicting good probabilities in Supervised Learning are</p> <ul> <li>Platt Calibration</li> <li>Isotonic Regression</li> <li>These methods are designed for binary classification, and it is not trivial.</li> </ul>"},{"location":"chap4/9Data_ML_interview/#25-which-method-is-frequently-used-to-prevent-overfitting","title":"25) Which method is frequently used to prevent overfitting?","text":"<p>When there is sufficient data \u2018Isotonic Regression\u2019 is used to prevent an overfitting issue.</p>"},{"location":"chap4/9Data_ML_interview/#26-what-is-the-difference-between-heuristic-for-rule-learning-and-heuristics-for-decision-trees","title":"26) What is the difference between heuristic for rule learning and heuristics for decision trees?","text":"<p>The difference is that the heuristics for decision trees evaluate the average quality of a number of disjointed sets while rule learners only evaluate the quality of the set of instances that is covered with the candidate rule.</p>"},{"location":"chap4/9Data_ML_interview/#27-what-is-perceptron-in-machine-learning","title":"27) What is Perceptron in Machine Learning?","text":"<p>In Machine Learning, Perceptron is an algorithm for supervised classification of the input into one of several possible non-binary outputs.</p>"},{"location":"chap4/9Data_ML_interview/#28-explain-the-two-components-of-bayesian-logic-program","title":"28) Explain the two components of Bayesian logic program?","text":"<p>Bayesian logic program consists of two components.  The first component is a logical one ; it consists of a set of Bayesian Clauses, which captures the qualitative structure of the domain.  The second component is a quantitative one, it encodes the quantitative information about the domain.</p>"},{"location":"chap4/9Data_ML_interview/#29-what-are-bayesian-networks-bn","title":"29) What are Bayesian Networks (BN) ?","text":"<p>Bayesian Network is used to represent the graphical model for probability relationship among a set of variables.</p>"},{"location":"chap4/9Data_ML_interview/#30-why-instance-based-learning-algorithm-sometimes-referred-as-lazy-learning-algorithm","title":"30) Why instance based learning algorithm sometimes referred as Lazy learning algorithm?","text":"<p>Instance based learning algorithm is also referred as Lazy learning algorithm as they delay the induction or generalization process until classification is performed.</p>"},{"location":"chap4/9Data_ML_interview/#31-what-are-the-two-classification-methods-that-svm-support-vector-machine-can-handle","title":"31) What are the two classification methods that SVM ( Support Vector Machine) can handle?","text":"<ul> <li>Combining binary classifiers</li> <li>Modifying binary to incorporate multiclass learning</li> </ul>"},{"location":"chap4/9Data_ML_interview/#32-what-is-ensemble-learning","title":"32) What is ensemble learning?","text":"<p>To solve a particular computational program, multiple models such as classifiers or experts are strategically generated and combined. This process is known as ensemble learning.</p>"},{"location":"chap4/9Data_ML_interview/#33-why-ensemble-learning-is-used","title":"33) Why ensemble learning is used?","text":"<p>Ensemble learning is used to improve the classification, prediction, function approximation etc of a model.</p>"},{"location":"chap4/9Data_ML_interview/#34-when-to-use-ensemble-learning","title":"34) When to use ensemble learning?","text":"<p>Ensemble learning is used when you build component classifiers that are more accurate and independent from each other.</p>"},{"location":"chap4/9Data_ML_interview/#35-what-are-the-two-paradigms-of-ensemble-methods","title":"35) What are the two paradigms of ensemble methods?","text":"<p>The two paradigms of ensemble methods are</p> <ul> <li>Sequential ensemble methods</li> <li>Parallel ensemble methods</li> </ul>"},{"location":"chap4/9Data_ML_interview/#36-what-is-the-general-principle-of-an-ensemble-method-and-what-is-bagging-and-boosting-in-ensemble-method","title":"36) What is the general principle of an ensemble method and what is bagging and boosting in ensemble method?","text":"<p>The general principle of an ensemble method is to combine the predictions of several models built with a given learning algorithm in order to improve robustness over a single model.  Bagging is a method in ensemble for improving unstable estimation or classification schemes.  While boosting method are used sequentially to reduce the bias of the combined model.  Boosting and Bagging both can reduce errors by reducing the variance term.</p>"},{"location":"chap4/9Data_ML_interview/#37-what-is-bias-variance-decomposition-of-classification-error-in-ensemble-method","title":"37) What is bias-variance decomposition of classification error in ensemble method?","text":"<p>The expected error of a learning algorithm can be decomposed into bias and variance. A bias term measures how closely the average classifier produced by the learning algorithm matches the target function.  The variance term measures how much the learning algorithm\u2019s prediction fluctuates for different training sets.</p>"},{"location":"chap4/9Data_ML_interview/#38-what-is-an-incremental-learning-algorithm-in-ensemble","title":"38) What is an Incremental Learning algorithm in ensemble?","text":"<p>Incremental learning method is the ability of an algorithm to learn from new data that may be available after classifier has already been generated from already available dataset.</p>"},{"location":"chap4/9Data_ML_interview/#39-what-is-pca-kpca-and-ica-used-for","title":"39) What is PCA, KPCA and ICA used for?","text":"<p>PCA (Principal Components Analysis), KPCA ( Kernel based Principal Component Analysis) and ICA ( Independent Component Analysis) are important feature extraction techniques used for dimensionality reduction.</p>"},{"location":"chap4/9Data_ML_interview/#40-what-is-dimension-reduction-in-machine-learning","title":"40) What is dimension reduction in Machine Learning?","text":"<p>In Machine Learning and statistics, dimension reduction is the process of reducing the number of random variables under considerations and can be divided into feature selection and feature extraction.</p>"},{"location":"chap4/9Data_ML_interview/#41-what-are-support-vector-machines","title":"41) What are support vector machines?","text":"<p>Support vector machines are supervised learning algorithms used for classification and regression analysis.</p>"},{"location":"chap4/9Data_ML_interview/#42-what-are-the-components-of-relational-evaluation-techniques","title":"42) What are the components of relational evaluation techniques?","text":"<p>The important components of relational evaluation techniques are</p> <ul> <li>Data Acquisition</li> <li>Ground Truth Acquisition</li> <li>Cross Validation Technique</li> <li>Query Type</li> <li>Scoring Metric</li> <li>Significance Test</li> </ul>"},{"location":"chap4/9Data_ML_interview/#43-what-are-the-different-methods-for-sequential-supervised-learning","title":"43) What are the different methods for Sequential Supervised Learning?","text":"<p>The different methods to solve Sequential Supervised Learning problems are</p> <ul> <li>Sliding-window methods</li> <li>Recurrent sliding windows</li> <li>Hidden Markow models</li> <li>Maximum entropy Markow models</li> <li>Conditional random fields</li> <li>Graph transformer networks</li> </ul>"},{"location":"chap4/9Data_ML_interview/#44-what-are-the-areas-in-robotics-and-information-processing-where-sequential-prediction-problem-arises","title":"44) What are the areas in robotics and information processing where sequential prediction problem arises?","text":"<p>The areas in robotics and information processing  where sequential prediction problem arises are</p> <ul> <li>Imitation Learning</li> <li>Structured prediction</li> <li>Model based reinforcement learning</li> </ul>"},{"location":"chap4/9Data_ML_interview/#45-what-is-batch-statistical-learning","title":"45) What is batch statistical learning?","text":"<p>Statistical learning techniques allow learning a function or predictor from a set of observed data that can make predictions about unseen or future data. These techniques provide guarantees on the performance of the learned predictor on the future unseen data based on a statistical assumption on the data generating process.</p>"},{"location":"chap4/9Data_ML_interview/#46-what-is-pac-learning","title":"46)   What is PAC Learning?","text":"<p>PAC (Probably Approximately Correct) learning is a learning framework that has been introduced to analyze learning algorithms and their statistical efficiency.</p>"},{"location":"chap4/9Data_ML_interview/#47-what-are-the-different-categories-you-can-categorized-the-sequence-learning-process","title":"47) What are the different categories you can categorized the sequence learning process?","text":"<ul> <li>Sequence prediction</li> <li>Sequence generation</li> <li>Sequence recognition</li> <li>Sequential decision</li> </ul>"},{"location":"chap4/9Data_ML_interview/#48-what-is-sequence-learning","title":"48) What is sequence learning?","text":"<p>Sequence learning is a method of teaching and learning in a logical manner.</p>"},{"location":"chap4/9Data_ML_interview/#49-what-are-two-techniques-of-machine-learning","title":"49) What are two techniques of Machine Learning ?","text":"<p>The two techniques of Machine Learning are</p> <ul> <li>Genetic Programming</li> <li>Inductive Learning</li> </ul>"},{"location":"chap4/9Data_ML_interview/#50-give-a-popular-application-of-machine-learning-that-you-see-on-day-to-day-basis","title":"50) Give a popular application of machine learning that you see on day to day basis?","text":"<p>The recommendation engine implemented by major ecommerce websites uses Machine Learning.</p>"},{"location":"chap5/10reverse_string/","title":"10\u3001Reverse String","text":"<p>String =&gt; list =&gt; string</p> <pre><code>\ndef main():\n    str= \"the sky is blue\"\n    s = str.split(\" \")\n    for i in range(len(s)-1,-1,-1):\n        print(s[i],end=\" \")\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> <pre><code># output:\nblue is sky the \n</code></pre>"},{"location":"chap5/11zeroinN/","title":"11\u3001Count how many zero in <code>N!</code>","text":"<p>Count how many zero in <code>N!</code> . Please write a piece of code (prefer python) and explain the complexity of your solution (in big-O notation)</p> <pre><code>def main(n):\n\n    # Init result\n    count = 0\n\n    while(n &gt;= 5):\n        n //= 5\n        count += n\n\n    return count\n\nif __name__ == \"__main__\":\n    n = 20 \n    print(f'{n}! has {main(n)} 0')     \n</code></pre> <pre><code>$ python3 test1.py \n20! has 4 0\n</code></pre> <p>Only one while loop, so the time complexity is O(n) and no pre-defined list the space complexity is O(0)</p>"},{"location":"chap5/12JumpGame/","title":"12\u3001Jump Game","text":"<p>Given an array of non-negative integers, you are at the first position of the array. Every number of this array indicates the max steps you can walk.  Please write a piece of code (prefer python) to determine if you can reach the final position.</p> <p>For example:</p> <p>Given [2, 0, 1], you can firstly walk maximum 2 steps and reach position 3 (value is 1 in this case), which is the final position. You should return True for this case. </p> <p>Given [1, 1, 0, 4], you can't reach the final position, because you can only reach position 3 (value is 0).</p> <pre><code>def main(nums):\n    reach = 0\n    for i, num in enumerate(nums):\n        if i &gt; reach:\n            return False\n        reach = max(reach, i + int(num))\n    return True\n\nif __name__ == \"__main__\":\n    # nums = [2, 0, 1]\n    nums = [1, 1, 0, 4]\n    print(main(nums))     \n</code></pre> <pre><code>python3 test2.py \nFalse\n</code></pre>"},{"location":"chap5/13Gs_int/","title":"GS interview preparation","text":""},{"location":"chap5/13Gs_int/#char","title":"Char","text":""},{"location":"chap5/13Gs_int/#non-repeating-character","title":"Non Repeating Character","text":"<pre><code># Given a string S consisting of lowercase Latin Letters. Find the first non-repeating character in S.\n\n# Input:\n# S = hello\n# Output: h\n# Explanation: In the given string, the\n# first character which is non-repeating\n# is h, as it appears first and there is\n# no other 'h' in the string.\n\n# Input:\n# S = zxvczbtxyzvy\n# Output: c\n# Explanation: In the given string, 'c' is\n# the character which is non-repeating. \n</code></pre> <pre><code>def main(str):\n    char_order = []\n    counts = {}\n    for c in str:\n        if c in counts:\n            counts[c]+=1\n        else:\n            counts[c] = 1 \n            char_order.append(c)\n\n    for c in char_order:\n        if counts[c] == 1:\n            return c\n\n    return None\n</code></pre> <pre><code>if  __name__ == \"__main__\":\n    print(main(\"PythonforallPythonMustforall\"))\n    print(main('tutorialspointfordeveloper'))\n    print(main('AABBCC'))\n</code></pre> <pre><code>$ python 8onorepc.py \nM\nu\nNone\n</code></pre>"},{"location":"chap5/13Gs_int/#string","title":"String","text":""},{"location":"chap5/13Gs_int/#1-reverse-words-in-a-given-string","title":"1 Reverse words in a given string","text":"<pre><code># Given a String S, reverse the string without reversing its individual words. \n# Words are separated by dots.\n\n# Input:\n# S = i.like.this.program.very.much\n# Output: much.very.program.this.like.i\n# Explanation: After reversing the whole\n# string(not individual words), the input\n# string becomes\n# much.very.program.this.like.i\n\n# Input:\n# S = pqr.mno\n# Output: mno.pqr\n# Explanation: After reversing the whole\n# string , the input string becomes\n# mno.pqr\n</code></pre> <pre><code>def main(Str):\n    s = Str.split(\".\");\n    for i in range(len(s)-1,-1,-1):\n        print(s[i],end=\".\")\n\nif __name__ == \"__main__\":\n    main(\"i.like.this.program.very.much\")\n</code></pre> <p>Output</p> <pre><code>much.very.program.this.like.i.\n</code></pre>"},{"location":"chap5/13Gs_int/#find-the-first-repeated-word-in-a-string","title":"Find the first repeated word in a string","text":"<p>Given a string, Find the 1st repeated word in a string</p> <p>Examples: </p> <pre><code>Input : \"Ravi had been saying that he had been there\"\nOutput : had\n\nInput : \"Ravi had been saying that\"\nOutput : No Repetition\n\nInput : \"he had had he\"\nOutput : he\n</code></pre> <pre><code>def firstRepeatString(str):\n    char_list = []\n    counts = {}\n    count = 0\n    raw_list = str.split(' ')\n    for i in range(len(raw_list)):\n        if raw_list[i] in counts:\n            counts[raw_list[i]] += 1\n        else:\n            counts[raw_list[i]] = 1\n            char_list.append(raw_list[i])\n\n\n    for c in char_list:\n        if counts[c] &gt; 1:\n            print(c)\n            break\n\nfirstRepeatString(\"he had had he\")\n</code></pre> <pre><code>from collections import Counter \n# Python program to find the first\n# repeated character in a string\ndef firstRepeatedWord(sentence):\n\n    # splitting the string\n    lis = list(sentence.split(\" \"))\n\n    # Calculating frequency of every word\n    frequency = Counter(lis)\n\n    # Traversing the list of words\n    for i in lis:\n\n        # checking if frequency is greater than 1\n\n        if(frequency[i] &gt; 1):\n            # return the word\n            return i\n\n# Driver code\nsentence = \"Vikram had been saying that he had been there\"\nprint(firstRepeatedWord(sentence))\n</code></pre> <pre><code>$ python3 21repreatstring.py \nhad\n</code></pre>"},{"location":"chap5/13Gs_int/#_1","title":"\u6700\u957f\u516c\u5171\u524d\u7f00","text":"<p>\u7f16\u5199\u4e00\u4e2a\u51fd\u6570\u6765\u67e5\u627e\u5b57\u7b26\u4e32\u6570\u7ec4\u4e2d\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u3002</p> <p>\u5982\u679c\u4e0d\u5b58\u5728\u516c\u5171\u524d\u7f00\uff0c\u8fd4\u56de\u7a7a\u5b57\u7b26\u4e32 \"\"\u3002</p> <pre><code>\u793a\u4f8b 1:\n\n\u8f93\u5165: [\"flower\",\"flow\",\"flight\"]\n\u8f93\u51fa: \"fl\"\n\u793a\u4f8b 2:\n\n\u8f93\u5165: [\"dog\",\"racecar\",\"car\"]\n\u8f93\u51fa: \"\"\n\u89e3\u91ca: \u8f93\u5165\u4e0d\u5b58\u5728\u516c\u5171\u524d\u7f00\u3002\n\u8bf4\u660e:\n\n\u6240\u6709\u8f93\u5165\u53ea\u5305\u542b\u5c0f\u5199\u5b57\u6bcd a-z \u3002\n</code></pre> <p>Option1</p> <pre><code>\u793a\u4f8b 1:\n\n\u8f93\u5165: [\"flower\",\"flow\",\"flight\"]\n\u8f93\u51fa: \"fl\"\n\u793a\u4f8b 2:\n\n\u8f93\u5165: [\"dog\",\"racecar\",\"car\"]\n\u8f93\u51fa: \"\"\n\u89e3\u91ca: \u8f93\u5165\u4e0d\u5b58\u5728\u516c\u5171\u524d\u7f00\u3002\n\u8bf4\u660e:\n\n\u6240\u6709\u8f93\u5165\u53ea\u5305\u542b\u5c0f\u5199\u5b57\u6bcd a-z \u3002\n</code></pre> <pre><code>def longest_string(arr):\n    result = \"\"\n    for i in zip(*arr):\n        if len(set(i)) == 1:\n            result += i[0]\n        else:\n            break\n    return result\n\narr = [\"a\",\"ab\",\"abc\"]\nprint(longest_string(arr))\n</code></pre> <p>Option2</p> <pre><code>def longest_str(str):\n    if not str:\n        return \"\"\n    res = str[0]\n    i = 1\n    while i &lt; len(str):\n        while str[i].find(res) != 0:\n            res = res[0:len(res)-1]\n        i += 1\n    return res\n\nprint(longest_str([\"aabc\",\"ab\"]))\n</code></pre>"},{"location":"chap5/13Gs_int/#array","title":"Array","text":""},{"location":"chap5/13Gs_int/#two-sum","title":"Two Sum","text":"<p>\u7ed9\u5b9a\u4e00\u4e2a\u6574\u6570\u6570\u7ec4 nums \u548c\u4e00\u4e2a\u76ee\u6807\u503c target\uff0c\u8bf7\u4f60\u5728\u8be5\u6570\u7ec4\u4e2d\u627e\u51fa\u548c\u4e3a\u76ee\u6807\u503c\u7684\u90a3 \u4e24\u4e2a \u6574\u6570\uff0c\u5e76\u8fd4\u56de\u4ed6\u4eec\u7684\u6570\u7ec4\u4e0b\u6807\u3002</p> <p>\u4f60\u53ef\u4ee5\u5047\u8bbe\u6bcf\u79cd\u8f93\u5165\u53ea\u4f1a\u5bf9\u5e94\u4e00\u4e2a\u7b54\u6848\u3002\u4f46\u662f\uff0c\u4f60\u4e0d\u80fd\u91cd\u590d\u5229\u7528\u8fd9\u4e2a\u6570\u7ec4\u4e2d\u540c\u6837\u7684\u5143\u7d20\u3002</p> <pre><code>\u7ed9\u5b9a nums = [2, 7, 11, 15], target = 9\n\u56e0\u4e3a nums[0] + nums[1] = 2 + 7 = 9\n\u6240\u4ee5\u8fd4\u56de [0, 1]\n</code></pre> <p>Option1</p> <pre><code>def twoSum(nums, target):\n    \"\"\"\n    :type nums: List[int]\n    :type target: int\n    :rtype: List[int]\n    \"\"\"\n    idxDict = dict()\n    for idx, num in enumerate(nums):\n        if target - num in idxDict:\n            return [idxDict[target - num], idx]\n        idxDict[num] = idx\n\n\nnums = [2, 7, 11, 15]\ntarget = 9\n\nprint(twoSum(nums,target))\n</code></pre> <p>Option2</p> <pre><code>def twoSumNaive(num_arr, pair_sum):\n    # search first element in the array\n    for i in range(len(num_arr)-1):\n        # search other element in the array\n        for j in range(i + 1, len(num_arr)):\n        # if these two elemets sum to pair_sum, print the pair\n            if num_arr[i] + num_arr[j] == pair_sum:\n                print(\"Pair with sum\", pair_sum,\"is: (\", num_arr[i],\",\",num_arr[j],\")\")\n                print([i,j])\n\n# Driver Code\nnum_arr = [3, 5, 2, -4, 8, 11]\npair_sum = 7\n\n# Function call inside print\ntwoSumNaive(num_arr, pair_sum) \n\n# Pair with sum 7 is: ( 5 , 2 )\n# [1, 2]\n# Pair with sum 7 is: ( -4 , 11 )\n# [3, 5]\n</code></pre> <p>Option3</p> <pre><code>def twoSumHashing(num_arr, pair_sum):\n    sums = []\n    hashTable = {}\n\n    for i in range(len(num_arr)):\n        complement = pair_sum - num_arr[i]\n        if complement in hashTable:\n            print(\"Pair with sum\", pair_sum,\"is: (\", num_arr[i],\",\",complement,\")\")\n            # print([i,hashTable[pair_sum - num_arr[i]]])\n        hashTable[num_arr[i]] = num_arr[i]\n\n# Driver Code\nnum_arr = [4, 5, 1, 8]\npair_sum = 9\n\n# Calling function\ntwoSumHashing(num_arr, pair_sum)\n</code></pre>"},{"location":"chap5/13Gs_int/#check-if-two-arrays-are-equal-or-not","title":"Check if two arrays are equal or not","text":"<pre><code># Check if two arrays are equal or not\n# Given two given arrays of equal length, the task is to find if given arrays are equal or not. \n# Two arrays are said to be equal if both of them contain the same set of elements, \n# arrangements (or permutation) of elements may be different though.\n\n# Input  : arr1[] = {1, 2, 5, 4, 0};\n#          arr2[] = {2, 4, 5, 0, 1}; \n# Output : Yes\n\n# Input  : arr1[] = {1, 2, 5, 4, 0, 2, 1};\n#          arr2[] = {2, 4, 5, 0, 1, 1, 2}; \n# Output : Yes\n\n# Input : arr1[] = {1, 7, 1};\n#         arr2[] = {7, 7, 1};\n# Output : No\n</code></pre> <pre><code>def areEqual(arr1, arr2, n, m):\n\n    # If lengths of array are not\n    # equal means array are not equal\n    if (n != m):\n        return False\n\n    # Sort both arrays\n    arr1.sort()\n    arr2.sort()\n\n    # Linearly compare elements\n    for i in range(0, n - 1):\n        if (arr1[i] != arr2[i]):\n            return False\n\n    # If all elements were same.\n    return True\n\n\n# Driver Code\narr1 = [3, 5, 2, 5, 2]\narr2 = [2, 3, 5, 5, 2]\nn = len(arr1)\nm = len(arr2)\n\nif (areEqual(arr1, arr2, n, m)):\n    print(\"Yes\")\nelse:\n    print(\"No\")\n</code></pre>"},{"location":"chap5/13Gs_int/#sort-an-array-in-wave-form","title":"Sort an array in wave form","text":"<pre><code># Given an unsorted array of integers, \n# sort the array into a wave like array. \n# An array \u2018arr[0..n-1]\u2019 is sorted in wave form if arr[0] &gt;= arr[1] &lt;= arr[2] &gt;= arr[3] &lt;= arr[4] &gt;= \u2026..\n\n#  Input:  arr[] = {10, 5, 6, 3, 2, 20, 100, 80}\n#  Output: arr[] = {10, 5, 6, 2, 20, 3, 100, 80} OR\n#                  {20, 5, 10, 2, 80, 6, 100, 3} OR\n#                  any other array that is in wave form\n\n#  Input:  arr[] = {20, 10, 8, 6, 4, 2}\n#  Output: arr[] = {20, 8, 10, 4, 6, 2} OR\n#                  {10, 8, 20, 2, 6, 4} OR\n#                  any other array that is in wave form\n\n#  Input:  arr[] = {2, 4, 6, 8, 10, 20}\n#  Output: arr[] = {4, 2, 8, 6, 20, 10} OR\n#                  any other array that is in wave form\n\n#  Input:  arr[] = {3, 6, 5, 10, 7, 20}\n#  Output: arr[] = {6, 3, 10, 5, 20, 7} OR\n#                  any other array that is in wave form\n</code></pre> <pre><code># Python function to sort the array arr[0..n-1] in wave form,\n# i.e., arr[0] &gt;= arr[1] &lt;= arr[2] &gt;= arr[3] &lt;= arr[4] &gt;= arr[5]\ndef sortInWave(arr, n):\n\n    #sort the array\n    arr.sort()\n\n    # Swap adjacent elements\n    for i in range(0,n-1,2):\n        arr[i], arr[i+1] = arr[i+1], arr[i]\n\n    # Driver program\narr = [10, 90, 49, 2, 1, 5, 23]\nsortInWave(arr, len(arr))\nfor i in range(0,len(arr)):\n    print (arr[i],end=\" \")\n</code></pre>"},{"location":"chap5/13Gs_int/#stock-buy-and-sell","title":"Stock buy and sell","text":"<pre><code># The cost of stock on each day is given in an array A[] of size N. \n# Find all the days on which you buy and sell the stock so that in between those days your profit is maximum.\n# Note: There may be multiple possible solutions. \n# Return any one of them. Any correct solution will result in an output of 1, \n# whereas wrong solutions will result in an output of 0.\n\n# Input:\n# N = 7\n# A[] = {100,180,260,310,40,535,695}\n# Output:\n# 1\n# Explanation:\n# One possible solution is (0 3) (4 6)\n# We can buy stock on day 0,\n# and sell it on 3rd day, which will \n# give us maximum profit. Now, we buy \n# stock on day 4 and sell it on day 6.\n\n# Input:\n# N = 5\n# A[] = {4,2,2,2,4}\n# Output:\n# 1\n# Explanation:\n# There are multiple possible solutions.\n# one of them is (3 4)\n# We can buy stock on day 3,\n# and sell it on 4th day, which will \n# give us maximum profit.\n</code></pre> <pre><code>def maxProfit(pricelist):\n    max_profit = 0\n    result = []\n    for i in range(len(pricelist)-1):\n        for j in range(i+1, len(pricelist)):\n            profit = pricelist[j] - pricelist[i]\n            if profit &gt; max_profit:\n                max_profit = profit\n    return max_profit\n\nprint(maxProfit([100,180,260,310,40,535,695]))\n</code></pre> <pre><code>655\n</code></pre> <pre><code>class Solution:\n    def maxProfit(self, priceslist):\n        min_price = float(\"inf\")\n        max_profit = 0\n        for i in range(len(priceslist)):\n            if priceslist[i] &lt; min_price:\n                min_price = priceslist[i]\n            elif priceslist[i] - min_price &gt; max_profit:\n                max_profit = priceslist[i] - min_price\n        return max_profit\n\ns = Solution();\n\n\nprint(s.maxProfit([100,180,260,310,40,535,695]))\n</code></pre> <ul> <li><code>float(\"inf\")</code> used for setting a variable with an infinitely large value.</li> </ul>"},{"location":"chap5/13Gs_int/#1-2-3-4-5-6-7-8-9-10-8","title":"\u5728\u6570\u7ec4 <code>{ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 }</code> \u4e2d\uff0c\u67e5\u627e 8 \u662f\u5426\u51fa\u73b0\u8fc7\u3002","text":"<pre><code>def main():\n# \u9700\u8981\u67e5\u627e\u7684\u6570\u5b57\n    targetNumb = 8\n    arr = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n    middle = 0\n    low = 0\n    high = len(arr) - 1\n    isfind = 0\n\n    while low &lt;= high:\n        middle = round((low + high) /2)\n        if arr[middle] ==  targetNumb:\n            print(f\"{targetNumb} in arr, and the index is {middle}\")\n            isfind = 1\n            break\n        elif arr[middle] &gt; targetNumb:  #  \u8bf4\u660e\u8be5\u6570\u5728low~middle\u4e4b\u95f4\n            high = middle - 1\n        else:                       #  \u8bf4\u660e\u8be5\u6570\u5728middle~high\u4e4b\u95f4\n            low = middle + 1\n    if isfind == 0:\n        print(f\"{targetNumb} is not in the arr\")\n\n\nif __name__ == \"__main__\":\n    main()\n\n# \u4e8c\u5206\u67e5\u627e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(logn)\uff0c\n</code></pre>"},{"location":"chap5/13Gs_int/#sort","title":"Sort","text":""},{"location":"chap5/13Gs_int/#bubble-sort","title":"Bubble Sort","text":"<pre><code># \u5192\u6ce1\u6392\u5e8f\u6700\u597d\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(n)\n# \u5192\u6ce1\u6392\u5e8f\u6700\u574f\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u6bd4\u8f83\u60e8\uff0c\u662f O(n*n)\u3002\n\n# \u4ece\u7b2c\u4e00\u4e2a\u6570\u636e\u5f00\u59cb\uff0c\u4f9d\u6b21\u6bd4\u8f83\u76f8\u90bb\u5143\u7d20\u7684\u5927\u5c0f\u3002\u5982\u679c\u524d\u8005\u5927\u4e8e\u540e\u8005\uff0c\u5219\u8fdb\u884c\u4ea4\u6362\u64cd\u4f5c\uff0c\u628a\u5927\u7684\u5143\u7d20\u5f80\u540e\u4ea4\u6362\u3002\u901a\u8fc7\u591a\u8f6e\u8fed\u4ee3\uff0c\u76f4\u5230\u6ca1\u6709\u4ea4\u6362\u64cd\u4f5c\u4e3a\u6b62\n\ndef main():\n    arr = [ 1, 0, 3, 4, 5, -6, 7, 8, 9, 10 ]\n    print(f\"The the original data order: {arr}\")\n    for i in range(1,len(arr)):           # Start from 2nd one\n        for j in range(0, len(arr)-i):    # Start from 1st one\n           if arr[j] &gt; arr[j+1]:\n               temp = arr[j]\n               arr[j] = arr[j + 1]\n               arr[j + 1] = temp\n\n    print(f\"The the Bubble sort data order: {arr}\")\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"chap5/13Gs_int/#insert-sort","title":"Insert Sort","text":"<pre><code># 1\u3001\u63d2\u5165\u6392\u5e8f\u7684\u539f\u7406\n# \u9009\u53d6\u672a\u6392\u5e8f\u7684\u5143\u7d20\uff0c\u63d2\u5165\u5230\u5df2\u6392\u5e8f\u533a\u95f4\u7684\u5408\u9002\u4f4d\u7f6e\uff0c\u76f4\u5230\u672a\u6392\u5e8f\u533a\u95f4\u4e3a\u7a7a\n# \u63d2\u5165\u6392\u5e8f\u7684\u5e73\u5747\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(n*n)\u3002\n\ndef main():\n    arr = [ 2, 3, 5, 1, 23, 6, 78, 34 ]\n    print(f\"The the original data order: {arr}\")\n    for i in range(1,len(arr)):\n        temp = arr[i]\n        j = i - 1\n        for j in range(j,0-1):\n            if  arr[j] &gt; temp:\n                arr[j+1] = arr[j]\n            else:\n                break\n        arr[j+1] = temp\n\n    print(f\"The the sorted data order: {arr}\")\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"chap5/13Gs_int/#merge-sort","title":"Merge Sort","text":"<pre><code>import sys\n\ndef merge_sort(A):\n    merge_sort2(A, 0, len(A)-1)\n\ndef merge_sort2(A, first, last):\n#  In Python 3, they made the / operator do a floating-point division, \n#  and added the // operator to do integer division \n    if first &lt; last:\n        middle = (first + last)//2\n        merge_sort2(A, first, middle)\n        merge_sort2(A, middle+1, last)\n        merge(A, first, middle, last)\n\ndef merge(A, first, middle, last):\n    L = A[first:middle+1]\n    R = A[middle+1:last+1]\n    L.append(sys.maxsize)  #Reach the end of list\n    R.append(sys.maxsize)\n    i = j = 0\n    #Index i for left half and j for the right half\n    #Initialize was 0\n\n    for k in range (first, last+1):\n        if L[i] &lt;= R[j]:\n            A[k] = L[i]\n            i += 1\n        else:\n            A[k] = R[j]\n            j += 1\n\nA = [5,9,1,2,4,8,6,3,7]\nprint(A)\nmerge_sort(A)\nprint(A)\n</code></pre>"},{"location":"chap5/13Gs_int/#quick-sort","title":"Quick Sort","text":"<pre><code># This Function handles sorting part of quick sort\n# start and end points to first and last element of\n# an array respectively\ndef partition(start, end, array):\n\n    # Initializing pivot's index to start\n    pivot_index = start\n    pivot = array[pivot_index]\n\n    # This loop runs till start pointer crosses\n    # end pointer, and when it does we swap the\n    # pivot with element on end pointer\n    while start &lt; end:\n\n        # Increment the start pointer till it finds an\n        # element greater than  pivot\n        while start &lt; len(array) and array[start] &lt;= pivot:\n            start += 1\n\n        # Decrement the end pointer till it finds an\n        # element less than pivot\n        while array[end] &gt; pivot:\n            end -= 1\n\n        # If start and end have not crossed each other,\n        # swap the numbers on start and end\n        if(start &lt; end):\n            array[start], array[end] = array[end], array[start]\n\n    # Swap pivot element with element on end pointer.\n    # This puts pivot on its correct sorted place.\n    array[end], array[pivot_index] = array[pivot_index], array[end]\n\n    # Returning end pointer to divide the array into 2\n    return end\n\n# The main function that implements QuickSort\ndef quick_sort(start, end, array):\n\n    if (start &lt; end):\n\n        # p is partitioning index, array[p]\n        # is at right place\n        p = partition(start, end, array)\n\n        # Sort elements before partition\n        # and after partition\n        quick_sort(start, p - 1, array)\n        quick_sort(p + 1, end, array)\n\n# Driver code\narray = [ 10, 7, 8, 9, 1, 5 ]\nquick_sort(0, len(array) - 1, array)\n\nprint(f'Sorted array: {array}')\n</code></pre>"},{"location":"chap5/13Gs_int/#tree","title":"Tree","text":""},{"location":"chap5/13Gs_int/#sum-tree","title":"Sum Tree","text":"<pre><code># Given a Binary Tree. Return true if, for every node X in the tree other than the leaves, \n# its value is equal to the sum of its left subtree's value and its right subtree's value. Else return false.\n\n# An empty tree is also a Sum Tree as the sum of an empty tree can be considered to be 0. \n# A leaf node is also considered a Sum Tree.\n\n# Input:\n#     3\n#   /   \\    \n#  1     2\n\n# Output: 1\n# Explanation:\n# The sum of left subtree and right subtree is\n# 1 + 2 = 3, which is the value of the root node.\n# Therefore,the given binary tree is a sum tree.\n</code></pre> <pre><code># A class to store a binary tree node\nclass Node:\n    def __init__(self, key=None, left=None, right=None):\n        self.key = key\n        self.left = left\n        self.right = right\n\n\n# Recursive function to check if a given binary tree is a sum tree or not\ndef isSumTree(root):\n\n    # base case: empty tree\n    if root is None:\n        return 0\n\n    # special case: leaf node\n    if root.left is None and root.right is None:\n        return root.key\n\n    left = isSumTree(root.left)\n    right = isSumTree(root.right)\n\n    # if the root's value is equal to the sum of all elements present in its\n    # left and right subtree\n    if left != -sys.maxsize and right != -sys.maxsize and root.key == left + right:\n        return 2 * root.key\n\n    return -sys.maxsize\n\n\nif __name__ == '__main__':\n\n#   Construct the following tree\n#              44\n#             /  \\\n#            /    \\\n#           9     13\n#          / \\    / \\\n#         4   5  6   7\n    root = Node(44)\n    root.left = Node(9)\n    root.right = Node(13)\n    root.left.left = Node(4)\n    root.left.right = Node(5)\n    root.right.left = Node(6)\n    root.right.right = Node(7)\n\n    if isSumTree(root) != -sys.maxsize:\n        print('Binary tree is a sum tree')\n    else:\n        print('Binary tree is not a sum tree')\n</code></pre>"},{"location":"chap5/13Gs_int/#binary-tree-to-dll","title":"Binary Tree to DLL","text":"<pre><code># Given a Binary Tree (BT), convert it to a Doubly Linked List(DLL) In-Place. \n# The left and right pointers in nodes are to be used as previous and next pointers respectively in converted DLL. \n# The order of nodes in DLL must be same as Inorder of the given Binary Tree. \n# The first node of Inorder traversal (leftmost node in BT) must be the head node of the DLL.\n\n# Input:\n#       1\n#     /  \\\n#    3    2\n# Output:\n# 3 1 2 \n# 2 1 3 \n# Explanation: DLL would be 3&lt;=&gt;1&lt;=&gt;2\n\n# Input:\n#        10\n#       /   \\\n#      20   30\n#    /   \\\n#   40   60\n# Output:\n# 40 20 60 10 30 \n# 30 10 60 20 40\n# Explanation:  DLL would be \n# 40&lt;=&gt;20&lt;=&gt;60&lt;=&gt;10&lt;=&gt;30.\n\n#Represent a node of binary tree    \nclass Node:    \n    def __init__(self,data):    \n        self.data = data;    \n        self.left = None;    \n        self.right = None;    \n\nclass BinaryTreeToDLL:    \n    def __init__(self):    \n        #Represent the root of binary tree    \n        self.root = None;    \n        #Represent the head and tail of the doubly linked list    \n        self.head = None;    \n        self.tail = None;    \n\n    #convertbtToDLL() will convert the given binary tree to corresponding doubly linked list    \n    def convertbtToDLL(self, node):    \n        #Checks whether node is None    \n        if(node == None):    \n            return;    \n\n        #Convert left subtree to doubly linked list    \n        self.convertbtToDLL(node.left);    \n\n        #If list is empty, add node as head of the list    \n        if(self.head == None):    \n            #Both head and tail will point to node    \n            self.head = self.tail = node;    \n        #Otherwise, add node to the end of the list    \n        else:    \n            #node will be added after tail such that tail's right will point to node    \n            self.tail.right = node;    \n            #node's left will point to tail    \n            node.left = self.tail;    \n            #node will become new tail    \n            self.tail = node;    \n\n        #Convert right subtree to doubly linked list    \n        self.convertbtToDLL(node.right);    \n\n    #display() will print out the nodes of the list    \n    def display(self):    \n        #Node current will point to head    \n        current = self.head;    \n        if(self.head == None):    \n            print(\"List is empty\");    \n            return;    \n        print(\"Nodes of generated doubly linked list: \");    \n        while(current != None):    \n            #Prints each node by incrementing pointer.    \n            print(current.data),    \n            current = current.right; \n\nbt = BinaryTreeToDLL();    \n#Add nodes to the binary tree    \nbt.root = Node(1);    \nbt.root.left = Node(2);    \nbt.root.right = Node(3);    \nbt.root.left.left = Node(4);    \nbt.root.left.right = Node(5);    \nbt.root.right.left = Node(6);    \nbt.root.right.right = Node(7);    \n\n#Converts the given binary tree to doubly linked list    \nbt.convertbtToDLL(bt.root);    \n\n#Displays the nodes present in the list    \nbt.display();                        \n</code></pre> <pre><code>$ python3 11btdll.py \nNodes of generated doubly linked list: \n4\n2\n5\n1\n6\n3\n7\n</code></pre>"},{"location":"chap5/13Gs_int/#determine-if-a-binary-tree-is-height-balanced","title":"determine if a binary tree is height-balanced?","text":"<pre><code># How to determine if a binary tree is height-balanced?\n# A tree where no leaf is much farther away from the root than any other leaf. \n# Different balancing schemes allow different definitions of \u201cmuch farther\u201d and different amounts of work to keep them balanced.\n# Consider a height-balancing scheme where following conditions should be checked to determine if a binary tree is balanced. \n\n# An empty tree is height-balanced. A non-empty binary tree T is balanced if: \n# 1) Left subtree of T is balanced \n# 2) Right subtree of T is balanced \n# 3) The difference between heights of left subtree and right subtree is not more than 1. \n# The above height-balancing scheme is used in AVL trees. \n# The diagram below shows two trees, one of them is height-balanced and other is not. \n# The second tree is not height-balanced because height of left subtree is 2 more than height of right subtree.\n</code></pre> <p>The difference between heights of left subtree and right subtree is not more than 1.</p> <pre><code>class Node:\n    # Constructor to create a new Node\n    def __init__(self, data):\n        self.data = data\n        self.left = None\n        self.right = None\n\n# function to find height of binary tree\ndef height(root):\n\n    # base condition when binary tree is empty\n    if root is None:\n        return 0\n    return max(height(root.left), height(root.right)) + 1\n\n# function to check if tree is height-balanced or not\ndef isBalanced(root):\n\n    # Base condition\n    if root is None:\n        return True\n\n    # for left and right subtree height\n    lh = height(root.left)\n    rh = height(root.right)\n\n    # allowed values for (lh - rh) are 1, -1, 0\n    if (abs(lh - rh) &lt;= 1) and isBalanced(\n    root.left) is True and isBalanced( root.right) is True:\n        return True\n\n    # if we reach here means tree is not\n    # height-balanced tree\n    return False\n\n# Driver function to test the above function\nroot = Node(1)\nroot.left = Node(2)\nroot.right = Node(3)\nroot.left.left = Node(4)\nroot.left.right = Node(5)\nroot.left.left.left = Node(8)\nif isBalanced(root):\n    print(\"Tree is balanced\")\nelse:\n    print(\"Tree is not balanced\")\n</code></pre> <pre><code>$ python3 16blheight.py \nTree is not balanced\n</code></pre>"},{"location":"chap5/13Gs_int/#find-the-kth-smallest-element-in-a-given-a-binary-search-tree-bst","title":"Find the kth smallest element in a given a binary search tree (BST)","text":"<p>Write a Python program to find the kth smallest element in a given a binary search tree.</p> <pre><code>class TreeNode(object):\n    def __init__(self, x):\n        self.val = x\n        self.left = None\n        self.right = None\n\ndef kth_smallest(root, k):\n    stack = []\n    while root or stack:\n        while root:\n            stack.append(root)\n            root = root.left\n        root = stack.pop()\n        k -= 1\n        if k == 0:\n            break\n        root = root.right\n    return root.val\n\nroot = TreeNode(8)  \nroot.left = TreeNode(5)  \nroot.right = TreeNode(14) \nroot.left.left = TreeNode(4)  \nroot.left.right = TreeNode(6) \nroot.left.right.left = TreeNode(8)  \nroot.left.right.right = TreeNode(7)  \nroot.right.right = TreeNode(24) \nroot.right.right.left = TreeNode(22)  \n\nprint(kth_smallest(root, 2))\nprint(kth_smallest(root, 3))\n</code></pre> <pre><code>5\n8\n</code></pre>"},{"location":"chap5/13Gs_int/#given-the-root-of-a-binary-tree-determine-if-it-is-a-valid-binary-search-tree-bst","title":"Given the root of a binary tree, determine if it is a valid binary search tree (BST).","text":"<pre><code># A valid BST is defined as follows:\n\n# The left subtree of a node contains only nodes with keys less than the node's key.\n# The right subtree of a node contains only nodes with keys greater than the node's key.\n# Both the left and right subtrees must also be binary search trees.\n\n# Input: root = [2,1,3]\n# Output: true\n\n# Input: root = [5,1,4,null,null,3,6]\n# Output: false\n# Explanation: The root node's value is 5 but its right child's value is 4.\n</code></pre> <p>Option1</p> <pre><code>class Solution:\n    def isValidateBST(self, root):\n        def dfs(lower, upper, node):\n            if not node:\n                return true\n            elif node.val&lt;=lower or node.val &gt;= upper:\n                return False\n            else:\n                return dfs(lower, node.val, node.left) and dfs(node.val, upper, node.right)\n\n        return dfs(float('-inf'),float('inf'),root)\n</code></pre> <p>Option2</p> <pre><code>def isValidBST(self, root):\n        if not root:\n            return True\n\n        def inOrder(root, order):\n            if root is None:\n                return\n            inOrder(root.left, order)\n            order.append(root.val)\n            inOrder(root.right, order)\n\n        order = []\n        inOrder(root, order)\n        for i in range(1, len(order)):\n            if order[i] &lt;= order[i-1]:\n                return False\n        return True\n\n</code></pre>"},{"location":"chap5/13Gs_int/#tree-order","title":"Tree Order","text":"<p>preorder</p> <pre><code># \u5148\u5e8f\u904d\u5386\n\nclass Node:\n    def __init__(self, data):\n        self.left = None\n        self.right = None\n        self.data = data\n\n# Insert Node\n    def insert(self, data):\n\n        if self.data:\n            if data &lt; self.data:\n                if self.left is None:\n                    self.left = Node(data)\n                else:\n                    self.left.insert(data)\n            elif data &gt; self.data:\n                if self.right is None:\n                    self.right = Node(data)\n                else:\n                    self.right.insert(data)\n        else:\n            self.data = data\n\n# Print the Tree\n    def PrintTree(self):\n        if self.left:\n            self.left.PrintTree()\n        print(self.data),\n        if self.right:\n            self.right.PrintTree()\n# Preorder traversal\n# Root -&gt; Left -&gt;Right\n    def PreorderTraversal(self, root):\n        res = []\n        if root:\n            res.append(root.data)\n            res = res + self.PreorderTraversal(root.left)\n            res = res + self.PreorderTraversal(root.right)\n        return res\n\nroot = Node(27)\nroot.insert(14)\nroot.insert(35)\nroot.insert(10)\nroot.insert(19)\nroot.insert(31)\nroot.insert(42)\nprint(root.PreorderTraversal(root))\n</code></pre> <p>Inorder traversal</p> <pre><code># Inorder traversal\n# Left -&gt; Root -&gt; Right\n\ndef inorderTraversal(self, root):\n        res = []\n        if root:\n            res = self.inorderTraversal(root.left)\n            res.append(root.data)\n            res = res + self.inorderTraversal(root.right)\n        return res\n</code></pre> <p>Postorder traversal</p> <pre><code>def PostorderTraversal(self, root):\n        res = []\n        if root:\n            res = self.PostorderTraversal(root.left)\n            res = res + self.PostorderTraversal(root.right)\n            res.append(root.data)\n        return res\n</code></pre>"},{"location":"chap5/13Gs_int/#stack","title":"Stack","text":""},{"location":"chap5/13Gs_int/#get-minimum-element-from-stack","title":"Get minimum element from stack","text":"<pre><code># Design a stack that supports push, pop, top, and retrieving the minimum element in constant time.\n\n# push(x) -- Push element x onto stack.\n\n# pop() -- Removes the element on top of the stack.\n\n# top() -- Get the top element.\n\n# getMin() -- Retrieve the minimum element in the stack.\n\n# Example:\n\n# MinStack minStack = new MinStack(); \n# minStack.push(-2); minStack.push(0); minStack.push(-3); minStack.getMin ....\n\n</code></pre> <pre><code>class MinStack:\n    def __init__(self):\n        self.stack = []\n        self.min = []\n        self.size = 0\n\n# Inserts a given element on top of the stack\n    def push(self, val):\n        if self.size == 0:\n            self.min.append(val)\n        else:\n            if val &lt;= self.min[-1]:\n                self.min.append(val)\n        self.stack.append(val)\n        self.size += 1\n\n    def pop(self):\n        tmp = self.stack.pop()\n        self.size -= 1\n        if tmp == self.min[-1]:\n            self.min.pop()\n\n    def top(self):\n        return self.stack[-1]\n\n    def getMin(self):\n        return self.min[-1]\n\n\nif __name__ == '__main__':\n\n    s = MinStack()\n\n    s.push(6)\n    print(s.getMin())\n\n    s.push(7)\n    print(s.getMin())\n\n    s.push(5)\n    print(s.getMin())\n\n    s.push(3)\n    print(s.getMin())\n\n    s.pop()\n    print(s.getMin())\n\n    s.pop()\n    print(s.getMin())\n</code></pre> <pre><code>$ python3 10minstck.py \n6\n6\n5\n3\n5\n6\n</code></pre>"},{"location":"chap5/13Gs_int/#queue-using-stacks","title":"Queue using Stacks","text":"<pre><code># Queue using Stacks\n# We are given a stack data structure with push and pop operations, \n# the task is to implement a queue using instances of stack data structure and operations on them.\n\n\n# Python3 program to implement Queue using\n# two stacks with costly deQueue()\n</code></pre> <pre><code>class Queue:\n    def __init__(self):\n        self.s1 = []\n        self.s2 = []\n\n    # EnQueue item to the queue\n    def enQueue(self, x):\n        self.s1.append(x)\n\n    # DeQueue item from the queue\n    def deQueue(self):\n\n        # if both the stacks are empty\n        if len(self.s1) == 0 and len(self.s2) == 0:\n            print(\"Q is Empty\")\n            return\n\n        # if s2 is empty and s1 has elements\n        elif len(self.s2) == 0 and len(self.s1) &gt; 0:\n            while len(self.s1):\n                temp = self.s1.pop()\n                self.s2.append(temp)\n            return self.s2.pop()\n\n        else:\n            return self.s2.pop()\n\n    # Driver code\nif __name__ == '__main__':\n    q = Queue()\n    q.enQueue(1)\n    q.enQueue(2)\n    q.enQueue(3)\n\n    print(q.deQueue())\n    print(q.deQueue())\n    print(q.deQueue())\n</code></pre>"},{"location":"chap5/13Gs_int/#_2","title":"\u7ed9\u5b9a\u4e00\u4e2a\u53ea\u5305\u62ec '('\uff0c')'\uff0c'{'\uff0c'}'\uff0c'['\uff0c']' \u7684\u5b57\u7b26\u4e32\uff0c\u5224\u65ad\u5b57\u7b26\u4e32\u662f\u5426\u6709\u6548\u3002","text":"<pre><code># \u6709\u6548\u5b57\u7b26\u4e32\u9700\u6ee1\u8db3\uff1a\u5de6\u62ec\u53f7\u5fc5\u987b\u4e0e\u76f8\u540c\u7c7b\u578b\u7684\u53f3\u62ec\u53f7\u5339\u914d\uff0c\u5de6\u62ec\u53f7\u5fc5\u987b\u4ee5\u6b63\u786e\u7684\u987a\u5e8f\u5339\u914d\u3002\n# \u4f8b\u5982\uff0c{ [ ( ) ( ) ] } \u662f\u5408\u6cd5\u7684\uff0c\u800c { ( [ ) ] } \u662f\u975e\u6cd5\u7684\u3002\n</code></pre> <pre><code>def main():\n    s =  \"{[()()]}\"\n    print(isLegal(s))\n    # print(s[0])\n    # print(isLeft(s))\n\ndef isLeft(c):\n    if c == '{' or c == '(' or c == '[':\n        return 1\n    else:\n        return 0\n\ndef isPair(p, curr):\n    if ( p == '{' and curr == '}' ) or ( p == '(' and curr == ')') or (p == '[' and curr == ']'):\n        return 1\n    else:\n        return 0\n\ndef isLegal(s):\n    stack = []\n    for i in range(0,len(s)):\n        curr = s[i]\n        if isLeft(curr) == 1:\n            stack.append(curr)\n        else:\n            if len(stack) == 0:\n                return \"Illegal\"\n            p = stack.pop()\n            if isPair(p, curr) == 0:\n                return \"Illegal\"\n\n    if len(stack) == 0:\n        return \"Legal\"\n    else:\n        return \"Illegal\"\n\nif __name__ == '__main__':\n    main()\n</code></pre>"},{"location":"chap5/13Gs_int/#linked-lists","title":"Linked lists","text":""},{"location":"chap5/13Gs_int/#intersection-point-in-y-shapped-linked-lists","title":"Intersection Point in Y Shapped Linked Lists","text":"<pre><code># Given two singly linked lists of size N and M, \n# write a program to get the point where two linked lists intersect each other.\n# Input:\n# LinkList1 = 3-&gt;6-&gt;9-&gt;common\n# LinkList2 = 10-&gt;common\n# common = 15-&gt;30-&gt;NULL\n# Output: 15\n\n# Input: \n# Linked List 1 = 4-&gt;1-&gt;common\n# Linked List 2 = 5-&gt;6-&gt;1-&gt;common\n# common = 8-&gt;4-&gt;5-&gt;NULL\n# Output: 8\n# Explanation: \n</code></pre> <pre><code># 4              5\n# |              |\n# 1              6\n#  \\             /\n#   8   -----  1 \n#    |\n#    4\n#    |\n#   5\n#   |\n#   NULL  \n\n</code></pre> <pre><code># defining a node for LinkedList\nclass Node:\n  def __init__(self,data):\n    self.data=data\n    self.next=None\n\n\n\ndef getIntersectionNode(head1,head2):\n\n  #finding the total number of elements in head1 LinkedList\n    c1=getCount(head1)\n\n  #finding the total number of elements in head2 LinkedList\n    c2=getCount(head2)\n\n  #Traverse the bigger node by 'd' so that from that node onwards, both LinkedList\n  #would be having same number of nodes and we can traverse them together.\n    if c1 &gt; c2:\n        d=c1-c2\n        return _getIntersectionNode(d,head1,head2)\n    else:\n        d=c2-c1\n        return _getIntersectionNode(d,head2,head1)\n\n\ndef _getIntersectionNode(d,head1,head2):\n\n\n    current1=head1\n    current2=head2\n\n\n    for i in range(d):\n        if current1 is None:\n            return -1\n        current1=current1.next\n\n    while current1 is not None and current2 is not None:\n\n    # Instead of values, we need to check if there addresses are same\n    # because there can be a case where value is same but that value is\n    #not an intersecting point.\n        if current1 is current2:\n            return current1.data # or current2.data ( the value would be same)\n\n        current1=current1.next\n        current2=current2.next\n\n  # Incase, we are not able to find our intersecting point.\n    return -1\n\n#Function to get the count of a LinkedList\ndef getCount(node):\n    cur=node\n    count=0\n    while cur is not None:\n        count+=1\n        cur=cur.next\n    return count\n\n\nif __name__ == '__main__':\n  # Creating two LinkedList\n  # 1st one: 3-&gt;6-&gt;9-&gt;15-&gt;30\n  # 2nd one: 10-&gt;15-&gt;30\n  # We can see that 15 would be our intersection point\n\n  # Defining the common node\n\n  common=Node(15)\n\n  #Defining first LinkedList\n\n  head1=Node(3)\n  head1.next=Node(6)\n  head1.next.next=Node(9)\n  head1.next.next.next=common\n  head1.next.next.next.next=Node(30)\n\n  # Defining second LinkedList\n\n  head2=Node(10)\n  head2.next=common\n  head2.next.next=Node(30)\n\n  print(\"The node of intersection is \",getIntersectionNode(head1,head2))\n</code></pre> <pre><code>python3 12listinterction.py \nThe node of intersection is  15\n</code></pre>"},{"location":"chap5/13Gs_int/#reverse-linked-list","title":"Reverse Linked List","text":"<p>Reverse a singly linked list.</p> <p>Explanation: head -&gt; prev(None); move pointer: head -&gt; head.next, prev -&gt; head</p> <p>Iteratively</p> <pre><code># Definition for singly-linked list.\n# class ListNode(object):\n#     def __init__(self, x):\n#         self.val = x\n#         self.next = None\n\nclass Solution(object):\n    def reverseList(self, head):\n        \"\"\"\n        :type head: ListNode\n        :rtype: ListNode\n        \"\"\"\n        next = None\n        while head:\n            head.next, head, next = next, head.next, head\n        return next # ***important***\n</code></pre> <ul> <li>Recursion</li> </ul> <pre><code> # Definition for singly-linked list.\n# class ListNode(object):\n#     def __init__(self, x):\n#         self.val = x\n#         self.next = None\n\nclass Solution(object):\n    def reverseList(self, head):\n        \"\"\"\n        :type head: ListNode\n        :rtype: ListNode\n        \"\"\"\n        return self.reverse(head)\n\n    def reverse(self, node, prev=None):\n        if not node:\n            return prev\n        n = node.next\n        node.next = prev\n\n        return self.reverse(n, node)\n</code></pre>"},{"location":"chap5/13Gs_int/#others","title":"Others","text":""},{"location":"chap5/13Gs_int/#two-rectangles-overlap-or-not","title":"two rectangles overlap or not","text":"<pre><code>#  \n# Given two rectangles, find if the given two rectangles overlap or not. \n# A rectangle is denoted by providing the x and y coordinates of two points: \n# the left top corner and the right bottom corner of the rectangle. \n# Two rectangles sharing a side are considered overlapping. \n# (L1 and R1 are the extreme points of the first rectangle and L2 and R2 are the extreme points of the second rectangle).\n\n\n# Input:\n# L1=(0,10)\n# R1=(10,0)\n# L2=(5,5)\n# R2=(15,0)\n# Output:\n# 1\n# Explanation:\n# The rectangles overlap.\n\n# Input:\n# L1=(0,2)\n# R1=(1,1)\n# L2=(-2,0)\n# R2=(0,-3)\n# Output:\n# 0\n# Explanation:\n# The rectangles do not overlap.\n\n# Python program to check if rectangles overlap\n</code></pre> <pre><code># Python program to check if rectangles overlap\nclass Point:\n    def __init__(self, x, y):\n        self.x = x\n        self.y = y\n\ndef doOverlap(l1, r1, l2, r2):\n    # To check if either rectangle is actually a line\n    # For example  :  l1 ={-1,0}  r1={1,1}  l2={0,-1}  r2={0,1}\n    # the line cannot have positive overlap\n    if(l1.x== r1.x or l1.y == r1.y or l2.x == r2.x or l2.y == r2.y):\n        return False\n\n    # If one rectangle is on left side of other\n    if(l1.x &gt;= r2.x or l2.x &gt;= r1.x):\n        return False\n\n    # If one rectangle is above other\n    if(r1.y &gt;= l2.y or r2.y &gt;= l1.y):\n        return False\n\n\n    return True\n\n# Driver Code\nif __name__ == \"__main__\":\n    l1 = Point(0, 10)\n    r1 = Point(10, 0)\n    l2 = Point(5, 5)\n    r2 = Point(15, 0)\n\n    if(doOverlap(l1, r1, l2, r2)):\n        print(\"Rectangles Overlap\")\n    else:\n        print(\"Rectangles Don't Overlap\")\n</code></pre> <pre><code>def doOverlap(l1, r1, l2, r2):\n    if(l1[0] == r1[0] or l1[1] == r1[1] or l2[0] == r2[0] or l2[1] == r2[1]):\n        return False\n\n    if(l1[0] &gt;= r2[0] or l2[0] &gt;= r1[0]):\n        return False\n\n    if(r1[1] &gt;= l2[1] or r2[1] &gt;= l1[1]):\n        return False\n\n    return True\n\nif __name__ == \"__main__\":\n    l1=[0, 10]\n    r1=[10, 0]  \n    l2=[5, 5]  \n    r2=[15, 0]\n\n    if(doOverlap(l1, r1, l2, r2)):\n        print(\"Rectangles Overlap\")\n    else:\n        print(\"Rectangles Don't Overlap\")\n</code></pre>"},{"location":"chap5/1Apple_3sum/","title":"1\u3001Apple Interview(3Sum)","text":""},{"location":"chap5/1Apple_3sum/#1-three-sum","title":"1 Three Sum","text":"<p>Given an array nums of n integers, are there elements a, b, c in nums such that a + b + c = 0? </p> <p>Find all unique triplets in the array which gives the sum of zero.</p>"},{"location":"chap5/1Apple_3sum/#my-solution","title":"My Solution","text":"<pre><code>def main(arr,n):\n    found = False\n    raw_results = {}\n    results = {}\n    for i in range(0, n-2):\n        for j in range(i+1, n-1):\n            for k in range(j+1, n):\n                if (arr[i] + arr[j] + arr[k] == 0):\n                    raw_results.update({i:sorted([arr[i],arr[j],arr[k]])})\n\n\n    for key,value in raw_results.items():\n        if value not in results.values():\n            results[key] = value    \n\n    return results\n\nif __name__ == \"__main__\":\n    arr = [0, 0, -1, -1, 2, -3, 1, 1]\n    n = len(arr)\n    print(main(arr,n))     \n</code></pre> <pre><code>{0: [-1, 0, 1], 2: [-1, -1, 2], 4: [-3, 1, 2]}\n</code></pre>"},{"location":"chap5/1Apple_3sum/#remove-duplicate-from-dictionary","title":"Remove duplicate from dictionary","text":"<pre><code>result = {}\n\nfor key,value in raw_results.items():\n        if value not in results.values():\n            results[key] = value  \n</code></pre>"},{"location":"chap5/1Apple_3sum/#2-maximum-distance-in-arrays","title":"2 Maximum Distance in Arrays","text":"<pre><code>\"\"\"\nInput: \n[[1,2,3],\n [4,5],\n [1,2,3]]\nOutput: 4\nExplanation: \nOne way to reach the maximum distance 4 is to pick 1 in the first or third array and pick 5 in the second array.\n\"\"\"\n</code></pre> <pre><code># Given m arrays, and each array is sorted in ascending order. \n# Now you can pick up two integers from two different arrays (each array picks one) \n# and calculate the distance. We define the distance between two integers a and b to be their absolute difference |a-b|. \n# Your task is to find the maximum distance.\n\n\"\"\"\nInput: \n[[1,2,3],\n [4,5],\n [1,2,3]]\nOutput: 4\nExplanation: \nOne way to reach the maximum distance 4 is to pick 1 in the first or third array and pick 5 in the second array.\n\"\"\"\n\n\nclass Solution(object):\n    def maxDistance(self, nums):\n    # \"\"\"\n    # :type arrays: List[List[int]]\n    # :rtype: int\n    # \"\"\"  \n        low = float('inf')\n        high = float('-inf')\n        res = 0\n        for num in nums:\n            # We can use num[0] &amp;&amp; num[-1] only because these lists are sorted\n            res = max(res, max(high - num[0], num[-1] - low))\n            low = min(low, min(num))\n            high = max(high, max(num))\n        # return low\n        return res\n\n\nlist = [[1,2,3],[4,5], [1,2,3]]\ns = Solution()\nprint(s.maxDistance(list)) \n\n#  python 1mda_624.py \n# 4\n</code></pre>"},{"location":"chap5/2Python_interview/","title":"2\u3001Python Interview","text":""},{"location":"chap5/2Python_interview/#1string","title":"1\u3001String","text":"<pre><code>message = \"\"\"Assassain Creed\nNothing is true, everthing is permitted\"\"\"\n\nprint(message)\nprint(len(message))\n\n\n# output:\nAssassain Creed\nNothing is true, everthing is permitted\n55\n</code></pre> <pre><code>a = [1,2,3,4]\nb = 'sample string'\n\nprint(str(a))\nprint(repr(a))\n\nprint(str(b))\n# sample string\nprint(repr(b))\n# 'sample string'\n</code></pre>"},{"location":"chap5/2Python_interview/#1-1-slice","title":"1-1 slice","text":"<pre><code>print(message[10:15])\n#first bracket include the letter, but the second does not\n\n# Creed\n\nprint(message[:10])\n# Assassain\n</code></pre>"},{"location":"chap5/2Python_interview/#1-2-func","title":"1-2 func","text":"<pre><code>print(message.lower())\nprint(message.upper())\n\nprint('Count how many e inside the \"message\" ')\nprint(message.count('e'))\nprint(message.find('true')) \n\n# 7\n# 27\n</code></pre> <pre><code>new_message=message.replace(\"Nothing is true, everthing is permitted\", \"We work in dark and serve the light\")\nprint(new_message)\n\n# Assassain Creed\n# We work in dark and serve the light\n</code></pre>"},{"location":"chap5/2Python_interview/#1-3-format","title":"1-3 format","text":"<pre><code>greet_msg_format = '{}, {} Chao'.format(greet, name)\nprint(greet_msg_format)\n\n\ngreet_msg_f= f'{greet.upper()}, {name} Jacob'\nprint(greet_msg_f)\n</code></pre>"},{"location":"chap5/2Python_interview/#2digit","title":"2\u3001Digit","text":"<pre><code>num = 3\nprint (type(num))\n\nnum += 1\nprint (num)\n\nprint (\"-3 abs is\", abs (-3))\nprint (\"3.75 round is\",round(3.75))\nprint (\"3.75 at 1 digit round is\",round(3.75, 1))\n</code></pre> <pre><code># output\n&lt;class 'int'&gt;\n4\n-3 abs is 3\n3.75 round is 4\n3.75 at 1 digit round is 3.8\n</code></pre>"},{"location":"chap5/2Python_interview/#3list","title":"3\u3001List","text":"<pre><code>list = [\" \", \" \", \" \", \" \" ,\" \"]\nAC_list = ['Origin', 'Revolution', 'Syndicate', 'Chronicles', 'Odyssey']\nprint (AC_list)\nprint ('Lenth of assassin creed list:', len(AC_list))  \n\nprint (AC_list[4])                              # Odyssey             \nprint (AC_list[-1])                             # Odyssey\nprint (AC_list[2:])                             # ['Syndicate', 'Chronicles', 'Odyssey']\n</code></pre> <pre><code>['Origin', 'Revolution', 'Syndicate', 'Chronicles', 'Odyssey']\nLenth of assassin creed list: 5\nOdyssey\nOdyssey\n['Syndicate', 'Chronicles', 'Odyssey']\n</code></pre> <pre><code>my_list = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n\nprint(my_list[5])\nprint(my_list[0:6])          #end is exclusive, start is inclusive\nprint(my_list[1:-2])\n\n# output\n5\n[0, 1, 2, 3, 4, 5]\n[1, 2, 3, 4, 5, 6, 7]\n\n\nprint(my_list[::-1])\n# [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]\n\nprint(my_list[-2::-1])\n# [8, 7, 6, 5, 4, 3, 2, 1, 0]\n</code></pre>"},{"location":"chap5/2Python_interview/#3-1-list-opeartion","title":"3-1 List opeartion","text":"<pre><code>AC_list.append('Black flag')\nprint (AC_list)        \n\nAC_list.insert(0, 'IV Black Flag')\nprint(AC_list)\n\nAC_list_old = ['IV Black Flag', 'Rogue']\nAC_list.extend(AC_list_old)\nprint('extend:', AC_list)\n\nAC_list.remove('Odyssey')\nprint('remove:', AC_list)\n\nAC_list2_popped = AC_list.pop()\nprint('poped:', AC_list)\n# poped: ['IV Black Flag', 'Origin', 'Revolution', 'Syndicate', 'Chronicles', 'Black flag', 'IV Black Flag']\n</code></pre> <ul> <li>append: <code>AC_list.append</code></li> <li>insert: <code>AC_list.insert(0, 'IV Black Flag')</code></li> <li>extend: <code>AC_list.extend(AC_list_old)</code></li> <li>pop: <code>AC_list.pop()</code></li> <li>remove: <code>AC_list.remove('Odyssey')</code></li> </ul>"},{"location":"chap5/2Python_interview/#3-2-list-sort","title":"3-2 List sort","text":"<pre><code>AC_list.reverse()\nprint('reverse:', AC_list)  \n\nnum_list = [0, 32, 98, 27, 19, 20]\nnum_list1 = [0, 32, 98, 27, 19, 20]\nnum_list2 = [0, 32, 98, 27, 19, 20]\n\n\nnum_list.sort()\nprint('sort method:', num_list)\n# sort method: [0, 19, 20, 27, 32, 98]\n\nnum_list1.sort(reverse=True)\nprint('reverse sort:', num_list1)\n# reverse sort: [98, 32, 27, 20, 19, 0]\n\nsorted_list = sorted(num_list)\nprint('sorted method:',sorted_list)\n</code></pre> <pre><code>sort method: [0, 19, 20, 27, 32, 98]\nreverse sort: [98, 32, 27, 20, 19, 0]\nsorted method: [0, 19, 20, 27, 32, 98]\n</code></pre>"},{"location":"chap5/2Python_interview/#3-3-in-list-or-not","title":"3-3 In list or not","text":"<pre><code>print('Brotherhood in the list:', 'Brotherhood' in AC_list)\nprint('Chronicles in the list:', 'Chronicles' in AC_list)\n\n# Brotherhood in the list: False\n# Chronicles in the list: True\n</code></pre>"},{"location":"chap5/2Python_interview/#3-4-loop-the-list","title":"3-4 Loop the list","text":"<pre><code>for ac in AC_list:\n    print('for loop:', ac)\n\n\nfor loop: IV Black Flag\nfor loop: Black flag\nfor loop: Chronicles\nfor loop: Syndicate\nfor loop: Revolution\nfor loop: Origin\nfor loop: IV Black Flag\n</code></pre> <pre><code>for index, ac in enumerate(AC_list):\n    print('index', index, 'in loop is', ac)\n\n# output\n\nindex 0 in loop is IV Black Flag\nindex 1 in loop is Black flag\nindex 2 in loop is Chronicles\nindex 3 in loop is Syndicate\nindex 4 in loop is Revolution\nindex 5 in loop is Origin\nindex 6 in loop is IV Black Flag\n</code></pre> <pre><code>for index, ac in enumerate(AC_list, start=1):\n    print('index', index, 'in loop is', ac)\n\n# output\nindex 1 in loop is IV Black Flag\nindex 2 in loop is Black flag\nindex 3 in loop is Chronicles\nindex 4 in loop is Syndicate\nindex 5 in loop is Revolution\nindex 6 in loop is Origin\nindex 7 in loop is IV Black Flag\n</code></pre>"},{"location":"chap5/2Python_interview/#3-5-multiple-list","title":"3-5 Multiple list","text":"<pre><code># u use any sign to concat the list\nAC_list_Arrow = ' -&gt;  '.join(AC_list)\nprint('join:', AC_list_Arrow )\n</code></pre> <p><code>' -&gt;  '.join(AC_list)</code>: <code>join: IV Black Flag -&gt;  Black flag -&gt;  Chronicles -&gt;  Syndicate -&gt;  Revolution -&gt;  Origin -&gt;  IV Black Flag</code></p> <pre><code>print(type(AC_list_Arrow))\n\n# output\n&lt;class 'str'&gt;\n</code></pre> <pre><code>new_AC_List = AC_list_Arrow.split(' -&gt; ')\nprint('split:' ,new_AC_List )\n\n\n# output\nsplit: ['IV Black Flag', ' Black flag', ' Chronicles', ' Syndicate', ' Revolution', ' Origin', ' IV Black Flag']\n</code></pre>"},{"location":"chap5/2Python_interview/#4tuples","title":"4\u3001Tuples","text":""},{"location":"chap5/2Python_interview/#tuples-difference-between-list-immutable-assignment-unsupported","title":"Tuples difference between list [immutable, assignment unsupported]","text":"<p>Tuples with () is immutable</p> <pre><code>tuple_1 = ('History', 'Math', 'Physics', 'CompSci')\n\ntuple_1[0] = 'Art'\n# TypeError: 'tuple' object does not support item assignment\n</code></pre>"},{"location":"chap5/2Python_interview/#5sets","title":"5\u3001Sets","text":"<pre><code># Sets is another kind of list except the order of set always change \n\nAC_list = {'Origin', 'Revolution', 'Syndicate', 'Chronicles', 'Odyssey'}\nprint(AC_list)\n</code></pre> <pre><code># Remove duplicate by sets\ns3 = {1, 2, 3 ,4, 5, 1, 2 ,3}\nprint(s3)\n# {1, 2, 3, 4, 5}\n\ns1 = {1, 2, 3 ,4, 5}\nprint(s1)\n# {1, 2, 3, 4, 5}\n\ns1.add(6)\nprint(s1)\n# {1, 2, 3, 4, 5, 6}\n\ns1.update([6, 7, 8])\nprint(s1)\n# {1, 2, 3, 4, 5, 6, 7, 8}\n\ns1.remove(8)  #8 is value in set\nprint(s1)\n# {1, 2, 3, 4, 5, 6, 7}\n\ns1.discard(8)\nprint(s1)\n#{1, 2, 3, 4, 5, 6, 7}\n</code></pre> <ul> <li><code>add()</code>   Adds an element to the set</li> <li><code>clear()</code> Removes all the elements from the set</li> <li><code>copy()</code>  Returns a copy of the set</li> <li><code>difference()</code> Returns a set containing the difference between two or more sets</li> <li><code>discard()</code> Remove the specified item</li> <li><code>intersection()</code>  Returns a set, that is the intersection of two other sets</li> <li><code>pop()</code>   Removes an element from the set</li> <li><code>remove()</code> Removes the specified element</li> <li><code>union()</code> Return a set containing the union of sets</li> <li><code>update()</code> Update the set with the union of this set and others</li> </ul> <pre><code>AC_list1 = {'Origin', 'Unity', 'Syndicate', 'Chronicles', 'Rogue'}\nAC_list2 = {'Origin', 'IV Black Flag', 'Syndicate', 'Odyssey', 'Rogue'}\n\nprint('intersection same : ', AC_list1.intersection(AC_list2))\n# intersection same :  {'Origin', 'Syndicate', 'Rogue'}\n\nprint('difference : ', AC_list1.difference(AC_list2))\nprint('difference : ', AC_list2.difference(AC_list1))\n\n\nprint(AC_list1.union(AC_list2))\n\n\n# difference :  {'Unity', 'Chronicles'}\n# difference :  {'Odyssey', 'IV Black Flag'}\n{'Rogue', 'Origin', 'IV Black Flag', 'Odyssey', 'Unity', 'Chronicles', 'Syndicate'}\n</code></pre>"},{"location":"chap5/2Python_interview/#6dict","title":"6\u3001dict","text":"<pre><code>AS_dict_old = {'1': \"Assassin's Creed\", '2':[\"Assassin's Creed II\", 'Brotherhood', 'Revelations'], \"3\":\"Assassin's Creed III\"}\nprint('dict:', AS_dict_old)\nprint('dict:', AS_dict_old['2'])\n\n# output\ndict: {'1': \"Assassin's Creed\", '2': [\"Assassin's Creed II\", 'Brotherhood', 'Revelations'], '3': \"Assassin's Creed III\"}\ndict: [\"Assassin's Creed II\", 'Brotherhood', 'Revelations']\n</code></pre> <pre><code>AS_dict_old['4'] = 'IV Black Flag'\nprint('get:', AS_dict_old.get('3'))\nprint('get:', AS_dict_old.get('4'))\n\n# get: Assassin's Creed III\n# get: IV Black Flag\n\nprint('dict:', AS_dict_old)\nAS_dict_old.update({'4':\"Assassin's Creed IV Black Flag\"})\nprint('dict after update:', AS_dict_old)\n# dict after update: {'1': \"Assassin's Creed\", '2': [\"Assassin's Creed II\", 'Brotherhood', 'Revelations'], '3': \"Assassin's Creed III\", '4': \"Assassin's Creed IV Black Flag\"}\n\nas4 = AS_dict_old.pop('4')\nprint('dict after pop:', AS_dict_old)\n# dict after pop: {'1': \"Assassin's Creed\", '2': [\"Assassin's Creed II\", 'Brotherhood', 'Revelations'], '3': \"Assassin's Creed III\"}\n\nprint(as4)\n# Assassin's Creed IV Black Flag\n\nprint(len(AS_dict_old)) \n# 3\n\nprint(AS_dict_old.keys())\n# dict_keys(['1', '2', '3'])\n\nprint(AS_dict_old.values())\n# dict_values([\"Assassin's Creed\", [\"Assassin's Creed II\", 'Brotherhood', 'Revelations'], \"Assassin's Creed III\"])\n\nprint(AS_dict_old.items ())\n# dict_items([('1', \"Assassin's Creed\"), ('2', [\"Assassin's Creed II\", 'Brotherhood', 'Revelations']), ('3', \"Assassin's Creed III\")])\n\nfor key, value in AS_dict_old.items():\n    print(key, value)\n\n# 1 Assassin's Creed\n# 2 [\"Assassin's Creed II\", 'Brotherhood', 'Revelations']\n# 3 Assassin's Creed III\n</code></pre>"},{"location":"chap5/2Python_interview/#6-1-empty","title":"6-1 empty","text":"<pre><code>empty_list = []   # empty_list=list()\nprint(empty_list)\n\nempty_tuple = ()   # empty_tuple=tuple()\nprint(empty_tuple)\n\nempty_dict = {}   # empty_dict = dict()\nprint(empty_dict)\n</code></pre>"},{"location":"chap5/2Python_interview/#6-2-empty","title":"6-2 empty","text":"<pre><code>user= 'Admin'\nPassword ='Password'\nlogged_in = True\n\nif user == 'Admin' and Password == 'Password' and logged_in:\n    print('welcome to the admin page')\nelse:\n    print('stay at login page')\n\nfor ac in AC_list:\n    if ac == 'Revolution':\n        print('Found, it is supposed to be Unity')\n        continue\n    print(ac)\n</code></pre>"},{"location":"chap5/2Python_interview/#7loop","title":"7\u3001Loop","text":"<pre><code>for ac in AC_list:\n    for rank in ['good', 'ok', 'bad']:\n        print(ac, rank)\n</code></pre>"},{"location":"chap5/2Python_interview/#7-1-range","title":"7-1 range","text":"<pre><code>for i in range(1, 11):\n    print(i)\n# 0...10    \n</code></pre> <pre><code>def main():\n    count = 0\n\n    for i in range(0, round(100/7)+1):\n        for j in range(0, round(100/3)+1):\n            if (100 - i*7 - j*3 &gt;= 0) and (100 - i*7 - j*3) % 2 == 0:\n                count += 1\n    return count\n\nif __name__ == \"__main__\":\n    print(main())\n</code></pre>"},{"location":"chap5/2Python_interview/#7-2-while","title":"7-2 while","text":"<pre><code>x = 0   \nwhile x &lt; 10:\n    print(x)\n    x += 1\n# 0...9\n</code></pre>"},{"location":"chap5/2Python_interview/#8func","title":"8\u3001Func","text":"<pre><code>def hello_func():\n    return \"Assassin's Creed\"\n\nprint(hello_func().upper()) \n\ndef bonjour_func(greeting):\n    return f'{greeting} Mademoiselle'\n\nprint(bonjour_func('Bonsoir'))\n</code></pre>"},{"location":"chap5/2Python_interview/#9import-function","title":"9\u3001Import function","text":"<pre><code>import random\nrandom_element = random.choice(courses)\nprint(type(random_element))\nfor _ in range(10):\n    print(random_element)\n\nfor _ in range(10):\n    print(_)\n\n\n# import math\n# rads = math.radians(90)\n# print(rads)\n# 1.5707963267948966\n\nimport datetime\nimport calendar\ntoday = datetime.date.today()\nprint(today)\n\nprint(calendar.isleap(2016))\nimport os \nprint(os.getcwd())\n\nimport antigravity\n</code></pre>"},{"location":"chap5/2Python_interview/#9-1-collections","title":"9-1 collections","text":"<pre><code>color = (55, 155, 255)  #tuple\ncolor_dict = {'red':55, 'green': 155, 'blue': 255}  #dictionary\n\nprint(color_dict['red']) \n# 55\n\n\nfrom collections import namedtuple\nColors = namedtuple('colors', ['red', 'green', 'blue'])\ncolors = Colors(55, 155, 255)\n\nprint(colors[0])\nprint(colors.green)\nprint(colors.blue)\n# 55\n# 155\n# 255\n</code></pre>"},{"location":"chap5/2Python_interview/#10remove-duplicates","title":"10\u3001Remove duplicates","text":""},{"location":"chap5/2Python_interview/#10-1-quick-remove-duplicate-from-a-list","title":"10-1 Quick remove duplicate from a list","text":"<pre><code>l1 = [1, 2, 3, 1, 2, 3]\nl2 = list(set(l1))   \nprint(l2)\n\n# [1, 2, 3]\n</code></pre>"},{"location":"chap5/2Python_interview/#10-2-quick-remove-duplicate-from-a-dictionay","title":"10-2 Quick remove duplicate from a dictionay","text":"<pre><code>result = {}\n\nfor key,value in raw_results.items():\n        if value not in results.values():\n            results[key] = value  \n</code></pre>"},{"location":"chap5/2Python_interview/#11add-elements","title":"11\u3001Add elements","text":""},{"location":"chap5/2Python_interview/#11-1-add-element-to-set-setadd","title":"11-1 add element to set(): <code>set.add()</code>","text":"<pre><code>nums = [1,2,3,4,5,6,7,8,9,10]\nmy_set = set()\nfor n in nums:\n    my_set.add(n)\n\nprint(my_set)\n\n# {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}\n</code></pre>"},{"location":"chap5/2Python_interview/#11-2-add-element-to-list-listadd","title":"11-2 add element to list(): <code>list.add()</code>","text":"<pre><code>my_list = []\nfor n in nums:\n    my_list.append(n)\n\nprint(my_list)\n\n# [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n</code></pre>"},{"location":"chap5/2Python_interview/#11-2-add-element-to-list-listapend","title":"11-2 add element to list(): <code>list.apend()</code>","text":"<pre><code>for n in nums:\n  my_list2.append(n*n)\n\nprint(my_list2)\n\n# [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]\n</code></pre> <pre><code>my_list3= [n*n for n in nums]\nprint(my_list3)\n\n# [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]\n</code></pre> <pre><code>my_list2 = []\nfor n in nums:\n    if n%2==0:\n        my_list2.append(n)\nprint(my_list2)\n\n# [2, 4, 6, 8, 10]\n</code></pre> <pre><code>my_list3 = []\nfor letter in 'abcd':\n    for num in range(4):\n        my_list3.append((letter,num))\n\nprint(my_list3)\n# [('a', 0), ('a', 1), ('a', 2), ('a', 3), ('b', 0), ('b', 1), ('b', 2), ('b', 3), ('c', 0), ('c', 1), ('c', 2), ('c', 3), ('d', 0), ('d', 1), ('d', 2), ('d', 3)]\n\nmy_list3 = [(letter, num) for letter in 'abcd' for num in range(4)]\n# [('Bruce', 'Batman'), ('Clark', 'Superman'), ('Peter', 'Spiderman'), ('Logan', 'Wolverine'), ('Wade', 'Deadpool')]\n</code></pre>"},{"location":"chap5/2Python_interview/#12zip-function","title":"12\u3001zip function","text":"<pre><code>names = ['Bruce', 'Clark', 'Peter', 'Logan', 'Wade']\nheros = ['Batman', 'Superman', 'Spiderman', 'Wolverine', 'Deadpool']\nprint(list(zip(names, heros)))\n\n\n# zip()\n# list()\n\n\n# {'Bruce': 'Batman', 'Clark': 'Superman', 'Peter': 'Spiderman', 'Logan': 'Wolverine', 'Wade': 'Deadpool'}\n</code></pre> <pre><code>my_dict = {}\nfor name, hero in zip(names, heros):\n    my_dict[name] = hero\nprint(my_dict)\n\n# {'Bruce': 'Batman', 'Clark': 'Superman', 'Peter': 'Spiderman', 'Logan': 'Wolverine', 'Wade': 'Deadpool'}\n</code></pre> <pre><code>def find_index(to_search,target):\n    for i,value in enumerate(to_search):\n        if value == target:\n            break\n    else:\n        return -1\n    return i\n\nmy_list = ['K8S', 'AWS', 'Python', 'Chef']\n\nindex_location = find_index(my_list,'Python')\nprint(f'Location of target is index: {index_location}')\n\nindex_location1 = find_index(my_list,'Ansible')\nprint(f'Location of target is index: {index_location1}')\n\n# Location of target is index: 2\n# Location of target is index: -1\n</code></pre>"},{"location":"chap5/2Python_interview/#13iter-function","title":"13\u3001iter function","text":"<pre><code>nums = [1, 2 ,3]\n\nfor i in nums:\n    print(i, end=\" \")\n\n# 1 2 3 &lt;list_iterator object at 0x106fe93d0&gt;\n</code></pre> <pre><code>i_nums = iter(nums)\nprint(i_nums)\n\n1\n2\n3\n</code></pre> <pre><code>def sentense(sentense):\n        for word in sentense.split():\n            yield word\n\ng_sentence = sentense('this is a test2')\n\nfor word in g_sentence:\n    print(word) \n</code></pre> <pre><code>this\nis\na\ntest2\n</code></pre>"},{"location":"chap5/2Python_interview/#14map-function","title":"14\u3001Map function","text":"<pre><code>def myfunc(a, b):\n      return a + b\n\nx = map(myfunc, ('apple', 'banana', 'cherry'), ('orange', 'lemon', 'pineapple'))\n\nprint(x)\n#convert the map into a list, for readability:\nprint(list(x))\n</code></pre> <pre><code>&lt;map object at 0x10c5515e0&gt;\n['appleorange', 'bananalemon', 'cherrypineapple']\n</code></pre>"},{"location":"chap5/3GS_longest_substr/","title":"3\u3001Longest substring","text":"<p>Given a string s, find the length of the longest substring without repeating characters.</p> <ul> <li>Input: s = \"abcabcbb\"</li> <li>Output: 3</li> <li> <p>Explanation: The answer is \"abc\", with the length of 3.</p> </li> <li> <p>Input: s = \"bbbbb\"</p> </li> <li>Output: 1</li> <li> <p>Explanation: The answer is \"b\", with the length of 1.</p> </li> <li> <p>Input: s = \"pwwkew\"</p> </li> <li>Output: 3</li> <li>Explanation: The answer is \"wke\", with the length of 3.</li> </ul> <p>Notice that the answer must be a substring, \"pwke\" is a subsequence and not a substring.</p> <pre><code>class Solution(object):\n    def lengthOfLongestSubstring(self, s):\n        \"\"\"\n        :type s: str\n        :rtype: int\n        \"\"\"\n        size = len(s)\n        if size &lt; 2:\n            return size\n\n        current_longest = 0\n        sub = \"\"\n\n        # for char in string directly\n        for c in s:\n            if c not in sub:\n                sub += c\n                if len(sub) &gt; current_longest:\n                    current_longest = len(sub)\n            else:\n                sub = f'{sub.split(c)[1]}{c}'\n\n                # str = 'pwwkewp'\n                # print(f\"{str.split('p')[1]}{'p'}\")\n                # output: wwkewp\n\n                # str = 'pww'\n                # print(f\"{str.split('w')[1]}{'w'}\")\n                # output: w\n                # print(f\"{str.split('w')[1]}\")\n                # output: empty\n\n        return current_longest\n\nstr = 'pwwkew'\ns = Solution()\nprint(s.lengthOfLongestSubstring(str)) \n</code></pre>"},{"location":"chap5/4GS_remove_sort_list/","title":"4\u3001Remove duplicate in Sort List","text":"<ul> <li>Given the head of a sorted linked list, delete all nodes that have duplicate numbers, leaving only distinct numbers from the original list. </li> <li> <p>Return the linked list sorted as well.</p> </li> <li> <p>Input: head = [1,2,3,3,4,4,5]</p> </li> <li> <p>Output: [1,2,5]</p> </li> <li> <p>Input: head = [1,1,1,2,3]</p> </li> <li>Output: [2,3]</li> </ul> <pre><code>class Solution:\n    def deleteDuplicates(self,ls):\n\n        # for i in range(0, len(list)):\n        #     print(i)\n        list1 = list(set(ls))\n        # remove duplicate\n\n        dupes = []\n        seen = {}\n\n        for x in ls:\n            if x not in seen.keys():\n                seen[x] = 1\n            else:\n                if seen[x] == 1:\n                    dupes.append(x)\n                seen[x] += 1\n\n        for x in dupes:\n            if x in list1:\n                list1.remove(x)\n\n        return list1\n\n\ns = Solution()\ns.deleteDuplicates([1,2,3,3,4,4,5])\nprint(s.deleteDuplicates([1,2,3,3,4,4,5]))\n\n# [1, 2, 5]\n</code></pre> <pre><code>class Solution:\n    def deleteDuplicates(self, ListNode):\n        holder = ListNode(0, head)\n        dummy_head = holder\n        next_node = head\n\n        while next_node:\n            if next_node.next is not None and next_node.next.val == next_node.val:\n                while(next_node.next is not None and next_node.val == next_node.next.val):\n                    next_node = next_node.next\n                dummy_head.next = next_node.next\n            else:\n                dummy_head = dummy_head.next\n        next_node = next_node.next\n\n        return holder.next\n\ns = Solution()\ns.deleteDuplicates([1,2,3,3,4,4,5])\nprint(s.deleteDuplicates([1,2,3,3,4,4,5]))\n</code></pre>"},{"location":"chap5/5Sort_list/","title":"5\u3001Reverse Sort List","text":""},{"location":"chap5/5Sort_list/#reverse-sort-from-start-to-end","title":"Reverse sort from start to end","text":"<pre><code>def main():\n    a = [1,2,3,4,5]\n    b = []\n\n    for i in range(0,len(a)):\n        b.append(i)\n\n    for i in range(0,len(a)):\n        b[i] = a[len(a)-i-1]\n    return b\n\nif __name__ == '__main__':\n    print(main())\n</code></pre> <pre><code># output:\n[5, 4, 3, 2, 1]\n</code></pre> <p>if no <code>b.append(i)</code></p> <pre><code>IndexError: list assignment index out of range\n</code></pre>"},{"location":"chap5/5Sort_list/#reverse-sort-from-start-to-half","title":"Reverse sort from start to half","text":"<pre><code>def main():\n    a = [1,2,3,4,5]\n    tmp = 0\n\n    for i in range(0,round(len(a)/2)):\n        tmp = a[i]\n        a[i] = a[len(a)-i-1]\n        a[len(a)-i-1]=tmp\n\n    return a\n\nif __name__ == '__main__':\n    print(main())\n    a = [1,2,3,4,5]\n</code></pre> <pre><code>tmp = a[i]\na[i] = a[len(a)-i-1]\na[len(a)-i-1]=tmp\n</code></pre>"},{"location":"chap5/5Sort_list/#sort-function","title":"Sort function","text":"<pre><code>b = sorted(a, reverse=True)\nprint(b)\n</code></pre>"},{"location":"chap5/6RM_dup_dict/","title":"6\u3001Remove duplicate from dictionary","text":"<pre><code>student_data = {'id1': \n   {'name': ['Sara'], \n    'class': ['V'], \n    'subject_integration': ['english, math, science']\n   },\n 'id2': \n  {'name': ['David'], \n    'class': ['V'], \n    'subject_integration': ['english, math, science']\n   },\n 'id3': \n    {'name': ['Sara'], \n    'class': ['V'], \n    'subject_integration': ['english, math, science']\n   },\n 'id4': \n   {'name': ['Surya'], \n    'class': ['V'], \n    'subject_integration': ['english, math, science']\n   },\n}\n\nresult = {}\n\nfor key,value in student_data.items():\n    if value not in result.values():\n        result[key] = value\n\nprint(result)\n</code></pre> <pre><code>{'id1': {'name': ['Sara'], 'class': ['V'], 'subject_integration': ['english, math, science']}, 'id2': {'name': ['David'], 'class': ['V'], 'subject_integration': ['english, math, science']}, 'id4': {'name': ['Surya'], 'class': ['V'], 'subject_integration': ['english, math, science']}}\n</code></pre>"},{"location":"chap5/7Find_max/","title":"Find Maxmium number count in list and nth number","text":""},{"location":"chap5/7Find_max/#1find-max-number-in-list","title":"1\u3001Find Max number in list","text":"<pre><code>def main():\n    a = [1,4,3]\n    max_val = -1\n    for i in range(0,len(a)):\n        if a[i] &gt; max_val:\n            max_val = a[i]\n    return max_val\n\nif __name__ == \"__main__\":\n    print(main())\n</code></pre> <ul> <li><code>max_val = -1</code></li> </ul> <pre><code>for i in range(0,len(a)):\n        if a[i] &gt; max_val:\n            max_val = a[i]\n</code></pre>"},{"location":"chap5/7Find_max/#2find-max-count-in-list","title":"2\u3001Find Max count in list","text":"<pre><code>def main():\n    a = [1, 3, 4, 3, 4, 1, 3]\n    time_tmp = 0\n    time_max = 0 \n    result={}\n\n    for i in range(0,len(a)):\n        for j in range(0,len(a)):\n            if a[i] == a[j]:\n                time_tmp += 1\n        # result[a[i]] = time_tmp\n\n    # return result\n\n        if time_tmp &gt; time_max:\n            time_max = time_tmp\n            val_max = a[i]\n\n    return val_max\n\nif __name__ == \"__main__\":\n    print(main())\n\n</code></pre> <pre><code>output:\n3\n</code></pre>"},{"location":"chap5/7Find_max/#2find-max-count-variable-in-list-with-dictionary","title":"2\u3001Find Max count variable in list with dictionary","text":"<pre><code>a = [1, 2, 3, 4, 5, 5, 5, 6]\n\nd = {}    # a[i]\u4e3akey, count \u4e3a value\nresult = []\n\nfor i in range(0,len(a)):\n    if a[i] in d.keys():\n        d[a[i]] = d.get(a[i])+1\n    else:\n        d[a[i]] = 1\n\n    # val_max = -1\n    # time_max = 0\n\nfor count in d.values():\n    result.append(count)\n\n# return result\nprint(max(result))\n</code></pre> <pre><code>output:\n3\n</code></pre>"},{"location":"chap5/7Find_max/#3-find-the-most-n-repeated-word-in-a-string","title":"3\u3001 Find the most n repeated word in a string","text":"<p>N largest values in dictionary</p> <pre><code>from collections import Counter\n\ndef getNthFrequency(str, n):\n    array = str.split(' ')\n    res_array = []\n    i = 1\n    # return array\n    res_dict = dict(Counter(array))\n    # return result\n    while i &lt;= n:\n        maximum_key = max(res_dict, key=res_dict.get)\n        res_array.append(maximum_key)\n        res_dict.pop(maximum_key)\n        i += 1\n\n    return res_array\n\n\nif __name__ == '__main__':\n    str = \"In this program, to use Counter, we have to import it from the collections class in our program. Since Counter works for hashable objects they are accessed using a key. We can get the Key using the get method.\"\n    print(getNthFrequency(str,2))\n</code></pre> <p><code>maximum_key = max(res_dict, key=res_dict.get)</code></p> <p><code>['the', 'to']</code></p> <pre><code>from collections import Counter\nfrom heapq import nlargest\n\n\ndef getNthFrequency(str, N):\n    array = str.split(' ')\n    res_array = []\n    i = 1\n    # return array\n    res_dict = dict(Counter(array))\n    # N largest values in dictionary\n    # Using nlargest\n    res = nlargest(N, res_dict, key = res_dict.get)\n    return res \n\nif __name__ == '__main__':\n    str = \"In this program, to use Counter, we have to import it from the collections class in our program. Since Counter works for hashable objects they are accessed using a key. We can get the Key using the get method.\"\n    print(getNthFrequency(str,3))\n</code></pre> <pre><code>['the', 'to', 'using']\n</code></pre>"},{"location":"chap5/7Find_max/#4find-nth-number-in-list","title":"4\u3001Find Nth number in list","text":"<p>\u5728\u4e00\u4e2a\u6709\u5e8f\u6570\u7ec4\u4e2d\uff0c\u67e5\u627e\u51fa\u7b2c\u4e00\u4e2a\u5927\u4e8e 9 \u7684\u6570\u5b57\uff0c\u5047\u8bbe\u4e00\u5b9a\u5b58\u5728\u3002\u4f8b\u5982\uff0c<code>arr = { -1, 3, 3, 7, 10, 14, 14 }</code>; </p> <pre><code>def main():\n    targetNumb = 9\n    arr = [ -1, 3, 3, 7, 10, 14, 14 ]\n    middle = 0\n    low = 0\n    high = len(arr) - 1\n\n    while low &lt;= high:\n        middle = round((high + low)/2)\n        if arr[middle] &gt; targetNumb and (middle == 0 or arr[middle-1] &lt;= targetNumb):\n            print(f\"The first number bigger than {targetNumb} which is {arr[middle]}\")\n            break\n        elif arr[middle] &gt; targetNumb:\n            # \u8bf4\u660e\u8be5\u6570\u5728low~middle\u4e4b\u95f4\n            high = middle - 1\n        else:\n            #  \u8bf4\u660e\u8be5\u6570\u5728middle~high\u4e4b\u95f4\n            low = middle + 1\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> <pre><code>The first number bigger than 9 which is 10\n</code></pre>"},{"location":"chap5/8gs_interview/","title":"8\u3001GS Interview","text":"<pre><code>Implement a run length encoding function.\n\n* For a string input the function returns output encoded as follows:\n*\n* \"a\"     -&gt; \"a1\"\n* \"aa\"    -&gt; \"a2\"\n* \"aabbb\" -&gt; \"a2b3\"\n* \"aabbbaa\" -&gt; \"a2b3a2\"\n* \"\"      -&gt; \"\"\n</code></pre> <pre><code>def doTestsPass():\n    # Assert(rle(\"aaa\"),        \"a3\",           \"Example 1\" );\n    # Assert(rle(\"aabbc\"),      \"a2b2c1\",       \"Example 5\" );\n    str = \"aabbc\"\n\n    if len(str) == 1:\n        print(f\"{str}1\")\n\n    # sub = \"\"\n    char_length = 0\n    result = {}\n\n    for char in str:\n        if char not in result.keys():\n            result[char] = 1    \n        else:\n            result[char] += 1\n\n\n    # print(result)\n\n    new_str = ''\n    for key,value in result.items():\n        print(f\"{key}{value}\",end =\"\")\n\n\nif __name__ == \"__main__\":\n    doTestsPass()  \n</code></pre> <pre><code>#output\na2b2c1\n</code></pre>"},{"location":"chap5/8gs_interview/#python-extract-distinct-k-length-substrings","title":"Python \u2013 Extract distinct K length substrings","text":"<pre><code>def distinctSubstring(str, n):\n    # Put all distinct substring in a HashSet\n    result = set()\n    for i in range(len(str)):\n        for j in range(i + 1, len(str) + 1):\n            if len(str[i:j:n]) &gt; 1:\n                result.add(str[i:j:n])\n    return result\n\nif __name__ == '__main__':\n\n    str = \"aaab\";\n    subs = distinctSubstring(str,2);\n\n    print(\"Distinct Substrings are: \");\n    for s in subs:\n        print(s);\n</code></pre> <pre><code>$ python3 24unqiuesub.py \nDistinct Substrings are: \nab\naa\n</code></pre>"},{"location":"chap5/8gs_interview/#python-program-to-find-minimum-element-in-a-sorted-and-rotated-array","title":"Python program to find minimum element in a sorted and rotated array","text":"<pre><code>def findMin(arr, low, high): \n    # This condition is needed to handle the case when array is not \n    # rotated at all \n    if high &lt; low: \n        return arr[0] \n\n    # If there is only one element left \n    if high == low: \n        return arr[low] \n\n    # Find mid \n    mid = int((low + high)/2) \n\n    # Check if element (mid+1) is minimum element. Consider \n    # the cases like [3, 4, 5, 1, 2] \n    if mid &lt; high and arr[mid+1] &lt; arr[mid]: \n        return arr[mid+1] \n\n    # Check if mid itself is minimum element \n    if mid &gt; low and arr[mid] &lt; arr[mid - 1]: \n        return arr[mid] \n\n    # Decide whether we need to go to left half or right half \n    if arr[high] &gt; arr[mid]: \n        return findMin(arr, low, mid-1) \n    return findMin(arr, mid+1, high) \n\n# Driver program to test above functions \narr1 = [5, 6, 1, 2, 3, 4] \nn1 = len(arr1) \nprint(\"The minimum element is \" + str(findMin(arr1, 0, n1-1))) \n</code></pre>"},{"location":"chap5/9Substring/","title":"9\u3001Find substring inside String","text":""},{"location":"chap5/9Substring/#9-1-function-1-double-loop-string","title":"9-1 Function 1: Double loop string","text":"<p>\u5047\u8bbe\u8981\u4ece\u4e3b\u4e32 s = \"goodgoogle\" \u4e2d\u627e\u5230 t = \"google\" \u5b50\u4e32</p> <pre><code>def main():\n    s = \"goodgoogle\"\n    t = \"google\"\n    isFind = 0\n\n    for i in range(0,len(s)-len(t)+1):\n        if s[i] == t[0]:\n            jc = 0\n            for j in range(0,len(t)):\n                if s[i+j] != t[j]:\n                    break\n                jc = j\n\n        if jc == len(t)-1:\n            isFind = 1 \n    print(isFind)\n</code></pre> <ul> <li><code>s[i+j] != t[j]</code>: \u4e0d\u540c\u4e86\u5c31break</li> </ul> <pre><code>if s[i+j] != t[j]:\n    break\n</code></pre>"},{"location":"chap5/9Substring/#9-2-function-2-python-inner-function-index","title":"9-2 Function 2: Python inner function: index()","text":"<pre><code>def main():\n    s = \"goodgoogle\"\n    t = \"google\"\n    try:\n        if s.index(t) &gt; 0:\n            print('Found')\n    except ValueError:\n        print('Not foud')\n\nif __name__ == '__main__':\n    main()\n</code></pre> <pre><code>output:\nFound\n</code></pre>"},{"location":"chap5/9Substring/#9-3-function-2-python-inner-function-find","title":"9-3 Function 2: Python inner function: find()","text":"<pre><code>s = \"goodgoogle\"\nt = \"google\"\nprint(s.find(t))\n</code></pre> <pre><code>4\n</code></pre>"},{"location":"chap6/10haproxy_learn/","title":"L10 HAProxy\u4ece\u96f6\u5f00\u59cb\u5230\u638c\u63e1","text":""},{"location":"chap6/10haproxy_learn/#_1","title":"\u76ee\u5f55\uff1a","text":"<ul> <li>HAProxy\u662f\u4ec0\u4e48</li> <li>HAProxy\u7684\u6838\u5fc3\u80fd\u529b\u548c\u5173\u952e\u7279\u6027</li> <li>HAProxy\u7684\u5b89\u88c5\u548c\u8fd0\u884c</li> <li>\u4f7f\u7528HAProxy\u642d\u5efaL7\u8d1f\u8f7d\u5747\u8861\u5668</li> <li>\u4f7f\u7528HAProxy\u642d\u5efaL4\u8d1f\u8f7d\u5747\u8861\u5668</li> <li>HAProxy\u5173\u952e\u914d\u7f6e\u8be6\u89e3</li> <li>\u4f7f\u7528Keepalived\u5b9e\u73b0HAProxy\u9ad8\u53ef\u7528</li> </ul>"},{"location":"chap6/10haproxy_learn/#haproxy","title":"HAProxy\u662f\u4ec0\u4e48","text":"<p>HAProxy\u662f\u4e00\u4e2a\u514d\u8d39\u7684\u8d1f\u8f7d\u5747\u8861\u8f6f\u4ef6\uff0c\u53ef\u4ee5\u8fd0\u884c\u4e8e\u5927\u90e8\u5206\u4e3b\u6d41\u7684Linux\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u3002</p> <p>HAProxy\u63d0\u4f9b\u4e86L4(TCP)\u548cL7(HTTP)\u4e24\u79cd\u8d1f\u8f7d\u5747\u8861\u80fd\u529b\uff0c\u5177\u5907\u4e30\u5bcc\u7684\u529f\u80fd\u3002HAProxy\u7684\u793e\u533a\u975e\u5e38\u6d3b\u8dc3\uff0c\u7248\u672c\u66f4\u65b0\u5feb\u901f\uff08\u6700\u65b0\u7a33\u5b9a\u72481.7.2\u4e8e2017/01/13\u63a8\u51fa\uff09\u3002\u6700\u5173\u952e\u7684\u662f\uff0cHAProxy\u5177\u5907\u5ab2\u7f8e\u5546\u7528\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u6027\u80fd\u548c\u7a33\u5b9a\u6027\u3002</p> <p>\u56e0\u4e3aHAProxy\u7684\u4e0a\u8ff0\u4f18\u70b9\uff0c\u5b83\u5f53\u524d\u4e0d\u4ec5\u4ec5\u662f\u514d\u8d39\u8d1f\u8f7d\u5747\u8861\u8f6f\u4ef6\u7684\u9996\u9009\uff0c\u66f4\u51e0\u4e4e\u6210\u4e3a\u4e86\u552f\u4e00\u9009\u62e9\u3002</p>"},{"location":"chap6/10haproxy_learn/#haproxy_1","title":"HAProxy\u7684\u6838\u5fc3\u80fd\u529b\u548c\u5173\u952e\u7279\u6027","text":""},{"location":"chap6/10haproxy_learn/#haproxy_2","title":"HAProxy\u7684\u6838\u5fc3\u529f\u80fd","text":"<ul> <li>\u8d1f\u8f7d\u5747\u8861\uff1aL4\u548cL7\u4e24\u79cd\u6a21\u5f0f\uff0c\u652f\u6301RR/\u9759\u6001RR/LC/IP Hash/URI Hash/<code>URL_PARAM Hash</code>/<code>HTTP_HEADER Hash</code>\u7b49\u4e30\u5bcc\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5</li> <li>\u5065\u5eb7\u68c0\u67e5\uff1a\u652f\u6301TCP\u548cHTTP\u4e24\u79cd\u5065\u5eb7\u68c0\u67e5\u6a21\u5f0f</li> <li>\u4f1a\u8bdd\u4fdd\u6301\uff1a\u5bf9\u4e8e\u672a\u5b9e\u73b0\u4f1a\u8bdd\u5171\u4eab\u7684\u5e94\u7528\u96c6\u7fa4\uff0c\u53ef\u901a\u8fc7Insert Cookie/Rewrite Cookie/Prefix Cookie\uff0c\u4ee5\u53ca\u4e0a\u8ff0\u7684\u591a\u79cdHash\u65b9\u5f0f\u5b9e\u73b0\u4f1a\u8bdd\u4fdd\u6301</li> <li>SSL\uff1aHAProxy\u53ef\u4ee5\u89e3\u6790HTTPS\u534f\u8bae\uff0c\u5e76\u80fd\u591f\u5c06\u8bf7\u6c42\u89e3\u5bc6\u4e3aHTTP\u540e\u5411\u540e\u7aef\u4f20\u8f93</li> <li>HTTP\u8bf7\u6c42\u91cd\u5199\u4e0e\u91cd\u5b9a\u5411</li> <li>\u76d1\u63a7\u4e0e\u7edf\u8ba1\uff1aHAProxy\u63d0\u4f9b\u4e86\u57fa\u4e8eWeb\u7684\u7edf\u8ba1\u4fe1\u606f\u9875\u9762\uff0c\u5c55\u73b0\u5065\u5eb7\u72b6\u6001\u548c\u6d41\u91cf\u6570\u636e\u3002\u57fa\u4e8e\u6b64\u529f\u80fd\uff0c\u4f7f\u7528\u8005\u53ef\u4ee5\u5f00\u53d1\u76d1\u63a7\u7a0b\u5e8f\u6765\u76d1\u63a7HAProxy\u7684\u72b6\u6001</li> </ul>"},{"location":"chap6/10haproxy_learn/#haproxy_3","title":"HAProxy\u7684\u5173\u952e\u7279\u6027","text":"<p>\u6027\u80fd</p> <ul> <li>\u91c7\u7528\u5355\u7ebf\u7a0b\u3001\u4e8b\u4ef6\u9a71\u52a8\u3001\u975e\u963b\u585e\u6a21\u578b\uff0c\u51cf\u5c11\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u6d88\u8017\uff0c\u80fd\u57281ms\u5185\u5904\u7406\u6570\u767e\u4e2a\u8bf7\u6c42\u3002\u5e76\u4e14\u6bcf\u4e2a\u4f1a\u8bdd\u53ea\u5360\u7528\u6570KB\u7684\u5185\u5b58\u3002</li> <li>\u5927\u91cf\u7cbe\u7ec6\u7684\u6027\u80fd\u4f18\u5316\uff0c\u5982<code>O(1)</code>\u590d\u6742\u5ea6\u7684\u4e8b\u4ef6\u68c0\u67e5\u5668\u3001\u5ef6\u8fdf\u66f4\u65b0\u6280\u672f\u3001<code>Single-buffereing</code>\u3001<code>Zero-copy forwarding</code>\u7b49\u7b49\uff0c\u8fd9\u4e9b\u6280\u672f\u4f7f\u5f97<code>HAProxy</code>\u5728\u4e2d\u7b49\u8d1f\u8f7d\u4e0b\u53ea\u5360\u7528\u6781\u4f4e\u7684<code>CPU</code>\u8d44\u6e90\u3002</li> <li><code>HAProxy</code>\u5927\u91cf\u5229\u7528\u64cd\u4f5c\u7cfb\u7edf\u672c\u8eab\u7684\u529f\u80fd\u7279\u6027\uff0c\u4f7f\u5f97\u5176\u5728\u5904\u7406\u8bf7\u6c42\u65f6\u80fd\u53d1\u6325\u6781\u9ad8\u7684\u6027\u80fd\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c<code>HAProxy</code>\u81ea\u8eab\u53ea\u5360\u7528<code>15%</code>\u7684\u5904\u7406\u65f6\u95f4\uff0c\u5269\u4f59\u768485%\u90fd\u662f\u5728\u7cfb\u7edf\u5185\u6838\u5c42\u5b8c\u6210\u7684\u3002</li> <li><code>HAProxy</code>\u4f5c\u8005\u57288\u5e74\u524d\uff082009\uff09\u5e74\u4f7f\u75281.4\u7248\u672c\u8fdb\u884c\u4e86\u4e00\u6b21\u6d4b\u8bd5\uff0c\u5355\u4e2a<code>HAProxy</code>\u8fdb\u7a0b\u7684\u5904\u7406\u80fd\u529b\u7a81\u7834\u4e8610\u4e07\u8bf7\u6c42/\u79d2\uff0c\u5e76\u8f7b\u677e\u5360\u6ee1\u4e86<code>10Gbps</code>\u7684\u7f51\u7edc\u5e26\u5bbd\u3002</li> </ul> <p>\u7a33\u5b9a\u6027</p> <p>\u4f5c\u4e3a\u5efa\u8bae\u4ee5\u5355\u8fdb\u7a0b\u6a21\u5f0f\u8fd0\u884c\u7684\u7a0b\u5e8f\uff0cHAProxy\u5bf9\u7a33\u5b9a\u6027\u7684\u8981\u6c42\u662f\u5341\u5206\u4e25\u82db\u7684\u3002\u6309\u7167\u4f5c\u8005\u7684\u8bf4\u6cd5\uff0cHAProxy\u572813\u5e74\u95f4\u4ece\u672a\u51fa\u73b0\u8fc7\u4e00\u4e2a\u4f1a\u5bfc\u81f4\u5176\u5d29\u6e83\u7684BUG\uff0cHAProxy\u4e00\u65e6\u6210\u529f\u542f\u52a8\uff0c\u9664\u975e\u64cd\u4f5c\u7cfb\u7edf\u6216\u786c\u4ef6\u6545\u969c\uff0c\u5426\u5219\u5c31\u4e0d\u4f1a\u5d29\u6e83\uff08\u6211\u89c9\u5f97\u53ef\u80fd\u591a\u5c11\u8fd8\u662f\u6709\u5938\u5927\u7684\u6210\u5206\uff09\u3002</p> <p>\u5728\u4e0a\u6587\u4e2d\u63d0\u5230\u8fc7\uff0cHAProxy\u7684\u5927\u90e8\u5206\u5de5\u4f5c\u90fd\u662f\u5728\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u5b8c\u6210\u7684\uff0c\u6240\u4ee5HAProxy\u7684\u7a33\u5b9a\u6027\u4e3b\u8981\u4f9d\u8d56\u4e8e\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4f5c\u8005\u5efa\u8bae\u4f7f\u75282.6\u62163.x\u7684Linux\u5185\u6838\uff0c\u5bf9sysctls\u53c2\u6570\u8fdb\u884c\u7cbe\u7ec6\u7684\u4f18\u5316\uff0c\u5e76\u4e14\u786e\u4fdd\u4e3b\u673a\u6709\u8db3\u591f\u7684\u5185\u5b58\u3002</p> <p>\u8fd9\u6837HAProxy\u5c31\u80fd\u591f\u6301\u7eed\u6ee1\u8d1f\u8f7d\u7a33\u5b9a\u8fd0\u884c\u6570\u5e74\u4e4b\u4e45\u3002</p> <p>\u4e2a\u4eba\u7684\u5efa\u8bae\uff1a</p> <ul> <li>\u4f7f\u75283.x\u5185\u6838\u7684Linux\u64cd\u4f5c\u7cfb\u7edf\u8fd0\u884cHAProxy\u8fd0\u884cHAProxy\u7684\u4e3b\u673a\u4e0a\u4e0d\u8981\u90e8\u7f72\u5176\u4ed6\u7684\u5e94\u7528\uff0c\u786e\u4fddHAProxy\u72ec\u5360\u8d44\u6e90\uff0c</li> <li>\u540c\u65f6\u907f\u514d\u5176\u4ed6\u5e94\u7528\u5f15\u53d1\u64cd\u4f5c\u7cfb\u7edf\u6216\u4e3b\u673a\u7684\u6545\u969c\u81f3\u5c11\u4e3aHAProxy\u914d\u5907\u4e00\u53f0\u5907\u673a\uff0c</li> <li>\u4ee5\u5e94\u5bf9\u4e3b\u673a\u786c\u4ef6\u6545\u969c\u3001\u65ad\u7535\u7b49\u7a81\u53d1\u60c5\u51b5\uff08\u642d\u5efa\u53cc\u6d3bHAProxy\u7684\u65b9\u6cd5\u5728\u540e\u6587\u4e2d\u6709\u63cf\u8ff0\uff09sysctl\u7684\u5efa\u8bae\u914d\u7f6e\uff08\u5e76\u4e0d\u662f\u4e07\u7528\u914d\u7f6e\uff0c\u4ecd\u7136\u9700\u8981\u9488\u5bf9\u5177\u4f53\u60c5\u51b5\u8fdb\u884c\u66f4\u7cbe\u7ec6\u7684\u8c03\u6574\uff0c\u4f46\u53ef\u4ee5\u4f5c\u4e3a\u9996\u6b21\u4f7f\u7528HAProxy\u7684\u521d\u59cb\u914d\u7f6e\u4f7f\u7528\uff09\uff1a</li> </ul> <pre><code>net.ipv4.tcp_tw_reuse = 1\nnet.ipv4.ip_local_port_range = 1024 65023\nnet.ipv4.tcp_max_syn_backlog = 10240\nnet.ipv4.tcp_max_tw_buckets = 400000\nnet.ipv4.tcp_max_orphans = 60000\nnet.ipv4.tcp_synack_retries = 3\nnet.core.somaxconn = 10000\n</code></pre>"},{"location":"chap6/10haproxy_learn/#haproxy_4","title":"HAProxy\u7684\u5b89\u88c5\u548c\u8fd0\u884c","text":"<p>\u4e0b\u9762\u4ecb\u7ecd\u5728CentOS7\u4e2d\u5b89\u88c5\u548c\u8fd0\u884cHAProxy\u6700\u65b0\u7a33\u5b9a\u7248(1.7.2)\u7684\u65b9\u6cd5</p>"},{"location":"chap6/10haproxy_learn/#_2","title":"\u5b89\u88c5","text":"<ul> <li>\u4e3aHAProxy\u521b\u5efa\u7528\u6237\u548c\u7528\u6237\u7ec4\uff0c\u6b64\u4f8b\u4e2d\u7528\u6237\u548c\u7528\u6237\u7ec4\u90fd\u662f\"ha\"\u3002\u6ce8\u610f\uff0c\u5982\u679c\u60f3\u8981\u8ba9HAProxy\u76d1\u542c1024\u4ee5\u4e0b\u7684\u7aef\u53e3\uff0c\u5219\u9700\u8981\u4ee5root\u7528\u6237\u6765\u542f\u52a8</li> <li>\u4e0b\u8f7d\u5e76\u89e3\u538b</li> </ul> <pre><code>wget http://www.haproxy.org/download/1.7/src/haproxy-1.7.2.tar.gz\ntar -xzf haproxy-1.7.2.tar.gz\n</code></pre> <p>\u7f16\u8bd1\u5e76\u5b89\u88c5</p> <pre><code>make PREFIX=/home/ha/haproxy TARGET=linux2628\nmake install PREFIX=/home/ha/haproxy\n</code></pre> <p>PREFIX\u4e3a\u6307\u5b9a\u7684\u5b89\u88c5\u8def\u5f84\uff0cTARGET\u5219\u6839\u636e\u5f53\u524d\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7248\u672c\u6307\u5b9a\uff1a</p> <pre><code>- linux22     for Linux 2.2\n- linux24     for Linux 2.4 and above (default)\n- linux24e    for Linux 2.4 with support for a working epoll (&gt; 0.21)\n- linux26     for Linux 2.6 and above\n- linux2628   for Linux 2.6.28, 3.x, and above (enables splice and tproxy)\n</code></pre> <p>\u6b64\u4f8b\u4e2d\uff0c\u6211\u4eec\u7684\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7248\u672c\u4e3a3.10.0\uff0c\u6240\u4ee5TARGET\u6307\u5b9a\u4e3alinux2628</p> <p>\u521b\u5efaHAProxy\u914d\u7f6e\u6587\u4ef6</p> <pre><code>mkdir -p /home/ha/haproxy/conf\nvi /home/ha/haproxy/conf/haproxy.cfg\n</code></pre> <p>\u6211\u4eec\u5148\u521b\u5efa\u4e00\u4e2a\u6700\u7b80\u5355\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>global #\u5168\u5c40\u5c5e\u6027\n    daemon  #\u4ee5daemon\u65b9\u5f0f\u5728\u540e\u53f0\u8fd0\u884c\n    maxconn 256  #\u6700\u5927\u540c\u65f6256\u8fde\u63a5\n    pidfile /home/ha/haproxy/conf/haproxy.pid  #\u6307\u5b9a\u4fdd\u5b58HAProxy\u8fdb\u7a0b\u53f7\u7684\u6587\u4ef6\n\ndefaults #\u9ed8\u8ba4\u53c2\u6570\n    mode http  #http\u6a21\u5f0f\n    timeout connect 5000ms  #\u8fde\u63a5server\u7aef\u8d85\u65f65s\n    timeout client 50000ms  #\u5ba2\u6237\u7aef\u54cd\u5e94\u8d85\u65f650s\n    timeout server 50000ms  #server\u7aef\u54cd\u5e94\u8d85\u65f650s\n\nfrontend http-in #\u524d\u7aef\u670d\u52a1http-in\n    bind *:8080  #\u76d1\u542c8080\u7aef\u53e3\n    default_backend servers  #\u8bf7\u6c42\u8f6c\u53d1\u81f3\u540d\u4e3a\"servers\"\u7684\u540e\u7aef\u670d\u52a1\n\nbackend servers #\u540e\u7aef\u670d\u52a1servers\n    server server1 127.0.0.1:8000 maxconn 32  #backend servers\u4e2d\u53ea\u6709\u4e00\u4e2a\u540e\u7aef\u670d\u52a1\uff0c\u540d\u5b57\u53ebserver1\uff0c\u8d77\u5728\u672c\u673a\u76848000\u7aef\u53e3\uff0cHAProxy\u540c\u65f6\u6700\u591a\u5411\u8fd9\u4e2a\u670d\u52a1\u53d1\u8d7732\u4e2a\u8fde\u63a5\n</code></pre> <p>\u6ce8\u610f\uff1aHAProxy\u8981\u6c42\u7cfb\u7edf\u7684ulimit -n\u53c2\u6570\u5927\u4e8e<code>[maxconn*2+18]</code>\uff0c\u5728\u8bbe\u7f6e\u8f83\u5927\u7684<code>maxconn</code>\u65f6\uff0c\u6ce8\u610f\u68c0\u67e5\u5e76\u4fee\u6539<code>ulimit -n</code>\u53c2\u6570</p> <p>\u5c06HAProxy\u6ce8\u518c\u4e3a\u7cfb\u7edf\u670d\u52a1</p> <p>\u5728<code>/etc/init.d</code>\u76ee\u5f55\u4e0b\u6dfb\u52a0<code>HAProxy</code>\u670d\u52a1\u7684\u542f\u505c\u811a\u672c\uff1a</p> <pre><code>#! /bin/sh\nset -e\n\nPATH=/sbin:/bin:/usr/sbin:/usr/bin:/home/ha/haproxy/sbin\nPROGDIR=/home/ha/haproxy\nPROGNAME=haproxy\nDAEMON=$PROGDIR/sbin/$PROGNAME\nCONFIG=$PROGDIR/conf/$PROGNAME.cfg\nPIDFILE=$PROGDIR/conf/$PROGNAME.pid\nDESC=\"HAProxy daemon\"\nSCRIPTNAME=/etc/init.d/$PROGNAME\n\n# Gracefully exit if the package has been removed.\ntest -x $DAEMON || exit 0\n\nstart()\n{\n       echo -e \"Starting $DESC: $PROGNAME\\n\"\n       $DAEMON -f $CONFIG\n       echo \".\"\n}\n\nstop()\n{\n       echo -e \"Stopping $DESC: $PROGNAME\\n\"\n       haproxy_pid=\"$(cat $PIDFILE)\"\n       kill $haproxy_pid\n       echo \".\"\n}\n\nrestart()\n{\n       echo -e \"Restarting $DESC: $PROGNAME\\n\"\n       $DAEMON -f $CONFIG -p $PIDFILE -sf $(cat $PIDFILE)\n       echo \".\"\n}\n\ncase \"$1\" in\n start)\n       start\n       ;;\n stop)\n       stop\n       ;;\n restart)\n       restart\n       ;;\n *)\n       echo \"Usage: $SCRIPTNAME {start|stop|restart}\" &gt;&amp;2\n       exit 1\n       ;;\nesac\n\nexit 0\n</code></pre> <p>\u8fd0\u884c \u542f\u52a8\u3001\u505c\u6b62\u548c\u91cd\u542f</p> <pre><code>service haproxy start\nservice haproxy stop\nservice haproxy restart\n</code></pre>"},{"location":"chap6/10haproxy_learn/#_3","title":"\u6dfb\u52a0\u65e5\u5fd7","text":"<p>HAProxy\u4e0d\u4f1a\u76f4\u63a5\u8f93\u51fa\u6587\u4ef6\u65e5\u5fd7\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u501f\u52a9Linux\u7684rsyslog\u6765\u8ba9HAProxy\u8f93\u51fa\u65e5\u5fd7</p> <ul> <li>\u4fee\u6539haproxy.cfg</li> </ul> <p>\u5728global\u57df\u548cdefaults\u57df\u4e2d\u6dfb\u52a0\uff1a</p> <pre><code>global\n    ...\n    log 127.0.0.1 local0 info\n    log 127.0.0.1 local1 warning\n    ...\n\ndefaults\n    ...\n    log global\n    ...\n</code></pre> <p>\u610f\u601d\u662f\u5c06info\u7ea7\uff08\u53ca\u4ee5\u4e0a\uff09\u7684\u65e5\u5fd7\u63a8\u9001\u5230<code>rsyslog</code>\u7684<code>local0</code>\u63a5\u53e3\uff0c\u5c06<code>warn</code>\u7ea7\uff08\u53ca\u4ee5\u4e0a\uff09\u7684\u65e5\u5fd7\u63a8\u9001\u5230<code>rsyslog</code>\u7684<code>local1</code>\u63a5\u53e3\uff0c\u5e76\u4e14\u6240\u6709<code>frontend</code>\u90fd\u9ed8\u8ba4\u4f7f\u7528<code>global</code>\u4e2d\u7684\u65e5\u5fd7\u914d\u7f6e\u3002</p> <p>\u6ce8\uff1ainfo\u7ea7\u7684\u65e5\u5fd7\u4f1a\u6253\u5370HAProxy\u5904\u7406\u7684\u6bcf\u4e00\u6761\u8bf7\u6c42\uff0c\u4f1a\u5360\u7528\u5f88\u5927\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u5efa\u8bae\u5c06\u65e5\u5fd7\u7ea7\u522b\u8c03\u6574\u4e3anotice</p> <p>\u4e3arsyslog\u6dfb\u52a0haproxy\u65e5\u5fd7\u7684\u914d\u7f6e</p> <pre><code>vi /etc/rsyslog.d/haproxy.conf\n</code></pre> <pre><code>$ModLoad imudp\n\n$UDPServerRun 514\n$FileCreateMode 0644  #\u65e5\u5fd7\u6587\u4ef6\u7684\u6743\u9650\n$FileOwner ha  #\u65e5\u5fd7\u6587\u4ef6\u7684owner\nlocal0.*     /var/log/haproxy.log  #local0\u63a5\u53e3\u5bf9\u5e94\u7684\u65e5\u5fd7\u8f93\u51fa\u6587\u4ef6\nlocal1.*     /var/log/haproxy_warn.log  #local1\u63a5\u53e3\u5bf9\u5e94\u7684\u65e5\u5fd7\u8f93\u51fa\u6587\u4ef6\n</code></pre> <p>\u4fee\u6539rsyslog\u7684\u542f\u52a8\u53c2\u6570</p> <pre><code>vi /etc/sysconfig/rsyslog\n# Options for rsyslogd\n\n# Syslogd options are deprecated since rsyslog v3.\n# If you want to use them, switch to compatibility mode 2 by \"-c 2\"\n# See rsyslogd(8) for more details\nSYSLOGD_OPTIONS=\"-c 2 -r -m 0\"\n</code></pre> <p>\u91cd\u542frsyslog\u548cHAProxy</p> <pre><code>service rsyslog restart\nservice haproxy restart\n</code></pre> <p>\u6b64\u65f6\u5c31\u5e94\u8be5\u80fd\u5728<code>/var/log</code>\u76ee\u5f55\u4e0b\u770b\u5230<code>haproxy</code>\u7684\u65e5\u5fd7\u6587\u4ef6\u4e86</p> <p>\u7528logrotate\u8fdb\u884c\u65e5\u5fd7\u5207\u5206</p> <p>\u901a\u8fc7rsyslog\u8f93\u51fa\u7684\u65e5\u5fd7\u662f\u4e0d\u4f1a\u8fdb\u884c\u5207\u5206\u7684\uff0c\u6240\u4ee5\u9700\u8981\u4f9d\u9760Linux\u63d0\u4f9b\u7684logrotate\u6765\u8fdb\u884c\u5207\u5206\u5de5\u4f5c</p> <p>\u4f7f\u7528root\u7528\u6237\uff0c\u521b\u5efahaproxy\u65e5\u5fd7\u5207\u5206\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>mkdir /root/logrotate\nvi /root/logrotate/haproxy\n</code></pre> <pre><code>/var/log/haproxy.log /var/log/haproxy_warn.log {  #\u5207\u5206\u7684\u4e24\u4e2a\u6587\u4ef6\u540d\n    daily        #\u6309\u5929\u5207\u5206\n    rotate 7     #\u4fdd\u75597\u4efd\n    create 0644 ha ha  #\u521b\u5efa\u65b0\u6587\u4ef6\u7684\u6743\u9650\u3001\u7528\u6237\u3001\u7528\u6237\u7ec4\n    compress     #\u538b\u7f29\u65e7\u65e5\u5fd7\n    delaycompress  #\u5ef6\u8fdf\u4e00\u5929\u538b\u7f29\n    missingok    #\u5ffd\u7565\u6587\u4ef6\u4e0d\u5b58\u5728\u7684\u9519\u8bef\n    dateext      #\u65e7\u65e5\u5fd7\u52a0\u4e0a\u65e5\u5fd7\u540e\u7f00\n    sharedscripts  #\u5207\u5206\u540e\u7684\u91cd\u542f\u811a\u672c\u53ea\u8fd0\u884c\u4e00\u6b21\n    postrotate   #\u5207\u5206\u540e\u8fd0\u884c\u811a\u672c\u91cd\u8f7drsyslog\uff0c\u8ba9rsyslog\u5411\u65b0\u7684\u65e5\u5fd7\u6587\u4ef6\u4e2d\u8f93\u51fa\u65e5\u5fd7\n      /bin/kill -HUP $(/bin/cat /var/run/syslogd.pid 2&gt;/dev/null) &amp;&gt;/dev/null\n    endscript\n}\n</code></pre> <p>\u5e76\u914d\u7f6e\u5728crontab\u4e2d\u8fd0\u884c\uff1a</p> <pre><code>0 0 * * * /usr/sbin/logrotate /root/logrotate/haproxy\n</code></pre>"},{"location":"chap6/10haproxy_learn/#haproxyl7","title":"\u4f7f\u7528HAProxy\u642d\u5efaL7\u8d1f\u8f7d\u5747\u8861\u5668","text":"<p>\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528HAProxy\u642d\u5efa\u4e00\u4e2aL7\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u5e94\u7528\u5982\u4e0b\u529f\u80fd</p> <ul> <li>\u8d1f\u8f7d\u5747\u8861</li> <li>\u4f1a\u8bdd\u4fdd\u6301</li> <li>\u5065\u5eb7\u68c0\u67e5</li> <li>\u6839\u636eURI\u524d\u7f00\u5411\u4e0d\u540c\u7684\u540e\u7aef\u96c6\u7fa4\u8f6c\u53d1</li> <li>\u76d1\u63a7\u9875\u9762</li> </ul> <p></p> <p>\u67b6\u6784\u4e2d\u5171\u67096\u4e2a\u540e\u7aef\u670d\u52a1\uff0c\u5212\u5206\u4e3a3\u7ec4\uff0c\u6bcf\u7ec4\u4e2d2\u4e2a\u670d\u52a1\uff1a</p> <ul> <li>ms1\uff1a\u670d\u52a1URI\u524d\u7f00\u4e3ams1/\u7684\u8bf7\u6c42</li> <li>ms2\uff1a\u670d\u52a1URI\u524d\u7f00\u4e3ams2/\u7684\u8bf7\u6c42</li> <li>def\uff1a\u670d\u52a1\u5176\u4ed6\u8bf7\u6c42</li> </ul>"},{"location":"chap6/10haproxy_learn/#_4","title":"\u642d\u5efa","text":"<p>1.\u642d\u5efa\u540e\u7aef\u670d\u52a1</p> <p>\u90e8\u7f726\u4e2a\u540e\u7aef\u670d\u52a1\uff0c\u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u7684Web\u670d\u52a1\uff0c\u5982Nginx\u3001Apache HTTPD\u3001Tomcat\u3001Jetty\u7b49\uff0c\u5177\u4f53Web\u670d\u52a1\u7684\u5b89\u88c5\u8fc7\u7a0b\u7701\u7565\u3002</p> <p>\u6b64\u4f8b\u4e2d\uff0c\u6211\u4eec\u5728192.168.8.111\u548c192.168.8.112\u4e24\u53f0\u4e3b\u673a\u4e0a\u5206\u522b\u5b89\u88c5\u4e863\u4e2aNginx\uff1a</p> <pre><code>ms1.srv1 - 192.168.8.111:8080\nms1.srv2 - 192.168.8.112:8080\nms2.srv1 - 192.168.8.111:8081\nms2.srv2 - 192.168.8.112:8081\ndef.srv1 - 192.168.8.111:8082\ndef.srv2 - 192.168.8.112:8082\n</code></pre> <p>\u5728\u8fd96\u4e2aNginx\u670d\u52a1\u5206\u522b\u90e8\u7f72\u5065\u5eb7\u68c0\u67e5\u9875\u9762healthCheck.html\uff0c\u9875\u9762\u5185\u5bb9\u4efb\u610f\u3002\u786e\u4fdd\u901a\u8fc7<code>http://ip:port/healthCheck.html</code>\u53ef\u4ee5\u8bbf\u95ee\u5230\u8fd9\u4e2a\u9875\u9762</p> <p>\u63a5\u4e0b\u6765\u57286\u4e2aNginx\u670d\u52a1\u4e2d\u90e8\u7f72\u670d\u52a1\u9875\u9762\uff1a</p> <p>\u5728\u7b2c\u4e00\u7ec4\u4e2d\u90e8\u7f72ms1/demo.html</p> <p>\u5728\u7b2c\u4e8c\u7ec4\u4e2d\u90e8\u7f72ms2/demo.html</p> <p>\u5728\u7b2c\u4e09\u7ec4\u4e2d\u90e8\u7f72def/demo.html</p> <p>demo.html\u7684\u5185\u5bb9\uff0c\u4ee5\u90e8\u7f72\u5728192.168.8.111:8080\u4e0a\u7684\u4e3a\u4f8b\uff1a</p> <p>Hello! This is ms1.srv1!</p> <p>\u90e8\u7f72\u5728192.168.8.112:8080\u4e0a\u7684\u5c31\u5e94\u8be5\u662f</p> <p>Hello! This is ms1.srv2!</p> <p>\u4ee5\u6b64\u7c7b\u63a8</p> <p>2. \u642d\u5efaHAProxy</p> <p>\u5728192.168.8.110\u4e3b\u673a\u5b89\u88c5HAProxy</p> <p>HAProxy\u7684\u5b89\u88c5\u548c\u914d\u7f6e\u6b65\u9aa4\u5982\u4e0a\u4e00\u7ae0\u4e2d\u63cf\u8ff0\uff0c\u6b64\u5904\u7565\u53bb</p> <p>HAProxy\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>lobal\n    daemon\n    maxconn 30000   #ulimit -n\u81f3\u5c11\u4e3a60018\n    user ha\n    pidfile /home/ha/haproxy/conf/haproxy.pid\n    log 127.0.0.1 local0 info\n    log 127.0.0.1 local1 warning\n\ndefaults\n    mode http\n    log global\n    option http-keep-alive   #\u4f7f\u7528keepAlive\u8fde\u63a5\n    option forwardfor        #\u8bb0\u5f55\u5ba2\u6237\u7aefIP\u5728X-Forwarded-For\u5934\u57df\u4e2d\n    option httplog           #\u5f00\u542fhttplog\uff0cHAProxy\u4f1a\u8bb0\u5f55\u66f4\u4e30\u5bcc\u7684\u8bf7\u6c42\u4fe1\u606f\n    timeout connect 5000ms\n    timeout client 10000ms\n    timeout server 50000ms\n    timeout http-request 20000ms    #\u4ece\u8fde\u63a5\u521b\u5efa\u5f00\u59cb\u5230\u4ece\u5ba2\u6237\u7aef\u8bfb\u53d6\u5b8c\u6574HTTP\u8bf7\u6c42\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u7528\u4e8e\u907f\u514d\u7c7bDoS\u653b\u51fb\n    option httpchk GET /healthCheck.html    #\u5b9a\u4e49\u9ed8\u8ba4\u7684\u5065\u5eb7\u68c0\u67e5\u7b56\u7565\n\nfrontend http-in\n    bind *:9001\n    maxconn 30000                    #\u5b9a\u4e49\u6b64\u7aef\u53e3\u4e0a\u7684maxconn\n    acl url_ms1 path_beg -i /ms1/    #\u5b9a\u4e49ACL\uff0c\u5f53uri\u4ee5/ms1/\u5f00\u5934\u65f6\uff0cACL[url_ms1]\u4e3atrue\n    acl url_ms2 path_beg -i /ms2/    #\u540c\u4e0a\uff0curl_ms2\n    use_backend ms1 if url_ms1       #\u5f53[url_ms1]\u4e3atrue\u65f6\uff0c\u5b9a\u5411\u5230\u540e\u7aef\u670d\u52a1\u7fa4ms1\u4e2d\n    use_backend ms2 if url_ms2       #\u5f53[url_ms2]\u4e3atrue\u65f6\uff0c\u5b9a\u5411\u5230\u540e\u7aef\u670d\u52a1\u7fa4ms2\u4e2d\n    default_backend default_servers  #\u5176\u4ed6\u60c5\u51b5\u65f6\uff0c\u5b9a\u5411\u5230\u540e\u7aef\u670d\u52a1\u7fa4default_servers\u4e2d\n\nbackend ms1    #\u5b9a\u4e49\u540e\u7aef\u670d\u52a1\u7fa4ms1\n    balance roundrobin    #\u4f7f\u7528RR\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\n    cookie HA_STICKY_ms1 insert indirect nocache    #\u4f1a\u8bdd\u4fdd\u6301\u7b56\u7565\uff0cinsert\u540d\u4e3a\"HA_STICKY_ms1\"\u7684cookie\n    #\u5b9a\u4e49\u540e\u7aefserver[ms1.srv1]\uff0c\u8bf7\u6c42\u5b9a\u5411\u5230\u8be5server\u65f6\u4f1a\u5728\u54cd\u5e94\u4e2d\u5199\u5165cookie\u503c[ms1.srv1]\n    #\u9488\u5bf9\u6b64server\u7684maxconn\u8bbe\u7f6e\u4e3a300\n    #\u5e94\u7528\u9ed8\u8ba4\u5065\u5eb7\u68c0\u67e5\u7b56\u7565\uff0c\u5065\u5eb7\u68c0\u67e5\u95f4\u9694\u548c\u8d85\u65f6\u65f6\u95f4\u4e3a2000ms\uff0c\u4e24\u6b21\u6210\u529f\u89c6\u4e3a\u8282\u70b9UP\uff0c\u4e09\u6b21\u5931\u8d25\u89c6\u4e3a\u8282\u70b9DOWN\n    server ms1.srv1 192.168.8.111:8080 cookie ms1.srv1 maxconn 300 check inter 2000ms rise 2 fall 3\n    #\u540c\u4e0a\uff0cinter 2000ms rise 2 fall 3\u662f\u9ed8\u8ba4\u503c\uff0c\u53ef\u4ee5\u7701\u7565\n    server ms1.srv2 192.168.8.112:8080 cookie ms1.srv2 maxconn 300 check\n\nbackend ms2    #\u5b9a\u4e49\u540e\u7aef\u670d\u52a1\u7fa4ms2\n    balance roundrobin\n    cookie HA_STICKY_ms2 insert indirect nocache\n    server ms2.srv1 192.168.8.111:8081 cookie ms2.srv1 maxconn 300 check\n    server ms2.srv2 192.168.8.112:8081 cookie ms2.srv2 maxconn 300 check\n\nbackend default_servers    #\u5b9a\u4e49\u540e\u7aef\u670d\u52a1\u7fa4default_servers\n    balance roundrobin\n    cookie HA_STICKY_def insert indirect nocache\n    server def.srv1 192.168.8.111:8082 cookie def.srv1 maxconn 300 check\n    server def.srv2 192.168.8.112:8082 cookie def.srv2 maxconn 300 check\n\nlisten stats    #\u5b9a\u4e49\u76d1\u63a7\u9875\u9762\n    bind *:1080                   #\u7ed1\u5b9a\u7aef\u53e31080\n    stats refresh 30s             #\u6bcf30\u79d2\u66f4\u65b0\u76d1\u63a7\u6570\u636e\n    stats uri /stats              #\u8bbf\u95ee\u76d1\u63a7\u9875\u9762\u7684uri\n    stats realm HAProxy\\ Stats    #\u76d1\u63a7\u9875\u9762\u7684\u8ba4\u8bc1\u63d0\u793a\n    stats auth admin:admin        #\u76d1\u63a7\u9875\u9762\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\n</code></pre> <p>\u4fee\u6539\u5b8c\u6210\u540e\uff0c\u542f\u52a8HAProxy</p> <pre><code>service haproxy start\n</code></pre> <p>\u6d4b\u8bd5</p> <p>\u9996\u5148\uff0c\u8bbf\u95ee\u4e00\u4e0b\u76d1\u63a7\u9875\u9762<code>http://192.168.8.110:1080/stats</code> \u5e76\u6309\u63d0\u793a\u8f93\u5165\u7528\u6237\u540d\u5bc6\u7801</p> <p>\u63a5\u4e0b\u6765\u5c31\u80fd\u770b\u5230\u76d1\u63a7\u9875\u9762\uff1a</p> <p></p> <p>\u76d1\u63a7\u9875\u9762\u4e2d\u5217\u51fa\u4e86\u6211\u4eec\u914d\u7f6e\u7684\u6240\u6709frontend\u548cbackend\u670d\u52a1\uff0c\u4ee5\u53ca\u5b83\u4eec\u7684\u8be6\u7ec6\u6307\u6807\u3002\u5982\u8fde\u63a5\u6570\uff0c\u961f\u5217\u60c5\u51b5\uff0csession rate\uff0c\u6d41\u91cf\uff0c\u540e\u7aef\u670d\u52a1\u7684\u5065\u5eb7\u72b6\u6001\u7b49\u7b49</p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u4e00\u4e00\u6d4b\u8bd5\u5728HAProxy\u4e2d\u914d\u7f6e\u7684\u529f\u80fd</p> <p>1. \u5065\u5eb7\u68c0\u67e5</p> <p>\u4ece\u76d1\u63a7\u9875\u9762\u4e2d\u5c31\u53ef\u4ee5\u76f4\u63a5\u770b\u51fa\u5065\u5eb7\u68c0\u67e5\u914d\u7f6e\u7684\u662f\u5426\u6b63\u786e\uff0c\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230\uff0cbackend ms1\u3001ms2\u3001<code>default_servers</code>\u4e0b\u5c5e\u76846\u4e2a\u540e\u7aef\u670d\u52a1\u7684Status\u90fd\u662f20h28m UP\uff0c\u4ee3\u8868\u5065\u5eb7\u72b6\u6001\u5df2\u6301\u7eed\u4e8620\u5c0f\u65f628\u5206\u949f\uff0c\u800c<code>LastChk</code>\u663e\u793a<code>L7OK/200 in 1ms</code>\u5219\u4ee3\u8868\u57281ms\u524d\u8fdb\u884c\u4e86L7\u7684\u5065\u5eb7\u68c0\u67e5\uff08\u5373HTTP\u8bf7\u6c42\u65b9\u5f0f\u7684\u5065\u5eb7\u68c0\u67e5\uff09\uff0c\u8fd4\u56de\u7801\u4e3a200</p> <p>\u6b64\u65f6\u6211\u4eec\u5c06<code>ms1.srv1</code>\u4e2d\u7684<code>healthCheck.html</code>\u6539\u540d</p> <pre><code>mv healthCheck.html healthCheck.html.bak\n</code></pre> <p>\u7136\u540e\u518d\u53bb\u770b\u76d1\u63a7\u9875\u9762\uff1a</p> <p>ms1.srv1\u7684\u72b6\u6001\u53d8\u6210\u4e862s DOWN\uff0cLastChk\u5219\u662fL7STS/404 in 2ms\uff0c\u4ee3\u8868\u4e0a\u6b21\u5065\u5eb7\u68c0\u67e5\u8fd4\u56de\u4e86404 \u518d\u6062\u590d<code>healthCheck.html</code>\uff0c\u5f88\u5feb\u5c31\u80fd\u770b\u5230<code>ms1.srv1</code>\u91cd\u65b0\u6062\u590d\u5230<code>UP</code>\u72b6\u6001</p> <p>2. \u901a\u8fc7URI\u524d\u7f00\u8f6c\u53d1\u8bf7\u6c42</p> <p></p> <p>3. \u8d1f\u8f7d\u5747\u8861\u548c\u4f1a\u8bdd\u4fdd\u6301\u7b56\u7565</p> <p>\u5728\u5206\u522b\u8bbf\u95ee\u8fc7ms1/demo.html, ms2/demo.html, m3/demo.html\u540e\uff0c\u67e5\u770b\u4e00\u4e0b\u6d4f\u89c8\u5668\u7684Cookie\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230HAProxy\u5df2\u7ecf\u56de\u5199\u4e86\u4e09\u4e2a\u7528\u4e8e\u4f1a\u8bdd\u4fdd\u6301\u7684cookie\uff0c\u6b64\u65f6\u53cd\u590d\u5237\u65b0\u8fd9\u4e09\u4e2a\u9875\u9762\uff0c\u4f1a\u53d1\u73b0\u603b\u662f\u88ab\u5b9a\u5411\u5230*.srv1\u4e0a</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u5220\u9664<code>HA_STICKY_ms1</code>\u8fd9\u6761<code>cookie</code>\uff0c\u7136\u540e\u518d\u8bbf\u95ee<code>ms1/demo.html</code>\uff0c\u4f1a\u770b\u5230\uff1a</p> <p></p> <p>\u5982\u679c\u53d1\u73b0\u4ecd\u7136\u88ab\u5b9a\u4f4d\u5230ms1.srv1\uff0c\u540c\u65f6\u4e5f\u6ca1\u6709\u5199\u5165\u65b0\u7684<code>HA_STICKY_ms1 Cookie</code>\uff0c\u90a3\u4e48\u53ef\u80fd\u662f\u6d4f\u89c8\u5668\u7f13\u5b58\u4e86<code>ms1/demo.html</code>\u9875\u9762\uff0c\u8bf7\u6c42\u5e76\u6ca1\u6709\u5230\u8fbeHAProxy\u3002F5\u5237\u65b0\u4e00\u4e0b\u5e94\u8be5\u5c31\u53ef\u4ee5\u4e86\u3002</p>"},{"location":"chap6/10haproxy_learn/#haproxyl4","title":"\u4f7f\u7528HAProxy\u642d\u5efaL4\u8d1f\u8f7d\u5747\u8861\u5668","text":"<p>HAProxy\u4f5c\u4e3aL4\u8d1f\u8f7d\u5747\u8861\u5668\u5de5\u4f5c\u65f6\uff0c\u4e0d\u4f1a\u53bb\u89e3\u6790\u4efb\u4f55\u4e0eHTTP\u534f\u8bae\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u53ea\u5728\u4f20\u8f93\u5c42\u5bf9\u6570\u636e\u5305\u8fdb\u884c\u5904\u7406\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4ee5L4\u6a21\u5f0f\u8fd0\u884c\u7684HAProxy\uff0c\u65e0\u6cd5\u5b9e\u73b0\u6839\u636eURL\u5411\u4e0d\u540c\u540e\u7aef\u8f6c\u53d1\u3001\u901a\u8fc7cookie\u5b9e\u73b0\u4f1a\u8bdd\u4fdd\u6301\u7b49\u529f\u80fd\u3002</p> <p>\u540c\u65f6\uff0c\u5728L4\u6a21\u5f0f\u4e0b\u5de5\u4f5c\u7684HAProxy\u4e5f\u65e0\u6cd5\u63d0\u4f9b\u76d1\u63a7\u9875\u9762\u3002 \u4f46\u4f5c\u4e3aL4\u8d1f\u8f7d\u5747\u8861\u5668\u7684HAProxy\u80fd\u591f\u63d0\u4f9b\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u9002\u5408\u4e8e\u57fa\u4e8e\u5957\u63a5\u5b57\u7684\u670d\u52a1\uff08\u5982\u6570\u636e\u5e93\u3001\u6d88\u606f\u961f\u5217\u3001RPC\u3001\u90ae\u4ef6\u670d\u52a1\u3001Redis\u7b49\uff09\uff0c\u6216\u4e0d\u9700\u8981\u903b\u8f91\u89c4\u5219\u5224\u65ad\uff0c\u5e76\u5df2\u5b9e\u73b0\u4e86\u4f1a\u8bdd\u5171\u4eab\u7684HTTP\u670d\u52a1\u3002</p> <p>\u603b\u4f53\u65b9\u6848</p> <p>\u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528HAProxy\u4ee5L4\u65b9\u5f0f\u6765\u4ee3\u7406\u4e24\u4e2aHTTP\u670d\u52a1\uff0c\u4e0d\u63d0\u4f9b\u4f1a\u8bdd\u4fdd\u6301\u3002</p> <pre><code>global\n    daemon\n    maxconn 30000   #ulimit -n\u81f3\u5c11\u4e3a60018\n    user ha\n    pidfile /home/ha/haproxy/conf/haproxy.pid\n    log 127.0.0.1 local0 info\n    log 127.0.0.1 local1 warning\n\ndefaults\n    mode tcp\n    log global\n    option tcplog            #\u5f00\u542ftcplog\n    timeout connect 5000ms\n    timeout client 10000ms\n    timeout server 10000ms   #TCP\u6a21\u5f0f\u4e0b\uff0c\u5e94\u5c06timeout client\u548ctimeout server\u8bbe\u7f6e\u4e3a\u4e00\u6837\u7684\u503c\uff0c\u4ee5\u9632\u6b62\u51fa\u73b0\u95ee\u9898\n    option httpchk GET /healthCheck.html    #\u5b9a\u4e49\u9ed8\u8ba4\u7684\u5065\u5eb7\u68c0\u67e5\u7b56\u7565\n\nfrontend http-in\n    bind *:9002\n    maxconn 30000                    #\u5b9a\u4e49\u6b64\u7aef\u53e3\u4e0a\u7684maxconn\n    default_backend default_servers  #\u8bf7\u6c42\u5b9a\u5411\u81f3\u540e\u7aef\u670d\u52a1\u7fa4default_servers\n\nbackend default_servers    #\u5b9a\u4e49\u540e\u7aef\u670d\u52a1\u7fa4default_servers\n    balance roundrobin\n    server def.srv1 192.168.8.111:8082 maxconn 300 check\n    server def.srv2 192.168.8.112:8082 maxconn 300 check\n</code></pre>"},{"location":"chap6/10haproxy_learn/#l4","title":"L4\u6a21\u5f0f\u4e0b\u7684\u4f1a\u8bdd\u4fdd\u6301","text":"<p>\u867d\u7136TCP\u6a21\u5f0f\u4e0b\u7684HAProxy\u65e0\u6cd5\u901a\u8fc7HTTP Cookie\u5b9e\u73b0\u4f1a\u8bdd\u4fdd\u6301\uff0c\u4f46\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5b9e\u73b0\u57fa\u4e8e\u5ba2\u6237\u7aefIP\u7684\u4f1a\u8bdd\u4fdd\u6301\u3002\u53ea\u9700\u5c06</p> <pre><code>balance roundrobin\n</code></pre> <p>\u6539\u4e3a</p> <pre><code>balance source\n</code></pre> <p>\u6b64\u5916\uff0cHAProxy\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684stick-table\u529f\u80fd\uff0cHAProxy\u53ef\u4ee5\u4ece\u4f20\u8f93\u5c42\u7684\u6570\u636e\u5305\u4e2d\u91c7\u6837\u51fa\u5927\u91cf\u7684\u5c5e\u6027\uff0c\u5e76\u5c06\u8fd9\u4e9b\u5c5e\u6027\u4f5c\u4e3a\u4f1a\u8bdd\u4fdd\u6301\u7684\u7b56\u7565\u5199\u5165stick-table\u4e2d\u3002</p>"},{"location":"chap6/10haproxy_learn/#2haproxy","title":"2\u3001HAProxy\u5173\u952e\u914d\u7f6e\u8be6\u89e3","text":""},{"location":"chap6/10haproxy_learn/#haproxy5","title":"\u603b\u89c8 HAProxy\u7684\u914d\u7f6e\u6587\u4ef6\u5171\u67095\u4e2a\u57df","text":"<ul> <li>global\uff1a\u7528\u4e8e\u914d\u7f6e\u5168\u5c40\u53c2\u6570</li> <li>default\uff1a\u7528\u4e8e\u914d\u7f6e\u6240\u6709frontend\u548cbackend\u7684\u9ed8\u8ba4\u5c5e\u6027</li> <li>frontend\uff1a\u7528\u4e8e\u914d\u7f6e\u524d\u7aef\u670d\u52a1\uff08\u5373HAProxy\u81ea\u8eab\u63d0\u4f9b\u7684\u670d\u52a1\uff09\u5b9e\u4f8b</li> <li>backend\uff1a\u7528\u4e8e\u914d\u7f6e\u540e\u7aef\u670d\u52a1\uff08\u5373HAProxy\u540e\u9762\u63a5\u7684\u670d\u52a1\uff09\u5b9e\u4f8b\u7ec4</li> <li>listen\uff1afrontend+backend\u7684\u7ec4\u5408\u914d\u7f6e\uff0c\u53ef\u4ee5\u7406\u89e3\u6210\u66f4\u7b80\u6d01\u7684\u914d\u7f6e\u65b9\u6cd5</li> </ul>"},{"location":"chap6/10haproxy_learn/#global","title":"global\u57df\u7684\u5173\u952e\u914d\u7f6e","text":"<ul> <li><code>daemon</code>\uff1a\u6307\u5b9aHAProxy\u4ee5\u540e\u53f0\u6a21\u5f0f\u8fd0\u884c\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\u90fd\u5e94\u8be5\u4f7f\u7528\u8fd9\u4e00\u914d\u7f6e</li> <li><code>user [username]</code> \uff1a\u6307\u5b9aHAProxy\u8fdb\u7a0b\u6240\u5c5e\u7684\u7528\u6237</li> <li><code>group [groupname]</code> \uff1a\u6307\u5b9aHAProxy\u8fdb\u7a0b\u6240\u5c5e\u7684\u7528\u6237\u7ec4</li> <li><code>log [address] [device] [maxlevel] [minlevel]</code>\uff1a\u65e5\u5fd7\u8f93\u51fa\u914d\u7f6e\uff0c\u5982log 127.0.0.1 local0 info warning\uff0c\u5373\u5411\u672c\u673arsyslog\u6216syslog\u7684local0\u8f93\u51fainfo\u5230warning\u7ea7\u522b\u7684\u65e5\u5fd7\u3002\u5176\u4e2d[minlevel]\u53ef\u4ee5\u7701\u7565\u3002HAProxy\u7684\u65e5\u5fd7\u5171\u67098\u4e2a\u7ea7\u522b\uff0c\u4ece\u9ad8\u5230\u4f4e\u4e3aemerg/alert/crit/err/warning/notice/info/debug</li> <li><code>pidfile</code> \uff1a\u6307\u5b9a\u8bb0\u5f55HAProxy\u8fdb\u7a0b\u53f7\u7684\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84\u3002\u4e3b\u8981\u7528\u4e8eHAProxy\u8fdb\u7a0b\u7684\u505c\u6b62\u548c\u91cd\u542f\u52a8\u4f5c\u3002</li> <li><code>maxconn</code> \uff1aHAProxy\u8fdb\u7a0b\u540c\u65f6\u5904\u7406\u7684\u8fde\u63a5\u6570\uff0c\u5f53\u8fde\u63a5\u6570\u8fbe\u5230\u8fd9\u4e00\u6570\u503c\u65f6\uff0cHAProxy\u5c06\u505c\u6b62\u63a5\u6536\u8fde\u63a5\u8bf7\u6c42</li> </ul>"},{"location":"chap6/10haproxy_learn/#frontend","title":"frontend\u57df\u7684\u5173\u952e\u914d\u7f6e","text":"<ul> <li><code>cl [name] [criterion] [flags] [operator] [value]</code>\uff1a\u5b9a\u4e49\u4e00\u6761ACL\uff0cACL\u662f\u6839\u636e\u6570\u636e\u5305\u7684\u6307\u5b9a\u5c5e\u6027\u4ee5\u6307\u5b9a\u8868\u8fbe\u5f0f\u8ba1\u7b97\u51fa\u7684true/false\u503c\u3002\u5982<code>\"acl url_ms1 path_beg -i /ms1/\"</code>\u5b9a\u4e49\u4e86\u540d\u4e3a<code>url_ms1</code>\u7684ACL\uff0c\u8be5ACL\u5728\u8bf7\u6c42uri\u4ee5/ms1/\u5f00\u5934\uff08\u5ffd\u7565\u5927\u5c0f\u5199\uff09\u65f6\u4e3atrue</li> <li><code>bind [ip]:[port]\uff1afrontend</code>\u670d\u52a1\u76d1\u542c\u7684\u7aef\u53e3</li> <li><code>default_backend [name]\uff1afrontend</code>\u5bf9\u5e94\u7684\u9ed8\u8ba4backend</li> <li><code>disabled</code>\uff1a\u7981\u7528\u6b64frontend</li> <li><code>http-request [operation] [condition]</code>\uff1a\u5bf9\u6240\u6709\u5230\u8fbe\u6b64frontend\u7684HTTP\u8bf7\u6c42\u5e94\u7528\u7684\u7b56\u7565\uff0c\u4f8b\u5982\u53ef\u4ee5\u62d2\u7edd\u3001\u8981\u6c42\u8ba4\u8bc1\u3001\u6dfb\u52a0header\u3001\u66ff\u6362header\u3001\u5b9a\u4e49ACL\u7b49\u7b49\u3002</li> <li><code>http-response [operation] [condition]</code>\uff1a\u5bf9\u6240\u6709\u4ece\u6b64frontend\u8fd4\u56de\u7684HTTP\u54cd\u5e94\u5e94\u7528\u7684\u7b56\u7565\uff0c\u5927\u4f53\u540c\u4e0a</li> <li><code>log</code>\uff1a\u540cglobal\u57df\u7684log\u914d\u7f6e\uff0c\u4ec5\u5e94\u7528\u4e8e\u6b64frontend\u3002\u5982\u679c\u8981\u6cbf\u7528global\u57df\u7684log\u914d\u7f6e\uff0c\u5219\u6b64\u5904\u914d\u7f6e\u4e3alog global</li> <li><code>maxconn</code>\uff1a\u540cglobal\u57df\u7684maxconn\uff0c\u4ec5\u5e94\u7528\u4e8e\u6b64frontend</li> <li><code>mode</code>\uff1a\u6b64frontend\u7684\u5de5\u4f5c\u6a21\u5f0f\uff0c\u4e3b\u8981\u6709http\u548ctcp\u4e24\u79cd\uff0c\u5bf9\u5e94L7\u548cL4\u4e24\u79cd\u8d1f\u8f7d\u5747\u8861\u6a21\u5f0f</li> <li><code>option forwardfor</code>\uff1a\u5728\u8bf7\u6c42\u4e2d\u6dfb\u52a0X-Forwarded-For Header\uff0c\u8bb0\u5f55\u5ba2\u6237\u7aefip</li> <li><code>option http-keep-alive</code>\uff1a\u4ee5KeepAlive\u6a21\u5f0f\u63d0\u4f9b\u670d\u52a1</li> <li><code>option httpclose</code>\uff1a\u4e0ehttp-keep-alive\u5bf9\u5e94\uff0c\u5173\u95edKeepAlive\u6a21\u5f0f\uff0c\u5982\u679cHAProxy\u4e3b\u8981\u63d0\u4f9b\u7684\u662f\u63a5\u53e3\u7c7b\u578b\u7684\u670d\u52a1\uff0c\u53ef\u4ee5\u8003\u8651\u91c7\u7528httpclose\u6a21\u5f0f\uff0c\u4ee5\u8282\u7701\u8fde\u63a5\u6570\u8d44\u6e90\u3002\u4f46\u5982\u679c\u8fd9\u6837\u505a\u4e86\uff0c\u63a5\u53e3\u7684\u8c03\u7528\u7aef\u5c06\u4e0d\u80fd\u4f7f\u7528HTTP\u8fde\u63a5\u6c60</li> <li><code>option httplog</code>\uff1a\u5f00\u542fhttplog\uff0cHAProxy\u5c06\u4f1a\u4ee5\u7c7b\u4f3cApache HTTP\u6216Nginx\u7684\u683c\u5f0f\u6765\u8bb0\u5f55\u8bf7\u6c42\u65e5\u5fd7</li> <li><code>option tcplog</code>\uff1a\u5f00\u542ftcplog\uff0cHAProxy\u5c06\u4f1a\u5728\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u6570\u636e\u5305\u5728\u4f20\u8f93\u5c42\u7684\u66f4\u591a\u5c5e\u6027</li> <li><code>stats uri [uri]</code>\uff1a\u5728\u6b64frontend\u4e0a\u5f00\u542f\u76d1\u63a7\u9875\u9762\uff0c\u901a\u8fc7[uri]\u8bbf\u95ee</li> <li><code>stats refresh [time]</code>\uff1a\u76d1\u63a7\u6570\u636e\u5237\u65b0\u5468\u671f</li> <li><code>stats auth [user]:[password]</code>\uff1a\u76d1\u63a7\u9875\u9762\u7684\u8ba4\u8bc1\u7528\u6237\u540d\u5bc6\u7801</li> <li><code>timeout client [time]</code>\uff1a\u6307\u8fde\u63a5\u521b\u5efa\u540e\uff0c\u5ba2\u6237\u7aef\u6301\u7eed\u4e0d\u53d1\u9001\u6570\u636e\u7684\u8d85\u65f6\u65f6\u95f4</li> <li><code>timeout http-request [time]</code>\uff1a\u6307\u8fde\u63a5\u521b\u5efa\u540e\uff0c\u5ba2\u6237\u7aef\u6ca1\u80fd\u53d1\u9001\u5b8c\u6574HTTP\u8bf7\u6c42\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u4e3b\u8981\u7528\u4e8e\u9632\u6b62DoS\u7c7b\u653b\u51fb\uff0c\u5373\u521b\u5efa\u8fde\u63a5\u540e\uff0c\u4ee5\u975e\u5e38\u7f13\u6162\u7684\u901f\u5ea6\u53d1\u9001\u8bf7\u6c42\u5305\uff0c\u5bfc\u81f4HAProxy\u8fde\u63a5\u88ab\u957f\u65f6\u95f4\u5360\u7528</li> <li><code>use_backend [backend] if|unless [acl]</code>\uff1a\u4e0eACL\u642d\u914d\u4f7f\u7528\uff0c\u5728\u6ee1\u8db3/\u4e0d\u6ee1\u8db3ACL\u65f6\u8f6c\u53d1\u81f3\u6307\u5b9a\u7684backend</li> </ul>"},{"location":"chap6/10haproxy_learn/#backend","title":"backend\u57df\u7684\u5173\u952e\u914d\u7f6e","text":"<ul> <li>acl\uff1a\u540cfrontend\u57df</li> <li><code>balance [algorithm]</code>\uff1a\u5728\u6b64backend\u4e0b\u6240\u6709server\u95f4\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0c\u5e38\u7528\u7684\u6709roundrobin\u548csource\uff0c\u5b8c\u6574\u7684\u7b97\u6cd5\u8bf4\u660e\u89c1\u5b98\u65b9\u6587\u6863configuration.html#4.2-balance</li> <li><code>cookie</code>\uff1a\u5728backend server\u95f4\u542f\u7528\u57fa\u4e8ecookie\u7684\u4f1a\u8bdd\u4fdd\u6301\u7b56\u7565\uff0c\u6700\u5e38\u7528\u7684\u662finsert\u65b9\u5f0f\uff0c\u5982<code>cookie HA_STICKY_ms1 insert indirect nocache</code>\uff0c\u6307HAProxy\u5c06\u5728\u54cd\u5e94\u4e2d\u63d2\u5165\u540d\u4e3a<code>HA_STICKY_ms1</code>\u7684cookie\uff0c\u5176\u503c\u4e3a\u5bf9\u5e94\u7684server\u5b9a\u4e49\u4e2d\u6307\u5b9a\u7684\u503c\uff0c\u5e76\u6839\u636e\u8bf7\u6c42\u4e2d\u6b64cookie\u7684\u503c\u51b3\u5b9a\u8f6c\u53d1\u81f3\u54ea\u4e2aserver\u3002indirect\u4ee3\u8868\u5982\u679c\u8bf7\u6c42\u4e2d\u5df2\u7ecf\u5e26\u6709\u5408\u6cd5\u7684<code>HA_STICK_ms1 cookie</code>\uff0c\u5219HAProxy\u4e0d\u4f1a\u5728\u54cd\u5e94\u4e2d\u518d\u6b21\u63d2\u5165\u6b64cookie\uff0cnocache\u5219\u4ee3\u8868\u7981\u6b62\u94fe\u8def\u4e0a\u7684\u6240\u6709\u7f51\u5173\u548c\u7f13\u5b58\u670d\u52a1\u5668\u7f13\u5b58\u5e26\u6709<code>Set-Cookie</code>\u5934\u7684\u54cd\u5e94\u3002</li> <li><code>default-server</code>\uff1a\u7528\u4e8e\u6307\u5b9a\u6b64backend\u4e0b\u6240\u6709server\u7684\u9ed8\u8ba4\u8bbe\u7f6e\u3002\u5177\u4f53\u89c1\u4e0b\u9762\u7684server\u914d\u7f6e\u3002</li> <li><code>disabled</code>\uff1a\u7981\u7528\u6b64backend</li> <li><code>http-request/http-response</code>\uff1a\u540cfrontend\u57df</li> <li><code>log</code>\uff1a\u540cfrontend\u57df</li> <li><code>mode</code>\uff1a\u540cfrontend\u57df</li> <li><code>option forwardfor</code>\uff1a\u540cfrontend\u57df</li> <li><code>option http-keep-alive</code>\uff1a\u540cfrontend\u57df</li> <li><code>option httpclose</code>\uff1a\u540cfrontend\u57df</li> <li><code>option httpchk [METHOD] [URL] [VERSION]</code>\uff1a\u5b9a\u4e49\u4ee5http\u65b9\u5f0f\u8fdb\u884c\u7684\u5065\u5eb7\u68c0\u67e5\u7b56\u7565\u3002\u5982<code>option httpchk GET /healthCheck.html HTTP/1.1</code></li> <li><code>option httplog</code>\uff1a\u540cfrontend\u57df</li> <li><code>option tcplog</code>\uff1a\u540cfrontend\u57df</li> <li><code>server [name] [ip]:[port] [params]</code>\uff1a\u5b9a\u4e49backend\u4e2d\u7684\u4e00\u4e2a\u540e\u7aefserver\uff0c[params]\u7528\u4e8e\u6307\u5b9a\u8fd9\u4e2aserver\u7684\u53c2\u6570\uff0c\u5e38\u7528\u7684\u5305\u62ec\u6709\uff1a</li> </ul> <p>check\uff1a\u6307\u5b9a\u6b64\u53c2\u6570\u65f6\uff0cHAProxy\u5c06\u4f1a\u5bf9\u6b64server\u6267\u884c\u5065\u5eb7\u68c0\u67e5\uff0c\u68c0\u67e5\u65b9\u6cd5\u5728option httpchk\u4e2d\u914d\u7f6e\u3002\u540c\u65f6\u8fd8\u53ef\u4ee5\u5728check\u540e\u6307\u5b9ainter, rise, fall\u4e09\u4e2a\u53c2\u6570\uff0c\u5206\u522b\u4ee3\u8868\u5065\u5eb7\u68c0\u67e5\u7684\u5468\u671f\u3001\u8fde\u7eed\u51e0\u6b21\u6210\u529f\u8ba4\u4e3aserver UP\uff0c\u8fde\u7eed\u51e0\u6b21\u5931\u8d25\u8ba4\u4e3aserver DOWN\uff0c\u9ed8\u8ba4\u503c\u662finter 2000ms rise 2 fall 3</p> <p>cookie [value]\uff1a\u7528\u4e8e\u914d\u5408\u57fa\u4e8ecookie\u7684\u4f1a\u8bdd\u4fdd\u6301\uff0c\u5982cookie ms1.srv1\u4ee3\u8868\u4ea4\u7531\u6b64server\u5904\u7406\u7684\u8bf7\u6c42\u4f1a\u5728\u54cd\u5e94\u4e2d\u5199\u5165\u503c\u4e3ams1.srv1\u7684cookie\uff08\u5177\u4f53\u7684cookie\u540d\u5219\u5728backend\u57df\u4e2d\u7684cookie\u8bbe\u7f6e\u4e2d\u6307\u5b9a\uff09 maxconn\uff1a\u6307HAProxy\u6700\u591a\u540c\u65f6\u5411\u6b64server\u53d1\u8d77\u7684\u8fde\u63a5\u6570\uff0c\u5f53\u8fde\u63a5\u6570\u5230\u8fbemaxconn\u540e\uff0c\u5411\u6b64server\u53d1\u8d77\u7684\u65b0\u8fde\u63a5\u4f1a\u8fdb\u5165\u7b49\u5f85\u961f\u5217\u3002\u9ed8\u8ba4\u4e3a0\uff0c\u5373\u65e0\u9650 maxqueue\uff1a\u7b49\u5f85\u961f\u5217\u7684\u957f\u5ea6\uff0c\u5f53\u961f\u5217\u5df2\u6ee1\u540e\uff0c\u540e\u7eed\u8bf7\u6c42\u5c06\u4f1a\u53d1\u81f3\u6b64backend\u4e0b\u7684\u5176\u4ed6server\uff0c\u9ed8\u8ba4\u4e3a0\uff0c\u5373\u65e0\u9650</p> <p>weight\uff1aserver\u7684\u6743\u91cd\uff0c0-256\uff0c\u6743\u91cd\u8d8a\u5927\uff0c\u5206\u7ed9\u8fd9\u4e2aserver\u7684\u8bf7\u6c42\u5c31\u8d8a\u591a\u3002weight\u4e3a0\u7684server\u5c06\u4e0d\u4f1a\u88ab\u5206\u914d\u4efb\u4f55\u65b0\u7684\u8fde\u63a5\u3002\u6240\u6709server\u9ed8\u8ba4weight\u4e3a1</p> <ul> <li><code>timeout connect [time]</code>\uff1a\u6307HAProxy\u5c1d\u8bd5\u4e0ebackend server\u521b\u5efa\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4</li> <li><code>timeout check [time]</code>\uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5065\u5eb7\u68c0\u67e5\u7684\u8fde\u63a5+\u54cd\u5e94\u8d85\u65f6\u65f6\u95f4\u4e3aserver\u547d\u4ee4\u4e2d\u6307\u5b9a\u7684inter\u503c\uff0c\u5982\u679c\u914d\u7f6e\u4e86<code>timeout check</code>\uff0cHAProxy\u4f1a\u4ee5inter\u4f5c\u4e3a\u5065\u5eb7\u68c0\u67e5\u8bf7\u6c42\u7684\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\uff0c\u5e76\u4ee5timeout check\u7684\u503c\u4f5c\u4e3a\u5065\u5eb7\u68c0\u67e5\u8bf7\u6c42\u7684\u54cd\u5e94\u8d85\u65f6\u65f6\u95f4</li> <li><code>timeout server [time]</code>\uff1a\u6307backend server\u54cd\u5e94HAProxy\u8bf7\u6c42\u7684\u8d85\u65f6\u65f6\u95f4</li> </ul>"},{"location":"chap6/10haproxy_learn/#default","title":"default\u57df","text":"<p>\u4e0a\u6587\u6240\u5c5e\u7684frontend\u548cbackend\u57df\u5173\u952e\u914d\u7f6e\u4e2d\uff0c\u9664acl\u3001bind\u3001http-request\u3001http-response\u3001<code>use_backend</code>\u5916\uff0c\u5176\u4f59\u7684\u5747\u53ef\u4ee5\u914d\u7f6e\u5728default\u57df\u4e2d\u3002default\u57df\u4e2d\u914d\u7f6e\u4e86\u7684\u9879\u76ee\uff0c\u5982\u679c\u5728frontend\u6216backend\u57df\u4e2d\u6ca1\u6709\u914d\u7f6e\uff0c\u5c06\u4f1a\u4f7f\u7528default\u57df\u4e2d\u7684\u914d\u7f6e\u3002</p>"},{"location":"chap6/10haproxy_learn/#listen","title":"listen\u57df","text":"<p>listen\u57df\u662ffrontend\u57df\u548cbackend\u57df\u7684\u7ec4\u5408\uff0cfrontend\u57df\u548cbackend\u57df\u4e2d\u6240\u6709\u7684\u914d\u7f6e\u90fd\u53ef\u4ee5\u914d\u7f6e\u5728listen\u57df\u4e0b</p> <p>\u5b98\u65b9\u914d\u7f6e\u6587\u6863</p> <p>HAProxy\u7684\u914d\u7f6e\u9879\u975e\u5e38\u591a\uff0c\u652f\u6301\u975e\u5e38\u4e30\u5bcc\u7684\u529f\u80fd\uff0c\u4e0a\u6587\u53ea\u5217\u51fa\u4e86\u4f5c\u4e3aL7\u8d1f\u8f7d\u5747\u8861\u5668\u4f7f\u7528HAProxy\u65f6\u7684\u4e00\u4e9b\u5173\u952e\u53c2\u6570\u3002\u5b8c\u6574\u7684\u53c2\u6570\u8bf4\u660e\u8bf7\u53c2\u89c1\u5b98\u65b9\u6587\u6863 configuration.html</p>"},{"location":"chap6/10haproxy_learn/#keepalivedhaproxy","title":"\u4f7f\u7528Keepalived\u5b9e\u73b0HAProxy\u9ad8\u53ef\u7528","text":"<p>\u5c3d\u7ba1HAProxy\u975e\u5e38\u7a33\u5b9a\uff0c\u4f46\u4ecd\u7136\u65e0\u6cd5\u89c4\u907f\u64cd\u4f5c\u7cfb\u7edf\u6545\u969c\u3001\u4e3b\u673a\u786c\u4ef6\u6545\u969c\u3001\u7f51\u7edc\u6545\u969c\u751a\u81f3\u65ad\u7535\u5e26\u6765\u7684\u98ce\u9669\u3002\u6240\u4ee5\u5fc5\u987b\u5bf9HAProxy\u5b9e\u65bd\u9ad8\u53ef\u7528\u65b9\u6848\u3002</p> <p>\u4e0b\u6587\u5c06\u4ecb\u7ecd\u5229\u7528Keepalived\u5b9e\u73b0\u7684HAProxy\u70ed\u5907\u65b9\u6848\u3002\u5373\u4e24\u53f0\u4e3b\u673a\u4e0a\u7684\u4e24\u4e2aHAProxy\u5b9e\u4f8b\u540c\u65f6\u5728\u7ebf\uff0c\u5176\u4e2d\u6743\u91cd\u8f83\u9ad8\u7684\u5b9e\u4f8b\u4e3aMASTER\uff0cMASTER\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u53e6\u4e00\u53f0\u5b9e\u4f8b\u81ea\u52a8\u63a5\u7ba1\u6240\u6709\u6d41\u91cf\u3002</p> <p>\u539f\u7406</p> <p>\u5728\u4e24\u53f0HAProxy\u7684\u4e3b\u673a\u4e0a\u5206\u522b\u8fd0\u884c\u7740\u4e00\u4e2aKeepalived\u5b9e\u4f8b\uff0c\u8fd9\u4e24\u4e2aKeepalived\u4e89\u62a2\u540c\u4e00\u4e2a\u865aIP\u5730\u5740\uff0c\u4e24\u4e2aHAProxy\u4e5f\u5c1d\u8bd5\u53bb\u7ed1\u5b9a\u8fd9\u540c\u4e00\u4e2a\u865aIP\u5730\u5740\u4e0a\u7684\u7aef\u53e3\u3002</p> <p>\u663e\u7136\uff0c\u540c\u65f6\u53ea\u80fd\u6709\u4e00\u4e2aKeepalived\u62a2\u5230\u8fd9\u4e2a\u865aIP\uff0c\u62a2\u5230\u4e86\u8fd9\u4e2a\u865aIP\u7684Keepalived\u4e3b\u673a\u4e0a\u7684HAProxy\u4fbf\u662f\u5f53\u524d\u7684MASTER\u3002</p> <p>Keepalived\u5185\u90e8\u7ef4\u62a4\u4e00\u4e2a\u6743\u91cd\u503c\uff0c\u6743\u91cd\u503c\u6700\u9ad8\u7684Keepalived\u5b9e\u4f8b\u80fd\u591f\u62a2\u5230\u865aIP\u3002\u540c\u65f6Keepalived\u4f1a\u5b9a\u671fcheck\u672c\u4e3b\u673a\u4e0a\u7684HAProxy\u72b6\u6001\uff0c\u72b6\u6001OK\u65f6\u6743\u91cd\u503c\u589e\u52a0\u3002</p>"},{"location":"chap6/10haproxy_learn/#haproxy_5","title":"\u642d\u5efaHAProxy\u4e3b\u5907\u96c6\u7fa4","text":"<p>\u73af\u5883\u51c6\u5907</p> <p>\u5728\u4e24\u53f0\u7269\u7406\u673a\u4e0a\u5b89\u88c5\u5e76\u914d\u7f6eHAProxy\uff0c\u672c\u4f8b\u4e2d\uff0c\u5c06\u5728192.168.8.110\u548c192.168.8.111\u4e24\u53f0\u4e3b\u673a\u4e0a\u4e0a\u5b89\u88c5\u4e24\u5957\u5b8c\u5168\u4e00\u6837\u7684HAProxy\uff0c\u5177\u4f53\u6b65\u9aa4\u7701\u7565\uff0c\u8bf7\u53c2\u8003\u201c\u4f7f\u7528HAProxy\u642d\u5efaL7\u8d1f\u8f7d\u5747\u8861\u5668\u201d\u4e00\u8282\u3002</p> <p>\u5b89\u88c5Keepalived</p> <p>\u4e0b\u8f7d\uff0c\u89e3\u538b\uff0c\u7f16\u8bd1\uff0c\u5b89\u88c5</p> <pre><code>wget http://www.keepalived.org/software/keepalived-1.2.19.tar.gz\ntar -xzf keepalived-1.2.19.tar.gz\n./configure --prefix=/usr/local/keepalived\nmake\nmake install\n</code></pre> <p>\u6ce8\u518c\u4e3a\u7cfb\u7edf\u670d\u52a1\uff1a</p> <pre><code>cp /usr/local/keepalived/sbin/keepalived /usr/sbin/\ncp /usr/local/keepalived/etc/sysconfig/keepalived /etc/sysconfig/\ncp /usr/local/keepalived/etc/rc.d/init.d/keepalived /etc/init.d/\nchmod +x /etc/init.d/keepalived\n</code></pre> <p>\u6ce8\u610f\uff1aKeepalived\u9700\u8981\u4f7f\u7528root\u7528\u6237\u8fdb\u884c\u5b89\u88c5\u548c\u914d\u7f6e</p> <p>\u914d\u7f6eKeepalived</p> <p>\u521b\u5efa\u5e76\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6</p> <pre><code>mkdir -p /etc/keepalived/\ncp /usr/local/keepalived/etc/keepalived/keepalived.conf /etc/keepalived/\nvi /etc/keepalived/keepalived.conf\n</code></pre> <p>\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9\uff1a</p> <pre><code>global_defs {\n    router_id LVS_DEVEL  #\u865a\u62df\u8def\u7531\u540d\u79f0\n}\n\n#HAProxy\u5065\u5eb7\u68c0\u67e5\u914d\u7f6e\nvrrp_script chk_haproxy {\n    script \"killall -0 haproxy\"  #\u4f7f\u7528killall -0\u68c0\u67e5haproxy\u5b9e\u4f8b\u662f\u5426\u5b58\u5728\uff0c\u6027\u80fd\u9ad8\u4e8eps\u547d\u4ee4\n    interval 2   #\u811a\u672c\u8fd0\u884c\u5468\u671f\n    weight 2   #\u6bcf\u6b21\u68c0\u67e5\u7684\u52a0\u6743\u6743\u91cd\u503c\n}\n\n#\u865a\u62df\u8def\u7531\u914d\u7f6e\nvrrp_instance VI_1 {\n    state MASTER           #\u672c\u673a\u5b9e\u4f8b\u72b6\u6001\uff0cMASTER/BACKUP\uff0c\u5907\u673a\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bf7\u5199BACKUP\n    interface enp0s25      #\u672c\u673a\u7f51\u5361\u540d\u79f0\uff0c\u4f7f\u7528ifconfig\u547d\u4ee4\u67e5\u770b\n    virtual_router_id 51   #\u865a\u62df\u8def\u7531\u7f16\u53f7\uff0c\u4e3b\u5907\u673a\u4fdd\u6301\u4e00\u81f4\n    priority 101           #\u672c\u673a\u521d\u59cb\u6743\u91cd\uff0c\u5907\u673a\u8bf7\u586b\u5199\u5c0f\u4e8e\u4e3b\u673a\u7684\u503c\uff08\u4f8b\u5982100\uff09\n    advert_int 1           #\u4e89\u62a2\u865a\u5730\u5740\u7684\u5468\u671f\uff0c\u79d2\n    virtual_ipaddress {\n        192.168.8.201      #\u865a\u5730\u5740IP\uff0c\u4e3b\u5907\u673a\u4fdd\u6301\u4e00\u81f4\n    }\n    track_script {\n        chk_haproxy        #\u5bf9\u5e94\u7684\u5065\u5eb7\u68c0\u67e5\u914d\u7f6e\n    }\n}\n</code></pre> <p>\u5982\u679c\u4e3b\u673a\u6ca1\u6709killall\u547d\u4ee4\uff0c\u5219\u9700\u8981\u5b89\u88c5psmisc\u5305\uff1a</p> <pre><code>yum intall psmisc\n</code></pre> <p>\u5206\u522b\u542f\u52a8\u4e24\u4e2aKeepalived</p> <pre><code>service keepalived start\n</code></pre> <p>\u9a8c\u8bc1</p> <p>\u542f\u52a8\u540e\uff0c\u5148\u5206\u522b\u5728\u4e24\u53f0\u4e3b\u673a\u67e5\u770b\u865aIP 192.168.8.201\u7531\u8c01\u6301\u6709\uff0c\u6267\u884c\u547d\u4ee4\uff1a</p> <pre><code>ip addr sh enp0s25   \uff08\u5c06enp0s25\u66ff\u6362\u6210\u4e3b\u673a\u7684\u7f51\u5361\u540d\uff09\n</code></pre> <p>\u6301\u6709\u865aIP\u7684\u4e3b\u673a\u8f93\u51fa\u4f1a\u662f\u8fd9\u6837\u7684\uff1a</p> <p></p> <p>\u53e6\u4e00\u53f0\u4e3b\u673a\u8f93\u51fa\u5219\u662f\u8fd9\u6837\u7684\uff1a</p> <p></p> <p>\u5982\u679c\u4f60\u5148\u542f\u52a8\u5907\u673a\u7684Keepalived\uff0c\u90a3\u4e48\u5f88\u6709\u53ef\u80fd\u865aIP\u4f1a\u88ab\u5907\u673a\u62a2\u5230\uff0c\u56e0\u4e3a\u5907\u673a\u7684\u6743\u91cd\u914d\u7f6e\u53ea\u6bd4\u4e3b\u673a\u4f4e1\uff0c\u53ea\u8981\u6267\u884c\u4e00\u6b21\u5065\u5eb7\u68c0\u67e5\u5c31\u80fd\u628a\u6743\u91cd\u63d0\u9ad8\u5230102\uff0c\u9ad8\u4e8e\u4e3b\u673a\u7684101\u3002</p> <p>\u6b64\u65f6\u8bbf\u95eehttp://192.168.8.201:9001/ms1/demo.html \uff0c\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u5148\u524d\u90e8\u7f72\u7684\u7f51\u9875\u3002 \u6b64\u65f6\uff0c\u68c0\u67e5/var/log/haproxy.log\uff0c\u80fd\u770b\u5230\u6b64\u8bf7\u6c42\u843d\u5728\u4e86\u62a2\u5230\u4e86\u865aIP\u7684\u4e3b\u673a\u4e0a\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u505c\u6389\u5f53\u524dMASTER\u4e3b\u673a\u7684HAProxy\u5b9e\u4f8b\uff08\u6216\u8005Keepalive\u5b9e\u4f8b\uff0c\u6548\u679c\u4e00\u6837\uff09</p> <pre><code>service haproxy stop\n</code></pre> <p>\u518d\u6b21\u8bbf\u95eehttp://192.168.8.201:9001/ms1/demo.html \uff0c\u5e76\u67e5\u770b\u5907\u673a\u7684/var/log/haproxy.log\uff0c\u4f1a\u770b\u5230\u6b64\u8bf7\u6c42\u843d\u5728\u4e86\u5907\u673a\u4e0a\uff0c\u4e3b\u5907\u81ea\u52a8\u5207\u6362\u6210\u529f\u3002</p> <p>\u4e5f\u53ef\u4ee5\u518d\u6b21\u6267\u884cip addr sh enp0s25\u547d\u4ee4\uff0c\u4f1a\u770b\u5230\u865aIP\u88ab\u5907\u673a\u62a2\u53bb\u4e86\u3002 \u5728<code>/var/log/message</code>\u4e2d\uff0c\u4e5f\u80fd\u591f\u770b\u5230keepalived\u8f93\u51fa\u7684\u5207\u6362\u65e5\u5fd7</p>"},{"location":"chap6/12Linux_vir_file/","title":"L12 \u4ece lsof \u5f00\u59cb\uff0c\u6df1\u5165\u7406\u89e3 Linux \u865a\u62df\u6587\u4ef6\u7cfb\u7edf","text":""},{"location":"chap6/12Linux_vir_file/#1","title":"1 \u80cc\u666f","text":"<p>\u6709\u65f6\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u60c5\u51b5\uff0c\u78c1\u76d8\u7a7a\u95f4\u663e\u793a\u5df2\u7ecf\u88ab\u5360\u6ee1\uff0c\u4f46\u662f\u5728\u67e5\u770b\u78c1\u76d8\u7684\u5177\u4f53\u6587\u4ef6\u5360\u7528\u60c5\u51b5\u65f6\uff0c\u53d1\u73b0\u78c1\u76d8\u4ecd\u7136\u6709\u5f88\u5927\u7684\u7a7a\u4f59\u7a7a\u95f4\u3002</p> <p>1.\u6267\u884c<code>df</code>\u547d\u4ee4\u67e5\u770b\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\uff0c\u53d1\u73b0\u78c1\u76d8\u5df2\u7ecf\u6ee1\u4e86\u3002</p> <pre><code>$ df -Th\nFilesystem     Type      Size  Used Avail Use% Mounted on\n/dev/vda1      ext4       30G    30G 0      100% /\ndevtmpfs       devtmpfs  489M     0  489M   0% /dev\ntmpfs          tmpfs     497M     0  497M   0% /dev/shm\ntmpfs          tmpfs     497M   50M  447M  11% /run\ntmpfs          tmpfs     497M     0  497M   0% /sys/fs/cgroup\n</code></pre> <p>2.\u6267\u884c <code>du</code> \u547d\u4ee4\u67e5\u770b\u5404\u4e2a\u76ee\u5f55\u7684\u78c1\u76d8\u5360\u7528\u60c5\u51b5\uff0c\u628a\u5404\u4e2a\u76ee\u5f55\u6587\u4ef6\u7684\u5927\u5c0f\u76f8\u52a0\uff0c\u53d1\u73b0\u5e76\u6ca1\u6709\u5360\u6ee1\u78c1\u76d8\uff0c\u670910\u591aG\u7a7a\u95f4\u83ab\u540d\u5931\u8e2a\u3002</p> <pre><code>$ du -h --max-depth=1 /home16M /home/logs11G /home/serverdog11G /home\n</code></pre> <p>3.\u4e3a\u4f55\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u60c5\u51b5\u5462\uff1f</p> <p>\u56e0\u4e3a\u867d\u7136\u6587\u4ef6\u5df2\u88ab\u5220\u9664\uff0c\u4f46\u662f\u4e00\u4e9b\u8fdb\u7a0b\u4ecd\u7136\u6253\u5f00\u8fd9\u4e9b\u6587\u4ef6\uff0c\u56e0\u6b64\u5176\u5360\u7528\u7684\u78c1\u76d8\u7a7a\u95f4\u5e76\u6ca1\u6709\u88ab\u91ca\u653e\u3002\u6267\u884clsof \u547d\u4ee4\u663e\u793a\u6253\u5f00\u5df2\u5220\u9664\u7684\u6587\u4ef6\u3002\u5c06\u6709\u95ee\u9898\u7684\u8fdb\u7a0b\u91cd\u542f\uff08\u6216\uff0c\u6e05\u7a7a\uff09\uff0c\u78c1\u76d8\u7a7a\u95f4\u5c31\u4f1a\u5f97\u5230\u91ca\u653e\u3002</p> <pre><code># lsof | grep delete\nmysqld     2470         mysql    4u      REG              253,1           0     523577 /var/tmp/ibfTeQFn (deleted)\nmysqld     2470         mysql    5u      REG              253,1           0     523579 /var/tmp/ibaHcIdW (deleted)\nmysqld     2470         mysql    6u      REG              253,1           0     523581 /var/tmp/ibLjiALu (deleted)\nmysqld     2470         mysql    7u      REG              253,1           0     523585 /var/tmp/ibCFnzTB (deleted)\nmysqld     2470         mysql   11u      REG              253,1           0     523587 /var/tmp/ibCjuqva (deleted)\n</code></pre> <pre><code> lsof | grep delete\nfileprovi   552 i515190    7r      DIR                1,4         64            89767166 /Users/i515190/Library/Application Support/FileProvider/FC87C0C5-2334-48A1-B44C-2C49D4F6ADB4/wharf/wharf/delete\ndeleted   20055 i515190  cwd       DIR                1,4        640                   2 /\ndeleted   20055 i515190  txt       REG                1,4    1384240 1152921500312492067 /System/Library/PrivateFrameworks/CacheDelete.framework/deleted\ndeleted   20055 i515190  txt       REG                1,4      46052            88735091 /Library/Preferences/Logging/.plist-cache.ql5gssJz\ndeleted   20055 i515190  txt       REG                1,4       7704            89818142 /Library/Application Support/CrashReporter/SubmitDiagInfo.domains\ndeleted   20055 i515190  txt       REG                1,4     114829            89908732 /private/var/db/analyticsd/events.whitelist\n</code></pre> <p>\u90a3\u4e48\uff0cLinux \u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5230\u5e95\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u8bbe\u8ba1\u5462\uff1f\u8981\u4e86\u89e3\u8fd9\u4e9b\uff0c\u5c31\u8981\u5148\u5f04\u6e05\u695a\u5e76\u4e0d\u5bb9\u6613\uff0c\u4e0b\u9762\u5c06\u4ece\u4e00\u4e9b\u57fa\u672c\u6982\u5ff5\u5165\u624b\uff0c\u4e00\u6b65\u6b65\u5c06\u8fd9\u4e9b\u68b3\u7406\u6e05\u695a\uff1a</p> <ul> <li> <p>\u4ec0\u4e48\u662f\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff08VFS\uff1avirtual filesystem\uff09\uff1f</p> </li> <li> <p>\u4ec0\u4e48\u662f\u901a\u7528\u6587\u4ef6\u6a21\u578b\uff1f</p> <ul> <li>\u8d85\u7ea7\u5757\u5bf9\u8c61\uff08superblock object\uff09</li> <li>\u7d22\u5f15\u8282\u70b9\u5bf9\u8c61\uff08inode object\uff09</li> <li>\u6587\u4ef6\u5bf9\u8c61\uff08file object\uff09</li> <li>\u76ee\u5f55\u9879\u5bf9\u8c61\uff08dentry object\uff09</li> <li>\u6587\u4ef6\u7684\u6982\u5ff5</li> </ul> </li> <li> <p>\u6587\u4ef6\u7684\u8868\u8fbe</p> <ul> <li>\u5185\u5b58\u8868\u8fbe</li> <li>\u78c1\u76d8\u8868\u8fbe</li> </ul> </li> <li> <p>\u76ee\u5f55\u6811\u7684\u6784\u5efa</p> <ul> <li>\u8f6f\u94fe\u63a5 vs \u786c\u94fe\u63a5</li> </ul> </li> <li> <p>\u6587\u4ef6 &amp; \u78c1\u76d8\u7ba1\u7406</p> <ul> <li>\u7d22\u5f15\u8282\u70b9\u72b6\u6001</li> </ul> </li> <li> <p>\u6587\u4ef6 &amp; \u8fdb\u7a0b\u7ba1\u7406</p> <ul> <li>\u64cd\u4f5c\uff1a\u6253\u5f00&amp;\u5220\u9664</li> </ul> </li> </ul>"},{"location":"chap6/12Linux_vir_file/#2-virtual-filesystem","title":"2 \u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff08virtual filesystem\uff09","text":"<p>\u4e0b\u56fe\u663e\u793a\u4e86 Linux \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8d1f\u8d23\u6587\u4ef6\u7ba1\u7406\u7684\u57fa\u672c\u7ec4\u4ef6\u3002\u4e0a\u534a\u533a\u57df\u4e3a\u7528\u6237\u6a21\u5f0f\uff0c\u4e0b\u534a\u533a\u57df\u4e3a\u5185\u6838\u6a21\u5f0f\u3002\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u6807\u51c6\u5e93libc\u6765\u8bbf\u95ee\u6587\u4ef6\uff0c\u5e93\u5c06\u8bf7\u6c42\u6620\u5c04\u5230\u7cfb\u7edf\u8c03\u7528\uff0c\u4ee5\u4fbf\u8fdb\u5165\u5185\u6838\u6a21\u5f0f\u3002</p> <p></p> <p>\u6240\u6709\u4e0e\u6587\u4ef6\u76f8\u5173\u7684\u64cd\u4f5c\u7684\u5165\u53e3\u90fd\u662f\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff08VFS\uff09\uff0c\u800c\u975e\u7279\u5b9a\u7684\u989d\u6587\u4ef6\u7cfb\u7edf\uff08\u5982Ext3\u3001ReiserFS\u548cNFS\uff09\u3002VFS \u63d0\u4f9b\u4e86\u7cfb\u7edf\u5e93\u548c\u7279\u5b9a\u6587\u4ef6\u7cfb\u7edf\u4e4b\u95f4\u7684\u63a5\u53e3\u3002</p> <p>\u56e0\u6b64\uff0cVFS \u4e0d\u4ec5\u5145\u5f53\u62bd\u8c61\u5c42\uff0c\u800c\u4e14\u5b9e\u9645\u4e0a\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u7684\u57fa\u672c\u5b9e\u73b0\uff0c\u53ef\u4ee5\u7531\u4e0d\u540c\u7684\u5b9e\u73b0\u6765\u4f7f\u7528\u548c\u6269\u5c55\u3002\u56e0\u6b64\uff0c\u8981\u4e86\u89e3\u6587\u4ef6\u7cfb\u7edf\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u5c31\u8981\u5148\u4e86\u89e3VFS \u3002</p>"},{"location":"chap6/12Linux_vir_file/#3","title":"3 \u901a\u7528\u6587\u4ef6\u6a21\u578b","text":"<p>VFS \u7684\u4e3b\u8981\u601d\u60f3\u5728\u4e8e\u5f15\u5165\u4e86\u4e00\u4e2a\u901a\u7528\u6587\u4ef6\u6a21\u578b\uff08common file model\uff09\u3002\u901a\u7528\u6587\u4ef6\u6a21\u578b\u7531\u4ee5\u4e0b\u5bf9\u8c61\u7c7b\u578b\u7ec4\u6210\uff1a</p>"},{"location":"chap6/12Linux_vir_file/#3-1-superblock-object","title":"3-1 \u8d85\u7ea7\u5757\u5bf9\u8c61\uff08superblock object\uff09","text":"<ul> <li>\u5185\u5b58\uff1a\u6587\u4ef6\u7cfb\u7edf\u5b89\u88c5\u65f6\u521b\u5efa\uff0c\u5b58\u653e\u6587\u4ef6\u7cfb\u7edf\u7684\u6709\u5173\u4fe1\u606f</li> <li>\u78c1\u76d8\uff1a\u5bf9\u5e94\u4e8e\u5b58\u653e\u5728\u78c1\u76d8\u4e0a\u7684\u6587\u4ef6\u7cfb\u7edf\u63a7\u5236\u5757\uff08filesystem control block\uff09</li> </ul>"},{"location":"chap6/12Linux_vir_file/#3-2-inode-object","title":"3-2 \u7d22\u5f15\u8282\u70b9\u5bf9\u8c61\uff08inode object\uff09","text":"<ul> <li>\u5185\u5b58\uff1a\u8bbf\u95ee\u65f6\u521b\u5efa\uff0c\u5b58\u653e\u5173\u4e8e\u5177\u4f53\u6587\u4ef6\u7684\u4e00\u822c\u4fe1\u606f\uff08inode \u7ed3\u6784\uff09</li> <li>\u78c1\u76d8\uff1a\u5bf9\u5e94\u4e8e\u5b58\u653e\u5728\u78c1\u76d8\u4e0a\u7684\u6587\u4ef6\u63a7\u5236\u5757\uff08file control block\uff09</li> <li>\u6bcf\u4e2a\u7d22\u5f15\u8282\u70b9\u5bf9\u8c61\u90fd\u6709\u4e00\u4e2a\u7d22\u5f15\u8282\u70b9\u53f7\uff0c\u552f\u4e00\u5730\u6807\u8bc6\u6587\u4ef6\u7cfb\u7edf\u7684\u6587\u4ef6</li> </ul>"},{"location":"chap6/12Linux_vir_file/#3-3-file-object","title":"3-3 \u6587\u4ef6\u5bf9\u8c61\uff08file object\uff09","text":"<ul> <li>\u5185\u5b58\uff1a\u6253\u5f00\u6587\u4ef6\u65f6\u521b\u5efa\uff0c\u5b58\u653e \u6253\u5f00\u6587\u4ef6 \u4e0e\u8fdb\u7a0b\u4e4b\u95f4\u8fdb\u884c\u4ea4\u4e92\u7684\u6709\u5173\u4fe1\u606f\uff08file \u7ed3\u6784\uff09</li> <li>\u6253\u5f00\u6587\u4ef6\u4fe1\u606f\uff0c\u4ec5\u5f53\u8fdb\u7a0b\u8bbf\u95ee\u6587\u4ef6\u671f\u95f4\u5b58\u5728\u4e8e\u5185\u6838\u5185\u5b58\u4e2d\u3002</li> </ul>"},{"location":"chap6/12Linux_vir_file/#3-4-dentry-object","title":"3-4 \u76ee\u5f55\u9879\u5bf9\u8c61\uff08dentry object\uff09","text":"<ul> <li>\u5185\u5b58\uff1a\u76ee\u5f55\u9879\u4e00\u65e6\u88ab\u8bfb\u5165\u5185\u5b58\uff0cVFS\u5c31\u4f1a\u5c06\u5176\u8f6c\u6362\u6210dentry \u7ed3\u6784\u7684\u76ee\u5f55\u9879\u5bf9\u8c61</li> <li>\u78c1\u76d8\uff1a\u7279\u5b9a\u6587\u4ef6\u7cfb\u7edf\u4ee5\u7279\u5b9a\u7684\u65b9\u5f0f\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a</li> <li>\u5b58\u653e\u76ee\u5f55\u9879\uff08\u5373\uff0c\u6587\u4ef6\u540d\u79f0\uff09\u4e0e\u5bf9\u5e94\u6587\u4ef6\u8fdb\u884c\u94fe\u63a5\u7684\u6709\u5173\u4fe1\u606f</li> </ul>"},{"location":"chap6/12Linux_vir_file/#4","title":"4 \u76ee\u5f55\u6811","text":"<p>\u7efc\u5408\u6765\u8bf4\uff0cLinux \u7684 \u6839\u6587\u4ef6\u7cfb\u7edf(system\u2019s root filessystem) \u662f\u5185\u6838\u542f\u52a8mount\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u3002\u5185\u6838\u4ee3\u7801\u6620\u50cf\u6587\u4ef6\u4fdd\u5b58\u5728\u6839\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u800c\u7cfb\u7edf\u5f15\u5bfc\u542f\u52a8\u7a0b\u5e8f\u4f1a\u5728\u6839\u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u4e4b\u540e\uff0c\u4ece\u4e2d\u628a\u4e00\u4e9b\u57fa\u672c\u7684\u521d\u59cb\u5316\u811a\u672c\u548c\u670d\u52a1\u7b49\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u53bb\u8fd0\u884c\uff08\u6587\u4ef6\u7cfb\u7edf\u548c\u5185\u6838\u662f\u5b8c\u5168\u72ec\u7acb\u7684\u4e24\u4e2a\u90e8\u5206\uff09\u3002</p> <p>\u5176\u4ed6\u6587\u4ef6\u7cfb\u7edf\uff0c\u5219\u540e\u7eed\u901a\u8fc7\u811a\u672c\u6216\u547d\u4ee4\u4f5c\u4e3a\u5b50\u6587\u4ef6\u7cfb\u7edf\u5b89\u88c5\u5728\u5df2\u5b89\u88c5\u6587\u4ef6\u7cfb\u7edf\u7684\u76ee\u5f55\u4e0a\uff0c\u6700\u7ec8\u5f62\u6210\u6574\u4e2a\u76ee\u5f55\u6811\u3002</p> <pre><code>start_kernel \n\u3000\u3000vfs_caches_init \n\u3000\u3000\u3000\u3000mnt_init \n\u3000\u3000\u3000\u3000\u3000\u3000init_rootfs     // \u6ce8\u518crootfs\u6587\u4ef6\u7cfb\u7edf\n\u3000\u3000\u3000\u3000\u3000\u3000init_mount_tree // \u6302\u8f7drootfs\u6587\u4ef6\u7cfb\u7edf \n\u3000\u3000\u2026 \n\u3000\u3000rest_init \n\u3000\u3000kernel_thread(kernel_init, NULL, CLONE_FS);\n</code></pre> <p>\u5c31\u5355\u4e2a\u6587\u4ef6\u7cfb\u7edf\u800c\u8a00\uff0c\u5728\u6587\u4ef6\u7cfb\u7edf\u5b89\u88c5\u65f6\uff0c\u521b\u5efa\u8d85\u7ea7\u5757\u5bf9\u8c61\uff1b\u6cbf\u6811\u67e5\u627e\u6587\u4ef6\u65f6\uff0c\u603b\u662f\u9996\u5148\u4ece\u521d\u8bc6\u76ee\u5f55\u7684\u4e2d\u67e5\u627e\u5339\u914d\u7684\u76ee\u5f55\u9879\uff0c\u4ee5\u4fbf\u83b7\u53d6\u76f8\u5e94\u7684\u7d22\u5f15\u8282\u70b9\uff0c\u7136\u540e\u8bfb\u53d6\u7d22\u5f15\u8282\u70b9\u7684\u76ee\u5f55\u6587\u4ef6\uff0c\u8f6c\u5316\u4e3adentry\u5bf9\u8c61\uff0c\u518d\u68c0\u67e5\u5339\u914d\u7684\u76ee\u5f55\u9879\uff0c\u53cd\u590d\u6267\u884c\u4ee5\u4e0a\u8fc7\u7a0b\uff0c\u76f4\u81f3\u627e\u5230\u5bf9\u5e94\u7684\u6587\u4ef6\u7684\u7d22\u5f15\u8282\u70b9\uff0c\u5e76\u521b\u5efa\u7d22\u5f15\u8282\u70b9\u5bf9\u8c61\u3002</p>"},{"location":"chap6/12Linux_vir_file/#5-vs","title":"5 \u8f6f\u94fe\u63a5 vs \u786c\u94fe\u63a5","text":"<p>\u8f6f\u94fe\u63a5\u662f\u4e00\u4e2a\u666e\u901a\u7684\u6587\u4ef6\uff0c\u5176\u4e2d\u5b58\u653e\u7684\u662f\u53e6\u5916\u4e00\u4e2a\u6587\u4ef6\u7684\u8def\u5f84\u540d\u3002</p> <ul> <li>\u786c\u94fe\u63a5\u5219\u6307\u5411\u540c\u4e00\u4e2a\u7d22\u5f15\u8282\u70b9\uff0c\u786c\u94fe\u63a5\u6570\u8bb0\u5f55\u5728\u7d22\u5f15\u8282\u70b9\u5bf9\u8c61\u7684 <code>i_nlink</code> \u5b57\u6bb5\u3002</li> <li>\u5f53<code>i_nlink</code>\u5b57\u6bb5\u4e3a\u96f6\u65f6\uff0c\u8bf4\u660e\u6ca1\u6709\u786c\u94fe\u63a5\u6307\u5411\u8be5\u6587\u4ef6\u3002</li> </ul>"},{"location":"chap6/12Linux_vir_file/#6","title":"6 \u6587\u4ef6 &amp; \u8fdb\u7a0b\u7ba1\u7406","text":"<p>\u4e0b\u56fe\u662f\u4e00\u4e2a\u7b80\u5355\u793a\u4f8b\uff0c\u8bf4\u660e\u8fdb\u7a0b\u662f\u600e\u6837\u4e0e\u6587\u4ef6\u8fdb\u884c\u4ea4\u4e92\u3002\u4e09\u4e2a\u4e0d\u540c\u8fdb\u7a0b\u6253\u5f00\u540c\u4e00\u4e2a\u6587\u4ef6\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u81ea\u5df1\u7684\u6587\u4ef6\u5bf9\u8c61\uff0c\u5176\u4e2d\u4e24\u4e2a\u8fdb\u7a0b\u4f7f\u7528\u540c\u4e00\u4e2a\u786c\u94fe\u63a5\uff08\u6bcf\u4e2a\u786c\u94fe\u63a5\u5bf9\u5e94\u4e00\u4e2a\u76ee\u5f55\u5bf9\u8c61\uff09\uff0c\u4e24\u4e2a\u76ee\u5f55\u9879\u5bf9\u8c61\u90fd\u6307\u5411\u540c\u4e00\u4e2a \u7d22\u5f15\u8282\u70b9\u5bf9\u8c61\u3002</p> <p></p> <p>\u7d22\u5f15\u8282\u70b9\u7684\u6570\u636e\u53c8\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff1a\u5185\u5b58\u6570\u636e\u548c\u78c1\u76d8\u6570\u636e\u3002</p> <p>Linux \u4f7f\u7528 Write back \u4f5c\u4e3a\u7d22\u5f15\u8282\u70b9\u7684\u6570\u636e\u4e00\u81f4\u6027\u7b56\u7565\u3002</p> <p>\u5bf9\u4e8e\u7d22\u5f15\u8282\u70b9\u7684\u6570\u636e\uff0c\u5f53\u6587\u4ef6\u88ab\u6253\u5f00\u65f6\uff0c\u624d\u4f1a\u52a0\u8f7d\u7d22\u5f15\u8282\u70b9\u5230\u5185\u5b58\uff1b\u5f53\u4e0d\u518d\u88ab\u8fdb\u7a0b\u4f7f\u7528\uff0c\u5219\u4ece\u5185\u5b58\u8e22\u51fa\uff1b\u5982\u679c\u4e2d\u95f4\u6709\u66f4\u65b0\uff0c\u5219\u9700\u8981\u628a\u6570\u636e\u5199\u56de\u78c1\u76d8\u3002</p> <pre><code>*  \"in_use\" - valid inode, i_count &gt; 0, i_nlink &gt; 0\n*  \"dirty\"  - as \"in_use\" but also dirty\n*  \"unused\" - valid inode, i_count = 0\n</code></pre> <p>\u7d22\u5f15\u8282\u70b9\u662f\u5426\u4ecd\u5728\u4f7f\u7528\uff0c\u662f\u901a\u8fc7 <code>open()</code> \u548c <code>close()</code> \u64cd\u4f5c\u5efa\u7acb\u548c\u9500\u6bc1\u6587\u4ef6\u5bf9\u8c61\uff0c\u6587\u4ef6\u5bf9\u8c61\u901a\u8fc7\u7d22\u5f15\u8282\u70b9\u63d0\u4f9b\u7684 <code>iget</code> \u548c <code>iput</code>  \u66f4\u65b0\u7d22\u5f15\u8282\u70b9\u7684<code>i_count</code>\u5b57\u6bb5\uff0c\u4ee5\u5b8c\u6210\u4f7f\u7528\u8ba1\u6570\u3002</p> <ul> <li><code>open</code> \u64cd\u4f5c\u4f7f\u5f97 <code>i_count</code> \u52a0\u4e00\uff0c close \u64cd\u4f5c\u4f7f\u5f97 <code>i_count</code> \u51cf\u4e00\u3002</li> <li>\u5728 close \u64cd\u4f5c\u65f6\u5224\u65ad\u7d22\u5f15\u8282\u70b9\u662f\u5426\u91ca\u653e\uff0c\u5982\u679c <code>i_count = 0</code>\uff0c\u5219\u610f\u5473\u7740\u4e0d\u518d\u6709\u8fdb\u7a0b\u5f15\u7528\uff0c\u5c06\u4f1a\u4ece\u5185\u5b58\u91ca\u653e\u3002</li> </ul>"},{"location":"chap6/12Linux_vir_file/#7","title":"7 \u6587\u4ef6 &amp; \u78c1\u76d8\u7ba1\u7406","text":"<p>\u6587\u4ef6\u4e0e\u78c1\u76d8\u7ba1\u7406\u8054\u7cfb\u6700\u7d27\u5bc6\u7684\u64cd\u4f5c\uff0c\u83ab\u8fc7\u4e8e<code>touch</code>\u548c<code>rm</code>\u64cd\u4f5c\uff0c\u800c\u5c24\u4ee5\u540e\u8005\u6700\u4e3a\u5173\u952e\u3002\u901a\u8fc7<code>strace</code>(\u6216 dtruss)\uff0c\u67e5\u770b <code>rm</code> \u7684\u5b9e\u9645\u7684\u7cfb\u7edf\u8c03\u7528</p> <pre><code>\n# dtruss rm tmp\n...\ngeteuid(0x0, 0x0, 0x0)       = 0 0\nioctl(0x0, 0x4004667A, 0x7FFEE06F09C4)       = 0 0\nlstat64(\"tmp\\0\", 0x7FFEE06F0968, 0x0)        = 0 0\naccess(\"tmp\\0\", 0x2, 0x0)        = 0 0\nunlink(\"tmp\\0\", 0x0, 0x0)        = 0 0\n</code></pre> <p>\u53ef\u4ee5\u53d1\u73b0 rm \u5b9e\u9645\u662f\u901a\u8fc7 unlink \u5b8c\u6210\u7684\u3002unlink\u4ee3\u8868\u5220\u9664\u76ee\u5f55\u9879\uff0c\u4ee5\u53ca\u51cf\u5c11\u5176\u7d22\u5f15\u8282\u70b9\u7684\u8ba1\u6570\u3002</p> <ul> <li>\u5220\u9664\u547d\u4ee4\uff08\u4e00\u4e2a\u8fdb\u7a0b\uff09\u4f7f\u7528 open \u64cd\u4f5c\u83b7\u5f97\u7236\u76ee\u5f55\u6587\u4ef6\u5bf9\u8c61</li> <li>\u901a\u8fc7 iget \u589e\u52a0 \u76ee\u5f55\u6587\u4ef6\u7684\u7d22\u5f15\u8282\u70b9\u5bf9\u8c61\u8ba1\u6570</li> <li>\u8bfb\u53d6\u76ee\u5f55\u6587\u4ef6\u6570\u636e<ul> <li>\u5c06\u76ee\u5f55\u6587\u4ef6\u6570\u636e\u8f6c\u5316\u4e3a\u76ee\u5f55\u9879\u5bf9\u8c61</li> <li>\u7531\u4e8e\u76ee\u5f55\u9879\u5305\u542b\u6587\u4ef6\u7684\u7d22\u5f15\u8282\u70b9\uff0c\u7c7b\u4f3c\u7684\uff0c\u9700\u8981\u901a\u8fc7 iget \u589e\u52a0\u6587\u4ef6\u7684\u7d22\u5f15\u8282\u70b9\u5bf9\u8c61\u8ba1\u6570</li> </ul> </li> <li>\u5220\u9664\u76ee\u5f55\u7684\u76ee\u5f55\u9879</li> <li>\u51cf\u5c11\u6587\u4ef6\u7d22\u5f15\u8282\u70b9\u5bf9\u8c61\u7684\u786c\u94fe\u63a5\u8ba1\u6570<code>i_nlink</code></li> <li>\u901a\u8fc7 iput \u7ed3\u675f\u5bf9\u6587\u4ef6\u7d22\u5f15\u8282\u70b9\u5bf9\u8c61\u7684\u64cd\u4f5c\uff0c\u4f7f\u7528\u8ba1\u6570<code>i_count</code> \u51cf\u4e00<ul> <li>\u5224\u65ad<code>i_count</code>\u662f\u5426\u4e3a\u96f6\uff0c\u5982\u679c\u4e3a\u96f6\uff0c\u5219\u91ca\u653e\u5185\u5b58</li> <li>\u7136\u540e\uff0c\u5224\u65ad<code>i_nlink</code>\u662f\u5426\u4e3a\u96f6\uff0c\u5982\u679c\u4e3a\u96f6\uff0c\u5219\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4</li> </ul> </li> <li>\u901a\u8fc7 iput \u7ed3\u675f\u5bf9\u76ee\u5f55\u7d22\u5f15\u8282\u70b9\u5bf9\u8c61\u7684\u64cd\u4f5c\u3002</li> </ul>"},{"location":"chap6/12Linux_vir_file/#_1","title":"\u7d22\u5f15\u4e0e\u6570\u636e","text":"<p>\u6587\u4ef6\u7cfb\u7edf\u4e0e\u6587\u4ef6\u3001\u78c1\u76d8\u7ba1\u7406\u4e0e\u6587\u4ef6\u3001\u8fdb\u7a0b\u7ba1\u7406\u4e0e\u6587\u4ef6\uff0c\u6700\u6838\u5fc3\u7684\u90fd\u662f\u6587\u4ef6\u7684\u7d22\u5f15\uff0c\u800c\u4e0d\u662f\u6587\u4ef6\u7684\u6570\u636e\u3002\u628a\u6570\u636e\u548c\u7d22\u5f15\u5206\u5f00\u662f\u7406\u89e3\u6587\u4ef6\u7cfb\u7edf\u7684\u5173\u952e\u3002</p> <p></p>"},{"location":"chap6/12Linux_vir_file/#_2","title":"\u7f13\u5b58\u7b56\u7565","text":"<p>\u7531\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528 Write back \u7684\u7b56\u7565\uff0c\u610f\u5473\u7740\u53ea\u6709\u5148\u91ca\u653e\u5185\u5b58\uff0c\u624d\u6709\u53ef\u80fd\u91ca\u653e\u78c1\u76d8\u3002</p> <p>Why lsof ?</p> <p>\u4ece\u4e0a\u9762\u7684\u6a21\u578b\u53ef\u4ee5\u5f88\u6e05\u695a\u7684\u7406\u89e3\uff0c\u56e0\u4e3a\u76ee\u5f55\u5df2\u7ecf\u6ca1\u6709\u7d22\u5f15\u5230\u6587\u4ef6\u4e86\uff0c\u4f46\u662f\u6253\u5f00\u6587\u4ef6\u8fd8\u6709\u7d22\u5f15\u5230\u6587\u4ef6\uff0c\u6240\u4ee5\u4e0d\u80fd\u7acb\u523b\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4\u3002</p> <p>\u4e3a\u4ec0\u4e48 lsof \u53ef\u4ee5\u627e\u5230\u5df2\u5220\u9664\u672a\u91ca\u653e\u7684\u6587\u4ef6\u5462\uff1f</p> <p>lsof\uff0c\u987e\u540d\u601d\u4e49\uff1alist open files\uff0c\u8be5\u547d\u4ee4\u7684\u539f\u7406\u5c31\u662f\u67e5\u627e\u6253\u5f00\u6587\u4ef6\u7684\u5217\u8868\uff0c\u56e0\u6b64\u53ef\u4ee5\u627e\u5230\u5df2\u5220\u9664\u672a\u91ca\u653e\u7684\u6587\u4ef6\u3002</p>"},{"location":"chap6/13Linux_ts/","title":"L13 Linux\u6545\u969c\u6392\u67e5\u601d\u8def\u53ca\u5e38\u7528\u547d\u4ee4","text":""},{"location":"chap6/13Linux_ts/#1-top","title":"1. \u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u72b6\u6001(top)","text":"<p>top\u547d\u4ee4\uff1a\u53ef\u4ee5\u6301\u7eed\u7684\u76d1\u89c6\u8fdb\u7a0b\u7684\u4fe1\u606f\u3002</p> <p>\u6316\u77ff\u5e94\u6025\u901a\u5e38\u4f18\u5148\u4f7f\u7528top\u547d\u4ee4\u6765\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\uff0c</p> <p>\u4e00\u822c\u6316\u77ff\u75c5\u6bd2\u7ad9\u7528CPU\u6bd4\u8f83\u5927</p>"},{"location":"chap6/13Linux_ts/#2-ps","title":"2. \u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u8fdb\u7a0b\u4fe1\u606f(ps)","text":"<p>ps\u547d\u4ee4\uff1a\u53ef\u4ee5\u67e5\u770b\u8fdb\u7a0b\u7684\u77ac\u95f4\u4fe1\u606f\u3002 \u5e38\u7528\u53c2\u6570\uff1a</p> <ul> <li><code>-a</code>\uff1a\u663e\u793a\u73b0\u884c\u7ec8\u7aef\u673a\u4e0b\u7684\u6240\u6709\u7a0b\u5e8f\uff0c\u5305\u62ec\u5176\u4ed6\u7528\u6237\u7684\u7a0b\u5e8f\u3002</li> <li><code>-e</code>\uff1a\u5217\u51fa\u7a0b\u5e8f\u65f6\uff0c\u663e\u793a\u6bcf\u4e2a\u7a0b\u5e8f\u6240\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\u3002</li> <li><code>-f</code>\uff1a\u663e\u793aUID,PPIP,C\u4e0eSTIME\u680f\u4f4d\u3002</li> </ul> <p></p>"},{"location":"chap6/13Linux_ts/#3-rootps","title":"3. \u67e5\u770b\u975eroot\u8fd0\u884c\u7684\u8fdb\u7a0b(ps)","text":"<p>\u547d\u4ee4: <code>ps -U root -u root -N</code></p> <p></p>"},{"location":"chap6/13Linux_ts/#4-rootps","title":"4. \u67e5\u770b\u7528\u6237root\u8fd0\u884c\u7684\u8fdb\u7a0b(ps)","text":"<p>\u547d\u4ee4: <code>ps -u root</code></p> <p></p>"},{"location":"chap6/13Linux_ts/#5-ps","title":"5 \u67e5\u770b\u6709\u6ca1\u6709\u5947\u602a\u8fdb\u7a0b(ps)","text":"<ul> <li>\u547d\u4ee4:<code>ps -aef | grep inetd</code></li> <li>grep \u662f\u641c\u7d22\u547d\u4ee4</li> <li>inetd \u7a0b\u5e8f\u662f\u4e00\u4e2aLinux\u5b88\u62a4\u8fdb\u7a0b.</li> </ul>"},{"location":"chap6/13Linux_ts/#6-ps","title":"6. \u68c0\u6d4b\u9690\u85cf\u8fdb\u7a0b(ps)","text":"<ul> <li>\u547d\u4ee4:<code>ps -ef | awk '{print}' | sort -n |uniq &gt;1</code></li> <li> <p>\u547d\u4ee4:<code>ls /proc | sort -n |uniq &gt;2</code></p> </li> <li> <p>sort \u547d\u4ee4\u5c06\u6587\u672c\u6587\u4ef6\u5185\u5bb9\u52a0\u4ee5\u6392\u5e8f,\u53ef\u9488\u5bf9\u6587\u672c\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u4ee5\u884c\u4e3a\u5355\u4f4d\u6765\u6392\u5e8f\u3002<code>-n</code> \u53c2\u6570\u4f9d\u7167\u6570\u503c\u7684\u5927\u5c0f\u6392\u5e8f\u3002</p> </li> <li>uniq \u547d\u4ee4\u7528\u4e8e\u68c0\u67e5\u53ca\u5220\u9664\u6587\u672c\u6587\u4ef6\u4e2d\u91cd\u590d\u51fa\u73b0\u7684\u884c\u5217\uff0c\u4e00\u822c\u4e0e <code>sort</code> \u547d\u4ee4\u7ed3\u5408\u4f7f\u7528\u3002</li> </ul>"},{"location":"chap6/13Linux_ts/#7-ls","title":"7. \u68c0\u6d4b\u7cfb\u7edf\u5b88\u62a4\u8fdb\u7a0b(ls)","text":"<p>\u547d\u4ee4:<code>ls /etc/crontab</code></p>"},{"location":"chap6/13Linux_ts/#_1","title":"\u4efb\u52a1\u53ca\u7528\u6237\u6d3b\u52a8\u6392\u67e5\u547d\u4ee4","text":"<p>1 \u67e5\u770b\u5f53\u524d\u767b\u9646\u7528\u6237\u7684IP\u4fe1\u606f(who)</p> <p>\u547d\u4ee4:<code>who -m</code></p> <pre><code>$ who -m\ni515190  ttys008  Apr  7 23:28 \n</code></pre>"},{"location":"chap6/13Linux_ts/#2-last","title":"2. \u67e5\u770b\u8fd1\u671f\u7528\u6237\u767b\u9646\u60c5\u51b5(last)","text":"<ul> <li>\u547d\u4ee4: <code>last -n 5</code>   ## -n 5 \u8868\u793a\u8f93\u51fa5\u6761</li> </ul>"},{"location":"chap6/13Linux_ts/#3-uid0awk","title":"3 \u67e5\u770buid\u4e3a0\u7684\u8d26\u53f7(awk)","text":"<pre><code>$ awk -F: '($3==0)' /etc/passwd\n\nroot:*:0:0:System Administrator:/var/root:/bin/sh\n</code></pre>"},{"location":"chap6/13Linux_ts/#4-uid0grep","title":"4. \u67e5\u770buid\u4e3a0\u7684\u8d26\u53f7(grep)","text":"<pre><code>grep -v -E \"^#\" /etc/passwd | awk -F: '$3==0{print $1}'\n\nroot\n</code></pre>"},{"location":"chap6/13Linux_ts/#5-pstree","title":"5. \u67e5\u770b\u8fdb\u7a0b\u6811\u662f\u5426\u6240\u6709\u5f02\u5e38\u8fdb\u7a0b\u5b58\u5728\u4e00\u4e2a\u7236\u8fdb\u7a0b\u3001\u5224\u65ad\u8fdb\u7a0b\u7684\u7236\u5b50\u5173\u7cfb(pstree)","text":"<pre><code>pstree -p\n</code></pre>"},{"location":"chap6/13Linux_ts/#_2","title":"\u7f51\u7edc\u6392\u67e5\u547d\u4ee4","text":"<p>netstat \u547d\u4ee4\u7528\u6765\u6253\u5370Linux\u4e2d\u7f51\u7edc\u7cfb\u7edf\u7684\u72b6\u6001\u4fe1\u606f\u3002</p> <p>\u5e38\u7528\u53c2\u6570\uff1a</p> <ul> <li>-a\u6216<code>\u2013all</code>\uff1a\u663e\u793a\u6240\u6709\u8fde\u7ebf\u4e2d\u7684Socket\u3002</li> <li>-c\u6216<code>\u2013continuous</code>\uff1a\u6301\u7eed\u5217\u51fa\u7f51\u7edc\u72b6\u6001\u3002</li> <li>-i\u6216<code>\u2013interfaces</code>\uff1a\u663e\u793a\u7f51\u7edc\u754c\u9762\u4fe1\u606f\u8868\u5355\u3002</li> <li>l\u6216<code>\u2013listening</code>\uff1a\u663e\u793a\u76d1\u63a7\u4e2d\u7684\u670d\u52a1\u5668\u7684Socket\u3002</li> <li>-n\u6216<code>\u2013numeric</code>\uff1a\u76f4\u63a5\u4f7f\u7528ip\u5730\u5740\uff0c\u800c\u4e0d\u901a\u8fc7\u57df\u540d\u670d\u52a1\u5668\u3002</li> <li>-t\u6216<code>\u2013tcp</code>\uff1a\u663e\u793aTCP\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5\u3002</li> <li>-u\u6216<code>\u2013udp</code>\uff1a\u663e\u793aUDP\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5\u3002</li> </ul>"},{"location":"chap6/13Linux_ts/#2-lsof","title":"2. \u67e5\u770b\u8c01\u5728\u4f7f\u7528\u67d0\u4e2a\u7aef\u53e3(lsof)","text":"<p>lsof \u547d\u4ee4\u7528\u4e8e\u67e5\u770b\u4f60\u8fdb\u7a0b\u5f00\u6253\u7684\u6587\u4ef6\uff0c\u6253\u5f00\u6587\u4ef6\u7684\u8fdb\u7a0b\uff0c\u8fdb\u7a0b\u6253\u5f00\u7684\u7aef\u53e3(TCP\u3001UDP)\u3002 \u5e38\u7528\u53c2\u6570\uff1a</p> <ul> <li><code>-g</code>\uff1a\u5217\u51faGID\u53f7\u8fdb\u7a0b\u8be6\u60c5\uff1b</li> <li><code>-d</code>&lt;\u6587\u4ef6\u53f7&gt;\uff1a\u5217\u51fa\u5360\u7528\u8be5\u6587\u4ef6\u53f7\u7684\u8fdb\u7a0b\uff1b</li> <li><code>-i</code>&lt;\u6761\u4ef6&gt;\uff1a\u5217\u51fa\u7b26\u5408\u6761\u4ef6\u7684\u8fdb\u7a0b\u3002\uff084\u30016\u3001\u534f\u8bae\u3001:\u7aef\u53e3\u3001 @ip \uff09</li> <li><code>-p</code>&lt;\u8fdb\u7a0b\u53f7&gt;\uff1a\u5217\u51fa\u6307\u5b9a\u8fdb\u7a0b\u53f7\u6240\u6253\u5f00\u7684\u6587\u4ef6\uff1b</li> <li><code>-u</code>\uff1a\u5217\u51faUID\u53f7\u8fdb\u7a0b\u8be6\u60c5\uff1b</li> </ul> <p>\u547d\u4ee4:<code>lsof -i :22</code> # \u770b\u770b\u8c01\u5728\u4f7f\u752822\u7aef\u53e3</p> <p></p>"},{"location":"chap6/13Linux_ts/#3-lsof","title":"3. \u67e5\u770b\u591a\u4e2a\u8fdb\u7a0b\u53f7\u5bf9\u5e94\u7684\u6587\u4ef6\u4fe1\u606f(lsof)","text":"<p>\u547d\u4ee4\uff1a<code>lsof -p 2,3</code> # \u4f7f\u7528\u9017\u53f7\u5206\u9694</p> <p>\u2018</p>"},{"location":"chap6/13Linux_ts/#4-tcplsof","title":"4 \u67e5\u770b\u6240\u6709tcp\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f(lsof)","text":"<pre><code>lsof -i tcp\n</code></pre> <p>\u67e5\u770b\u6240\u6709udp\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f(lsof)</p> <pre><code>lsof -i udp\n</code></pre>"},{"location":"chap6/13Linux_ts/#_3","title":"\u6587\u4ef6\u6392\u67e5\u547d\u4ee4","text":""},{"location":"chap6/13Linux_ts/#1-24find","title":"1 \u67e5\u627e\u6700\u8fd124\u5c0f\u65f6\u5185\u4fee\u6539\u8fc7\u7684\u6587\u4ef6(find)","text":"<ul> <li>\u547d\u4ee4\uff1a<code>find ./ -mtime 0</code></li> <li>find \u547d\u4ee4\u7528\u6765\u5728\u6307\u5b9a\u76ee\u5f55\u4e0b\u67e5\u627e\u6587\u4ef6\u3002</li> </ul> <p>\u53c2\u6570 <code>-mtime n</code> \u6309\u7167\u6587\u4ef6\u7684\u66f4\u6539\u65f6\u95f4\u6765\u627e\u6587\u4ef6\uff0cn\u4e3a\u6574\u6570\u3002</p> <ul> <li><code>-mtime 0</code> \u8868\u793a\u6587\u4ef6\u4fee\u6539\u65f6\u95f4\u8ddd\u79bb\u5f53\u524d\u4e3a0\u5929\u7684\u6587\u4ef6\uff0c\u5373\u8ddd\u79bb\u5f53\u524d\u65f6\u95f4\u4e0d\u52301\u5929\uff0824\u5c0f\u65f6\uff09\u4ee5\u5185\u7684\u6587\u4ef6\u3002</li> <li><code>-mtime 1</code> \u8868\u793a\u6587\u4ef6\u4fee\u6539\u65f6\u95f4\u8ddd\u79bb\u5f53\u524d\u4e3a1\u5929\u7684\u6587\u4ef6\uff0c\u5373\u8ddd\u79bb\u5f53\u524d\u65f6\u95f41\u5929\uff0824\u5c0f\u65f6\uff0d48\u5c0f\u65f6\uff09\u7684\u6587\u4ef6\u3002</li> <li><code>-mtime\uff0b1</code> \u8868\u793a\u6587\u4ef6\u4fee\u6539\u65f6\u95f4\u4e3a\u5927\u4e8e1\u5929\u7684\u6587\u4ef6\uff0c\u5373\u8ddd\u79bb\u5f53\u524d\u65f6\u95f42\u5929\uff0848\u5c0f\u65f6\uff09\u4e4b\u5916\u7684\u6587\u4ef6</li> <li><code>-mtime -1</code> \u8868\u793a\u6587\u4ef6\u4fee\u6539\u65f6\u95f4\u4e3a\u5c0f\u4e8e1\u5929\u7684\u6587\u4ef6\uff0c\u5373\u8ddd\u79bb\u5f53\u524d\u65f6\u95f41\u5929\uff0824\u5c0f\u65f6\uff09\u4e4b\u5185\u7684\u6587\u4ef6</li> </ul>"},{"location":"chap6/13Linux_ts/#txtfind","title":"\u67e5\u627e(\u4e0d\uff09\u4ee5.txt\u7ed3\u5c3e\u7684\u6587\u4ef6\u540d(find)","text":"<pre><code>find / -name \"*.txt\"\n</code></pre> <p>\u5ffd\u7565\u5927\u5c0f\u5199\uff0c\u547d\u4ee4\uff1a<code>find / -iname \"*.txt\"</code></p> <p><code>find / ! -name \"*.txt\"</code></p>"},{"location":"chap6/14Linux_iptables/","title":"L14 Linux iptables\u547d\u4ee4\u8be6\u89e3","text":"<p>iptables \u662f Linux \u9632\u706b\u5899\u7cfb\u7edf\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\uff0ciptables \u7684\u4e3b\u8981\u529f\u80fd\u662f\u5b9e\u73b0\u5bf9\u7f51\u7edc\u6570\u636e\u5305\u8fdb\u51fa\u8bbe\u5907\u53ca\u8f6c\u53d1\u7684\u63a7\u5236\u3002</p> <p>\u5f53\u6570\u636e\u5305\u9700\u8981\u8fdb\u5165\u8bbe\u5907\u3001\u4ece\u8bbe\u5907\u4e2d\u6d41\u51fa\u6216\u8005\u7531\u8be5\u8bbe\u5907\u8f6c\u53d1\u3001\u8def\u7531\u65f6\uff0c\u90fd\u53ef\u4ee5\u4f7f\u7528 iptables \u8fdb\u884c\u63a7\u5236\u3002</p>"},{"location":"chap6/14Linux_iptables/#iptables","title":"iptables\u7b80\u4ecb","text":"<p>iptables \u662f\u96c6\u6210\u5728 Linux \u5185\u6838\u4e2d\u7684\u5305\u8fc7\u6ee4\u9632\u706b\u5899\u7cfb\u7edf\u3002\u4f7f\u7528 iptables \u53ef\u4ee5\u6dfb\u52a0\u3001\u5220\u9664\u5177\u4f53\u7684\u8fc7\u6ee4\u89c4\u5219\uff0ciptables \u9ed8\u8ba4\u7ef4\u62a4\u7740 4 \u4e2a\u8868\u548c 5 \u4e2a\u94fe\uff0c\u6240\u6709\u7684\u9632\u706b\u5899\u7b56\u7565\u89c4\u5219\u90fd\u88ab\u5206\u522b\u5199\u5165\u8fd9\u4e9b\u8868\u4e0e\u94fe\u4e2d\u3002</p> <p>\u201c\u56db\u8868\u201d\u662f\u6307 iptables \u7684\u529f\u80fd\uff0c\u9ed8\u8ba4\u7684 iptables \u89c4\u5219\u8868\u6709 filter \u8868\uff08\u8fc7\u6ee4\u89c4\u5219\u8868\uff09\u3001nat \u8868\uff08\u5730\u5740\u8f6c\u6362\u89c4\u5219\u8868\uff09\u3001mangle\uff08\u4fee\u6539\u6570\u636e\u6807\u8bb0\u4f4d\u89c4\u5219\u8868\uff09\u3001raw\uff08\u8ddf\u8e2a\u6570\u636e\u8868\u89c4\u5219\u8868\uff09\uff1a</p> <ul> <li>filter \u8868\uff1a\u63a7\u5236\u6570\u636e\u5305\u662f\u5426\u5141\u8bb8\u8fdb\u51fa\u53ca\u8f6c\u53d1\uff0c\u53ef\u4ee5\u63a7\u5236\u7684\u94fe\u8def\u6709 INPUT\u3001FORWARD \u548c OUTPUT\u3002</li> <li>nat \u8868\uff1a\u63a7\u5236\u6570\u636e\u5305\u4e2d\u5730\u5740\u8f6c\u6362\uff0c\u53ef\u4ee5\u63a7\u5236\u7684\u94fe\u8def\u6709 PREROUTING\u3001INPUT\u3001OUTPUT \u548c POSTROUTING\u3002</li> <li>mangle\uff1a\u4fee\u6539\u6570\u636e\u5305\u4e2d\u7684\u539f\u6570\u636e\uff0c\u53ef\u4ee5\u63a7\u5236\u7684\u94fe\u8def\u6709 PREROUTING\u3001INPUT\u3001OUTPUT\u3001FORWARD \u548c POSTROUTING\u3002</li> <li>raw\uff1a\u63a7\u5236 nat \u8868\u4e2d\u8fde\u63a5\u8ffd\u8e2a\u673a\u5236\u7684\u542f\u7528\u72b6\u51b5\uff0c\u53ef\u4ee5\u63a7\u5236\u7684\u94fe\u8def\u6709 PREROUTING\u3001OUTPUT\u3002</li> </ul> <p>\u201c\u4e94\u94fe\u201d\u662f\u6307\u5185\u6838\u4e2d\u63a7\u5236\u7f51\u7edc\u7684 NetFilter \u5b9a\u4e49\u7684 5 \u4e2a\u89c4\u5219\u94fe\u3002\u6bcf\u4e2a\u89c4\u5219\u8868\u4e2d\u5305\u542b\u591a\u4e2a\u6570\u636e\u94fe\uff1aINPUT\uff08\u5165\u7ad9\u6570\u636e\u8fc7\u6ee4\uff09\u3001OUTPUT\uff08\u51fa\u7ad9\u6570\u636e\u8fc7\u6ee4\uff09\u3001FORWARD\uff08\u8f6c\u53d1\u6570\u636e\u8fc7\u6ee4\uff09\u3001PREROUTING\uff08\u8def\u7531\u524d\u8fc7\u6ee4\uff09\u548cPOSTROUTING\uff08\u8def\u7531\u540e\u8fc7\u6ee4\uff09\uff0c\u9632\u706b\u5899\u89c4\u5219\u9700\u8981\u5199\u5165\u5230\u8fd9\u4e9b\u5177\u4f53\u7684\u6570\u636e\u94fe\u4e2d\u3002</p> <p>Linux \u9632\u706b\u5899\u7684\u8fc7\u6ee4\u6846\u67b6\uff0c\u5982\u56fe 1 \u6240\u793a\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u51fa\uff0c</p> <ul> <li>\u5982\u679c\u662f\u5916\u90e8\u4e3b\u673a\u53d1\u9001\u6570\u636e\u5305\u7ed9\u9632\u706b\u5899\u672c\u673a\uff0c\u6570\u636e\u5c06\u4f1a\u7ecf\u8fc7 PREROUTING \u94fe\u4e0e INPUT \u94fe\uff1b</li> <li>\u5982\u679c\u662f\u9632\u706b\u5899\u672c\u673a\u53d1\u9001\u6570\u636e\u5305\u5230\u5916\u90e8\u4e3b\u673a\uff0c\u6570\u636e\u5c06\u4f1a\u7ecf\u8fc7 OUTPUT \u94fe\u4e0e POSTROUTING \u94fe\uff1b</li> <li>\u5982\u679c\u9632\u706b\u5899\u4f5c\u4e3a\u8def\u7531\u8d1f\u8d23\u8f6c\u53d1\u6570\u636e\uff0c\u5219\u6570\u636e\u5c06\u7ecf\u8fc7 PREROUTING \u94fe\u3001FORWARD \u94fe\u4ee5\u53ca POSTROUTING \u94fe\u3002</li> </ul>"},{"location":"chap6/14Linux_iptables/#iptables_1","title":"iptables\u8bed\u6cd5\u683c\u5f0f","text":"<pre><code>[root@bogon ~]# iptables [-t table] COMMAND [chain] CRETIRIA -j ACTION\n</code></pre> <p>\u5404\u53c2\u6570\u7684\u542b\u4e49\u4e3a\uff1a</p> <ul> <li><code>-t</code>\uff1a\u6307\u5b9a\u9700\u8981\u7ef4\u62a4\u7684\u9632\u706b\u5899\u89c4\u5219\u8868 filter\u3001nat\u3001mangle\u6216raw\u3002\u5728\u4e0d\u4f7f\u7528 <code>-t</code> \u65f6\u5219\u9ed8\u8ba4\u4f7f\u7528 filter \u8868\u3002</li> <li><code>COMMAND</code>\uff1a\u5b50\u547d\u4ee4\uff0c\u5b9a\u4e49\u5bf9\u89c4\u5219\u7684\u7ba1\u7406\u3002</li> <li><code>chain</code>\uff1a\u6307\u660e\u94fe\u8868\u3002</li> <li><code>CRETIRIA</code>\uff1a\u5339\u914d\u53c2\u6570\u3002</li> <li><code>ACTION</code>\uff1a\u89e6\u53d1\u52a8\u4f5c\u3002</li> </ul> <p>iptables \u547d\u4ee4\u5e38\u7528\u7684\u9009\u9879\u53ca\u5404\u81ea\u7684\u529f\u80fd\u5982\u8868 2 \u6240\u793a\u3002</p> <p></p> <p>iptables \u547d\u4ee4\u5e38\u7528\u5339\u914d\u53c2\u6570\u53ca\u5404\u81ea\u7684\u529f\u80fd\u5982\u8868 3 \u6240\u793a\u3002</p> <p>\u5185\u6838\u4f1a\u6309\u7167\u987a\u5e8f\u4f9d\u6b21\u68c0\u67e5 iptables \u9632\u706b\u5899\u89c4\u5219\uff0c\u5982\u679c\u53d1\u73b0\u6709\u5339\u914d\u7684\u89c4\u5219\u76ee\u5f55\uff0c\u5219\u7acb\u523b\u6267\u884c\u76f8\u5173\u52a8\u4f5c\uff0c\u505c\u6b62\u7ee7\u7eed\u5411\u4e0b\u67e5\u627e\u89c4\u5219\u76ee\u5f55\uff1b</p> <p>\u5982\u679c\u6240\u6709\u7684\u9632\u706b\u5899\u89c4\u5219\u90fd\u672a\u80fd\u5339\u914d\u6210\u529f\uff0c\u5219\u6309\u7167\u9ed8\u8ba4\u7b56\u7565\u5904\u7406\u3002</p> <p>\u4f7f\u7528 <code>-A</code> \u9009\u9879\u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\u4f1a\u5c06\u8be5\u89c4\u5219\u8ffd\u52a0\u5230\u6574\u4e2a\u94fe\u7684\u6700\u540e\uff0c\u800c\u4f7f\u7528 <code>-I</code> \u9009\u9879\u6dfb\u52a0\u7684\u9632\u706b\u5899\u89c4\u5219\u5219\u4f1a\u9ed8\u8ba4\u63d2\u5165\u5230\u94fe\u4e2d\u4f5c\u4e3a\u7b2c\u4e00\u6761\u89c4\u5219\u3002</p> <p>\u6ce8\u610f\uff0c\u5728 Linux CentOS \u7cfb\u7edf\u4e2d\uff0ciptables \u662f\u9ed8\u8ba4\u5b89\u88c5\u7684\uff0c\u5982\u679c\u7cfb\u7edf\u4e2d\u6ca1\u6709 iptables \u5de5\u5177\uff0c\u53ef\u4ee5\u5148\u8fdb\u884c\u5b89\u88c5\u3002</p>"},{"location":"chap6/14Linux_iptables/#_1","title":"\u89c4\u5219\u7684\u67e5\u770b\u4e0e\u6e05\u9664","text":"<p>\u4f7f\u7528 iptables \u547d\u4ee4\u53ef\u4ee5\u5bf9\u5177\u4f53\u7684\u89c4\u5219\u8fdb\u884c\u67e5\u770b\u3001\u6dfb\u52a0\u3001\u4fee\u6539\u548c\u5220\u9664</p>"},{"location":"chap6/14Linux_iptables/#1","title":"1) \u67e5\u770b\u89c4\u5219","text":"<p>\u5bf9\u89c4\u5219\u7684\u67e5\u770b\u9700\u8981\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>[root@bogon ~]# iptables -nvL\n</code></pre> <p>\u5404\u53c2\u6570\u7684\u542b\u4e49\u4e3a\uff1a</p> <ul> <li><code>-L</code> \u8868\u793a\u67e5\u770b\u5f53\u524d\u8868\u7684\u6240\u6709\u89c4\u5219\uff0c\u9ed8\u8ba4\u67e5\u770b\u7684\u662f filter \u8868\uff0c\u5982\u679c\u8981\u67e5\u770b nat \u8868\uff0c\u53ef\u4ee5\u52a0\u4e0a <code>-t nat</code>\u53c2\u6570\u3002</li> <li><code>-n</code> \u8868\u793a\u4e0d\u5bf9 IP \u5730\u5740\u8fdb\u884c\u53cd\u67e5\uff0c\u52a0\u4e0a\u8fd9\u4e2a\u53c2\u6570\u663e\u793a\u901f\u5ea6\u5c06\u4f1a\u52a0\u5feb\u3002</li> <li><code>-v</code> \u8868\u793a\u8f93\u51fa\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u542b\u901a\u8fc7\u8be5\u89c4\u5219\u7684\u6570\u636e\u5305\u6570\u91cf\u3001\u603b\u5b57\u8282\u6570\u4ee5\u53ca\u76f8\u5e94\u7684\u7f51\u7edc\u63a5\u53e3\u3002</li> </ul> <p>\u3010\u4f8b 1\u3011\u67e5\u770b\u89c4\u5219\u3002</p> <p>\u9996\u5148\u9700\u8981\u4f7f\u7528 su \u547d\u4ee4\uff0c\u5207\u6362\u5f53\u524d\u7528\u6237\u5230 root \u7528\u6237\u3002\u7136\u540e\u5728\u7ec8\u7aef\u9875\u9762\u8f93\u5165\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>[root@bogon ~]# iptables -L\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination        \nACCEPT     all  --  anywhere             anywhere            state RELATED,ESTABLISHED\nACCEPT     icmp --  anywhere             anywhere           \nACCEPT     all  --  anywhere             anywhere           \nACCEPT     tcp  --  anywhere             anywhere            state NEW tcp dpt:ssh\nREJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited\n......\n</code></pre>"},{"location":"chap6/14Linux_iptables/#2","title":"2) \u6dfb\u52a0\u89c4\u5219","text":"<p>\u3010\u4f8b 2\u3011\u67e5\u770b\u5f53\u524d\u89c4\u5219\u3002</p> <p>\u9996\u5148\u9700\u8981\u4f7f\u7528 su \u547d\u4ee4\uff0c\u5207\u6362\u5f53\u524d\u7528\u6237\u5230 root \u7528\u6237\uff0c\u7136\u540e\u5728\u7ec8\u7aef\u9875\u9762\u8f93\u5165\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>[root@bogon ~]# iptables -nL --line-number\nChain INPUT (policy ACCEPT)\nnum  target     prot opt source               destination        \n1    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED\n2    ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0          \n3    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0          \n4    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           state NEW tcp dpt:22\n5    REJECT     all  --  0.0.0.0/0            0.0.0.0/0           reject-with icmp-host-prohibited\n......\n</code></pre> <p>\u3010\u4f8b 3\u3011\u6dfb\u52a0\u4e00\u6761\u89c4\u5219\u5230\u5c3e\u90e8\u3002</p> <p>\u9996\u5148\u9700\u8981\u4f7f\u7528 su \u547d\u4ee4\uff0c\u5207\u6362\u5f53\u524d\u7528\u6237\u5230 root \u7528\u6237\uff0c\u7136\u540e\u5728\u7ec8\u7aef\u9875\u9762\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>[root@bogon ~]# iptables -A INPUT -s 192.168.1.5 -j DROP\n\n\n[root@bogon ~]# iptables -nL --line-number\nChain INPUT (policy ACCEPT)\nnum  target     prot opt source               destination        \n1    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED\n2    ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0          \n3    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0          \n4    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           state NEW tcp dpt:22\n5    REJECT     all  --  0.0.0.0/0            0.0.0.0/0           reject-with icmp-host-prohibited\n6    DROP       all  --  192.168.1.5          0.0.0.0/0    \n</code></pre> <p>3) \u4fee\u6539\u89c4\u5219</p> <p>\u5728\u4fee\u6539\u89c4\u5219\u65f6\u9700\u8981\u4f7f\u7528<code>-R</code> \u53c2\u6570\u3002</p> <p>\u3010\u4f8b 4\u3011\u628a\u6dfb\u52a0\u5728\u7b2c 6 \u884c\u89c4\u5219\u7684 DROP \u4fee\u6539\u4e3a ACCEPT\u3002</p> <p>\u9996\u5148\u9700\u8981\u4f7f\u7528 su \u547d\u4ee4\uff0c\u5207\u6362\u5f53\u524d\u7528\u6237\u5230 root \u7528\u6237\uff0c\u7136\u540e\u5728\u7ec8\u7aef\u9875\u9762\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>[root@bogon ~]# iptables -R INPUT 6 -s 194.168.1.5 -j ACCEPT\n[root@bogon ~]# iptables -nL --line-number\nChain INPUT (policy ACCEPT)\nnum  target     prot opt source               destination        \n1    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED\n2    ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0          \n3    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0          \n4    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           state NEW tcp dpt:22\n5    REJECT     all  --  0.0.0.0/0            0.0.0.0/0           reject-with icmp-host-prohibited\n6    ACCEPT     all  --  194.168.1.5          0.0.0.0/0   \n</code></pre> <p>\u5bf9\u6bd4\u53d1\u73b0\uff0c\u7b2c 6 \u884c\u89c4\u5219\u7684 target \u5df2\u4fee\u6539\u4e3a ACCEPT\u3002</p>"},{"location":"chap6/14Linux_iptables/#4","title":"4) \u5220\u9664\u89c4\u5219","text":"<p>\u5220\u9664\u89c4\u5219\u6709\u4e24\u79cd\u65b9\u6cd5\uff0c\u4f46\u90fd\u5fc5\u987b\u4f7f\u7528 -D \u53c2\u6570\u3002</p> <p>\u3010\u4f8b 5\u3011\u5220\u9664\u6dfb\u52a0\u7684\u7b2c 6 \u884c\u7684\u89c4\u5219\u3002</p> <p>\u9996\u5148\u9700\u8981\u4f7f\u7528su\u547d\u4ee4\uff0c\u5207\u6362\u5f53\u524d\u7528\u6237\u5230 root \u7528\u6237\uff0c\u7136\u540e\u5728\u7ec8\u7aef\u9875\u9762\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>[root@bogon ~]# iptables -D INPUT 6 -s 194.168.1.5 -j ACCEPT\n</code></pre> <p>\u6216</p> <pre><code># iptables -D INPUT 6\n</code></pre> <p>\u6ce8\u610f\uff0c\u6709\u65f6\u9700\u8981\u5220\u9664\u7684\u89c4\u5219\u8f83\u957f\uff0c\u5220\u9664\u65f6\u9700\u8981\u5199\u4e00\u5927\u4e32\u7684\u4ee3\u7801\uff0c\u8fd9\u6837\u6bd4\u8f83\u5bb9\u6613\u5199\u9519\uff0c\u8fd9\u65f6\u53ef\u4ee5\u5148\u4f7f\u7528 -line-number \u627e\u51fa\u8be5\u6761\u89c4\u5219\u7684\u884c\u53f7\uff0c\u518d\u901a\u8fc7\u884c\u53f7\u5220\u9664\u89c4\u5219\u3002</p>"},{"location":"chap6/14Linux_iptables/#_2","title":"\u9632\u706b\u5899\u7684\u5907\u4efd\u4e0e\u8fd8\u539f","text":"<p>\u9ed8\u8ba4\u7684 iptables \u9632\u706b\u5899\u89c4\u5219\u4f1a\u7acb\u523b\u751f\u6548\uff0c\u4f46\u5982\u679c\u4e0d\u4fdd\u5b58\uff0c\u5f53\u8ba1\u7b97\u673a\u91cd\u542f\u540e\u6240\u6709\u7684\u89c4\u5219\u90fd\u4f1a\u4e22\u5931\uff0c\u6240\u4ee5\u5bf9\u9632\u706b\u5899\u89c4\u5219\u8fdb\u884c\u53ca\u65f6\u4fdd\u5b58\u7684\u64cd\u4f5c\u662f\u975e\u5e38\u5fc5\u8981\u7684\u3002</p> <p>iptables \u8f6f\u4ef6\u5305\u63d0\u4f9b\u4e86\u4e24\u4e2a\u975e\u5e38\u6709\u7528\u7684\u5de5\u5177\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e24\u4e2a\u5de5\u5177\u5904\u7406\u5927\u91cf\u7684\u9632\u706b\u5899\u89c4\u5219\u3002\u8fd9\u4e24\u4e2a\u5de5\u5177\u5206\u522b\u662f <code>iptables-save</code> \u548c <code>iptables-restore</code>\uff0c\u4f7f\u7528\u8be5\u5de5\u5177\u53ef\u4ee5\u5b9e\u73b0\u9632\u706b\u5899\u89c4\u5219\u7684\u4fdd\u5b58\u4e0e\u8fd8\u539f\u3002\u8fd9\u4e24\u4e2a\u5de5\u5177\u7684\u6700\u5927\u4f18\u52bf\u662f\u5904\u7406\u5e9e\u5927\u7684\u89c4\u5219\u96c6\u65f6\u901f\u5ea6\u975e\u5e38\u5feb\u3002</p> <p>CentOS 7 \u7cfb\u7edf\u4e2d\u9632\u706b\u5899\u89c4\u5219\u9ed8\u8ba4\u4fdd\u5b58\u5728 <code>/etc/sysconfig/iptables</code> \u6587\u4ef6\u4e2d\uff0c\u4f7f\u7528 <code>iptables-save</code> \u5c06\u89c4\u5219\u4fdd\u5b58\u81f3\u8be5\u6587\u4ef6\u4e2d\u53ef\u4ee5\u5b9e\u73b0\u4fdd\u5b58\u9632\u706b\u5899\u89c4\u5219\u7684\u4f5c\u7528\uff0c\u8ba1\u7b97\u673a\u91cd\u542f\u540e\u4f1a\u81ea\u52a8\u52a0\u8f7d\u8be5\u6587\u4ef6\u4e2d\u7684\u89c4\u5219\u3002</p> <p>\u5982\u679c\u4f7f\u7528 <code>iptables-save</code> \u5c06\u89c4\u5219\u4fdd\u5b58\u81f3\u5176\u4ed6\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5907\u4efd\u9632\u706b\u5899\u89c4\u5219\u7684\u4f5c\u7528\u3002\u5f53\u9632\u706b\u5899\u89c4\u5219\u9700\u8981\u505a\u8fd8\u539f\u64cd\u4f5c\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>iptables-restore</code> \u5c06\u5907\u4efd\u6587\u4ef6\u76f4\u63a5\u5bfc\u5165\u5f53\u524d\u9632\u706b\u5899\u89c4\u5219\u3002</p>"},{"location":"chap6/14Linux_iptables/#1iptables-save","title":"1\u3001iptables-save\u547d\u4ee4","text":"<p><code>iptables-save</code> \u547d\u4ee4\u7528\u6765\u6279\u91cf\u5bfc\u51fa Linux \u9632\u706b\u5899\u89c4\u5219\uff0c\u8bed\u6cd5\u4ecb\u7ecd\u5982\u4e0b\uff1a</p> <p>\u4fdd\u5b58\u5728\u9ed8\u8ba4\u6587\u4ef6\u5939\u4e2d\uff08\u4fdd\u5b58\u9632\u706b\u5899\u89c4\u5219\uff09\uff1a</p> <pre><code>[root@bogon ~]# iptables-save &gt; /etc/sysconfig/iptables\n</code></pre> <p>\u4fdd\u5b58\u5728\u5176\u4ed6\u4f4d\u7f6e\uff08\u5907\u4efd\u9632\u706b\u5899\u89c4\u5219\uff09\uff1a</p> <pre><code>[root@bogon ~]# iptables-save &gt; \u6587\u4ef6\u540d\u79f0\n</code></pre> <p>1) \u76f4\u63a5\u6267\u884c iptables-save \u547d\u4ee4\uff1a\u663e\u793a\u51fa\u5f53\u524d\u542f\u7528\u7684\u6240\u6709\u89c4\u5219\uff0c\u6309\u7167 raw\u3001mangle\u3001nat\u3001filter \u8868\u7684\u987a\u5e8f\u4f9d\u6b21\u5217\u51fa\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>[root@bogon ~]# iptables-save\n# Generated by iptables-save v1.4.7 on Thu Aug 27 07:06:36 2020\n*filter\n:INPUT ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [602:39026]\n.......\nCOMMIT\n# Completed on Thu Aug 27 07:06:36 2020\n</code></pre> <p>\u5176\u4e2d\uff1a</p> <ul> <li><code>\u201c#\u201d</code>\u53f7\u5f00\u5934\u7684\u8868\u793a\u6ce8\u91ca\uff1b</li> <li><code>\u201c*filter\u201d</code>\u8868\u793a\u6240\u5728\u7684\u8868\uff1b</li> <li>\u201c<code>\uff1a</code>\u94fe\u540d\u9ed8\u8ba4\u7b56\u7565\u201d\u8868\u793a\u76f8\u5e94\u7684\u94fe\u53ca\u9ed8\u8ba4\u7b56\u7565\uff0c\u5177\u4f53\u7684\u89c4\u5219\u90e8\u5206\u7701\u7565\u4e86\u547d\u4ee4\u540d\u201ciptables\u201d\uff1b</li> <li>\u5728\u672b\u5c3e\u5904\u201cCOMMIT\u201d\u8868\u793a\u63d0\u4ea4\u524d\u9762\u7684\u89c4\u5219\u8bbe\u7f6e\u3002</li> </ul> <p>2) \u5907\u4efd\u5230\u5176\u4ed6\u6587\u4ef6\u4e2d\u3002\u4f8b\u5982\u6587\u4ef6\uff1atext\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>[root@bogon ~]# iptables-save &gt; test\n[root@bogon ~]# ls\ntest\n[root@bogon ~]# cat test\n# Generated by iptables-save v1.4.7 on Thu Aug 27 07:09:47 2020\n*filter\n......\n</code></pre> <p>3) \u5217\u51fanat\u8868\u7684\u89c4\u5219\u5185\u5bb9\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>[root@bogon ~]# iptables-save -t nat\n</code></pre> <p>\u201c-t\u8868\u540d\u201d\uff1a\u8868\u793a\u5217\u51fa\u67d0\u4e00\u4e2a\u8868\u3002</p>"},{"location":"chap6/14Linux_iptables/#2iptables-restore","title":"2\u3001iptables-restore\u547d\u4ee4","text":"<p>iptables-restore \u547d\u4ee4\u53ef\u4ee5\u6279\u91cf\u5bfc\u5165Linux\u9632\u706b\u5899\u89c4\u5219\uff0c\u540c\u65f6\u4e5f\u9700\u8981\u7ed3\u5408\u91cd\u5b9a\u5411\u8f93\u5165\u6765\u6307\u5b9a\u5907\u4efd\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>[root@bogon ~]# iptables-restore &lt; \u6587\u4ef6\u540d\u79f0\n</code></pre> <p>\u6ce8\u610f\uff0c\u5bfc\u5165\u7684\u6587\u4ef6\u5fc5\u987b\u662f\u4f7f\u7528 iptables-save\u5de5\u5177\u5bfc\u51fa\u6765\u7684\u624d\u53ef\u4ee5\u3002</p> <p>\u5148\u4f7f\u7528<code>iptables-restore</code> \u547d\u4ee4\u8fd8\u539f text \u6587\u4ef6\uff0c\u7136\u540e\u4f7f\u7528 iptables -t nat -nvL \u547d\u4ee4\u67e5\u770b\u6e05\u7a7a\u7684\u89c4\u5219\u662f\u5426\u5df2\u7ecf\u8fd8\u539f\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>[root@bogon ~]# iptables-restore &lt; test\n[root@bogon ~]# iptables -t nat -nvL\nChain PREROUTING (policy ACCEPT 0 packets, 0 bytes)\npkts bytes target     prot opt in     out     source               destination        \n\nChain POSTROUTING (policy ACCEPT 0 packets, 0 bytes)\npkts bytes target     prot opt in     out     source               destination        \n\nChain OUTPUT (policy ACCEPT 0 packets, 0 bytes)\npkts bytes target     prot opt in     out     source               destination        \n</code></pre>"},{"location":"chap6/15linux_network/","title":"L15 Linux\u7f51\u7edc\u57fa\u7840\u4e0e\u6027\u80fd\u4f18\u5316","text":""},{"location":"chap6/15linux_network/#1","title":"1 \u7f51\u7edc\u6a21\u578b","text":"<p>\u5e38\u89c1\u7684\u6709 OSI \u7f51\u7edc\u6a21\u578b\u3001TCP/IP \u7f51\u7edc\u6a21\u578b\u3001\u4e94\u5c42\u534f\u8bae\u7f51\u7edc\u6a21\u578b\uff1a</p> <p>OSI \u4e03\u5c42\u7f51\u7edc\u6a21\u578b\uff1a\u5c06\u4f20\u7edf\u7684\u4e94\u5c42 TCP \u6a21\u578b\u4e2d\u7684\u5e94\u7528\u5c42\u5206\u4e3a\u5e94\u7528\u5c42\u3001\u8868\u793a\u5c42\u3001\u4f1a\u8bdd\u5c42</p> <ul> <li>\u5e94\u7528\u5c42\uff1a\u8d1f\u8d23\u4e3a\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u7edf\u4e00\u7684\u63a5\u53e3</li> <li>\u8868\u793a\u5c42\uff1a\u8d1f\u8d23\u628a\u6570\u636e\u8f6c\u6362\u6210\u517c\u5bb9\u63a5\u6536\u7cfb\u7edf\u7684\u683c\u5f0f</li> <li>\u4f1a\u8bdd\u5c42\uff1a\u8d1f\u8d23\u7ef4\u62a4\u8ba1\u7b97\u673a\u4e4b\u95f4\u7684\u901a\u4fe1\u8fde\u63a5\uff0c\u5373\u8d1f\u8d23\u5728\u7f51\u7edc\u4e2d\u7684\u4e24\u8282\u70b9\u4e4b\u95f4\u5efa\u7acb\u3001\u7ef4\u6301\u548c\u7ec8\u6b62\u901a\u4fe1</li> <li>\u4f20\u8f93\u5c42\uff1a\u8d1f\u8d23\u4e3a\u6570\u636e\u52a0\u4e0a\u4f20\u8f93\u8868\u5934\uff0c\u5f62\u6210\u6570\u636e\u5305</li> <li>\u7f51\u7edc\u5c42\uff1a\u8d1f\u8d23\u6570\u636e\u7684\u8def\u7531\u548c\u8f6c\u53d1</li> <li>\u6570\u636e\u94fe\u8def\u5c42\uff1a\u8d1f\u8d23 MAC \u5bfb\u5740\u3001\u9519\u8bef\u4fa6\u6d4b\u548c\u6539\u9519</li> <li>\u7269\u7406\u5c42\uff1a\u8d1f\u8d23\u5728\u7269\u7406\u7f51\u7edc\u4e2d\u4f20\u8f93\u6570\u636e\u5e27</li> </ul> <p>Linux \u4e0a\u4f7f\u7528\u7684\u662f TCP/IP \u7f51\u7edc\u6a21\u578b\uff0c\u5373\u56db\u5c42\u7f51\u7edc\u6a21\u578b\uff1a</p> <ul> <li>\u5e94\u7528\u5c42\uff0c\u8d1f\u8d23\u5411\u7528\u6237\u63d0\u4f9b\u4e00\u7ec4\u5e94\u7528\u7a0b\u5e8f\uff0c\u6bd4\u5982 HTTP\u3001FTP\u3001DNS \u7b49</li> <li>\u4f20\u8f93\u5c42\uff0c\u8d1f\u8d23\u7aef\u5230\u7aef\u7684\u901a\u4fe1\uff0c\u6bd4\u5982 TCP\u3001UDP \u7b49</li> <li>\u7f51\u7edc\u5c42\uff0c\u8d1f\u8d23\u7f51\u7edc\u5305\u7684\u5c01\u88c5\u3001\u5bfb\u5740\u548c\u8def\u7531\uff0c\u6bd4\u5982 IP\u3001ICMP \u7b49</li> <li>\u7f51\u7edc\u63a5\u53e3\u5c42\uff0c\u8d1f\u8d23\u7f51\u7edc\u5305\u5728\u7269\u7406\u7f51\u7edc\u4e2d\u7684\u4f20\u8f93\uff0c\u6bd4\u5982 MAC \u5bfb\u5740\u3001\u9519\u8bef\u4fa6\u6d4b\u4ee5\u53ca\u901a\u8fc7\u7f51\u5361\u4f20\u8f93\u7f51\u7edc\u5e27\u7b49</li> </ul> <p>\u5728 TCP/IP \u6a21\u578b\u4e0b\uff0c\u7f51\u7edc\u6570\u636e\u5c06\u9010\u5c42\u4f20\u9012\u5e76\u5904\u7406:</p> <p></p>"},{"location":"chap6/15linux_network/#2","title":"2 \u7f51\u7edc\u6027\u80fd","text":"<p>\u5e38\u7528\u7684\u7f51\u7edc[\u6027\u80fd\u6307\u6807]\uff1a</p> <ul> <li>\u5e26\u5bbd\uff1a\u8868\u793a\u94fe\u8def\u7684\u6700\u5927\u4f20\u8f93\u901f\u7387\uff0c\u5355\u4f4d\u901a\u5e38\u4e3a b/s \uff08\u6bd4\u7279 / \u79d2\uff09</li> <li>\u541e\u5410\u91cf\uff1a\u8868\u793a\u5355\u4f4d\u65f6\u95f4\u5185\u6210\u529f\u4f20\u8f93\u7684\u6570\u636e\u91cf\uff0c\u5355\u4f4d\u901a\u5e38\u4e3a b/s\uff08\u6bd4\u7279 / \u79d2\uff09\u6216\u8005 B/s\uff08\u5b57\u8282 / \u79d2\uff09</li> <li>\u5ef6\u65f6\uff1a\u8868\u793a\u4ece\u7f51\u7edc\u8bf7\u6c42\u53d1\u51fa\u540e\uff0c\u4e00\u76f4\u5230\u6536\u5230\u8fdc\u7aef\u54cd\u5e94\uff0c\u6240\u9700\u8981\u7684\u65f6\u95f4\u5ef6\u8fdf\u3002\u5728\u4e0d\u540c\u573a\u666f\u4e2d\uff0c\u8fd9\u4e00\u6307\u6807\u53ef\u80fd\u4f1a\u6709\u4e0d\u540c\u542b\u4e49\u3002\u6bd4\u5982\uff0c\u5b83\u53ef\u4ee5\u8868\u793a\uff0c\u5efa\u7acb\u8fde\u63a5\u9700\u8981\u7684\u65f6\u95f4\uff08\u6bd4\u5982 TCP \u63e1\u624b\u5ef6\u65f6\uff09\uff0c\u6216\u4e00\u4e2a\u6570\u636e\u5305\u5f80\u8fd4\u6240\u9700\u7684\u65f6\u95f4\uff08\u6bd4\u5982 RTT\uff09</li> <li>PPS\uff1aPacket Per Second\uff08\u5305 / \u79d2\uff09\uff0c\u8868\u793a\u4ee5\u7f51\u7edc\u5305\u4e3a\u5355\u4f4d\u7684\u4f20\u8f93\u901f\u7387\u3002PPS \u901a\u5e38\u7528\u6765\u8bc4\u4f30\u7f51\u7edc\u7684\u8f6c\u53d1\u80fd\u529b\u57fa\u4e8e Linux \u670d\u52a1\u5668\u7684\u8f6c\u53d1\uff0c\u5219\u5bb9\u6613\u53d7\u7f51\u7edc\u5305\u5927\u5c0f\u7684\u5f71\u54cd\u3002</li> <li>\u7f51\u7edc\u7684\u53ef\u7528\u6027\uff1a\u7f51\u7edc\u6b63\u5e38\u901a\u4fe1</li> <li>\u5e76\u53d1\u8fde\u63a5\u6570\uff1aTCP \u53ef\u4ee5\u8fde\u63a5\u591a\u5c11</li> <li>\u4e22\u5305\u7387\uff1a\u4e22\u5305\u5360\u603b\u5305\u7684\u6bd4\u91cd</li> <li>\u91cd\u4f20\u7387\uff1a\u91cd\u65b0\u4f20\u8f93\u7684\u7f51\u7edc\u5305\u6bd4\u4f8b</li> </ul>"},{"location":"chap6/15linux_network/#3","title":"3 \u5e38\u7528\u7684\u7f51\u7edc\u6027\u80fd\u76d1\u63a7\u5de5\u5177\uff1a","text":"<ul> <li>netstat\uff1a\u7528\u4e8e\u663e\u793a\u4e0e IP\u3001TCP\u3001UDP \u548c ICMP \u534f\u8bae\u76f8\u5173\u7684\u7edf\u8ba1\u6570\u636e\uff0c\u6838\u5fc3\u662f\u663e\u793a\u5957\u63a5\u5b57\u72b6\u6001</li> <li>ifconfig\uff1a\u7528\u4e8e\u663e\u793a\u6216\u914d\u7f6e\u7f51\u7edc\u8bbe\u5907\uff08\u7f51\u7edc\u63a5\u53e3\u5361\uff09\u4fe1\u606f</li> <li>route\uff1a\u7528\u4e8e\u663e\u793a\u548c\u64cd\u4f5c IP \u8def\u7531\u8868\uff0c\u901a\u8fc7\u76ee\u6807\u5730\u5740 ip \u548c\u5b50\u7f51\u63a9\u7801\u53ef\u4ee5\u5206\u6790\u51fa\u53d1\u5305\u8def\u5f84</li> <li><code>sar -n DEV</code>\uff1a\u663e\u793a\u7f51\u7edc\u4fe1\u606f\uff0c\u7528 sar \u5206\u6790\u7f51\u7edc\u66f4\u591a\u7684\u662f\u7528\u4e8e\u6d41\u91cf\u548c\u5305\u91cf\u7684\u68c0\u6d4b\u548c\u5f02\u5e38\u53d1\u73b0</li> <li>nmap\uff1a\u7528\u4e8e\u7f51\u7edc\u63a2\u6d4b\u548c\u5b89\u5168\u5ba1\u6838\u7684\u5de5\u5177</li> <li>ss\uff1a\u67e5\u8be2\u7f51\u7edc\u7684\u8fde\u63a5\u4fe1\u606f</li> <li>ping\uff1a\u68c0\u6d4b\u7f51\u7edc\u8fde\u901a\u6027</li> </ul> <p>\u7b80\u5355\u4ecb\u7ecd\u4e0b\u5404\u79cd\u5de5\u5177\u7684\u4f7f\u7528\uff1a</p>"},{"location":"chap6/15linux_network/#netstat","title":"netstat","text":"<p>\u7528\u4e8e\u663e\u793a\u4e0e IP\u3001TCP\u3001UDP \u548c ICMP \u534f\u8bae\u76f8\u5173\u7684\u7edf\u8ba1\u6570\u636e\uff0c\u6838\u5fc3\u662f\u663e\u793a\u5957\u63a5\u5b57\u72b6\u6001</p> <p>\u53c2\u6570\uff1a-a \u663e\u793a\u6240\u6709\u5957\u63a5\u5b57 -n \u4e0d\u89e3\u6790 DNS \u540d\u5b57 (\u89e3\u6790 DNS \u4f1a\u6bd4\u8f83\u6162) -t \u8fc7\u6ee4\u51fa TCP \u76f8\u5173\u7684\u7f51\u7edc\u5957\u63a5\u5b57 -p \u663e\u793a\u8fdb\u7a0b / \u7a0b\u5e8f\u540d -s \u663e\u793a\u51fa\u534f\u8bae\u6808\u4e2d\u76f8\u5173\u7684\u4e00\u4e9b\u7edf\u8ba1\u4fe1\u606f</p> <p>tips\uff1a\u73b0\u5728\u5e38\u7528 ss \u66ff\u4ee3\uff0css \u7684\u901f\u5ea6\u66f4\u5feb\u4e00\u4e9b -t \u8868\u793a\u53ea\u663e\u793a TCP \u5957\u63a5\u5b57 -n \u8868\u793a\u663e\u793a\u6570\u5b57\u5730\u5740\u548c\u7aef -p \u8868\u793a\u663e\u793a\u8fdb\u7a0b\u4fe1\u606f</p> <pre><code>#\u4f7f\u7528netstat\u67e5\u770btcp\u548cudp\u7684\u5957\u63a5\u5b57\u4fe1\u606f\n[root@ja /] netstat -antu\nActive Internet connections (servers and established)\nProto Recv-Q Send-Q Local Address           Foreign Address         State      \ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN     \ntcp        0      0 172.30.0.39:46522       169.254.0.55:5574       ESTABLISHED\ntcp        0     36 172.30.0.39:22          163.177.68.30:3199      ESTABLISHED\nudp        0      0 0.0.0.0:68              0.0.0.0:*                          \nudp        0      0 0.0.0.0:68              0.0.0.0:*                          \nudp        0      0 172.30.0.39:123         0.0.0.0:*                          \nudp        0      0 127.0.0.1:123           0.0.0.0:*                          \nudp        0      0 0.0.0.0:50844           0.0.0.0:*                          \nudp6       0      0 fe80::5054:ff:fed2::123 :::*                               \nudp6       0      0 ::1:123                 :::*    \n\n#\u4f7f\u7528ss\u4e5f\u53ef\u4ee5\u8fbe\u5230\u540c\u6837\u7684\u6548\u679c\n\n[root@ja /] ss -ant\nState      Recv-Q Send-Q             Local Address:Port              Peer Address:Port              \nLISTEN     0      128                      *:22                             *:*                  \nESTAB      0      0                   172.30.0.39:46522              169.254.0.55:5574               \nESTAB      0      36                  172.30.0.39:22                 163.177.68.30:3199\n</code></pre> <p>\u7528 netstat \u67e5\u770b\u66f4\u4e3a\u8be6\u7ec6\u7684\u534f\u8bae\u6808\u4fe1\u606f\u66f4\u52a0\u76f4\u89c2\u548c\u8be6\u7ec6\uff1a</p> <pre><code>[root@ja /] netstat -s\nIp:\n    16250019 total packets received\n    0 forwarded\n    0 incoming packets discarded\n    16249365 incoming packets delivered\n    17150794 requests sent out\n    1784 dropped because of missing route\nIcmp:\n    3568568 ICMP messages received\n    87 input ICMP message failed.\n    ICMP input histogram:\n        destination unreachable: 339\n        timeout in transit: 107\n        echo requests: 3567914\n        echo replies: 202\n        timestamp request: 2\n    3568477 ICMP messages sent\n    0 ICMP messages failed\n    ICMP output histogram:\n        destination unreachable: 109\n        echo request: 420\n        echo replies: 3567914\n        timestamp replies: 2\n....\nTcp:\n    1462144 active connections openings\n    208661 passive connection openings\n    1787 failed connection attempts\n    2493 connection resets received\n    2 connections established\n    12207346 segments received\n    13063063 segments send out\n    105967 segments retransmited\n    14 bad segments received.\n    148312 resets sent\n    InCsumErrors: 14\n</code></pre>"},{"location":"chap6/15linux_network/#ifconfig","title":"ifconfig","text":"<p>\u7528\u4e8e\u663e\u793a\u6216\u914d\u7f6e\u7f51\u7edc\u8bbe\u5907\uff08\u7f51\u7edc\u63a5\u53e3\u5361\uff09\u4fe1\u606f \uff08\u73b0\u7528 ip \u76f8\u5173\u547d\u4ee4\u66ff\u4ee3\uff0c\u5305\u62ec ip link ip address \u7b49\uff09</p> <pre><code>#\u7528ifconfig\u67e5\u770b\u7f51\u5361\u4fe1\u606f\n[root@ja /] ifconfig \neth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 172.30.0.39  netmask 255.255.240.0  broadcast 172.30.15.255\n        inet6 fe80::5054:ff:fed2:e0d8  prefixlen 64  scopeid 0x20&lt;link&gt;\n        ether 52:54:00:d2:e0:d8  txqueuelen 1000  (Ethernet)\n        RX packets 16381686  bytes 1576456712 (1.4 GiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 17176768  bytes 2555718092 (2.3 GiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 19726  bytes 967210 (944.5 KiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 19726  bytes 967210 (944.5 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\n&gt; \u53ef\u4ee5\u770b\u5230\u7f51\u7edc\u63a5\u53e3\u7684\u72b6\u6001\u6807\u5fd7\u3001MTU \u5927\u5c0f\u3001IP\u3001\u5b50\u7f51\u3001MAC \u5730\u5740\u4ee5\u53ca\u7f51\u7edc\u5305\u6536\u53d1\u7684\u7edf\u8ba1\u4fe1\u606f\n\n#ip\u547d\u4ee4\u662f\u975e\u5e38\u5f3a\u5927\u7684\uff0c\u53ef\u4ee5\u7528ip addr\u66ff\u4ee3ifconfig\n[root@ja /] ip addr\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 52:54:00:d2:e0:d8 brd ff:ff:ff:ff:ff:ff\n    inet 172.30.0.39/20 brd 172.30.15.255 scope global eth0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::5054:ff:fed2:e0d8/64 scope link \n       valid_lft forever preferred_lft forever\n\n# tips\uff1a   ip\u547d\u4ee4\u663e\u793a\u7684LOWER_UP\u8868\u793a\u7269\u7406\u7f51\u7edc\u662f\u8054\u901a\u7684\uff0cifconfig\u663e\u793a\u7684\u662fRUNNING\uff0c\u5982\u679c\u6ca1\u6709\u663e\u793a\u53ef\u80fd\u5c31\u662f\u7269\u7406\u95ee\u9898\n</code></pre> <p>ifconfig \u7684\u4e00\u4e9b\u914d\u7f6e\u64cd\u4f5c\uff1a</p> <pre><code>#\u542f\u52a8\u6216\u8005\u5173\u95ed\u6307\u5b9a\u7f51\u5361\nifconfig eth0 down   \nifconfig eth0 up\n#\u4fee\u6539MAC\u5730\u5740\nifconfig eth0 down //\u5173\u95ed\u7f51\u5361\nifconfig eth0 hw ether $MACaddress //\u4fee\u6539MAC\u5730\u5740\nifconfig eth0 up //\u542f\u52a8\u7f51\u5361\n#\u914d\u7f6eIP\u5730\u5740\nifconfig eth0 $ipaddress netmask 255.255.255.0  // \u7ed9eth0\u7f51\u5361\u914d\u7f6eIP\u5730\u5740,\u5e76\u52a0\u4e0a\u5b50\u63a9\u7801\n#\u542f\u7528\u548c\u5173\u95edARP\u534f\u8bae\nifconfig eth0 arp  //\u5f00\u542f\nifconfig eth0 -arp  //\u5173\u95ed\n#\u8bbe\u7f6e\u6700\u5927\u4f20\u8f93\u5355\u5143\nifconfig eth0 mtu 1460 //\u8bbe\u7f6e\u80fd\u901a\u8fc7\u7684\u6700\u5927\u6570\u636e\u5305\u5927\u5c0f\u4e3a 1460 bytes\n</code></pre>"},{"location":"chap6/15linux_network/#route","title":"route","text":"<p>\u7528\u4e8e\u663e\u793a\u548c\u64cd\u4f5c IP \u8def\u7531\u8868\uff0c\u901a\u8fc7\u76ee\u6807\u5730\u5740 ip \u548c\u5b50\u7f51\u63a9\u7801\u53ef\u4ee5\u5206\u6790\u51fa\u53d1\u5305\u8def\u5f84 (\u73b0\u5e38\u7528 ip route \u66ff\u4ee3) (\u8865\u5145\uff1a<code>ip rule show</code> \u663e\u793a\u8def\u7531\u7b56\u7565\u8868\uff0c\u8c03\u6574\u8def\u7531\u7b56\u7565\u8868\u53ef\u4ee5\u8bbe\u7f6e\u8def\u7531\u8f6c\u53d1\u7b56\u7565)</p> <pre><code>#\u7528route\u67e5\u770b\u8def\u7531\u8868\n[root@ja /] #route -n\nKernel IP routing table\nDestination     Gateway         Genmask         Flags Metric Ref    Use Iface\n0.0.0.0         172.30.0.1      0.0.0.0         UG    0      0        0 eth0\n172.30.0.0      0.0.0.0         255.255.240.0   U     0      0        0 eth0\n\n#\u4e5f\u53ef\u4ee5\u7528ip\u547d\u4ee4\u67e5\u770b\u548c\u64cd\u4f5cIP\u8def\u7531\u7684\u4e00\u4e9b\u4fe1\u606f\uff1a\n[root@ja /] ip route\ndefault via 172.30.0.1 dev eth0 \n172.30.0.0/20 dev eth0 proto kernel scope link src 172.30.0.39 \n[root@jessy /] ip route show\ndefault via 172.30.0.1 dev eth0 \n172.30.0.0/20 dev eth0 proto kernel scope link src 172.30.0.39 \n[root@jessy /] ip rule show\n0: from all lookup local \n32766: from all lookup main \n32767: from all lookup default\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7 route \u53bb\u914d\u7f6e\u8def\u7531\u8868\uff1a</p> <pre><code>route add -net 224.0.0.0 netmask 240.0.0.0 reject  #\u5c4f\u853d\u4e00\u6761\u8def\u7531\nroute del -net 224.0.0.0 netmask 240.0.0.0   #\u5220\u9664\u8def\u7531\u8bb0\u5f55\nroute add default gw 192.168.120.240 #\u6dfb\u52a0\u8bbe\u7f6e\u9ed8\u8ba4\u7f51\u5173\n</code></pre>"},{"location":"chap6/15linux_network/#sar","title":"sar","text":"<p>sar \u662f\u4e00\u4e2a\u4f18\u79c0\u7684\u4e00\u822c\u6027\u80fd\u76d1\u89c6\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u8f93\u51fa Linux \u6240\u5b8c\u6210\u7684\u51e0\u4e4e\u6240\u6709\u5de5\u4f5c\u7684\u6570\u636e\u3002sar \u547d\u4ee4\u5728 sysetat rpm \u4e2d\u63d0\u4f9b\u3002sar \u53ef\u4ee5\u663e\u793a CPU\u3001\u8fd0\u884c\u961f\u5217\u3001\u78c1\u76d8 I/O\u3001\u5206\u9875\uff08\u4ea4\u6362\u533a\uff09\u3001\u5185\u5b58\u3001CPU \u4e2d\u65ad\u3001\u7f51\u7edc\u7b49\u6027\u80fd\u6570\u636e</p> <p>\u7528 <code>sar -n DEV</code> \u663e\u793a\u7f51\u7edc\u4fe1\u606f</p> <pre><code>[root@ja /] sar -n DEV 1\nLinux 3.10.0-1062.18.1.el7.x86_64 (jessy)  08/03/2020  _x86_64_ (4 CPU)\n\n02:57:41 PM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s\n02:57:42 PM      eth0      4.00      2.00      0.21      0.21      0.00      0.00      0.00\n02:57:42 PM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n\n02:57:42 PM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s\n02:57:43 PM      eth0     10.00     10.00      0.80      1.32      0.00      0.00      0.00\n02:57:43 PM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n\n02:57:43 PM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s\n02:57:44 PM      eth0      8.00      8.00      0.61      1.43      0.00      0.00      0.00\n02:57:44 PM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n\n02:57:44 PM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s\n02:57:45 PM      eth0      4.00      5.00      0.37      0.79      0.00      0.00      0.00\n02:57:45 PM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n</code></pre> <p></p> <p>\u7528 sar \u5206\u6790\u7f51\u7edc\u66f4\u591a\u7684\u662f\u7528\u4e8e\u6d41\u91cf\u548c\u5305\u91cf\u7684\u68c0\u6d4b\u548c\u5f02\u5e38\u53d1\u73b0\u3002\u8981\u66f4\u52a0\u8be6\u7ec6\u5206\u6790\u7ec6\u8282\u8fd8\u662f tcpdump+wireshark \u65b9\u4fbf</p>"},{"location":"chap6/15linux_network/#nmap","title":"nmap","text":"<p>\u4e00\u4e2a\u7528\u4e8e\u7f51\u7edc\u63a2\u6d4b\u548c\u5b89\u5168\u5ba1\u6838\u7684\u5de5\u5177\uff0c\u9700\u8981\u81ea\u884c\u5b89\u88c5 (yum install nmap)</p> <p>\u5e38\u7528\u6765\uff1a</p> <pre><code>nmap baidu.com\n\nStarting Nmap 6.40 ( http://nmap.org ) at 2020-08-03 14:59 CST\nNmap scan report for baidu.com (39.156.69.79)\nHost is up (0.042s latency).\nOther addresses for baidu.com (not scanned): 220.181.38.148\nNot shown: 998 filtered ports\nPORT    STATE SERVICE\n80/tcp  open  http\n443/tcp open  https\n\nNmap done: 1 IP address (1 host up) scanned in 17.84 seconds\n</code></pre> <pre><code>nmap &lt;target ip1 address&gt; &lt;target ip2 address&gt; #\u5feb\u901f\u626b\u63cf\u591a\u4e2aip\u5730\u5740\nnmap -p(range) &lt;target IP&gt;    #\u6307\u5b9a\u7aef\u53e3\u548c\u8303\u56f4\n</code></pre>"},{"location":"chap6/15linux_network/#ping","title":"ping","text":"<p>ping \u7a0b\u5e8f\u662f\u6d4b\u8bd5\u53e6\u4e00\u4e2a\u4e3b\u673a\u662f\u5426\u53ef\u8fbe\u7684\u5e38\u7528\u7a0b\u5e8f\uff0c\u5e38\u7528\u6765\u6d4b\u8bd5\u8fdc\u7a0b\u4e3b\u673a\u7684\u8fde\u901a\u6027\u548c\u5ef6\u65f6\u3002</p> <p>ping \u7a0b\u5e8f\u7684\u539f\u7406\u5c31\u662f\u53d1\u9001\u4e00\u4e2a ICMP \u62a5\u6587\u7ed9\u4e3b\u673a\uff0c\u7b49\u5f85\u8fd4\u56de\u7684 ICMP \u56de\u663e\u5e94\u7b54\u3002</p> <p>\u4e00\u4e9b\u9009\u9879\uff0c\u5305\u62ec <code>-s</code> \u8bbe\u7f6e\u5305\u7684\u5927\u5c0f\uff0c<code>-c</code> \u8bbe\u7f6e ping \u7684\u6b21\u6570\uff0c<code>-t</code> \u8868\u793a\u4e00\u76f4 ping \u76f4\u81f3\u81ea\u5df1\u7ec8\u6b62\uff0c<code>-R</code> \u67e5\u770b\u8def\u7531\u9009\u9879</p> <pre><code>ping baidu.com\nPING baidu.com (39.156.69.79) 56(84) bytes of data.\n64 bytes from 39.156.69.79 (39.156.69.79): icmp_seq=1 ttl=47 time=41.9 ms\n64 bytes from 39.156.69.79 (39.156.69.79): icmp_seq=2 ttl=47 time=41.9 ms\n...\n--- baidu.com ping statistics ---\n8 packets transmitted, 8 received, 0% packet loss, time 10491ms\nrtt min/avg/max/mdev = 41.915/41.930/41.967/0.271 ms\n</code></pre>"},{"location":"chap6/15linux_network/#iperf","title":"iperf","text":"<p>iperf \u662f\u5e38\u7528\u7684\u7f51\u7edc\u6027\u80fd\u6d4b\u8bd5\u5de5\u5177\uff0c\u7528\u6765\u6d4b\u8bd5 TCP \u548c UDP \u7684\u541e\u5410\u91cf\uff0c\u4ee5\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u901a\u4fe1\u7684\u65b9\u5f0f\uff0c\u6d4b\u8bd5\u4e00\u6bb5\u65f6\u95f4\u5185\u7684\u5e73\u5747\u541e\u5410\u91cf\u3002</p> <pre><code>#\u5728\u670d\u52a1\u5668\u6267\u884ciperf\n# -s \u8868\u793a\u542f\u52a8\u670d\u52a1\u7aef\uff0c-i \u8868\u793a\u6c47\u62a5\u95f4\u9694\uff0c-p \u8868\u793a\u76d1\u542c\u7aef\u53e3\niperf3 -s \n#\u5728\u5ba2\u6237\u7aef\u6267\u884ciperf\niperf3 -c 192.168.77.131 \n\n[root@ja /] iperf3 -s -i 1 -p 12345\n-----------------------------------------------------------\nServer listening on 12345\n-----------------------------------------------------------\nAccepted connection from 172.30.0.39, port 49566\n[  5] local 172.30.0.39 port 12345 connected to 172.30.0.39 port 49568\n[ ID] Interval           Transfer     Bandwidth\n[  5]   0.00-1.00   sec  5.23 GBytes  44.9 Gbits/sec                  \n[  5]   1.00-2.00   sec  5.60 GBytes  48.1 Gbits/sec                  \n[  5]   2.00-3.00   sec  5.10 GBytes  43.8 Gbits/sec                  \n[  5]   3.00-4.00   sec  5.45 GBytes  46.8 Gbits/sec                  \n[  5]   4.00-5.00   sec  4.84 GBytes  41.6 Gbits/sec                  \n[  5]   5.00-6.00   sec  4.84 GBytes  41.6 Gbits/sec                  \n[  5]   6.00-7.00   sec  4.93 GBytes  42.3 Gbits/sec                  \n[  5]   7.00-8.00   sec  5.57 GBytes  47.8 Gbits/sec                  \n[  5]   8.00-9.00   sec  5.85 GBytes  50.2 Gbits/sec                  \n[  5]   9.00-10.00  sec  5.79 GBytes  49.7 Gbits/sec                  \n[  5]  10.00-10.04  sec   274 MBytes  59.1 Gbits/sec                  \n- - - - - - - - - - - - - - - - - - - - - - - - -\n[ ID] Interval           Transfer     Bandwidth\n[  5]   0.00-10.04  sec  0.00 Bytes  0.00 bits/sec                  sender\n[  5]   0.00-10.04  sec  53.4 GBytes  45.7 Gbits/sec                  receiver\n-----------------------------------------------------------\nServer listening on 12345\n-----------------------------------------------------------\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u673a\u5668\u7684 TCP \u541e\u5410\u91cf\u3001\u5e26\u5bbd\u7b49\u4fe1\u606f\uff0c\u53d1\u9001\u65b9\u4e5f\u53ef\u4ee5\u770b\u5230\u7a97\u53e3\u5927\u5c0f\u3001\u541e\u5410\u91cf\u3001\u5e26\u5bbd\u7b49\u4fe1\u606f</p>"},{"location":"chap6/15linux_network/#4-socket","title":"4 [SOCKET]\u6027\u80fd\u4f18\u5316","text":"<p>\u4e3b\u8981\u662f TCP \u7684\u5934\u90e8\u9009\u9879\u90e8\u5206\u548c socket \u8fde\u63a5\u65f6\u7684\u9009\u9879\u90e8\u5206\uff0c\u6839\u636e\u590d\u6742\u7684\u7f51\u7edc\u73af\u5883\u8fdb\u884c\u9009\u62e9\u4f1a\u5927\u5927\u63d0\u5347 socket \u7684\u6027\u80fd\u3002</p>"},{"location":"chap6/15linux_network/#tcp","title":"TCP \u9009\u9879","text":"<p><code>SO_LINGER</code></p> <p><code>SO_LINGER</code> \uff1a\u6307\u5b9a\u51fd\u6570 close \u5bf9\u9762\u5411\u8fde\u63a5\u7684\u534f\u8bae\u5982\u4f55\u64cd\u4f5c\uff0c\u5185\u6838\u7f3a\u7701 close \u64cd\u4f5c\u662f\u7acb\u5373\u8fd4\u56de\uff0c\u5982\u679c\u6709\u6570\u636e\u6b8b\u7559\u5728\u5957\u63a5\u53e3\u7f13\u51b2\u533a\u4e2d\u5219\u7cfb\u7edf\u5c06\u8bd5\u7740\u5c06\u8fd9\u4e9b\u6570\u636e\u53d1\u9001\u7ed9\u5bf9\u65b9\u3002</p> <pre><code>struct linger {\n     int l_onoff; /* 0 = off, nozero = on */\n     int l_linger; /* linger time */\n};\n</code></pre> <ul> <li>\u8bbe\u7f6e l_onoff \u4e3a 0\uff0c\u5219\u5173\u95ed linger\uff0cclose \u76f4\u63a5\u8fd4\u56de\uff0c\u672a\u53d1\u9001\u6570\u636e\u5c06\u7531\u5185\u6838\u5b8c\u6210\u4f20\u8f93</li> <li>\u8bbe\u7f6e l_onoff \u4e3a\u975e 0\uff0cl_linger \u4e3a 0\uff0c\u5219\u6253\u5f00 linger\uff0c\u5219\u7acb\u5373\u5173\u95ed\u8be5\u8fde\u63a5\uff0c\u901a\u8fc7\u53d1\u9001 RST \u5206\u7ec4 (\u800c\u4e0d\u662f\u7528\u6b63\u5e38\u7684 FIN|ACK|FIN|ACK \u56db\u4e2a\u5206\u7ec4) \u6765\u5173\u95ed\u8be5\u8fde\u63a5\u3002\u5982\u679c\u53d1\u9001\u7f13\u51b2\u533a\u4e2d\u5982\u679c\u6709\u672a\u53d1\u9001\u5b8c\u7684\u6570\u636e\uff0c\u5219\u4e22\u5f03\u3002\u4e3b\u52a8\u5173\u95ed\u4e00\u65b9\u7684 TCP \u72b6\u6001\u5219\u8df3\u8fc7 TIMEWAIT\uff0c\u76f4\u63a5\u8fdb\u5165 CLOSED</li> <li>\u8bbe\u7f6e l_onoff \u4e3a\u975e 0\uff0cl_linger \u4e3a\u975e 0\uff0c\u5c06\u8fde\u63a5\u7684\u5173\u95ed\u8bbe\u7f6e\u4e00\u4e2a\u8d85\u65f6\u3002\u5982\u679c socket \u53d1\u9001\u7f13\u51b2\u533a\u4e2d\u4ecd\u6b8b\u7559\u6570\u636e\uff0c\u8fdb\u7a0b\u8fdb\u5165\u7761\u7720\uff0c\u5185\u6838\u8fdb\u5165\u5b9a\u65f6\u72b6\u6001\u53bb\u5c3d\u91cf\u53bb\u53d1\u9001\u8fd9\u4e9b\u6570\u636e\u3002\u5728\u8d85\u65f6\u4e4b\u524d\uff0c\u5982\u679c\u6240\u6709\u6570\u636e\u90fd\u53d1\u9001\u5b8c\u4e14\u88ab\u5bf9\u65b9\u786e\u8ba4\uff0c\u5185\u6838\u7528\u6b63\u5e38\u7684 FIN|ACK|FIN|ACK \u56db\u4e2a\u5206\u7ec4\u6765\u5173\u95ed\u8be5\u8fde\u63a5\uff0cclose() \u6210\u529f\u8fd4\u56de\u3002\u5982\u679c\u8d85\u65f6\u4e4b\u65f6\uff0c\u6570\u636e\u4ecd\u7136\u672a\u80fd\u6210\u529f\u53d1\u9001\u53ca\u88ab\u786e\u8ba4\uff0c\u7528\u4e0a\u9762\u7684\u65b9\u5f0f\u6765\u5173\u95ed\u6b64\u8fde\u63a5\u3002close() \u8fd4\u56de EWOULDBLOCK</li> </ul> <p>\u56db\u6b21\u6325\u624b\u65ad\u5f00\u8fde\u63a5\u4e3b\u52a8\u5173\u95ed\u65b9\u4f1a\u8fdb\u5165 TIME_WAIT \u72b6\u6001\uff0cTIME_WAIT \u72b6\u6001\u975e\u5e38\u591a\u7684\u8bdd\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u8d1f\u8f7d\u8f83\u5927 (TIME_WAIT \u672c\u8eab\u4e0d\u5360\u7528\u8d44\u6e90\uff0c\u4f46\u662f\u5904\u7406 TIME_WAIT \u9700\u8981\u8017\u8d39\u8d44\u6e90)\uff0c\u6545\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u6253\u5f00 linger \u5219\u76f4\u63a5\u53d1\u9001 RST \u5206\u7ec4\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0d\u4f1a\u4ea7\u751f <code>TIME_WAIT</code>\u3002</p> <p>\uff08TIPS:TIME_WAIT \u72b6\u6001\u592a\u591a\uff0c\u7cfb\u7edf\u4f1a\u8fdb\u884c\u56de\u6536\u548c\u5229\u7528\uff0c\u56e0\u6b64\uff0c\u56de\u6536\u65f6\u662f\u7b49\u5f85\u7684\u65f6\u95f4\u6700\u957f\u7684\uff0c\u6545\u5982\u679c TIME_WAIT \u72b6\u6001\u592a\u591a\u7684\u8bdd\uff0c\u5c31\u9700\u8981\u7ef4\u62a4\u4e00\u4e2a\u975e\u5e38\u5927\u7684\u6570\u636e\u7ed3\u6784\u7528\u6765\u627e\u7b49\u5f85\u65f6\u95f4\u6700\u957f\u7684\uff0c\u4f1a\u5360\u636e\u4e00\u5b9a\u7684\u7cfb\u7edf\u8ba1\u7b97\u8d44\u6e90\uff09</p> <p>\u5bf9\u4e8e TIME_WAIT \u8fc7\u591a\u4e5f\u53ef\u4ee5\u76f4\u63a5\u8bbe\u7f6e\u7cfb\u7edf\u7684\u6700\u5927 TIME_WAIT \u6570\uff0c\u5c06\u8be5\u6570\u5b57\u8c03\u5c0f\u4e00\u4e9b\u3002(\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u4e0d\u592a\u53ef\u9760\u7684\u65ad\u5f00\uff0c\u4e0d\u8fc7\u5bf9\u4e8e\u51cf\u5c11\u670d\u52a1\u5668\u538b\u529b\u6765\u8bf4\u8fd8\u662f\u6bd4\u8f83\u4e0d\u9519\u7684\u65b9\u5f0f\uff0c\u53ea\u662f\u4f1a\u4ee4\u5ba2\u6237\u7aef\u65ad\u5f00\u8fde\u63a5\u66f4\u6162\u4e00\u4e9b\uff0c\u5ba2\u6237\u7aef\u901a\u5e38\u662f\u4e00\u4e2a\u4e3b\u673a\uff0c\u7ef4\u6301\u8fde\u63a5\u8f83\u5c11\uff0c\u4e00\u4e2a\u8f83\u957f\u7684\u65ad\u5f00\u5f71\u54cd\u4e0d\u5927)</p>"},{"location":"chap6/15linux_network/#so_reuseaddr","title":"<code>SO_REUSEADDR</code>","text":"<p>\u901a\u5e38\u4e00\u4e2a\u7aef\u53e3\u91ca\u653e\u540e\u4f1a\u7b49\u5f85\u4e24\u5206\u949f (TIME_WAIT \u65f6\u95f4) \u4e4b\u540e\u624d\u80fd\u518d\u88ab\u4f7f\u7528\uff0cSO_REUSEADDR \u662f\u8ba9\u7aef\u53e3\u91ca\u653e\u540e\u7acb\u5373\u5c31\u53ef\u4ee5\u88ab\u518d\u6b21\u4f7f\u7528\u3002</p> <p>SO_REUSEADDR \u7528\u4e8e\u5bf9 TCP \u5957\u63a5\u5b57\u5904\u4e8e TIME_WAIT \u72b6\u6001\u4e0b\u7684 socket\uff0c\u624d\u53ef\u4ee5\u91cd\u590d\u7ed1\u5b9a\u4f7f\u7528\u3002server \u7a0b\u5e8f\u603b\u662f\u5e94\u8be5\u5728\u8c03\u7528 bind() \u4e4b\u524d\u8bbe\u7f6e SO_REUSEADDR \u5957\u63a5\u5b57\u9009\u9879\u3002\u5728 TCP \u8fde\u63a5\u4e2d\uff0c\u4e3b\u52a8\u5173\u95ed\u65b9\u4f1a\u8fdb\u5165 TIME_WAIT \u72b6\u6001\uff0c\u56e0\u6b64\u8fd9\u4e2a\u529f\u80fd\u4e5f\u5c31\u662f\u4e3b\u52a8\u65b9\u6536\u5230\u88ab\u52a8\u65b9\u53d1\u9001\u7684 FIN \u540e\uff0c\u53d1\u9001 ACK \u540e\u5c31\u53ef\u4ee5\u65ad\u5f00\u8fde\u63a5\uff0c\u4e0d\u518d\u53bb\u5904\u7406\u8be5 ACK \u4e22\u5931\u7b49\u60c5\u51b5\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u4e2a\u5957\u63a5\u5b57\u9009\u9879\u5411\u5185\u6838\u4f20\u8fbe\u4e86\u8be5\u6d88\u606f\uff1a\u5982\u679c\u8fd9\u4e2a\u7aef\u53e3\u88ab\u5360\u7528\u4f46\u662f TCP \u72b6\u6001\u4f4d\u4e8e <code>TIME_WAIT</code> \uff0c\u5219\u53ef\u4ee5\u91cd\u7528\u7aef\u53e3\u3002\u800c\u5982\u679c\u7aef\u53e3\u5fd9\uff0c\u800c TCP \u72b6\u6001\u4f4d\u4e8e\u5176\u4ed6\u72b6\u6001\uff0c\u90a3\u4e48\u91cd\u7528\u7aef\u53e3\u65f6\u4f9d\u65e7\u5f97\u5230\u4e00\u4e2a\u9519\u8bef\u4fe1\u606f\uff0c\u6307\u660e \"\u5730\u5740\u5df2\u7ecf\u4f7f\u7528\u4e2d\"\u3002\u5982\u679c\u60f3\u8981\u8ba9\u670d\u52a1\u7a0b\u5e8f\u505c\u6b62\u540e\u5c31\u53ef\u4ee5\u7acb\u5373\u91cd\u7528\uff0c\u5e76\u4e14\u4f7f\u7528\u7684\u7aef\u53e3\u8fd8\u662f\u8fd9\u4e2a\u7aef\u53e3\uff0c\u90a3\u4e48\u8bbe\u7f6e <code>SO_REUSEADDR</code> \u9009\u9879\u5c06\u975e\u5e38\u6709\u5fc5\u8981\u3002\u603b\u4f53\u6765\u8bf4\uff0c\u5bf9\u4e8e\u9700\u8981\u7ef4\u6301\u5927\u91cf TCP \u8fde\u63a5\u7684\u670d\u52a1\u5668\u53ef\u4ee5\u8bbe\u7f6e\u8fd9\u4e2a\u9009\u9879\uff0c\u56e0\u4e3a\u53ef\u80fd\u4f1a\u5b58\u5728\u5927\u91cf\u7684 <code>TIME_WAIT</code> \u72b6\u6001 (\u5c24\u5176\u662f HTTP \u670d\u52a1\u901a\u5e38\u662f\u670d\u52a1\u5668\u5145\u5f53\u4e3b\u52a8\u65ad\u5f00\u4e00\u65b9)\uff0c\u8bbe\u7f6e\u8be5\u9009\u9879\u5c31\u5f88\u6709\u5fc5\u8981\uff0c\u6bd5\u7adf\u6700\u7cdf\u7cd5\u7684\u60c5\u51b5\u4e0b\u57fa\u672c\u662f\u5ba2\u6237\u7aef\u7684\u65ad\u5f00\u6162\u4e00\u4e9b\uff0c\u5f71\u54cd\u4e5f\u4e0d\u662f\u975e\u5e38\u5927 (\u5ba2\u6237\u673a\u901a\u5e38\u4e0d\u9700\u8981\u5927\u91cf\u7684 TCP \u8fde\u63a5\u9700\u8981)</p>"},{"location":"chap6/15linux_network/#tcp_nodelaytcp_chork","title":"<code>TCP_NODELAY/TCP_CHORK</code>","text":""},{"location":"chap6/15linux_network/#nagle","title":"Nagle \u7b97\u6cd5","text":"<p>Nagle \u7b97\u6cd5\u9488\u5bf9\u7684\u662f\u9700\u8981\u8fde\u7eed\u53d1\u9001\u591a\u4e2a\u5c0f\u6570\u636e\u5305\u7684\u60c5\u51b5\u4e0b\uff0c\u53d1\u9001\u7684\u6709\u6548\u6570\u636e\u76f8\u8f83\u4e8e\u5934\u90e8\u592a\u5c0f\uff0c\u56e0\u6b64\u53d1\u9001\u7684\u6548\u7387\u8fc7\u4f4e\uff0c\u751a\u81f3\u53ef\u80fd\u5bfc\u81f4\u7f51\u7edc\u963b\u585e\u3002Nagle \u7b97\u6cd5\u53ef\u4ee5\u51cf\u5c11\u7f51\u7edc\u4e2d\u5c0f\u7684\u6570\u636e\u5305\u7684\u6570\u91cf\uff0c\u4ece\u800c\u964d\u4f4e\u7f51\u7edc\u7684\u62e5\u585e\u7a0b\u5ea6\u3002\u6700\u5e38\u89c1\u7684 Nagle \u7b97\u6cd5\u7684\u4f8b\u5b50\u5c31\u662f Telnet \u7a0b\u5e8f\uff0c\u7528\u6237\u5728\u63a7\u5236\u53f0\u7684\u6bcf\u6b21\u51fb\u952e\u90fd\u4f1a\u53d1\u9001\u4e00\u4e2a\u6570\u636e\u5305\uff0c\u8fd9\u4e2a\u5305\u901a\u5e38\u5305\u542b 41 \u4e2a\u5b57\u8282\uff0c\u7136\u800c\u53ea\u6709\u4e00\u4e2a\u5b57\u8282\u662f\u6709\u6548\u8d1f\u8f7d\uff0c\u5176\u4f59 40 \u4e2a\u5b57\u8282\u90fd\u662f\u62a5\u5934\uff0c\u5982\u679c\u6bcf\u6b21\u51fb\u952e\u90fd\u53d1\u9001\u4e00\u4e2a\u62a5\u6587\uff0c\u90a3\u5c31\u4f1a\u9020\u6210\u4e86\u5de8\u5927\u7684\u5f00\u9500\u3002\u4e3a\u4e86\u51cf\u5c0f\u8fd9\u79cd\u5f00\u9500\uff0cNagle \u7b97\u6cd5\u89c4\u5b9a\uff0c\u5f53 TCP \u53d1\u9001\u4e86\u4e00\u4e2a\u5c0f\u7684 segment\uff08\u5c0f\u4e8e MSS\uff09\uff0c\u5b83\u5fc5\u987b\u7b49\u5230\u63a5\u6536\u5230\u5bf9\u65b9\u7684 ACK \u4e4b\u540e\uff0c\u624d\u80fd\u7ee7\u7eed\u53d1\u9001\u53e6\u4e00\u4e2a\u5c0f\u7684 segment\uff0c\u56e0\u6b64\u53d1\u9001\u65b9\u5c06\u7b2c\u4e00\u4e2a\u5c0f\u5305\u53d1\u51fa\u53bb\u540e\uff0c\u5c06\u540e\u9762\u5230\u8fbe\u7684\u5c11\u91cf\u5b57\u7b26\u6570\u636e\u90fd\u7f13\u5b58\u8d77\u6765\u800c\u4e0d\u7acb\u5373\u53d1\u9001\uff0c\u76f4\u5230\u6536\u5230\u4e0a\u4e00\u4e2a\u6570\u636e\u5305\u7684 ACK \u6216\u8005 \u5f53\u524d\u5b57\u7b26\u5c5e\u4e8e\u7d27\u6025\u6570\u636e \u6216\u8005 \u7f13\u5b58\u7684\u5b57\u7b26\u6570\u636e\u5df2\u7ecf\u5230\u8fbe\u4e00\u5b9a\u7684\u957f\u5ea6\u3002Nagle \u7b97\u6cd5\u5e76\u975e\u7075\u4e39\u5999\u836f\uff0c\u5b83\u4f1a\u589e\u52a0 TCP \u53d1\u9001\u6570\u636e\u7684\u5ef6\u8fdf\u3002\u5728\u4e00\u4e9b\u8981\u6c42\u4f4e\u5ef6\u8fdf\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff08\u4f8b\u5982\u5373\u65f6\u901a\u8baf\u5e94\u7528\uff09\uff0cNagle \u7b97\u6cd5\u7684\u89c4\u5b9a\u662f\u4e0d\u6613\u88ab\u63a5\u53d7\u7684\uff0c\u56e0\u6b64\u9700\u8981\u8bbe\u7f6e <code>TCP_NODELAY</code> \u6216\u8005 <code>TCP_CHORK</code> \u5173\u95ed Nagle \u7b97\u6cd5\u3002</p> <p>TIPS: TCP \u7684\u5ef6\u8fdf ACK \u4e0e Nagle \u7b97\u6cd5\u6709\u5f02\u66f2\u540c\u5de5\u4e4b\u5999\uff0c\u5ef6\u8fdf ACK\uff1a\u5f53 TCP \u63a5\u6536\u5230\u6570\u636e\u65f6\uff0c\u5e76\u4e0d\u4f1a\u7acb\u5373\u53d1\u9001 ACK \u7ed9\u5bf9\u65b9\uff0c\u76f8\u53cd\uff0c\u5b83\u4f1a\u7b49\u5f85\u5e94\u7528\u5c42\u4ea7\u751f\u6570\u636e\uff0c\u7136\u540e\u5c06 ACK \u548c\u6570\u636e\u4e00\u8d77\u53d1\u9001\uff0c\u5e76\u4e14\u53d1\u9001\u7684 ACK \u5e8f\u53f7\u4e3a\u5c06\u53ef\u80fd\u4f1a\u662f\u66f4\u5927\u7684 ACK \u5e8f\u53f7\uff08\u5728 Linux \u7684\u6700\u591a\u7b49\u5f85 40 \u6beb\u79d2\uff09\uff08ACK \u5e8f\u53f7\u8868\u793a\u8be5\u5e8f\u53f7\u4e4b\u524d\u7684\u62a5\u6587\u5df2\u7ecf\u6536\u5230\uff0c\u6545\u7b49\u5f85\u671f\u95f4\u53ef\u80fd\u53c8\u6536\u5230\u4e86\u90e8\u5206\u62a5\u6587\uff0c\u6700\u7ec8\u53ea\u9700\u8981\u53d1\u9001\u4e00\u4e2a\u6700\u5927\u7684 ACK \u5e8f\u53f7\u5373\u53ef\u8868\u793a\u4e4b\u524d\u7684\u90fd\u6536\u5230\u4e86\uff09</p>"},{"location":"chap6/15linux_network/#tcp_nodelaytcp_chork_1","title":"<code>TCP_NODELAY/TCP_CHORK</code>","text":"<p><code>TCP_NODELAY</code> \u548c <code>TCP_CHORK</code> \u90fd\u7981\u6389\u4e86 Nagle \u7b97\u6cd5\uff0c\u884c\u4e3a\u9700\u6c42\u6709\u4e9b\u4e0d\u540c\uff1a</p> <ul> <li><code>TCP_NODELAY</code> \u4e0d\u4f7f\u7528 Nagle \u7b97\u6cd5\uff0c\u4e0d\u4f1a\u5c06\u5c0f\u5305\u8fdb\u884c\u62fc\u63a5\u6210\u5927\u5305\u518d\u8fdb\u884c\u53d1\u9001\uff0c\u800c\u662f\u76f4\u63a5\u5c06\u5c0f\u5305\u53d1\u9001\u51fa\u53bb</li> <li><code>TCP_CORK</code> \u9002\u7528\u4e8e\u9700\u8981\u4f20\u9001\u5927\u91cf\u6570\u636e\u65f6\uff0c\u53ef\u4ee5\u63d0\u9ad8 TCP \u7684\u53d1\u884c\u6548\u7387\u3002\u8bbe\u7f6e <code>TCP_CORK</code> \u540e\u5c06\u6bcf\u6b21\u5c3d\u91cf\u53d1\u9001\u6700\u5927\u7684\u6570\u636e\u91cf\uff0c\u5f53\u7136\u4e5f\u6709\u4e00\u4e2a\u963b\u585e\u65f6\u95f4\uff0c\u5f53\u963b\u585e\u65f6\u95f4\u5230\u7684\u65f6\u5019\u6570\u636e\u4f1a\u81ea\u52a8\u4f20\u9001</li> </ul>"},{"location":"chap6/15linux_network/#tcp_defer_accpt","title":"<code>TCP_DEFER_ACCPT</code>","text":"<p>\u63a8\u8fdf\u63a5\u6536\uff0c\u8bbe\u7f6e\u8be5\u9009\u9879\u540e\uff0c\u670d\u52a1\u5668\u63a5\u6536\u5230\u7b2c\u4e00\u4e2a\u6570\u636e\u540e\uff0c\u624d\u4f1a\u5efa\u7acb\u8fde\u63a5\u3002(\u53ef\u4ee5\u7528\u6765\u9632\u8303\u7a7a\u8fde\u63a5\u653b\u51fb)</p> <p>\u5f53\u8bbe\u7f6e\u8be5\u9009\u9879\u540e\uff0c\u670d\u52a1\u5668\u6536\u5230 connect \u5b8c\u6210 3 \u6b21\u63e1\u624b\u540e\uff0c\u670d\u52a1\u5668\u4ecd\u7136\u662f <code>SYN_RECV</code>\uff0c\u800c\u4e0d\u662f ESTABLISHED \u72b6\u6001\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4e0d\u4f1a\u63a5\u6536\u6570\u636e\uff0c\u76f4\u81f3\u6536\u5230\u4e00\u4e2a\u6570\u636e\u624d\u4f1a\u8fdb\u884c ESTABLISHED \u72b6\u6001\u3002\u56e0\u6b64\u5982\u679c\u5ba2\u6237\u4e00\u76f4\u6ca1\u6709\u53d1\u9001\u6570\u636e\uff0c\u5219\u670d\u52a1\u5668\u4f1a\u91cd\u4f20 SYN/ACK \u62a5\u6587\uff0c\u4f1a\u6709\u91cd\u4f20\u6b21\u6570\u548c\u8d85\u65f6\u503c\u7684\u9650\u5236\u3002</p>"},{"location":"chap6/15linux_network/#so_keepalive","title":"<code>SO_KEEPALIVE</code>","text":"<p><code>SO_KEEPALIVE</code> \u4fdd\u6301\u8fde\u63a5\u68c0\u6d4b\u5bf9\u65b9\u4e3b\u673a\u662f\u5426\u5d29\u6e83\uff0c\u907f\u514d\uff08\u670d\u52a1\u5668\uff09\u6c38\u8fdc\u963b\u585e\u4e8e TCP \u8fde\u63a5\u7684\u8f93\u5165\u3002</p> <p>\u8bbe\u7f6e\u8be5\u9009\u9879\u540e\uff0c\u5982\u679c 2 \u5c0f\u65f6\u5185\u5728\u6b64\u5957\u63a5\u53e3\u7684\u4efb\u4e00\u65b9\u5411\u90fd\u6ca1\u6709\u6570\u636e\u4ea4\u6362\uff0cTCP \u5c31\u81ea\u52a8\u7ed9\u5bf9\u65b9 \u53d1\u4e00\u4e2a\u4fdd\u6301\u5b58\u6d3b\u63a2\u6d4b\u5206\u8282 (keepalive probe)\u3002\u8fd9\u662f\u4e00\u4e2a\u5bf9\u65b9\u5fc5\u987b\u54cd\u5e94\u7684 TCP \u5206\u8282. \u5b83\u4f1a\u5bfc\u81f4\u4ee5\u4e0b\u4e09\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>\u5bf9\u65b9\u63a5\u6536\u4e00\u5207\u6b63\u5e38\uff1a\u4ee5\u671f\u671b\u7684 ACK \u54cd\u5e94\uff0c2 \u5c0f\u65f6\u540e\uff0cTCP \u5c06\u53d1\u51fa\u53e6\u4e00\u4e2a\u63a2\u6d4b\u5206\u8282</li> <li>\u5bf9\u65b9\u5df2\u5d29\u6e83\u4e14\u5df2\u91cd\u65b0\u542f\u52a8\uff1a\u4ee5 RST \u54cd\u5e94\u3002\u5957\u63a5\u53e3\u7684\u5f85\u5904\u7406\u9519\u8bef\u88ab\u7f6e\u4e3a ECONNRESET\uff0c\u5957\u63a5 \u53e3\u672c\u8eab\u5219\u88ab\u5173\u95ed\u3002</li> <li>\u5bf9\u65b9\u65e0\u4efb\u4f55\u54cd\u5e94\uff1a\u6e90\u81ea berkeley \u7684 TCP \u53d1\u9001\u53e6\u5916 8 \u4e2a\u63a2\u6d4b\u5206\u8282\uff0c\u76f8\u9694 75 \u79d2\u4e00\u4e2a\uff0c\u8bd5\u56fe\u5f97\u5230\u4e00\u4e2a\u54cd\u5e94\u3002\u5728\u53d1\u51fa\u7b2c\u4e00\u4e2a\u63a2\u6d4b\u5206\u8282 11 \u5206\u949f 15 \u79d2\u540e\u82e5\u4ecd\u65e0\u54cd\u5e94\u5c31\u653e\u5f03\u3002\u5957\u63a5\u53e3\u7684\u5f85\u5904\u7406\u9519\u8bef\u88ab\u7f6e\u4e3a ETIMEOUT\uff0c\u5957\u63a5\u53e3\u672c\u8eab\u5219\u88ab\u5173\u95ed\u3002\u5982 ICMP \u9519\u8bef\u662f \u201chost unreachable(\u4e3b\u673a\u4e0d\u53ef\u8fbe)\u201d\uff0c\u8bf4\u660e\u5bf9\u65b9\u4e3b\u673a\u5e76\u6ca1\u6709\u5d29\u6e83\uff0c\u4f46\u662f\u4e0d\u53ef\u8fbe\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5f85\u5904\u7406\u9519\u8bef\u88ab\u7f6e\u4e3a EHOSTUNREACH\u3002</li> </ul> <p>\u6709\u5173 <code>SO_KEEPALIVE</code> \u7684\u4e09\u4e2a\u53c2\u6570\u8be6\u7ec6\u89e3\u91ca\u5982\u4e0b:</p> <ul> <li><code>tcp_keepalive_intvl</code>\uff0c\u4fdd\u6d3b\u63a2\u6d4b\u6d88\u606f\u7684\u53d1\u9001\u9891\u7387\u3002\u9ed8\u8ba4\u503c\u4e3a 75s\u3002</li> <li><code>tcp_keepalive_probes</code>\uff0cTCP \u53d1\u9001\u4fdd\u6d3b\u63a2\u6d4b\u6d88\u606f\u4ee5\u786e\u5b9a\u8fde\u63a5\u662f\u5426\u5df2\u65ad\u5f00\u7684\u6b21\u6570\u3002\u9ed8\u8ba4\u503c\u4e3a 9</li> <li><code>tcp_keepalive_time</code>\uff0c\u5728 TCP \u4fdd\u6d3b\u6253\u5f00\u7684\u60c5\u51b5\u4e0b\uff0c\u6700\u540e\u4e00\u6b21\u6570\u636e\u4ea4\u6362\u5230 TCP \u53d1\u9001\u7b2c\u4e00\u4e2a\u4fdd\u6d3b\u63a2\u6d4b\u6d88\u606f\u7684\u65f6\u95f4\uff0c\u5373\u5141\u8bb8\u7684\u6301\u7eed\u7a7a\u95f2\u65f6\u95f4\u3002\u9ed8\u8ba4\u503c\u4e3a 7200s\uff082h\uff09\u3002</li> </ul>"},{"location":"chap6/15linux_network/#so_sndtimeo-so_rcvtimeo","title":"<code>SO_SNDTIMEO &amp; SO_RCVTIMEO</code>","text":"<p><code>SO_RCVTIMEO</code> \u548c <code>SO_SNDTIMEO</code> \uff0c\u5b83\u4eec\u5206\u522b\u7528\u6765\u8bbe\u7f6e socket \u63a5\u6536\u6570\u636e\u8d85\u65f6\u65f6\u95f4\u548c\u53d1\u9001\u6570\u636e\u8d85\u65f6\u65f6\u95f4\u3002</p> <p>\u56e0\u6b64\uff0c\u8fd9\u4e24\u4e2a\u9009\u9879\u4ec5\u5bf9\u4e0e\u6570\u636e\u6536\u53d1\u76f8\u5173\u7684\u7cfb\u7edf\u8c03\u7528\u6709\u6548\u3002\u63a5\u6536\u8d85\u65f6\u4f1a\u5f71\u54cd read\u3001readv\u3001recv\u3001recvfrom\u3001recvmsg \u7684\u72b6\u6001\uff0c\u53d1\u9001\u8d85\u65f6\u4f1a\u5f71\u54cd write\u3001writev\u3001send\u3001sendto \u548c sendmsg \u7684\u72b6\u6001\u3002</p>"},{"location":"chap6/15linux_network/#_1","title":"\u7f13\u5b58\u5927\u5c0f","text":"<p><code>SO_RCVBUF</code> \u548c <code>SO_SNDBUF</code>\uff1a\u8bbe\u7f6e\u7684\u662f Socket \u7f13\u5b58\u5927\u5c0f\uff0c\u7f13\u5b58\u5927\u5c0f\u4f1a\u5f71\u54cd\u5957\u63a5\u5b57\u7684\u7684\u6027\u80fd</p> <ul> <li><code>SO_SNDBUF</code>\uff1aTCP \u53d1\u9001\u7f13\u51b2\u533a\u7684\u5bb9\u91cf\u4e0a\u9650\uff1b</li> <li><code>SO_RCVBUF</code>\uff1aTCP \u63a5\u53d7\u7f13\u51b2\u533a\u7684\u5bb9\u91cf\u4e0a\u9650\uff1b</li> <li>\u63a5\u6536\u7aef\u7f13\u51b2\u533a\uff0c\u7f13\u5b58\u4e86\u8fdc\u7aef\u53d1\u8fc7\u6765\u7684\u6570\u636e\u3002\u5982\u679c\u7f13\u51b2\u533a\u5df2\u6ee1\uff0c\u5c31\u4e0d\u80fd\u518d\u63a5\u6536\u65b0\u7684\u6570\u636e</li> <li>\u5199\u7f13\u51b2\u533a\uff0c\u7f13\u5b58\u4e86\u8981\u53d1\u51fa\u53bb\u7684\u6570\u636e\u3002\u5982\u679c\u5199\u7f13\u51b2\u533a\u5df2\u6ee1\uff0c\u5e94\u7528\u7a0b\u5e8f\u7684\u5199\u64cd\u4f5c\u5c31\u4f1a\u88ab\u963b\u585e</li> </ul> <p>proc \u76ee\u5f55\u4e0b\u7684 SOCKET \u7f13\u5b58\u53c2\u6570\u8def\u5f84\u4e3a\uff1a</p> <pre><code>/proc/sys/net/core/rmem_default\n/proc/sys/net/core/rmem_max\n/proc/sys/net/core/wmem_default\n/proc/sys/net/core/wmem_max\n</code></pre> <p>\u8c03\u5927\u7f13\u5b58\u7406\u8bba\u4e0a\u662f\u4f1a\u63d0\u5347 Socket \u4f20\u8f93\u901f\u7387\u7684\uff0c\u4f46\u662f\uff0c\u5e76\u4e0d\u662f\u603b\u662f\u8fd9\u6837\u3002\u7f13\u5b58\u662f\u4e00\u4e2a\u53ea\u6709\u5728\u53d1\u9001\u65b9\u548c\u63a5\u6536\u65b9\u7684\u6027\u80fd\u5dee\u5f02\u6bd4\u8f83\u5927\u65f6\u7f13\u5b58\u4f1a\u4ea7\u751f\u5f71\u54cd\u3002\u8fd8\u8981\u8865\u5145\u7684\u662f\uff0c\u5bf9\u4e8e TCP \u8fde\u63a5\u800c\u8a00\uff0c\u771f\u6b63\u7684\u4f20\u8f93\u8fc7\u7a0b\u662f\u4f9d\u8d56\u4e8e\u53d1\u9001\u65b9\u548c\u63a5\u6536\u65b9\u4e24\u65b9\u7684\u7a97\u53e3\u5927\u5c0f\u7684\uff0c\u56e0\u6b64\u5355\u5355\u8c03\u5927\u53d1\u9001\u65b9\u7f13\u5b58\u5e76\u4e0d\u4f1a\u5bf9\u6574\u4f53\u4ea7\u751f\u660e\u663e\u5f71\u54cd\u3002</p> <p>\u5728\u5927\u5ef6\u65f6\u7f51\u7edc\u4e0a\u7684\u5e26\u5bbd\u5229\u7528\u7387\u4f4e\uff0c\u4e3b\u8981\u539f\u56e0\u662f\u5ef6\u65f6\u53d8\u5927\u4e4b\u540e\uff0c\u53d1\u9001\u65b9\u53d1\u7684\u6570\u636e\u4e0d\u80fd\u53ca\u65f6\u5230\u8fbe\u63a5\u6536\u65b9\u3002\u5bfc\u81f4\u53d1\u9001\u7f13\u5b58\u6ee1\u4e4b\u540e\uff0c\u4e0d\u80fd\u518d\u6301\u7eed\u53d1\u9001\u6570\u636e\u3002\u63a5\u6536\u65b9\u5219\u56e0\u4e3a TCP \u901a\u544a\u7a97\u53e3\u53d7\u5230\u63a5\u6536\u65b9\u5269\u4f59\u7f13\u5b58\u5927\u5c0f\u7684\u5f71\u54cd\u3002\u63a5\u6536\u7f13\u5b58\u5c0f\u7684\u8bdd\uff0c\u5219\u4f1a\u901a\u544a\u5bf9\u65b9\u53d1\u9001\u7a97\u53e3\u53d8\u5c0f\u3002\u8fdb\u800c\u5f71\u54cd\u53d1\u9001\u65b9\u4e0d\u80fd\u4ee5\u5927\u7a97\u53e3\u53d1\u9001\u6570\u636e\u3002\u6240\u4ee5\uff0c\u8fd9\u91cc\u7684\u8c03\u4f18\u601d\u8def\u5e94\u8be5\u662f\uff0c\u53d1\u9001\u65b9\u8c03\u5927 tcp_wmem\uff0c\u63a5\u6536\u65b9\u8c03\u5927 tcp_rmem\u3002</p> <p>\u5982\u679c\u7f51\u7edc\u7684\u73af\u5883\u6bd4\u8f83\u5dee\uff0c\u5373\u4e22\u5305\u7387\u6bd4\u8f83\u9ad8\uff0c\u90a3\u4e48\u4f1a\u53d1\u73b0\u54ea\u6015\u8c03\u9ad8\u53d1\u9001\u548c\u63a5\u6536\u53cc\u65b9\u7684\u7f13\u5b58\u5927\u5c0f\uff0c\u4e5f\u65e0\u6cd5\u63d0\u5347\u6574\u4f53\u7684\u4f20\u8f93\u901f\u7387\uff0c\u4e3b\u8981\u539f\u56e0\u662f\u7531\u4e8e\u4e22\u5305\u6bd4\u8f83\u9ad8\uff0c\u56e0\u6b64\u7f51\u7edc\u6bd4\u8f83\u62e5\u585e\uff0c\u4f1a\u9891\u7e41\u5f15\u53d1\u6162\u542f\u52a8\uff0c\u4f7f\u5f97\u771f\u6b63\u7684\u7a97\u53e3\u74f6\u9888\u5e76\u4e0d\u5728\u4e8e\u7f13\u5b58\u7684\u5927\u5c0f\uff0c\u751a\u81f3\u4e00\u76f4\u96be\u4ee5\u5230\u8fbe\u4e00\u4e2a\u8f83\u5927\u7684\u503c\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u8003\u8651\u91c7\u7528\u4e0d\u540c\u7684\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\uff0cbbr \u7b97\u6cd5\u5bf9\u4e22\u5305\u4e0d\u654f\u611f\uff0c\u56e0\u6b64\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5982\u679c\u91c7\u7528 bbr \u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u5c06\u4f7f\u5f97\u6574\u4e2a\u7f51\u7edc\u6027\u80fd\u8f83\u9ad8\u3002\u5982\u679c\u7f51\u7edc\u7684\u4e22\u5305\u5f88\u5c11\u5ef6\u65f6\u5f88\u5927\uff0c\u90a3\u4e48\u8c03\u6574\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u4e5f\u4e0d\u4f1a\u7531\u660e\u663e\u63d0\u5347\uff0c\u6b64\u65f6\u4e3b\u8981\u74f6\u9888\u5c31\u662f\u7f13\u5b58\u3002</p> <p>\u4e3a\u4e86\u63d0\u9ad8\u7f51\u7edc\u7684\u541e\u5410\u91cf\uff0c\u901a\u5e38\u9700\u8981\u8c03\u6574\u8fd9\u4e9b\u7f13\u51b2\u533a\u7684\u5927\u5c0f\uff1a</p> <ul> <li>\u589e\u5927\u6bcf\u4e2a\u5957\u63a5\u5b57\u7684\u7f13\u51b2\u533a\u5927\u5c0f <code>net.core.optmem_max</code>\uff1b</li> <li>\u589e\u5927\u5957\u63a5\u5b57\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f <code>net.core.rmem_max</code> \u548c\u53d1\u9001\u7f13\u51b2\u533a\u5927\u5c0f <code>net.core.wmem_max</code>\uff1b</li> <li>\u589e\u5927 TCP \u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f <code>net.ipv4.tcp_rmem</code> \u548c\u53d1\u9001\u7f13\u51b2\u533a\u5927\u5c0f <code>net.ipv4.tcp_wmem</code></li> </ul>"},{"location":"chap6/15linux_network/#backlog","title":"backlog","text":"<p>TCP socket \u670d\u52a1\u7684 4 \u4e2a\u6b65\u9aa4 <code>socket-&gt;bind-&gt;listen-&gt;accept</code></p> <p>\u5728\u8c03\u7528 listen \u51fd\u6570\u65f6, \u6709\u4e00\u4e2a backlog \u53c2\u6570. \u5728 Linux \u4e2d backlog \u8868\u793a\u5df2\u5b8c\u6210 (ESTABLISHED) \u4e14\u672a accept \u7684\u961f\u5217\u5927\u5c0f.</p> <pre><code>int listen(int sockfd, int backlog);\n</code></pre> <p>TCP \u5efa\u7acb\u8fde\u63a5\u8fc7\u7a0b\uff1a\u670d\u52a1\u5668\u6536\u5230\u5ba2\u6237\u7aef SYN \u5305, \u53d1\u9001 SYN+ACK \u5305\u540e, \u5728\u5185\u5b58\u521b\u5efa\u4e00\u4e2a\u72b6\u6001\u4e3a SYN_RCVD \u7684\u8fde\u63a5, \u653e\u5165\u672a\u5b8c\u6210\u961f\u5217, \u8fd9\u4e2a\u961f\u5217\u7684\u5927\u5c0f\u53ef\u901a\u8fc7 <code>/ proc/sys/net/ipv4/tcp_max_syn_backlog</code> \u8bbe\u7f6e. \u670d\u52a1\u5668\u6536\u5230\u5ba2\u6237\u7aef\u7684 ACK \u5305\u540e, \u8be5\u8fde\u63a5\u7684\u72b6\u6001\u7531 SYN_RCVD \u6539\u4e3a <code>ESTABLISHED</code>, \u5e76\u79fb\u5230\u5df2\u5b8c\u6210\u961f\u5217.</p> <p>\u670d\u52a1\u5668\u7a0b\u5e8f\u8c03\u7528 accept \u540e, \u8be5\u8fde\u63a5\u79fb\u9664\u5df2\u5b8c\u6210\u961f\u5217, \u7531\u5185\u6838\u4ea4\u7ed9\u7a0b\u5e8f\u63a7\u5236.</p> <p>\uff08\u5728\u7b2c\u4e8c\u6b21\u63e1\u624b\u5b8c\u6210\u540e\u670d\u52a1\u5668\u5df2\u7ecf\u5c06\u8be5\u8fde\u63a5\u653e\u5165\u4e86\u534a\u8fde\u63a5\u961f\u5217\uff0c\u5f53\u7b2c\u4e09\u6b21\u63e1\u624b\u6210\u529f\u540e\u653e\u5165\u4e86\u5168\u8fde\u63a5\u961f\u5217\uff0c\u5f53 accept \u8fdb\u7a0b\u88ab\u8c03\u7528\u540e\uff0c\u8be5\u8fde\u63a5\u88ab\u8c03\u8d70\u7531\u5185\u6838\u7ba1\u7406\uff09</p> <p>backlog \u5c31\u662f\u6307\u5b9a\u5168\u8fde\u63a5\u961f\u5217\u7684\u5927\u5c0f\uff0c\u5982\u679c\u5168\u8fde\u63a5\u961f\u5217\u961f\u5217\u6ee1\u4e86\u5e76\u4e14 <code>tcp_abort_on_overflow</code> \u662f 0 \u7684\u8bdd\uff0cserver \u8fc7\u4e00\u6bb5\u65f6\u95f4\u518d\u6b21\u53d1\u9001 syn+ack \u7ed9 client\uff0c\u5982\u679c client \u8d85\u65f6\u7b49\u5f85\u6bd4\u8f83\u77ed\uff0c\u5c31\u4f1a\u5f88\u5bb9\u6613\u5bfc\u81f4\u5f02\u5e38\u3002(<code>tcp_abort_on_overflow</code>\u4e3a 0 \u8868\u793a\u5982\u679c\u4e09\u6b21\u63e1\u624b\u7b2c\u4e09\u6b65\u7684\u65f6\u5019\u5168\u8fde\u63a5\u961f\u5217\u6ee1\u4e86\u90a3\u4e48 server \u6254\u6389 client \u53d1\u8fc7\u6765\u7684 ack), \u56e0\u6b64\u5982\u679c backlog \u592a\u5c0f\u7684\u8bdd\u4f1a\u5bfc\u81f4\u5168\u8fde\u63a5\u961f\u5217\u5bb9\u6613\u6ee1\uff0c\u4ece\u800c TCP \u8fde\u63a5\u5efa\u7acb\u5931\u8d25\u3002</p> <p></p> <p>\u8bbe\u7f6e backlog \u540e\uff0c\u7cfb\u7edf\u4f1a\u548c <code>/ proc/sys/net/core/somaxconn</code> \u6bd4\u8f83\uff0c\u53d6\u8f83\u5c0f\u503c\u4f5c\u4e3a\u771f\u6b63\u7684 backlog</p> <p>\u5f53\u5df2\u8fde\u63a5\u961f\u5217\u6ee1\u540e\uff0c\u5982\u679c\u8bbe\u7f6e <code>tcp_abort_on_overflow</code> \u4e3a 0 \u8868\u793a\u5982\u679c\u4e09\u6b21\u63e1\u624b\u7b2c\u4e09\u6b65\u7684\u65f6\u5019\u5168\u8fde\u63a5\u961f\u5217\u6ee1\u4e86\u90a3\u4e48 server \u6254\u6389 client \u53d1\u8fc7\u6765\u7684 ack</p> <p>\u5f53\u534a\u8fde\u63a5\u961f\u5217\u6ee1\u540e\uff0c\u5982\u679c\u542f\u7528 <code>syncookies (net.ipv4.tcp_syncookies = 1)</code>, \u65b0\u7684\u8fde\u63a5\u4e0d\u8fdb\u5165\u672a\u5b8c\u6210\u961f\u5217, \u4e0d\u53d7\u5f71\u54cd. \u5426\u5219, \u670d\u52a1\u5668\u4e0d\u5728\u63a5\u53d7\u65b0\u7684\u8fde\u63a5.</p>"},{"location":"chap6/15linux_network/#syn-syn-flood-attack","title":"SYN \u6d2a\u6c34\u653b\u51fb (syn flood attack)","text":"<p>\u901a\u8fc7\u4f2a\u9020 IP \u5411\u670d\u52a1\u5668\u53d1\u9001 SYN \u5305, \u585e\u6ee1\u670d\u52a1\u5668\u7684\u672a\u5b8c\u6210\u961f\u5217, \u670d\u52a1\u5668\u53d1\u9001 SYN+ACK \u5305 \u6ca1\u56de\u590d, \u53cd\u590d SYN+ACK \u5305, \u4f7f\u670d\u52a1\u5668\u4e0d\u53ef\u7528. \u542f\u7528 syncookies \u662f\u7b80\u5355\u6709\u6548\u7684\u62b5\u5fa1\u63aa\u65bd. \u4ec5\u672a\u5b8c\u6210\u961f\u5217\u6ee1\u540e\u624d\u751f\u6548.</p> <p>SYN \u6d2a\u6c34\u653b\u51fb\u5bfc\u81f4\u88ab\u653b\u51fb\u670d\u52a1\u5668\u4fdd\u6301\u5927\u91cf <code>SYN_RECV</code>\u72b6\u6001\u7684 \u201c\u534a\u8fde\u63a5\u201d\uff0c\u5e76\u4e14\u4f1a\u91cd\u8bd5\u9ed8\u8ba4 5 \u6b21\u56de\u5e94\u7b2c\u4e8c\u4e2a\u63e1\u624b\u5305\uff0c\u585e\u6ee1 TCP \u7b49\u5f85\u8fde\u63a5\u961f\u5217\uff0c\u8d44\u6e90\u8017\u5c3d\uff08CPU \u6ee1\u8d1f\u8377\u6216\u5185\u5b58\u4e0d\u8db3\uff09\uff0c\u8ba9\u6b63\u5e38\u7684\u4e1a\u52a1\u8bf7\u6c42\u8fde\u63a5\u4e0d\u8fdb\u6765</p>"},{"location":"chap6/15linux_network/#_2","title":"\u6027\u80fd\u4f18\u5316\u601d\u8def","text":"<p>\u4ece\u7f51\u7edc I/O \u7684\u89d2\u5ea6\u6765\u8bf4\uff0c\u6709\u5982\u4e0b\u601d\u8def\uff1a</p> <ul> <li>I/O \u591a\u8def\u590d\u7528\u6280\u672f epoll\uff0c\u4e3b\u8981\u7528\u6765\u53d6\u4ee3 select \u548c poll</li> <li>\u5f02\u6b65 I/O \u6280\u672f\u3002\u5f02\u6b65 IO \u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u540c\u65f6\u53d1\u8d77\u5f88\u591a I/O \u64cd\u4f5c\uff0c\u800c\u4e0d\u7528\u7b49\u5f85\u8fd9\u4e9b\u64cd\u4f5c\u5b8c\u6210\uff0c\u7b49\u5230 I/O \u5b8c\u6210\u540e\uff0c\u7cfb\u7edf\u4f1a\u7528\u4e8b\u4ef6\u901a\u77e5\u7684\u65b9\u5f0f\uff0c\u544a\u8bc9\u5e94\u7528\u7a0b\u5e8f\u7ed3\u679c</li> </ul> <p>\u4ece\u8fdb\u7a0b\u7684\u5de5\u4f5c\u6a21\u578b\u6765\u8bf4\uff0c\u6709\u5982\u4e0b\u601d\u8def\uff1a</p> <ul> <li>\u4e3b\u8fdb\u7a0b + \u591a\u4e2a worker \u5b50\u8fdb\u7a0b\u3002\u5176\u4e2d\uff0c\u4e3b\u8fdb\u7a0b\u8d1f\u8d23\u7ba1\u7406\u7f51\u7edc\u8fde\u63a5\uff0c\u800c\u5b50\u8fdb\u7a0b\u8d1f\u8d23\u5b9e\u9645\u7684\u4e1a\u52a1\u5904\u7406</li> <li>\u76d1\u542c\u5230\u76f8\u540c\u7aef\u53e3\u7684\u591a\u8fdb\u7a0b\u6a21\u578b\uff0c\u5373\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u3002\u6240\u6709\u8fdb\u7a0b\u90fd\u4f1a\u76d1\u542c\u76f8\u540c\u63a5\u53e3\uff0c\u5e76\u4e14\u5f00\u542f <code>SO_REUSEPORT</code> \u9009\u9879\uff0c\u7531\u5185\u6838\u8d1f\u8d23\uff0c\u628a\u8bf7\u6c42\u8d1f\u8f7d\u5747\u8861\u5230\u8fd9\u4e9b\u76d1\u542c\u8fdb\u7a0b\u4e2d\u53bb</li> </ul> <p>\u5e94\u7528\u5c42\u7684\u7f51\u7edc\u534f\u8bae\u4f18\u5316\u601d\u8def\uff1a</p> <ul> <li>\u5728\u6bcf\u79d2\u8bf7\u6c42\u6b21\u6570\u8f83\u591a\u65f6\u5e76\u4e14\u8fde\u63a5\u901a\u5e38\u662f\u8fde\u7eed\u65f6\uff0c\u4f7f\u7528\u957f\u8fde\u63a5\u53d6\u4ee3\u77ed\u8fde\u63a5\uff0c\u53ef\u4ee5\u663e\u8457\u964d\u4f4e TCP \u5efa\u7acb\u8fde\u63a5\u7684\u6210\u672c</li> <li>\u4f7f\u7528\u5185\u5b58\u7b49\u65b9\u5f0f\uff0c\u6765\u7f13\u5b58\u4e0d\u5e38\u53d8\u5316\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u964d\u4f4e\u7f51\u7edc I/O \u6b21\u6570\uff0c\u540c\u65f6\u52a0\u5feb\u5e94\u7528\u7a0b\u5e8f\u7684\u54cd\u5e94\u901f\u5ea6</li> <li>\u4f7f\u7528 Protocol Buffer \u7b49\u5e8f\u5217\u5316\u7684\u65b9\u5f0f\uff0c\u538b\u7f29\u7f51\u7edc I/O \u7684\u6570\u636e\u91cf\uff0c\u53ef\u4ee5\u63d0\u9ad8\u5e94\u7528\u7a0b\u5e8f\u7684\u541e\u5410</li> <li>\u4f7f\u7528 DNS \u7f13\u5b58\u3001\u9884\u53d6\u3001HTTPDNS \u7b49\u65b9\u5f0f\uff0c\u51cf\u5c11 DNS \u89e3\u6790\u7684\u5ef6\u8fdf\uff0c\u4e5f\u53ef\u4ee5\u63d0\u5347\u7f51\u7edc I/O \u7684\u6574\u4f53\u901f\u5ea6</li> </ul>"},{"location":"chap6/1Linux_perf/","title":"L1 1min \u5185\u5bf9 Linux \u8fdb\u884c\u6027\u80fd\u8bca\u65ad","text":"<p>Netflix \u5728 AWS \u4e0a\u6709\u7740\u5927\u89c4\u6a21\u7684 EC2 \u96c6\u7fa4\uff0c\u4ee5\u53ca\u5404\u79cd\u5404\u6837\u7684\u6027\u80fd\u5206\u6790\u548c\u76d1\u63a7\u5de5\u5177\u3002\u6bd4\u5982\u6211\u4eec\u4f7f\u7528 Atlas \u6765\u76d1\u63a7\u6574\u4e2a\u5e73\u53f0\uff0c\u7528 Vector \u5b9e\u65f6\u5206\u6790 EC2 \u5b9e\u4f8b\u7684\u6027\u80fd\u3002\u8fd9\u4e9b\u5de5\u5177\u5df2\u7ecf\u80fd\u591f\u5e2e\u52a9\u6211\u4eec\u89e3\u51b3\u5927\u90e8\u5206\u7684\u95ee\u9898\uff0c\u4f46\u662f\u6709\u65f6\u5019\u6211\u4eec\u8fd8\u662f\u8981\u767b\u5f55\u8fdb\u673a\u5668\u5185\u90e8\uff0c\u7528\u4e00\u4e9b\u6807\u51c6\u7684 Linux \u6027\u80fd\u5206\u6790\u5de5\u5177\u6765\u5b9a\u4f4d\u95ee\u9898\u3002</p>"},{"location":"chap6/1Linux_perf/#1-60","title":"1\u3001\u6700\u5f00\u59cb\u7684 60 \u79d2","text":"<p>\u5728\u8fd9\u7bc7\u6587\u7ae0\u91cc\uff0cNetflix \u6027\u80fd\u5de5\u7a0b\u56e2\u961f\u4f1a\u4ecb\u7ecd\u4e00\u4e9b\u6211\u4eec\u4f7f\u7528\u7684\u6807\u51c6\u7684 Linux \u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5728\u53d1\u73b0\u95ee\u9898\u7684\u524d 60 \u79d2\u5185\u53bb\u5206\u6790\u548c\u5b9a\u4f4d\u95ee\u9898\u3002\u5728\u8fd9 60 \u79d2\u5185\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u8fd9 10 \u4e2a\u547d\u4ee4\u884c\u4e86\u89e3\u7cfb\u7edf\u6574\u4f53\u7684\u8fd0\u884c\u60c5\u51b5\uff0c\u4ee5\u53ca\u5f53\u524d\u8fd0\u884c\u7684\u8fdb\u7a0b\u5bf9\u8d44\u6e90\u7684\u4f7f\u7528\u60c5\u51b5\u3002</p> <p>\u5728\u8fd9\u4e9b\u6307\u6807\u91cc\u9762\uff0c\u6211\u4eec\u5148\u5173\u6ce8\u548c\u9519\u8bef\u3001\u4ee5\u53ca\u548c\u8d44\u6e90\u9971\u548c\u7387\u76f8\u5173\u7684\u6307\u6807\uff0c\u7136\u540e\u518d\u770b\u8d44\u6e90\u4f7f\u7528\u7387\u3002\u76f8\u5bf9\u6765\u8bb2\uff0c\u9519\u8bef\u548c\u8d44\u6e90\u9971\u548c\u7387\u6bd4\u8f83\u5bb9\u6613\u7406\u89e3\u3002\u9971\u548c\u7684\u610f\u601d\u662f\u6307\u4e00\u4e2a\u8d44\u6e90\uff08CPU\uff0c\u5185\u5b58\uff0c\u78c1\u76d8\uff09\u4e0a\u7684\u8d1f\u8f7d\u8d85\u8fc7\u4e86\u5b83\u80fd\u591f\u5904\u7406\u7684\u80fd\u529b\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u89c2\u5bdf\u5230\u7684\u73b0\u8c61\u5c31\u662f\u8bf7\u6c42\u961f\u5217\u5f00\u59cb\u5806\u79ef\uff0c\u6216\u8005\u8bf7\u6c42\u7b49\u5f85\u7684\u65f6\u95f4\u53d8\u957f\u3002</p> <pre><code>uptime\ndmesg | tail\nvmstat 1\nmpstat -P ALL 1\npidstat 1\niostat -xz 1\nfree -m\nsar -n DEV 1\nsar -n TCP,ETCP 1\ntop\n</code></pre> <p>\u6709\u4e9b\u547d\u4ee4\u884c\u4f9d\u8d56\u4e8e sysstat \u5305\u3002</p> <p>\u901a\u8fc7\u8fd9\u4e9b\u547d\u4ee4\u884c\u7684\u4f7f\u7528\uff0c\u4f60\u53ef\u4ee5\u719f\u6089\u4e00\u4e0b\u5206\u6790\u7cfb\u7edf\u6027\u80fd\u95ee\u9898\u65f6\u5e38\u7528\u7684\u4e00\u5957\u65b9\u6cd5\u6216\u8005\u6d41\u7a0b\uff1aUSE \u3002</p> <p>\u8fd9\u4e2a\u65b9\u6cd5\u4e3b\u8981\u4ece\u8d44\u6e90\u4f7f\u7528\u7387\uff08Utilization\uff09\u3001\u8d44\u6e90\u9971\u548c\u5ea6\uff08Satuation\uff09\u3001\u9519\u8bef\uff08Error\uff09\uff0c\u8fd9\u4e09\u4e2a\u65b9\u9762\u5bf9\u6240\u6709\u7684\u8d44\u6e90\u8fdb\u884c\u5206\u6790\uff08CPU\uff0c\u5185\u5b58\uff0c\u78c1\u76d8\u7b49\u7b49\uff09\u3002</p> <p>\u5728\u8fd9\u4e2a\u5206\u6790\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4e5f\u8981\u65f6\u523b\u6ce8\u610f\u6211\u4eec\u5df2\u7ecf\u6392\u9664\u8fc7\u7684\u8d44\u6e90\u95ee\u9898\uff0c\u4ee5\u4fbf\u7f29\u5c0f\u6211\u4eec\u5b9a\u4f4d\u7684\u8303\u56f4\uff0c\u7ed9\u4e0b\u4e00\u6b65\u7684\u5b9a\u4f4d\u63d0\u4f9b\u66f4\u660e\u786e\u7684\u65b9\u5411\u3002</p>"},{"location":"chap6/1Linux_perf/#1-uptime","title":"1. uptime","text":"<pre><code>$ uptime \n23:51:26 up 21:31, 1 user, load average: 30.02, 26.43, 19.02\n</code></pre> <p>\u8fd9\u4e2a\u547d\u4ee4\u80fd\u5f88\u5feb\u5730\u68c0\u67e5\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d\uff0c\u4f60\u53ef\u4ee5\u8ba4\u4e3a\u8fd9\u4e2a\u8d1f\u8f7d\u7684\u503c\u663e\u793a\u7684\u662f\u6709\u591a\u5c11\u4efb\u52a1\u5728\u7b49\u5f85\u8fd0\u884c\u3002\u5728 Linux \u7cfb\u7edf\u91cc\uff0c\u8fd9\u5305\u542b\u4e86\u60f3\u8981\u6216\u8005\u6b63\u5728\u4f7f\u7528 CPU \u7684\u4efb\u52a1\uff0c\u4ee5\u53ca\u5728 io \u4e0a\u88ab\u963b\u585e\u7684\u4efb\u52a1\u3002</p> <p>\u8fd9\u4e2a\u547d\u4ee4\u80fd\u4f7f\u6211\u4eec\u5bf9\u7cfb\u7edf\u7684\u5168\u5c40\u72b6\u6001\u6709\u4e00\u4e2a\u5927\u81f4\u7684\u4e86\u89e3\uff0c\u4f46\u662f\u6211\u4eec\u4f9d\u7136\u9700\u8981\u4f7f\u7528\u5176\u5b83\u5de5\u5177\u83b7\u53d6\u66f4\u591a\u7684\u4fe1\u606f\u3002</p> <p>\u8fd9\u4e09\u4e2a\u503c\u662f\u7cfb\u7edf\u8ba1\u7b97\u7684 1 \u5206\u949f\u30015 \u5206\u949f\u300115 \u5206\u949f\u7684\u6307\u6570\u52a0\u6743\u7684\u52a8\u6001\u5e73\u5747\u503c\uff0c\u53ef\u4ee5\u7b80\u5355\u5730\u8ba4\u4e3a\u5c31\u662f\u8fd9\u4e2a\u65f6\u95f4\u6bb5\u5185\u7684\u5e73\u5747\u503c\u3002\u6839\u636e\u8fd9\u4e09\u4e2a\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u4e86\u89e3\u7cfb\u7edf\u8d1f\u8f7d\u968f\u65f6\u95f4\u7684\u53d8\u5316\u3002</p> <p>\u6bd4\u5982\uff0c\u5047\u8bbe\u73b0\u5728\u7cfb\u7edf\u51fa\u4e86\u95ee\u9898\uff0c\u4f60\u53bb\u67e5\u770b\u8fd9\u4e09\u4e2a\u503c\uff0c\u53d1\u73b0 1 \u5206\u949f\u7684\u8d1f\u8f7d\u503c\u6bd4 15 \u5206\u949f\u7684\u8d1f\u8f7d\u503c\u8981\u5c0f\u5f88\u591a\uff0c\u90a3\u4e48\u4f60\u5f88\u6709\u53ef\u80fd\u5df2\u7ecf\u9519\u8fc7\u4e86\u7cfb\u7edf\u51fa\u95ee\u9898\u7684\u65f6\u95f4\u70b9\u3002</p> <p>\u5728\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u91cc\u9762\uff0c\u8d1f\u8f7d\u7684\u5e73\u5747\u503c\u663e\u793a 1 \u5206\u949f\u4e3a 30\uff0c\u6bd4 15 \u5206\u949f\u7684 19 \u76f8\u6bd4\u589e\u957f\u8f83\u591a\u3002\u6709\u5f88\u591a\u539f\u56e0\u4f1a\u5bfc\u81f4\u8d1f\u8f7d\u7684\u589e\u52a0\uff0c\u4e5f\u8bb8\u662f CPU \u4e0d\u591f\u7528\u4e86\uff1b</p> <p>vmstat \u6216\u8005 mpstat \u53ef\u4ee5\u8fdb\u4e00\u6b65\u786e\u8ba4\u95ee\u9898\u5728\u54ea\u91cc\u3002</p>"},{"location":"chap6/1Linux_perf/#2-dmesg-tail","title":"2. dmesg | tail","text":"<pre><code>$ dmesg | tail\n[1880957.563150] perl invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\n[...]\n[1880957.563400] Out of memory: Kill process 18694 (perl) score 246 or sacrifice child\n[1880957.563408] Killed process 18694 (perl) total-vm:1972392kB, anon-rss:1953348kB, file-rss:0kB\n[2320864.954447] TCP: Possible SYN flooding on port 7001. Dropping request.  Check SNMP counters.\n</code></pre> <p>\u8fd9\u4e2a\u547d\u4ee4\u663e\u793a\u4e86\u6700\u65b0\u7684\u51e0\u6761\u7cfb\u7edf\u65e5\u5fd7\u3002\u8fd9\u91cc\u6211\u4eec\u4e3b\u8981\u627e\u4e00\u4e0b\u6709\u6ca1\u6709\u4e00\u4e9b\u7cfb\u7edf\u9519\u8bef\u4f1a\u5bfc\u81f4\u6027\u80fd\u7684\u95ee\u9898\u3002</p> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u5305\u542b\u4e86 <code>oom-killer</code> \u4ee5\u53ca <code>TCP</code> \u4e22\u5305\u3002</p> <p>\u4e0d\u8981\u7565\u8fc7\u8fd9\u4e00\u6b65\uff01<code>dmesg</code> \u6c38\u8fdc\u503c\u5f97\u770b\u4e00\u770b\u3002</p>"},{"location":"chap6/1Linux_perf/#3-vmstat-1","title":"3. vmstat 1","text":"<pre><code>$ vmstat 1\nprocs ---------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n r  b swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n34  0    0 200889792  73708 591828    0    0     0     5    6   10 96  1  3  0  0\n32  0    0 200889920  73708 591860    0    0     0   592 13284 4282 98  1  1  0  0\n32  0    0 200890112  73708 591860    0    0     0     0 9501 2154 99  1  0  0  0\n32  0    0 200889568  73712 591856    0    0     0    48 11900 2459 99  0  0  0  0\n32  0    0 200890208  73712 591860    0    0     0     0 15898 4840 98  1  1  0  0\n^C\n</code></pre> <p>vmstat \u5c55\u793a\u4e86\u865a\u62df\u5185\u5b58\u3001CPU \u7684\u4e00\u4e9b\u60c5\u51b5\u3002</p> <p>\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u91cc\u547d\u4ee4\u884c\u7684 1 \u8868\u793a\u6bcf\u9694 1 \u79d2\u949f\u663e\u793a\u4e00\u6b21\u3002</p> <p>\u5728\u8fd9\u4e2a\u7248\u672c\u7684 vmstat \u91cc\uff0c\u7b2c\u4e00\u884c\u8868\u793a\u4e86\u8fd9\u4e00\u6b21\u542f\u52a8\u4ee5\u6765\u7684\u5404\u9879\u6307\u6807\uff0c\u6211\u4eec\u53ef\u4ee5\u6682\u65f6\u5ffd\u7565\u6389\u7b2c\u4e00\u884c\u3002</p> <p>\u9700\u8981\u67e5\u770b\u7684\u6307\u6807\uff1a</p> <ul> <li>r\uff1a\u5904\u5728 runnable \u72b6\u6001\u7684\u4efb\u52a1\uff0c\u5305\u62ec\u6b63\u5728\u8fd0\u884c\u7684\u4efb\u52a1\u548c\u7b49\u5f85\u8fd0\u884c\u7684\u4efb\u52a1\u3002\u8fd9\u4e2a\u503c\u6bd4\u5e73\u5747\u8d1f\u8f7d\u80fd\u66f4\u597d\u5730\u770b\u51fa CPU \u662f\u5426\u9971\u548c\u3002\u8fd9\u4e2a\u503c\u4e0d\u5305\u542b\u7b49\u5f85 io \u76f8\u5173\u7684\u4efb\u52a1\u3002\u5f53 r \u7684\u503c\u6bd4\u5f53\u524d CPU \u4e2a\u6570\u8981\u5927\u7684\u65f6\u5019\uff0c\u7cfb\u7edf\u5c31\u5904\u4e8e\u9971\u548c\u72b6\u6001\u4e86\u3002</li> <li>free\uff1a\u4ee5 KB \u8ba1\u7b97\u7684\u7a7a\u95f2\u5185\u5b58\u5927\u5c0f\u3002</li> <li>si\uff0cso\uff1a\u6362\u5165\u6362\u51fa\u7684\u5185\u5b58\u9875\u3002\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u975e\u96f6\uff0c\u8868\u793a\u5185\u5b58\u4e0d\u591f\u4e86\u3002</li> <li>us\uff0csy\uff0cid\uff0cwa\uff0cst\uff1aCPU \u65f6\u95f4\u7684\u5404\u9879\u6307\u6807\uff08\u5bf9\u6240\u6709 CPU \u53d6\u5747\u503c\uff09\uff0c\u5206\u522b\u8868\u793a\uff1a\u7528\u6237\u6001\u65f6\u95f4\uff0c\u5185\u6838\u6001\u65f6\u95f4\uff0c\u7a7a\u95f2\u65f6\u95f4\uff0c\u7b49\u5f85 io\uff0c\u5077\u53d6\u65f6\u95f4\uff08\u5728\u865a\u62df\u5316\u73af\u5883\u4e0b\u7cfb\u7edf\u5728\u5176\u5b83\u79df\u6237\u4e0a\u7684\u5f00\u9500\uff09</li> </ul> <p>\u628a\u7528\u6237\u6001 CPU \u65f6\u95f4\uff08us\uff09\u548c\u5185\u6838\u6001 CPU \u65f6\u95f4\uff08sy\uff09\u52a0\u8d77\u6765\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u4e00\u6b65\u786e\u8ba4 CPU \u662f\u5426\u7e41\u5fd9\u3002</p> <p>\u7b49\u5f85 IO \u7684\u65f6\u95f4 \uff08wa\uff09\u9ad8\u7684\u8bdd\uff0c\u8868\u793a\u78c1\u76d8\u662f\u74f6\u9888\uff1b</p> <p>\u6ce8\u610f\uff0c\u8fd9\u4e2a\u4e5f\u88ab\u5305\u542b\u5728\u7a7a\u95f2\u65f6\u95f4\u91cc\u9762\uff08id\uff09\uff0c CPU \u8fd9\u4e2a\u65f6\u5019\u4e5f\u662f\u7a7a\u95f2\u7684\uff0c\u4efb\u52a1\u6b64\u65f6\u963b\u585e\u5728\u78c1\u76d8 IO \u4e0a\u4e86\u3002\u4f60\u53ef\u4ee5\u628a\u7b49\u5f85 IO \u7684\u65f6\u95f4\uff08wa\uff09\u770b\u505a\u53e6\u4e00\u79cd\u5f62\u5f0f\u7684 CPU \u7a7a\u95f2\uff0c\u5b83\u53ef\u4ee5\u544a\u8bc9\u4f60 CPU \u4e3a\u4ec0\u4e48\u662f\u7a7a\u95f2\u7684\u3002</p> <p>\u7cfb\u7edf\u5904\u7406 IO \u7684\u65f6\u5019\uff0c\u80af\u5b9a\u662f\u4f1a\u6d88\u8017\u5185\u6838\u6001\u65f6\u95f4\uff08sy\uff09\u7684\u3002\u5982\u679c\u5185\u6838\u6001\u65f6\u95f4\u8f83\u591a\u7684\u8bdd\uff0c\u6bd4\u5982\u8d85\u8fc7 20%\uff0c\u6211\u4eec\u9700\u8981\u8fdb\u4e00\u6b65\u5206\u6790\uff0c\u4e5f\u8bb8\u5185\u6838\u5bf9 IO \u7684\u5904\u7406\u6548\u7387\u4e0d\u9ad8\u3002</p> <p>\u5728\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u91cc\uff0cCPU \u65f6\u95f4\u5927\u90e8\u5206\u90fd\u6d88\u8017\u5728\u4e86\u7528\u6237\u6001\uff0c\u8868\u660e\u4e3b\u8981\u662f\u5e94\u7528\u5c42\u7684\u4ee3\u7801\u5728\u4f7f\u7528 CPU\u3002CPU \u5229\u7528\u7387 \uff08us + sy\uff09\u4e5f\u8d85\u8fc7\u4e86 90%\uff0c\u8fd9\u4e0d\u4e00\u5b9a\u662f\u4e00\u4e2a\u95ee\u9898\uff1b</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 r \u548c CPU \u4e2a\u6570\u786e\u5b9a CPU \u7684\u9971\u548c\u5ea6\u3002</p>"},{"location":"chap6/1Linux_perf/#4-mpstat-p-all-1","title":"4. mpstat -P ALL 1","text":"<pre><code>$ mpstat -P ALL 1\nLinux 3.13.0-49-generic (titanclusters-xxxxx)  07/14/2015  _x86_64_ (32 CPU)\n\n07:38:49 PM  CPU   %usr  %nice   %sys %iowait   %irq  %soft  %steal  %guest  %gnice  %idle\n07:38:50 PM  all  98.47   0.00   0.75    0.00   0.00   0.00    0.00    0.00    0.00   0.78\n07:38:50 PM    0  96.04   0.00   2.97    0.00   0.00   0.00    0.00    0.00    0.00   0.99\n07:38:50 PM    1  97.00   0.00   1.00    0.00   0.00   0.00    0.00    0.00    0.00   2.00\n07:38:50 PM    2  98.00   0.00   1.00    0.00   0.00   0.00    0.00    0.00    0.00   1.00\n07:38:50 PM    3  96.97   0.00   0.00    0.00   0.00   0.00    0.00    0.00    0.00   3.03\n[...]\n</code></pre> <p>\u8fd9\u4e2a\u547d\u4ee4\u628a\u6bcf\u4e2a CPU \u7684\u65f6\u95f4\u90fd\u6253\u5370\u51fa\u6765\uff0c\u53ef\u4ee5\u770b\u770b CPU \u5bf9\u4efb\u52a1\u7684\u5904\u7406\u662f\u5426\u5747\u5300\u3002\u6bd4\u5982\uff0c\u5982\u679c\u67d0\u4e00\u5355\u4e2a CPU \u4f7f\u7528\u7387\u5f88\u9ad8\u7684\u8bdd\uff0c\u8bf4\u660e\u8fd9\u662f\u4e00\u4e2a\u5355\u7ebf\u7a0b\u5e94\u7528\u3002</p>"},{"location":"chap6/1Linux_perf/#5-pidstat-1","title":"5. pidstat 1","text":"<pre><code>$ pidstat 1\nLinux 3.13.0-49-generic (titanclusters-xxxxx)  07/14/2015    _x86_64_    (32 CPU)\n\n07:41:02 PM   UID       PID    %usr %system  %guest    %CPU   CPU  Command\n07:41:03 PM     0         9    0.00    0.94    0.00    0.94     1  rcuos/0\n07:41:03 PM     0      4214    5.66    5.66    0.00   11.32    15  mesos-slave\n07:41:03 PM     0      4354    0.94    0.94    0.00    1.89     8  java\n07:41:03 PM     0      6521 1596.23    1.89    0.00 1598.11    27  java\n07:41:03 PM     0      6564 1571.70    7.55    0.00 1579.25    28  java\n07:41:03 PM 60004     60154    0.94    4.72    0.00    5.66     9  pidstat\n\n07:41:03 PM   UID       PID    %usr %system  %guest    %CPU   CPU  Command\n07:41:04 PM     0      4214    6.00    2.00    0.00    8.00    15  mesos-slave\n07:41:04 PM     0      6521 1590.00    1.00    0.00 1591.00    27  java\n07:41:04 PM     0      6564 1573.00   10.00    0.00 1583.00    28  java\n07:41:04 PM   108      6718    1.00    0.00    0.00    1.00     0  snmp-pass\n07:41:04 PM 60004     60154    1.00    4.00    0.00    5.00     9  pidstat\n^C\n</code></pre> <p>pidstat \u548c top \u5f88\u50cf\uff0c\u4e0d\u540c\u7684\u662f\u5b83\u53ef\u4ee5\u6bcf\u9694\u4e00\u4e2a\u95f4\u9694\u6253\u5370\u4e00\u6b21\uff0c\u800c\u4e0d\u662f\u50cf top \u90a3\u6837\u6bcf\u6b21\u90fd\u6e05\u5c4f\u3002\u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u65b9\u4fbf\u5730\u67e5\u770b\u8fdb\u7a0b\u53ef\u80fd\u5b58\u5728\u7684\u884c\u4e3a\u6a21\u5f0f\uff0c\u4f60\u4e5f\u53ef\u4ee5\u76f4\u63a5 copy past\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5730\u8bb0\u5f55\u968f\u7740\u65f6\u95f4\u7684\u53d8\u5316\uff0c\u5404\u4e2a\u8fdb\u7a0b\u8fd0\u884c\u72b6\u51b5\u7684\u53d8\u5316\u3002</p> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u8bf4\u660e\u6709 2 \u4e2a Java \u8fdb\u7a0b\u6d88\u8017\u4e86\u5927\u91cf CPU\u3002\u8fd9\u91cc\u7684 %CPU \u8868\u660e\u7684\u662f\u5bf9\u6240\u6709 CPU \u7684\u503c\uff0c\u6bd4\u5982 1591% \u6807\u8bc6\u8fd9\u4e2a Java \u8fdb\u7a0b\u51e0\u4e4e\u6d88\u8017\u4e86 16 \u4e2a CPU\u3002</p>"},{"location":"chap6/1Linux_perf/#6-iostat-xz-1","title":"6. <code>iostat -xz 1</code>","text":"<pre><code>$ iostat -xz 1\nLinux 3.13.0-49-generic (titanclusters-xxxxx)  07/14/2015  x86_64 (32 CPU)\navg-cpu:  %user   %nice %system %iowait  %steal   %idle\n  73.96    0.00    3.73    0.03    0.06   22.21\nDevice:   rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util\nxvda        0.00     0.23    0.21    0.18     4.52     2.08    34.37     0.00    9.98   13.80    5.42   2.44   0.09\nxvdb        0.01     0.00    1.02    8.94   127.97   598.53   145.79     0.00    0.43    1.78    0.28   0.25   0.25\nxvdc        0.01     0.00    1.02    8.86   127.79   595.94   146.50     0.00    0.45    1.82    0.30   0.27   0.26\ndm-0        0.00     0.00    0.69    2.32    10.47    31.69    28.01     0.01    3.23    0.71    3.98   0.13   0.04\ndm-1        0.00     0.00    0.00    0.94     0.01     3.78     8.00     0.33  345.84    0.04  346.81   0.01   0.00\ndm-2        0.00     0.00    0.09    0.07     1.35     0.36    22.50     0.00    2.55    0.23    5.62   1.78   0.03...^C\n</code></pre> <p>iostat \u662f\u7406\u89e3\u5757\u8bbe\u5907\uff08\u78c1\u76d8\uff09\u7684\u5f53\u524d\u8d1f\u8f7d\u548c\u6027\u80fd\u7684\u91cd\u8981\u5de5\u5177\u3002\u51e0\u4e2a\u6307\u6807\u7684\u542b\u4e49\uff1a</p> <ul> <li><code>r/s\uff0cw/s\uff0crkB/s\uff0cwkB/s</code>\uff1a\u7cfb\u7edf\u53d1\u5f80\u8bbe\u5907\u7684\u6bcf\u79d2\u7684\u8bfb\u6b21\u6570\u3001\u6bcf\u79d2\u5199\u6b21\u6570\u3001\u6bcf\u79d2\u8bfb\u7684\u6570\u636e\u91cf\u3001\u6bcf\u79d2\u5199\u7684\u6570\u636e\u91cf\u3002\u8fd9\u51e0\u4e2a\u6307\u6807\u53cd\u6620\u7684\u662f\u7cfb\u7edf\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002\u7cfb\u7edf\u7684\u6027\u80fd\u95ee\u9898\u5f88\u6709\u53ef\u80fd\u5c31\u662f\u8d1f\u8f7d\u592a\u5927\u3002</li> <li><code>await</code>\uff1a\u7cfb\u7edf\u53d1\u5f80 IO \u8bbe\u5907\u7684\u8bf7\u6c42\u7684\u5e73\u5747\u54cd\u5e94\u65f6\u95f4\u3002\u8fd9\u5305\u62ec\u8bf7\u6c42\u6392\u961f\u7684\u65f6\u95f4\uff0c\u4ee5\u53ca\u8bf7\u6c42\u5904\u7406\u7684\u65f6\u95f4\u3002\u8d85\u8fc7\u7ecf\u9a8c\u503c\u7684\u5e73\u5747\u54cd\u5e94\u65f6\u95f4\u8868\u660e\u8bbe\u5907\u5904\u4e8e\u9971\u548c\u72b6\u6001\uff0c\u6216\u8005\u8bbe\u5907\u6709\u95ee\u9898\u3002</li> <li><code>avgqu-sz</code>\uff1a\u8bbe\u5907\u8bf7\u6c42\u961f\u5217\u7684\u5e73\u5747\u957f\u5ea6\u3002\u961f\u5217\u957f\u5ea6\u5927\u4e8e 1 \u8868\u793a\u8bbe\u5907\u5904\u4e8e\u9971\u548c\u72b6\u6001\u3002</li> <li><code>%util</code>\uff1a\u8bbe\u5907\u5229\u7528\u7387\u3002\u8bbe\u5907\u7e41\u5fd9\u7684\u7a0b\u5ea6\uff0c\u8868\u793a\u6bcf\u4e00\u79d2\u4e4b\u5185\uff0c\u8bbe\u5907\u5904\u7406 IO \u7684\u65f6\u95f4\u5360\u6bd4\u3002\u5927\u4e8e 60% \u7684\u5229\u7528\u7387\u901a\u5e38\u4f1a\u5bfc\u81f4\u6027\u80fd\u95ee\u9898\uff08\u53ef\u4ee5\u901a\u8fc7 await \u770b\u5230\uff09\uff0c\u4f46\u662f\u6bcf\u79cd\u8bbe\u5907\u4e5f\u4f1a\u6709\u6709\u6240\u4e0d\u540c\u3002\u63a5\u8fd1 100% \u7684\u5229\u7528\u7387\u8868\u660e\u78c1\u76d8\u5904\u4e8e\u9971\u548c\u72b6\u6001\u3002</li> </ul> <p>\u5982\u679c\u8fd9\u4e2a\u5757\u8bbe\u5907\u662f\u4e00\u4e2a\u903b\u8f91\u5757\u8bbe\u5907\uff0c\u8fd9\u4e2a\u903b\u8f91\u5feb\u8bbe\u5907\u540e\u9762\u6709\u5f88\u591a\u7269\u7406\u7684\u78c1\u76d8\u7684\u8bdd\uff0c100% \u5229\u7528\u7387\u53ea\u80fd\u8868\u660e\u6709\u4e9b IO \u7684\u5904\u7406\u65f6\u95f4\u8fbe\u5230\u4e86 100%\uff1b\u540e\u7aef\u7684\u7269\u7406\u78c1\u76d8\u53ef\u80fd\u8fdc\u8fdc\u6ca1\u6709\u8fbe\u5230\u9971\u548c\u72b6\u6001\uff0c\u53ef\u4ee5\u5904\u7406\u66f4\u591a\u7684\u8d1f\u8f7d\u3002</p> <p>\u8fd8\u6709\u4e00\u70b9\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8f83\u5dee\u7684\u78c1\u76d8 IO \u6027\u80fd\u5e76\u4e0d\u4e00\u5b9a\u610f\u5473\u7740\u5e94\u7528\u7a0b\u5e8f\u4f1a\u6709\u95ee\u9898\u3002\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u6709\u8bb8\u591a\u65b9\u6cd5\u6267\u884c\u5f02\u6b65 IO\uff0c\u800c\u4e0d\u4f1a\u963b\u585e\u5728 IO \u4e0a\u9762\uff1b\u5e94\u7528\u7a0b\u5e8f\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8bf8\u5982\u9884\u8bfb\u53d6\uff0c\u5199\u7f13\u51b2\u7b49\u6280\u672f\u964d\u4f4e IO \u5ef6\u8fdf\u5bf9\u81ea\u8eab\u7684\u5f71\u54cd\u3002</p>"},{"location":"chap6/1Linux_perf/#7-free-m","title":"<code>7. free -m</code>","text":"<pre><code>$ free -m\n             total       used       free     shared    buffers     cached\nMem:        245998      24545     221453         83         59        541\n-/+ buffers/cache:      23944     222053\nSwap:            0          0          0\n</code></pre> <p>\u53f3\u8fb9\u7684\u4e24\u5217\u663e\u5f0f\uff1a</p> <ul> <li>buffers\uff1a\u7528\u4e8e\u5757\u8bbe\u5907 I/O \u7684\u7f13\u51b2\u533a\u7f13\u5b58\u3002</li> <li>cached\uff1a\u7528\u4e8e\u6587\u4ef6\u7cfb\u7edf\u7684\u9875\u9762\u7f13\u5b58\u3002</li> </ul> <p>\u6211\u4eec\u53ea\u662f\u60f3\u8981\u68c0\u67e5\u8fd9\u4e9b\u4e0d\u63a5\u8fd1\u96f6\u7684\u5927\u5c0f\uff0c\u5176\u53ef\u80fd\u4f1a\u5bfc\u81f4\u66f4\u9ad8\u78c1\u76d8 I/O\uff08\u4f7f\u7528 iostat \u786e\u8ba4\uff09\uff0c\u548c\u66f4\u7cdf\u7cd5\u7684\u6027\u80fd\u3002\u4e0a\u9762\u7684\u4f8b\u5b50\u770b\u8d77\u6765\u8fd8\u4e0d\u9519\uff0c\u6bcf\u4e00\u5217\u5747\u6709\u5f88\u591a M \u4e2a\u5927\u5c0f\u3002</p> <p>\u6bd4\u8d77\u7b2c\u4e00\u884c\uff0c<code>-/+ buffers/cache</code>\u63d0\u4f9b\u7684\u5185\u5b58\u4f7f\u7528\u91cf\u4f1a\u66f4\u52a0\u51c6\u786e\u4e9b\u3002</p> <p>Linux \u4f1a\u628a\u6682\u65f6\u7528\u4e0d\u4e0a\u7684\u5185\u5b58\u7528\u4f5c\u7f13\u5b58\uff0c\u4e00\u65e6\u5e94\u7528\u9700\u8981\u7684\u65f6\u5019\u5c31\u7acb\u523b\u91cd\u65b0\u5206\u914d\u7ed9\u5b83\u3002\u6240\u4ee5\u90e8\u5206\u88ab\u7528\u4f5c\u7f13\u5b58\u7684\u5185\u5b58\u5176\u5b9e\u4e5f\u7b97\u662f\u7a7a\u95f2\u7684\u5185\u5b58\u3002\u4e3a\u4e86\u89e3\u91ca\u8fd9\u4e00\u70b9\uff0c \u751a\u81f3\u6709\u4eba\u4e13\u95e8\u5efa\u4e86\u4e2a\u7f51\u7ad9\uff1ahttp://www.linuxatemyram.com/\u3002</p> <p>\u5982\u679c\u4f7f\u7528 ZFS \u7684\u8bdd\uff0c\u53ef\u80fd\u4f1a\u6709\u70b9\u56f0\u60d1\u3002ZFS \u6709\u81ea\u5df1\u7684\u6587\u4ef6\u7cfb\u7edf\u7f13\u5b58\uff0c\u5728 free -m \u91cc\u9762\u770b\u4e0d\u5230\uff1b\u7cfb\u7edf\u770b\u8d77\u6765\u7a7a\u95f2\u5185\u5b58\u4e0d\u591a\u4e86\uff0c\u4f46\u662f\u6709\u53ef\u80fd ZFS \u6709\u5f88\u591a\u7684\u7f13\u5b58\u53ef\u7528\u3002</p>"},{"location":"chap6/1Linux_perf/#8-sar-n-dev-1","title":"8. <code>sar -n DEV 1</code>","text":"<pre><code>$ sar -n DEV 1\nLinux 3.13.0-49-generic (titanclusters-xxxxx)  07/14/2015     _x86_64_    (32 CPU)\n\n12:16:48 AM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s   %ifutil\n12:16:49 AM      eth0  18763.00   5032.00  20686.42    478.30      0.00      0.00      0.00      0.00\n12:16:49 AM        lo     14.00     14.00      1.36      1.36      0.00      0.00      0.00      0.00\n12:16:49 AM   docker0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n\n12:16:49 AM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s   %ifutil\n12:16:50 AM      eth0  19763.00   5101.00  21999.10    482.56      0.00      0.00      0.00      0.00\n12:16:50 AM        lo     20.00     20.00      3.25      3.25      0.00      0.00      0.00      0.00\n12:16:50 AM   docker0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n^C\n</code></pre> <p>\u8fd9\u4e2a\u5de5\u5177\u53ef\u4ee5\u67e5\u770b\u7f51\u7edc\u63a5\u53e3\u7684\u541e\u5410\u91cf\uff1a<code>rxkB/s</code> \u548c <code>txkB/s</code>\u53ef\u4ee5\u6d4b\u91cf\u8d1f\u8f7d\uff0c\u4e5f\u53ef\u4ee5\u770b\u662f\u5426\u8fbe\u5230\u7f51\u7edc\u6d41\u91cf\u9650\u5236\u4e86\u3002</p> <p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u91cc\uff0ceth0 \u7684\u541e\u5410\u91cf\u8fbe\u5230\u4e86\u5927\u7ea6 22 Mbytes/s\uff0c\u5dee\u4e0d\u591a 176 Mbits/sec \uff0c\u6bd4 1 Gbit/sec \u8fd8\u8981\u5c11\u5f88\u591a\u3002</p> <p>\u8fd9\u4e2a\u4f8b\u5b50\u91cc\u4e5f\u6709 <code>%ifutil</code>\u6807\u8bc6\u8bbe\u5907\u5229\u7528\u7387\uff0c\u6211\u4eec\u4e5f\u7528 Brenan \u7684 nicstat tool[1] \u6d4b\u91cf\u3002\u548c nicstat \u4e00\u6837\uff0c\u8fd9\u4e2a\u8bbe\u5907\u5229\u7528\u7387\u5f88\u96be\u6d4b\u91cf\u6b63\u786e\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u91cc\u597d\u50cf\u8fd9\u4e2a\u503c\u8fd8\u6709\u70b9\u95ee\u9898\u3002</p>"},{"location":"chap6/1Linux_perf/#9-sar-n-tcpetcp-1","title":"9. <code>sar -n TCP,ETCP 1</code>","text":"<pre><code>$ sar -n TCP,ETCP 1\nLinux 3.13.0-49-generic (titanclusters-xxxxx)  07/14/2015    _x86_64_    (32 CPU)\n\n12:17:19 AM  active/s passive/s    iseg/s    oseg/s\n12:17:20 AM      1.00      0.00  10233.00  18846.00\n\n12:17:19 AM  atmptf/s  estres/s retrans/s isegerr/s   orsts/s\n12:17:20 AM      0.00      0.00      0.00      0.00      0.00\n\n12:17:20 AM  active/s passive/s    iseg/s    oseg/s\n12:17:21 AM      1.00      0.00   8359.00   6039.00\n\n12:17:20 AM  atmptf/s  estres/s retrans/s isegerr/s   orsts/s\n12:17:21 AM      0.00      0.00      0.00      0.00      0.00\n^C\n</code></pre> <p>\u8fd9\u662f\u5bf9 TCP \u91cd\u8981\u6307\u6807\u7684\u4e00\u4e9b\u6982\u62ec\uff0c\u5305\u62ec\uff1a</p> <ul> <li><code>active/s</code>\uff1a\u6bcf\u79d2\u949f\u672c\u5730\u4e3b\u52a8\u5f00\u542f\u7684 TCP \u8fde\u63a5\uff0c\u4e5f\u5c31\u662f\u672c\u5730\u7a0b\u5e8f\u4f7f\u7528 connect() \u7cfb\u7edf\u8c03\u7528</li> <li><code>passive/s</code>\uff1a\u6bcf\u79d2\u949f\u4ece\u6e90\u7aef\u53d1\u8d77\u7684 TCP \u8fde\u63a5\uff0c\u4e5f\u5c31\u662f\u672c\u5730\u7a0b\u5e8f\u4f7f\u7528 accept() \u6240\u63a5\u53d7\u7684\u8fde\u63a5</li> <li><code>retrans/s</code>\uff1a\u6bcf\u79d2\u949f\u7684 TCP \u91cd\u4f20\u6b21\u6570</li> </ul> <p>atctive \u548c passive \u7684\u6570\u76ee\u901a\u5e38\u53ef\u4ee5\u7528\u6765\u8861\u91cf\u670d\u52a1\u5668\u7684\u8d1f\u8f7d\uff1a\u63a5\u53d7\u8fde\u63a5\u7684\u4e2a\u6570\uff08passive\uff09\uff0c\u4e0b\u6e38\u8fde\u63a5\u7684\u4e2a\u6570\uff08active\uff09\u3002\u53ef\u4ee5\u7b80\u5355\u8ba4\u4e3a active \u4e3a\u51fa\u4e3b\u673a\u7684\u8fde\u63a5\uff0cpassive \u4e3a\u5165\u4e3b\u673a\u7684\u8fde\u63a5\uff1b\u4f46\u8fd9\u4e2a\u4e0d\u662f\u5f88\u4e25\u683c\u7684\u8bf4\u6cd5\uff0c\u6bd4\u5982 loalhost \u548c localhost \u4e4b\u95f4\u7684\u8fde\u63a5\u3002</p> <p>\u91cd\u4f20\u8868\u793a\u7f51\u7edc\u6216\u8005\u670d\u52a1\u5668\u7684\u95ee\u9898\u3002\u4e5f\u8bb8\u662f\u7f51\u7edc\u4e0d\u7a33\u5b9a\u4e86\uff0c\u4e5f\u8bb8\u662f\u670d\u52a1\u5668\u8d1f\u8f7d\u8fc7\u91cd\u5f00\u59cb\u4e22\u5305\u4e86\u3002\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u8868\u793a\u6bcf\u79d2\u53ea\u6709 1 \u4e2a\u65b0\u8fde\u63a5\u5efa\u7acb\u3002</p>"},{"location":"chap6/1Linux_perf/#10-top","title":"10. top","text":"<pre><code>$ top\ntop - 00:15:40 up 21:56,  1 user,  load average: 31.09, 29.87, 29.92\nTasks: 871 total,   1 running, 868 sleeping,   0 stopped,   2 zombie\n%Cpu(s): 96.8 us,  0.4 sy,  0.0 ni,  2.7 id,  0.1 wa,  0.0 hi,  0.0 si,  0.0 st\nKiB Mem:  25190241+total, 24921688 used, 22698073+free,    60448 buffers\nKiB Swap:        0 total,        0 used,        0 free.   554208 cached Mem\n\n   PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND\n 20248 root      20   0  0.227t 0.012t  18748 S  3090  5.2  29812:58 java\n  4213 root      20   0 2722544  64640  44232 S  23.5  0.0 233:35.37 mesos-slave\n 66128 titancl+  20   0   24344   2332   1172 R   1.0  0.0   0:00.07 top\n  5235 root      20   0 38.227g 547004  49996 S   0.7  0.2   2:02.74 java\n  4299 root      20   0 20.015g 2.682g  16836 S   0.3  1.1  33:14.42 java\n     1 root      20   0   33620   2920   1496 S   0.0  0.0   0:03.82 init\n     2 root      20   0       0      0      0 S   0.0  0.0   0:00.02 kthreadd\n     3 root      20   0       0      0      0 S   0.0  0.0   0:05.35 ksoftirqd/0\n     5 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kworker/0:0H\n     6 root      20   0       0      0      0 S   0.0  0.0   0:06.94 kworker/u256:0\n     8 root      20   0       0      0      0 S   0.0  0.0   2:38.05 rcu_sched\n</code></pre> <p>top \u547d\u4ee4\u6db5\u76d6\u4e86\u6211\u4eec\u524d\u9762\u8bb2\u8ff0\u7684\u8bb8\u591a\u6307\u6807\u3002\u6211\u4eec\u53ef\u4ee5\u7528\u5b83\u6765\u770b\u548c\u6211\u4eec\u4e4b\u524d\u67e5\u770b\u7684\u7ed3\u679c\u6709\u6ca1\u6709\u5f88\u5927\u7684\u4e0d\u540c\uff0c\u5982\u679c\u6709\u7684\u8bdd\uff0c\u90a3\u8868\u793a\u7cfb\u7edf\u7684\u8d1f\u8f7d\u5728\u53d8\u5316\u3002</p> <p>top \u7684\u7f3a\u70b9\u5c31\u662f\u4f60\u5f88\u96be\u627e\u5230\u8fd9\u4e9b\u6307\u6807\u968f\u7740\u65f6\u95f4\u7684\u4e00\u4e9b\u884c\u4e3a\u6a21\u5f0f\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cvmstat \u6216\u8005 pidstat \u8fd9\u79cd\u53ef\u4ee5\u63d0\u4f9b\u6eda\u52a8\u8f93\u51fa\u7684\u547d\u4ee4\u662f\u66f4\u597d\u7684\u65b9\u5f0f\u3002\u5982\u679c\u4f60\u4e0d\u4ee5\u8db3\u591f\u5feb\u7684\u901f\u5ea6\u6682\u505c\u8f93\u51fa\uff08Ctrl-S \u6682\u505c\uff0cCtrl-Q \u7ee7\u7eed\uff09\uff0c\u4e00\u4e9b\u95f4\u6b47\u6027\u95ee\u9898\u7684\u7ebf\u7d22\u4e5f\u53ef\u80fd\u7531\u4e8e\u88ab\u6e05\u5c4f\u800c\u4e22\u5931\u3002</p>"},{"location":"chap6/2Linux_load_avg/","title":"L2 \u5f53\u9762\u8bd5\u5b98\u95ee\u4f60load average\u65f6\uff0c\u600e\u4e48\u56de\u7b54\uff1f","text":""},{"location":"chap6/2Linux_load_avg/#1load-average","title":"1\u3001\u4ec0\u4e48\u662fload average\uff1f","text":"<p>linux\u7cfb\u7edf\u4e2d\u7684Load \u662f\u5bf9\u5f53\u524dCPU\u5de5\u4f5c\u91cf\u7684\u5ea6\u91cf (WikiPedia: the system load is a measure of the amount of work that a computer system is doing)\u3002</p> <p>\u4e5f\u6709\u7b80\u5355\u7684\u8bf4\u662f\u8fdb\u7a0b\u961f\u5217\u7684\u957f\u5ea6\u3002</p> <p>Load Average \u5c31\u662f\u4e00\u6bb5\u65f6\u95f4 (1 \u5206\u949f\u30015\u5206\u949f\u300115\u5206\u949f) \u5185\u5e73\u5747 Load \u3002 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u547d\u4ee4\"w\" \u6216\u8005 \"uptime\" \u3001\"top\"\u7b49\u53ef\u67e5\u770b\u5f53\u524dload average\u60c5\u51b5</p> <p></p> <p>\u4e0a\u9762\u5185\u5bb9\u663e\u793a\u7cfb\u7edf\u8d1f\u8f7d\u4e3a\u201c6.68, 7.23, 5.66\u201d\uff0c\u8fd93\u4e2a\u503c\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f</p> <ul> <li>\u7b2c\u4e00\u4f4d6.68\uff1a\u8868\u793a\u6700\u8fd11\u5206\u949f\u5e73\u5747\u8d1f\u8f7d</li> <li>\u7b2c\u4e8c\u4f4d7.23\uff1a\u8868\u793a\u6700\u8fd15\u5206\u949f\u5e73\u5747\u8d1f\u8f7d</li> <li>\u7b2c\u4e09\u4f4d5.66\uff1a\u8868\u793a\u6700\u8fd115\u5206\u949f\u5e73\u5747\u8d1f\u8f7d</li> </ul> <p>linux\u7cfb\u7edf\u662f5\u79d2\u949f\u8fdb\u884c\u4e00\u6b21Load\u91c7\u6837</p>"},{"location":"chap6/2Linux_load_avg/#2load-average","title":"2\u3001load average\u503c\u7684\u542b\u4e49","text":""},{"location":"chap6/2Linux_load_avg/#2-1","title":"2-1 \u5355\u6838\u5904\u7406\u5668","text":"<p>\u5047\u8bbe\u6211\u4eec\u7684\u7cfb\u7edf\u662f\u5355CPU\u5355\u5185\u6838\u7684\uff0c\u628a\u5b83\u6bd4\u55bb\u6210\u662f\u4e00\u6761\u5355\u5411\u9a6c\u8def\uff0c\u628aCPU\u4efb\u52a1\u6bd4\u4f5c\u6c7d\u8f66\u3002\u5f53\u8f66\u4e0d\u591a\u7684\u65f6\u5019\uff0cload &lt;1\uff1b\u5f53\u8f66\u5360\u6ee1\u6574\u4e2a\u9a6c\u8def\u7684\u65f6\u5019 load=1\uff1b\u5f53\u9a6c\u8def\u90fd\u7ad9\u6ee1\u4e86\uff0c\u800c\u4e14\u9a6c\u8def\u5916\u8fd8\u5806\u6ee1\u4e86\u6c7d\u8f66\u7684\u65f6\u5019 load&gt;1</p> <p></p>"},{"location":"chap6/2Linux_load_avg/#2-2","title":"2-2 \u591a\u6838\u5904\u7406\u5668","text":"<p>\u6211\u4eec\u7ecf\u5e38\u4f1a\u53d1\u73b0\u670d\u52a1\u5668Load &gt; 1\u4f46\u662f\u8fd0\u884c\u4ecd\u7136\u4e0d\u9519\uff0c\u90a3\u662f\u56e0\u4e3a\u670d\u52a1\u5668\u662f\u591a\u6838\u5904\u7406\u5668\uff08Multi-core\uff09\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u670d\u52a1\u5668CPU\u662f2\u6838\uff0c\u90a3\u4e48\u5c06\u610f\u5473\u6211\u4eec\u62e5\u67092\u6761\u9a6c\u8def\uff0c\u6211\u4eec\u7684Load = 2\u65f6\uff0c\u6240\u6709\u9a6c\u8def\u90fd\u8dd1\u6ee1\u8f66\u8f86\u3002</p> <p></p> <p>\u67e5\u770bCPU core </p> <pre><code>grep 'model name' /proc/cpuinfo | wc -l\n</code></pre>"},{"location":"chap6/2Linux_load_avg/#3load-average","title":"3\u3001\u4ec0\u4e48\u6837\u7684Load average\u503c\u8981\u63d0\u9ad8\u8b66\u60d5","text":"<p>0.7 &lt; load &lt; 1: \u6b64\u65f6\u662f\u4e0d\u9519\u7684\u72b6\u6001\uff0c\u5982\u679c\u8fdb\u6765\u66f4\u591a\u7684\u6c7d\u8f66\uff0c\u4f60\u7684\u9a6c\u8def\u4ecd\u7136\u53ef\u4ee5\u5e94\u4ed8\u3002</p> <p>load = 1: \u4f60\u7684\u9a6c\u8def\u5373\u5c06\u62e5\u5835\uff0c\u800c\u4e14\u6ca1\u6709\u66f4\u591a\u7684\u8d44\u6e90\u989d\u5916\u7684\u4efb\u52a1\uff0c\u8d76\u7d27\u770b\u770b\u53d1\u751f\u4e86\u4ec0\u4e48\u5427\u3002</p> <p>load &gt; 5: \u975e\u5e38\u4e25\u91cd\u62e5\u5835\uff0c\u6211\u4eec\u7684\u9a6c\u8def\u975e\u5e38\u7e41\u5fd9\uff0c\u6bcf\u8f86\u8f66\u90fd\u65e0\u6cd5\u5f88\u5feb\u7684\u8fd0\u884c</p>"},{"location":"chap6/2Linux_load_avg/#4load","title":"4\u3001\u4e09\u79cdLoad\u503c\uff0c\u5e94\u8be5\u770b\u54ea\u4e2a\uff1f","text":"<p>\u901a\u5e38\u6211\u4eec\u5148\u770b15\u5206\u949fload\uff0c\u5982\u679cload\u5f88\u9ad8\uff0c\u518d\u770b1\u5206\u949f\u548c5\u5206\u949f\u8d1f\u8f7d\uff0c\u67e5\u770b\u662f\u5426\u6709\u4e0b\u964d\u8d8b\u52bf\u3002</p> <p>1\u5206\u949f\u8d1f\u8f7d\u503c &gt; 1\uff0c\u90a3\u4e48\u6211\u4eec\u4e0d\u7528\u62c5\u5fc3\uff0c\u4f46\u662f\u5982\u679c15\u5206\u949f\u8d1f\u8f7d\u90fd\u8d85\u8fc71\uff0c\u6211\u4eec\u8981\u8d76\u7d27\u770b\u770b\u53d1\u751f\u4e86\u4ec0\u4e48\u4e8b\u60c5\u3002\u6240\u4ee5\u6211\u4eec\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u67e5\u770b\u8fd9\u4e09\u4e2a\u503c\u3002</p>"},{"location":"chap6/3Linux_inode/","title":"L3 \u6587\u4ef6\u7cfb\u7edfinode","text":"<ul> <li>1.\u6587\u4ef6\u7cfb\u7edf\u5305\u62ec\u54ea\u4e9b\uff1f</li> <li>2.inode\u7684\u4f5c\u7528\u662f\u4ec0\u4e48\uff1f</li> <li>3.\u6247\u533a\u548c\u5757\u4ee5\u53cainode\u4e4b\u95f4\u662f\u600e\u6837\u7684\u5173\u7cfb\uff1f</li> </ul> <p>\u7b54\uff1a</p> <ol> <li>\u6587\u4ef6\u7cfb\u7edf\u5305\u542b\u5143\u6570\u636e\uff08\u7d22\u5f15\u6570\u636e\uff09\u4ee5\u53ca\u6570\u636e\u5185\u5bb9\uff08\u6570\u636e\u5757\uff09</li> <li>inode\u5373\u4e3a\u5143\u6570\u636e\uff0cinode\u8bb0\u5f55\u6570\u636e\u5757\u7684\u4f4d\u7f6e\u53ca\u7d22\u5f15\u4fe1\u606f\uff08\u6587\u4ef6\u5c5e\u6027\uff0cctime\uff0catime\uff0cmtime\u7b49\uff09</li> <li>.\u786c\u76d8\u662f\u7531\u76d8\u7247\u548c\u5b58\u50a8\u9762\u7ec4\u6210\uff0c\u6bcf\u4e2a\u76d8\u7247\u5305\u542b\u78c1\u9053\uff0c\u78c1\u76d8\u903b\u8f91\u4e0a\u5212\u5206\u4e3a\u6247\u533a\uff0c\u9ed8\u8ba4\u6247\u533a\u662f512\u4e2a\u5b57\u8282\uff0c\u6bcf8\u4e2a\u6247\u533a\u7ec4\u6210\u4e00\u4e2a\u5757\uff0c\u6587\u4ef6\u8bfb\u53d6\u7684\u6700\u5c0f\u5355\u4f4d\u662f\u5757\uff08\u9ed8\u8ba44K\uff09\uff0cinode\u8bb0\u5f55\u5757\u7684\u4f4d\u7f6e</li> </ol>"},{"location":"chap6/3Linux_inode/#1","title":"1\u3001 \u78c1\u76d8\u8bbe\u5907","text":"<p>\u78c1\u76d8\u8bbe\u5907\u662f\u4e00\u79cd\u76f8\u5f53\u590d\u6742\u7684\u673a\u7535\u8bbe\u5907\uff08\u6bd4\u8f83\u8be6\u7ec6\u7684\u4ecb\u7ecd\u53ef\u4ee5\u53c2\u8003blog\u786c\u76d8\u5185\u90e8\u786c\u4ef6\u7ed3\u6784\u548c\u5de5\u4f5c\u539f\u7406\u8be6\u89e3 \uff09\u3002</p> <p>\u78c1\u76d8\u8bbe\u5907\u53ef\u4ee5\u5305\u62ec\u4e00\u4e2a\u6216\u591a\u4e2a\u7269\u7406\u76d8\u7247\uff0c\u6bcf\u4e2a\u78c1\u76d8\u7247\u5206\u4e00\u4e2a\u6216\u4e24\u4e2a\u5b58\u50a8\u9762\uff08\u5982\u56fe\uff08a\uff09\u6240\u793a\uff09\u3002</p> <p>\u6bcf\u4e2a\u78c1\u76d8\u9762\u88ab\u7ec4\u7ec7\u6210\u82e5\u5e72\u4e2a\u540c\u5fc3\u73af\uff0c\u8fd9\u79cd\u73af\u79f0\u4e3a\u78c1\u9053track\uff0c\u5404\u78c1\u9053\u4e4b\u95f4\u7559\u6709\u5fc5\u8981\u7684\u95f4\u9699\u3002\u6bcf\u6761\u78c1\u9053\u53c8\u88ab\u903b\u8f91\u4e0a\u5212\u5206\u6210\u82e5\u5e72\u4e2a\u6247\u533asectors\u3002</p> <p>\u5728\u4e0d\u540c\u6247\u533a\u4e4b\u95f4\u53c8\u4fdd\u7559\u5fc5\u8981\u7684\u95f4\u9694, \u56fe\uff08b\uff09\u4e2d\u663e\u793a\u4e86\u663e\u793a\u4e86\u4e00\u4e2a\u67093\u4e2a\u78c1\u9053\uff0c\u6bcf\u4e2a\u78c1\u9053\u53c8\u88ab\u5206\u6210 8 \u4e2a\u6247\u533a\u7684\u78c1\u76d8\u7247\u7684\u4e00\u4e2a\u5b58\u50a8\u9762\u3002</p> <p></p> <p>\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u4fe1\u606f\u4e00\u822c\u4ee5\u6247\u533a(sectors)\u7684\u5f62\u5f0f\u5b58\u50a8\u5728\u786c\u76d8\u4e0a\uff0c\u800c\u6bcf\u4e2a\u6247\u533a\u5305\u62ec512\u4e2a\u5b57\u8282\u7684\u6570\u636e\u548c\u4e00\u4e9b\u5176\u4ed6\u4fe1\u606f\uff08\u5373\u4e00\u4e2a\u6247\u533a\u5305\u62ec\u4e24\u4e2a\u4e3b\u8981\u90e8\u5206\uff1a\u5b58\u50a8\u6570\u636e\u5730\u70b9\u7684\u6807\u8bc6\u7b26\u548c\u5b58\u50a8\u6570\u636e\u7684\u6570\u636e\u6bb5\uff09\u3002</p> <p>\u64cd\u4f5c\u7cfb\u7edf\u8bfb\u53d6\u786c\u76d8\u7684\u65f6\u5019\uff0c\u4e0d\u4f1a\u4e00\u4e2a\u4e2a\u6247\u533a\u5730\u8bfb\u53d6\uff0c\u8fd9\u6837\u6548\u7387\u592a\u4f4e\uff0c\u800c\u662f\u4e00\u6b21\u6027\u8fde\u7eed\u8bfb\u53d6\u591a\u4e2a\u6247\u533a\uff0c\u5373\u4e00\u6b21\u6027\u8bfb\u53d6\u4e00\u4e2a\u5757\uff08blocks\uff09\u3002</p> <p>\u8fd9\u79cd\u7531\u591a\u4e2a\u6247\u533a\u7ec4\u6210\u7684\u201d\u5757\u201d\uff0c\u662f\u6587\u4ef6\u5b58\u53d6\u7684\u6700\u5c0f\u5355\u4f4d\u3002\u201d\u5757\u201d\u7684\u5927\u5c0f\uff0c\u6700\u5e38\u89c1\u7684\u662f4KB\uff0c\u5373\u8fde\u7eed\u516b\u4e2a sectors\u7ec4\u6210\u4e00\u4e2a blocks\u3002</p>"},{"location":"chap6/3Linux_inode/#2inode","title":"2\u3001inode\u7684\u5185\u5bb9","text":"<p>\u65e2\u7136\u6587\u4ef6\u6570\u636e\u90fd\u50a8\u5b58\u5728\u201d\u5757\u201d\u4e2d\uff0c\u90a3\u4e48\u5bf9\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u800c\u8a00\uff0c\u5fc5\u987b\u91c7\u7528\u4e00\u79cd\u65b9\u5f0f\u6765\u627e\u5230\u8fd9\u4e2a\u5b58\u50a8\u6587\u4ef6\u6570\u636e\u7684\u201c\u5757\u201d\uff0c\u4e3a\u6b64\u64cd\u4f5c\u7cfb\u7edf\u4fbf\u5f15\u5165\u4e86\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u6982\u5ff5\u201dinode\u201d\uff0c\u4e2d\u6587\u540d\u4e3a\u201c\u7d22\u5f15\u7ed3\u70b9\u201d \u3002</p> <p>\u65e2\u7136\u5f15\u8fdbinode\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u627e\u5230\u201c\u5757\u201d\uff0c\u90a3\u4e48inode\u4e2d\u5fc5\u7136\u5305\u62ec\u50cf\u6587\u4ef6\u6570\u636eblock\u4f4d\u7f6e\u8fd9\u4e48\u91cd\u8981\u7684\u4fe1\u606f\uff0c\u5f53\u7136\u4e5f\u4e0d\u4ec5\u4ec5\u5305\u62ec\u8fd9\u4e48\u4e00\u4e2a\u4fe1\u606f\uff0c\u8fd8\u5305\u62ec\u6bd4\u5982\u6587\u4ef6\u7684\u521b\u5efa\u8005\u3001\u6587\u4ef6\u7684\u521b\u5efa\u65e5\u671f\u3001\u6587\u4ef6\u7684\u5927\u5c0f\u7b49\u7b49\u3002</p> <p>\u5177\u4f53\u53ef\u4ee5\u8f93\u5165stat\u6307\u4ee4\u67e5\u770b\u67d0\u4e2a\u6587\u4ef6\u7684inode\u4fe1\u606f\uff0c\u8fd9\u91cc\u4ee5<code>example.txt</code>\u4e3a\u4f8b\u3002</p> <pre><code>stat example.txt\n</code></pre> <p></p> <p>\u8fd9\u91cc\u4fbf\u53ef\u4ee5\u770b\u5230inode\u4fe1\u606f\u4e3b\u8981\u5305\u62ec\uff1a</p> <ul> <li>\u6587\u4ef6\u7684\u5b57\u8282\u6570\uff0c\u5757\u6570</li> <li>\u6587\u4ef6\u62e5\u6709\u8005\u7684User ID</li> <li>\u6587\u4ef6\u7684Group ID</li> <li>\u6587\u4ef6\u7684\u8bfb\u3001\u5199\u3001\u6267\u884c\u6743\u9650</li> <li>\u6587\u4ef6\u7684\u65f6\u95f4\u6233\uff0c\u5171\u6709\u4e09\u4e2a\uff1actime\u6307inode\u4e0a\u4e00\u6b21\u53d8\u52a8\u7684\u65f6\u95f4\uff0cmtime\u6307\u6587\u4ef6\u5185\u5bb9\u4e0a\u4e00\u6b21\u53d8\u52a8\u7684\u65f6\u95f4\uff0catime\u6307\u6587\u4ef6\u4e0a\u4e00\u6b21\u6253\u5f00\u7684\u65f6\u95f4\u3002</li> <li>\u94fe\u63a5\u6570\uff0c\u5373\u6709\u591a\u5c11\u6587\u4ef6\u540d\u6307\u5411\u8fd9\u4e2ainode</li> <li>\u6587\u4ef6\u6570\u636eblock\u7684\u4f4d\u7f6e</li> <li>inode\u7f16\u53f7</li> </ul>"},{"location":"chap6/3Linux_inode/#3inode","title":"3\u3001inode\u7684\u5927\u5c0f","text":"<p>\u524d\u9762\u5df2\u7ecf\u63d0\u5230inode\u4e2d\u5305\u62ec\u5173\u4e8e\u67d0\u4e2a\u6587\u4ef6\u7684\u7d22\u5f15\u4fe1\u606f\uff0c\u90a3\u4e48\u5176\u4e2d\u5fc5\u7136\u4f1a\u5b58\u50a8\u90e8\u5206\u6570\u636e\uff0c\u5728\u8ba1\u7b97\u673a\u4e2d\u5fc5\u7136\u4f1a\u5360\u636e\u4e00\u5b9a\u7684\u7a7a\u95f4\uff0c\u6240\u4ee5\u786c\u76d8\u683c\u5f0f\u5316\u7684\u65f6\u5019\uff0c\u64cd\u4f5c\u7cfb\u7edf\u81ea\u52a8\u5c06\u786c\u76d8\u5206\u6210\u4e24\u4e2a\u533a\u57df\u3002</p> <p>\u4e00\u4e2a\u662f\u6570\u636e\u533a\uff0c\u5b58\u653e\u6587\u4ef6\u6570\u636e\uff1b\u53e6\u4e00\u4e2a\u662finode\u533a\uff08inode table\uff09\uff0c\u5b58\u653einode\u6240\u5305\u542b\u7684\u4fe1\u606f\u3002</p> <p>\u6bcf\u4e2ainode\u8282\u70b9\u7684\u5927\u5c0f\uff0c\u4e00\u822c\u662f128\u5b57\u8282\u6216256\u5b57\u8282\u3002inode\u8282\u70b9\u7684\u603b\u6570\uff0c\u5728\u683c\u5f0f\u5316\u65f6\u5c31\u7ed9\u5b9a\uff0c\u4e00\u822c\u662f\u6bcf1KB\u6216\u6bcf2KB\u5c31\u8bbe\u7f6e\u4e00\u4e2ainode\u3002 </p> <p>\u5047\u5b9a\u5728\u4e00\u57571GB\u7684\u786c\u76d8\u4e2d\uff0c\u6bcf\u4e2ainode\u8282\u70b9\u7684\u5927\u5c0f\u4e3a128\u5b57\u8282\uff0c\u6bcf1KB\u5c31\u8bbe\u7f6e\u4e00\u4e2ainode\uff0c\u90a3\u4e48inode table\u7684\u5927\u5c0f\u5c31\u4f1a\u8fbe\u5230128MB\uff0c\u5360\u6574\u5757\u786c\u76d8\u768412.8%\u3002</p> <p>\u67e5\u770b\u6bcf\u4e2a\u786c\u76d8\u5206\u533a\u7684inode\u603b\u6570\u548c\u5df2\u7ecf\u4f7f\u7528\u7684\u6570\u91cf\uff0c\u53ef\u4ee5\u4f7f\u7528df\u547d\u4ee4\u67e5\u770b\u3002</p> <pre><code>df -i\n</code></pre> <p>\u67e5\u770b\u6bcf\u4e2ainode\u8282\u70b9\u7684\u5927\u5c0f\uff0c\u53ef\u4ee5\u7528\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>sudo dumpe2fs -h /dev/sda9 | grep \u201cInode size\u201d\n</code></pre> <p>\u7531\u4e8e\u6bcf\u4e2a\u6587\u4ef6\u90fd\u5fc5\u987b\u6709\u4e00\u4e2ainode\uff0c\u56e0\u6b64\u6709\u53ef\u80fd\u4f1a\u53d1\u751f\u78c1\u76d8\u7a7a\u95f4\u672a\u6ee1\u800cinode\u5df2\u7ecf\u7528\u5b8c\u5bfc\u81f4\u4e0d\u80fd\u5b58\u5165\u6587\u4ef6\u7684\u60c5\u51b5\u3002</p>"},{"location":"chap6/3Linux_inode/#4inode","title":"4\u3001inode\u7f16\u53f7","text":"<p>\u5728Unix/Linux\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u7cfb\u7edf\u5185\u90e8\u5e76\u4e0d\u91c7\u7528\u6587\u4ef6\u540d\u67e5\u627e\u6587\u4ef6\uff0c\u800c\u662f\u4f7f\u7528inode\u7f16\u53f7\u6765\u8bc6\u522b\u6587\u4ef6\u3002</p> <p>\u56e0\u6b64\u5bf9\u4e8e\u7cfb\u7edf\u6765\u8bf4\uff0c\u6587\u4ef6\u540d\u53ea\u662finode\u53f7\u7801\u4fbf\u4e8e\u8bc6\u522b\u7684\u522b\u79f0\u6216\u8005\u7ef0\u53f7\u3002\u800c\u7ad9\u5728\u7528\u6237\u89d2\u5ea6\uff0c\u7528\u6237\u901a\u8fc7\u6587\u4ef6\u540d\uff0c\u6253\u5f00\u6587\u4ef6\uff0c\u5b9e\u9645\u4e0a\uff0c\u7cfb\u7edf\u5185\u90e8\u662f\u83b7\u53d6inode\u4fe1\u606f\u627e\u5230\u6570\u636e\u5757\u7684\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u5206\u6210\u4e09\u6b65\uff1a</p> <ul> <li>\u9996\u5148\uff0c\u7cfb\u7edf\u627e\u5230\u8fd9\u4e2a\u6587\u4ef6\u540d\u5bf9\u5e94\u7684inode\u53f7\u7801\uff1b</li> <li>\u5176\u6b21\uff0c\u901a\u8fc7inode\u53f7\u7801\uff0c\u83b7\u53d6inode\u4fe1\u606f\uff1b</li> <li>\u6700\u540e\uff0c\u6839\u636einode\u4fe1\u606f\uff0c\u627e\u5230\u6587\u4ef6\u6570\u636e\u6240\u5728\u7684block\uff0c\u8bfb\u51fa\u6570\u636e\u3002</li> </ul> <p>\u6ce8\uff1a\u53ef\u4ee5\u4f7f\u7528<code>df -i</code>\u6216\u8005<code>ls -i</code>\u5747\u53ef\u4ee5\u67e5\u770b\u5230\u6587\u4ef6\u540d\u5bf9\u5e94\u7684inode\u53f7\u7801\u3002</p>"},{"location":"chap6/3Linux_inode/#5","title":"5\u3001\u76ee\u5f55\u6587\u4ef6","text":"<p>Unix/Linux\u7cfb\u7edf\u4e2d\uff0c\u76ee\u5f55\uff08directory\uff09\u4e5f\u662f\u4e00\u79cd\u6587\u4ef6\u3002\u6253\u5f00\u76ee\u5f55\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u6253\u5f00\u76ee\u5f55\u6587\u4ef6\u3002 </p> <p>\u76ee\u5f55\u6587\u4ef6\u7684\u7ed3\u6784\u975e\u5e38\u7b80\u5355\uff0c\u5c31\u662f\u4e00\u7cfb\u5217\u76ee\u5f55\u9879\uff08dirent\uff09\u7684\u5217\u8868\u3002\u6bcf\u4e2a\u76ee\u5f55\u9879\uff0c\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff1a\u6240\u5305\u542b\u6587\u4ef6\u7684\u6587\u4ef6\u540d\uff0c\u4ee5\u53ca\u8be5\u6587\u4ef6\u540d\u5bf9\u5e94\u7684inode\u53f7\u7801\u3002 </p> <p>\u5bf9\u4e8e\u76ee\u5f55\u6587\u4ef6\u800c\u8a00\uff0c\u5176\u8bfb\u6743\u9650\uff08r\uff09\u548c\u5199\u6743\u9650\uff08w\uff09\u5e76\u4e0d\u96be\u7406\u89e3\uff0c\u90fd\u662f\u9488\u5bf9\u76ee\u5f55\u6587\u4ef6\u672c\u8eab\u3002</p> <p>\u7531\u4e8e\u76ee\u5f55\u6587\u4ef6\u5185\u53ea\u6709\u6587\u4ef6\u540d\u548cinode\u53f7\u7801\uff0c\u6240\u4ee5\u5982\u679c\u53ea\u6709\u8bfb\u6743\u9650\uff0c\u53ea\u80fd\u83b7\u53d6\u6587\u4ef6\u540d\uff0c\u65e0\u6cd5\u83b7\u53d6\u5176\u4ed6\u4fe1\u606f\uff0c\u8fd9\u4e3b\u8981\u662f\u56e0\u4e3a\u5176\u4ed6\u4fe1\u606f\u90fd\u50a8\u5b58\u5728inode\u8282\u70b9\u4e2d\uff0c\u800c\u8bfb\u53d6inode\u8282\u70b9\u5185\u7684\u4fe1\u606f\u9700\u8981\u76ee\u5f55\u6587\u4ef6\u7684\u6267\u884c\u6743\u9650\uff08x\uff09\u3002</p>"},{"location":"chap6/3Linux_inode/#6","title":"6\u3001\u786c\u94fe\u63a5","text":"<p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u6587\u4ef6\u540d\u548cinode\u53f7\u7801\u662f\u201d\u4e00\u4e00\u5bf9\u5e94\u201d\u5173\u7cfb\uff0c\u6bcf\u4e2ainode\u53f7\u7801\u5bf9\u5e94\u4e00\u4e2a\u6587\u4ef6\u540d\u3002</p> <p>\u4f46\u662fUnix/Linux\u7cfb\u7edf\u5141\u8bb8\uff0c\u591a\u4e2a\u6587\u4ef6\u540d\u6307\u5411\u540c\u4e00\u4e2ainode\u53f7\u7801\u3002</p> <p>\u8fd9\u610f\u5473\u7740\uff0c\u53ef\u4ee5\u7528\u4e0d\u540c\u7684\u6587\u4ef6\u540d\u8bbf\u95ee\u540c\u6837\u7684\u5185\u5bb9\uff1b\u5bf9\u6587\u4ef6\u5185\u5bb9\u8fdb\u884c\u4fee\u6539\uff0c\u4f1a\u5f71\u54cd\u5230\u6240\u6709\u6587\u4ef6\u540d\uff1b\u4f46\u662f\uff0c\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u4e0d\u5f71\u54cd\u53e6\u4e00\u4e2a\u6587\u4ef6\u540d\u7684\u8bbf\u95ee\u3002\u8fd9\u79cd\u60c5\u51b5\u5c31\u88ab\u79f0\u4e3a\u201d\u786c\u94fe\u63a5\u201d\uff08hard link\uff09\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528ln\u6307\u4ee4\u6dfb\u52a0\u786c\u94fe\u63a5\u3002</p> <p></p> <p>\u8fd0\u884c\u4e0a\u9762\u8fd9\u6761\u547d\u4ee4\u4ee5\u540e\uff0c\u6e90\u6587\u4ef6\u4e0e\u76ee\u6807\u6587\u4ef6\u7684inode\u53f7\u7801\u76f8\u540c\uff0c\u90fd\u6307\u5411\u540c\u4e00\u4e2ainode\u3002</p> <p>inode\u4fe1\u606f\u4e2d\u6709\u4e00\u9879\u53eb\u505a\u201d\u94fe\u63a5\u6570\u201d\uff0c\u8bb0\u5f55\u6307\u5411\u8be5inode\u7684\u6587\u4ef6\u540d\u603b\u6570\uff0c\u8fd9\u65f6\u5c31\u4f1a\u589e\u52a01\u3002</p> <p>\u53cd\u8fc7\u6765\uff0c\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u5c31\u4f1a\u4f7f\u5f97inode\u8282\u70b9\u4e2d\u7684\u201d\u94fe\u63a5\u6570\u201d\u51cf1\u3002</p> <p>\u5f53\u8fd9\u4e2a\u503c\u51cf\u52300\uff0c\u8868\u660e\u6ca1\u6709\u6587\u4ef6\u540d\u6307\u5411\u8fd9\u4e2ainode\uff0c\u7cfb\u7edf\u5c31\u4f1a\u56de\u6536\u8fd9\u4e2ainode\u53f7\u7801\uff0c\u4ee5\u53ca\u5176\u6240\u5bf9\u5e94block\u533a\u57df\u3002 </p> <p>\u8fd9\u91cc\u987a\u4fbf\u8bf4\u4e00\u4e0b\u76ee\u5f55\u6587\u4ef6\u7684\u201d\u94fe\u63a5\u6570\u201d\u3002\u521b\u5efa\u76ee\u5f55\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u751f\u6210\u4e24\u4e2a\u76ee\u5f55\u9879\uff1a\u201d.\u201d\u548c\u201d..\u201d\u3002</p> <p>\u524d\u8005\u7684inode\u53f7\u7801\u5c31\u662f\u5f53\u524d\u76ee\u5f55\u7684inode\u53f7\u7801\uff0c\u7b49\u540c\u4e8e\u5f53\u524d\u76ee\u5f55\u7684\u201d\u786c\u94fe\u63a5\u201d\uff1b</p> <p>\u540e\u8005\u7684inode\u53f7\u7801\u5c31\u662f\u5f53\u524d\u76ee\u5f55\u7684\u7236\u76ee\u5f55\u7684inode\u53f7\u7801\uff0c\u7b49\u540c\u4e8e\u7236\u76ee\u5f55\u7684\u201d\u786c\u94fe\u63a5\u201d\u3002</p> <p>\u6240\u4ee5\uff0c\u4efb\u4f55\u4e00\u4e2a\u76ee\u5f55\u7684\u201d\u786c\u94fe\u63a5\u201d\u603b\u6570\uff0c\u603b\u662f\u7b49\u4e8e2\u52a0\u4e0a\u5b83\u7684\u5b50\u76ee\u5f55\u603b\u6570\uff08\u542b\u9690\u85cf\u76ee\u5f55\uff09\u3002</p>"},{"location":"chap6/3Linux_inode/#7","title":"7\u3001\u8f6f\u94fe\u63a5","text":"<p>\u9664\u4e86\u786c\u94fe\u63a5\u4ee5\u5916\uff0c\u8fd8\u6709\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\u3002 </p> <p>\u6587\u4ef6A\u548c\u6587\u4ef6B\u7684inode\u53f7\u7801\u867d\u7136\u4e0d\u4e00\u6837\uff0c\u4f46\u662f\u6587\u4ef6A\u7684\u5185\u5bb9\u662f\u6587\u4ef6B\u7684\u8def\u5f84\u3002</p> <p>\u8bfb\u53d6\u6587\u4ef6A\u65f6\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u5c06\u8bbf\u95ee\u8005\u5bfc\u5411\u6587\u4ef6B\u3002\u56e0\u6b64\uff0c\u65e0\u8bba\u6253\u5f00\u54ea\u4e00\u4e2a\u6587\u4ef6\uff0c\u6700\u7ec8\u8bfb\u53d6\u7684\u90fd\u662f\u6587\u4ef6B\u3002\u8fd9\u65f6\uff0c\u6587\u4ef6A\u5c31\u79f0\u4e3a\u6587\u4ef6B\u7684\u201d\u8f6f\u94fe\u63a5\u201d\uff08soft link\uff09\u6216\u8005\u201d\u7b26\u53f7\u94fe\u63a5\uff08symbolic link\uff09\u3002 </p> <p>\u8fd9\u610f\u5473\u7740\uff0c\u6587\u4ef6A\u4f9d\u8d56\u4e8e\u6587\u4ef6B\u800c\u5b58\u5728\uff0c\u5982\u679c\u5220\u9664\u4e86\u6587\u4ef6B\uff0c\u6253\u5f00\u6587\u4ef6A\u5c31\u4f1a\u62a5\u9519\uff1a\u201dNo such file or directory\u201d\u3002</p> <p>\u8fd9\u662f\u8f6f\u94fe\u63a5\u4e0e\u786c\u94fe\u63a5\u6700\u5927\u7684\u4e0d\u540c\uff1a\u6587\u4ef6A\u6307\u5411\u6587\u4ef6B\u7684\u6587\u4ef6\u540d\uff0c\u800c\u4e0d\u662f\u6587\u4ef6B\u7684inode\u53f7\u7801\uff0c\u6587\u4ef6B\u7684inode\u201d\u94fe\u63a5\u6570\u201d\u4e0d\u4f1a\u56e0\u6b64\u53d1\u751f\u53d8\u5316\u3002<code>ln -s</code>\u547d\u4ee4\u53ef\u4ee5\u521b\u5efa\u8f6f\u94fe\u63a5\u3002</p> <p></p>"},{"location":"chap6/3Linux_inode/#8inode","title":"8\u3001inode\u7684\u7279\u6b8a\u4f5c\u7528","text":"<p>\u7531\u4e8einode\u53f7\u7801\u4e0e\u6587\u4ef6\u540d\u5206\u79bb\uff0c\u8fd9\u79cd\u673a\u5236\u5bfc\u81f4\u4e86\u4e00\u4e9bUnix/Linux\u7cfb\u7edf\u7279\u6709\u7684\u73b0\u8c61\u3002</p> <ul> <li>\u6709\u65f6\uff0c\u6587\u4ef6\u540d\u5305\u542b\u7279\u6b8a\u5b57\u7b26\uff0c\u65e0\u6cd5\u6b63\u5e38\u5220\u9664\u3002\u8fd9\u65f6\uff0c\u76f4\u63a5\u5220\u9664inode\u8282\u70b9\uff0c\u5c31\u80fd\u8d77\u5230\u5220\u9664\u6587\u4ef6\u7684\u4f5c\u7528\u3002</li> <li>\u79fb\u52a8\u6587\u4ef6\u6216\u91cd\u547d\u540d\u6587\u4ef6\uff0c\u53ea\u662f\u6539\u53d8\u6587\u4ef6\u540d\uff0c\u4e0d\u5f71\u54cdinode\u53f7\u7801\u3002</li> <li>\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u4ee5\u540e\uff0c\u7cfb\u7edf\u5c31\u4ee5inode\u53f7\u7801\u6765\u8bc6\u522b\u8fd9\u4e2a\u6587\u4ef6\uff0c\u4e0d\u518d\u8003\u8651\u6587\u4ef6\u540d\u3002\u56e0\u6b64\uff0c\u901a\u5e38\u6765\u8bf4\uff0c\u7cfb\u7edf\u65e0\u6cd5\u4eceinode\u53f7\u7801\u5f97\u77e5\u6587\u4ef6\u540d\u3002</li> </ul> <p>\u6700\u540e\u4e00\u70b9\u4f7f\u5f97\u8f6f\u4ef6\u66f4\u65b0\u53d8\u5f97\u7b80\u5355\uff0c\u53ef\u4ee5\u5728\u4e0d\u5173\u95ed\u8f6f\u4ef6\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u66f4\u65b0\uff0c\u4e0d\u9700\u8981\u91cd\u542f\u3002\u56e0\u4e3a\u7cfb\u7edf\u901a\u8fc7inode\u53f7\u7801\uff0c\u8bc6\u522b\u8fd0\u884c\u4e2d\u7684\u6587\u4ef6\uff0c\u4e0d\u901a\u8fc7\u6587\u4ef6\u540d\u3002\u66f4\u65b0\u7684\u65f6\u5019\uff0c\u65b0\u7248\u6587\u4ef6\u4ee5\u540c\u6837\u7684\u6587\u4ef6\u540d\uff0c\u751f\u6210\u4e00\u4e2a\u65b0\u7684inode\uff0c\u4e0d\u4f1a\u5f71\u54cd\u5230\u8fd0\u884c\u4e2d\u7684\u6587\u4ef6\u3002\u7b49\u5230\u4e0b\u4e00\u6b21\u8fd0\u884c\u8fd9\u4e2a\u8f6f\u4ef6\u7684\u65f6\u5019\uff0c\u6587\u4ef6\u540d\u5c31\u81ea\u52a8\u6307\u5411\u65b0\u7248\u6587\u4ef6\uff0c\u65e7\u7248\u6587\u4ef6\u7684inode\u5219\u88ab\u56de\u6536\u3002</p>"},{"location":"chap6/4Linux_ops_int/","title":"L4 \u8fd0\u7ef4\u5fc5\u987b\u638c\u63e1\u7684Linux\u9762\u8bd5\u9898","text":""},{"location":"chap6/4Linux_ops_int/#1gplgnu","title":"1\u3001\u89e3\u91ca\u4e0b\u4ec0\u4e48\u662fGPL,GNU,\u81ea\u7531\u8f6f\u4ef6\uff1f","text":"<ul> <li>GPL\uff1a\uff08\u901a\u7528\u516c\u5171\u8bb8\u53ef\u8bc1\uff09\uff1a\u4e00\u79cd\u6388\u6743\uff0c\u4efb\u4f55\u4eba\u6709\u6743\u53d6\u5f97\u3001\u4fee\u6539\u3001\u91cd\u65b0\u53d1\u5e03\u81ea\u7531\u8f6f\u4ef6\u7684\u6743\u529b</li> <li>GNU:(\u9769\u5974\u8ba1\u5212)\uff1a\u76ee\u6807\u662f\u521b\u5efa\u4e00\u5957\u5b8c\u5168\u81ea\u7531\u3001\u5f00\u653e\u7684\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002</li> <li>\u81ea\u7531\u8f6f\u4ef6\uff1a\u662f\u4e00\u79cd\u53ef\u4ee5\u4e0d\u53d7\u9650\u5236\u5730\u81ea\u7531\u4f7f\u7528\u3001\u590d\u5236\u3001\u7814\u7a76\u3001\u4fee\u6539\u548c\u5206\u53d1\u7684\u8f6f\u4ef6\u3002\u4e3b\u8981\u8bb8\u53ef\u8bc1\u6709GPL\u548cBSD\u8bb8\u53ef\u8bc1\u4e24\u79cd</li> </ul>"},{"location":"chap6/4Linux_ops_int/#2linuxbuffercache","title":"2\u3001linux\u7cfb\u7edf\u91cc\uff0cbuffer\u548ccache\u5982\u4f55\u533a\u5206\uff1f","text":"<p>buffer\u548ccache\u90fd\u662f\u5185\u5b58\u4e2d\u7684\u4e00\u5757\u533a\u57df\uff0c</p> <ul> <li> <p>\u5f53CPU\u9700\u8981\u5199\u6570\u636e\u5230\u78c1\u76d8\u65f6\uff0c\u7531\u4e8e\u78c1\u76d8\u901f\u5ea6\u6bd4\u8f83\u6162\uff0c\u6240\u4ee5CPU\u5148\u628a\u6570\u636e\u5b58\u8fdbbuffer\uff0c</p> <ul> <li>\u7136\u540eCPU\u53bb\u6267\u884c\u5176\u4ed6\u4efb\u52a1\uff0cbuffer\u4e2d\u7684\u6570\u636e\u4f1a\u5b9a\u671f\u5199\u5165\u78c1\u76d8\uff1b</li> </ul> </li> <li> <p>\u5f53CPU\u9700\u8981\u4ece\u78c1\u76d8\u8bfb\u5165\u6570\u636e\u65f6\uff0c\u7531\u4e8e\u78c1\u76d8\u901f\u5ea6\u6bd4\u8f83\u6162\uff0c</p> <ul> <li>\u53ef\u4ee5\u628a\u5373\u5c06\u7528\u5230\u7684\u6570\u636e\u63d0\u524d\u5b58\u5165cache\uff0cCPU\u76f4\u63a5\u4eceCache\u4e2d\u62ff\u6570\u636e\u8981\u5feb\u7684\u591a\u3002</li> </ul> </li> </ul>"},{"location":"chap6/4Linux_ops_int/#3linux0-6","title":"3\u3001\u63cf\u8ff0Linux\u8fd0\u884c\u7ea7\u522b0-6\u7684\u5404\u81ea\u542b\u4e49","text":"<ul> <li>0\uff1a\u5173\u673a\u6a21\u5f0f</li> <li>1\uff1a\u5355\u7528\u6237\u6a21\u5f0f&lt;==\u7834\u89e3root\u5bc6\u7801</li> <li>2\uff1a\u65e0\u7f51\u7edc\u652f\u6301\u7684\u591a\u7528\u6237\u6a21\u5f0f</li> <li>3\uff1a\u6709\u7f51\u7edc\u652f\u6301\u7684\u591a\u7528\u6237\u6a21\u5f0f\uff08\u6587\u672c\u6a21\u5f0f\uff0c\u5de5\u4f5c\u4e2d\u6700\u5e38\u7528\u7684\u6a21\u5f0f\uff09</li> <li>4\uff1a\u4fdd\u7559\uff0c\u672a\u4f7f\u7528</li> <li>5\uff1a\u6709\u7f51\u7edc\u652f\u6301\u7684X-windows\u652f\u6301\u591a\u7528\u6237\u6a21\u5f0f\uff08\u684c\u9762\uff09</li> <li>6: \u91cd\u65b0\u5f15\u5bfc\u7cfb\u7edf\uff0c\u5373\u91cd\u542f</li> </ul>"},{"location":"chap6/4Linux_ops_int/#4linux","title":"4\u3001\u63cf\u8ff0Linux\u7cfb\u7edf\u4ece\u5f00\u673a\u5230\u767b\u9646\u754c\u9762\u7684\u542f\u52a8\u8fc7\u7a0b","text":"<ul> <li>\u2474\u5f00\u673aBIOS\u81ea\u68c0\uff0c\u52a0\u8f7d\u786c\u76d8\u3002</li> <li>\u2475\u8bfb\u53d6MBR,MBR\u5f15\u5bfc\u3002</li> <li>\u2476grub\u5f15\u5bfc\u83dc\u5355(Boot Loader)\u3002</li> <li>\u2477\u52a0\u8f7d\u5185\u6838kernel\u3002</li> <li>\u2478\u542f\u52a8init\u8fdb\u7a0b\uff0c\u4f9d\u636einittab\u6587\u4ef6\u8bbe\u5b9a\u8fd0\u884c\u7ea7\u522b</li> <li>\u2479init\u8fdb\u7a0b\uff0c\u6267\u884crc.sysinit\u6587\u4ef6\u3002</li> <li>\u247a\u542f\u52a8\u5185\u6838\u6a21\u5757\uff0c\u6267\u884c\u4e0d\u540c\u7ea7\u522b\u7684\u811a\u672c\u7a0b\u5e8f\u3002</li> <li>\u247b\u6267\u884c/etc/rc.d/rc.local</li> <li>\u247c\u542f\u52a8mingetty\uff0c\u8fdb\u5165\u7cfb\u7edf\u767b\u9646\u754c\u9762\u3002</li> </ul>"},{"location":"chap6/4Linux_ops_int/#5linux","title":"5\u3001\u63cf\u8ff0Linux\u4e0b\u8f6f\u94fe\u63a5\u548c\u786c\u94fe\u63a5\u7684\u533a\u522b","text":"<p>\u5728Linux\u7cfb\u7edf\u4e2d\uff0c\u94fe\u63a5\u5206\u4e3a\u4e24\u79cd\uff0c\u4e00\u79cd\u662f\u786c\u94fe\u63a5\uff08Hard link\uff09\uff0c\u53e6\u4e00\u79cd\u79f0\u4e3a\u7b26\u53f7\u94fe\u63a5\u6216\u8f6f\u94fe\u63a5\uff08Symbolic Link\uff09\u3002</p> <ul> <li>\u2460\u9ed8\u8ba4\u4e0d\u5e26\u53c2\u6570\u7684\u60c5\u51b5\u4e0b\uff0cln\u521b\u5efa\u7684\u662f\u786c\u94fe\u63a5\uff0c\u5e26-s\u53c2\u6570\u7684ln\u547d\u4ee4\u521b\u5efa\u7684\u662f\u8f6f\u94fe\u63a5\u3002</li> <li>\u2461\u786c\u94fe\u63a5\u6587\u4ef6\u4e0e\u6e90\u6587\u4ef6\u7684inode\u8282\u70b9\u53f7\u76f8\u540c\uff0c\u800c\u8f6f\u94fe\u63a5\u6587\u4ef6\u7684inode\u8282\u70b9\u53f7\uff0c\u4e0e\u6e90\u6587\u4ef6\u4e0d\u540c\uff0c</li> <li>\u2462ln\u547d\u4ee4\u4e0d\u80fd\u5bf9\u76ee\u5f55\u521b\u5efa\u786c\u94fe\u63a5\uff0c\u4f46\u53ef\u4ee5\u521b\u5efa\u8f6f\u94fe\u63a5\u3002\u5bf9\u76ee\u5f55\u7684\u8f6f\u94fe\u63a5\u4f1a\u7ecf\u5e38\u4f7f\u7528\u5230\u3002</li> <li>\u2463\u5220\u9664\u8f6f\u94fe\u63a5\u6587\u4ef6\uff0c\u5bf9\u6e90\u6587\u4ef6\u548c\u786c\u94fe\u63a5\u6587\u4ef6\u65e0\u4efb\u4f55\u5f71\u54cd\u3002</li> <li>\u2464\u5220\u9664\u6587\u4ef6\u7684\u786c\u94fe\u63a5\u6587\u4ef6\uff0c\u5bf9\u6e90\u6587\u4ef6\u53ca\u8f6f\u94fe\u63a5\u6587\u4ef6\u65e0\u4efb\u4f55\u5f71\u54cd\u3002</li> <li>\u2465\u5220\u9664\u94fe\u63a5\u6587\u4ef6\u7684\u6e90\u6587\u4ef6\uff0c\u5bf9\u786c\u94fe\u63a5\u6587\u4ef6\u65e0\u5f71\u54cd\uff0c\u4f1a\u5bfc\u81f4\u5176\u8f6f\u94fe\u63a5\u5931\u6548\uff08\u7ea2\u5e95\u767d\u5b57\u95ea\u70c1\u72b6\uff09\u3002</li> <li>\u2466\u540c\u65f6\u5220\u9664\u6e90\u6587\u4ef6\u53ca\u5176\u786c\u94fe\u63a5\u6587\u4ef6\uff0c\u6574\u4e2a\u6587\u4ef6\u624d\u4f1a\u88ab\u771f\u6b63\u7684\u5220\u9664\u3002</li> <li>\u2467\u5f88\u591a\u786c\u4ef6\u8bbe\u5907\u7684\u5feb\u7167\u529f\u80fd\uff0c\u4f7f\u7528\u7684\u5c31\u662f\u7c7b\u4f3c\u786c\u94fe\u63a5\u7684\u539f\u7406\u3002</li> <li>\u2468\u8f6f\u94fe\u63a5\u53ef\u4ee5\u8de8\u6587\u4ef6\u7cfb\u7edf\uff0c\u786c\u94fe\u63a5\u4e0d\u53ef\u4ee5\u8de8\u6587\u4ef6\u7cfb\u7edf\u3002</li> </ul>"},{"location":"chap6/4Linux_ops_int/#6shell","title":"6\u3001shell\u811a\u672c\u4e2d<code>\u201c$?\u201d</code>\u6807\u8bb0\u7684\u7528\u9014\u662f\u4ec0\u4e48?","text":"<p>\u5728\u5199\u4e00\u4e2ashell\u811a\u672c\u65f6\uff0c\u5982\u679c\u4f60\u60f3\u8981\u68c0\u67e5\u524d\u4e00\u547d\u4ee4\u662f\u5426\u6267\u884c\u6210\u529f\uff0c\u5728if\u6761\u4ef6\u4e2d\u4f7f\u7528<code>\u201c$?\u201d</code>\u53ef\u4ee5\u6765\u68c0\u67e5\u524d\u4e00\u547d\u4ee4\u7684\u7ed3\u675f\u72b6\u6001\u3002\u7b80\u5355\u7684\u4f8b\u5b50\u5982\u4e0b\uff1a</p> <pre><code>root@localhost:~# ls /usr/bin/\nroot@localhost:~# echo $?\n0\n\n\u5982\u679c\u7ed3\u675f\u72b6\u6001\u662f0\uff0c\u8bf4\u660e\u524d\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u6210\u529f\u3002\nroot@localhost:~# ls /usr/bin/share\nls: cannot access /usr/bin/share: No such file or directory\n\nroot@localhost:~# echo $?\n2\n\u5982\u679c\u7ed3\u675f\u72b6\u6001\u4e0d\u662f0\uff0c\u8bf4\u660e\u547d\u4ee4\u6267\u884c\u5931\u8d25\u3002\n</code></pre>"},{"location":"chap6/4Linux_ops_int/#7history","title":"7\u3001\u5982\u4f55\u8ba9history\u547d\u4ee4\u663e\u793a\u5177\u4f53\u65f6\u95f4\uff1f","text":"<pre><code>$ HISTTIMEFORMAT=\"%Y-%m-%d %H:%M:%S\"\n\n$ export HISTTIMEFORMAT\n\n\u91cd\u65b0\u5f00\u673a\u540e\u4f1a\u8fd8\u539f\uff0c\u53ef\u4ee5\u5199\uff0fetc\uff0fprofile\n</code></pre> <p>8\u3001\u7528shell\u7edf\u8ba1ip\u8bbf\u95ee\u60c5\u51b5\uff0c\u8981\u6c42\u5206\u6790nginx\u8bbf\u95ee\u65e5\u5fd7\uff0c\u627e\u51fa\u8bbf\u95ee\u9875\u9762\u6570\u91cf\u5728\u524d10\u4f4d\u7684IP\u6570\u3002\u4ee5\u4e0b\u662fnginx\u7684\u8bbf\u95ee\u65e5\u5fd7\u8282\u9009</p> <pre><code>202.101.129.218- - [26/Mar/2006:23:59:55 +0800] \"GET /online/stat_inst.php?pid=d065HTTP/1.1\" 302 20-\"-\" \"-\" \"Mozilla/4.0(compatible; MSIE 6.0; Windows NT 5.1)\"\n\n# \u8bf7\u5199shell\u5b9e\u73b0\u8f93\u51fatop10\u7684IP\u5217\u8868\u3002\n\n$ awk '{print $1}' access.log |sort|uniq -c |head -n 10\n\n31 202.101.129.218\n21 123.93.29.11\n11 13.92.19.31\n</code></pre>"},{"location":"chap6/4Linux_ops_int/#98080801000254","title":"9\u3001\u5c06\u672c\u5730\u768480\u7aef\u53e3\u7684\u8bf7\u6c42\u8f6c\u53d1\u52308080\u7aef\u53e3\uff0c\u672c\u673a\u5730\u574010.0.0.254\uff0c\u5199\u51fa\u547d\u4ee4","text":"<pre><code>$ iptables -t nat -A PREROUTING -d 10.0.0.254 -p tcp --dprot 80 -j DNAT --to-destination 10.0.0.254:8080\n</code></pre>"},{"location":"chap6/4Linux_ops_int/#10load","title":"10\u3001Load\u8fc7\u9ad8\u7684\u53ef\u80fd\u6027\u6709\u54ea\u4e9b\uff1f","text":""},{"location":"chap6/4Linux_ops_int/#10-1","title":"10-1 \u6392\u67e5\u601d\u8def","text":"<ul> <li> <ol> <li>\u9996\u5148\u6392\u67e5\u54ea\u4e9b\u8fdb\u7a0bcpu\u5360\u7528\u7387\u9ad8\u3002\u901a\u8fc7\u547d\u4ee4 ps aux</li> </ol> </li> <li>2\u3001\u5047\u5982\u901a\u8fc7\u7b2c\u4e00\u6b65\u770b\u5230\u4e00\u4e2aJAVA\u8fdb\u7a0b\u5360\u6709\u8d44\u6e90\u6bd4\u8f83\u9ad8\uff0c\u67e5\u770b\u5bf9\u5e94java\u8fdb\u7a0b\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u7684CPU\u5360\u7528\u7387\u3002\u901a\u8fc7\u547d\u4ee4\uff1a<code>ps -Lp 15047</code></li> <li>3\u3001\u8ffd\u8e2a\u7ebf\u7a0b\u5185\u90e8\uff0c\u67e5\u770bload\u8fc7\u9ad8\u539f\u56e0\u3002\u901a\u8fc7\u547d\u4ee4\uff1ajstack 15047</li> </ul> <p>\u6392\u67e5\u601d\u8def\uff1a 1. \u9996\u5148\u6392\u67e5\u54ea\u4e9b\u8fdb\u7a0bcpu\u5360\u7528\u7387\u9ad8\u3002\u901a\u8fc7\u547d\u4ee4 ps ux 2\u3001\u5047\u5982\u901a\u8fc7\u7b2c\u4e00\u6b65\u770b\u5230\u4e00\u4e2aJAVA\u8fdb\u7a0b\u5360\u6709\u8d44\u6e90\u6bd4\u8f83\u9ad8\uff0c\u67e5\u770b\u5bf9\u5e94java\u8fdb\u7a0b\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u7684CPU\u5360\u7528\u7387\u3002\u901a\u8fc7\u547d\u4ee4\uff1aps -Lp 15047 3\u3001\u8ffd\u8e2a\u7ebf\u7a0b\u5185\u90e8\uff0c\u67e5\u770bload\u8fc7\u9ad8\u539f\u56e0\u3002\u901a\u8fc7\u547d\u4ee4\uff1ajstack 15047</p>"},{"location":"chap6/4Linux_ops_int/#10-2","title":"10-2 \u5176\u4ed6\u7ecf\u9a8c\uff1a","text":"<p>cpu load\u7684\u98d9\u5347\uff0c\u4e00\u65b9\u9762\u53ef\u80fd\u548cfull gc\u7684\u6b21\u6570\u589e\u5927\u6709\u5173\uff0c\u4e00\u65b9\u9762\u53ef\u80fd\u548c\u6b7b\u5faa\u73af\u6709\u5173</p>"},{"location":"chap6/4Linux_ops_int/#11etcfstab","title":"11\u3001\u63cf\u8ff0<code>/etc/fstab</code> \u6587\u4ef6\u4e2d\u6bcf\u4e2a\u5b57\u6bb5\u7684\u542b\u4e49\uff1f","text":"<ul> <li>(1\uff09\u7b2c\u4e00\u5217\uff1a\u5c06\u88ab\u52a0\u8f7d\u7684\u6587\u4ef6\u7cfb\u7edf\u540d\uff1b</li> <li>\uff082\uff09\u7b2c\u4e8c\u5217\uff1a\u8be5\u6587\u4ef6\u7cfb\u7edf\u7684\u5b89\u88c5\u70b9\uff1b</li> <li>\uff083\uff09\u7b2c\u4e09\u5217\uff1a\u6587\u4ef6\u7cfb\u7edf\u7684\u7c7b\u578b\uff1b</li> <li>\uff084\uff09\u7b2c\u56db\u5217\uff1a\u8bbe\u7f6e\u53c2\u6570\uff1b</li> <li>\uff085\uff09\u7b2c\u4e94\u5217\uff1a\u4f9b\u5907\u4efd\u7a0b\u5e8f\u786e\u5b9a\u4e0a\u6b21\u5907\u4efd\u8ddd\u73b0\u5728\u7684\u5929\u6570\uff1b</li> <li>\uff086\uff09\u7b2c\u516d\u5217\uff1a\u5728\u7cfb\u7edf\u5f15\u5bfc\u65f6\u68c0\u6d4b\u6587\u4ef6\u7cfb\u7edf\u7684\u987a\u5e8f\u3002</li> </ul>"},{"location":"chap6/4Linux_ops_int/#12","title":"12\u3001 \u5982\u4f55\u5728\u6253\u5305\u65f6\u6392\u9664\u6307\u5b9a\u76ee\u5f55?","text":"<pre><code>$ tar --exclude=/home/dmtsai --exclude=*.tar -zcvf myfile.tar.gz /home/* /etc\n</code></pre>"},{"location":"chap6/4Linux_ops_int/#13","title":"13. \u600e\u4e48\u751f\u6210\u968f\u673a\u5bc6\u7801?","text":"<pre><code>mkpasswd -l 8  -C 2 -c 2 -d 4 -s 0\n</code></pre>"},{"location":"chap6/4Linux_ops_int/#14tcp","title":"14\u3001\u5982\u4f55\u7edf\u8ba1tcp\u72b6\u6001\uff1f","text":"<pre><code>netstat -an | grep '^tcp' | awk '{++s[$NF]} END{for(i in s) print i \"\\t\"s[i]}'\n</code></pre>"},{"location":"chap6/4Linux_ops_int/#15mysql-root","title":"15\u3001mysql \u5fd8\u8bb0 root \u5bc6\u7801\u600e\u4e48\u529e","text":"<pre><code>$ mysqld_safe --user=mysql --skip-grant-tables --skip-networking &amp; use mysql;\n\nmysql&gt; update user set password=password('123123') where user='root';\n</code></pre>"},{"location":"chap6/5Linux_network_int/","title":"L5 \u5e38\u89c1\u7f51\u7edc\u7f16\u7a0b\u9762\u8bd5\u9898","text":""},{"location":"chap6/5Linux_network_int/#_1","title":"\u7f51\u7edc\u534f\u8bae\u662f\u4ec0\u4e48\uff1f","text":"<p>\u5728\u8ba1\u7b97\u673a\u7f51\u7edc\u8981\u505a\u5230\u6709\u6761\u4e0d\u7d0a\u5730\u4ea4\u6362\u6570\u636e\uff0c\u5c31\u5fc5\u987b\u9075\u5b88\u4e00\u4e9b\u4e8b\u5148\u7ea6\u5b9a\u597d\u7684\u89c4\u5219\uff0c\u6bd4\u5982\u4ea4\u6362\u6570\u636e\u7684\u683c\u5f0f\u3001\u662f\u5426\u9700\u8981\u53d1\u9001\u4e00\u4e2a\u5e94\u7b54\u4fe1\u606f\u3002\u8fd9\u4e9b\u89c4\u5219\u88ab\u79f0\u4e3a\u7f51\u7edc\u534f\u8bae\u3002</p> <p>\u4e3a\u4ec0\u4e48\u8981\u5bf9\u7f51\u7edc\u534f\u8bae\u5206\u5c42\uff1f</p> <ul> <li>\u7b80\u5316\u95ee\u9898\u96be\u5ea6\u548c\u590d\u6742\u5ea6\u3002\u7531\u4e8e\u5404\u5c42\u4e4b\u95f4\u72ec\u7acb\uff0c\u6211\u4eec\u53ef\u4ee5\u5206\u5272\u5927\u95ee\u9898\u4e3a\u5c0f\u95ee\u9898\u3002</li> <li>\u7075\u6d3b\u6027\u597d\u3002\u5f53\u5176\u4e2d\u4e00\u5c42\u7684\u6280\u672f\u53d8\u5316\u65f6\uff0c\u53ea\u8981\u5c42\u95f4\u63a5\u53e3\u5173\u7cfb\u4fdd\u6301\u4e0d\u53d8\uff0c\u5176\u4ed6\u5c42\u4e0d\u53d7\u5f71\u54cd\u3002</li> <li>\u6613\u4e8e\u5b9e\u73b0\u548c\u7ef4\u62a4\u3002</li> <li>\u4fc3\u8fdb\u6807\u51c6\u5316\u5de5\u4f5c\u3002\u5206\u5f00\u540e\uff0c\u6bcf\u5c42\u529f\u80fd\u53ef\u4ee5\u76f8\u5bf9\u7b80\u5355\u5730\u88ab\u63cf\u8ff0\u3002</li> </ul> <p>\u7f51\u7edc\u534f\u8bae\u5206\u5c42\u7684\u7f3a\u70b9\uff1a\u529f\u80fd\u53ef\u80fd\u51fa\u73b0\u5728\u591a\u4e2a\u5c42\u91cc\uff0c\u4ea7\u751f\u4e86\u989d\u5916\u5f00\u9500\u3002</p> <p>\u4e3a\u4e86\u4f7f\u4e0d\u540c\u4f53\u7cfb\u7ed3\u6784\u7684\u8ba1\u7b97\u673a\u7f51\u7edc\u90fd\u80fd\u4e92\u8054\uff0c\u56fd\u9645\u6807\u51c6\u5316\u7ec4\u7ec7 ISO \u4e8e 1977 \u5e74\u63d0\u51fa\u4e86\u4e00\u4e2a\u8bd5\u56fe\u4f7f\u5404\u79cd\u8ba1\u7b97\u673a\u5728\u4e16\u754c\u8303\u56f4\u5185\u4e92\u8054\u6210\u7f51\u7684\u6807\u51c6\u6846\u67b6\uff0c\u5373\u8457\u540d\u7684\u5f00\u653e\u7cfb\u7edf\u4e92\u8054\u57fa\u672c\u53c2\u8003\u6a21\u578b OSI/RM\uff0c\u7b80\u79f0\u4e3a OSI\u3002</p> <p>OSI \u7684\u4e03\u5c42\u534f\u8bae\u4f53\u7cfb\u7ed3\u6784\u7684\u6982\u5ff5\u6e05\u695a\uff0c\u7406\u8bba\u4e5f\u8f83\u5b8c\u6574\uff0c\u4f46\u5b83\u65e2\u590d\u6742\u53c8\u4e0d\u5b9e\u7528\uff0cTCP/IP \u4f53\u7cfb\u7ed3\u6784\u5219\u4e0d\u540c\uff0c\u4f46\u5b83\u73b0\u5728\u5374\u5f97\u5230\u4e86\u975e\u5e38\u5e7f\u6cdb\u7684\u5e94\u7528\u3002</p> <p>TCP/IP \u662f\u4e00\u4e2a\u56db\u5c42\u4f53\u7cfb\u7ed3\u6784\uff0c\u5b83\u5305\u542b\u5e94\u7528\u5c42\uff0c\u8fd0\u8f93\u5c42\uff0c\u7f51\u9645\u5c42\u548c\u7f51\u7edc\u63a5\u53e3\u5c42\uff08\u7528\u7f51\u9645\u5c42\u8fd9\u4e2a\u540d\u5b57\u662f\u5f3a\u8c03\u8fd9\u4e00\u5c42\u662f\u4e3a\u4e86\u89e3\u51b3\u4e0d\u540c\u7f51\u7edc\u7684\u4e92\u8fde\u95ee\u9898\uff09\uff0c\u4e0d\u8fc7\u4ece\u5b9e\u8d28\u4e0a\u8bb2\uff0cTCP/IP \u53ea\u6709\u6700\u4e0a\u9762\u7684\u4e09\u5c42\uff0c\u56e0\u4e3a\u6700\u4e0b\u9762\u7684\u7f51\u7edc\u63a5\u53e3\u5c42\u5e76\u6ca1\u6709\u4ec0\u4e48\u5177\u4f53\u5185\u5bb9\uff0c\u56e0\u6b64\u5728\u5b66\u4e60\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u539f\u7406\u65f6\u5f80\u5f80\u91c7\u7528\u6298\u4e2d\u7684\u529e\u6cd5\uff0c\u5373\u7efc\u5408 OSI \u548c TCP/IP \u7684\u4f18\u70b9\uff0c\u91c7\u7528\u4e00\u79cd\u53ea\u6709\u4e94\u5c42\u534f\u8bae\u7684\u4f53\u7cfb\u7ed3\u6784\uff0c\u8fd9\u6837\u65e2\u7b80\u6d01\u53c8\u80fd\u5c06\u6982\u5ff5\u9610\u8ff0\u6e05\u695a\uff0c\u6709\u65f6\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4e5f\u53ef\u628a\u6700\u5e95\u4e0b\u4e24\u5c42\u79f0\u4e3a\u7f51\u7edc\u63a5\u53e3\u5c42\u3002</p> <p>\u56db\u5c42\u534f\u8bae\uff0c\u4e94\u5c42\u534f\u8bae\u548c\u4e03\u5c42\u534f\u8bae\u7684\u5173\u7cfb\u5982\u4e0b\uff1a</p> <ul> <li>TCP/IP\u662f\u4e00\u4e2a\u56db\u5c42\u7684\u4f53\u7cfb\u7ed3\u6784\uff0c\u4e3b\u8981\u5305\u62ec\uff1a\u5e94\u7528\u5c42\u3001\u8fd0\u8f93\u5c42\u3001\u7f51\u9645\u5c42\u548c\u7f51\u7edc\u63a5\u53e3\u5c42\u3002</li> <li>\u4e94\u5c42\u534f\u8bae\u7684\u4f53\u7cfb\u7ed3\u6784\u4e3b\u8981\u5305\u62ec\uff1a\u5e94\u7528\u5c42\u3001\u8fd0\u8f93\u5c42\u3001\u7f51\u7edc\u5c42\uff0c\u6570\u636e\u94fe\u8def\u5c42\u548c\u7269\u7406\u5c42\u3002</li> <li>OSI\u4e03\u5c42\u534f\u8bae\u6a21\u578b\u4e3b\u8981\u5305\u62ec\u662f\uff1a\u5e94\u7528\u5c42\uff08Application\uff09\u3001\u8868\u793a\u5c42\uff08Presentation\uff09\u3001\u4f1a\u8bdd\u5c42\uff08Session\uff09\u3001\u8fd0\u8f93\u5c42\uff08Transport\uff09\u3001\u7f51\u7edc\u5c42\uff08Network\uff09\u3001\u6570\u636e\u94fe\u8def\u5c42\uff08Data Link\uff09\u3001\u7269\u7406\u5c42\uff08Physical\uff09\u3002</li> </ul> <p></p> <p>\u6ce8\uff1a\u4e94\u5c42\u534f\u8bae\u7684\u4f53\u7cfb\u7ed3\u6784\u53ea\u662f\u4e3a\u4e86\u4ecb\u7ecd\u7f51\u7edc\u539f\u7406\u800c\u8bbe\u8ba1\u7684\uff0c\u5b9e\u9645\u5e94\u7528\u8fd8\u662f TCP/IP \u56db\u5c42\u4f53\u7cfb\u7ed3\u6784\u3002</p>"},{"location":"chap6/5Linux_network_int/#1tcpip","title":"1\u3001TCP/IP \u534f\u8bae\u65cf","text":""},{"location":"chap6/5Linux_network_int/#1-1","title":"1-1 \u5e94\u7528\u5c42","text":"<p>\u5e94\u7528\u5c42\uff08application-layer\uff09\u7684\u4efb\u52a1\u662f\u901a\u8fc7\u5e94\u7528\u8fdb\u7a0b\u95f4\u7684\u4ea4\u4e92\u6765\u5b8c\u6210\u7279\u5b9a\u7f51\u7edc\u5e94\u7528\u3002\u5e94\u7528\u5c42\u534f\u8bae\u5b9a\u4e49\u7684\u662f\u5e94\u7528\u8fdb\u7a0b\uff08\u8fdb\u7a0b\uff1a\u4e3b\u673a\u4e2d\u6b63\u5728\u8fd0\u884c\u7684\u7a0b\u5e8f\uff09\u95f4\u7684\u901a\u4fe1\u548c\u4ea4\u4e92\u7684\u89c4\u5219\u3002</p> <p>\u5bf9\u4e8e\u4e0d\u540c\u7684\u7f51\u7edc\u5e94\u7528\u9700\u8981\u4e0d\u540c\u7684\u5e94\u7528\u5c42\u534f\u8bae\u3002\u5728\u4e92\u8054\u7f51\u4e2d\u5e94\u7528\u5c42\u534f\u8bae\u5f88\u591a\uff0c\u5982\u57df\u540d\u7cfb\u7edf DNS\uff0c\u652f\u6301\u4e07\u7ef4\u7f51\u5e94\u7528\u7684 HTTP \u534f\u8bae\uff0c\u652f\u6301\u7535\u5b50\u90ae\u4ef6\u7684 SMTP \u534f\u8bae\u7b49\u7b49\u3002</p>"},{"location":"chap6/5Linux_network_int/#1-2","title":"1-2 \u8fd0\u8f93\u5c42","text":"<p>\u8fd0\u8f93\u5c42\uff08transport layer\uff09\u7684\u4e3b\u8981\u4efb\u52a1\u5c31\u662f\u8d1f\u8d23\u5411\u4e24\u53f0\u4e3b\u673a\u8fdb\u7a0b\u4e4b\u95f4\u7684\u901a\u4fe1\u63d0\u4f9b\u901a\u7528\u7684\u6570\u636e\u4f20\u8f93\u670d\u52a1\u3002\u5e94\u7528\u8fdb\u7a0b\u5229\u7528\u8be5\u670d\u52a1\u4f20\u9001\u5e94\u7528\u5c42\u62a5\u6587\u3002</p> <p>\u8fd0\u8f93\u5c42\u4e3b\u8981\u4f7f\u7528\u4e00\u4e0b\u4e24\u79cd\u534f\u8bae\uff1a</p> <ul> <li>\u4f20\u8f93\u63a7\u5236\u534f\u8bae-TCP\uff1a\u63d0\u4f9b\u9762\u5411\u8fde\u63a5\u7684\uff0c\u53ef\u9760\u7684\u6570\u636e\u4f20\u8f93\u670d\u52a1\u3002</li> <li>\u7528\u6237\u6570\u636e\u534f\u8bae-UDP\uff1a\u63d0\u4f9b\u65e0\u8fde\u63a5\u7684\uff0c\u5c3d\u6700\u5927\u52aa\u529b\u7684\u6570\u636e\u4f20\u8f93\u670d\u52a1\uff08\u4e0d\u4fdd\u8bc1\u6570\u636e\u4f20\u8f93\u7684\u53ef\u9760\u6027\uff09\u3002</li> </ul> <p></p> <p>\u6bcf\u4e00\u4e2a\u5e94\u7528\u5c42\uff08TCP/IP \u53c2\u8003\u6a21\u578b\u7684\u6700\u9ad8\u5c42\uff09\u534f\u8bae\u4e00\u822c\u90fd\u4f1a\u4f7f\u7528\u5230\u4e24\u4e2a\u4f20\u8f93\u5c42\u534f\u8bae\u4e4b\u4e00\u3002</p> <p>\u8fd0\u884c\u5728 TCP \u534f\u8bae\u4e0a\u7684\u534f\u8bae\uff1a</p> <ul> <li>HTTP\uff08Hypertext Transfer Protocol\uff0c\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\uff09\uff0c\u4e3b\u8981\u7528\u4e8e\u666e\u901a\u6d4f\u89c8\u3002</li> <li>HTTPS\uff08HTTP over SSL\uff0c\u5b89\u5168\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\uff09\uff0cHTTP \u534f\u8bae\u7684\u5b89\u5168\u7248\u672c\u3002</li> <li>FTP\uff08File Transfer Protocol\uff0c\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff09\uff0c\u7528\u4e8e\u6587\u4ef6\u4f20\u8f93\u3002</li> <li>POP3\uff08Post Office Protocol\uff0cversion 3\uff0c\u90ae\u5c40\u534f\u8bae\uff09\uff0c\u6536\u90ae\u4ef6\u7528\u3002</li> <li>SMTP\uff08Simple Mail Transfer Protocol\uff0c\u7b80\u5355\u90ae\u4ef6\u4f20\u8f93\u534f\u8bae\uff09\uff0c\u7528\u6765\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u3002</li> <li>TELNET\uff08Teletype over the Network\uff0c\u7f51\u7edc\u7535\u4f20\uff09\uff0c\u901a\u8fc7\u4e00\u4e2a\u7ec8\u7aef\uff08terminal\uff09\u767b\u9646\u5230\u7f51\u7edc\u3002</li> <li>SSH\uff08Secure Shell\uff0c\u7528\u4e8e\u66ff\u4ee3\u5b89\u5168\u6027\u5dee\u7684 TELNET\uff09\uff0c\u7528\u4e8e\u52a0\u5bc6\u5b89\u5168\u767b\u9646\u7528\u3002</li> </ul> <p>\u8fd0\u884c\u5728UDP\u534f\u8bae\u4e0a\u7684\u534f\u8bae\uff1a</p> <ul> <li>BOOTP\uff08Boot Protocol\uff0c\u542f\u52a8\u534f\u8bae\uff09\uff0c\u5e94\u7528\u4e8e\u65e0\u76d8\u8bbe\u5907\u3002</li> <li>NTP\uff08Network Time Protocol\uff0c\u7f51\u7edc\u65f6\u95f4\u534f\u8bae\uff09\uff0c\u7528\u4e8e\u7f51\u7edc\u540c\u6b65\u3002</li> <li>DHCP\uff08Dynamic Host Configuration Protocol\uff0c\u52a8\u6001\u4e3b\u673a\u914d\u7f6e\u534f\u8bae\uff09\uff0c\u52a8\u6001\u914d\u7f6eIP\u5730\u5740\u3002</li> </ul> <p>\u8fd0\u884c\u5728TCP\u548cUDP\u534f\u8bae\u4e0a\uff1a</p> <ul> <li>DNS\uff08Domain Name Service\uff0c\u57df\u540d\u670d\u52a1\uff09\uff0c\u7528\u4e8e\u5b8c\u6210\u5730\u5740\u67e5\u627e\uff0c\u90ae\u4ef6\u8f6c\u53d1\u7b49\u5de5\u4f5c\u3002</li> </ul>"},{"location":"chap6/5Linux_network_int/#1-3","title":"1-3 \u7f51\u7edc\u5c42","text":"<p>\u7f51\u7edc\u5c42\u7684\u4efb\u52a1\u5c31\u662f\u9009\u62e9\u5408\u9002\u7684\u7f51\u95f4\u8def\u7531\u548c\u4ea4\u6362\u7ed3\u70b9\uff0c\u786e\u4fdd\u8ba1\u7b97\u673a\u901a\u4fe1\u7684\u6570\u636e\u53ca\u65f6\u4f20\u9001\u3002\u5728\u53d1\u9001\u6570\u636e\u65f6\uff0c\u7f51\u7edc\u5c42\u628a\u8fd0\u8f93\u5c42\u4ea7\u751f\u7684\u62a5\u6587\u6bb5\u6216\u7528\u6237\u6570\u636e\u62a5\u5c01\u88c5\u6210\u5206\u7ec4\u548c\u5305\u8fdb\u884c\u4f20\u9001\u3002\u5728 TCP/IP \u4f53\u7cfb\u7ed3\u6784\u4e2d\uff0c\u7531\u4e8e\u7f51\u7edc\u5c42\u4f7f\u7528 IP \u534f\u8bae\uff0c\u56e0\u6b64\u5206\u7ec4\u4e5f\u53eb IP \u6570\u636e\u62a5 \uff0c\u7b80\u79f0\u6570\u636e\u62a5\u3002</p> <p>\u4e92\u8054\u7f51\u662f\u7531\u5927\u91cf\u7684\u5f02\u6784\uff08heterogeneous\uff09\u7f51\u7edc\u901a\u8fc7\u8def\u7531\u5668\uff08router\uff09\u76f8\u4e92\u8fde\u63a5\u8d77\u6765\u7684\u3002\u4e92\u8054\u7f51\u4f7f\u7528\u7684\u7f51\u7edc\u5c42\u534f\u8bae\u662f\u65e0\u8fde\u63a5\u7684\u7f51\u9645\u534f\u8bae\uff08Intert Prococol\uff09\u548c\u8bb8\u591a\u8def\u7531\u9009\u62e9\u534f\u8bae\uff0c\u56e0\u6b64\u4e92\u8054\u7f51\u7684\u7f51\u7edc\u5c42\u4e5f\u53eb\u505a\u7f51\u9645\u5c42\u6216 IP \u5c42\u3002</p>"},{"location":"chap6/5Linux_network_int/#1-4","title":"1-4 \u6570\u636e\u94fe\u8def\u5c42","text":"<p>\u6570\u636e\u94fe\u8def\u5c42\uff08data link layer\uff09\u901a\u5e38\u7b80\u79f0\u4e3a\u94fe\u8def\u5c42\u3002\u4e24\u53f0\u4e3b\u673a\u4e4b\u95f4\u7684\u6570\u636e\u4f20\u8f93\uff0c\u603b\u662f\u5728\u4e00\u6bb5\u4e00\u6bb5\u7684\u94fe\u8def\u4e0a\u4f20\u9001\u7684\uff0c\u8fd9\u5c31\u9700\u8981\u4f7f\u7528\u4e13\u95e8\u7684\u94fe\u8def\u5c42\u7684\u534f\u8bae\u3002</p> <p>\u5728\u4e24\u4e2a\u76f8\u90bb\u8282\u70b9\u4e4b\u95f4\u4f20\u9001\u6570\u636e\u65f6\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5c06\u7f51\u7edc\u5c42\u4ea4\u4e0b\u6765\u7684 IP \u6570\u636e\u62a5\u7ec4\u88c5\u6210\u5e27\uff0c\u5728\u4e24\u4e2a\u76f8\u90bb\u8282\u70b9\u95f4\u7684\u94fe\u8def\u4e0a\u4f20\u9001\u5e27\u3002\u6bcf\u4e00\u5e27\u5305\u62ec\u6570\u636e\u548c\u5fc5\u8981\u7684\u63a7\u5236\u4fe1\u606f\uff08\u5982\u540c\u6b65\u4fe1\u606f\uff0c\u5730\u5740\u4fe1\u606f\uff0c\u5dee\u9519\u63a7\u5236\u7b49\uff09\u3002</p> <p>\u5728\u63a5\u6536\u6570\u636e\u65f6\uff0c\u63a7\u5236\u4fe1\u606f\u4f7f\u63a5\u6536\u7aef\u80fd\u591f\u77e5\u9053\u4e00\u4e2a\u5e27\u4ece\u54ea\u4e2a\u6bd4\u7279\u5f00\u59cb\u548c\u5230\u54ea\u4e2a\u6bd4\u7279\u7ed3\u675f\u3002</p> <p>\u4e00\u822c\u7684Web\u5e94\u7528\u7684\u901a\u4fe1\u4f20\u8f93\u6d41\u662f\u8fd9\u6837\u7684\uff1a</p> <p></p> <p>\u53d1\u9001\u7aef\u5728\u5c42\u4e0e\u5c42\u4e4b\u95f4\u4f20\u8f93\u6570\u636e\u65f6\uff0c\u6bcf\u7ecf\u8fc7\u4e00\u5c42\u65f6\u4f1a\u88ab\u6253\u4e0a\u4e00\u4e2a\u8be5\u5c42\u6240\u5c5e\u7684\u9996\u90e8\u4fe1\u606f\u3002\u53cd\u4e4b\uff0c\u63a5\u6536\u7aef\u5728\u5c42\u4e0e\u5c42\u4e4b\u95f4\u4f20\u8f93\u6570\u636e\u65f6\uff0c\u6bcf\u7ecf\u8fc7\u4e00\u5c42\u65f6\u4f1a\u628a\u5bf9\u5e94\u7684\u9996\u90e8\u4fe1\u606f\u53bb\u9664\u3002</p>"},{"location":"chap6/5Linux_network_int/#1-5","title":"1-5 \u7269\u7406\u5c42","text":"<p>\u5728\u7269\u7406\u5c42\u4e0a\u6240\u4f20\u9001\u7684\u6570\u636e\u5355\u4f4d\u662f\u6bd4\u7279\u3002\u7269\u7406\u5c42\uff08physical layer\uff09\u7684\u4f5c\u7528\u662f\u5b9e\u73b0\u76f8\u90bb\u8ba1\u7b97\u673a\u8282\u70b9\u4e4b\u95f4\u6bd4\u7279\u6d41\u7684\u900f\u660e\u4f20\u9001\uff0c\u5c3d\u53ef\u80fd\u5c4f\u853d\u6389\u5177\u4f53\u4f20\u8f93\u4ecb\u8d28\u548c\u7269\u7406\u8bbe\u5907\u7684\u5dee\u5f02\u3002\u4f7f\u5176\u4e0a\u9762\u7684\u6570\u636e\u94fe\u8def\u5c42\u4e0d\u5fc5\u8003\u8651\u7f51\u7edc\u7684\u5177\u4f53\u4f20\u8f93\u4ecb\u8d28\u662f\u4ec0\u4e48\u3002\u201c\u900f\u660e\u4f20\u9001\u6bd4\u7279\u6d41\u201d\u8868\u793a\u7ecf\u5b9e\u9645\u7535\u8def\u4f20\u9001\u540e\u7684\u6bd4\u7279\u6d41\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0c\u5bf9\u4f20\u9001\u7684\u6bd4\u7279\u6d41\u6765\u8bf4\uff0c\u8fd9\u4e2a\u7535\u8def\u597d\u50cf\u662f\u770b\u4e0d\u89c1\u7684\u3002</p>"},{"location":"chap6/5Linux_network_int/#1-6-tcpip","title":"1-6 TCP/IP \u534f\u8bae\u65cf","text":"<p>\u5728\u4e92\u8054\u7f51\u4f7f\u7528\u7684\u5404\u79cd\u534f\u8bae\u4e2d\u6700\u91cd\u8981\u548c\u6700\u8457\u540d\u7684\u5c31\u662f TCP/IP \u4e24\u4e2a\u534f\u8bae\u3002\u73b0\u5728\u4eba\u4eec\u7ecf\u5e38\u63d0\u5230\u7684 TCP/IP \u5e76\u4e0d\u4e00\u5b9a\u662f\u5355\u6307 TCP \u548c IP \u8fd9\u4e24\u4e2a\u5177\u4f53\u7684\u534f\u8bae\uff0c\u800c\u5f80\u5f80\u662f\u8868\u793a\u4e92\u8054\u7f51\u6240\u4f7f\u7528\u7684\u6574\u4e2a TCP/IP \u534f\u8bae\u65cf\u3002</p> <p></p> <p>\u4e92\u8054\u7f51\u534f\u8bae\u5957\u4ef6\uff08\u82f1\u8bed\uff1aInternet Protocol Suite\uff0c\u7f29\u5199IPS\uff09\u662f\u4e00\u4e2a\u7f51\u7edc\u901a\u8baf\u6a21\u578b\uff0c\u4ee5\u53ca\u4e00\u6574\u4e2a\u7f51\u7edc\u4f20\u8f93\u534f\u8bae\u5bb6\u65cf\uff0c\u4e3a\u7f51\u9645\u7f51\u7edc\u7684\u57fa\u7840\u901a\u8baf\u67b6\u6784\u3002\u5b83\u5e38\u88ab\u901a\u79f0\u4e3a TCP/IP \u534f\u8bae\u65cf\uff08\u82f1\u8bed\uff1aTCP/IP Protocol Suite\uff0c\u6216 TCP/IP Protocols\uff09\uff0c\u7b80\u79f0 TCP/IP\u3002\u56e0\u4e3a\u8be5\u534f\u5b9a\u5bb6\u65cf\u7684\u4e24\u4e2a\u6838\u5fc3\u534f\u5b9a\uff1aTCP\uff08\u4f20\u8f93\u63a7\u5236\u534f\u8bae\uff09\u548cIP\uff08\u7f51\u9645\u534f\u8bae\uff09\uff0c\u4e3a\u8be5\u5bb6\u65cf\u4e2d\u6700\u65e9\u901a\u8fc7\u7684\u6807\u51c6\u3002</p> <p>\u5212\u91cd\u70b9\uff1aTCP\uff08\u4f20\u8f93\u63a7\u5236\u534f\u8bae\uff09\u548c IP\uff08\u7f51\u9645\u534f\u8bae\uff09 \u662f\u6700\u5148\u5b9a\u4e49\u7684\u4e24\u4e2a\u6838\u5fc3\u534f\u8bae\uff0c\u6240\u4ee5\u624d\u7edf\u79f0\u4e3a TCP/IP \u534f\u8bae\u65cf\u3002</p>"},{"location":"chap6/5Linux_network_int/#2tcp","title":"2\u3001TCP\u7684\u4e09\u6b21\u63e1\u624b\u56db\u6b21\u6325\u624b","text":"<p>TCP \u662f\u4e00\u79cd\u9762\u5411\u8fde\u63a5\u7684\u3001\u53ef\u9760\u7684\u3001\u57fa\u4e8e\u5b57\u8282\u6d41\u7684\u4f20\u8f93\u5c42\u901a\u4fe1\u534f\u8bae\uff0c\u5728\u53d1\u9001\u6570\u636e\u524d\uff0c\u901a\u4fe1\u53cc\u65b9\u5fc5\u987b\u5728\u5f7c\u6b64\u95f4\u5efa\u7acb\u4e00\u6761\u8fde\u63a5\u3002\u6240\u8c13\u7684\u201c\u8fde\u63a5\u201d\uff0c\u5176\u5b9e\u662f\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4fdd\u5b58\u7684\u4e00\u4efd\u5173\u4e8e\u5bf9\u65b9\u7684\u4fe1\u606f\uff0c\u5982 IP \u5730\u5740\u3001\u7aef\u53e3\u53f7\u7b49\u3002</p> <p>TCP \u53ef\u4ee5\u770b\u6210\u662f\u4e00\u79cd\u5b57\u8282\u6d41\uff0c\u5b83\u4f1a\u5904\u7406 IP \u5c42\u6216\u4ee5\u4e0b\u7684\u5c42\u7684\u4e22\u5305\u3001\u91cd\u590d\u4ee5\u53ca\u9519\u8bef\u95ee\u9898\u3002\u5728\u8fde\u63a5\u7684\u5efa\u7acb\u8fc7\u7a0b\u4e2d\uff0c\u53cc\u65b9\u9700\u8981\u4ea4\u6362\u4e00\u4e9b\u8fde\u63a5\u7684\u53c2\u6570\u3002\u8fd9\u4e9b\u53c2\u6570\u53ef\u4ee5\u653e\u5728 TCP \u5934\u90e8\u3002</p> <p>\u4e00\u4e2a TCP \u8fde\u63a5\u7531\u4e00\u4e2a 4 \u5143\u7ec4\u6784\u6210\uff0c\u5206\u522b\u662f\u4e24\u4e2a IP \u5730\u5740\u548c\u4e24\u4e2a\u7aef\u53e3\u53f7\u3002\u4e00\u4e2a TCP \u8fde\u63a5\u901a\u5e38\u5206\u4e3a\u4e09\u4e2a\u9636\u6bb5\uff1a\u8fde\u63a5\u3001\u6570\u636e\u4f20\u8f93\u3001\u9000\u51fa\uff08\u5173\u95ed\uff09\u3002\u901a\u8fc7\u4e09\u6b21\u63e1\u624b\u5efa\u7acb\u4e00\u4e2a\u94fe\u63a5\uff0c\u901a\u8fc7\u56db\u6b21\u6325\u624b\u6765\u5173\u95ed\u4e00\u4e2a\u8fde\u63a5\u3002</p> <p>\u5f53\u4e00\u4e2a\u8fde\u63a5\u88ab\u5efa\u7acb\u6216\u88ab\u7ec8\u6b62\u65f6\uff0c\u4ea4\u6362\u7684\u62a5\u6587\u6bb5\u53ea\u5305\u542b TCP \u5934\u90e8\uff0c\u800c\u6ca1\u6709\u6570\u636e\u3002</p> <p>TCP \u62a5\u6587\u7684\u5934\u90e8\u7ed3\u6784</p> <p>\u5728\u4e86\u89e3 TCP \u8fde\u63a5\u4e4b\u524d\u5148\u6765\u4e86\u89e3\u4e00\u4e0b TCP \u62a5\u6587\u7684\u5934\u90e8\u7ed3\u6784\u3002</p> <p>\u4e0a\u56fe\u4e2d\u6709\u51e0\u4e2a\u5b57\u6bb5\u9700\u8981\u91cd\u70b9\u4ecb\u7ecd\u4e0b\uff1a</p> <ul> <li>\u5e8f\u53f7\uff1aseq \u5e8f\u53f7\uff0c\u5360 32 \u4f4d\uff0c\u7528\u6765\u6807\u8bc6\u4ece TCP \u6e90\u7aef\u5411\u76ee\u7684\u7aef\u53d1\u9001\u7684\u5b57\u8282\u6d41\uff0c\u53d1\u8d77\u65b9\u53d1\u9001\u6570\u636e\u65f6\u5bf9\u6b64\u8fdb\u884c\u6807\u8bb0\u3002</li> <li>\u786e\u8ba4\u5e8f\u53f7\uff1aACK \u5e8f\u53f7\uff0c\u5360 32 \u4f4d\uff0c\u53ea\u6709 ACK \u6807\u5fd7\u4f4d\u4e3a1\u65f6\uff0c\u786e\u8ba4\u5e8f\u53f7\u5b57\u6bb5\u624d\u6709\u6548\uff0c<code>ack=seq+1</code>\u3002</li> <li>\u6807\u5fd7\u4f4d\uff1a\u5171 6 \u4e2a\uff0c\u5373 URG\u3001ACK\u3001PSH\u3001RST\u3001SYN\u3001FIN \u7b49\uff0c\u5177\u4f53\u542b\u4e49\u5982\u4e0b\uff1a<ul> <li>ACK\uff1a\u786e\u8ba4\u5e8f\u53f7\u6709\u6548\u3002</li> <li>FIN\uff1a\u91ca\u653e\u4e00\u4e2a\u8fde\u63a5\u3002</li> <li>PSH\uff1a\u63a5\u6536\u65b9\u5e94\u8be5\u5c3d\u5feb\u5c06\u8fd9\u4e2a\u62a5\u6587\u4ea4\u7ed9\u5e94\u7528\u5c42\u3002</li> <li>RST\uff1a\u91cd\u7f6e\u8fde\u63a5\u3002</li> <li>SYN\uff1a\u53d1\u8d77\u4e00\u4e2a\u65b0\u8fde\u63a5\u3002</li> <li>URG\uff1a\u7d27\u6025\u6307\u9488\uff08urgent pointer\uff09\u6709\u6548\u3002</li> </ul> </li> </ul> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a</p> <ul> <li>\u4e0d\u8981\u5c06\u786e\u8ba4\u5e8f\u53f7 ACK \u4e0e\u6807\u5fd7\u4f4d\u4e2d\u7684 ACK \u641e\u6df7\u4e86\u3002</li> <li>\u786e\u8ba4\u65b9 ack = \u53d1\u8d77\u65b9 seq + 1\uff0c\u4e24\u7aef\u914d\u5bf9\u3002</li> </ul>"},{"location":"chap6/5Linux_network_int/#2-1","title":"2-1 \u4e09\u6b21\u63e1\u624b","text":"<p>\u4e09\u6b21\u63e1\u624b\u7684\u672c\u8d28\u662f\u786e\u8ba4\u901a\u4fe1\u53cc\u65b9\u6536\u53d1\u6570\u636e\u7684\u80fd\u529b\u3002</p> <p>\u9996\u5148\uff0c\u6211\u8ba9\u4fe1\u4f7f\u8fd0\u8f93\u4e00\u4efd\u4fe1\u4ef6\u7ed9\u5bf9\u65b9\uff0c\u5bf9\u65b9\u6536\u5230\u4e86\uff0c\u90a3\u4e48\u4ed6\u5c31\u77e5\u9053\u4e86\u6211\u7684\u53d1\u4ef6\u80fd\u529b\u548c\u4ed6\u7684\u6536\u4ef6\u80fd\u529b\u662f\u53ef\u4ee5\u7684\u3002</p> <p>\u4e8e\u662f\u4ed6\u7ed9\u6211\u56de\u4fe1\uff0c\u6211\u82e5\u6536\u5230\u4e86\uff0c\u6211\u4fbf\u77e5\u6211\u7684\u53d1\u4ef6\u80fd\u529b\u548c\u4ed6\u7684\u6536\u4ef6\u80fd\u529b\u662f\u53ef\u4ee5\u7684\uff0c\u5e76\u4e14\u4ed6\u7684\u53d1\u4ef6\u80fd\u529b\u548c\u6211\u7684\u6536\u4ef6\u80fd\u529b\u662f\u53ef\u4ee5\u3002</p> <p>\u7136\u800c\u6b64\u65f6\u4ed6\u8fd8\u4e0d\u77e5\u9053\u4ed6\u7684\u53d1\u4ef6\u80fd\u529b\u548c\u6211\u7684\u6536\u4ef6\u80fd\u529b\u5230\u5e95\u53ef\u4e0d\u53ef\u4ee5\uff0c\u4e8e\u662f\u6211\u6700\u540e\u56de\u9988\u4e00\u6b21\uff0c\u4ed6\u82e5\u6536\u5230\u4e86\uff0c\u4ed6\u4fbf\u6e05\u695a\u4e86\u4ed6\u7684\u53d1\u4ef6\u80fd\u529b\u548c\u6211\u7684\u6536\u4ef6\u80fd\u529b\u662f\u53ef\u4ee5\u7684\u3002</p> <p>\u8fd9\uff0c\u5c31\u662f\u4e09\u6b21\u63e1\u624b\uff0c\u8fd9\u6837\u8bf4\uff0c\u4f60\u7406\u89e3\u4e86\u5417\uff1f</p> <p></p> <ul> <li>\u7b2c\u4e00\u6b21\u63e1\u624b\uff1a\u5ba2\u6237\u7aef\u8981\u5411\u670d\u52a1\u7aef\u53d1\u8d77\u8fde\u63a5\u8bf7\u6c42\uff0c\u9996\u5148\u5ba2\u6237\u7aef\u968f\u673a\u751f\u6210\u4e00\u4e2a\u8d77\u59cb\u5e8f\u5217\u53f7 ISN\uff08\u6bd4\u5982\u662f 100\uff09\uff0c\u90a3\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001\u7684\u62a5\u6587\u6bb5\u5305\u542b SYN \u6807\u5fd7\u4f4d\uff08\u4e5f\u5c31\u662f SYN = 1\uff09\uff0c\u5e8f\u5217\u53f7 seq = 100\u3002</li> <li>\u7b2c\u4e8c\u6b21\u63e1\u624b\uff1a\u670d\u52a1\u7aef\u6536\u5230\u5ba2\u6237\u7aef\u53d1\u8fc7\u6765\u7684\u62a5\u6587\u540e\uff0c\u53d1\u73b0 SYN = 1\uff0c\u77e5\u9053\u8fd9\u662f\u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42\uff0c\u4e8e\u662f\u5c06\u5ba2\u6237\u7aef\u7684\u8d77\u59cb\u5e8f\u5217\u53f7 100 \u5b58\u8d77\u6765\uff0c\u5e76\u4e14\u968f\u673a\u751f\u6210\u4e00\u4e2a\u670d\u52a1\u7aef\u7684\u8d77\u59cb\u5e8f\u5217\u53f7\uff08\u6bd4\u5982\u662f 300\uff09\u3002\u7136\u540e\u7ed9\u5ba2\u6237\u7aef\u56de\u590d\u4e00\u6bb5\u62a5\u6587\uff0c\u56de\u590d\u62a5\u6587\u5305\u542b SYN \u548c ACK \u6807\u5fd7\uff08\u4e5f\u5c31\u662f SYN = 1\uff0cACK = 1\uff09\u3001\u5e8f\u5217\u53f7 seq = 300\u3001\u786e\u8ba4\u53f7 ack = 101\uff08\u5ba2\u6237\u7aef\u53d1\u8fc7\u6765\u7684\u5e8f\u5217\u53f7 + 1\uff09\u3002</li> <li>\u7b2c\u4e09\u6b21\u63e1\u624b\uff1a\u5ba2\u6237\u7aef\u6536\u5230\u670d\u52a1\u7aef\u7684\u56de\u590d\u540e\u53d1\u73b0 ACK = 1\u5e76\u4e14 ack =101\uff0c\u4e8e\u662f\u77e5\u9053\u670d\u52a1\u7aef\u5df2\u7ecf\u6536\u5230\u4e86\u5e8f\u5217\u53f7\u4e3a 100 \u7684\u90a3\u6bb5\u62a5\u6587\uff1b\u540c\u65f6\u53d1\u73b0 SYN = 1\uff0c\u77e5\u9053\u4e86\u670d\u52a1\u7aef\u540c\u610f\u4e86\u8fd9\u6b21\u8fde\u63a5\uff0c\u4e8e\u662f\u5c31\u5c06\u670d\u52a1\u7aef\u7684\u5e8f\u5217\u53f7 300 \u7ed9\u5b58\u4e0b\u6765\u3002\u7136\u540e\u5ba2\u6237\u7aef\u518d\u56de\u590d\u4e00\u6bb5\u62a5\u6587\u7ed9\u670d\u52a1\u7aef\uff0c\u62a5\u6587\u5305\u542b ACK \u6807\u5fd7\u4f4d\uff08ACK = 1\uff09\u3001ack = 301\uff08\u670d\u52a1\u7aef\u5e8f\u5217\u53f7+1\uff09\u3001seq = 101\uff08\u7b2c\u4e00\u6b21\u63e1\u624b\u65f6\u53d1\u9001\u62a5\u6587\u662f\u5360\u636e\u4e00\u4e2a\u5e8f\u5217\u53f7\u7684\uff0c\u6240\u4ee5\u8fd9\u6b21 seq \u5c31\u4ece 101 \u5f00\u59cb\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u4e0d\u643a\u5e26\u6570\u636e\u7684 ACK \u62a5\u6587\u662f\u4e0d\u5360\u636e\u5e8f\u5217\u53f7\u7684\uff0c\u6240\u4ee5\u540e\u9762\u7b2c\u4e00\u6b21\u6b63\u5f0f\u53d1\u9001\u6570\u636e\u65f6 seq \u8fd8\u662f 101\uff09\u3002\u5f53\u670d\u52a1\u7aef\u6536\u5230\u62a5\u6587\u540e\u53d1\u73b0 ACK = 1 \u5e76\u4e14 ack = 301\uff0c\u5c31\u77e5\u9053\u5ba2\u6237\u7aef\u6536\u5230\u5e8f\u5217\u53f7\u4e3a 300 \u7684\u62a5\u6587\u4e86\uff0c\u5c31\u8fd9\u6837\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u901a\u8fc7 TCP \u5efa\u7acb\u4e86\u8fde\u63a5\u3002</li> </ul> <p></p>"},{"location":"chap6/5Linux_network_int/#2-2","title":"2-2 \u56db\u6b21\u6325\u624b","text":"<p>\u56db\u6b21\u6325\u624b\u7684\u76ee\u7684\u662f\u5173\u95ed\u4e00\u4e2a\u8fde\u63a5\u3002</p> <p></p> <p>\u6bd4\u5982\u5ba2\u6237\u7aef\u521d\u59cb\u5316\u7684\u5e8f\u5217\u53f7 ISA = 100\uff0c\u670d\u52a1\u7aef\u521d\u59cb\u5316\u7684\u5e8f\u5217\u53f7 ISA = 300\u3002TCP \u8fde\u63a5\u6210\u529f\u540e\u5ba2\u6237\u7aef\u603b\u5171\u53d1\u9001\u4e86 1000 \u4e2a\u5b57\u8282\u7684\u6570\u636e\uff0c\u670d\u52a1\u7aef\u5728\u5ba2\u6237\u7aef\u53d1 FIN \u62a5\u6587\u524d\u603b\u5171\u56de\u590d\u4e86 2000 \u4e2a\u5b57\u8282\u7684\u6570\u636e\u3002</p> <ul> <li>\u7b2c\u4e00\u6b21\u6325\u624b\uff1a\u5f53\u5ba2\u6237\u7aef\u7684\u6570\u636e\u90fd\u4f20\u8f93\u5b8c\u6210\u540e\uff0c\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u51fa\u8fde\u63a5\u91ca\u653e\u62a5\u6587\uff08\u5f53\u7136\u6570\u636e\u6ca1\u53d1\u5b8c\u65f6\u4e5f\u53ef\u4ee5\u53d1\u9001\u8fde\u63a5\u91ca\u653e\u62a5\u6587\u5e76\u505c\u6b62\u53d1\u9001\u6570\u636e\uff09\uff0c\u91ca\u653e\u8fde\u63a5\u62a5\u6587\u5305\u542b FIN \u6807\u5fd7\u4f4d\uff08FIN = 1\uff09\u3001\u5e8f\u5217\u53f7 seq = 1101\uff08100 + 1 + 1000\uff0c\u5176\u4e2d\u7684 1 \u662f\u5efa\u7acb\u8fde\u63a5\u65f6\u5360\u7684\u4e00\u4e2a\u5e8f\u5217\u53f7\uff09\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\u5ba2\u6237\u7aef\u53d1\u51fa FIN \u62a5\u6587\u6bb5\u540e\u53ea\u662f\u4e0d\u80fd\u53d1\u6570\u636e\u4e86\uff0c\u4f46\u662f\u8fd8\u53ef\u4ee5\u6b63\u5e38\u6536\u6570\u636e\uff1b\u53e6\u5916FIN\u62a5\u6587\u6bb5\u5373\u4f7f\u4e0d\u643a\u5e26\u6570\u636e\u4e5f\u8981\u5360\u636e\u4e00\u4e2a\u5e8f\u5217\u53f7\u3002</li> <li>\u7b2c\u4e8c\u6b21\u6325\u624b\uff1a\u670d\u52a1\u7aef\u6536\u5230\u5ba2\u6237\u7aef\u53d1\u7684FIN\u62a5\u6587\u540e\u7ed9\u5ba2\u6237\u7aef\u56de\u590d\u786e\u8ba4\u62a5\u6587\uff0c\u786e\u8ba4\u62a5\u6587\u5305\u542b ACK \u6807\u5fd7\u4f4d\uff08ACK = 1\uff09\u3001\u786e\u8ba4\u53f7 ack = 1102\uff08\u5ba2\u6237\u7aef FIN \u62a5\u6587\u5e8f\u5217\u53f7 1101 + 1\uff09\u3001\u5e8f\u5217\u53f7 seq = 2300\uff08300 + 2000\uff09\u3002\u6b64\u65f6\u670d\u52a1\u7aef\u5904\u4e8e\u5173\u95ed\u7b49\u5f85\u72b6\u6001\uff0c\u800c\u4e0d\u662f\u7acb\u9a6c\u7ed9\u5ba2\u6237\u7aef\u53d1 FIN \u62a5\u6587\uff0c\u8fd9\u4e2a\u72b6\u6001\u8fd8\u8981\u6301\u7eed\u4e00\u6bb5\u65f6\u95f4\uff0c\u56e0\u4e3a\u670d\u52a1\u7aef\u53ef\u80fd\u8fd8\u6709\u6570\u636e\u6ca1\u53d1\u5b8c\u3002</li> <li>\u7b2c\u4e09\u6b21\u6325\u624b\uff1a\u670d\u52a1\u7aef\u5c06\u6700\u540e\u6570\u636e\uff08\u6bd4\u5982 50 \u4e2a\u5b57\u8282\uff09\u53d1\u9001\u5b8c\u6bd5\u540e\u5c31\u5411\u5ba2\u6237\u7aef\u53d1\u51fa\u8fde\u63a5\u91ca\u653e\u62a5\u6587\uff0c\u62a5\u6587\u5305\u542b FIN \u548c ACK \u6807\u5fd7\u4f4d\uff08FIN = 1\uff0cACK = 1\uff09\u3001\u786e\u8ba4\u53f7\u548c\u7b2c\u4e8c\u6b21\u6325\u624b\u4e00\u6837 ack = 1102\u3001\u5e8f\u5217\u53f7 seq = 2350\uff082300 + 50\uff09\u3002</li> <li>\u7b2c\u56db\u6b21\u6325\u624b\uff1a\u5ba2\u6237\u7aef\u6536\u5230\u670d\u52a1\u7aef\u53d1\u7684FIN\u62a5\u6587\u540e\uff0c\u5411\u670d\u52a1\u7aef\u53d1\u51fa\u786e\u8ba4\u62a5\u6587\uff0c\u786e\u8ba4\u62a5\u6587\u5305\u542b ACK \u6807\u5fd7\u4f4d\uff08ACK = 1\uff09\u3001\u786e\u8ba4\u53f7 ack = 2351\u3001\u5e8f\u5217\u53f7 seq = 1102\u3002\u6ce8\u610f\u5ba2\u6237\u7aef\u53d1\u51fa\u786e\u8ba4\u62a5\u6587\u540e\u4e0d\u662f\u7acb\u9a6c\u91ca\u653e TCP \u8fde\u63a5\uff0c\u800c\u662f\u8981\u7ecf\u8fc7 2MSL\uff08\u6700\u957f\u62a5\u6587\u6bb5\u5bff\u547d\u7684 2 \u500d\u65f6\u957f\uff09\u540e\u624d\u91ca\u653e TCP \u8fde\u63a5\u3002\u800c\u670d\u52a1\u7aef\u4e00\u65e6\u6536\u5230\u5ba2\u6237\u7aef\u53d1\u51fa\u7684\u786e\u8ba4\u62a5\u6587\u5c31\u4f1a\u7acb\u9a6c\u91ca\u653e TCP \u8fde\u63a5\uff0c\u6240\u4ee5\u670d\u52a1\u7aef\u7ed3\u675f TCP \u8fde\u63a5\u7684\u65f6\u95f4\u8981\u6bd4\u5ba2\u6237\u7aef\u65e9\u4e00\u4e9b\u3002</li> </ul>"},{"location":"chap6/5Linux_network_int/#3","title":"3\u3001\u5e38\u89c1\u9762\u8bd5\u9898","text":""},{"location":"chap6/5Linux_network_int/#3-1-tcp-3-2","title":"3-1 \u4e3a\u4ec0\u4e48 TCP \u8fde\u63a5\u7684\u65f6\u5019\u662f 3 \u6b21\uff1f2 \u6b21\u4e0d\u53ef\u4ee5\u5417\uff1f","text":"<p>\u56e0\u4e3a\u9700\u8981\u8003\u8651\u8fde\u63a5\u65f6\u4e22\u5305\u7684\u95ee\u9898\uff0c\u5982\u679c\u53ea\u63e1\u624b 2 \u6b21\uff0c\u7b2c\u4e8c\u6b21\u63e1\u624b\u65f6\u5982\u679c\u670d\u52a1\u7aef\u53d1\u7ed9\u5ba2\u6237\u7aef\u7684\u786e\u8ba4\u62a5\u6587\u6bb5\u4e22\u5931\uff0c\u6b64\u65f6\u670d\u52a1\u7aef\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\u6536\u53d1\u6570\u636e\uff08\u53ef\u4ee5\u7406\u89e3\u670d\u52a1\u7aef\u5df2\u7ecf\u8fde\u63a5\u6210\u529f\uff09\uff0c\u800c\u5ba2\u6237\u7aef\u4e00\u76f4\u6ca1\u6536\u5230\u670d\u52a1\u7aef\u7684\u786e\u8ba4\u62a5\u6587\uff0c\u6240\u4ee5\u5ba2\u6237\u7aef\u5c31\u4e0d\u77e5\u9053\u670d\u52a1\u7aef\u662f\u5426\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\uff08\u53ef\u4ee5\u7406\u89e3\u4e3a\u5ba2\u6237\u7aef\u672a\u8fde\u63a5\u6210\u529f\uff09\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5ba2\u6237\u7aef\u4e0d\u4f1a\u7ed9\u670d\u52a1\u7aef\u53d1\u6570\u636e\uff0c\u4e5f\u4f1a\u5ffd\u7565\u670d\u52a1\u7aef\u53d1\u8fc7\u6765\u7684\u6570\u636e\u3002</p> <p>\u5982\u679c\u662f\u4e09\u6b21\u63e1\u624b\uff0c\u5373\u4fbf\u53d1\u751f\u4e22\u5305\u4e5f\u4e0d\u4f1a\u6709\u95ee\u9898\uff0c\u6bd4\u5982\u5982\u679c\u7b2c\u4e09\u6b21\u63e1\u624b\u5ba2\u6237\u7aef\u53d1\u7684\u786e\u8ba4 ack \u62a5\u6587\u4e22\u5931\uff0c\u670d\u52a1\u7aef\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u6ca1\u6709\u6536\u5230\u786e\u8ba4 ack \u62a5\u6587\u7684\u8bdd\u5c31\u4f1a\u91cd\u65b0\u8fdb\u884c\u7b2c\u4e8c\u6b21\u63e1\u624b\uff0c\u4e5f\u5c31\u662f\u670d\u52a1\u7aef\u4f1a\u91cd\u53d1 SYN \u62a5\u6587\u6bb5\uff0c\u5ba2\u6237\u7aef\u6536\u5230\u91cd\u53d1\u7684\u62a5\u6587\u6bb5\u540e\u4f1a\u518d\u6b21\u7ed9\u670d\u52a1\u7aef\u53d1\u9001\u786e\u8ba4 ack \u62a5\u6587\u3002</p>"},{"location":"chap6/5Linux_network_int/#3-2-tcp-3-4","title":"3-2 \u4e3a\u4ec0\u4e48 TCP \u8fde\u63a5\u7684\u65f6\u5019\u662f 3 \u6b21\uff0c\u5173\u95ed\u7684\u65f6\u5019\u5374\u662f 4 \u6b21\uff1f","text":"<p>\u56e0\u4e3a\u53ea\u6709\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u6ca1\u6709\u6570\u636e\u8981\u53d1\u9001\u7684\u65f6\u5019\u624d\u80fd\u65ad\u5f00 TCP\u3002</p> <p>\u800c\u5ba2\u6237\u7aef\u53d1\u51fa FIN \u62a5\u6587\u65f6\u53ea\u80fd\u4fdd\u8bc1\u5ba2\u6237\u7aef\u6ca1\u6709\u6570\u636e\u53d1\u4e86\uff0c\u670d\u52a1\u7aef\u8fd8\u6709\u6ca1\u6709\u6570\u636e\u53d1\u5ba2\u6237\u7aef\u662f\u4e0d\u77e5\u9053\u7684\u3002\u800c\u670d\u52a1\u7aef\u6536\u5230\u5ba2\u6237\u7aef\u7684 FIN \u62a5\u6587\u540e\u53ea\u80fd\u5148\u56de\u590d\u5ba2\u6237\u7aef\u4e00\u4e2a\u786e\u8ba4\u62a5\u6587\u6765\u544a\u8bc9\u5ba2\u6237\u7aef\u6211\u670d\u52a1\u7aef\u5df2\u7ecf\u6536\u5230\u4f60\u7684 FIN \u62a5\u6587\u4e86\uff0c\u4f46\u6211\u670d\u52a1\u7aef\u8fd8\u6709\u4e00\u4e9b\u6570\u636e\u6ca1\u53d1\u5b8c\uff0c\u7b49\u8fd9\u4e9b\u6570\u636e\u53d1\u5b8c\u4e86\u670d\u52a1\u7aef\u624d\u80fd\u7ed9\u5ba2\u6237\u7aef\u53d1 FIN \u62a5\u6587\uff08\u6240\u4ee5\u4e0d\u80fd\u4e00\u6b21\u6027\u5c06\u786e\u8ba4\u62a5\u6587\u548c FIN \u62a5\u6587\u53d1\u7ed9\u5ba2\u6237\u7aef\uff0c\u5c31\u662f\u8fd9\u91cc\u591a\u51fa\u6765\u4e86\u4e00\u6b21\uff09\u3002</p>"},{"location":"chap6/5Linux_network_int/#3-3-2msl-tcp","title":"3-3 \u4e3a\u4ec0\u4e48\u5ba2\u6237\u7aef\u53d1\u51fa\u7b2c\u56db\u6b21\u6325\u624b\u7684\u786e\u8ba4\u62a5\u6587\u540e\u8981\u7b49 2MSL \u7684\u65f6\u95f4\u624d\u80fd\u91ca\u653e TCP \u8fde\u63a5\uff1f","text":"<p>\u8fd9\u91cc\u540c\u6837\u662f\u8981\u8003\u8651\u4e22\u5305\u7684\u95ee\u9898\uff0c\u5982\u679c\u7b2c\u56db\u6b21\u6325\u624b\u7684\u62a5\u6587\u4e22\u5931\uff0c\u670d\u52a1\u7aef\u6ca1\u6536\u5230\u786e\u8ba4 ack \u62a5\u6587\u5c31\u4f1a\u91cd\u53d1\u7b2c\u4e09\u6b21\u6325\u624b\u7684\u62a5\u6587\uff0c\u8fd9\u6837\u62a5\u6587\u4e00\u53bb\u4e00\u56de\u6700\u957f\u65f6\u95f4\u5c31\u662f 2MSL\uff0c\u6240\u4ee5\u9700\u8981\u7b49\u8fd9\u4e48\u957f\u65f6\u95f4\u6765\u786e\u8ba4\u670d\u52a1\u7aef\u786e\u5b9e\u5df2\u7ecf\u6536\u5230\u4e86\u3002</p>"},{"location":"chap6/5Linux_network_int/#3-4","title":"3-4 \u5982\u679c\u5df2\u7ecf\u5efa\u7acb\u4e86\u8fde\u63a5\uff0c\u4f46\u662f\u5ba2\u6237\u7aef\u7a81\u7136\u51fa\u73b0\u6545\u969c\u4e86\u600e\u4e48\u529e\uff1f","text":"<p>TCP \u8bbe\u6709\u4e00\u4e2a\u4fdd\u6d3b\u8ba1\u65f6\u5668\uff0c\u5ba2\u6237\u7aef\u5982\u679c\u51fa\u73b0\u6545\u969c\uff0c\u670d\u52a1\u5668\u4e0d\u80fd\u4e00\u76f4\u7b49\u4e0b\u53bb\uff0c\u767d\u767d\u6d6a\u8d39\u8d44\u6e90\u3002\u670d\u52a1\u5668\u6bcf\u6536\u5230\u4e00\u6b21\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u540e\u90fd\u4f1a\u91cd\u65b0\u590d\u4f4d\u8fd9\u4e2a\u8ba1\u65f6\u5668\uff0c\u65f6\u95f4\u901a\u5e38\u662f\u8bbe\u7f6e\u4e3a 2 \u5c0f\u65f6\uff0c\u82e5\u4e24\u5c0f\u65f6\u8fd8\u6ca1\u6709\u6536\u5230\u5ba2\u6237\u7aef\u7684\u4efb\u4f55\u6570\u636e\uff0c\u670d\u52a1\u5668\u5c31\u4f1a\u53d1\u9001\u4e00\u4e2a\u63a2\u6d4b\u62a5\u6587\u6bb5\uff0c\u4ee5\u540e\u6bcf\u9694 75 \u79d2\u949f\u53d1\u9001\u4e00\u6b21\u3002\u82e5\u4e00\u8fde\u53d1\u9001 10 \u4e2a\u63a2\u6d4b\u62a5\u6587\u4ecd\u7136\u6ca1\u53cd\u5e94\uff0c\u670d\u52a1\u5668\u5c31\u8ba4\u4e3a\u5ba2\u6237\u7aef\u51fa\u4e86\u6545\u969c\uff0c\u63a5\u7740\u5c31\u5173\u95ed\u8fde\u63a5\u3002</p>"},{"location":"chap6/5Linux_network_int/#3-5-httphttp-https","title":"3-5 \u4ec0\u4e48\u662f HTTP\uff0cHTTP \u4e0e HTTPS \u6709\u4ec0\u4e48\u533a\u522b\uff1f","text":"<p>HTTP \u662f\u4e00\u4e2a\u5728\u8ba1\u7b97\u673a\u4e16\u754c\u91cc\u4e13\u95e8\u5728\u4e24\u70b9\u4e4b\u95f4\u4f20\u8f93\u6587\u5b57\u3001\u56fe\u7247\u3001\u97f3\u9891\u3001\u89c6\u9891\u7b49\u8d85\u6587\u672c\u6570\u636e\u7684\u7ea6\u5b9a\u548c\u89c4\u8303\u3002</p> <p></p> <p>\u5e38\u7528 HTTP \u72b6\u6001\u7801</p> <p>HTTP \u72b6\u6001\u7801\u8868\u793a\u5ba2\u6237\u7aef HTTP \u8bf7\u6c42\u7684\u8fd4\u56de\u7ed3\u679c\u3001\u6807\u8bc6\u670d\u52a1\u5668\u5904\u7406\u662f\u5426\u6b63\u5e38\u3001\u8868\u660e\u8bf7\u6c42\u51fa\u73b0\u7684\u9519\u8bef\u7b49\u3002</p> <p>\u72b6\u6001\u7801\u7684\u7c7b\u522b\uff1a</p> <p></p> <p>\u5e38\u7528 HTTP \u72b6\u6001\u7801\uff1a</p> <p></p>"},{"location":"chap6/5Linux_network_int/#3-6-get-post","title":"3-6 GET \u548c POST \u533a\u522b","text":"<p>\u8bf4\u9053 GET \u548c POST\uff0c\u5c31\u4e0d\u5f97\u4e0d\u63d0 HTTP \u534f\u8bae\uff0c\u56e0\u4e3a\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u7684\u4ea4\u4e92\u662f\u901a\u8fc7 HTTP \u534f\u8bae\u6267\u884c\u7684\uff0c\u800c GET \u548c POST \u4e5f\u662f HTTP \u534f\u8bae\u4e2d\u7684\u4e24\u79cd\u65b9\u6cd5\u3002</p> <p>HTTP \u5168\u79f0\u4e3a Hyper Text Transfer Protocol\uff0c\u4e2d\u6587\u7ffb\u8bd1\u4e3a\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\uff0c\u76ee\u7684\u662f\u4fdd\u8bc1\u6d4f\u89c8\u5668\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u3002HTTP\u7684\u5de5\u4f5c\u65b9\u5f0f\u662f\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u8bf7\u6c42-\u5e94\u7b54\u534f\u8bae\u3002</p> <p>HTTP \u534f\u8bae\u4e2d\u5b9a\u4e49\u4e86\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u8fdb\u884c\u4ea4\u4e92\u7684\u4e0d\u540c\u65b9\u6cd5\uff0c\u57fa\u672c\u65b9\u6cd5\u6709 4 \u79cd\uff0c\u5206\u522b\u662f GET\uff0cPOST\uff0cPUT\uff0cDELETE\u3002\u8fd9\u56db\u79cd\u65b9\u6cd5\u53ef\u4ee5\u7406\u89e3\u4e3a\uff0c\u5bf9\u670d\u52a1\u5668\u8d44\u6e90\u7684\u67e5\uff0c\u6539\uff0c\u589e\uff0c\u5220\u3002</p> <ul> <li>GET\uff1a\u4ece\u670d\u52a1\u5668\u4e0a\u83b7\u53d6\u6570\u636e\uff0c\u4e5f\u5c31\u662f\u6240\u8c13\u7684\u67e5\uff0c\u4ec5\u4ec5\u662f\u83b7\u53d6\u670d\u52a1\u5668\u8d44\u6e90\uff0c\u4e0d\u8fdb\u884c\u4fee\u6539\u3002</li> <li>POST\uff1a\u5411\u670d\u52a1\u5668\u63d0\u4ea4\u6570\u636e\uff0c\u8fd9\u5c31\u6d89\u53ca\u5230\u4e86\u6570\u636e\u7684\u66f4\u65b0\uff0c\u4e5f\u5c31\u662f\u66f4\u6539\u670d\u52a1\u5668\u7684\u6570\u636e\u3002</li> <li>PUT\uff1a\u82f1\u6587\u542b\u4e49\u662f\u653e\u7f6e\uff0c\u4e5f\u5c31\u662f\u5411\u670d\u52a1\u5668\u65b0\u6dfb\u52a0\u6570\u636e\uff0c\u5c31\u662f\u6240\u8c13\u7684\u589e\u3002</li> <li>DELETE\uff1a\u4ece\u5b57\u9762\u610f\u601d\u4e5f\u80fd\u770b\u51fa\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5c31\u662f\u5220\u9664\u670d\u52a1\u5668\u6570\u636e\u7684\u8fc7\u7a0b\u3002</li> </ul> <p>GET \u548c POST \u533a\u522b\uff1a</p> <ul> <li>Get \u662f\u4e0d\u5b89\u5168\u7684\uff0c\u56e0\u4e3a\u5728\u4f20\u8f93\u8fc7\u7a0b\uff0c\u6570\u636e\u88ab\u653e\u5728\u8bf7\u6c42\u7684 URL \u4e2d\uff1bPost \u7684\u6240\u6709\u64cd\u4f5c\u5bf9\u7528\u6237\u6765\u8bf4\u90fd\u662f\u4e0d\u53ef\u89c1\u7684\u3002\u4f46\u662f\u8fd9\u79cd\u505a\u6cd5\u4e5f\u4e0d\u65f6\u7edd\u5bf9\u7684\uff0c\u5927\u90e8\u5206\u4eba\u7684\u505a\u6cd5\u4e5f\u662f\u6309\u7167\u4e0a\u9762\u7684\u8bf4\u6cd5\u6765\u7684\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u5728 get \u8bf7\u6c42\u52a0\u4e0a request body\uff0c\u7ed9 post \u8bf7\u6c42\u5e26\u4e0a URL \u53c2\u6570\u3002</li> <li>Get \u8bf7\u6c42\u63d0\u4ea4\u7684 url \u4e2d\u7684\u6570\u636e\u6700\u591a\u53ea\u80fd\u662f 2048 \u5b57\u8282\uff0c\u8fd9\u4e2a\u9650\u5236\u662f\u6d4f\u89c8\u5668\u6216\u8005\u670d\u52a1\u5668\u7ed9\u6dfb\u52a0\u7684\uff0chttp \u534f\u8bae\u5e76\u6ca1\u6709\u5bf9 url \u957f\u5ea6\u8fdb\u884c\u9650\u5236\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u4fdd\u8bc1\u670d\u52a1\u5668\u548c\u6d4f\u89c8\u5668\u80fd\u591f\u6b63\u5e38\u8fd0\u884c\uff0c\u9632\u6b62\u6709\u4eba\u6076\u610f\u53d1\u9001\u8bf7\u6c42\u3002Post \u8bf7\u6c42\u5219\u6ca1\u6709\u5927\u5c0f\u9650\u5236\u3002</li> <li>Get \u9650\u5236 Form \u8868\u5355\u7684\u6570\u636e\u96c6\u7684\u503c\u5fc5\u987b\u4e3a ASCII \u5b57\u7b26\uff1b\u800c Post \u652f\u6301\u6574\u4e2a ISO10646\u5b57\u7b26\u96c6\u3002</li> <li>Get \u6267\u884c\u6548\u7387\u5374\u6bd4 Post \u65b9\u6cd5\u597d\u3002Get \u662f form \u63d0\u4ea4\u7684\u9ed8\u8ba4\u65b9\u6cd5\u3002</li> <li>GET \u4ea7\u751f\u4e00\u4e2a TCP \u6570\u636e\u5305\uff1bPOST \u4ea7\u751f\u4e24\u4e2a TCP \u6570\u636e\u5305\u3002</li> <li>\u5bf9\u4e8e GET \u65b9\u5f0f\u7684\u8bf7\u6c42\uff0c\u6d4f\u89c8\u5668\u4f1a\u628a http header \u548c data \u4e00\u5e76\u53d1\u9001\u51fa\u53bb\uff0c\u670d\u52a1\u5668\u54cd\u5e94 200\uff08\u8fd4\u56de\u6570\u636e\uff09\uff1b\u800c\u5bf9\u4e8e POST\uff0c\u6d4f\u89c8\u5668\u5148\u53d1\u9001 header\uff0c\u670d\u52a1\u5668\u54cd\u5e94 100 continue\uff0c\u6d4f\u89c8\u5668\u518d\u53d1\u9001 data\uff0c\u670d\u52a1\u5668\u54cd\u5e94 200 ok\uff08\u8fd4\u56de\u6570\u636e\uff09\u3002</li> </ul>"},{"location":"chap6/5Linux_network_int/#3-7","title":"3-7 \u4ec0\u4e48\u662f\u5bf9\u79f0\u52a0\u5bc6\u4e0e\u975e\u5bf9\u79f0\u52a0\u5bc6\uff1f","text":"<p>\u5bf9\u79f0\u5bc6\u94a5\u52a0\u5bc6\u662f\u6307\u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u540c\u4e00\u4e2a\u5bc6\u94a5\u7684\u65b9\u5f0f\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5b58\u5728\u7684\u6700\u5927\u95ee\u9898\u5c31\u662f\u5bc6\u94a5\u53d1\u9001\u95ee\u9898\uff0c\u5373\u5982\u4f55\u5b89\u5168\u5730\u5c06\u5bc6\u94a5\u53d1\u7ed9\u5bf9\u65b9\u3002</p> <p>\u800c\u975e\u5bf9\u79f0\u52a0\u5bc6\u662f\u6307\u4f7f\u7528\u4e00\u5bf9\u975e\u5bf9\u79f0\u5bc6\u94a5\uff0c\u5373\u516c\u94a5\u548c\u79c1\u94a5\uff0c\u516c\u94a5\u53ef\u4ee5\u968f\u610f\u53d1\u5e03\uff0c\u4f46\u79c1\u94a5\u53ea\u6709\u81ea\u5df1\u77e5\u9053\u3002\u53d1\u9001\u5bc6\u6587\u7684\u4e00\u65b9\u4f7f\u7528\u5bf9\u65b9\u7684\u516c\u94a5\u8fdb\u884c\u52a0\u5bc6\u5904\u7406\uff0c\u5bf9\u65b9\u63a5\u6536\u5230\u52a0\u5bc6\u4fe1\u606f\u540e\uff0c\u4f7f\u7528\u81ea\u5df1\u7684\u79c1\u94a5\u8fdb\u884c\u89e3\u5bc6\u3002</p> <p>\u7531\u4e8e\u975e\u5bf9\u79f0\u52a0\u5bc6\u7684\u65b9\u5f0f\u4e0d\u9700\u8981\u53d1\u9001\u7528\u6765\u89e3\u5bc6\u7684\u79c1\u94a5\uff0c\u6240\u4ee5\u53ef\u4ee5\u4fdd\u8bc1\u5b89\u5168\u6027\uff1b\u4f46\u662f\u548c\u5bf9\u79f0\u52a0\u5bc6\u6bd4\u8d77\u6765\uff0c\u975e\u5e38\u7684\u6162\u3002</p>"},{"location":"chap6/5Linux_network_int/#3-8-http2","title":"3-8 \u4ec0\u4e48\u662f HTTP2\uff1f","text":"<p>HTTP2 \u53ef\u4ee5\u63d0\u9ad8\u4e86\u7f51\u9875\u7684\u6027\u80fd\u3002</p> <p>\u5728 HTTP1 \u4e2d\u6d4f\u89c8\u5668\u9650\u5236\u4e86\u540c\u4e00\u4e2a\u57df\u540d\u4e0b\u7684\u8bf7\u6c42\u6570\u91cf\uff08Chrome \u4e0b\u4e00\u822c\u662f\u516d\u4e2a\uff09\uff0c\u5f53\u5728\u8bf7\u6c42\u5f88\u591a\u8d44\u6e90\u7684\u65f6\u5019\uff0c\u7531\u4e8e\u961f\u5934\u963b\u585e\u5f53\u6d4f\u89c8\u5668\u8fbe\u5230\u6700\u5927\u8bf7\u6c42\u6570\u91cf\u65f6\uff0c\u5269\u4f59\u7684\u8d44\u6e90\u9700\u7b49\u5f85\u5f53\u524d\u7684\u516d\u4e2a\u8bf7\u6c42\u5b8c\u6210\u540e\u624d\u80fd\u53d1\u8d77\u8bf7\u6c42\u3002</p> <p>HTTP2 \u4e2d\u5f15\u5165\u4e86\u591a\u8def\u590d\u7528\u7684\u6280\u672f\uff0c\u8fd9\u4e2a\u6280\u672f\u53ef\u4ee5\u53ea\u901a\u8fc7\u4e00\u4e2a TCP \u8fde\u63a5\u5c31\u53ef\u4ee5\u4f20\u8f93\u6240\u6709\u7684\u8bf7\u6c42\u6570\u636e\u3002\u591a\u8def\u590d\u7528\u53ef\u4ee5\u7ed5\u8fc7\u6d4f\u89c8\u5668\u9650\u5236\u540c\u4e00\u4e2a\u57df\u540d\u4e0b\u7684\u8bf7\u6c42\u6570\u91cf\u7684\u95ee\u9898\uff0c\u8fdb\u800c\u63d0\u9ad8\u4e86\u7f51\u9875\u7684\u6027\u80fd\u3002</p>"},{"location":"chap6/5Linux_network_int/#3-9-sessioncookie-token","title":"3-9 Session\u3001Cookie \u548c Token \u7684\u4e3b\u8981\u533a\u522b","text":"<p>HTTP \u534f\u8bae\u672c\u8eab\u662f\u65e0\u72b6\u6001\u7684\u3002\u4ec0\u4e48\u662f\u65e0\u72b6\u6001\u5462\uff0c\u5373\u670d\u52a1\u5668\u65e0\u6cd5\u5224\u65ad\u7528\u6237\u8eab\u4efd\u3002</p>"},{"location":"chap6/5Linux_network_int/#3-9-1-cookie","title":"3-9-1 \u4ec0\u4e48\u662f Cookie","text":"<p>Cookie \u662f\u7531 Web \u670d\u52a1\u5668\u4fdd\u5b58\u5728\u7528\u6237\u6d4f\u89c8\u5668\u4e0a\u7684\u5c0f\u6587\u4ef6\uff08key-value \u683c\u5f0f\uff09\uff0c\u5305\u542b\u7528\u6237\u76f8\u5173\u7684\u4fe1\u606f\u3002</p> <p>\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u53d1\u8d77\u8bf7\u6c42\uff0c\u5982\u679c\u670d\u52a1\u5668\u9700\u8981\u8bb0\u5f55\u8be5\u7528\u6237\u72b6\u6001\uff0c\u5c31\u4f7f\u7528 response \u5411\u5ba2\u6237\u7aef\u6d4f\u89c8\u5668\u9881\u53d1\u4e00\u4e2a Cookie\u3002</p> <p>\u5ba2\u6237\u7aef\u6d4f\u89c8\u5668\u4f1a\u628a Cookie \u4fdd\u5b58\u8d77\u6765\u3002\u5f53\u6d4f\u89c8\u5668\u518d\u8bf7\u6c42\u8be5\u7f51\u7ad9\u65f6\uff0c\u6d4f\u89c8\u5668\u628a\u8bf7\u6c42\u7684\u7f51\u5740\u8fde\u540c\u8be5 Cookie \u4e00\u540c\u63d0\u4ea4\u7ed9\u670d\u52a1\u5668\u3002\u670d\u52a1\u5668\u68c0\u67e5\u8be5 Cookie\uff0c\u4ee5\u6b64\u6765\u8fa8\u8ba4\u7528\u6237\u8eab\u4efd\u3002</p>"},{"location":"chap6/5Linux_network_int/#3-9-2-session","title":"3-9-2 \u4ec0\u4e48\u662f Session","text":"<p>Session \u662f\u4f9d\u8d56 Cookie \u5b9e\u73b0\u7684\u3002Session \u662f\u670d\u52a1\u5668\u7aef\u5bf9\u8c61\u3002</p> <p>Session \u662f\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u4f1a\u8bdd\u8fc7\u7a0b\u4e2d\uff0c\u670d\u52a1\u5668\u5206\u914d\u7684\u4e00\u5757\u50a8\u5b58\u7a7a\u95f4\u3002</p> <p>\u670d\u52a1\u5668\u9ed8\u8ba4\u4e3a\u6d4f\u89c8\u5668\u5728 Cookie \u4e2d\u8bbe\u7f6e sessionid\uff0c\u6d4f\u89c8\u5668\u5728\u5411\u670d\u52a1\u5668\u8bf7\u6c42\u8fc7\u7a0b\u4e2d\u4f20\u8f93 Cookie \u5305\u542b sessionid \uff0c\u670d\u52a1\u5668\u6839\u636e sessionid \u83b7\u53d6\u51fa\u4f1a\u8bdd\u4e2d\u5b58\u50a8\u7684\u4fe1\u606f\uff0c\u7136\u540e\u786e\u5b9a\u4f1a\u8bdd\u7684\u8eab\u4efd\u4fe1\u606f\u3002</p>"},{"location":"chap6/5Linux_network_int/#3-9-3-cookie-session","title":"3-9-3 Cookie \u4e0e Session \u533a\u522b","text":"<ul> <li>\u5b58\u50a8\u4f4d\u7f6e\u4e0e\u5b89\u5168\u6027\uff1aCookie \u6570\u636e\u5b58\u653e\u5728\u5ba2\u6237\u7aef\u4e0a\uff0c\u5b89\u5168\u6027\u8f83\u5dee\uff0cSession \u6570\u636e\u653e\u5728\u670d\u52a1\u5668\u4e0a\uff0c\u5b89\u5168\u6027\u76f8\u5bf9\u66f4\u9ad8\uff1b</li> <li>\u5b58\u50a8\u7a7a\u95f4\uff1a\u5355\u4e2a Cookie \u4fdd\u5b58\u7684\u6570\u636e\u4e0d\u80fd\u8d85\u8fc74 K\uff0c\u5f88\u591a\u6d4f\u89c8\u5668\u90fd\u9650\u5236\u4e00\u4e2a\u7ad9\u70b9\u6700\u591a\u4fdd\u5b58 20 \u4e2a Cookie\uff0cSession \u65e0\u6b64\u9650\u5236</li> <li>\u5360\u7528\u670d\u52a1\u5668\u8d44\u6e90\uff1aSession \u4e00\u5b9a\u65f6\u95f4\u5185\u4fdd\u5b58\u5728\u670d\u52a1\u5668\u4e0a\uff0c\u5f53\u8bbf\u95ee\u589e\u591a\uff0c\u5360\u7528\u670d\u52a1\u5668\u6027\u80fd\uff0c\u8003\u8651\u5230\u670d\u52a1\u5668\u6027\u80fd\u65b9\u9762\uff0c\u5e94\u5f53\u4f7f\u7528 Cookie\u3002</li> </ul>"},{"location":"chap6/5Linux_network_int/#3-9-4-token","title":"3-9-4 \u4ec0\u4e48\u662f Token","text":"<p>Token \u7684\u5f15\u5165\uff1aToken \u662f\u5728\u5ba2\u6237\u7aef\u9891\u7e41\u5411\u670d\u52a1\u7aef\u8bf7\u6c42\u6570\u636e\uff0c\u670d\u52a1\u7aef\u9891\u7e41\u7684\u53bb\u6570\u636e\u5e93\u67e5\u8be2\u7528\u6237\u540d\u548c\u5bc6\u7801\u5e76\u8fdb\u884c\u5bf9\u6bd4\uff0c\u5224\u65ad\u7528\u6237\u540d\u548c\u5bc6\u7801\u6b63\u786e\u4e0e\u5426\uff0c\u5e76\u4f5c\u51fa\u76f8\u5e94\u63d0\u793a\uff0c\u5728\u8fd9\u6837\u7684\u80cc\u666f\u4e0b\uff0cToken \u4fbf\u5e94\u8fd0\u800c\u751f\u3002</p> <p>Token \u7684\u5b9a\u4e49\uff1aToken \u662f\u670d\u52a1\u7aef\u751f\u6210\u7684\u4e00\u4e32\u5b57\u7b26\u4e32\uff0c\u4ee5\u4f5c\u5ba2\u6237\u7aef\u8fdb\u884c\u8bf7\u6c42\u7684\u4e00\u4e2a\u4ee4\u724c\uff0c\u5f53\u7b2c\u4e00\u6b21\u767b\u5f55\u540e\uff0c\u670d\u52a1\u5668\u751f\u6210\u4e00\u4e2a Token \u4fbf\u5c06\u6b64 Token \u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u4ee5\u540e\u5ba2\u6237\u7aef\u53ea\u9700\u5e26\u4e0a\u8fd9\u4e2a Token \u524d\u6765\u8bf7\u6c42\u6570\u636e\u5373\u53ef\uff0c\u65e0\u9700\u518d\u6b21\u5e26\u4e0a\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002</p> <p>\u4f7f\u7528 Token \u7684\u76ee\u7684\uff1aToken \u7684\u76ee\u7684\u662f\u4e3a\u4e86\u51cf\u8f7b\u670d\u52a1\u5668\u7684\u538b\u529b\uff0c\u51cf\u5c11\u9891\u7e41\u7684\u67e5\u8be2\u6570\u636e\u5e93\uff0c\u4f7f\u670d\u52a1\u5668\u66f4\u52a0\u5065\u58ee\u3002</p> <p>Token \u662f\u5728\u670d\u52a1\u7aef\u4ea7\u751f\u7684\u3002\u5982\u679c\u524d\u7aef\u4f7f\u7528\u7528\u6237\u540d/\u5bc6\u7801\u5411\u670d\u52a1\u7aef\u8bf7\u6c42\u8ba4\u8bc1\uff0c\u670d\u52a1\u7aef\u8ba4\u8bc1\u6210\u529f\uff0c\u90a3\u4e48\u5728\u670d\u52a1\u7aef\u4f1a\u8fd4\u56de Token \u7ed9\u524d\u7aef\u3002\u524d\u7aef\u53ef\u4ee5\u5728\u6bcf\u6b21\u8bf7\u6c42\u7684\u65f6\u5019\u5e26\u4e0a Token \u8bc1\u660e\u81ea\u5df1\u7684\u5408\u6cd5\u5730\u4f4d\u3002</p>"},{"location":"chap6/5Linux_network_int/#3-9-5-session-token","title":"3-9-5 Session \u4e0e Token \u533a\u522b","text":"<p>Session \u673a\u5236\u5b58\u5728\u670d\u52a1\u5668\u538b\u529b\u589e\u5927\uff0cCSRF \u8de8\u7ad9\u4f2a\u9020\u8bf7\u6c42\u653b\u51fb\uff0c\u6269\u5c55\u6027\u4e0d\u5f3a\u7b49\u95ee\u9898\uff1b</p> <p>Session \u5b58\u50a8\u5728\u670d\u52a1\u5668\u7aef\uff0cToken \u5b58\u50a8\u5728\u5ba2\u6237\u7aef</p> <p>Token \u63d0\u4f9b\u8ba4\u8bc1\u548c\u6388\u6743\u529f\u80fd\uff0c\u4f5c\u4e3a\u8eab\u4efd\u8ba4\u8bc1\uff0cToken \u5b89\u5168\u6027\u6bd4 Session \u597d\uff1b</p> <p>Session\u8fd9\u79cd\u4f1a\u8bdd\u5b58\u50a8\u65b9\u5f0f\u65b9\u5f0f\u53ea\u9002\u7528\u4e8e\u5ba2\u6237\u7aef\u4ee3\u7801\u548c\u670d\u52a1\u7aef\u4ee3\u7801\u8fd0\u884c\u5728\u540c\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\uff0cToken \u9002\u7528\u4e8e\u9879\u76ee\u7ea7\u7684\u524d\u540e\u7aef\u5206\u79bb\uff08\u524d\u540e\u7aef\u4ee3\u7801\u8fd0\u884c\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0b\uff09</p>"},{"location":"chap6/5Linux_network_int/#3-9-6-servlet","title":"3-9-6 Servlet \u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u5417\uff1f","text":"<p>Servlet \u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u591a\u7ebf\u7a0b\u5e76\u53d1\u7684\u8bfb\u5199\u4f1a\u5bfc\u81f4\u6570\u636e\u4e0d\u540c\u6b65\u7684\u95ee\u9898\u3002</p> <p>\u89e3\u51b3\u7684\u529e\u6cd5\u662f\u5c3d\u91cf\u4e0d\u8981\u5b9a\u4e49 name \u5c5e\u6027\uff0c\u800c\u662f\u8981\u628a name \u53d8\u91cf\u5206\u522b\u5b9a\u4e49\u5728 doGet() \u548c doPost() \u65b9\u6cd5\u5185\u3002\u867d\u7136\u4f7f\u7528 synchronized(name){} \u8bed\u53e5\u5757\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\uff0c\u4f46\u662f\u4f1a\u9020\u6210\u7ebf\u7a0b\u7684\u7b49\u5f85\uff0c\u4e0d\u662f\u5f88\u79d1\u5b66\u7684\u529e\u6cd5\u3002</p> <p>\u6ce8\u610f\uff1a\u591a\u7ebf\u7a0b\u7684\u5e76\u53d1\u7684\u8bfb\u5199 Servlet \u7c7b\u5c5e\u6027\u4f1a\u5bfc\u81f4\u6570\u636e\u4e0d\u540c\u6b65\u3002\u4f46\u662f\u5982\u679c\u53ea\u662f\u5e76\u53d1\u5730\u8bfb\u53d6\u5c5e\u6027\u800c\u4e0d\u5199\u5165\uff0c\u5219\u4e0d\u5b58\u5728\u6570\u636e\u4e0d\u540c\u6b65\u7684\u95ee\u9898\u3002\u56e0\u6b64 Servlet \u91cc\u7684\u53ea\u8bfb\u5c5e\u6027\u6700\u597d\u5b9a\u4e49\u4e3a final \u7c7b\u578b\u7684\u3002</p>"},{"location":"chap6/5Linux_network_int/#3-9-7-servlet-servlet","title":"3-9-7 Servlet \u63a5\u53e3\u4e2d\u6709\u54ea\u4e9b\u65b9\u6cd5\u53ca Servlet \u751f\u547d\u5468\u671f\u63a2\u79d8","text":"<p>\u5728 Java Web \u7a0b\u5e8f\u4e2d\uff0cServlet \u4e3b\u8981\u8d1f\u8d23\u63a5\u6536\u7528\u6237\u8bf7\u6c42 HttpServletRequest\uff0c\u5728 doGet()\uff0cdoPost() \u4e2d\u505a\u76f8\u5e94\u7684\u5904\u7406\uff0c\u5e76\u5c06\u56de\u5e94 HttpServletResponse \u53cd\u9988\u7ed9\u7528\u6237\u3002Servlet \u53ef\u4ee5\u8bbe\u7f6e\u521d\u59cb\u5316\u53c2\u6570\uff0c\u4f9b Servlet \u5185\u90e8\u4f7f\u7528\u3002</p> <p>Servlet \u63a5\u53e3\u5b9a\u4e49\u4e86 5 \u4e2a\u65b9\u6cd5\uff0c\u5176\u4e2d\u524d\u4e09\u4e2a\u65b9\u6cd5\u4e0e Servlet \u751f\u547d\u5468\u671f\u76f8\u5173\uff1a</p> <ul> <li>void init(ServletConfig config) throws ServletException</li> <li>void service(ServletRequest req, ServletResponse resp) throws ServletException, java.io.IOException</li> <li>void destory()</li> <li>java.lang.String getServletInfo()</li> <li>ServletConfig getServletConfig()</li> </ul> <p>\u751f\u547d\u5468\u671f\uff1a</p> <p>Web \u5bb9\u5668\u52a0\u8f7d Servlet \u5e76\u5c06\u5176\u5b9e\u4f8b\u5316\u540e\uff0cServlet \u751f\u547d\u5468\u671f\u5f00\u59cb\uff0c\u5bb9\u5668\u8fd0\u884c\u5176 init() \u65b9\u6cd5\u8fdb\u884c Servlet \u7684\u521d\u59cb\u5316\uff1b</p> <p>\u8bf7\u6c42\u5230\u8fbe\u65f6\u8c03\u7528 Servlet \u7684 service() \u65b9\u6cd5\uff0cservice() \u65b9\u6cd5\u4f1a\u6839\u636e\u9700\u8981\u8c03\u7528\u4e0e\u8bf7\u6c42\u5bf9\u5e94\u7684 doGet \u6216 doPost \u7b49\u65b9\u6cd5\uff1b</p> <p>\u5f53\u670d\u52a1\u5668\u5173\u95ed\u6216\u9879\u76ee\u88ab\u5378\u8f7d\u65f6\u670d\u52a1\u5668\u4f1a\u5c06 Servlet \u5b9e\u4f8b\u9500\u6bc1\uff0c\u6b64\u65f6\u4f1a\u8c03\u7528 Servlet \u7684 destroy() \u65b9\u6cd5\u3002</p> <p>init \u65b9\u6cd5\u548c destory \u65b9\u6cd5\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\uff0cservice \u65b9\u6cd5\u5ba2\u6237\u7aef\u6bcf\u6b21\u8bf7\u6c42 Servlet \u90fd\u4f1a\u6267\u884c\u3002Servlet \u4e2d\u6709\u65f6\u4f1a\u7528\u5230\u4e00\u4e9b\u9700\u8981\u521d\u59cb\u5316\u4e0e\u9500\u6bc1\u7684\u8d44\u6e90\uff0c\u56e0\u6b64\u53ef\u4ee5\u628a\u521d\u59cb\u5316\u8d44\u6e90\u7684\u4ee3\u7801\u653e\u5165 init \u65b9\u6cd5\u4e2d\uff0c\u9500\u6bc1\u8d44\u6e90\u7684\u4ee3\u7801\u653e\u5165 destroy \u65b9\u6cd5\u4e2d\uff0c\u8fd9\u6837\u5c31\u4e0d\u9700\u8981\u6bcf\u6b21\u5904\u7406\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u90fd\u8981\u521d\u59cb\u5316\u4e0e\u9500\u6bc1\u8d44\u6e90\u3002</p>"},{"location":"chap6/5Linux_network_int/#3-10-cookie-session","title":"3-10 \u5982\u679c\u5ba2\u6237\u7aef\u7981\u6b62 Cookie \u80fd\u5b9e\u73b0 Session \u8fd8\u80fd\u7528\u5417\uff1f","text":"<p>Cookie \u4e0e Session\uff0c\u4e00\u822c\u8ba4\u4e3a\u662f\u4e24\u4e2a\u72ec\u7acb\u7684\u4e1c\u897f\uff0cSession \u91c7\u7528\u7684\u662f\u5728\u670d\u52a1\u5668\u7aef\u4fdd\u6301\u72b6\u6001\u7684\u65b9\u6848\uff0c\u800c Cookie \u91c7\u7528\u7684\u662f\u5728\u5ba2\u6237\u7aef\u4fdd\u6301\u72b6\u6001\u7684\u65b9\u6848\u3002</p> <p>\u4f46\u4e3a\u4ec0\u4e48\u7981\u7528 Cookie \u5c31\u4e0d\u80fd\u5f97\u5230 Session \u5462\uff1f\u56e0\u4e3a Session \u662f\u7528 Session ID \u6765\u786e\u5b9a\u5f53\u524d\u5bf9\u8bdd\u6240\u5bf9\u5e94\u7684\u670d\u52a1\u5668 Session\uff0c\u800c Session ID \u662f\u901a\u8fc7 Cookie \u6765\u4f20\u9012\u7684\uff0c\u7981\u7528 Cookie \u76f8\u5f53\u4e8e\u5931\u53bb\u4e86 Session ID\uff0c\u4e5f\u5c31\u5f97\u4e0d\u5230 Session \u4e86\u3002</p> <p>\u5047\u5b9a\u7528\u6237\u5173\u95ed Cookie \u7684\u60c5\u51b5\u4e0b\u4f7f\u7528 Session\uff0c\u5176\u5b9e\u73b0\u9014\u5f84\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> <ul> <li>\u624b\u52a8\u901a\u8fc7 URL \u4f20\u503c\u3001\u9690\u85cf\u8868\u5355\u4f20\u9012 Session ID\u3002</li> <li>\u7528\u6587\u4ef6\u3001\u6570\u636e\u5e93\u7b49\u5f62\u5f0f\u4fdd\u5b58 Session ID\uff0c\u5728\u8de8\u9875\u8fc7\u7a0b\u4e2d\u624b\u52a8\u8c03\u7528\u3002</li> </ul>"},{"location":"chap6/5Linux_network_int/#linux","title":"Linux \u2018\u7f51\u7edc\u914d\u7f6e\u2019 \u548c \u2018\u6545\u969c\u6392\u9664\u2019 \u547d\u4ee4\u603b\u7ed3","text":""},{"location":"chap6/5Linux_network_int/#ifconfig","title":"ifconfig","text":"<p>ifconfig\u547d\u4ee4 \u88ab\u7528\u4e8e\u914d\u7f6e\u548c\u663e\u793aLinux\u5185\u6838\u4e2d\u7f51\u7edc\u63a5\u53e3\u7684\u7f51\u7edc\u53c2\u6570\u3002\u7528ifconfig\u547d\u4ee4\u914d\u7f6e\u7684\u7f51\u5361\u4fe1\u606f\uff0c\u5728\u7f51\u5361\u91cd\u542f\u540e\u673a\u5668\u91cd\u542f\u540e\uff0c\u914d\u7f6e\u5c31\u4e0d\u5b58\u5728\u3002\u8981\u60f3\u5c06\u4e0a\u8ff0\u7684\u914d\u7f6e\u4fe1\u606f\u6c38\u8fdc\u7684\u5b58\u7684\u7535\u8111\u91cc\uff0c\u90a3\u5c31\u8981\u4fee\u6539\u7f51\u5361\u7684\u914d\u7f6e\u6587\u4ef6\u4e86\u3002</p> <pre><code># ifconfig\n\neth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 172.24.186.123  netmask 255.255.240.0  broadcast 172.24.191.255\n        ether 00:16:3e:24:5d:8c  txqueuelen 1000  (Ethernet)\n        RX packets 36773275  bytes 9755326821 (9.0 GiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 31552596  bytes 6792314542 (6.3 GiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 36893510  bytes 27158894604 (25.2 GiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 36893510  bytes 27158894604 (25.2 GiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n</code></pre> <p>ifconfig \u5e26\u7f51\u53e3\uff08eth0) \u547d\u4ee4\u4ec5\u663e\u793a\u7279\u5b9a\u7684\u63a5\u53e3\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982 IP Address, MAC Address \u7b49\u4e0e -a \u5982\u679c\u5b83\u4e5f\u88ab\u7981\u7528\uff0c\u9009\u9879\u5c06\u663e\u793a\u6240\u6709\u53ef\u7528\u7684\u63a5\u53e3\u8be6\u7ec6\u4fe1\u606f\u3002</p> <pre><code># ifconfig eth0\n</code></pre>"},{"location":"chap6/5Linux_network_int/#ip","title":"\u5206\u914d IP \u5730\u5740\u548c\u7f51\u5173","text":"<p>\u5206\u914d\u4e00\u4e2a IP Address \u548c Gateway\u5373\u65f6\u63a5\u53e3\u3002\u5982\u679c\u7cfb\u7edf\u91cd\u65b0\u542f\u52a8\uff0c\u8be5\u8bbe\u7f6e\u5c06\u88ab\u5220\u9664\u3002</p> <pre><code># ifconfig eth0 192.168.1.110 netmask 255.255.255.0\n</code></pre>"},{"location":"chap6/5Linux_network_int/#_2","title":"\u542f\u7528\u6216\u7981\u7528\u7279\u5b9a\u7f51\u53e3","text":"<p>enable \u6216\u8005 disable \uff0c\u6211\u4eec\u4f7f\u7528\u793a\u4f8b\u547d\u4ee4\u5982\u4e0b\u3002</p> <p>\u542f\u7528 eth0</p> <pre><code># ifup eth0\n</code></pre> <p>\u7981\u7528 eth0</p> <pre><code># ifdown eth0\n</code></pre>"},{"location":"chap6/5Linux_network_int/#mtu","title":"\u8bbe\u7f6e MTU \u5927\u5c0f","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b MTU \u5927\u5c0f\u662f 1500. \u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u6240\u9700MTU\u5927\u5c0f\u4e0e\u4ee5\u4e0b\u547d\u4ee4\u3002\u4ee3\u66ffXXXX \u4e0e\u5927\u5c0f\u3002</p> <pre><code># ifconfig eth0 mtu XXXX\n</code></pre>"},{"location":"chap6/5Linux_network_int/#_3","title":"\u5c06\u63a5\u53e3\u8bbe\u7f6e\u4e3a\u6df7\u6742\u6a21\u5f0f","text":"<p>Network interface \u53ea\u6709\u6536\u5230\u7684\u6570\u636e\u5305\u5c5e\u4e8e\u90a3\u4e2a\u7279\u5b9a\u7684 NIC. \u5982\u679c\u4f60\u628a\u63a5\u53e3promiscuous\u6a21\u5f0f\u5b83\u5c06\u63a5\u6536\u6240\u6709\u7684\u6570\u636e\u5305\u3002\u8fd9\u5bf9\u4e8e\u6355\u83b7\u6570\u636e\u5305\u548c\u7a0d\u540e\u5206\u6790\u975e\u5e38\u6709\u7528\u3002\u4e3a\u6b64\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u8d85\u7ea7\u7528\u6237\u8bbf\u95ee\u6743\u9650\u3002</p> <pre><code># ifconfig eth0 - promisc\n</code></pre>"},{"location":"chap6/5Linux_network_int/#2-ping","title":"2. ping \u547d\u4ee4","text":"<p>ping\u547d\u4ee4 \u7528\u6765\u6d4b\u8bd5\u4e3b\u673a\u4e4b\u95f4\u7f51\u7edc\u7684\u8fde\u901a\u6027\u3002\u6267\u884cping\u6307\u4ee4\u4f1a\u4f7f\u7528ICMP\u4f20\u8f93\u534f\u8bae\uff0c\u53d1\u51fa\u8981\u6c42\u56de\u5e94\u7684\u4fe1\u606f\uff0c\u82e5\u8fdc\u7aef\u4e3b\u673a\u7684\u7f51\u7edc\u529f\u80fd\u6ca1\u6709\u95ee\u9898\uff0c\u5c31\u4f1a\u56de\u5e94\u8be5\u4fe1\u606f\uff0c\u56e0\u800c\u5f97\u77e5\u8be5\u4e3b\u673a\u8fd0\u4f5c\u6b63\u5e38\u3002</p> <pre><code># ping 127.0.0.1\n\u6216\n# ping www.rumenz.com\n</code></pre> <p>\u5728 Linuxping \u547d\u4ee4\u4e00\u76f4\u6267\u884c\uff0c\u76f4\u5230\u60a8\u4e2d\u65ad\u3002\u5e73\u4e0e<code>-c</code>\u9009\u9879\u9000\u51fa\u540e <code>N</code>\u8bf7\u6c42\u6570\uff08\u6210\u529f\u6216\u9519\u8bef\u54cd\u5e94\uff09\u3002</p> <pre><code># ping -c 5 www.rumenz.com\nPING www.rumenz.com (42.194.162.109) 56(84) bytes of data.\n64 bytes from 42.194.162.109 (42.194.162.109): icmp_seq=1 ttl=52 time=35.8 ms\n64 bytes from 42.194.162.109 (42.194.162.109): icmp_seq=2 ttl=52 time=35.6 ms\n64 bytes from 42.194.162.109 (42.194.162.109): icmp_seq=3 ttl=52 time=35.6 ms\n64 bytes from 42.194.162.109 (42.194.162.109): icmp_seq=4 ttl=52 time=35.6 ms\n64 bytes from 42.194.162.109 (42.194.162.109): icmp_seq=5 ttl=52 time=35.6 ms\n\n--- www.rumenz.com ping statistics ---\n5 packets transmitted, 5 received, 0% packet loss, time 4004ms\nrtt min/avg/max/mdev = 35.662/35.720/35.893/0.190 ms\n</code></pre>"},{"location":"chap6/5Linux_network_int/#3-traceroute","title":"3. traceroute \u547d\u4ee4","text":"<p>traceroute\u662f\u4e00\u4e2a\u7f51\u7edc\u6545\u969c\u6392\u9664\u5b9e\u7528\u7a0b\u5e8f\uff0c\u5b83\u663e\u793a\u5230\u8fbe\u76ee\u7684\u5730\u6240\u7528\u7684\u8df3\u6570\uff0c\u4e5f\u51b3\u5b9a\u4e86\u6570\u636e\u5305\u7684\u4f20\u64ad\u8def\u5f84\u3002\u4e0b\u9762\u6211\u4eec\u6b63\u5728\u8ffd\u8e2a\u901a\u5f80\u5168\u7403\u7684\u8def\u7ebfDNS server IP Address \u5e76\u4e14\u80fd\u591f\u5230\u8fbe\u76ee\u7684\u5730\u8fd8\u663e\u793a\u8be5\u6570\u636e\u5305\u6b63\u5728\u65c5\u884c\u7684\u8def\u5f84\u3002</p> <pre><code># traceroute 8.8.8.8\n</code></pre>"},{"location":"chap6/5Linux_network_int/#4-netstat","title":"4. netstat \u547d\u4ee4","text":"<pre><code>netstat\u547d\u4ee4 \u7528\u6765\u6253\u5370Linux\u4e2d\u7f51\u7edc\u7cfb\u7edf\u7684\u72b6\u6001\u4fe1\u606f\uff0c\u53ef\u8ba9\u4f60\u5f97\u77e5\u6574\u4e2aLinux\u7cfb\u7edf\u7684\u7f51\u7edc\u60c5\u51b5\u3002\n</code></pre> <pre><code># netstat -r\nKernel IP routing table\nDestination     Gateway         Genmask         Flags   MSS Window  irtt Iface\ndefault         gateway         0.0.0.0         UG        0 0          0 eth0\nlink-local      0.0.0.0         255.255.0.0     U         0 0          0 eth0\n172.24.176.0    0.0.0.0         255.255.240.0   U         0 0          0 eth0\n</code></pre>"},{"location":"chap6/5Linux_network_int/#5-dig","title":"5. dig \u547d\u4ee4","text":"<p>dig\u547d\u4ee4 \u662f\u5e38\u7528\u7684\u57df\u540d\u67e5\u8be2\u5de5\u5177\uff0c\u53ef\u4ee5\u7528\u6765\u6d4b\u8bd5\u57df\u540d\u7cfb\u7edf\u5de5\u4f5c\u662f\u5426\u6b63\u5e38\u3002</p> <pre><code># dig www.rumenz.com\n\n; &lt;&lt;&gt;&gt; DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.7 &lt;&lt;&gt;&gt; www.rumenz.com\n;; global options: +cmd\n;; Got answer:\n;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 11798\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0\n\n;; QUESTION SECTION:\n;www.rumenz.com.                        IN      A\n\n;; ANSWER SECTION:\nwww.rumenz.com.         583     IN      A       42.194.162.109\n\n;; Query time: 0 msec\n;; SERVER: 100.100.2.136#53(100.100.2.136)\n;; WHEN: Sat Nov 20 21:45:32 CST 2021\n;; MSG SIZE  rcvd: 48\n</code></pre>"},{"location":"chap6/5Linux_network_int/#6-nslookup","title":"6. nslookup \u547d\u4ee4","text":"<p>nslookup \u547d\u4ee4\u4e5f\u7528\u4e8e\u627e\u51fa DNS\u76f8\u5173\u67e5\u8be2\u3002\u4e0b\u9762\u7684\u4f8b\u5b50\u663e\u793aA Record (IP Address\uff09 \u7684 rumenz.com.</p> <pre><code># nslookup www.rumenz.com\nServer:         100.100.2.136\nAddress:        100.100.2.136#53\n\nNon-authoritative answer:\nName:   www.rumenz.com\nAddress: 42.194.162.109\n</code></pre>"},{"location":"chap6/5Linux_network_int/#7-route","title":"7. route\u547d\u4ee4","text":"<p>route \u547d\u4ee4\u8fd8\u663e\u793a\u548c\u64cd\u4f5c ip\u8def\u7531\u8868\u3002\u67e5\u770b\u9ed8\u8ba4\u8def\u7531\u8868Linux</p> <pre><code># route\n</code></pre> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6dfb\u52a0\u3001\u5220\u9664\u8def\u7531\u548c\u9ed8\u8ba4\u7f51\u5173\u3002</p> <pre><code># route add -net 10.10.10.0/24 gw 192.168.0.1\n</code></pre> <p>\u5220\u9664\u8def\u7531</p> <pre><code># route del -net 10.10.10.0/24 gw 192.168.0.1\n</code></pre> <p>\u6dfb\u52a0\u9ed8\u8ba4\u7f51\u5173</p> <pre><code># route add default gw 192.168.0.1\n</code></pre>"},{"location":"chap6/5Linux_network_int/#8-host","title":"8. host\u547d\u4ee4","text":"<p>host \u67e5\u627e\u540d\u79f0\u7684\u547d\u4ee4 IP \u6216\u8005 IP \u547d\u540d IPv4 \u6216\u8005 IPv6 \u5e76\u67e5\u8be2 DNS \u8bb0\u5f55\u3002</p> <pre><code># host www.rumenz.com\nwww.rumenz.com has address 42.194.162.109\n</code></pre> <p>\u4f7f\u7528 -t \u9009\u9879\u6211\u4eec\u53ef\u4ee5\u627e\u51fa DNS \u8d44\u6e90\u8bb0\u5f55\uff0c\u4f8b\u5982 CNAME, NS, MX, SOA \u7b49\u7b49\u3002</p> <pre><code>//\u5148\u5b89\u88c5\n# yum install bind-utils -y\n# host -t CNAME www.baidu.com\nwww.baidu.com is an alias for www.a.shifen.com.\n</code></pre>"},{"location":"chap6/5Linux_network_int/#9-arp","title":"9. arp \u547d\u4ee4","text":"<p>arp \u547d\u4ee4 \u662f Address Resolution Protocol\uff0c\u5730\u5740\u89e3\u6790\u534f\u8bae\uff0c\u662f\u901a\u8fc7\u89e3\u6790\u7f51\u7edc\u5c42\u5730\u5740\u6765\u627e\u5bfb\u6570\u636e\u94fe\u8def\u5c42\u5730\u5740\u7684\u4e00\u4e2a\u7f51\u7edc\u534f\u8bae\u5305\u4e2d\u6781\u5176\u91cd\u8981\u7684\u7f51\u7edc\u4f20\u8f93\u534f\u8bae\u3002\u800c\u8be5\u547d\u4ee4\u53ef\u4ee5\u663e\u793a\u548c\u4fee\u6539 arp \u534f\u8bae\u89e3\u6790\u8868\u4e2d\u7684\u7f13\u51b2\u6570\u636e\u3002</p> <pre><code># arp -e\nAddress                  HWtype  HWaddress           Flags Mask            Iface\ngateway                  ether   ee:ff:ff:ff:ff:ff   C                     eth0\n</code></pre>"},{"location":"chap6/5Linux_network_int/#10-ethtool","title":"10. ethtool \u547d\u4ee4","text":"<p>ethtool\u547d\u4ee4\u7528\u4e8e\u83b7\u53d6\u4ee5\u592a\u7f51\u5361\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u6216\u8005\u4fee\u6539\u8fd9\u4e9b\u914d\u7f6e\u3002\u8fd9\u4e2a\u547d\u4ee4\u6bd4\u8f83\u590d\u6742\uff0c\u529f\u80fd\u7279\u522b\u591a\u3002</p> <pre><code># ethtool eth0\nSettings for eth0:\n        Link detected: yes\n</code></pre>"},{"location":"chap6/5Linux_network_int/#11-iwconfig","title":"11. iwconfig \u547d\u4ee4","text":"<p>iwconfig  \u7cfb\u7edf\u914d\u7f6e\u65e0\u7ebf\u7f51\u7edc\u8bbe\u5907\u6216\u663e\u793a\u65e0\u7ebf\u7f51\u7edc\u8bbe\u5907\u4fe1\u606f\u3002iwconfig \u547d\u4ee4\u7c7b\u4f3c\u4e8eifconfig\u547d\u4ee4\uff0c\u4f46\u662f\u4ed6\u914d\u7f6e\u5bf9\u8c61\u662f\u65e0\u7ebf\u7f51\u5361\uff0c\u5b83\u5bf9\u7f51\u7edc\u8bbe\u5907\u8fdb\u884c\u65e0\u7ebf\u64cd\u4f5c\uff0c\u5982\u8bbe\u7f6e\u65e0\u7ebf\u901a\u4fe1\u9891\u6bb5</p> <pre><code>\n//\u5148\u5b89\u88c5\n# yum install -y wireless-tools\n# iwconfig [interface]\neth0      no wireless extensions.\n</code></pre>"},{"location":"chap6/5Linux_network_int/#12-hostname","title":"12. hostname \u547d\u4ee4","text":"<p>hostname\u662f\u5728\u7f51\u7edc\u4e2d\u8bc6\u522b\u3002\u6267\u884chostname\u547d\u4ee4\u4ee5\u67e5\u770b\u673a\u5668\u7684\u4e3b\u673a\u540d\u3002\u53ef\u4ee5\u5728\u5176\u4e2d\u6c38\u4e45\u8bbe\u7f6e\u4e3b\u673a\u540d<code>/etc/sysconfig/network.</code> \u8bbe\u7f6e\u6b63\u786e\u7684\u4e3b\u673a\u540d\u540e\u9700\u8981\u91cd\u65b0\u542f\u52a8\u3002</p> <pre><code># hostname\nrumenz.com\n</code></pre>"},{"location":"chap6/6Git_principle/","title":"L6 Git \u5b9e\u7528\u6280\u5de7\u8bb0\u5f55","text":"<p>Git Flow\uff1a</p> <ul> <li>\u4e3b\u5e72\u5206\u652f</li> <li>\u7a33\u5b9a\u5206\u652f</li> <li>\u5f00\u53d1\u5206\u652f</li> <li>\u8865\u4e01\u5206\u652f</li> <li>\u4fee\u6539\u5206\u652f</li> </ul> <p></p> <p>GitHub Flow\uff1a</p> <ul> <li>\u521b\u5efa\u5206\u652f</li> <li>\u6dfb\u52a0\u63d0\u4ea4</li> <li>\u63d0\u4ea4 PR \u8bf7\u6c42</li> <li>\u8ba8\u8bba\u548c\u8bc4\u4f30\u4ee3\u7801</li> <li>\u90e8\u7f72\u68c0\u6d4b</li> <li>\u5408\u5e76\u4ee3\u7801</li> </ul> <p></p> <ul> <li>\u5e26\u751f\u4ea7\u5206\u652f</li> <li>\u5e26\u73af\u5883\u5206\u652f</li> <li>\u5e26\u53d1\u5e03\u5206\u652f</li> </ul>"},{"location":"chap6/6Git_principle/#1","title":"1\u3001\u65e5\u5e38\u4f7f\u7528\u6700\u4f73\u5b9e\u8df5","text":"<p>\u4f7f\u7528\u547d\u4ee4\u884c\u4ee3\u66ff\u56fe\u5f62\u5316\u754c\u9762\uff1a</p> <ul> <li>\u4f7f\u7528\u547d\u4ee4\u884c\u6765\u64cd\u4f5c\uff0c\u7b80\u6d01\u4e14\u6548\u7387\u9ad8</li> </ul> <p>\u63d0\u4ea4\u5e94\u8be5\u5c3d\u53ef\u80fd\u7684\u8868\u8ff0\u63d0\u4ea4\u4fee\u6539\u5185\u5bb9\uff1a</p> <ul> <li>\u533a\u5206 subject \u548c body \u5185\u5bb9\uff0c\u4f7f\u7528\u7a7a\u884c\u9694\u5f00</li> <li>subject \u4e00\u822c\u4e0d\u8d85\u8fc7 50 \u4e2a\u5b57\u7b26</li> <li>body \u6bcf\u4e00\u884c\u7684\u957f\u5ea6\u63a7\u5236\u5728 72 \u4e2a\u5b57\u7b26</li> <li>subject \u7ed3\u5c3e\u4e0d\u9700\u8981\u4f7f\u7528\u53e5\u53f7\u6216\u8005\u70b9\u53f7\u7ed3\u5c3e</li> <li>body \u7528\u6765\u8be6\u7ec6\u89e3\u91ca\u6b64\u6b21\u63d0\u4ea4\u5177\u4f53\u505a\u4e86\u4ec0\u4e48</li> </ul> <p>\u4f7f\u7528 <code>.gitignore</code> \u6587\u4ef6\u6765\u6392\u9664\u65e0\u7528\u6587\u4ef6\uff1a</p> <ul> <li>\u53ef\u4f7f\u7528\u6a21\u677f\u6587\u4ef6\uff0c\u7136\u540e\u6839\u636e\u9879\u76ee\u5b9e\u9645\u8fdb\u884c\u4fee\u6539</li> </ul> <p>\u57fa\u4e8e\u5206\u652f\u6216 fork \u7684\u5f00\u53d1\u6a21\u5f0f\uff1a</p> <ul> <li>\u4e0d\u8981\u76f4\u63a5\u5728\u4e3b\u5e72\u5206\u652f\u4e0a\u9762\u8fdb\u884c\u5f00\u53d1</li> <li>\u5728\u65b0\u5efa\u7684\u5206\u652f\u4e0a\u8fdb\u884c\u529f\u80fd\u7684\u5f00\u53d1\u548c\u95ee\u9898\u7684\u4fee\u590d</li> </ul> <p>\u4f7f\u7528 release \u5206\u652f\u548c tag \u6807\u8bb0\u8fdb\u884c\u7248\u672c\u7ba1\u7406\uff1a</p> <ul> <li>\u4f7f\u7528 release \u5206\u652f\u53d1\u5e03\u4ee3\u7801\u548c\u7248\u672c\u7ef4\u62a4\uff08release/1.32\uff09</li> <li>\u4f7f\u7528 tag \u6765\u6807\u8bb0\u7248\u672c\uff08A-\u5927 feature \u529f\u80fd\uff1bB-\u5c0f feature \u529f\u80fd\uff1bC-\u53ea\u4fee bug\uff09</li> </ul>"},{"location":"chap6/6Git_principle/#2","title":"2\u3001\u5e38\u7528\u547d\u4ee4\u6c47\u603b\u6574\u7406","text":"<p>\u65e5\u5e38\u4f7f\u7528\u53ea\u8981\u8bb0\u4f4f 6 \u4e2a\u547d\u4ee4\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p></p> <pre><code># \u5de5\u4f5c\u533a -&gt; \u6682\u5b58\u533a\n$ git add &lt;file/dir&gt;\n\n# \u6682\u5b58\u533a -&gt; \u672c\u5730\u4ed3\u5e93\n$ git commit -m \"some info\"\n\n# \u672c\u5730\u4ed3\u5e93 -&gt; \u8fdc\u7a0b\u4ed3\u5e93\n$ git push origin master  # \u672c\u5730 master \u5206\u652f\u63a8\u9001\u5230\u8fdc\u7a0b origin \u4ed3\u5e93\n</code></pre> <pre><code># \u5de5\u4f5c\u533a &lt;- \u6682\u5b58\u533a\n$ git checkout -- &lt;file&gt;  # \u6682\u5b58\u533a\u6587\u4ef6\u5185\u5bb9\u8986\u76d6\u5de5\u4f5c\u533a\u6587\u4ef6\u5185\u5bb9\n\n# \u6682\u5b58\u533a &lt;- \u672c\u5730\u4ed3\u5e93\n$ git reset HEAD &lt;file&gt;   # \u672c\u5730\u4ed3\u5e93\u6587\u4ef6\u5185\u5bb9\u8986\u76d6\u6682\u5b58\u533a\u6587\u4ef6\u5185\u5bb9\n\n# \u672c\u5730\u4ed3\u5e93 &lt;- \u8fdc\u7a0b\u4ed3\u5e93\n$ git clone &lt;git_url&gt;        # \u514b\u9686\u8fdc\u7a0b\u4ed3\u5e93\n$ git fetch upstream master  # \u62c9\u53d6\u8fdc\u7a0b\u4ee3\u7801\u5230\u672c\u5730\u4f46\u4e0d\u5e94\u7528\u5728\u5f53\u524d\u5206\u652f\n$ git pull upstream master   # \u62c9\u53d6\u8fdc\u7a0b\u4ee3\u7801\u5230\u672c\u5730\u4f46\u5e94\u7528\u5728\u5f53\u524d\u5206\u652f\n$ git pull --rebase upstream master  # \u5982\u679c\u5e73\u65f6\u4f7f\u7528 rebase \u5408\u5e76\u4ee3\u7801\u5219\u52a0\u4e0a\n</code></pre> <pre><code># \u5de5\u4f5c\u533a &lt;- \u672c\u5730\u4ed3\u5e93\n$ git reset &lt;commit&gt;          # \u672c\u5730\u4ed3\u5e93\u8986\u76d6\u5230\u5de5\u4f5c\u533a\uff08\u4fdd\u5b58\u56de\u9000\u6587\u4ef6\u5185\u5bb9\u4fee\u6539\uff09\n$ git reset --mixed &lt;commit&gt;  # \u672c\u5730\u4ed3\u5e93\u8986\u76d6\u5230\u5de5\u4f5c\u533a\uff08\u4fdd\u5b58\u56de\u9000\u6587\u4ef6\u5185\u5bb9\u4fee\u6539\uff09\n$ git reset --soft &lt;commit&gt;   # \u672c\u5730\u4ed3\u5e93\u8986\u76d6\u5230\u5de5\u4f5c\u533a\uff08\u4fdd\u7559\u4fee\u6539\u5e76\u52a0\u5230\u6682\u5b58\u533a\uff09\n$ git reset --hard &lt;commit&gt;   # \u672c\u5730\u4ed3\u5e93\u8986\u76d6\u5230\u5de5\u4f5c\u533a\uff08\u4e0d\u4fdd\u7559\u4fee\u6539\u76f4\u63a5\u5220\u9664\u6389)\n</code></pre>"},{"location":"chap6/6Git_principle/#2_1","title":"2\u3001\u914d\u7f6e\u5b9e\u7528\u53c2\u6570\u9009\u9879","text":""},{"location":"chap6/6Git_principle/#2-1","title":"2-1 \u5168\u5c40\u914d\u7f6e","text":"<pre><code># \u7528\u6237\u4fe1\u606f\n$ git config --global user.name \"your_name\"\n$ git config --global user.email \"your_email\"\n\n# \u6587\u672c\u7f16\u8f91\u5668\n$ git config --global core.editor \"nvim\"\n\n# \u5206\u9875\u5668\n$ git config --global core.pager \"more\"\n\n# \u522b\u540d\n$ git config --global alias.gs \"git status\"\n\n# \u7ea0\u9519\n$ git config --global help.autocorrect 1\n</code></pre>"},{"location":"chap6/6Git_principle/#2-2","title":"2-2 \u4e2a\u4eba\u914d\u7f6e","text":"<pre><code># \u4e0d\u52a0 --global \u53c2\u6570\u7684\u8bdd\uff0c\u5219\u4e3a\u4e2a\u4eba\u914d\u7f6e\n$ git config --list\n$ git config user.name\n$ git config user.name \"your_name\"\n\n# \u5982\u679c\u5728\u9879\u76ee\u4e2d\u8bbe\u7f6e\uff0c\u5219\u4fdd\u5b58\u5728 .git/config\u6587\u4ef6\u91cc\u9762\n$ cat .git/config\n[user]\n    name = \"your_name\"\n......\n</code></pre>"},{"location":"chap6/6Git_principle/#3","title":"3\u3001\u5408\u5e76\u548c\u53d8\u57fa\u7684\u9009\u62e9","text":"<p>\u5230\u5e95\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528 merge \u64cd\u4f5c\uff0c\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528 rebase \u64cd\u4f5c\u5462\uff1f</p> <p>\u4f7f\u7528 merge \u64cd\u4f5c - Python \u4e2d\u7684 Requests \u5e93\u5728\u4f7f\u7528</p> <p>\u652f\u6301\u4f7f\u7528 merge \u7684\u5f00\u53d1\u8005\uff0c\u4ed6\u4eec\u8ba4\u4e3a\u4ed3\u5e93\u7684\u63d0\u4ea4\u5386\u53f2\u5c31\u662f\u8bb0\u5f55\u5b9e\u9645\u53d1\u751f\u8fc7\u4ec0\u4e48\uff0c\u5b83\u662f\u9488\u5bf9\u4e8e\u5386\u53f2\u7684\u4e00\u4e2a\u6587\u6863\uff0c\u672c\u8eab\u5176\u5b9e\u662f\u6709\u4ef7\u503c\u7684\uff0c\u6211\u4eec\u4e0d\u5e94\u8be5\u968f\u610f\u4fee\u6539\u3002\u6211\u4eec\u6539\u53d8\u5386\u53f2\u7684\u8bdd\uff0c\u5c31\u76f8\u5f53\u4e8e\u4f7f\u7528\u201c\u8c0e\u8a00\u201d\u6765\u63a9\u76d6\u5b9e\u9645\u53d1\u751f\u8fc7\u7684\u4e8b\u60c5\uff0c\u800c\u8fd9\u4e9b\u75d5\u8ff9\u662f\u5e94\u8be5\u88ab\u4fdd\u7559\u7684\u3002\u53ef\u80fd\uff0c\u8fd9\u6837\u5e76\u4e0d\u662f\u5f88\u597d\u3002</p> <pre><code># 3rd \u7684\u4e24\u4e2a\u5206\u652f\u7684 commit \u4fee\u6539\u76f8\u540c\u5185\u5bb9\n*   62a322d - (HEAD-&gt;master) Merge branch 'hotfix3' into master\n|\\\n| * 6fa8f4a - (hotfix3) 3rd commit in hotfix3\n* | 548d681 - 3rd commit in master\n|/\n* 6ba4a08 - 2nd commit\n* 22afcc1 - 1st commit\n</code></pre> <p>\u4f7f\u7528 rebase \u64cd\u4f5c - Python \u4e2d\u7684 Django \u5e93\u5728\u4f7f\u7528</p> <p>\u652f\u6301\u4f7f\u7528 rebase \u7684\u5f00\u53d1\u8005\uff0c\u4ed6\u4eec\u8ba4\u4e3a\u63d0\u4ea4\u5386\u53f2\u662f\u9879\u76ee\u8fc7\u7a0b\u4e2d\u53d1\u751f\u8fc7\u7684\u4e8b\u60c5\uff0c\u9700\u8981\u9879\u76ee\u7684\u4e3b\u5e72\u975e\u5e38\u7684\u5e72\u51c0\u3002\u800c\u4f7f\u7528 merge \u64cd\u4f5c\u4f1a\u751f\u6210\u4e00\u4e2a merge \u7684 commit \u5bf9\u8c61\uff0c\u8ba9\u63d0\u4ea4\u5386\u53f2\u591a\u4e86\u4e00\u4e9b\u975e\u5e38\u591a\u4f59\u7684\u5185\u5bb9\u3002</p> <p>\u5f53\u6211\u4eec\u540e\u671f\uff0c\u4f7f\u7528 log \u547d\u4ee4\u53c2\u770b\u63d0\u4ea4\u5386\u53f2\u7684\u8bdd\uff0c\u4f1a\u53d1\u73b0\u4e3b\u5e72\u7684\u63d0\u4ea4\u5386\u53f2\u975e\u5e38\u7684\u5c34\u5c2c\u3002\u6bd4\u5982\uff0c\u540c\u6837\u7684\u4fee\u6539\u5185\u5bb9\u91cd\u590d\u63d0\u4ea4\u4e86\u4e24\u6b21\uff0c\u8fd9\u663e\u7136\u662f\u5206\u652f\u5408\u5e76\u5bfc\u81f4\u7684\u95ee\u9898\u3002</p> <pre><code># 3rd \u7684\u4e24\u4e2a\u5206\u652f\u7684 commit \u4fee\u6539\u76f8\u540c\u5185\u5bb9\n* 697167e - (HEAD -&gt; master, hotfix) 3rd commit\n* 6ba4a08 - 2nd commit (2 minutes ago)\n* 22afcc1 - 1st commit (3 minutes ago)\n</code></pre> <p>\u4e24\u8005\u7684\u4f7f\u7528\u539f\u5219</p> <p>\u603b\u7684\u539f\u5219\u5c31\u662f\uff0c\u53ea\u5bf9\u5c1a\u672a\u63a8\u9001\u6216\u5206\u4eab\u7ed9\u5176\u4ed6\u4eba\u7684\u672c\u5730\u4fee\u6539\u6267\u884c\u53d8\u57fa\u64cd\u4f5c\u6e05\u7406\u5386\u53f2\uff0c\u4ece\u4e0d\u5bf9\u5df2\u7ecf\u63a8\u9001\u5230\u4ed3\u5e93\u7684\u63d0\u4ea4\u8bb0\u5f55\u6267\u884c\u53d8\u57fa\u64cd\u4f5c\uff0c\u8fd9\u6837\uff0c\u4f60\u624d\u53ef\u80fd\u4eab\u53d7\u5230\u4e24\u79cd\u65b9\u5f0f\u5e26\u6765\u7684\u4fbf\u5229\u3002</p>"},{"location":"chap6/6Git_principle/#4","title":"4\u3001\u66f4\u65b0\u4ed3\u5e93\u63d0\u4ea4\u5386\u53f2","text":"<p>Git \u63d0\u4f9b\u4e86\u4e00\u4e9b\u5de5\u5177\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5b8c\u5584\u7248\u672c\u5e93\u4e2d\u7684\u63d0\u4ea4\u5185\u5bb9\uff0c\u6bd4\u5982\uff1a</p>"},{"location":"chap6/6Git_principle/#4-1-commit","title":"4-1 \u5408\u5e76\u591a\u4e2a commit \u63d0\u4ea4\u8bb0\u5f55","text":"<p>\u65e5\u5e38\u5f00\u53d1\u4e2d\uff0c\u6211\u4eec\u4e3a\u4e86\u5b8c\u6210\u4e00\u4e2a\u529f\u80fd\u6216\u8005\u7279\u6027\uff0c\u63d0\u4ea4\u5f88\u591a\u4e2a commit \u8bb0\u5f55\u3002\u4f46\u662f\u5728\u6700\u540e\uff0c\u63d0\u4ea4 PR \u4e4b\u524d\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u662f\u5e94\u8be5\u6574\u7406\u4e0b\u8fd9\u4e9b\u63d0\u4ea4\u8bb0\u5f55\u7684\u3002\u6709\u4e9b commit \u9700\u8981\u5408\u5e76\u8d77\u6765\uff0c\u6216\u8005\u9700\u8981\u5c06\u5176\u5220\u9664\u6389\uff0c\u7b49\u7b49\u3002</p> <pre><code># \u8c03\u6574\u6700\u8fd1\u4e94\u6b21\u7684\u63d0\u4ea4\u8bb0\u5f55\n$ git rebase -i HEAD~5\n$ git rebase -i 5af4zd35  # \u5f80\u524d\u7b2c\u516d\u6b21\u7684commit\u503c\nreword c2aeb6e 3rd commit\nsquash 25a3122 4th commit\npick 5d36f1d 5th commit\nfixup bd5d32f 6th commit\ndrop 581e96d 7th commit\n\n# \u67e5\u770b\u63d0\u4ea4\u5386\u53f2\u8bb0\u5f55\n$ git log\n* ce813eb - (HEAD -&gt; master) 5th commit\n* aa2f043 - 3rd commit -&gt; modified\n* 6c5418f - 2nd commit\n* c8f7dea - 1st commit\n</code></pre> <p></p>"},{"location":"chap6/6Git_principle/#4-2","title":"4-2 \u5220\u9664\u610f\u5916\u8c03\u8bd5\u7684\u6d4b\u8bd5\u4ee3\u7801","text":"<p>\u6709\u65f6\u5019\u63d0\u4ea4\u4e4b\u540e\uff0c\u6211\u4eec\u624d\u53d1\u73b0\u63d0\u4ea4\u7684\u5386\u53f2\u8bb0\u5f55\u4e2d\u5b58\u5728\u8fd9\u4e00\u4e9b\u95ee\u9898\uff0c\u800c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53c8\u4e0d\u60f3\u65b0\u751f\u6210\u4e00\u4e2a commit \u8bb0\u5f55\uff0c\u4e14\u8fbe\u5230\u4e00\u4e2a\u4fee\u6539\u7684\u76ee\u5f55\u3002\u5373\uff0c\u4fee\u6539\u4e4b\u524d\u7684 commit \u63d0\u4ea4\u8bb0\u5f55\u3002</p> <pre><code># \u4e0d\u4f7f\u7528\u5206\u9875\u5668\n$ git --no-pager log --oneline -1\nd5e96d9 (HEAD -&gt; master) say file\n\n# \u6539\u53d8\u63d0\u4ea4\u4fe1\u606f\u5e76\u52a0\u5165\u6682\u5b58\u533a\n$ echo \"hello\" &gt; say.txt\n$ git add -u\n\n# \u6539\u53d8\u5f53\u524d\u6700\u65b0\u4e00\u6b21\u63d0\u4ea4\u8bb0\u5f55\n$ git commit --amend\n# \u6539\u53d8\u4e14\u606f\u4e0d\u6539\u53d8\u63d0\u4ea4\u4fe1\n$ git commit --amend --no-edit\n# \u6539\u53d8\u5f53\u524d\u6700\u65b0\u4e00\u6b21\u63d0\u4ea4\u8bb0\u5f55\u5e76\u4fee\u6539\u4fe1\u606f\n$ git commit --amend -m \"some_info\"\n\n# \u4e0d\u4f7f\u7528\u5206\u9875\u5668\n$ git --no-pager log --oneline -1\n9e1e0eb (HEAD -&gt; master) say file\n</code></pre>"},{"location":"chap6/6Git_principle/#4-3-commit","title":"4-3 \u53d6\u6d88\u591a\u4e2a commit \u4e2d\u7684\u90e8\u5206\u63d0\u4ea4","text":"<p>\u6211\u4eec\u5f00\u53d1\u4e86\u4e00\u4e2a\u529f\u80fd\uff0c\u800c\u5728\u4e0a\u7ebf\u7684\u65f6\u5019\uff0c\u4ea7\u54c1\u7ecf\u7406\u8bf4\u8fd9\u4e2a\u529f\u80fd\u7684\u90e8\u5206\u7279\u6027\u5df2\u7ecf\u4e0d\u9700\u8981\u4e86\uff0c\u5373\u76f8\u5173\u7279\u6027\u7684\u63d0\u4ea4\u8bb0\u5f55\u548c\u5185\u5bb9\u5c31\u53ef\u4ee5\u5ffd\u7565/\u5220\u9664\u6389\u4e86\u3002</p> <pre><code># \u56de\u6eda\u64cd\u4f5c(\u53ef\u591a\u6b21\u6267\u884c\u56de\u6eda\u64cd\u4f5c)\n# \u5f7b\u5e95\u4e0a\u6b21\u63d0\u4ea4\u8bb0\u5f55\uff1b\u4e5f\u53ef\u662f PR \u7684\u63d0\u4ea4\u8bb0\u5f55\n# \u9ed8\u8ba4\u4f1a\u751f\u6210\u4e00\u4e2a\u7c7b\u578b\u4e3a reverts \u7684\u65b0 commit \u5bf9\u8c61\n$ git revert 3zj5sldl\n</code></pre>"},{"location":"chap6/6Git_principle/#4-4-commit","title":"4-4 \u5408\u5e76\u67d0\u4e9b\u7279\u5b9a\u7684 commit \u63d0\u4ea4","text":"<p>\u6211\u4eec\u4e0d\u5e0c\u671b\u5408\u5e76\u6574\u4e2a\u5206\u652f\uff0c\u800c\u662f\u9700\u8981\u5408\u5e76\u8be5\u5206\u652f\u7684\u67d0\u4e9b\u63d0\u4ea4\u8bb0\u5f55\u5c31\u53ef\u4ee5\u4e86\u3002</p> <pre><code># \u6458\u6a31\u6843\n$ git cherry-pick -x z562e23d\n</code></pre>"},{"location":"chap6/6Git_principle/#5","title":"5\u3001\u4f7f\u7528\u5f15\u7528\u65e5\u5fd7\u8bb0\u5f55","text":"<p>\u5982\u4f55\u627e\u56de\u6211\u4eec\u4e22\u5931\u7684\u5185\u5bb9\u548c\u8bb0\u5f55\uff1f</p> <p>\u6211\u4eec\u4e4b\u524d\u8bf4\u8fc7\uff0c\u4f7f\u7528\u4e0b\u9762\u547d\u4ee4\u56de\u9000\u5185\u5bb9\u3001\u5f3a\u5236\u63a8\u9001\u4ee3\u7801\u3001\u5220\u9664\u672c\u5730\u5206\u652f\uff0c\u90fd\u662f\u975e\u5e38\u5371\u9669\u7684\u64cd\u4f5c\uff0c\u56e0\u4e3a\u91cd\u7f6e\u4e4b\u540e\u6211\u4eec\u5c31\u6ca1\u6709\u529e\u6cd5\u5728\u627e\u5230\u4e4b\u524d\u7684\u4fee\u6539\u5185\u5bb9\u4e86\u3002</p> <pre><code># \u56de\u9000\n$ git reset --hard &lt;commit&gt;\n\n# \u63a8\u9001\n$ git push origin master -f\n\n# \u5206\u652f\n$ git branch -D &lt;branch_name&gt;\n</code></pre> <p>\u5176\u5b9e Git \u7ed9\u6211\u4eec\u7559\u4e86\u4e00\u4e2a\u540e\u95e8\uff0c\u5c31\u662f\u4f7f\u7528 relflog \u547d\u4ee4\u6765\u627e\u56de\u4e4b\u524d\u7684\u5185\u5bb9\uff0c\u53ea\u4e0d\u8fc7\u662f\u76f8\u5bf9\u6765\u8bf4\u9ebb\u70e6\u4e00\u4e9b\u3002\u800c\u539f\u7406\u4e5f\u5f88\u7b80\u7b54\uff0c\u5c31\u662f\u5728\u6211\u4eec\u4f7f\u7528 Git \u547d\u4ee4\u64cd\u4f5c\u4ed3\u5e93\u7684\u65f6\u5019\uff0cGit \u5077\u5077\u5730\u5e2e\u52a9\u6211\u4eec\u628a\u6240\u6709\u7684\u64cd\u4f5c\u8bb0\u5f55\u4e86\u4e0b\u6765\u3002</p> <pre><code># \u67e5\u770b\u65e5\u5fd7\u8bb0\u5f55\n$ git --no-pager log --oneline -1\n4bc8703 (HEAD -&gt; master) hhhh\n\n# \u56de\u9000\u5230\u4e0a\u6b21\u63d0\u4ea4\n$ git reset --hard HEAD~1\n\n# \u67e5\u770b\u5f15\u7528\u65e5\u5fd7\u8bb0\u5f55\n$ git reflog\n6a89f1b (HEAD -&gt; master) HEAD@{0}: reset: moving to HEAD~1\n4bc8703 HEAD@{1}: commit (amend): hhhh\n\n# \u627e\u56de\u5185\u5bb9\n$ git cherry-pick 4bc8703\n</code></pre>"},{"location":"chap6/6Git_principle/#6","title":"6\u3001\u6279\u91cf\u4fee\u6539\u5386\u53f2\u63d0\u4ea4","text":"<p>\u4e4b\u524d\u6211\u4eec\u5b66\u4e60\u5230\u7684\u547d\u4ee4\u90fd\u662f\u9488\u5bf9\u4e8e\u4e00\u4e2a\u6216\u8005\u591a\u4e2a commit \u63d0\u4ea4\u4fe1\u606f\u8fdb\u884c\u4fee\u6539\u7684\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u5168\u5c40\u4fee\u6539\u5386\u53f2\u63d0\u4ea4\u5462\uff1f\u5f53\u7136\uff0cGit \u4e2d\u4e5f\u662f\u652f\u6301\u5168\u5c40\u4fee\u6539\u5386\u53f2\u63d0\u4ea4\u7684\uff0c\u6bd4\u5982\u5168\u5c40\u4fee\u6539\u90ae\u7bb1\u5730\u5740\uff0c\u6216\u8005\u5c06\u4e00\u4e2a\u6587\u4ef6\u4ece\u5168\u5c40\u5386\u53f2\u4e2d\u5220\u9664\u6216\u4fee\u6539\u3002</p> <ul> <li>\u5f00\u6e90\u9879\u76ee\u4e2d\u4f7f\u7528\u4e86\u516c\u53f8\u90ae\u7bb1\u8fdb\u884c\u63d0\u4ea4\u4e86</li> <li>\u63d0\u4ea4\u6587\u4ef6\u4e2d\u5305\u542b\u9690\u79c1\u6027\u7684\u5bc6\u7801\u76f8\u5173\u4fe1\u606f</li> <li>\u63d0\u4ea4\u65f6\u5c06\u5927\u6587\u4ef6\u63d0\u4ea4\u5230\u4e86\u4ed3\u5e93\u4ee3\u7801\u4e2d\u4e86</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 filter-brach \u7684\u65b9\u5f0f\u8fdb\u884c\u4fee\u6539\uff0c\u4f46\u662f\u5efa\u8bae\u5728\u4f7f\u7528\u4e4b\u524d\uff0c\u65b0\u5efa\u4e00\u4e2a\u5206\u652f\uff0c\u5728\u4e0a\u9762\u8fdb\u884c\u6d4b\u8bd5\u6ca1\u6709\u95ee\u9898\u4e4b\u540e\uff0c\u518d\u5728\u4e3b\u5e72\u4e0a\u64cd\u4f5c\uff0c\u9632\u6b62\u51fa\u73b0\u95ee\u9898\uff0c\u80cc\u4e2a\u5927\u9505\u5728\u8eab\u4e0a\u3002</p> <pre><code># \u521b\u5efa\u5206\u652f\n$ git branch -b testing\n\n# \u4fee\u6539\u90ae\u7bb1\u5730\u5740\n$ git filter-branch --commit-filter '\n    if [ \"$GIT_AUTHOR_EMAIL\" == \"escape@escapelife.site\" ]; then\n        GIT_AUTHOR_NAME=\"escape\";\n        GIT_AUTHOR_EMAIL=\"escape@gmail.com\";\n        git commit-tree \"$@\"\n    else\n        git commit-tree \"$@\"\n    fi' HEAD\n</code></pre>"},{"location":"chap6/6Git_principle/#7","title":"7\u3001\u7075\u6d3b\u4f7f\u7528\u94a9\u5b50\u51fd\u6570","text":"<p>\u4e3b\u8981\u4ecb\u7ecd.git/hooks \u76ee\u5f55\u4e0b\u9762\u7684\u793a\u4f8b\u94a9\u5b50\u51fd\u6570\uff01</p> <p>\u5728 Git \u91cc\u9762\u6709\u4e24\u7c7b\uff0c\u5206\u522b\u5bf9\u5e94\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u94a9\u5b50\u51fd\u6570\u3002\u5ba2\u6237\u7aef\u7684\u94a9\u5b50\u51fd\u6570\uff0c\u662f\u5728\u6267\u884c\u63d0\u4ea4\u548c\u5408\u5e76\u4e4b\u7c7b\u7684\u64cd\u4f5c\u65f6\u8c03\u7528\u7684\u3002\u800c\u670d\u52a1\u7aef\u94a9\u5b50\u51fd\u6570\uff0c\u5c31\u662f\u5f53\u670d\u52a1\u7aef\u6536\u5230\u4ee3\u7801\u63d0\u4ea4\u4e4b\u540e\uff0c\u53ef\u4ee5\u51fa\u53d1\u4ee3\u7801\u68c0\u67e5\u548c\u6301\u7eed\u96c6\u6210\u7684\u6b65\u9aa4\u3002\u4f5c\u4e3a\u5f00\u53d1\u8005\u6211\u4eec\u5e76\u4e0d\u4f1a\u642d\u5efa Git \u670d\u52a1\u5668\uff0c\u6240\u4ee5\u57fa\u672c\u4e0d\u4f1a\u6d89\u53ca\u3002</p> <p>\u4e0b\u9762\u5c31\u662f Git \u81ea\u5e26\u7684\u94a9\u5b50\u811a\u672c\uff0c\u4f46\u662f\u81ea\u5e26\u7684\u90fd .sample \u4f5c\u4e3a\u540e\u7f00\uff0c\u8868\u793a\u5e76\u6ca1\u6709\u542f\u7528\uff0c\u8868\u793a\u4e3a\u4e00\u4e2a\u793a\u4f8b\u3002\u5982\u679c\u9700\u8981\u542f\u7528\u7684\u8bdd\uff0c\u5c06 \u00b7.sample \u00b7\u4f5c\u4e3a\u540e\u7f00\u5220\u9664\u6389\uff0c\u5373\u53ef\u3002\u800c\u5176\u94a9\u5b50\u811a\u672c\u7684\u5bf9\u5e94\u5185\u5bb9\uff0c\u90fd\u662f\u4f7f\u7528 Shell \u8bed\u6cd5\u8fdb\u884c\u7f16\u5199\u7684\u3002</p> <pre><code>\u279c ll .git/hooks\ntotal 112\n-rwxr-xr-x  applypatch-msg.sample\n-rwxr-xr-x  commit-msg.sample\n-rwxr-xr-x  fsmonitor-watchman.sample\n-rwxr-xr-x  post-update.sample\n-rwxr-xr-x  pre-applypatch.sample\n-rwxr-xr-x  pre-commit.sample\n-rwxr-xr-x  pre-merge-commit.sample\n-rwxr-xr-x  pre-push.sample  # \u4e0d\u4f1a\u63a8\u9001\u5305\u542bWIP\u7684commit\u63d0\u4ea4\n-rwxr-xr-x  pre-rebase.sample\n-rwxr-xr-x  pre-receive.sample\n-rwxr-xr-x  prepare-commit-msg.sample\n-rwxr-xr-x  update.sample\n</code></pre> <p>\u5176\u5b9e\uff0c\u94a9\u5b50\u811a\u672c\u4f7f\u7528\u4efb\u4f55\u8bed\u8a00\u7f16\u5199\u90fd\u662f\u53ef\u4ee5\u7684\uff0c\u53ea\u8981\u4f60\u8ba9\u7a0b\u5e8f\u8fd4\u56de\u5bf9\u5e94\u7684\u9000\u51fa\u7801\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u6b63\u5e38\u7684\u4ee3\u7801\u5408\u5165\u6d41\u7a0b\u5c31\u662f\uff0c\u6211\u4eec\u672c\u5730\u4fee\u6539\u4e4b\u540e\uff0c\u63d0\u4e00\u4e2a PR \u8bf7\u6c42\u5e76\u901a\u8fc7 Github \u7684 CI \u68c0\u67e5\uff0c\u63a5\u4e0b\u6765\u8fdb\u884c\u4ee3\u7801\u8bc4\u5ba1\uff0c\u6700\u540e\u88ab\u5408\u5e76\u5165\u4e3b\u5e72\u3002\u4f46\u662f\uff0c\u597d\u7684\u4e00\u4e2a\u4e60\u60ef\u5c31\u662f\uff0c\u5728\u4ee3\u7801\u63d0\u4ea4\u4e4b\u524d\u5c31\u5e94\u8be5\u4fdd\u8bc1\u4ee3\u7801\u4e0d\u4f1a\u51fa\u73b0\u8bed\u6cd5\u9519\u8bef\u7b49\u57fa\u7840\u95ee\u9898\uff0c\u6bd4\u5982\u901a\u8fc7 flake8 \u548c PEP8 \u6807\u51c6\u7b49\u3002</p> <p>\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528 pre-commit[1] \u8fd9\u4e2a GitHub \u7684\u5f00\u6e90\u9879\u76ee\u4e86\uff0c\u5176\u672c\u8d28\u5c31\u662f\u7ed9\u9879\u76ee\u6dfb\u52a0\u94a9\u5b50\u51fd\u6570\u7684\u4e00\u4e2a\u811a\u672c\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u6211\u4eec\u5728\u63d0\u4ea4\u4ee3\u7801\u6216\u8005\u63a8\u9001\u4ee3\u7801\u4e4b\u524d\uff0c\u5148\u68c0\u67e5\u4ee3\u7801\u7684\u8d28\u91cf\u3002</p> <p>\u800c pre-commit-hooks \u8fd9\u4e2a\u9879\u76ee\u91cc\u9762\u5305\u542b\u7684\u5c31\u662f\uff0c\u73b0\u5728\u6240\u652f\u6301\u7684\u94a9\u5b50\u811a\u672c\uff0c\u5373\u5f00\u7bb1\u5373\u7528\u7684\u94a9\u5b50\u811a\u672c\u96c6\u5408\u3002\u800c\u5176\u94a9\u5b50\u811a\u672c\u7684\u5bf9\u5e94\u5185\u5bb9\uff0c\u90fd\u662f\u4f7f\u7528 Python \u8bed\u6cd5\u8fdb\u884c\u7f16\u5199\u7684\u3002</p> <pre><code># \u5b89\u88c5\u65b9\u5f0f\n$ pip install pre-commit\n\n# \u6307\u5b9a hook \u7c7b\u578b\uff08\u5373\u5728\u54ea\u91cc\u68c0\u67e5\uff09\n$ pre-commit install -f --hook-type pre-push\n\n# \u914d\u7f6e\u9700\u8981\u6267\u884c\u7684\u68c0\u67e5\n$ cat .pre-commit-config.yaml\nrepos:\n- repo: https://github.com/pre-commit/pre-commit-hooks\n  rev: v2.9.2\n  hooks:\n    - id: trailing-whitespace\n    - id: flake8\n\n# \u6267\u884c push \u64cd\u4f5c\u65f6\u68c0\u67e5\n$ git push origin master\n</code></pre>"},{"location":"chap6/6Git_principle/#8","title":"8\u3001\u5feb\u901f\u514b\u9686\u5927\u578b\u9879\u76ee","text":"<p>\u6211\u4eec\u5982\u679c\u60f3\u4e3a Linux \u6216 Python \u8fd9\u6837\u7684\u5927\u578b\u9879\u76ee\u8d21\u732e\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u9996\u5148\u9047\u5230\u7684\u95ee\u9898\u5c31\u662f\uff0c\u5982\u679c\u5feb\u901f\u7684 clone \u8be5\u9879\u76ee\u5230\u672c\u5730\u3002\u56e0\u4e3a\u6539\u9879\u76ee\u63d0\u4ea4\u5386\u53f2\u8d85\u591a\u4e14\u4ed3\u5e93\u5de8\u5927\uff0c\u52a0\u4e86\u56fd\u5185\u7f51\u7edc\u7684\u95ee\u9898\uff0c\u53ef\u80fd\u7b49\u9879\u76ee\u5b8c\u5168\u62c9\u4e0b\u6765\u7684\u65f6\u5019\uff0c\u6211\u4eec\u7684\u70ed\u60c5\u90fd\u6d88\u51cf\u4e0b\u53bb\u4e86\u3002</p> <p>\u597d\u5728 Git \u4e5f\u5e2e\u6211\u4eec\u60f3\u5230\u4e86\u8fd9\u6837\u7684\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 --depth \u53c2\u6570\u503c\u62c9\u53d6\u8fdc\u7a0b\u4ed3\u5e93\u4e0a\u9762\u6700\u65b0\u4e00\u6b21\u7684\u63d0\u4ea4\u5386\u53f2\uff0c\u5e76\u4e0d\u5305\u542b\u9879\u76ee\u5386\u53f2\u8bb0\u5f55\uff0c\u5373 <code>.git/objects/</code> \u76ee\u5f55\u4e0b\u7684\u5bf9\u8c61\u53ea\u662f\u672c\u5730\u7684\uff0c\u5e76\u4e0d\u5305\u542b\u4e4b\u524d\u7684\u591a\u6b21\u4fee\u6539\u4ea7\u751f\u7684\u5bf9\u8c61\u3002</p> <pre><code># \u514b\u9686\u4e0d\u5305\u542b\u4e4b\u524d\u5386\u53f2\n$ git clone http://xxx.xx.xxx/xxx --depth=1\n</code></pre> <p>\u4f46\u662f\uff0c\u6709\u65f6\u95f4\u6211\u4eec\u53ef\u80fd\u4f1a\u9700\u8981 clone \u4ed3\u5e93\u4e2d\u7684\u67d0\u4e2a tag \u7248\u672c\u5bf9\u5e94\u4e0b\u7684\u5185\u5bb9\u3002\u5982\u679c\u6211\u4eec\u76f4\u63a5\u4f7f\u7528 clone \u547d\u4ee4\u662f\u65e0\u6cd5\u505a\u5230\u7684\uff0c\u9700\u8981\u6267\u884c\u5982\u4e0b\u64cd\u4f5c\uff0c\u5373\u53ef\u5b8c\u7f8e\u89e3\u51b3\u3002</p> <pre><code># \u514b\u9686\u7279\u5b9a\u7248\u672c\u4ee3\u7801\n$ git init xxx-15-0-1\n$ git remote add origin http://xxx.xx.xxx/xxx\n$ git -c protocol.version=2 fetch origin 15.0.1 --depth=1\n$ git checkout FETCH_HEAD\n</code></pre> <p>\u4e0a\u9762\u7684\u6548\u679c\u5df2\u7ecf\u57fa\u672c\u53ef\u4ee5\u6ee1\u8db3\u6211\u4eec\u65e5\u5e38\u4f7f\u7528\u9700\u6c42\u4e86\uff0c\u4f46\u662f\u4e0d\u5e78\u7684\u662f\uff0c\u4f60\u73b0\u5728\u63a5\u53d7\u4e86\u4e00\u4e2a\u673a\u5668\u5b66\u4e60\u7684\u9879\u76ee\uff0c\u91cc\u9762\u5305\u542b\u4e86\u5927\u91cf\u7684 lfs \u6587\u4ef6\uff0c\u73b0\u5728 clone \u53c8\u4f1a\u53d8\u5f97\u975e\u5e38\u6162\u3002\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u64cd\u4f5c\u6765\u907f\u514d\uff0cGit \u5de5\u5177\u4e3b\u52a8\u62c9\u53bb lfs \u6587\u4ef6\uff0c\u6765\u8fbe\u5230\u76ee\u5f55\u3002</p> <pre><code># \u514b\u9686\u4e0d\u5305\u542b LFS \u6570\u636e\n$ GIT_LFS_SKIP_SMUDGE=1 git clone http://xxx.xx.xxx/xxx\n</code></pre>"},{"location":"chap6/6Git_principle/#9","title":"9\u3001\u4f55\u5904\u7406\u5de5\u4f5c\u4e2d\u65ad","text":"<p>\u6bd4\u5982\uff0c\u6211\u4eec\u73b0\u5728\u6b63\u5728\u4e00\u4e2a\u5206\u652f\u4e3a\u9879\u76ee\u6dfb\u52a0\u4e00\u4e2a\u5c0f\u7684\u529f\u80fd\uff0c\u6b64\u65f6\uff0c\u4ea7\u54c1\u7ecf\u7406\u627e\u5230\u4f60\u8bf4\u662f\u7ebf\u4e0a\u73af\u5883\u73b0\u5728\u6709\u4e00\u4e2a bug \u9700\u8981\u8ba9\u4f60\u6765\u4fee\u590d\u4e0b\u3002\u4f46\u662f\uff0c\u6b64\u65f6\u6211\u4eec\u6dfb\u52a0\u7684\u5c0f\u529f\u80fd\u5e76\u6ca1\u6709\u5b8c\u6210\u3002</p> <p>\u5982\u679c\u6b64\u65f6\uff0c\u6211\u4eec\u76f4\u63a5\u5207\u6362\u5230\u4e3b\u5e72\u5206\u652f\u7684\u8bdd\uff0c\u4f1a\u5c06\u4e4b\u524d\u5206\u652f\u6ca1\u6709\u6765\u5f97\u53ca\u63d0\u4ea4\u7684\u5185\u5bb9\u5168\u90e8\u90fd\u5e26\u5230\u4e86\u4e3b\u5e72\u5206\u652f\u4e0a\u6765\uff0c\u8fd9\u662f\u6211\u4eec\u4e0d\u60f3\u770b\u5230\u7684\u60c5\u51b5\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u5b58\u4e0a\u4e2a\u5206\u652f\u7684\u5de5\u4f5c\u72b6\u6001\uff0c\u5728\u6211\u4eec\u4fee\u6539\u5b8c\u6210\u7ebf\u4e0a bug \u4e4b\u540e\uff0c\u518d\u7ee7\u7eed\u5de5\u4f5c\u3002</p> <p>\u597d\u5728 Git \u4e5f\u5e2e\u6211\u4eec\u60f3\u5230\u4e86\u8fd9\u6837\u7684\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 stash \u5b50\u547d\u4ee4\u5e2e\u52a9\u6211\u4eec\u5c06\u5f53\u524d\u5de5\u4f5c\u533a\u3001\u6682\u5b58\u533a\u5f53\u4e2d\u7684\u4fee\u6539\u90fd\u4fdd\u5b58\u5230\u5806\u6808\u4e4b\u4e2d\u3002\u7b49\u5230\u9700\u8981\u5904\u7406\u7684\u65f6\u5019\uff0c\u518d\u5f39\u51fa\u5806\u6808\u4e2d\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u518d\u6b21\u8fdb\u884c\u5f00\u53d1\u3002</p> <pre><code>\u279c git stash -h\nusage: git stash list [&lt;options&gt;]\n   or: git stash show [&lt;options&gt;] [&lt;stash&gt;]\n   or: git stash drop [-q|--quiet] [&lt;stash&gt;]\n   or: git stash ( pop | apply ) [--index] [-q|--quiet] [&lt;stash&gt;]\n   or: git stash branch &lt;branchname&gt; [&lt;stash&gt;]\n   or: git stash clear\n   or: git stash [push [-p|--patch] [-k|--[no-]keep-index] [-q|--quiet]\n          [-u|--include-untracked] [-a|--all] [-m|--message &lt;message&gt;]\n          [--pathspec-from-file=&lt;file&gt; [--pathspec-file-nul]]\n          [--] [&lt;pathspec&gt;...]]\n   or: git stash save [-p|--patch] [-k|--[no-]keep-index] [-q|--quiet]\n          [-u|--include-untracked] [-a|--all] [&lt;message&gt;]\n</code></pre> <pre><code># \u5b58\u50a8\u5f53\u524d\u7684\u4fee\u6539\u4f46\u4e0d\u7528\u63d0\u4ea4 commit\n$ git stash\n\n# \u4fdd\u5b58\u5f53\u524d\u72b6\u6001\u5305\u62ec untracked \u7684\u6587\u4ef6\n$ git stash -u\n\n# \u5c55\u793a\u6240\u6709 stashes \u4fe1\u606f\n$ git stash list\n\n# \u56de\u5230\u67d0\u4e2a stash \u72b6\u6001\n$ git stash apply &lt;stash@{n}&gt;\n\n# \u5220\u9664\u50a8\u85cf\u533a\n$ git stash drop &lt;stash@{n}&gt;\n\n# \u56de\u5230\u6700\u540e\u4e00\u4e2a stash \u7684\u72b6\u6001\u5e76\u5220\u9664\u8fd9\u4e2a stash \u4fe1\u606f\n$ git stash pop\n\n# \u5220\u9664\u6240\u6709\u7684 stash \u4fe1\u606f\n$ git stash clear\n\n# \u4ece stash \u4e2d\u62ff\u51fa\u67d0\u4e2a\u6587\u4ef6\u7684\u4fee\u6539\n$ git checkout &lt;stash@{n}&gt; -- &lt;file-path&gt;\n</code></pre> <p>\u5176\u5b9e\u6bd4\u8f83\u4fdd\u9669\u7684\u505a\u6cd5\u5c31\u662f\uff0c\u5c06\u5f53\u524d\u7684\u6240\u6709\u4fee\u6539\u8fdb\u884c push \u5e76\u4fdd\u5b58\u5230\u8fdc\u7a0b\u4ed3\u5e93\u91cc\u9762\u3002\u8fd9\u6837\u7684\u597d\u5904\u5728\u4e8e\uff0c\u53ef\u4ee5\u8fdc\u7aef\u5907\u4efd\u6211\u4eec\u7684\u4fee\u6539\uff0c\u4e0d\u4f1a\u5bb3\u6015\u672c\u5730\u6587\u4ef6\u4e22\u5931\u7b49\u95ee\u9898\u3002\u7b49\u5230\u6211\u4eec\u9700\u8981\u7ee7\u7eed\u5f00\u53d1\u7684\u65f6\u5019\uff0c\u62c9\u4e0b\u5bf9\u5e94\u5185\u5bb9\uff0c\u518d\u60f3\u529e\u6cd5\u8fdb\u884c\u8865\u6551\uff0c\u6bd4\u5982\u4f7f\u7528 <code>--amend</code>\u6216\u8005 <code>reset</code> \u547d\u4ee4\u3002</p> <pre><code># \u5c06\u5de5\u4f5c\u533a\u548c\u6682\u5b58\u533a\u8986\u76d6\u6700\u8fd1\u4e00\u6b21\u63d0\u4ea4\n$ git commit --amend\n$ git commit --amend -m \"some_info\"\n\n# \u56de\u9000\u5230\u6307\u5b9a\u7248\u672c\u5e76\u8bb0\u5f55\u4fee\u6539\u5185\u5bb9\uff08--mixed\uff09\n# \u672c\u5730\u4ed3\u5e93\u8986\u76d6\u5230\u5de5\u4f5c\u533a\uff08\u4fdd\u5b58\u56de\u9000\u6587\u4ef6\u5185\u5bb9\u4fee\u6539\uff09\n$ git reset a87f328\n$ git reset HEAD~\n$ git reset HEAD~2\n$ git reset &lt;tag&gt;~2\n$ git reset --mixed &lt;commit/reference&gt;\n\n# \u672c\u5730\u4ed3\u5e93\u8986\u76d6\u5230\u5de5\u4f5c\u533a\uff08\u4e0d\u4fdd\u7559\u4fee\u6539\u76f4\u63a5\u5220\u9664\u6389\uff09\n$ git reset --soft &lt;commit/reference&gt;\n# \u672c\u5730\u4ed3\u5e93\u8986\u76d6\u5230\u5de5\u4f5c\u533a\uff08\u4fdd\u7559\u4fee\u6539\u5e76\u52a0\u5230\u6682\u5b58\u533a\uff09\n$ git reset --hard &lt;commit/reference&gt;\n</code></pre>"},{"location":"chap6/7LoadBalancer/","title":"L7 \u6df1\u5165\u6d45\u51fa\u8d1f\u8f7d\u5747\u8861","text":""},{"location":"chap6/7LoadBalancer/#1","title":"1\u3001\u8d1f\u8f7d\u5747\u8861\u7b80\u4ecb","text":""},{"location":"chap6/7LoadBalancer/#1-1","title":"1-1 \u5927\u578b\u7f51\u7ad9\u9762\u4e34\u7684\u6311\u6218","text":"<p>\u5927\u578b\u7f51\u7ad9\u90fd\u8981\u9762\u5bf9\u5e9e\u5927\u7684\u7528\u6237\u91cf\uff0c\u9ad8\u5e76\u53d1\uff0c\u6d77\u91cf\u6570\u636e\u7b49\u6311\u6218\u3002\u4e3a\u4e86\u63d0\u5347\u7cfb\u7edf\u6574\u4f53\u7684\u6027\u80fd\uff0c\u53ef\u4ee5\u91c7\u7528\u5782\u76f4\u6269\u5c55\u548c\u6c34\u5e73\u6269\u5c55\u4e24\u79cd\u65b9\u5f0f\u3002</p> <p>\u5782\u76f4\u6269\u5c55\uff1a\u5728\u7f51\u7ad9\u53d1\u5c55\u65e9\u671f\uff0c\u53ef\u4ee5\u4ece\u5355\u673a\u7684\u89d2\u5ea6\u901a\u8fc7\u589e\u52a0\u786c\u4ef6\u5904\u7406\u80fd\u529b\uff0c\u6bd4\u5982 CPU \u5904\u7406\u80fd\u529b\uff0c\u5185\u5b58\u5bb9\u91cf\uff0c\u78c1\u76d8\u7b49\u65b9\u9762\uff0c\u5b9e\u73b0\u670d\u52a1\u5668\u5904\u7406\u80fd\u529b\u7684\u63d0\u5347\u3002\u4f46\u662f\uff0c\u5355\u673a\u662f\u6709\u6027\u80fd\u74f6\u9888\u7684\uff0c\u4e00\u65e6\u89e6\u53ca\u74f6\u9888\uff0c\u518d\u60f3\u63d0\u5347\uff0c\u4ed8\u51fa\u7684\u6210\u672c\u548c\u4ee3\u4ef7\u4f1a\u6781\u9ad8\u3002\u8fd9\u663e\u7136\u4e0d\u80fd\u6ee1\u8db3\u5927\u578b\u5206\u5e03\u5f0f\u7cfb\u7edf\uff08\u7f51\u7ad9\uff09\u6240\u6709\u5e94\u5bf9\u7684\u5927\u6d41\u91cf\uff0c\u9ad8\u5e76\u53d1\uff0c\u6d77\u91cf\u6570\u636e\u7b49\u6311\u6218\u3002</p> <p>\u6c34\u5e73\u6269\u5c55\uff1a\u901a\u8fc7\u96c6\u7fa4\u6765\u5206\u62c5\u5927\u578b\u7f51\u7ad9\u7684\u6d41\u91cf\u3002\u96c6\u7fa4\u4e2d\u7684\u5e94\u7528\u670d\u52a1\u5668\uff08\u8282\u70b9\uff09\u901a\u5e38\u88ab\u8bbe\u8ba1\u6210\u65e0\u72b6\u6001\uff0c\u7528\u6237\u53ef\u4ee5\u8bf7\u6c42\u4efb\u4f55\u4e00\u4e2a\u8282\u70b9\uff0c\u8fd9\u4e9b\u8282\u70b9\u5171\u540c\u5206\u62c5\u8bbf\u95ee\u538b\u529b\u3002\u6c34\u5e73\u6269\u5c55\u6709\u4e24\u4e2a\u8981\u70b9\uff1a</p> <ul> <li>\u5e94\u7528\u96c6\u7fa4\uff1a\u5c06\u540c\u4e00\u5e94\u7528\u90e8\u7f72\u5230\u591a\u53f0\u673a\u5668\u4e0a\uff0c\u7ec4\u6210\u5904\u7406\u96c6\u7fa4\uff0c\u63a5\u6536\u8d1f\u8f7d\u5747\u8861\u8bbe\u5907\u5206\u53d1\u7684\u8bf7\u6c42\uff0c\u8fdb\u884c\u5904\u7406\uff0c\u5e76\u8fd4\u56de\u76f8\u5e94\u6570\u636e\u3002</li> <li>\u8d1f\u8f7d\u5747\u8861\uff1a\u5c06\u7528\u6237\u8bbf\u95ee\u8bf7\u6c42\uff0c\u901a\u8fc7\u67d0\u79cd\u7b97\u6cd5\uff0c\u5206\u53d1\u5230\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u3002</li> </ul>"},{"location":"chap6/7LoadBalancer/#1-2","title":"1-2. \u4ec0\u4e48\u662f\u8d1f\u8f7d\u5747\u8861","text":"<p>\u8d1f\u8f7d\u5747\u8861\uff08Load Balance\uff0c\u7b80\u79f0 LB\uff09\u662f\u9ad8\u5e76\u53d1\u3001\u9ad8\u53ef\u7528\u7cfb\u7edf\u5fc5\u4e0d\u53ef\u5c11\u7684\u5173\u952e\u7ec4\u4ef6\uff0c\u76ee\u6807\u662f \u5c3d\u529b\u5c06\u7f51\u7edc\u6d41\u91cf\u5e73\u5747\u5206\u53d1\u5230\u591a\u4e2a\u670d\u52a1\u5668\u4e0a\uff0c\u4ee5\u63d0\u9ad8\u7cfb\u7edf\u6574\u4f53\u7684\u54cd\u5e94\u901f\u5ea6\u548c\u53ef\u7528\u6027\u3002</p> <p>\u8d1f\u8f7d\u5747\u8861\u7684\u4e3b\u8981\u4f5c\u7528\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u9ad8\u5e76\u53d1\uff1a\u8d1f\u8f7d\u5747\u8861\u901a\u8fc7\u7b97\u6cd5\u8c03\u6574\u8d1f\u8f7d\uff0c\u5c3d\u529b\u5747\u5300\u7684\u5206\u914d\u5e94\u7528\u96c6\u7fa4\u4e2d\u5404\u8282\u70b9\u7684\u5de5\u4f5c\u91cf\uff0c\u4ee5\u6b64\u63d0\u9ad8\u5e94\u7528\u96c6\u7fa4\u7684\u5e76\u53d1\u5904\u7406\u80fd\u529b\uff08\u541e\u5410\u91cf\uff09\u3002</p> </li> <li> <p>\u4f38\u7f29\u6027\uff1a\u6dfb\u52a0\u6216\u51cf\u5c11\u670d\u52a1\u5668\u6570\u91cf\uff0c\u7136\u540e\u7531\u8d1f\u8f7d\u5747\u8861\u8fdb\u884c\u5206\u53d1\u63a7\u5236\u3002\u8fd9\u4f7f\u5f97\u5e94\u7528\u96c6\u7fa4\u5177\u5907\u4f38\u7f29\u6027\u3002</p> </li> <li> <p>\u9ad8\u53ef\u7528\uff1a\u8d1f\u8f7d\u5747\u8861\u5668\u53ef\u4ee5\u76d1\u63a7\u5019\u9009\u670d\u52a1\u5668\uff0c\u5f53\u670d\u52a1\u5668\u4e0d\u53ef\u7528\u65f6\uff0c\u81ea\u52a8\u8df3\u8fc7\uff0c\u5c06\u8bf7\u6c42\u5206\u53d1\u7ed9\u53ef\u7528\u7684\u670d\u52a1\u5668\u3002\u8fd9\u4f7f\u5f97\u5e94\u7528\u96c6\u7fa4\u5177\u5907\u9ad8\u53ef\u7528\u7684\u7279\u6027\u3002</p> </li> <li> <p>\u5b89\u5168\u9632\u62a4\uff1a\u6709\u4e9b\u8d1f\u8f7d\u5747\u8861\u8f6f\u4ef6\u6216\u786c\u4ef6\u63d0\u4f9b\u4e86\u5b89\u5168\u6027\u529f\u80fd\uff0c\u5982\uff1a\u9ed1\u767d\u540d\u5355\u5904\u7406\u3001\u9632\u706b\u5899\uff0c\u9632 DDos \u653b\u51fb\u7b49\u3002</p> </li> </ul>"},{"location":"chap6/7LoadBalancer/#2","title":"2\u3001\u8d1f\u8f7d\u5747\u8861\u7684\u5206\u7c7b","text":"<p>\u652f\u6301\u8d1f\u8f7d\u5747\u8861\u7684\u6280\u672f\u5f88\u591a\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7ef4\u5ea6\u53bb\u8fdb\u884c\u5206\u7c7b\u3002</p>"},{"location":"chap6/7LoadBalancer/#2-1","title":"2-1 \u8f7d\u4f53\u7ef4\u5ea6\u5206\u7c7b","text":"<p>\u4ece\u652f\u6301\u8d1f\u8f7d\u5747\u8861\u7684\u8f7d\u4f53\u6765\u770b\uff0c\u53ef\u4ee5\u5c06\u8d1f\u8f7d\u5747\u8861\u5206\u4e3a\u4e24\u7c7b\uff1a\u786c\u4ef6\u8d1f\u8f7d\u5747\u8861\u3001\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861</p>"},{"location":"chap6/7LoadBalancer/#2-1-1","title":"2-1-1 \u786c\u4ef6\u8d1f\u8f7d\u5747\u8861","text":"<p>\u786c\u4ef6\u8d1f\u8f7d\u5747\u8861\uff0c\u4e00\u822c\u662f\u5728\u5b9a\u5236\u5904\u7406\u5668\u4e0a\u8fd0\u884c\u7684\u72ec\u7acb\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\uff0c\u4ef7\u683c\u6602\u8d35\uff0c\u571f\u8c6a\u4e13\u5c5e\u3002\u786c\u4ef6\u8d1f\u8f7d\u5747\u8861\u7684\u4e3b\u6d41\u4ea7\u54c1\u6709:F5 \u548c A10\u3002</p> <p>\u786c\u4ef6\u8d1f\u8f7d\u5747\u8861\u7684 \u4f18\u70b9\uff1a</p> <ul> <li>\u529f\u80fd\u5f3a\u5927\uff1a\u652f\u6301\u5168\u5c40\u8d1f\u8f7d\u5747\u8861\u5e76\u63d0\u4f9b\u8f83\u5168\u9762\u7684\u3001\u590d\u6742\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u3002</li> <li>\u6027\u80fd\u5f3a\u608d\uff1a\u786c\u4ef6\u8d1f\u8f7d\u5747\u8861\u7531\u4e8e\u662f\u5728\u4e13\u7528\u5904\u7406\u5668\u4e0a\u8fd0\u884c\uff0c\u56e0\u6b64\u541e\u5410\u91cf\u5927\uff0c\u53ef\u652f\u6301\u5355\u673a\u767e\u4e07\u4ee5\u4e0a\u7684\u5e76\u53d1\u3002</li> <li>\u5b89\u5168\u6027\u9ad8\uff1a\u5f80\u5f80\u5177\u5907\u9632\u706b\u5899\uff0c\u9632 DDos \u653b\u51fb\u7b49\u5b89\u5168\u529f\u80fd\u3002</li> </ul> <p>\u786c\u4ef6\u8d1f\u8f7d\u5747\u8861\u7684 \u7f3a\u70b9\uff1a</p> <ul> <li>\u6210\u672c\u6602\u8d35\uff1a\u8d2d\u4e70\u548c\u7ef4\u62a4\u786c\u4ef6\u8d1f\u8f7d\u5747\u8861\u7684\u6210\u672c\u90fd\u5f88\u9ad8\u3002</li> <li>\u6269\u5c55\u6027\u5dee\uff1a\u5f53\u8bbf\u95ee\u91cf\u7a81\u589e\u65f6\uff0c\u8d85\u8fc7\u9650\u5ea6\u4e0d\u80fd\u52a8\u6001\u6269\u5bb9\u3002</li> </ul>"},{"location":"chap6/7LoadBalancer/#2-1-2","title":"2-1-2 \u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861","text":"<p>\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\uff0c\u5e94\u7528\u6700\u5e7f\u6cdb\uff0c\u65e0\u8bba\u5927\u516c\u53f8\u8fd8\u662f\u5c0f\u516c\u53f8\u90fd\u4f1a\u4f7f\u7528\u3002 \u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u4ece\u8f6f\u4ef6\u5c42\u9762\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\uff0c\u4e00\u822c\u53ef\u4ee5\u5728\u4efb\u4f55\u6807\u51c6\u7269\u7406\u8bbe\u5907\u4e0a\u8fd0\u884c\u3002</p> <p>\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u7684 \u4e3b\u6d41\u4ea7\u54c1 \u6709\uff1aNginx\u3001HAProxy\u3001LVS\u3002</p> <ul> <li>LVS \u53ef\u4ee5\u4f5c\u4e3a\u56db\u5c42\u8d1f\u8f7d\u5747\u8861\u5668\u3002\u5176\u8d1f\u8f7d\u5747\u8861\u7684\u6027\u80fd\u8981\u4f18\u4e8e Nginx\u3002</li> <li>HAProxy \u53ef\u4ee5\u4f5c\u4e3a HTTP \u548c TCP \u8d1f\u8f7d\u5747\u8861\u5668\u3002</li> <li>Nginx\u3001HAProxy \u53ef\u4ee5\u4f5c\u4e3a\u56db\u5c42\u6216\u4e03\u5c42\u8d1f\u8f7d\u5747\u8861\u5668\u3002</li> </ul> <p>\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u7684 \u4f18\u70b9\uff1a</p> <ul> <li>\u6269\u5c55\u6027\u597d\uff1a\u9002\u5e94\u52a8\u6001\u53d8\u5316\uff0c\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u5b9e\u4f8b\uff0c\u52a8\u6001\u6269\u5c55\u5230\u8d85\u51fa\u521d\u59cb\u5bb9\u91cf\u7684\u80fd\u529b\u3002</li> <li>\u6210\u672c\u4f4e\u5ec9\uff1a\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u53ef\u4ee5\u5728\u4efb\u4f55\u6807\u51c6\u7269\u7406\u8bbe\u5907\u4e0a\u8fd0\u884c\uff0c\u964d\u4f4e\u4e86\u8d2d\u4e70\u548c\u8fd0\u7ef4\u7684\u6210\u672c\u3002</li> </ul> <p>\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u7684 \u7f3a\u70b9\uff1a</p> <ul> <li>\u6027\u80fd\u7565\u5dee\uff1a\u76f8\u6bd4\u4e8e\u786c\u4ef6\u8d1f\u8f7d\u5747\u8861\uff0c\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u7684\u6027\u80fd\u8981\u7565\u4f4e\u4e00\u4e9b\u3002</li> </ul>"},{"location":"chap6/7LoadBalancer/#2-2","title":"2-2 \u7f51\u7edc\u901a\u4fe1\u5206\u7c7b","text":"<p>1) \u4e03\u5c42\u8d1f\u8f7d\u5747\u8861\uff1a\u5c31\u662f\u53ef\u4ee5\u6839\u636e\u8bbf\u95ee\u7528\u6237\u7684 HTTP \u8bf7\u6c42\u5934\u3001URL \u4fe1\u606f\u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230\u7279\u5b9a\u7684\u4e3b\u673a\u3002</p> <ul> <li>DNS \u91cd\u5b9a\u5411</li> <li>HTTP \u91cd\u5b9a\u5411</li> <li>\u53cd\u5411\u4ee3\u7406</li> </ul> <p>2) \u56db\u5c42\u8d1f\u8f7d\u5747\u8861\uff1a\u57fa\u4e8e IP \u5730\u5740\u548c\u7aef\u53e3\u8fdb\u884c\u8bf7\u6c42\u7684\u8f6c\u53d1\u3002</p> <ul> <li>\u4fee\u6539 IP \u5730\u5740</li> <li>\u4fee\u6539 MAC \u5730\u5740</li> </ul>"},{"location":"chap6/7LoadBalancer/#2-2-1-dns","title":"2-2-1 DNS \u8d1f\u8f7d\u5747\u8861","text":"<p>DNS \u8d1f\u8f7d\u5747\u8861\u4e00\u822c\u7528\u4e8e\u4e92\u8054\u7f51\u516c\u53f8\uff0c\u590d\u6742\u7684\u4e1a\u52a1\u7cfb\u7edf\u4e0d\u9002\u5408\u4f7f\u7528\u3002\u5927\u578b\u7f51\u7ad9\u4e00\u822c\u4f7f\u7528 DNS \u8d1f\u8f7d\u5747\u8861\u4f5c\u4e3a \u7b2c\u4e00\u7ea7\u8d1f\u8f7d\u5747\u8861\u624b\u6bb5\uff0c\u7136\u540e\u5728\u5185\u90e8\u4f7f\u7528\u5176\u5b83\u65b9\u5f0f\u505a\u7b2c\u4e8c\u7ea7\u8d1f\u8f7d\u5747\u8861\u3002DNS \u8d1f\u8f7d\u5747\u8861\u5c5e\u4e8e\u4e03\u5c42\u8d1f\u8f7d\u5747\u8861\u3002</p> <p>DNS \u5373 \u57df\u540d\u89e3\u6790\u670d\u52a1\uff0c\u662f OSI \u7b2c\u4e03\u5c42\u7f51\u7edc\u534f\u8bae\u3002</p> <p>DNS \u88ab\u8bbe\u8ba1\u4e3a\u4e00\u4e2a\u6811\u5f62\u7ed3\u6784\u7684\u5206\u5e03\u5f0f\u5e94\u7528\uff0c\u81ea\u4e0a\u800c\u4e0b\u4f9d\u6b21\u4e3a\uff1a\u6839\u57df\u540d\u670d\u52a1\u5668\uff0c\u4e00\u7ea7\u57df\u540d\u670d\u52a1\u5668\uff0c\u4e8c\u7ea7\u57df\u540d\u670d\u52a1\u5668\uff0c... \uff0c\u672c\u5730\u57df\u540d\u670d\u52a1\u5668\u3002\u663e\u7136\uff0c\u5982\u679c\u6240\u6709\u6570\u636e\u90fd\u5b58\u50a8\u5728\u6839\u57df\u540d\u670d\u52a1\u5668\uff0c\u90a3\u4e48 DNS \u67e5\u8be2\u7684\u8d1f\u8f7d\u548c\u5f00\u9500\u4f1a\u975e\u5e38\u5e9e\u5927\u3002</p> <p>\u56e0\u6b64\uff0cDNS \u67e5\u8be2\u76f8\u5bf9\u4e8e DNS \u5c42\u7ea7\u7ed3\u6784\uff0c\u662f\u4e00\u4e2a\u9006\u5411\u7684\u9012\u5f52\u6d41\u7a0b\uff0cDNS \u5ba2\u6237\u7aef\u4f9d\u6b21\u8bf7\u6c42\u672c\u5730 DNS \u670d\u52a1\u5668\uff0c\u4e0a\u4e00\u7ea7 DNS \u670d\u52a1\u5668\uff0c\u4e0a\u4e0a\u4e00\u7ea7 DNS \u670d\u52a1\u5668\uff0c... \uff0c\u6839 DNS \u670d\u52a1\u5668\uff08\u53c8\u53eb\u6743\u5a01 DNS \u670d\u52a1\u5668\uff09\uff0c\u4e00\u65e6\u547d\u4e2d\uff0c\u7acb\u5373\u8fd4\u56de\u3002</p> <p>\u4e3a\u4e86\u51cf\u5c11\u67e5\u8be2\u6b21\u6570\uff0c\u6bcf\u4e00\u7ea7 DNS \u670d\u52a1\u5668\u90fd\u4f1a\u8bbe\u7f6e DNS \u67e5\u8be2\u7f13\u5b58\u3002</p> <p>DNS \u8d1f\u8f7d\u5747\u8861\u7684\u5de5\u4f5c\u539f\u7406\u5c31\u662f\uff1a\u57fa\u4e8e DNS \u67e5\u8be2\u7f13\u5b58\uff0c\u6309\u7167\u8d1f\u8f7d\u60c5\u51b5\u8fd4\u56de\u4e0d\u540c\u670d\u52a1\u5668\u7684 IP \u5730\u5740\u3002</p> <p></p> <p>DNS \u91cd\u5b9a\u5411\u7684 \u4f18\u70b9\uff1a</p> <p>\u4f7f\u7528\u7b80\u5355\uff1a\u8d1f\u8f7d\u5747\u8861\u5de5\u4f5c\uff0c\u4ea4\u7ed9 DNS \u670d\u52a1\u5668\u5904\u7406\uff0c\u7701\u6389\u4e86\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\u7ef4\u62a4\u7684\u9ebb\u70e6</p> <p>\u63d0\u9ad8\u6027\u80fd\uff1a\u53ef\u4ee5\u652f\u6301\u57fa\u4e8e\u5730\u5740\u7684\u57df\u540d\u89e3\u6790\uff0c\u89e3\u6790\u6210\u8ddd\u79bb\u7528\u6237\u6700\u8fd1\u7684\u670d\u52a1\u5668\u5730\u5740\uff08\u7c7b\u4f3c CDN \u7684\u539f\u7406\uff09\uff0c\u53ef\u4ee5\u52a0\u5feb\u8bbf\u95ee\u901f\u5ea6\uff0c\u6539\u5584\u6027\u80fd\uff1b</p> <p>DNS \u91cd\u5b9a\u5411\u7684 \u7f3a\u70b9\uff1a</p> <p>\u53ef\u7528\u6027\u5dee\uff1aDNS \u89e3\u6790\u662f\u591a\u7ea7\u89e3\u6790\uff0c\u65b0\u589e/\u4fee\u6539 DNS \u540e\uff0c\u89e3\u6790\u65f6\u95f4\u8f83\u957f\uff1b\u89e3\u6790\u8fc7\u7a0b\u4e2d\uff0c\u7528\u6237\u8bbf\u95ee\u7f51\u7ad9\u5c06\u5931\u8d25\uff1b</p> <p>\u6269\u5c55\u6027\u4f4e\uff1aDNS \u8d1f\u8f7d\u5747\u8861\u7684\u63a7\u5236\u6743\u5728\u57df\u540d\u5546\u90a3\u91cc\uff0c\u65e0\u6cd5\u5bf9\u5176\u505a\u66f4\u591a\u7684\u6539\u5584\u548c\u6269\u5c55\uff1b</p> <p>\u7ef4\u62a4\u6027\u5dee\uff1a\u4e5f\u4e0d\u80fd\u53cd\u6620\u670d\u52a1\u5668\u7684\u5f53\u524d\u8fd0\u884c\u72b6\u6001\uff1b\u652f\u6301\u7684\u7b97\u6cd5\u5c11\uff1b\u4e0d\u80fd\u533a\u5206\u670d\u52a1\u5668\u7684\u5dee\u5f02\uff08\u4e0d\u80fd\u6839\u636e\u7cfb\u7edf\u4e0e\u670d\u52a1\u7684\u72b6\u6001\u6765\u5224\u65ad\u8d1f\u8f7d\uff09\u3002</p>"},{"location":"chap6/7LoadBalancer/#2-2-2-http","title":"2-2-2 HTTP \u8d1f\u8f7d\u5747\u8861","text":"<p>HTTP \u8d1f\u8f7d\u5747\u8861\u662f\u57fa\u4e8e HTTP \u91cd\u5b9a\u5411\u5b9e\u73b0\u7684\u3002HTTP \u8d1f\u8f7d\u5747\u8861\u5c5e\u4e8e\u4e03\u5c42\u8d1f\u8f7d\u5747\u8861\u3002</p> <p>HTTP \u91cd\u5b9a\u5411\u539f\u7406\u662f\uff1a\u6839\u636e\u7528\u6237\u7684 HTTP \u8bf7\u6c42\u8ba1\u7b97\u51fa\u4e00\u4e2a\u771f\u5b9e\u7684\u670d\u52a1\u5668\u5730\u5740\uff0c\u5c06\u8be5\u670d\u52a1\u5668\u5730\u5740\u5199\u5165 HTTP \u91cd\u5b9a\u5411\u54cd\u5e94\u4e2d\uff0c\u8fd4\u56de\u7ed9\u6d4f\u89c8\u5668\uff0c\u7531\u6d4f\u89c8\u5668\u91cd\u65b0\u8fdb\u884c\u8bbf\u95ee\u3002</p> <p></p> <p>HTTP \u91cd\u5b9a\u5411\u7684\u4f18\u70b9\uff1a\u65b9\u6848\u7b80\u5355\u3002</p> <p>HTTP \u91cd\u5b9a\u5411\u7684 \u7f3a\u70b9\uff1a</p> <ul> <li>\u6027\u80fd\u8f83\u5dee\uff1a\u6bcf\u6b21\u8bbf\u95ee\u9700\u8981\u4e24\u6b21\u8bf7\u6c42\u670d\u52a1\u5668\uff0c\u589e\u52a0\u4e86\u8bbf\u95ee\u7684\u5ef6\u8fdf\u3002</li> <li>\u964d\u4f4e\u641c\u7d22\u6392\u540d\uff1a\u4f7f\u7528\u91cd\u5b9a\u5411\u540e\uff0c\u641c\u7d22\u5f15\u64ce\u4f1a\u89c6\u4e3a SEO \u4f5c\u5f0a\u3002</li> <li>\u5982\u679c\u8d1f\u8f7d\u5747\u8861\u5668\u5b95\u673a\uff0c\u5c31\u65e0\u6cd5\u8bbf\u95ee\u8be5\u7ad9\u70b9\u3002</li> </ul> <p>\u7531\u4e8e\u5176\u7f3a\u70b9\u6bd4\u8f83\u660e\u663e\uff0c\u6240\u4ee5\u8fd9\u79cd\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u5b9e\u9645\u5e94\u7528\u8f83\u5c11\u3002</p>"},{"location":"chap6/7LoadBalancer/#2-2-3","title":"2-2-3 \u53cd\u5411\u4ee3\u7406\u8d1f\u8f7d\u5747\u8861","text":"<p>\u53cd\u5411\u4ee3\u7406\uff08Reverse Proxy\uff09\u65b9\u5f0f\u662f\u6307\u4ee5 \u4ee3\u7406\u670d\u52a1\u5668 \u6765\u63a5\u53d7\u7f51\u7edc\u8bf7\u6c42\uff0c\u7136\u540e \u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u5185\u7f51\u4e2d\u7684\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u4ece\u5185\u7f51\u4e2d\u7684\u670d\u52a1\u5668\u4e0a\u5f97\u5230\u7684\u7ed3\u679c\u8fd4\u56de\u7ed9\u7f51\u7edc\u8bf7\u6c42\u7684\u5ba2\u6237\u7aef\u3002\u53cd\u5411\u4ee3\u7406\u8d1f\u8f7d\u5747\u8861\u5c5e\u4e8e\u4e03\u5c42\u8d1f\u8f7d\u5747\u8861\u3002</p> <p>\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u7684\u4e3b\u6d41\u4ea7\u54c1\uff1aNginx\u3001Apache\u3002</p> <p>\u6b63\u5411\u4ee3\u7406\u4e0e\u53cd\u5411\u4ee3\u7406\u6709\u4ec0\u4e48\u533a\u522b\uff1f</p> <ul> <li>\u6b63\u5411\u4ee3\u7406\uff1a\u53d1\u751f\u5728 \u5ba2\u6237\u7aef\uff0c\u662f\u7531\u7528\u6237\u4e3b\u52a8\u53d1\u8d77\u7684\u3002\u7ffb\u5899\u8f6f\u4ef6\u5c31\u662f\u5178\u578b\u7684\u6b63\u5411\u4ee3\u7406\uff0c\u5ba2\u6237\u7aef\u901a\u8fc7\u4e3b\u52a8\u8bbf\u95ee\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u8ba9\u4ee3\u7406\u670d\u52a1\u5668\u83b7\u5f97\u9700\u8981\u7684\u5916\u7f51\u6570\u636e\uff0c\u7136\u540e\u8f6c\u53d1\u56de\u5ba2\u6237\u7aef\u3002</li> <li>\u53cd\u5411\u4ee3\u7406\uff1a\u53d1\u751f\u5728 \u670d\u52a1\u7aef\uff0c\u7528\u6237\u4e0d\u77e5\u9053\u4ee3\u7406\u7684\u5b58\u5728\u3002</li> </ul> <p></p> <p>\u53cd\u5411\u4ee3\u7406\u662f\u5982\u4f55\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u7684\u5462\uff1f\u4ee5 Nginx \u4e3a\u4f8b\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p> <ul> <li>\u9996\u5148\uff0c\u5728\u4ee3\u7406\u670d\u52a1\u5668\u4e0a\u8bbe\u5b9a\u597d\u8d1f\u8f7d\u5747\u8861\u89c4\u5219\u3002</li> <li>\u7136\u540e\uff0c\u5f53\u6536\u5230\u5ba2\u6237\u7aef\u8bf7\u6c42\uff0c\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\u62e6\u622a\u6307\u5b9a\u7684\u57df\u540d\u6216 IP \u8bf7\u6c42\uff0c\u6839\u636e\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0c\u5c06\u8bf7\u6c42\u5206\u53d1\u5230\u5019\u9009\u670d\u52a1\u5668\u4e0a\u3002</li> <li>\u5176\u6b21\uff0c\u5982\u679c\u67d0\u53f0\u5019\u9009\u670d\u52a1\u5668\u5b95\u673a\uff0c\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\u4f1a\u6709\u5bb9\u9519\u5904\u7406\uff0c\u6bd4\u5982\u5206\u53d1\u8bf7\u6c42\u5931\u8d25 3 \u6b21\u4ee5\u4e0a\uff0c\u5c06\u8bf7\u6c42\u5206\u53d1\u5230\u5176\u4ed6\u5019\u9009\u670d\u52a1\u5668\u4e0a\u3002</li> </ul> <p>\u53cd\u5411\u4ee3\u7406\u7684 \u4f18\u70b9\uff1a</p> <ul> <li>1) \u591a\u79cd\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff1a\u652f\u6301\u591a\u79cd\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0c\u4ee5\u5e94\u5bf9\u4e0d\u540c\u7684\u573a\u666f\u9700\u6c42\u3002</li> <li>2) \u53ef\u4ee5\u76d1\u63a7\u670d\u52a1\u5668\uff1a\u57fa\u4e8e HTTP \u534f\u8bae\uff0c\u53ef\u4ee5\u76d1\u63a7\u8f6c\u53d1\u670d\u52a1\u5668\u7684\u72b6\u6001\uff0c\u5982\uff1a\u7cfb\u7edf\u8d1f\u8f7d\u3001\u54cd\u5e94\u65f6\u95f4\u3001\u662f\u5426\u53ef\u7528\u3001\u8fde\u63a5\u6570\u3001\u6d41\u91cf\u7b49\uff0c\u4ece\u800c\u6839\u636e\u8fd9\u4e9b\u6570\u636e\u8c03\u6574\u8d1f\u8f7d\u5747\u8861\u7684\u7b56\u7565\u3002</li> </ul> <p>\u53cd\u5411\u4ee3\u7406\u7684 \u7f3a\u70b9\uff1a</p> <ul> <li>1) \u989d\u5916\u7684\u8f6c\u53d1\u5f00\u9500\uff1a\u53cd\u5411\u4ee3\u7406\u7684\u8f6c\u53d1\u64cd\u4f5c\u672c\u8eab\u662f\u6709\u6027\u80fd\u5f00\u9500\u7684\uff0c\u53ef\u80fd\u4f1a\u5305\u62ec\u521b\u5efa\u8fde\u63a5\uff0c\u7b49\u5f85\u8fde\u63a5\u54cd\u5e94\uff0c\u5206\u6790\u54cd\u5e94\u7ed3\u679c\u7b49\u64cd\u4f5c\u3002</li> <li>2) \u589e\u52a0\u7cfb\u7edf\u590d\u6742\u5ea6\uff1a\u53cd\u5411\u4ee3\u7406\u5e38\u7528\u4e8e\u505a\u5206\u5e03\u5f0f\u5e94\u7528\u7684\u6c34\u5e73\u6269\u5c55\uff0c\u4f46\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5b58\u5728\u4ee5\u4e0b\u95ee\u9898\uff0c\u4e3a\u4e86\u89e3\u51b3\u4ee5\u4e0b\u95ee\u9898\u4f1a\u7ed9\u7cfb\u7edf\u6574\u4f53\u589e\u52a0\u989d\u5916\u7684\u590d\u6742\u5ea6\u548c\u8fd0\u7ef4\u6210\u672c\uff1a</li> </ul> <p>\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5982\u679c\u81ea\u8eab\u5b95\u673a\uff0c\u5c31\u65e0\u6cd5\u8bbf\u95ee\u7ad9\u70b9\uff0c\u6240\u4ee5\u9700\u8981\u6709 \u9ad8\u53ef\u7528 \u65b9\u6848\uff0c\u5e38\u89c1\u7684\u65b9\u6848\u6709\uff1a\u4e3b\u5907\u6a21\u5f0f\uff08\u4e00\u4e3b\u4e00\u5907\uff09\u3001\u53cc\u4e3b\u6a21\u5f0f\uff08\u4e92\u4e3a\u4e3b\u5907\uff09\u3002</p> <p>\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u81ea\u8eab\u4e5f\u5b58\u5728\u6027\u80fd\u74f6\u9888\uff0c\u968f\u7740\u9700\u8981\u8f6c\u53d1\u7684\u8bf7\u6c42\u91cf\u4e0d\u65ad\u6500\u5347\uff0c\u9700\u8981\u6709 \u53ef\u6269\u5c55 \u65b9\u6848\u3002</p>"},{"location":"chap6/7LoadBalancer/#2-2-4-ip","title":"2-2-4 IP\u8d1f\u8f7d\u5747\u8861","text":"<p>IP \u8d1f\u8f7d\u5747\u8861\u662f\u5728\u7f51\u7edc\u5c42\u901a\u8fc7\u4fee\u6539\u8bf7\u6c42\u76ee\u7684\u5730\u5740\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\u3002</p> <p></p> <p>\u5982\u4e0a\u56fe\u6240\u793a\uff0cIP \u5747\u8861\u5904\u7406\u6d41\u7a0b\u5927\u81f4\u4e3a\uff1a</p> <p>\u5ba2\u6237\u7aef\u8bf7\u6c42 192.168.137.10\uff0c\u7531\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\u63a5\u6536\u5230\u62a5\u6587\u3002</p> <p>\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\u6839\u636e\u7b97\u6cd5\u9009\u51fa\u4e00\u4e2a\u670d\u52a1\u8282\u70b9 192.168.0.1\uff0c\u7136\u540e\u5c06\u62a5\u6587\u8bf7\u6c42\u5730\u5740\u6539\u4e3a\u8be5\u8282\u70b9\u7684 IP\u3002</p> <p>\u771f\u5b9e\u670d\u52a1\u8282\u70b9\u6536\u5230\u8bf7\u6c42\u62a5\u6587\uff0c\u5904\u7406\u540e\uff0c\u8fd4\u56de\u54cd\u5e94\u6570\u636e\u5230\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\u3002</p> <p>\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\u5c06\u54cd\u5e94\u6570\u636e\u7684\u6e90\u5730\u5740\u6539\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\u5730\u5740\uff0c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002</p> <p>IP \u8d1f\u8f7d\u5747\u8861\u5728\u5185\u6838\u8fdb\u7a0b\u5b8c\u6210\u6570\u636e\u5206\u53d1\uff0c\u8f83\u53cd\u5411\u4ee3\u7406\u8d1f\u8f7d\u5747\u8861\u6709\u66f4\u597d\u7684\u4ece\u5904\u7406\u6027\u80fd\u3002\u4f46\u662f\uff0c\u7531\u4e8e\u6240\u6709\u8bf7\u6c42\u54cd\u5e94\u90fd\u8981\u7ecf\u8fc7\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\uff0c\u96c6\u7fa4\u7684\u541e\u5410\u91cf\u53d7\u5236\u4e8e\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\u7684\u5e26\u5bbd\u3002</p>"},{"location":"chap6/7LoadBalancer/#2-2-5","title":"2-2-5 \u6570\u636e\u94fe\u8def\u5c42\u8d1f\u8f7d\u5747\u8861","text":"<p>\u6570\u636e\u94fe\u8def\u5c42\u8d1f\u8f7d\u5747\u8861\u662f\u6307\u5728\u901a\u4fe1\u534f\u8bae\u7684\u6570\u636e\u94fe\u8def\u5c42\u4fee\u6539 mac \u5730\u5740\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\u3002</p> <p></p> <p>\u5728 Linux \u5e73\u53f0\u4e0a\u6700\u597d\u7684\u94fe\u8def\u5c42\u8d1f\u8f7d\u5747\u8861\u5f00\u6e90\u4ea7\u54c1\u662f LVS (Linux Virtual Server)\u3002LVS \u662f\u57fa\u4e8e Linux \u5185\u6838\u4e2d netfilter \u6846\u67b6\u5b9e\u73b0\u7684\u8d1f\u8f7d\u5747\u8861\u7cfb\u7edf\u3002netfilter \u662f\u5185\u6838\u6001\u7684 Linux \u9632\u706b\u5899\u673a\u5236\uff0c\u53ef\u4ee5\u5728\u6570\u636e\u5305\u6d41\u7ecf\u8fc7\u7a0b\u4e2d\uff0c\u6839\u636e\u89c4\u5219\u8bbe\u7f6e\u82e5\u5e72\u4e2a\u5173\u5361\uff08hook \u51fd\u6570\uff09\u6765\u6267\u884c\u76f8\u5173\u7684\u64cd\u4f5c\u3002</p> <p>LVS \u7684\u5de5\u4f5c\u6d41\u7a0b\u5927\u81f4\u5982\u4e0b\uff1a</p> <ul> <li>\u5f53\u7528\u6237\u8bbf\u95ee www.sina.com.cn \u65f6\uff0c\u7528\u6237\u6570\u636e\u901a\u8fc7\u5c42\u5c42\u7f51\u7edc\uff0c\u6700\u540e\u901a\u8fc7\u4ea4\u6362\u673a\u8fdb\u5165 LVS \u670d\u52a1\u5668\u7f51\u5361\uff0c\u5e76\u8fdb\u5165\u5185\u6838\u7f51\u7edc\u5c42\u3002</li> <li>\u8fdb\u5165 PREROUTING \u540e\u7ecf\u8fc7\u8def\u7531\u67e5\u627e\uff0c\u786e\u5b9a\u8bbf\u95ee\u7684\u76ee\u7684 VIP \u662f\u672c\u673a IP \u5730\u5740\uff0c\u6240\u4ee5\u6570\u636e\u5305\u8fdb\u5165\u5230 INPUT \u94fe\u4e0a</li> <li>IPVS \u662f\u5de5\u4f5c\u5728 INPUT \u94fe\u4e0a\uff0c\u4f1a\u6839\u636e\u8bbf\u95ee\u7684 vip+port \u5224\u65ad\u8bf7\u6c42\u662f\u5426 IPVS \u670d\u52a1\uff0c\u5982\u679c\u662f\u5219\u8c03\u7528\u6ce8\u518c\u7684 IPVS HOOK \u51fd\u6570\uff0c\u8fdb\u884c IPVS \u76f8\u5173\u4e3b\u6d41\u7a0b\uff0c\u5f3a\u884c\u4fee\u6539\u6570\u636e\u5305\u7684\u76f8\u5173\u6570\u636e\uff0c\u5e76\u5c06\u6570\u636e\u5305\u53d1\u5f80 POSTROUTING \u94fe\u4e0a\u3002</li> <li>POSTROUTING \u4e0a\u6536\u5230\u6570\u636e\u5305\u540e\uff0c\u6839\u636e\u76ee\u6807 IP \u5730\u5740\uff08\u540e\u7aef\u670d\u52a1\u5668\uff09\uff0c\u901a\u8fc7\u8def\u7531\u9009\u8def\uff0c\u5c06\u6570\u636e\u5305\u6700\u7ec8\u53d1\u5f80\u540e\u7aef\u7684\u670d\u52a1\u5668\u4e0a\u3002</li> </ul> <p>\u5f00\u6e90 LVS \u7248\u672c\u6709 3 \u79cd\u5de5\u4f5c\u6a21\u5f0f\uff0c\u6bcf\u79cd\u6a21\u5f0f\u5de5\u4f5c\u539f\u7406\u622a\u7136\u4e0d\u540c\uff0c\u8bf4\u5404\u79cd\u6a21\u5f0f\u90fd\u6709\u81ea\u5df1\u7684\u4f18\u7f3a\u70b9\uff0c\u5206\u522b\u9002\u5408\u4e0d\u540c\u7684\u5e94\u7528\u573a\u666f\uff0c\u4e0d\u8fc7\u6700\u7ec8\u672c\u8d28\u7684\u529f\u80fd\u90fd\u662f\u80fd\u5b9e\u73b0\u5747\u8861\u7684\u6d41\u91cf\u8c03\u5ea6\u548c\u826f\u597d\u7684\u6269\u5c55\u6027\u3002\u4e3b\u8981\u5305\u62ec\u4e09\u79cd\u6a21\u5f0f\uff1aDR \u6a21\u5f0f\u3001NAT \u6a21\u5f0f\u3001Tunnel \u6a21\u5f0f\u3002</p>"},{"location":"chap6/7LoadBalancer/#3","title":"3\u3001\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5","text":"<p>\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u5b9e\u73b0\u53ef\u4ee5\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1a</p> <ul> <li>\u6839\u636e\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u5728\u5019\u9009\u670d\u52a1\u5668\u5217\u8868\u9009\u51fa\u4e00\u4e2a\u670d\u52a1\u5668;</li> <li>\u5c06\u8bf7\u6c42\u6570\u636e\u53d1\u9001\u5230\u8be5\u670d\u52a1\u5668\u4e0a\u3002</li> </ul> <p>\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u662f\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u6838\u5fc3\u4e2d\u7684\u6838\u5fc3\u3002\u8d1f\u8f7d\u5747\u8861\u4ea7\u54c1\u591a\u79cd\u591a\u6837\uff0c\u4f46\u662f\u5404\u79cd\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u539f\u7406\u662f\u5171\u6027\u7684\u3002\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u6709\u5f88\u591a\u79cd\uff0c\u5206\u522b\u9002\u7528\u4e8e\u4e0d\u540c\u7684\u5e94\u7528\u573a\u666f\uff0c\u672c\u6587\u4ec5\u4ecb\u7ecd\u6700\u4e3a\u5e38\u89c1\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u7684\u7279\u6027\u53ca\u539f\u7406\uff1a\u8f6e\u8be2\u3001\u968f\u673a\u3001\u6700\u5c0f\u6d3b\u8dc3\u6570\u3001\u6e90\u5730\u5740\u54c8\u5e0c\u3001\u4e00\u81f4\u6027\u54c8\u5e0c\u3002</p> <p>\u6ce8\uff1a\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u7684\u5b9e\u73b0\uff0c\u63a8\u8350\u9605\u8bfb Dubbo \u5b98\u65b9\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u8bf4\u660e \uff0c\u6e90\u7801\u8bb2\u89e3\u975e\u5e38\u8be6\u7ec6\uff0c\u975e\u5e38\u503c\u5f97\u501f\u9274\u3002</p>"},{"location":"chap6/7LoadBalancer/#3-1","title":"3-1 \u968f\u673a","text":""},{"location":"chap6/7LoadBalancer/#3-1-1","title":"3-1-1 \u968f\u673a\u7b97\u6cd5","text":"<p>\u968f\u673a\uff08Random\uff09 \u7b97\u6cd5\u5c06\u8bf7\u6c42\u968f\u673a\u5206\u53d1\u5230\u5019\u9009\u670d\u52a1\u5668\u3002</p> <p>\u968f\u673a\u7b97\u6cd5 \u9002\u5408\u670d\u52a1\u5668\u786c\u4ef6\u76f8\u540c\u7684\u573a\u666f\u3002\u5b66\u4e60\u8fc7\u6982\u7387\u8bba\u7684\u90fd\u77e5\u9053\uff0c\u8c03\u7528\u91cf\u8f83\u5c0f\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u8d1f\u8f7d\u5e76\u4e0d\u5747\u5300\uff0c\u8c03\u7528\u91cf\u8d8a\u5927\uff0c\u8d1f\u8f7d\u8d8a\u5747\u8861\u3002</p> <p></p> <ul> <li>\u3010\u793a\u4f8b\u3011\u968f\u673a\u7b97\u6cd5\u5b9e\u73b0\u793a\u4f8b</li> </ul> <p>\u8d1f\u8f7d\u5747\u8861\u63a5\u53e3</p> <pre><code>public interface LoadBalance&lt;N extends Node&gt; {\n\n    N select(List&lt;N&gt; nodes, String ip);\n\n}\n</code></pre> <p>\u8d1f\u8f7d\u5747\u8861\u62bd\u8c61\u7c7b</p> <pre><code>public abstract class BaseLoadBalance&lt;N extends Node&gt; implements LoadBalance&lt;N&gt; {\n\n    @Override\n    public N select(List&lt;N&gt; nodes, String ip) {\n        if (CollectionUtil.isEmpty(nodes)) {\n            return null;\n        }\n\n        // \u5982\u679c nodes \u5217\u8868\u4e2d\u4ec5\u6709\u4e00\u4e2a node\uff0c\u76f4\u63a5\u8fd4\u56de\u5373\u53ef\uff0c\u65e0\u9700\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\n        if (nodes.size() == 1) {\n            return nodes.get(0);\n        }\n\n        return doSelect(nodes, ip);\n    }\n\n    protected abstract N doSelect(List&lt;N&gt; nodes, String ip);\n\n}\n</code></pre> <p>\u670d\u52a1\u5668\u8282\u70b9\u7c7b</p> <pre><code>public class Node implements Comparable&lt;Node&gt; {\n\n    protected String url;\n\n    protected Integer weight;\n\n    protected Integer active;\n\n    // ...\n}\n</code></pre> <p>\u968f\u673a\u7b97\u6cd5\u5b9e\u73b0</p> <pre><code>\npublic class RandomLoadBalance&lt;N extends Node&gt; extends BaseLoadBalance&lt;N&gt; implements LoadBalance&lt;N&gt; {\n\n    private final Random random = new Random();\n\n    @Override\n    protected N doSelect(List&lt;N&gt; nodes, String ip) {\n        // \u5728\u5217\u8868\u4e2d\u968f\u673a\u9009\u53d6\u4e00\u4e2a\u8282\u70b9\n        int index = random.nextInt(nodes.size());\n        return nodes.get(index);\n    }\n\n}\n</code></pre>"},{"location":"chap6/7LoadBalancer/#3-1-2","title":"3-1-2 \u52a0\u6743\u968f\u673a\u7b97\u6cd5","text":"<p>\u52a0\u6743\u968f\u673a\uff08Weighted Random\uff09 \u7b97\u6cd5\u5728\u968f\u673a\u7b97\u6cd5\u7684\u57fa\u7840\u4e0a\uff0c\u6309\u7167\u6982\u7387\u8c03\u6574\u6743\u91cd\uff0c\u8fdb\u884c\u8d1f\u8f7d\u5206\u914d\u3002</p> <p>\u3010\u793a\u4f8b\u3011\u52a0\u6743\u968f\u673a\u7b97\u6cd5\u5b9e\u73b0\u793a\u4f8b</p> <pre><code>\npublic class WeightRandomLoadBalance&lt;N extends Node&gt; extends BaseLoadBalance&lt;N&gt; implements LoadBalance&lt;N&gt; {\n\n    private final Random random = ThreadLocalRandom.current();\n\n    @Override\n    protected N doSelect(List&lt;N&gt; nodes, String ip) {\n\n        int length = nodes.size();\n        AtomicInteger totalWeight = new AtomicInteger(0);\n        for (N node : nodes) {\n            Integer weight = node.getWeight();\n            totalWeight.getAndAdd(weight);\n        }\n\n        if (totalWeight.get() &gt; 0) {\n            int offset = random.nextInt(totalWeight.get());\n            for (N node : nodes) {\n                // \u8ba9\u968f\u673a\u503c offset \u51cf\u53bb\u6743\u91cd\u503c\n                offset -= node.getWeight();\n                if (offset &lt; 0) {\n                    // \u8fd4\u56de\u76f8\u5e94\u7684 Node\n                    return node;\n                }\n            }\n        }\n\n        // \u76f4\u63a5\u968f\u673a\u8fd4\u56de\u4e00\u4e2a\n        return nodes.get(random.nextInt(length));\n    }\n\n}\n</code></pre>"},{"location":"chap6/7LoadBalancer/#3-2","title":"3-2 \u8f6e\u8be2","text":""},{"location":"chap6/7LoadBalancer/#3-2-1","title":"3-2-1 \u8f6e\u8be2\u7b97\u6cd5","text":"<p>\u8f6e\u8be2\uff08Round Robin\uff09\u7b97\u6cd5\u7684\u7b56\u7565\u662f\uff1a\u5c06\u8bf7\u6c42\u4f9d\u6b21\u5206\u53d1\u5230\u5019\u9009\u670d\u52a1\u5668\u3002</p> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u6536\u5230\u6765\u81ea\u5ba2\u6237\u7aef\u7684 6 \u4e2a\u8bf7\u6c42\uff0c(1, 3, 5) \u7684\u8bf7\u6c42\u4f1a\u88ab\u53d1\u9001\u5230\u670d\u52a1\u5668 1\uff0c(2, 4, 6) \u7684\u8bf7\u6c42\u4f1a\u88ab\u53d1\u9001\u5230\u670d\u52a1\u5668 2\u3002</p> <p></p> <p>\u8be5\u7b97\u6cd5\u9002\u5408\u573a\u666f\uff1a\u5404\u670d\u52a1\u5668\u5904\u7406\u80fd\u529b\u76f8\u8fd1\uff0c\u4e14\u6bcf\u4e2a\u4e8b\u52a1\u5de5\u4f5c\u91cf\u5dee\u5f02\u4e0d\u5927\u3002\u5982\u679c\u5b58\u5728\u8f83\u5927\u5dee\u5f02\uff0c\u90a3\u4e48\u5904\u7406\u8f83\u6162\u7684\u670d\u52a1\u5668\u5c31\u53ef\u80fd\u4f1a\u79ef\u538b\u8bf7\u6c42\uff0c\u6700\u7ec8\u65e0\u6cd5\u627f\u62c5\u8fc7\u5927\u7684\u8d1f\u8f7d\u3002</p> <p>\u3010\u793a\u4f8b\u3011\u8f6e\u8be2\u7b97\u6cd5\u793a\u4f8b</p> <p>\u8f6e\u8be2\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u5b9e\u73b0</p> <p></p> <pre><code>public class RoundRobinLoadBalance&lt;N extends Node&gt; extends BaseLoadBalance&lt;N&gt; implements LoadBalance&lt;N&gt; {\n\n    private final AtomicInteger position = new AtomicInteger(0);\n\n    @Override\n    protected N doSelect(List&lt;N&gt; nodes, String ip) {\n        int length = nodes.size();\n        // \u5982\u679c\u4f4d\u7f6e\u503c\u5df2\u7ecf\u7b49\u4e8e\u8282\u70b9\u6570\uff0c\u91cd\u7f6e\u4e3a 0\n        position.compareAndSet(length, 0);\n        N node = nodes.get(position.get());\n        position.getAndIncrement();\n        return node;\n    }\n\n}\n</code></pre>"},{"location":"chap6/7LoadBalancer/#3-2-2","title":"3-2-2 \u52a0\u6743\u8f6e\u8be2\u7b97\u6cd5","text":"<p>\u52a0\u6743\u8f6e\u8be2\uff08Weighted Round Robbin\uff09\u7b97\u6cd5\u5728\u8f6e\u8be2\u7b97\u6cd5\u7684\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u4e86\u6743\u91cd\u5c5e\u6027\u6765\u8c03\u8282\u8f6c\u53d1\u670d\u52a1\u5668\u7684\u8bf7\u6c42\u6570\u76ee\u3002\u6027\u80fd\u9ad8\u3001\u5904\u7406\u901f\u5ea6\u5feb\u7684\u8282\u70b9\u5e94\u8be5\u8bbe\u7f6e\u66f4\u9ad8\u7684\u6743\u91cd\uff0c\u4f7f\u5f97\u5206\u53d1\u65f6\u4f18\u5148\u5c06\u8bf7\u6c42\u5206\u53d1\u5230\u6743\u91cd\u8f83\u9ad8\u7684\u8282\u70b9\u4e0a\u3002</p> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u670d\u52a1\u5668 A \u8bbe\u7f6e\u6743\u91cd\u4e3a 5\uff0c\u670d\u52a1\u5668 B \u8bbe\u7f6e\u6743\u91cd\u4e3a 1\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u6536\u5230\u6765\u81ea\u5ba2\u6237\u7aef\u7684 6 \u4e2a\u8bf7\u6c42\uff0c\u90a3\u4e48 (1, 2, 3, 4, 5) \u8bf7\u6c42\u4f1a\u88ab\u53d1\u9001\u5230\u670d\u52a1\u5668 A\uff0c(6) \u8bf7\u6c42\u4f1a\u88ab\u53d1\u9001\u5230\u670d\u52a1\u5668 B\u3002</p> <p></p> <p>\u3010\u793a\u4f8b\u3011\u52a0\u6743\u8f6e\u8be2\u7b97\u6cd5\u5b9e\u73b0\u793a\u4f8b</p> <p>\u4ee5\u4e0b\u5b9e\u73b0\u57fa\u4e8e Dubbo \u52a0\u6743\u8f6e\u8be2\u7b97\u6cd5\u505a\u4e86\u4e00\u4e9b\u7b80\u5316\u3002</p> <pre><code>public class WeightRoundRobinLoadBalance&lt;N extends Node&gt; extends BaseLoadBalance&lt;N&gt; implements LoadBalance&lt;N&gt; {\n\n    /**\n     * 60\u79d2\n     */\n    private static final int RECYCLE_PERIOD = 60000;\n\n    /**\n     * Node hashcode \u5230 WeightedRoundRobin \u7684\u6620\u5c04\u5173\u7cfb\n     */\n    private ConcurrentMap&lt;Integer, WeightedRoundRobin&gt; weightMap = new ConcurrentHashMap&lt;&gt;();\n\n    /**\n     * \u539f\u5b50\u66f4\u65b0\u9501\n     */\n    private AtomicBoolean updateLock = new AtomicBoolean();\n\n    @Override\n    protected N doSelect(List&lt;N&gt; nodes, String ip) {\n\n        int totalWeight = 0;\n        long maxCurrent = Long.MIN_VALUE;\n\n        // \u83b7\u53d6\u5f53\u524d\u65f6\u95f4\n        long now = System.currentTimeMillis();\n        N selectedNode = null;\n        WeightedRoundRobin selectedWRR = null;\n\n        // \u4e0b\u9762\u8fd9\u4e2a\u5faa\u73af\u4e3b\u8981\u505a\u4e86\u8fd9\u6837\u51e0\u4ef6\u4e8b\u60c5\uff1a\n        //   1. \u904d\u5386 Node \u5217\u8868\uff0c\u68c0\u6d4b\u5f53\u524d Node \u662f\u5426\u6709\u76f8\u5e94\u7684 WeightedRoundRobin\uff0c\u6ca1\u6709\u5219\u521b\u5efa\n        //   2. \u68c0\u6d4b Node \u6743\u91cd\u662f\u5426\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u82e5\u53d8\u5316\u4e86\uff0c\u5219\u66f4\u65b0 WeightedRoundRobin \u7684 weight \u5b57\u6bb5\n        //   3. \u8ba9 current \u5b57\u6bb5\u52a0\u4e0a\u81ea\u8eab\u6743\u91cd\uff0c\u7b49\u4ef7\u4e8e current += weight\n        //   4. \u8bbe\u7f6e lastUpdate \u5b57\u6bb5\uff0c\u5373 lastUpdate = now\n        //   5. \u5bfb\u627e\u5177\u6709\u6700\u5927 current \u7684 Node\uff0c\u4ee5\u53ca Node \u5bf9\u5e94\u7684 WeightedRoundRobin\uff0c\n        //      \u6682\u5b58\u8d77\u6765\uff0c\u7559\u4f5c\u540e\u7528\n        //   6. \u8ba1\u7b97\u6743\u91cd\u603b\u548c\n        for (N node : nodes) {\n            int hashCode = node.hashCode();\n            WeightedRoundRobin weightedRoundRobin = weightMap.get(hashCode);\n            int weight = node.getWeight();\n            if (weight &lt; 0) {\n                weight = 0;\n            }\n\n            // \u68c0\u6d4b\u5f53\u524d Node \u662f\u5426\u6709\u5bf9\u5e94\u7684 WeightedRoundRobin\uff0c\u6ca1\u6709\u5219\u521b\u5efa\n            if (weightedRoundRobin == null) {\n                weightedRoundRobin = new WeightedRoundRobin();\n                // \u8bbe\u7f6e Node \u6743\u91cd\n                weightedRoundRobin.setWeight(weight);\n                // \u5b58\u50a8 url \u552f\u4e00\u6807\u8bc6 identifyString \u5230 weightedRoundRobin \u7684\u6620\u5c04\u5173\u7cfb\n                weightMap.putIfAbsent(hashCode, weightedRoundRobin);\n                weightedRoundRobin = weightMap.get(hashCode);\n            }\n            // Node \u6743\u91cd\u4e0d\u7b49\u4e8e WeightedRoundRobin \u4e2d\u4fdd\u5b58\u7684\u6743\u91cd\uff0c\u8bf4\u660e\u6743\u91cd\u53d8\u5316\u4e86\uff0c\u6b64\u65f6\u8fdb\u884c\u66f4\u65b0\n            if (weight != weightedRoundRobin.getWeight()) {\n                weightedRoundRobin.setWeight(weight);\n            }\n\n            // \u8ba9 current \u52a0\u4e0a\u81ea\u8eab\u6743\u91cd\uff0c\u7b49\u4ef7\u4e8e current += weight\n            long current = weightedRoundRobin.increaseCurrent();\n            // \u8bbe\u7f6e lastUpdate\uff0c\u8868\u793a\u8fd1\u671f\u66f4\u65b0\u8fc7\n            weightedRoundRobin.setLastUpdate(now);\n            // \u627e\u51fa\u6700\u5927\u7684 current\n            if (current &gt; maxCurrent) {\n                maxCurrent = current;\n                // \u5c06\u5177\u6709\u6700\u5927 current \u6743\u91cd\u7684 Node \u8d4b\u503c\u7ed9 selectedNode\n                selectedNode = node;\n                // \u5c06 Node \u5bf9\u5e94\u7684 weightedRoundRobin \u8d4b\u503c\u7ed9 selectedWRR\uff0c\u7559\u4f5c\u540e\u7528\n                selectedWRR = weightedRoundRobin;\n            }\n\n            // \u8ba1\u7b97\u6743\u91cd\u603b\u548c\n            totalWeight += weight;\n        }\n\n        // \u5bf9 weightMap \u8fdb\u884c\u68c0\u67e5\uff0c\u8fc7\u6ee4\u6389\u957f\u65f6\u95f4\u672a\u88ab\u66f4\u65b0\u7684\u8282\u70b9\u3002\n        // \u8be5\u8282\u70b9\u53ef\u80fd\u6302\u4e86\uff0cnodes \u4e2d\u4e0d\u5305\u542b\u8be5\u8282\u70b9\uff0c\u6240\u4ee5\u8be5\u8282\u70b9\u7684 lastUpdate \u957f\u65f6\u95f4\u65e0\u6cd5\u88ab\u66f4\u65b0\u3002\n        // \u82e5\u672a\u66f4\u65b0\u65f6\u957f\u8d85\u8fc7\u9608\u503c\u540e\uff0c\u5c31\u4f1a\u88ab\u79fb\u9664\u6389\uff0c\u9ed8\u8ba4\u9608\u503c\u4e3a60\u79d2\u3002\n        if (!updateLock.get() &amp;&amp; nodes.size() != weightMap.size()) {\n            if (updateLock.compareAndSet(false, true)) {\n                try {\n                    // \u904d\u5386\u4fee\u6539\uff0c\u5373\u79fb\u9664\u8fc7\u671f\u8bb0\u5f55\n                    weightMap.entrySet().removeIf(item -&gt; now - item.getValue().getLastUpdate() &gt; RECYCLE_PERIOD);\n                } finally {\n                    updateLock.set(false);\n                }\n            }\n        }\n\n        if (selectedNode != null) {\n            // \u8ba9 current \u51cf\u53bb\u6743\u91cd\u603b\u548c\uff0c\u7b49\u4ef7\u4e8e current -= totalWeight\n            selectedWRR.decreaseCurrent(totalWeight);\n            // \u8fd4\u56de\u5177\u6709\u6700\u5927 current \u7684 Node\n            return selectedNode;\n        }\n\n        // should not happen here\n        return nodes.get(0);\n    }\n\n    protected static class WeightedRoundRobin {\n\n        // \u670d\u52a1\u63d0\u4f9b\u8005\u6743\u91cd\n        private int weight;\n        // \u5f53\u524d\u6743\u91cd\n        private AtomicLong current = new AtomicLong(0);\n        // \u6700\u540e\u4e00\u6b21\u66f4\u65b0\u65f6\u95f4\n        private long lastUpdate;\n\n        public long increaseCurrent() {\n            // current = current + weight\uff1b\n            return current.addAndGet(weight);\n        }\n\n        public long decreaseCurrent(int total) {\n            // current = current - total;\n            return current.addAndGet(-1 * total);\n        }\n\n        public int getWeight() {\n            return weight;\n        }\n\n        public void setWeight(int weight) {\n            this.weight = weight;\n            // \u521d\u59cb\u60c5\u51b5\u4e0b\uff0ccurrent = 0\n            current.set(0);\n        }\n\n        public AtomicLong getCurrent() {\n            return current;\n        }\n\n        public void setCurrent(AtomicLong current) {\n            this.current = current;\n        }\n\n        public long getLastUpdate() {\n            return lastUpdate;\n        }\n\n        public void setLastUpdate(long lastUpdate) {\n            this.lastUpdate = lastUpdate;\n        }\n\n    }\n\n}\n</code></pre>"},{"location":"chap6/7LoadBalancer/#3-3","title":"3-3 \u6700\u5c0f\u6d3b\u8dc3\u6570","text":"<p>\u6700\u5c0f\u6d3b\u8dc3\u6570\uff08Least Active\uff09\u7b97\u6cd5 \u5c06\u8bf7\u6c42\u5206\u53d1\u5230\u8fde\u63a5\u6570/\u8bf7\u6c42\u6570\u6700\u5c11\u7684\u5019\u9009\u670d\u52a1\u5668\uff08\u76ee\u524d\u5904\u7406\u8bf7\u6c42\u6700\u5c11\u7684\u670d\u52a1\u5668\uff09\u3002</p> <ul> <li>\u7279\u70b9\uff1a\u6839\u636e\u5019\u9009\u670d\u52a1\u5668\u5f53\u524d\u7684\u8bf7\u6c42\u8fde\u63a5\u6570\uff0c\u52a8\u6001\u5206\u914d\u3002</li> <li>\u573a\u666f\uff1a\u9002\u7528\u4e8e\u5bf9\u7cfb\u7edf\u8d1f\u8f7d\u8f83\u4e3a\u654f\u611f\u6216\u8bf7\u6c42\u8fde\u63a5\u65f6\u957f\u76f8\u5dee\u8f83\u5927\u7684\u573a\u666f\u3002</li> </ul> <p>\u7531\u4e8e\u6bcf\u4e2a\u8bf7\u6c42\u7684\u8fde\u63a5\u65f6\u957f\u4e0d\u4e00\u6837\uff0c\u5982\u679c\u91c7\u7528\u7b80\u5355\u7684\u8f6e\u5faa\u6216\u968f\u673a\u7b97\u6cd5\uff0c\u90fd\u53ef\u80fd\u51fa\u73b0\u67d0\u4e9b\u670d\u52a1\u5668\u5f53\u524d\u8fde\u63a5\u6570\u8fc7\u5927\uff0c\u800c\u53e6\u4e00\u4e9b\u670d\u52a1\u5668\u7684\u8fde\u63a5\u8fc7\u5c0f\u7684\u60c5\u51b5\uff0c\u8fd9\u5c31\u9020\u6210\u4e86\u8d1f\u8f7d\u5e76\u975e\u771f\u6b63\u5747\u8861\u3002\u867d\u7136\uff0c\u8f6e\u8be2\u6216\u7b97\u6cd5\u90fd\u53ef\u4ee5\u901a\u8fc7\u52a0\u6743\u91cd\u5c5e\u6027\u7684\u65b9\u5f0f\u8fdb\u884c\u8d1f\u8f7d\u8c03\u6574\uff0c\u4f46\u52a0\u6743\u65b9\u5f0f\u96be\u4ee5\u5e94\u5bf9\u52a8\u6001\u53d8\u5316\u3002</p> <p>\u4f8b\u5982\u4e0b\u56fe\u4e2d\uff0c(1, 3, 5) \u8bf7\u6c42\u4f1a\u88ab\u53d1\u9001\u5230\u670d\u52a1\u5668 1\uff0c\u4f46\u662f (1, 3) \u5f88\u5feb\u5c31\u65ad\u5f00\u8fde\u63a5\uff0c\u6b64\u65f6\u53ea\u6709 (5) \u8bf7\u6c42\u8fde\u63a5\u670d\u52a1\u5668 1\uff1b(2, 4, 6) \u8bf7\u6c42\u88ab\u53d1\u9001\u5230\u670d\u52a1\u5668 2\uff0c\u53ea\u6709 (2) \u7684\u8fde\u63a5\u65ad\u5f00\u3002\u8be5\u7cfb\u7edf\u7ee7\u7eed\u8fd0\u884c\u65f6\uff0c\u670d\u52a1\u5668 2 \u4f1a\u627f\u62c5\u8fc7\u5927\u7684\u8d1f\u8f7d\u3002</p> <p></p> <p>\u6700\u5c0f\u6d3b\u8dc3\u6570\u7b97\u6cd5\u4f1a\u8bb0\u5f55\u5f53\u524d\u65f6\u523b\uff0c\u6bcf\u4e2a\u5019\u9009\u8282\u70b9\u6b63\u5728\u5904\u7406\u7684\u8fde\u63a5\u6570\uff0c\u7136\u540e\u9009\u62e9\u8fde\u63a5\u6570\u6700\u5c0f\u7684\u8282\u70b9\u3002\u8be5\u7b56\u7565\u80fd\u591f\u52a8\u6001\u3001\u5b9e\u65f6\u5730\u53cd\u5e94\u670d\u52a1\u5668\u7684\u5f53\u524d\u72b6\u51b5\uff0c\u8f83\u4e3a\u5408\u7406\u5730\u5c06\u8d1f\u8d23\u5206\u914d\u5747\u5300\uff0c\u9002\u7528\u4e8e\u5bf9\u5f53\u524d\u7cfb\u7edf\u8d1f\u8f7d\u8f83\u4e3a\u654f\u611f\u7684\u573a\u666f\u3002</p> <p>\u4f8b\u5982\u4e0b\u56fe\u4e2d\uff0c\u670d\u52a1\u5668 1 \u5f53\u524d\u8fde\u63a5\u6570\u6700\u5c0f\uff0c\u90a3\u4e48\u65b0\u5230\u6765\u7684\u8bf7\u6c42 6 \u5c31\u4f1a\u88ab\u53d1\u9001\u5230\u670d\u52a1\u5668 1 \u4e0a\u3002</p> <p></p> <p>\u52a0\u6743\u6700\u5c0f\u6d3b\u8dc3\u6570\uff08Weighted Least Connection\uff09\u5728\u6700\u5c0f\u6d3b\u8dc3\u6570\u7684\u57fa\u7840\u4e0a\uff0c\u6839\u636e\u670d\u52a1\u5668\u7684\u6027\u80fd\u4e3a\u6bcf\u53f0\u670d\u52a1\u5668\u5206\u914d\u6743\u91cd\uff0c\u518d\u6839\u636e\u6743\u91cd\u8ba1\u7b97\u51fa\u6bcf\u53f0\u670d\u52a1\u5668\u80fd\u5904\u7406\u7684\u8fde\u63a5\u6570\u3002</p> <p>\u6700\u5c0f\u6d3b\u8dc3\u6570\u7b97\u6cd5\u5b9e\u73b0\u8981\u70b9\uff1a\u6d3b\u8dc3\u8c03\u7528\u6570\u8d8a\u5c0f\uff0c\u8868\u660e\u8be5\u670d\u52a1\u8282\u70b9\u5904\u7406\u80fd\u529b\u8d8a\u9ad8\uff0c\u5355\u4f4d\u65f6\u95f4\u5185\u53ef\u5904\u7406\u66f4\u591a\u7684\u8bf7\u6c42\uff0c\u5e94\u4f18\u5148\u5c06\u8bf7\u6c42\u5206\u53d1\u7ed9\u8be5\u670d\u52a1\u3002\u5728\u5177\u4f53\u5b9e\u73b0\u4e2d\uff0c\u6bcf\u4e2a\u670d\u52a1\u8282\u70b9\u5bf9\u5e94\u4e00\u4e2a\u6d3b\u8dc3\u6570 active\u3002\u521d\u59cb\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u670d\u52a1\u63d0\u4f9b\u8005\u6d3b\u8dc3\u6570\u5747\u4e3a 0\u3002\u6bcf\u6536\u5230\u4e00\u4e2a\u8bf7\u6c42\uff0c\u6d3b\u8dc3\u6570\u52a0 1\uff0c\u5b8c\u6210\u8bf7\u6c42\u540e\u5219\u5c06\u6d3b\u8dc3\u6570\u51cf 1\u3002\u5728\u670d\u52a1\u8fd0\u884c\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u6027\u80fd\u597d\u7684\u670d\u52a1\u63d0\u4f9b\u8005\u5904\u7406\u8bf7\u6c42\u7684\u901f\u5ea6\u66f4\u5feb\uff0c\u56e0\u6b64\u6d3b\u8dc3\u6570\u4e0b\u964d\u7684\u4e5f\u8d8a\u5feb\uff0c\u6b64\u65f6\u8fd9\u6837\u7684\u670d\u52a1\u63d0\u4f9b\u8005\u80fd\u591f\u4f18\u5148\u83b7\u53d6\u5230\u65b0\u7684\u670d\u52a1\u8bf7\u6c42\u3001\u8fd9\u5c31\u662f\u6700\u5c0f\u6d3b\u8dc3\u6570\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u7684\u57fa\u672c\u601d\u60f3\u3002</p> <p>\u3010\u793a\u4f8b\u3011\u6700\u5c0f\u6d3b\u8dc3\u6570\u7b97\u6cd5\u5b9e\u73b0</p> <p>\u4ee5\u4e0b\u5b9e\u73b0\u57fa\u4e8e Dubbo \u6700\u5c0f\u6d3b\u8dc3\u6570\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u505a\u4e86\u4e9b\u8bb8\u6539\u52a8\u3002</p> <pre><code>\npublic class LeastActiveLoadBalance&lt;N extends Node&gt; extends BaseLoadBalance&lt;N&gt; implements LoadBalance&lt;N&gt; {\n\n    private final Random random = new Random();\n\n    @Override\n    protected N doSelect(List&lt;N&gt; nodes, String ip) {\n        int length = nodes.size();\n        // \u6700\u5c0f\u7684\u6d3b\u8dc3\u6570\n        int leastActive = -1;\n        // \u5177\u6709\u76f8\u540c\u201c\u6700\u5c0f\u6d3b\u8dc3\u6570\u201d\u7684\u670d\u52a1\u8005\u63d0\u4f9b\u8005\uff08\u4ee5\u4e0b\u7528 Node \u4ee3\u79f0\uff09\u6570\u91cf\n        int leastCount = 0;\n        // leastIndexs \u7528\u4e8e\u8bb0\u5f55\u5177\u6709\u76f8\u540c\u201c\u6700\u5c0f\u6d3b\u8dc3\u6570\u201d\u7684 Node \u5728 nodes \u5217\u8868\u4e2d\u7684\u4e0b\u6807\u4fe1\u606f\n        int[] leastIndexs = new int[length];\n        int totalWeight = 0;\n        // \u7b2c\u4e00\u4e2a\u6700\u5c0f\u6d3b\u8dc3\u6570\u7684 Node \u6743\u91cd\u503c\uff0c\u7528\u4e8e\u4e0e\u5176\u4ed6\u5177\u6709\u76f8\u540c\u6700\u5c0f\u6d3b\u8dc3\u6570\u7684 Node \u7684\u6743\u91cd\u8fdb\u884c\u5bf9\u6bd4\uff0c\n        // \u4ee5\u68c0\u6d4b\u662f\u5426\u201c\u6240\u6709\u5177\u6709\u76f8\u540c\u6700\u5c0f\u6d3b\u8dc3\u6570\u7684 Node \u7684\u6743\u91cd\u201d\u5747\u76f8\u7b49\n        int firstWeight = 0;\n        boolean sameWeight = true;\n\n        // \u904d\u5386 nodes \u5217\u8868\n        for (int i = 0; i &lt; length; i++) {\n            N node = nodes.get(i);\n            // \u53d1\u73b0\u66f4\u5c0f\u7684\u6d3b\u8dc3\u6570\uff0c\u91cd\u65b0\u5f00\u59cb\n            if (leastActive == -1 || node.getActive() &lt; leastActive) {\n                // \u4f7f\u7528\u5f53\u524d\u6d3b\u8dc3\u6570\u66f4\u65b0\u6700\u5c0f\u6d3b\u8dc3\u6570 leastActive\n                leastActive = node.getActive();\n                // \u66f4\u65b0 leastCount \u4e3a 1\n                leastCount = 1;\n                // \u8bb0\u5f55\u5f53\u524d\u4e0b\u6807\u503c\u5230 leastIndexs \u4e2d\n                leastIndexs[0] = i;\n                totalWeight = node.getWeight();\n                firstWeight = node.getWeight();\n                sameWeight = true;\n\n                // \u5f53\u524d Node \u7684\u6d3b\u8dc3\u6570 node.getActive() \u4e0e\u6700\u5c0f\u6d3b\u8dc3\u6570 leastActive \u76f8\u540c\n            } else if (node.getActive() == leastActive) {\n                // \u5728 leastIndexs \u4e2d\u8bb0\u5f55\u4e0b\u5f53\u524d Node \u5728 nodes \u96c6\u5408\u4e2d\u7684\u4e0b\u6807\n                leastIndexs[leastCount++] = i;\n                // \u7d2f\u52a0\u6743\u91cd\n                totalWeight += node.getWeight();\n                // \u68c0\u6d4b\u5f53\u524d Node \u7684\u6743\u91cd\u4e0e firstWeight \u662f\u5426\u76f8\u7b49\uff0c\n                // \u4e0d\u76f8\u7b49\u5219\u5c06 sameWeight \u7f6e\u4e3a false\n                if (sameWeight &amp;&amp; i &gt; 0\n                    &amp;&amp; node.getWeight() != firstWeight) {\n                    sameWeight = false;\n                }\n            }\n        }\n\n        // \u5f53\u53ea\u6709\u4e00\u4e2a Node \u5177\u6709\u6700\u5c0f\u6d3b\u8dc3\u6570\uff0c\u6b64\u65f6\u76f4\u63a5\u8fd4\u56de\u8be5 Node \u5373\u53ef\n        if (leastCount == 1) {\n            return nodes.get(leastIndexs[0]);\n        }\n\n        // \u6709\u591a\u4e2a Node \u5177\u6709\u76f8\u540c\u7684\u6700\u5c0f\u6d3b\u8dc3\u6570\uff0c\u4f46\u5b83\u4eec\u4e4b\u95f4\u7684\u6743\u91cd\u4e0d\u540c\n        if (!sameWeight &amp;&amp; totalWeight &gt; 0) {\n            // \u968f\u673a\u751f\u6210\u4e00\u4e2a [0, totalWeight) \u4e4b\u95f4\u7684\u6570\u5b57\n            int offsetWeight = random.nextInt(totalWeight);\n            // \u5faa\u73af\u8ba9\u968f\u673a\u6570\u51cf\u53bb\u5177\u6709\u6700\u5c0f\u6d3b\u8dc3\u6570\u7684 Node \u7684\u6743\u91cd\u503c\uff0c\n            // \u5f53 offset \u5c0f\u4e8e\u7b49\u4e8e0\u65f6\uff0c\u8fd4\u56de\u76f8\u5e94\u7684 Node\n            for (int i = 0; i &lt; leastCount; i++) {\n                int leastIndex = leastIndexs[i];\n                // \u83b7\u53d6\u6743\u91cd\u503c\uff0c\u5e76\u8ba9\u968f\u673a\u6570\u51cf\u53bb\u6743\u91cd\u503c\n                offsetWeight -= nodes.get(leastIndex).getWeight();\n                if (offsetWeight &lt;= 0) {\n                    return nodes.get(leastIndex);\n                }\n            }\n        }\n        // \u5982\u679c\u6743\u91cd\u76f8\u540c\u6216\u6743\u91cd\u4e3a0\u65f6\uff0c\u968f\u673a\u8fd4\u56de\u4e00\u4e2a Node\n        return nodes.get(leastIndexs[random.nextInt(leastCount)]);\n    }\n\n}\n</code></pre>"},{"location":"chap6/7LoadBalancer/#3-4","title":"3-4 \u6e90\u5730\u5740\u54c8\u5e0c","text":"<p>\u6e90\u5730\u5740\u54c8\u5e0c\uff08IP Hash\uff09\u7b97\u6cd5 \u6839\u636e\u8bf7\u6c42\u6e90 IP\uff0c\u901a\u8fc7\u54c8\u5e0c\u8ba1\u7b97\u5f97\u5230\u4e00\u4e2a\u6570\u503c\uff0c\u7528\u8be5\u6570\u503c\u5728\u5019\u9009\u670d\u52a1\u5668\u5217\u8868\u7684\u8fdb\u884c\u53d6\u6a21\u8fd0\u7b97\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u4fbf\u662f\u9009\u4e2d\u7684\u670d\u52a1\u5668\u3002</p> <p>\u53ef\u4ee5\u4fdd\u8bc1\u540c\u4e00 IP \u7684\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u4f1a\u8f6c\u53d1\u5230\u540c\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\uff0c\u7528\u6765\u5b9e\u73b0\u4f1a\u8bdd\u7c98\u6ede\uff08Sticky Session\uff09\u3002</p> <p>\u7279\u70b9\uff1a\u4fdd\u8bc1\u7279\u5b9a\u7528\u6237\u603b\u662f\u8bf7\u6c42\u5230\u76f8\u540c\u7684\u670d\u52a1\u5668\uff0c\u82e5\u670d\u52a1\u5668\u5b95\u673a\uff0c\u4f1a\u8bdd\u4f1a\u4e22\u5931\u3002</p> <p>\u3010\u793a\u4f8b\u3011\u6e90\u5730\u5740\u54c8\u5e0c\u7b97\u6cd5\u5b9e\u73b0\u793a\u4f8b</p> <pre><code>public class IpHashLoadBalance&lt;N extends Node&gt; extends BaseLoadBalance&lt;N&gt; implements LoadBalance&lt;N&gt; {\n\n    @Override\n    protected N doSelect(List&lt;N&gt; nodes, String ip) {\n        if (StrUtil.isBlank(ip)) {\n            ip = \"127.0.0.1\";\n        }\n\n        int length = nodes.size();\n        int index = hash(ip) % length;\n        return nodes.get(index);\n    }\n\n    public int hash(String text) {\n        return HashUtil.fnvHash(text);\n    }\n\n}\n</code></pre>"},{"location":"chap6/7LoadBalancer/#3-5","title":"3-5 \u4e00\u81f4\u6027\u54c8\u5e0c","text":"<p>\u4e00\u81f4\u6027\u54c8\u5e0c\uff08Consistent Hash\uff09\u7b97\u6cd5\u7684\u76ee\u6807\u662f\uff1a\u76f8\u540c\u7684\u8bf7\u6c42\u5c3d\u53ef\u80fd\u843d\u5230\u540c\u4e00\u4e2a\u670d\u52a1\u5668\u4e0a\u3002</p> <p>\u4e00\u81f4\u6027\u54c8\u5e0c \u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3 \u7a33\u5b9a\u6027\u95ee\u9898\uff0c\u53ef\u4ee5\u5c06\u6240\u6709\u7684 \u5b58\u50a8\u8282\u70b9 \u6392\u5217\u5728 \u9996\u5c3e\u76f8\u63a5 \u7684 Hash \u73af\u4e0a\uff0c\u6bcf\u4e2a key \u5728\u8ba1\u7b97 Hash \u540e\u4f1a \u987a\u65f6\u9488 \u627e\u5230 \u4e34\u63a5 \u7684 \u5b58\u50a8\u8282\u70b9 \u5b58\u653e\u3002\u800c\u5f53\u6709\u8282\u70b9 \u52a0\u5165 \u6216 \u9000\u51fa \u65f6\uff0c\u4ec5\u5f71\u54cd\u8be5\u8282\u70b9\u5728 Hash\u73af\u4e0a\u987a\u65f6\u9488\u76f8\u90bb\u7684\u540e\u7eed\u8282\u70b9\u3002</p> <p></p> <p>1\uff09\u76f8\u540c\u7684\u8bf7\u6c42\u662f\u6307\uff1a\u4e00\u822c\u5728\u4f7f\u7528\u4e00\u81f4\u6027\u54c8\u5e0c\u65f6\uff0c\u9700\u8981\u6307\u5b9a\u4e00\u4e2a key \u7528\u4e8e hash \u8ba1\u7b97\uff0c\u53ef\u80fd\u662f\uff1a</p> <ul> <li>\u7528\u6237 ID</li> <li>\u8bf7\u6c42\u65b9 IP</li> <li>\u8bf7\u6c42\u670d\u52a1\u540d\u79f0\uff0c\u53c2\u6570\u5217\u8868\u6784\u6210\u7684\u4e32</li> </ul> <p>2\uff09\u5c3d\u53ef\u80fd\u662f\u6307\uff1a\u670d\u52a1\u5668\u53ef\u80fd\u53d1\u751f\u4e0a\u4e0b\u7ebf\uff0c\u5c11\u6570\u670d\u52a1\u5668\u7684\u53d8\u5316\u4e0d\u5e94\u8be5\u5f71\u54cd\u5927\u591a\u6570\u7684\u8bf7\u6c42\u3002</p> <p>\u5f53\u67d0\u53f0\u5019\u9009\u670d\u52a1\u5668\u5b95\u673a\u65f6\uff0c\u539f\u672c\u53d1\u5f80\u8be5\u670d\u52a1\u5668\u7684\u8bf7\u6c42\uff0c\u4f1a\u57fa\u4e8e\u865a\u62df\u8282\u70b9\uff0c\u5e73\u644a\u5230\u5176\u5b83\u5019\u9009\u670d\u52a1\u5668\uff0c\u4e0d\u4f1a\u5f15\u8d77\u5267\u70c8\u53d8\u52a8\u3002</p> <p>\u4f18\u70b9\uff1a\u52a0\u5165 \u548c \u5220\u9664 \u8282\u70b9\u53ea\u5f71\u54cd \u54c8\u5e0c\u73af \u4e2d \u987a\u65f6\u9488\u65b9\u5411 \u7684 \u76f8\u90bb\u7684\u8282\u70b9\uff0c\u5bf9\u5176\u4ed6\u8282\u70b9\u65e0\u5f71\u54cd\u3002</p> <p>\u7f3a\u70b9\uff1a\u52a0\u51cf\u8282\u70b9 \u4f1a\u9020\u6210 \u54c8\u5e0c\u73af \u4e2d\u90e8\u5206\u6570\u636e \u65e0\u6cd5\u547d\u4e2d\u3002\u5f53\u4f7f\u7528 \u5c11\u91cf\u8282\u70b9 \u65f6\uff0c\u8282\u70b9\u53d8\u5316 \u5c06\u5927\u8303\u56f4\u5f71\u54cd \u54c8\u5e0c\u73af \u4e2d \u6570\u636e\u6620\u5c04\uff0c\u4e0d\u9002\u5408 \u5c11\u91cf\u6570\u636e\u8282\u70b9 \u7684\u5206\u5e03\u5f0f\u65b9\u6848\u3002\u666e\u901a \u7684 \u4e00\u81f4\u6027\u54c8\u5e0c\u5206\u533a \u5728\u589e\u51cf\u8282\u70b9\u65f6\u9700\u8981 \u589e\u52a0\u4e00\u500d \u6216 \u51cf\u53bb\u4e00\u534a \u8282\u70b9\u624d\u80fd\u4fdd\u8bc1 \u6570\u636e \u548c \u8d1f\u8f7d\u7684\u5747\u8861\u3002</p> <p>\u6ce8\u610f\uff1a\u56e0\u4e3a \u4e00\u81f4\u6027\u54c8\u5e0c\u5206\u533a \u7684\u8fd9\u4e9b\u7f3a\u70b9\uff0c\u4e00\u4e9b\u5206\u5e03\u5f0f\u7cfb\u7edf\u91c7\u7528 \u865a\u62df\u69fd \u5bf9 \u4e00\u81f4\u6027\u54c8\u5e0c \u8fdb\u884c\u6539\u8fdb\uff0c\u6bd4\u5982 Dynamo \u7cfb\u7edf\u3002</p> <p>\u3010\u793a\u4f8b\u3011\u4e00\u81f4\u6027\u54c8\u5e0c\u7b97\u6cd5\u793a\u4f8b</p> <pre><code>\npublic class ConsistentHashLoadBalance&lt;N extends Node&gt; extends BaseLoadBalance&lt;N&gt; implements LoadBalance&lt;N&gt; {\n\n    private final ConcurrentMap&lt;String, ConsistentHashSelector&lt;?&gt;&gt; selectors = new ConcurrentHashMap&lt;&gt;();\n\n    @SuppressWarnings(\"unchecked\")\n    @Override\n    protected N doSelect(List&lt;N&gt; nodes, String ip) {\n        // \u5206\u7247\u6570\uff0c\u8fd9\u91cc\u8bbe\u4e3a\u8282\u70b9\u6570\u7684 4 \u500d\n        Integer replicaNum = nodes.size() * 4;\n        // \u83b7\u53d6 nodes \u539f\u59cb\u7684 hashcode\n        int identityHashCode = System.identityHashCode(nodes);\n\n        // \u5982\u679c nodes \u662f\u4e00\u4e2a\u65b0\u7684 List \u5bf9\u8c61\uff0c\u610f\u5473\u7740\u8282\u70b9\u6570\u91cf\u53d1\u751f\u4e86\u53d8\u5316\n        // \u6b64\u65f6 selector.identityHashCode != identityHashCode \u6761\u4ef6\u6210\u7acb\n        ConsistentHashSelector&lt;N&gt; selector = (ConsistentHashSelector&lt;N&gt;) selectors.get(ip);\n        if (selector == null || selector.identityHashCode != identityHashCode) {\n            // \u521b\u5efa\u65b0\u7684 ConsistentHashSelector\n            selectors.put(ip, new ConsistentHashSelector&lt;&gt;(nodes, identityHashCode, replicaNum));\n            selector = (ConsistentHashSelector&lt;N&gt;) selectors.get(ip);\n        }\n        // \u8c03\u7528 ConsistentHashSelector \u7684 select \u65b9\u6cd5\u9009\u62e9 Node\n        return selector.select(ip);\n    }\n\n    /**\n     * \u4e00\u81f4\u6027\u54c8\u5e0c\u9009\u62e9\u5668\n     */\n    private static final class ConsistentHashSelector&lt;N extends Node&gt; {\n\n        /**\n         * \u5b58\u50a8\u865a\u62df\u8282\u70b9\n         */\n        private final TreeMap&lt;Long, N&gt; virtualNodes;\n\n        private final int identityHashCode;\n\n        /**\n         * \u6784\u9020\u5668\n         *\n         * @param nodes            \u8282\u70b9\u5217\u8868\n         * @param identityHashCode hashcode\n         * @param replicaNum       \u5206\u7247\u6570\n         */\n        ConsistentHashSelector(List&lt;N&gt; nodes, int identityHashCode, Integer replicaNum) {\n            this.virtualNodes = new TreeMap&lt;&gt;();\n            this.identityHashCode = identityHashCode;\n            // \u83b7\u53d6\u865a\u62df\u8282\u70b9\u6570\uff0c\u9ed8\u8ba4\u4e3a 100\n            if (replicaNum == null) {\n                replicaNum = 100;\n            }\n            for (N node : nodes) {\n                for (int i = 0; i &lt; replicaNum / 4; i++) {\n                    // \u5bf9 url \u8fdb\u884c md5 \u8fd0\u7b97\uff0c\u5f97\u5230\u4e00\u4e2a\u957f\u5ea6\u4e3a16\u7684\u5b57\u8282\u6570\u7ec4\n                    byte[] digest = md5(node.getUrl());\n                    // \u5bf9 digest \u90e8\u5206\u5b57\u8282\u8fdb\u884c 4 \u6b21 hash \u8fd0\u7b97\uff0c\u5f97\u5230\u56db\u4e2a\u4e0d\u540c\u7684 long \u578b\u6b63\u6574\u6570\n                    for (int j = 0; j &lt; 4; j++) {\n                        // h = 0 \u65f6\uff0c\u53d6 digest \u4e2d\u4e0b\u6807\u4e3a 0 ~ 3 \u76844\u4e2a\u5b57\u8282\u8fdb\u884c\u4f4d\u8fd0\u7b97\n                        // h = 1 \u65f6\uff0c\u53d6 digest \u4e2d\u4e0b\u6807\u4e3a 4 ~ 7 \u76844\u4e2a\u5b57\u8282\u8fdb\u884c\u4f4d\u8fd0\u7b97\n                        // h = 2, h = 3 \u65f6\u8fc7\u7a0b\u540c\u4e0a\n                        long m = hash(digest, j);\n                        // \u5c06 hash \u5230 node \u7684\u6620\u5c04\u5173\u7cfb\u5b58\u50a8\u5230 virtualNodes \u4e2d\uff0c\n                        // virtualNodes \u9700\u8981\u63d0\u4f9b\u9ad8\u6548\u7684\u67e5\u8be2\u64cd\u4f5c\uff0c\u56e0\u6b64\u9009\u7528 TreeMap \u4f5c\u4e3a\u5b58\u50a8\u7ed3\u6784\n                        virtualNodes.put(m, node);\n                    }\n                }\n            }\n        }\n\n        public N select(String key) {\n            // \u5bf9\u53c2\u6570 key \u8fdb\u884c md5 \u8fd0\u7b97\n            byte[] digest = md5(key);\n            // \u53d6 digest \u6570\u7ec4\u7684\u524d\u56db\u4e2a\u5b57\u8282\u8fdb\u884c hash \u8fd0\u7b97\uff0c\u518d\u5c06 hash \u503c\u4f20\u7ed9 selectForKey \u65b9\u6cd5\uff0c\n            // \u5bfb\u627e\u5408\u9002\u7684 Node\n            return selectForKey(hash(digest, 0));\n        }\n\n        private N selectForKey(long hash) {\n            // \u67e5\u627e\u7b2c\u4e00\u4e2a\u5927\u4e8e\u6216\u7b49\u4e8e\u5f53\u524d hash \u7684\u8282\u70b9\n            Map.Entry&lt;Long, N&gt; entry = virtualNodes.ceilingEntry(hash);\n            // \u5982\u679c hash \u5927\u4e8e Node \u5728\u54c8\u5e0c\u73af\u4e0a\u6700\u5927\u7684\u4f4d\u7f6e\uff0c\u6b64\u65f6 entry = null\uff0c\n            // \u9700\u8981\u5c06 TreeMap \u7684\u5934\u8282\u70b9\u8d4b\u503c\u7ed9 entry\n            if (entry == null) {\n                entry = virtualNodes.firstEntry();\n            }\n            // \u8fd4\u56de Node\n            return entry.getValue();\n        }\n\n    }\n\n    /**\n     * \u8ba1\u7b97 hash \u503c\n     */\n    public static long hash(byte[] digest, int number) {\n        return (((long) (digest[3 + number * 4] &amp; 0xFF) &lt;&lt; 24)\n            | ((long) (digest[2 + number * 4] &amp; 0xFF) &lt;&lt; 16)\n            | ((long) (digest[1 + number * 4] &amp; 0xFF) &lt;&lt; 8)\n            | (digest[number * 4] &amp; 0xFF))\n            &amp; 0xFFFFFFFFL;\n    }\n\n    /**\n     * \u8ba1\u7b97 MD5 \u503c\n     */\n    public static byte[] md5(String value) {\n        MessageDigest md5;\n        try {\n            md5 = MessageDigest.getInstance(\"MD5\");\n        } catch (NoSuchAlgorithmException e) {\n            throw new IllegalStateException(e.getMessage(), e);\n        }\n        md5.reset();\n        byte[] bytes = value.getBytes(StandardCharsets.UTF_8);\n        md5.update(bytes);\n        return md5.digest();\n    }\n\n}\n</code></pre> <p>\u4ee5\u4e0a\u793a\u4f8b\u57fa\u4e8e Dubbo \u7684\u4e00\u81f4\u6027\u54c8\u5e0c\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u505a\u4e86\u4e00\u4e9b\u7b80\u5316\u3002</p>"},{"location":"chap6/8Linux_all/","title":"L8 Linux \u9762\u8bd5\u9898 \u5408\u96c6CDN","text":""},{"location":"chap6/8Linux_all/#linux-command-bash","title":"Linux Command &amp; Bash","text":"<p>1.\u67e5\u627e\u6587\u4ef6\u540e\u7f00\u662flog\u7684\u4e09\u5929\u524d\u7684\u6587\u4ef6\u5220\u9664\u548c\u4e09\u5929\u5185\u6ca1\u4fee\u6539\u8fc7\u7684\u6587\u4ef6</p> <pre><code>find / -name \".log\" -mtime +3 -exec rm fr {} ; \n\nfind /log ! -mtime -3\n</code></pre> <p>2.\u5199\u4e00\u4e2a\u811a\u672c\u5c06\u76ee\u5f55\u4e0b\u5927\u4e8e100kb\u7684\u6587\u4ef6\u79fb\u52a8\u5230<code>/tmp</code>\u4e0b</p> <pre><code>fimd / -size +100k -exec mv {} /tmp ;\n</code></pre> <p>3.\u5c06\u6570\u636e\u5e93\u5907\u4efd\u5e76\u6253\u5305\u4f20\u9012\u5230\u8fdc\u7a0b\u670d\u52a1\u5668192.168.1.1\u7684<code>/backup</code>\u76ee\u5f55\u4e0b</p> <pre><code>mysqldump -u root -p database &gt; database.sql;\n\ntar -czvf database.tar.gz database.sql ; \n\nrsync -avP ./database.tar.gz root@192.168.1.1:/backup\n</code></pre> <p>4.\u65e5\u5fd7\u5982\u4e0b\u7edf\u8ba1\u8bbf\u95eeip\u6700\u591a\u7684\u524d10\u4e2a</p> <pre><code>awk '{print $1}'  *.log | sort | uniq -c | sort -nr | head -n\n</code></pre> <p>5.\u628a<code>/usr/local/</code>\u66ff\u6362\u6210\u5176\u4ed6\u7684\u76ee\u5f55</p> <pre><code>sed -i 's//usr/local//\u76ee\u5f55/g' \u6587\u4ef6\n</code></pre> <p>6.\u67e5\u770b\u670d\u52a1\u5668\u7a0b\u5e8f\u8fd0\u884c\u7ea7\u522b\u548c\u4fee\u6539\u8fd0\u884c\u7ea7\u522b\uff0c\u548c\u670d\u52a1\u7684\u8fd0\u884c\u7ea7\u522b</p> <ul> <li>\u67e5\u770b\uff1a<code>who -r</code></li> <li>\u4fee\u6539\uff1a<code>etc/inittab</code></li> <li>\u670d\u52a1\u8fd0\u884c\u7ea7\u522b <code>chkconfig \u2013list vsftp</code></li> <li>\u4fee\u6539\uff1a<code>chkconfig \u2013level 345 vsftp on</code></li> </ul> <p>7.\u7528tcpdump\u622a\u53d6\u672c\u673a<code>ip 192.168.23.1 80</code>\u7aef\u53e3\u7684\u5305</p> <pre><code>tcpdump tcp port 80 host 192.168.23.1\n\nTcpdump -w test host 192.168.1.1 and tcp port 80\n</code></pre> <p>8.\u7528tcpdump\u622a\u53d6ip <code>192.168.23.1</code>\u8bbf\u95ee\u4e3b\u673a ip <code>192.168.23.2</code> \u768480\u7aef\u53e3\u7684\u5305</p> <pre><code>tcpdump host 192.168.23.1 and 192.168.23.2 and dst port 80\n</code></pre> <p>9.\u7528<code>iptable</code>s\u5c06<code>192.168.0.100</code>\u7684<code>80</code>\u7aef\u53e3\u6620\u5c04\u5230<code>59.15.17.231</code>\u7684<code>8080</code>\u7aef\u53e3</p> <pre><code>iptables -t nat -A PREROUTINT -p tcp -d 192.168.0.100 \u2013dport 80 -j DNAT \u2013to-destination 59.15.17.231:8080\n</code></pre> <p>10.\u672c\u673a\u768480\u7aef\u53e3\u8f6c\u53d1\u52308080</p> <pre><code>iptables -t nat -A PREROUTING -p tcp \u2013dport -j REDIRECT \u2013to-ports 8080\n</code></pre> <p>11.\u7981\u6b62\u4e00\u4e2a\u7528\u6237\u767b\u5f55\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528ftp</p> <p>\u4fee\u6539<code>etc/passwd</code> \u6700\u540e\u4e00\u4e2a\u5b57\u6bb5 \u6539\u6210/<code>bin/nologin</code></p> <p>12.\u83b7\u53d61.txt\u4e2d\u7b2c\u4e8c\u884c\u7b2c\u4e09\u5217\u7684\u6570\u636e\uff0c\u8f93\u51fa\u52302.txt</p> <pre><code>cat 1.txt|awk \u2019NR==2{print $3}\u2019 &gt; 2.txt\n</code></pre> <p>13.\u67e5\u770bLinux\u7cfb\u7edf\u5f53\u524d\u5355\u4e2a\u5171\u4eab\u5185\u5b58\u6bb5\u7684\u6700\u5927\u503c</p> <pre><code>ipcs -a\n</code></pre> <p>14.\u7528\u4ec0\u4e48\u547d\u4ee4\u67e5\u8be2\u6307\u5b9aIP\u5730\u5740\u7684\u670d\u52a1\u5668\u7aef\u53e3</p> <pre><code>nmap 127.0.0.1\n</code></pre> <p>15.\u5982\u4f55\u8ba9history\u547d\u4ee4\u663e\u793a\u5177\u4f53\u65f6\u95f4</p> <pre><code>HISTTIMEFORMAT=\u201d%Y-%m-%d %H:%M:%S \u201d\n</code></pre> <p>16.\u67e5\u770bLinux\u7cfb\u7edf\u5f53\u524d\u52a0\u8f7d\u7684\u5e93\u6587\u4ef6</p> <pre><code>lsof |grep /lib\n</code></pre> <p>17.\u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u67d0\u4e00\u786c\u4ef6\u7684\u9a71\u52a8\u7248\u672c\u3002\u6bd4\u5982\u7f51\u5361</p> <pre><code>ethtool \u2013i eth0\n</code></pre> <p>18.DNS\u670d\u52a1\u5668\u6709\u54ea\u4e09\u79cd\u7c7b\u578b</p> <p>\u4e3b \u4ece \u8f6c\u53d1</p> <p>19.\u67e5\u770b3306\u7aef\u53e3\u88ab\u8c01\u5360\u7528</p> <pre><code>lsof -i:3306\n</code></pre> <p>20.\u67e5\u770b\u5360\u7528\u5185\u5b58\u6700\u5927\u76845\u4e2a\u8fdb\u7a0b</p> <pre><code>ps -aux | sort -k4nr | head -n 5\n</code></pre> <p>21.\u67e5\u770b\u5360\u7528\u5185\u5b58\u6700\u5927\u7684\u8fdb\u7a0b\u7684PID\u548cVSZ</p> <pre><code>ps -aux|sort -k5nr|awk \u2019BEGIN{print \u201dPID VSZ\u201d}{print $2,$5}\u2019|awk \u2019NR&lt;3\u2032\n</code></pre> <p>22. <code>lsof -p 12</code> \u770b\u8fdb\u7a0b\u53f7\u4e3a12\u7684\u8fdb\u7a0b\u6253\u5f00\u4e86\u54ea\u4e9b\u6587\u4ef6</p> <p>23.\u540c\u65f6\u6267\u884ca\u548cb\u7b49a\u548cb\u90fd\u6267\u884c\u5b8c\u6267\u884cc</p> <pre><code>#!/bin/bash\n\n./a.sh &amp;\n\n./b.sh &amp;\n\nwait\n\necho adf\n</code></pre> <p>24.snmpdf \u901a\u8fc7SNMP\u76d1\u89c6\u8fdc\u7a0b\u4e3b\u673a\u7684\u78c1\u76d8\u7a7a\u95f4</p> <pre><code>snmpdf -v 1 -c public localhost\n</code></pre> <p>\u83b7\u53d6192.168.6.53\u7684\u6240\u6709\u5f00\u653e\u7aef\u53e3\u72b6\u6001</p> <pre><code>snmpnetstat -v 2c -c public -a 192.168.6.53\n</code></pre> <p>25.\u7b80\u8ff0\u7f16\u8bd1kernel\u7684\u5927\u4f53\u6b65\u9aa4</p> <p>(1)\u4e0b\u8f7d\u89e3\u538b\u7f29\u65b0\u7248\u672c\u7684\u5185\u6838\u5230/usr/src\u4e0b</p> <p>(2)\u5c06\u4ee5\u524d\u7248\u672c\u94fe\u63a5\u5220\u9664\uff0c\u5efa\u7acb\u65b0\u7684\u8fde\u63a5</p> <p>(3)\u7f16\u8bd1\u5185\u6838\uff0c\u7f16\u8bd1\u6a21\u5757\uff0c\u5b89\u88c5\u6a21\u5757</p> <p>(4)\u4fee\u6539grub.conf \uff0c\u7136\u540e\u91cd\u542f</p> <p>26.<code>diff/patch</code>\u7684\u4f5c\u7528\u548c\u7528\u6cd5</p> <p>\u547d\u4ee4diff A B &gt; C ,\u4e00\u822cA\u662f\u539f\u59cb\u6587\u4ef6\uff0cB\u662f\u4fee\u6539\u540e\u7684\u6587\u4ef6\uff0cC\u79f0\u4e3aA\u7684\u8865\u4e01\u6587\u4ef6\u3002</p> <p>patch A C \u5c31\u80fd\u5f97\u5230B, \u8fd9\u4e00\u6b65\u53eb\u505a\u5bf9A\u6253\u4e0a\u4e86B\u7684\u540d\u5b57\u4e3aC\u7684\u8865\u4e01</p> <p>27.\u6267\u884c <code>bin/myprog</code> \u8fd4\u56de<code>0</code> \u6253\u5370ok <code>1</code>\u6253\u5370bad <code>2</code>\u6253\u5370error \u5176\u4ed6\u6253\u5370 wrony</p> <pre><code>./bin/myprog\n\nif [[ $? = 0 ]];then\n\necho\u201dOK\u201d\n\nelif [[ $? =1 ]];then\n\necho\u201dbad\u201d\n\nelse\n\necho\u201derror\u201d\n\nfi\n</code></pre> <p>28.\u6c42\u4e00\u7ec4\u6570\u7684\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c</p> <pre><code>#!/bin/sh\n\nmin=$1\n\nmax=$1\n\nsum=$1\n\nshift\n\nwhile [ $# -gt 0 ]\n\ndo\n\nif [ $min -gt $1 ]\n\nthen\n\nmin=$1\n\nfi\n\nif [ $max -lt $1 ]\n\nthen\n\nmax=$1\n\nfi\n\nsum=`expr $sum +$1`\n\nshift\n\ndone\n\nsum=`echo \u201d$sum/5\u2033`|bc -l\n\necho min=$min\n\necho max=$max\n\necho aver=$sum\n</code></pre> <p>28.\u6267\u884c\u53ef\u6267\u884c\u7a0b\u5e8ftest\u5e76\u628a\u8f93\u51fa\u548c\u9519\u8bef\u5199\u5230err.log</p> <pre><code>./test &gt; &amp; err.log\n</code></pre> <p>29.\u7528telnet\u8fde\u63a5\u6821\u5185\u670d\u52a1\u5668mail.xiaonei.com \u53d1\u4e00\u5c01\u4fe1</p> <pre><code>mail -v -s \u201dhello\u201d root@192.168.23.1\n</code></pre> <p>30.\u6dfb\u52a0\u8def\u7531\u8868\u5e76\u67e5\u770b</p> <pre><code>route add -net 203.208.39.104 netmask 255.255.255.255 gw 192.168.1.1\n\nnetstat \u2013r\n</code></pre> <p>31.\u6b63\u5219\u5339\u914dip</p> <pre><code>((25[0-5]|2[0-4]d|1dd|[1-9]d|d).){3}(25[0-5]|2[0-4]d|1dd|[1-9]d|[1-9])\n</code></pre> <p>32.\u628a<code>/data</code>\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u6240\u6709\u4ee5\u6269\u5c55\u540d<code>.txt</code>\u7ed3\u5c3e\u7684\u6587\u4ef6\u4e2d\u5305\u542b<code>oldgirl</code>\u7684\u5b57\u7b26\u4e32\u5168\u90e8\u66ff\u6362\u4e3a<code>oldboy</code></p> <pre><code>find /data/ -type f -name \"*.txt\" | xargs sed -i 's/oldgirl/oldboy/g'\n</code></pre> <p>33. \u7edf\u8ba1\u4e00\u4e0b<code>/var/log/nginx/access.log</code> \u65e5\u5fd7\u4e2d\u8bbf\u95ee\u91cf\u6700\u591a\u7684\u524d\u5341\u4e2aIP?</p> <p><code>cat access_log | awk \u2018{print $1}\u2019 | uniq -c|sort -rn|head -10</code> \u6216</p> <p><code>awk '{print $1}' /var/log/nginx/access.log | sort | uniq -c | sort -nr -k1 | head -n 10</code></p> <ul> <li><code>uniq</code> - \u5220\u9664\u6392\u5e8f\u6587\u4ef6\u4e2d\u7684\u91cd\u590d\u884c</li> <li><code>sort</code>\u5bf9\u4e8e\u6587\u672c\u8fdb\u884c\u6392\u5e8f</li> <li><code>-l</code> \u6309\u7167\u5f53\u524d\u73af\u5883\u6392\u5e8f.</li> <li><code>-m</code> \u5408\u5e76\u5df2\u7ecf\u6392\u5e8f\u597d\u7684\u6587\u4ef6,\u4e0d\u6392\u5e8f.</li> <li><code>-n</code> \u6309\u7167\u5b57\u7b26\u4e32\u7684\u6570\u503c\u987a\u5e8f\u6bd4\u8f83,\u6697\u542b-b</li> <li><code>-r</code> \u98a0\u5012\u6bd4\u8f83\u7684\u7ed3\u679c.</li> </ul> <p>34. \u600e\u4e48\u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u4e2d\u6bcf\u4e2aIP\u7684\u8fde\u63a5\u6570\uff1a</p> <pre><code># netstat -n | awk '/^tcp/ {print $5}' | awk -F: '{print $1}' | sort | uniq -c| sort \u2013rn\n</code></pre> <ul> <li><code>sort</code>\u547d\u4ee4\uff1a\u8fdb\u884c\u6392\u5e8f\uff0c-r \u53cd\u5411\u6392\u5e8f -n \u4f7f\u7528\u7eaf\u6570\u5b57\u8fdb\u884c\u6392\u5e8f</li> <li><code>uniq</code> \u5c06\u91cd\u590d\u7684\u6570\u636e\u4ec5\u4ec5\u5217\u51fa\u4e00\u4e2a\u6765\u663e\u793a\uff0cuniq -c\uff0c\u8fdb\u884c\u8ba1\u6570</li> <li><code>awk -F</code>: '{print $1}' \u4ee5F \u4e3a\u5206\u754c\u7b26\uff0c\u53d6\u51fa\u7b2c\u4e00\u4e2a\uff1a\u4e4b\u524d\u7684\u6570\u636e</li> </ul> <p>35 \u600e\u4e48\u67e5\u770b\u5f53\u524d\u78c1\u76d8\u7684IO\uff1a</p> <p>iostat \u662f sysstat \u5de5\u5177\u96c6\u7684\u4e00\u4e2a\u5de5\u5177\uff0c\u9700\u8981\u5b89\u88c5\u3002</p> <pre><code>[root@localhost ~]# iostat -d-k 1 10\nLinux 3.10.0-327.el7.x86_64 (localhost.localdomain) 03/23/2017 _x86_64_(2 CPU)\nDevice: tps kB_read/s kB_wrtn/s kB_read kB_wrtn\nsda 16.60 597.83 29.44 384048 18909\nscd0 0.03 0.10 0.00 66 0\ndm-0 15.78 551.54 26.20 354311 16831\ndm-1 0.22 1.97 0.00 1268 0\n</code></pre> <ul> <li>\u53c2\u6570<code>-d</code>\u8868\u793a\uff0c\u663e\u793a\u8bbe\u5907\uff08\u78c1\u76d8\uff09\u4f7f\u7528\u72b6\u6001\uff1b</li> <li><code>-k</code> \u67d0\u4e9b\u4f7f\u7528block\u4e3a\u5355\u4f4d\u7684\u5217\u5f3a\u5236\u4f7f\u7528<code>Kilobytes</code>\u4e3a\u5355\u4f4d\uff1b</li> <li><code>1 10</code> \u8868\u793a\uff0c\u6570\u636e\u663e\u793a\u6bcf\u96941\u79d2\u5237\u65b0\u4e00\u6b21\uff0c\u5171\u663e\u793a10\u6b21\u3002</li> </ul> <p>2\uff09\u4f7f\u7528iotop\u547d\u4ee4</p> <p>iotop\u547d\u4ee4\u662f\u4e00\u4e2a\u7528\u6765\u76d1\u89c6\u78c1\u76d8I/O\u4f7f\u7528\u72b6\u51b5\u7684top\u7c7b\u5de5\u5177\u3002iotop\u5177\u6709\u4e0etop\u76f8\u4f3c\u7684UI\u3002Linux\u4e0b\u7684IO\u7edf\u8ba1\u5de5\u5177\u5982iostat\uff0cnmon\u7b49\u5927\u591a\u6570\u662f\u53ea\u80fd\u7edf\u8ba1\u5230per\u8bbe\u5907\u7684\u8bfb\u5199\u60c5\u51b5\uff0c\u5982\u679c\u4f60\u60f3\u77e5\u9053\u6bcf\u4e2a\u8fdb\u7a0b\u662f\u5982\u4f55\u4f7f\u7528IO\u7684\u5c31\u6bd4\u8f83\u9ebb\u70e6\uff0c\u4f7f\u7528iotop\u547d\u4ee4\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u67e5\u770b\u3002</p> <p>36 \u67e5\u770b\u5f53\u524d\u8fde\u63a5\u6570\uff1a</p> <pre><code>[root@localhost ~]# cat /proc/sys/net/netfilter/nf_conntrack_count\n0\n</code></pre> <p>iptables\u7684\u94fe\u63a5\u8ddf\u8e2a\u8868\u6700\u5927\u5bb9\u91cf\u914d\u7f6e\u6587\u4ef6\u5982\u4e0b\uff1a</p> <pre><code>[root@localhost ~]# cat /proc/sys/net/netfilter/nf_conntrack_max\n65536\n</code></pre>"},{"location":"chap6/8Linux_all/#mysql","title":"Mysql","text":"<p>1.\u5982\u4f55\u5224\u65admysql\u4e3b\u4ece\u662f\u5426\u540c\u6b65\uff1f\u8be5\u5982\u4f55\u4f7f\u5176\u540c\u6b65\uff1f</p> <pre><code>Slave_IO_Running\nSlave_SQL_Running\uff1b\n</code></pre> <p>2.mysql\u7684innodb\u5982\u4f55\u5b9a\u4f4d\u9501\u95ee\u9898\uff0cmysql\u5982\u4f55\u51cf\u5c11\u4e3b\u4ece\u590d\u5236\u5ef6\u8fdf\uff1f</p> <p>\u5728\u4f7f\u7528 <code>show engine innodb status</code> \u68c0\u67e5\u5f15\u64ce\u72b6\u6001\u65f6\uff0c\u53d1\u73b0\u4e86\u6b7b\u9501\u95ee\u9898</p> <p>\u57285.5\u4e2d\uff0c<code>information_schema</code>\u5e93\u4e2d\u589e\u52a0\u4e86\u4e09\u4e2a\u5173\u4e8e\u9501\u7684\u8868\uff08MEMORY\u5f15\u64ce\uff1a<code>innodb_trx ##</code> \u5f53\u524d\u8fd0\u884c\u7684\u6240\u6709\u4e8b\u52a1<code>innodb_locks ##</code> \u5f53\u524d\u51fa\u73b0\u7684\u9501<code>innodb_lock_waits ##</code> \u9501\u7b49\u5f85\u7684\u5bf9\u5e94\u5173\u7cfb</p> <p>3.mysql\u5982\u4f55\u51cf\u5c11\u4e3b\u4ece\u590d\u5236\u5ef6\u8fdf:</p> <ul> <li>1.\u4ece\u5e93\u786c\u4ef6\u6bd4\u4e3b\u5e93\u5dee\uff0c\u5bfc\u81f4\u590d\u5236\u5ef6\u8fdf</li> <li>2.\u4e3b\u4ece\u590d\u5236\u5355\u7ebf\u7a0b\uff0c\u5982\u679c\u4e3b\u5e93\u5199\u5e76\u53d1\u592a\u5927\uff0c\u6765\u4e0d\u53ca\u4f20\u9001\u5230\u4ece\u5e93\uff0c\u5c31\u4f1a\u5bfc\u81f4\u5ef6\u8fdf\u3002\u66f4\u9ad8\u7248\u672c\u7684mysql\u53ef\u4ee5\u652f\u6301\u591a\u7ebf\u7a0b\u590d\u5236</li> <li>3.\u6162SQL\u8bed\u53e5\u8fc7\u591a</li> <li>4.\u7f51\u7edc\u5ef6\u8fdf</li> <li>5.master\u8d1f\u8f7d<ul> <li>\u4e3b\u5e93\u8bfb\u5199\u538b\u529b\u5927\uff0c\u5bfc\u81f4\u590d\u5236\u5ef6\u8fdf\uff0c\u67b6\u6784\u7684\u524d\u7aef\u8981\u52a0<code>buffer</code>\u53ca\u7f13\u5b58\u5c42</li> </ul> </li> </ul> <p>\u53e6\u5916\uff0c 2\u4e2a\u53ef\u4ee5\u51cf\u5c11\u5ef6\u8fdf\u7684\u53c2\u6570:</p> <ul> <li> <p><code>-slave-net-timeout=seconds</code> \u5355\u4f4d\u4e3a\u79d2 \u9ed8\u8ba4\u8bbe\u7f6e\u4e3a 3600\u79d2  </p> <ul> <li>\u53c2\u6570\u542b\u4e49\uff1a\u5f53slave\u4ece\u4e3b\u6570\u636e\u5e93\u8bfb\u53d6log\u6570\u636e\u5931\u8d25\u540e\uff0c\u7b49\u5f85\u591a\u4e45\u91cd\u65b0\u5efa\u7acb\u8fde\u63a5\u5e76\u83b7\u53d6\u6570\u636e</li> </ul> </li> <li> <p><code>-master-connect-retry=seconds</code> \u5355\u4f4d\u4e3a\u79d2 \u9ed8\u8ba4\u8bbe\u7f6e\u4e3a 60\u79d2</p> <ul> <li>\u53c2\u6570\u542b\u4e49\uff1a\u5f53\u91cd\u65b0\u5efa\u7acb\u4e3b\u4ece\u8fde\u63a5\u65f6\uff0c\u5982\u679c\u8fde\u63a5\u5efa\u7acb\u5931\u8d25\uff0c\u95f4\u9694\u591a\u4e45\u540e\u91cd\u8bd5\u3002</li> </ul> </li> <li> <p>\u901a\u5e38\u914d\u7f6e\u4ee5\u4e0a2\u4e2a\u53c2\u6570\u53ef\u4ee5\u51cf\u5c11\u7f51\u7edc\u95ee\u9898\u5bfc\u81f4\u7684\u4e3b\u4ece\u6570\u636e\u540c\u6b65\u5ef6\u8fdf</p> </li> </ul> <p>MySQL\u6570\u636e\u5e93\u4e3b\u4ece\u540c\u6b65\u5ef6\u8fdf\u89e3\u51b3\u65b9\u6848</p> <p>\u6700\u7b80\u5355\u7684\u51cf\u5c11slave\u540c\u6b65\u5ef6\u65f6\u7684\u65b9\u6848\u5c31\u662f\u5728\u67b6\u6784\u4e0a\u505a\u4f18\u5316\uff0c\u5c3d\u91cf\u8ba9\u4e3b\u5e93\u7684DDL\u5feb\u901f\u6267\u884c\u3002\u8fd8\u6709\u5c31\u662f\u4e3b\u5e93\u662f\u5199\uff0c\u5bf9\u6570\u636e\u5b89\u5168\u6027\u8f83\u9ad8\uff0c\u6bd4\u5982 <code>sync_binlog=1</code>\uff0c</p> <p>Mysql\u5f00\u542f<code>bin-log</code>\u65e5\u5fd7\u4f7f\u7528<code>bin-log</code>\u65f6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5e76\u4e0d\u662f\u6bcf\u6b21\u6267\u884c\u5199\u5165\u5c31\u4e0e\u786c\u76d8\u540c\u6b65\uff0c\u8fd9\u6837\u5728\u670d\u52a1\u5668\u5d29\u6e83\u662f\uff0c\u5c31\u53ef\u80fd\u5bfc\u81f4<code>bin-log</code>\u6700\u540e\u7684\u8bed\u53e5\u4e22\u5931\u3002 \u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u53c2\u6570\u6765\u8c03\u8282\uff0c<code>sync_binlog=N</code>\uff0c\u4f7f\u6267\u884c<code>N</code>\u6b21\u5199\u5165\u540e\uff0c\u4e0e\u786c\u76d8\u540c\u6b65\u3002</p> <p><code>1</code> \u662f\u6700\u5b89\u5168\u7684\uff0c\u4f46\u662f\u4e5f\u662f\u6700\u6162\u7684<code>innodb_flush_log_at_trx_commit= 1</code></p> <p>\u4e4b\u7c7b\u7684\u8bbe\u7f6e\uff0c\u800cslave\u5219\u4e0d\u9700\u8981\u8fd9\u4e48\u9ad8\u7684\u6570\u636e\u5b89\u5168\uff0c\u5b8c\u5168\u53ef\u4ee5\u8bb2<code>sync_binlog</code>\u8bbe\u7f6e\u4e3a<code>0</code>\u6216\u8005\u5173\u95ed<code>binlog</code>\uff0c<code>innodb_flushlog</code>\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a<code>0</code>\u6765\u63d0\u9ad8<code>sql</code>\u7684\u6267\u884c\u6548\u7387\u3002\u53e6\u5916\u5c31\u662f\u4f7f\u7528\u6bd4\u4e3b\u5e93\u66f4\u597d\u7684\u786c\u4ef6\u8bbe\u5907\u4f5c\u4e3a<code>slave</code>\u3002</p> <p>4. .\u5982\u4f55\u91cd\u7f6emysql root\u5bc6\u7801\uff1f</p> <ul> <li> <p>\u5728\u5df2\u77e5MYSQL\u6570\u636e\u5e93\u7684ROOT\u7528\u6237\u5bc6\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u4fee\u6539\u5bc6\u7801\u7684\u65b9\u6cd5\uff1a</p> <ul> <li>1\u3001 \u5728SHELL\u73af\u5883\u4e0b\uff0c\u4f7f\u7528<code>mysqladmin</code>\u547d\u4ee4\u8bbe\u7f6e\uff1a<code>mysqladmin \u2013u root \u2013p password \u201d\u65b0\u5bc6\u7801\u201c</code> \u56de\u8f66\u540e\u8981\u6c42\u8f93\u5165\u65e7\u5bc6\u7801</li> <li>2\u3001 \u5728mysql \u73af\u5883\u4e2d,\u4f7f\u7528<code>update</code>\u547d\u4ee4\uff0c\u76f4\u63a5\u66f4\u65b0<code>mysq</code>l\u5e93<code>user</code>\u8868\u7684\u6570\u636e\uff1a<ul> <li><code>Update mysql.user set password=password(\u2018\u65b0\u5bc6\u7801\u2019) where user=\u2019root\u2019;</code></li> <li><code>flush privileges;</code></li> <li>\u6ce8\u610f\uff1amysql\u8bed\u53e5\u8981\u4ee5\u5206\u53f7\u201d\uff1b\u201d\u7ed3\u675f</li> </ul> </li> <li>3\u3001 \u5728mysql&gt;\u73af\u5883\u4e2d\uff0c\u4f7f\u7528grant\u547d\u4ee4\uff0c\u4fee\u6539root\u7528\u6237\u7684\u6388\u6743\u6743\u9650\u3002<ul> <li><code>grant all on *.* to root@\u2019localhost\u2019 identified by \u2018\u65b0\u5bc6\u7801\u2019\uff1b</code></li> </ul> </li> </ul> </li> <li> <p>\u5982\u67e5\u5fd8\u8bb0\u4e86mysql\u6570\u636e\u5e93\u7684ROOT\u7528\u6237\u7684\u5bc6\u7801\uff0c\u53c8\u5982\u4f55\u505a\u5462\uff1f\u65b9\u6cd5\u5982\u4e0b\uff1a</p> <ul> <li>1\u3001 \u5173\u95ed\u5f53\u524d\u8fd0\u884c\u7684mysqld\u670d\u52a1\u7a0b\u5e8f\uff1a<code>service mysqld stop\uff08\u8981\u5148\u5c06mysqld\u6dfb\u52a0\u4e3a\u7cfb\u7edf\u670d\u52a1\uff09</code></li> <li>2\u3001 \u4f7f\u7528<code>mysqld_safe</code>\u811a\u672c\u4ee5\u5b89\u5168\u6a21\u5f0f\uff08\u4e0d\u52a0\u8f7d\u6388\u6743\u8868\uff09\u542f\u52a8mysqld \u670d\u52a1<ul> <li><code>/usr/local/mysql/bin/mysqld_safe --skip-grant-table &amp;</code></li> </ul> </li> <li>3\u3001 \u4f7f\u7528\u7a7a\u5bc6\u7801\u7684root\u7528\u6237\u767b\u5f55\u6570\u636e\u5e93\uff0c\u91cd\u65b0\u8bbe\u7f6eROOT\u7528\u6237\u7684\u5bc6\u7801</li> </ul> </li> </ul> <pre><code>\uff03mysql -u root\nMysql&gt; Update mysql.user set password=password(\u2018\u65b0\u5bc6\u7801\u2019) where user=\u2019root\u2019;\nMysql&gt; flush privileges;\n</code></pre> <p>5. mysql\u6570\u636e\u5907\u4efd\u5de5\u5177</p> <p>mysqldump\u5de5\u5177</p> <p>Mysqldump\u662fmysql\u81ea\u5e26\u7684\u5907\u4efd\u5de5\u5177\uff0c\u76ee\u5f55\u5728bin\u76ee\u5f55\u4e0b\u9762\uff1a<code>/usr/local/mysql/bin/mysqldump</code>\uff0c\u652f\u6301\u57fa\u4e8einnodb\u7684\u70ed\u5907\u4efd\u3002\u4f46\u662f\u7531\u4e8e\u662f\u903b\u8f91\u5907\u4efd\uff0c\u6240\u4ee5\u901f\u5ea6\u4e0d\u662f\u5f88\u5feb\uff0c\u9002\u5408\u5907\u4efd\u6570\u636e\u6bd4\u8f83\u5c0f\u7684\u573a\u666f\u3002Mysqldump\u5b8c\u5168\u5907\u4efd+\u4e8c\u8fdb\u5236\u65e5\u5fd7\u53ef\u4ee5\u5b9e\u73b0\u57fa\u4e8e\u65f6\u95f4\u70b9\u7684\u6062\u590d\u3002</p> <p>\u57fa\u4e8eLVM\u5feb\u7167\u5907\u4efd</p> <p>\u5728\u7269\u7406\u5907\u4efd\u4e2d\uff0c\u6709\u57fa\u4e8e\u6587\u4ef6\u7cfb\u7edf\u7684\u7269\u7406\u5907\u4efd\uff08LVM\u7684\u5feb\u7167\uff09\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7528tar\u4e4b\u7c7b\u7684\u547d\u4ee4\u5bf9\u6574\u4e2a\u6570\u636e\u5e93\u76ee\u5f55\u8fdb\u884c\u6253\u5305\u5907\u4efd\uff0c\u4f46\u662f\u8fd9\u4e9b\u53ea\u80fd\u8fdb\u884c\u6ce0\u5907\u4efd\uff0c\u4e0d\u540c\u7684\u5b58\u50a8\u5f15\u64ce\u5907\u4efd\u7684\u4e5f\u4e0d\u4e00\u6837\uff0cmyisam\u81ea\u52a8\u5907\u4efd\u5230\u8868\u7ea7\u522b\uff0c\u800cinnodb\u4e0d\u5f00\u542f\u72ec\u7acb\u8868\u7a7a\u95f4\u7684\u8bdd\u53ea\u80fd\u5907\u4efd\u6574\u4e2a\u6570\u636e\u5e93\u3002</p> <p>tar\u5305\u5907\u4efd</p> <p>percona\u63d0\u4f9b\u7684xtrabackup\u5de5\u5177</p> <p>\u652f\u6301innodb\u7684\u7269\u7406\u70ed\u5907\u4efd\uff0c\u652f\u6301\u5b8c\u5168\u5907\u4efd\uff0c\u589e\u91cf\u5907\u4efd\uff0c\u800c\u4e14\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u652f\u6301innodb\u5b58\u50a8\u5f15\u8d77\u7684\u6570\u636e\u5728\u4e0d\u540c\u6570\u636e\u5e93\u4e4b\u95f4\u8fc1\u79fb\uff0c\u652f\u6301\u590d\u5236\u6a21\u5f0f\u4e0b\u7684\u4ece\u673a\u5907\u4efd\u6062\u590d\u5907\u4efd\u6062\u590d\uff0c\u4e3a\u4e86\u8ba9xtrabackup\u652f\u6301\u66f4\u591a\u7684\u529f\u80fd\u6269\u5c55\uff0c\u53ef\u4ee5\u8bbe\u7acb\u72ec\u7acb\u8868\u7a7a\u95f4\uff0c\u6253\u5f00 <code>innodb_file_per_table</code>\u529f\u80fd\uff0c\u542f\u7528\u4e4b\u540e\u53ef\u4ee5\u652f\u6301\u5355\u72ec\u7684\u8868\u5907\u4efd\u3002</p>"},{"location":"chap6/8Linux_all/#_1","title":"\u7f51\u7edc","text":"<p>1. osi\u4e03\u5c42\u6a21\u578b\uff0ctcp\u4e09\u6b21\u63e1\u624b\u8fc7\u7a0b\uff0ctcp\u8fde\u63a5\u65ad\u5f00\u8fc7\u7a0b\uff0c\u4ec0\u4e48\u60c5\u51b5\u4e0btcp\u8fdb\u5165<code>time_wait</code>?</p> <p>\u5f53\u5173\u95ed\u4e00\u4e2a socket \u8fde\u63a5\u65f6\uff0c\u4e3b\u52a8\u5173\u95ed\u4e00\u7aef\u7684 socket \u5c06\u8fdb\u5165<code>TIME_WAIT</code>\u72b6\u6001\uff0c\u800c\u88ab\u52a8\u5173\u95ed\u4e00\u65b9\u5219\u8f6c\u5165<code>CLOSED</code>\u72b6\u6001\u3002</p> <p>\u5177\u4f53\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>1\u3001 \u5ba2\u6237\u7aef\u53d1\u9001FIN\u62a5\u6587\u6bb5\uff0c\u8fdb\u5165<code>FIN_WAIT_1</code>\u72b6\u6001\u3002</li> <li>2\u3001 \u670d\u52a1\u5668\u7aef\u6536\u5230FIN\u62a5\u6587\u6bb5\uff0c\u53d1\u9001ACK\u8868\u793a\u786e\u8ba4\uff0c\u8fdb\u5165<code>CLOSE_WAIT</code>\u72b6\u6001\u3002</li> <li>3\u3001 \u5ba2\u6237\u7aef\u6536\u5230FIN\u7684\u786e\u8ba4\u62a5\u6587\u6bb5\uff0c\u8fdb\u5165<code>FIN_WAIT_2</code>\u72b6\u6001\u3002</li> <li>4\u3001\u670d\u52a1\u5668\u7aef\u53d1\u9001FIN\u62a5\u6587\u7aef\uff0c\u8fdb\u5165<code>LAST_ACK</code>\u72b6\u6001\u3002</li> <li>5\u3001 \u5ba2\u6237\u7aef\u6536\u5230FIN\u62a5\u6587\u7aef\uff0c\u53d1\u9001FIN\u7684ACK\uff0c\u540c\u65f6\u8fdb\u5165<code>TIME_WAIT</code>\u72b6\u6001\uff0c\u542f\u52a8TIME_WAIT\u5b9a\u65f6\u5668\uff0c\u8d85\u65f6\u65f6\u95f4\u8bbe\u4e3a2MSL\u3002</li> <li>6\u3001 \u670d\u52a1\u5668\u7aef\u6536\u5230FIN\u7684ACK\uff0c\u8fdb\u5165CLOSED\u72b6\u6001\u3002</li> <li>7\u3001\u5ba2\u6237\u7aef\u57282MSL\u65f6\u95f4\u5185\u6ca1\u6536\u5230\u5bf9\u7aef\u7684\u4efb\u4f55\u54cd\u5e94\uff0c<code>TIME_WAIT</code>\u8d85\u65f6\uff0c\u8fdb\u5165CLOSED\u72b6\u6001\u3002</li> </ul> <p>2 \u4ec0\u4e48\u662f\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff0c\u6709\u4f55\u5371\u5bb3\uff0csql\u6ce8\u5165\u653b\u51fb\u5982\u4f55\u9632\u8303\uff1f</p> <p>\u4e00\u822c\u8bf4\u6765\uff0c\u5728Web\u5b89\u5168\u9886\u57df\uff0c\u5e38\u89c1\u7684\u653b\u51fb\u65b9\u5f0f\u5927\u6982\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> <ul> <li>SQL\u6ce8\u5165\u653b\u51fb(\u7a0b\u5e8f\u547d\u4ee4\u548c\u7528\u6237\u6570\u636e\uff08\u5373\u7528\u6237\u8f93\u5165\uff09\u4e4b\u95f4\u6ca1\u6709\u505a\u5230\u6cfe\u6e2d\u5206\u660e\u3002\u8fd9\u4f7f\u5f97\u653b\u51fb\u8005\u6709\u673a\u4f1a\u5c06\u7a0b\u5e8f\u547d\u4ee4\u5f53\u4f5c\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\u63d0\u4ea4\u7ed9We\u7a0b\u5e8f\uff0c\u4ee5\u53d1\u53f7\u65bd\u4ee4\uff0c\u4e3a\u6240\u6b32\u4e3a)</li> <li>\u91c7\u7528\u9884\u7f16\u8bd1\u8bed\u53e5\u96c6\uff0c\u5b83\u5185\u7f6e\u4e86\u5904\u7406SQL\u6ce8\u5165\u7684\u80fd\u529b\uff0c\u53ea\u8981\u4f7f\u7528\u5b83\u7684setXXX\u65b9\u6cd5\u4f20\u503c\u5373\u53ef\u30022\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u8fc7\u6ee4\u4f20\u5165\u7684\u53c2\u65703\u5b57\u7b26\u4e32\u8fc7\u6ee44.jsp\u4e2d\u8c03\u7528\u8be5\u51fd\u6570\u68c0\u67e5\u662f\u5426\u5305\u51fd\u975e\u6cd5\u5b57\u7b265.JSP\u9875\u9762\u5224\u65ad\u4ee3\u7801\uff1a</li> <li>\u8de8\u7ad9\u811a\u672c\u653b\u51fb \u2013 XSS(\u5229\u7528\u7f51\u7ad9\u7a0b\u5e8f\u5bf9\u7528\u6237\u8f93\u5165\u8fc7\u6ee4\u4e0d\u8db3\uff0c\u8f93\u5165\u53ef\u4ee5\u663e\u793a\u5728\u9875\u9762\u4e0a\u5bf9\u5176\u4ed6\u7528\u6237\u9020\u6210\u5f71\u54cd\u7684HTML\u4ee3\u7801\uff0c\u4ece\u800c\u76d7\u53d6\u7528\u6237\u8d44\u6599\u3001\u5229\u7528\u7528\u6237\u8eab\u4efd\u8fdb\u884c\u67d0\u79cd\u52a8\u4f5c\u6216\u8005\u5bf9\u8bbf\u95ee\u8005\u8fdb\u884c\u75c5\u6bd2\u4fb5\u5bb3\u7684\u4e00\u79cd\u653b\u51fb\u65b9\u5f0f)</li> <li>\u8de8\u7ad9\u4f2a\u9020\u8bf7\u6c42\u653b\u51fb - CSRF</li> <li>\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u653b\u51fb</li> <li>\u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\u653b\u51fb - DDOS</li> </ul> <p>3 lvs/nginx/haproxy\u4f18\u7f3a\u70b9</p>"},{"location":"chap6/8Linux_all/#_2","title":"\u5b58\u50a8","text":"<p>\u7b54\uff1a\u4f7f\u7528\u5206\u5e03\u5f0f\u5b58\u50a8\uff0c\u5982mfs\u3001hadoop\u7b49</p>"},{"location":"chap6/9Linux_five/","title":"L9 Linux\u9762\u8bd5\u6700\u9ad8\u9891\u76845\u4e2a\u57fa\u672c\u95ee\u9898\uff08CPU+COMMMAND)","text":""},{"location":"chap6/9Linux_five/#1cpucpu","title":"1\u3001CPU\u5229\u7528\u7387\u548cCPU\u8d1f\u8f7d\u7684\u533a\u522b\u662f\u4ec0\u4e48","text":""},{"location":"chap6/9Linux_five/#1-1-cpu","title":"1-1 CPU\u5229\u7528\u7387","text":"<p>\u63d0\u5230CPU\u5229\u7528\u7387\uff0c\u5c31\u5fc5\u987b\u7406\u89e3\u65f6\u95f4\u7247\u3002\u4ec0\u4e48\u662fCPU\u65f6\u95f4\u7247\uff1f\u6211\u4eec\u73b0\u5728\u6240\u4f7f\u7528\u7684Windows\u3001Linux\u3001Mac OS\u90fd\u662f\u201c\u591a\u4efb\u52a1\u64cd\u4f5c\u7cfb\u7edf\u201d\uff0c\u5c31\u662f\u8bf4\u4ed6\u4eec\u53ef\u4ee5\u201c\u540c\u65f6\u201d\u8fd0\u884c\u591a\u4e2a\u7a0b\u5e8f\uff0c\u6bd4\u5982\u4e00\u8fb9\u6253\u5f00Chrome\u6d4f\u89c8\u5668\u6d4f\u89c8\u7f51\u9875\u8fd8\u80fd\u4e00\u8fb9\u542c\u97f3\u4e50\u3002</p> <p>\u4f46\u662f\uff0c\u5b9e\u9645\u4e0a\u4e00\u4e2aCPU\u5185\u6838\u5728\u540c\u4e00\u65f6\u523b\u53ea\u80fd\u5e72\u4e00\u4ef6\u4e8b\uff0c\u90a3\u64cd\u4f5c\u7cfb\u7edf\u662f\u5982\u4f55\u5b9e\u73b0\u201c\u591a\u4efb\u52a1\u201d\u7684\u5462\uff1f\u5927\u6982\u7684\u65b9\u6cd5\u662f\u8ba9\u591a\u4e2a\u8fdb\u7a0b\u8f6e\u6d41\u4f7f\u7528CPU\u4e00\u5c0f\u6bb5\u65f6\u95f4\uff0c\u7531\u4e8e\u8fd9\u4e2a\u201c\u4e00\u5c0f\u6bb5\u65f6\u95f4\u201d\u5f88\u77ed(\u5728linux\u4e0a\u4e3a5ms-800ms\u4e4b\u95f4)\uff0c\u7528\u6237\u611f\u89c9\u4e0d\u5230\uff0c\u5c31\u597d\u50cf\u662f\u51e0\u4e2a\u7a0b\u5e8f\u540c\u65f6\u5728\u8fd0\u884c\u4e86\u3002</p> <p>\u4e0a\u9762\u63d0\u5230\u7684\u201c\u4e00\u5c0f\u6bb5\u65f6\u95f4\u201d\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684CPU\u65f6\u95f4\u7247\uff0cCPU\u7684\u73b0\u4ee3\u5206\u65f6\u591a\u4efb\u52a1\u64cd\u4f5c\u7cfb\u7edf\u5bf9CPU\u90fd\u662f\u5206\u65f6\u95f4\u7247\u4f7f\u7528\u7684\u3002</p> <p>CPU\u4f7f\u7528\u7387\uff0c\u5c31\u662f\u7a0b\u5e8f\u5bf9CPU\u65f6\u95f4\u7247\u7684\u5360\u7528\u60c5\u51b5</p> <p>\u5373CPU\u4f7f\u7528\u7387 = CPU\u65f6\u95f4\u7247\u88ab\u7a0b\u5e8f\u4f7f\u7528\u7684\u65f6\u95f4 / \u603b\u65f6\u95f4\u3002</p> <p>\u6bd4\u5982A\u8fdb\u7a0b\u5360\u752810ms\uff0c\u7136\u540eB\u8fdb\u7a0b\u5360\u752830ms\uff0c\u7136\u540e\u7a7a\u95f260ms\uff0c\u518d\u53c8\u662fA\u8fdb\u7a0b\u536010ms\uff0cB\u8fdb\u7a0b\u536030ms\uff0c\u7a7a\u95f260ms\uff0c\u5982\u679c\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u90fd\u662f\u5982\u6b64\uff0c\u90a3\u4e48\u8fd9\u6bb5\u65f6\u95f4\u5185\u7684CPU\u5360\u7528\u7387\u4e3a40%\u3002</p> <p>CPU\u5229\u7528\u7387\u663e\u793a\u7684\u662f\u7a0b\u5e8f\u5728\u8fd0\u884c\u671f\u95f4\u5b9e\u65f6\u5360\u7528\u7684CPU\u767e\u5206\u6bd4\u3002</p> <p>\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u7684CPU\u5360\u7528\u7387\u5206\u4e3a\u7528\u6237\u6001CPU\u4f7f\u7528\u7387\u548c\u7cfb\u7edf\u6001CPU\u4f7f\u7528\u7387\u3002</p> <p>\u7528\u6237\u6001CPU\u4f7f\u7528\u7387\u662f\u6307\u6267\u884c\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u7684\u65f6\u95f4\u5360\u603bCPU\u65f6\u95f4\u7684\u767e\u5206\u6bd4\u3002\u76f8\u6bd4\u800c\u8a00\uff0c\u7cfb\u7edf\u6001CPU\u4f7f\u7528\u7387\u662f\u6307\u5e94\u7528\u6267\u884c\u64cd\u4f5c\u7cfb\u7edf\u8c03\u7528\u7684\u65f6\u95f4\u5360\u603bCPU\u65f6\u95f4\u7684\u767e\u5206\u6bd4\u3002\u7cfb\u7edf\u6001\u7684CPU\u4f7f\u7528\u7387\u9ad8\u610f\u5473\u7740\u5171\u4eab\u8d44\u6e90\u6709\u7ade\u4e89\u6216\u8005I/O\u8bbe\u5907\u4e4b\u95f4\u6709\u5927\u91cf\u7684\u4ea4\u4e92\u3002</p>"},{"location":"chap6/9Linux_five/#1-2-cpu","title":"1-2 CPU\u8d1f\u8f7d","text":"<p>\u7b80\u5355\u7406\u89e3\uff0c\u4e00\u4e2a\u662fCPU\u7684\u5b9e\u65f6\u4f7f\u7528\u60c5\u51b5\uff0c\u4e00\u4e2a\u662fCPU\u7684\u5f53\u524d\u4ee5\u53ca\u672a\u6765\u4e00\u6bb5\u65f6\u95f4\u7684\u4f7f\u7528\u60c5\u51b5\u3002</p> <p>\u4e3e\u4f8b\u6765\u8bf4\uff1a\u5982\u679c\u6211\u6709\u4e00\u4e2a\u7a0b\u5e8f\u5b83\u9700\u8981\u4e00\u76f4\u4f7f\u7528CPU\u7684\u8fd0\u7b97\u529f\u80fd\uff0c\u90a3\u4e48\u6b64\u65f6CPU\u7684\u4f7f\u7528\u7387\u53ef\u80fd\u8fbe\u5230100%\uff0c\u4f46\u662fCPU\u7684\u5de5\u4f5c\u8d1f\u8f7d\u5219\u662f\u8d8b\u8fd1\u4e8e\u201c1\u201d\uff0c\u56e0\u4e3aCPU\u4ec5\u8d1f\u8d23\u4e00\u4e2a\u5de5\u4f5c\u561b\uff01</p> <p>\u5982\u679c\u540c\u65f6\u6267\u884c\u8fd9\u6837\u7684\u7a0b\u5e8f\u4e24\u4e2a\u5462\uff1fCPU\u7684\u4f7f\u7528\u7387\u8fd8\u662f100%\uff0c\u4f46\u662f\u5de5\u4f5c\u8d1f\u8f7d\u5219\u53d8\u62102\u4e86\u3002\u6240\u4ee5\u4e5f\u5c31\u662f\u8bf4\uff0cCPU\u7684\u5de5\u4f5c\u8d1f\u8f7d\u8d8a\u5927\uff0c\u4ee3\u8868CPU\u5fc5\u987b\u8981\u5728\u4e0d\u540c\u7684\u5de5\u4f5c\u4e4b\u95f4\u8fdb\u884c\u9891\u7e41\u7684\u5de5\u4f5c\u5207\u6362\u3002\u65e0\u8bbaCPU\u7684\u5229\u7528\u7387\u662f\u9ad8\u662f\u4f4e\uff0c\u8ddf\u540e\u9762\u6709\u591a\u5c11\u4efb\u52a1\u5728\u6392\u961f(CPU\u8d1f\u8f7d)\u6ca1\u6709\u5fc5\u7136\u5173\u7cfb\u3002</p> <p>\u5982\u679c\u5355\u6838CPU\u7684\u8bdd\uff0c\u8d1f\u8f7d\u8fbe\u52301\u5c31\u4ee3\u8868CPU\u5df2\u7ecf\u8fbe\u5230\u6ee1\u8d1f\u8377\u7684\u72b6\u6001\u4e86\uff0c\u8d85\u8fc71\uff0c\u540e\u9762\u7684\u8fdb\u884c\u5c31\u9700\u8981\u6392\u961f\u7b49\u5f85\u5904\u7406\u4e86\u3002\u5982\u679c\u662f\u662f\u591a\u6838\u591aCPU\uff0c\u5047\u8bbe\u73b0\u5728\u670d\u52a1\u5668\u662f2\u4e2aCPU\uff0c\u6bcf\u4e2aCPU\u67092\u4e2a\u6838\uff0c\u90a3\u4e48\u603b\u8d1f\u8f7d\u4e0d\u8d85\u8fc74\u90fd\u6ca1\u4ec0\u4e48\u95ee\u9898\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7uptime\u3001w\u547d\u4ee4\u67e5\u770bCPU\u5e73\u5747\u8d1f\u8f7d\uff0c\u4f7f\u7528top\u547d\u4ee4\u8fd8\u80fd\u770b\u5230CPU\u8d1f\u8f7d\u603b\u4f53\u4f7f\u7528\u7387\u4ee5\u53ca\u5404\u4e2a\u8fdb\u7a0b\u5360\u7528CPU\u7684\u6bd4\u4f8b\u3002</p> <p></p>"},{"location":"chap6/9Linux_five/#1-3-cpu","title":"1-3 \u67e5\u770b\u7269\u7406CPU\u4e2a\u6570","text":"<pre><code>cat /proc/cpuinfo | grep \u201cphysical id\u201d| sort | uniq | wc -l\n</code></pre>"},{"location":"chap6/9Linux_five/#1-4-cpucore","title":"1-4 \u67e5\u770b\u6bcf\u4e2a\u7269\u7406CPU\u4e2dcore\u7684\u4e2a\u6570(\u5373\u6838\u6570)","text":"<pre><code>cat /proc/cpuinfo | grep \u201ccpu cores\u201d | uniq\n</code></pre>"},{"location":"chap6/9Linux_five/#1-5-cpu","title":"1-5 \u67e5\u770b\u903b\u8f91CPU\u7684\u4e2a\u6570","text":"<pre><code>cat /proc/cpuinfo| grep \u201cprocessor\u201d| wc -l\n</code></pre>"},{"location":"chap6/9Linux_five/#2cpu","title":"2\u3001\u5982\u679cCPU\u8d1f\u8f7d\u5f88\u9ad8\uff0c\u5229\u7528\u7387\u5374\u5f88\u4f4e\u8be5\u600e\u4e48\u529e","text":"<p>CPU\u8d1f\u8f7d\u5f88\u9ad8\uff0c\u5229\u7528\u7387\u5374\u5f88\u4f4e\uff0c\u8bf4\u660e\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\u7684\u4efb\u52a1\u5f88\u591a\uff0c\u8d1f\u8f7d\u8d8a\u9ad8\uff0c\u4ee3\u8868\u53ef\u80fd\u5f88\u591a\u50f5\u6b7b\u7684\u8fdb\u7a0b\u3002\u901a\u5e38\u8fd9\u79cd\u60c5\u51b5\u662fIO\u5bc6\u96c6\u578b\u7684\u4efb\u52a1\uff0c\u5927\u91cf\u4efb\u52a1\u5728\u8bf7\u6c42\u76f8\u540c\u7684IO\uff0c\u5bfc\u81f4\u4efb\u52a1\u961f\u5217\u5806\u79ef\u3002</p> <p>\u751f\u4ea7\u73af\u5883\u9020\u6210CPU\u5229\u7528\u7387\u4f4e\u8d1f\u8f7d\u9ad8\u7684\u5177\u4f53\u573a\u666f\u5e38\u89c1\u7684\u6709\u5982\u4e0b\u51e0\u79cd\u3002</p>"},{"location":"chap6/9Linux_five/#2-1-io","title":"2-1 \u573a\u666f\u4e00\uff1a\u78c1\u76d8\u8bfb\u5199\u8bf7\u6c42\u8fc7\u591a\u5c31\u4f1a\u5bfc\u81f4\u5927\u91cfI/O\u7b49\u5f85","text":"<p>\u8fdb\u7a0b\u5728cpu\u4e0a\u9762\u8fd0\u884c\u9700\u8981\u8bbf\u95ee\u78c1\u76d8\u6587\u4ef6\uff0c\u8fd9\u4e2a\u65f6\u5019cpu\u4f1a\u5411\u5185\u6838\u53d1\u8d77\u8c03\u7528\u6587\u4ef6\u7684\u8bf7\u6c42\uff0c\u8ba9\u5185\u6838\u53bb\u78c1\u76d8\u53d6\u6587\u4ef6\uff0c\u8fd9\u4e2a\u65f6\u5019cpu\u4f1a\u5207\u6362\u5230\u5176\u4ed6\u8fdb\u7a0b\u6216\u8005\u7a7a\u95f2\uff0c\u8fd9\u4e2a\u4efb\u52a1\u5c31\u4f1a\u8f6c\u6362\u4e3a\u4e0d\u53ef\u4e2d\u65ad\u7761\u7720\u72b6\u6001\u3002\u5f53\u8fd9\u79cd\u8bfb\u5199\u8bf7\u6c42\u8fc7\u591a\u5c31\u4f1a\u5bfc\u81f4\u4e0d\u53ef\u4e2d\u65ad\u7761\u7720\u72b6\u6001\u7684\u8fdb\u7a0b\u8fc7\u591a\uff0c\u4ece\u800c\u5bfc\u81f4\u8d1f\u8f7d\u9ad8\uff0ccpu\u4f4e\u7684\u60c5\u51b5\u3002</p>"},{"location":"chap6/9Linux_five/#2-2-mysql","title":"2-2 \u573a\u666f\u4e8c\uff1aMySQL\u4e2d\u5b58\u5728\u6ca1\u6709\u7d22\u5f15\u7684\u8bed\u53e5\u6216\u5b58\u5728\u6b7b\u9501\u7b49\u60c5\u51b5","text":"<p>\u6211\u4eec\u90fd\u77e5\u9053MySQL\u7684\u6570\u636e\u662f\u5b58\u50a8\u5728\u786c\u76d8\u4e2d\uff0c\u5982\u679c\u9700\u8981\u8fdb\u884csql\u67e5\u8be2\uff0c\u9700\u8981\u5148\u628a\u6570\u636e\u4ece\u78c1\u76d8\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u3002\u5f53\u5728\u6570\u636e\u7279\u522b\u5927\u7684\u65f6\u5019\uff0c\u5982\u679c\u6267\u884c\u7684sql\u8bed\u53e5\u6ca1\u6709\u7d22\u5f15\uff0c\u5c31\u4f1a\u9020\u6210\u626b\u63cf\u8868\u7684\u884c\u6570\u8fc7\u5927\u5bfc\u81f4I/O\u963b\u585e\uff0c\u6216\u8005\u662f\u8bed\u53e5\u4e2d\u5b58\u5728\u6b7b\u9501\uff0c\u4e5f\u4f1a\u9020\u6210I/O\u963b\u585e\uff0c\u4ece\u800c\u5bfc\u81f4\u4e0d\u53ef\u4e2d\u65ad\u7761\u7720\u8fdb\u7a0b\u8fc7\u591a\uff0c\u5bfc\u81f4\u8d1f\u8f7d\u8fc7\u5927\u3002</p> <p>\u540c\u6837\uff0c\u53ef\u4ee5\u5148\u901a\u8fc7top\u547d\u4ee4\u89c2\u5bdf\uff0c\u5047\u8bbe\u53d1\u73b0\u73b0\u5728\u786e\u5b9e\u662f\u9ad8\u8d1f\u8f7d\u4f4e\u4f7f\u7528\u7387\u3002</p> <p></p> <p>\u7136\u540e\uff0c\u518d\u901a\u8fc7\u547d\u4ee4<code>ps -aux</code>\u67e5\u770b\u662f\u5426\u5b58\u5728\u72b6\u6001\u4e3a<code>D\u7684</code>\u8fdb\u7a0b\uff0c\u8fd9\u4e2a\u72b6\u6001\u6307\u7684\u5c31\u662f\u4e0d\u53ef\u4e2d\u65ad\u7684\u7761\u7720\u72b6\u6001\u7684\u8fdb\u7a0b\u3002</p> <p>\u5904\u4e8e\u8fd9\u4e2a\u72b6\u6001\u7684\u8fdb\u7a0b\u65e0\u6cd5\u7ec8\u6b62\uff0c\u4e5f\u65e0\u6cd5\u81ea\u884c\u9000\u51fa\uff0c\u53ea\u80fd\u901a\u8fc7\u6062\u590d\u5176\u4f9d\u8d56\u7684\u8d44\u6e90\u6216\u8005\u91cd\u542f\u7cfb\u7edf\u6765\u89e3\u51b3\u3002\u4ee5\u4e0b\u56fe\u4e2d\u6ca1\u6709D\u72b6\u6001\u7684\u8fdb\u7a0b\u3002</p> <p></p> <p>Linux\u4e0a\u8fdb\u7a0b\u7684\u4e94\u79cd\u72b6\u6001</p> <ul> <li>R (<code>TASK_RUNNING</code>)\uff1a\u53ef\u6267\u884c\u72b6\u6001\uff0c\u53ea\u6709\u5728\u8be5\u72b6\u6001\u7684\u8fdb\u7a0b\u624d\u53ef\u80fd\u5728CPU\u4e0a\u8fd0\u884c\u3002\u800c\u540c\u4e00\u65f6\u523b\u53ef\u80fd\u6709\u591a\u4e2a\u8fdb\u7a0b\u5904\u4e8e\u53ef\u6267\u884c\u72b6\u6001\u3002</li> <li>S (<code>TASK_INTERRUPTIBLE)</code>\uff1a\u53ef\u4e2d\u65ad\u7684\u7761\u7720\u72b6\u6001\uff0c\u5904\u4e8e\u8fd9\u4e2a\u72b6\u6001\u7684\u8fdb\u7a0b\u56e0\u4e3a\u7b49\u5f85\u67d0\u67d0\u4e8b\u4ef6\u7684\u53d1\u751f\uff08\u6bd4\u5982\u7b49\u5f85socket\u8fde\u63a5\u3001\u7b49\u5f85\u4fe1\u53f7\u91cf\uff09\uff0c\u800c\u88ab\u6302\u8d77\u3002</li> <li>D (<code>TASK_UNINTERRUPTIBLE</code>)\uff1a\u4e0d\u53ef\u4e2d\u65ad\u7684\u7761\u7720\u72b6\u6001\uff0c\u8fdb\u7a0b\u5904\u4e8e\u7761\u7720\u72b6\u6001\uff0c\u4f46\u662f\u6b64\u523b\u8fdb\u7a0b\u662f\u4e0d\u53ef\u4e2d\u65ad\u7684\u3002<code>**TASK_UNINTERRUPTIBLE</code>\u72b6\u6001\u5b58\u5728\u7684\u610f\u4e49\u5c31\u5728\u4e8e\uff0c\u5185\u6838\u7684\u67d0\u4e9b\u5904\u7406\u6d41\u7a0b\u662f\u4e0d\u80fd\u88ab\u6253\u65ad\u7684**\u3002</li> <li>T (<code>TASK_STOPPED</code> or<code>TASK_TRACED</code>)\uff1a\u6682\u505c\u72b6\u6001\u6216\u8ddf\u8e2a\u72b6\u6001\u3002Z (<code>TASK_DEAD - EXIT_ZOMBIE)</code>\uff1a\u9000\u51fa\u72b6\u6001\uff0c\u8fdb\u7a0b\u6210\u4e3a\u50f5\u5c38\u8fdb\u7a0b\u3002\u8fdb\u7a0b\u5df2\u7ec8\u6b62\uff0c\u4f46\u8fdb\u7a0b\u63cf\u8ff0\u8fd8\u5728\uff0c\u76f4\u5230\u7236\u8fdb\u7a0b\u8c03\u7528<code>wait4()</code>\u7cfb\u7edf\u8c03\u7528\u540e\u91ca\u653e\u3002</li> </ul>"},{"location":"chap6/9Linux_five/#3cpu","title":"3\u3001\u5982\u679cCPU\u8d1f\u8f7d\u5f88\u4f4e\uff0c\u5229\u7528\u7387\u5374\u5f88\u9ad8\u8be5\u600e\u4e48\u529e","text":"<p>\u8fd9\u8868\u793aCPU\u7684\u4efb\u52a1\u5e76\u4e0d\u591a\uff0c\u4f46\u662f\u4efb\u52a1\u6267\u884c\u7684\u65f6\u95f4\u5f88\u957f\uff0c\u5927\u6982\u7387\u5c31\u662f\u4f60\u5199\u7684\u4ee3\u7801\u672c\u8eab\u6709\u95ee\u9898\uff0c\u901a\u5e38\u662f\u8ba1\u7b97\u5bc6\u96c6\u578b\u4efb\u52a1\uff0c\u751f\u6210\u4e86\u5927\u91cf\u8017\u65f6\u77ed\u7684\u8ba1\u7b97\u4efb\u52a1\u3002</p> <p>\u600e\u4e48\u6392\u67e5\uff1f\u76f4\u63a5top\u547d\u4ee4\u627e\u5230CPU\u4f7f\u7528\u7387\u6700\u9ad8\u7684\u8fdb\u7a0b\uff0c\u5b9a\u4f4d\u5230\u53bb\u770b\u770b\u5c31\u884c\u4e86\u3002\u5982\u679c\u4ee3\u7801\u6ca1\u6709\u95ee\u9898\uff0c\u90a3\u4e48\u8fc7\u6bb5\u65f6\u95f4CPU\u4f7f\u7528\u7387\u5c31\u4f1a\u4e0b\u964d\u7684\u3002\u5f80\u671f\u9762\u8bd5\u9898\u6c47\u603b\uff1a250\u671f\u9762\u8bd5\u8d44\u6599</p>"},{"location":"chap6/9Linux_five/#4cpu100","title":"4\u3001CPU\u5229\u7528\u7387\u8fbe\u5230100%\u600e\u4e48\u6392\u67e5\u95ee\u9898","text":""},{"location":"chap6/9Linux_five/#4-1topcpu","title":"4-1\u3001\u901a\u8fc7top\u627e\u5230CPU\u5360\u7528\u7387\u9ad8\u7684\u8fdb\u7a0b\uff08\u65f6\u95f4\u5360\u7528\u7684\u591a\uff09","text":""},{"location":"chap6/9Linux_five/#4-2top-hp-pidcpuid","title":"4-2\u3001\u901a\u8fc7<code>top -Hp pid</code>\u547d\u4ee4\u67e5\u770bCPU\u5360\u6bd4\u9760\u524d\u7684\u7ebf\u7a0bID","text":""},{"location":"chap6/9Linux_five/#4-3id16printf-0xxn-743170x1224d","title":"4-3\u3001\u518d\u628a\u7ebf\u7a0bID\u8f6c\u5316\u4e3a16\u8fdb\u5236\uff0c<code>printf \u201c0x%x\\n\u201d 74317</code>\uff0c\u5f97\u52300x1224d","text":""},{"location":"chap6/9Linux_five/#4-4jstack-72700-grep-0x1224d-c5-color","title":"4-4\u3001\u901a\u8fc7\u547d\u4ee4<code>jstack 72700 | grep \u20180x1224d\u2019 -C5 --color</code>\u627e\u5230\u6709\u95ee\u9898\u7684\u4ee3\u7801","text":"<pre><code>\u6ce8\u610f\uff1ajstack\u7684\u5bf9\u8c61\u662fjava\u8fdb\u7a0b\u7684PID\uff0c\u800c\u4e0d\u662fjava\u7ebf\u7a0b\u7684PID\u3002\n</code></pre>"},{"location":"chap6/9Linux_five/#5linux","title":"5\u3001\u8bf4\u51e0\u4e2a\u5e38\u89c1\u7684Linux\u547d\u4ee4","text":""},{"location":"chap6/9Linux_five/#5-1","title":"5-1 \u5e38\u7528\u7684\u6587\u4ef6/\u76ee\u5f55\u547d\u4ee4","text":"<p>ls\uff1a\u7528\u6237\u67e5\u770b\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c<code>ls -a</code>\u53ef\u4ee5\u7528\u6765\u67e5\u770b\u9690\u85cf\u6587\u4ef6\uff0c<code>ls -l\u53ef</code>\u4ee5\u7528\u4e8e\u67e5\u770b\u6587\u4ef6\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u6743\u9650\u3001\u5927\u5c0f\u3001\u6240\u6709\u8005\u7b49\u4fe1\u606f\u3002</p> <p>touch\uff1a\u7528\u4e8e\u521b\u5efa\u6587\u4ef6\u3002\u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\uff0c\u5982\u679c\u6587\u4ef6\u5df2\u5b58\u5728\uff0c\u5219\u4f1a\u4fee\u6539\u6587\u4ef6\u7684\u65f6\u95f4\u6233\u3002</p> <p>cat\uff1acat\u662f\u82f1\u6587concatenate\u7684\u7f29\u5199\uff0c\u7528\u4e8e\u67e5\u770b\u6587\u4ef6\u5185\u5bb9\u3002\u4f7f\u7528cat\u67e5\u770b\u6587\u4ef6\u7684\u8bdd\uff0c\u4e0d\u7ba1\u6587\u4ef6\u7684\u5185\u5bb9\u6709\u591a\u5c11\uff0c\u90fd\u4f1a\u4e00\u6b21\u6027\u663e\u793a\uff0c\u6240\u4ee5\u4ed6\u4e0d\u9002\u5408\u67e5\u770b\u592a\u5927\u7684\u6587\u4ef6\u3002</p> <p>more\uff1amore\u548ccat\u6709\u70b9\u533a\u522b\uff0cmore\u7528\u4e8e\u5206\u5c4f\u663e\u793a\u6587\u4ef6\u5185\u5bb9\u3002\u53ef\u4ee5\u7528\u7a7a\u683c\u952e\u5411\u4e0b\u7ffb\u9875\uff0cb\u952e\u5411\u4e0a\u7ffb\u9875</p> <p>less\uff1a\u548cmore\u7c7b\u4f3c\uff0cless\u7528\u4e8e\u5206\u884c\u663e\u793a</p> <p>tail\uff1a\u53ef\u80fd\u662f\u5e73\u65f6\u7528\u7684\u6700\u591a\u7684\u547d\u4ee4\u4e86\uff0c\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u57fa\u672c\u9760\u5b83\u3002<code>tail -fn 100 xx.log</code>\u67e5\u770b\u6700\u540e\u7684100\u884c\u5185\u5bb9</p>"},{"location":"chap6/9Linux_five/#5-2","title":"5-2 \u5e38\u7528\u7684\u6743\u9650\u547d\u4ee4","text":"<p>chmod\uff1a\u4fee\u6539\u6743\u9650\u547d\u4ee4\u3002\u4e00\u822c\u7528+\u53f7\u6dfb\u52a0\u6743\u9650\uff0c-\u53f7\u5220\u9664\u6743\u9650\uff0cx\u4ee3\u8868\u6267\u884c\u6743\u9650\uff0cr\u4ee3\u8868\u8bfb\u53d6\u6743\u9650\uff0cw\u4ee3\u8868\u5199\u5165\u6743\u9650\uff0c\u5e38\u89c1\u5199\u6cd5\u6bd4\u5982<code>chmod +x</code>\u6587\u4ef6\u540d\u6dfb\u52a0\u6267\u884c\u6743\u9650\u3002</p> <p>\u8fd8\u6709\u53e6\u5916\u4e00\u79cd\u5199\u6cd5\uff0c\u4f7f\u7528\u6570\u5b57\u6765\u6388\u6743\uff0c\u56e0\u4e3ar=4\uff0cw=2\uff0cx=1\uff0c\u5e73\u65f6\u6267\u884c\u547d\u4ee4chmod 777 \u6587\u4ef6\u540d\u8fd9\u5c31\u662f\u6700\u9ad8\u6743\u9650\u4e86\u3002</p> <p>\u7b2c\u4e00\u4e2a\u6570\u5b577=4+2+1\u4ee3\u8868\u7740\u6240\u6709\u8005\u7684\u6743\u9650\uff0c\u7b2c\u4e8c\u4e2a\u6570\u5b577\u4ee3\u8868\u6240\u5c5e\u7ec4\u7684\u6743\u9650\uff0c\u7b2c\u4e09\u4e2a\u6570\u5b57\u4ee3\u8868\u5176\u4ed6\u4eba\u7684\u6743\u9650\u3002\u5e38\u89c1\u7684\u6743\u9650\u6570\u5b57\u8fd8\u6709644\uff0c\u6240\u6709\u8005\u6709\u8bfb\u5199\u6743\u9650\uff0c\u5176\u4ed6\u4eba\u53ea\u6709\u53ea\u8bfb\u6743\u9650\uff0c755\u4ee3\u8868\u5176\u4ed6\u4eba\u6709\u53ea\u8bfb\u548c\u6267\u884c\u6743\u9650\u3002</p> <p>chown\uff1a\u7528\u4e8e\u4fee\u6539\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u6240\u6709\u8005\u548c\u6240\u5c5e\u7ec4\u3002\u4e00\u822c\u7528\u6cd5chown user \u6587\u4ef6\u540d\u7528\u4e8e\u4fee\u6539\u6587\u4ef6\u6240\u6709\u8005\uff0cchown user:user \u6587\u4ef6\u540d\u4fee\u6539\u6587\u4ef6\u6240\u6709\u8005\u548c\u7ec4\uff0c\u5192\u53f7\u524d\u9762\u662f\u6240\u6709\u8005\uff0c\u540e\u9762\u662f\u7ec4\u3002\u5f80\u671f\u9762\u8bd5\u9898\u6c47\u603b\uff1a250\u671f\u9762\u8bd5\u8d44\u6599</p>"},{"location":"chap6/9Linux_five/#5-3","title":"5-3 \u5e38\u7528\u7684\u538b\u7f29\u547d\u4ee4","text":"<p>zip\uff1a\u538b\u7f29zip\u6587\u4ef6\u547d\u4ee4\uff0c\u6bd4\u5982<code>zip test.zip</code> \u6587\u4ef6\u540d\u53ef\u4ee5\u628a\u6587\u4ef6\u538b\u7f29\u6210zip\u6587\u4ef6\uff0c\u5982\u679c\u538b\u7f29\u76ee\u5f55\u7684\u8bdd\u5219\u9700\u6dfb\u52a0<code>-r</code>\u9009\u9879\u3002</p> <p><code>unzip</code>\uff1a\u4e0ezip\u5bf9\u5e94\uff0c\u89e3\u538bzip\u6587\u4ef6\u547d\u4ee4\u3002<code>unzip xxx.zip</code>\u76f4\u63a5\u89e3\u538b\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7 <code>-d</code> \u9009\u9879\u6307\u5b9a\u89e3\u538b\u76ee\u5f55\u3002</p> <p></p> <p>gzip\uff1a\u7528\u4e8e\u538b\u7f29\u5e26.gz\u540e\u7f00\u7684\u6587\u4ef6\uff0cgzip\u547d\u4ee4\u4e0d\u80fd\u6253\u5305\u76ee\u5f55\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\u76f4\u63a5\u4f7f\u7528gzip \u6587\u4ef6\u540d\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u5bfc\u81f4\u6e90\u6587\u4ef6\u4f1a\u6d88\u5931\uff0c\u5982\u679c\u8981\u4fdd\u7559\u6e90\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528<code>gzip -c</code> \u6587\u4ef6\u540d<code>&gt; xx.gz</code>\uff0c\u89e3\u538b\u7f29\u76f4\u63a5\u4f7f\u7528<code>gzip -d xx.gz</code></p> <p>tar\uff1atar\u547d\u4ee4\u53ef\u4ee5\u4e3alinux\u7684\u6587\u4ef6\u548c\u76ee\u5f55\u521b\u5efa\u6863\u6848\u3002\u5229\u7528tar\uff0c\u53ef\u4ee5\u4e3a\u67d0\u4e00\u7279\u5b9a\u6587\u4ef6\u521b\u5efa\u6863\u6848\uff08\u5907\u4efd\u6587\u4ef6\uff09\uff0c\u4e5f\u53ef\u4ee5\u5728\u6863\u6848\u4e2d\u6539\u53d8\u6587\u4ef6\uff0c\u6216\u8005\u5411\u6863\u6848\u4e2d\u52a0\u5165\u65b0\u7684\u6587\u4ef6\u3002tar\u5e38\u7528\u51e0\u4e2a\u9009\u9879\uff0c-x \u89e3\u6253\u5305\uff0c-c \u6253\u5305\uff0c-f \u6307\u5b9a\u538b\u7f29\u5305\u6587\u4ef6\u540d\uff0c-v \u663e\u793a\u6253\u5305\u6587\u4ef6\u8fc7\u7a0b\uff0c\u4e00\u822c\u5e38\u7528<code>tar -cvf xx.tar</code> \u6587\u4ef6\u540d\u6765\u6253\u5305\uff0c\u89e3\u538b\u5219\u4f7f\u7528<code>tar -xvf xx.tar</code></p> <p>\u9996\u5148\u8981\u5f04\u6e05\u4e24\u4e2a\u6982\u5ff5\uff1a\u6253\u5305\u548c\u538b\u7f29\u3002\u6253\u5305\u662f\u6307\u5c06\u4e00\u5927\u5806\u6587\u4ef6\u6216\u76ee\u5f55\u53d8\u6210\u4e00\u4e2a\u603b\u7684\u6587\u4ef6\uff1b\u538b\u7f29\u5219\u662f\u5c06\u4e00\u4e2a\u5927\u7684\u6587\u4ef6\u901a\u8fc7\u4e00\u4e9b\u538b\u7f29\u7b97\u6cd5\u53d8\u6210\u4e00\u4e2a\u5c0f\u6587\u4ef6\u3002\u4e3a\u4ec0\u4e48\u8981\u533a\u5206\u8fd9\u4e24\u4e2a\u6982\u5ff5\u5462\uff1f\u8fd9\u6e90\u4e8eLinux\u4e2d\u5f88\u591a\u538b\u7f29\u7a0b\u5e8f\u53ea\u80fd\u9488\u5bf9\u4e00\u4e2a\u6587\u4ef6\u8fdb\u884c\u538b\u7f29\uff0c\u8fd9\u6837\u5f53\u4f60\u60f3\u8981\u538b\u7f29\u4e00\u5927\u5806\u6587\u4ef6\u65f6\uff0c\u4f60\u5f97\u5148\u5c06\u8fd9\u4e00\u5927\u5806\u6587\u4ef6\u5148\u6253\u6210\u4e00\u4e2a\u5305\uff08tar\u547d\u4ee4\uff09\uff0c\u7136\u540e\u518d\u7528\u538b\u7f29\u7a0b\u5e8f\u8fdb\u884c\u538b\u7f29\uff08gzip\u7b49\u547d\u4ee4\uff09\u3002</p> <p>Linux\u7684\u6253\u5305\u548c\u538b\u7f29\u662f\u5206\u5f00\u7684\u64cd\u4f5c\uff0c\u5982\u679c\u8981\u6253\u5305\u5e76\u4e14\u538b\u7f29\u7684\u8bdd\uff0c\u6309\u7167\u524d\u9762\u7684\u505a\u6cd5\u5fc5\u987b\u5148\u7528tar\u6253\u5305\uff0c\u7136\u540e\u518d\u7528gzip\u538b\u7f29\u3002\u5f53\u7136\uff0c\u8fd8\u6709\u66f4\u597d\u7684\u505a\u6cd5\u5c31\u662f-z\u547d\u4ee4\uff0c\u6253\u5305\u5e76\u4e14\u538b\u7f29\u3002</p> <p>\u4f7f\u7528\u547d\u4ee4<code>tar -zcvf xx.tar.gz</code> \u6587\u4ef6\u540d\u6765\u6253\u5305\u538b\u7f29\uff0c\u4f7f\u7528\u547d\u4ee4<code>tar -zxvf xx.tar.gz</code>\u6765\u89e3\u538b\u7f29\u3002</p>"},{"location":"chap6/linux_rew/","title":"Linux review","text":""},{"location":"chap6/linux_rew/#linux","title":"Linux \u8fdb\u884c\u6027\u80fd\u8bca\u65ad","text":""},{"location":"chap6/linux_rew/#cpu","title":"CPU\u5229\u7528\u7387","text":"<p>CPU\u4f7f\u7528\u7387\uff0c\u5c31\u662f\u7a0b\u5e8f\u5bf9CPU\u65f6\u95f4\u7247\u7684\u5360\u7528\u60c5\u51b5</p> <p>\u5373<code>CPU\u4f7f\u7528\u7387 = CPU\u65f6\u95f4\u7247\u88ab\u7a0b\u5e8f\u4f7f\u7528\u7684\u65f6\u95f4 / \u603b\u65f6\u95f4</code>\u3002</p> <p>CPU\u5229\u7528\u7387\u663e\u793a\u7684\u662f\u7a0b\u5e8f\u5728\u8fd0\u884c\u671f\u95f4\u5b9e\u65f6\u5360\u7528\u7684CPU\u767e\u5206\u6bd4\u3002</p>"},{"location":"chap6/linux_rew/#cpu_1","title":"CPU \u5e73\u5747\u8d1f\u8f7d","text":"<p>CPU \u5e73\u5747\u8d1f\u8f7d\uff0c\u4ee5\u53ca\u5728 io \u4e0a\u88ab\u963b\u585e\u7684\u4efb\u52a1\u3002</p> <pre><code>$ uptime \n23:51:26 up 21:31, 1 user, load average: 30.02, 26.43, 19.02\n</code></pre> <p>\u8fd9\u4e09\u4e2a\u503c\u662f\u7cfb\u7edf\u8ba1\u7b97\u7684 1 \u5206\u949f\u30015 \u5206\u949f\u300115 \u5206\u949f\u7684\u6307\u6570\u52a0\u6743\u7684\u52a8\u6001\u5e73\u5747\u503c</p> <p>CPU\u7684\u4f7f\u7528\u7387\u8fd8\u662f100%\uff0c\u4f46\u662f\u5de5\u4f5c\u8d1f\u8f7d\u5219\u53d8\u62102\u4e86\u3002\u6240\u4ee5\u4e5f\u5c31\u662f\u8bf4\uff0cCPU\u7684\u5de5\u4f5c\u8d1f\u8f7d\u8d8a\u5927\uff0c\u4ee3\u8868CPU\u5fc5\u987b\u8981\u5728\u4e0d\u540c\u7684\u5de5\u4f5c\u4e4b\u95f4\u8fdb\u884c\u9891\u7e41\u7684\u5de5\u4f5c\u5207\u6362\u3002\u65e0\u8bbaCPU\u7684\u5229\u7528\u7387\u662f\u9ad8\u662f\u4f4e\uff0c\u8ddf\u540e\u9762\u6709\u591a\u5c11\u4efb\u52a1\u5728\u6392\u961f(CPU\u8d1f\u8f7d)\u6ca1\u6709\u5fc5\u7136\u5173\u7cfb</p>"},{"location":"chap6/linux_rew/#load-average","title":"\u4ec0\u4e48\u662fload average\uff1f","text":"<p>linux\u7cfb\u7edf\u4e2d\u7684Load \u662f\u5bf9\u5f53\u524dCPU\u5de5\u4f5c\u91cf\u7684\u5ea6\u91cf (WikiPedia: the system load is a measure of the amount of work that a computer system is doing)\u3002</p> <p>\u67e5\u770b\u7269\u7406CPU\u4e2a\u6570</p> <pre><code>cat /proc/cpuinfo | grep \u201cphysical id\u201d| sort | uniq | wc -l\n</code></pre> <p>\u67e5\u770b\u6bcf\u4e2a\u7269\u7406CPU\u4e2dcore\u7684\u4e2a\u6570(\u5373\u6838\u6570)</p> <pre><code>cat /proc/cpuinfo | grep \u201ccpu cores\u201d | uniq\n</code></pre> <p>\u67e5\u770b\u903b\u8f91CPU\u7684\u4e2a\u6570</p> <pre><code>cat /proc/cpuinfo| grep \u201cprocessor\u201d| wc -l\n</code></pre>"},{"location":"chap6/linux_rew/#2cpu","title":"2\u3001\u5982\u679cCPU\u8d1f\u8f7d\u5f88\u9ad8\uff0c\u5229\u7528\u7387\u5374\u5f88\u4f4e\u8be5\u600e\u4e48\u529e","text":"<p>CPU\u8d1f\u8f7d\u5f88\u9ad8\uff0c\u5229\u7528\u7387\u5374\u5f88\u4f4e\uff0c\u8bf4\u660e\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\u7684\u4efb\u52a1\u5f88\u591a\uff0c\u8d1f\u8f7d\u8d8a\u9ad8\uff0c\u4ee3\u8868\u53ef\u80fd\u5f88\u591a\u50f5\u6b7b\u7684\u8fdb\u7a0b\u3002\u901a\u5e38\u8fd9\u79cd\u60c5\u51b5\u662fIO\u5bc6\u96c6\u578b\u7684\u4efb\u52a1\uff0c\u5927\u91cf\u4efb\u52a1\u5728\u8bf7\u6c42\u76f8\u540c\u7684IO\uff0c\u5bfc\u81f4\u4efb\u52a1\u961f\u5217\u5806\u79ef\u3002</p> <ul> <li>\u78c1\u76d8\u8bfb\u5199\u8bf7\u6c42\u8fc7\u591a\u5c31\u4f1a\u5bfc\u81f4\u5927\u91cfI/O\u7b49\u5f85</li> <li>MySQL\u4e2d\u5b58\u5728\u6ca1\u6709\u7d22\u5f15\u7684\u8bed\u53e5\u6216\u5b58\u5728\u6b7b\u9501\u7b49\u60c5\u51b5</li> </ul>"},{"location":"chap6/linux_rew/#top","title":"top","text":"<ul> <li>The same output you can find using Linux uptime command.</li> <li>Row 2 shows the number of process running on the server and their state. \uff08total,  running, sleeping, stopped, zombie)<ul> <li>Zombie process is a process that has completed execution but still has an entry in the process table.</li> </ul> </li> <li>Row three shows the CPU utilization status on the server, you can find here how much CPU is free and how much is utilizing by the system.</li> <li>Row 4 shows the memory utilization on the server, you can find here how much memory is used, the same results you can find using free command.<ul> <li>Total system memory, current used by memory system, free memory, total memory used by Buffers</li> </ul> </li> <li>Row 5 shows the swap memory utilization on the server, you can find here how much swap is being used, the same results you can find using free command.<ul> <li>In general terms, swap is a part of the hard disk used as RAM on the system.</li> <li>Total Swap memory in System </li> <li>Current USED Swap Memory by system</li> <li>Free Swap Memory</li> <li>Total Cached memory by system</li> </ul> </li> <li>Row #6  running process on servers and there additional details about them like below.</li> </ul>"},{"location":"chap6/linux_rew/#linuxbuffercache","title":"linux\u7cfb\u7edf\u91cc\uff0cbuffer\u548ccache\u5982\u4f55\u533a\u5206\uff1f","text":"<p>buffer\u548ccache\u90fd\u662f\u5185\u5b58\u4e2d\u7684\u4e00\u5757\u533a\u57df\uff0c</p> <ul> <li>\u5f53CPU\u9700\u8981\u5199\u6570\u636e\u5230\u78c1\u76d8\u65f6\uff0c\u7531\u4e8e\u78c1\u76d8\u901f\u5ea6\u6bd4\u8f83\u6162\uff0c\u6240\u4ee5CPU\u5148\u628a\u6570\u636e\u5b58\u8fdbbuffer\uff0c</li> <li>\u5f53CPU\u9700\u8981\u4ece\u78c1\u76d8\u8bfb\u5165\u6570\u636e\u65f6\uff0c\u7531\u4e8e\u78c1\u76d8\u901f\u5ea6\u6bd4\u8f83\u6162\uff0c\u53ef\u4ee5\u628a\u5373\u5c06\u7528\u5230\u7684\u6570\u636e\u63d0\u524d\u5b58\u5165cache\uff0cCPU\u76f4\u63a5\u4eceCache\u4e2d\u62ff\u6570\u636e\u8981\u5feb\u7684\u591a\u3002</li> </ul>"},{"location":"chap6/linux_rew/#linux_1","title":"Linux \u6587\u4ef6\u7cfb\u7edf","text":""},{"location":"chap6/linux_rew/#inode","title":"inode","text":"<p>\u6587\u4ef6\u7cfb\u7edf\u5305\u542b\u5143\u6570\u636e\uff08\u7d22\u5f15\u6570\u636e\uff09\u4ee5\u53ca\u6570\u636e\u5185\u5bb9\uff08\u6570\u636e\u5757\uff09</p> <p>inode\u5373\u4e3a\u5143\u6570\u636e\uff0cinode\u8bb0\u5f55\u6570\u636e\u5757\u7684\u4f4d\u7f6e\u53ca\u7d22\u5f15\u4fe1\u606f\uff08\u6587\u4ef6\u5c5e\u6027\uff0cctime\uff0catime\uff0cmtime\u7b49\uff09</p> <ul> <li>\u6587\u4ef6\u7684\u5b57\u8282\u6570\uff0c\u5757\u6570</li> <li>\u6587\u4ef6\u62e5\u6709\u8005\u7684User ID</li> <li>\u6587\u4ef6\u7684Group ID</li> <li>\u6587\u4ef6\u7684\u8bfb\u3001\u5199\u3001\u6267\u884c\u6743\u9650</li> <li>\u6587\u4ef6\u7684\u65f6\u95f4\u6233\uff0c\u5171\u6709\u4e09\u4e2a\uff1actime\u6307inode\u4e0a\u4e00\u6b21\u53d8\u52a8\u7684\u65f6\u95f4\uff0cmtime\u6307\u6587\u4ef6\u5185\u5bb9\u4e0a\u4e00\u6b21\u53d8\u52a8\u7684\u65f6\u95f4\uff0catime\u6307\u6587\u4ef6\u4e0a\u4e00\u6b21\u6253\u5f00\u7684\u65f6\u95f4\u3002</li> <li>\u94fe\u63a5\u6570\uff0c\u5373\u6709\u591a\u5c11\u6587\u4ef6\u540d\u6307\u5411\u8fd9\u4e2ainode</li> <li>\u6587\u4ef6\u6570\u636eblock\u7684\u4f4d\u7f6e</li> <li>inode\u7f16\u53f7</li> </ul>"},{"location":"chap6/linux_rew/#inode_1","title":"inode\u7684\u5927\u5c0f","text":"<p>\u6240\u4ee5\u786c\u76d8\u683c\u5f0f\u5316\u7684\u65f6\u5019\uff0c\u64cd\u4f5c\u7cfb\u7edf\u81ea\u52a8\u5c06\u786c\u76d8\u5206\u6210\u4e24\u4e2a\u533a\u57df\u3002</p> <p>\u4e00\u4e2a\u662f\u6570\u636e\u533a\uff0c\u5b58\u653e\u6587\u4ef6\u6570\u636e\uff1b\u53e6\u4e00\u4e2a\u662finode\u533a\uff08inode table\uff09\uff0c\u5b58\u653einode\u6240\u5305\u542b\u7684\u4fe1\u606f</p> <p>\u786c\u94fe\u63a5</p> <p>Unix/Linux\u7cfb\u7edf\u5141\u8bb8\uff0c\u591a\u4e2a\u6587\u4ef6\u540d\u6307\u5411\u540c\u4e00\u4e2ainode\u53f7\u7801\u3002</p> <p>\u53ef\u4ee5\u7528\u4e0d\u540c\u7684\u6587\u4ef6\u540d\u8bbf\u95ee\u540c\u6837\u7684\u5185\u5bb9\uff1b\u5bf9\u6587\u4ef6\u5185\u5bb9\u8fdb\u884c\u4fee\u6539\uff0c\u4f1a\u5f71\u54cd\u5230\u6240\u6709\u6587\u4ef6\u540d\uff1b\u4f46\u662f\uff0c\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u4e0d\u5f71\u54cd\u53e6\u4e00\u4e2a\u6587\u4ef6\u540d\u7684\u8bbf\u95ee\u3002\u8fd9\u79cd\u60c5\u51b5\u5c31\u88ab\u79f0\u4e3a\u201d\u786c\u94fe\u63a5\u201d\uff08hard link\uff09</p> <p><code>ln -i</code></p> <p>\u8f6f\u94fe\u63a5</p> <p>\u6587\u4ef6A\u548c\u6587\u4ef6B\u7684inode\u53f7\u7801\u867d\u7136\u4e0d\u4e00\u6837\uff0c\u4f46\u662f\u6587\u4ef6A\u7684\u5185\u5bb9\u662f\u6587\u4ef6B\u7684\u8def\u5f84\u3002</p> <p>ln\u521b\u5efa\u7684\u662f\u786c\u94fe\u63a5\uff0c\u5e26-s\u53c2\u6570\u7684ln\u547d\u4ee4\u521b\u5efa\u7684\u662f\u8f6f\u94fe\u63a5\u3002</p>"},{"location":"chap6/linux_rew/#_1","title":"\u8d1f\u8f7d\u5747\u8861","text":"<p>\u4e03\u5c42\u8d1f\u8f7d\u5747\u8861\uff1a\u5c31\u662f\u53ef\u4ee5\u6839\u636e\u8bbf\u95ee\u7528\u6237\u7684 HTTP \u8bf7\u6c42\u5934\u3001URL \u4fe1\u606f\u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230\u7279\u5b9a\u7684\u4e3b\u673a\u3002</p> <ul> <li>DNS \u91cd\u5b9a\u5411</li> <li>HTTP \u91cd\u5b9a\u5411</li> <li>\u53cd\u5411\u4ee3\u7406</li> </ul> <p>\u56db\u5c42\u8d1f\u8f7d\u5747\u8861\uff1a\u57fa\u4e8e IP \u5730\u5740\u548c\u7aef\u53e3\u8fdb\u884c\u8bf7\u6c42\u7684\u8f6c\u53d1\u3002</p> <ul> <li>\u4fee\u6539 IP \u5730\u5740</li> <li>\u4fee\u6539 MAC \u5730\u5740</li> </ul> <p>DNS \u8d1f\u8f7d\u5747\u8861 /  HTTP \u8d1f\u8f7d\u5747\u8861 / \u53cd\u5411\u4ee3\u7406\u8d1f\u8f7d\u5747\u8861 / IP\u8d1f\u8f7d\u5747\u8861 / \u6570\u636e\u94fe\u8def\u5c42\u8d1f\u8f7d\u5747\u8861</p>"},{"location":"chap6/linux_rew/#_2","title":"\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5","text":"<ul> <li> <p>\u968f\u673a</p> <ul> <li>\u968f\u673a\u7b97\u6cd5</li> <li>\u52a0\u6743\u968f\u673a\u7b97\u6cd5</li> </ul> </li> <li> <p>\u8f6e\u8be2</p> <ul> <li>\u8f6e\u8be2\u7b97\u6cd5</li> <li>\u52a0\u6743\u8f6e\u8be2\u7b97\u6cd5</li> </ul> </li> <li>\u6700\u5c0f\u6d3b\u8dc3\u6570 / \u6e90\u5730\u5740\u54c8\u5e0c / \u4e00\u81f4\u6027\u54c8\u5e0c</li> </ul>"},{"location":"chap6/linux_rew/#_3","title":"\u5e38\u89c1\u7f51\u7edc\u7f16\u7a0b\u9762\u8bd5\u9898","text":"<ul> <li>\u7f51\u7edc\u534f\u8bae\u662f\u4ec0\u4e48\uff1f</li> </ul> <p>\u7b80\u8ff0TCP\u4e09\u6b21\u63e1\u624b\uff0c\u56db\u6b21\u65ad\u5f00\uff0c\u53ca\u5176\u4f18\u70b9\u548c\u7f3a\u70b9\uff0c\u540c\u65f6\u76f8\u5bf9\u4e8eUDP\u7684\u5dee\u522b\uff1f</p>"},{"location":"chap6/linux_rew/#tcp","title":"\u7b80\u8ff0TCP\u4e09\u6b21\u63e1\u624b\uff0c\u56db\u6b21\u65ad\u5f00","text":"<ul> <li><code>Client -&gt; Server</code>:  <code>SYN_SENT</code> -&gt; SYN -&gt; <code>SYN-RCV</code> (Listen)</li> <li><code>Server -&gt; Client</code>: <code>SYN-RCV</code> -&gt; <code>SYN+ACK</code> -&gt; ESTABLSHED</li> <li> <p><code>Client -&gt; Server</code>: <code>ESTABLSHED</code> -&gt; <code>ACK+\u8bf7\u6c42\u6570\u636e</code> -&gt; <code>ESTABLSHED</code></p> </li> <li> <p>\u7b2c\u4e00\u6b21\u63e1\u624b\uff1a\u5ba2\u6237\u7aef\u53d1\u9001syn\u5305(syn=j)\u5230\u670d\u52a1\u5668\uff0c\u5e76\u8fdb\u5165<code>SYN_SEND</code>\u72b6\u6001\uff0c\u7b49\u5f85\u670d\u52a1\u5668\u786e\u8ba4\uff1b</p> </li> <li>\u7b2c\u4e8c\u6b21\u63e1\u624b\uff1a\u670d\u52a1\u5668\u6536\u5230syn\u5305\uff0c\u5fc5\u987b\u786e\u8ba4\u5ba2\u6237\u7684SYN\uff08ack=j+1\uff09\uff0c\u540c\u65f6\u81ea\u5df1\u4e5f\u53d1\u9001\u4e00\u4e2aSYN\u5305\uff08syn=k\uff09\uff0c\u5373SYN+ACK\u5305\uff0c\u6b64\u65f6\u670d\u52a1\u5668\u8fdb\u5165<code>SYN_RECV</code>\u72b6\u6001\uff1b</li> <li>\u7b2c\u4e09\u6b21\u63e1\u624b\uff1a\u5ba2\u6237\u7aef\u6536\u5230\u670d\u52a1\u5668\u7684<code>SYN\uff0bACK</code>\u5305\uff0c\u5411\u670d\u52a1\u5668\u53d1\u9001\u786e\u8ba4\u5305<code>ACK(ack=k+1)</code>\uff0c\u6b64\u5305\u53d1\u9001\u5b8c\u6bd5\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u8fdb\u5165ESTABLISHED\u72b6\u6001\uff0c\u5b8c\u6210\u4e09\u6b21\u63e1\u624b\u3002</li> </ul>"},{"location":"chap6/linux_rew/#_4","title":"\u56db\u6b21\u65ad\u5f00\uff1a","text":"<ul> <li>\u5f53\u4e3b\u673aA\u5b8c\u6210\u6570\u636e\u4f20\u8f93\u540e\uff0c\u5c06\u63a7\u5236\u4f4dFIN\u7f6e1\uff0c\u63d0\u51fa\u505c\u6b62TCP\u8fde\u63a5\u7684\u8bf7\u6c42\uff1b</li> <li>\u4e3b\u673aB\u6536\u5230FIN\u540e\u5bf9\u5176\u4f5c\u51fa\u54cd\u5e94\uff0c\u786e\u8ba4\u8fd9\u4e00\u65b9\u5411\u4e0a\u7684TCP\u8fde\u63a5\u5c06\u5173\u95ed\uff0c\u5c06ACK\u7f6e1\uff1b</li> <li>\u4e3b\u673aB\u518d\u63d0\u51fa\u53cd\u65b9\u5411\u7684\u5173\u95ed\u8bf7\u6c42\uff0c\u5c06FIN\u7f6e1\uff1b</li> <li> <p>\u4e3b\u673aA\u5bf9\u4e3b\u673aB\u7684\u8bf7\u6c42\u8fdb\u884c\u786e\u8ba4\uff0c\u5c06ACK\u7f6e1\uff0c\u53cc\u65b9\u5411\u7684\u5173\u95ed\u7ed3\u675f</p> </li> <li> <p>A -&gt; B (<code>FIN_WAIT1</code> -&gt; FIN -&gt; <code>CLOSE_WAIT</code>)</p> </li> <li>B -&gt; A (<code>CLOSE_WAIT</code> -&gt; ACK -&gt; <code>FIN_WAIT2</code>)</li> <li>B -&gt; A (<code>LAST_ACK</code> -&gt; FIN -&gt; <code>TIME_WAIT</code>)</li> <li>A -&gt; B (<code>TIME_WAIT</code> -&gt; ACK) </li> </ul>"},{"location":"chap6/linux_rew/#netstat","title":"netstat","text":"<pre><code>netstat -nlp |grep LISTEN   //\u67e5\u770b\u5f53\u524d\u6240\u6709\u76d1\u542c\u7aef\u53e3\u00b7\n</code></pre>"},{"location":"chap6/linux_rew/#_5","title":"\u76d1\u542c\u7aef\u53e3","text":"<p>\u4fa6\u542c\u7aef\u53e3\u662f\u5e94\u7528\u7a0b\u5e8f\u6216\u8fdb\u7a0b\u5728\u5176\u4e0a\u4fa6\u542c\u7684\u7f51\u7edc\u7aef\u53e3\uff0c\u5145\u5f53\u901a\u4fe1\u7aef\u70b9\u3002</p> <p>\u6bcf\u4e2a\u76d1\u542c\u7aef\u53e3\u90fd\u53ef\u4ee5\u4f7f\u7528\u9632\u706b\u5899\u6253\u5f00\u6216\u5173\u95ed\uff08\u8fc7\u6ee4\uff09\u3002\u4e00\u822c\u800c\u8a00\uff0c\u5f00\u653e\u7aef\u53e3\u662f\u4e00\u4e2a\u7f51\u7edc\u7aef\u53e3\uff0c\u5b83\u63a5\u53d7\u6765\u81ea\u8fdc\u7a0b\u4f4d\u7f6e\u7684\u4f20\u5165\u6570\u636e\u5305\u3002</p> <pre><code>sudo netstat -tunlp\n</code></pre> <ul> <li><code>-t</code>-\u663e\u793aTCP\u7aef\u53e3\u3002</li> <li><code>-u</code> -\u663e\u793aUDP\u7aef\u53e3\u3002</li> <li><code>-n</code> -\u663e\u793a\u6570\u5b57\u5730\u5740\u800c\u4e0d\u662f\u89e3\u6790\u4e3b\u673a\u3002</li> <li><code>-l</code> -\u4ec5\u663e\u793a\u76d1\u542c\u7aef\u53e3\u3002</li> <li><code>-p</code> -\u663e\u793a\u4fa6\u542c\u5668\u8fdb\u7a0b\u7684PID\u548c\u540d\u79f0\u3002\u4ec5\u5f53\u4f60\u4ee5root\u7528\u6237\u6216 sudo \u7528\u6237\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\u65f6\uff0c\u624d\u4f1a\u663e\u793a\u6b64\u4fe1\u606f\u3002</li> </ul> <pre><code>Proto Recv-Q Send-Q Local Address   Foreign Address     State       PID/Program name      \ntcp        0      0 0:22              0:*               LISTEN      445/sshd              \ntcp        0      0 0:25              0:*               LISTEN      929/master            \ntcp6       0      0 :::3306           ::*               LISTEN      534/mysqld            \ntcp6       0      0 :::80             :::*              LISTEN      515/apache2           \ntcp6       0      0 :::22             :::*              LISTEN      445/sshd              \ntcp6       0      0 :::25             :::*              LISTEN      929/master            \ntcp6       0      0 :::33060          :::*              LISTEN      534/mysqld            \nudp        0      0 0:68              0:*                           966/dhclient  \n</code></pre> <ul> <li>Proto-\u5957\u63a5\u5b57\u4f7f\u7528\u7684\u534f\u8bae\u3002</li> <li>Local Address -\u8fdb\u7a0b\u4fa6\u542c\u7684IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u3002</li> <li>PID/Program name -PID\u548c\u8fdb\u7a0b\u540d\u79f0\u3002</li> </ul> <pre><code>sudo netstat -nlp | grep 22\n</code></pre> <pre><code>tcp        0      0 0:22              0:*               LISTEN      445/sshd  \ntcp6       0      0 :::22             :::*              LISTEN      445/sshd  \n</code></pre>"},{"location":"chap6/linux_rew/#ss","title":"\u7528ss","text":"<p>\u68c0\u67e5\u76d1\u542c\u7aef\u53e3</p> <p>ss\u662f\u65b0\u7684netstat\u3002\u5b83\u7f3a\u5c11netstat\u7684\u67d0\u4e9b\u529f\u80fd\uff0c\u4f46\u662f\u516c\u5f00\u4e86\u66f4\u591a\u7684TCP\u72b6\u6001\uff0c\u5e76\u4e14\u901f\u5ea6\u7a0d\u5feb\u3002\u547d\u4ee4\u9009\u9879\u57fa\u672c\u76f8\u540c\uff0c\u56e0\u6b64\u4ecenetstat\u5230ss\u7684\u8f6c\u6362\u5e76\u4e0d\u56f0\u96be\u3002</p> <p>\u8981\u4f7f\u7528ss\u83b7\u53d6\u6240\u6709\u76d1\u542c\u7aef\u53e3\u7684\u5217\u8868\uff0c\u8bf7\u8f93\u5165\uff1a</p> <pre><code>sudo ss -tunlp\n</code></pre> <p>\u8f93\u51fa\u4e0enetstat\u62a5\u544a\u7684\u8f93\u51fa\u51e0\u4e4e\u76f8\u540c\uff1a</p> <pre><code>State    Recv-Q   Send-Q     Local Address:Port      Peer Address:Port                                                                                          \nLISTEN   0        128              0:22             0:*      users:((\"sshd\",pid=445,fd=3))                                                          \nLISTEN   0        100              0:25             0:*      users:((\"master\",pid=929,fd=13))                                                       \nLISTEN   0        128                    *:3306                 *:*      users:((\"mysqld\",pid=534,fd=30))                                                       \nLISTEN   0        128                    *:80                   *:*      users:((\"apache2\",pid=765,fd=4),(\"apache2\",pid=764,fd=4),(\"apache2\",pid=515,fd=4))     \nLISTEN   0        128                 [::]:22                [::]:*      users:((\"sshd\",pid=445,fd=4))                                                          \nLISTEN   0        100                 [::]:25                [::]:*      users:((\"master\",pid=929,fd=14))                                                       \nLISTEN   0        70                     *:33060                *:*      users:((\"mysqld\",pid=534,fd=33))  \n</code></pre>"},{"location":"chap6/linux_rew/#lsof","title":"\u4f7f\u7528lsof","text":"<p>\u68c0\u67e5\u76d1\u542c\u7aef\u53e3</p> <p>lsof\u662f\u529f\u80fd\u5f3a\u5927\u7684\u547d\u4ee4\u884c\u5e94\u7528\u7a0b\u5e8f\uff0c\u53ef\u63d0\u4f9b\u6709\u5173\u8fdb\u7a0b\u6253\u5f00\u7684\u6587\u4ef6\u7684\u4fe1\u606f\u3002</p> <p>\u5728Linux\u4e2d\uff0c\u6240\u6709\u5185\u5bb9\u90fd\u662f\u6587\u4ef6\u3002\u4f60\u53ef\u4ee5\u5c06\u5957\u63a5\u5b57\u89c6\u4e3a\u5199\u5165\u7f51\u7edc\u7684\u6587\u4ef6\u3002</p> <p>\u8981\u83b7\u53d6\u5177\u6709lsof\u7684\u6240\u6709\u4fa6\u542cTCP\u7aef\u53e3\u7684\u5217\u8868\uff0c\u8bf7\u8f93\u5165\uff1a</p> <pre><code>sudo lsof -nP -iTCP -sTCP:LISTEN  \n</code></pre> <p>\u4f7f\u7528\u7684\u9009\u9879\u5982\u4e0b:</p> <ul> <li><code>-n</code>-\u4e0d\u8981\u5c06\u7aef\u53e3\u53f7\u8f6c\u6362\u4e3a\u7aef\u53e3\u540d\u79f0\u3002</li> <li><code>-p</code> -\u4e0d\u89e3\u6790\u4e3b\u673a\u540d\uff0c\u663e\u793a\u6570\u5b57\u5730\u5740\u3002</li> </ul> <p>-iTCP -sTCP:LISTEN -\u4ec5\u663e\u793aTCP\u72b6\u6001\u4e3aLISTEN\u7684\u7f51\u7edc\u6587\u4ef6\u3002</p> <pre><code>COMMAND   PID     USER   FD   TYPE DEVICE SIZE/OFF NODE NAME  \nsshd      445     root    3u  IPv4  16434      0t0  TCP *:22 (LISTEN)  \nsshd      445     root    4u  IPv6  16445      0t0  TCP *:22 (LISTEN)  \napache2   515     root    4u  IPv6  16590      0t0  TCP *:80 (LISTEN)  \nmysqld    534    mysql   30u  IPv6  17636      0t0  TCP *:3306 (LISTEN)  \nmysqld    534    mysql   33u  IPv6  19973      0t0  TCP *:33060 (LISTEN)  \napache2   764 www-data    4u  IPv6  16590      0t0  TCP *:80 (LISTEN)  \napache2   765 www-data    4u  IPv6  16590      0t0  TCP *:80 (LISTEN)  \nmaster    929     root   13u  IPv4  19637      0t0  TCP *:25 (LISTEN)  \nmaster    929     root   14u  IPv6  19638      0t0  TCP *:25 (LISTEN)  \n</code></pre> <ul> <li>COMMAND\uff0cPID\uff0cUSER-\u8fd0\u884c\u4e0e\u7aef\u53e3\u5173\u8054\u7684\u7a0b\u5e8f\u7684\u540d\u79f0\uff0cPID\u548c\u7528\u6237\u3002</li> <li>NAME -\u7aef\u53e3\u53f7\u3002</li> </ul> <p>\u8981\u67e5\u627e\u6b63\u5728\u4fa6\u542c\u7279\u5b9a\u7aef\u53e3\uff08\u4f8b\u5982\u7aef\u53e33306\uff09\u7684\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u4f7f\u7528\uff1a</p> <pre><code>sudo lsof -nP -iTCP:3306 -sTCP:LISTEN  \n</code></pre> <p>\u8f93\u51fa\u663e\u793aMySQL\u670d\u52a1\u5668\u4f7f\u7528\u7aef\u53e33306:</p> <pre><code>COMMAND PID  USER   FD   TYPE DEVICE SIZE/OFF NODE NAME  \nmysqld  534 mysql   30u  IPv6  17636      0t0  TCP *:3306 (LISTEN)\n</code></pre>"},{"location":"chap7/1Ms/","title":"1\u3001Microsoft Interview2021","text":"<ul> <li>Netstat \u67e5\u770b\u7684\u72b6\u6001</li> <li>pause\u5bb9\u5668\u7684\u79d8\u5bc6</li> <li>HTTP and HTTPS \u7684\u63e1\u624b\u8fc7\u7a0b</li> <li>k8s\u521b\u5efaservice\u7684\u8fc7\u7a0b</li> <li>StatefulSet\u548cDeployment\u7684\u533a\u522b</li> <li>Docker \u6302\u8f7d\u70b9 \u548c \u5b58\u50a8\u9a71\u52a8</li> </ul>"},{"location":"chap7/1Ms/#1-netstat","title":"1. Netstat \u67e5\u770b\u7684\u72b6\u6001","text":"<p>netstat\u547d\u4ee4\u5404\u4e2a\u53c2\u6570\u8bf4\u660e\u5982\u4e0b\uff1a</p> <pre><code>-a   \u6216\u2013all                             \u663e\u793a\u6240\u6709\u8fde\u7ebf\u4e2d\u7684Socket\u3002\n-A                                       &lt;\u7f51\u7edc\u7c7b\u578b&gt;\u6216\u2013&lt;\u7f51\u7edc\u7c7b\u578b&gt; \u5217\u51fa\u8be5\u7f51\u7edc\u7c7b\u578b\u8fde\u7ebf\u4e2d\u7684\u76f8\u5173\u5730\u5740\u3002\n-c   \u6216\u2013continuous               \u6301\u7eed\u5217\u51fa\u7f51\u7edc\u72b6\u6001\u3002\n-C \u6216\u2013cache                       \u663e\u793a\u8def\u7531\u5668\u914d\u7f6e\u7684\u5feb\u53d6\u4fe1\u606f\u3002\n-e  \u6216\u2013extend                     \u663e\u793a\u7f51\u7edc\u5176\u4ed6\u76f8\u5173\u4fe1\u606f\u3002\n-F  \u6216 \u2013fib                          \u663e\u793aFIB\u3002\n-g  \u6216\u2013groups                     \u663e\u793a\u591a\u91cd\u5e7f\u64ad\u529f\u80fd\u7fa4\u7ec4\u7ec4\u5458\u540d\u5355\u3002\n-h  \u6216\u2013help                        \u5728\u7ebf\u5e2e\u52a9\u3002\n-i   \u6216\u2013interfaces                 \u663e\u793a\u7f51\u7edc\u754c\u9762\u4fe1\u606f\u8868\u5355\u3002\n-l  \u6216\u2013listening                    \u663e\u793a\u76d1\u63a7\u4e2d\u7684\u670d\u52a1\u5668\u7684Socket\u3002\n-M   \u6216\u2013masquerade           \u663e\u793a\u4f2a\u88c5\u7684\u7f51\u7edc\u8fde\u7ebf\u3002\n-n  \u6216\u2013numeric                   \u76f4\u63a5\u4f7f\u7528IP\u5730\u5740\uff0c\u800c\u4e0d\u901a\u8fc7\u57df\u540d\u670d\u52a1\u5668\u3002\n-N   \u6216\u2013netlink\u6216\u2013symbolic  \u663e\u793a\u7f51\u7edc\u786c\u4ef6\u5916\u56f4\u8bbe\u5907\u7684\u7b26\u53f7\u8fde\u63a5\u540d\u79f0\u3002\n-o  \u6216\u2013timers                      \u663e\u793a\u8ba1\u65f6\u5668\u3002\n-p   \u6216\u2013programs                \u663e\u793a\u6b63\u5728\u4f7f\u7528Socket\u7684\u7a0b\u5e8f\u8bc6\u522b\u7801\u548c\u7a0b\u5e8f\u540d\u79f0\u3002\n-r  \u6216\u2013route                        \u663e\u793a Routing Table\u3002\n-s  \u6216\u2013statistice \u663e\u793a\u7f51\u7edc\u5de5\u4f5c\u4fe1\u606f\u7edf\u8ba1\u8868\u3002\n-t  \u6216\u2013tcp \u663e\u793aTCP \u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5\u3002\n-u\u6216\u2013udp \u663e\u793aUDP\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5\u3002\n-v\u6216\u2013verbose \u663e\u793a\u6307\u4ee4\u6267\u884c\u8fc7\u7a0b\u3002\n-V \u6216\u2013version \u663e\u793a\u7248\u672c\u4fe1\u606f\u3002\n-w\u6216\u2013raw \u663e\u793aRAW\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5\u3002\n-x\u6216\u2013unix \u6b64\u53c2\u6570\u7684\u6548\u679c\u548c\u6307\u5b9a\u201d-A unix\u201d\u53c2\u6570\u76f8\u540c\u3002\n\u2013ip\u6216\u2013inet \u6b64\u53c2\u6570\u7684\u6548\u679c\u548c\u6307\u5b9a\u201d-A inet\u201d\u53c2\u6570\u76f8\u540c\u3002\n</code></pre> <p>\u5373\u53ef\u663e\u793a\u5f53\u524d\u670d\u52a1\u5668\u4e0a\u6240\u6709\u7aef\u53e3\u53ca\u8fdb\u7a0b\u670d\u52a1\uff0c\u4e8egrep\u7ed3\u5408\u53ef\u67e5\u770b\u67d0\u4e2a\u5177\u4f53\u7aef\u53e3\u53ca\u670d\u52a1\u60c5\u51b5\uff1a</p> <pre><code>[root@localhost ~]# netstat -ntlp   //\u67e5\u770b\u5f53\u524d\u6240\u6709tcp\u7aef\u53e3\u00b7\n\n[root@localhost ~]# netstat -ntulp |grep 80   //\u67e5\u770b\u6240\u670980\u7aef\u53e3\u4f7f\u7528\u60c5\u51b5\u00b7\n\n[root@localhost ~]# netstat -an | grep 3306   //\u67e5\u770b\u6240\u67093306\u7aef\u53e3\u4f7f\u7528\u60c5\u51b5\u00b7\n\n[root@localhost ~]# netstat -nlp |grep LISTEN   //\u67e5\u770b\u5f53\u524d\u6240\u6709\u76d1\u542c\u7aef\u53e3\u00b7\n</code></pre> <p>\u67e5\u770b\u5f53\u524d\u6240\u6709tcp\u7aef\u53e3\u4f7f\u7528\u60c5\u51b5\uff1a</p> <p></p> <p>\u8fd9\u91cc\u89e3\u91ca\u4e00\u4e0b\uff1a</p> <ol> <li><code>0.0.0.0</code>\u4ee3\u8868\u672c\u673a\u4e0a\u53ef\u7528\u7684\u4efb\u610f\u5730\u5740\u3002 \u6bd4\u5982<code>0.0.0.0:135</code> \u8868\u793a\u672c\u673a\u4e0a\u6240\u6709\u5730\u5740\u7684135\u7aef\u53e3\uff0c\u8fd9\u6837\u591aip\u8ba1\u7b97\u673a\u5c31\u4e0d\u7528\u91cd\u590d\u663e\u793a\u4e86\u3002</li> <li><code>TCP 0.0.0.0:80</code>\u8868\u793a\u5728\u6240\u6709\u7684\u53ef\u7528\u63a5\u53e3\u4e0a\u76d1\u542cTCP80\u7aef\u53e3</li> <li><code>0.0.0.0</code>\u4e3a\u9ed8\u8ba4\u8def\u7531\uff0c\u5373\u8981\u5230\u8fbe\u4e0d\u518d\u8def\u7531\u8868\u91cc\u9762\u7684\u7f51\u6bb5\u7684\u5305\u90fd\u8d700.0.0.0\u8fd9\u6761\u89c4\u5219</li> </ol> <p>\u7136\u540e127.0.0.1\u5c31\u662f\u8868\u793a\u4f60\u672c\u673aip\u5730\u5740\u7684\u610f\u601d\u4e86\u3002</p> <p>\u7136\u540e<code>[::]:21</code>\u8fd9\u53c8\u662f\u4ec0\u4e48\u9b3c\uff1f</p> <p>\u8fd9\u4e2a\u8868\u793aipv6\u768421\u53f7\u7aef\u53e3\u7684\u610f\u601d\u3002</p> <p>\u8fd8\u6709UDP\u7684\u5916\u90e8\u94fe\u63a5\u600e\u4e48\u90fd\u662f<code>*:*</code>\u5462\uff1f</p> <p><code>*\uff1a*</code>\u662f\u7f51\u5740\u7684\u901a\u914d\u7b26\uff0c\u5c31\u662f<code>192.168.15.12</code>\uff0c\u8fd9\u4e2a\u7c7b\u578b\u7684\u6574\u4f53\u63cf\u8ff0\u3002</p> <p>\u89e3\u91ca\u4e00\u4e0b\u72b6\u6001\uff08state\uff09\u4e86</p>"},{"location":"chap7/1Ms/#state","title":"State","text":"<ul> <li>LISTEN\uff1a(Listening for a connection.)  \u4fa6\u542c\u6765\u81ea\u8fdc\u65b9\u7684TCP\u7aef\u53e3\u7684\u8fde\u63a5\u8bf7\u6c42</li> <li>SYN-SENT\uff1a(Active; sent SYN. Waiting for a matching connection request after having sent a connection request.)  \u518d\u53d1\u9001\u8fde\u63a5\u8bf7\u6c42\u540e\u7b49\u5f85\u5339\u914d\u7684\u8fde\u63a5\u8bf7\u6c42</li> <li>SYN-RECEIVED\uff1a(Sent and received SYN. Waiting for a confirming connection request acknowledgment after having both received and sent connection requests.)\u518d\u6536\u5230\u548c\u53d1\u9001\u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42\u540e\u7b49\u5f85\u5bf9\u65b9\u5bf9\u8fde\u63a5\u8bf7\u6c42\u7684\u786e\u8ba4</li> <li>ESTABLISHED\uff1a(Connection established.)\u4ee3\u8868\u4e00\u4e2a\u6253\u5f00\u7684\u8fde\u63a5</li> <li>FIN-WAIT-1\uff1a(Closed; sent FIN.)\u7b49\u5f85\u8fdc\u7a0bTCP\u8fde\u63a5\u4e2d\u65ad\u8bf7\u6c42\uff0c\u6216\u5148\u524d\u7684\u8fde\u63a5\u4e2d\u65ad\u8bf7\u6c42\u7684\u786e\u8ba4</li> <li>FIN-WAIT-2\uff1a(Closed; FIN is acknowledged; awaiting FIN.)\u4ece\u8fdc\u7a0bTCP\u7b49\u5f85\u8fde\u63a5\u4e2d\u65ad\u8bf7\u6c42</li> <li>CLOSE-WAIT\uff1a(Received FIN; waiting to receive CLOSE.)\u7b49\u5f85\u4ece\u672c\u5730\u7528\u6237\u53d1\u6765\u7684\u8fde\u63a5\u4e2d\u65ad\u8bf7\u6c42</li> <li>CLOSING\uff1a(Closed; exchanged FIN; waiting for FIN.)\u7b49\u5f85\u8fdc\u7a0bTCP\u5bf9\u8fde\u63a5\u4e2d\u65ad\u7684\u786e\u8ba4</li> <li>LAST-ACK\uff1a(Received FIN and CLOSE; waiting for FIN ACK.)\u7b49\u5f85\u539f\u6765\u7684\u53d1\u5411\u8fdc\u7a0bTCP\u7684\u8fde\u63a5\u4e2d\u65ad\u8bf7\u6c42\u7684\u786e\u8ba4</li> <li>TIME-WAIT\uff1a(In 2 MSL (twice the maximum segment length) quiet wait after close. )\u7b49\u5f85\u8db3\u591f\u7684\u65f6\u95f4\u4ee5\u786e\u4fdd\u8fdc\u7a0bTCP\u63a5\u6536\u5230\u8fde\u63a5\u4e2d\u65ad\u8bf7\u6c42\u7684\u786e\u8ba4</li> <li>CLOSED\uff1a(Connection is closed.)\u6ca1\u6709\u4efb\u4f55\u8fde\u63a5\u72b6\u6001</li> </ul> <p>\u4f8b\u5982\u8981\u67e5\u770b\u5f53\u524dMysql\u9ed8\u8ba4\u7aef\u53e380\u662f\u5426\u542f\u52a8\u53ef\u4ee5\u505a\u5982\u4e0b\u64cd\u4f5c</p> <p></p> <p><code>netstat -ano</code>\u6765\u663e\u793a\u534f\u8bae\u7edf\u8ba1\u4fe1\u606f\u548cTCP/IP\u7f51\u7edc\u8fde\u63a5</p> <p><code>netstat -t/-u/-l/-r/-n</code>\u3010\u663e\u793a\u7f51\u7edc\u76f8\u5173\u4fe1\u606f,-t:TCP\u534f\u8bae,-u:UDP\u534f\u8bae,-l:\u76d1\u542c,-r:\u8def\u7531,-n:\u663e\u793aIP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u3011</p> <ul> <li><code>netstat -tlun</code>\u3010\u67e5\u770b\u672c\u673a\u76d1\u542c\u7684\u7aef\u53e3\u3011</li> <li><code>netstat -an</code>\u3010\u67e5\u770b\u672c\u673a\u6240\u6709\u7684\u7f51\u7edc\u3011</li> <li><code>netstat -rn</code>\u3010\u67e5\u770b\u672c\u673a\u8def\u7531\u8868\u3011</li> <li>\u5217\u51fa\u6240\u6709\u7aef\u53e3\uff1a<code>netstat -a</code> </li> <li>\u5217\u51fa\u6240\u6709\u7684TCP\u7aef\u53e3\uff1a<code>netstat -at</code> </li> <li>\u5217\u51fa\u6240\u6709\u7684UDP\u7aef\u53e3\uff1a<code>netstat -au</code> </li> <li>\u5217\u51fa\u6240\u6709\u5904\u4e8e\u76d1\u542c\u72b6\u6001\u7684socket\uff1a<code>netstat -l</code> </li> <li>\u5217\u51fa\u6240\u6709\u76d1\u542cTCP\u7aef\u53e3\u7684socket\uff1a<code>netstat -lt</code> </li> <li>\u5217\u51fa\u6240\u6709\u76d1\u542cUDP\u7aef\u53e3\u7684socket\uff1a<code>netstat -lu</code> </li> <li>\u627e\u51fa\u7a0b\u5e8f\u8fd0\u884c\u7684\u7aef\u53e3\uff1a<code>netstat -ap | grep ssh</code> </li> <li>\u627e\u51fa\u8fd0\u884c\u5728\u6307\u5b9a\u7aef\u53e3\u7684\u8fdb\u7a0b\uff1a<code>netstat -an | grep \u2018:80\u2019</code></li> </ul> <p>\u51e0\u4e2a\u6709\u7528\u67e5\u627e\uff1a</p> <pre><code>1.\u67e5\u627e\u8bf7\u6c42\u6570\u524d20\u4e2aIP\uff08\u5e38\u7528\u4e8e\u67e5\u627e\u653b\u6765\u6e90\uff09\uff1a\nnetstat -anlp|grep 80|grep tcp|awk '{print $5}'|awk -F: '{print $1}'|sort|uniq -c|sort -nr|head -n20\n\nnetstat -ant |awk '/:80/{split($5,ip,\u201d:\u201d);++A[ip[1]]}END{for(i in A) print A[i],i}' |sort -rn|head -n20\n\n2.\u7528tcpdump\u55c5\u63a280\u7aef\u53e3\u7684\u8bbf\u95ee\u770b\u770b\u8c01\u6700\u9ad8\ntcpdump -i eth0 -tnn dst port 80 -c 1000 | awk -F\u201d.\u201d '{print $1\u2033.\u201d$2\u2033.\u201d$3\u2033.\u201d$4}' | sort | uniq -c | sort -nr |head -20\n\n3.\u67e5\u627e\u8f83\u591atime_wait\u8fde\u63a5\nnetstat -n|grep TIME_WAIT|awk '{print $5}'|sort|uniq -c|sort -rn|head -n20\n\n4.\u627e\u67e5\u8f83\u591a\u7684SYN\u8fde\u63a5\nnetstat -an | grep SYN | awk '{print $5}' | awk -F: '{print $1}' | sort | uniq -c | sort -nr | more\n\n5.\u6839\u636e\u7aef\u53e3\u5217\u8fdb\u7a0b\nnetstat -ntlp | grep 80 | awk '{print $7}' | cut -d/ -f1\n</code></pre>"},{"location":"chap7/1Ms/#2pause","title":"2\u3001pause\u5bb9\u5668\u7684\u79d8\u5bc6","text":"<ul> <li>\u9ad8\u5ea6\u8026\u5408\u7684\u5bb9\u5668\u95f4\u7684\u901a\u4fe1\u95ee\u9898</li> <li>Pod\u4e0ePod\u4e4b\u95f4\u7684\u901a\u4fe1</li> <li>Pod\u548cService\u4e4b\u95f4\u7684\u901a\u4fe1</li> <li>\u5916\u90e8\u7cfb\u7edf\u548cService\u4e4b\u95f4\u7684\u901a\u4fe1</li> </ul> <p>\u79d8\u5bc6\u5c31\u5728Pause\u5bb9\u5668\u3002K8s\u7684pause\u5bb9\u5668\u6709\u4e24\u5927\u4f5c\u7528\uff1a</p> <ul> <li>\u5b83\u4f5c\u4e3aPod\u5185\u7684\u201c\u7cfb\u7edf\u5bb9\u5668\u201d\uff0c\u63d0\u4f9b\u4e00\u4e2a\u57fa\u7840\u7684Linux Namespace\uff0c\u4ee5\u4f9b\u5176\u5b83\u7528\u6237\u5bb9\u5668\u52a0\u5165\u3002</li> <li>\u5982\u679c\u5f00\u542f\u4e86PID Namespace\u5171\u4eab\u7684\u8bdd\uff0c\u5b83\u8fd8\u4f5c\u4e3aPod\u7684\u201cinit\u8fdb\u7a0b\u201d\uff08pid=1\uff0c\u4e5f\u5373\u6240\u6709\u5176\u5b83\u5bb9\u5668\u7684\u7236\u5bb9\u5668\uff0c\u6240\u6709\u5176\u5b83\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\uff09\uff0c\u8d1f\u8d23\u50f5\u5c38\u8fdb\u7a0b\u7684\u56de\u6536\u3002</li> </ul>"},{"location":"chap7/1Ms/#2-1-1namespace","title":"2-1 \u529f\u80fd1\uff1a\u5171\u4eabNamespace","text":"<p>\u5728Linux\u7cfb\u7edf\u4e2d\uff0c\u5f53\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5b50\u8fdb\u7a0b\u7684\u65f6\u5019\uff0c\u8be5\u8fdb\u7a0b\u5c31\u4f1a\u7ee7\u627f\u7236\u8fdb\u7a0b\u7684Namespace\uff0cK8s\u7684Pod\u5c31\u662f\u6a21\u62df\u8fd9\u79cd\u65b9\u5f0f\u3002</p> <p>\u521b\u5efaPod\u65f6\uff0c\u91cc\u9762\u7b2c\u4e00\u4e2a\u88ab\u521b\u5efa\u7684\u5bb9\u5668\u6c38\u8fdc\u90fd\u662fpause\u5bb9\u5668\uff08\u53ea\u4e0d\u8fc7\u662f\u7cfb\u7edf\u81ea\u52a8\u521b\u5efa\u7684\uff09\uff0cpause\u5bb9\u5668\u521b\u5efa\u597d\u4e4b\u540e\uff0c\u624d\u4f1a\u521b\u5efa\u7528\u6237\u5bb9\u5668\u3002</p> <p>\u7cfb\u7edf\uff08CRI\u548cCNI\uff09\u4f1a\u4e3apause\u5bb9\u5668\u521b\u5efa\u597dNamespace\uff0c\u540e\u9762\u7684\u7528\u6237\u5bb9\u5668\u90fd\u52a0\u5165pause\u7684Namespace\uff0c\u8fd9\u6837\u5927\u5bb6\u5c31\u5904\u4e8e\u540c\u4e00\u4e2aNamespace\u4e86\uff0c\u7c7b\u4f3c\u4e8e\u5927\u5bb6\u90fd\u5728\u4e00\u4e2a\u201c\u865a\u62df\u673a\u201d\u91cc\u9762\u90e8\u7f72\u3002\u5bf9\u4e8e\u7f51\u7edc\u800c\u8a00\uff0c\u5c31\u662f\u5171\u4eabNetwork Namespace\u4e86\u3002\u4e0b\u9762\u7528docker\u6a21\u62df\u4e00\u4e0bk8s\u7684Pod\u8fc7\u7a0b\u3002</p> <p>\u7b2c\u4e00\u6b65\uff1a\u6a21\u62df\u521b\u5efaPod\u7684\u201c\u7cfb\u7edf\u5bb9\u5668\u201dpause\u5bb9\u5668\u3002</p> <pre><code>$ docker run -d --name pause -p 8080:80  --ipc=shareable  registry.aliyuncs.com/k8sxio/pause:3.2\n184cfffc577e032902a293bf1848f6353bd8a335f57d6b20625b96ebca8dfaa0\n\n\n$ docker ps -l\nCONTAINER ID        IMAGE                                    COMMAND             CREATED             STATUS              PORTS                  NAMES\n184cfffc577e        registry.aliyuncs.com/k8sxio/pause:3.2   \"/pause\"            13 seconds ago      Up 11 seconds       0.0.0.0:8080-&gt;80/tcp   pause\n</code></pre> <p>\u8fd9\u91cc\u7684\u64cd\u4f5c\u5c31\u662f\u521b\u5efa\u4e00\u4e2adocker\u5bb9\u5668\uff0c\u5e76\u5c06\u5bb9\u5668\u5185\u768480\u7aef\u53e3\u6620\u5c04\u5230\u5916\u90e8\u76848080\u7aef\u53e3\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\u4e3a\u4e86\u8ba9\u5176\u4ed6\u5bb9\u5668\u53ef\u4ee5\u5171\u4eab\u8be5\u5bb9\u5668\u7684<code>IPC Namespace</code>\uff0c\u9700\u8981\u589e\u52a0<code>--ipc=shareable</code>\u3002</p> <p>\u7b2c\u4e8c\u6b65\uff1a\u521b\u5efa\u201c\u7528\u6237\u5bb9\u5668\u201d nginx\u3002nginx\u9ed8\u8ba4\u662f\u76d1\u542c80\u7aef\u53e3\u7684\uff0c\u5148\u521b\u5efa\u4e00\u4e2a\u914d\u7f6e<code>nginx.conf</code>\uff1a</p> <pre><code>error_log stderr;\nevents { worker_connections  1024; }\nhttp {\n    access_log /dev/stdout combined;\n    server {\n         listen 80 default_server;\n         server_name example.com www.example.com;\n         location / {\n             proxy_pass http://127.0.0.1:2368;\n         }\n     }\n}\n</code></pre> <p>\u914d\u7f6e\u975e\u5e38\u7b80\u5355\uff0c\u5c06\u6240\u6709\u8bf7\u6c42\u8f6c\u53d1\u5230<code>127.0.0.1:2368</code>\u3002\u7136\u540e\u542f\u52a8nginx\u5bb9\u5668\uff0c\u4e0d\u8fc7\u8be5\u5bb9\u5668\u5171\u4eabpause\u5bb9\u5668\u7684Namespace\uff0c\u800c\u4e0d\u662f\u50cfdocker\u9ed8\u8ba4\u884c\u4e3a\u90a3\u6837\u521b\u5efa\u81ea\u5df1\u7684<code>Namespace</code>\uff1a</p> <pre><code>\u279c ~ docker run -d --name nginx -v `pwd`/nginx.conf:/etc/nginx/nginx.conf --net=container:pause --ipc=container:pause --pid=container:pause nginx\n660af561bc2d5936b3da727067ac30663780c5f7f73efe288b5838a5044c1331\n\n\n\u279c  nginx docker ps -l\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES\n660af561bc2d        nginx               \"/docker-entrypoint.\u2026\"   4 seconds ago       Up 3 seconds                            nginx\n</code></pre> <p>\u6b64\u65f6\uff0ccurl\u4e00\u4e0b\u672c\u673a\u76848080\uff08\u4e5f\u5c31\u662fpause\u5bb9\u5668\u768480\uff09\u7aef\u53e3\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <pre><code>\u279c  ~ curl 127.0.0.1:8080\n&lt;html&gt;\n&lt;head&gt;&lt;title&gt;502 Bad Gateway&lt;/title&gt;&lt;/head&gt;\n&lt;body&gt;\n&lt;center&gt;&lt;h1&gt;502 Bad Gateway&lt;/h1&gt;&lt;/center&gt;\n&lt;hr&gt;&lt;center&gt;nginx/1.19.6&lt;/center&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u4e5f\u5c31\u662f\u8bf4pause\u5bb9\u5668\u768480\u7aef\u53e3\u4e0a\u9762\u662fnginx\u670d\u52a1\uff0c\u8fd9\u662f\u56e0\u4e3a\u5b83\u4eec\u90fd\u5904\u4e8e\u4e00\u4e2a<code>Network Namespace</code>\u3002\u8fd9\u91cc\u62a5502\u662f\u56e0\u4e3a\u6211\u4eec\u518dnginx\u914d\u7f6e\u91cc\u9762\u914d\u4e86\u6240\u6709\u8bf7\u6c42\u90fd\u8f6c\u53d1\u52302368\u7aef\u53e3\uff0c\u4f46\u8fd9\u4e2a\u7aef\u53e3\u6ca1\u6709\u670d\u52a1\u76d1\u542c\u3002</p> <p>\u7b2c\u4e09\u6b65\uff1a\u518d\u521b\u5efa\u4e00\u4e2a\u201c\u7528\u6237\u5bb9\u5668\u201d ghost\uff08\u4e00\u4e2a\u535a\u5ba2\u7cfb\u7edf\uff0c\u9ed8\u8ba4\u76d1\u542c2368\u7aef\u53e3\uff09\uff1a</p> <pre><code>\u279c  ~ docker run -d --name ghost --net=container:nginx --ipc=container:nginx --pid=container:nginx ghost\nb455cb94dcec8a1896e55fc3ee9ac1133ba9f44440311a986a036efe09eb9227\n\u279c  ~ docker ps -l\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES\nb455cb94dcec        ghost               \"docker-entrypoint.s\u2026\"   4 seconds ago       Up 3 seconds                            ghost\n</code></pre> <p>\u5bb9\u5668\u542f\u52a8\u540e\uff0c\u6211\u4eec\u76f4\u63a5\u5728\u6d4f\u89c8\u5668\u8bbf\u95ee\u672c\u673a\u76848080\u7aef\u53e3\uff0c\u5c31\u53ef\u4ee5\u770b\u5230ghost\u7684web\u9875\u9762\u4e86\uff1a</p> <p>\u6b64\u65f6\uff0c\u9ad8\u5ea6\u8026\u5408\u7684\u4e24\u4e2a\u5bb9\u5668nginx+ghost\u5c31\u5728\u4e00\u4e2aNamespace\u91cc\u9762\u4e86\uff0c\u7279\u522b\u662f\u5904\u4e8e\u540c\u4e00\u4e2aNetwork Namespace\uff08\u53ef\u4ee5\u901a\u8fc7127.0.0.1\u76f8\u4e92\u8bbf\u95ee\uff09\uff0c\u8ba9\u4ed6\u4eec\u7684\u901a\u4fe1\u53d8\u5f97\u6781\u5176\u65b9\u4fbf\u3002\u5982\u679c\u518d\u52a0\u4e0apause\u5bb9\u5668\uff0c\u90a3\u4ed6\u4eec3\u4e2a\u5c31\u662fk8s\u91cc\u9762\u7684\u4e00\u4e2aPod\u4e86\u3002</p> <p></p> <p>\u597d\uff0c\u6700\u540e\u603b\u7ed3\u4e00\u4e0b\uff0c\u5f53\u6211\u4eec\u5728k8s\u91cc\u9762\u521b\u5efa\u5bb9\u5668\u65f6\uff0cCRI\uff08\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u6bd4\u5982docker\uff09\u548cCNI\uff08\u5bb9\u5668\u7f51\u7edc\u63a5\u53e3\uff0c\u8d1f\u8d23\u5bb9\u5668\u7f51\u7edc\uff09\u9996\u5148\u521b\u5efa\u597dpause\u5bb9\u5668\u8fd9\u4e2a\u7cfb\u7edf\u5bb9\u5668\uff0c\u8fd9\u5c31\u5305\u542b\u521b\u5efa\u5e76\u521d\u59cb\u5316\u5404\u79cdNamespace\uff08Network Namespace\u90e8\u5206\u7531CNI\u8d1f\u8d23\uff09\u3002\u4e4b\u540e\u518d\u521b\u5efa\u7528\u6237\u5bb9\u5668\uff0c\u7528\u6237\u5bb9\u5668\u52a0\u5165pause\u7684Namespace\u3002\u5176\u4e2dNetwork Namespace\u662f\u9ed8\u8ba4\u5c31\u5171\u4eab\u7684\uff0cPID Namespace\u5219\u9700\u8981\u770b\u914d\u7f6e\u3002</p>"},{"location":"chap7/1Ms/#3-http-and-https","title":"3. HTTP and HTTPS \u7684\u63e1\u624b\u8fc7\u7a0b","text":""},{"location":"chap7/1Ms/#3-1-http","title":"3-1 HTTP\u4e09\u6b21\u63e1\u624b","text":"<p>HTTP\uff08HyperText Transfer Protocol)\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\u662f\u4e92\u8054\u7f51\u4e0a\u5e94\u7528\u6700\u4e3a\u5e7f\u6cdb\u7684\u4e00\u79cd\u7f51\u7edc\u534f\u8bae\u3002\u7531\u4e8e\u4fe1\u606f\u662f\u660e\u6587\u4f20\u8f93\uff0c\u6240\u4ee5\u88ab\u8ba4\u4e3a\u662f\u4e0d\u5b89\u5168\u7684\u3002\u800c\u5173\u4e8eHTTP\u7684\u4e09\u6b21\u63e1\u624b\uff0c\u5176\u5b9e\u5c31\u662f\u4f7f\u7528\u4e09\u6b21TCP\u63e1\u624b\u786e\u8ba4\u5efa\u7acb\u4e00\u4e2aHTTP\u8fde\u63a5\u3002</p> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff0cSYN\uff08synchronous\uff09\u662fTCP/IP\u5efa\u7acb\u8fde\u63a5\u65f6\u4f7f\u7528\u7684\u63e1\u624b\u4fe1\u53f7\u3001Sequence number\uff08\u5e8f\u5217\u53f7\uff09\u3001Acknowledge number\uff08\u786e\u8ba4\u53f7\u7801\uff09\uff0c\u4e09\u4e2a\u7bad\u5934\u6307\u5411\u5c31\u4ee3\u8868\u4e09\u6b21\u63e1\u624b\uff0c\u5b8c\u6210\u4e09\u6b21\u63e1\u624b\uff0c\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u5f00\u59cb\u4f20\u9001\u6570\u636e\u3002</p> <p></p> <ul> <li>\u7b2c\u4e00\u6b21\u63e1\u624b\uff1a\u5ba2\u6237\u7aef\u53d1\u9001syn\u5305(syn=j)\u5230\u670d\u52a1\u5668\uff0c\u5e76\u8fdb\u5165<code>SYN_SEND</code>\u72b6\u6001\uff0c\u7b49\u5f85\u670d\u52a1\u5668\u786e\u8ba4\uff1b</li> <li>\u7b2c\u4e8c\u6b21\u63e1\u624b\uff1a\u670d\u52a1\u5668\u6536\u5230syn\u5305\uff0c\u5fc5\u987b\u786e\u8ba4\u5ba2\u6237\u7684<code>SYN\uff08ack=j+1</code>\uff09\uff0c\u540c\u65f6\u81ea\u5df1\u4e5f\u53d1\u9001\u4e00\u4e2a<code>SYN</code>\u5305\uff08syn=k\uff09\uff0c\u5373<code>SYN+ACK</code>\u5305\uff0c\u6b64\u65f6\u670d\u52a1\u5668\u8fdb\u5165<code>SYN_RECV</code>\u72b6\u6001\uff1b</li> <li>\u7b2c\u4e09\u6b21\u63e1\u624b\uff1a\u5ba2\u6237\u7aef\u6536\u5230\u670d\u52a1\u5668\u7684<code>SYN\uff0bACK</code>\u5305\uff0c\u5411\u670d\u52a1\u5668\u53d1\u9001\u786e\u8ba4\u5305<code>ACK(ack=k+1)</code>\uff0c\u6b64\u5305\u53d1\u9001\u5b8c\u6bd5\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u8fdb\u5165<code>ESTABLISHED</code>\u72b6\u6001\uff0c\u5b8c\u6210\u4e09\u6b21\u63e1\u624b\u3002</li> </ul>"},{"location":"chap7/1Ms/#3-2-https","title":"3-2 HTTPS\u63e1\u624b\u8fc7\u7a0b","text":"<p>HTTPS\u5728HTTP\u7684\u57fa\u7840\u4e0a\u52a0\u5165\u4e86SSL\u534f\u8bae\uff0cSSL\u4f9d\u9760\u8bc1\u4e66\u6765\u9a8c\u8bc1\u670d\u52a1\u5668\u7684\u8eab\u4efd\uff0c\u5e76\u4e3a\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u52a0\u5bc6\u3002\u5177\u4f53\u662f\u5982\u4f55\u8fdb\u884c\u52a0\u5bc6\uff0c\u89e3\u5bc6\uff0c\u9a8c\u8bc1\u7684\uff0c\u4e14\u770b\u4e0b\u56fe\uff0c\u4e0b\u9762\u7684\u79f0\u4e3a\u4e00\u6b21\u63e1\u624b\u3002</p> <p></p> <ol> <li>\u5ba2\u6237\u7aef\u53d1\u8d77HTTPS\u8bf7\u6c42</li> <li>\u670d\u52a1\u7aef\u7684\u914d\u7f6e<ul> <li>\u91c7\u7528HTTPS\u534f\u8bae\u7684\u670d\u52a1\u5668\u5fc5\u987b\u8981\u6709\u4e00\u5957\u6570\u5b57\u8bc1\u4e66\uff0c\u53ef\u4ee5\u662f\u81ea\u5df1\u5236\u4f5c\u6216\u8005CA\u8bc1\u4e66\u3002</li> <li>\u533a\u522b\u5c31\u662f\u81ea\u5df1\u9881\u53d1\u7684\u8bc1\u4e66\u9700\u8981\u5ba2\u6237\u7aef\u9a8c\u8bc1\u901a\u8fc7\uff0c\u624d\u53ef\u4ee5\u7ee7\u7eed\u8bbf\u95ee\uff0c</li> <li>\u800c\u4f7f\u7528CA\u8bc1\u4e66\u5219\u4e0d\u4f1a\u5f39\u51fa\u63d0\u793a\u9875\u9762\u3002\u8fd9\u5957\u8bc1\u4e66\u5176\u5b9e\u5c31\u662f\u4e00\u5bf9\u516c\u94a5\u548c\u79c1\u94a5\u3002</li> <li>\u516c\u94a5\u7ed9\u522b\u4eba\u52a0\u5bc6\u4f7f\u7528\uff0c\u79c1\u94a5\u7ed9\u81ea\u5df1\u89e3\u5bc6\u4f7f\u7528\u3002</li> </ul> </li> <li>\u4f20\u9001\u8bc1\u4e66<ul> <li>\u8fd9\u4e2a\u8bc1\u4e66\u5176\u5b9e\u5c31\u662f\u516c\u94a5\uff0c\u53ea\u662f\u5305\u542b\u4e86\u5f88\u591a\u4fe1\u606f\uff0c\u5982\u8bc1\u4e66\u7684\u9881\u53d1\u673a\u6784\uff0c\u8fc7\u671f\u65f6\u95f4\u7b49\u3002</li> </ul> </li> <li>\u5ba2\u6237\u7aef\u89e3\u6790\u8bc1\u4e66<ul> <li>\u8fd9\u90e8\u5206\u5de5\u4f5c\u662f\u6709\u5ba2\u6237\u7aef\u7684TLS\u6765\u5b8c\u6210\u7684\uff0c<ul> <li>\u9996\u5148\u4f1a\u9a8c\u8bc1\u516c\u94a5\u662f\u5426\u6709\u6548\uff0c\u6bd4\u5982\u9881\u53d1\u673a\u6784\uff0c\u8fc7\u671f\u65f6\u95f4\u7b49\uff0c</li> <li>\u5982\u679c\u53d1\u73b0\u5f02\u5e38\uff0c\u5219\u4f1a\u5f39\u51fa\u4e00\u4e2a\u8b66\u544a\u6846\uff0c\u63d0\u793a\u8bc1\u4e66\u5b58\u5728\u95ee\u9898\u3002</li> <li>\u5982\u679c\u8bc1\u4e66\u6ca1\u6709\u95ee\u9898\uff0c\u90a3\u4e48\u5c31\u751f\u6210\u4e00\u4e2a\u968f\u5373\u503c\uff0c\u7136\u540e\u7528\u8bc1\u4e66\u5bf9\u8be5\u968f\u673a\u503c\u8fdb\u884c\u52a0\u5bc6\u3002</li> </ul> </li> </ul> </li> <li>\u4f20\u9001\u52a0\u5bc6\u4fe1\u606f<ul> <li>\u8fd9\u90e8\u5206\u4f20\u9001\u7684\u662f\u7528\u8bc1\u4e66\u52a0\u5bc6\u540e\u7684\u968f\u673a\u503c\uff0c\u76ee\u7684\u5c31\u662f\u8ba9\u670d\u52a1\u7aef\u5f97\u5230\u8fd9\u4e2a\u968f\u673a\u503c\uff0c\u4ee5\u540e\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u7684\u901a\u4fe1\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u968f\u673a\u503c\u6765\u8fdb\u884c\u52a0\u5bc6\u89e3\u5bc6\u4e86\u3002</li> </ul> </li> <li>\u670d\u52a1\u6bb5\u89e3\u5bc6\u4fe1\u606f<ul> <li>\u670d\u52a1\u7aef\u7528\u79c1\u94a5\u89e3\u5bc6\u540e\uff0c\u5f97\u5230\u4e86\u5ba2\u6237\u7aef\u4f20\u8fc7\u6765\u7684\u968f\u673a\u503c(\u79c1\u94a5)\uff0c\u7136\u540e\u628a\u5185\u5bb9\u901a\u8fc7\u8be5\u503c\u8fdb\u884c\u5bf9\u79f0\u52a0\u5bc6\u3002</li> <li>\u6240\u8c13\u5bf9\u79f0\u52a0\u5bc6\u5c31\u662f\uff0c\u5c06\u4fe1\u606f\u548c\u79c1\u94a5\u901a\u8fc7\u67d0\u79cd\u7b97\u6cd5\u6df7\u5408\u5728\u4e00\u8d77\uff0c\u8fd9\u6837\u9664\u975e\u77e5\u9053\u79c1\u94a5\uff0c\u4e0d\u7136\u65e0\u6cd5\u83b7\u53d6\u5185\u5bb9\uff0c\u800c\u6b63\u597d\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u77e5\u9053\u8fd9\u4e2a\u79c1\u94a5\uff0c\u6240\u4ee5\u53ea\u8981\u52a0\u5bc6\u7b97\u6cd5\u591f\u5f6a\u608d\uff0c\u79c1\u94a5\u591f\u590d\u6742\uff0c\u6570\u636e\u5c31\u591f\u5b89\u5168\u3002</li> </ul> </li> <li>\u4f20\u8f93\u52a0\u5bc6\u540e\u7684\u4fe1\u606f<ul> <li>\u8fd9\u90e8\u5206\u4fe1\u606f\u662f\u670d\u52a1\u6bb5\u7528\u79c1\u94a5\u52a0\u5bc6\u540e\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u5728\u5ba2\u6237\u7aef\u88ab\u8fd8\u539f\u3002</li> </ul> </li> <li>\u5ba2\u6237\u7aef\u89e3\u5bc6\u4fe1\u606f<ul> <li>\u5ba2\u6237\u7aef\u7528\u4e4b\u524d\u751f\u6210\u7684\u79c1\u94a5\u89e3\u5bc6\u670d\u52a1\u6bb5\u4f20\u8fc7\u6765\u7684\u4fe1\u606f\uff0c\u4e8e\u662f\u83b7\u53d6\u4e86\u89e3\u5bc6\u540e\u7684\u5185\u5bb9\u3002</li> </ul> </li> </ol>"},{"location":"chap7/1Ms/#3-3-httpshttp","title":"3-3 HTTPS\u548cHTTP\u7684\u533a\u522b","text":"<ol> <li>https\u534f\u8bae\u9700\u8981\u5230ca\u7533\u8bf7\u8bc1\u4e66\u6216\u81ea\u5236\u8bc1\u4e66\u3002</li> <li>http\u7684\u4fe1\u606f\u662f\u660e\u6587\u4f20\u8f93\uff0chttps\u5219\u662f\u5177\u6709\u5b89\u5168\u6027\u7684ssl\u52a0\u5bc6\u3002</li> <li>http\u662f\u76f4\u63a5\u4e0eTCP\u8fdb\u884c\u6570\u636e\u4f20\u8f93\uff0c\u800chttps\u662f\u7ecf\u8fc7\u4e00\u5c42SSL\uff08OSI\u8868\u793a\u5c42\uff09\uff0c\u7528\u7684\u7aef\u53e3\u4e5f\u4e0d\u4e00\u6837\uff0c\u524d\u8005\u662f80\uff08\u9700\u8981\u56fd\u5185\u5907\u6848\uff09\uff0c\u540e\u8005\u662f443\u3002</li> <li>http\u7684\u8fde\u63a5\u5f88\u7b80\u5355\uff0c\u662f\u65e0\u72b6\u6001\u7684\uff1bHTTPS\u534f\u8bae\u662f\u7531SSL+HTTP\u534f\u8bae\u6784\u5efa\u7684\u53ef\u8fdb\u884c\u52a0\u5bc6\u4f20\u8f93\u3001\u8eab\u4efd\u8ba4\u8bc1\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u6bd4http\u534f\u8bae\u5b89\u5168\u3002</li> </ol> <p>\u6ce8\u610fhttps\u52a0\u5bc6\u662f\u5728\u4f20\u8f93\u5c42</p> <p>https\u62a5\u6587\u5728\u88ab\u5305\u88c5\u6210tcp\u62a5\u6587\u7684\u65f6\u5019\u5b8c\u6210\u52a0\u5bc6\u7684\u8fc7\u7a0b\uff0c\u65e0\u8bba\u662fhttps\u7684header\u57df\u4e5f\u597d\uff0cbody\u57df\u4e5f\u7f62\u90fd\u662f\u4f1a\u88ab\u52a0\u5bc6\u7684\u3002</p> <p>\u5f53\u4f7f\u7528tcpdump\u6216\u8005wireshark\u4e4b\u7c7b\u7684tcp\u5c42\u5de5\u5177\u6293\u5305\uff0c\u83b7\u53d6\u662f\u52a0\u5bc6\u7684\u5185\u5bb9\uff0c\u800c\u5982\u679c\u7528\u5e94\u7528\u5c42\u6293\u5305\uff0c\u4f7f\u7528Charels(Mac)\u3001Fildder(Windows)\u6293\u5305\u5de5\u5177\uff0c\u90a3\u5f53\u7136\u770b\u5230\u662f\u660e\u6587\u7684\u3002</p> <p>HTTPS\u4e00\u822c\u4f7f\u7528\u7684\u52a0\u5bc6\u4e0eHASH\u7b97\u6cd5\u5982\u4e0b\uff1a</p> <p>\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\uff1aRSA\uff0cDSA/DSS</p> <p>\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\uff1aAES\uff0cRC4\uff0c3DES</p> <p>HASH\u7b97\u6cd5\uff1aMD5\uff0cSHA1\uff0cSHA256</p>"},{"location":"chap7/1Ms/#4k8sservice","title":"4\u3001k8s\u521b\u5efaservice\u7684\u8fc7\u7a0b","text":"<ul> <li>\u901a\u8fc7kubectl\u63d0\u4ea4\u4e00\u4e2apod\u7684service\u521b\u5efa\u8bf7\u6c42</li> <li><code>Controller Manager</code>\u4f1a\u901a\u8fc7\u5bf9\u5e94\u7684<code>Label</code>\u6807\u7b7e\u67e5\u8be2\u5230\u76f8\u5173\u7684<code>pod</code>\u5b9e\u4f8b\uff0c\u751f\u6210<code>Serveice</code>\u7684<code>Endpoints</code>\u4fe1\u606f\uff0c\u5e76\u901a\u8fc7<code>API server</code>\u5199\u5165\u5230<code>etcd</code>\u952e\u503c\u5e93\u4e2d</li> <li><code>Worker Node</code>\u8282\u70b9\u4e0a\u7684<code>kube proxy</code>\u901a\u8fc7<code>API server</code>\u67e5\u8be2\u5e76\u76d1\u542c<code>service</code>\u5bf9\u8c61\u4e0e\u5176\u5bf9\u5e94\u7684<code>Endpoints</code>\u4fe1\u606f(\u670d\u52a1\u53d1\u73b0)\uff0c\u521b\u5efa\u4e00\u4e2a\u7c7b\u4f3c\u8d1f\u8f7d\u5747\u8861\u5668\u5b9e\u73b0Service\u8bbf\u95ee\u5230\u540e\u7aefPod\u7684\u6d41\u91cf</li> </ul>"},{"location":"chap7/1Ms/#5statefulsetdeployment","title":"5\u3001StatefulSet\u548cDeployment\u7684\u533a\u522b","text":"<p>\u201cDeployment\u7528\u4e8e\u90e8\u7f72\u65e0\u72b6\u6001\u670d\u52a1\uff0cStatefulSet\u7528\u6765\u90e8\u7f72\u6709\u72b6\u6001\u670d\u52a1\u201d\u3002</p> <p>5-1 \u65e0\u72b6\u6001\u7684\u5e94\u7528</p> <ul> <li>pod\u4e4b\u95f4\u6ca1\u6709\u987a\u5e8f</li> <li>\u6240\u6709pod\u5171\u4eab\u5b58\u50a8</li> <li>pod\u540d\u5b57\u5305\u542b\u968f\u673a\u6570\u5b57</li> <li>service\u90fd\u6709ClusterIP,\u53ef\u4ee5\u8d1f\u8f7d\u5747\u8861</li> </ul> <p>5-2 \u6709\u72b6\u6001\u7684\u5e94\u7528</p> <ul> <li>\u90e8\u7f72\u3001\u6269\u5c55\u3001\u66f4\u65b0\u3001\u5220\u9664\u90fd\u8981\u6709\u987a\u5e8f</li> <li>\u6bcf\u4e2apod\u90fd\u6709\u81ea\u5df1\u5b58\u50a8\uff0c\u6240\u4ee5\u90fd\u7528<code>volumeClaimTemplates</code>\uff0c\u4e3a\u6bcf\u4e2apod\u90fd\u751f\u6210\u4e00\u4e2a\u81ea\u5df1\u7684\u5b58\u50a8\uff0c\u4fdd\u5b58\u81ea\u5df1\u7684\u72b6\u6001</li> <li>pod\u540d\u5b57\u59cb\u7ec8\u662f\u56fa\u5b9a\u7684</li> <li>service\u6ca1\u6709<code>ClusterIP</code>\uff0c\u662f<code>headlessservice</code>\uff0c\u6240\u4ee5\u65e0\u6cd5\u8d1f\u8f7d\u5747\u8861\uff0c\u8fd4\u56de\u7684\u90fd\u662fpod\u540d\uff0c\u6240\u4ee5pod\u540d\u5b57\u90fd\u5fc5\u987b\u56fa\u5b9a\uff0c<ul> <li>StatefulSet\u5728Headless Service\u7684\u57fa\u7840\u4e0a\u53c8\u4e3aStatefulSet\u63a7\u5236\u7684\u6bcf\u4e2aPod\u526f\u672c\u521b\u5efa\u4e86\u4e00\u4e2aDNS\u57df\u540d:<code>$(podname).(headless server name).namespace.svc.cluster.local</code></li> </ul>"},{"location":"chap7/1Ms/#6docker","title":"6\u3001Docker \u6302\u8f7d\u70b9","text":"<p>\u867d\u7136\u6211\u4eec\u5df2\u7ecf\u901a\u8fc7 Linux \u7684\u547d\u540d\u7a7a\u95f4\u89e3\u51b3\u4e86\u8fdb\u7a0b\u548c\u7f51\u7edc\u9694\u79bb\u7684\u95ee\u9898\uff0c\u5728 Docker \u8fdb\u7a0b\u4e2d\u6211\u4eec\u5df2\u7ecf\u6ca1\u6709\u529e\u6cd5\u8bbf\u95ee\u5bbf\u4e3b\u673a\u5668\u4e0a\u7684\u5176\u4ed6\u8fdb\u7a0b\u5e76\u4e14\u9650\u5236\u4e86\u7f51\u7edc\u7684\u8bbf\u95ee\uff0c</p> <p>\u4f46\u662f <code>Docker</code> \u5bb9\u5668\u4e2d\u7684\u8fdb\u7a0b\u4ecd\u7136\u80fd\u591f\u8bbf\u95ee\u6216\u8005\u4fee\u6539\u5bbf\u4e3b\u673a\u5668\u4e0a\u7684\u5176\u4ed6\u76ee\u5f55\uff0c\u8fd9\u662f\u6211\u4eec\u4e0d\u5e0c\u671b\u770b\u5230\u7684\u3002</p> <ul> <li>\u5728\u65b0\u7684\u8fdb\u7a0b\u4e2d\u521b\u5efa\u9694\u79bb\u7684\u6302\u8f7d\u70b9\u547d\u540d\u7a7a\u95f4\u9700\u8981\u5728 <code>clone</code> \u51fd\u6570\u4e2d\u4f20\u5165 <code>CLONE_NEWNS</code>\uff0c\u8fd9\u6837\u5b50\u8fdb\u7a0b\u5c31\u80fd\u5f97\u5230\u7236\u8fdb\u7a0b\u6302\u8f7d\u70b9\u7684\u62f7\u8d1d\uff0c\u5982\u679c\u4e0d\u4f20\u5165\u8fd9\u4e2a\u53c2\u6570\u5b50\u8fdb\u7a0b\u5bf9\u6587\u4ef6\u7cfb\u7edf\u7684\u8bfb\u5199\u90fd\u4f1a\u540c\u6b65\u56de\u7236\u8fdb\u7a0b\u4ee5\u53ca\u6574\u4e2a\u4e3b\u673a\u7684\u6587\u4ef6\u7cfb\u7edf\u3002 <p>\u5982\u679c\u4e00\u4e2a\u5bb9\u5668\u9700\u8981\u542f\u52a8\uff0c\u90a3\u4e48\u5b83\u4e00\u5b9a\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u6839\u6587\u4ef6\u7cfb\u7edf\uff08<code>rootfs</code>\uff09\uff0c\u5bb9\u5668\u9700\u8981\u4f7f\u7528\u8fd9\u4e2a\u6587\u4ef6\u7cfb\u7edf\u6765\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8fdb\u7a0b\uff0c\u6240\u6709\u4e8c\u8fdb\u5236\u7684\u6267\u884c\u90fd\u5fc5\u987b\u5728\u8fd9\u4e2a\u6839\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002</p>"},{"location":"chap7/2Ms_al/","title":"2 Microsoft Interview Algorithm 2021","text":""},{"location":"chap7/2Ms_al/#1find-the-kth-smallest-element-in-a-given-a-binary-search-tree-bst","title":"1\u3001Find the kth smallest element in a given a binary search tree (BST)","text":"<p>Write a Python program to find the kth smallest element in a given a binary search tree.</p> <pre><code>class TreeNode(object):\n    def __init__(self, x):\n        self.val = x\n        self.left = None\n        self.right = None\n\ndef kth_smallest(root, k):\n    stack = []\n    while root or stack:\n        while root:\n            stack.append(root)\n            root = root.left\n        root = stack.pop()\n        k -= 1\n        if k == 0:\n            break\n        root = root.right\n    return root.val\n\nroot = TreeNode(8)  \nroot.left = TreeNode(5)  \nroot.right = TreeNode(14) \nroot.left.left = TreeNode(4)  \nroot.left.right = TreeNode(6) \nroot.left.right.left = TreeNode(8)  \nroot.left.right.right = TreeNode(7)  \nroot.right.right = TreeNode(24) \nroot.right.right.left = TreeNode(22)  \n\nprint(kth_smallest(root, 2))\nprint(kth_smallest(root, 3))\n</code></pre> <pre><code>5\n8\n</code></pre> <p></p>"},{"location":"chap7/2Ms_al/#2","title":"2\u3001\u6700\u957f\u516c\u5171\u524d\u7f00","text":"<p>\u7f16\u5199\u4e00\u4e2a\u51fd\u6570\u6765\u67e5\u627e\u5b57\u7b26\u4e32\u6570\u7ec4\u4e2d\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u3002</p> <p>\u5982\u679c\u4e0d\u5b58\u5728\u516c\u5171\u524d\u7f00\uff0c\u8fd4\u56de\u7a7a\u5b57\u7b26\u4e32 \"\"\u3002</p> <pre><code>\u793a\u4f8b 1:\n\n\u8f93\u5165: [\"flower\",\"flow\",\"flight\"]\n\u8f93\u51fa: \"fl\"\n\u793a\u4f8b 2:\n\n\u8f93\u5165: [\"dog\",\"racecar\",\"car\"]\n\u8f93\u51fa: \"\"\n\u89e3\u91ca: \u8f93\u5165\u4e0d\u5b58\u5728\u516c\u5171\u524d\u7f00\u3002\n\u8bf4\u660e:\n\n\u6240\u6709\u8f93\u5165\u53ea\u5305\u542b\u5c0f\u5199\u5b57\u6bcd a-z \u3002\n</code></pre> <p>\u5229\u7528python\u4e2d\u7684<code>zip()</code>\u51fd\u6570\uff0c\u53d6\u5217\u8868\u4e0a\u6bcf\u4e2a\u5b57\u7b26\u4e32\u4e0a\u6bcf\u4e00\u4e2a\u4f4d\u7684\u5b57\u6bcd\uff0c\u6bd4\u8f83\u540c\u4e00\u4f4d\u7f6e\u4e0a\u7684\u5b57\u6bcd\u662f\u5426\u76f8\u540c\u6765\u8ba1\u7b97\u6700\u957f\u7684\u516c\u5171\u524d\u7f00\u3002</p> <pre><code>names = ['Bruce', 'Clark', 'Peter', 'Logan', 'Wade']\nheros = ['Batman', 'Superman', 'Spiderman', 'Wolverine', 'Deadpool']\nprint(list(zip(names, heros)))\n\n# {'Bruce': 'Batman', 'Clark': 'Superman', 'Peter': 'Spiderman', 'Logan': 'Wolverine', 'Wade': 'Deadpool'}\n</code></pre> <pre><code>names = ['Bruce', 'Clark', 'Peter', 'Logan', 'Wade']\nprint(list(zip(*names)))\n\n# [('B', 'C', 'P', 'L', 'W'), ('r', 'l', 'e', 'o', 'a'), ('u', 'a', 't', 'g', 'd'), ('c', 'r', 'e', 'a', 'e')]\n\na = [\"ab\",\"ab\",\"abc\"]\nprint(list(zip(*a)))\n\n# [('a', 'a', 'a'), ('b', 'b', 'b')]\n</code></pre> <pre><code>b = \"\"\nfor j in list(zip(*a)):\n    # print(j)\n    if len(set(j)) == 1:\n        b += j[0]\n    else:\n        break\nprint(b)\n\n# ab\n</code></pre> <pre><code>def longest_string(arr):\n    result = \"\"\n    for i in zip(*arr):\n        if len(set(i)) == 1:\n            result += i[0]\n        else:\n            break\n    return result\n\narr = [\"a\",\"ab\",\"abc\"]\nprint(longest_string(arr))\n</code></pre> <p><code>*arr</code>: all arr </p> <p>\u53d6\u5217\u8868\u4e2d\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32s0\uff0c\u904d\u5386\u540e\u5e8f\u5b57\u7b26\u4e32\uff0c\u770bs0\u4e0e\u5b57\u7b26\u4e32\u76f8\u540c\u7684\u6700\u957f\u524d\u7f00\u662f\u591a\u5c11\u3002</p> <pre><code>def longest_str(str):\n    if not str:\n        return \"\"\n    res = str[0]\n    i = 1\n    while i &lt; len(str):\n        while str[i].find(res) != 0:\n            res = res[0:len(res)-1]\n        i += 1\n    return res\n\nprint(longest_str([\"aabc\",\"ab\"]))\n</code></pre> <pre><code>$ python3 a2.py \nab\n</code></pre>"},{"location":"chap7/2Ms_al/#3-two-sum","title":"3\u3001\u4e24\u6570\u4e4b\u548c Two Sum","text":"<p>\u7ed9\u5b9a\u4e00\u4e2a\u6574\u6570\u6570\u7ec4 nums \u548c\u4e00\u4e2a\u76ee\u6807\u503c target\uff0c\u8bf7\u4f60\u5728\u8be5\u6570\u7ec4\u4e2d\u627e\u51fa\u548c\u4e3a\u76ee\u6807\u503c\u7684\u90a3 \u4e24\u4e2a \u6574\u6570\uff0c\u5e76\u8fd4\u56de\u4ed6\u4eec\u7684\u6570\u7ec4\u4e0b\u6807\u3002</p> <p>\u4f60\u53ef\u4ee5\u5047\u8bbe\u6bcf\u79cd\u8f93\u5165\u53ea\u4f1a\u5bf9\u5e94\u4e00\u4e2a\u7b54\u6848\u3002\u4f46\u662f\uff0c\u4f60\u4e0d\u80fd\u91cd\u590d\u5229\u7528\u8fd9\u4e2a\u6570\u7ec4\u4e2d\u540c\u6837\u7684\u5143\u7d20\u3002</p> <p>\u793a\u4f8b:</p> <pre><code>\u7ed9\u5b9a nums = [2, 7, 11, 15], target = 9\n\u56e0\u4e3a nums[0] + nums[1] = 2 + 7 = 9\n\u6240\u4ee5\u8fd4\u56de [0, 1]\n</code></pre>"},{"location":"chap7/2Ms_al/#3-1-pythonenumerate","title":"3-1 \u5173\u4e8ePython\u7684<code>enumerate()</code>\u7684\u7528\u6cd5","text":"<pre><code>a = [3,4,5,6]\nfor i, num in a:\n    print(i, num)\n</code></pre> <p><code>TypeError: 'int' object is not iterable</code></p> <pre><code>a = [3,4,5,6]\nfor i, num in enumerate(a):\n    print(i, num)\n</code></pre> <pre><code>(0, 3)\n(1, 4)\n(2, 5)\n(3, 6)\n</code></pre> <pre><code>def twoSum(nums, target):\n    \"\"\"\n    :type nums: List[int]\n    :type target: int\n    :rtype: List[int]\n    \"\"\"\n    idxDict = dict()\n    for idx, num in enumerate(nums):\n        if target - num in idxDict:\n            return [idxDict[target - num], idx]\n        idxDict[num] = idx\n\n\nnums = [2, 7, 11, 15]\ntarget = 9\n\nprint(twoSum(nums,target))\n</code></pre> <pre><code>def two_sum(nums, target):\n    # idxDict = dict()\n    idxDict = {}\n    for idx, num in enumerate(nums):\n        if target - num in idxDict:    \n            return [idxDict[target - num], idx]\n            # return True\n            # return [idxDict[target - num]]\n        idxDict[num] = idx\n\nnums = [3, 2, 11, 15]\ntarget = 13   \nprint(two_sum(nums,target))\n</code></pre>"},{"location":"chap7/2Ms_al/#output-two-values-from-two-sum","title":"Output two values from two sum","text":"<p>Naive Solution</p> <pre><code>def twoSumNaive(num_arr, pair_sum):\n    # search first element in the array\n    for i in range(len(num_arr)-1):\n        # search other element in the array\n        for j in range(i + 1, len(num_arr)):\n        # if these two elemets sum to pair_sum, print the pair\n            if num_arr[i] + num_arr[j] == pair_sum:\n                print(\"Pair with sum\", pair_sum,\"is: (\", num_arr[i],\",\",num_arr[j],\")\")\n                print([i,j])\n\n# Driver Code\nnum_arr = [3, 5, 2, -4, 8, 11]\npair_sum = 7\n\n# Function call inside print\ntwoSumNaive(num_arr, pair_sum) \n\n# Pair with sum 7 is: ( 5 , 2 )\n# [1, 2]\n# Pair with sum 7 is: ( -4 , 11 )\n# [3, 5]\n</code></pre> <p>Optimal Solution hashtable</p> <pre><code>def twoSumHashing(num_arr, pair_sum):\n    sums = []\n    hashTable = {}\n\n    for i in range(len(num_arr)):\n        complement = pair_sum - num_arr[i]\n        if complement in hashTable:\n            print(\"Pair with sum\", pair_sum,\"is: (\", num_arr[i],\",\",complement,\")\")\n            # print([i,hashTable[pair_sum - num_arr[i]]])\n        hashTable[num_arr[i]] = num_arr[i]\n\n# Driver Code\nnum_arr = [4, 5, 1, 8]\npair_sum = 9\n\n# Calling function\ntwoSumHashing(num_arr, pair_sum)\n</code></pre> <pre><code>Pair with sum 9 is: ( 5 , 4 )\nPair with sum 9 is: ( 8 , 1 )\n</code></pre>"},{"location":"chap7/3ubs/","title":"3 UBS interview","text":""},{"location":"chap7/3ubs/#database-sql","title":"Database &amp; SQL","text":""},{"location":"chap7/3ubs/#1-sql-datatypes","title":"1. SQL Datatypes","text":"<p>Which of the below is NOT data type in a SQL database? </p> <ul> <li>DATE </li> <li>NUMBER </li> <li>VARCHAR2 </li> <li>STRING </li> </ul> <p>varchar =&gt; string(not exist)</p>"},{"location":"chap7/3ubs/#2-sql-joins","title":"2. SQL joins","text":"<p>Which of the following JOINs are valid in SQL statements? </p> <ul> <li>LEFT JOIN</li> <li>BOTH JOIN </li> <li>RIGHT JOIN</li> <li>FULL JOIN </li> <li>CROSS JOIN </li> <li>MIX JOIN </li> <li>JOIN </li> <li>SELF JOIN </li> </ul>"},{"location":"chap7/3ubs/#3-sql-delete","title":"3. SQL DELETE","text":"<p>Which of the following are correct statements about DELETE? </p> <ul> <li>Remove the blocks in database </li> <li>Rollback is not allowed after DELETE </li> <li>Delete entire database </li> <li>Remove column(s) from a table and then commit or rollback </li> <li>Remove row(s) from a table and then commit or rollback </li> </ul>"},{"location":"chap7/3ubs/#4-sql-select","title":"4. SQL Select","text":"<p>Here is EMPLOYEE table </p> <pre><code>Name \nAnnie \nBob\nCallie \nDerek \n</code></pre> <p>which of these queries will display the complete contents of the table? </p> <ul> <li>Select name from employee </li> <li>Select name </li> <li>Select * from employee </li> <li>Select employee </li> </ul>"},{"location":"chap7/3ubs/#5-sql-equi-joins","title":"5. SQL equi-joins","text":"<p>Select all correct answers if the query is equi-join? </p> <ul> <li>select * from TABLE1 t1 where t1.id &gt;= 2 </li> <li>select * from TABLE1 t1, TABLE2 t2 where t1.id = t2.id </li> <li>select * from TABLE1 t1 where t1.id = 2 and t1.id = 45 </li> <li>select * from TABLE2 t2 join TABLE1 t1 on t1.id = t2.id</li> </ul> <pre><code>SELECT column_list \nFROM table1, table2....\nWHERE table1.column_name =\ntable2.column_name; \n</code></pre> <pre><code>SELECT *\nFROM table1 \nJOIN table2\n[ON (join_condition)]\n</code></pre>"},{"location":"chap7/3ubs/#6-sql-syntax","title":"6. SQL syntax","text":"<p>In which sequence need the following elements of an simple SQL query which is not joining tables be? </p> <ol> <li>ORDER BY </li> <li>GROUP BY </li> <li>SELECT </li> <li>WHERE </li> <li>FROM </li> <li> <p>HAVING </p> </li> <li> <p>SELECT, HAVING, FROM, WHERE, GROUP BY, ORDER BY </p> </li> <li>SELECT, FROM, WHERE, HAVING, GROUP BY, ORDER BY </li> <li>SELECT, FROM, WHERE, HAVING, ORDER BY, GROUP BY </li> <li>SELECT, FROM, HAVING, WHERE, ORDER BY, GROUP BY </li> <li>SELECT, FROM, WHERE, GROUP BY, HAVING, ORDER BY</li> </ol>"},{"location":"chap7/3ubs/#7-sql-syntax","title":"7. SQL syntax","text":"<p>Which are the correct SQL statements to extract the names of those who have at least once won a race? </p> <ul> <li>select winner from races </li> <li>select distinct winner from races </li> <li>select unique winner from races </li> <li>select winner from races having winner = UNIQUE </li> </ul> <p>8. SQL remove data</p> <p>Which of the following SQL statements will delete all rows in a table **without deleting the table? **</p> <ul> <li>DELETE FROM table_name; </li> <li>DELETE TABLE table_name; </li> <li>DROP TABLE table_name;      [\u5220\u9664\u8868\u7ed3\u6784]  </li> <li>TRUNCATE table_name;    [\u6e05\u7a7a\u8868\u7ed3\u6784] </li> </ul> <p>9. SQL Trigger</p> <p>Is it possible to create trigger on views? </p> <ul> <li>Yes </li> <li>No </li> </ul> <p>10. SQL Trigger</p> <p>What are the difference between Trigger and Stored Procedure? Choose which are correct only </p> <ul> <li>Trigger is run automatically if the event is occured but Stored Procedure don't run automatically but you have to run it manually </li> <li>Trigger execute implicitly whereas store procedure execute via procedure call from another block. </li> <li>Within a Stored Procedure you can call specific trigger but within a Trigger you cannot call Stored Procedure </li> <li>We can call a stored procedure from front end (.asp files, .aspx files, .ascx files etc.) but we can't call a trigger from these files. </li> <li>Stored procedure can take the input parameters, but we can't pass the parameters as an input to a trigger</li> </ul>"},{"location":"chap7/3ubs/#11-sql-query-one-table-1","title":"11. SQL Query one table 1","text":"<p>A table called \"CONSULTANT\" is populated with below records.</p> <p></p> <p>Which of the following query returns the full name of the consultants whose name starts with \"A\"? </p> <p>Pick ONE option </p> <ul> <li><code>select ID from CONSULTANT where FULL_NAME ='%A'</code> </li> <li><code>select FIRST_NAME from CONSULTANT where ID = '%A'</code></li> <li><code>select * from CONSULTANT where FULL_NAME = '%A%'</code> </li> <li><code>select FULL_NAME from CONSULTANT where FULL_NAME like 'A%'</code> </li> <li><code>select FULL_NAME from CONSULTANT where FULL_NAME = 'A%'</code> </li> <li><code>select ID from CONSULTANT where FULL_NAME = 'A*'</code> </li> <li><code>select ID from CONSULTANT where FULL_NAME matches 'A.*'</code> </li> <li><code>select ID from CONSULTANT where FULL_NAME like 'A*'</code> </li> </ul>"},{"location":"chap7/3ubs/#12-sql-primary-key","title":"12 SQL Primary Key","text":"<p>Which is/are correct statements about primary key of a table? </p> <p>Pick ONE OR MORE options </p> <ul> <li>Primary keys can contain NULL values</li> <li>Primary keys cannot contain NULL values.</li> <li>A table can have only one primary key </li> <li>A table can have multiple primary keys with single or multiple fields </li> <li>None of the above </li> </ul> <p>Primary keys must contain unique values. </p> <p>A primary key column cannot have NULL values. </p> <p>A table can have only one primary key, which may consist of single or multiple fields. </p> <p>When multiple fields are used as a primary key, they are called a composite key.</p>"},{"location":"chap7/3ubs/#13-sql-primary-key","title":"13. SQL Primary Key","text":"<p>Which statements are WRONG about PRIMARY KEY constraint in SQL? </p> <p>Pick ONE option </p> <ul> <li>The PRIMARY KEY uniquely identifies each record in a SQL database table </li> <li>Primary key can be made based on multiple columns </li> <li>Primary key must be made of a single column </li> <li>Primary keys must contain unique values. </li> <li>None of the above </li> </ul>"},{"location":"chap7/3ubs/#14-sql-data-manipulate-language","title":"14. SQL Data Manipulate Language","text":"<p>Which of the following is considered DML (Data Manipulate Language)? </p> <p>Pick ONE OR MORE options </p> <ul> <li>SELECT </li> <li>ALTER </li> <li>CREATE </li> <li>INSERT</li> <li>UPDATE</li> </ul> <p>https://chao-xi.github.io/jxdatabasebook/db_ops/17ops_review/#dml</p> <p><code>insert \\ delete \\ update</code></p>"},{"location":"chap7/3ubs/#15-primary-key","title":"15. Primary Key","text":"<p>Which is/are correct statements about primary key of a table? </p> <p>Pick ONE OR MORE options </p> <ul> <li>Primary keys can contain NULL values </li> <li>Primary keys cannot contain NULL values. </li> <li>A table can have only one primary key with single or multiple fields </li> <li>A table can have multiple primary keys with single or multiple fields </li> </ul>"},{"location":"chap7/3ubs/#16-sql-trigger","title":"16 SQL Trigger","text":"<p>Which one is not a type of Trigger? </p> <p>Pick ONE option </p> <ul> <li>AFTER UPDATE Trigger </li> <li>AFTFR INSERT Trigger</li> <li>AFTER DELETE Trigger </li> <li>AFTER ALERT Trigger </li> </ul>"},{"location":"chap7/3ubs/#17-sql-update","title":"17. SQL Update","text":"<p>Which of the following statements about the SQL UPDATE command are wrong? </p> <p>Pick ONE option </p> <ul> <li>If a WHERE clause is miccina in the ctAtPmpnt then all records will be updated. </li> <li>Only one record can be updated at a time using WHERE clause </li> <li>Multiple records can be updated at a time using WHERE clause </li> <li>None of the above </li> </ul>"},{"location":"chap7/3ubs/#18-sql-trigger","title":"18 SQL Trigger","text":"<p>When do we use triggers? </p> <p>Pick ONE option </p> <ul> <li>To maintain complex integrity constraints </li> <li>Auditing table information by recording the changes </li> <li>Signaling other program actions when changes are made to the table </li> <li>Enforcing complex business rules </li> <li>All above (a, b, c. d ) </li> </ul> <p>Create an audit trail of activity in the database. ...</p> <p>Implement a business rule. ...</p> <p>Derive additional data that is not available within a table or within the database. ...</p> <p>Enforce referential integrity.</p>"},{"location":"chap7/3ubs/#task-management","title":"Task Management","text":""},{"location":"chap7/3ubs/#1-problem-management","title":"1. problem management","text":"<p>Which Process is responsible for eliminating recurring incidents and minimizing the impact of incidents that cannot be prevented? </p> <p>Pick ONE option </p> <ul> <li>service level management </li> <li>problem management </li> <li>change management </li> <li>event management </li> </ul>"},{"location":"chap7/3ubs/#2-service-operations","title":"2. Service Operations","text":"<p>____ is an unplanned interruption to an IT Service or reduction in the quality of an IT service. </p> <p>Pick ONE option </p> <ul> <li>Event </li> <li>Problem </li> <li>Incident </li> <li>Error </li> </ul>"},{"location":"chap7/3ubs/#3-timeline","title":"3. Timeline","text":"<p>In ITIL, the mutually agreed timeline between two internal teams for completing a task is known as </p> <p>Pick ONE option </p> <ul> <li>SLA </li> <li>PLA </li> <li>OLA </li> <li>None of the above </li> </ul> <p>The main difference between OLAs and SLAs is that they represent different commitments: </p> <ul> <li>The SLA underscores a commitment to the client/customer. </li> <li>The OLA highlights the commitment to internal groups within the organization.</li> </ul>"},{"location":"chap7/3ubs/#4-event-management","title":"4. event management","text":"<p>You are in the process of setting up a monitoring solution for your infrastructure. A server is currently running with only 10% of disk space . What classification do you think the monitoring system should ideally assign to the current situation? </p> <p>Pick ONE option  </p> <ul> <li>An Incident </li> <li>An Event </li> <li>A Major Incident </li> <li>A Problem </li> </ul>"},{"location":"chap7/3ubs/#5-event-managament","title":"5. Event Managament","text":"<p>\"Any detectable or discernible occurrence that has significance for the management of IT Infrastructure or the delivery of IT service\" . </p> <p>Which of the below ITIL terms implies this statement? </p> <p>Pick ONE option </p> <ul> <li>An Incident </li> <li>An Warning </li> <li>An Event </li> <li>A Change </li> </ul>"},{"location":"chap7/3ubs/#6-incident-priority","title":"6. Incident Priority","text":"<p>Incident Priority = __ * ___</p> <p>Pick ONE OR MORE options </p> <ul> <li>Urgency </li> <li>Importance </li> <li>Impact </li> <li>Number of users affected </li> </ul>"},{"location":"chap7/3ubs/#7-priority","title":"7. priority","text":"<p>Which of the following is most significant in determining the priority of an Incident? </p> <p>Pick ONE option </p> <ul> <li>The impact on the business and how quickly the business needs a resolution </li> <li>The ease and speed of implementing the fix </li> <li>The seniority of the person logging the Incident </li> <li>The ability of the Service Desk to rectify the Incident without referral to specialist support groups </li> </ul>"},{"location":"chap7/3ubs/#9-urgent-change","title":"9. Urgent change","text":"<p>In case of emergency, we can change data in production immediately with the approval from senior collegues. </p> <p>Pick ONE option </p> <ul> <li>Yes, as they are more experienced </li> <li>No, It requires a change and it should be done after CAB approval </li> <li>Yes, but with approvals for an emergency change from the ECR sponsor </li> </ul>"},{"location":"chap7/3ubs/#10-event-and-incident-management","title":"10. Event and Incident Management","text":"<p>\"All events are incidents, but not all incidents are events\" </p> <p>What is your response to the above statement? </p> <p>Pick ONE option </p> <ul> <li>Yes </li> <li>No </li> <li>Sometime </li> <li>None of the above </li> </ul>"},{"location":"chap7/3ubs/#linux","title":"Linux","text":""},{"location":"chap7/3ubs/#1-reboot-time","title":"1 reboot time","text":"<p>Complete the blanks in the following question with the appropriate answer. </p> <p>Write below a basic command that can be used to find the last reboot time of a unix server. </p> <ul> <li><code>who -b</code> </li> <li><code>last reboot</code></li> <li><code>uptime</code></li> </ul>"},{"location":"chap7/3ubs/#2-last-10-line","title":"2 last 10 line","text":"<p>Complete the blanks in the following question with the appropriate answer. </p> <p>Write below the basic command that can be used to find the last 10 lines of a file in UNIX. </p> <p><code>tail -10</code></p>"},{"location":"chap7/3ubs/#3-shell-script","title":"3 shell script","text":"<p>You are using a BASH or KORN shell, i.e. not a CSH. </p> <ul> <li>export A=10 </li> <li>export B=20 </li> <li>export C=30 </li> <li>echo <code>echo $A</code> + $(echo $B) </li> </ul> <p>What is the output of the above sequence of commands? </p> <p>Pick ONE option </p> <ul> <li>30 </li> <li>20 + 10 </li> <li>10 + 20 </li> <li> </li> <li>a syntax error </li> <li>None of the above </li> </ul>"},{"location":"chap7/3ubs/#4-copy-files","title":"4 copy files","text":"<p>In Unix, which of the following commands is used to copy all the files that have the string chap and any two other characters to the progs directory? </p> <p>Pick ONE option </p> <ul> <li><code>cp chap?? progs</code> </li> <li><code>cp chap* progs</code> </li> <li><code>cp chap[1 2] /progs/*.*</code></li> <li><code>cp chap?? /progs/*</code> </li> </ul>"},{"location":"chap7/3ubs/#5-killing-a-job","title":"5 killing a job","text":"<p>What are the command (s) that can be used to surely kill a process ID in UNIX? </p> <p>Pick ONE OR MORE options </p> <ul> <li>kill -9 </li> <li>terminate -9 </li> <li>stop -9 </li> <li>kill -kill </li> <li>kill -SIGkill </li> </ul>"},{"location":"chap7/3ubs/#6-house-keeping","title":"6 house keeping","text":"<p>Which one of the below command can be used to delete log files from a folder older than 30 days? </p> <p>Pick ONE OR MORE options </p> <ul> <li><code>find . -type f -name \"*.log\"  -mtime +30  -exec rm{}\\;</code> </li> <li><code>find . -type f -name \"*.log\" -mtime -30 -exec rm{}\\;</code></li> <li><code>find . -type f -name \"*.log\" -mtime -30 | xargs rm</code> </li> <li><code>find . -type f -name \"*.log\" -mtime +30 | xargs rm</code> </li> <li><code>find . -type f -name \"*.log\" -mtime +30 -exec rm -i {}\\;</code></li> </ul>"},{"location":"chap7/3ubs/#7-default-environment-variables-in-bash","title":"7 Default Environment Variables in Bash","text":"<p>Which file contains the default environment variables when using the bash shell? </p> <p>Pick ONE option </p> <ul> <li><code>~/.profile</code></li> <li><code>~/.bash</code> </li> <li><code>/etc/profile.d</code> </li> <li><code>/bash</code> </li> </ul>"},{"location":"chap7/3ubs/#8-pattern-matching","title":"8 pattern matching","text":"<p>In Unix, which of the following symbols is used with the grep command to match the pattern pat at the beginning of a line? </p> <p>Pick ONE option </p> <ul> <li><code>^pat</code> </li> <li><code>$pat</code> </li> <li><code>pat$</code> </li> <li><code>pat^</code></li> </ul>"},{"location":"chap7/3ubs/#9-datetime","title":"9 datetime","text":"<p>Complete the blanks in the following question with the appropriate answer. The command used to display the current date and timezone in UNIX? </p> <p>date</p>"},{"location":"chap7/3ubs/#10-memory-usage","title":"10. Memory usage","text":"<p>Complete the blanks in the following question with the appropriate answer. </p> <p>Name any basic command that can be used to find the available memory in a unix server </p> <p><code>free -m</code></p>"},{"location":"chap7/3ubs/#11-shell-script-execution","title":"11. shell script execution","text":"<p>In Unix, let's say that you create a file <code>my_custom_command</code> with the following command as content </p> <p><code>echo my custom command</code></p> <p>What would happen if you execute the file <code>my_custom_command</code>? </p> <p>Pick ONE option </p> <ul> <li>The message \"my custom command\" is displayed </li> <li>The message \"my custom command\" is displayed only if the execute permission of the file '<code>my_custom_command</code>' is set. </li> <li>The message \"my\" is displayed </li> <li>The message \"my\" is displayed only if the execute permission of the file '<code>my_custom_command</code>' is set. </li> </ul>"},{"location":"chap7/3ubs/#12-filename-of-the-current-script","title":"12 Filename of the current script.","text":"<p>In Unix, which of the following statements shows the file name of the script being executed currently? </p> <p>Pick ONE option </p> <ul> <li><code>echo $#</code></li> <li><code>echo $$</code> </li> <li><code>echo $0</code> </li> <li> <p><code>echo $?</code> </p> </li> <li> <p><code>$#</code> is the number of positional parameters passed to the script, shell, or shell function</p> </li> <li>The <code>$?</code> variable represents the exit status of the previous command.</li> <li><code>echo $0</code> it can be used to display the name of the current shell.</li> <li>The <code>$$</code> variable is the PID (Process IDentifier) of the currently running shell.</li> <li><code>$_</code> is another special bash parameter and used to reference the absolute file name of the shell or bash script which is being executed as specified in the argument list</li> </ul>"},{"location":"chap7/3ubs/#13-exit-status","title":"13 Exit status","text":"<p>In Unix, which of the following statements shows the exit status of the last executed command? </p> <p>Pick ONE option </p> <ul> <li>echo $# </li> <li>echo $$ </li> <li>echo $_ </li> <li>echo $? </li> </ul>"},{"location":"chap7/3ubs/#14-command-substitution","title":"14 Command Substitution","text":"<p>Using command substitution, how would you display the value of the present working directory?  Pick ONE option </p> <ul> <li>echo $(pwd) </li> <li>echo pwd </li> <li>$pwd </li> <li>pwd | echo </li> </ul>"},{"location":"chap7/3ubs/#15-selective-searching","title":"15 selective searching","text":"<p>What command and option we can use to display 5 lines above and 5 lines below an exception we are interested to search in a log file? </p> <p>Pick ONE option </p> <ul> <li><code>grep +5 &lt;pattern&gt; file name</code> </li> <li><code>grep +5 -5 &lt;pattern&gt; file name</code> </li> <li><code>grep -A 5 -B 5 &lt;pattern&gt; file name</code> </li> <li><code>grep &lt;pattern&gt; file name head +5 tail -5</code> </li> </ul>"},{"location":"chap7/3ubs/#16-managing-processes","title":"16  managing processes","text":"<p>When you press and hold the Ctrl key and another key a the UNIX process in the foreground will be stopped but not terminated. Which is the second key you need to press? </p> <p>Pick ONE option </p> <ul> <li>a</li> <li>c</li> <li>z</li> <li>v</li> </ul>"},{"location":"chap7/3ubs/#17-space-in-a-file-system","title":"17 space in a file system","text":"<p>Complete the blanks in the following question with the appropriate answer. </p> <p>Write a basic command that can be used to find the available space in a file system in UNIX? </p> <p><code>df -h</code></p>"},{"location":"chap7/3ubs/#windows","title":"Windows","text":""},{"location":"chap7/3ubs/#1-windows","title":"1 Windows","text":"<p>A windows server has restarted unexpectedly. The log events records of the system can be checked under: </p> <p>Pick ONE option </p> <ul> <li>services.msc </li> <li>Task Manager </li> <li>system.msc </li> <li>Event Viewer </li> </ul> <p>Event Viewer is a component of Microsoft's Windows NT operating system that lets administrators and users view the event logs on a local or remote machine.</p>"},{"location":"chap7/3ubs/#2-windows","title":"2 Windows","text":"<p>Which of the following desktop tool can be used to connect remotely to a Windows server? </p> <p>Pick ONE option </p> <ul> <li>Remote Desktop Connection </li> <li>services.msc </li> <li>Task manager </li> <li>None of the above </li> </ul>"},{"location":"chap7/3ubs/#3-windows","title":"3 Windows","text":"<p>SSH can be used in only  </p> <p>Pick ONE option </p> <ul> <li>unix-like operating systems</li> <li>windows </li> <li>Both of the above </li> <li>None of the above </li> </ul>"},{"location":"chap7/3ubs/#4-windows","title":"4 Windows","text":"<p>In a command prompt, which command displays the short names of the files in the current directory? </p> <p>Pick ONE option </p> <ul> <li><code>dir /X</code> </li> <li>ls</li> <li>dir /S </li> <li>None of the above </li> </ul>"},{"location":"chap7/3ubs/#5-windows","title":"5 Windows","text":"<p>To restart IIS service on Windows webserver, the following command can be executed Please select the 2 correct options </p> <p>Pick ONE OR MORE options </p> <ul> <li>iisreset /start </li> <li>iisrecycle </li> <li>iisreset /restart </li> <li>iisreset </li> </ul>"},{"location":"chap7/3ubs/#6-windows","title":"6 Windows","text":"<p>Which command can be used to check the IP address on a windows server? </p> <p>Pick ONE OR MORE options </p> <ul> <li>ipconfig </li> <li>ping </li> <li>ipconfig /all </li> <li>tracert </li> </ul>"},{"location":"chap7/3ubs/#on-a-windows-webserver-iis-stands-for","title":"On a windows webserver, IIS stands for","text":"<p>Pick ONE option </p> <ul> <li>Indian Information Service </li> <li>Immunization information system </li> <li>Internet Information Services </li> <li>inter-IC Sound </li> </ul>"},{"location":"chap7/3ubs/#windows_1","title":"Windows","text":"<p>An Active Directory is: </p> <p>Pick ONE option </p> <ul> <li>the protocol used for services authentication </li> <li>Uthe current folder </li> <li>the directory service database to store the organizational based data,policy,authentication </li> <li>None of the above </li> </ul>"},{"location":"chap7/3ubs/#windows_2","title":"Windows","text":"<p>What command would you use to do a reverse DNS lookup? </p> <p>Pick ONE option </p> <ul> <li>host </li> <li>ping </li> <li>nslookup </li> <li>ipconfig </li> </ul>"},{"location":"chap7/3ubs/#windows_3","title":"Windows","text":"<p>Which of the following method enable you to create a shared network folder? </p> <p>Pick ONE OR MORE options </p> <ul> <li>Right-click a folder in either My Computer or Windows Explorer, select Sharing And Security, click the option button Share This Folder, and click OK. </li> <li>Right-click a folder in either My Computer or Windows Explorer, select ies, click the Sharing tab, click the option button Share This Folder, and click OK. </li> <li>Open the Computer Management Console, expand Shared Folders, right-click the Shares node, and click New File Share. Follow the onscreen instructions for the Create Shared Folder Wizard. </li> <li>Open a command prompt window. Type \"Net Share <code>share_name=x:folder_name</code>\", where share_name represents the name you want to assign to the shared folder, x: represents the drive letter where the folder resides, and <code>folder_name</code> represents the actual name of the folder. </li> <li>All of the above </li> </ul>"},{"location":"chap7/3ubs/#autosys","title":"Autosys","text":""},{"location":"chap7/3ubs/#autosys_1","title":"Autosys","text":"<p>A ... is to starts a process that will check the presence of a particular file in the operating system. It is the same as a command job. When this OS file does not increase in size, the file watcher job executes completely </p> <p>Pick ONE option </p> <ul> <li>Command job</li> <li>File watcher job </li> <li>Box job </li> </ul>"},{"location":"chap7/3ubs/#on-ice","title":"ON ICE","text":"<p>Keeping a job ON ICE helps to skip the dependency on it. Is this a correct statement? </p> <p>Pick ONE option </p> <ul> <li>True </li> <li>False </li> </ul>"},{"location":"chap7/3ubs/#on-hold","title":"ON HOLD","text":"<p>Keeping a job ON HOLD helps to skip the dependency on it. Is this a correct statement? </p> <p>Pick ONE option </p> <ul> <li>True </li> <li>False </li> </ul> <p>Job on ice :  Dependant job will run, In fact we can call Job on ice as a SUCCESS condition.</p> <p>Job on Hold : Dependant job wont run...</p>"},{"location":"chap7/3ubs/#automation","title":"Automation","text":""},{"location":"chap7/3ubs/#automation_1","title":"Automation","text":"<p>Scheduled automations cannot be triggered based on conditions (e.g., Trigger automation only when an alert is generated or a ticket is created) </p> <p>Pick ONE option </p> <ul> <li>TRUE </li> <li>FALSE </li> </ul>"},{"location":"chap7/3ubs/#automation_2","title":"Automation","text":"<p>Which option below is not an example of screen Scraping in Automation </p> <p>Pick ONE option </p> <ul> <li>Extracting data from a web page </li> <li>Extracting data from a desktop based application </li> <li>Extracting Data from a Data base </li> <li>Data entry via web page </li> </ul>"},{"location":"chap7/3ubs/#automation_3","title":"Automation","text":"<p>Automation enables __</p> <p>Pick ONE option </p> <ul> <li>cost based on reduction</li> <li>None of the option </li> <li>Reduces delivery risk </li> <li>All of the options </li> <li>Easy integration</li> </ul>"},{"location":"chap7/3ubs/#big-data","title":"Big data","text":""},{"location":"chap7/3ubs/#big-data_1","title":"Big Data","text":"<p>The type of data Hadoop can deal with is </p> <p>Pick ONE option </p> <ul> <li>Structured  </li> <li>Semi-structured </li> <li>Unstructured </li> <li>All of the options </li> </ul> <p>The V s of Big Data are </p> <p>Pick ONE option </p> <ul> <li>Volume </li> <li>Variety </li> <li>Velocity </li> <li>Veracity </li> <li>All of the options </li> </ul>"},{"location":"chap7/3ubs/#big-data_2","title":"Big Data","text":"<p>What are the must-have features for an automation tool? (Select all the applies) </p> <p>Pick ONE option </p> <ul> <li>Debugging and object identification</li> <li>Supports various frameworks </li> <li>Should support all kinds of test environments </li> <li>A, B &amp; C </li> <li>Only B &amp; C </li> </ul>"},{"location":"chap7/3ubs/#big-data_3","title":"Big Data","text":"<p>Which of the following focuses on discovery of (previously) unknown properties on the data </p> <p>Pick ONE option </p> <ul> <li>Data Mining </li> <li>Big Data </li> <li>Data Wrangling </li> <li>Machine Learning </li> </ul>"},{"location":"chap7/3ubs/#automation_4","title":"Automation","text":"<p>List the benefits of using Automation (Please select the options which is not appropriate) </p> <p>Pick ONE option</p> <ul> <li>Reduces Cost</li> <li>Increases Productivity </li> <li>Increase in complexities during implementation </li> <li>Eliminates Human errors </li> </ul>"},{"location":"chap7/4MorganS/","title":"Morgan Stanly 2021","text":""},{"location":"chap7/4MorganS/#jenkins","title":"Jenkins","text":""},{"location":"chap7/4MorganS/#jenkins-shared-library","title":"Jenkins Shared Library","text":"<ul> <li>\u5728pipene\u4e2d\u5b9a\u4e49\u51fd\u6570</li> <li>Jenkins \u5171\u4eab\u5e93</li> </ul> <p>Jenkins \u5171\u4eab\u5e93</p> <p>\u5728\u591a\u4e2a\u9879\u76ee\u4e4b\u95f4\u5171\u4eab\u6d41\u6c34\u7ebf\u6709\u52a9\u4e8e\u51cf\u5c11\u5197\u4f59\u5e76\u4fdd\u6301\u4ee3\u7801\u3002\u6d41\u6c34\u7ebf\u652f\u6301\u521b\u5efa \"\u5171\u4eab\u5e93\" \uff0c\u53ef\u4ee5\u5728\u5916\u90e8\u6e90\u4ee3\u7801\u63a7\u5236\u4ed3\u5e93\u4e2d\u5b9a\u4e49\u5e76\u52a0\u8f7d\u5230\u73b0\u6709\u7684\u6d41\u6c34\u7ebf\u4e2d\u3002</p> <ul> <li><code>src</code>\u76ee\u5f55\u7c7b\u4f3c\u4e8e\u6807\u51c6Java\u6e90\u76ee\u5f55\u7ed3\u6784\u3002\u6267\u884c\u6d41\u6c34\u7ebf\u65f6\uff0c\u6b64\u76ee\u5f55\u5c06\u6dfb\u52a0\u5230\u7c7b\u8def\u5f84\u4e2d\u3002</li> <li><code>vars</code>\u76ee\u5f55\u6258\u7ba1\u811a\u672c\u6587\u4ef6\uff0c\u8fd9\u4e9b\u811a\u672c\u6587\u4ef6\u5728\u201c\u7ba1\u9053\u201d\u4e2d\u4f5c\u4e3a\u53d8\u91cf\u516c\u5f00\u3002</li> <li><code>resources</code>\u76ee\u5f55\u5141\u8bb8<code>libraryResource</code>\u4ece\u5916\u90e8\u5e93\u4e2d\u4f7f\u7528\u6b65\u9aa4\u6765\u52a0\u8f7d\u76f8\u5173\u8054\u7684\u975e <code>Groovy</code>\u6587\u4ef6\u3002</li> </ul> <p></p> <ul> <li><code>Class: bar.grooy</code>     \u7c7b</li> <li>vars: <code>foo.groovy</code>, <code>foo.txt</code> </li> <li>resource: <code>bar.json</code> stastic helper data for <code>bar.groovy</code></li> </ul> <p>\u7b80\u5355\u4f7f\u7528\u5e93</p> <p>\u6807\u8bb0Load\u7684\u5171\u4eab\u5e93\u9690\u542b\u7684\u5141\u8bb8\u7ba1\u9053\u7acb\u5373\u4f7f\u7528\u4efb\u4f55\u6b64\u7c7b\u5e93\u5b9a\u4e49\u7684\u7c7b\u6b7b\u5168\u5c40\u53d8\u91cf\u3002 \u8981\u8bbf\u95ee\u5176\u4ed6\u5171\u4eab\u5e93\uff0c Jenkinsfile\u9700\u8981\u4f7f\u7528<code>@Library</code>\u6ce8\u91ca\uff0c\u5e76\u6307\u5b9a\u5e93\u7684\u540d\u79f0</p> <pre><code>@Library('my-shared-library')  _\n/* Using a version specifierk such as branch, tag, etc */ \n\n@Library('my-shared-library@&lt;version&gt;')  _\n\n@Library('my-shared-library@1.0') _ \n/* Accessing multiple libraries with one statement */ \n\n@Library(['my-shared-library', 'otherlib@abc12341']) _ \n</code></pre> <p><code>_</code>\uff1a \u4ee3\u8868\u5f15\u7528</p> <pre><code>@Library('jenkinslib') _\ndef tools = new org.devops.tools()\n</code></pre> <p>\u5e38\u7528\u7684\u5171\u4eab\u5e93</p> <ul> <li>\u589e\u52a0\u683c\u5f0f\u5316\u8f93\u51fa\u65b9\u6cd5 \uff08ansiColor\uff09</li> <li>\u5c01\u88c5\u5de5\u5177\uff08mvn,  ant, gradle, npm)  <code>def build = new org.devops.buildtools()</code></li> <li>gitlab sharedlibrary function: ( \u5c01\u88c5HTTP\u8bf7\u6c42, \u66f4\u6539\u63d0\u4ea4\u72b6\u6001)</li> <li>\u90ae\u4ef6\u53d1\u9001\u6a21\u677f  Email(status,emailUser)</li> <li>\u6d41\u6c34\u7ebf\u8fdb\u884c\u81ea\u52a8\u5316\u4ee3\u7801\u626b\u63cf   <code>SonarScan(projectName, projectDesc, projectPath)</code></li> <li>Nexus\u65b9\u6cd5 `GetGav() //\u83b7\u53d6POM\u4e2d\u7684\u5750\u6807, NexusUpload(): Nexus plugin deploy MavenUpload() mvn deploy\uff0c ArtifactUpdate(updateType,artifactUrl) //\u5236\u54c1\u664b\u7ea7</li> <li>nexusapi //\u5c01\u88c5HTTP  //\u83b7\u53d6\u4ed3\u5e93\u4e2d\u6240\u6709\u7ec4\u4ef6 //\u83b7\u53d6\u5355\u4ef6\u7ec4\u4ef6 //\u83b7\u53d6\u7ec4\u4ef6\u4fe1\u606f</li> <li>Gitlab <ul> <li><code>HttpReq(reqType,reqUrl,reqBody)</code>  //\u5c01\u88c5HTTP\u8bf7\u6c42</li> <li><code>UpdateRepoFile(projectId,filePath,fileContent)</code> //\u66f4\u65b0\u6587\u4ef6\u5185\u5bb9</li> <li><code>GetRepoFile(projectId,filePath)</code> //  \u83b7\u53d6\u6587\u4ef6\u5185\u5bb9</li> <li><code>CreateRepoFile(projectId,filePath,fileContent)</code>  //\u521b\u5efa\u4ed3\u5e93\u6587\u4ef6</li> <li><code>ChangeCommitStatus(projectId,commitSha,status)</code> //\u66f4\u6539\u63d0\u4ea4\u72b6\u6001</li> <li><code>GetProjectID(repoName='',projectName)</code>  //\u83b7\u53d6\u9879\u76eeID</li> <li><code>DeleteBranch(projectId,branchName)</code> //\u5220\u9664\u5206\u652f</li> <li><code>CreateBranch(projectId,refBranch,newBranch)</code>  //\u521b\u5efa\u5206\u652f</li> <li><code>CreateMr(projectId,sourceBranch,targetBranch,title,assigneeUser=\"\")</code> // \u521b\u5efa\u5408\u5e76\u8bf7\u6c42</li> <li><code>SearchProjectBranches(projectId,searchKey)</code> //\u641c\u7d22\u5206\u652f</li> <li><code>AcceptMr(projectId,mergeId)</code> //\u5141\u8bb8\u5408\u5e76</li> </ul> </li> <li>Jmeter \u63a5\u53e3\u6d4b\u8bd5\u751f\u6210\u62a5\u544a</li> <li>\u4f7f\u7528 Prometheus \u76d1\u63a7 Jenkins</li> </ul>"},{"location":"chap7/4MorganS/#jenkins-secrets-and-credential","title":"Jenkins Secrets and Credential","text":"<ul> <li>\u6dfb\u52a0\u51ed\u8bc1\u540e\uff0c\u9700\u8981\u5b89\u88c5<code>\"Credentials Binding Plugin\"</code>\u63d2\u4ef6\uff0c\u5c31\u53ef\u4ee5\u5728<code>pipeline</code>\u4e2d\u4f7f\u7528<code>withCredentials</code> \u6b65\u9aa4\u4f7f\u7528\u51ed\u8bc1\u4e86\u3002<ul> <li>Secret text: <code>withCredentials([string(credentialsId: 'secretText', variable: 'varName')])</code></li> <li>Usernarne with password: <code>withCredentials([usernamePassword(credentialsId: ' ', usernameVariable: ' ', passwordVariable: '')])</code></li> <li>Secret file: <code>withCredentials([file(credentialsId: ' ', variable: ' ')])</code></li> <li>SSH Username with private key: <code>withCredentials([sshUserPrivateKey(  keyFileVariable:\"key\",  credentialsId : \"private-key\" )])</code></li> </ul> </li> </ul> <p>\u4f18\u96c5\u5730\u4f7f\u7528\u51ed\u8bc1</p> <ul> <li>Secret text\uff1a <code>environment {   AWS_ACCESS_KEY_ID = credentials( 'aws-secret-key-id' )  }</code></li> <li>Username with password: <code>`environment {   BITBUCKET_CREDS = credentials( 'jenkins-bitbucket-creds' ) }</code></li> <li>Secret file\uff1a <code>environment {  KNOWN_HOSTS = credentials('known_hosts') }</code> </li> </ul> <p>\u51ed\u8bc1\u7ba1\u7406\u4f7f\u7528HashiCorp Vault</p> <ul> <li><code>vault write -address=${VAULT_ADDR} secret/hello value=world</code></li> <li><code>def x = vault path: 'secret/hello', key: 'value'</code></li> <li><code>wrap([$class: 'MaskPasswordsBuildWrapper',  varMaskRegexes: [[regex: 'abc--.*']]  ]</code></li> </ul>"},{"location":"chap7/4MorganS/#jenkins-parallelism-and-distributed","title":"Jenkins Parallelism and Distributed","text":"<pre><code>parallel (\n\"stream 1\" : { \n    node('linux') {  // runs on one of the nodes labelled as linux nodes\n        build 'Job1'\n    }\n},\n\"stream 2\" : {\n    node('named_node_foo'){  // only runs on node named_foo_node\n        build 'Job2'\n    }\n}\n</code></pre>"},{"location":"chap7/4MorganS/#nas-storage","title":"Nas Storage","text":"<p>NFS value</p> <ul> <li>\u7acb\u670d\u52a1\u7aef\u6570\u636e\u76ee\u5f55,\u5171\u4eab\u76ee\u5f55\u8bbe\u7f6e\u6743\u9650</li> <li>\u5173\u95ed\u9632\u706b\u5899</li> <li>\u5b89\u88c5\u914d\u7f6e nfs   \u914d\u7f6e <code>nfs</code>\uff0c<code>nfs</code> \u7684\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\u5728 <code>/etc/exports</code> \u6587\u4ef6\u4e0b\uff0c\u5728\u8be5\u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e0b\u9762\u7684\u914d\u7f6e\u4fe1\u606f\uff1a</li> </ul> <pre><code>$ sudo vi /etc/exports\n/data/k8s  *(rw,sync,no_root_squash)\n</code></pre> <ul> <li><code>/data/k8s</code>\uff1a\u662f\u5171\u4eab\u7684\u6570\u636e\u76ee\u5f55</li> <li><code>*</code>\uff1a\u8868\u793a\u4efb\u4f55\u4eba\u90fd\u6709\u6743\u9650\u8fde\u63a5\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u7f51\u6bb5\uff0c\u4e00\u4e2a IP\uff0c\u4e5f\u53ef\u4ee5\u662f\u57df\u540d</li> <li><code>rw</code>\uff1a\u8bfb\u5199\u7684\u6743\u9650</li> <li><code>sync</code>\uff1a\u8868\u793a\u6587\u4ef6\u540c\u65f6\u5199\u5165\u786c\u76d8\u548c\u5185\u5b58</li> <li><code>no_root_squash</code>\uff1a\u5f53\u767b\u5f55 NFS \u4e3b\u673a\u4f7f\u7528\u5171\u4eab\u76ee\u5f55\u7684\u4f7f\u7528\u8005\u662f root \u65f6\uff0c\u5176\u6743\u9650\u5c06\u88ab\u8f6c\u6362\u6210\u4e3a\u533f\u540d\u4f7f\u7528\u8005\uff0c\u901a\u5e38\u5b83\u7684 <code>UID</code> \u4e0e <code>GID</code>\uff0c\u90fd\u4f1a\u53d8\u6210 <code>nobody</code> \u8eab\u4efd</li> </ul> <p>\u6ce8\u610f\u542f\u52a8\u987a\u5e8f\uff0c\u5148\u542f\u52a8 rpcbind</p> <pre><code>$ sudo vi exports\n$ sudo systemctl start rpcbind.service\n$ sudo systemctl enable rpcbind\n</code></pre> <p>\u7136\u540e\u542f\u52a8 nfs \u670d\u52a1\uff1a</p> <pre><code>$ sudo systemctl start nfs.service\n$ sudo systemctl enable nfs\n$ systemctl status nfs\n</code></pre>"},{"location":"chap7/4MorganS/#haproxy","title":"Haproxy","text":"<ul> <li>Load Balancing Algorithms: <ul> <li>Round Robin selects servers in turns. This is the default algorithm.</li> </ul> </li> <li>leastconn<ul> <li>Selects the server with the least number of connections\u2013it is recommended for longer sessions.</li> </ul> </li> <li>source<ul> <li>This selects which server to use based on a hash of the source IP i.e. your user\u2019s IP address. </li> </ul> </li> <li>static-rr / first / random </li> </ul> <p><code>server web1 10.10.10.10 weight 50</code></p>"},{"location":"chap7/4MorganS/#log","title":"Log","text":""},{"location":"chap7/4MorganS/#logstash-vs-fluentd","title":"LogStash VS Fluentd","text":""},{"location":"chap7/4MorganS/#logstash-event-routing-vs-fluentd-event-routing","title":"Logstash Event Routing vs Fluentd Event Routing","text":"<p>Logstash routes all data into a single stream and then uses algorithmic if-then statements to send them to the right destination. </p> <pre><code>output {\nif [loglevel] == \"ERROR\" and [deployment] == \"production\" {\npagerduty {\n...\n        }\n    }\n}\n</code></pre> <p>Fluentd Event Routing</p> <p>Fluentd relies on tags to route events. Each Fluentd event has a tag that tells Fluentd where it wants to be route</p> <pre><code>&lt;match production.error&gt;\ntype pagerduty\n\u2026\n&lt;/match&gt;\n</code></pre> <pre><code>&lt;source&gt;\n  @type tail\n  tag system.logs\n  # ...\n&lt;source&gt;\n</code></pre> <p>then mark that tag in the area:</p> <pre><code>&lt;match {app.**,system.logs}&gt;\n</code></pre> <p>Fluentd\u2019s approach is more declarative whereas Logstash\u2019s method is procedural.</p> <ul> <li>Therefore, programmers trained in procedural programming might see Logstash\u2019s configuration as easier for getting started. </li> <li>On the other hand, Fluentd\u2019s tag-based routing allows complex routing to be expressed clearl</li> </ul>"},{"location":"chap7/4MorganS/#transport-comparison","title":"Transport Comparison","text":"<ul> <li>Logstash: Needs to be deployed with Redis to ensure reliability</li> <li> <p>Fluentd: Built-in reliability, but its configuration is more complicated</p> </li> <li> <p>LogStash: limited to an on-memory queue that holds 20 events.</p> </li> <li>Fluentd: highly configurable buffering system.</li> </ul>"},{"location":"chap7/4MorganS/#performance-comparison","title":"Performance Comparison","text":"<ul> <li>Logstash: Slightly more memory use. Use Elastic Beats for leaf machines.</li> <li>Fluentd: Slightly less memory use. Use Fluent Bit and Fluentd Forwarder for leaf machines.</li> </ul>"},{"location":"chap7/4MorganS/#performance","title":"Performance","text":"<p>Fluentd: slightly better reputation.</p>"},{"location":"chap7/4MorganS/#monitoring-tuning","title":"Monitoring &amp; Tuning","text":"<ul> <li>LogStash: Metrics filter, can be visualized in 3rd party such as Graphite.</li> <li>Fluentd: built-in monitoring agent, plug-ins to integrate with your monitoring stack.</li> </ul>"},{"location":"chap7/4MorganS/#jaeger","title":"Jaeger","text":"<p>\u4e00\u4e2a Trace \u7684\u771f\u5b9e\u6570\u636e</p> <pre><code>{\"duration\":2065,\"operationName\":\"/ping\",\"parentSpanID\":\"0\",\"process.serviceName\":\"negri.sidecarserverlistener.myapp\",\"process.tags.hostname\":\"MacBook-Pro-3.local\",\"process.tags.ip\":\"192.168.1.88\",\"spanID\":\"5f1db306ef459b2f\",\"startTime\":1609241265147010,\"tags.http.method\":\"GET\",\"tags.http.status_code\":\"200\",\"tags.http.url\":\"/ping\",\"tags.peer.address\":\"http://127.0.0.1:8888\",\"tags.span.kind\":\"server\",\"traceID\":\"5f1db306ef459b2f\"}\n</code></pre> <ul> <li>\u63a5\u53e3\u7684\u8fd0\u884c\u65f6\u95f4 duration\uff0c</li> <li>\u8bb0\u5f55\u4e86\u670d\u52a1\u540d\u3001</li> <li>TraceId\u3001</li> <li>SpanId\u3001</li> <li>ParentSpanId \u7b49\u4e0a\u9762\u6211\u4eec\u804a\u5230\u7684\u5e38\u7528\u6570\u636e\uff0c</li> </ul> <p>\u53e6\u5916\u8fd8\u8bb0\u5f55\u4e86\u6211\u4eec\u6240\u9700\u8981\u7684\u4e00\u4e9b\u81ea\u5b9a\u4e49\u6570\u636e\uff0c\u653e\u5728\u4e86 Tags \u5b57\u6bb5\u4e2d\u3002</p> <p>\u94fe\u8def\u8ffd\u8e2a\u7cfb\u7edf\uff0c\u901a\u8fc7\u6536\u96c6\u7a0b\u5e8f\u4e2d\u7684\u6253\u70b9\u65e5\u5fd7\u7684\u65b9\u5f0f\uff0c\u901a\u5e38\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4ee5\u4e0b\u529f\u80fd\u3002</p> <ul> <li>\u6392\u67e5\u6839\u56e0\uff1a\u5206\u6790\u5355\u6b21\u8bf7\u6c42\u7684\u8c03\u7528\u94fe\u8def\uff0c\u6392\u67e5\u95ee\u9898\u6839\u56e0\u3002</li> <li>\u8c03\u7528\u5173\u7cfb\u56fe\uff1a\u901a\u8fc7 Trace \u4e2d\u7684\u670d\u52a1\u4fe1\u606f\uff0c\u7ed8\u5236\u670d\u52a1\u8c03\u7528\u5173\u7cfb\u56fe\u3002</li> <li>\u65e5\u5fd7\u8ffd\u8e2a\uff1a\u901a\u8fc7\u5173\u8054\u65e5\u5fd7 RequestId\uff0c\u53ef\u4ee5\u94fe\u63a5\u5230\u65e5\u5fd7\u7cfb\u7edf\uff0c\u67e5\u770b\u66f4\u8be6\u7ec6\u7684\u65e5\u5fd7\u4fe1\u606f\u3002</li> </ul>"},{"location":"chap7/4MorganS/#python-modules","title":"Python modules","text":""},{"location":"chap7/4MorganS/#python-basic-modules","title":"python basic modules","text":"<p>sys</p> <pre><code>import sys\nsys.path.append('/A/B/C')\n</code></pre> <p>random / math / datetime / calendar / os </p> <pre><code>import os \nprint(os.getcwd()\n</code></pre> <p>Data Format Section</p> <pre><code>import json\n</code></pre> <p>Web Scrap</p> <pre><code>from bs4 import BeautifulSoup\nimport requests\n\n\n# Web Scraping with Requests-HTML\nimport time\nfrom requests_html import HTMLSession\n</code></pre> <p>Python Thread and Process</p> <pre><code>import subprocess\n\n\nimport time\nimport threading\n\nimport requests\nimport time\nimport concurrent.futures\nimport os\n\nimport multiprocessing\nimport concurrent.futures\n</code></pre> <p>psutil</p> <pre><code>import psutil\nprint(psutil.cpu_count())  # CPU\u903b\u8f91\u6570\u91cf\n&gt;&gt;&gt; 8\n\nprint(psutil.cpu_count(logical=False)) # CPU\u7269\u7406\u6838\u5fc3\n&gt;&gt;&gt; 4\n</code></pre> <p>re: re Module - How to Write and Match Regular Expressions (Regex)</p> <pre><code>import re\n</code></pre> <p>Generate Random Numbers and Data Using the random Module</p> <pre><code>import random\n</code></pre> <p>OS Module - Use Underlying Operating System Functionality</p> <pre><code>import os \n</code></pre> <p>Zip Files - Creating and Extracting Zip Archives</p> <pre><code>import zipfile\n</code></pre>"},{"location":"chap7/5apple/","title":"2021 Apple Interview","text":""},{"location":"chap7/5apple/#1-how-does-the-pxe-boot-process-work","title":"1 How does the PXE boot process work?","text":"<p>Dynamic Host Configuration Protocol</p> <p>Using your DHCP server to store and serve this information looks like this:</p> <ul> <li>The device sends out a DHCP broadcast and states that it needs to PXE boot</li> <li>The DHCP server picks up this broadcast and replies with a suggested IP address to use. <ul> <li>If the server has the information on how to PXE boot, that information is included in its reply</li> </ul> </li> <li>The device then replies to the server and uses the provided address</li> <li>Then the device contacts the PXE boot server (traditional a WDS server or SCCM server) and requests the boot file (also known as the Network Boot Program (NBP)) that it was told to look for from the DHCP server</li> <li>The file is then loaded and launched on the client</li> </ul>"},{"location":"chap7/5apple/#2-check-linux-memory","title":"2 Check Linux memory","text":"<p><code>/proc/meminfo</code></p> <ul> <li> <p>Free memory is the amount of memory which is currently not used for anything. This number should be small, because memory which is not used is simply wasted.</p> </li> <li> <p>Available memory is the amount of memory which is available for allocation to a new process or to existing processes.</p> </li> </ul>"},{"location":"chap7/5apple/#3-how-do-i-add-a-dns-server-via-resolvconf","title":"3 How do I add a DNS server via resolv.conf?","text":"<p><code>resolv.conf</code> is the name of a computer file used in various operating systems to configure the system's Domain Name System resolver. </p> <p>The <code>/etc/resolv.conf</code> file defines how the system uses DNS to resolve host names and IP addresses. </p> <p>This file usually contains a line specifying the search domains and up to three lines that specify the IP addresses of DNS server. The following entries from <code>/etc/resolv.conf</code> configure two search domains and three DNS servers:</p> <pre><code>search us.mydomain.com mydomain.com\nnameserver 192.168.154.3\nnameserver 192.168.154.4\nnameserver 10.216.106.3\n</code></pre> <p>If your system obtains its IP address from a DHCP server, it is usual for the system to configure the contents of this file with information also obtained using DHCP.</p>"},{"location":"chap7/6aws/","title":"6 AWS","text":""},{"location":"chap7/6aws/#stage-1-manually-create-a-vpn-connection-for-two-sites","title":"Stage 1: Manually create a VPN connection for two \u201csites\u201d","text":"<ul> <li>Two \u201csites\u201d in one AWS region under a single AWS account. (Each site is hosted in a VPC with an application of 1,000+ EC2 instances.)</li> <li>Customer asks to build a \u201csite-to-site\u201d VPN connection between the two VPCs <ul> <li>so that any servers of the two applications can talk in a secured and scalable way.</li> </ul> </li> </ul> <p>VPC peering is supposed to be not available in this region.</p> <p>Candidate is expected to manually implement the VPN connection in the lab environment by deploying any necessary AWS resources or open-source tools (VPN solutions like openSwan or strongSwan).</p>"},{"location":"chap7/6aws/#provision-the-vpn-connection-with-cloudformation-cfn-template","title":"Provision the VPN connection with CloudFormation (CFN) template","text":"<p>In this stage, candidate is required to create the above VPN connection with a CloudFormation (CFN) template</p> <ul> <li>EC2 security group to enable for ingress and egress traffic.</li> <li>Resource and User Data - Use a script in User Data to install and start VPN Servers.</li> <li>Define the outputs of the CFN with the following items:<ul> <li>Instance IDs of the VPN Servers</li> <li>VPN Server is running in each VPC </li> <li>VPN Server\u2019s Public IP address</li> </ul> </li> </ul>"},{"location":"chap7/6aws/#make-the-vpn-connection-robust","title":"Make the VPN connection robust","text":"<p>In this bonus stage, candidate is expected to improve the resilience of the VPN connection in Stage 1. Try to propose an HA architecture for this connection to auto heal in case of failure.</p> <p>Deliverables:</p> <ul> <li>The HA architecture chart, proposal description and necessary pseudocode. </li> <li>Implement it and revise the CFN template to achieve auto-provision</li> </ul>"},{"location":"chap7/6aws/#solution-steps","title":"Solution Steps","text":""},{"location":"chap7/6aws/#vpca-instance-oregen","title":"VPCA-INSTANCE  <code>Oregen</code>","text":"<ul> <li>1.Create <code>VPC-A</code>, region: Oregen, IPv4 CIDR: <code>10.100.0.0/16</code><ul> <li>vpc-00bc9b0aaeb67e39a </li> </ul> </li> <li>2.Createa Private subnet in: <code>VPCA-Private-Subnet</code> <code>10.100.0.0/24</code></li> <li>3.Create a Route Table\uff1a <code>VPCA-Private-RT</code> , VPC: <code>VPC-A</code></li> <li> <ol> <li>Edit Route Table:  Edit subnet associations: <code>VPCA-Private-Subnet</code></li> </ol> </li> <li> <ol> <li>Launch EC2 instance in this subnet <code>VPCA-Private-Subnet</code></li> <li>Name: <code>EC2-A</code></li> <li>t2.micro,</li> <li>tag: <code>NAME</code> <code>VPCA-Private-EC2</code></li> <li>Create a new security group<ul> <li><code>EC2-A-SG</code></li> <li>All TCP: <code>10.200.0.0/16</code></li> <li>All ICMP - IPV4:  <code>10.200.0.0/16</code></li> </ul> </li> <li>create new key: vpntest</li> </ol> </li> <li>IP:  <code>10.100.0.195</code></li> </ul>"},{"location":"chap7/6aws/#vpcb-instance-frankfurt","title":"VPCB-INSTANCE  <code>FRANKFURT</code>","text":"<ul> <li>1.Create <code>VPC-B</code>, region: Oregen, IPv4 CIDR: <code>10.200.0.0/16</code><ul> <li>vpc-06e0539e9b9e00711</li> </ul> </li> <li> <ol> <li>Create Internet Gateways <code>VPCB-IGW</code> and Attach to <code>VPC-B</code></li> </ol> </li> <li> <ol> <li>Createa public subnet in: </li> <li><code>VPCB-Public-Subnet</code> </li> <li><code>10.200.0.0/24</code></li> <li>Auto-assign IP settings: Enable auto-assign public IPv4 address</li> </ol> </li> <li> <ol> <li>Create a Route Table\uff1a <code>VPCB-Public-RT</code> , VPC: <code>VPC-B</code></li> <li>Edit Routes: <code>0.0.0.0/0</code> : <code>igw-0e4b20b5ec738efe3</code></li> </ol> </li> <li> <ol> <li>Edit Route Table:  Edit subnet associations: <code>VPCB-Public-Subnet</code></li> </ol> </li> <li> <ol> <li>Launch EC2 instance in this subnet <code>VPCB-Public-Subnet</code></li> <li>Name: <code>EC2-B</code></li> <li>t2.micro,</li> <li>tag: <code>NAME</code> <code>VPCB-Router</code></li> <li>Create a new security group<ul> <li><code>EC2-B-SG</code></li> <li>SSH: TCP 22  My IP</li> <li>All TCP: <code>10.100.0.0/16</code></li> <li>All ICMP - IPV4:  <code>10.200.0.0/16</code></li> </ul> </li> <li>create new key: vpnint</li> <li>Source/Destination check -&gt; stop</li> </ol> </li> <li>Private IP:  <code>10.200.0.41</code></li> <li>Public IP:  3.67.225.7 </li> </ul>"},{"location":"chap7/6aws/#ssh-ec2-b","title":"SSH EC2-B","text":"<pre><code>ls | grep vpn\nvpnint.pem\nvpntest.pem\n</code></pre> <pre><code>$ chmod 400 vpnint.pem\n$ ssh -i \"vpnint.pem\" ec2-user@3.67.225.7\n\n       __|  __|_  )\n       _|  (     /   Amazon Linux 2 AMI\n      ___|\\___|___|\n\nhttps://aws.amazon.com/amazon-linux-2/\nNo packages needed for security; 1 packages available\nRun \"sudo yum update\" to apply all updates.\n-bash: warning: setlocale: LC_CTYPE: cannot change locale (UTF-8): No such file or directory\n[ec2-user@ip-10-200-0-41 ~]$\n</code></pre>"},{"location":"chap7/6aws/#vpc-a-vpn","title":"VPC A VPN","text":"<ul> <li> <p>VPC A Virtual Private Gateway</p> <ul> <li><code>VPC-A-VGW</code>:  <code>VPC-A</code>  and attach to <code>VPC-A</code></li> </ul> </li> <li> <p>VPC A Customer Gateway</p> <ul> <li><code>VPC-A-CGW</code>:  IP address: <code>3.67.225.7</code></li> </ul> </li> </ul> <p>Site-to-Site VPN connections</p> <ul> <li><code>VPCA-VPCB-VPN</code></li> <li><code>VPC-A-VGW</code></li> <li><code>VPC-A-CGW</code></li> <li>static: `10.200.0.0/16</li> </ul>"},{"location":"chap7/6aws/#route-table-propagation-vpca-private-rt","title":"Route table propagation <code>VPCA-Private-RT</code>","text":"<ul> <li><code>VPC-A-VGW:</code> Enable</li> </ul>"},{"location":"chap7/6aws/#login-ec2-b-configure-software-vpn","title":"login EC2-B configure software VPN","text":"<pre><code>sudo su\nyum install -y openswan\n</code></pre> <p>In /etc/ipsec.conf uncomment following line (if not already uncommented)</p> <p>include /etc/ipsec.d/*.conf</p> <pre><code>vim /etc/sysctl.conf \n\nnet.ipv4.ip_forward = 1\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.all.send_redirects = 0\n</code></pre> <pre><code>service network restart\nRestarting network (via systemctl):                        [  OK  ]\n</code></pre>"},{"location":"chap7/6aws/#download-vpn-configuration-openswan","title":"Download  VPN configuration OpenSwan","text":"<ul> <li><code>vim /etc/ipsec.d/aws.conf</code></li> </ul> <pre><code>conn Tunnel2\n        authby=secret\n        auto=start\n        left=%defaultroute\n        leftid=3.67.225.7\n        right=35.164.50.218\n        type=tunnel\n        ikelifetime=8h\n        keylife=1h\n        phase2alg=aes128-sha1;modp1024\n        ike=aes128-sha1;modp1024\n        keyingtries=%forever\n        keyexchange=ike\n        leftsubnet=10.200.0.0/16\n        rightsubnet=10.100.0.0/16\n        dpddelay=10\n        dpdtimeout=30\n        dpdaction=restart_by_peer\n</code></pre> <ul> <li><code>vim /etc/ipsec.d/aws.secrets</code></li> </ul> <pre><code>3.67.225.7 35.164.50.218: PSK \"hvQ1jgPeP5Kfn725izXix.7OIwq6aFnI\"\n</code></pre> <pre><code>systemctl start ipsec\n\n[root@ip-10-200-0-41 ec2-user]# systemctl status ipsec\n\u25cf ipsec.service - Internet Key Exchange (IKE) Protocol Daemon for IPsec\n   Loaded: loaded (/usr/lib/systemd/system/ipsec.service; disabled; vendor preset: disabled)\n   Active: active (running) since Sat 2022-03-05 13:35:35 UTC; 33s ago\n     Docs: man:ipsec(8)\n           man:pluto(8)\n           man:ipsec.conf(5)\n  Process: 3122 ExecStartPre=/usr/sbin/ipsec --checknflog (code=exited, status=0/SUCCESS)\n  Process: 3111 ExecStartPre=/usr/sbin/ipsec --checknss (code=exited, status=0/SUCCESS)\n  Process: 2572 ExecStartPre=/usr/libexec/ipsec/_stackmanager start (code=exited, status=0/SUCCESS)\n  Process: 2570 ExecStartPre=/usr/libexec/ipsec/addconn --config /etc/ipsec.conf --checkconfig (code=exited, status=0/SUCCESS)\n Main PID: 3143 (pluto)\n   Status: \"Startup completed.\"\n   CGroup: /system.slice/ipsec.service\n           \u2514\u25003143 /usr/libexec/ipsec/pluto --leak-detective --config /etc/ipsec.conf --nofork\n\nMar 05 13:35:35 ip-10-200-0-41.eu-central-1.compute.internal pluto[3143]: | setup callback for interface eth0:500 fd 15\nMar 05 13:35:35 ip-10-200-0-41.eu-central-1.compute.internal pluto[3143]: loading secrets from \"/etc/ipsec.secrets\"\nMar 05 13:35:35 ip-10-200-0-41.eu-central-1.compute.internal pluto[3143]: loading secrets from \"/etc/ipsec.d/aws.secrets\"\nMar 05 13:35:35 ip-10-200-0-41.eu-central-1.compute.internal pluto[3143]: \"Tunnel2\" #1: initiating Main Mode\nMar 05 13:35:35 ip-10-200-0-41.eu-central-1.compute.internal pluto[3143]: \"Tunnel2\" #1: STATE_MAIN_I2: sent MI2, expecting MR2\nMar 05 13:35:35 ip-10-200-0-41.eu-central-1.compute.internal pluto[3143]: \"Tunnel2\" #1: STATE_MAIN_I3: sent MI3, expecting MR3\nMar 05 13:35:35 ip-10-200-0-41.eu-central-1.compute.internal pluto[3143]: \"Tunnel2\" #1: Peer ID is ID_IPV4_ADDR: '35.164.50.218'\nMar 05 13:35:35 ip-10-200-0-41.eu-central-1.compute.internal pluto[3143]: \"Tunnel2\" #1: STATE_MAIN_I4: ISAKMP SA established {auth=PRESHARED_KE...1024}\nMar 05 13:35:35 ip-10-200-0-41.eu-central-1.compute.internal pluto[3143]: \"Tunnel2\" #2: initiating Quick Mode PSK+ENCRYPT+TUNNEL+PFS+UP+IKEV1_A...1024}\nMar 05 13:35:35 ip-10-200-0-41.eu-central-1.compute.internal pluto[3143]: \"Tunnel2\" #2: STATE_QUICK_I2: sent QI2, IPsec SA established tunnel m...tive}\nHint: Some lines were ellipsized, use -l to show in full.\n</code></pre>"},{"location":"chap7/6aws/#cloudformation","title":"Cloudformation","text":"<p>BonusBits CloudFormation Templates</p> <p>https://s3.amazonaws.com/bonusbits-public/cloudformation-templates/github/</p> <p>1VpcBCfn.yaml</p> <pre><code>AWSTemplateFormatVersion : 2010-09-09\n\n# VPC B is private VPC\nParameters:\n  # VPC B\n  VpcBCidrBlock:\n    Description: VPC B CIDR Block\n    Type: String\n    Default: 10.200.0.0/16\n  # Subnet B\n  SubnetBCidrBlock:\n    Description: Subnet CIDR Block\n    Type: String\n    Default: 10.200.0.0/24\n  # EC2 Instance Type\n  InstanceType:\n    Description: EC2 Instance Type\n    Type: String\n    Default: t2.micro\n    ConstraintDescription: must be a valid EC2 instance type\n  # Key Pair Name\n  KeyName:\n    Description: Key Pair Name\n    Type: AWS::EC2::KeyPair::KeyName\n    Default: vpnint\n\nMappings:\n  # EC2 Instance image Map\n  RegionMap:\n    eu-central-1:\n      hvm: \"ami-00e76d391403fc721\"\n    # us-west-2:\n    #   hmv: \"ami-0b9f27b05e1de14e9\"\n\nResources:\n  # VPC\n  VPC:\n    Type: AWS::EC2::VPC\n    Properties:\n      CidrBlock: !Ref VpcBCidrBlock\n      EnableDnsSupport: true\n      EnableDnsHostnames: true\n      Tags:\n        - Key: Name\n          Value: VPCB-Public-Subnet\n\n  # Internet Gateways\n  InternetGateway:\n    Type: AWS::EC2::InternetGateway\n    Properties:\n    Tags:\n    - Key: Name\n      Value: VPCB-IGW\n\n  GatewayToInternet:\n    Type: AWS::EC2::VPCGatewayAttachment\n    DependsOn:\n    - InternetGateway\n    - VPC\n    Properties:\n      VpcId: !Ref VPC\n      InternetGatewayId: !Ref InternetGateway\n\n  # Subnet\n  Subnet:\n    Type: AWS::EC2::Subnet\n    Properties:\n      VpcId: !Ref VPC\n      CidrBlock: !Ref SubnetBCidrBlock\n      MapPublicIpOnLaunch: True\n      Tags:\n      - Key: Name\n        Value: VPCB-Public-Subnet\n  # Route Table\n  PublicRouteTable:\n    Type: AWS::EC2::RouteTable\n    Properties:\n      VpcId: !Ref VPC\n      Tags:\n      - Key: Name\n        Value: VPCB-Public-RT\n  # Public Route\n  PublicRoute:\n    Type: AWS::EC2::Route\n    DependsOn:\n    - PublicRouteTable\n    - InternetGateway\n    Properties:\n      RouteTableId: !Ref PublicRouteTable\n      DestinationCidrBlock: 0.0.0.0/0\n      GatewayId: !Ref InternetGateway\n  # Public Subnet RT Association\n  PublicSubnetAssociation:\n    Type: AWS::EC2::SubnetRouteTableAssociation\n    DependsOn:\n    - Subnet\n    - PublicRouteTable\n    Properties:\n      RouteTableId: !Ref PublicRouteTable\n      SubnetId: !Ref Subnet\n\n  # EC2 Security Group\n  InstanceSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      VpcId: !Ref VPC\n      GroupDescription: TCP, ICMP, SSH\n      SecurityGroupIngress:\n      - IpProtocol: tcp\n        FromPort: -1\n        ToPort: -1\n        CidrIp: 10.100.0.0/16\n      - IpProtocol: icmp\n        FromPort: -1\n        ToPort: -1\n        CidrIp: 10.100.0.0/16\n      - IpProtocol: tcp\n        FromPort: 22\n        ToPort: 22\n        CidrIp: 0.0.0.0/0\n      SecurityGroupEgress:\n      - IpProtocol: '-1'\n        CidrIp: 0.0.0.0/0\n      Tags:\n      - Key: Name\n        Value: EC2-B-SG\n  # EC2 Instance\n  EC2Instance:\n    Type: AWS::EC2::Instance\n    Properties:\n      ImageId:\n        Fn::FindInMap: [RegionMap, Ref: AWS::Region, hvm]\n      InstanceType:\n        Ref: InstanceType\n      SourceDestCheck: false\n      KeyName:\n        Ref: KeyName\n      Tags:\n      - Key: Name\n        Value: VPCB-Router\n      NetworkInterfaces:\n      - GroupSet:\n        - Ref: InstanceSecurityGroup\n        AssociatePublicIpAddress: true\n        DeviceIndex: 0\n        DeleteOnTermination: true\n        SubnetId: !Ref Subnet\n      UserData:\n        Fn::Base64: \n          !Sub |\n            #!/bin/bash\n            yum install -y openswan\n            cat &lt;&lt;EOT &gt;&gt; /etc/sysctl.conf\n            net.ipv4.ip_forward = 1\n            net.ipv4.conf.all.accept_redirects = 0\n            net.ipv4.conf.all.send_redirects = 0\n            EOT   \n            service network restart\n\nOutputs:\n  EC2Instance:\n    Description: EC2 instance VPCB-EC2 ID\n    Value: !Ref EC2Instance\n  EC2PublicIP:\n    Description: VPN Servers Public IP address\n    Value: !GetAtt EC2Instance.PublicIp\n</code></pre> <p>2VpnACfn.yaml</p> <pre><code>AWSTemplateFormatVersion : 2010-09-09\n\n# VPC A\nParameters:\n  # VPC A\n  VpcACidrBlock:\n    Description: VPC A CIDR Block\n    Type: String\n    Default: 10.100.0.0/16\n  # Customer Gateway A IP\n  CustomerGatewayIp:\n    Description: Gustomer Gateway IP from VPCB instance public IP\n    Type: String\n    Default: X.X.X.X\n  # Subnet A\n  SubnetACidrBlock:\n    Description: Subnet CIDR Block\n    Type: String\n    Default: 10.100.0.0/24\n  # EC2 Instance Type\n  InstanceType:\n    Description: EC2 Instance Type\n    Type: String\n    Default: t2.micro\n    ConstraintDescription: must be a valid EC2 instance type\n  # Key Pair Name\n  KeyName:\n    Description: Key Pair Name\n    Type: AWS::EC2::KeyPair::KeyName\n    Default: vpnint\n\nMappings:\n  # EC2 Instance image Map\n  RegionMap:\n    # eu-central-1:\n    #   hvm: \"ami-00e76d391403fc721\"\n    us-west-2:\n      hmv: \"ami-0b9f27b05e1de14e9\"\n\nResources:\n  # VPC\n  VPC:\n    Type: AWS::EC2::VPC\n    Properties:\n      CidrBlock: !Ref VpcACidrBlock\n      EnableDnsSupport: true\n      EnableDnsHostnames: true\n      Tags:\n        - Key: Name\n          Value: VPC-A\n  # Customer Gateway\n  CustomerGateway:\n    Type: AWS::EC2::CustomerGateway\n    Properties:\n      Type: ipsec.1\n      BgpAsn: 65000\n      IpAddress: !Ref CustomerGatewayIp\n      Tags:\n      - Key: Name\n        Value: \"VPC-A-CGW\"\n  # VPN Gateway\n  VPNGateway:\n    Type: AWS::EC2::VPNGateway\n    Properties:\n      Type: ipsec.1\n      Tags:\n      - Key: Name\n        Value: VPC-A-VGW\n  AttachVPNGateway:\n    Type: AWS::EC2::VPCGatewayAttachment\n    Properties:\n      VpcId: !Ref VPC\n      VpnGatewayId: !Ref VPNGateway\n  # VPN Connection\n  VPNConnection:\n    Type: AWS::EC2::VPNConnection\n    Properties:\n      Type: ipsec.1\n      StaticRoutesOnly: False\n      CustomerGatewayId: !Ref CustomerGateway\n      VpnGatewayId: !Ref VPNGateway\n      Tags:\n      - Key: Name\n        Value: VPCA-VPCB-VPN\n  # Subnet\n  Subnet:\n    Type: AWS::EC2::Subnet\n    Properties:\n      VpcId: !Ref VPC\n      CidrBlock: !Ref SubnetACidrBlock\n      MapPublicIpOnLaunch: False\n      Tags:\n      - Key: Name\n        Value: VPCA-Private-Subnet\n  # Route Table\n  RouteTable:\n    Type: AWS::EC2::RouteTable\n    Properties:\n      VpcId: !Ref VPC\n      Tags:\n      - Key: Name\n        Value: VPCA-Private-RT\n  RouteTableAssociation:\n    Type: AWS::EC2::SubnetRouteTableAssociation\n    Properties:\n      RouteTableId: !Ref RouteTable\n      SubnetId: !Ref Subnet\n  RoutePropagation:\n    Type: AWS::EC2::VPNGatewayRoutePropagation\n    DependsOn: AttachVPNGateway\n    Properties:\n      RouteTableIds:\n      - !Ref RouteTable\n      VpnGatewayId: !Ref VPNGateway\n  # EC2 Security Group\n  InstanceSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      VpcId: !Ref VPC\n      GroupDescription: TCP, ICMP\n      SecurityGroupIngress:\n      - IpProtocol: tcp\n        FromPort: -1\n        ToPort: -1\n        CidrIp: 10.200.0.0/16\n      - IpProtocol: icmp\n        FromPort: -1\n        ToPort: -1\n        CidrIp: 10.200.0.0/16\n      SecurityGroupEgress:\n      - IpProtocol: '-1'\n        CidrIp: 0.0.0.0/0\n      Tags:\n      - Key: Name\n        Value: VPCA-Private-EC2\n  # EC2 Instance\n  EC2Instance:\n    Type: AWS::EC2::Instance\n    Properties:\n      ImageId:\n        Fn::FindInMap: [RegionMap, Ref: AWS::Region, hvm]\n      InstanceType:\n        Ref: InstanceType\n      KeyName:\n        Ref: KeyName\n      Tags:\n      - Key: Name\n        Value: VPCA-Private-EC2\n      NetworkInterfaces:\n      - GroupSet:\n        - Ref: InstanceSecurityGroup\n        AssociatePublicIpAddress: false\n        DeviceIndex: 0\n        DeleteOnTermination: true\n        SubnetId: !Ref Subnet\n\nOutputs:\n  EC2Instance:\n    Description: EC2 instance VPCA-Private-EC2 ID\n    Value: !Ref EC2Instance\n</code></pre>"},{"location":"chap7/7tesla/","title":"7 Tesla","text":"<p>Instrumenting Ruby on Rails with Prometheus</p> <p>How To Use Prometheus Adapter to Autoscale Custom Metrics Deployments</p>"},{"location":"chap7/7tesla/#the-technical-problem","title":"The technical problem","text":"<p>Setup customizatized automatically HPA(horizontal Pod AutoScaler) infrastructure for our web application server pods based on a large amount of web server quests during a short of times. </p> <p>Our web application is running with Nginx server inside Kubernetes pod, we want to set up an automatically scaling up/down policy based on customized NGINX metrics for example when a large amount of requests come, we want our web application server will automatically scaling up and scaling down when requests dropping in the session of time.</p> <p>Default Kubernetes HPA policies are only based on CPU and memory.  We already installed Prometheus operator inside our cluster as our monitor tool, so I choose nginx-prometheus-exporter to export nignx service metrics, Prometheus scrape metrics from services, and prometheus-adpater pull metrics and APIServer expose metrics to be used by Horizontal Pod Autoscaling object.</p>"},{"location":"chap7/7tesla/#why-was-it-hard","title":"Why was it hard?","text":"<p>Normally we only use Prometheus/Granfana as monitor solutions and only use CPU and Memory to scale the deployment. How to combine two solutions to enable HPA inside the Kubernetes cluster needs strong experience on both Prometheus and Kubernetes, and the Prometheus-adapter is pretty complex</p>"},{"location":"chap7/7tesla/#how-did-solve-it","title":"How did solve it?","text":"<p>Inject <code>nginx-prometheus-exporter</code> as sidecar inside the web application pod to export niginx metrics to Prometheus, use <code>nginx_http_requests_total</code> as HPA metrics. And make sure Prometheus can collect all these nginx metrics.</p> <p>Config Prometheus adapter configmap for the metrics, like seriesQuery: <code>nginx_http_requests_total</code>, and create Prometheus adapater deployment, service and APIService</p> <p>Create Kubernetes HorizontalPodAutoscaler(HPA) to set up HPA policy based on the metrics name created by Prometheus adapter and we can also set up target value for the scaling up/down threshold.</p> <p>Then the Kubernetes API server will route the request to the Prometheus adapter custom API server to trigger the scaling actions.</p>"},{"location":"chap7/7tesla/#what-alternative-solutions-did-you-consider-and-why-didnt-you-choose-them","title":"What alternative solutions did you consider and why didn't you choose them?","text":"<p>KEDA is a Kubernetes-based Event Driven Autoscaler. KEDA can drive the scaling of any container in Kubernetes based on the number of events needing to be processed.</p> <p>KEDA main component Scaler represents event sources that KEDA can scale based on a queue services like AWS Kinesis Stream, Kafka topic, RabbiqMQ queue, Redis Streams. </p> <p>So this solution is better for backend services like queue consumers to do the SQL query job and need to set up another set metrics adapter, contoller and Scaler not perfect for front-end web service or web server as loadbalancer.</p>"},{"location":"chap7/7tesla/#difference-between-deployment-vs-statefulsets-vs-damemonset","title":"Difference between deployment vs StatefulSets vs Damemonset","text":""},{"location":"chap7/7tesla/#deployment","title":"Deployment","text":"<ul> <li>It will check that the desired state of ReplicaSet, so it will create a ReplicaSet,</li> <li>Deployments are usually used for stateless applications</li> <li>All the pods of deployment will be sharing the same Volume and  data across all of them will be the same which can lead to data inconsistency.</li> <li> <p>Deployments create a ReplicaSet which then creates a Pod so whenever you update the deployment using RollingUpdate(default) strategy</p> </li> <li> <p>pod\u4e4b\u95f4\u6ca1\u6709\u987a\u5e8f</p> </li> <li>\u6240\u6709pod\u5171\u4eab\u5b58\u50a8</li> <li>pod\u540d\u5b57\u5305\u542b\u968f\u673a\u6570\u5b57</li> <li>service\u90fd\u6709ClusterIP,\u53ef\u4ee5\u8d1f\u8f7d\u5747\u8861</li> </ul>"},{"location":"chap7/7tesla/#statefulsets","title":"StatefulSets","text":"<ul> <li>StatefulSet is a Kubernetes resource used to manage stateful applications</li> <li>Provides the guarantee about the ordering and uniqueness of these Pods.</li> <li>StatefulSet doesn\u2019t create ReplicaSet rather itself but creates the Pod with a unique naming convention. </li> <li>Every replica of a stateful set will have its own state, and each of the pods will be creating its own PVC(Persistent Volume Claim). </li> <li>StatefulSets don\u2019t create ReplicaSet so you can't roll back a StatefulSet to a previous version. You can only delete or scale up/down the Statefulset. </li> <li> <p>StatefulSets are useful in the case of Databases especially when we need Highly Available Databases in production</p> <ul> <li>Stable, unique network identifiers.</li> <li>Stable, persistent storage.</li> <li>Ordered, graceful deployment and scaling.</li> <li>Ordered, automated rolling updates.</li> </ul> </li> <li> <p>\u90e8\u7f72\u3001\u6269\u5c55\u3001\u66f4\u65b0\u3001\u5220\u9664\u90fd\u8981\u6709\u987a\u5e8f</p> </li> <li>\u6bcf\u4e2apod\u90fd\u6709\u81ea\u5df1\u5b58\u50a8\uff0c\u6240\u4ee5\u90fd\u7528volumeClaimTemplates\uff0c\u4e3a\u6bcf\u4e2apod\u90fd\u751f\u6210\u4e00\u4e2a\u81ea\u5df1\u7684\u5b58\u50a8\uff0c\u4fdd\u5b58\u81ea\u5df1\u7684\u72b6\u6001</li> <li>pod\u540d\u5b57\u59cb\u7ec8\u662f\u56fa\u5b9a\u7684</li> <li>service\u6ca1\u6709ClusterIP\uff0c\u662fheadlessservice\uff0c\u6240\u4ee5\u65e0\u6cd5\u8d1f\u8f7d\u5747\u8861\uff0c\u8fd4\u56de\u7684\u90fd\u662fpod\u540d\uff0c\u6240\u4ee5pod\u540d\u5b57\u90fd\u5fc5\u987b\u56fa\u5b9a\uff0c</li> <li>StatefulSet\u5728Headless Service\u7684\u57fa\u7840\u4e0a\u53c8\u4e3aStatefulSet\u63a7\u5236\u7684\u6bcf\u4e2aPod\u526f\u672c\u521b\u5efa\u4e86\u4e00\u4e2aDNS\u57df\u540d:<code>$(podname).(headless server name).namespace.svc.cluster.local</code></li> </ul>"},{"location":"chap7/7tesla/#damemonset","title":"Damemonset","text":"<ul> <li>pod runs on all the nodes of the cluster. If a node is added/removed from a cluster, DaemonSet automatically adds/deletes the pod.</li> <li>Daemonset automatically doesn\u2019t run on nodes that have a taint e.g. Master. You will have to specify the tolerations for it on the pod.</li> <li>All pods are sharing the same volume</li> <li>If you update a DaemonSet, it also performs RollingUpdate i.e. one pod will go down and the updated pod will come up</li> <li> <p>Some typical uses of a DaemonSet are:</p> <ul> <li>running a cluster storage daemon on every node \u6bd4\u5982 glusterd \u6216 ceph\u3002</li> <li>running a logs collection daemon on every node \u6bd4\u5982 flunentd \u6216 logstash\u3002</li> <li>running a node monitoring daemon on every node \u6bd4\u5982 Prometheus Node Exporter \u6216 collectd\u3002</li> </ul> </li> </ul>"},{"location":"chap7/7tesla/#difference-hardlink-and-symlink","title":"Difference hardlink and symlink","text":"<p>Linux\u7cfb\u7edf\u662f\u901a\u8fc7link\u7684\u6570\u91cf\u6765\u63a7\u5236\u6587\u4ef6\u5220\u9664\u7684\uff0c\u53ea\u6709\u5f53\u4e00\u4e2a\u6587\u4ef6\u4e0d\u5b58\u5728\u4efb\u4f55link\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u6587\u4ef6\u624d\u4f1a\u88ab\u5220\u9664\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\u6bcf\u4e2a\u6587\u4ef6\u4e24\u4e2alink\u8ba1\u6570\u5668\u6765\u63a7\u5236\uff1a<code>i_count</code>\u548c<code>i_nlink</code>\u3002</p> <ul> <li>\u5f53\u4e00\u4e2a\u6587\u4ef6\u88ab\u4e00\u4e2a\u7a0b\u5e8f\u5360\u7528\u7684\u65f6\u5019<code>i_count</code>\u5c31\u52a01\u3002</li> <li>\u5f53\u6587\u4ef6\u7684\u786c\u94fe\u63a5\u591a\u4e00\u4e2a\u7684\u65f6\u5019<code>i_nlink</code>\u4e5f\u52a01\u3002</li> <li> <p>\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\uff0c\u5c31\u662f\u8ba9\u8fd9\u4e2a\u6587\u4ef6\uff0c\u6ca1\u6709\u8fdb\u7a0b\u5360\u7528\uff0c\u540c\u65f6<code>i_link</code>\u6570\u91cf\u4e3a0\u3002</p> </li> <li> <p>\u9ed8\u8ba4\u4e0d\u5e26\u53c2\u6570\u7684\u60c5\u51b5\u4e0b\uff0cln\u521b\u5efa\u7684\u662f\u786c\u94fe\u63a5\uff0c\u5e26<code>-s</code>\u53c2\u6570\u7684ln\u547d\u4ee4\u521b\u5efa\u7684\u662f\u8f6f\u94fe\u63a5\u3002</p> </li> <li>\u786c\u94fe\u63a5\u6587\u4ef6\u4e0e\u6e90\u6587\u4ef6\u7684inode\u8282\u70b9\u53f7\u76f8\u540c\uff0c\u800c\u8f6f\u94fe\u63a5\u6587\u4ef6\u7684<code>inode</code>\u8282\u70b9\u53f7\uff0c\u4e0e\u6e90\u6587\u4ef6\u4e0d\u540c</li> <li>ln\u547d\u4ee4\u4e0d\u80fd\u5bf9\u76ee\u5f55\u521b\u5efa\u786c\u94fe\u63a5\uff0c\u4f46\u53ef\u4ee5\u521b\u5efa\u8f6f\u94fe\u63a5\u3002\u5bf9\u76ee\u5f55\u7684\u8f6f\u94fe\u63a5\u4f1a\u7ecf\u5e38\u4f7f\u7528\u5230\u3002</li> <li>\u5220\u9664\u6587\u4ef6<ul> <li>\u5220\u9664\u8f6f\u94fe\u63a5\u6587\u4ef6\uff0c\u5bf9\u6e90\u6587\u4ef6\u548c\u786c\u94fe\u63a5\u6587\u4ef6\u65e0\u4efb\u4f55\u5f71\u54cd\u3002</li> <li>\u5220\u9664\u6587\u4ef6\u7684\u786c\u94fe\u63a5\u6587\u4ef6\uff0c\u5bf9\u6e90\u6587\u4ef6\u53ca\u8f6f\u94fe\u63a5\u6587\u4ef6\u65e0\u4efb\u4f55\u5f71\u54cd\u3002</li> <li>\u5220\u9664\u94fe\u63a5\u6587\u4ef6\u7684\u6e90\u6587\u4ef6\uff0c\u5bf9\u786c\u94fe\u63a5\u6587\u4ef6\u65e0\u5f71\u54cd\uff0c\u4f1a\u5bfc\u81f4\u5176\u8f6f\u94fe\u63a5\u5931\u6548\uff08\u7ea2\u5e95\u767d\u5b57\u95ea\u70c1\u72b6\uff09</li> <li>\u540c\u65f6\u5220\u9664\u6e90\u6587\u4ef6\u53ca\u5176\u786c\u94fe\u63a5\u6587\u4ef6\uff0c\u6574\u4e2a\u6587\u4ef6\u624d\u4f1a\u88ab\u771f\u6b63\u7684\u5220\u9664\u3002</li> </ul> </li> <li>\u5f88\u591a\u786c\u4ef6\u8bbe\u5907\u7684\u5feb\u7167\u529f\u80fd\uff0c\u4f7f\u7528\u7684\u5c31\u662f\u7c7b\u4f3c\u786c\u94fe\u63a5\u7684\u539f\u7406</li> </ul>"},{"location":"chap7/7tesla/#how-to-block-one-port-on-server","title":"How to block one port on server","text":"<pre><code>$ iptables -t nat -A PREROUTING -d 10.0.0.254 -p tcp --dprot 80 -j DNAT --to-destination 10.0.0.254:8080\n</code></pre> <ul> <li><code>-t</code>\uff1a\u6307\u5b9a\u9700\u8981\u7ef4\u62a4\u7684\u9632\u706b\u5899\u89c4\u5219\u8868 filter\u3001nat\u3001mangle\u6216raw\u3002\u5728\u4e0d\u4f7f\u7528 <code>-t</code> \u65f6\u5219\u9ed8\u8ba4\u4f7f\u7528 filter \u8868\u3002</li> <li><code>-d</code>, <code>--destination</code>: Destination specification</li> <li><code>--to-destination</code>: This allows you to DNAT connections in a round-robin way over a given range of destination addresses.</li> </ul>"},{"location":"chap7/7tesla/#whats-proc-folder-in-linux","title":"Whats proc folder in Linux","text":"<p>It is a Virtual File System. </p> <p>Contained within the procfs are information about processes and other system information. It is mapped to <code>/proc</code> and mounted at boot time.</p> <p>The files contain system information such as memory (meminfo), CPU information (cpuinfo), and available filesystems.</p> <ul> <li>/proc/cmdline \u2013 Kernel command line information.</li> <li>/proc/console \u2013 Information about current consoles including tty.</li> <li>/proc/devices \u2013 Device drivers currently configured for the running kernel.</li> <li>/proc/dma \u2013 Info about current DMA channels.</li> <li>/proc/fb \u2013 Framebuffer devices.</li> <li>/proc/filesystems \u2013 Current filesystems supported by the kernel.</li> <li>/proc/iomem \u2013 Current system memory map for devices.</li> <li>/proc/ioports \u2013 Registered port regions for input output communication with device.</li> <li>/proc/loadavg \u2013 System load average.</li> <li>/proc/locks \u2013 Files currently locked by kernel.</li> <li>/proc/meminfo \u2013 Info about system memory (see above example).</li> <li>/proc/misc \u2013 Miscellaneous drivers registered for miscellaneous major device.</li> <li>/proc/modules \u2013 Currently loaded kernel modules.</li> <li>/proc/mounts \u2013 List of all mounts in use by system.</li> <li>/proc/partitions \u2013 Detailed info about partitions available to the system.</li> <li>/proc/pci \u2013 Information about every PCI device.</li> <li>/proc/stat \u2013 Record or various statistics kept from last reboot.</li> <li>/proc/swap \u2013 Information about swap space.</li> <li>/proc/uptime \u2013 Uptime information (in seconds).</li> <li>/proc/version \u2013 Kernel version, gcc version, and Linux distribution installed.</li> </ul>"},{"location":"chap7/7tesla/#find-the-most-n-repeated-word-in-a-string","title":"Find the most n repeated word in a string","text":"<p>N largest values in dictionary</p> <pre><code>from collections import Counter\n\ndef getNthFrequency(str, n):\n    array = str.split(' ')\n    res_array = []\n    i = 1\n    # return array\n    res_dict = dict(Counter(array))\n    # return result\n    while i &lt;= n:\n        maximum_key = max(res_dict, key=res_dict.get)\n        res_array.append(maximum_key)\n        res_dict.pop(maximum_key)\n        i += 1\n\n    return res_array\n\n\nif __name__ == '__main__':\n    str = \"In this program, to use Counter, we have to import it from the collections class in our program. Since Counter works for hashable objects they are accessed using a key. We can get the Key using the get method.\"\n    print(getNthFrequency(str,2))\n</code></pre> <p><code>['the', 'to']</code></p> <pre><code>from collections import Counter\nfrom heapq import nlargest\n\n\ndef getNthFrequency(str, N):\n    array = str.split(' ')\n    res_array = []\n    i = 1\n    # return array\n    res_dict = dict(Counter(array))\n    # N largest values in dictionary\n    # Using nlargest\n    res = nlargest(N, res_dict, key = res_dict.get)\n    return res \n\nif __name__ == '__main__':\n    str = \"In this program, to use Counter, we have to import it from the collections class in our program. Since Counter works for hashable objects they are accessed using a key. We can get the Key using the get method.\"\n    print(getNthFrequency(str,3))\n</code></pre> <pre><code>['the', 'to', 'using']\n</code></pre>"},{"location":"chap7/Arch_anws/","title":"\u67b6\u6784\u5e08\u9762\u8bd5\u5408\u96c6","text":""},{"location":"chap7/Arch_anws/#redis","title":"Redis \u9762\u8bd5","text":""},{"location":"chap7/Arch_anws/#1","title":"1 \u6d41\u91cf\u6d2a\u5cf0\u77ed\u65f6\u95f4\u8bbf\u95ee\u91cf\u9661\u589e","text":"<ul> <li>\u670d\u52a1\u5668\u625b\u4e0d\u4f4f\uff0c\u670d\u52a1\u5668\u5c31\u5bb9\u6613\u51fa\u73b0\u8fd9\u4e2a\u6027\u80fd\u74f6\u9888\u6765\u4e0d\u53ca\u54cd\u5e94</li> </ul> <p>\u89e3\u51b3\u65b9\u6848</p> <ol> <li> <p>\u4e3a\u4e86\u4fdd\u969c\u6574\u4e2a\u670d\u52a1\u7684\u4e0d\u88ab\u6d41\u91cf\u6d2a\u5cf0\u6240\u51fb\u57ae\uff0c\u90a3\u6211\u4eec\u5728\u8fd9\u4e2a\u7f51\u5173\u5c42\u5462\u5c31\u5fc5\u987b\u505a\u4e00\u4e2a\u6d41\u91cf\u7684\u9650\u5236\u3002\u6b64\u5982\u8bf4\u8bbe\u7f6e\u547d\u724c\u7b52token bucket\u7684\u7b97\u6cd5\u5728\u89c4\u5b9a\u7684\u65f6\u95f4\u5185, \u5141\u8bb8\u4e00\u5b9a\u91cf\u7684\u8fd9\u4e2a\u6d41\u91cf\u7684\u6d8c\u5165\uff0c \u5269\u4f59\u7684\u8fd9\u4e2a\u8bf7\u6c42\u9700\u8981\u4f9d\u6b21\u6392\u961f\u3002</p> <ul> <li>\u5728\u7528\u6237\u624b\u673a\u7aef\u5462\u5c31\u662f\u7b49\u5f85\u8d85\u65f6\uff0c\u7a0d\u540e\u518d\u8bd5\u4e00\u4e9b\u63d0\u793a</li> <li>\u7b2c\u4e8c\u5c31\u662f\u5e94\u7528\u7684\u5d29\u6e83</li> </ul> </li> <li> <p>\u62b5\u6321\u4e0d\u4e86\u90a3\u4e48\u5927\u7684\u6d41\u91cf\u5e76\u53d1\uff0c\u5b9e\u9645\u7684\u5e76\u53d1\u91cf\u8fdc\u8fdc\u8d85\u8fc7\u7406\u8bba\u4e0a\u7684\u8fd9\u4e2a\u6700\u9ad8\u7684\u5e76\u53d1\u91cf\uff0c\u800c\u8fd0\u7ef4\u4eba\u5458\u7684\u6269\u5bb9\u662f\u9700\u8981\u65f6\u95f4\u54cd\u5e94\u6216\u8005\u5462\u6ca1\u6709\u4e0a\u4e91\u670d\u52a1\u7684\u5f39\u6027\u6269\u5bb9\u3002 \u6ca1\u6709\u529e\u6cd5\u6839\u636e\u6d41\u91cf\u6765\u52a8\u6001\u7684\u589e\u52a0\u76f8\u5e94\u7684\u673a\u5668\u6765\u4fdd\u969c\u670d\u52a1\uff0c\u5c31\u662f\u62b5\u6321\u4e0d\u4e86\u6d41\u91cf\u6d2a\u5cf0\uff0c\u5e94\u7528\u5d29\u6e83</p> </li> <li> <p>\u7b2c\u4e09\u70b9\u5c31\u662f\u6570\u636e\u5e93\u7684\u6027\u80fd\u74f6\u9888\uff0c\u6570\u636e\u5e93\u96c6\u7fa4\u7684\u8bfb\u5199\u5206\u79bb\u3002\u6ee1\u8db3\u4e0d\u4e86\u8db3\u591f\u591a\u7684\u6570\u636e\u8bf7\u6c42\u3002\u8981\u589e\u52a0\u4e00\u4e9b\u6570\u636e\u5e93\u7684\u670d\u52a1\u5668\u3002\u6bd4\u5982\u8bf4\u589e\u52a0\u7f13\u5b58\u670d\u52a1\u5668\uff0c\u5c31\u662f\u505a\u4e00\u4e9b\u63d0\u524d\u7684\u8ba1\u7b97\u3002</p> <ul> <li>\u7528\u6237\u53ea\u8981\u4e00\u4e00\u6709\u8bf7\u6c42\uff0c\u670d\u52a1\u5668\u5c31\u80fd\u591f\u7acb\u9a6c\u54cd\u5e94\u3002\u4ee5\u7a7a\u95f4\u6362\u65f6\u95f4\u7684\u8fd9\u4e48\u4e00\u4e2a\u505a\u6cd5</li> </ul> </li> <li>\u7b2c\u56db\u70b9\u5462\u5c31\u662f\u7b2c\u4e09\u65b9\u6570\u636e\u63a5\u53e3\u7684\u5d29\u6e83\u3002\u5065\u5eb7\u7801\u5173\u8054\u7684\u5f88\u591a\u7684\u6570\u636e\uff0c\u5173\u8054\u670d\u52a1\u7684\u8c03\u7528\u3002\u5982\u679c\u7b2c\u4e09\u65b9\u7684\u8fd9\u4e2a\u6570\u636e\u63a5\u53e3\u625b\u4e0d\u4f4f\u8fd9\u4e48\u5927\u7684\u8fd9\u4e2a\u5e76\u53d1\u8bf7\u6c42\u5c31\u4f1a\u5bfc\u81f4\u8c03\u7528\u7684\u8d85\u65f6\u670d\u52a1\u7684\u4e0d\u53ef\u7528</li> </ol>"},{"location":"chap7/Arch_anws/#2","title":"2 \u5fc5\u987b\u8981\u638c\u63e1\u7684\u6570\u636e\u5e93\u4f18\u5316\u6280\u5de7","text":"<p>\u8fd9\u4e09\u4e2a\u6570\u636e\u5e93\u8bbe\u8ba1\u7684\u8981\u70b9\u5fc5\u987b\u638c\u63e1, \u5206\u522b\u662f\u4e3b\u4ece\u590d\u5236,\u8bfb\u5199\u5206\u79bb, \u5206\u5e93\u5206\u8868, \u5c31\u9700\u8981\u53bb\u8003\u8651\u589e\u52a0\u6570\u636e\u5e93\u670d\u52a1\u5668\u3002</p> <p>\u4e00\u822c\u7684\u8fd9\u4e2a\u4e1a\u52a1\u7cfb\u7edf, \u90fd\u662f\u8bfb\u591a\u5199\u5c11\u3002 \u4e00\u822c\u90fd\u4f1a\u91c7\u7528\u4e00\u4e3b\u591a\u4ece\u7684\u6570\u636e\u5e93\u67b6\u6784\uff0c\u4e00\u4e2a\u4e3b\u5e93\u642d\u914d\u591a\u4e2a\u4ece\u5e93\uff0c\u90a3\u4e3b\u5e93\u8d1f\u8d23\u5199\uff0c\u4ece\u5e93\u8d1f\u8d23\u8bfb\u3002\u5728\u8bfb\u5199\u7684\u65f6\u5019\uff0c\u901a\u8fc7\u89e6\u53d1\u5668\u6765\u5224\u5b9a\u8bfb\u8fd8\u662f\u5199\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u5e38\u8bf4\u7684\u8bfb\u5199\u5206\u79bb</p> <p>\u8bfb\u5199\u5206\u79bb</p> <p>\u5c31\u53ef\u4ee5\u5927\u5927\u7684\u63d0\u9ad8\u4e86\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u67e5\u8be2\u6548\u7387\u53c8\u53ef\u4ee5\u964d\u4f4e\u5355\u5e93\u8bfb\u5199\u5e26\u6765\u7684\u8fd9\u4e2a\u5e76\u53d1\u6c96\u7a81. \u591a\u4e2a\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u6570\u636e\u540c\u6b65\u600e\u4e48\u529e? \u4e3b\u4ece\u540c\u6b65\u7684\u539f\u7406\u6570\u636e\u5e93\u707e\u96be\u7684\u6062\u590d\u7684\u539f\u7406\u662f\u4e00\u81f4\u7684. \u90fd\u662f\u901a\u8fc7\u65e5\u5fd7, \u5c06\u8bb0\u5f55\u7684\u6240\u6709\u7684\u8fd9\u4e2adml\u64cd\u4f5c\u91cd\u65b0\u6267\u884c\u2014\u904d. \u6bd4\u5982\u8bf4Mysql \u90a3\u4e3b\u5e93\u6240\u6709\u7684\u589e\u5220\u6539, \u90fd\u4f1a\u5b58\u50a8\u5728\u8fd9\u4e2abinlog \u4e2d. \u5c31\u53ef\u4ee5\u628a\u6240\u6709\u7684\u8fd9\u4e2a\u6570\u636e\u5e93\u64cd\u4f5c, \u4ece\u5e93\u4e0a\u9762\u5168\u90e8\u6267\u884c\u4e00\u904d, \u8fd9\u6837\u5c31\u4f1a\u8f7b\u677e\u7684\u89e3\u6c7a\u6570\u636e\u540c\u6b65\u7684\u95f4\u9898</p> <p>\u5206\u5e93</p> <p>\u5982\u4f55\u5b58\u50a8\u5e73\u53f0\u7684\u8fd9\u4e2a\u5927\u6570\u636e\u91cf,\u5355\u4e2a\u7684\u8fd9\u4e2a\u5173\u7cfb\u6570\u636e\u5e93\u7684\u5bb9\u91cf\u662f\u6709\u9650\u7684\u65e0\u6cd5\u5b58\u653e\u5168\u90e8\u7684\u6570\u636e, \u56e0\u6b64\u9700\u8981\u5206\u800c\u6cbb\u4e4b,  \u5c31\u662f\u5e38\u8bf4\u5206\u5e93\u5206\u8868.  \u6839\u636e\u6570\u636e\u7684\u79cd\u7c7b\u4e0d\u540c,\u53ef\u4ee5\u4ee5\u5efa\u7acb\u591a\u4ecb\u6570\u636e\u5e93, \u5355\u4e2a\u6570\u636e\u5e93\u5462\u4ec5\u5b58\u653e\u4e00\u79cd\u7c7b\u522b\u7684\u6570\u636e. \u5546\u54c1\u6570\u636e, \u7528\u6237\u6570\u636e, \u7269\u6d41\u6570\u636e\u7b49\u7b49\u90a3\u4e48\u5c31\u53ef\u4ee5\u5206\u522b\u521b\u5efa\u8fd9\u4e09\u4e2a\u6570\u636e\u5e93\uff0c\u6765\u5b58\u653e\u8fd9\u4e09\u7c7b\u6570\u636e</p> <p>\u5206\u8868</p> <p>\u5206\u8868\u5c31\u662f\u628a\u539f\u5148\u7684\u4e00\u5f20\u5927\u8868\uff0c\u6309\u7167\u6c34\u5e73\u62c6\u5206\u7684\u65b9\u5f0f\u4ea7\u751f\u591a\u4e2a\u6570\u636e\u8868\u3002\u53ef\u4ee5\u6309\u65f6\u95f4\u62c6\u5206\uff0c\u54c8\u897f\u62c6\u5206\uff0c\u53ef\u4ee5\u53d6\u4f59\u7684\u65b9\u5f0f\u62c6\u5206\u7b49\u7b49\u3002 </p> <p>\u8981\u6839\u636e\u5b9e\u9645\u7684\u8fd9\u4e2a\u4e1a\u52a1\uff0c\u6765\u505a\u4e00\u4e9b\u53d6\u820d\uff0c\u8fd9\u4e2a\u5206\u8868\u540e\u7684\u4e00\u4e2a\u5173\u8054\u67e5\u8be2\u7684\u95ee\u9898\u56e0\u4e3a\u6570\u636e\u5206\u6563\u5728\u591a\u4e2a\u8868\u4e2d\u3002\u8981\u63d0\u524d\u6309\u7167\u7b56\u8def\u627e\u5230\u6570\u636e\u6240\u5728\u7684\u8fd9\u4e2a\u6570\u636e\u8868\uff0c\u624d\u80fd\u8fdb\u884c\u540e\u7eed\u7684\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u64cd\u4f5c</p>"},{"location":"chap7/Arch_anws/#3-redis-keyvalue","title":"3 Redis \u70edkey\u548c\u5927value","text":"<p>redis \u7684\u70edkey\u548c\u5927value\u5982\u679c\u5904\u7406\u4e0d\u597d\u9020\u6210\u7684\u7ebf\u4e0a\u95ee\u9898\u3002\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u50cfredis\u96c6\u7fa4\u4e2d\uff0c\u6570\u636e\u90fd\u662f\u6bd4\u8f83\u5747\u52fb\u7684\uff0c\u5206\u5e03\u5728\u6bcf\u4e00\u4e2a\u8282\u70b9\u3002\u8bf7\u6c42\u4e5f\u4f1a\u5747\u52fb\u7684\u5206\u5e03\u5230\u6bcf\u4e00\u4e2a\u5206\u7247\u4e0a\uff0c \u4f46\u662f\u4e00\u4e9b\u7279\u6b8a\u7684\u573a\u666f\u4e2d\u3002\u6bd4\u5982\u8bf4\u5916\u90e8\u7684\u722c\u866b\uff0c \u653b\u51fb\u554a\u70ed\u70b9\u5546\u54c1\u7b49\u7b49\u554a\u3002</p> <p>\u90a3\u4e48\u8fd9\u79cd\u77ed\u65f6\u95f4\u5185\uff0c\u67d0\u4e9bkey\u8bbf\u95ee\u91cf\u8fc7\u5927\u7136\u540e\u8bf7\u6c42\u5230\u540c\u4e00\u53f0\u6570\u636e\u5206\u7247\u4e0a\uff0c\u6700\u7ec8\u5bfc\u81f4\u8be5\u5206\u7247\u4e0d\u582a\u91cd\u8d1f\uff0c\u6210\u4e3a\u74f6\u9888\uff0c\u6700\u7ec8\u5c06\u4f1a\u5bfc\u81f4\u7f13\u5b58\u96ea\u5d29</p> <p>\u90a3\u4e48\u600e\u4e48\u76d1\u6d4b\u70ed key</p> <p>\u5e38\u89c4\u5c31\u662f\u6839\u636e\u4e1a\u52a1\u4ee5\u5f80\u7684\u6570\u636e\u505a\u4e00\u4e2a\u5224\u5b9a\uff0c\u6bd4\u5982\u8bf4\u6211\u4eec\u7684\u4fc3\u9500\u6d3b\u52a8\uff0c\u6216\u8005\u5728\u8c03\u7528redis\u7684\u65f6\u5019\uff0c\u5199\u4e00\u4e2a\u65b9\u6cd5\u6765\u5224\u5b9a\u5982\u679c\u89c1\u5230\u5230\u67d0 1 key \u7684 qps \u5982\u679c\u8fbe\u5230\u4e86\u8fd9\u4ecb 1000 \u53ef\u80fd\u5c31\u662f\u4e00\u4e2a\u70ed key</p> <p>\u90a3\u4e48\u600e\u4e48\u89e3\u51b3\u70edkey</p> <p>\u53ef\u4ee5\u6269\u5bb9\uff0c\u589e\u52a0\u5206\u7247\u3002\u526f\u672c\u591a\u4e86\uff0c\u81ea\u7136\u538b\u529b\u5c31\u5206\u62c5\u4e86\u4e00\u4e9b\u3002\u9632\u6b62\u5355\u4e2a\u673a\u5668\u6253\u6302\u3002 </p> <p>\u8fd8\u6709\u4e00\u79cd\u5462\u5c31\u662f\u4f7f\u7528\u8fd9\u4e2a\u4e8c\u7ea7\u7f13\u5b58\uff0c \u628a\u70ed\u70b9\u6570\u636e\u5462\u653e\u5230 jvm \u7684\u672c\u5730\u7f13\u5b58\u4e2d\u3002 \u672c\u5730\u7f13\u5b58\u5462\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2acaffeine, guava. \u8fd9\u6837\u5c31\u76f4\u63a5\u8bfb\u5230\u4e86\u672c\u5730\u7f13\u5b58\u4e86, \u4e0d\u9700\u8981\u518d\u53bb\u8bf7\u6c42 redis. \u5c31\u7701\u53bb\u4e86\u4e00\u6b21\u8fd9\u4e2a\u8fdc\u7a0b\u7684io\u8c03\u7528, \u540c\u6837\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u6846\u67b6, jd-hotkey \u4f1a\u81ea\u52a8\u7684\u53bb\u76d1\u6d4b\u4f60\u7684\u71b1 key\u5e76\u4e14\u8f6c\u4e3aivm\u672c\u5730\u7f13\u5b58</p>"},{"location":"chap7/Arch_anws/#4-redistvalue","title":"4 redist\u7684\u5927value","text":"<p>\u6709\u65f6\u5019\u4f1a\u628a\u4e00\u4e2a\u5f88\u5927\u7684\u503c\u585e\u5230\u540c\u4e00\u4e2aKey\u4e2d\uff0c \u6bd4\u5982\u8bf4 string \u7c7b\u578b\u5c31\u4f1a\u585e \u4e00\u4ecb\u5f88\u5927\u7684\u5b87\u7b26\u4e32\u6587\u672c\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e9b\u8fd9\u4e2a\u96c6\u5408\u7c7b\u7684ist\uff0cset\u52a8\u4e0d\u52a8\u5c31\u4f1a\u585e\u4e2a\u51e0\u4e07\u6761\u7684\u6570\u636e\u3002 </p> <p>\u90a3\u4e48\u8fd9\u4e9b\u5927valure\uff0c \u5728\u9879\u76ee\u524d\u671f\u53ef\u80fd\u4e0d\u5bb9\u6613\u53d1\u73b0\uff0c\u4f46\u662f\u4e00\u65e6\u5e76\u53d1\u91cf\u5927\u4e86\u4e4b\u540e\uff0c\u5c31\u4f1a\u66b4\u9732\u5f88\u591a\u7684\u95ee\u9898\u4ece\u800c\u6210\u4e3a\u670d\u52a1\u5668\u7684\u6740\u624b\u3002</p> <p>\u6bd4\u5982\u8bf4\u6570\u636e\u503e\u659c\uff0c\u90a3\u4e48\u5927\u7684Value\u4f1a\u5bfc\u81f4\u96c6\u7fa4, \u4e0d\u540c\u7684\u8282\u70b9\u7684\u6570\u636e\u5206\u5e03\u4e0d\u5747\u5300.\u90a3\u4e48\u6709\u7684\u591a\u6709\u7684\u5c11, \u4f1a\u9020\u6210\u6570\u636e\u503e\u659c\u7684\u5411\u9898. \u5927\u91cf\u8bfb\u5199\u6bd4\u4f8b\u975e\u5e38\u9ad8\u7684\u8bf7\u6c42\uff0c\u5c31\u4f1a\u843d\u5230\u540c\u4e00\u4e2a\u8282\u70b9\u4e0a\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8303\u70b9\u7684\u8d1f\u8f7d\uff0c\u5c31\u4f1a\u4e25\u91cd\u7684\u5347\u9ad8\uff0c\u5bb9\u6613\u6253\u6302\u3002</p> <p>\u53e6\u5916\u5927value, \u5728\u67e5\u8be2\u7684\u65f6\u5019\u5462\u4f1a\u5360\u7528 redis server\u7684\u7f13\u5b58, \u5c31\u4f1a\u5bfc\u81f4redis \u670d\u52a1\u5668\u7684\u7f13\u51b2\u533a\u4e0d\u8db3 ,\u5927\u91cf\u7684\u8bf7\u6c42\u5c31\u4f1a\u51fa\u73b0\u8d85\u65f6\u7684\u73b0\u8c61. \u6570\u636e\u5e93\u5c42\u88ab\u51fb\u7a7f\u7684\u8fde\u9501\u53cd\u5e94</p> <p>\u600e\u4e48\u89e3\u6c7a\uff1a \u62c6</p> <p>\u628a\u4f60\u7684\u5927value, \u5927list\u62c6\u6210\u591a\u4e2akey-value. \u5c06\u64cd\u4f5c\u538b\u529b\uff0c\u5e73\u644a\u5230\u591a\u4e2a redis \u5b9e\u4f8b\u4e2d\uff0c\u964d\u4f4e\u5bf9\u5355\u4e2a\u8282\u70b9\u7684 IO\u5f71\u54cd. \u53ef\u4ee5\u4f7f\u7528\u54c8\u897f\u7b97\u6cd5\u53bb\u62c6, \u4f7f\u7528\u8fd9\u4e2a\u53d6\u6a21\u7684\u7b97\u6cd5\u53bb\u62c6\uff0c \u6838\u5fc3\u7684\u601d\u60f3\u662f\u5c06value\u6253\u6563\u3002\u6bcf\u6b21\u53eaget \u4f60\u9700\u8981\u7684\u6570\u636e\uff0c\u7c7b\u4f3c\u4e8e\u6570\u636e\u5e93\u4e2d\u7684\u5206\u5e93\u5206\u8868</p>"},{"location":"chap7/Arch_anws/#5-redis","title":"5 Redis \u7f13\u5b58\u96ea\u5d29","text":"<p>\u4ec0\u4e48\u662f\u7f13\u5b58\u96ea\u5d29</p> <p>\u5927\u91cf\u7684\u67e5\u8be2\u8bf7\u6c42\uff0c\u5728redis\u5c42\u627e\u4e0d\u5230\u6570\u636e\uff0c\u5c31\u4f1a\u6e17\u900f\u5230\u6570\u636e\u5e93\u5c42\uff0c\u90a3\u4e48\u6570\u636e\u5e93\u77ed\u65f6\u95ee\u5185\u538b\u529b\u5c71\u5927\u3002\u5927\u91cf\u7684\u8bf7\u6c42\u4f1a\u9020\u6210\u67e5\u8be2\u963b\u585e\uff0c\u628a\u6570\u636e\u5e93\u62d6\u6b7b\u4e86\u3002</p> <p>\u600e\u4e48\u5f15\u8d77\u7684\u7f13\u9707\u96ea\u5d29</p> <p>\u5927\u6279\u91cf\u7684\u70ed\u70b9\u6570\u636e\u7684\u8fc7\u671f\uff0c\u90a3\u4e48\u70ed\u70b9\u6570\u636e\u4e00\u65e6\u8fc7\u671f\uff0c\u81ea\u7136\u5728redis\u91cc\u9762\u5c31\u67e5\u4e0d\u5230\u6570\u636e\uff0c\u5c31\u4f1a\u56de\u6e90\u6570\u636e\u5e93\u3002\u90a3\u4e48\u5927\u4e95\u53d1\u91cf\u7684\u8bf7\u6c42\uff0c \u5728\u77ac\u95f4\u5c31\u4f1a\u538b\u5230\u6570\u636e\u5e93\u4e0a</p> <p>\u53e6\u4e00\u4e2a\u539f\u56e0</p> <p>\u5c31\u662fredis\u5b9e\u4f8b\u53d1\u751f\u4e86\u6545\u969c\uff0c\u90a3\u4e48\u65e0\u6cd5\u5904\u7406\u8bf7\u6c42\uff0c\u4ed6\u62d6\u6b7b\u4e86Redis\u7684\u8282\u70b9\uff0c\u90a3\u4e48\u4e5f\u4f1a\u5bfc\u81f4\u5927\u91cf\u7684\u8bf7\u6c42\u79ef\u538b\u5230\u6570\u636e\u5e93\u5c42\uff0c </p> <p>\u90a3\u4e48\u5bf9\u4e8e\u6570\u636e\u8fc7\u671f\uff0c\u53ef\u4ee5\u4f7f\u7528\u5dee\u5f02\u5316\u53bb\u5b9a\u4e49\u7f13\u5b58\u8fc7\u671f\u65f6\u95f4\uff0c\u90a3\u4e0d\u8981\u628a\u5927\u91cf\u7684key \u5728\u540c\u4e00\u4e2a\u65f6\u95f4\u5185\u8fc7\u671f\u3002 \u6bd4\u5982\u8bf4\u5728\u521d\u59cb\u5316\u7f13\u5b58\u7684\u540c\u65f6\uff0c \u7ed9\u8fd9\u4e9b\u6570\u636e\u8fc7\u671f\u65f6\u95f4\u589e\u52a0\u4e00\u4e2a\u6bd4\u8f83\u5c0f\u7684\u4e00\u4e2a\u968f\u673a\u6570\uff0c\u53ef\u4ee5\u907f\u514d\u4e86\u5927\u91cf\u7684\u6570\u636e\u540c\u65f6\u8fc7\u671f\u3002\u53c8\u80fd\u4fdd\u8bc1\u8fd9\u4e9b\u6570\u636e\u5728\u76f8\u8fd1\u7684\u65f6\u95f4\u5185\u5931\u6548</p> <p>\u540c\u65f6\u5462\u6211\u4eec\u4e5f\u53ef\u4ee5\u8ba9\u8fd9\u4e2a\u670d\u52a1\u964d\u7ea7\uff0c \u5141\u8bb8\u6838\u5fc3\u4e1a\u52a1\u8bbf\u95ee\u6570\u636e\u5e93\uff0c\u975e\u6838\u5fc3\u4e1a\u52a1\u76f4\u63a5\u8fd4\u56de\u4e8b\u5148\u5b9a\u4e49\u597d\u7684\u4fe1\u606f\u3002 \u90a3\u4e48\u9488\u5bf9 redis\u670d\u52a1\u5b95\u673a\uff0c\u53ef\u4ee5\u505a\u8fd9\u4e2a\u8bf7\u6c42\u9650\u6d41\u5bf9\u3002</p> <p>\u63a7\u5236\u6bcf\u79d2\u8fdb\u5165\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd9\u4e2a\u8bf7\u6c42\u6570\uff0c\u907f\u514d\u8fc7\u591a\u7684\u8bf7\u6c42\u538b\u5230\u6570\u636e\u5e93\u53ef\u4ee5\u505a\u670d\u52a1\u7194\u65ad\u3002</p> <p>\u6682\u505c\u4e1a\u52a1\u7684\u5e94\u7528\uff0c\u5bf9\u7f13\u5b58\u670d\u52a1\u7684\u8bbf\u95ee\uff0c\u5148\u8d70ivm\u7f13\u5b58\uff0c\u4ece\u800c\u964d\u4f4e\u5bf9\u6570\u636e\u5e93\u7684\u538b\u529b\u5f53\u7136\u8fd9\u4e9b\u90fd\u662f\u6743\u76ca\u4e4b\u8ba1\u8fd8\u662f\u8981\u4fdd\u8bc1redis\u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u90a3\u4e48\u4e3b\u8282\u70b9\u4e00\u65e6\u5b95\u673a\uff0c\u90a3\u4e48\u4ece\u8282\u70b9\u5c31\u53ef\u4ee5\u5feb\u901f\u7684\u5207\u6362\u5230\u4e3b\u8282\u70b9\u90a3\u4e48\u7ee7\u7eed\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1</p>"},{"location":"chap7/Arch_anws/#6-redis","title":"6 Redis\u7f13\u5b58\u7a7f\u900f","text":"<p>\u4ec0\u4e48\u662f\u7f13\u5b58\u7a7f\u900f\uff0c\u7b80\u5355\u6765\u8bb2\u5c31\u662f\u5728\u67e5\u627e\u8fd9\u4e2a key \u5728\u7f13\u5b58\u548c\u6570\u636e\u5e93\u4e2d\u90fd\u4e0d\u5b58\u5728\u3002\u5bfc\u81f4\u6bcf\u6b21\u8bf7\u6c42\u6570\u636e\uff0c \u4ece\u7f13\u5b58\u4e2d\u90fd\u83b7\u53d6\u4e0d\u5230\uff0c \u4ece\u800c\u5c06\u8fd9\u4e2a\u8bf7\u6c42\u6253\u5230\u6570\u636e\u5e93\u4e0a\uff0c\u4f46\u6570\u636e\u5e93\u4e2d\u4e5f\u6ca1\u6709\u5bf9\u5e94\u7684\u6570\u636e\u3002 \u5c31\u662f\u6bcf\u4e00\u6b21\u8bf7\u6c42\uff0c\u90fd\u76f4\u63a5\u6253\u5728\u6570\u636e\u5e93\u4e0a\u9762\u7f13\u5b58\u4e0d\u8d77\u4efb\u4f55\u7684\u4f5c\u7528\u3002 \u90a3\u4e48\u4e00\u65e6\u5e76\u53d1\u91cf\u4e0a\u6765\u4e4b\u540e\uff0c \u6570\u636e\u5e93\u538b\u529b\u5c31\u5927\u4e86</p> <p>\u7f13\u5b58\u7a7f\u900f\u662f\u600e\u4e48\u5f15\u8d77\u7684\uff0c \u5e38\u89c1\u5c31\u662f\u6570\u636e\u540c\u6b65\u7684\u95ee\u9898\u3002 \u5e93\u91cc\u7a81\u7136\u5220\u9664\u4e86\u67d0\u4e00\u4e2a\u5546\u54c1\u7684\u4fe1\u606f\uff0c\u53ef\u80fd\u662f\u8bef\u64cd\u4f5c\u3002\u90a3\u5fae\u670d\u52a1\u7684\u5176\u4ed6\u677f\u5757\u7684\u6570\u636e\u540c\u6b65\u7684\u6bd4\u8f83\u6162\u6216\u8005\u540c\u6b65\u5931\u8d25\u3002 \u90a3\u4e48\u5217\u8868\u4e2d\u8fd8\u6709\u8fd9\u6761\u6570\u636e\uff0c\u6070\u5de7\u8bbf\u95ee\u8fd9\u6761\u6570\u636e\u7684\u4eba\u5f88\u591a\u3002</p> <p>\u8bbf\u95eeredis\u6ca1\u6709\u6570\u636e\uff0c\u8bbf\u95ee\u6570\u636e\u5e93\u4e5f\u6ca1\u6709\u6570\u636e\uff0c\u8fd9\u4e2a\u5c31\u53d1\u751f\u4e86\u4e00\u6b21\u7a7f\u900f\uff0c\u90a3\u4e48\u8fd8\u6709\u4e00\u79cd\u53ef\u80fd\u5c31\u662f\u6076\u610f\u653b\u51fb\uff0c\u627e\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684 id\uff0c\u6bd4\u5982\u8bf4 id \u5c0f\u4e8e0\uff0c\u8fd9\u4e2a\u80af\u5b9a\u662f\u4e0d\u5b58\u5728\u7684\u3002 \u90a3\u4e48redis \u4e2d\u53c8\u6ca1\u6709\u9884\u70ed\uff0c \u6570\u636e\u5e93\u4e2d\u4e5f\u6ca1\u6709\uff0c\u5982\u679c\u518d\u52a0\u4e0a\u8fd9\u4e2a\u5e76\u53d1\u8bf7\u6c42\uff0c\u5c31\u53d8\u6210\u4e86\u6076\u610f\u653b\u51fb\u6570\u636e\u5e93\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u505a\u7279\u6b8a\u5904\u7406\uff0c\u77ac\u95f4\u5c31\u4f1a\u6253\u6ee1\u6570\u636e\u5e93\u7684 Cpu\uff0c\u90a3\u4e48\u6700\u7ec8\u7cfb\u7edf\u53ef\u80fd\u4f1a\u5d29\u6389\u3002</p> <p>\u600e\u4e48\u89e3\u6c7a\u7f13\u5b58\u7a7f\u900f\u3002</p> <p>\u90a3\u5982\u679c\u4e00\u4e2a\u67e5\u8be2\u8fd4\u56de\u7684\u6570\u636e\u4e3a\u7a7a\uff0c\u4e0d\u7ba1\u662f\u6570\u636e\u4e0d\u5b58\u5728\u8fd8\u662f\u7cfb\u7edf\u6545\u969c\uff0c\u6211\u4eec\u4ecd\u7136\u628a\u8fd9\u4e2a\u7a7a\u503c\u8fdb\u884c\u7f13\u5b58\uff0c \u4f46\u5b83\u7684\u8fc7\u671f\u65f6\u95f4\u5462\u53ef\u4ee5\u8bbe\u7f6e\u7684\u5f88\u77ed\uff0c\u6700\u957f\u4e0d\u8981\u8d85\u8fc75\u5206\u949f\u3002</p> <p>\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u8bbe\u7f6e\u8fc7\u957f\uff0c \u4e00\u4e2a\u662f\u5360\u6709\u7f13\u5b58\uff0c\u53e6\u4e00\u4e2a\u5982\u679c\u6709\u4e86\u65b0\u6570\u636e\u3002\u4f1a\u9020\u6210\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u60c5\u6cc1\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u65b9\u6cd5\u5462\u5c31\u662f\u4f7f\u7528\u5e03\u9686\u8fc7\u6ee4\u5668\uff0c\u5224\u65ad\u8bf7\u6c42\u5bf9\u5e94\u7684\u952e\uff0c\u662f\u5426\u5728\u8fd9\u4e2a\u8fc7\u6ee4\u5668\u4e2d\uff0c\u5982\u679c\u4e0d\u5728\u5c31\u76f4\u63a5\u8fd4\u56de\u3002\u4e0d\u53bb\u8bf7\u6c42\u6570\u636e\u5e93\u4e5f\u4e0d\u53bb\u7f13\u5b58\u7a7a\u503c\uff0c\u6781\u5c11\u7684\u7a7a\u95f4\u6765\u6807\u8bc6\u8d85\u5927\u91cf\u7684\u6570\u636e</p>"},{"location":"chap7/Arch_anws/#7-redis","title":"7 \u5982\u4f55\u4fdd\u969credis\u6302\u4e86\u4e4b\u540e: \u6570\u636e\u4e0d\u4e1f\u5931\uff1f","text":"<p>redis\u6570\u636e\u662f\u5168\u90e8\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u7684, \u90a3\u4e48\u5982\u679c\u673a\u5668\u7a81\u7136\u6302, \u90a3\u4e48\u6570\u636e\u5c31\u4f1a\u5168\u90e8\u4e22.\u6570\u636e\u4e0d\u4f1a\u56e0\u4e3aredis\u6302\u4e86\u800c\u4e22\u5931, \u5c31\u662fredis\u6240\u8c13\u7684\u7279\u4e45\u5316\u673a\u5236. </p> <p>\u6301\u4e45\u5316\u7684\u5b58\u50a8\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2a\u78c1\u76d8\u4e0a\u7684\u6587\u672c\u6587\u6863, \u65e5\u5fd7\u6587\u4ef6, \u8fd8\u6709\u6570\u636e\u5e93\u6587\u4ef6\u7b49\u7b49.  \u90fd\u662f\u5c5e\u4e8e\u8fd9\u4e2a\u6570\u636e\u7684\u6301\u4e45\u5316,  redis\u7684\u6301\u4e45\u5316\u5728\u78c1\u76d8\u4e0a\u627e\u4e00\u4e2a\u5730\u65b9\u6765\u5b58\u50a8\u3002 </p> <p>\u4e00\u79cd\u5462\u53eb<code>rdb</code>\uff0crdb\u5c31\u662f<code>redisdatabase</code>, \u5c31\u662f\u5e38\u8bf4\u7684\u8fd9\u4e2aredis\u6570\u636e\u5e93,\u53c9\u53eb\u5185\u5b58\u5b58\u5feb\u7167\u3002 \u53ef\u4ee5\u5b9a\u65f6\u7684\u53bb\u5907\u4efd\u7f13\u5b58\u4e2d\u7684\u6570\u636e\uff0c\u9694\u4e00\u6bb5\u65f6\u95f4\u5c31\u4f1a\u6267\u884c\u4e00\u6b21\u5907\u4efd\u3002 </p> <p>\u5c31\u8ddf\u5b9a\u671f\u5907\u4efd\u6570\u636e\u5e93\u6587\u4ef6\u4e00\u6837,\u90a3\u5982\u679credis\u6302\u4e86,\u518d\u6b21\u542f\u52a8\u7684\u65f6\u5019. \u5c31\u4f1a\u4ece\u6700\u65b0\u7684rdb\u6587\u4ef6\u4e2d\u52a0\u8f7d\u6570\u636e,  </p> <p>\u53e6\u4e00\u4e2a\u662faof\uff0c\u5168\u79f0\u662f<code>append only file</code>. \u662f\u5728\u4e00\u4e2a\u6587\u4ef6\u91cc\u9762\u53bb\u8ffd\u52a0\u4ed6\u7684\u547d\u4ee4\uff0c\u662f\u8bb0\u5f55redis\u7f13\u5b58\u4e2d\u6240\u6709\u7684\u4fee\u6539\u3002 </p> <p>\u65b0\u589e\u7684\u5220\u9664\u7684\u65e5\u5fd7\uff0c \u90fd\u4f1a\u4ee5\u547d\u4ee4\u7684\u65b9\u5f0f\uff0c \u4e00\u6761\u4e00\u6761\u7684\u5b58\u50a8\u5728\u65e5\u5fd7\u4e2d\uff0c \u6240\u4ee5\u4e00\u65e6redis\u6302\u4e86\uff0c\u91cd\u542fredis\u7684\u65f6\u5019\uff0c \u5c31\u4f1a\u6839\u636e\u65e5\u5fd7\u4e2d\u7684\u547d\u4ee4\u5f88\u8f7b\u677e\u7684\u6765\u6062\u590d\u6570\u636e\u3002 \u5c31\u8ddfmysql\u4e2d\u7684binlog\u975e\u5e38\u50cf\uff0c\u53ea\u5b58\u50a8\u547d\u4ee4\u3002 </p> <p>\u4e0d\u5b58\u50a8\u6570\u636e\u9700\u8981\u7684\u65f6\u5019\uff0c\u9700\u8981\u6062\u590d\u6570\u636e\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u547d\u4ee4\u5c31OK\u3002\u90a3\u4e48\u6709\u4e86aof\u673a\u5236\uff0c \u4e5f\u53ef\u4ee5\u5f80\u5176\u4ed6\u7684\u4e00\u4e9b\u4e2d\u95f4\u952e\uff0c\u90fd\u4f1a\u4ee5\u547d\u4ee4\u7684\u65b9\u5f0f\uff0c\u4e00\u6761\u4e00\u6761\u7684\u5b58\u50a8\u5728\u65e5\u5fd7\u4e2d\uff0c \u6240\u4ee5\u2014\u65e6redis\u6302\u4e86\uff0c \u91cd\u540eredis\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u6839\u636e\u65e5\u5fd7\u4e2d\u7684\u547d\u4ee4\u3002 \u6062\u590d\u6570\u636e\uff0c \u9700\u8981\u6062\u590d\u6570\u636e\u7684\u65f6\u5019\uff0c \u90a3\u4e48\u6709\u4e86aof\u673a\u5236\uff0c \u505a\u4e86\u4e00\u4e9b\u6570\u636e\u540c\u6b65\uff0c \u6bd4\u5982\u8bf4\u50cf\u641c\u7d22\u5f15\u64ceES\u3002</p>"},{"location":"chap7/Arch_anws/#8","title":"8 \u8bfb\u591a\u5199\u5c11\u7684\u573a\u666f \u8be5\u7528\u4ec0\u4e48\u7f13\u5b58\u8bfb\u5199\u7b56\u7565","text":"<p>\u6211\u4eec\u7528redis\u7f13\u5b58\u6700\u591a\u7684\u573a\u666f\u5c31\u662f\u8bfb\u591a\u5199\u5c11\uff0c 90%\u7684\u573a\u666f\u662f\u8bfb\uff0c10%\u7684\u573a\u666f\u662f\u5199\uff0c\u8be5\u600e\u4e48\u9009\u62e9\u7b56\u8def\u624d\u80fd\u591f\u8ba9\u7f13\u5b58\u8bfb\u8bfb\u5199\u7387\u6700\u9ad8\uff0c\u6027\u80fd\u6700\u597d\u3002\u6211\u4eec\u4e00\u822c\u4f1a\u9009\u62e9\u4e00\u79cd\u6700\u5e38\u7528\u7684\u7f13\u5b58\u8bfb\u5199\u7b56\u7565\uff0c\u53eb\u505a cache-aside\uff0c\u4e5f\u53eb\u65c1\u5165\u7f13\u5b58\u7b56\u7565</p> <p>\u573a\u666f\u4e2d\u7684\u6570\u636e\uff0c\u662f\u4ee5\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u4e3a\u6dee\u7684\uff0c\u90a3\u4e48\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u662f\u6309\u9700\u52a0\u8f7d\u7684\uff0c\u6709\u9700\u8981\u5c31\u52a0\u8f7d\uff0c\u4e0d\u9700\u8981\u5c31\u4e0d\u52a0\u8f7d\u3002</p> <p>\u4e5f\u5c31\u662fredis\u6240\u8c13\u7684\u60f0\u6027\u52a0\u8f7d\u673a\u5236\uff0c\u8bfb\u7b56\u7565\u5f88\u7b80\u5355\u3002 \u5148\u4ece\u7f13\u5b58\u4e2d\u53bb\u8bfb\u6570\u636e\uff0c\u5982\u679c\u7f13\u5b58\u547d\u4e2d\u5c31\u76f4\u63a5\u8fd4\u56de\u6570\u636e\uff0c\u5982\u679c\u7f13\u5b58\u547d\u4e2d\u5931\u8d25\uff0c\u4ece\u6570\u636e\u5e93\u4e2d\u67e5\u8be2\u6570\u636e\uff0c\u67e5\u8be2\u5230\u6570\u636e\u4e4b\u540e\u3002 \u5c06\u6570\u636e\u5199\u5165\u5230\u7f13\u5b58\u4e2d\u5e76\u4e14\u8fd4\u56de\u7ed9\u7528\u6237\uff0c\u8fd9\u4e2a\u5c31\u662f\u4ed6\u7684\u4e00\u4e2a\u8bfb\u7b56\u8def\u3002</p> <p>\u50cf\u793e\u4ea4\u5e73\u53f0\u7684\u7528\u6237\u4fe1\u606f\uff0c \u5c31\u975e\u5e38\u9002\u5408\u7528cache-aside\u7684\u7b56\u7565\u3002\u90a3\u4e48\u6709\u7684\u7528\u6237\u4e3b\u9875\u8bbf\u95ee\u91cf\u591a\uff0c \u6709\u7684\u7528\u6237\u5462\u8bbf\u95ee\u91cf\u5c11\uff0c\u5c31\u80fd\u591f\u5927\u5927\u7684\u6e1b\u5c11\u51b7\u6570\u636e\u5360\u7528\u7684\u5185\u5b58\u7a7a\u95f4  \u56e0\u4e3a\u5185\u5b58\u5bf9\u4e8e\u6211\u4eec\u662f\u975e\u5e38\u7684\u5b9d\u8d35\u7684\uff0c </p> <p>\u90a3\u4e48\u5bf9\u4e8e\u5199\u7b56\u7565\uff0c \u6b65\u9aa4\u975e\u5e38\u7b80\u5355\u3002 \u5148\u66f4\u65b0\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\uff0c \u7136\u540e\u518d\u5220\u9664\u7f13\u5b58\u8bb0\u5f55\u3002\u8fd9\u65f6\u5019\u5982\u679c\u6709\u65b0\u7684\u8bf7\u6c42\u8fdb\u6765\uff0c \u5c31\u4f1a\u5148\u8bfb\u6570\u636e\u5e93\uff0c\u518d\u628a\u6570\u636e\u5199\u5165\u5230\u7f13\u5b58\u4e2d\u3002 </p> <p>Cache aside\u7684\u5b58\u5728\u7684\u6700\u5927\u95ee\u9898</p> <p>\u5c31\u662f\u5f53\u5199\u5165\u7684\u6b64\u8f83\u9891\u7e41\u7684\u65f6\u5019\uff0c \u6309\u7167\u8fd9\u4e2a\u5199\u7b56\u8def\u3002\u7f13\u5b58\u4e2d\u7684\u8fd9\u4e2a\u6570\u636e\uff0c \u5c31\u4f1a\u88ab\u9891\u7e41\u7684\u6e05\u7406\u3002\u4e00\u65e6\u5927\u91cf\u7684\u8bf7\u6c42\u8fc7\u6765\uff0c\u5f88\u591a\u7f13\u5b58\u627e\u4e0d\u5230\uff0c\u5c31\u4f1a\u5bf9\u7f13\u5b58\u7684\u547d\u4e2d\u7387\uff0c\u6709\u4e00\u5b9a\u7684\u5f71\u54cd\u5c31\u4f1a\u5f71\u54cd\u5230\u6570\u636e\u5e93\u7684\u8bfb\u5199\u6027\u80fd\u3002 </p> <p>\u53e6\u5916\u5c31\u662f\u5728\u5e76\u53d1\u7f13\u5b58\u7684\u65f6\u5019\uff0c \u6709\u53ef\u80fd\u4f1a\u5e26\u6765\u7f13\u5b58\u548c\u6570\u636e\u5e93\u4e0d\u4e00\u81f4\u7684\u60c5\u6cc1\u3002 \u8981\u5728\u66f4\u65b0\u7f13\u5b58\u524d\uff0c\u6765\u589e\u52a0\u4e00\u4e2a\u5206\u5e03\u5f0f\u9501\u3002 \u56e0\u4e3a\u8fd9\u6837\u5728\u540c\u4e00\u65f6\u95f4\uff0c\u53ea\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u6765\u66f4\u65b0\u7f13\u5b58, \u5c31\u4e0d\u4f1a\u4ea7\u751f\u5e76\u53d1\u95ee\u9898. \u5bf9\u4e8e\u5199\u5165\u7684\u6027\u80fd\u4f1a\u6709\u4e00\u5b9a\u7684\u5f71\u54cd\uff0c\u4e00\u65e6\u591a\u4e86\u4e4b\u540e\uff0c\u6027\u80fd\u5c31\u4f1a\u5927\u6253\u6298\u6263</p>"},{"location":"chap7/Arch_anws/#9","title":"9 \u8bfb\u591a\u5199\u591a\u7684\u573a\u666f \u8be5\u600e\u4e48\u9009\u62e9\u7f13\u5b58\u7b56\u7565","text":"<p>\u5f02\u6b65\u7f13\u5b58\u5199\u5165\u7684\u8bfb\u5199\u7b56\u7565 , \u53c8\u53eb\u505a write behind caching\uff0c\u628a\u7f13\u5b58\u4f5c\u4e3a\u4e3b\u8981\u7684\u6570\u636e\u5b58\u50a8\uff0c\u6ce8\u610f\u662f\u4f5c\u4e3a\u4e3b\u8981\u7684\u6570\u636e\u5b58\u50a8\u3002 \u90a3\u4e48\u4e00\u65e6\u6709\u5199\u6570\u636e\u7684\u8bf7\u6c42\uff0c\u6211\u4eec\u5148\u66f4\u65b0\u7f13\u5b58\uff0c\u4e0d\u76f4\u63a5\u66f4\u65b0\u6570\u636e\u5e93\u3002</p> <p>\u4e0d\u7ba1\u662f\u8bfb\u64cd\u4f5c\u4e5f\u597d\u8fd8\u662f\u5199\u64cd\u4f5c\u4e5f\u597d\uff0c \u4f1a\u628a\u5168\u90e8\u538b\u529b\u653e\u5728redis\u7f13\u5b58\uff0c \u4e0d\u4f1a\u76f4\u63a5\u53bb\u64cd\u4f5c\u6570\u636e\u5e93\u3002 \u6027\u80fd\u5c31\u4f1a\u5927\u5927\u7684\u63d0\u5347\uff0c\u6bd5\u7adf\u8fd9\u4e2a\u5185\u5b58\u7684io\u8bfb\u5199\u7684\u6027\u80fd\uff0c \u5f02\u6b65\u66f4\u65b0\u6570\u636e\u5e93\u5462\u4e5f\u5f88\u5bb9\u6613\u3002 </p> <p>\u53ef\u4ee5\u4f7f\u7528\u6d88\u81ea\u5bf9\u961f\u5217\uff0c \u5728\u8fd9\u4e2a\u6570\u636e\u5e93\u4e0d\u5fd9\uff0c\u6765\u5f02\u6b65\u66f4\u65b0\u5b83\uff0c\u6027\u80fd\u5c31\u4f1a\u5927\u5927\u7684\u63d0\u5347\u554a </p> <p>\u5f02\u6b65\u66f4\u65b0\u6570\u636e\u5e93\u5f88\u5bb9\u6613\uff0c\u4f46\u662f\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5bf9\u6570\u636e\u5e93\u7684\u4e00\u81f4\u6027\uff0c\u4f1a\u5e26\u6765\u5f88\u5927\u7684\u6311\u6218</p>"},{"location":"chap7/Arch_anws/#10-redis","title":"10 redis\u7f13\u5b58\u8fc7\u671f\u7b56\u7565","text":"<p>\u521a\u8fc7\u671f\u7684\u7f13\u5b58\uff0c \u5927\u6982\u7387\u8fd8\u662f\u4f1a\u5b58\u5728\u5185\u5b58\u4e2d\u3002\u90a3\u4e48\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\uff0c \u5c31\u662fredis\u7684\u7f13\u5b58\u8fc7\u671f\u7b56\u7565\uff0credis\u7f13\u5b58\u8fc7\u671f\u7b56\u7565\uff0c\u4e3b\u8981\u662f\u4e24\u90e8\u5206\u7ec4\u6210</p> <ul> <li> <p>\u4e00\u4e2a\u662f\u5b9a\u671f\u5220\u9664, redis\u9ed8\u8ba4\u662f\u6bcf\u9694100\u6beb\u79d2, \u5c31\u4f1a\u4ece\u6240\u6709\u7684\u8fd9\u4e2akey\u4e2d,\u968f\u673a\u9009\u62e9\u4e00\u90e8\u5206key, \u6765\u68c0\u67e5\u8fc7\u6ca1\u8fc7\u671f, \u90a3\u4e48\u5982\u679c\u8fc7\u671f\u4e86, \u5c31\u6267\u884c\u5220\u9664\u64cd\u4f5c.</p> <ul> <li>\u6ce8\u610f: \u8fd9\u662f\u968f\u673a\u9009\u62e9\u4e00\u90e8\u5206key, \u4e0d\u662f\u68c0\u67e5\u6240\u6709\u7684, \u90a3\u4e48\u5982\u679c\u53bb\u8f6e\u8be2\u6240\u6709\u7684key\u8fc7\u6ca1\u8fc7\u671f, \u5f88\u6709\u53ef\u80fd\u4f1a\u5f15\u53d1\u6027\u80fd\u707e\u96be. \u800c\u5982\u679c\u6709\u51e0\u4e07\u51e0\u5341\u4e07\u4e2akey,\u90a3\u4e48CPU\u6709\u53ef\u80fd\u5403\u4e0d\u6d88, \u56e0\u4e3a\u95f4\u9694\u65f6\u95f4\u77ed. \u6bcf\u4e2a100\u6beb\u79d2\u5462\u5c31\u4f1a\u6267\u884c\u4e00\u6b21. \u90a3\u4e48\u65f6\u95f4\u7d27\u4efb\u52a1\u91cd, \u5168\u90e8\u68c0\u67e5\u80af\u5b9a\u662f\u4e0d\u53ef\u80fd\u7684. </li> <li>\u5b9a\u671f\u5220\u9664\u7b56\u7565\u5176\u5b9e\u5c31\u662f\uff0c\u968f\u673a\u9009\u62e9\u4e00\u90e8\u5206key\u6765\u505a\u68c0\u67e5\uff0c\u5982\u679c\u5230\u671f\u4e86\u5c31\u76f4\u63a5\u5220\u9664</li> <li>\u7b2c2\u4e2a\u8fc7\u671f\u7b56\u7565\u5462\u5c31\u662f\u60f0\u6027\u5220\u9664\u3002 \u4e4b\u524d\u8bf4\u8fc7\u5199\u5165\u7f13\u5b58\uff0c\u53ea\u6709\u8bbf\u95ee\u4e86\u67d0\u6761\u6570\u636e\uff0c \u628a\u4ed6\u7684\u52a0\u8f7d\u5230\u7684\u5185\u5b58\u4e2d\u3002 \u90a3\u4e48\u540c\u6837\u5bf9\u4e8e\u7f13\u5b58\u8fc7\u671f\uff0c \u4e5f\u6709\u7c7b\u4f3c\u7684\u7f13\u5b58\u60f0\u6027\u522a\u9664\uff0c\u5176\u5b9e\u5c31\u662f\u88ab\u52a8\u68c0\u67e5\u5220\u9664\uff0c\u5fc5\u987b\u6709\u4eba\u8bbf\u95ee\u4e86\u8fd9\u4e2akey\uff0c\u90a3\u4e48\u8bbf\u95ee\u7684\u540c\u65f6\u5462\uff0c\u5c31\u4f1a\u53bb\u68c0\u67e5\u8fd9\u4e2akey\u662f\u5426\u8fc7\u671f\uff0c\u5982\u679c\u8fc7\u671f\u4e86\u5c31\u6267\u884c\u5220\u9664\u3002 \u8fd9\u5c31\u662fredis\u6240\u8c13\u7684\u60f0\u6027\u5220\u9664\u673a\u5236\uff0c </li> </ul> </li> <li> <p>\u4e00\u4e9b\u8fc7\u671f\u7684\u51b7\u6570\u636e\uff0c \u4e0d\u7ecf\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u3002 \u4e5f\u6ca1\u6709\u88ab\u5b9a\u671f\u5220\u9664\uff0c \u968f\u673a\u5230\u7684\u8fd9\u4e2a\u6570\u636e\u5c31\u4f1a\u6210\u4e3a\u6f0f\u7f51\u4e4b\u9c7c Redis \u6dd8\u6c70\u7b56\u7565, \u5f53\u5185\u5b58\u6ee1\u4e86\u4e4b\u540e\u554a,\u4f1a\u4f18\u5148\u9009\u62e9\u4e00\u4e9b\u8fd9\u4e2a\u8fc7\u671f\u7684key, \u8bbf\u95ee\u91cf\u4f4e\u7684key\u8fdb\u884c\u5220\u9664. \u8fd9\u6837\u7684\u8bdd\u5462\u5c31\u5835\u4f4f\u4e86\u6240\u6709\u7684\u6f0f\u7f51\u4e4b\u9c7c</p> </li> </ul> <p>\u6240\u6709\u7684\u8fc7\u671fkey, \u4e00\u90e8\u5206\u88ab\u8fc7\u671f\u7b56\u8def\u7ed9\u5220\u9664\u6389\uff0c \u4e00\u90e8\u5206\u53c8\u88ab\u6dd8\u6c70\u7b56\u8def\u7ed9\u5220\u9664\u6389\u4e86\u3002 \u5c31\u80fd\u4fdd\u8bc1redis\u6709\u8db3\u591f\u7684\u7a7a\u95f4\uff0c\u6765\u5b58\u50a8\u65b0\u7684\u6570\u636e</p>"},{"location":"chap7/Arch_anws/#11-redis","title":"11 redis\u7f13\u5b58\u6dd8\u6c70\u7b56\u7565","text":"<p>\u5f53\u8fd9\u4e2aredis\u7684\u5185\u5b58\u6ee1\u4e86\uff0c \u8fd6\u5230\u4e86\u6700\u5927\u7684\u5185\u5b58\u7684\u65f6\u5019\uff0c\u90a3\u4e48redis\u5c31\u5fc5\u987b\u8fdb\u884c\u7f13\u5b58\u7684\u6dd8\u6c70\uff0c\u5426\u5219\u5c06\u4f1a\u4e25\u91cd\u7684\u5f71\u54cdredis\u7684\u8fd0\u884c\u3002\u4e5f\u65e0\u6cd5\u5199\u5165\u65b0\u7684\u6570\u636e\uff0c\u8bf7\u6c42\u91cf\u591a\u4e86\u5e76\u53d1\u5927\u4e86\u3002 \u5185\u5b58\u4e0d\u8db3\u7684\u8282\u70b9\uff0c \u8fd0\u884c\u6709\u53ef\u80fd\u4f1a\u4e25\u91cd\u7684\u7f13\u6162\uff0c \u751a\u81f3\u4f1a\u5f15\u8d77\u8282\u70b9\u7684\u5b95\u673a\uff0c</p> <p>Redis \u662f\u63d0\u4f9b\u4e86\u5f88\u591a\u7684\u8fd9\u4e2a\u7f13\u5b58\u6dd8\u6c70\u7b56\u7565, \u4ece\u6240\u6709\u7684\u952e\u503c\u5bf9\u4e2d\u53ef\u4ee5\u9009\u62e9, \u53ef\u4ee5\u9009\u62e9key\u8fdb\u884c\u5220\u9664. </p> <ul> <li>lru\u6dd8\u6c70\u7b56\u7565(least recently used) \u8fdb\u884c\u6dd8\u6c70\uff0c\u5224\u65ad\u6700\u8fd1\u88ab\u8bbf\u95ee\u7684\u8fd9\u4e2a\u65f6\u95f4\u3002 \u5982\u679c\u8ddd\u79bb\u76ee\u524d\u6700\u8fdc\uff0c\u8fd9\u4e2a\u6570\u636e\u4f1a\u4f18\u5148\u88ab\u6dd8\u6c70</li> <li>Ifu\u7b97\u6cd5\u6dd8\u6c70\u7b56\u7565\uff08least frequently used\uff09\uff0c\u6311\u9009\u6700\u5c11\u7ecf\u5e38\u4f7f\u7528\u7684\u6570\u636e\u8fdb\u884c\u6dd8\u6c70\u3002 <ul> <li>\u4e5f\u5c31\u662f\u6311\u9009\u51fa\u6700\u8fd1\u4f7f\u7528\u6b21\u6570\u6700\u5c11\u7684key\uff0c \u8fdb\u884c\u6570\u636e\u7684\u5220\u9664</li> </ul> </li> </ul> <p>\u6765\u9009\u62e9\u4e0d\u540c\u7684\u7b56\u8def\u53bb\u6dd8\u6c70\u6570\u636e\uff0c \u5f53\u7f13\u5b58\u6570\u636e\u6ca1\u6709\u660e\u663e\u7684\u51b7\u70ed\u4e4b\u5206\u7684\u65f6\u5019\uff0c \u4e5f\u5c31\u662f\u6570\u636e\u7684\u8bbf\u95ee\u9891\u7387\u5dee\u8ddd\u4e0d\u5927\uff0c \u5efa\u8bae\u8fd9\u4e2a\u968f\u673a\u7b56\u8def\uff0c\u8fdb\u884c\u6dd8\u6c70\u6570\u636e</p> <p>\u5f53\u6570\u636e\u6709\u660e\u663e\u7684\u51b7\u70ed\u4e4b\u5206\uff0c \u6bd4\u5982\u793e\u4ea4\u5e73\u53f0\uff0c \u4e5f\u5c31\u662fIru\u7b97\u6cd5\u6765\u6dd8\u6c70\u7f13\u5b58\uff0c\u5c06\u6700\u8fd1\u6700\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u7559\u5728\u7f13\u5b58\u4e2d\uff0c \u628a\u51b7\u6570\u636e\u8fdb\u884c\u6dd8\u6c70</p> <p>\u4e0d\u7ba1\u7528\u4ec0\u4e48\u6837\u7684\u6dd8\u6c70\u7b56\u7565\uff0c \u603b\u5f52\u662f\u6709\u4e00\u4e9b\u91cd\u8981\u7684\u6570\u636e\u3002 \u4f1a\u88ab\u7f13\u5b58\u6dd8\u6c70\u7b56\u7565\u8bef\u6740\u6389\uff0c \u5c31\u9700\u8981\u5728\u4ee3\u7801\u7684\u4e1a\u52a1\u5c42\uff0c \u6765\u505a\u597d\u5224\u5b9a\uff0c\u53ef\u4ee5\u901a\u8fc7\u8ba2\u9605redlis\u7684\u56de\u6536\u4e8b\u4ef6\uff0c \u53bb\u6355\u6349\u88ab\u6dd8\u6c70\u56de\u6536\u7684key\u7684\u4fe1\u606f\u3002 </p> <p>\u5982\u679ckey\u975e\u5e38\u91cd\u8981,  \u90a3\u4e48\u5c5e\u4e8e\u7684\u91cd\u8981\u6570\u636e, \u90a3\u4e48\u5c31\u4e0d\u8fdb\u884c\u7f13\u5b58\u7684\u6dd8\u6c70. \u867d\u7136\u4f7f\u7528\u8ba2\u9605redis\u6dd8\u6c70\u4e8b\u4ef6, \u4f1a\u6709\u4e00\u5b9a\u7684\u8fd9\u4e2a\u6027\u80fd\u635f\u8017\uff0c \u5374\u80fd\u591f\u907f\u514d\u4e00\u4e9b\u91cd\u8981\u7684\u7f13\u5b58\u6570\u636e\u3002 </p> <p>\u88ab\u5220\u6389\u6240\u4ee5\u5f88\u591a\u573a\u5408\u4e0b\u8fd8\u662f\u6709\u4e00\u4e9b\u975e\u5e38\u91cd\u8981\u7684\u6570\u636e\uff0c\u53bb\u505a\u8fd9\u4e2a\u7279\u6b8a\u4fdd\u62a4\u7684 \u3002\u6bd4\u5982\u8fd9\u4e2a\u4e1a\u52a1\u6570\u636e\u91cc\u9762\uff0c\u6bd4\u5982\u8bf4\u6709\u70b9\u8d5e\u6570\u636e\uff0c \u6d4f\u89c8\u91cf\u6570\u636e\u3002 \u867d\u7136\u6570\u636e\u4e0d\u662f\u7279\u522b\u91cd\u8981\uff0c\u4f46\u662f\u8fd8\u662f\u9700\u8981\uff0c\u8fd9\u4e2a\u6570\u636e\u5e93\u91cc\u9762\u53bb\u505a\u6301\u4e45\u5316\u7684\u5b58\u50a8\u7684\u5c31\u9700\u8981\u4e1a\u52a1\u5c42\u6765\u5199\u4ee3\u7801\u8fdb\u884c\u5e72\u9884</p>"},{"location":"chap7/Arch_anws/#12-redis","title":"12 redis \u5728\u793e\u4ea4\u5e73\u53f0\u4e0b\u7684\u5e94\u7528","text":"<p>\u53ef\u4ee5\u7528\u8fd9\u4e2aredis\u6765\u7f13\u5b58\u6570\u636e\uff0c \u90a3\u4e48\u9891\u7e41\u7684\u6570\u636e\u8bbf\u95ee\uff0c \u50cf\u4e2a\u4eba\u4fe1\u606f\u57fa\u672c\u7684\u6570\u636e\uff0c \u5c31\u53ef\u4ee5\u7f13\u5b58\u5728Redis\u4e2d\u3002</p> <p>\u90a3\u4e48\u8fd8\u6709\u4e00\u4e9b\u63a8\u8350\u7684feed\u6d41\uff0c\u6bd4\u5982\u597d\u53cb\u63a8\u8350\u3002 \u8fd9\u4e9b\u5e26\u6709\u4e2a\u6027\u5316\u7684\u63a8\u8350\u7684\u6570\u636e\uff0c\u53eb\u505a\u7a7a\u95f4\u6362\u65f6\u95f4\uff0c </p> <p>\u5728redis\u4e2d\u4e5f\u540c\u6837\u9002\u7528\u5c31\u662f\u6570\u636e\u7ed3\u6784\u65b9\u9762\u7684\u5e94\u7528\uff0c \u6bd4\u5982\u8bf4\u6211\u4eec\u5229\u7528zset\uff0c\u8f83\u5e38\u7528\u7684\u6570\u636e\u7ed3\u6784\u3002 \u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u6392\u5e8f\u3002\u53ef\u4ee5\u7528\u5b83\u6765\u505a\u8fd9\u4e2a\u4eba\u6c14\u6392\u884c\u699c\uff0c \u6839\u636e\u5b83\u7684\u8bbf\u95ee\u91cf\uff0c\u53ef\u4ee5\u76f4\u63a5\u505a\u4e2a\u6392\u5e8f\u3002\u6bd4\u8d77\u6211\u4eec\u4f20\u7edf\u7684\u5b58\u50a8\uff0c\u6b64\u5982\u8bf4mysql\u5148\u53bb\u6392\u5e8f\u518d\u53bb\u83b7\u53d6\uff0c\u5728\u67e5\u8be2\u4e0a\u7684\u6548\u7387\u4e5f\u66f4\u52a0\u7684\u9ad8\u6548\u3002</p> <p>\u53ef\u4ee5\u7528\u6765\u505a\u8fd9\u4e2a\u8ba1\u6570\u5668\uff0c\u6bd4\u5982\u50cf\u4e2a\u4eba\u4e3b\u9875\u6d4f\u89c8\u91cf\uff0c\u6d4f\u89c8\u6570\u4e00\u822c\u662f\u8981\u6c42\u5b9e\u65f6\u3002 redis\u7684\u5929\u7136\u662f\u652f\u6301\u8fd9\u4e2a\u57fa\u7840\u529f\u80fd</p> <p>\u90a3\u4e48\u7b2c4\u4e2a\u5e94\u7528\u53ef\u4ee5\u7528\u6765\u505a\u4e3b\u5e93\uff0c\u6bd4\u5982\u8bf4\u7528\u6237\u4e3b\u9875\u7684\u70b9\u8d5e\uff0c\u4f1a\u6d89\u53ca\u5230\u9891\u7e41\u7684\u8bfb\u5199\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u628a\u8fd9\u90e8\u5206\u6570\u636e\uff0c\u653e\u5728\u7f13\u5b58\u4e2d\u3002\u7136\u540e\u5728\u6570\u636e\u5e93\u4e0d\u5fd9\u7684\u65f6\u5019\uff0c \u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\uff0c \u518d\u628a\u8fd9\u4e2a\u6570\u636e\u5462\u5237\u5230\u6570\u636e\u5e93\u4e2d\u3002 \u80fd\u591f\u5927\u5927\u7684\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u6027\u80fd\uff0c \u8bfb\u591a\u5199\u591a\u7684\u8fd9\u6837\u7684\u4e00\u4e2a\u5e94\u7528\u573a\u666f</p>"},{"location":"chap7/Arch_anws/#13-redis","title":"13 redis\u6302\u4e86 \u7cfb\u7edf\u5982\u4f55\u8865\u6551","text":"<p>\u8c08\u8c08redis\u7684\u9ad8\u53ef\u7528</p> <p>\u600e\u4e48\u5b9e\u73b0relis\u7684\u9ad8\u53ef\u7528, \u4f46\u662f\u5728\u5927\u7684\u6d41\u91cf\u4e0b\u9762\u7684\u5e76\u53d1\uff0c \u6bd4\u5982\u8bf4\u673a\u5668\u6545\u969c\uff0c\u6bd4\u5982\u8bf4\u77ed\u65f6\u95f4\u5185\u8bbf\u95ee\u66b4\u589e\uff0c\u6765\u4e0d\u53ca\u54cd\u5e94\u3002\u6216\u8005\u662f\u585e\u5165\u7684key\u503c\u592a\u591a, \u5185\u5b58\u8fc7\u5927\u6765\u4e0d\u53ca\u56de\u6536,\u90fd\u4f1a\u5bfc\u81f4, redis\u53d1\u751f\u6545\u969c\u751a\u81f3\u5b95\u673a,\u505a\u597dredis\u7684\u9ad8\u53ef\u7528\u914d\u7f6e, redis\u5e38\u89c1\u67093\u4e2a\u9ad8\u53ef\u7528\u7684\u6a21\u5f0f</p> <ul> <li>\u7b2c\u4e00\u4e2a \u4e3b\u4ece\u6a21\u5f0f</li> </ul> <p>\u4e00\u4e3b\u4e00\u4ece\u6216\u8005\u4e00\u4e3b\u591a\u4ece\uff0c \u8ddf\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u9ad8\u53ef\u7528\u7c7b\u4f3c\uff0c\u591a\u4e2a\u8282\u70b9\u3002\u901a\u8fc7aof\u547d\u4ee4\u6765\u4fdd\u6301\u6570\u636e\u7684\u540c\u6b65\u3002 \u90a3\u4e48\u6709\u4e86\u591a\u8282\u70b9\uff0c \u5c31\u5927\u5927\u7684\u5206\u644a\u4e86\u8fd9\u4e2aredis\u7684\u8bbf\u95ee\u5e95\u529b.</p> <p>\u4e5f\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u573a\u666f, \u6765\u505a\u8bfb\u5199\u5206\u79bb, \u90a3\u4e48\u4e3b\u8282\u70b9\u7528\u6765\u5199, \u4ece\u8282\u70b9\u7528\u6765\u8bfb,\u5c31\u662f\u4e00\u65e6\u4e3b\u8282\u70b9\u6302\u4e86, \u5c31\u9700\u8981\u624b\u52a8\u53bb\u6307\u5b9a\u8fd9\u4e2a\u4e3b\u8282\u70b9, \u4e00\u822c\u5f88\u5c11\u7528\u8fd9\u79cd\u6a21\u5f0f. </p> <p>\u54e8\u5175\u6a21\u5f0f, \u4e00\u65e6\u4e3b\u8282\u70b9\u6302\uff0c\u53ef\u4ee5\u91cd\u65b0\u53bb\u9009\u62e9\u65b0\u7684\u4e3b\u8282\u70b9\uff0c\u6765\u4fdd\u969c\u7684\u4e1a\u52a1\u4e0d\u95f4\u65ad\uff0c\u5176\u5b9e\u662f\u4e3b\u4ece\u6a21\u5f0f\u7684\u5347\u7ea7\u7248\u3002\u52a0\u4e86\u8fd9\u4e2a\u5fc3\u8df3\u76d1\u6d4b\u5207\u6362\u7684\u529f\u80fd\u3002\u5c31\u53ef\u4ee5\u5927\u5927\u7684\u63d0\u9ad8\u4e86redis\u7684\u53ef\u7528</p> <p>\u54e8\u5175\u6a21\u5f0f\u5462\u4e5f\u6709\u4e00\u4e9b\u7f3a\u70b9\uff0c\u6b64\u5982\u8bf4\u8fd9\u4e2a\u4e3b\u8282\u70b9\u8ddf\u4ece\u8282\u70b9\u7684\u6570\u636e\u662f\u4e00\u6837\u7684\uff0c\u6d6a\u8d39\u6211\u4eec\u5b9d\u8d35\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u800c\u4e14\u4e00\u822c\u90fd\u662f\u4e3b\u8282\u70b9\u5728\u5199\u3002 \u5c31\u5bb9\u6613\u53d7\u5230\u5355\u8282\u70b9\u673a\u5668\u7684\u9650\u5236\uff0c\u6bd5\u7adf\u5355\u673a\u7684\u8fd9\u4e2a\u5185\u5b58\u662f\u6709\u9650\u7684\uff0c\u5f88\u5bb9\u6613\u9047\u5230\u5e76\u53d1\u8bbf\u95ee\u7684\u6027\u80fd\u74f6\u9888</p> <p>Redis 3.0\u4ee5\u540e\uff0c\u5c31\u6709\u4e86\u8fd9\u4e2acluster\u96c6\u7fa4\u6a21\u5f0f\uff0c\u591a\u4e3b\u591a\u4ece\uff0c\u5c06\u6570\u636e\u8fdb\u884c\u5206\u5e03\u5f0f\u7684\u5b58\u50a8\uff0c\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u7247\uff0c\u90a3\u4e48\u6bcf\u53f0redis\u8282\u70b9\u4e0a\u9762\uff0c \u5b58\u50a8\u4e0d\u540c\u7684\u5185\u5bb9\uff0c\u4e0d\u7ba1\u662f\u6570\u636e\u5b58\u50a8\u4e5f\u597d\u8bbf\u95ee\u4e5f\u59a4\uff0c \u90fd\u8fdb\u884c\u4e86\u538b\u529b\u7684\u5206\u644a\uff0c \u800c\u4e14Cluster\u7684\u6a21\u5f0f\uff0c \u6269\u5bb9\u4e5f\u975e\u5e38\u65b9\u4fbf\uff0c\u652f\u6301\u52a8\u6001\u6269\u5c55</p> <p>\u90a3\u4e48\u4e00\u65e6\u53d1\u73b0\u538b\u529b\u8fc7\u5927\uff0c \u53ef\u4ee5\u968f\u65f6\u589e\u52a0\u8282\u70b9\uff0ccluster\u7684\u6a21\u5f0f\uff0c\u5c31\u662f\u4e3a\u4e86\u8fd9\u4e2a\u6d77\u91cf\u6570\u636e\u7684\u5b58\u50a8\u9ad8\u5e76\u53d1\u9ad8\u53ef\u7528\u7684\u573a\u666f\u800c\u751f\u7684</p>"},{"location":"chap7/Arch_anws/#14-redis","title":"14 redis\u5230\u5e95\u662f\u5355\u7ebf\u7a0b\u8fd8\u662f\u591a\u7ebf\u7a0b\uff1f","text":"<p>redis6.0\u591a\u7ebf\u7a0b,\u662f\u9488\u5bf9\u7684\u5904\u7406\u7f51\u7edc\u8bf7\u6c42\u8fc7\u7a0b\u4e2d\u91c7\u7528\u4e86\u591a\u7ebf\u7a0b\u3002\u800c\u6570\u636e\u7684\u8bfb\u5199\u547d\u4ee4\uff0c\u591a\u7ebf\u7a0b\u53ea\u662f\u5728\u5904\u7406\u547d\u4ee4\u63a5\u6536\u548c\u7ed3\u679c\u7684\u53d1\u9001\u4e0a\u9762\uff0c\u4f46\u662f\u547d\u547d\u7684\u6267\u884c\uff0c\u8bfb\u6570\u636e/\u5199\u6570\u636e\u8fd8\u662f\u5355\u7ebf\u7a0b\u3002\u5c31\u662f\u80fd\u591f\u5927\u5927\u7684\u63d0\u5347io\u7684\u6027\u80fd\uff0c</p> <p>redis\u7684\u74f6\u9888\u4e0d\u5728CPU\uff0c \u800c\u5728\u4e8e\u5185\u5b58\u548c\u7f51\u7edc\uff0c\u5185\u5b58\u7684\u95ee\u9898\u52a0\u5185\u5b58\u5c31\u53ef\u4ee5\u641e\u5b9a\u3002 </p> <p>\u7f51\u7edcIO\u5c31\u4e0d\u4e00\u6837, redis\u5927\u90e8\u5206\u7684\u65f6\u95f4\u90fd\u82b1\u5728\u8fd9\u4e2a\u7f51\u7edc\u7684IO\u4e0a\u9762,\u901a\u8fc7\u591a\u7ebf\u7a0b\u7684\u65b9\u5f0f\u6765\u5904\u7406\u7f51\u7edcIO\u3002 </p> <p>\u5927\u5927\u7684\u63d0\u5347\u4e86\u7cfb\u7edf\u7684\u5e76\u53d1\u6570\uff0c\u6709\u4e86\u591a\u7ebf\u7a0b\uff0c\u4e5f\u4f1a\u8003\u8651\u5230\u6570\u636e\u7684\u5e76\u53d1\u5b89\u5168\uff0c\u4f9d\u7136\u4fdd\u7559\u4e86\u5bf9\u6267\u884c\u547d\u5206\u7684\u5355\u7ebf\u7a0b\uff0c\u4e0d\u50cf\u591a\u7ebf\u7a0b\uff0c\u9700\u8981\u53bb\u9891\u7e41\u7684\u521b\u5efa\u9500\u6bc1\u7ebf\u7a0b\uff0c\u907f\u514d\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u6ca1\u6709\u8fd9\u4e2a\u5e76\u53d1\u8d44\u6e90\u7ade\u4e89\u7684\u95ee\u9898\u3002\u901f\u5ea6\u4e0a\u9762\u4e5f\u6709\u4e86\u4fdd\u8bc1\uff0c\u5bf9\u4e8e\u8fd9\u4e2a6.0\u4ee5\u540e\uff0c\u9700\u8981\u5206\u573a\u666f\u6765\u8bf4\uff0c\u65e2\u6709\u4e86\u591a\u7ebf\u7a0b\u4e5f\u6709\u4e86\u5355\u7ebf\u7a0b\u554a</p>"},{"location":"chap7/Arch_anws/#15","title":"15 \u600e\u4e48\u4fdd\u8bc1 \u6570\u636e\u5e93\uff0e\u7f13\u5b58\u7684\u53cc\u5199\u4e00\u81f4\u6027","text":"<p>\u6570\u636e\u5e93\u5728\u5199\uff0c\u7f13\u5b58\u4e5f\u5728\u5199, \u4e24\u4e2a\u5b58\u50a8\u5355\u5143\uff0c \u5c31\u4e00\u5b9a\u4f1a\u6709\u6570\u636e\u4e00\u81f4\u6027\u7684\u95ee\u9898\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662f\u8bfb\u5230\u8001\u6570\u636e\u3002 </p> <p>\u5bf9\u4e8e\u4e00\u4e9b\u6bd4\u8f83\u91cd\u8981\u7684\u6570\u636e\uff0c\u6b64\u5982\u8bf4\u50cf\u4ea4\u6613\u7cfb\u7edf\u91cc\u7684\u8fd9\u4e2a\u5e93\u5b58\u91cf\uff0c\u5c31\u8981\u7279\u522b\u6ce8\u610f\u6570\u636e\u7684\u4e00\u81f4\u6027\u95ee\u9898\u3002</p>"},{"location":"chap7/Arch_anws/#1_1","title":"1 \u52a0\u9501","text":"<p>\u53ef\u4ee5\u4fdd\u8bc1\u8857\u66f4\u65b0\u6570\u636e\u5e93\u3001\u7f13\u5b58\u7684\u65f6\u5019\uff0c \u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u64cd\u4f5c\u3002 \u8fd9\u79cd\u5c31\u662f\u5f3a\u4e00\u81f4\u6027\u4e86\uff0c \u4e5f\u4e0d\u4f1a\u5b58\u5728\u4e0d\u4e00\u81f4\u7684\u95ee\u9898</p> <p>\u52a0\u9501\u4e5f\u662f\u6709\u7f3a\u70b9\u7684,  \u6027\u80fd\u4e0a\u9762\u5c31\u4f1a\u5927\u6253\u6298\u6263\uff0c\u4e0d\u592a\u9002\u5408\u5e76\u53d1\u91cf\u6b64\u8f83\u5927\u7684\u573a\u666f</p> <p>\u5927\u90e8\u5206\u573a\u666f\u8981\u4fdd\u8bc1\u6027\u80fd\uff0c\u4e5f\u5177\u80fd\u591f\u4fdd\u8bc1\u6700\u7ec8\u7684\u4e00\u81f4\u6027\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684cap\u7406\u8bba\u3002\u53ef\u7528\u6027\uff0c \u4e00\u81f4\u6027\uff0c\u5bb9\u9519\u6027\u5177\u80fd\u540c\u65f6\u4fdd\u8bc1\u4e24\u4e2a\uff0c\u65e0\u6cd5\u540c\u65f6\u6ee1\u8db33\u4e2a\u6761\u4ef6\uff0c\u6027\u80fd\u4e4b\u4e0b\u8981\u4fdd\u6301\u4e00\u81f4\u6027\u3002</p>"},{"location":"chap7/Arch_anws/#2_1","title":"2 \u5e38\u89c1\u7684\u89e3\u6c7a\u65b9\u6848\u5c31\u662f\uff0c\u5ef6\u8fdf\u53cc\u5220","text":"<p>\u5148\u5220\u7f13\u5b58\u518d\u66f4\u65b0\u6570\u636e\u5e93\uff0c \u7136\u540e\u5ef6\u9000\u51e0\u79d2\u949f\u518d\u5220\u4e00\u6b21\u7f13\u5b58\uff0c\u5ef6\u8fdf\u65f6\u95f4\u5462\u5c31\u662f\u8bfb\u4e1a\u52a1\u903b\u8f91\u6570\u636e\u8017\u65f6, \u52a0\u4e0a\u51e0\u767e\u6beb\u79d2\u7684\u968f\u673a\u6570\uff0c\u4e3b\u8981\u7684\u76ee\u7684\uff0c \u4e3a\u4e86\u786e\u4fdd\u8bfb\u8bf7\u6c42\u7ed3\u675f\u3002 </p> <p>\u5199\u8bf7\u6c42\u53ef\u4ee5\u5220\u9664\uff0c\u8bfb\u8bf7\u6c42\u53ef\u80fd\u5e26\u6765\u7684\u8fd9\u4e2a\u7f13\u5b58\u810f\u6570\u636e\uff0c\u8fd9\u79cd\u65b9\u6848\u5462\u8fd8\u7b97\u53ef\u4ee5\u3002\u4f11\u7720\u53ef\u80fd\u4f1a\u6709\u810f\u6570\u636e\uff0c\u4e00\u822c\u7684\u4e1a\u52a1\u90fd\u80fd\u591f\u63a5\u53d7\u3002</p> <p>\u5c5e\u4e8e\u5927\u5e76\u53d1\u4e0b\u9ad8\u6027\u80fd\u4e0b\uff0c\u5f53\u7136\u4e5f\u4e0d\u662f\u5b8c\u5168\u6ca1\u6709\u95ee\u9898\u3002</p> <p>\u6700\u5e38\u89c1\u7684\u5c31\u662f\u64cd\u4f5c\u6570\u636e\u5e93\u6216\u8005\u64cd\u4f5c\u7f13\u5b58\u5931\u8d25\u4e86\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e5f\u662f\u53ef\u80fd\u5b58\u5728\u7684\uff0c\u5bf9\u4e4e\u66f4\u65b0\u6570\u636e\u5e93\u5931\u8d25\u4e86\u3002\u5176\u5b9e\u6ca1\u6709\u592a\u5927\u5173\u7cfb\uff0c\u56e0\u4e3a\u6b64\u65f6\u7684\u6570\u636e\u5e93\u548c\u7f13\u5b58\u4e2d\u7684\uff0c\u8fd8\u90fd\u662f\u8001\u6570\u636e\uff0c\u4e0d\u5b58\u5728\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\u3002</p> <p>\u5047\u5982\u5220\u9664\u7f13\u5b58\u5931\u8d25\u90a3\u4e48\u95ee\u9898\u5c31\u5927\u4e86\uff0c\u8fd9\u6bb5\u65f6\u95f4\u8bfb\u7684\u7f13\u5b58\u90fd\u662f\u8001\u6570\u636e\u3002\u53ef\u4ee5\u8bbe\u7f6e\u7f13\u5b58\u8fc7\u671f\u65f6\u95f4\uff0c\u4f5c\u4e3a\u8fd9\u4e2a\u515c\u5e95\u7684\u65b9\u6848\u3002 \u4f46\u662f\u5462\u53ca\u65f6\u6027\u4e0d\u9ad8, \u5c31\u5fc5\u987b\u8003\u8651\u5bf9\u5220\u9664\u64cd\u4f5c\u8fdb\u884c\u91cd\u8bd5.   \u91cd\u8bd5\u673a\u5236\u6709\u5f88\u591a, \u53ef\u4ee5\u56f4\u6d88\u606f\u961f\u5217\u554a\u5b8c\u6b65\u5904\u7406\u5220\u9664,\u672c\u8eab\u4e5f\u5e26\u6709\u8fd9\u4e2a\u91cd\u8bd5\u673a\u5236. \u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u6570\u636e\u5e93\u7684binllog\u3002 </p> <p>\u53ea\u8981\u76d1\u6d4b\u5230\u6570\u636e\u5e93\u7684\u66f4\u65b0\uff0c\u90a3\u4e48\u5c31\u6267\u884c\u5220\u9664\u7f13\u5b58\u7684\u64cd\u4f5c\uff0c\u5220\u9664\u5931\u8d25\u5c31\u8bb0\u5f55\u4e0b\u6765\u7b49\u5f85\u91cd\u8bd5\u3002 </p> <ul> <li>\u5982\u679c\u5e76\u53d1\u91cf\u4e0d\u5927\uff0c \u76f4\u63a5\u7528\u9501\u554a\u4fdd\u6301\u5f3a\u4e00\u81f4\u6027\u5c31\u53ef\u4ee5\u4e86</li> <li>\u4f46\u662f\u5982\u679c\u5e76\u53d1\u91cf\u5f88\u5927\uff0c\u5efa\u8bae\u7f13\u5b58\u5ef6\u8fdf\u53cc\u5220\u7684\u7b56\u7565\uff0c \u6765\u4fdd\u8bc1\u6700\u7ec8\u7684\u4e00\u81f4\u6027</li> </ul>"},{"location":"chap7/Arch_anws/#16-redis","title":"16 redis\u5728\u96c6\u7fa4\u4e0b\u91cd\u8981\u5e94\u7528\u5206\u5e03\u5f0f\u9501","text":"<p>redis\u4fdd\u8bc1\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b, \u5728\u4fee\u6539\u5e93\u5b58\u6570\u636e. \u5426\u5219\u6570\u636e\u5e93\u5c31\u6539\u4e71\u4e86\u3002 \u4f20\u7edf\u7684\u5355\u4f53\u67b6\u6784\uff0c\u4e00\u53f0\u670d\u52a1\u5668\u4e00\u4e2aJVM\uff0c\u53ef\u4ee5\u7528jvm\u91cc\u9762\u7684\u4e00\u4e2a\u5185\u90e8\u9501\uff0c \u4f8b\u5982synchrionized, lock \u5c31\u53ef\u4ee5\u641e\u5b9a\u3002\u800c\u5bf9\u4e8e\u591a\u53f0\u670d\u52a1\u5668\u90a3\u4e48\u5206\u5e03\u5f0f\u67b6\u6784\u96c6\u7fa4\u67b6\u6784,Jvm\u9501. \u662f\u4fdd\u8bc1\u4e0d\u4e86\u6570\u636e\u7684\u8fd9\u4e2a\u6b63\u5e38\u6263\u51cf\u7684</p> <p>\u8fd9\u65f6\u5019\u5462\u5c31\u9700\u8981\u5f15\u5165\u5206\u5e03\u5f0f\u9501\uff0c\u5206\u5e03\u5f0f\u9501\u6709\u5f88\u591a\u3002\u5178\u578b\u57fa\u4e8e\u8fd9\u4e2a\u6570\u636e\u5e93\uff0c \u57fa\u4e8ezookeeper.  \u57fa\u4e8eredis, \u8fd8\u662f\u4f1a\u9009\u62e9redis\u6765\u4f5c\u4e3a\u4e00\u4e2a\u5206\u5e03\u5f0f\u9501\uff0c<code>setnx key valuext</code> , \u4e0d\u8981\u5fd8\u8bb0\u4e86\u52a0\u8fd9\u4e2a\u8fc7\u671f\u65f6\u95f4, </p> <p>\u6bd4\u5982\u8bf4\u50cf\u4e1a\u52a1\u7684bug. \u4f1a\u5bfc\u81f4\u8fd9\u4e2a\u89e3\u9501\u5931\u8d25. \u6240\u6709\u9700\u8981\u52a0\u9501\u7684\u7ebf\u7a0b , \u4f1a\u5168\u90e8\u963b\u585e, \u5e38\u8bf4\u7684\u6b7b\u9501,\u4e3a\u4e86\u9632\u6b62\u8fd9\u4e2a\u6b7b\u9501. \u52a0\u8fc7\u671f\u65f6\u95f4, </p> <p>\u4e00\u4e2a\u65b0\u7684\u95ee\u9898, \u4e07\u4e00\u8fd9\u4e2a\u65f6\u95f4\u5230\u4e86\u3002\u4e1a\u52a1\u903b\u8f91\u8fd8\u6ca1\u5904\u7406\u5b8c\u600e\u4e48\u529e\uff0c\u7528\u4e00\u4e2a\u5b88\u62a4\u7ebf\u7a0b\u53bb\u7eed\u547d\uff08watch dog)\u3002  \u6211\u4eec\u9700\u8981\u989d\u5916\u7684\u8d77\u4e00\u4e2a\u7ebf\u7a0b, \u53bb\u5b9a\u671f\u68c0\u67e5,\u5982\u679c\u8fd8\u6ca1\u6709\u5904\u7406\u5b8c, key\u7684\u8fd9\u4e2a\u8fc7\u671f\u65f6\u95f4\u505a\u4e00\u4e2a\u5ef6\u957f.</p> <p>\u5982\u679c\u60f3\u8d70\u6377\u5f84, \u53ef\u4ee5\u53bb\u96c6\u6210\u3002 \u4e00\u4e9b\u5206\u5e03\u5f0f\u9501\u7684\u8fd9\u4e2a\u7ec4\u4ef6redisson. \u4e5f\u662f\u57fa\u4e8eredis\u7684\u4e00\u4e2a\u5206\u5e03\u5f0f\u9501</p>"},{"location":"chap7/Arch_anws/#17-redis","title":"17 redis\u4e8b\u52a1","text":"<p>\u90a3\u4e48redis\u6240\u8bf4\u7684\u8fd9\u4e2a\u4e8b\u52a1\uff0c\u4e00\u7cfb\u5217\u547d\u5206\u7684\u96c6\u5408\u653e\u5728\u4e00\u8d77\u3002\u7136\u540e\u8fdb\u884c\u5e8f\u5217\u5316\u6309\u7167\u96c6\u5408\u4e2d\u7684\u547d\u4ee4\u7684\u987a\u5e8f\uff0c\u4e00\u4e2a\u4e00\u4e2a\u7684\u53bb\u6267\u884c\uff0c\u4e32\u884c\u5316\u3002\u5728\u547d\u4ee4\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u80fd\u53bb\u63d2\u5165\u7684\u53bb\u6267\u884c\uff0c\u662fredis\u6240\u8bf4\u7684\u4e8b\u52a1\u3002</p>"},{"location":"chap7/Arch_anws/#18-redis","title":"18 redis\u7684\u6570\u636e\u7ed3\u6784\u4ee5\u53ca\u5e94\u7528\u573a\u666f","text":"<p>string\u5e94\u7528\u573a\u666f</p> <p>\u7ed3\u6784\u7b80\u5355\uff0c <code>set key value</code>\uff0c\u7528\u6765\u5b58\u7b80\u5355\u7684\u5b57\u6bcd\u4e32\u3002\u53ef\u4ee5\u7528\u6765\u5b58json, XML, \u4e8c\u8fdb\u5236\u7684\u56fe\u7247, \u5b58\u50a8,\u4fdd\u5b58\u767b\u5f55\u7684token\u5bf9, spring oauth\u8fd9\u4e2a\u9274\u6743\u7ec4\u4ef6\uff0c string\u5b58\u50a8\u767b\u9646\u7684token. \u8fd8\u53ef\u4ee5\u7528string\u7c7b\u578b\u6765\u505a\u8ba1\u6570\u5668,</p> <p>\u5bf9\u8c61, \u793e\u4ea4\u7cfb\u7edf\u91cc\u7684\u8fd9\u4e2a\u7528\u6237\u4fe1\u606f. \u6709\u660e\u663e\u7684\u8fd9\u4e2a\u51b7\u70ed\u6570\u636e\u4e4b\u5206, \u53ef\u4ee5\u5c06\u8fd9\u4e2a\u5bf9\u8c61\u8f6c\u6210json\u5b57\u7b26\u4e32, \u90a3\u4e48\u8bbf\u95ee\u91cf\u8d8a\u9ad8\u7684\u6570\u636e. \u6709\u6548\u671f\u53ef\u4ee5\u8bbe\u7f6e\u7684\u76f8\u5e94\u7684\u957f\u4e00\u4e9b </p> <p>\u51b7\u6570\u636e\uff0c \u968f\u7740\u8fc7\u671f\u65f6\u95f4\u554a\uff0c\u5c31\u6162\u6162\u7684\u4ece\u8fd9\u4e2a\u7f13\u5b58\u4e2d\u6dd8\u6c70\u4e86\u3002\u9664\u4e86string\u7c7b\u578b\u5176\u4ed6\u7684\u90fd\u662f\u96c6\u5408\u4e86</p> <p>list</p> <p>\u5c31\u662f\u987a\u5e8f\uff0c\u4e00\u822c\u662f\u7528\u5b83\u6765\u505a\u6682\u5b58\uff0c\u6b64\u5982\u8bf4\u9891\u7e41\u64cd\u4f5c\u7684\u8fd9\u4e2a\u70b9\u8d5e\u3002 </p> <p>set\u96c6\u5408\u7684\u7279\u70b9\u5462\u5c31\u662f\u53bb\u91cd\u65e0\u5e8f\u5bf9\uff0c </p> <p>\u7edf\u8ba1\u5b58\u50a8\u7528\u6237\u7684ID\uff0cset\u8fd8\u63d0\u4f9b\u4e86\u6c42\u4ea4\u96c6\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u7528\u6765\u505a\u8fd9\u4e2a\u63a8\u8350\u554afeed\u6d41</p> <p>zset \u5c31\u662f\u52a0\u4e86\u8fd9\u4e2a\u6392\u5e8f </p> <p>\u5b83\u91cc\u9762\u6709\u4e00\u4e2adouble\u7c7b\u578b\u7684score\u53ef\u4ee5\u7528\u6765\u505a\u6392\u5e8f,\u5178\u578b\u7684\u5c31\u662f\u7528\u6765\u505a\u6392\u884c\u699c.\u6bd4\u5982\u8bf4\u70ed\u95e8\u7684\u8bfe\u7a0b\u6392\u884c. \u9605\u8bfb\u6392\u884c, \u70ed\u95e8\u7684\u8bdd\u9898\u6392\u884c, \u90fd\u53ef\u4ee5\u7528zset\u6765\u5904\u7406</p> <p>hash\u7c7b\u578b</p> <p>string\u7c7b\u578b\u7684key\u8ddfstring\u7c7b\u578b\u7684\u8fd9\u4e2avalue\u7ec4\u6210\u7684, \u6bd4\u8f83\u9002\u5408\u5bf9\u8c61\u5b58\u50a8, \u5c31\u662f\u7528\u6765\u5b58\u50a8\u8fd9\u4e2a\u5927\u5bb9\u91cf\u7684\u6570\u636e. \u5c31\u662fredis\u5728\u96c6\u5408\u91cc\u9762</p> <p>\u4e0d\u7ba1\u662fset\u8fd8\u662fzset, list \u8fd8\u662f hash, \u4e0d\u63d0\u4f9b\u8fc7\u671f\u65f6\u95f4\u7684\u8bbe\u7f6e, \u6240\u4ee5\u4f1a\u957f\u65f6\u95f4\u7684\u5b58\u50a8\u5728\u7f13\u5b58\u4e2d, \u6bd4\u8f83\u9002\u5408\u5b58\u50a8\u4e00\u4e9b\u8bbf\u95ee\u91cf\u5927, \u6bd4\u8f83\u56fa\u5316\u7684\u6570\u636e</p> <p>\u5982\u679c\u60f3\u6dfb\u52a0\u8fc7\u671f\u65f6\u95f4, \u9700\u8981\u81ea\u5df1\u53bb\u5b9e\u73b0. </p> <p>\u53e6\u5916\u4eceredis3.2\u5f00\u59cb, redis\u63d0\u4f9b\u4e86\u5730\u7406\u4f4d\u7f6e\u7684\u4fe1\u606f\u7684\u652f\u6301, \u5c31\u662f\u6dfb\u52a0\u4e86geo\u7684\u6570\u636e\u7c7b\u578b. \u53ef\u4ee5\u5c06\u4f4d\u7f6e\u4fe1\u606f, \u50cf\u8fd9\u4e2a\u7ef4\u5ea6, \u7ecf\u7eac\u5ea6\u6dfb\u52a0\u5230\u8fd9\u4e2akey\u4e2d\uff0c\u5f88\u5bb9\u6613\u5462\u8fdb\u884c\u8fd9\u4e2a\u5730\u7406\u4f4d\u7f6e\u7684\u68c0\u7d22\u3002 \u5185\u90e8\u91c7\u7528\u7684\u5c31\u662f\u6709\u5e8f\u96c6\u5408\u7684\u5b9e\u73b0\u3002\u90a3\u4e48\u9760\u7740\u8fd1\u7684\u5c31\u4f1a\u4f18\u5148\u63a8\u8350\uff0c\u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662f\u57fa\u4e8e\u5730\u7406\u4f4d\u7f6e\u7684\u641c\u7d22\uff0c\u6bd4\u5982\u8bf4\u9644\u8fd1\u7684\u4eba\uff0c\u9644\u8fd1\u7684\u5546\u5e97\uff0c\u52a0\u6cb9\u7ad9</p>"},{"location":"chap7/Arch_anws/#18-redis_1","title":"18 redis\u5206\u5e03\u5f0f\u9501\u5728\u4e3b\u4ece\u6a21\u5f0f\u4e0b\u7684\u5751","text":"<p>\u4e00\u822c\u505aredis\u9ad8\u53ef\u7528\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u7528redis cluster\u6a21\u5f0f\uff0c\u6bd4\u5982\u8bf4\u4e09\u4e3b\u4e09\u4ece\u3002</p> <p>\u4e3b\u5e93\u6309\u7167\u4e00\u5b9a\u7684\u903b\u8f91\u5b58\u50a8\u6570\u636e\uff0c\u65e2\u8d1f\u8d23\u8bfb\u4e5f\u8d1f\u8d23\u5199\uff0c\u4ece\u5e93\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u6253\u9171\u6cb9\u7684\u4e5f\u5c31\u540c\u6b65\u4e2a\u6570\u636e\uff0c\u5c31\u7b49\u4e3b\u5e93\u6302\u4e86\u6765\u505a\u66ff\u8865\uff0c\u8fd9\u79cdcluster\u7684\u4e3b\u4ece\u6a21\u5f0f\uff0c\u63d0\u5347\u4e86\u6574\u4f53\u7684\u6027\u80fd\u3002</p> <p>\u6570\u636e\u4e5f\u662f\u5206\u5e03\u5f0f\u5b58\u50a8\u7684\uff0c\u4e5f\u80fd\u591f\u7f13\u89e3\u8bbf\u95ee\u538b\u529b\u3002</p> <p>\u4f46\u662f\u63d0\u5347\u6027\u80fd\u7684\u540c\u65f6\uff0c\u4e5f\u5e26\u6765\u4e86\u4e00\u4e9b\u5176\u4ed6\u95ee\u9898\u3002 \u6bd4\u5982\u8bf4\u5bf9\u4e8eRedis\u7684\u5206\u5e03\u5f0f\u9501\uff0c\u5bf9\u4e8e<code>Redis cluster</code>\u6a21\u5f0f\u7684\u5206\u5e03\u5f0f\u9501\u3002</p> <p>\u5982\u679c\u60f3\u8981\u52a0\u9501,\u4e00\u822c\u90fd\u4f1a\u6839\u636e\u4e00\u5b9a\u7684\u8ba1\u7b97\u89c4\u5219\u627e\u5230\u4e00\u4e2amaster\u6765\u5199\u5165key, \u5728\u52a0\u9501\u6210\u529f\u4e4b\u540e, master\u8282\u70b9key\u5f02\u6b65\u590d\u5236\u7ed9\u5bf9\u5e94\u7684\u4ece\u8282\u70b9, \u4f46\u662f\u4e00\u65e6master\u8282\u70b9\u5f02\u5e38\u6545\u969c, \u5b95\u673a\uff0c\u4ece\u8282\u70b9\u590d\u5236\u5931\u8d25. \u90a3\u4e48\u4e3a\u4e86\u4fdd\u8bc1\u96c6\u7fa4\u7684\u53ef\u7528\u6027, \u5c31\u4f1a\u8fdb\u884c\u4e3b\u5907\u5207\u6362. Slave\u5c31\u4f1a\u53d8\u6210master\uff0c\u5982\u679c\u6709\u65b0\u7684\u7ebf\u7a0b\u8bbf\u95ee\u5c31\u4f1a\u628a\u9501\u52a0\u5230\u65b0\u7684\u8282\u70b9\u4e0a\u9762\uff0c </p> <p>\u8fd9\u6837\u4e00\u6765\u7cfb\u7edf\u91cc\u9762\u5c31\u4f1a\u51fa\u73b0\u4e24\u628a\u9501\uff0c\u540e\u679c\u53ef\u60f3\u800c\u77e5\uff0c\u5c31\u4f1a\u51fa\u73b0\u5404\u79cd\u810f\u6570\u636e\u3002</p> <p>\u76ee\u524d\u5462\u4e5f\u662f\u6709\u4e00\u4e9b\u89e3\u6c7a\u65b9\u6848\uff0c\u5e38\u89c1\u5c31\u662fredlock\u3002\u539f\u7406\u5c31\u662f\u9700\u8981\u90e8\u7f72\uff0credis\u7684\u5f88\u591a\u4e2a\u8282\u70b9\uff0c\u6bcf\u4e00\u4e2a\u8282\u70b9\u76f8\u5bf9\u72ec\u7acb\uff0c\u4e0d\u5b58\u5728\u4e3b\u4ece\u590d\u5236\u3002</p> <p>\u52a0\u9501\u7684\u65f6\u5019\uff0c\u5ba2\u6237\u7aef\u4f9d\u6b21\u5411\u8fd9\u51e0\u4e2aredis\u5b9e\u4f8b\u5462\u53d1\u8d77\u52a0\u9501\u8bf7\u6c42\uff0c\u53ef\u4ee5\u7528set\u547d\u4ee4\uff0c\u4e5f\u90fd\u4f1a\u8bbe\u7f6e\u4e00\u4e2a\u8d85\u65f6\u65f6\u95f4\u3002</p> <p>\u5982\u679c\u67d0\u4e00\u4e2a\u5b9e\u4f8b\u52a0\u901f\u5931\u8d25\uff0c\u6bd4\u5982\u8bf4\u7f51\u7edc\u8d85\u65f6\uff0c\u5c31\u4f1a\u7acb\u5373\u5411\u4e0b\u4e00\u4e2aredis\u5b9e\u4f8b\u7533\u8bf7\u52a0\u9501\u3002</p> <p>\u5982\u679c\u5ba2\u6237\u7aef\uff0c\u5927\u591a\u6570\u7684\u8fd9\u4e2a\u5b9e\u4f8b\u52a0\u9501\u6210\u529f\uff0c\u7ebf\u7a0b\u52a0\u9501\u6210\u529f\uff0c\u5426\u5219\u5c31\u4f1a\u8ba4\u4e3a\u52a0\u9501\u5931\u8d25\u3002 </p> <p>\u52a0\u9501\u6210\u529f\u5c31\u53ef\u4ee5\u64cd\u4f5c\u4e00\u4e9b\u5171\u4eab\u8d44\u6e90\uff0c\u6bd4\u5982\u8bf4MYSQL\u7684\u67d0\u4e00\u6761\u8bb0\u5f55\u3002 \u5982\u679c\u52a0\u9501\u5931\u8d25\u5c31\u53ef\u4ee5\u5411\u5168\u90e8\u8282\u70b9\u53d1\u8d77\u91ca\u653e\u9501\u7684\u8bf7\u6c42\u3002 </p> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2alua\u811a\u672c\uff0c \u6765\u91ca\u653e\u9501\u5b9e\u73b0\u8d77\u6765\u8fd8\u662f\u6bd4\u8f83\u590d\u6742\u7684\u3002\u8fd8\u662f\u4f7f\u7528\u8fd9\u4e2aRedison\u6765\u505a\u4e00\u4e9b\u5904\u7406\u3002</p> <p>\u5f53\u7136\u5982\u679c\u91cf\u4e0d\u662f\u5f88\u5927\uff0c\u5355\u673a\u7684\u8fd9\u4e2aredis\u5b9e\u4f8b\u5c31\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\u3002\u81ea\u7136\u5c31\u80fd\u591f\u907f\u5f00\u4e3b\u4ece\u6a21\u5f0f\u7684\u5751\uff0c\u5373\u4f7f\u4e0a\u4e86redis cluster\u6a21\u5f0f\uff0c redis\u6302\u4e86\u7684\u6982\u7387\u8fd8\u662f\u633a\u5c0f\u7684\uff0c \u5c3d\u91cf\u4fdd\u8bc1\u673a\u5668\u7684\u7a33\u5b9a\u6027\u5c31\u597d\u4e86\u3002 </p>"},{"location":"chap7/Arch_anws/#2_2","title":"2 \u5206\u5e03\u5f0f","text":""},{"location":"chap7/Arch_anws/#1_2","title":"1 \u8c08\u8c08\u4f60\u5bf9\u5206\u5e03\u5f0f\u7684\u7406\u89e3","text":"<p>\u5206\u5e03\u5f0f\u6846\u67b6\uff0c\u4e00\u4e2a\u662f\u963f\u91cc\u7684\u8fd9\u4e2adubbo\uff0c \u4e00\u4e2a\u662fspringcloud\u3002\u5b9e\u73b0\u7684\u539f\u7406\u90fd\u5927\u5dee\u4e0d\u5dee\uff0c \u6ce8\u518c\u4e2d\u5fc3\uff0c\u914d\u7f6e\u4e2d\u5fc3\uff0c\u8ba4\u8bc1\u4e2d\u5fc3, \u4e1a\u52a1\u4e2d\u5fc3\u7b49\u7b49</p> <p>\u5206\u5e03\u5f0f\u6846\u67b6\u5f15\u5165\u5f88\u65b9\u4fbf\uff0c\u4f46\u662f\u540c\u6837\u4e5f\u5e26\u6765\u4e86\u5f88\u591a\u7684\u95ee\u9898\u3002\u6bd4\u5982\u8bf4\u7cfb\u7edf\u4f1a\u53d8\u5f97\u8d8a\u6765\u8d8a\u590d\u6742\u3002 \u7cfb\u7edf\u7684\u7ef4\u62a4\u6210\u672c\u4e5f\u5f88\u9ad8\uff0c\u7248\u672c\u8fed\u4ee3\u53d1\u5e03\u7684\u4e5f\u53d8\u5f97\u8d8a\u6765\u8d8a\u590d\u6742\u3002\u8fd8\u6709\u6700\u5e38\u89c1\u7684\u5c31\u662fcap\u95ee\u9898, \u4e00\u81f4\u6027\u7684\u95ee\u9898\u7b49\u7b49</p>"},{"location":"chap7/Arch_anws/#2-rpc","title":"2 \u5206\u5e03\u5f0f\u5fae\u670d\u52a1\u7684\u7075\u9b42-rpc\u7684\u7406\u89e3","text":"<p>RPC\u5176\u5b9e\u5c31\u662f\u5206\u5e03\u5f0f\u5fae\u670d\u52a1\u6846\u67b6\u7684\u7075\u9b4f \u4ec0\u4e48\u662fRPC\uff0c\u53ef\u4ee5\u7b80\u5355\u7684\u7406\u89e3\u6210\u8de8\u6a21\u5757\u670d\u52a1\u8c03\u7528\u7684\u6846\u67b6\uff0c\u4f20\u7edf\u7684\u5355\u4f53\u67b6\u6784\uff0c\u8c03\u7528\u670d\u52a1\u53ef\u4ee5\u5f88\u7b80\u5355\uff0c\u76f4\u63a5\u662f\u5148\u5f15\u7528\u8fd9\u4e2aservice\u3002 \u7528service.\u65b9\u6cd5\u540d\u7684\u65b9\u5f0f\u5c31\u8c03\u7528\u6210\u529f\u4e86\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u670d\u52a1\uff0c\u90fd\u5199\u5728\u4e00\u4e2a\u5305\u91cc\u9762\uff0c \u53ef\u4ee5\u76f4\u63a5\u5728\u672c\u5730\u8c03\u7528\u3002</p> <p>\u4f46\u662f\u4e00\u65e6\u6539\u5199\u6210\u4e86\u8fd9\u4e2a\u5206\u5e03\u5f0f\u4e4b\u540e\uff0c \u5fae\u670d\u52a1\u4e4b\u540e\u5f88\u591a\u6a21\u5757\u3002 \u5206\u522b\u5728\u4e0d\u540c\u7684\u8fd9\u4e2a\u6a21\u5757\u4e2d\uff0c\u7528\u6237\u4e2d\u5fc3\uff0c\u5546\u54c1\u4e2d\u5fc3\uff0c\u8ba2\u5355\u4e2d\u5fc3\uff0c\u901a\u77e5\u4e2d\u5fc3\u7b49\u7b49\u5f7c\u6b64\u72ec\u7acb\u3002 </p> <p>\u6bd4\u5982\u8bf4\u6211\u8981\u8d2d\u4e70\u5546\u54c1\uff0c \u5c31\u6d89\u53ca\u5230\u5bf9\u7528\u6237\u4e2d\u5fc3\u7684\u8c03\u7528\uff0c \u6bd4\u5982\u8bf4\u9700\u8981\u53bb\u5224\u5b9a\u3002 \u8fd9\u4e2a\u7528\u6237\u6709\u6ca1\u6709\u767b\u5f55\uff0c \u8d26\u6237\u6709\u6ca1\u6709\u8fd9\u4e2a\u79ef\u5206\u53ef\u4ee5\u62b5\u6263\uff0c \u4f20\u7edf\u7684\u53ef\u80fd\u4f1a\u7528\u8fd9\u4e2ahttp\u63a5\u53e3\u7684\u65b9\u5f0f\uff0c \u6765\u8c03\u7528\uff0c \u4f20\u53c2\uff0c\u54cd\u5e94\uff0c\u8fd4\u53c2\uff0c\u90a3\u4e48\u5bf9\u4e8e\u7b80\u5355\u7684\u8fd9\u4e2a\u4e1a\u52a1\u6765\u8bf4\uff0c \u5176\u5b9e\u95ee\u9898\u4e5f\u4e0d\u5927</p> <p>\u4f46\u662f\u4e00\u65e6\u4e1a\u52a1\u91cf\u5927\u4e86\uff0c\u4e1a\u52a1\u590d\u6742\uff0chttp\u63a5\u53e3\u7684\u6548\u7387\u5c31\u4f1a\u5f88\u4f4e\uff0chttp\u67093\u6b21\u63e1\u624b\u3002\u7f51\u7edc\u5f00\u9500\u4e5f\u56e0\u6b64\u5462\u4f1a\u6709\u975e\u5e38\u5927\uff0c\u90a3\u4e48\u4e00\u65e6\u9891\u7e41\u4f7f\u7528\u7684\u6548\u7387\u4e0a\u8fd8\u662f\u4f1a\u6709\u4e00\u4e9b\u5f71\u54cd\u7684\u3002</p> <p>\u5c31\u5f97\u8003\u8651\u8fd9\u4e2arpc\u6846\u67b6\uff0c\u8ba9\u670d\u52a1\u8c03\u7528\u8ddf\u672c\u5730\u8c03\u7528\u4e00\u6837\uff0c\u9ad8\u6027\u80fd\u4f4e\u5ef6\u8fdf\u3002</p> <p>\u90a3\u4e48\u7528\u6237\u672c\u8eab\uff0c\u6839\u672c\u5c31\u611f\u53d7\u4e0d\u5230\u8fd9\u4e2a\u8fdc\u7a0b\u7684\u8fd9\u4e2a\u8c03\u7528\u3002\u5b9e\u73b0\u539f\u7406\u4e5f\u5f88\u7b80\u5355  \u6240\u6709\u7684\u670d\u52a1\u5148\u6ce8\u518c\u5230\u6ce8\u518c\u4e2d\u5fc3\uff0c\u90a3\u4e48\u6ce8\u518c\u4e2d\u5fc3\u5462\u5fc5\u987b\u8981\u6709\u7684\uff0c\u8d77\u5230\u4e86\u8fd9\u4e2a\u670d\u52a1\u8c03\u5ea6\uff0c\u76d1\u6d4b\u7684\u4e00\u4e2a\u529f\u80fd\uff0c\u80fd\u770b\u5230\u5404\u4e2a\u6a21\u5757\u7684\u670d\u52a1\u5305\u7684\u6ce8\u518c\uff0c\u5bf9\u5e94\u7684\u8fd9\u4e2aIP\u554a\u7aef\u53e3\uff0c \u6709\u51e0\u4e2a\u670d\u52a1\u5305\u5728\u7ebf\u7b49\u7b49\u3002 </p> <p>\u90a3\u4e48\u6bcf\u6b21\u8c03\u7528\u7684\u65f6\u5019\uff0c \u53ef\u4ee5\u5148\u628a\u8fd9\u4e2a\u8bf7\u6c42\u53d1\u9001\u5230\u6ce8\u518c\u4e2d\u5fc3\uff0c\u90a3\u4e48\u6ce8\u518c\u4e2d\u5fc3\u627e\u5230\u5bf9\u5e94\u7684\u670d\u52a1\u3002\u8fd4\u56de\u7ed9\u8fd9\u4e2a\u8c03\u7528\u7684\u6a21\u5757\uff0c\u5982\u679c\u662f\u96c6\u7fa4\u90e8\u7f72\uff0c\u90a3\u4e48\u5c31\u6309\u7167\u8fd9\u4e2a\u8f6e\u8be2\u7684\u7b56\u7565\u6216\u8005\u4e00\u4e9b\u7279\u6b8a\u7684\u7b56\u7565\u90fd\u53ef\u4ee5\u3002</p> <p>\u627e\u5230\u4e00\u4e2a\u53ef\u4ee5\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u5305\u5b8c\u6210\u8c03\u7528\uff0c\u7136\u540e\u8fd4\u56de\u7ed3\u679c\u3002\u539f\u7406\u57fa\u672c\u4e0a\u90fd\u662f\u8fd9\u6837\uff0c\u5e38\u89c1\u7684rpc\u6846\u67b6\u6709\u5f88\u591a\u3002 \u6b64\u8f83\u5e38\u89c1\u7684\u5c31\u662fdubbo\uff0c spring \u91cc\u7684 feign</p> <p>\u6ce8\u518c\u4e2d\u5fc3\uff0c\u4e00\u822c\u90fd\u662fzookeeper\uff0c \u90a3\u4e48Feignt, \u4e00\u822c\u90fd\u7528spring cloud\u91cc\u9762\u7684\u5168\u5bb6\u6876\uff0ceureca\u3002\u8fd8\u6709\u5176\u4ed6\u7684\u4e00\u4e9b\u6ce8\u518c\u4e2d\u5fc3</p>"},{"location":"chap7/Arch_anws/#3","title":"3 \u670d\u52a1\u6302\u4e86\u6ce8\u518c\u4e2d\u5fc3\u5982\u4f55\u611f\u77e5\u670d\u52a1\u4e0d\u53ef\u7528","text":"<p>\u901a\u5e38\u8bb2\u7684\u670d\u52a1\u4e0d\u53ef\u7528\uff0c\u670d\u52a1\u6389\u7ebf\u554a\u4e00\u822c\u662f\u6709\u4e24\u79cd\u60c5\u6cc1\uff0c\u4e00\u79cd\u662f\u5c5e\u4e8e\u8fd9\u4e2a\u4e3b\u52a8\u4e0b\u7ebf\u3002 \u4e00\u79cd\u662f\u5c5e\u4e8e\u8fd9\u4e2a\u5f02\u5e38\u4e0b\u7ebf\uff0c\u786c\u4ef6\u6545\u969c\u554a\u5b95\u673a\uff0c\u8d85\u65f6\u8c03\u7528\u7b49\u7b49\u5404\u79cd\u5f02\u5e38\u60c5\u6cc1\u3002</p> <p>\u90a3\u4e48\u4e3b\u52a8\u4e0b\u7ebf\uff0c \u4e00\u4e2a\u53ef\u63a7\u7684\u72b6\u6001\uff0c \u4e00\u822c\u662f\u5728\u53d1\u7248\u7684\u65f6\u5019\uff0c\u8fd9\u65f6\u5019\u4f1a\u5148\u505c\u6389\u8fd9\u4e2a\u670d\u52a1\uff0c\u5728\u505c\u6b62\u4e4b\u524d\u670d\u52a1\u5305\u4f1a\u901a\u77e5\u8fd9\u4e2a\u6ce8\u518c\u4e2d\u5fc3\uff0c \u6709\u6d41\u91cf\u8fdb\u6765\u7684\u5148\u4e0d\u8981\u5206\u7ed9\u6211\uff0c\u8ba9\u522b\u7684\u673a\u5668\u6765\u8fdb\u884c\u670d\u52a1\uff0c\u7b49\u91cd\u542f\u6210\u529f\u4e4b\u540e\u518d\u653e\u6d41\u91cf\u8fdb\u6765\u3002</p> <p>\u6216\u8005\u662f\u5728\u7ba1\u7406\u540e\u53f0\uff0c\u624b\u52a8\u53bb\u6458\u6389\u8fd9\u4e2a\u673a\u5668\u3002\u8fd9\u79cd\u60c5\u6cc1\u4e0b\u662f\u7531\u670d\u52a1\u5305\uff0c\u6765\u901a\u77e5\u8fd9\u4e2a\u6ce8\u518c\u4e2d\u5fc3\u3002 \u6ce8\u518c\u4e2d\u5fc3\u6536\u5230\u6d88\u606f\u4e4b\u540e\uff0c\u4f1a\u4e3b\u52a8\u5220\u9664\u8be5\u670d\u52a1\u7684\u8fd9\u4e2a\u5728\u7ebf\u72b6\u6001\uff0c \u8fd9\u6837\u5c31\u80fd\u591f\u907f\u514d\u6d41\u91cf\u8bbf\u95ee\u5230\u8fd9\u4e2a\u4e0b\u7ebf\u7684\u673a\u5668\u4e0a\u9762</p> <p>\u53e6\u5916\u4e00\u79cd\u662f\u8fd9\u4e2a\u5f02\u5e38\u4e0b\u7ebf\uff0c\u65ad\u7535\u65ad\u7f51\uff0c\u670d\u52a1\u5b95\u673a\u3002\u6ce8\u518c\u4e2d\u5fc3\u4e0d\u77e5\u9053\u8be5\u670d\u52a1\u5df2\u7ecf\u6389\u7ebf\u4e86\uff0c\u90a3\u4e48\u4e00\u65e6\u88ab\u5176\u4ed6\u7684\u8fd9\u4e2a\u6a21\u5757\u8c03\u7528\u4e86\u5c31\u4f1a\u5e26\u6765\u4e00\u4e9b\u4f55\u9898\u3002</p> <p>\u90a3\u4e48\u4e3a\u4e86\u907f\u514d\u51fa\u73b0\u8fd9\u6837\u7684\u60c5\u6cc1\uff0c\u6ce8\u518c\u4e2d\u5fc3\u589e\u52a0\u4e86\u4e00\u4e2a\u5fc3\u8df3\u68c0\u6d4b\u529f\u80fd\uff0c\u4f1a\u5bf9\u670d\u52a1\u7684\u63d0\u4f9b\u8005provider\uff0c\u8fdb\u884c\u8fd9\u4ecb\u5fc3\u8df3\u68c0\u6d4b\uff0c\u6bcf\u969430\u79d2\u5c31\u4f1a\u53d1\u9001\u4e00\u4e2a\u5fc3\u8df3\uff0c\u90a3\u4e48\u5982\u679c\u4e09\u6b21\u5fc3\u8df3\u90fd\u6ca1\u6709\u8fd4\u56de\u503c\uff0c\u8be5\u670d\u52a1\u5df2\u7ecf\u4e0b\u7ebf\uff0c\u7136\u540e\u8d76\u7d27\u901a\u77e5consumer\uff0c\u6d88\u8d39\u8005\u7aef\u6765\u66f4\u65b0\u7684\u8fd9\u4e2a\u670d\u52a1\u5217\u8868\uff0c\u544a\u8bc9\u8fd9\u4e2aconsumer\u7aef\u8c03\u7528\u522b\u7684\u673a\u5668</p>"},{"location":"chap7/Arch_anws/#4","title":"4 \u6ce8\u518c\u4e2d\u5fc3\u6302\u4e86\u670d\u52a1\u4e4b\u95ee\u8fd8\u80fd\u76f8\u4e92\u8c03\u7528\u5417","text":"<p>\u5982\u679c\u6ce8\u518c\u4e2d\u5fc3\u6302\u4e86\u670d\u52a1\u4e4b\u95f4\u8fd8\u80fd\u4e0d\u80fd\u76f8\u4e92\u8c03\u7528\uff1f</p> <p>\u80fd\u8c03\u7528\uff0c\u4e0d\u80fd\u8c03\u7528\u8981\u770b\u5177\u4f53\u7684\u573a\u666f </p> <p>\u6ce8\u518c\u4e2d\u5fc3\u6570\u636e\u5e93\u6302\u6389\u3002 \u5176\u5b9e\u4e5f\u65e0\u6240\u8c13, \u6ce8\u518c\u4e2d\u5fc3\u8fd8\u662f\u80fd\u591f\u7528\u7684, \u4e00\u822c\u90fd\u4f1a\u628a\u6ce8\u518c\u673a\u7684\u4fe1\u606f\u653e\u5728\u7684\u7f13\u5b58\u91cc\u9762\u3002 \u6ce8\u518c\u4e2d\u5fc3\u6570\u636e\u5e93\u6302\u6389\uff0c \u6211\u4eec\u4ece\u7f13\u5b58\u91cc\u9762\u635e\u6570\u636e\u5c31\u53ef\u4ee5\u4e86.</p> <p>\u5982\u679c\u7f13\u5b58\u4e5f\u6302\u4e86\u8bbf\u95ee\u4e0d\u4e86\u4e86,  \u5982\u679c\u4f60\u91c7\u7528\u7684\u662f\u96c6\u7fa4\u6a21\u5f0f, \u4e5f\u4e0d\u7528\u62c5\u5fc3. \u8fd8\u662f\u4f1a\u9009\u62e9\u5176\u4ed6\u7684\u8282\u70b9\u6765\u4f5c\u4e3a master \u7ee7\u7eed\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u7684. </p> <p>\u4f46\u662f\u5982\u679c\u6ce8\u518c\u4e2d\u5fc3\u96c6\u7fa4\u90fd\u6302\u4e86,  \u6570\u636e\u5e93\u7f13\u5b58\u4e5f\u8bbf\u95ee\u4e0d\u4e86, \u4e00\u70b9\u4e8b\u90fd\u6ca1\u6709.\u56e0\u4e3a\u8c03\u7528\u8005\u672c\u5730, \u4e5f\u4f1a\u7f13\u5b58\u4e00\u4efd\u8fd9\u4e2a\u670d\u52a1\u5217\u8868. \u5305\u62ecIP\u5730\u5740, \u7aef\u53e3, \u540d\u79f0\u7b49\u7b49. \u90fd\u4f1a\u4ece\u6ce8\u518c\u4e2d\u5fc3\u62c9\u53d6\u4e00\u4efd\uff0c \u5f53\u524d\u670d\u52a1\u5305\u6e05\u5355\u3002\u6240\u4ee5\u5728\u8c03\u7528\u8005\u672c\u5730\u90fd\u4f1a\u5b58\u6709\u4e00\u4efd\u8fd9\u4e2a\u670d\u52a1\u5217\u8868</p> <p>\u4e00\u65e6\u6ce8\u518c\u4e2d\u5fc3\u6302\u4e86\uff0c\u670d\u52a1\u5305\u4e4b\u95f4 consumer\u548cprovider\u4e4b\u95f4\u3002 \u5c31\u4f1a\u91c7\u7528\u8fd9\u4e2a\u76f4\u8054\u7684\u65b9\u5f0f\uff0c\u4e5f\u7701\u7565\u4e86\u548c\u6ce8\u518c\u4e2d\u5fc3\u7684\u4ea4\u4e92\u3002 \u670d\u52a1\u5305\u4e4b\u95f4\u4e5f\u80fd\u591f\u76f8\u4e92\u8c03\u7528\uff0c \u4e0d\u53d7\u5f71\u54cd\u3002\u8fd9\u4e9b\u7b56\u7565\u9700\u8981\u53bb\u505a\u4e00\u4e9b\u914d\u7f6e</p> <p>\u4e0d\u80fd\u8c03\u7528\u7684\u573a\u666f\uff0cprovider \u5c31\u662f\u8fd9\u4e2a\u670d\u52a1\u7684\u63d0\u4f9b\u8005\u7684IP\u5730\u5740, \u7aef\u53e3\u53d1\u751f\u4e86\u6539\u53d8. \u90a3\u4e48\u6b63\u5e38\u60c5\u6cc1\u4e0b, \u6ce8\u518c\u4e2d\u5fc3\u662f\u80fd\u591f\u611f\u77e5\u5230. \u5e76\u4e14\u5e7f\u64ad\u7ed9\u6240\u6709\u7684\u670d\u52a1\u5305. \u670d\u52a1\u5305\u63a5\u6536\u5230\u4e86\u66f4\u65b0\u4fe1\u606f\u4e4b\u540e, \u5c31\u4f1a\u7acb\u523b\u6539\u53d8\u672c\u5730\u7f13\u5b58, \u670d\u52a1\u6e05\u5355\u6570\u636e. \u4f46\u662f\u5728\u6ce8\u518c\u4e2d\u5fc3\u6302\u4e86\u7684\u60c5\u6cc1, \u5176\u4ed6\u7684\u670d\u52a1\u5305\u5c31\u65e0\u6cd5\u66f4\u65b0, \u6240\u4ee5\u5c31\u4f1a\u5bfc\u81f4\u8c03\u7528\u5931\u8d25</p>"},{"location":"chap7/Arch_anws/#5-cap","title":"5 \u5206\u5e03\u5f0f\u7ed5\u4e0d\u5f00\u7684\u9b54\u5492 cap\u5b9a\u5f8b","text":"<p>\u5206\u5e03\u5f0f\uff0c\u4e0d\u5f97\u4e0d\u63d0\u5230CAP\u5b9a\u7406 \u53ef\u7528\u6027\uff0c \u4e00\u81f4\u6027\uff0c\u5bb9\u9519\u6027\u53ea\u80fd\u540c\u65f6\u6ee1\u8db3\u4e24\u4e2a\u3002\u5728\u8ba8\u8bba\u4f18\u5316\u5206\u5e03\u5f0f\u67b6\u6784\u7684\u65f6\u5019\uff0c \u56f4\u7ed5\u8fd93\u4e2a\u70b9\u7684\u63d0\u5347\uff0c\u63d0\u5347\u8fd9\u4e2a\u7cfb\u7edf\u7684\u53ef\u7528\u6027\uff0c\u5c31\u4f1a\u589e\u52a0\u8fd9\u4e2a\u7f13\u5b58\uff0c\u589e\u52a0\u670d\u52a1\u5668\uff0c\u5f15\u5165\u6d88\u606f\u961f\u5217\u3002\u6765\u63d0\u5347\u8fd9\u4e2a\u7cfb\u7edf\u7684\u5e76\u53d1\u91cf</p> <p>\u63d0\u5347\u8fd9\u4e2a\u5bb9\u9519\u6027\uff0c\u53ef\u4ee5\u8fdb\u884c\u8fd9\u4e2a\u670d\u52a1\u5668\u7684\u96c6\u7fa4\u7684\u90e8\u7f72\u3002 \u90a3\u4e48\u4e00\u53f0\u6302\u6389, \u4e0d\u5f71\u54cd\u5176\u4ed6\u8fd9\u4e2a.  \u8282\u70b9\u6b63\u5e38\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1. \u6570\u636e\u5e93\uff0c\u7f13\u5b58\u90fd\u8fdb\u884c\u8fd9\u4e2a\u96c6\u7fa4\u7684\u90e8\u7f72. \u5305\u62ec\u8fd9\u4e2a\u5bb9\u707e\u5907\u4efd</p> <p>\u5206\u5e03\u5f0f\u6570\u636e\u5e93, \u5c31\u662f\u5178\u578b\u7684\u727a\u7272\u4e86\u4e00\u81f4\u6027, \u63d0\u5347\u4e86\u53ef\u7528\u6027, \u5bb9\u9519\u6027\u7684\u4e00\u4e2a\u7ecf\u5178\u7684\u6848\u4f8b</p>"},{"location":"chap7/Arch_anws/#6","title":"6 \u804a\u804a\u5206\u5e03\u5f0f\u4e0b\u7684 \u8d1f\u8f7d\u5747\ud85d\uddfe\u7b56\u54af","text":"<p>\u5206\u5e03\u5f0f\u4e0b\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c \u5728\u8fd9\u4e2a\u5206\u5e03\u5f0f\u5fae\u670d\u7684\u67b6\u6784\u4e2d\uff0c\u4e00\u4e2a\u670d\u52a1\u901a\u5e38\u90fd\u662f\u6709\u597d\u51e0\u4e2a\u76f8\u540c\u7684\u670d\u52a1\u5305\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u7684\u3002 \u6bd4\u5982\u8bf4\u8ba2\u5355\u4e2d\u5fc3\uff0c \u5c31\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u7684\u9700\u8981\u6765\u90e8\u7f72\u591a\u53f0\u670d\u52a1\u5668\uff0c \u6bcf\u53f0\u670d\u52a1\u5668\u4e0a\u90fd\u4f1a\u90e8\u7f72\u4e00\u4e2a\u8ba2\u5355\u4e2d\u5fc3\uff0c\u8ba2\u5355\u4e2d\u5fc3\u7684\u96c6\u7fa4\u7edf\u4e00\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u3002</p> <p>\u5982\u679c\u5927\u91cf\u7684\u8bbf\u95ee\u8fc7\u6765\uff0c\u600e\u4e48\u53bb\u5206\u914d\u8bf7\u6c42\u5230\u76f8\u5e94\u7684\u670d\u52a1\u5668\u4e0a\u53bb\u3002 \u5fae\u670d\u52a1\u67b6\u6784\u4e0b\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u4e0b\u7684\u8d1f\u8f7d\u5747\u8861\u3002 \u5fc5\u4e0d\u53ef\u5c11\u7684\u4e00\u4e2a\u7ec4\u4ef6\uff0cdouble\u6709, spring cloudt\u4e5f\u6709 </p> <p>spring cloud\u662f\u5f15\u7528\u7684\u5916\u5728\u7684\u7ec4\u4ef6\uff0cribbon\u3002 \u5e38\u89c1\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u6709\u5f88\u591a\uff0c\u8f6e\u8be2\u7b56\u7565\uff0c\u968f\u673a\u7b56\u7565\uff0c\u52a0\u6743\u7b56\u7565\u3002 \u6240\u6709\u7684\u8d1f\u8f7d\u5747\u8861\u5176\u5b9e\u90fd\u9700\u8981\u914d\u5408\u6ce8\u518c\u4e2d\u5fc3\u6765\u4f7f\u7528\uff0c\u56e0\u4e3a\u670d\u52a1\u5305\u90fd\u9700\u8981\u6ce8\u518c\u5728\u6ce8\u518c\u4e2d\u5fc3\uff0c\u8c03\u7528\u8005\u9996\u5148\u662f\u83b7\u53d6\u4e86\u670d\u52a1\u5305\u7684\u6ce8\u518c\u4fe1\u606f\u4e4b\u540e\uff0c\u80fd\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u7b56\u7565</p>"},{"location":"chap7/Arch_anws/#7","title":"7 \u6d41\u91cf\u7684\u5165\u53e3 \u7f51\u5173\u7ea7\u7684\u8d1f\u8f7d\u5747\u8861","text":"<p>\u5206\u5e03\u5f0f\u96c6\u7fa4\u6709\u5f88\u591a\u7684\u5e94\u7528\u8d1f\u8f7d\u5747\u8861\u7684\u573a\u666f.  \u7f51\u5173\u7ea7\u7684\u8fd9\u4e2a\u8d1f\u8f7d\u5747\u8861. \u8fd9\u4e2a\u5fae\u670d\u52a1\u7684\u5185\u90e8\u7684\u7f51\u5173\u5c42,  \u6b64\u5982\u50cfspincloud\u7684\u5f15\u5165\u4e86gateway, \u5f15\u5165zuul, \u6765\u4f5c\u4e3a\u5fae\u670d\u52a1\u7684\u7f51\u5173, \u53ef\u4ee5\u8d77\u5230\u9274\u6743\u9650\u6d41\u7194\u65ad\u7684\u4f5c\u7528. \u66f4\u91cd\u8981\u7684\u8fd8\u662f\u5f53\u8def\u7531\u6765\u7528. \u6bd4\u5982\u8bf4\u83b7\u53d6\u4e86\u7528\u6237\u4fe1\u606f, \u8bf7\u6c42\u7684\u662f\u7528\u6237\u4e2d\u5fc3. \u7f51\u5173\u4f1a\u628a\u76f8\u5e94\u7684\u8bf7\u6c42,\u5206\u914d\u7ed9\u8fd9\u4e2a\u7528\u6237\u4e2d\u5fc3\u96c6\u7fa4.</p> <p>\u8ba9\u7528\u6237\u4e2d\u5fc3\u96c6\u7fa4\u53bb\u5904\u7406\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u7684\u8bf7\u6c42, \u7136\u540e\u6309\u7167\u9ed8\u8ba4\u7b56\u7565\u3002\u6bd4\u5982\u8fd9\u4e2a\u8f6e\u8be2\u7b56\u8def\u6765\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\u3002 </p> <p>\u5728\u5fae\u670d\u52a1\u7684\u5916\u90e8\u540c\u6837\u4e5f\u6709\u8d1f\u8f7d\u5747\u8861\uff0c \u6bd4\u5982\u8bf4\u6211\u4eec\u5e38\u89c1\u7684nginx\u3002 \u5c31\u662f\u505a\u8fd9\u4e2a\u53cd\u5411\u4ee3\u7406\uff0c \u4ee3\u7406\u80cc\u540e\u4e00\u5806\u7684\u670d\u52a1\u5668\u3002\u7531\u8fd9\u4e2anginx\u7edf\u4e00\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\uff0c \u8bf7\u6c42\u5148\u8f6c\u53d1\u5230\u8fd9\u4e2anginx\u4e0a\u9762\uff0c\u90a3\u4e48nginx \u518d\u6839\u636e\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u3002 \u8fdb\u884c\u8bf7\u6c42\u8f6c\u53d1\uff0c\u652f\u6301\u9ad8\u4f38\u7f29\u6027\u7684\u96c6\u7fa4\u67b6\u6784\u3002</p> <p>\u6240\u4ee5\u4e00\u822c\u7684\uff0c\u4e91\u670d\u52a1\u7528\u7684\u8fd8\u662f\u6bd4\u8f83\u591a\u4e00\u4e9b\uff0c\u914d\u5408\u5f39\u6027\u8ba1\u7b97\u3002\u53ef\u4ee5\u5b9e\u73b0\u8fd9\u4e2a\u5f39\u6027\u6269\u5bb9\uff0c\u7075\u6d3b\u589e\u51cf\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u642d\u914dF5\uff0c\u786c\u4ef6\u8d1f\u8f7d\u5747\u8861\u5668</p>"},{"location":"chap7/Arch_anws/#8_1","title":"8 \u5982\u4f55\u63d0\u9ad8\u7cfb\u7d71\u53ef\u7528\u6027 \u7ed9\u6bcf\u4e2a\u670d\u52a1\u627e\u4e2a\u5907\u80ce","text":"<p>\u600e\u4e48\u53bb\u63d0\u9ad8\u7cfb\u7edf\u7684\u53ef\u7528\u6027\uff0c\u5c31\u662f\u5c3d\u91cf\u7ed9\u6bcf\u4e00\u4e2a\u670d\u52a1\u627e\u4e00\u4e2a\u5907\u80ce\u3002\u4f46\u662f\u5907\u80ce\uff0c \u4e0d\u662f\u96c6\u7fa4\u6982\u5ff5\u91cc\u7684\u4e00\u4e2a\u5907\u7528\u673a\u5668\u800c\u662f\u4e00\u79cd\u5907\u7528\u65b9\u6848\u3002 </p> <p>\u6bd4\u5982\u5982\u8bf4\u5e38\u8bf4\u7684\u8fd9\u4e2a\u964d\u7ea7\u5907\u6848\uff0c\u5c31\u662f\u4e00\u79cd\u8fd9\u4e2a\u5907\u80ce\u65b9\u6848\uff0c\u6bd4\u5982\u67e5\u8be2\u8fd9\u4e2a\u5546\u54c1\u4fe1\u606f\u3002 </p> <p>\u6bd4\u5982\u67e5\u7684\u8fd9\u4e2aredlis\u96c6\u7fa4\uff0c\u5982\u679c\u53d1\u751f\u4e86\u6545\u969c\uff0c\u96ea\u5d29\uff0c\u7a7f\u900f\u5404\u79cd\u6545\u969c\u4e32.  \u7a7f\u900f\u5404\u79cd\u6545\u969c\u4e32,  redls\u6240\u6709\u7684\u96c6\u7fa4\u5462\u90fd\u6302\u4e0d\u80fd\u7528\u4e86\u3002\u6bd4\u5982 elasticsearch \u67e5\u8be2\u901f\u5ea6\uff0c\u53ef\u80fd\u6ca1\u6709\u8fd9\u4e2aredls\u8fd9\u4e48\u5feb\uff0c\u4f46\u662f\u597d\u6b79\u5907\u80ce\u8fd8\u80fd\u7528\u3002</p> <p>\u6d41\u91cf\u63a7\u5236\uff0c\u4e5f\u5c31\u662f\u9650\u6d41\u3002 \u5305\u62ec\u5355\u673a\u9650\u6d41\u8ddf\u96c6\u7fa4\u9650\u6d41\uff0c\u6bd4\u5982\u8bf4\u8fd9\u4e2a\u7cfb\u7edfqps, \u6bd4\u5982\u8bf4\u63a7\u5236\u57282,000\uff0c\u7194\u65ad\u673a\u5236\u3002 \u5f53\u4e0b\u6e38\u670d\u52a1\u56e0\u4e3a\u8bbf\u95ee\u538b\u529b\u8fc7\u5927\uff0c\u90a3\u4e48\u4e0a\u6e38\u670d\u52a1\u4e3a\u4e86\u4fdd\u62a4\u81ea\u5df1\uff0c\u4ee5\u53ca\u7cfb\u7edf\u6574\u4f53\u7684\u8fd9\u4e2a\u53ef\u7528\u6027\uff0c\u53ef\u4ee5\u6682\u65f6\u5207\u65ad\u5bf9\u4e0b\u6e38\u670d\u52a1\u7684\u8c03\u7528\uff0c\u662f\u4e00\u79cd\u4e3a\u4e86\u4fdd\u62a4\u7cfb\u7edf\u6574\u4f53\u7684\u53ef\u7528\u6027\uff0c\u800c\u91c7\u7528\u7684\u8fd9\u4e2a\u5907\u80ce\u7b56\u7565</p> <p>\u9ad8\u53ef\u7528\u6027\u7684\u4e5f\u5c31\u8fd9\u4e48\u51e0\u79cd\u65b9\u6848\uff0c\u4e00\u4e2a\u662f\u964d\u7ea7\uff0c \u4e00\u4e2a\u662f\u9650\u6d41\uff0c \u4e00\u4e2a\u662f\u7194\u65ad</p>"},{"location":"chap7/Arch_anws/#9_1","title":"9 \u670d\u52a1\u7194\u65ad \u89e3\u6c7a\u707e\u96be\u6027\u96ea\u5d29\u6548\u5e94\u7684\u80b2\u6548\u5229\u5668","text":"<p>\u4e3a\u4e86\u4fdd\u62a4\u670d\u52a1\u4e0d\u88ab\u6d41\u91cf\u51b2\u57ae\uff0c \u8fbe\u5230\u4e00\u5b9a\u7684\u8fd9\u4e2a\u9608\u503c\u5c31\u4f1a\u76f4\u63a5\u6390\u65ad\u670d\u52a1\u3002\u7194\u65ad\u5668\u600e\u4e48\u77e5\u9053\u4ec0\u4e48\u65f6\u5019\u8be5\u7194\u65ad\u3002 \u4e00\u822c\u5bb9\u65ad\u5668\u90fd\u662f\u6839\u636e\u670d\u52a1\u8c03\u7528\u7684\u5931\u8d25\u7387\u6765\u5224\u65ad\uff0c\u6bd4\u5982\u8bf4\u4e00\u79d2\u5185100\u4e2a\u8bf7\u6c42\uff0c \u5982\u679c\u8bbe\u7f6e\u5931\u8d25\u7387\u4e3a50%\uff0c\u90a3\u4e48\u4e00\u65e6\u8fbe\u5230\u4e8650\u4e2a\u8bf7\u6c42\u5931\u8d25\u3002 \u8981\u4e48\u8d85\u65f6\uff0c\u8981\u4e48\u662f\u63a5\u53e3\u9519\u8bef\uff0c\u7194\u65ad\u5668\u4f1a\u542f\u52a8\u7194\u65ad\u6765\u65ad\u5f00\u670d\u52a1</p> <p>\u65ad\u5f00\u4e4b\u540e\u600e\u4e48\u6062\u590d\u539f\u6765\u7684\u670d\u52a1\uff0c\u5bb9\u65ad\u5668\u672c\u8eab\u90fd\u5e26\u6709\u91cd\u89c6\u673a\u5236\uff0c\u6bd4\u5982\u8bf45\u79d2\u949f\u3002 5\u79d2\u949f\u4e4b\u540e\u5c31\u4f1a\u53d1\u8d77\u91cd\u8bd5\uff0c\u5982\u679c\u5931\u8d25\u7387\u4e0b\u964d\uff0c\u90a3\u4e48\u5c31\u4f1a\u5173\u6389\u7194\u65ad\uff0c \u7ee7\u7eed\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u3002\u53e6\u5916\u7194\u65ad\u5462\u5f80\u5f80\u662f\u8ddf\u964d\u7ea7\u4e00\u8d77\u7528\u7684\uff0c \u4e00\u65e6\u53d1\u751f\u4e86\u7194\u65ad\uff0c\u5c31\u5c31\u4f1a\u8c03\u7528\u964d\u7ea7\u65b9\u6cd5\u3002</p> <p>\u5e38\u89c1\u7684\u6709getfallback\uff0c\u6bd4\u5982\u8bf4redis\u670d\u52a1\u3002\u5982\u679c\u538b\u529b\u8fc7\u5927\u51fa\u73b0\u4e86\u7194\u65ad\uff0c\u90a3\u4e48\u7194\u65ad\u5668\u5c31\u4f1a\u81ea\u52a8\u8c03\u7528\u9686\u7ea7\u65b9\u6cd5\u3002 \u7528\u5176\u4ed6\u7684\u8d44\u6e90\u6765\u4ee3\u66ffredis\u670d\u52a1\uff0c\u6bd4\u5982elasticsearch, \u6216\u8005\u8981\u7528\u672c\u5730\u7684\u7f13\u5b58\u50cfguava. \u8fd9\u6837\u7684\u597d\u5904\u5462\u5c31\u662f\u5728\u5bb9\u65ad\u4e4b\u540e,\u53ef\u4ee5\u4e0d\u95f4\u65ad\u7684\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1,\u6765\u4fdd\u8bc1\u9ad8\u53ef\u7528\u6027. </p> <p>\u5e38\u7528\u7684\u6709hystrix, sentinel.  hystrix spring cloud \u4e2d\u6bd4\u8f83\u5e38\u89c1\u3002 \u4f46\u662f\u5462\u8fd8\u662f\u63a8\u8350\u5927\u5bb6\u6765\u4f7f\u7528sentinel\uff0chystrix\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4</p>"},{"location":"chap7/Arch_anws/#10","title":"10 \u5206\u5e03\u5f0f\u4e0b\u7684\u7ebf\u7a0b\u9694\u79bb\u673a\u5236","text":"<p>\u7ebf\u7a0b\u9694\u79bb\u673a\u5236, \u5c06\u8fd9\u4e2a\u4e0b\u5355\u63a5\u53e3, \u67e5\u8be2\u63a5\u53e3, \u5206\u5f00\u9694\u79bb\u3002\u6bd4\u5982\u8bf4\u4e0b\u5355\u63a5\u53e3\u5141\u8bb820\u4e2a\u7ebf\u7a0b\uff0c\u67e5\u8be2\u63a5\u53e3\u5141\u8bb810\u4e2a\u7ebf\u7a0b\u3002\u90a3\u4e48\u8c03\u7528\u7684\u65f6\u5019\u4e92\u4e0d\u5f71\u54cd\u3002 \u8fd9\u6837\u5c31\u4e0d\u4f1a\u51fa\u73b0\u4e0b\u5355\u63a5\u53e3\u5360\u7528\u5168\u90e8\u5546\u57ce\u4e2d\u5fc3\u7684\u7ebf\u7a0b\uff0c\u4ece\u800c\u5bfc\u81f4\u5176\u4ed6\u7684\u63a5\u53e3\u4e0d\u53ef\u4ee5\u7528\u7684\u60c5\u51b5</p> <p>\u7ebf\u7a0b\u5982\u679c\u5360\u6ee1\u4e86\u600e\u4e48\u5904\u7406</p> <p>\u5e38\u89c1\u7684\u7ebf\u7a0b\u6c60\uff0c\u6bd4\u5982\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3002 \u89e3\u51b3\u65b9\u5f0f\u5c31\u662f\u8bf7\u6c42\u4e00\u76f4\u7b49\u5f85\u3002 \u4e00\u76f4\u7b49\u5230\u6709\u7a7a\u4f59\u7684\u67e5\u8be2\u7ebf\u7a0b\uff0c\u7136\u540e\u5b8c\u6210\u8fd9\u4e2a\u67e5\u8be2\u7684\u64cd\u4f5c\u3002 \u4f46\u662f\u5982\u679c\u7b49\u4e0d\u5230\uff0c\u8d85\u8fc7\u4e86\u8bbe\u7f6e\u7684\u7b49\u5f85\u65f6\u95f4\u3002 \u90a3\u4e48\u4e00\u822c\u5c31\u662f\u8fd4\u56de\u54cd\u5e94\u8d85\u65f6\u3002\u90a3\u4e48\u5927\u90e8\u5206\u573a\u666f\u90fd\u662f\u8fd9\u4e48\u505a\u7684</p> <p>\u9694\u79bb\u7ebf\u7a0b\uff0c\u8bf7\u6c42\u4e00\u65e6\u53d1\u73b0\u7ebf\u7a0b\u6c60\u9971\u548c\u4ed6\u4f1a\u76f4\u63a5\u7194\u65ad\uff0c \u76f4\u63a5\u62d2\u7edd\u670d\u52a1\u6bd4\u8f83\u5e72\u8106\uff0c\u51cf\u5c11\u4e86\u6392\u961f\u65f6\u95f4\uff0c\u4e0d\u4f1a\u51fa\u73b0\u5f88\u591a\u7684\u7ebf\u7a0b\u963b\u585e\uff0c\u867d\u7136\u4e00\u90e8\u5206\u7528\u6237\u4e0b\u5355\u5931\u8d25\uff0c \u5927\u4e0d\u4e86\u7a0d\u540e\u91cd\u8bd5\u3002\u51e0\u79d2\u949f\u7684\u65f6\u95f4\u5176\u5b9e\u4e5f\u65e0\u5173\u7d27\u8981\uff0c \u4e00\u65e6\u7194\u65ad\u4e86\u3002\u8bf7\u6c42\u5c31\u4f1a\u8d70\u8fd9\u4e2a\u964d\u7ea7\u7684\u65b9\u6cd5\uff0cgetfallback\uff0c\u53ef\u4ee5\u662f\u53cb\u597d\u8bbf\u95ee\u63d0\u793a\u3002</p> <p>\u4e1a\u52a1\u7e41\u5fd9\u8bf7\u7a0d\u540e\u518d\u8bd5\uff0c\u8981\u4e48\u662f\u8d70\u672c\u5730\u7684\u67e5\u8be2\uff0c \u8981\u4e48\u8d70\u5176\u4ed6\u7684\u4e00\u4e9b\u67e5\u8be2\u7b49\u7b49\uff0c\u53cd\u6b63\u5c31\u662f\u5feb\u901f\u5931\u8d25\uff0c\u53cd\u6b63\u5c31\u662f\u5feb\u901f\u5931\u8d25\u3002\u5982\u679c\u5360\u7528\u7ebf\u7a0b\u6c60\u7684\u7ebf\u7a0b\u4e00\u76f4\u4e0d\u91ca\u653e\uff0c\u4e00\u822c\u8981\u8bbe\u7f6e\u8fd9\u4e2a\u8fc7\u671f\u65f6\u95f4\uff0c \u6bd4\u5982\u8bf4\u8fd9\u4e2a100\u6beb\u79d2\uff0c \u8d85\u8fc7100\u6beb\u79d2\u5462\u8fd8\u4e0d\u91ca\u653e\uff0c\u90a3\u4e48\u5c31\u5f3a\u5236\u91ca\u653e\uff0c\u9632\u6b62\u4e00\u76f4\u5360\u7740\u5751\u3002</p> <p>\u90a3\u4e48\u7ebf\u7a0b\u9694\u79bb\u673a\u5236\uff0c\u4e3b\u8981\u5e94\u5bf9\u7684\u662f\u8fd9\u4e2a\u5177\u4f53\u7684\u65b9\u6cd5\uff0c \u8fd9\u4e2a\u7ebf\u7a0b\u63a7\u5236\uff0c\u4e3b\u8981\u7684\u529f\u80fd\u3002 \u5c31\u662f\u5c06\u4e0d\u540c\u7684\u8fd9\u4e2a\u65b9\u6cd5\uff0c \u7528\u7ebf\u7a0b\u6c60\u9694\u79bb\u5f00\u3002\u9632\u6b62\u6709\u4e00\u4e9b\u8fd9\u4e2a\u8bf7\u6c42\u91cf\u8fc7\u5927\u7684\u65b9\u6cd5\uff0c \u8017\u5c3d\u6574\u4e2a\u7cfb\u7edf\u8d44\u6e90\u6765\u62d6\u57ae\u6574\u4e2a\u670d\u52a1\u4e2d\u5fc3</p>"},{"location":"chap7/Arch_anws/#11","title":"11 \u4fe1\u53f7\u91cf\u9694\u79bb","text":"<p>\u9664\u4e86\u7ebf\u7a0b\u6c60\u9694\u79bb\uff0c\u8fd8\u6709\u4e00\u79cd\u5e38\u89c1\u7684\u9694\u79bb\u65b9\u5f0f\u53eb\u4fe1\u53f7\u91cf\u9694\u79bb\u3002 \u53ef\u4ee5\u5bf9\u65b9\u6cd5\u7ea7\u63a5\u53e3\u673a\u7ea7\u505a\u8fd9\u4e2a\u9694\u79bb\u7684\uff0c\u4fe1\u53f7\u91cf\u9694\u79bb\u5f88\u7b80\u5355\u3002\u5c31\u662f\u8bbe\u7f6e\u4e00\u4e2a\u91cf\uff0c\u6bd4\u5982\u8bf41,000\uff0c\u8bf7\u6c42\u8fc7\u6765\u4e4b\u540e\u5c31\u53d6\u4e00\u4e2a\u4fe1\u53f7\u3002 \u62ff\u5230\u4fe1\u53f7\u5462\u624d\u53ef\u4ee5\u8bbf\u95ee\u4e0b\u6e38\u7684\u670d\u52a1\uff0c\u8bf7\u6c42\u5b8c\u6210\u4e4b\u540e\u5462\u5c31\u91ca\u653e\u4fe1\u53f7\u3002</p> <p>\u5982\u679c1000\u4e2a\u4fe1\u53f7\u540c\u65f6\u5168\u90e8\u5360\u6ee1\u4e86\uff0c \u90a3\u4e48\u518d\u6b21\u8fdb\u6765\u7684\u8bf7\u6c42\u5c31\u4f1a\u88ab\u62d2\u4e4b\u95e8\u5916\uff0c\u670d\u52a1\u5305\u4f1a\u76f4\u63a5\u7194\u65ad\u3002 \u964d\u7ea7\u7684\u65b9\u6cd5\uff0cgetfallback\uff0c \u63d0\u793a\u4e1a\u52a1\u5e2e\u5fd9\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002</p> <p>\u4e0e\u7ebf\u7a0b\u9694\u79bb\u7684\u533a\u522b</p> <p>\u7ebf\u7a0b\u6c60\u9694\u79bb\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u91cd\u3002 \u5c5e\u4e8e\u5bf9\u8fd9\u4e2a\u5355\u4e2a\u7684\u65b9\u6cd5\uff0c\u4e13\u95e8\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u9694\u79bb\u7ebf\u7a0b\u6c60\u3002 \u5bf9\u4e00\u4e9b\u8fd9\u4e2a\u67e5\u8be2\u91cf\u6bd4\u8f83\u5927\uff0c\u8ba1\u7b97\u6bd4\u8f83\u590d\u6742\u7684\u65b9\u6cd5\u6765\u4f7f\u7528\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u6709\u5145\u8db3\u7684\u7ebf\u7a0b\uff0c\u6765\u4fdd\u969c\u4e1a\u52a1\u7684\u8fd0\u884c\u662f\u5c5e\u4e8e\u8fd9\u4e2a\u5f02\u6b65\u7684\u5904\u7406\u65b9\u5f0f\uff0c\u800c\u4e14\u8bbe\u6709\u8fd9\u4e2a\u8d85\u65f6\u65f6\u95f4\uff0c\u8fc7\u671f\u5c31\u76f4\u63a5\u91ca\u653e\u7ebf\u7a0b</p> <p>\u800c\u4fe1\u53f7\u91cf\u5c31\u4e0d\u7136\u4e86\uff0c \u5b83\u5c5e\u4e8e\u8fd9\u4e2a\u8f7b\u91cf\u7ea7\u7684\u8ba1\u6570\u5668\uff0c \u800c\u4e14\u662f\u540c\u6b65\u7684\u5904\u7406\u65b9\u5f0f\u3002 \u5982\u679c\u9488\u5bf9\u4e00\u4e9b\u8ba1\u7b97\u91cf\u6bd4\u8f83\u5927\uff0c \u67e5\u8be2\u91cf\u6bd4\u8f83\u5927\u7684\u8fd9\u4e2a\u65b9\u6cd5\uff0c \u6216\u8005\u8bf4\u6bd4\u8f83\u8017\u65f6\u7684\u4e00\u4e9b\u65b9\u6cd5\u3002 \u5c31\u4f1a\u6709\u5f88\u591a\u7684\u4fe1\u53f7\u91cf\u88ab\u5360\u7528\uff0c\u5c31\u4f1a\u5f88\u5feb\u53d1\u751f\u7194\u65ad\u3002 \u4e0d\u592a\u9002\u5408</p> <p>\u6240\u4ee5\u9488\u5bf9\u4fe1\u53f7\u91cf\u7684\u9694\u79bb\u4f7f\u7528\uff0c\u6bd4\u8f83\u9002\u5408\u4e00\u4e9b\u6bd4\u8f83\u8f7b\u91cf\u7684\u67e5\u8be2\u3002 \u6216\u8005\u63a5\u53e3\u8fd4\u56de\u6bd4\u8f83\u5feb\u7684\u63a5\u53e3\uff0c\u6bd4\u5982\u8bf4redis\u67e5\u8be2\uff0c \u6216\u8005\u5904\u7406\u4e00\u4e9b\u8ba1\u7b97\u91cf\u6bd4\u8f83\u5c0f\u7684\u4e1a\u52a1\uff0c\u80fd\u591f\u5feb\u901f\u7684\u91ca\u653e\u8fd9\u4e2a\u4fe1\u53f7\u91cf\uff0c\u8ba9\u66f4\u591a\u7684\u8bf7\u6c42\u8fdb\u6765\u554a\uff0c\u4e5f\u80fd\u591f\u7b26\u5408\u5927\u5e76\u53d1\u7684\u8fd9\u4e2a\u8981\u6c42\u3002 </p> <p>\u73b0\u5728\u6709\u5f88\u591a\u7684\u7ec4\u4ef6\uff0c\u5728\u9694\u79bb\u65b9\u9762\u90fd\u505a\u7684\u4e0d\u9519\u3002 \u5305\u62ecSpring cloud\u7684hystrix\uff0c sentinel, \u4e5f\u90fd\u652f\u6301\u4fe1\u53f7\u91cf\u7684\u9694\u79bb\u6216\u8005\u662f\u7ebf\u7a0b\u6c60\u7684\u9694\u79bb. \u53e6\u5916\u4fe1\u53f7\u91cf\u7684\u9694\u79bb\u673a\u5236\u9664\u4e86\u65b9\u6cd5\u7ea7\u4ee5\u5916, \u8fd8\u6709\u5728\u8fd9\u4e2a\u7f51\u5173\u5c42\u7528\u7684, zuul &amp; gateway\u7f51\u5173\u3002 \u5c31\u662f\u76f4\u63a5\u5728\u7f51\u5173\u5c42, \u5bf9\u8bf7\u6c42\u91cf\u505a\u4e86\u4fe1\u53f7\u91cf\u7684\u9694\u79bb. </p> <p>\u9488\u5bf9\u4e0d\u540c\u7684\u573a\u666f, \u9488\u5bf9\u4e0d\u540c\u7684\u8fd9\u4e2a\u670d\u52a1\u4e2d\u5fc3, \u6bd4\u5982\u7528\u6237\u4e2d\u5fc3\u5546\u57ce\u4e2d\u5fc3,\u8ba2\u5355\u4e2d\u5fc3, \u5c31\u53ef\u4ee5\u5206\u914d\u4e0d\u540c\u7684\u6570\u91cf\u7684\u8fd9\u4e2a\u4fe1\u53f7\u91cf</p>"},{"location":"chap7/Arch_anws/#12","title":"12 \u5982\u4f55\u5b9e\u73b0\u5206\u5e03\u5f0f\u4e8b\u52a1\uff1f","text":"<p>\u53ea\u8981\u6d89\u53ca\u5230\u4ea4\u6613\uff0c\u5c31\u9700\u8981\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u4fdd\u8bc1\u8981\u4e48\u5168\u90e8\u6210\u529f\uff0c\u8981\u4e48\u5168\u90e8\u5931\u8d25\uff0c\u6d89\u53ca\u5230\u591a\u4e2a\u5e93\uff0c\u90a3\u4e48\u5c31\u4e00\u5b9a\u7ed5\u4e0d\u5f00\u5206\u5e03\u5f0f\u4e8b\u52a1\u3002</p> <p>\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u4e3b\u6d41\u7684\u5b9e\u73b0\u65b9\u5f0f\u5176\u5b9e\u5c31\u4e24\u79cd</p> <ul> <li>\u4e00\u79cd\u662f\u57fa\u4e8exa\u534f\u8bae\uff0c xa\u534f\u8bae\u7684\u539f\u7406\u5176\u5b9e\u5c31\u662f\u4e24\u9636\u6bb5\u63d0\u4ea4\u3002\u800c\u4e14\u4f9d\u8d56\u6570\u636e\u5e93\u672c\u8eab\u7684\u4e8b\u52a1\uff0c\u5728\u4e8b\u52a1\u5f00\u59cb\u4e4b\u540e\uff0c\u4e8b\u52a1\u7ba1\u7406\u5668\u5148\u8be2\u95ee\u5404\u4e2a\u6570\u636e\u5e93\u51c6\u5907\u597d\u4e86\u5417\uff0c\u5982\u679c\u6bcf\u4e2a\u6570\u636e\u5e93\u90fd\u56de\u590dOK\uff0c\u90a3\u4e48\u5c31\u6b63\u5f0f\u63d0\u4ea4\u4e8b\u52a1\uff0c\u5728\u5404\u4e2a\u6570\u636e\u5e93\u4e0a\u9762\u6765\u6267\u884c\u64cd\u4f5c\uff0c\u5982\u679c\u6709\u4efb\u4f55\u4e00\u4e2a\u6570\u636e\u5e93\u56de\u7b54\u4e0dOK\uff0c\u90a3\u4e48\u5c31\u56de\u6eda\u4e8b\u52a1</li> <li>\u4e00\u79cd\u662f\u57fa\u4e8ettc\uff0ctcc\u5176\u5b9e\u8ddfxa\u534f\u8bae\u6bd4\u8f83\u5927\u7684\u533a\u522b\u3002\u5c31\u662f\u4e0d\u9700\u8981\u4f9d\u8d56\u6570\u636e\u5e93\u7684\u4e8b\u52a1\u91c7\u7528\u7684\u662f\u8865\u507f\u673a\u5236\u6765\u5904\u7406\u6570\u636e\u7684\u4e00\u81f4\u6027\u95ee\u9898\u3002<ul> <li>\u67093\u4e2a\u9636\u6bb5\uff0c\u4e00\u4e2a\u662ftry\uff0c\u4e00\u4e2aconfirm\uff0c\u4e00\u4e2a\u662fcancel</li> <li>try\u8fd9\u4e2a\u9636\u6bb5\uff0c\u5bf9\u4e8e\u4e1a\u52a1\u7cfb\u7edf\uff0c\u662f\u505a\u4e86\u68c0\u6d4b\u548c\u8d44\u6e90\u9884\u7559\u7684\u4f5c\u7528\uff0c\u6bd4\u5982\u5728\u4ea4\u6613\u7cfb\u7edf\u4e2d\u554a\u8981\u62b5\u6263\u7684\u79ef\u5206\uff0c\u5c31\u5148\u901a\u8fc7\u4e1a\u52a1\u4ee3\u7801\u5148\u51bb\u7ed3\u3002 \u7136\u540e\u5728confirm\u9636\u6bb5\uff0c\u4e3b\u8981\u5c31\u662f\u5bf9\u8fd9\u4e2a\u4e1a\u52a1\u7cfb\u7edf\u505a\u786e\u8ba4\u63d0\u4ea4</li> <li>\u90a3\u4e48\u5982\u679c\u9047\u5230\u9519\u8bef\uff0c\u5c31\u9700\u8981\u76f4\u63a5\u56de\u6eda\uff0c\u4e4b\u524d\u51bb\u7ed3\u7684\u79ef\u5206\u5c31\u76f4\u63a5\u91ca\u653e\u4e86</li> <li>tcc\u4ee3\u7801\u7684\u4fb5\u5165\u6027\u6bd4\u8f83\u5f3a\uff0c \u6bcf\u4e2a\u9636\u6bb5\u90fd\u9700\u8981\u4e1a\u52a1\u4ee3\u7801\u6765\u5b9e\u73b0\uff0c\u56e0\u4e3a\u4e0d\u4f9d\u8d56\u6570\u636e\u5e93\u7684\u4e8b\u52a1\uff0c\u56de\u6eda\u662f\u9700\u8981\u901a\u8fc7\u8865\u507f\u673a\u5236\u6765\u5b9e\u73b0\u7684\uff0c\u6bd4\u5982\u8bf4\u652f\u4ed8\u5931\u8d25\uff0c\u5c31\u9700\u8981\u8fd4\u8fd8\u4e4b\u524d\u6263\u9664\u7684\u79ef\u5206</li> <li>\u53d1\u9001\u8fd9\u4e2a\u6d88\u606f\u8fd9\u4e2a\u79ef\u5206\u4e2d\u5fc3\uff0c\u8ba9\u79ef\u5206\u4e2d\u5fc3\u901a\u8fc7\u4e1a\u52a1\u4ee3\u7801\u6765\u5904\u7406\u79ef\u5206\u7684\u8fd4\u8fd8\u3002</li> </ul> </li> </ul> <p>tcc\u5728\u5206\u5e03\u5f0f\u67b6\u6784\u4e0b\u7528\u7684\u66f4\u591a\u4e00\u4e9b\uff0c \u4e0d\u50cfxa\u90a3\u6837\u5360\u6709\u592a\u957f\u65f6\u95f4\u3002 \u8fd9\u4e2a\u6570\u636e\u5e93\u8d44\u6e90\uff0c \u6240\u4ee5\u5728\u6027\u80fd\u4e0a\u9762\u8981\u7a0d\u5fae\u4f18\u79c0\u4e00\u4e9b\u3002 </p> <p>\u5f53\u7136\u9664\u4e86xa, tcc\u8fd8\u6709\u5229\u7528\u8fd9\u4e2a\u6d88\u606f\u961f\u5217\u505a\u4e8b\u52a1. \u5148\u53d1\u8fd9\u4e2a\u534a\u6d88\u606f\u7136\u540e\u6267\u884c\u4e3b\u4e1a\u52a1. \u6210\u529f\u4e4b\u540e, \u534a\u6d88\u606f\u5c31\u8f6c\u6210\u6b63\u5e38\u6d88\u606f\u6765\u8fdb\u884c\u6d88\u8d39</p>"},{"location":"chap7/Arch_anws/#13","title":"13 \u5206\u5e03\u5f0f\u7cfb\u7d71\u4e0b \u5546\u57ce\u79d2\u6740\u7cfb\u7ed5\u7684\u8bbe\u8ba1\u601d\u8def","text":"<p>\u600e\u4e48\u8bbe\u8ba1\u4e00\u5957\u65e2\u80fd\u591f\u6ee1\u8db3\u65e5\u5e38\u7684\u4ea4\u6613\uff0c\u53c8\u80fd\u591f\u625b\u4f4f\u9ad8\u5e76\u53d1\u7684\u5999\u6740\u7cfb\u7edf\u3002</p> <p>\u90a3\u4e48\u5e76\u53d1\u91cf\u4e00\u65e6\u4e0a\u6765\uff0c\u63a5\u53e3\uff0c\u6570\u636e\u5e93\u53ef\u80fd\u5c31\u4f1a\u8fbe\u5230\u74f6\u9888\u3002</p> <ul> <li>\u5546\u57ce\u7684\u8be6\u60c5\u9875\u9762</li> </ul> <p>\u4e00\u5b9a\u8981\u505a\u4f18\u5316,  \u7f51\u9875\u7248\u7684\u8981\u5c3d\u91cf\u7684\u9759\u6001\u5316, \u521d\u59cb\u5316\u9875\u9762\u7684\u8fc7\u7a0b\u4e2d, \u5c3d\u91cf\u4e0d\u8981\u8c03\u63a5\u53e3, \u5982\u679c\u6ca1\u6cd5\u9759\u6001\u5316. \u9875\u9762\u4e5f\u8981\u505a\u597d\u7f13\u5b58.</p> <p>\u628a\u5546\u54c1\u7684\u8be6\u60c5, \u4ecb\u7ecd\u90fd\u7f13\u5b58\u5230 redis \u91cc\u9762.  \u6bd4\u8f83\u7a33\u59a5\u7684\u65b9\u5f0f, \u662f\u518d\u505a\u964d\u7ea7\u5904\u7406. \u9632\u6b62redis \u51fa\u73b0\u6545\u969c,  \u6bd4\u5982\u8bf4\u51fb\u7a7f,\u96ea\u5d29. \u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u8bfb\u53d6\u672c\u5730\u7f13\u5b58. </p> <p>\u53e6\u5916\u8be6\u60c5\u9875\u6d89\u53ca\u5230\u7684\u56fe\u7247, \u56fe\u7247\u53c8\u662f\u6bd4\u8f83\u8017\u8d44\u6e90\u7684. \u6240\u4ee5\u8981\u628a\u5b83\u6254\u5230\u72ec\u7acb\u7684\u8fd9\u4e2a\u6587\u4ef6\u670d\u52a1\u5668\u4e0a\u9762.  \u9632\u6b62\u8fd9\u4e9b\u56fe\u7247\u62c9\u53d6\uff0c\u5360\u6ee1\u5e26\u5bbd. \u4f1a\u5f71\u54cd\u5230\u9875\u9762\u7684\u8bbf\u95ee, \u4e00\u822c\u5462\u90fd\u662f\u6254\u5230\u8fd9\u4e2aCDN, \u8fb9\u7f18\u8ba1\u7b97</p> <ul> <li>\u79d2\u6740\u6a21\u5757</li> </ul> <p>\u9875\u9762\u7ea7\u7684\u9650\u6d41\uff0c \u6bd4\u5982\u8bf4\u9650\u5236\u6309\u94ae\u7684\u70b9\u51fb\u6b21\u6570\u3002 \u670d\u52a1\u5668\u7aef\u4e5f\u5fc5\u987b\u505a\u597d\u9650\u6d41\uff0c \u4e00\u822c\u5c31\u662f\u5728\u7f51\u5173\u5c42\uff0c \u91c7\u7528\u4e00\u4e9b\u9650\u6d41\u7b97\u6cd5, \u6bd4\u5982\u8bf4\u4ee4\u724c\u6876,\u6f0f\u6876.  \u90a3\u4e48\u89c4\u5b9a\u7684\u65f6\u95f4\u5468\u671f, \u653e\u4e00\u5b9a\u7684\u6d41\u91cf\u8fdb\u6765.</p> <p>\u5176\u4f59\u7684\u6d41\u91cf, \u76f4\u63a5\u8fd4\u56de\u7f51\u7edc\u7e41\u5fd9\u8bf7\u7a0d\u540e\u518d\u8bd5. \u7136\u540e\u5728\u5546\u57ce\u7684\u8d2d\u4e70\u63a5\u53e3\u4e0a\u9762,\u4e5f\u8981\u505a\u597d\u7194\u65ad. \u56e0\u4e3a\u6d41\u91cf\u5927, \u5c31\u4f1a\u51fa\u73b0\u5f88\u591a\u7684\u8bbf\u95ee\u5931\u8d25, \u5f53\u8bbf\u95ee\u6b21\u6570\u8fbe\u5230\u4e00\u5b9a\u7684\u570b\u503c. \u5c31\u8981\u5f00\u542f\u8fd9\u4e2a\u7194\u65ad\u673a\u5236, \u76f4\u63a5\u62d2\u7edd\u6240\u6709\u7684\u670d\u52a1</p> <p>\u7b49\u6062\u590d\uff0c\u6b63\u5e38\u4e4b\u540e. \u518d\u91cd\u65b0\u5f00\u542f\u4f1a\u5168\u90e8\u8d70\u8fd9\u4e2a\u964d\u7ea7\u65b9\u6cd5, \u8bf7\u7a0d\u540e\u518d\u8bd5.</p> <p>\u8fd9\u6837\u4e00\u6765\u5462\u5728\u670d\u52a1\u7aef\u7684\u53ef\u7528\u6027, \u5c31\u4e0d\u7528\u8fc7\u4e8e\u62c5\u5fc3\u4e86. \u7cfb\u7edf\u4e0d\u4f1a\u8f7b\u6613\u7684\u88ab\u6d41\u91cf\u51b2\u57ae</p> <ul> <li>\u5546\u54c1\u8d2d\u4e70</li> </ul> <p>\u6bd4\u8f83\u5bb9\u6613\u51fa\u4e8b\u6545\u5c31\u662f\u5e93\u5b58\u7684\u6263\u51cf, \u5c31\u8981\u505a\u597d\u6263\u51cf\u73af\u8282\u7684\u539f\u5b50\u6027, \u5e38\u89c1\u7684\u5c31\u662f\u91c7\u7528\u5206\u5e03\u5f0f\u9501,  \u57fa\u4e8eredis, zookeeper, \u4e5f\u53ef\u4ee5\u91c7\u7528\u4e00\u4e9b\u6570\u636e\u5e93\u7684\u89e6\u53d1\u5668. \u8d85\u8fc7\u4e86\u5e93\u5b58\u5462</p>"},{"location":"chap7/Arch_anws/#14-id","title":"14 \u804a\u804a\u5206\u5e03\u5f0fID\u751f\u6210\u65b9\u6848","text":"<p>\u5728\u591a\u5e93\u591a\u8868\u7684\u60c5\u51b5\u4e0b\u9762\uff0c\u7b80\u5355\u7684\u5229\u7528\u6570\u636e\u5e93\u7684\u81ea\u589e\uff0c\u4f1a\u51fa\u73b0\u5927\u9762\u79ef\u7684ID\u91cd\u590d\u3002 \u53ef\u4ee5\u57fa\u4e8e\u6570\u636e\u5e93\u7684\u81ea\u589eID\uff0c \u505a\u4e2a\u6539\u9020\u554a\uff0c\u6bd4\u5982\u8bf4a\u8868135\uff0cb\u8868246\uff0c\u9519\u5f00\u9012\u589e\u3002 \u8fd9\u4e2a\u65b9\u6848\u8fd8\u662f\u4f9d\u8d56\u6570\u636e\u5e93\u7684\u81ea\u589e\u5c5e\u6027\uff0c\u4e5f\u65e0\u9700\u989d\u5916\u7684\u4fb5\u5165\u4ee3\u7801\u3002\u4e0d\u8db3\u7684\u5730\u65b9\u5c31\u662f\u5728\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u52a0\u5165\u4e86\u65b0\u7684\u8868\uff0c\u81ea\u589eID\u9700\u8981\u91cd\u65b0\u5206\u914d\u3002 </p> <p>\u96ea\u82b1\u7b97\u6cd5</p> <p>\u6bd4\u8f83\u597d\u7684\u65b9\u5f0f\u5c31\u662f\u6839\u636e\u4e1a\u52a1\u91cf\u591a\u5efa\u8868\uff0c\u5176\u5b9e\u5206\u5e03\u5f0fID\u3002\u516c\u8ba4\u65b9\u6848\u662f\u91c7\u7528snowflake\u7684\u96ea\u82b1\u7b97\u6cd5. \u4ed6\u7684\u6838\u5fc3\u662f\u7531\u4e09\u90e8\u5206\u7ec4\u6210, \u4e00\u4e2a\u662f\u65f6\u95f4\u6233\u4ee3\u8868\u5f53\u524d\u7684\u65f6\u95f4, \u4e00\u4e2a\u662f\u673a\u5668\u7801\u4ee3\u8868\u751f\u6210ID\u7684\u673a\u5668, \u4e00\u4e2a\u662f\u5e8f\u5217\u53f7\uff0c\u9012\u589e\u4e86\u4e00\u4e32\u6570\u5b57. </p> <p>\u90a3\u4e48\u540c\u4e00\u4e2a\u673a\u5668\u540c\u4e00\u6beb\u79d2\u5e8f\u5217\u53f7\u662f\u8fde\u7eed\u7684,\u81ea\u589e\u7801\u653e\u5728\u5185\u5b58\u91cc\u9762. \u540c\u4e00\u6beb\u79d2\u6309\u90e8\u5c31\u73ed, \u90a3\u4e48\u4e0b\u4e00\u6beb\u79d2\u518d\u91cd\u65b0\u8ba1\u7b97\u554a</p> <p>\u96ea\u82b1\u7b97\u6cd5\u5462\u53ef\u80fd\u4f1a\u51fa\u95ee\u9898\u7684\u5730\u65b9: </p> <p>\u5c31\u662f\u8fd9\u4e2a\u65f6\u95f4\u6233\u7684\u95ee\u9898, \u56e0\u4e3a\u4f9d\u8d56\u65f6\u95f4\u6233. \u5c31\u6709\u53ef\u80fd\u751f\u6210\u91cd\u590d\u7684id, \u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u5e38\u8bf4\u7684\u65f6\u95f4\u56de\u62e8\u95ee\u9898,\u5f53\u7136\u8fd9\u79cd\u60c5\u6cc1\u5f88\u5c11. \u670d\u52a1\u5668\u7684\u65f6\u95f4\u4e00\u822c\u4e0d\u4f1a\u8f7b\u6613\u52a8, </p>"},{"location":"chap7/Arch_anws/#15_1","title":"15 \u804a\u804a\u5206\u5e03\u5f0f\u4e0b\u7684\u94fe\u8def\u8ffd\u8e2a\u7cfb\u7edf","text":"<p>\u5bf9\u4e8e\u5206\u5e03\u5f0f\u67b6\u6784\u4e0b\u9762, \u6d89\u53ca\u5230\u591a\u4e2a\u5fae\u670d\u52a1\u7684\u6a21\u5757. \u6bd4\u5982\u8bf4\u7528\u6237\u4e2d\u5fc3, \u5546\u57ce\u4e2d\u5fc3, \u8ba2\u5355\u4e2d\u5fc3\u7b49\u7b49. \u5f7c\u6b64\u4e4b\u95f4\u5462\u76f8\u4e92\u72ec\u7acb, \u53c8\u6709\u590d\u6742\u7684\u5173\u8054\u8c03\u7528, \u6bcf\u4e00\u4e2a\u6a21\u5757\u53c8\u6d89\u53ca\u5230\u4e86\u8d1f\u8f7d\u5747\u8861, \u5b9a\u4f4d\u5230\u5177\u4f53\u662f\u67d0\u4e00\u4e2a\u6a21\u5757\u51fa\u7684\u95ee\u9898. </p> <p>\u6574\u4e2a\u7684\u4e0b\u5355\u5c31\u6d89\u53ca\u5230\u4e86\u5546\u57ce\u4e2d\u5fc3, \u7528\u6237\u4e2d\u5fc3, \u79ef\u5206\u4e2d\u5fc3,\u8ba2\u5355\u4e2d\u5fc3, \u4ed3\u50a8\u4e2d\u5fc35\u4e2a\u6a21\u5757. \u6574\u4e2a\u4e0b\u5355\u63a5\u53e3, \u5c31\u6d89\u53ca\u5230\u4e86\u4e94\u4e2a\u6a21\u5757. \u5f88\u96be\u5c31\u53d1\u73b0\u5177\u4f53\u67d0\u4e00\u4e2a\u6a21\u5757\u51fa\u4e86\u95ee\u9898, \u56e0\u4e3a\u7ebf\u4e0a\u7684\u65e5\u5fd7\u4e0d\u505c\u7684\u5728\u5237, \u8981\u627e\u5230\u5177\u4f53\u7684\u67d0\u4e00\u4e2a\u65e5\u5fd7\u76f8\u5bf9\u6765\u8bb2\u8fd8\u662f\u6bd4\u8f83\u56f0\u96be\u7684.</p> <p>\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2aelk\u5206\u5e03\u5f0f\u7684\u65e5\u5fd7\u7cfb\u7edf\u6765\u6c47\u603b\u65e5\u5fd7, \u4e2d\u4e2d\u95f4\u8fd8\u5939\u6742\u4e86\u5f88\u591a\u5176\u4ed6\u63a5\u53e3\u7684\u65e5\u5fd7. \u5c31\u4e0d\u5f97\u4e0d\u5229\u7528\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0b\u7684\u94fe\u8def\u8ffd\u8e2a\u7cfb\u7edf\u6765\u89e3\u51b3\u8fd9\u4e9b\u75db\u70b9</p> <p>\u8fd9\u4e2a\u7cfb\u7edf\u7684\u4e3b\u8981\u4efb\u52a1\uff0c\u5c31\u662f\u6536\u96c6\u5404\u4e2a\u670d\u52a1\u7684\u65e5\u5fd7\u4e0a\u62a5\u65e5\u5fd7\u5206\u6790\u65e5\u5fd7\u4fdd\u5b58\u5c55\u793a\u3002 \u5173\u952e\u7684\u6838\u5fc3\u5c31\u5728\u4e8e\u8fd9\u4e2a\u8c03\u7528\uff0c\u4e3a\u6bcf\u4e00\u4e2a\u8bf7\u6c42\u751f\u6210\u4e86\u8fd9\u4e2a\u5168\u5c40\u7684ID\uff0ctraceId, \u5c06\u4e0d\u540c\u7cfb\u7edf\u539f\u5148\u662f\u5b64\u7acb\u7684\u72b6\u6001. \u628a\u5b83\u5b64\u7acb\u7684\u8fd9\u4e9b\u4fe1\u606f,\u8c03\u7528\u7684\u4fe1\u606f\u5173\u8054\u5728\u4e00\u8d77\u8fd8\u539f\u51fa\u66f4\u591a\u6709\u4ef7\u503c\u7684\u6570\u636e, \u5148\u8c03\u7528\u4e86\u5565\u540e\u8c03\u7528\u4e86\u5565, \u6bcf\u4e00\u4e2a\u6a21\u5757\u8c03\u7528\u82b1\u8d39\u4e86\u591a\u957f\u65f6\u95f4, \u6bcf\u4e00\u4e2a\u6a21\u5757\u8c03\u7528\u82b1\u8d39\u4e86\u591a\u957f\u65f6\u95f4, \u6210\u529f\u8fd8\u662f\u5931\u8d25,\u90fd\u53ef\u4ee5\u901a\u8fc7\u754c\u9762\u53ef\u89c6\u5316\u5c55\u793a\u51fa\u6765.  \u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662f\u50cf\u8fd9\u4e2azipkin</p>"},{"location":"chap7/Arch_anws/#16","title":"16 \u804a\u804a\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0b\u7684 \u9274\u6743\u8ba4\u8bc1\u65b9\u6848","text":"<p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0b\u9762\uff0c\u6574\u4e2a\u670d\u52a1\u5c31\u4f1a\u5206\u5272\u6210\u4e86\u5f88\u591a\u5c0f\u6a21\u5757\uff0c\u53c8\u53eb\u505a\u8fd9\u4e2a\u5fae\u670d\u52a1\u3002 \u90a3\u6bd4\u5982\u8bf4\u50cf\u7528\u6237\u4e2d\u5fc3\uff0c\u8bfe\u7a0b\u4e2d\u5fc3\uff0c\u5546\u57ce\u4e2d\u5fc3\uff0c\u901a\u77e5\u4e2d\u5fc3\uff0c\u7269\u6d41\u4e2d\u5fc3\u7b49\u7b49\u597d\u591a\u6a21\u5757\u3002 </p> <p>\u90a3\u4e48\u6bcf\u4e00\u4e2a\u6a21\u5757\uff0c\u53ef\u80fd\u90fd\u9700\u8981\u505a\u9274\u6743\uff0c\u90fd\u8981\u505a\u8ba4\u8bc1\u3002 \u6240\u4ee5\u5c31\u8feb\u5207\u9700\u8981\u6709\u4e00\u5957\u7edf\u4e00\u7684\u5bf9\u5916\u9274\u6743\u7684\u8ba4\u8bc1\u7684\u4e2d\u5fc3\u3002\u9700\u8981\u6ee1\u8db3\u4e00\u4e2a\u5730\u65b9\u767b\u5f55\uff0c\u7136\u540e\u6240\u6709\u7684\u5730\u65b9\u90fd\u80fd\u53bb\u540c\u6b65\u4f7f\u7528\uff0c \u6574\u4e2a\u670d\u52a1\u7aef\u7684\u5b58\u50a8\u65b9\u9762\u4e5f\u662f\u4e2a\u95ee\u9898\uff0c \u90fd\u662f\u57fa\u4e8e\u8fd9\u4e2atoken\u7684\u65b9\u5f0f\uff0c \u6765\u5bf9\u5916\u63d0\u4f9b\u8fd9\u4e2a\u9274\u6743\u548c\u8ba4\u8bc1\u670d\u52a1\u7684\u3002 </p> <p>\u90a3\u4e48\u5b9e\u73b0\u7684\u539f\u7406\u5176\u5b9e\u4e5f\u5f88\u7b80\u5355\uff0c \u7528\u6237\u767b\u5f55\u7684\u65f6\u5019\u3002 \u77ed\u4fe1\u9a8c\u8bc1\u7801\u6216\u8005\u662f\u8d26\u53f7\u5bc6\u7801\uff0c\u8ba4\u8bc1\u901a\u8fc7\u63a5\u53e3\u5c31\u4f1a\u751f\u6210\u4e00\u4e2atoken\uff0c\u90a3\u4e48\u5176\u5b9e\u5c31\u662f\u5b57\u7b26\u4e32\u5bf9\u3002\u7136\u540e\u670d\u52a1\u7aef\u8981\u628a\u8fd9\u4e2atoken\u5b58\u8d77\u6765\uff0c \u90a3\u4e48\u4e00\u822c\u4e5f\u90fd\u662f\u653e\u5728\u7684\u5206\u5e03\u5f0f\u7f13\u5b58redis, \u6709\u4e00\u5b9a\u7684\u8fd9\u4e2a\u6709\u6548\u671f. </p> <p>\u6709\u6548\u671f\u5185, \u6240\u6709\u7684\u8fd9\u4e2a\u6a21\u5757\u7684\u9274\u6743\u8bbf\u95ee, \u53ef\u4ee5\u4eceredis\u91cc\u9762\u6765\u83b7\u53d6\u5230token, \u5982\u679c\u5b58\u5728\u5c31\u8bf4\u660e\u8ba4\u8bc1\u6210\u529f. \u5982\u679c\u4e0d\u5b58\u5728\u5c31\u8bf4\u660e\u4ed6\u5df2\u7ecf\u5931\u6548\u4e86, \u662f\u4e00\u4e2a\u975e\u6cd5\u8bf7\u6c42, \u90a3\u4e48\u5bf9\u4e8e\u524d\u7aef\u9700\u8981\u628a\u8ba4\u8bc1\u8fd4\u56de\u7684token\u4fdd\u5b58\u5728\u672c\u5730. </p> <p>\u5176\u4ed6\u63a5\u53e3\u8bf7\u6c42\u7684\u65f6\u5019, \u4f1a\u5e26\u4e0a\u8fd9\u4e2atoken, \u5f53\u7136\u4e5f\u53ef\u4ee5\u585e\u5230header\u91cc\u9762, \u6548\u679c\u90fd\u662f\u4e00\u6837\u7684. \u90a3\u4e48\u57fa\u4e8etoken\u6a21\u5f0f, \u4e00\u822c\u4e5f\u90fd\u662f\u91c7\u7528\u8fd9\u4e2aspring oauth2\u7684\u9274\u6743\u65b9\u6848, \u90a3\u4e48\u9664\u4e86\u8d26\u6237\u5bc6\u7801\u8fd8\u6709\u9a8c\u8bc1\u7801\uff0c\u5fae\u4fe1\u4e00\u952e\u767b\u5f55\u3002 \u4e00\u4e2a\u4eba\u53ef\u80fd\u4f1a\u6709\u4e09\u56db\u79cd\u8fd9\u4e2a\u8ba4\u8bc1\u65b9\u5f0f\uff0c \u751f\u6210\u4e00\u4e2a\u5168\u5c40\u7684\u8fd9\u4e2atoken\uff0c\u53e6\u5916token\u7684\u751f\u4ea7\u65b9\u5f0f\u4e5f\u6709\u51e0\u79cd\u3002</p> <ul> <li>\u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662fJWT\uff0c json web token\uff0c\u91cc\u9762\u5b58\u50a8\u4e86\u4e00\u5927\u5806\u7684\u7528\u6237\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u52a0\u5bc6\u5b58\u50a8\uff0c \u597d\u5904\u662f\u4e0d\u9700\u8981\u518d\u53bb\u67e5\u6570\u636e\u5e93\u4e86\u3002 \u53ef\u4ee5\u76f4\u63a5\u4ece\u8fd9\u4e2a\uff0ctoken\u91cc\u9762\u5c31\u53ef\u80fd\u89e3\u6790\u51fa\u7528\u6237\u7684\u4fe1\u606f\uff0c\u4e0d\u597d\u7684\u5730\u65b9\u5c31\u662f\u8fd9\u4e2a\u5b57\u7b26\u4e32\u592a\u957f\u4e86\uff0c\u4f20\u6765\u4f20\u53bb\u4e5f\u5f71\u54cd\u6211\u4eec\u7684\u8fd9\u4e2a\u7f51\u7edcIO</li> <li>\u6211\u4eec\u4e00\u822c\u7528\u7684\u5176\u5b9e\u90fd\u662f\u91c7\u7528\u8fd9\u4e2auuid\u6765\u751f\u6210</li> </ul>"},{"location":"chap7/Arch_anws/#17","title":"17 \u5fae\u670d\u52a1\u7684\u62c6\u5206","text":"<ul> <li>\u4e00\u4e2a\u5c31\u662f\u57fa\u4e8e\u8fd9\u4e2a\u4e1a\u52a1\u7684\u5212\u5206\uff0c \u5c31\u6309\u7167\u63d0\u4f9b\u670d\u52a1\u5185\u5bb9\u7684\u4e0d\u540c\uff0c\u9ad8\u5185\u805a\u4f4e\u5076\u548c</li> <li>\u57fa\u4e8e\u8fd9\u4e2a\u8d44\u6e90\u9700\u6c42\u7684\u62c6\u5206\uff0c\u8fd9\u4e2a\u6a21\u5757\u8bbf\u95ee\u91cf\u5927\u4e0d\u5927\u3002 \u8bbf\u95ee\u91cf\u5927\u7684\u8981\u8ddf\u8bbf\u95ee\u91cf\u5c0f\u505a\u4e00\u4e2a\u533a\u5206\uff0c</li> <li>\u6f14\u8fdb\u5f0f\u7684\u62c6\u5206\uff0c\u5c31\u662f\u4e00\u5f00\u59cb\u62c6\u5206\u7684\u8fd9\u4e2a\u7c92\u5ea6\u4e0d\u7528\u592a\u5927\uff0c\u5148\u653e\u5728\u4e00\u8d77\uff0c\u8d70\u4e00\u6b65\u770b\u4e00\u6b65\uff0c\u91cf\u4e0a\u6765\u4e4b\u540e\u518d\u53bb\u505a\u62c6\u5206</li> </ul>"},{"location":"chap7/Arch_anws/#18","title":"18 \u5982\u4f55\u89e3\u6c7a\u5206\u5e03\u5f0f\u9501\u7684\u6b7b\u9501\u95ee\u9898","text":"<p>\u5206\u5e03\u5f0f\u6240\u9501\u76ee\u524d\u7528\u7684\u6bd4\u8f83\u591a\u3002\u53ea\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u6765\u8bbf\u95ee\u8d44\u6e90\uff0c\u53ea\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u6765\u8bbf\u95ee\u8d44\u6e90\u3002 </p> <p>\u5e26\u6765\u4e86\u5f88\u591a\u65b0\u7684\u95ee\u9898\uff0c\u6bd4\u5982\u8bf4\u8fd9\u4e2a\u6b7b\u9501\u95ee\u9898\u3002\u5e38\u89c1\u7684\u573a\u666f\u6bd4\u5982\u8bf4\u52a0\u9501\uff0c \u4f46\u662f\u6ca1\u6709\u7a0b\u5e8f\u53bb\u91ca\u653e\u9501\uff0c \u4e00\u76f4\u5360\u7528\u554a\u5c31\u4ea7\u751f\u4e86\u6b7b\u9501</p> <p>\u8fd8\u6709\u867d\u7136\u5199\u4e86\u7a0b\u5e8f\u662f\u91ca\u653e\u9501\uff0c\u4f46\u662f\u52a0\u9501\u4e4b\u540e\uff0c\u7a0b\u5e8f\u6302\u4e86\u554a\u4e5f\u4ea7\u751f\u4e86\u6b7b\u9501\u3002</p> <p>\u8fd8\u6709\u52a0\u9501\u7684\u65f6\u5019\u539f\u5b50\u6027\u7684\u95ee\u9898\uff0c\u867d\u7136\u52a0\u4e86\u9501\uff0c\u4f46\u662f\u8fc7\u671f\u65f6\u95f4\u6ca1\u6709\u52a0\u4e0a\u53bb\uff0c\u7a0b\u5e8f\u5c31\u6302\u4e86\u4e5f\u4f1a\u4ea7\u751f\u6b7b\u9501\u7b49\u7b49</p> <p>\u6b7b\u9501\u5927\u90e8\u5206\u4ea7\u751f\u7684\u573a\u666f\uff0c\u52a0\u4e86\u9501\u6ca1\u6709\u91ca\u653e\u3002\u7136\u540e\u5176\u4ed6\u7ebf\u7a0b\u62ff\u4e0d\u5230\u9501\uff0c\u5c31\u9020\u6210\u4e86\u5927\u9762\u79ef\u7684\u8bf7\u6c42\u5931\u8d25\u3002</p> <p>\u6240\u4ee5\u89e3\u6c7a\u95ee\u9898\u7684\u601d\u8def\u5c31\u662f\uff0c\u9996\u5148\u8981\u4fdd\u969c\u5206\u5e03\u5f0f\u9501\u80fd\u591f\u6b63\u5e38\u91ca\u653e</p> <p>\u91ca\u653e\u9501\u6709\u51e0\u79cd\u65b9\u5f0f</p> <ul> <li>\u76f4\u63a5\u5220\u6389\u9501\u7684key\u6216\u8005\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u4e00\u822c\u5c31\u8fd9\u4e24\u79cd\u91ca\u653e\u65b9\u5f0f</li> <li>\u5220\u9664\u9501\u7684key\u662f\u8981\u6ce8\u610f\uff0c<ul> <li>\u9996\u5148\u9700\u8981\u5224\u65ad\u9501\u662f\u5426\u88ab\u5360\u7528\uff0c\u5982\u679c\u5360\u7528\u624d\u5f00\u59cb\u6267\u884c\u5220\u9664\u3002\u8fd8\u9700\u8981\u5224\u65ad\u662f\u5426\u662f\u5f53\u524d\u7ebf\u7a0b\u52a0\u7684\u9501\uff0c\u4e0d\u80fd\u628a\u522b\u7684\u7ebf\u7a0b\u52a0\u7684\u9501\u7ed9\u91ca\u653e\u6389\uff0c\u540c\u65f6\u4e5f\u8981\u4fdd\u8bc1\u554a\u64cd\u4f5c\u7684\u539f\u5b50\u6027\uff0c\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2alua\u811a\u672c\u6765\u5b9e\u73b0\uff0c</li> </ul> </li> <li>\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u4e00\u822c\u5462\u662f\u5148<code>set nx</code>, \u5230\u671f\u4e86\u5c31\u76f4\u63a5\u91ca\u653e\uff0c\u4f46\u662f\u8fd9\u4e2a\u6b65\u9aa4\u4e0d\u662f\u539f\u5b50\u6027\u7684\uff0c\u6240\u4ee5\u4eceredis2.6\u5f00\u59cb\u5f15\u5165\u4e86set\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bbe\u7f6e\u9501\u7684\u540c\u65f6\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7lua\u811a\u672c\u6765\u6267\u884c\u8fd9\u4e2a<code>setnx</code>, <code>expire</code> \u9632\u6b62\u5220\u9664\u6240\u9501\u7684\u4ee3\u7801\u5931\u6548, \u53ef\u4ee5\u901a\u8fc7\u8fc7\u671f\u65f6\u95f4\u6765\u8865\u5200</li> </ul>"},{"location":"chap7/Arch_anws/#19","title":"19 \u91ca\u653e\u5206\u5e03\u5f0f\u9501\u8981\u6ce8\u610f\u54ea\u4e9b\u95ee\u9898","text":"<p>\u4e00\u822c\u91ca\u653e\u6709\u4e24\u4e2a\u9014\u5f84, \u4e00\u4e2a\u662f\u5199\u4ee3\u7801\uff0c\u76f4\u63a5\u5728\u4e1a\u52a1\u903b\u8f91\u5904\u7406\u5b8c\u6210\u4e4b\u540e\uff0c\u901a\u8fc7Redis\u6765\u628akey\u8fdb\u884c\u5220\u9664</p> <p>\u6216\u8005\u901a\u8fc7\u8fc7\u671f\u65f6\u95f4\uff0c\u8d85\u8fc7\u4e86\u8fc7\u671f\u65f6\u95f4\u4e4b\u540e\u5c31\u76f4\u63a5\u8fc7\u671f\u5220\u9664\u3002 \u5c31\u662f\u5206\u5e03\u5f0f\u9501\u8d85\u8fc7\u4e86\u8fc7\u671f\u65f6\u95f4\uff0c\u4e1a\u52a1\u8fd8\u6ca1\u6709\u5904\u7406\u5b8c\uff0c\u8fd9\u4e2a\u65f6\u5019\u7684\u9501\u5c31\u88ab\u91ca\u653e\u4e86\uff0c\u5c31\u4f1a\u88ab\u5176\u4ed6\u7684\u7ebf\u7a0b\u62ff\u8d70\uff0c\u9501\u4e5f\u5c31\u5931\u53bb\u4e86\u610f\u4e49</p> <p>\u90a3\u4e48\u4e24\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\u540c\u4e00\u4e2a\u6570\u636e\uff0c\u90a3\u4e48\u6570\u636e\u5c31\u5bb9\u6613\u51fa\u73b0\u4e00\u4e9b\u9519\u4e71\u3002 </p> <p>\u5c31\u662f\u8981\u589e\u52a0\u4e00\u4e2a\u5b88\u62a4\u7ebf\u7a0b\uff0c\u6bcf\u9694\u51e0\u79d2\u949f\u6765\u68c0\u67e5\u4e00\u6b21\uff0c\u5224\u65ad\u4e1a\u52a1\u5feb\u5230\u671f\u4e86\u6709\u6ca1\u6709\u5904\u7406\u5b8c\uff0c \u5982\u679c\u6ca1\u6709\u5904\u7406\u5b8c\uff0c\u5c31\u7ed9\u5f53\u524d\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u7eed\u547d\uff0c\u6bd4\u5982\u8bf4\u518d\u589e\u52a05\u79d2\uff0c\u5904\u7406\u5b8c\u4e86\uff0c\u5c31\u76f4\u63a5\u5173\u6389\u8fd9\u4e2a\u5b88\u62a4\u7ebf\u7a0b\uff08watch dog).\u8fd9\u4e2a\u662f\u5904\u7406\u9501\u7684\u4e00\u4e2a\u8fc7\u671f\u7eed\u547d</p> <p>\u90a3\u4e48\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\u5462\u5c31\u662f\u4ee3\u7801\u903b\u8f91\uff0c\u91ca\u653e\u9501\u7684\u65f6\u5019\u5462\u8981\u5224\u65ad\u662f\u4e0d\u662f\u81ea\u5df1\u7ebf\u7a0b\u52a0\u7684\u9501\uff0c\u522b\u628a\u522b\u7684\u7ebf\u7a0b\u52a0\u4e86\u9501\u7ed9\u91ca\u653e\u4e86\u3002</p> <p>\u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662fa\u7ebf\u7a0b\u5361\u6b7b\u9501\u8fc7\u671f\u4e86\u3002 \u8fd9\u4e2a\u65f6\u5019\uff0c\u88abb\u7ebf\u7a0b\u52a0\u4e86\u9501,\u8fd9\u4e2a\u65f6\u5019\u5462a\u7ebf\u7a0b\u53c8\u6062\u590d\u4e86, \u53c8\u628ab\u7ebf\u57ce\u7684\u8fd9\u4e2a\u9501\u7ed9\u91ca\u653e\u4e86.</p> <p>\u6240\u4ee5\u7279\u522b\u5f3a\u8c03, \u5728\u5220\u9664\u9501\u7684\u65f6\u5019. \u6bd4\u5982\u7ed9\u5206\u5e03\u5f0f\u9501. \u589e\u52a0\u8fd9\u4e2a\u5f53\u524d\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u6807\u8bb0. \u6bd4\u5982\u8bf4\u8fd9\u4e2athreadID, \u53ea\u6709\u81ea\u5df1\u52a0\u7684\u9501\u624d\u5141\u8bb8\u5220\u9664\uff0c \u5426\u5219\u662f\u4e0d\u6267\u884c\u5220\u9664</p>"},{"location":"chap7/Arch_anws/#20","title":"20 \u4e3a\u4ec0\u4e48\u8bf4\u53ef\u91cd\u5165\u9501\u662f\u4e2a\u7cdf\u7cd5\u7684\u8bbe\u8ba1","text":"<p>\u53ef\u91cd\u5165\u9501, \u4ecejvm\u91cc\u9762syntronized\u5230redis\u5206\u5e03\u5f0f\u9501, \u4e5f\u90fd\u652f\u6301\u53ef\u91cd\u5165\u7684\u8bbe\u8ba1, \u5c31\u662f\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u5230\u4e86\u9501, \u5982\u679c\u5f80\u4e0b\u8c03\u7528\u7684\u65b9\u6cd5\u4e5f\u6d89\u53ca\u5230\u4e86\u8d44\u6e90\u7684\u7ade\u4e89\u4e5f\u9700\u8981\u52a0\u9501. </p> <p>\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5462\u5982\u679c\u662f\u53ef\u91cd\u5165\u7684\u9501, \u5f80\u4e0b\u7684\u9501\u5c31\u4e0d\u9700\u8981\u518d\u52a0\u4e86\uff0c\u9501\u5c31\u4f1a\u76f4\u63a5\u52a0\u4e0a\uff0c\u53ef\u4ee5\u53cd\u590d\u52a0\u9501\uff0c\u90a3\u4e48\u5982\u679c\u73b0\u5728\u7684\u9501\u4e0d\u652f\u6301\u53ef\u91cd\u5165\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5728\u65b0\u7684\u5b50\u65b9\u6cd5\u4e0a\u9762\u6765\u52a0\u4e0a\u65b0\u7684\u9501</p> <p>\u52a0\u9501\u7684\u540c\u65f6\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u9501\u91cc\u6709\u9501\uff0c\u5728\u7b49\u5f85\u5f53\u524d\u9501\u7684\u91ca\u653e\u5c31\u4f1a\u5f88\u5bb9\u6613\u51fa\u73b0\u6b7b\u9501\uff0c\u90a3\u4e48\u53ef\u91cd\u5165\u9501\u5176\u5b9e\u5c31\u6ca1\u6709\u8fd9\u4e2a\u95ee\u9898\uff0c\u8fd9\u4e2a\u5c31\u662f\u53ef\u4f20\u5165\u9501\u7684\u8fd9\u4e2a\u8bbe\u8ba1\u521d\u8877</p> <p>\u90a3\u4e48\u5728\u5206\u5e03\u5f0f\u7684\u73af\u5883\u4e0b\u9762, \u7528\u7684\u6bd4\u8f83\u591a\u7684\u5c31\u662f\u57fa\u4e8eRedis\u7684\u5206\u5e03\u5f0f\u9501, \u6bd4\u5982\u8bf4\u50cfredison, \u5173\u952e\u70b9\u5c31\u4e24\u4e2a</p> <ul> <li>\u4e00\u4e2a\u662f\u8981\u5b58\u50a8\u5f53\u524d\u7ebf\u7a0b\u7684ID\uff0c\u90a3\u4e48\u7ebf\u7a0bID\u7684\u83b7\u53d6\uff0c\u8981\u6ce8\u610f\u5206\u5e03\u5f0f\u4e0b\u7684ID\u4e0d\u8981\u51fa\u73b0\u91cd\u590d\u7684\uff0c\u53ef\u4ee5\u7528\u8fdb\u7a0b\u7684ID\u7ebf\u7a0b\u7684ID\u7ec4\u5408\u6765\u4fdd\u969c\u4e0d\u91cd\u590d\uff0c </li> <li>\u4e00\u4e2a\u662f\u8981\u505a\u597d\u8ba1\u6570\uff0c\u5c31\u662f\u8981\u8bb0\u5f55\u91cd\u590d\u52a0\u9501\u7684\u6b21\u6570\uff0c\u7528redis\u7684\u8fd9\u4e2aincr\u51fd\u6570\uff0c\u90a3\u4e48\u5b58\u5728\u54c8\u897f\uff0c\u90a3\u4e48\u52a0\u4e86\u591a\u5c11\u6b21\u7684\u9501\uff0c\u90a3\u4e48\u5728\u76f8\u5e94\u91ca\u653e\u9501\u7684\u65f6\u5019\uff0c\u5c31\u9700\u8981\u51cf\u591a\u5c11\u6b21\u4e86\u91cd\u5165\u9501\u3002 </li> </ul> <p>\u4e0d\u662f\u4e00\u4e2a\u597d\u7684\u8bbe\u8ba1\uff0c\u7834\u574f\u4e86\u8fd9\u4e2a\u6240\u8c13\u7684\u4e0d\u53d8\u91cf\u589e\u52a0\u4e86\u590d\u6742\u5ea6\u5bb9\u6613\u4ea7\u751fbug</p>"},{"location":"chap7/Arch_anws/#21-id-","title":"21 \u804a\u804a\u5206\u5e03\u5f0f\u4e0bID\u751f\u6210\u65b9\u6848 - \u53f7\u6bb5\u6a21\u5f0f","text":"<p>\u5927\u540d\u9f0e\u9f0e\u7684\u96ea\u82b1\u7b97\u6cd5\u4e00\u76f4\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u9762\u88ab\u5e7f\u6cdb\u7684\u5e94\u7528\uff0c\u751f\u6210\u4e5f\u5f88\u7b80\u5355\uff0c\u9996\u5148\u65f6\u95f4\u6233\uff0c\u7136\u540e\u673a\u5668\u7801\u81ea\u589e\u6570\uff0c\u7136\u540e\u673a\u5668\u7801\u81ea\u589e\u6570</p> <p>\u8fd8\u6709\u4e00\u4e2aID\u751f\u5b58\u7684\u65b9\u6848\uff0c \u53eb\u505a\u8fd9\u4e2a\u53f7\u6bb5\u6a21\u5f0f\uff0c\u5c31\u662f\u8bf7\u6c42\u4e00\u4e0b\uff0c\u53ef\u4ee5\u751f\u6210\u4e86\u591a\u4e2a\u53f7\u53d8\u6210\u4e86\u4e00\u79cd\u53f7\u6bb5\u3002 </p> <p>\u6bd4\u5982\u8bf4\u8bf7\u6c42\u4e00\u4e0b\u5c31\u653e1000\u4e2a\u53f7\uff0c\u90a3\u4e48\u53f7\u7801\uff0c\u5176\u5b9e\u5c31\u662f\u76f8\u5f53\u4e8e\u751f\u6210\u7684\u8fd9\u4e2aID\uff0c\u90a3\u5176\u5b9e\u4ed6\u662f\u4f9d\u8d56\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\uff0c\u5f97\u6709\u4e2a\u5730\u65b9\u6765\u5b58\u50a8\uff0c\u53f7\u6bb5\u53d1\u653e\u7684\u8fdb\u5ea6\u3002</p> <p>\u591a\u4e2a\u5ba2\u6237\u7aef\u8bf7\u6c42\uff0c\u5c31\u77e5\u9053\u672c\u5730\u5e94\u8be5\u4ece\u54ea\u4e2a\u6570\u5f00\u59cb\u8ba1\u7b97\u4e86\u3002\u7136\u540e\u6709ID\u8bf7\u6c42\u8fdb\u6765\uff0c \u672c\u5730\u5c31\u52a01\u8fd4\u56de\uff0c \u76f4\u5230\u8017\u5c3d\u53f7\u6bb5\u7684\u8d44\u6e90\uff0c\u518d\u53bb\u8bf7\u6c42\u6570\u636e\u5e93\u6765\u83b7\u53d6\u65b0\u7684\u53f7\u6bb5</p>"},{"location":"chap7/Arch_anws/#22","title":"22 \u804a\u804a\u5206\u5e03\u5f0f\u4e0b\u7684\u996a\u52a1\u8c03\u5ea6\u6846\u67b6","text":"<p>\u5e38\u89c1\u7684\u8fd9\u4e2a\u4efb\u52a1\u4ea4\u6d41\u6846\u67b6\u4e5f\u5f88\u591a\uff0cquartz, xxl-job, elasticjob, \u548c schedulex</p> <p>quartz</p> <p>\u4f9d\u8d56\u6570\u636e\u5e93\uff0c\u652f\u6301cron\u8868\u8fbe\u5f0f\uff0c\u5c31\u662f\u6ca1\u6709\u8fd9\u4e2a\u56fe\u5f62\u5316\u7684\u754c\u9762</p> <p>xxl-job</p> <p>\u90fd\u662f\u57fa\u4e8ecron\u8868\u8fbe\u5f0f, \u90fd\u9700\u8981\u4f9d\u8d56\u6570\u636e\u5e93, \u5f53\u7136\u4e5f\u589e\u52a0\u4e86\u5f88\u591a\u7279\u6027.\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2a\u62a5\u8b66\u76d1\u63a7, \u51fa\u73b0\u95ee\u9898\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u90ae\u4ef6\u62a5\u8b66. \u8fd8\u6709\u4e30\u5bcc\u7684\u53ef\u89c6\u5316\u7684\u7ba1\u7406\u754c\u9762, xxl\u4e5f\u6bd4\u8f83\u5bb9\u6613\u96c6\u6210</p>"},{"location":"chap7/Arch_anws/#21","title":"21 \u804a\u804a\u5206\u5e03\u5f0f\u4e8b\u52a1\u4e0b\u7684\u4e8c\u9636\u6bb5\u63d0\u4ea4","text":"<p>\u5e38\u89c1\u7684XA\uff0cAT\u6a21\u5f0f,</p> <ul> <li>\u4e00\u9636\u6bb5\u662f\u51c6\u5907\u9636\u6bb5prepare</li> <li>\u4e00\u9636\u6bb5\u662f\u63d0\u4ea4\u9636\u6bb5commit</li> </ul> <p>\u90a3\u4e48\u5728\u51c6\u5907\u9636\u6bb5\u4e8b\u52a1\u534f\u8c03\u8005\uff0c\u53c8\u53eb\u4ed6\u4e8b\u52a1\u7ba1\u7406\u5668\uff0c\u6bd4\u5982\u8bf4\u5e38\u89c1\u7684seata\uff0c\u5c31\u4f1a\u7ed9\u6bcf\u4e00\u4e2a\u53c2\u4e0e\u8005\u53d1\u9001prepare\u6d88\u606f\u5c31\u662f\u7684\u5404\u4e2a\u670d\u52a1\u4e86\u3002</p> <p>\u6bcf\u4e00\u4e2a\u53c2\u4e0e\u8005\u8981\u4e48\u76f4\u63a5\u8fd4\u56de\u5931\u8d25\uff0c\u6bd4\u5982\u9047\u5230\u4e86\u4e00\u4e9b\u8fd9\u4e2a\u6743\u9650\u7684\u9a8c\u8bc1\u95ee\u9898\u6216\u8005\u662f\u4e00\u4e9b\u5e93\u5b58\u4e0d\u591f\u7684\u95ee\u9898\uff0c \u4e8b\u52a1\u5c31\u4f1a\u76f4\u63a5\u505c\u6b62\uff0c\u5728\u672c\u5730\u5c31\u6267\u884c\u4e8b\u52a1\u4e86\u3002\u5199\u672c\u5730\u7684\u4e00\u4e9bredo\uff0c ando\u65e5\u5fd7\u3002\u5b8c\u6210\u6240\u6709\u7684insert, update. </p> <p>\u4f46\u662f\u5982\u679c\u4e0d\u63d0\u4ea4\u6267\u884c\u5b8c\u6210, \u5c31\u62a5\u544a\u7ed9\u4e8b\u52a1\u7ba1\u7406\u5668seata\u3002 \u5df2\u5b8c\u6210\uff0c\u53ef\u4ee5\u63d0\u4ea4\u4e86\uff0c\u90a3\u4e48\u4e8b\u52a1\u7ba1\u7406\u5668\u5c31\u4f1a\u5728\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u6210\u529f\u4e4b\u540e\uff0c\u518d\u7ed9\u6bcf\u4e00\u4e2a\u8fd9\u4e2a\u5206\u652f\u53bb\u4e0b\u8fbe\u6267\u884ccommit\u7684\u547d\u4ee4\u3002 \u7136\u540e\u6bcf\u4e00\u4e2a\u53c2\u4e0e\u8005\u5206\u522b\u53bb\u63d0\u4ea4\uff0c\u8fd9\u4e2a\u65f6\u5019\u624d\u662f\u771f\u6b63\u7684\u63d0\u4ea4\uff0c</p> <p>\u4e8c\u9636\u6bb5\u6709\u4ec0\u4e48\u95ee\u9898</p> <ul> <li>\u5c31\u662f\u6027\u80fd\u95ee\u9898\uff0c\u5728\u4e8b\u52a1\u6ca1\u6709\u5b8c\u6210\u4e4b\u524d\uff0c\u5176\u5b9e\u6bcf\u4e00\u4e2a\u5206\u652f\u3002\u5b83\u90fd\u662f\u963b\u585e\u7684\u72b6\u6001\uff0c </li> <li>\u53e6\u5916\u4e00\u4e2a\u5e38\u89c1\u7684\u95ee\u9898\uff0c\u5c31\u662f\u53ef\u9ad8\u6027\u7684\u95ee\u9898\u4e86\uff0c\u6bd4\u5982\u8bf4\u5728\u63d0\u4ea4\u9636\uff0c\u6bb5\uff0c\u5206\u652f\u957f\u65f6\u95f4\u4e0d\u54cd\u5e94\uff0c\u53ef\u80fd\u662f\u5b95\u673a\u4e86\u3002 \u6216\u8005\u662f\u670d\u52a1\u5f02\u5e38\u7b49\u7b49\uff0c\u53cd\u6b63\u5c31\u662f\u4e0d\u54cd\u5e94\u3002</li> </ul> <p>\u5176\u4ed6\u7684\u7ebf\u7a0b\u90fd\u662f\u963b\u585e\u72b6\u6001\uff0c\u9700\u8981\u6709\u4e00\u4e2a\u673a\u5236\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u6bd4\u5982\u8bf4\u8d77\u4e00\u4e2a\u5b88\u62a4\u7ebf\u7a0b\uff0c\u5982\u679c\u957f\u65f6\u95f4\u4e0d\u54cd\u5e94\uff0c\u5c31\u76f4\u63a5\u5f53\u6210\u5931\u8d25\u6765\u5904\u7406\u3002 </p> <p>\u8ba9\u5176\u4ed6\u7684\u6a21\u5757\uff0c\u5168\u90e8\u56de\u6eda\u6389\u3002</p>"},{"location":"chap7/Arch_anws/#22_1","title":"22 \u804a\u804a\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u4e09\u9636\u6bb5\u63d0\u4ea4","text":"<p>\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u4e8c\u9636\u6bb5\uff0c\u63d0\u4ea4\u51c6\u5907\u9636\u6bb5\uff0c\u63d0\u4ea4\u9636\u6bb5</p> <p>\u4f46\u662f\u5b9e\u9645\u4e0a\uff0c\u5728\u9879\u76ee\u4e2d\u7528\u7684\u5e76\u4e0d\u591a\u3002\u4e3b\u8981\u539f\u56e0\u8fd8\u662f\u5728\u4e8e\u4ed6\u7684\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u6709\u5f88\u591a\u7684\u95ee\u9898\u3002</p> <p>\u6bd4\u5982\u8282\u70b9\u90fd\u5904\u4e8e\u963b\u585e\u72b6\u6001\uff0c\u90a3\u4e48\u5404\u4e2a\u6570\u636e\u5e93\u8282\u70b9\u90fd\u5360\u7528\u7740\u6570\u636e\u5e93\u7684\u8d44\u6e90\uff0c\u53ea\u6709\u5f53\u6240\u6709\u8282\u70b9\u51c6\u5907\u5b8c\u6bd5\u3002 </p> <p>\u4e8b\u52a1\u534f\u8c03\u8005\u624d\u4f1a\u901a\u77e5\u8fdb\u884c\u5168\u5c40\u63d0\u4ea4\uff0c\u53ea\u6709\u5404\u4e2a\u8282\u70b9\u90fd\u63d0\u4ea4\u4e4b\u540e\u624d\u4f1a\u91ca\u653e\u8d44\u6e90\u3002 </p> <p>\u8fd9\u6837\u7684\u8fc7\u7a0b\u5f80\u5f80\u4f1a\u6bd4\u8f83\u6f2b\u957f\uff0c\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u4e5f\u4f1a\u6bd4\u8f83\u5927\uff0c\u7136\u540e\u8fd8\u6709\u534f\u8c03\u8005\u5355\u70b9\u6545\u969c\u7684\u95ee\u9898\uff0c\u90a3\u4e48\u4e00\u65e6\u534f\u8c03\u8005\u6302\uff0c\u5206\u652f\u8282\u70b9\u6536\u4e0d\u5230\u901a\u77e5\uff0c\u5230\u5e95\u662f\u56de\u6eda\uff0c\u8fd8\u662f\u63d0\u4ea4\uff0c\u5c31\u4f1a\u4e00\u76f4\u5361\u6b7b\u5728\u90a3\u91cc\u3002</p> <p>\u7136\u540e\u8fd8\u6709\u8fd9\u4e2a\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\uff0c\u6bd4\u5982\u8bf4\u7f51\u7edc\u6296\u52a8\uff0c\u90a3\u4e48\u6709\u7684\u6536\u5230\u4e86\u8fd9\u4e2a\u63d0\u4ea4\u901a\u77e5\uff0c\u6709\u7684\u6ca1\u6536\u5230\u3002</p> <p>\u4e09\u9636\u6bb5\u63d0\u4ea43PC\uff0c\u5c31\u4ea7\u751f\u4e86\u7684\u8fdb\u7248\u672c\u3002CanCommit\uff0cpreCommit\uff0c doCommit\u3002\u5c31\u662f\u5728\u4e8c\u9636\u6bb5\u7684\u51c6\u5907\u9636\u6bb5\uff0c\u63d0\u4ea4\u9636\u6bb5\u4e2d\u95f4\uff0c\u589e\u52a0\u4e86pre commit\u7684\u9636\u6bb5\u3002 </p> <p>\u9884\u63d0\u4ea4\uff0c\u8fd9\u90e8\u5206\u5c31\u662f\u5728\u539f\u5148\u4e8c\u9636\u6bb5\u7684\u63d0\u4ea4\u9636\u6bb5\uff0c\u628a\u5de5\u4f5c\u505a\u4e86\u8fdb\u4e00\u6b65\u7684\u62c6\u5206\u3002 \u5148\u786e\u8ba4\u5404\u4e2a\u53c2\u4e0e\u8005\u51c6\u5907\u63d0\u4ea4\u7684\u72b6\u6001\u662f\u5426\u6b63\u5e38\uff0c\u907f\u514d\u5728\u63d0\u4ea4\u9636\u6bb5\u53d1\u751f\u5404\u79cd\u5404\u6837\u7684\u6545\u969c\uff0c\u90a3\u4e48\u5728\u6b63\u5f0f\u63d0\u4ea4\u4e4b\u524d\u3002 </p> <p>\u5148\u5c1d\u8bd5\u505a\u4e00\u4e0b\u63d0\u4ea4\uff0c\u5224\u65ad\u7684\u8ba2\u5355\u4e2d\u5fc3\u7b49\u6b63\u4e0d\u6b63\u5e38\u3002\u5c31\u80fd\u591f\u5c3d\u65e9\u7684\u53d1\u73b0\u4e00\u4e9b\u95ee\u9898\uff0c\u907f\u514d\u628a\u8fd9\u4e2a\u95ee\u9898\u90fd\u62d6\u5230\u63d0\u4ea4\u7684\u9636\u6bb5\u6765\u5904\u7406\u3002</p> <p>\u4e09\u9636\u6bb5\u63d0\u4ea4\u6bd4\u8f83\u91cd\u8981\u7684\u6539\u8fdb\u65b9\u5f0f\uff0c\u5c31\u662f\u5f15\u5165\u4e86\u8d85\u65f6\u673a\u5236\uff0c\u4e8c\u9636\u6bb5\u63d0\u4ea4\uff0c\u53ea\u6709\u4e8b\u52a1\u7684\u534f\u8c03\u8005\u624d\u6709\u8fd9\u4e2a\u8d85\u65f6\u673a\u5236\u672c\u8eab\u5404\u4e2a\u5206\u652f\u4e8b\u52a1\uff0c\u662f\u6ca1\u6709\u8d85\u65f6\u673a\u5236\u7684\u3002</p> <p>\u5982\u679c\u5206\u652f\u7684\u4e8b\u52a1\uff0c\u90a3\u4e48\u4e09\u519b\u4e71\u63d0\u4ea4\uff0c\u5c31\u4fee\u8865\u4e86\u8fd9\u6837\u7684\u4e00\u4e2a\u6f0f\u6d1e\u3002\u5982\u679c\u5206\u652f\u4e8b\u52a1\u957f\u65f6\u95f4\u65e0\u6cd5\u4e0e\u534f\u8c03\u8005\u554a\u901a\u8baf\uff0c\u90a3\u4e48\u53ef\u80fd\u662fseata\u6302\u4e86\u3002 </p> <p>\u90a3\u4e48\u53c2\u4e0e\u8005\uff0c\u5c31\u4f1a\u5728\u7b49\u5f85\u547d\u4ee4\u8d85\u65f6\u4e4b\u540e\uff0c\u6bd4\u5982\u8bf41\u79d2\u949f\u6216\u80052\u79d2\u949f\uff0c\u90a3\u4e48\u5c31\u4f1a\u81ea\u52a8\u8fdb\u5165\u672c\u5730\u7684commit\uff0c\u8fdb\u884c\u8d44\u6e90\u7684\u91ca\u653e\u3002</p> <p>\u8fd9\u6837\u7684\u8bdd\u5c31\u80fd\u591f\u907f\u514d\u56e0\u4e3a\u8fd9\u4e2a\u4e8b\u52a1\u957f\u65f6\u95f4\u963b\u585e\u4e86\u3002 \u56e0\u4e3a\u8fd9\u4e2a\u4e8b\u52a1\u957f\u65f6\u95f4\u963b\u585e\u4e86\u8fd8\u662f\u4e0d\u80fd\u591f\u89e3\u51b3\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\uff0c\u5148\u628a\u8fd9\u4e2a\u89e6\u53d1\u7684\u8fd9\u79cd\u5f02\u5e38\u60c5\u51b5\u7136\u540e\u518d\u53cd\u9988\u7ed9\u540e\u53f0\uff0c\u4eba\u5de5\u6765\u5e72\u9884\u5904\u7406</p>"},{"location":"chap7/Arch_anws/#23-tcc","title":"23 \u5206\u5e03\u5f0f\u4e8b\u52a1\u4e0b\u7684TCC\u6a21\u5f0f","text":"<p>\u5b9e\u9645\u4e0atcc\u662f\u4e8c\u9636\u6bb5, \u901a\u5e38\u8fd9\u4e2a\u4e8c\u9636\u6bb5\u6307\u7684\u662f. </p> <p>\u57fa\u4e8e\u8fd9\u4e2axa\u6a21\u5f0f, \u8981\u4f9d\u8d56\u6570\u636e\u5e93\u4e8b\u52a1\u7684\u8fd9\u4e48\u4e00\u79cd\u6a21\u5f0f, \u90a3\u4e48Tcc\u8fd9\u4e2a\u4e8c\u9636\u6bb5, \u5b83\u5176\u5b9e\u662f\u4f20\u7edf\u4e8c\u9636\u6bb5\u7684\u6539\u8fdb\u7248\u672c. \u540c\u6837\u4e5f\u662f\u5148\u5c1d\u8bd5\u53d1\u8d77\u4e8b\u52a1, \u5982\u679c\u90fd\u6b63\u5e38\u90a3\u4e48commit, \u5982\u679c\u5931\u8d25\u90a3\u5c31\u76f4\u63a5cancel. \u6709\u4e00\u4e2a\u5f88\u5927\u7684\u6539\u8fdb, \u5c31\u662f\u629b\u5f03\u4e86\u6570\u636e\u5e93\u7684\u4e8b\u52a1.</p> <p>\u6240\u6709\u7684\u4e8b\u52a1\u5904\u7406\u5305\u62ec\u5c1d\u8bd5\u5904\u7406, \u63d0\u4ea4\uff0c\u56de\u6eda. \u5168\u90fd\u8981\u4e0a\u5347\u5230\u4e1a\u52a1\u5c42\u6765\u5904\u7406, \u5c31\u662f\u624b\u5199\u903b\u8f91\u4ee3\u7801. \u5728\u4e1a\u52a1\u91cc\u9762, \u6bd4\u5982\u8bf4\u4e0b\u5355\u6263\u5e93\u5b58. </p> <p>\u5728\u51c6\u5907\u9636\u6bb5\uff0c\u5c31\u662ftry\u9636\u6bb5, \u8ba2\u5355\u7684\u72b6\u6001\u662f\u9884\u521b\u5efa\u7684\u4e00\u4e2a\u72b6\u6001\uff0c\u5e93\u5b58\u7684\u6263\u51cf\u4e5f\u662f\u5728\u9884\u6263\u9664\u7684\u72b6\u6001\u3002 \u5982\u679c\u9047\u5230\u5206\u6210\u5931\u8d25\u7684\u60c5\u51b5\uff0c\u8981\u5206\u9636\u6bb5\u6765\u8003\u8651\uff0c\u5982\u679c\u662f\u5728try\u9636\u6bb5\u5931\u8d25\uff0c \u90a3\u4e48\u76f4\u63a5rollback\u3002 \u4f46\u662f\u5982\u679c\u5728commit\u9636\u6bb5\u5931\u8d25\u4e86\u600e\u4e48\u529e\uff0c\u53ea\u80fd\u786c\u7740\u5934\u76ae\u4e0d\u505c\u7684\u91cd\u8bd5\u76f4\u5230\u6210\u529f\u4e3a\u6b62\uff0c \u8fd9\u4e2a\u91cd\u8bd5\u52a8\u4f5c\u4e5f\u662f\u4e8b\u52a1\u7ba1\u7406\u5668\u6765\u505a\u7684</p>"},{"location":"chap7/Arch_anws/#24","title":"24 \u5206\u5e03\u5f0f\u4e0b\u5982\u4f55\u5bf9\u670d\u52a1\u8fdb\u884c\u4f18\u96c5\u4e0b\u7ebf","text":"<ul> <li>kill -9 \u4e0d\u884c;</li> <li>kill -15 </li> </ul> <p>\u5e38\u89c1\u7684\u5f88\u591a\u547d\u4ee4\uff0c\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2aTomcat\u7684\u505c\u6b62\uff0c\u57fa\u672c\u4e5f\u90fd\u5305\u7684\u662f<code>kill -15</code>\u7684\u547d\u4ee4,\u6765\u7ed3\u675f\u6b63\u5728\u8dd1\u7684\u670d\u52a1</p> <p>\u5f53\u7136\u4e86\u5f88\u591a\u7684Java\u6846\u67b6\uff0c\u50cf\u8fd9spring\uff0c \u4e5f\u5185\u7f6e\u4e86shut down hook. \u6765\u54cd\u5e94 <code>kill -15</code>\u7684\u547d\u4ee4, \u9ed8\u8ba4\u7684\u90fd\u662f\u5148\u5904\u7406\u597d, \u5f53\u524d\u4e0a\u4e0b\u6587\u7684\u4efb\u52a1, \u5904\u7406\u5b8c\u4e86\u624d\u5141\u8bb8kill\u6389</p> <p>stop\u7684\u547d\u4ee4\u597d\u50cf\u4e0d\u662f\u7acb\u5373\u505c\u6b62, \u5b9e\u9645\u4e0a\u662f\u670d\u52a1\u5185\u90e8, \u53ef\u80fd\u662f\u5728\u5904\u7406\u4e00\u4e9b\u4e8b\u52a1, \u6240\u4ee5\u8981\u7b49\uff0c</p> <p>\u90a3\u4e48\u5bf9\u4e8e\u5206\u5e03\u5f0f\u4e0b\u5fae\u670d\u52a1\u600e\u4e48\u4e0b\u7ebf, \u4e00\u822c\u90fd\u662f\u5148\u4ece\u6ce8\u518c\u4e2d\u5fc3\u6458\u9664\u673a\u5668 \u6bd4\u5982\u8bf4\u50cfeureka\u6216\u8005\u662fNacos\uff0c \u8fd9\u65f6\u5019\u4e00\u822c\u90fd\u662f\u8d1f\u8f7d\u5747\u8861\uff0c \u6bd4\u5982\u8bf4\u7528\u6237\u4e2d\u5fc3\u53ef\u80fd\u6709\u597d\u591a\u4e2a\u3002 </p> <p>\u8fd9\u4e2a\u65f6\u5019\u5982\u679c\u4f60\u8981\u4e0b\u7ebf\uff0c\u67d0\u4e00\u4e2a\u7528\u6237\u4e2d\u5fc3\u3002\u90a3\u4e48\u5c31\u76f4\u63a5\u53d1\u6307\u4ee4\u7ed9eureka\u6216\u8005Nacos, \u628a\u8fd9\u4e2a\u670d\u52a1\u6458\u6389, \u540e\u7eed\u7684\u8bf7\u6c42\u5c31\u4e0d\u4f1a. \u53d1\u9001\u5230\u5f53\u524d\u7684\u670d\u52a1\u4e0a, \u8fd9\u4e2a\u65f6\u5019\u518d\u4f7f\u7528<code>kill -15</code>\u7684\u547d\u4ee4. \u7ed3\u675f\u670d\u52a1\u554a</p> <p>\u8fd8\u6709\u50cf\u7f51\u5173\u5c42\u7684\u4e0b\u7ebf, \u4e00\u822c\u90fd\u662f\u524d\u7f6e \u8fd9\u4e2aNginx, \u8fd9\u4e2a\u65f6\u5019\u5982\u679c\u8981\u5e72\u6389\u4e00\u4e2a\u670d\u52a1, \u5c31\u9700\u8981Nginx\u7684\u670d\u52a1\u5217\u8868\u91cc\u9762\u628a\u5b83\u8bbe\u7f6e\u6210\u4e0d\u53ef\u7528, \u7136\u540e\u518d\u5bf9\u670d\u52a1\u5c42\u8fdb\u884ckill\u7684\u4e0b\u7ebf\u5904\u7406</p>"},{"location":"chap7/Arch_anws/#24-rpc","title":"24 RPC\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u5b9e\u73b0\u50cf\u672c\u5730\u4e00\u6837\u8c03\u7528","text":"<p>\u4e3b\u6d41\u7684\u5fae\u670d\u52a1\u7684\u6846\u67b6\uff0c\u670d\u52a1\u4e0e\u670d\u52a1\u4e4b\u95f4\u7684\u8c03\u7528\uff0c\u90fd\u662f\u901a\u8fc7RPC\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u7684\u5b9e\u73b0\u65b9\u5f0f\u4e5f\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u901a\u8fc7\u8fdc\u7a0b\u670d\u52a1\u7c7b\uff0c\u7136\u540e\u901a\u8fc7\u65b9\u6cd5\u76f4\u63a5invoke\uff0c\u8c03\u7528\u7684\u901f\u5ea6\u4e5f\u5f88\u5feb\uff0c\u8ddf\u672c\u5730\u6ca1\u4ec0\u4e48\u533a\u522b</p> <p>\u4e24\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u5173\u952e\u70b9</p> <p>\u4e00\u4e2a\u7f51\u7edc\u901a\u4fe1</p> <p>dubbo\u7684\u901a\u4fe1\u65b9\u5f0f\uff0c\u662ftcp socket \u7684\u957f\u8fde\u63a5\uff0c\u6bcf\u6b21\u8c03\u7528\u4e0d\u9700\u8981\u91cd\u65b0\u5efa\u7acb\u8fde\u63a5\uff0c\u6709\u9700\u8981\u76f4\u63a5\u8c03\u7528\uff0c\u800c\u4e14\u670d\u52a1\u4e4b\u95f4\u4e00\u822c\u8d70\u7684\u662f\u5185\u7f51</p> <p>\u53e6\u4e00\u65b9\u9762\u662f\u4ee3\u7406</p> <p>\u5fae\u670d\u52a1\u7684\u6846\u67b6\uff0c\u90fd\u662f\u901a\u8fc7\u4ee3\u7406\u7684\u6a21\u5f0f\uff0c\u628a\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\u5c01\u88c5\u4e86\u8d77\u6765\uff0c\u5305\u62ec\u4e86\u5bf9\u51fa\u53c2\u5165\u53c2\u7684\u5e8f\u5217\u5316\uff0c\u7ebf\u7a0b\u6c60\u7684\u8c03\u7528\uff0c\u8fd8\u6709\u8d1f\u8f7d\u5747\u8861\u7684\u9009\u62e9\uff0c</p>"},{"location":"chap7/Arch_anws/#25","title":"25 \u804a\u804a\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0b\u7684\u5bb9\u9519\u673a\u5236","text":"<ul> <li>\u9996\u5148\uff1a \u5197\u4f59\u5907\u4efd</li> </ul> <p>\u5176\u5b9e\u4e0d\u7ba1\u662f\u7cfb\u7edf\u7684\u6570\u636e\u4e5f\u597d\uff0c\u8fd8\u662f\u529f\u80fd\u4e5f\u597d\uff0c\u90fd\u9700\u8981\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u9762\u8fdb\u884c\u5907\u4efd\uff0c\u4ee5\u9632\u6b62\u5355\u4e2a\u8282\u70b9\u7684\u6545\u969c\uff0c\u5bfc\u81f4\u6574\u4e2a\u7cfb\u7edf\u5d29\u6e83\uff0c \u4e00\u65e6\u67d0\u4e2a\u8282\u70b9\u51fa\u73b0\u4e86\u6545\u969c</p> <p>\u7cfb\u7edf\u53ef\u4ee5\u81ea\u52a8\u7684\u5207\u6362\u5230\u5907\u7528\u8282\u70b9\u4e0a\u9762\u6765\u7ee7\u7eed\u8fd0\u884c\uff0c\u6bd4\u5982\u5e94\u7528\u670d\u52a1\uff0c\u6ce8\u518c\u4e2d\u5fc3\uff0c\u8fd8\u6709\u4e00\u4e9b\u8fd9\u4e2a\u4e2d\u95f4\u952e\uff0c \u6bd4\u5982\u8bf4\u6d88\u606f\u961f\u5217\uff0credis\uff0c\u6570\u636e\u5e93\uff0c\u90fd\u9700\u8981\u505a\u597d\u5197\u4f59\u5907\u4efd\uff0c</p> <ul> <li>\u90a3\u4e48\u5197\u4f59\u5907\u4efd\u518d\u5347\u4e00\u7ea7\uff1a \u5bb9\u707e\u5907\u4efd</li> </ul> <p>\u9664\u4e86\u591a\u526f\u672c\u4ee5\u5916\uff0c \u8fd8\u9700\u8981\u5f3a\u8c03\u591a\u6570\u636e\u4e2d\u5fc3\uff0c\u591a\u5730\u7406\u4f4d\u7f6e\uff0c\u5176\u5b9e\u5c31\u662f\u5206\u6563\u5728\u4e0d\u540c\u7684\u5730\u65b9</p> <p>\u786e\u4fdd\u5728\u4e00\u4e2a\u533a\u57df\u53d1\u751f\u4e86\u707e\u96be\u6216\u8005\u6545\u969c\uff0c \u53ef\u4ee5\u901a\u8fc7\u5907\u4efd\u6570\u636e\u548c\u670d\u52a1\u6765\u6062\u590d\u7cfb\u7edf</p> <ul> <li>\u7136\u540e\uff1a \u5fc3\u8df3\u76d1\u6d4b</li> </ul> <p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u68c0\u6d4b\u6545\u969c\u7684\u91cd\u8981\u624b\u6bb5\u5e94\uff0c \u901a\u8fc7\u7cfb\u7edf\u5b9a\u671f\u5411\u8282\u70b9\u6765\u53d1\u9001\u5fc3\u8df3\u6d88\u606f\uff0c \u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u5982\u679c\u6ca1\u6709\u6536\u5230\u5fc3\u8df3\u56de\u590d\uff0c\u5c31\u4f1a\u8ba4\u4e3a\u8282\u70b9\u6545\u969c\u3002\u5c06\u5b83\u6807\u8bb0\u4e3a\u4e0d\u53ef\u7528\uff0c \u5c31\u4f1a\u5c06\u4efb\u52a1\u8f6c\u79fb\u5230\u5176\u4ed6\u53ef\u7528\u7684\u8282\u70b9\u4e0a\u9762\uff0c</p> <p>\u6709\u4e00\u4e2a\u6bd4\u8f83\u5178\u578b\u7684\u529f\u80fd\uff1a \u6709\u4e00\u4e2a\u6bd4\u8f83\u5178\u578b\u7684\u529f\u80fd\u6d4b\u5404\u4e2a\u673a\u5668\u6216\u8005\u5404\u4e2a\u670d\u52a1\u7684\u8fd0\u884c\u60c5\u51b5\uff0c\u50cfredis\u4e3b\u4ece\u8282\u70b9\u7684\u4e92\u76f8\u76d1\u542c\uff0c\u6ce8\u518c\u4e2d\u5fc3\u4e0e\u5e94\u7528\u670d\u52a1\u4e4b\u95f4\u7684\u76d1\u542c\uff0c\u90fd\u662f\u91c7\u7528\u4e86\u5fc3\u8df3\u68c0\u6d4b\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u7684</p> <ul> <li>\u8d1f\u8f7d\u5747\u8861\u662f\u5bb9\u9519\u673a\u5236\u4e2d\u5fc5\u4e0d\u53ef\u5c11\u7684\u4e00\u5458</li> </ul> <p>\u901a\u8fc7\u5c06\u8bf7\u6c42\u5206\u644a\u5230\u591a\u4e2a\u8282\u70b9\u4e0a\u9762\uff0c\u6765\u907f\u514d\u5355\u4e2a\u8282\u70b9\u7684\u8d1f\u8f7d\u8fc7\u5927,\u4ece\u800c\u63d0\u9ad8\u7cfb\u7edf\u7684\u6574\u4f53\u6027\u80fd\u548c\u53ef\u9760\u6027, </p> <p>\u50cf\u5fae\u670d\u52a1\u4e0b\u540c\u4e00\u4e2a\u5fae\u670d\u52a1, \u53ef\u80fd\u6709\u597d\u51e0\u4e2a\u76f8\u540c\u7684\u670d\u52a1\u5305\u6765\u5171\u540c\u7ec4\u6210\u4e86\u670d\u52a1\u5355\u5143, \u600e\u4e48\u8bbf\u95ee\u8fd9\u4e9b\u670d\u52a1\u5305? </p> <p>\u91c7\u7528\u4ec0\u4e48\u6837\u7684\u7b56\u7565, \u5c31\u9700\u8981\u7528\u5230\u8d1f\u8f7d\u5747\u8861\u6765\u505a\u7edf\u4e00\u7684\u5206\u914d</p> <ul> <li>\u8fd8\u6709\u5c31\u662f\u5206\u5e03\u5f0f\u4e8b\u52a1</li> </ul> <p>\u4e5f\u662f\u5bb9\u9519\u673a\u5236\u4e2d\u91cd\u8981\u7684\u7ec4\u6210\u90e8\u5206, \u7531\u4e8e\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u9762\u5404\u4e2a\u8282\u70b9\u4e4b\u95f4\u7684\u7f51\u7edc\u5ef6\u8fdf, \u6216\u8005\u4e0d\u53ef\u9760\u6027,\u5f88\u5bb9\u6613\u5c31\u51fa\u73b0\u4e86\u8fd9\u4e2a\u4e8b\u7269\u4e00\u81f4\u6027\u7684\u95ee\u9898,\u6bd4\u5982\u8bf4a\u6210\u529f\u4e86, b\u4e0d\u6210\u529f. </p> <p>\u5c31\u8981\u505a\u7edf\u4e00\u7684\u56de\u6eda, \u5c31\u9700\u8981\u4f7f\u7528\u5206\u5e03\u5f0f\u4e8b\u52a1,\u6765\u534f\u8c03\u5404\u4e2a\u8282\u70b9\u4e4b\u95f4\u7684\u4e8b\u52a1\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027</p> <p>\u5e38\u89c1\u7684\u89e3\u6c7a\u65b9\u6848, \u5c31\u662f\u4e8c\u9636\u6bb5\u4e09\u9636\u6bb5\u63d0\u4ea4\u4e86, \u50cf\u8fd9\u4e2aXA,TCC, at\u90fd\u662f\u6bd4\u8f83\u5e38\u89c1\u7684\u65b9\u6848, </p> <ul> <li>\u52a8\u6001\u4f38\u7f29\u6216\u8005\u5f39\u6027\u4f38\u7f29</li> </ul> <p>\u5f53\u6211\u4eec\u7684\u7cfb\u7edf\u8d1f\u8f7d\u8fc7\u5927, \u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0\u66f4\u591a\u7684\u8282\u70b9\u6765\u5206\u62c5\u8d1f\u8f7d, \u5f53\u8282\u70b9\u6545\u969c\u6216\u8005\u51fa\u73b0\u6027\u80fd\u95ee\u9898\u65f6, \u53ef\u4ee5\u52a8\u6001\u7684\u6765\u8c03\u6574\u7cfb\u7edf\u4e2d\u5404\u4e2a\u8282\u70b9\u7684\u914d\u7f6e,\u6765\u786e\u4fdd\u6574\u4e2a\u7cfb\u7edf\u7684\u7a33\u5b9a\u6027\u548c\u53ef\u9760\u6027, \u8fd9\u4e2a\u4e00\u822c\u8981\u642d\u914d\u4e91\u670d\u52a1\u6765\u505a</p>"},{"location":"chap7/Arch_anws/#3_1","title":"3 \u6d88\u606f\u961f\u5217","text":""},{"location":"chap7/Arch_anws/#1_3","title":"1 \u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528\u6d88\u606f\u961f\u5217","text":"<p>\u4e00\u6761\u4e00\u6761\u7684\u6d88\u606f\u5728\u6392\u961f\u7b49\u5f85\u6d88\u8d39,  \u7f51\u4e0a\u4e70\u4e1c\u897f\u4e5f\u8981\u6392\u961f\u3002 \u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662f\u5e94\u7528\u6d88\u606f\u961f\u5217\uff0c\u5c06\u76f8\u5173\u7684\u6307\u4ee4\u6765\u505a\u4e00\u4e2a\u6392\u961f\uff0c \u7b49\u5f85\u4e1a\u52a1\u65b9\u6162\u6162\u7684\u53bb\u5904\u7406\u3002 </p> <p>\u6d88\u606f\u53d1\u5e03\u8005\u53ea\u7ba1\u628a\u6d88\u606f\u53d1\u5e03\u5230mg\u4e2d\uff0c\u800c\u4e0d\u7528\u7ba1\u8c01\u6765\u53d6\uff0c\u90a3\u4e48\u6d88\u606f\u4f7f\u7528\u8005\u4e5f\u53ea\u7ba1\u4ecemq\u4e2d\u53d6\u6d88\u606f, \u800c\u4e0d\u7ba1\u662f\u8c01\u53d1\u5e03\u7684.</p> <p>\u4e0b\u5355\u6210\u529f, \u5c31\u53d1\u6d88\u606f\u7ed9\u79ef\u5206\u4e2d\u5fc3, \u518d\u53d1\u6d88\u606f\u7ed9\u901a\u77e5\u4e2d\u5fc3, \u6392\u961f\u5904\u7406\u652f\u4ed8\u6210\u529f\u901a\u77e5\u7684\u4e1a\u52a1. \u6392\u961f\u8bb0\u5f55\u7528\u6237\u7684\u91cd\u8981\u64cd\u4f5c, \u8fd9\u4e9b\u64cd\u4f5c\u54cd\u5e94\u4e0d\u7528\u5f88\u53ca\u65f6. \u6240\u6709\u6307\u4ee4\u8fdb\u884c\u6392\u961f, \u7b49\u5230\u4e5f\u6709\u4e0d\u5fd9\u7684\u65f6\u5019\u6765\u5904\u7406. \u8fd9\u79cd\u573a\u666f\u5462\u4e5f\u53eb\u6d41\u91cf\u524a\u5cf0</p> <p>\u6211\u4eec\u4e0d\u7528\u628a\u6240\u6709\u7684\u64cd\u4f5c, \u90fd\u6253\u5305\u5728\u4e00\u4e2a\u4e0b\u5355\u7684\u63a5\u53e3\u91cc\u9762. \u800c\u662f\u628a\u4e1a\u52a1\u505a\u4e86\u4e00\u4e9b\u62c6\u5206, \u6bd4\u5982\u79ef\u5206\u4e2d\u5fc3</p> <p>\u5e94\u7528\u6d88\u606f\u961f\u65e0\u5916\u4e4e\u5c31\u4e09\u4e2a\u65b9\u9762</p> <ul> <li>\u4e00\u4e2a\u662f\u5f02\u6b65\u5904\u7406</li> <li>\u4e00\u4e2a\u662f\u6d41\u91cf\u524a\u5cf0</li> <li>\u4e00\u4e2a\u662f\u5e94\u7528\u89e3\u8026</li> </ul>"},{"location":"chap7/Arch_anws/#2_3","title":"2 \u6d88\u606f\u961f\u5217 \u5e36\u6765\u4e86\u54ea\u4e9b\u95ee\u9898","text":"<p>\u6d88\u606f\u961f\u5217\u6240\u5e26\u6765\u7684\u4e00\u4e9b\u95ee\u9898\uff0c\u5305\u542b\u53ef\u7528\u6027\u95ee\u9898\uff0c\u4e00\u81f4\u6027\u95ee\u9898\uff0c\u590d\u6742\u6027\u95ee\u9898\u3002 </p> <p>\u7cfb\u7edf\u539f\u5148\u53ef\u80fd\u5904\u7406\u7684\u597d\u597d\u7684\uff0c \u786c\u751f\u751f\u7684\u52a0\u4e86\u4e00\u4e2aMQ\uff0c\u591a\u4e86\u4e00\u4e2a\u4e2d\u95f4\u4ef6\uff0c \u53ef\u80fd\u4f1a\u589e\u52a0\u7cfb\u7edf\u7684\u590d\u6742\u5ea6\u3002  \u600e\u4e48\u4fdd\u8bc1\u6d88\u606f\u6709\u6ca1\u6709\u91cd\u590d\u6d88\u8d39\uff0c \u600e\u4e48\u5904\u7406\u6d88\u606f\u4e22\u5931\u7684\u60c5\u51b5\uff0c \u600e\u4e48\u4fdd\u8bc1\u6d88\u606f\u4f20\u9012\u7684\u987a\u5e8f\u6027\u3002 </p> <p>\u5f15\u5165MQ\u6ca1\u6709\u592a\u591a\u7684\u5de5\u4f5c, \u53ef\u80fd\u5dee\u4e0d\u591a10%\u7684\u5de5\u4f5c\u91cf,  \u5904\u7406\u53ef\u80fd\u4f1a\u5e26\u6765\u5f88\u591a\u7684\u95ee\u9898. \u589e\u52a0\u7684\u590d\u6742\u5ea6\u53ef\u80fd\u8981\u7ffb\u4e00\u500d</p> <p>\u53ef\u7528\u6027</p> <p>\u7cfb\u7edf\u5f15\u5165\u4e86\u8fd9\u4e2a\u5916\u90e8\u7684\u4f9d\u8d56\u8d8a\u591a, \u8d8a\u5bb9\u6613\u6302\u3002 \u4f46\u662f\u5982\u679c\u5f15\u5165MQ\u591a\u4e86\u4e00\u4e2a\u4e2d\u95f4\u4ef6,  \u4e07\u4e00mq\u6302\u6389\u6574\u4e2a\u6a21\u5757\u5462\u53ef\u80fd\u90fd\u6302\u3002 </p> <p>\u5982\u679c\u4e2d\u95f4\u7684\u8fd9\u4e2a\u6d88\u606f\u961f\u5217\u6302\u6389, \u51fa\u73b0\u4e00\u4e9b\u4e00\u81f4\u6027\u7684\u95ee\u9898. \u6bd4\u5982\u8bf4\u5904\u7406\u8fd9\u4e2a\u8ba2\u5355\u6570\u636e, \u7136\u540e\u5982\u679c\u8981\u540c\u6b65\uff0c\u6765\u540c\u6b65\u5230\u591a\u4e2a\u7cfb\u7edf\u4e2d\u6216\u8005mq\u5f02\u5e38\u957f\u65f6\u95f4\u5f97\u4e0d\u5230\u54cd\u5e94\uff0c \u6570\u636e\u957f\u65f6\u95f4\u66f4\u65b0\u4e0d\u4e0a\u53bb\u3002 \u51fa\u73b0\u8fd9\u4e2a\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5</p> <p>\u5e94\u7528\u6d88\u606f\u961f\u5217\u7684\u95ee\u9898 </p> <ul> <li>\u53ef\u7528\u6027\u95ee\u9898</li> <li>\u4e00\u81f4\u6027\u95ee\u9898</li> <li>\u590d\u6742\u6027\u95ee\u9898</li> </ul>"},{"location":"chap7/Arch_anws/#3_2","title":"3 \u6d88\u606f\u961f\u5217 \u5982\u4f55\u89e3\u6c7a\u6d88\u606f\u91cd\u590d\u7684\u95ee\u9898","text":"<p>\u7528\u6237\u5728\u5546\u57ce\u4e2d\u5fc3\u4e0b\u5355\u6210\u529f\u4e86, \u7136\u540e\u901a\u8fc7\u6d88\u606f\u961f\u5217, \u53d1\u9001\u6d88\u606f\u7ed9\u8fd9\u4e2a\u79ef\u5206\u7cfb\u7edf\u53bb\u5956\u52b1\u79ef\u5206. \u5047\u5982\u51fa\u73b0\u4e86\u8fd9\u4e2a\u6d88\u606f\u91cd\u590d,  \u6bd4\u5982\u8bf4\u79ef\u5206\u7cfb\u7edf\u6536\u5230\u4e86\u540c\u4e00\u4e2a\u7528\u6237, \u540c\u4e00\u4e2a\u8ba2\u5355\u4e24\u6761\u76f8\u540c\u7684\u6d88\u606f\u4f1a\u600e\u4e48\u6837?  \u51fa\u73b0\u4e86\u91cd\u590d\u6d88\u606f\u7684\u53ef\u80fd\u6027\u6709\u5f88\u591a</p> <p>\u53d1\u9001\u65b9\u4e3a\u4e86\u9632\u6b62\u6d88\u606f\u4e1f\u5931\uff0c \u505a\u4e86\u6d88\u606f\u8865\u507f\uff0c \u8fd9\u79cd\u60c5\u51b5\u5f88\u591a\u554a\uff0c\u4e00\u822c\u90fd\u662f\u6d88\u8d39\u65b9\uff0c \u54cd\u5e94\u8d85\u65f6\u5f88\u6709\u53ef\u80fd\u662f\u7f51\u7edc\u6296\u52a8\u6216\u8005\u662fMQ\u6302\u4e86.  \u53cd\u6b63\u5c31\u662f\u53d1\u9001\u65b9\u957f\u65f6\u95f4\u6536\u4e0d\u5230\u6d88\u8d39\u6210\u529f\u7684\u6d88\u606f.  \u5c31\u4f1a\u518d\u6b21\u53d1\u9001\u4e00\u6761\u6d88\u606f\u8fdb\u884c\u8865\u507f</p> <p>\u5f53\u7136\u5982\u679c\u6d88\u8d39\u7aef\u8fd8\u662f\u54cd\u5e94\u4e0d\u53ca\u65f6, \u90a3\u4e48\u53ef\u80fd\u5c31\u4f1a\u591a\u6b21\u8865\u507f. \u4e0d\u505c\u7684\u5c1d\u8bd5\u91cd\u53d1\u6d88\u606f.  \u9700\u8981\u9488\u5bf9\u8fd9\u4e2a\u79ef\u5206\u7d2f\u79ef\u63a5\u53e3, \u505a\u5e42\u7b49\u8bbe\u8ba1\u3002 \u5c31\u53bb\u505a\u8fd9\u4e2a\u6d88\u606f\u53bb\u91cd\u5904\u7406\uff0c \u6bd4\u5982\u8bf4\u4e0b\u5355\u4e2d\u5fc3\uff0c\u7684\u786e\u4fdd\u53d1\u9001\u7684\u6d88\u606f\u53ea\u67091\u6761\uff0c\u4f46\u662f\u4e0d\u80fd\u76f8\u4fe1\u4ed6\u4f9d\u8d56\u4ed6\u3002 </p> <p>\u53ea\u6709\u5728\u79ef\u5206\u4e2d\u95f4\u505a\u4e86\u5e42\u7b49\u8bbe\u8ba1\uff0c \u624d\u6709\u53ef\u80fd\u5b8c\u5168\u907f\u514d\u8fd9\u79cd\u548c\u94b1\u76f8\u5173\u7684bug\u3002 \u6bd5\u7adf\u5982\u679c\u4f9d\u8d56\u4e0a\u771f\u6b63\u51fa\u4e86\u3002 </p> <p>\u79ef\u5206\u4e2d\u5fc3\u7684\u5bc6\u5e42\u7b49\u5904\u7406\u4e5f\u5f88\u7b80\u5355\uff0c \u6839\u636e\u7528\u6237\u8ba2\u5355\u53f7\u6216\u8005\u662f\u6d41\u6c34\u53f7\u505a\u5f3a\u5e42\u7b49\u3002 \u6bcf\u6210\u529f\u64cd\u4f5c1\u6761\u79ef\u5206\u5956\u52b1\uff0c \u5c31\u8bb0\u5f55\u4e0b\u6765\u3002 \u5373\u4f7f\u662f\u628a\u6d88\u606f\u91cd\u590d\u4e86\uff0c\u53ea\u8981\u5224\u65ad\u540c\u4e00\u4e2a\u8ba2\u5355\u53f7\uff0c\u90a3\u4e48\u5c31\u662f\u505a\u597d\u63a5\u53e3\u7684\u5e42\u7b49\u8bbe\u8ba1</p>"},{"location":"chap7/Arch_anws/#4_1","title":"4 \u5e94\u5bf9\u6d88\u606f\u91cd\u590d \u5e42\u7b49\u8bbe\u8ba1\u7684\u51e0\u79cd\u65b9\u6848","text":"<p>\u65b9\u6848\u4e00</p> <p>\u901a\u8fc7\u7ea8\u675f\u63a7\u5236\uff0c \u6bd4\u5982\u8bf4\u5229\u7528\u6570\u636e\u5e93\u7684unique\u7d20\u5f15\uff0c\u4e5f\u53ef\u4ee5\u5229\u7528redis\u7684setnx\u6765\u505a\u7ea6\u675f\u3002\u5982\u679crelis\u4e2d\u5b58\u5728\u554a\u5bf9\u5e94\u7684\u6807\u8bc6\uff0c\u90a3\u4e48\u5c31\u76f4\u63a5\u62d2\u7edd\u63d2\u5165\u3002 \u5229\u7528\u4e86\u6570\u636e\u5e93\u6216\u8005redis\u4e00\u4e2a\u7ea6\u675f\u63a7\u5236\u6765\u8fbe\u5230\u4e86\u6d88\u606f\u7684\u5e42\u7b49</p> <p>\u65b9\u68482</p> <p>\u8bbe\u7f6e\u524d\u7f6e\u6761\u4ef6</p> <p>\u6bd4\u5982\u8bf4\u5728\u6d88\u8d39\u7aef\u5904\u7406\u4e4b\u524d, \u67e5\u8be2\u4e00\u4e0b\u6570\u636e\u5e93.\u5224\u65ad\u8ba2\u5355\u53f7,\u5bf9\u5e94\u7684\u79ef\u5206\u5956\u52b1\u5230\u5e95\u6709\u6ca1\u6709\u53d1\u653e\u6210\u529f. \u5982\u679c\u53d1\u653e\u6210\u529f\u4e86,\u90a3\u4e48\u5c31\u4e0d\u518d\u8fdb\u884c\u91cd\u590d\u5956\u52b1. \u5f53\u7136\u8fd9\u4e2a\u67e5\u8be2\u8981\u52a0\u4e00\u4e2a\u5206\u5e03\u5f0f\u9501, \u9632\u6b62\u51fa\u73b0\u5e76\u53d1\u7684\u64cd\u4f5c. </p> <p>\u5229\u7528\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u67e5\u8be2\u5904\u7406, \u5e38\u8bf4\u7684\u6570\u636e\u5e93\u7248\u672c\u53f7.  \u7ed9\u5f53\u524d\u8981\u5904\u7406\u7684\u6570\u636e, \u8bbe\u7f6e\u4e00\u4e2a\u7248\u672c\u53f7\u5c5e\u6027.  \u5982\u679c\u5904\u7406\u8fc7\u4e86, \u7248\u672c\u53f7\u5c31\u52a0\u4e00.</p> <p>\u5728\u66f4\u65b0\u5904\u7406\u72b6\u6001\u7684\u65f6\u5019,  \u4f1a\u5bf9\u6bd4\u7248\u672c\u53f7.  \u5982\u679c\u4e0d\u4e00\u81f4\u8bf4\u660e\u5df2\u7ecf\u5904\u7406\u8fc7\u4e86. \u91cd\u590d\u7684\u6d88\u606f, \u5c31\u4e0d\u518d\u8fdb\u884c\u76f8\u5e94\u7684\u5904\u7406. \u4e5f\u662f\u6570\u636e\u5e93\u4e50\u89c2\u9501\u7684\u5b9e\u73b0\u65b9\u5f0f\u4e4b\u4e00</p> <p>\u65b9\u68483</p> <p>\u5229\u7528\u4e86\u6570\u636e\u7684\u7248\u672c\u53f7\uff0c\u5229\u7528\u7ed9\u6d88\u606f\u8bbe\u7f6e\u4e00\u4e2a\u5168\u5c40\u7684ID. \u5176\u4ed6\u7684\u91cd\u590d\u6d88\u606f\u5c31\u76f4\u63a5\u62d2\u7edd</p> <p>\u4e5f\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528\uff0c \u6bd4\u5982\u8bf4\u6570\u636e\u5e93\u7684\u8fd9\u4e2aunique\u7d20\u5f15\uff0c \u8ddf\u524d\u7f6e\u6761\u4ef6\u7684\u8fd9\u4e2a\u5224\u65ad\u3002 \u679c\u524d\u7f6e\u7684\u6761\u4ef6\u51fa\u73b0\u4e86\u4e00\u4e9b\u6f0f\u7f51\u4e4b\u9c7c\uff0c \u5728\u6570\u636e\u5e93\u5c42\u7684\u8fd9\u4e2aunique\u7d22\u5f15\u5462</p>"},{"location":"chap7/Arch_anws/#5","title":"5 \u6d88\u606f\u961f\u5217 \u5982\u4f55\u89e3\u51b3\u6d88\u606f\u4e22\u5931\u95ee\u9898","text":"<p>\u6d88\u606f\u4e22\u5931\uff0c\u5f88\u591a\u73b0\u5728\u4e3b\u6d41\u7684\u6d88\u606f\u961f\u5217\u3002\u7c7b\u4f3c\u4e8e rabbitmq, kafka, rocketmq\u4e5f\u90fd\u63d0\u4f9b\u4e86\u6bd4\u8f83\u5b8c\u5584\u7684\u8fd9\u4e2a\u6d88\u606f\u53ef\u9760\u7684\u4fdd\u969c\u673a\u5236\u3002 \u5b8c\u5168\u53ef\u4ee5\u505a\u5230\u5728\u6d88\u606f\u4f20\u9012\u7684\u8fc7\u7a0b\u4e2d\uff0c \u5982\u679c\u786c\u4ef6\u7684\u6545\u969c\uff0c \u7f51\u7edc\u4e2d\u65ad\u4e5f\u80fd\u786e\u4fdd\u6d88\u606f\u7684\u53ef\u9760\u4f20\u9012\u3002 </p> <p>\u4e3a\u4e86\u4e0d\u4e22\u6d88\u606f\uff0c\u867d\u7136\u4e0d\u540c\u7684\u6d88\u606f\u961f\u5217\u63d0\u4f9b\u7684API\u4e0d\u4e00\u6837, \u76f8\u5173\u7684\u914d\u7f6e\u9879\u4e5f\u4e0d\u4e00\u6837. \u4f46\u662f\u5b9e\u73b0\u7684\u539f\u7406\u57fa\u672c\u662f\u4e00\u81f4\u7684\u3002\u90fd\u662f\u901a\u8fc73\u4e2a\u9636\u6bb5\u6765\u4fdd\u969c</p> <ul> <li>\u4e00\u4e2a\u662f\u5728\u6d88\u606f\u7684\u751f\u4ea7\u9636\u6bb5<ul> <li>\u5728\u751f\u4ea7\u9636\u6bb5\uff0c\u6d88\u606f\u961f\u5217\u662f\u901a\u8fc7\u5e38\u7528\u7684\u8bf7\u6c42\u786e\u8ba4\u673a\u5236\u3002 \u6765\u4fdd\u969c\u6d88\u606f\u7684\u53ef\u9760\u4f20\u9012\u7684\u3002\u5f53\u4ee3\u7801\u8c03\u7528\u53d1\u6d88\u606f\u7684\u65b9\u6cd5\uff0c\u6d88\u606f\u961f\u5217\u5c31\u4f1a\u628a\u6d88\u606f\u53d1\u9001\u5230broker, \u90a3\u4e48broker\u6536\u5230\u6d88\u606f\u4e4b\u540e, \u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u786e\u8ba4\u54cd\u5e94. \u8868\u660e\u6d88\u606f\u5df2\u7ecf\u6536\u5230\u4e86 </li> <li>\u6709\u4e9b\u6d88\u606f\u961f\u5217, \u5728\u957f\u65f6\u95f4\u6ca1\u6536\u5230, \u8fd9\u4e2a\u786e\u8ba4\u54cd\u5e94\u4e4b\u540e. \u4f1a\u81ea\u52a8\u91cd\u8bd5\u6765\u505a\u4e00\u4e2a\u6d88\u606f\u8865\u507f, \u4ee5\u786e\u4fdd\u6d88\u606f\u80fd\u591f\u6b63\u5e38\u7684\u53d1\u9001\u5230\u7684broker\u4e2d. </li> </ul> </li> <li>\u4e00\u4e2a\u662f\u5728\u6d88\u606f\u7684\u5b58\u50a8\u9636\u6bb5<ul> <li>\u5728\u5b58\u50a8\u9636\u6bb5, \u5176\u5b9e\u4e00\u822c\u6d88\u606f\u4e0d\u4f1a\u4e1f. \u9664\u975e\u51fa\u73b0\u4e86\u4e00\u4e9b\u786c\u4ef6\u6545\u969c\u3002 \u6bd4\u5982\u8bf4\u8fdb\u7a0b\u6302\u6389\u4e86\u6216\u8005\u662f\u670d\u52a1\u5668\u5b95\u673a\u4e86\u3002\u90a3\u8fd9\u79cd\u60c5\u51b5\u5462\u53ef\u80fd\u662f\u4f1a\u4e1f\u6d88\u606f\u7684</li> <li>\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c \u505a\u4e00\u4e9b\u6301\u4e45\u5316\u7684\u5b58\u50a8\u3002 \u8fd9\u4e2a\u6d88\u606f\u961f\u5217\u4e5f\u4f1a\u63d0\u4f9b\u4e00\u4e9b\u76f8\u5e94\u7684\u5237\u5c4f\u914d\u7f6e\u3002 \u4e0d\u7528\u53bb\u624b\u5de5\u7684\u5199\u4ee3\u7801\u5904\u7406\uff0c\u5b58\u50a8\u7684braker\u6302\u6389\uff0c \u90a3\u4e48\u6d88\u606f\u5462\u4e5f\u4e0d\u4f1a\u4e1f\uff0c\u91cd\u542f\u4e4b\u540e\u53ef\u4ee5\u7ee7\u7eed\u5904\u7406\u6d88\u606f\u3002 </li> </ul> </li> <li>\u6d88\u606f\u7684\u6d88\u8d39\u9636\u6bb5\uff0c\u8ddf\u751f\u4ea7\u9636\u6bb5\u5176\u5b9e\u662f\u5dee\u4e0d\u591a\u3002 \u4e5f\u90fd\u662f\u901a\u8fc7ack\u7684\u786e\u8ba4\u673a\u5236\uff0c\u6765\u786e\u4fdd\u6d88\u606f\u7684\u53ef\u9760\u4f20\u9012\u3002 \u4ecebroker\u62c9\u53d6\u6d88\u606f\u4e4b\u540e, \u7136\u540e\u53d1\u9001\u5230\u6d88\u8d39\u7aef\u53bb\u5904\u7406 \u5904\u7406\u5b8c\u6210\u4e4b\u540e, \u5728\u7ed9\u4e2a\u56de\u8c03\uff0c\u544a\u77e5broker\u5df2\u7ecf\u6d88\u8d39\u5b8c\u6210<ul> <li>\u5982\u679cbroker\u6ca1\u6709\u6536\u5230\u6d88\u606f\u786e\u8ba4\u7684\u54cd\u5e94, \u4e5f\u4f1a\u8fdb\u884c\u6d88\u606f\u7684\u8865\u507f,\u8fd8\u4f1a\u53d1\u9001\u540c\u4e00\u6761\u6d88\u606f\u786e\u4fdd, \u6d88\u606f\u4e0d\u4f1a\u5728\u7f51\u7edc\u4f20\u8f93\u7684\u8fc7\u7a0b\u4e2d\u4e22\u5931</li> </ul> </li> </ul> <p>\u603b\u7ed3\u4e0b\u6765\u4fdd\u969c\u6d88\u606f\u4e0d\u4e1f\u5931\u7684\u7b56\u7565</p> <ul> <li>\u751f\u4ea7\u9636\u6bb5\uff0c\u6d88\u8d39\u9636\u6bb5\u7684Ack\u786e\u8ba4\u673a\u5236</li> <li>\u5b58\u50a8\u9636\u6bb5\u554a\u6301\u4e45\u5316\u5b58\u50a8\u7684\u914d\u7f6e</li> </ul>"},{"location":"chap7/Arch_anws/#6_1","title":"6 \u5982\u4f55\u68c0\u6d4b\u6d88\u606f\u4e22\u5931\u8c08\u8c08\u6d88\u606f\u4e22\u5931\u7684\u515c\u5e95\u65b9\u6848","text":"<p>\u53ef\u4ee5\u5229\u7528\u62e6\u622a\u5668\u7684\u673a\u5236\uff0c \u5728\u751f\u4ea7\u7aef\u9650\u53d1\u9001\u6d88\u606f\u4e4b\u524d\uff0c \u901a\u8fc7\u62e6\u622a\u5668\u5c06\u6d88\u606f\u7248\u672c\u53f7\u6ce8\u5165\u5230\u6d88\u606f\u4e2d\u3002 </p> <p>\u90a3\u7248\u672c\u53f7\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u8fde\u7eed\u9012\u589e\u7684ID\u751f\u6210\uff0c \u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u5206\u5e03\u5f0f\u7684\u5168\u533aID\uff0c\u5728\u6d88\u8d39\u7aef\u6536\u5230\u4e86\u6d88\u606f\u4e4b\u540e\uff0c \u518d\u901a\u8fc7\u62e6\u622a\u5668\u628a\u7248\u672c\u53f7\u8bb0\u5f55\u4e0b\u6765\uff0c\u518d\u901a\u8fc7\u62e6\u622a\u5668\u628a\u7248\u672c\u53f7\u8bb0\u5f55\u4e0b\u6765\u3002 </p> <p>\u5982\u679c\u68c0\u6d4b\u8fd9\u4e2a\u7248\u672c\u53f7\u8fde\u7eed\u6027\u6216\u8005\u4ed6\u7684\u6d88\u8d39\u72b6\u6001\uff0c\u6765\u5224\u65ad\u5230\u5e95\u6709\u6ca1\u6709\u4e22\u6d88\u606f\u3002 \u5982\u679c\u4e1f\u4e86\u6d88\u606f\uff0c\u90a3\u4e48\u53ef\u4ee5\u518d\u8fdb\u884c\u8fd9\u4e2a\u6d88\u606f\u7684\u8865\u507f\uff0c\u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662f\u5e38\u8bf4\u7684AOP\uff0c \u90a3\u4e48aop\u7684\u4f18\u52bf\uff0c\u4e0d\u7528\u4fb5\u5165\u5230\u5177\u4f53\u7684\u4e1a\u52a1\u4ee3\u7801\u4e2d\u3002 \u8026\u5408\u5ea6\u6bd4\u8f83\u4f4e\u3002</p> <p>\u53e6\u5916\u4e00\u4e2a\u65b9\u6848\u6bd4\u8f83\u7b80\u5355\uff0c \u6839\u636e\u72b6\u6001\uff0c\u6d88\u8d39\u9001\u79ef\u5206\u7684\u4f8b\u5b50\u3002\u5b9a\u671f\u53bb\u68c0\u67e5\u5230\u5e95\u6709\u6ca1\u6709\u6210\u529f\u6536\u5230\u79ef\u5206\u3002 \u770b\u8fd9\u4e2a\u72b6\u6001\u7801\u7684\u53d8\u5316\uff0c \u5982\u679c\u6ca1\u53d8\uff0c\u90a3\u5c31\u8bf4\u660e\u6211\u4eec\u6d88\u606f\u5904\u7406\u5931\u8d25\u4e86\u6216\u8005\u662f\u4e1f\u4e86\u6216\u8005\u5176\u4ed6\u4ec0\u4e48\u539f\u56e0\u3002 </p> <p>\u90a3\u5c31\u9700\u8981\u989d\u5916\u7684\u53bb\u5904\u7406\uff0c \u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u5b9a\u65f6\u4efb\u52a1\u3002\u90a3\u4e48\u6bcf\u9694\u51e0\u5206\u949f\uff0c\u53ef\u4ee5\u53bb\u5b9a\u671f\u7684\u68c0\u67e5\u9001\u79ef\u5206\u8fd9\u4e2a\u6d88\u8d39\u60c5\u6cc1\u3002 \u90a3\u4e48\u4e00\u6709\u5f02\u5e38\uff0c \u5c31\u53ef\u4ee5\u8fdb\u884c\u989d\u5916\u7684\u5904\u7406\uff0c\u7136\u540e\u53bb\u53d8\u66f4\u5904\u7406\u72c0\u6001.</p> <p>\u9632\u6b62\u6d88\u606f\u4e1f\u5931\u7684\u515c\u5e95\u65b9\u6848\uff0c\u4e24\u4e2a\u65b9\u9762</p> <ul> <li>\u4e00\u4e2a\u662f\u68c0\u6d4b\u6211\u4eec\u7684\u7248\u672c\u53f7\u7684\u8fde\u7eed\u6027, \u6709\u4e0d\u8fde\u7eed\u7684\u8bf4\u660e\u8fd9\u4e2a\u4e22\u4e86\u6d88\u606f</li> <li>\u53e6\u5916\u4e00\u4e2a\u5462\u662f\u6839\u636e\u8ba2\u5355\u7684\u72b6\u6001\u7801, \u5982\u679c\u6ca1\u6709\u53d8\u66f4, \u90a3\u5c31\u8bf4\u660e\u9700\u8981\u8fdb\u884c\u989d\u5916\u7684\u5904\u7406. \u6765\u4fdd\u969c\u6211\u4eec\u7684\u6b63\u5e38\u8fd0\u8f6c</li> </ul>"},{"location":"chap7/Arch_anws/#7_1","title":"7 \u6d88\u606f\u961f\u5217\u5982\u4f55\u4fdd\u8bc1\u987a\u5e8f\u6d88\u8d39","text":"<p>\u5206\u5e03\u5f0f\u67b6\u6784\uff0c\u6d88\u606f\u9700\u8981\u5206\u53d1\u7ed9\u591a\u4e2a\u6d88\u8d39\u8005\u9700\u8981\u540c\u65f6\u5904\u7406\u3002 </p> <p>\u6d88\u606f\u961f\u5217\u4e2d\u7684\u6d88\u606f\u5c31\u4e0d\u80fd\u4fdd\u8bc1\uff0c\u65e0\u6cd5\u4fdd\u8bc1\u6d88\u8d39\u7684\u987a\u5e8f\u6027\u3002 </p> <p>\u90a3\u600e\u4e48\u89e3\u6c7a\uff0c\u5173\u952e\u5462\u5c31\u5728\u4e8e\u5728\u6d88\u8d39\u8005\u6d88\u8d39\u4e4b\u524d\uff0c\u5c06\u6709\u76f8\u5173\u6027\u7684\u8fd9\u4e2a\u6570\u636e\uff0c\u987a\u5e8f\u7684\u5199\u5165\u5230\u540c\u4e00\u4e2a\u961f\u5217\u4e2d\u540c\u4e00\u4e2a\u8ba2\u5355\u7684\u79ef\u5206\u5904\u7406\u3002 </p> <p>\u77ed\u4fe1\u53d1\u9001\u5fc5\u987b\uff0c\u8fdb\u5165\u540c\u4e00\u4e2a\u961f\u5217\u4e2d\u3002 \u90a3\u4e48\u4e3a\u4e86\u5206\u538b\uff0c\u961f\u5217\u53ef\u4ee5\u5206\u6210\u597d\u51e0\u5341\u4e2a\uff0c Hash\uff0c\u53d6\u6a21\u3002 </p> <p>\u5148\u5206\u597d\u5bf9\u5217\u4fdd\u8bc1\u76f8\u5173\u7684\u6570\u636e\u8fdb\u5165\u5230\u540c\u4e00\u4e2a\u5bf9\u5217\u4e2d\u3002 \u7136\u540e\u5462\u5728\u6d88\u8d39\u7aef\uff0c \u4e00\u4e2aqueue\u5bf9\u5e94\u4e00\u4e2a\u6d88\u8d39\u7aef\u3002 </p> <p>\u6bd4\u5982\u8bf4\u961f\u5217\uff0c1-5 \u5bf9\u5e94\u6d88\u8d39\u7aefa\u7684\u8fd9\u4e2a5\u4e2a\u6d88\u8d39\u65b9\u6cd5\uff0c \u961f\u52176-10\u5bf9\u5e94\u6d88\u8d39\u7aefb\u7684\u4e94\u4e2a\u6d88\u8d39\u65b9\u6cd5\u3002</p> <p>\u53ef\u4ee5\u91c7\u7528\u591a\u4e2a\u8fd9\u4e2a\u5185\u5b58\u961f\u5217\uff0c\u6bd4\u5982\u8bf4\u8fd9\u4e2a\u540c\u4e00\u4e2a\u8ba2\u5355\u7684\u6d88\u606f\uff0c \u53ef\u4ee5\u8fdb\u5165\u540c\u4e00\u4e2a\u5185\u5b58\u5bf9\u5217\u4e2d\uff0c \u90a3\u4e48\u5904\u7406\u5b8c\u4e86\u5c31\u91ca\u653e\u8be5\u7ebf\u7a0b\uff0c\u90a3\u4e48\u4e5f\u80fd\u591f\u4fdd\u8bc1\u3002</p> <p>\u5728\u591a\u7ebf\u7a0b\u4e0b\u7684\u8fd9\u4e2a\u987a\u5e8f\u5904\u7406\uff0c\u8fd9\u4e2a\u6d88\u606f\u961f\u5217\u7684\u6570\u636e\u6d88\u8d39\u95ee\u9898\u3002 \u53ea\u8981\u4fdd\u8bc1\u4e00\u70b9\u5c31\u662f\u76f8\u5173\u6027\u7684\u6570\u636e\u9700\u8981\u6309\u987a\u5e8f\u3002 \u5199\u5165\u540c\u4e00\u4e2a\u961f\u5217\u4e2d\uff0c\u4fdd\u8bc1\u540c\u4e00\u4e2a\u6d88\u8d39\u7aef\u6d88\u8d39\u5c31\u53ef\u4ee5\u4e86</p>"},{"location":"chap7/Arch_anws/#8_2","title":"8 \u6d88\u606f\u961f\u5217\u987a\u5e8f\u6d88\u8d39\u7684 \u5e94\u7528\u573a\u666f\u53ca\u89e3\u51b3\u65b9\u6848","text":"<p>\u6570\u636e\u540c\u6b65\u7684\u8fc7\u7a0b\u4e2d, \u5c31\u4f1a\u53d1\u751f\u5148\u53d6\u6d88\u8ba2\u5355, \u7136\u540e\u518d\u4e0b\u5355\u7684\u573a\u666f. \u62c6\u5206\u591a\u4e2aqueue. \u6309\u7167\u8ba2\u5355\u53f7\u53d6\u6a21, Hash\u7684\u65b9\u5f0f\u5206\u6210\u591a\u4e2aqueue. </p> <p></p> <p>\u540c\u4e00\u4e2a\u8ba2\u5355\u53f7\u7684\u4e0b\u5355, \u53d6\u6d88\u8ba2\u5355\u7684\u6d88\u606f, \u8fdb\u5165\u540c\u4e00\u4e2aqueue\u4e2d. \u4e5f\u5c31\u662f\u591a\u4e86\u4e00\u4e9bqueue\u800c\u5df2, \u4e00\u4e2aqueue\u4e00\u4e2aconsumer\u3002</p> <p>queue\u4e2d\u7684\u6d88\u606f\u53c8\u662f\u987a\u5e8f\u7684\uff0c\u6d88\u8d39\u8005\u5c31\u4f1a\u5148\u53d6\u4e0b\u5355\u7684\u6d88\u606f\uff0c\u518d\u53d6\u8ba2\u5355\u53d6\u6d88\u7684\u6d88\u606f\uff0c\u8fd9\u6837\u7684\u8bdd\u5c31\u80fd\u4fdd\u8bc1\u6d88\u606f\u7684\u8fd9\u4e2a\u987a\u5e8f\u6d88\u8d39</p> <p>\u5728\u6d88\u606f\u961f\u5217\u4e2d\u591a\u6761\u8fd9\u4e2a\u77ed\u4fe1\u9a8c\u8bc1\u7801\u7684\u53d1\u9001\u8bf7\u6c42\uff0c \u90a3\u4e48\u4e3a\u4e86\u4fdd\u8bc1\u8fd9\u4e2a\u6821\u9a8c\u7684\u51c6\u786e\u6027\uff0c\u5c31\u5fc5\u987b\u4fdd\u8bc1\u540c\u4e00\u4e2a\u7528\u6237\u540c\u4e00\u4e2a\u573a\u666f\uff0c\u77ed\u4fe1\u9a8c\u8bc1\u7801\u7684\u987a\u5e8f\u6027\uff0c\u89e3\u51b3\u65b9\u6848\u4e5f\u8ddf\u8ba2\u5355\u7684\u573a\u666f\u7c7b\u4f3c \u5c31\u662f\u6309\u7167\u7528\u6237\u7684ID\u53d6\u6a21\uff0c\u6216\u8005Hash\u7684\u65b9\u5f0f\u53d6\u6a21\uff0c\u5206\u6210\u591a\u4e2aqueue.  \u90a3\u4e48\u540c\u4e00\u4e2a\u7528\u6237\u540c\u4e00\u4e2a\u573a\u666f\u53d1\u9001\u9a8c\u8bc1\u7801, \u8fdb\u5165\u540c\u4e00\u4e2aqueue\u4e2d\u3002 </p> <p>\u7136\u540e\u4e00\u4e2aqueue\uff0c \u4e00\u4e2aconsumer, \u8fd9\u6837\u7684\u8bdd\u4e5f\u5c31\u80fd\u4fdd\u8bc1\u6d88\u8d39\u7684\u8fd9\u4e2a\u987a\u5e8f\u6027\u3002 \u4fdd\u969c\u6d88\u606f\u987a\u5e8f\u6d88\u8d39\u7684\u4e5f\u5c31\u4e24\u4e2a\u6b65\u9aa4</p> <ul> <li>\u4e00\u4e2a\u662f\u9700\u8981\u987a\u5e8f\u6d88\u8d39\u7684\uff0c\u76f8\u5173\u6d88\u606f\u8fdb\u5165\u540c\u4e00\u4e2aqueue\u4e2d\uff0c\u90a3\u4e48\u4e3a\u4e86\u5206\u538b\uff0c \u53ef\u4ee5\u62c6\u5206\u6210\u591a\u4e2aqueue\u3002 \u90a3\u4e48\u5176\u5b9e\u5c31\u662f\u591a\u4e86\u4e00\u4e9bqueue\u800c\u5df1\uff0c </li> <li>\u800c\u662f\u8981\u4fdd\u8bc1\u4e00\u4e2aqueue \u4e00\u4e2a consumer</li> </ul>"},{"location":"chap7/Arch_anws/#9_2","title":"9 \u51fa\u73b0\u4e86\u6d88\u606f\u79ef\u538b\u8be5\u5982\u4f55\u89e3\u51b3","text":"<p>\u6d88\u606f\u961f\u5217\u4e2d\u7684\u6d88\u606f\u90fd\u662f\u5b58\u653e\u5728\u5185\u5b58\u4e2d\u3002 \u5982\u679c\u51fa\u73b0\u4e86\u8fd9\u8fc7\u91cf\u7684\u6d88\u606f\u79ef\u538b\uff0c \u5c31\u4f1a\u5f15\u8d77\u5185\u5b58\u6216\u8005\u78c1\u76d8\u7684\u544a\u8b66\uff0c\u4ece\u800c\u9020\u6210\u54cd\u5e94\u8d85\u65f6\u8fde\u63a5\u963b\u585e\uff0c \u7136\u540e\u8fd8\u4f1a\u5f71\u54cd\u5230\u5176\u4ed6\u961f\u5217\u7684\u4f7f\u7528\uff0c\u5bfc\u81f4\u6574\u4f53\u7684\u670d\u52a1\u4e0d\u53ef\u7528</p> <p>\u4e3a\u4ec0\u4e48\u4f1a\u51fa\u73b0\u6d88\u606f\u79ef\u538b\uff1f</p> <p>\u8fd9\u4e2a\u6d88\u606f\u961f\u5217\u6709\u751f\u4ea7\u7aef\u6709\u6d88\u8d39\u7aef\uff0c \u4e00\u4e2a\u8fdb\u4e00\u4e2a\u51fa\uff0c \u90a3\u4e48\u5982\u679c\u51fa\u73b0\u4e86\u79ef\u538b\u3002</p> <ul> <li>\u8981\u4e48\u5c31\u662f\u8fdb\u7684\u592a\u5feb\uff0c \u751f\u4ea7\u7aef\u4ea7\u751f\u7684\u6d88\u606f\u592a\u591a\u3002 </li> <li>\u8981\u4e48\u5c31\u662f\u51fa\u7684\u592a\u6162\uff0c \u6d88\u8d39\u7aef\u6765\u4e0d\u53ca\u6d88\u8d39\uff0c\u5c31\u4f1a\u4ea7\u751f\u8fc7\u591a\u7684\u6d88\u606f\u79ef\u538b\u5728\u961f\u5217\u4e2d</li> </ul> <p>\u89e3\u51b3\u65b9\u6848\uff0c \u4e5f\u5c31\u662f\u4ece\u8fd9\u4e24\u4e2a\u65b9\u9762\u5165\u624b\uff0c </p> <ul> <li>\u9650\u5236\u751f\u4ea7\u8005\u4ea7\u751f\u6d88\u606f</li> <li>\u52a0\u5feb\u6d88\u8d39\u7aef\u6d88\u8d39\u6d88\u606f</li> </ul> <p>\u52a0\u5feb\u6d88\u8d39\u7aef\u6d88\u8d39\u6d88\u606f\uff0c\u9650\u5236\u751f\u4ea7\u8005\u4ea7\u751f\u6d88\u606f\uff0c\u5176\u5b9e\u5c31\u662f\u7684\u9650\u6d41\u7194\u65ad\u548c\u964d\u7ea7</p> <ul> <li>\u4e00\u90e8\u5206\u6d41\u91cf\u901a\u8fc7\u9650\u6d41\u7b97\u6cd5\uff0c\u7194\u65ad\u7b56\u7565\uff0c\u6bd4\u5982\u8bf4\u5e38\u89c1\u7684\u8fd9\u4e2a\u4ee4\u724c\u6876\u7b97\u6cd5\u3002 \u5148\u8ba9\u4e00\u90e8\u5206\u7528\u6237\u8fdb\u6765\uff0c \u5176\u4ed6\u7684\u7528\u6237\u5728\u5916\u9762\u6392\u961f\uff0c\u7b49\u7cfb\u7edf\u53d1\u653e\u4e86\u4ee4\u724c\u518d\u8ba9\u4ed6\u8fdb\u6765\u3002\u8fd9\u4e2a\u662f\u9650\u6d41</li> <li>\u7194\u65ad\u5c31\u662f\u7cfb\u7edf\u538b\u529b\u8fc7\u5927\uff0c\u8bf7\u6c42\u51fa\u73b0\u4e86\u8d85\u65f6\u6216\u8005\u54cd\u5e94\u5931\u8d25\uff0c \u8fbe\u5230\u4e00\u5b9a\u7684\u6b21\u6570\uff0c\u5c31\u4f1a\u81ea\u52a8\u89e6\u53d1\u7194\u65ad\uff0c\u65ad\u5f00\u670d\u52a1\uff0c\u7136\u540e\u5bf9\u5916\u8fd4\u56de\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff0c \u8fd9\u662f\u751f\u4ea7\u7aef\u7684\u4e00\u4e9b\u4e3e\u63aa</li> </ul> <p>\u6838\u5fc3\u5c31\u662f\u964d\u4f4e\u6d41\u91cf\uff0c\u628a\u8fd9\u4e2a\u4e00\u90e8\u5206\u7528\u6237\u6321\u5728\u5916\u9762\u3002\u5c31\u5728\u6d88\u606f\u79ef\u538b\u7684\u6e90\u5934\u4e0a\u9762\u505a\u4e86\u9650\u5236\u3002 </p> <p>\u6d88\u8d39\u7aef</p> <p>\u6d88\u8d39\u7aef\u7684\u4f18\u5316\u7b56\u7565\u5c31\u662f\u52a0\u5feb\u6d88\u606f\u7684\u6d88\u8d39\u901f\u5ea6\uff0c </p> <ul> <li>\u9996\u5148\u6d88\u8d39\u7aef\u53ef\u4ee5\u505a\u6269\u5bb9\uff0c\u591a\u4e2a\u6d88\u8d39\u7aef\u540c\u65f6\u6765\u6d88\u8d39\u6d88\u606f\uff0c\u8fd9\u5c31\u76f8\u5f53\u4e8e\u505a\u4e86\u4e00\u4e2a\u6a2a\u5411\u6269\u5c55\u3002</li> <li>\u5982\u679c\u4e1a\u52a1\u4ee3\u7801\u5904\u7406\u6bd4\u8f83\u6162\u3002 \u53ef\u80fd\u662f\u9700\u8981\u53bb\u4f18\u5316\u4e00\u4e0b\u4ee3\u7801\u7684\u903b\u8f91\uff0c\u4ece\u4ee3\u7801\u5c42\u9762\u6765\u505a\u4e00\u4e9b\u4f18\u5316</li> <li>\u5982\u679c\u74f6\u9888\u51fa\u73b0\u5728\u6570\u636e\u5e93\uff0c \u5b58\u5e93\u6bd4\u8f83\u6162\u3002\u53ef\u4ee5\u5148\u5b58\u5728redis\u4e2d\uff0c\u7136\u540e\u7b49\u5230\u4e1a\u52a1\u4e0d\u5fd9\u7684\u65f6\u5019\uff0c\u518d\u4eceredis\u4e2d\u628a\u76f8\u5173\u7684\u8fd9\u4e2a\u6570\u636e\u6301\u4e45\u5316\u5230\u6211\u4eec\u7684\u6570\u636e\u5e93\u91cc\u9762</li> </ul> <p>\u603b\u7ed3\uff1a \u89e3\u6c7a\u6d88\u606f\u79ef\u538b\u65e0\u975e\u5c31\u4e24\u4e2a\u65b9\u6848</p> <ul> <li>\u4e00\u4e2a\u662f\u505a\u597d\u9650\u6d41\uff0c\u5728\u6e90\u5934\u4e0a\u9762\u9632\u6b62\u8fc7\u591a\u7684\u8bf7\u6c42\u8fdb\u6765\uff0c\u9020\u6210\u6d88\u606f\u79ef\u538b\uff0c\u8981\u4e48\u6269\u5bb9\uff0c\u8981\u4e48\u5c31\u4f18\u5316\u4ee3\u7801</li> <li>\u8981\u4e48\u5c31\u662f\u6539\u53d8\u6211\u4eec\u7684\u5b58\u50a8\u7b56\u7565\uff0c\u5728\u6d88\u8d39\u7aef\u7684\u74f6\u9888\u4e0a\u9762\u6765\u4e0b\u529f\u592b</li> </ul>"},{"location":"chap7/Arch_anws/#10_1","title":"10 \u6d88\u606f\u961f\u5217\u4e2d\u7684\u6b7b\u4fe1\u961f\u5217\u53ca\u5e94\u7528\u573a\u666f","text":"<p>\u4ec0\u4e48\u662f\u6b7b\u4fe1\u961f\u5217\uff0c\u5c31\u662f\u6d88\u606f\u961f\u5217\u4e2d\u65e0\u6cd5\u6d88\u8d39\u7684\u6d88\u606f\u3002 \u6bd4\u5982\u8bf4\u8fd9\u4e2a\u6d88\u606f\u8fc7\u671f\u4e86\uff0c\u5c31\u4f1a\u88ab\u8fd9\u4e2a\u6d88\u606f\u5bf9\u5217\u4ece\u539f\u6709\u7684\u5bf9\u5217\u4e2d\u5220\u9664\uff0c\u7136\u540e\u5c31\u8f6c\u5230\u4e86\u8fd9\u4e2a\u6b7b\u6027\u961f\u5217, \u518d\u901a\u8fc7\u6d88\u8d39\u7aef\u6765\u6d88\u8d39\u8fd9\u4e9b\u6b7b\u6389\u7684\u6d88\u606f</p> <p>\u8fd9\u5c31\u662f\u6b7b\u4fe1\u961f\u5217\u7684\u4e00\u4e2a\u539f\u7406, \u9488\u5bf9\u6d88\u606f\u79ef\u538b\u7684\u573a\u666f\u3002</p> <p>\u9996\u5148\u8981\u8bbe\u7f6e\u6d88\u606f\u7684\u8fc7\u671f\u65f6\u95f4\uff0c \u8fd9\u4e9b\u6d88\u606f\u5c31\u4f1a\u88ab\u81ea\u52a8\u7684\u8f6c\u79fb\u5230\u6b7b\u4fe1\u961f\u5217\uff0c\u4ed6\u4e0d\u4f1a\u957f\u65f6\u95f4\u7684\u5728\u8fd9\u4e2a\u4e1a\u52a1\u961f\u5217\u4e2d\u5b58\u5728\uff0c\u5c31\u80fd\u591f\u907f\u514d\u6d88\u606f\u957f\u65f6\u95f4\u7684\u5b58\u653e\u5728\u961f\u5217\u4e2d\uff0c\u4e5f\u5c31\u80fd\u591f\u907f\u514d\u8fd9\u4e2a\u6d88\u606f\u79ef\u538b\u800c\u4e14\u8fc7\u671f\u7684\u6d88\u606f\u4e5f\u6ca1\u6709\u4e22\uff0c\u8fdb\u5165\u4e86\u6b7b\u4fe1\u961f\u5217\u7ee7\u7eed\u6d88\u8d39\u3002</p> <p>\u76f8\u5f53\u4e8e\u591a\u4e86\u4e2a\u5206\u538b\u7684\u961f\u5217\uff0c\u6240\u4ee5\u914d\u7f6e\u6b7b\u4fe1\u5bf9\u5217\u4e5f\u662f\u53ef\u4ee5\u89e3\u6c7a\u8fd9\u4e2a\u6d88\u606f\u79ef\u538b\u7684\u95ee\u9898\u3002 </p> <p>\u8fd8\u53ef\u4ee5\u7528\u6765\u5904\u7406\u8fd9\u4e2a\u5ef6\u8fdf\u6d88\u606f\uff0c\u6682\u65f6\u5148\u4e0d\u60f3\u6d88\u8d39\u8fd9\u6761\u6d88\u606f\u3002 \u60f3\u7b495\u5206\u949f\u4e4b\u540e\u518d\u8ba9\u4ed6\u6d88\u8d39. </p> <p>\u4f8b\u5982\u5546\u57ce\u4e0b\u5355\uff0c\u53ef\u80fd\u6709\u4e9b\u7528\u6237\u6210\u529f\u4e0b\u5355\u4e86\uff0c \u4f46\u662f\u8fd9\u4e2a\u65f6\u5019\u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6b7b\u4fe1\u961f\u5217\u3002</p> <p>\u90a3\u4e48\u5728\u7528\u6237\u4e0b\u5355\u4e4b\u540e\uff0c \u53d1\u9001\u4e00\u6761\u9a8c\u8bc1\u6d88\u606f\uff0c\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u6bd4\u5982\u8bf415\u5206\u949f\u3002\u90a3\u4e48\u7b49\u5230\u65f6\u95f4\u8fc7\u4e86\u5c31\u81ea\u52a8\u7684\u8fdb\u5165\u6b7b\u4fe1\u961f\u5217\u3002 \u5728\u6d88\u8d39\u7aef\u53bb\u68c0\u67e5\u6709\u6ca1\u6709\u672a\u652f\u4ed8\u7684\u8ba2\u5355\uff0c\u8fd9\u4e2a\u4e5f\u662f\u5178\u578b\u7684\u901a\u8fc7\u6b7b\u4fe1\u961f\u5217\uff0c\u6765\u5b9e\u73b0\u8fd9\u4e2a\u5ef6\u8fdf\u6d88\u606f\u7684\u4f8b\u5b50\u3002</p>"},{"location":"chap7/Arch_anws/#11_1","title":"11 \u6d88\u606f\u961f\u5217\u8be5\u5982\u4f55\u9009\u578b\uff1f","text":"<ul> <li>\u53ef\u4e1a\u52a1\u91cf\u6bd4\u8f83\u5927\uff0c\u4f4e\u65f6\u5ef6\u7684\u8fd9\u4e2a\u573a\u666f\u8981\u6c42\u4e0b\u9762\uff0c\u5efa\u8bae\u662f\u9009\u7528racketmq</li> <li>\u9700\u8981\u5904\u7406\u5927\u6279\u91cf\u7684\u6570\u636e\u7684\u540c\u6b65, \u79bb\u7ebf\u8ba1\u7b97 ,\u5efa\u8bae\u9009\u62e9kafka</li> <li>\u4e00\u822c\u573a\u666f\u4e0b\u8003\u8651\u517c\u5bb9, \u96c6\u6210\u7684\u4fbf\u5229\u6027, \u5efa\u8bae\u8003\u8651rabbitmq</li> </ul>"},{"location":"chap7/Arch_anws/#12_1","title":"12 \u6d88\u606f\u961f\u5217\u4e2d\u7684\u4e8b\u52a1\u6d88\u606f\u5982\u4f55\u4fdd\u8bc1\u6570\u636e\u4e00\u81f4\u6027","text":"<p>\u540c\u6837\u5728\u6d88\u606f\u961f\u5217\u4e2d\u4e5f\u63d0\u4f9b\u4e86\u4e8b\u52a1\u7684\u529f\u80fd\uff0c\u540c\u6837\u4e5f\u662f\u4e3a\u4e86\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027</p> <p>\u5728\u4e0b\u5355\u7684\u4e1a\u52a1\u903b\u8f91\u4e4b\u524d\uff0c\u5148\u53d1\u9001\u4e00\u6761\u4e8b\u52a1\u6d88\u606f\u3002\u4f46\u662f\u8fd9\u4e2a\u6d88\u606f\u662f\u9690\u5f62\u7684\uff0c \u662f\u4e00\u79cd\u7279\u6b8a\u7684\u961f\u5217\uff0c\u7b49\u5230\u4ed6\u53d1\u9001\u6210\u529f\u4e4b\u540e\uff0c\u5c31\u4f1a\u901a\u77e5\u751f\u4ea7\u7aef\uff0c\u53ef\u4ee5\u5f00\u59cb\u4e0b\u5355\u7684\u4e1a\u52a1\u4e86\u3002</p> <p>\u8fd9\u4e2a\u65f6\u5019\u5982\u679c\u4e0b\u5355\u903b\u8f91\u5931\u8d25\u5c31\u5c31\u76f4\u63a5\u56de\u6eda\uff0c\u9690\u5f62\u6d88\u606f\u4e5f\u4f1a\u88ab\u5220\u9664. \u5982\u679c\u4e0b\u5355\u6210\u529f, \u90a3\u4e48\u5c31\u4f1a\u901a\u77e5\u6d88\u606f\u961f\u5217, \u5c06\u9690\u5f62\u7684\u6d88\u606f\u961f\u5217\u8f6c\u6210\u666e\u901a\u6d88\u606f\uff0c \u518d\u53d1\u7ed9\u8fd9\u4e2a\u6d88\u8d39\u7aef\u5b8c\u6210\u6d88\u8d39\u3002</p> <ul> <li>\u5c31\u662f\u5148\u8ba9\u6d88\u606f\u53d1\u9001\u51fa\u53bb\uff0c\u518d\u7b49\u5f85\u4e3b\u4f53\u4e1a\u52a1\u7684\u6267\u884c\u3002 \u5982\u679c\u5931\u8d25\u4e86\u5c31\u5168\u90e8rollback\u3002</li> <li>\u5982\u679c\u6210\u529f\uff0c \u6d88\u606f\u4e5f\u4e0d\u4f1a\u4e22\u5931\uff0c\u56e0\u4e3a\u4e3b\u4f53\u4e1a\u52a1\u5f00\u59cb\u4e4b\u524d\uff0c \u5df2\u7ecf\u53d1\u9001\u6210\u529f\u4e86\uff0c \u8fd9\u5c31\u662f\u4e00\u79cd\u7528\u4e8b\u52a1\u7684\u65b9\u5f0f\uff0c\u6765\u4fdd\u969c\u6d88\u606f\u4e0d\u4e22\u5931\u7684\u89e3\u51b3\u65b9\u6848</li> </ul> <p>ack\u7684\u4fdd\u969c\u673a\u5236\uff08\u9002\u5408\u5355\u4e00\u6d88\u606f\uff09</p> <p>\u53ef\u4ee5\u9632\u6b62\u6d88\u606f\u4e22\u5931\uff0c\u5728\u5927\u90e8\u5206\u7684\u573a\u666f\u4e0b\u3002\u5229\u7528\u6d88\u606f\u961f\u5217\u7684ack\u7406\u8bba\uff0c\u4e5f\u662f\u53ef\u4ee5\u4fdd\u8bc1\u6d88\u606f\u7684\u4e0d\u4e22\u5931\u3002\u4f46\u662f\u6d88\u606f\u961f\u5217\u5f15\u5165\u4e8b\u52a1\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u6d88\u606f\u4e00\u81f4\u6027\u65b9\u6848\u7684\u8865\u5145\u3002 </p> <p>\u5355\u4e00\u7684\u6d88\u606f\u53ef\u80fd\u770b\u4e0d\u51fa\u4ec0\u4e48\uff0c \u5982\u679c\u573a\u666f\u4e2d\u8981\u53d1\u9001\u591a\u6761\u6d88\u606f\u3002\u53ea\u6709\u901a\u8fc7\u4e8b\u52a1\u7684\u65b9\u5f0f\uff0c\u591a\u4e2a\u6d88\u606f\uff0c\u5982\u679c\u5176\u4e2d\u4e00\u4e2a\u6302\u4e86\u5c31\u4f1a\u5168\u90e8\u56de\u6eda\uff0c\u8981\u4e48\u5168\u90e8\u6210\u529f\u8981\u4e48\u5168\u90e8\u5931\u8d25\uff0c\u8fd9\u5c31\u662f\u4e8b\u52a1\u6bd4\u8f83\u597d\u7684\u65b9\u9762</p>"},{"location":"chap7/Arch_anws/#13_1","title":"13 \u5173\u4e8e\u6d88\u606f\u961f\u5217\u4e8b\u52a1\u4e00\u4e9b\u95ee\u9898\u7684\u89e3\u7b54","text":"<p>1 \u7531\u6d88\u606f\u961f\u5217\u53d1\u51fa\u7684\u8fd9\u4e2a\u9690\u85cf\u6d88\u606f\u662f\u4ec0\u4e48\u610f\u601d</p> <p>\u5176\u5b9e\u5f88\u591a\u7684\u6d88\u606f\u961f\u5217\u53c8\u53eb\u505a\u534a\u6d88\u606f, \u5c31\u662f\u6d88\u606f\u5462\u53ea\u6267\u884c\u4e86\u4e00\u534a\u7684\u529f\u80fd. \u5c31\u662f\u4ece\u8fd9\u4e2a\u751f\u4ea7\u7aef\u5230\u4e86\u6d88\u606f\u961f\u5217\u7684broker, \u8fd9\u4e2a\u65f6\u5019\u5462\u4e95\u4e0d\u662f\u4e00\u4e2a\u6b63\u5e38\u7684\u6d88\u606f, \u53ea\u662f\u5b58\u5728\u65e5\u5fd7\u4e2d\u7684\u4e00\u6761\u8bb0\u5f55\uff0c \u5728rocketmq\u91cc\u9762, \u8fd9\u4e2a\u65e5\u5fd7\u53eb\u505acommitlog.  \u90a3\u4e48\u7b49\u751f\u4ea7\u7aef\u7684\u4e1a\u52a1\u6267\u884c\u6210\u529f\u4e4b\u540e. \u518d\u4ece\u8fd9\u4e2acommitlog\u91cc\u9762\u628a\u8fd9\u4e2a\u76f8\u5173\u7684\u65e5\u5fd7\u8bb0\u5f55\u635e\u51fa\u6765</p> <p>\u90a3\u4e48\u6240\u8c13\u7684\u9690\u85cf\u6d88\u606f\u6216\u8005\u534a\u6d88\u606f\u5c31\u4f1a\u8f6c\u6210\u6b63\u5e38\u6d88\u606f, \u518d\u7531broker\u5462\u8f6c\u5230\u6d88\u8d39\u7aef\u8fdb\u884c\u6d88\u8d39,\u8fd9\u4e2a\u662f\u9690\u85cf\u6d88\u606f\u548c\u534a\u6d88\u606f\u7684\u89e3\u91ca.  \u5c31\u50cfrabbitmq, rocketmq, kafka\uff0c \u4e5f\u90fd\u652f\u6301\u4e86\u8fd9\u4e2a\u4e8b\u52a1\u7684\u529f\u80fd\uff0c</p> <p>\u6d88\u8d39\u7aef\u6d88\u8d39\u5931\u8d25\u4e86\u751f\u4ea7\u7aef\u600e\u4e48\u56de\u6eda</p> <p>\u5176\u5b9e\u6d88\u606f\u961f\u5217\u7684\u4e8b\u52a1\u53ea\u80fd\u4fdd\u8bc1\u4e3b\u4f53\u4e1a\u52a1\u5168\u90e8\u6210\u529f\u7684\u60c5\u51b5\u4e0b\uff0c\u6d88\u606f\u4e5f\u80fd\u591f\u4ece\u751f\u4ea7\u7aef\u6210\u529f\u7684\u53d1\u9001\u5230\u6d88\u606f\u961f\u5217\u7684broker\uff0c\u6240\u4ee5\u5982\u679c\u6d88\u8d39\u7aef\u5931\u8d25\u4e86\u8fd9\u4e2a\u662f\u4e8b\u52a1\u56de\u6eda\u4e0d\u4e86\u7684</p> <p>\u53ea\u80fd\u591f\u4fdd\u8bc1\u6d88\u606f\u5728\u751f\u4ea7\u9636\u6bb5\uff0c\u80fd\u591f\u51c6\u786e\u65e0\u8bef\u7684\u4f20\u9001\u5230\u8fd9\u4e2abroker\uff0c\u6d88\u8d39\u9636\u6bb5\u5b83\u662f\u65e0\u6cd5\u4fdd\u8bc1\u7684</p>"},{"location":"chap7/Arch_anws/#14","title":"14 \u6d88\u606f\u961f\u5217\u5230\u5e95\u662f \u63a8\u6a21\u5f0f\u8fd8\u662f\u62c9\u6a21\u5f0f","text":"<p>\u6d88\u606f\u961f\u5217\u5230\u5e95\u662f\u63a8\u6a21\u5f0f\u8fd8\u662f\u62c9\u6a21\u5f0f\uff0c\u8981\u5206\u751f\u4ea7\u7aef\u5230broker\uff0c\u4ee5\u53cabroker\u5230\u6d88\u8d39\u7aef\u3002 </p> <p>\u5148\u8bf4\u4e00\u8bf4\u751f\u4ea7\u7aef\u5230\u8fd9\u4e2abroker</p> <p>\u4e1a\u52a1\u7aef\u4ea7\u751f\u4e86\u6d88\u606f\uff0c\u662f\u901a\u8fc7\u63a8\u7684\u6a21\u5f0f\u4f20\u7ed9broker\u7684\u3002 \u4e0d\u7ba1\u662fRabbitMQ\u8fd8\u662fRocketMQ\u8fd8\u662fkafka\uff0c\u90fd\u662f\u63a8\u7684\u6a21\u5f0f\u3002\u5c31\u662f\u4e0d\u7528\u5728\u8fd9\u4e2a\u751f\u4ea7\u7aef\u5b58\u6d88\u606f\u4e86\uff0c \u5c31\u662f\u4e0d\u7528\u5728\u8fd9\u4e2a\u751f\u4ea7\u7aef\u5b58\u6d88\u606f\u4e86\uff0c\u7edf\u4e00\u7684\u6254\u7ed9broker\u6765\u5904\u7406\uff0cbroker\u53c8\u6709\u6301\u4e45\u5316\u7684\u673a\u5236\u3002 </p> <p>broker\u5230\u6d88\u8d39\u7aef</p> <ul> <li>\u50cfrocketMQ\uff0ckafka\u5c31\u662f\u62c9\u6a21\u5f0f\uff0c </li> <li>\u90a3\u4e48\u5bf9\u4e8eRabbitmq\u5c31\u662f\u63a8\u6a21\u5f0f. \u63a8\u6a21\u5f0f\u5c31\u662fbroker\u6709\u6d88\u606f\u4e86\u5c31\u76f4\u63a5\u5f80\u6d88\u8d39\u7aef\u63a8, \u6d88\u8d39\u8005\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2a\u7f13\u51b2\u533a\u6765\u7f13\u5b58\u8fd9\u4e9b\u6d88\u606f, \u6d88\u8d39\u8005\u76f4\u63a5\u53ef\u4ee5\u8fd9\u4e2a\u5185\u5b58\u91cc\u9762\u6765\u53d6\u6d88\u606f. </li> <li>\u4f18\u52bf: \u5b9e\u65f6\u6027\u9ad8\u5ef6\u8fdf\u5c0f</li> <li>\u52a3\u52bf: \u5c31\u662f\u7f13\u51b2\u533a\u5462\u53ef\u80fd\u4f1a\u6ea2\u51fa</li> </ul> <p>\u6240\u4ee5\u50cfrabbitmq\u6bd4\u8f83\u9002\u5408\uff0c\u6d88\u606f\u91cf\u4e0d\u5927</p> <p>\u5b9e\u65f6\u6027\u8981\u6c42\u6bd4\u8f83\u9ad8\u7684\u573a\u666f\uff0c\u90a3\u4e48\u5bf9\u4e8erocketmq, kafka, \u90fd\u662f\u91c7\u7528\u8fd9\u4e2a\u62c9\u6a21\u5f0f. \u6d88\u8d39\u7aef\u4e3b\u52a8\u8bf7\u6c42broker\u6765\u62c9\u53d6\u6d88\u606f, \u6bcf\u9694\u51e0\u79d2\u949f\u62c9\u4e00\u4e0b. \u5982\u679c\u6ca1\u6709\u6d88\u606f\u5462\u5c31\u5728\u90a3\u7b49\u7740, \u4e00\u76f4\u7b49\u5230\u8d85\u65f6\u91ca\u653e, \u53c8\u53eb\u505a\u957f\u8f6e\u8be2</p> <ul> <li>\u4f18\u52bf: \u5c31\u662f\u53ef\u4ee5\u6839\u636e\u6d88\u8d39\u8005\u7684\u81ea\u8eab\u60c5\u51b5, \u4e3b\u52a8\u53bb\u8bf7\u6c42. \u5982\u679c\u5f53\u524d\u6d88\u8d39\u8005\u89c9\u5f97\u81ea\u5df1\u8fd9\u4e2a\u6d88\u8d39\u4e0d\u8fc7\u6765, \u90a3\u4e48\u53ef\u4ee5\u6839\u636e\u4e00\u5b9a\u7684\u7b56\u7565\u6765\u505c\u6b62\u62c9\u53d6</li> <li>\u52a3\u52bf: \u5c31\u662f\u6709\u4e00\u5b9a\u7684\u8fd9\u4e2a\u65f6\u5ef6</li> <li>rocketmq \u5ef6\u8fdf\u5df2\u7ecf\u5f88\u5c0f\u4e86</li> </ul>"},{"location":"chap7/Arch_anws/#4_2","title":"4 \u6570\u636e\u5e93","text":""},{"location":"chap7/Arch_anws/#1_4","title":"1 \u4ec0\u4e48\u60c5\u51b5\u4e0b\u8981\u8fdb\u884c\u5206\u5e93\u5206\u8868\uff1f","text":"<p>\u5355\u8868\u6570\u636e\u5982\u679c\u8fbe\u5230\u4e861,000\u4e07\uff0c\u56e0\u4e3a\u8fbe\u5230\u8fd9\u4e2a\u91cf\u7ea7\u7684\u6570\u636e\u5e93\u4e0d\u7ba1\u662f\u67e5\u8be2\u4e5f\u597d\uff0c\u5199\u6570\u636e\u5e93\u4e5f\u597d\uff0c\u6548\u7387\u90fd\u5f88\u4f4e\u3002 </p> <p>\u67e5\u8be2\u5f88\u597d\u7406\u89e3\uff0c\u9700\u8981\u53bb\u904d\u5386\u6570\u636e\u8868\uff0c\u6570\u636e\u8868\u8d8a\u5927\uff0c\u67e5\u8be2\u80af\u5b9a\u5c31\u8d8a\u6162\u3002\u4f46\u662finsert\u5b8c\u6bd5\u4e4b\u540e\uff0c \u6570\u636e\u5e93\u5c31\u4f1a\u9488\u5bf9\u7528\u6237\u8868\u91cd\u65b0\u5efa\u7acb\u5bf9\u5e94\u7684\u7d20\u5f15\u3002 </p> <p>\u4e3a\u4e86\u67e5\u8be2\u7684\u6548\u7387\uff0c\u7d22\u5f15\u91c7\u7528\u7684\u662fb+\u6811\uff0c\u90a3\u4e48\u6709\u4e86\u65b0\u6570\u636e\u3002 \u5c31\u9700\u8981\u91cd\u65b0\u53bb\u6784\u5efa\u7d22\u5f15\u7684b+\u6811\uff0c \u90a3\u4e481,500w\u884c\u7684\u8fd9\u4e2a\u6570\u636e\uff0c\u5efa\u7acb\u8d77\u7d20\u5f15\u6765\u3002\u5728\u7cfb\u7edf\u7684\u5f00\u9500\u65b9\u9762\u8fd8\u662f\u4e0d\u5bb9\u5ffd\u89c6\u7684\uff0c \u6bd4\u8f83\u5f71\u54cd\u6570\u636e\u5e93\u7684\u6027\u80fd\u3002</p> <p>1.1 \u5206\u8868</p> <p>\u6bd4\u5982\u505a\u4e86\u5206\u8868\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982\u8bf4\u5206\u4e86\u4e94\u4e2a\u8868\uff0c\u5728\u5efa\u7acb\u7d22\u5f15\u65b9\u9762\u7684\u65f6\u95f4\u5c31\u4f1a\u4e0b\u964d\u5f88\u591a, \u4e5f\u5c31\u80fd\u591f\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u8fd0\u884c\u6548\u7387, \u8fdb\u800c\u4e5f\u80fd\u591f\u63d0\u9ad8\u7cfb\u7edf\u7684\u5e76\u53d1\u91cf</p> <p>\u5f53\u7136\u5206\u8868\u7684\u597d\u5904, \u9664\u4e86\u7d22\u5f15\u65b9\u9762\u8fd8\u6709\u5f88\u591a. \u6bd4\u5982\u8bf4\u53ef\u4ee5\u51cf\u5c11\u8fd9\u4e2a\u5199\u64cd\u4f5c\u9501\u7684\u8303\u56f4, \u5728\u5199\u6570\u636e\u7684\u65f6\u5019\uff0c\u4f1a\u5bf9\u6570\u636e\u8fdb\u884c\u52a0\u9501.  \u5982\u679c\u6570\u636e\u8868\u91cc\u7684\u6570\u636e\u5f88\u591a, \u90a3\u4e48\u5f88\u660e\u663e\u5c31\u4f1a\u589e\u52a0\u9501\u7684\u8303\u56f4. \u52a0\u9501\u8d8a\u591a, \u6548\u7387\u5c31\u81ea\u7136\u4f1a\u4f4e. </p> <p>\u5206\u8868\uff0c\u8bf4\u5230\u5e95\u5c31\u662f\u628a\u6570\u636e\u5206\u7247\u62c6\u5206\uff0c\u53c8\u53eb\u6c34\u5e73\u62c6\u5206\uff0c \u628a\u5355\u8868\u7684\u6570\u636e\u51cf\u5c11\uff0c\u81ea\u7136\u5c31\u80fd\u63d0\u9ad8\u7cfb\u7edf\u7684\u6027\u80fd\u3002</p> <p>1.2 \u5206\u5e93</p> <p>\u63d0\u9ad8\u8fd9\u4e2a\u67b6\u6784\u7684\u4e00\u4e2a\u53ef\u7528\u6027\uff0c \u51cf\u5c11\u5355\u70b9\u6545\u969c\u3002 \u80fd\u591f\u6709\u6548\u7684\u5206\u62c5\u4e00\u4e2a\u5e93\u7684\u538b\u529b\uff0c \u53ea\u5206\u5e93\u4e0d\u5206\u8868\u3002 </p> <p>\u5e38\u7528\u4e8e\u8fd9\u4e2a\u8bfb\u5199\u5206\u79bb\u7684\u573a\u666f\uff0c\u90a3\u4e48\u4e00\u4e3b\u591a\u4ece\u3002\u4e3b\u5e93\u8d1f\u8d23\u5199\u4ece\u5e93\u8d1f\u8d23\u8bfb\uff0c\u4ece\u5e93\u4ece\u4e3b\u5e93\u540c\u6b65\u66f4\u65b0\u6570\u636e\u6765\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c \u4e3b\u5e93\u540c\u6b65\u66f4\u65b0\u6570\u636e\u6765\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027</p>"},{"location":"chap7/Arch_anws/#2_4","title":"2 \u5206\u5e93\u5206\u8868\u7684\u51e0\u79cd\u7b56\u7565","text":"<p>\u7528\u7684\u6bd4\u8f83\u591a\u7684\u4e5f\u5c313\u4e2a\uff0c \u6309 ID\u53d6\u6a21\uff0c\u6309 \u65f6\u95f4\u70b9\u5206\u533a\uff0c\u91c7\u7528\u4e00\u81f4\u6027\u54c8\u897f</p> <ul> <li>\u6309\u7167\u65f6\u95f4\u70b9\u5206\u533a</li> </ul> <p>\u9002\u7528\u5e72\u8fd9\u4e2a\u8ba2\u5355\u6570\u636e\u62c6\u5206\u3002 \u6309\u5929\u5206\u8868\uff0c \u6309\u6708\u5206\u8868\u6309\u5e74\u5206\u8868\u3002\u90a3\u4e48\u65f6\u95f4\u8d8a\u4e45\u7684\u6570\u636e\uff0c \u88ab\u67e5\u8be2\u5230\u7684\u6982\u7387\u4e5f\u4f1a\u8d8a\u4f4e\u3002 \u7c7b\u4f3c\u51b7\u6267\u6570\u636e\u7684\u5206\u79bb\uff0c\u5e38\u89c1\u7684\u7535\u5546\u6216\u8005\u94f6\u884cAPP\uff0c\u5c31\u4f1a\u63d0\u4f9b\u6bd4\u5982\u8bf4\u8fd13\u4e2a\u6708\uff0c\u8fd16\u4e2a\u6708\u8ba2\u5355\u7684\u8fd9\u4e2a\u67e5\u8be2\u5feb\u6377\u952e\u3002</p> <p>\u5176\u5b9e\u5c31\u662f\u6309\u7167\u5929\uff0c\u6309\u7167\u6708\u6765\u505a\u4e86\u8fd9\u4e2a\u6570\u636e\u8868\u7684\u5206\u533a\u3002</p> <ul> <li>ID\u53d6\u6a21</li> </ul> <p>\u8fd8\u662f\u4ee5\u7528\u6236\u8868\u4e3a\u4f8b, \u6bd4\u5982\u8aaa\u7528\u6236\u88683,000\u4e07, \u8981\u62c6\u62106\u4e2a\u8868, \u6bcf\u4e2a\u8868500\u4e07\u3002\u5c07\u6570\u636e\u5206\u644a\u52306\u4e2a\u8868\u4e2d\uff0c\u67e5\u8be2\u4e5f\u7b80\u5355\uff0c\u5148\u901a\u8fc7ID\u53d6\u6a21\u627e\u5230\u6240\u5728\u7684\u8868\u3002\u518d\u53bb\u6267\u884csql\u8bed\u53e5</p> <p>\u4f46\u662f\u53d6\u6a21\u6cd5\u6709\u4e00\u4e2a\u7f3a\u70b9\uff0c\u5982\u679c\u6570\u636e\u91cf\u589e\u52a0\u3002 \u5c31\u8981\u6269\u5145\u6570\u636e\u8868, \u90a3\u4e48\u4e4b\u524d\u5df2\u7ecf\u8ba1\u7b97\u597d\u7684\u53d6\u6a21\u7684\u503c\u5c31\u4f1a\u6539\u53d8, \u5df2\u7ecf\u5b58\u5728\u76843.000\u4e07\u7684\u6570\u636e\u5462\u5c31\u8981\u91cd\u65b0\u5206\u7247\u4e86. </p> <ul> <li>\u4e00\u81f4\u6027\u54c8\u897f\u7b97\u6cd5</li> </ul> <p>\u8fd9\u4e2a\u9700\u8981\u9762\u4e34\u5927\u91cf\u7684,\u989d\u5916\u7684\u8fd9\u4e2a\u6570\u636e\u8fc1\u79fb\u7684\u5de5\u4f5c,  \u5176\u5b9e\u53ef\u4ee5\u8003\u8651\u4e00\u81f4\u6027\u54c8\u897f\u7b97\u6cd5\u6765\u89e3\u51b3\uff0c \u6574\u4e2a\u54c8\u897f\u503c\u7684\u7a7a\u95f4\uff0c\u7ec4\u7ec7\u6210\u4e00\u4e2a\u865b\u62df\u7684\u4e00\u4e2a\u5706\u73af\uff0c\u7136\u540e\u5404\u4e2a\u6570\u636e\u8868\u8fdb\u884c\u4e00\u4e2a\u54c8\u897f\uff0c \u53ef\u4ee5\u9009\u62e9\u7684\u8868\u7684\u7f16\u53f7\u6216\u8005\u540d\u79f0\uff0c \u4f5c\u4e3a\u4e00\u4e2a\u5173\u952e\u8bcd\u8fdb\u884c\u54c8\u897f\uff0c\u8fd9\u6837\u6bcf\u4e00\u4e2a\u6570\u636e\u8868\u5c31\u80fd\u591f\u786e\u5b9a\u5728\u54c8\u897f\u73af\u4e0a\u7684\u8fd9\u4e2a\u4f4d\u7f6e</p> <p>\u5b58\u50a8\u6570\u636e\u7684\u65f6\u5019\uff0c\u53ea\u8981\u5c06\u6570\u636ekey\u3002\u4f7f\u7528\u76f8\u540c\u7684\u8fd9\u4e2a\u51fd\u6570\u54c8\u897f\uff0c\u8ba1\u7b97\u51fa\u54c8\u897f\u503c\u3002\u5e76\u786e\u5b9a\u6b64\u6570\u636e\u5728\u8fd9\u4e2a\u73af\u4e0a\u7684\u4f4d\uff0c\u7136\u540e\u6309\u7167\u8fd9\u4e2a\u7b97\u6cd5\u627e\u5230\u9760\u8fd1\u7684\u8fd9\u4e2a\u6570\u636e\u8868\u3002</p> <p>\u7136\u540e\u8fdb\u884c\u76f8\u5173\u7684\u4e00\u4e9b\u6570\u636e\u64cd\u4f5c\uff0c\u5f53\u7136\u6570\u636e\u91cf\u589e\u5927\u3002 \u53bb\u65b0\u589e\u6570\u636e\u8868\u7684\u65f6\u5019\uff0c \u90a3\u4e48\u5206\u8868\u53d6\u6a21\uff0c \u8fd8\u662f\u6309\u7167ID\u53d6\u6a21\u7684\u5927\u5f0f\u6765\u505a\u66f4\u597d\u4e00\u4e9b\uff0c\u53ea\u8981\u4f30\u7b97\u5978\u6570\u636e\u7684\u589e\u91cf\u5408\u7406\u7684\u505a\u597d\u89c4\u5212</p>"},{"location":"chap7/Arch_anws/#3_3","title":"3 \u5206\u5e93\u5206\u8868\u7d2b\u6765\u4e86\u54ea\u4e9b\u95ee\u9898\uff1f","text":"<p>\u65e5\u5e38\u751f\u4ea7\u73af\u5883\u4e2d\uff0c \u6570\u636e\u5e93\u4e00\u65e6\u51fa\u73b0\u4e86\u6027\u80fd\u74f6\u9888\u7684\u65f6\u5019\uff0c \u5c31\u4f1a\u60f3\u5230\u4e86\u5206\u5e93\u5206\u8868\u3002   </p> <p>\u53ef\u4ee5\u6309\u7167\u53d6\u6a21\uff0c \u4e00\u81f4\u6027\u54c8\u897f\uff0c\u6309\u7167\u65f6\u95f4\u70b9\u6765\u5206\u533a\u64cd\u4f5c\u8d77\u6765\u8fd8\u662f\u6bd4\u8f83\u5bb9\u6613\uff0c\u5c24\u5176\u662f\u501f\u52a9\u4e86\u4e00\u4e9b\u4e2d\u95f4\u952e\u4ef6\uff0c \u6bd4\u5982mycat\u3002</p> <ul> <li>1 \u6bd4\u5982\u8bf4\u5206\u5e93\u5206\u8868\u4e4b\u540e\u600e\u4e48\u53bbJoin?</li> </ul> <p>\u90a3\u4e48\u4e00\u822c\u60c5\u51b5\u4e0b, \u5206\u5e93\u5206\u8868\u4e4b\u540e,  \u5c31\u4e0d\u5efa\u8bae\u518d\u8ddf\u8fd9\u4e2a\u5355\u5e93\u5355\u8868\u4e00\u6837\u8fdb\u884cJoin\u64cd\u4f5c, \u5e94\u8be5\u907f\u514d\u8fd9\u6837\u7684\u4e00\u4e2ajoin\u67e5\u8be2</p> <p>\u6bd4\u8f83\u5e38\u89c4\u7684\u505a\u6cd5, \u5176\u5b9e\u53ef\u4ee5\u91c7\u7528\u8fd9\u4e2a\u5b57\u6bb5\u7684\u5197\u4f59, \u6709\u4e9b\u5b57\u6bb5\u5c31\u4e0d\u7528\u518d\u53bbjoin\u53bb\u67e5\u8be2\u4e86</p> <ul> <li>2 \u5206\u5e03\u5f0fID\u7684\u95ee\u9898</li> </ul> <p>\u5728\u5206\u5e93\u5206\u8868\u4e4b\u540e,  \u5c31\u4e0d\u80fd\u518d\u50cf\u4ee5\u524d\u4e00\u6837\u4f7f\u7528mysql \u81ea\u589eid\u4e86\u3002 \u56e0\u4e3a\u5728\u63d2\u5165\u8bb0\u5f55\u7684\u65f6\u5019\uff0c \u4e0d\u540c\u7684\u5e93\u4e0d\u540c\u7684\u8868\u3002 </p> <p>\u751f\u6210\u7684\u8bb0\u5f55\u7684\u81ea\u589eID\u5c31\u4f1a\u51fa\u73b0\u51b2\u7a81\uff0c\u5c31\u9700\u8981\u6709\u4e00\u4e2a\u5168\u5c40\u7684ID\u751f\u6210\u5668\uff0c \u7cfb\u7edf\u9700\u8981\u989d\u5916\u7684\u4e00\u4e2a\u53ef\u9760\u7684\u5206\u5e03\u5f0fID\u7684\u751f\u6210\u5668\u7684\u4e00\u4e2a\u670d\u52a1</p> <p>\u800c\u4e14\u4e00\u5b9a\u8981\u53ef\u9760, \u5426\u5219\u52a8\u4e0d\u52a8\u5c31\u5b95\u673a\u8d85\u53ef\u80fd\u5c31\u4f1a\u53d8\u6210\u65b0\u7684\u6027\u80fd\u74f6\u9888</p> <p>\u6bd4\u8f83\u5e38\u89c1\u7684\u5206\u5e03\u5f0fID\u751f\u6210\u7b56\u7565</p> <ol> <li>uuid, \u770b\u8d77\u6765\u5c31\u662f\u4e00\u5806\u4e71\u7801</li> <li>\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5c31\u662f redis\u7684incr\u51fd\u6570, \u4f46\u662fredis\u8981\u786e\u4fdd\u53ef\u9760\u6027,\u4e00\u65e5\u51fa\u73b0\u4e86\u4e00\u4e9b\u6545\u969c, \u91cd\u542f\u4e4b\u540e\u6570\u636e\u5c31\u53ef\u80fd\u5c31\u4f1a\u4e22\u5931, \u53ef\u80fd\u5c31\u4f1a\u91cd\u65b0\u5f00\u59cb\u8ba1\u7b97,\u53ef\u80fd\u5c31\u4f1a\u51fa\u73b0\u91cd\u590d\u7684ID</li> <li>\u6bd4\u5982snowflake, \u96ea\u82b1\u7b97\u6cd5\u7b49\u7b49</li> <li> <p>leaf\u7b97\u6cd5</p> </li> <li> <p>3 \u5206\u5e93\u5206\u8868\u4e4b\u540e\u4f1a\u53ef\u80fd\u4f1a\u9047\u5230\u8fd9\u4e2a\u6269\u5145\u8868</p> </li> </ol> <p>\u4e00\u65e6\u8fd9\u4e2a\u6570\u636e\u8868\u4e0d\u591f\u7528\u4f60\u3001\u8981\u91cd\u65b0\u5206\u8868\u3002 \u5c06\u51e0\u5343\u4e07\uff0c \u751a\u81f3\u51e0\u4ebf\u7684\u8fd9\u4e2a\u6570\u636e\u91cd\u65b0\u5237\u76d8\u3002 </p> <p>\u6bd4\u8f83\u5934\u75bc\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\uff0c\u56e0\u4e3a\u6d89\u53ca\u5230\u4e86\u8fd9\u4e2a\u540c\u65f6\u8981\u66f4\u65b0\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u8868\uff0c\u5982\u4f55\u4fdd\u8bc1\u8981\u4e48\u540c\u65f6\u6210\u529f\uff0c \u8981\u4e48\u540c\u65f6\u5931\u8d25\uff0c\u5c31\u6210\u4e86\u4e00\u4e2a\u9700\u8981\u89e3\u6c7a\u7684\u95ee\u9898</p> <p>\u6bd4\u8f83\u5e38\u89c1\u7684\u4e5f\u5c31\u4e24\u79cd\u65b9\u6848</p> <ul> <li>xa : xa\u73b0\u5728\u5176\u5b9e\u7528\u7684\u4e0d\u591a</li> <li>tcc: \u4e3b\u6d41\u7684\u65b9\u6848\u5176\u5b9e\u8fd8\u662ftcc<ul> <li>\u5148try, \u9501\u5b9a\u8d44\u6e90\uff0c \u7136\u540econfirm, commit</li> <li>\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u5f00\u6e90\u7684\u6846\u67b6\uff0c seata\uff0c bytecc</li> </ul> </li> </ul>"},{"location":"chap7/Arch_anws/#_2","title":"\u5c3d\u91cf\u4e0d\u8981\u5c1d\u8bd5\u5206\u5e93\u5206\u8868","text":""},{"location":"chap7/Arch_anws/#4_3","title":"4 \u5206\u5e93\u5206\u8868\u4e4b\u540e\u5982\u4f55\u8fdb\u884c\u5206\u9875\u67e5\u8be2","text":"<p>\u6bd4\u5982\u8bf4\u5982\u679c\u6309\u7167\u8fd9\u4e2a\u65f6\u95f4\u70b9\u5206\u8868\uff0c\u6216\u8005ID\u7684\u8fd9\u4e2a\u8303\u56f4\u5206\u8868\u3002 </p> <ul> <li>\u53ef\u4ee5\u6839\u636e\u65f6\u95f4\u8303\u56f4\u7684\u6761\u4ef6\uff0c \u5148\u627e\u5230\u5bf9\u5e94\u7684\u8868\uff0c \u7136\u540e\u6309\u7167\u4f20\u7edf\u7684\u5355\u8868\u7684\u5206\u9875\u67e5\u8be2\u7684\u65b9\u6cd5\u5c31\u53ef\u4ee5\u4e86 \uff08\u65f6\u95f4\u7684\u8303\u56f4\u6216\u8005\u662fID\u7684\u8303\u56f4\u6765\u5206\u8868\uff09</li> <li>\u4f46\u662f\u5982\u679c\u662f\u53d6\u6a21\u7684\u573a\u666f\uff0c \u4e0d\u5177\u5907\u8fde\u7eed\u6027\uff0c\u6570\u636e\u5206\u6563\u7684\u5728\u5404\u4e2a\u8868\u4e2d<ul> <li>\u5206\u9875\u67e5\u627e\uff0c\u53ef\u4ee5\u6839\u636e\u4e0a\u4e00\u9875\u7684ID\uff0c\u589e\u52a0\u6548\u7387</li> </ul> </li> </ul>"},{"location":"chap7/Arch_anws/#5_1","title":"5 \u5206\u5e93\u5206\u8868\u4e4b\u67e5\u8be2\u4f18\u5316\u7b56\u7565","text":"<p>\u63d0\u5347\u6574\u4e2a\u7cfb\u7edf\u7684\u67e5\u8be2\u6027\u80fd\uff0c \u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e9b\u9759\u6001\u7684\u6216\u8005\u53d8\u52a8\u4e0d\u5927\u7684\u4e00\u4e9b\u6570\u636e\u3002 \u6bd4\u5982\u8bf4\u50cf\u5546\u54c1\u6570\u636e\uff0c \u5c31\u53ef\u4ee5\u76f4\u63a5\u6254\u5728redis\u91cc\u9762\uff0c \u8fd8\u6709\u70b9\u8d5e\uff0c\u6536\u85cf\u8fd9\u79cd\u64cd\u4f5c\u9891\u7e41\u7684\u6570\u636e\uff0c\u4e5f\u53ef\u4ee5\u6254\u5230redis \u56e0\u4e3a\u6570\u636e\u5462\u90fd\u662f\u57fa\u4e8e\u5185\u5b58</p> <p>\u5728\u67e5\u8be2\u7684\u6027\u8d28\u4e0a\u9762\u662f\u8981\u6bd4\u4f20\u7edf\u7684\u8fd9\u4e2a\u6570\u636e\u5e93\u67e5\u8be2\u8981\u9ad8\u597d\u51e0\u4e2a\u6570\u91cf\u7ea7</p> <p>\u57fa\u4e8e\u5185\u5b58\u5462\u8fd8\u6709es</p> <p>\u5206\u5e93\u5206\u8868\u4e4b\u540e\uff0c \u53ef\u4ee5\u5f02\u6784\u4e00\u4efd\u6570\u636e\u5230es\u4e2d\u3002 \u8fd9\u6837\u5c31\u4e0d\u7528\u8003\u8651\u590d\u6742\u7684\u5206\u9875\uff0c </p> <ul> <li>ES\u7684\u5012\u6392\u7d20\u5f15\uff0c\u6bcf\u4e00\u4e2a\u6570\u636e\u6bcf\u4e00\u4e2a\u5b57\u6bb5\u90fd\u8fdb\u884c\u4e86\u5206\u8bcd\u3002\u6bcf\u4e00\u4e2a\u5206\u8bcd\u90fd\u4f1a\u5efa\u7acb\u7d22\u5f15\u3002\u8fd9\u6837\u5728\u68c0\u7d22\u5173\u952e\u8bcd\u7684\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u5173\u952e\u8bcd\u76f4\u63a5\u627e\u5230\u5012\u6392\u7d20\u5f15\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u6309\u56fe\u7d22\u9aa5\uff0c\u5c31\u53ef\u4ee5\u627e\u5230\u76f8\u5e94\u7684\u6587\u6863</li> <li>ES\u662f\u57fa\u4e8e\u5185\u5b58\uff0c ES\u628a\u6570\u636e\u8ff8\u884c\u5904\u7406\u5efa\u7acb\u4e86\u7d22\u5f15\u4e4b\u540e\u3002 \u5c31\u4f1a\u5168\u90e8\u6254\u5230\u5185\u5b58\u91cc\u9762\uff0c \u8981\u4f18\u4e8emysql\u7684b+\u6811\u7684\u7ed3\u6784\u3002 \u5374\u80fd\u591f\u76f4\u63a5\u4ece\u5185\u5b58\u91cc\u9762\u627e\u5230\u76ee\u6807\u6587\u6863\uff0c \u53ef\u4ee5\u5927\u5927\u7684\u63d0\u5347\u67e5\u8be2\u6548\u7387</li> </ul>"},{"location":"chap7/Arch_anws/#6_2","title":"6 \u5982\u4f55\u5b9e\u73b0\u6570\u636e\u5e93\u7684\u8bfb\u5199\u5206\u79bb","text":"<p>\u57fa\u4e8e\u4e3b\u4ece\u590d\u5236\u7684\u67b6\u6784\uff0c\u7b80\u5355\u6765\u8bb2\u5c31\u662f\u641e\u4e00\u4e2a\u4e3b\u5e93\uff0c\u6302\u591a\u4e2a\u4ece\u5e93\u3002</p> <p>\u53ea\u662f\u5199\u4e3b\u5e93\u4e86\uff0c\u4fee\u6539\uff0c\u5220\u9664\u65b0\u589e\u90fd\u662f\u5728\u4e3b\u5e93\u4e0a\u9762\u8fdb\u884c\u64cd\u4f5c\u3002 </p> <p>\u7136\u540e\u4e3b\u5e93\u5c31\u4f1a\u81ea\u52a8\u7684\u628a\u6570\u636e\uff0c\u7ed9\u540c\u6b65\u5230\u4ece\u5e93\u4e0a\u53bb\u3002 \u4e3b\u5e93\u554a\u5c31\u8ddf\u5b58\u5e93\u4fdd\u8bc1\u4e86\u6570\u636e\u7edf\u4e00\uff0c\u4ece\u5e93\u6709\u591a\u4e2a\uff0c\u7edf\u4e00\u5bf9\u5916\u63d0\u4f9b\u67e5\u8be2\u670d\u52a1\u3002</p> <p>\u5728\u5b9e\u73b0\u5c42\u9762, \u6709\u4e24\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u70b9</p> <ul> <li>\u4e00\u4e2a\u662f\u6570\u636e\u7684\u540c\u6b65\u95ee\u9898, \u4e3b\u5e93\u600e\u4e48\u628a\u6570\u636e\u540c\u6b65\u5230\u4ece\u5e93\u4e0a\u9762</li> <li>\u4e00\u4e2a\u662f\u8bbf\u95ee\u7684\u7b56\u7565\u95ee\u9898, \u600e\u4e48\u77e5\u9053\u5f53\u524d\u7684sql\u8bed\u53e5</li> </ul> <p>\u8be5\u8bbf\u95ee\u54ea\u4e00\u4e2a\u5e93\u5f97\u6709\u76f8\u5173\u7684\u8def\u7531\u534f\u8bae,  \u6570\u636e\u7684\u540c\u6b65\u95ee\u9898\u4ee5mysql\u4e3a\u4f8b\u3002\u6838\u5fc3\u5c31\u662f\u4ed6\u7684\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\u53ebbinlog\uff0c</p> <p>\u90a3\u4e48\u4e3b\u5e93\uff0c\u6bcf\u6b21\u7684\u64cd\u4f5c\u3002 \u589e\u5220\u6539\u90fd\u4f1a\u628a\u65e5\u5fd7\u6254\u5230binlog\u4e2d\uff0c\u90a3\u4e48\u4ece\u5e93\u4f1a\u8ba2\u9605\u4e3b\u5e93\u7684binlog\uff0c\u5728\u8fde\u63a5\u4e0a\u4e3b\u5e93\u4e4b\u540e\u3002 </p> <p>\u5c31\u4f1a\u5b9e\u65f6\u7684\u53bb\u540c\u6b65binlog\u7684\u5185\u5bb9\uff0c \u89e3\u6790\u6210sql\u8bed\u53e5\uff0c\u7136\u540e\u5728\u4ece\u5e93\u7684\u672c\u5730\uff0c\u6267\u884csql\u8bed\u53e5\u3002  </p> <p>\u4ece\u5e93\u4e4b\u95f4\u7684\u6570\u636e\u540c\u6b65, \u5f53\u7136\u5982\u679c\u64cd\u4f5c\u5e76\u53d1\u91cf\u5927\u3002 binlog\u7684\u540c\u6b65\u6267\u884c\uff0c\u76f8\u5e94\u7684\u4e5f\u4f1a\u6162\u4e00\u4e9b\u3002\u51e0\u5341\u79d2\uff0c \u51e0\u767e\u6beb\u79d2\uff0c\u51e0\u79d2\u554a\u90fd\u662f\u6709\u53ef\u80fd\u7684\uff0c\u4e5f\u662f\u727a\u7272\u4e86\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c \u4fdd\u8bc1\u4e86\u53ef\u7528\u6027</p> <p>\u7136\u540e\u8bbf\u95ee\u7684\u7b56\u7565\u95ee\u9898\uff0c\u589e\u5220\u6539\u8981\u9009\u62e9\u4e3b\u5e93\u3002\u67e5\u8be2\u8981\u9009\u62e9\u4ece\u5e93\uff0c\u4ece\u5e93\u6709\u591a\u4e2a\u8fd8\u6d89\u53ca\u5230\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u5f53\u7136\u53ef\u4ee5\u5728\u4ee3\u7801\u91cc\u5b9e\u73b0\uff0c \u53ef\u4ee5\u914d\u7f6e\u591a\u4e2a\u6570\u636e\u6e90\u3002 </p> <p>\u6839\u636esql\u8bed\u53e5\u6765\u5224\u65ad\uff0c\u5e94\u8be5\u8bbf\u95ee\u54ea\u4e2a\u6570\u636e\u5e93\uff0c \u5199\u597d\u8def\u7531\u534f\u8bae\uff0c\u5c31\u4f1a\u628a\u4ee3\u7801\u8ddf\u6570\u636e\u5e93\uff0c\u7d27\u5bc6\u7684\u8026\u5408\u5728\u4e00\u8d77\u3002\u90a3\u4e00\u822c\u4e5f\u90fd\u4f1a\u8fed\u62e9\u4e2d\u95f4\u4ef6mycat\uff0c\u4e5f\u4e0d\u9700\u8981\u518d\u505a\u4e00\u4e9b\u4ec0\u4e48\u8def\u7531\u914d\u7f6e</p>"},{"location":"chap7/Arch_anws/#7-select","title":"7 \u4e3a\u5565\u8981\u7981\u7528<code>select *</code>","text":"<p>\u6570\u636e\u662f\u5b58\u50a8\u5728\u8fd9\u4e2a\u78c1\u76d8\u4e0a\u7684, \u53bb\u67e5\u6240\u6709\u7684\u5b57\u6bb5, \u80af\u5b9a\u5c31\u4f1a\u589e\u52a0\u78c1\u5bc6io\u7684\u5f00\u9500. </p> <p>\u5982\u679c\u8fd9\u4e9b\u5b57\u6bb5\u4e2d\u5305\u542b\u4e86\u4e00\u4e9b\u5927\u5b57\u6bb5, \u6bd4\u5982\u8bf4\u50cftext\uff0c\u6bd4\u5982\u8bf4\u50cfblob. \u90a3\u4e48\u8bfb\u53d6\u4e5f\u4f1a\u5f88\u6162, </p> <p>\u53e6\u5916\u4ece\u8fd9\u4e2a\u5e94\u7528\u670d\u52a1\u5668\u83b7\u53d6\u53d6\u6570\u636e\u5e93\u670d\u52a1\u5668\u7684\u6570\u636e, \u672c\u8eab\u4e5f\u4f1a\u6709\u4e00\u5b9a\u7684\u7f51\u7edc\u65f6\u5ef6. \u67e5\u7684\u8d8a\u591a\u901f\u5ea6\u80af\u5b9a\u5c31\u8d8a\u6162, \u67e5\u7684\u6162\uff0c\u7ebf\u7a0b\u91ca\u653e\u7684\u5c31\u6162, \u5c31\u4f1a\u5f71\u54cd\u5176\u4ed6\u7684\u67e5\u8be2\u7ebf\u7a0b.  \u6574\u4f53\u7684\u6027\u80fd\u5c31\u4f1a\u53d7\u5230\u5f71\u54cd</p> <p>\u7b2c\u4e8c\uff0c \u65e0\u6cd5\u4f7f\u7528\u8986\u76d6\u7d22\u5f15,  \u6bd4\u5982\u8bf4\u4f60\u8981\u67e5\u8be2\u7684\u5b57\u6bb5, \u78b0\u5de7\u8bbe\u7f6e\u4e86\u7d22\u5f15. \u5c31\u53ef\u4ee5\u76f4\u63a5\u4ece\u7d22\u5f15\u7684b+\u6811\u4e2d\u83b7\u53d6\u6570\u636e, \u57fa\u4e8eb+\u6811\u7684\u68c0\u7d22\u901f\u5ea6\u8fd8\u662f\u5f88\u5feb\u7684. </p> <p>\u7528\u4e86<code>select *</code>,  \u4e0d\u53ef\u80fd\u8bf4\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u5efa\u7d22\u5f15,  \u5c31\u6ca1\u6cd5\u76f4\u63a5\u4ece\u7d22\u5f15\u6811\u91cc\u9762\u53bb\u67e5\u627e\u6570\u636e. \u5c31\u5f97\u4ece\u78c1\u5bc6\u4e0a\u9762\u53bb\u67e5\u627e\u5b8c\u6574\u8bb0\u5f55,  \u5e38\u8bf4\u7684\u56de\u8868.  \u5728\u67e5\u8be2\u6027\u80fd\u4e0a\u9762\u5c31\u6253\u4e86\u6298\u6263\u4e86</p>"},{"location":"chap7/Arch_anws/#8_3","title":"8 \u804a\u804a\u6570\u636e\u5e93\u7684\u4e50\u89c2\u9501\uff0c\u60b2\u89c2\u9501","text":"<p>\u60b2\u89c2\u9501</p> <p>\u540c\u4e00\u65f6\u523b\u53ea\u5141\u8bb8\u4e00\u4e2a\u6570\u636e\u5e93\u7684\u4e8b\u52a1\u6765\u4fee\u6539\u8d44\u6e90\uff0c \u4f53\u73b0\u5728sql\u4e0a\u90a3\u5c31\u662f<code>select for update</code>. </p> <p>\u5148\u628a\u8fd9\u6761\u8bb0\u5f55\u9501\u4f4f, \u5176\u4ed6\u7684\u4e8b\u52a1\u8fc7\u6765\u5148\u7b49\u7740. \u53ea\u6709\u5f53\u524d\u7684\u4e8b\u52a1\u63d0\u4ea4\u4e86\u91ca\u653e\u4e86\u9501, \u5176\u4ed6\u4eba\u624d\u80fd\u591f\u83b7\u53d6\u5230\u9501\uff0c\u8fd9\u6837\u5176\u5b9e\u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e32\u884c\u7684\u64cd\u4f5c</p> <p>\u4e50\u89c2\u9501</p> <p>\u5c31\u662f\u6b64\u8f83\u4e50\u89c2\u7684\u8ba4\u4e3a\u6bcf\u4e00\u4e2a\u4e8b\u52a1\uff0c\u90fd\u662f\u4e0d\u66f4\u65b0\u6570\u636e\u6216\u8005\u5c11\u91cf\u7684\u66f4\u65b0\u6570\u636e\u3002\u7b80\u5355\u8bb2\u5c31\u662f\u67e5\u7684\u6bd4\u8f83\u591a\u6539\u7684\u6bd4\u8f83\u5c11\uff0c\u90a3\u5c31\u5bf9\u8d44\u6e90\u53ef\u4ee5\u5148\u4e0d\u7528\u52a0\u9501\u662f\u4e50\u89c2\u9501\u7684\u6838\u5fc3</p> <p>\u867d\u7136\u6ca1\u6709\u9501\uff0c\u4f46\u662f\u6709\u4e86\u4e00\u4e2a\u6982\u5ff5\u53eb\u7248\u672c\u53f7\uff0c\u4e00\u4e2a\u8bb0\u5f55\u5bf9\u5e94\u4e00\u4e2a\u7248\u672c\u53f7\u3002 \u5199\u7684\u65f6\u5019\uff0c\u518d\u628a\u5bf9\u5e94\u7684\u7248\u672c\u53f7\u4f5c\u4e3a\u6761\u4ef6\u5e26\u8fdb\u53bb\uff0c\u5728where\u6761\u4ef6\u91cc\u3002 \u90a3\u4e48\u66f4\u65b0\u7684\u5b8c\u4e86\u4e4b\u540e\uff0c\u628a\u7248\u672c\u53f7\u52a01\u3002 \u90a3\u4e48\u5982\u679c\u5199\u7684\u65f6\u5019\uff0c \u7248\u672c\u53f7\u8ddf\u4e4b\u524d\u7684\u4e0d\u4e00\u81f4\uff0c\u90a3\u5c31\u8bf4\u660e\u6211\u4eec\u7684\u8fd9\u4e2a\u6570\u636e\u88ab\u5176\u4ed6\u7684\u4e8b\u52a1\u4fee\u6539\u8fc7\u4e86\u3002</p> <p>\u6240\u4ee5\u8981\u629b\u51fa\u66f4\u65b0\u5931\u8d25\u7684\u5f02\u5e38\uff0c\u8ba9\u524d\u7aef\u4e1a\u52a1\u6765\u5904\u7406\uff0c\u4ed6\u4e0d\u50cf\u60b2\u89c2\u9501\u76f4\u63a5\u9501\u4f4f\u8d44\u6e90\u6765\u4e32\u884c\u5316\u3002 </p> <p>\u4e0d\u505a\u4efb\u4f55\u7684\u963b\u585e\u7528\u7248\u672c\u53f7\u6765\u63a7\u5236, \u76f8\u6bd4\u4e0b\u6765\u6548\u7387\u5c31\u4f1a\u9ad8\u5f88\u591a, \u5e76\u53d1\u81ea\u7136\u5c31\u80fd\u4e0a\u53bb\u4e86. \u9047\u5230\u4e86\u5e76\u53d1\u5927\u7684\u573a\u666f, \u5c31\u6bd4\u5982\u8bf4\u7535\u5546\u79d2\u6740\u4fc3\u9500, \u8fd9\u4e2a\u65f6\u5019\u5462\u4f1a\u9891\u7e41\u7684\u53bb\u6287\u51cf\u5e93\u5b58, \u4f46\u662f\u4e50\u89c2\u9501\u7248\u672c\u53f7\u7684\u673a\u5236\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u591f\u6709\u4e00\u4e2a\u6263\u51cf\u6210\u529f. </p> <p>\u5176\u4ed6\u7684\u5168\u90e8\u5931\u8d25, \u5176\u4ed6\u7684\u7ebf\u7a0b\u5c31\u9700\u8981\u518d\u6b21\u5c1d\u8bd5, \u91cd\u65b0\u5237\u65b0\u9875\u9762\u554a\u8bf7\u91cd\u65b0\u8bf7\u6c42. \u5c31\u4f1a\u8ba9\u7cfb\u7edf\u7684\u8bf7\u6c42\u538b\u529b\u6296\u589e, \u8fd9\u4e2a\u5c31\u662f\u6240\u8c13\u7684\u91cd\u8bd5\u5f00\u9500,\u8fd8\u4f1a\u62d6\u57ae\u6574\u4e2a\u4e1a\u52a1\u5e73\u53f0</p> <p>\u6240\u4ee5\u4e50\u89c2\u9501\u7684\u4f7f\u7528\u573a\u666f, \u4e00\u822c\u662f\u8bbf\u95ee\u91cf\u5927\u4f46\u662f\u4fee\u6539\u7684\u91cf\u5c11\u7684\u573a\u666f, \u65e2\u80fd\u591f\u625b\u4f4f\u9ad8\u5e76\u53d1\u53c8\u80fd\u591f\u9501\u5b9a\u8d44\u6e90, \u5982\u679c\u4f60\u7528\u4e50\u89c2\u9501\u5c31\u518d\u5408\u9002\u4e0d\u8fc7\u4e86,\u4e50\u89c2\u9501\u4e5f\u4f1a\u7528\u5728\u5e42\u7b49\u7684\u63a7\u5236\u4e0a\u9762</p>"},{"location":"chap7/Arch_anws/#9_3","title":"9 \u4e0d\u63a8\u8350\u7528\u60b2\u89c2\u9501","text":"<p>\u4ece\u6027\u80fd\u65b9\u9762\u6765</p> <p>\u6bcf\u6b21\u90fd\u5f97\u52a0\u9501\uff0c\u52a0\u9501\uff0c\u91ca\u653e\u9501\uff0c\u5f00\u9500\u5c31\u4e0a\u53bb\u4e86\u3002 </p> <p>\u8fd8\u6709\u9501\u7ade\u4e89\uff0c\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u6709\u4e00\u4e2a\u4e8b\u52a1\u5728\u4fee\u6539\u6570\u636e\uff0c \u90a3\u4e48\u5176\u4ed6\u7684\u6570\u636e\u90e8\u4e8b\u52a1\uff0c\u5168\u90e8\u662f\u963b\u585e\u7684\u72b6\u6001\u3002 \u5927\u5bb6\u90fd\u5728\u7b49\u5f85\u5f53\u524d\u7684\u4e8b\u52a1\u7ed3\u675f\uff0c\u5c31\u957f\u65f6\u95f4\u7684\u5360\u7528\u4e86\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u8fde\u63a5\u3002 \u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u6570\u91cf\u662f\u6709\u9650\u7684\uff0c\u957f\u65f6\u95f4\u5360\u7528\uff0c\u5176\u4ed6\u7684\u7ebf\u7a0b\u3002</p> <p>\u83b7\u53d6\u4e0d\u5230\u6570\u636e\u5e93\u7684\u8fde\u63a5\uff0c\u4e0a\u9762\u5e94\u7528\u5c42\u7684\u8fde\u63a5\u5c31\u4f1a\u8d85\u65f6\u3002\u6bd4\u5982\u8bf4\u50cf\u7f51\u5173\u5c42\u7684\u8fde\u63a5\uff0c\u8d1f\u8f7d\u5747\u8861\u7684\u8fde\u63a5\u90fd\u4f1a\u8d85\u65f6\uff0c \u5c31\u4f1a\u5f15\u8d77\u6240\u8c13\u7684\u60ca\u7fa4\u6548\u5e94\uff0c\u5bfc\u81f4\u6574\u4e2a\u5e73\u53f0\u5c31\u4f1a\u51fa\u73b0\u8d85\u65f6\u7684\u73b0\u8c61\uff0c \u7136\u540e\u6570\u636e\u5e93\u5e73\u53f0\u4e5f\u4f1a\u9891\u7e41\u7684\u62a5\u9519</p> <p>\u52a0\u9501</p> <p>\u5404\u79cd\u6162sql\u968f\u4e4b\u800c\u6765\uff0c\u77e5\u9053\u60b2\u89c2\u9501 \uff08\u9ed8\u8ba4\uff09 \u52a0\u7684\u662f\u884c\u9501\u3002\u57fa\u4e8e\u6570\u636e\u5e93\u7684\u7d22\u5f15\u6765\u52a0\u7684\u9501\uff0c\u5982\u679c\u9047\u5230\u7d22\u5f15\u5931\u6548\u3002 </p> <p>\u672c\u6765\u52a0\u4e86\u884c\u9501\uff0c\u53ef\u80fd\u5c31\u7acb\u9a6c\u5c31\u5347\u7ea7\u4e3a\u8868\u9501\uff0c\u9501\u4f4f\u4e86\u6574\u4e2a\u8868\uff0c\u5982\u679c\u6d89\u53ca\u5230\u4e86\u591a\u4e2a\u8868\u7684\u5173\u8054\u67e5\u8be2\uff0c\u5f88\u5bb9\u6613\u5c31\u4f1a\u53d8\u6210\u6b7b\u9501\u3002 \u5982\u679c\u6ca1\u6709\u5916\u754c\u7684\u5e72\u9884\uff0c\u5c31\u4f1a\u4e00\u76f4\u9501\u4e0b\u53bb\u5c24\u5176\u662f\u5e76\u53d1\u91cf\u5927\u7684\u573a\u666f\u3002 </p> <p>\u4e0d\u9002\u7528\u8bfb\u591a\u5199\u5c11\u7684\u573a\u666f\uff0c \u8fd9\u4e9b\u573a\u666f\u5982\u679c\u662f\u7528\u60b2\u89c2\u9501\u3002</p> <p>\u90a3\u4ec0\u4e48\u573a\u666f\u80fd\u7528</p> <p>\u4e00\u822c\u662f\u5728\u4e00\u4e9b\u8981\u6c42\u6570\u636e\u5f3a\u4e00\u81f4\u7684\u573a\u666f\uff0c\u5e76\u53d1\u91cf\u53c8\u4e0d\u9ad8\u7684\u573a\u666f\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\uff0c\u6bd4\u5982\u8bf4\u50cf\u91d1\u878d\u7c7b\u7684\u8fd9\u4e2a\u8d26\u6237\u5904\u7406\uff0c \u5e93\u5b58\u6263\u51cf\u7b49\u7b49</p>"},{"location":"chap7/Arch_anws/#10_2","title":"10 \u804a\u804a\u6570\u636e\u5e93\u7684\u8868\u9501\u3001\u884c\u9501","text":"<p>\u4e00\u822c\u9ed8\u8ba4\u90fd\u662f\u52a0\u7684\u662f\u884c\u9501\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u6b63\u5728\u66f4\u65b0\u7684\u64cd\u4f5c\u3002\u90a3\u4e48\u5176\u4ed6\u7684\u66f4\u65b0\u8bf7\u6c42\u662f\u8fdb\u4e0d\u6765\u7684\uff0c\u4e3b\u8981\u5c31\u662f\u4e3a\u4e86\u9632\u6b62\u4fee\u6539\u7684\u8fc7\u7a0b\u4e2d\u3002 \u6709\u5176\u4ed6\u7684\u4e8b\u52a1\u6765\u4fee\u6539\u540c\u4e00\u6761\u8bb0\u5f55\u9020\u6210\u810f\u6570\u636e\u3002</p> <p>\u8fd9\u4e2a\u65f6\u5019\u7528\u7684\u5c31\u662f\u884c\u9501\uff0c\u518d\u6bd4\u5982\u8bf4\u4fee\u6539\u8868\u7ed3\u6784\u3002\u4fee\u6539\u4e00\u4e2a\u5b57\u6bb5\uff0c\u540d\u79f0\u3002 \u6216\u8005\u662f\u4fee\u6539\u5b83\u7684\u7c7b\u578b\uff0c\u90a3\u4e48mysql\u5c31\u4f1a\u628a\u5f53\u524d\u7684\u8868\u9501\u4f4f\uff0c\u6240\u6709\u5173\u4e8e\u8fd9\u4e2a\u8868\u7684\u3002 </p> <p>\u53ea\u6709\u4fee\u6539\u5b8c\u6210\u4e4b\u540e\u91ca\u653e\u4e86\u8868\u9501\uff0c\u624d\u80fd\u8ba9\u4ed6\u8fdb\u3002\u8fd9\u4e2a\u65f6\u5019\u5c31\u662f\u628a\u6574\u4e2a\u8868\u9501\u4f4f\uff0c\u90a3\u4e48\u8868\u9501\u9501\u7684\u8303\u56f4\u6bd4\u8f83\u5e7f\u3002\u6bd4\u5982\u8bf4\u4fee\u6539\u4e86\u8868\u7684\u7ed3\u6784\uff0c\u5b57\u6bb5\u7684\u540d\u79f0\uff0c\u6216\u8005\u662f\u7c7b\u578b\u3002 \u5f80\u751f\u4ea7\u73af\u5883\u540c\u6b65\u7684\u65f6\u5019\uff0c \u6216\u8005\u8bf4\u662f\u9501\u7684\u8303\u56f4\u3002 </p> <p>\u884c\u9501\u76f8\u5bf9\u8868\u6240\u6765\u8bf4\uff0c\u5c31\u8981\u7a0d\u5fae\u590d\u6742\u4e00\u4e9b\uff0c\u5982\u679cwhere\u6761\u4ef6\u91cc\u9762\u5339\u914d\u7684\u662f\u7d22\u5f15\uff0c\u6bd4\u5982\u8bf4\u4e3b\u952eID\u7d22\u5f15\uff0cID\u7b49\u4e8e1\uff0c \u8fd9\u4e2a\u65f6\u5019\u5c31\u4f1a\u628aID\u7b49\u4e8e1\u7684\uff0c\u8fd9\u6761\u8bb0\u5f55\u52a0\u4e00\u4e2a\u9501\uff0c\u53eb\u8bb0\u5f55\u9501\uff0c\u5f53\u7136\u8fd9\u4e2a\u4e5f\u662f\u884c\u9501</p> <p>\u53ea\u662f\u9488\u5bf9\u5f53\u524d\u7684\u8bb0\u5f55\u52a0\u7684\u9501\uff0c\u90a3\u4e48\u5982\u679c\u67e5\u8be2\u7684\u6761\u4ef6\u662f\u6240\u6709\u7684\u8303\u56f4\u3002\u6bd4\u5982\u8bf4\u8fd9\u4e2aID\u57282-5\u4e4b\u95f4\uff0c\u90a3\u4e48\u52a0\u7684\u4e5f\u662f\u8bb0\u5f55\u9501\uff0c\u53ea\u662f\u5b83\u4e0d\u6b62\u4e00\u6761\uff0c\u662f\u597d\u51e0\u6761\uff0c\u5982\u679c\u6ca1\u6709\u8bb0\u5f55\u7684\u8bdd\uff0c \u7167\u6837\u4f1a\u52a0\u9501\uff0c\u4ed6\u53eb\u95f4\u9699\u9501\uff0c\u5c5e\u4e8e\u884c\u9501\u7684\u4e00\u79cd\uff0c\u5bf9\u4e00\u4e9b\u4e0d\u5b58\u5728\u7684\u8bb0\u5f55\u8fdb\u884c\u52a0\u9501\uff0c \u52a0\u9501\u7684\u76ee\u7684\u4e3b\u8981\u662f\u4e3a\u4e86\u9632\u6b62\u5e7b\u8bfb</p> <p>\u5e7b\u8bfb\uff1a</p> <p>\u5982\u679c\u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u91cc\u9762\uff0c \u4e00\u5f00\u59cb\u8bfb\u5230\u7684\u6570\u636e\u662f\u7a7a\u7684\uff0c \u5982\u679c\u4e0d\u52a0\u9501\u7684\u8bdd\u3002 \u5176\u4ed6\u7684\u4e8b\u7269\uff0c\u53c8\u628a\u8fd9\u4e2a\u7a7a\u9699\u589e\u52a0\u4e86\u4e00\u4e2a\u6570\u636e\u3002\u90a3\u4e48\u518d\u6b21\u8bfb\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u9020\u6210\u4e24\u4e2a\u7ed3\u679c\u4e0d\u4e00\u6837\uff0c\u8fd9\u4e2a\u5728\u6570\u636e\u5e93\u91cc\u9762\u53eb\u505a\u5e7b\u8bfb\u3002</p> <p>\u8fd9\u4e2a\u662finnodb\u4e0d\u5141\u8bb8\uff0c\u7136\u540e\u884c\u9501\u91cc\u9762\u8fd8\u6709\u8fd9\u4e2a\u4e34\u952e\u9501\uff0c\u662f\u8bb0\u5f55\u9501\u8ddf\u95f4\u9699\u9501\u7684\u7ec4\u5408\uff0c \u5982\u679c\u8303\u56f4\u67e5\u8be2\u91cc\u9762\u65e2\u6d89\u53ca\u5230\u4e86\u8fd9\u4e2a\u6709\u8bb0\u5f55\u7684ID\uff0c\u53c8\u6d89\u53ca\u5230\u4e86\u6ca1\u6709\u8bb0\u5f55\u7684ID\uff0c\u5c31\u662f\u8bb0\u5f55\u9501\u8ddf\u95f4\u9699\u9501\u7684\u7ec4\u5408\u62f3\uff0c\u4e24\u4e2a\u4e00\u8d77</p> <p>\u52a0\u884c\u9501\u4e5f\u5c31\u662f3\u79cd\uff0c\u8bb0\u5f55\u9501\uff0c\u95f4\u9699\u9501\uff0c\u4e34\u952e\u9501 </p> <p>\u5f53\u7136\u8fd9\u4e9b\u90fd\u662f\u8981\u57fa\u4e8e\u7d22\u5f15, \u5982\u679c\u4f60\u7684\u7d22\u5f15\u4e0d\u5b58\u5728,\u4f1a\u76f4\u63a5\u5347\u7ea7\u4e3a\u8868\u9501,\u9501\u4f4f\u6574\u4e2a\u8868.</p> <p>\u53ea\u8981\u6d89\u53ca\u5230\u8fd9\u4e2a\u8868\u7684\u4fee\u6539\u90fd\u4f1a\u88ab\u963b\u585e, \u4f1a\u4ea7\u751f\u5404\u79cd\u7684\u6162\u65e5\u5fd7,\u7136\u540e\u662f\u6570\u636e\u5e93\u8fde\u63a5\u8d85\u65f6,\u63a5\u53e3\u54cd\u5e94\u8d85\u65f6, \u7f51\u5173\u8d85\u65f6\u7b49\u7b49\u4e00\u7cfb\u5217\u7684\u53cd\u5e94</p>"},{"location":"chap7/Arch_anws/#11_2","title":"11 \u6570\u636e\u5e93\u7684\u4e3b\u952e\u7d22\u5f15\uff0e\u4e8c\u7ea7\u7d22\u5f15","text":"<p>\u7d20\u5f15\u5b58\u5728\u7684\u76ee\u7684\u4e5f\u5c31\u662f\u4e3a\u4e86\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u67e5\u8be2\u6548\u7387\uff0c \u4e0d\u7ba1\u8868\u6709\u6ca1\u6709\u4e3b\u52a8\u8bbe\u7f6e\u7d22\u5f15\uff0c\u5176\u5b9e\u90fd\u4f1a\u6709\u4e00\u4e2a\u9ed8\u8ba4\u7684\u7d22\u5f15\uff0c\u8fd9\u4e2a\u9ed8\u8ba4\u7684\u7d22\u5f15\uff0c\u5c31\u662f\u6570\u636e\u5e93\u91cc\u9762\u7684\u4e3b\u952e\u7d22\u5f15\uff0c\u53c8\u53eb\u805a\u7b77\u7d22\u5f15\uff0c\u4e3b\u952e\u7d22\u5f15\u91cc\u9762\u5b58\u50a8\u4e86\u8fd9\u6761\u8bb0\u5f55\u7684\u6240\u6709\u6570\u636e\uff0c\u53ea\u8981\u8fd9\u6761\u8bb0\u5f55\u5b58\u5728\uff0c \u90a3\u4e48\u5c31\u4f1a\u6709\u4e3b\u952e\u7d22\u5f15</p> <p>\u4e3b\u952e\u7d22\u5f15\uff0c\u6309\u7167b+\u6811\u7684\u89c4\u5219\u6392\u5217\u597d\u4e3b\u952eId, \u4ece\u5c0f\u5230\u5927\u6392\u5217, \u8fd9\u4e2a\u65f6\u5019\u5462\u5982\u679c\u8981\u63d2\u5165\u4e00\u6761\u8bb0\u5f55, \u5c31\u4f1a\u5148\u8ba1\u7b97ID\u5728b+\u6811\u4e0a\u7684\u4f4d\u7f6e,\u7136\u540e\u6267\u884c\u63d2\u5165</p> <p>\u4e8c\u7ea7\u7d22\u5f15,\u9664\u4e86\u4e3b\u952e\u7d22\u5f15\u4ee5\u5916, \u5176\u4ed6\u52a0\u7684\u6240\u6709\u7684\u7d20\u5f15\u90fd\u662f\u4e8c\u7ea7\u7d22\u5f15. \u4e3b\u952e\u7d22\u5f15\u91cc\u5b58\u7684\u662f\u8bb0\u5f55, \u4e8c\u7ea7\u7d22\u5f15\u91cc\u5b58\u7684\u662f\u4e3b\u952e\u7d20\u5f15</p> <p>\u4e8c\u7ea7\u7d22\u5f15\u5b58\u5728\u7684\u76ee\u7684\u5c31\u662f\u4e3a\u4e86\u627e\u5230\u4e3b\u952e\u7d22\u5f15, \u56e0\u4e3a\u6240\u6709\u7684\u6570\u636e\u90fd\u5728\u4e3b\u952e\u7d22\u5f15\u91cc\u9762</p>"},{"location":"chap7/Arch_anws/#12-no","title":"12 \u7d22\u5217\u52a0\u7684\u8d8a\u591a\u8d8a\u597d -  No","text":"<p>\u7d22\u5f15\u7528\u7684\u662fb+\u6811, \u6bcf\u52a0\u4e00\u4e2a\u7d22\u5f15, \u5176\u5b9e\u5c31\u4f1a\u589e\u52a0\u4e00\u68f5b\u52a0\u6811\uff0c\u6240\u4ee5\u7d22\u5f15\u8d8a\u591a\uff0c\u81ea\u7136\u8fd9\u4e2a\u6811\u7684\u68f5\u6570\u5c31\u4f1a\u8d8a\u591a\uff0c \u90a3\u4e48\u518d\u52a0\u4e0a\u8868\u7684\u6570\u636e\u6301\u7eed\u589e\u5927\uff0c\u90a3\u4e48\u6811\u4e0a\u7684\u53f6\u5b50\u5c31\u4f1a\u8d8a\u6765\u8d8a\u591a\uff0c\u5c31\u5360\u7684\u8fd9\u4e2a\u78c1\u76d8\u7a7a\u95f4\u4e5f\u5c31\u8d8a\u6765\u8d8a\u5927\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\u5462\u4ecesql\u6548\u7387</p> <p>\u7d22\u5f15\u591a\u4e86\uff0c\u67e5\u8be2\u4e0a\u80af\u5b9a\u662f\u6ca1\u95ee\u9898\u3002 \u67e5\u7684\u5feb\uff0c\u4f46\u662f\u5bf9\u4e8e\u8868\u7684\u64cd\u4f5c\uff0c\u50cf\u65b0\u589e\uff0c\u4fee\u6539\uff0c\u5220\u9664\u6548\u7387\u5c31\u4f1a\u53d8\u4f4e\u3002 \u6bcf\u64cd\u4f5c\u4e00\u56de\uff0c\u90fd\u5f97\u7ef4\u62a4\u4e00\u4e0b\u6240\u6709\u7684\u7d22\u5f15\u6811\uff0c \u5982\u679c\u65b0\u589e\u7684\u8bdd\uff0c\u8fd8\u8981\u53bb\u68c0\u7d22\u6dfb\u52a0\u7684\u4f4d\u7f6e\uff0c\u56e0\u4e3aB+\u6811\u662f\u4ece\u5c0f\u5230\u5927\u6392\u5217\uff0c\u589e\u52a0\u4e00\u4e2a\u5c31\u5f97\u91cd\u65b0\u6392\u5e8f\uff0c \u5f53\u7136\u5982\u679c\u5f53\u524d\u7684\u6570\u636e\u9875\u6ee1\u4e86\uff0c\u8fd8\u8981\u91cd\u65b0\u53bb\u521b\u5efa\u65b0\u7684\u6570\u636e\u9875\uff0c\u90a3\u4e48\u6574\u4e2a\u7684\u68c0\u7d22\u5440\u6392\u5e8f\uff0c\u521b\u5efa\uff0c\u63d2\u5165\uff0c\u5c31\u4f1a\u5927\u5927\u7684\u964d\u4f4e\u64cd\u4f5c\u7684\u6027\u80fd</p> <p>\u5bf9\u67e5\u8be2\u786e\u5b9e\u4e0d\u9519\uff0c\u4f46\u662f\u5bf9\u4e8e\u589e\u5220\u6539\u6ca1\u90a3\u4e48\u53cb\u597d\u4e86\uff0c\u5bf9\u4e8e\u7d22\u5f15\u7684\u6dfb\u52a0\uff0c\u516c\u53f8\u89c4\u5b9a\u4e0d\u662f\u90a3\u4e48\u968f\u4fbf\u52a0\u7684\u3002</p> <ul> <li>\u5355\u8868\u7d22\u5f15\u7684\u4e2a\u6570\u4e0d\u80fd\u8d85\u8fc73-5\u4e2a</li> <li>\u5bf9\u4e8e\u4e00\u4e9b\u9891\u7e41\u64cd\u4f5c\u7684\u4e00\u4e9b\u8868\uff0c\u5c3d\u91cf\u4e0d\u80fd\u5efa\u592a\u591a\u7684\u7d22\u5f15\uff0c\u8981\u5c3d\u91cf\u9009\u62e9\u4e00\u4e9b\u64cd\u4f5c\u91cf\u6bd4\u8f83\u5927\u7684\u5b57\u6bb5\u6216\u8005\u5173\u8054\u7684\u6570\u91cf\uff0c\u53bb \u5efa\u6bd4\u8f83\u5927\u7684\u5b57\u6bb5\u6765\u4f5c\u4e3a\u7d22\u5f15</li> </ul>"},{"location":"chap7/Arch_anws/#13_2","title":"13 \u9ad8\u5e76\u53d1\u4e0b\u4e00\u5b9a\u9002\u5408\u7528\u4e50\u89c2\u9501\u5417\uff1f","text":"<p>\u9009\u7528\u4e50\u89c2\u9501\u56e0\u4e3a\u4e0d\u5b58\u5728\u9501\u7ade\u4e89\uff0c\u6ca1\u6709\u90a3\u4e48\u591a\u7684\u51b2\u7a81\u3002</p> <p>\u9996\u5148\u540c\u4e00\u65f6\u523b\u9ad8\u5e76\u53d1\u4e0b\u8bfb\u53d6\u8d44\u6e90\u7684\u7ebf\u7a0b\u5c31\u6709\u5f88\u591a\uff0c\u4f46\u662f\u53ea\u80fd\u6709\u4e00\u4e2a\u80fd\u66f4\u65b0\u4e0a\u53bb\uff0c\u56e0\u4e3a\u4e50\u89c2\u9501\u7684\u673a\u5236\uff0c\u90a3\u4e48\u5176\u4ed6\u7684\u8bf7\u6c42\u5c31\u4f1a\u5927\u9762\u79ef\u7684\u5931\u8d25\uff0c\u56e0\u4e3a\u7248\u672c\u53f7\u4e0d\u4e00\u81f4\u3002\u90a3\u4e48\u4e00\u65e6\u66f4\u65b0\u5931\u8d25\uff0c \u524d\u7aef\u5c31\u4f1a\u6709\u8fd9\u4e2a\u91cd\u8bd5\u673a\u5236\uff0c\u5c31\u4f1a\u4e0d\u505c\u7684\u53bbget\u8fd9\u4e2a\u8d44\u6e90\uff0c\u5c31\u4f1a\u589e\u52a0\u67e5\u8be2\u63a5\u53e3\u7684\u538b\u529b</p> <p>\u5176\u6b21\u6211\u4eec\u4ece\u6570\u636e\u5e93\u7684\u89d2\u5ea6\uff0c\u540c\u6837\u4e5f\u4f1a\u5b58\u5728\u95ee\u9898\uff0c\u6bd4\u5982\u8bf4\u9501\u7ade\u4e89\uff0cupdate\u66f4\u65b0\u8bed\u53e5\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u7684\u4f7f\u7528\u7684\u662f\u884c\u9501\uff0c\u5373\u4f7f\u6ca1\u6709\u5f00\u542f\u624b\u52a8\u5f0f\uff0c \u6ca1\u6709\u7528for update, \u5b9e\u9645\u4e0a\u53bb\u66f4\u65b0\u4e00\u6761\u6570\u636e, \u540c\u6837\u4e5f\u4f1a\u6709\u9501\u4f4f\u8d44\u6e90,\u53ea\u662f\u901f\u5ea6\u6bd4\u8f83\u5feb\u4f60\u6ca1\u6709\u611f\u77e5</p> <p>\u5982\u679c\u5927\u6279\u91cf\u7684update\u7684\u8fc7\u6765\uff0c \u540c\u4e00\u65f6\u523bupdate\u5c31\u4f1a\u4e0d\u505c\u7684\u53bb\u4e89\u62a2\u884c\u9501\uff0c \u540c\u6837\u4f1a\u5b58\u5728\u9501\u7ade\u4e89\uff0c\u5982\u679c\u91cf\u4e00\u4e0a\u53bb\u6574\u4e2a\u6548\u7387\u5c31\u4f1a\u4e0b\u964d\uff0c\u540c\u6837\u4e5f\u4f1a\u5b58\u5728\u6027\u80fd\u95ee\u9898\u3002</p> <p>\u6240\u4ee5\u9ad8\u5e76\u53d1\u4e0b\uff0c\u6279\u91cf\u7684\u66f4\u65b0\u64cd\u4f5c\uff0c\u80af\u5b9a\u662f\u4e0d\u9002\u5408\u7684\uff0c\u5efa\u8bae\u4f7f\u7528\u8fd9\u4e2aRedis\u6765\u505a\u5e93\u5b58\u7684\u9884\u6263\u51cf\uff0c \u7136\u540e\u5b9a\u671f\u7684\u505a\u597dredis\uff0c\u8ddf\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u540c\u6b65</p> <p>\u90a3\u4e48\u4ec0\u4e48\u573a\u666f\u4e0b\u80fd\u7528\u4e50\u89c2\u9501\uff0c \u90a3\u5c31\u662f\u8bfb\u591a\u5199\u5c11\uff0c\u6709\u8d44\u6e90\u7ade\u4e89\u4f46\u662f\u4e0d\u591a\uff0c\u90a3\u4e48\u4e50\u89c2\u9501\u5c31\u518d\u5408\u9002\u4e0d\u8fc7\u4e86</p>"},{"location":"chap7/Arch_anws/#14_1","title":"14 \u5982\u4f55\u9632\u6b62\u6570\u636e\u5e93\u7684\u6b7b\u9501","text":"<p>\u90a3\u4e48\u6b7b\u9501\u600e\u4e48\u4ea7\u751f\uff0c\u603b\u7ed3\u4e0b\u6765\u5c31\u4e00\u6761\u5c31\u662f\u4e0d\u540c\u7684\u4e8b\u52a1\u4e4b\u95f4\u53d1\u751f\u4e86\u5faa\u73af\u4f9d\u8d56\uff0c\u6bd4\u5982\u8bf4\u4e8b\u7269a\u8ddf\u4e8b\u7269b\uff0c\u5206\u522b\u5360\u7528\u4e86\u8d44\u6e90x\u8ddf\u8d44\u6e90y\uff0c\u5f53a\u8bd5\u56fe\u8bf7\u6c42y\u7684\u65f6\u5019\uff0c\u4e8b\u7269b\u5374\u53c8\u5360\u7528\u4e86y\uff0c\u8fd9\u4e2a\u65f6\u5019\u5462a\u5c31\u4f1a\u88ab\u963b\u585e\uff0c\u540c\u6837\u7684\u5f53b\u8bd5\u56fe\u8bf7\u6c42x\uff0c\u800ca\u53c8\u5360\u7528\u4e86x\u7684\u65f6\u5019\uff0cb\u4e5f\u4f1a\u88ab\u963b\u585e\uff0c\u8fd9\u4e2a\u65f6\u5019\u5462a\u8ddfb\u90fd\u65e0\u6cd5\u7ee7\u7eed\u6267\u884c\uff0c\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u6b7b\u9501\u3002</p> <p>\u4e5f\u6709\u53ef\u80fd\u662f\u591a\u4e2a\u4e8b\u52a1\u4e4b\u95f4\uff0c\u53d8\u6210\u4e86\u4e00\u79cd\u5faa\u73af\u4f9d\u8d56\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u53d1\u751f\u4e86\u6570\u636e\u5e93\u7684\u6b7b\u9501\uff0c \u6bd4\u8f83\u5e38\u89c1\u7684\u573a\u666f\u5c31\u662f\u76f8\u4e92\u8f6c\u8d26\uff0c</p> <ul> <li>\u6bd4\u8f83\u5e38\u89c1\u7684\u89e3\u6c7a\u65b9\u6848\uff0c\u5c31\u662f\u52a0\u4e0a\u5206\u5e03\u5f0f\u9501\uff0c\u4fdd\u8bc1ab\u4e4b\u95f4\u7684\u8f6c\u8d26\u4e1a\u52a1\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u5904\u7406</li> <li>\u53e6\u5916\u4e00\u79cd\u5904\u7406\u65b9\u5f0f\uff0c\u5c31\u662f\u89c4\u5b9a\u7ebf\u7a0b\u52a0\u9501\u7684\u987a\u5e8f\u8981\u4e00\u81f4\uff0c \u6bd4\u5982\u8bf4\u5148\u9501\u5b9aa\u7684\u8d26\u6237\uff0c\u7136\u540e\u518d\u9501\u5b9ab\u7684\u8d26\u6237\uff0c\u8fd9\u6837\u7684\u8bdd\u6240\u6709\u7684\u8bf7\u6c42\u90fd\u4f1a\u5148\u6309\u7167\u5148a\u540eb\u7684\u987a\u5e8f\u8fdb\u884c\u52a0\u9501\uff0c\u81ea\u7136\u800c\u7136\u5c31\u6ca1\u6709\u6b7b\u9501\u7684\u53d1\u751f\u4e86\uff0c</li> <li>\u4f18\u5316SQL\u8bed\u53e5\u548c\u7d22\u5f15\uff0c \u4e5f\u53ef\u4ee5\u51cf\u5c11\u5bf9\u540c\u4e00\u6570\u636e\u884c\u7684\u7ade\u4e89\uff0c \u52a0\u9501\u5c3d\u91cf\u52a0\u5728\u884c\u7d22\u4e0a\uff0c\u5b83\u7684\u8303\u56f4\u5c31\u4f1a\u7f29\u51cf\u4e86\uff0c\u81ea\u7136\u5c31\u80fd\u591f\u964d\u4f4e\u6b7b\u9501\u7684\u6982\u7387\u4e86\u3002\u5927\u591a\u6570\u6570\u636e\u5e93\uff0c\u4e5f\u4f1a\u63d0\u4f9b\u6b7b\u9501\u7684\u68c0\u6d4b\u548c\u8d85\u65f6\u673a\u5236\uff0c \u5f53\u53d1\u73b0\u6b7b\u9501\u65f6\uff0c\u6570\u636e\u5e93\u4f1a\u81ea\u52a8\u56de\u6eda\u5176\u4e2d\u4e00\u4e2a\u4e8b\u52a1\u6765\u91ca\u653e\u8d44\u6e90,\u907f\u514d\u4e86\u6b7b\u9501\u7684\u8fdb\u4e00\u6b65\u6269\u5927</li> <li>\u8d85\u65f6\u673a\u5236, \u5219\u53ef\u4ee5\u5728\u4e00\u5b9a\u7684\u65f6\u95f4\u5185, \u4e3b\u52a8\u7ed3\u675f\u4e8b\u7269\u6765\u91ca\u653e\u8d44\u6e90, \u907f\u514d\u6b7b\u9501\u7684\u957f\u65f6\u95f4\u6301\u7eed,\u4e5f \u80fd\u591f\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u5e76\u53d1\u6027\u80fd</li> </ul>"},{"location":"chap7/Arch_anws/#15_2","title":"15 \u96c6\u5408\u6570\u636e\u7684\u66f4\u65b0\uff0c\u5148\u5220\u540e\u589e\u4f1a\u80b2\u4ec0\u4e48\u95ee\u9898\uff1f","text":"<p>\u5982\u679c\u9700\u8981\u66f4\u65b0\u7684\u6570\u636e\uff0c\u6570\u636e\u5e93\u73b0\u6709\u7684\u6570\u636e\u91cf\u4e0d\u4e00\u81f4\uff0c</p> <p>\u89e3\u51b3\u65b9\u6848\uff1a\u635e\u53d6\u5f53\u524d\u4e1a\u52a1\u573a\u666f\u4e2d\u5b58\u5728\u7684\u65e7\u6570\u636e\u7136\u540e\u6839\u636e\u8bf7\u6c42\u7684\u8fd9\u4e2a\u6570\u636e\u6765\u505a\u5bf9\u6bd4</p> <ul> <li>\u5982\u679c\u5728\u8001\u6570\u636e\u4e0d\u5b58\u5728\uff0c\u90a3\u5c31\u4ee3\u8868\u662f\u65b0\u589e\u7684\u6570\u636e\uff0c\u5c31\u8981\u6267\u884c\u8fd9\u4e2ainsert\u7684\u64cd\u4f5c</li> <li>\u5982\u679c\u5728\u8001\u6570\u636e\u4e2d\u5b58\u5728\uff0c\u5982\u679c\u5386\u53f2\u6570\u636e\u4e2d\u7684\u6570\u636e\u5728\u8bf7\u6c42\u7684\u5165\u53c2\u4e2d\u4e0d\u5b58\u5728\uff0c\u90a3\u5c31\u9700\u8981\u5220\u9664\u5386\u53f2\u6570\u636e</li> </ul> <p>\u4f46\u662f\u8fd9\u79cd\u5904\u7406\u65b9\u5f0f\u6bd4\u8f83\u8d39\u52b2\uff0c\u5c31\u4f1a\u91c7\u7528\u4e00\u4e9b\u6bd4\u8f83\u66b4\u529b\u7684\u8fd9\u4e2a\u505a\u6cd5\uff0c\u5c31\u662f\u5168\u90e8\u5e72\u6389\u6570\u636e\uff0c\u5148\u628a\u5168\u90e8\u7684\u6570\u636e\u5220\u6389\uff0c\u7136\u540e\u518d\u65b0\u589e\uff0c\u5f88\u591a\u516c\u53f8\u90fd\u660e\u4ee4\u7981\u6b62\u8fd9\u79cd\u505a\u6cd5</p> <ol> <li>\u4e3b\u952e\u7684\u65ad\u5c42\uff0c\u5982\u679c\u662f\u7269\u7406\u5220\u9664\uff0c\u5927\u91cf\u7684\u4e3b\u952eID\u7f3a\u5931\uff0c\u5c31\u4f1a\u51fa\u73b0\u65ad\u5c42\u7684\u73b0\u8c61\uff0c\u90a3\u4e48\u5927\u91cf\u7684ID\u7a7a\u95f4\u6d6a\u8d39\uff0c\u4e5f\u4f1a\u5bfc\u81f4\u7d22\u5f15\u7684\u5206\u88c2\u548c\u788e\u7247\u5316\uff0c\u81ea\u7136\u67e5\u8be2\u6548\u7387\u4e5f\u4f1a\u53d8\u4f4e\uff0c\u5305\u62ec\u540e\u7eed\u6570\u636e\u7684\u7ef4\u62a4\uff0c\u8fc1\u79fb\uff0c\u5206\u5e93\u5206\u8868</li> <li>\u4e3b\u952e\u65ad\u5c42\uff0c\u4e5f\u4f1a\u5bfc\u81f4\u8fd9\u4e2a\u6570\u636e\u4e0d\u5747\u5300\uff0c\u6570\u636e\u503e\u659c\uff0c\u6027\u80fd\u7684\u6d6a\u8d39</li> </ol> <p>\u6bd4\u5982\u53ea\u8981\u65b0\u589e\u4e00\u6761\u6570\u636e\uff0c\u672c\u4e0d\u5e94\u8be5\u5220\u9664\u7684\u6570\u636e\uff0c\u7136\u540e\u8981\u91cd\u65b0\u6dfb\u52a0\uff0c\u8fd9\u4e2a\u4e00\u5220\u4e00\u589e\u7684\u8fc7\u7a0b\uff0c\u5f88\u660e\u663e\u5c31\u4f1a\u6d6a\u8d39\u5f88\u5927\u7684\u6570\u636e\u5e93\u6027\u80fd</p> <p>\u6bd4\u8f83\u4e25\u8c28\u7684\u5904\u7406\u65b9\u5f0f\u8fd8\u662f\u5206\u522b\uff0c\u901a\u8fc7\u5224\u65ad\u6765\u53bb\u5904\u7406\u65b0\u589e\u4fee\u6539\u548c\u5220\u9664\uff0c\u5bf9\u4e8e\u6574\u4e2a\u4e1a\u52a1\u8fd8\u7b97\u7a33\u59a5</p> <p>\u5f53\u7136\u65b0\u589e\u548c\u4fee\u6539\uff0c\u53ef\u4ee5\u505a\u4e00\u4e9b\u4f18\u5316\u4e86\uff0c\u6bd4\u8f83\u5e38\u7528\u7684\u65b9\u5f0f\u5462\u5c31\u662f\u7528\u8fd9\u4e2a\u201cINSERT ON DUPLICATE KEY UPDATE\u201d\uff0c\u5728\u6267\u884c\u65f6\u4f1a\u68c0\u67e5\u662f\u5426\u5df2\u7ecf\u5b58\u5728\u4e00\u4e2aunique\u952e\u7684\u7ea6\u675f\u7684\u8bb0\u5f55\u3002</p> <p>\u5982\u679c\u5b58\u5728\u5c31\u6267\u884c\u66f4\u65b0\u7684\u64cd\u4f5c\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5c31\u6267\u884c\u63d2\u5165\u7684\u64cd\u4f5c\uff0c\u8fd9\u6837\u7684\u8bdd\u5c31\u76f8\u5f53\u4e8e\u5c11\u4e86\u4e00\u6b65\uff0c\u628a\u51b3\u5b9a\u65b0\u589e\u8fd8\u662f\u4fee\u6539\u632a\u5230\u6570\u636e\u5e93\u6765\u505a</p>"},{"location":"chap7/Arch_anws/#5-nginx","title":"5 Nginx","text":""},{"location":"chap7/Arch_anws/#1-nginx","title":"1 nginx\u7684\u9ad8\u53ef\u7528\u53ca\u96c6\u7fa4\u65b9\u6848","text":"<ul> <li>\u4f20\u7edf\u7684\u65b9\u6848\u662f\u91c7\u7528nginx\u52a0keepalive\uff0c\u4e00\u4e3b\u4e00\u4ece\uff0c\u5982\u679c\u4e3b\u670d\u6302\u6389\u4e86\uff0c\u90a3\u4e48keepalive\u5c31\u4f1a\u505c\u6389\u4e3b\u670d\u3002\u628a\u5907\u7528\u7684nginx\u9876\u4e0a\u6765\uff0c\u6765\u4f5c\u4e3a\u4e3b\u670d\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u3002 \u6216\u8005\u53cc\u4e3b\u4e5f\u53ef\u4ee5</li> </ul> <p>\u5982\u679c\u5355\u53f0nginx\u8fbe\u5230\u74f6\u9888\u4e86\uff0c\u5982\u679c\u4f60\u8981\u60f3\u8ba9\u66f4\u591a\u7684\u7528\u6237\u8fdb\u6765\uff0c\u5c31\u5fc5\u987b\u8fdb\u884c\u8fd9\u4e2a\u7f51\u5173\u7684\u6269\u5bb9\u3002\u53ef\u4ee5\u6269\u5c55\u52304\u52305\u53f0\uff0c\u8c01\u6765\u505a\u8fd9\u4e9bnginx\u7684\u8def\u7531\u8d1f\u8f7d\u3002 \u8bf7\u6c42\u5206\u53d1\uff0c\u6bd5\u7adf\u6269\u5bb9\u7684nginx\u662f\u76f8\u5bf9\u72ec\u7acb\u7684\u3002</p> <p>\u6bcf\u4e00\u4e2anginx\u5176\u5b9e\u90fd\u6709\u4e00\u4e2a\u72ec\u7acb\u7684IP\uff0c\u5e76\u53d1\u66f4\u9ad8\u7684\u8fd9\u4e2aLVS\uff0c\u5b83\u662f\u4e00\u4e2a\u865b\u62df\u7684\u8fd9\u4e2a\u670d\u52a1\u5668\u96c6\u7fa4\u7cfb\u7edf\u3002 \u56e0\u4e3a\u5b83\u5de5\u4f5c\u5728\u4f20\u8f93\u5c42\uff0c \u6240\u4ee5\u5b83\u7684\u8f6c\u6362\u6548\u7387\u8fd8\u662f\u6bd4\u8f83\u9ad8\uff0c \u53ef\u4ee5\u652f\u6301\u51e0\u5341\u4e07\u7684\u8fd9\u4e2a\u5e76\u53d1\u8bf7\u6c42\uff0c\u6240\u4ee5\u7528\u5b83\u6765\u4ee3\u7406nginx\u96c6\u7fa4\uff0c\u65b9\u5411\u4e0a\u9762\u662f\u53ef\u884c\u7684</p> <p>\u4e5f\u53ef\u4ee5\u7528\u4e91\u5382\u5546\u7684\u8d1f\u8f7d\u5747\u8861\uff0c \u5c31\u662f\u4e91\u670d\u52a1\u5668\u8c8c\u4f3c\u4e0d\u652f\u6301\u865a\u62dfIP\uff0c\u5982\u679c\u60f3\u8981\u901a\u8fc7keepalive\uff0c\u5728\u4e91\u670d\u52a1\u5668\u4e0a\u9762\u53bb\u5b9e\u73b0\u9ad8\u53ef\u7528\uff0c \u8981\u4f7f\u7528\u8fd9\u4e2a\u865a\u62dfIP\uff0c\u8fd9\u4e2a\u65b9\u6848\u53ef\u80fd\u4e0d\u5927\u73b0\u5b9e\u3002 \u5176\u5b9e\u53ef\u4ee5\u4e0a\u8fd9\u4e2a\u786c\u4ef6\u8d1f\u8f7dF5</p>"},{"location":"chap7/Arch_anws/#6_3","title":"6 \u8bbe\u8ba1\u6a21\u5f0f","text":""},{"location":"chap7/Arch_anws/#1_5","title":"1 \u65e5\u5e38\u642c\u7816\u4e2d\u7528\u5230\u7684\u8bbe\u8ba1\u6a21\u5f0f","text":"<p>\u7b56\u7565\u6a21\u5f0f\uff0c\u5c06\u4e0d\u540c\u7684\u652f\u4ed8\u65b9\u5f0f\u901a\u8fc7\u4e0d\u540c\u7684\u63a5\u53e3\u6765\u5b9e\u73b0\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570\u6765\u51b3\u5b9a\u5177\u4f53\u4f7f\u7528\u54ea\u79cd\u7b56\u7565\uff0c\u8fd9\u6837\u505a\u7684\u597d\u5904</p> <ul> <li>\u4e00\u662f\u7684\u4ee3\u7801\u6e05\u6670\uff0c\u65b9\u4fbf\u540e\u671f\u7684\u7ef4\u62a4\uff0c</li> <li>\u4e8c\u6765\u5982\u679c\u6709\u65b0\u589e\u7684\u652f\u4ed8\u65b9\u5f0f\uff0c\u53ea\u8981\u5b9e\u73b0\u652f\u4ed8\u7684\u63a5\u53e3\u5c31\u53ef\u4ee5\u4e86\uff0c\u4e0d\u9700\u8981\u4fee\u6539\u539f\u6709\u7684\u4ee3\u7801\u51cf\u5c11\u4e86\u98ce\u9669\uff0c \u4e0d\u9700\u8981\u4fee\u6539\u539f\u6709\u7684\u4ee3\u7801\u51cf\u5c11\u4e86\u98ce\u9669</li> </ul> <p>\u8fd9\u4e2a\u662f\u7b56\u7565\u6a21\u5f0f</p> <p>\u8fd8\u6709\u4e00\u4e9b\u975e\u4e3b\u6d41\u7a0b\u7684\u4e00\u4e9b\u529f\u80fd\uff0c \u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2a\u5173\u952e\u65e5\u5fd7\u7684\u6536\u96c6\uff0c\u90a3\u4e48\u5982\u679c\u5199\u5728\u4ee3\u7801\u91cc\u5c31\u5f88\u70e6\uff0c\u903b\u8f91\u90fd\u662f\u4e00\u6837\u7684\uff0c \u6bcf\u89c1\u4e00\u4e2a\u65b9\u6cd5\u90fd\u8981\u5199\u4e00\u4e2a\u6536\u96c6\uff0c\u6bd4\u8f83\u9ebb\u70e6</p> <p>\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u4f7f\u7528\u5207\u9762\uff0c \u4e5f\u5c31\u662f\u6211\u4eec\u5e38\u8bf4\u7684\u8fd9\u4e2aaop\uff0c\u901a\u8fc7\u5207\u7247\u7684\u65b9\u5f0f\u76f4\u63a5\u622a\u53d6\u53c2\u6570\uff0c\u7136\u540e\u4ea4\u7531\u4e13\u95e8\u7684\u65e5\u5fd7\u6536\u96c6\u7c7b\u6765\u5904\u7406\uff0c\u8fd9\u79cdAOP\u7684\u5207\u9762\u7684\u65b9\u5f0f\uff0c\u5e94\u8be5\u7b97\u662f\u6bd4\u8f83\u5e38\u89c1\u7684\uff0c\u4e5f\u7528\u5230\u4e86\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u53eb\u505a\u4ee3\u7406\u6a21\u5f0f</p> <p>\u5b9e\u9645\u7684\u8fd9\u4e2a\u65e5\u5fd7\u6536\u96c6\uff0c\u662f\u7531\u65e5\u5fd7\u6536\u96c6\u7c7b\u6765\u5b9e\u73b0\u7684\uff0c\u5b83\u662f\u65b9\u6cd5\u4e2d\u65e5\u5fd7\u6536\u96c6\u7684\u4ee3\u7406\uff0c\u6240\u4ee5\u53eb\u505a\u4ee3\u7406\u6a21\u5f0f</p> <p>\u5f53\u7136\u4ee3\u7406\u6a21\u5f0f\u8fdc\u4e0d\u6b62AOP\uff0c\u50cf\u5fae\u670d\u52a1\u4e4b\u95f4\u7684\u8c03\u7528\uff0c\u4e5f\u7528\u7684\u4ee3\u7406\u6a21\u5f0f\uff0c\u8c03\u7528\u8fdc\u7a0b\u7684\u670d\u52a1\uff0c\u53ef\u4ee5\u50cf\u672c\u5730\u4e00\u6837\u65b9\u4fbf</p> <p>\u90a3\u4e48\u9664\u4e86\u4ee3\u7406\u6a21\u5f0f\uff0c\u7b56\u7565\u6a21\u5f0f\u8fd8\u6709\u5f88\u591a\u5176\u4ed6\u7684\u8bbe\u8ba1\u6a21\u5f0f\uff0c \u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\uff0c\u5355\u4f8b\u6a21\u5f0f\u3001\u5efa\u9020\u8005\u6a21\u5f0f\u3001\u9002\u914d\u5668\u6a21\u5f0f\u7b49\u7b49</p>"},{"location":"chap7/Arch_anws/#2_5","title":"2 \u5de5\u5382\u6a21\u5f0f\u3001\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f","text":"<p>\u53ea\u8981\u4f60\u7684\u9879\u76ee\u91cc\u9762\u5b58\u5728interface\uff0c\u90a3\u57fa\u672c\u4e0a\u5c31\u4f1a\u7528\u5230\u5de5\u5382\u6a21\u5f0f\uff0cinterface\u8bf4\u5230\u5e95\u5b83\u5c31\u662f\u4e00\u4e2a\u5de5\u5382\uff0c\u63d0\u4f9b\u4e00\u4e2a\u6807\u51c6\u3002</p> <p>\u63a5\u53e3\u5b9e\u73b0\u7c7b\uff0c\u5b83\u5c31\u662f\u76f8\u5f53\u4e8e\u8fd9\u4e2a\u6807\u51c6\uff0c\u5bf9\u5e94\u7684\u4e0d\u540c\u7684\u5b9e\u73b0\u3002\u4e3e\u4e2a\u4f8b\u5b50\u6bd4\u5982\u8bf4\u4e0a\u4f20\u6587\u4ef6\uff0c\u5bf9\u5e94\u4e86\u597d\u51e0\u4e2a\u6587\u4ef6\u4e2d\u5fc3\uff0c\u5c31\u53ef\u4ee5\u5b9a\u4e00\u4e2a\u4e0a\u4f20\u7684\u63a5\u53e3\u5de5\u5382\u7c7b\uff0c\u91cc\u9762\u6709\u6587\u4ef6\u540d\u7684\u83b7\u53d6\uff0c\u6d41\u7684\u83b7\u53d6\uff0c\u5305\u62ec\u4e0a\u4f20\u5730\u5740\uff0c\u7aef\u53e3\uff0c\u4e0d\u540c\u7684\u5b9e\u73b0\u7c7b\u6765\u5b9e\u73b0\uff0c\u4e0d\u540c\u7684\u8fd9\u4e2a\u4e0a\u4f20\u65b9\u5f0f\uff0c\u4e0a\u4f20\u5904\u7406\u5c31\u6bd4\u8f83\u6e05\u6670\uff0c\u4e0d\u7528\u518d\u53bb\u901a\u8fc7if else \u6765\u505a\u591a\u5c42\u7ea7\u5d4c\u5957\u4e86</p> <p>\u5728\u6280\u672f\u6846\u67b6\u91cc\u9762\uff0c\u6bd4\u5982\u8bf4\u5728spring\u91cc\u9762\u6bd4\u8f83\u5e38\u7528\u7684bean, \u90a3\u4e48\u5f88\u591a\u7684\u57fa\u7840\u914d\u7f6e\u90fd\u653e\u5728bean\u91cc\u9762\u3002 \u5728spring MVC\u7684\u65f6\u4ee3\uff0c\u8fd8\u9700\u8981\u624b\u5199bean\u7684\u914d\u7f6e\u8981\u914d\u5728\u8fd9\u4e2axml\u91cc\u9762\uff0c \u73b0\u5728\u4e5f\u90fd\u662f\u7528\u7684\u6ce8\u89e3\uff0c\u90a3\u4e48\u914d\u7f6e\u5199\u597d\u4e86\uff0c\u5c31\u901a\u8fc7BeanFactory, \u6765\u521b\u5efabean\u7684\u5bf9\u8c61, \u8fd9\u6837\u6574\u4e2a\u9879\u76ee\u624d\u53ef\u4ee5\u8bbf\u95ee\u5230bean. </p> <p>\u6574\u4e2abean\u7684\u521b\u5efa\u8fc7\u7a0b, \u5176\u5b9e\u5c31\u662f\u7b80\u5355\u5de5\u5382\u6a21\u5f0f\u7684\u4e00\u4e2a\u4f53\u73b0, \u90a3\u4e48\u628a\u4e00\u4e2abean\u9700\u8981\u7684\u5185\u5bb9, \u65b9\u6cd5\u901a\u901a\u653e\u5230\u5de5\u5382\u91cc\u9762, \u5c31\u662f\u4e00\u4e2a\u6bd4\u8f83\u6807\u6dee\u7684\u5b9e\u4f53.</p> <p>\u5c31\u53ef\u4ee5\u8ba4\u4e3a\u5de5\u5382\u6a21\u5f0f\u5c31\u662f\u4e00\u79cd\u516c\u5171\u7684\u6807\u51c6, \u6240\u6709\u7684\u76f8\u5173\u7c7b\u522b\u7684\u5b9e\u73b0\u90fd\u9700\u8981\u901a\u8fc7\u8fd9\u4e2a\u5de5\u5382\u7684\u6807\u51c6\u624d\u80fd\u7528</p> <p>\u90a3\u4e48\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u5c31\u66f4\u52a0\u7b80\u5355\u4e86, \u5b83\u5c31\u662f\u5404\u4e2a\u5de5\u5382\u6a21\u5f0f\u7684\u4e00\u4e2a\u7ec4\u5408</p>"},{"location":"chap7/Arch_anws/#3_4","title":"3 \u8ba2\u5355\u8d85\u65f6\u5173\u95ed\u7684\u51e0\u79cd\u65b9\u6848","text":"<p>\u901a\u5e38\u4f1a\u51fa\u73b0\u4e00\u4e2a\u8ba2\u5355\u622a\u6b62\u65f6\u95f4\uff0c\u622a\u6b62\u65f6\u95f4\u5230\u4e86\uff0c\u5982\u679c\u8fd8\u6ca1\u6709\u652f\u4ed8\uff0c\u5c31\u9700\u8981\u7cfb\u7edf\u53bb\u53d6\u6d88\u5f53\u524d\u7684\u8ba2\u5355\u91ca\u653e\u5e93\u5b58</p> <p>\u9996\u5148\u662f\u5b9a\u65f6\u4efb\u52a1</p> <p>\u7cfb\u7edf\u6bcf\u9694\u51e0\u79d2\u949f\u67e5\u4e00\u4e0b\u5e93\uff0c\u5982\u679c\u8fc7\u671f\u4e86\u5c31\u76f4\u63a5\u53d6\u6d88\uff0c \u901a\u5e38\u4f1a\u7528\u5230xxl-job, quartz \u8fd9\u4e9b\u5b9a\u65f6\u4efb\u52a1\u7684\u7ec4\u4ef6, \u4e5f\u53ef\u4ee5\u4f7f\u7528Linux\u81ea\u5e26\u7684\u8fd9\u4e2acrontab, \u90fd\u662f\u5b9a\u671f\u6765\u8c03\u7528\u68c0\u67e5\u8ba2\u5355\u7684API</p> <p>\u4e00\u79cd\u662f\u88ab\u52a8\u53d6\u6d88 </p> <p>\u6bd4\u5982\u8bf4\u7528\u6237\u67e5\u770b\u8ba2\u5355\u7684\u65f6\u5019, \u987a\u4fbf\u68c0\u67e5. \u5f53\u524d\u8ba2\u5355\u6709\u6ca1\u6709\u8fc7\u671f, \u5982\u679c\u8fc7\u671f\u4e86\u5c31\u76f4\u63a5\u6e05\u6389, \u662f\u4f9d\u8d56\u4e8e\u5ba2\u6237\u7aef\u7528\u6237\u7684\u4e3b\u52a8\u8bf7\u6c42, \u662f\u4f9d\u8d56\u4e8e\u5ba2\u6237\u7aef\u7528\u6237\u7684\u4e3b\u52a8\u8bf7\u6c42, \u5982\u679c\u7528\u6237\u4e0d\u67e5\u770b</p> <p>\u5982\u679c\u8fc7\u671f\u4e86\u5c31\u76f4\u63a5\u6e05\u6389, \u662f\u4f9d\u8d56\u4e8e\u5ba2\u6237\u7aef\u7528\u6237\u7684\u4e3b\u52a8\u8bf7\u6c42, \u5982\u679c\u7528\u6237\u4e0d\u67e5\u770b\uff0c\u53ef\u80fd\u5c31\u4f1a\u4e00\u76f4\u6302\u7740\uff0c\u5355\u72ec\u4f7f\u7528\u4e0d\u592a\u53ef\u884c\uff0c\u8ddf\u8fd9\u4e2a\u5b9a\u65f6\u4efb\u52a1\u7684\u65b9\u6848\u7ed3\u5408\u8d77\u6765\uff0c\u5b9a\u65f6\u4efb\u52a1\u6765\u4f5c\u4e3a\u8fd9\u4e2a\u515c\u5e95\u65b9\u6848\u6765\u4f7f\u7528</p> <p>\u5904\u7406\u7684\u903b\u8f91\uff0c\u5c31\u6709\u70b9\u50cf\u8fd9\u4e2aredis\uff08\u8fc7\u671f\u56de\u6536\uff09\uff0c\u5148\u60f0\u6027\u5220\u9664\uff0c\u6e05\u9664\u4e0d\u6389\u7684\uff0c\u518d\u901a\u8fc7\u5b9a\u671f\u6e05\u7406\u7684\u65b9\u5f0f\u6765\u5904\u7406</p> <p>\u8fd8\u6709\u4e00\u79cd\u662f\u5229\u7528\u6d88\u606f\u5bf9\u5217\u7684\u8fd9\u4e2a\u5ef6\u8fdf\u5bf9\u5217\u4e0b\u8ba2\u5355\u7684\uff0c \u540c\u65f6\u53d1\u9001\u4e00\u6761\u5ef6\u8fdf\u5bf9\u5217\uff0c\u5230\u4e86\u65f6\u95f4\u53d1\u9001\u8fc7\u53bb\uff0c\u5173\u6389\u8ba2\u5355\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u4e00\u4e9b\u7279\u6b8a\u7684\u573a\u666f\u4e0b\u9762\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u8ba2\u5355\u8d85\u65f6\u5173\u4e0d\u6389\u7684\u60c5\u6cc1\uff0c\u6bd4\u5982\u8bf4\u8bf7\u6c42\u91cf\u5927\u6765\u4e0d\u53ca\u5916\u7406\uff0c\u6216\u8005\u662f\u8ba2\u5355\u5173\u95ed\u7684\u63a5\u53e3\u6302\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u8ba2\u5355\u867d\u7136\u8d85\u65f6\u4e86\uff0c\u8fd8\u662f\u53ef\u4ee5\u53d1\u8d77\u652f\u4ed8\u7684\uff0c\u6240\u4ee5\u8fd9\u4e2a\u65f6\u5019\u4e00\u5b9a\u8981\u9650\u5236\u4f4f\u3002\u5728\u8ba2\u5355\u5012\u8ba1\u65f6\u7ed3\u675f\u7684\u65f6\u5019\uff0c\u4e0d\u80fd\u8ba9\u4ed6\u518d\u6b21\u53d1\u8d77\u8ba2\u5355\u7684\u652f\u4ed8\uff0c\u524d\u7aef\u80af\u5b9a\u8981\u505a\u597d\u9650\u5236\uff0c\u540e\u7aef\u4e5f\u8981\u505a\u597d\u8ba2\u5355\u6709\u6548\u7684\u68c0\u9a8c\uff0c\u4fdd\u8bc1\u8ba2\u5355\u5728\u8d85\u503c\u5173\u95ed\u7684\u60c5\u51b5\u4e0b\u9762\uff0c\u7528\u6237\u53d1\u8d77\u4e0d\u4e86\u652f\u4ed8</p>"},{"location":"chap7/Arch_anws/#4-aop","title":"4 \u804aAOP\u7684\u5e94\u7528\u573a\u666f\u53ca\u6ce8\u610f\u4e8b\u9879","text":"<p>AOP\u51e0\u4e4e\u6bcf\u4e2a\u9879\u76ee\u90fd\u4f1a\u7528\u5230, \u9762\u5411\u5207\u9762\u7f16\u7a0b. </p> <p>\u5728\u65b9\u6cd5\u4e0a, \u901a\u8fc7\u4e00\u4e2a\u6ce8\u89e3\u5c31\u80fd\u62e6\u622a\u6570\u636e, \u7136\u540e\u518d\u505a\u4e00\u4e9b\u7279\u6b8a\u7684\u5904\u7406\u903b\u8f91, \u8ddf\u9762\u5411\u5bf9\u8c61\u662f\u5c5e\u4e8e\u4e24\u79cd\u4e0d\u540c\u7684\u7ef4\u5ea6</p> <p>\u4f20\u7edf\u7684\u9762\u5411\u5bf9\u8c61</p> <p>\u5c31\u662f\u628a\u6240\u6709\u7684\u4e1a\u52a1\u903b\u8f91\u653e\u5728\u4e00\u8d77, \u5206\u6563\u5728\u4e0d\u540c\u7684\u5bf9\u8c61\u91cc\u9762\u6709\u5404\u79cd\u5404\u6837\u7684\u65b9\u6cd5, \u6709\u5404\u79cd\u5404\u6837\u7684\u8fd9\u4e2a\u6210\u5458\u53d8\u91cf, \u90a3\u4e48\u6240\u6709\u7684\u6838\u5fc3\u903b\u8f91, \u90fd\u662f\u901a\u8fc7\u9762\u5411\u5bf9\u8c61\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u7684. </p> <p>\u968f\u7740\u7cfb\u7edf\u8d8a\u6765\u8d8a\u5927, \u5f88\u591a\u975e\u4e3b\u8981\u6d41\u7a0b\u7684\u5185\u5bb9\u4e5f\u52a0\u5165\u8fdb\u6765\u4e86, \u6bd4\u65b9\u8bf4\u65b9\u6cd5\u8bbf\u95ee\u65e5\u5fd7\u7684\u8bb0\u5f55\uff0c </p> <p>\u5982\u679c\u6309\u7167\u4f20\u7edf\u7684\u9762\u5411\u5bf9\u8c61\u7684\u65b9\u5f0f\uff0c \u53ef\u80fd\u5c31\u8981\u5728\u65b9\u6cd5\u7684\u5165\u53e3\u5904\u6765\u589e\u52a0log\uff0c \u4f46\u662flog\u672c\u8eab\u4e5f\u4e0d\u662f\u7279\u522b\u91cd\u8981\uff0c \u5c5e\u4e8e\u540e\u9762\u6392\u67e5\u95ee\u9898\u7edf\u8ba1\u7528\u7684\uff0c\u4f46\u662f\u5374\u4fb5\u5165\u4e86\u4e3b\u6d41\u7a0b\u7684\u4ee3\u7801\u4e2d\uff0c \u4f1a\u4ea7\u751f\u5f88\u591a\u7684\u4ee3\u7801\u5197\u4f59</p> <p>\u5982\u679c\u901a\u8fc7AOP\u5207\u9762\u7684\u65b9\u5f0f\u6765\u505a\u5c31\u6bd4\u8f83\u7b80\u5355\uff0c\u4e5f\u5c31\u662f\u5728\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u4e8e\u4e00\u4e2a\u6ce8\u89e3\uff0c\u6ce8\u89e3\u7684\u4f5c\u7528\u5462\u5176\u5b9e\u662f\u4e3a\u4e86\u62e6\u622a\uff0c\u62e6\u622a\u4e4b\u540e\u8be5\u5199\u76d8\u5199\u76d8\uff0c\u8be5\u843d\u5e93\u843d\u5e93\uff0c\u5b8c\u5168\u662f\u5f02\u6b65\u7684\u64cd\u4f5c\uff0c\u4e0d\u4f1a\u5f71\u54cd\u4e3b\u8981\u7684\u4e1a\u52a1\u6d41\u7a0b</p> <p>\u90a3\u4e48\u9664\u4e86\u65b9\u6cd5\u7684\u65e5\u5fd7\u4ee5\u5916\u8fd8\u6709\u5176\u4ed6\u7684\u4e00\u4e9b\u5e94\u7528\u573a\u666f\u4e86, \u6bd4\u65b9\u8bf4\u6743\u9650\u7684\u5224\u5b9a, \u8fd9\u4e2a\u65b9\u6cd5\u6709\u6ca1\u6709\u8bbf\u95ee\u6743\u9650\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5207\u9762\u7684\u65b9\u5f0f, \u53ea\u6709\u7279\u5b9a\u89d2\u8272\u6216\u8005\u6743\u9650\u7684\u7528\u6237, \u624d\u80fd\u8bbf\u95ee\u5230\u67d0\u4e9b\u654f\u611f\u7684\u64cd\u4f5c, \u90a3\u4e48\u8fd8\u53ef\u4ee5\u5229\u7528AOP\u505a\u5168\u5c40\u5f02\u5e38\u7684\u6355\u83b7\uff0c\u7136\u540e\u8fdb\u884c\u5904\u7406</p> <p>\u8fd8\u53ef\u4ee5\u7528\u4e8e\u5bf9\u7cfb\u7edf\u7684\u6027\u80fd\u8fdb\u884c\u76d1\u63a7\uff0c\u597d\u6bd4\u65b9\u8bf4\u67d0\u4e2a\u65b9\u6cd5\u6267\u884c\u524d\u540e\u7684\u65f6\u95f4\uff0c\u6216\u8005\u7edf\u8ba1\u67e5\u8be2\u6570\u636e\u5e93\u7684\u6b21\u6570</p> <p>\u90a3\u4e48AOP\u8fd8\u6709\u4e00\u70b9\u9700\u8981\u7279\u522b\u6ce8\u610f\uff0c\u5c31\u662f\u8981\u8003\u8651\u5931\u6548\u7684\u573a\u666f\uff0c\u6bd4\u65b9\u8bf4\u540c\u4e00\u4e2a\u7c7b\u4e2d\u7684\u65b9\u6cd5\u4e92\u76f8\u8c03\u7528, a\u65b9\u6cd5\u8c03\u7528b\u65b9\u6cd5, b\u65b9\u6cd5\u7684AOP\u7684\u6ce8\u89e3, AOP\u8981\u901a\u8fc7\u751f\u6210\u52a8\u6001\u4ee3\u7406\u7684\u65b9\u5f0f\u6765\u5904\u7406, AOP\u8981\u901a\u8fc7\u751f\u6210\u52a8\u6001\u4ee3\u7406\u7684\u65b9\u5f0f\u6765\u5904\u7406\u3002\u4f46\u662f\u5462\u4e00\u4e2a\u7c7b\u4e2d\u7684\u65b9\u6cd5\u4e92\u76f8\u8c03\u7528\uff0c\u662f\u4e0d\u9700\u8981\u7ecf\u8fc7\u4ee3\u7406\u7684\uff0c\u6240\u4ee5AOP\u5c31\u4f1a\u5931\u6548</p> <p>\u89e3\u6c7a\u65b9\u6848\u4e5f\u5f88\u7b80\u5355\uff0c\u8981\u4e48\u58f0\u660e\u4e00\u4e0b\u5f53\u524d\u7c7b\u7684\u670d\u52a1\uff0c \u7136\u540e\u901a\u8fc7\u4ee3\u7406\u7684\u65b9\u5f0f\u6765\u8fdb\u884c\u8c03\u7528\uff0c \u8981\u4e48\u5c31\u79fb\u51fa\u5f53\u524d\u7c7b\u5c31\u53ef\u4ee5\u4e86\u3002 </p> <p>\u8fd8\u6709\u65e0\u6cd5\u8ba9\u5207\u9762\u589e\u5f3a\u7684\u65b9\u5f0f\uff0c\u9759\u6001\u65b9\u6cd5static\uff0c \u8fd8\u6709final\u4fee\u9970\u8fc7\u7684\u8fd9\u4e2a\u65b9\u6cd5\uff0c \u4e5f\u65e0\u6cd5\u4f7f\u7528\u52a8\u6001\u4ee3\u7406\u7684\u65b9\u5f0f\u6765\u505a\uff0c \u540c\u6837\u4e5f\u4f1a\u4f7fAOP\u5931\u6548</p> <p>\u53e6\u5916\u8fd8\u6709\u4e00\u70b9\u9700\u8981\u7279\u522b\u6ce8\u610f\u662f\uff0c \u65b9\u6cd5\u4e2d\u7684\u4e8b\u52a1\uff0c \u5927\u90e8\u5206\u90fd\u662f\u57fa\u4e8eAOP\u7684\uff0c \u903b\u8f91\u6765\u5b9e\u73b0\u7684\u4e5f\u90fd\u662f\u4e3a\u4e86\u6355\u83b7\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u5f02\u5e38\uff0c \u7136\u540e\u8fdb\u884c\u56de\u6eda</p> <p>\u5982\u679c\u9047\u5230AOP\u5931\u6548\u7684\u573a\u666f\uff0c \u540c\u4e00\u4e2a\u7c7b\u4e2d\u7684\u65b9\u6cd5\u8c03\u7528\uff0c a\u65b9\u6cd5\u8c03b\u65b9\u6cd5\uff0cb\u65b9\u6cd5\u76f8\u5f53\u4e8e\u88ab\u62f7\u8d1d\u5230\u4e86a\u65b9\u6cd5\u91cc\u9762\uff0c \u90a3\u4e48b\u65b9\u6cd5\u4e2d\u7684AOP\u662f\u5931\u6548\u7684\uff0c \u90a3\u4e48b\u65b9\u6cd5\u7684\u4e8b\u52a1\uff0c \u81ea\u7136\u800c\u7136\u7684\u4e5f\u5c31\u8ddf\u7740\u5931\u6548\u4e86\uff0c\u5c31\u76f8\u5f53\u4e8e\u56e0\u4e3aAOP\u7684\u5931\u6548\u95f4\u63a5\u5f15\u53d1\u4e86\u4e8b\u52a1\u7684\u5931\u6548\u554a\uff0c\u8981\u7279\u522b\u7684\u6ce8\u610f\uff0c\u56e0\u4e3a\u4e8b\u52a1\u7684\u5931\u6548\uff0c\u4f1a\u5e26\u6765\u4e00\u4e9b\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898</p>"},{"location":"chap7/Arch_anws/#7_2","title":"7 \u672c\u5730\u5f00\u53d1","text":""},{"location":"chap7/Arch_anws/#1_6","title":"1 \u804a\u804a\u670d\u52a1\u7aef\u7684\u672c\u5730\u7f13\u5b58","text":"<p>\u672c\u5730\u7f13\u5b58\u4e5f\u53eb\u505a\u8fd1\u7aef\u7f13\u5b58\uff0c\u90a3\u4e48\u4e00\u822c\u7684\u5904\u7406\u573a\u666f\uff0c\u5c31\u662f\u5148\u8bbf\u95ee\u672c\u5730\u7f13\u5b58\uff0c\u5982\u679c\u672c\u5730\u7f13\u5b58\u6ca1\u6709\uff0c\u518d\u53bb\u8bbf\u95ee\u8fdc\u7aef\u7684redis\uff0c\u8fdc\u7aefredis\u4e5f\u6ca1\u6709\uff0c\u90a3\u4e48\u76f4\u63a5\u8bbf\u95ee\u6570\u636e\u5e93</p> <p>\u90a3\u4e48\u4e00\u822c\u662f\u8fd9\u6837\u7684\u4e00\u4e2a\u6d41\u7a0b\uff0c\u90a3\u4e48\u5e38\u89c4\u7684\u5b9e\u73b0\u5c31\u662f\u4f7f\u7528\u4e00\u4e9b\u6846\u67b6\uff0c \u6bd4\u5982\u50cfcoffine, guava. </p> <p>\u5982\u679credis\u8bbf\u95ee\u5f02\u5e38\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u5c31\u53ef\u4ee5\u76f4\u63a5\u964d\u7ea7\u6765\u8bfb\u53d6\u672c\u5730\u7684\u7f13\u5b58\uff0c\u4e5f\u80fd\u591f\u51cf\u5c11\u7f13\u5b58\u51fb\u7a7f\u5e26\u6765\u7684\u98ce\u9669</p> <p>\u672c\u5730\u7f13\u5b58\u6bd4\u8f83\u5927\u7684\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\uff0c\u8ddfredis\uff0c\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u901a\u8fc7\u4e00\u4e9b\u540c\u6b65\u7b56\u7565\u6765\u7f13\u89e3\u8fd9\u4e2a\u4e00\u81f4\u6027\u7684\u95ee\u9898</p>"},{"location":"chap7/Arch_anws/#2_6","title":"2 \u65e5\u5e38\u5f00\u53d1\u4e2d\u7684\u6279\u5904\u7406","text":"<p>\u6279\u5904\u7406\u662f\u4e00\u4e2a\u6bd4\u8f83\u7b80\u5355\u5374\u6bd4\u8f83\u5b9e\u7528\u7684, \u80fd\u591f\u63d0\u9ad8\u6027\u80fd\u7684\u6709\u6548\u5229\u5668.</p> <p>\u524d\u7aef\u7684\u6279\u5904\u7406, \u6bd4\u5982\u8bf4\u5e38\u89c1\u7684\u50cf\u8fd9\u4e2a\u57cb\u70b9, \u7528\u6237\u6bcf\u70b9\u4e00\u4e0b\u5c31\u4f1a\u6709\u4e00\u4e2a\u8bb0\u5f55, \u8fd9\u79cd\u60c5\u51b5\u4e00\u822c\u90fd\u662f\u524d\u7aef\u6512\u7740, \u5148\u653e\u5728\u672c\u5730, \u6309\u7167\u4e00\u5b9a\u7684\u8fd9\u4e2a\u7b56\u7565\u6765\u8fdb\u884c\u4e0a\u62a5, \u6bd4\u5982\u8bf4\u6512\u591f\u4e8610\u6761\u6216\u8005\u662f\u6bcf\u9694\u4e00\u5206\u949f\u6279\u91cf\u4e0a\u62a5</p> <p>\u5bf9\u4e8e\u4e00\u4e9b\u9ad8\u5e76\u53d1\u4e0b\u7684\u573a\u666f, \u6765\u505a\u4e00\u4e9b\u964d\u7ea7, \u5982\u679c\u51fa\u73b0\u4e86\u4e00\u4e9b\u5999\u6740\u5927\u4fc3. \u90a3\u4e48\u5c31\u5148\u6682\u65f6\u4e0d\u4e0a\u62a5\u6216\u8005\u5ef6\u957f\u6279\u5904\u7406\u7684\u5468\u671f, \u8fd9\u6837\u5c31\u80fd\u591f\u5927\u5927\u7684\u51cf\u5c11\u4ea4\u4e92\u7684\u6b21\u6570,\u51cf\u5c11\u7f51\u7edc\u7684IO,\u8282\u7ea6\u8d44\u6e90\u90a3\u4e48\u5bf9\u4e8e\u670d\u52a1\u7aef, \u4e5f\u6709\u6d89\u53ca\u5230\u7684\u6279\u5904\u7406,\u6bd4\u5982\u8bf4\u6d89\u53ca\u5230\u4e86\u65e2\u6709\u7236\u7ea7\u6570\u7ec4, \u53c8\u6709\u5b50\u96c6\u6570\u7ec4\u7684\u8fd9\u6837\u7684\u4e00\u4e2a\u6279\u91cf\u63d2\u5165, \u5343\u4e07\u4e0d\u80fd\u5faa\u73af\u63d2\u5165</p> <p>\u5982\u679c\u4f60\u8981\u8ffd\u6c42\u6548\u7387\u8ffd\u6c42\u6027\u80fd,\u6279\u5904\u7406\u7684\u601d\u60f3\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684</p>"},{"location":"chap7/Arch_anws/#3_5","title":"3 \u7f13\u5b58\u7684\u547d\u4e2d\u7387","text":"<p>\u7f13\u5b58\u547d\u4e2d\u7387\u4ece\u67b6\u6784\u89d2\u5ea6\u6765\u8bf4\uff0c\u6bd5\u7adf\u7f13\u5b58\u8981\u9ad8\u4e8e\u6570\u636e\u5e93\u597d\u51e0\u4e2a\u6570\u91cf\u7ea7\uff0c\u6709\u4e86\u7f13\u5b58\u5c31\u8981\u7528\u597d\u5b83\uff0c\u90a3\u4e48\u5c31\u6709\u4e86\u7f13\u5b58\u547d\u4e2d\u7387\u8fd9\u4e2a\u6982\u5ff5\uff0c\u5b83\u662f\u8861\u91cf\u7cfb\u7edf\u6027\u80fd\u7684\u4e00\u4e2a\u91cd\u8981\u6307\u6807\uff0c\u8bf7\u6c42\u7684\u6570\u636e\u5728\u7f13\u5b58\u4e2d\u627e\u5230\u4e86\u547d\u4e2d\u4e86\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u7f13\u5b58\u6765\u83b7\u53d6\u60f3\u8981\u7684\u6570\u636e\u3002</p> <p>\u547d\u4e0d\u4e2d\u90a3\u4e48\u5c31\u9700\u8981\u53bb\u67e5\u6211\u4eec\u7684\u6570\u636e\u5e93\u4e86\uff0c\u547d\u4e2d\u7f13\u5b58\u7684\u8bf7\u6c42\u5360\u603b\u8bf7\u6c42\u7684\u6bd4\u7387\uff0c\u5c31\u662f\u6240\u8c13\u7684\u7f13\u5b58\u547d\u4e2d\u7387\uff0c\u547d\u4e2d\u7387\u8d8a\u9ad8\u5e94\u7528\u7684\u6027\u80fd\u5c31\u8d8a\u597d\uff0c\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u54cd\u5e94\u65f6\u95f4\u53d8\u77ed\u4e86\uff0c\u541e\u5410\u91cf\u53d8\u9ad8\u4e86\uff0cQPS\u63d0\u9ad8\u4e86\uff0c\u81ea\u7136\u5e76\u53d1\u91cf\u4e5f\u5c31\u4e0a\u53bb\u4e86</p> <p>\u90a3\u600e\u4e48\u63d0\u9ad8\u7f13\u5b58\u547d\u4e2d\u7387\u5462</p> <p>\u6311\u4e00\u90e8\u5206\u8bbf\u95ee\u91cf\u6bd4\u8f83\u9ad8\u7684\u6570\u636e\uff0c\u4e5f\u5c31\u662f\u6240\u8c13\u7684\u70ed\u70b9\u6570\u636e\u6765\u5237\u5230\u7f13\u5b58\u91cc\u9762\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u7cfb\u7edf\u57cb\u70b9\u6216\u8005\u901a\u8fc7\u8fd9\u4e2a\u6570\u636e\u76d1\u6d4b\uff0c\u6216\u8005\u901a\u8fc7\u4e00\u4e9b\u5f00\u6e90\u7684\u7ec4\u4ef6\uff0c\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2a\u554ajd-Hotkey\uff0c\u5bf9\u4e8e\u8fd9\u4e9b\u70ed\u70b9\u6570\u636e\uff0c\u662f\u53ef\u4ee5\u63d0\u524d\u5237\u5230\u7f13\u5b58\u91cc\u9762\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee\u91cf\u6765\u7ed9\u70edkey\u7eed\u547d\uff0c\u6bd4\u5982\u8bf4\u6bcf\u589e\u52a0\u4e00\u4e2a\u8bbf\u95ee\uff0c\u5c31\u5ef6\u957f\u4e00\u5b9a\u7684\u8fd9\u4e2a\u8fc7\u671f\u65f6\u95f4\uff0c\u70ed\u70b9\u6570\u636e\u5c31\u4f1a\u957f\u671f\u7684\u505c\u7559\u5728\u7f13\u5b58\u91cc\u9762\uff0c\u90a3\u4e48\u547d\u4e2d\u7387\u4e5f\u5c31\u81ea\u7136\u5c31\u9ad8\u4e86</p> <p>\u53e6\u5916\u8fd8\u6709\u4e00\u4e2a\u63d0\u5347\u547d\u4e2d\u7387\u7684\u65b9\u5f0f\uff0c\u5c31\u662f\u4f7f\u7528\u591a\u7ea7\u7f13\u5b58\uff0c\u8bf7\u6c42\u5148\u8fc7\u6765\u5148\u5728\u672c\u5730\u67e5\u770b\uff0c\u5982\u679c\u5728\u8fd1\u7aef\u7f13\u5b58\u91cc\u9762\u6709\u5c31\u76f4\u63a5\u8fd4\u56de\uff0c\u5982\u679c\u6ca1\u6709\u5c31\u518d\u53bbredis\u91cc\u9762\u53bb\u770b\uff0c\u8fd9\u6837\u4e00\u6765\u80fd\u591f\u63d0\u9ad8\u7f13\u5b58\u7684\u547d\u4e2d\u7387\uff0c\u4e8c\u6765\u4e5f\u80fd\u591f\u51cf\u5c11\u5bf9redis\u7684\u8bbf\u95ee\uff0c\u4fdd\u62a4\u4e86\u8fdc\u7aef\u7f13\u5b58</p> <p>\u53e6\u5916\u8fd8\u6709\u8fd9\u4e2a\u7f13\u5b58\u7684\u7c92\u5ea6\u8981\u6ce8\u610f\uff0c\u5c3d\u91cf\u8981\u5f80\u5c0f\u7684\u53bb\u8bbe\uff0c\u4e0d\u8981\u7b3c\u7edf\u7684\u653e\u5728\u4e00\u4e2a\u96c6\u5408\u91cc\u9762</p>"},{"location":"chap7/Arch_anws/#4_4","title":"4 \u5206\u5e03\u5f0f\u4e0b\u7684\u65e5\u5fd7\u7cfb\u7edf","text":"<p>\u5728\u9879\u76ee\u91cc\u4f1a\u5f15\u5165\u4e00\u4e9b\u65e5\u5fd7\u7684\u7ec4\u4ef6\uff0c\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2alog4j, self4\uff0c\u7136\u540e\u5728\u4e00\u4e9b\u6bd4\u8f83\u5173\u952e\u7684\u5730\u65b9\uff0c\u6765\u8bb0\u5f55\u65e5\u5fd7</p> <p>\u96c6\u7fa4\u67b6\u6784\u7684\u5206\u5e03\u5f0f\u67b6\u6784\uff0c\u65e5\u5fd7\u5206\u6563\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u9762\u5c24\u5176\u662f\u5fae\u670d\u52a1\u67b6\u6784\uff0c \u670d\u52a1\u4e0e\u670d\u52a1\u4e4b\u95f4\u7684\u4ea4\u53c9\u8c03\u7528</p> <p>\u8981\u67e5\u770b\u4e00\u4e2a\u4e8b\u52a1\u7684\u5168\u90e8\u65e5\u5fd7\uff0c\u53ef\u80fd\u8981\u767b\u5f55\u597d\u51e0\u53f0\u670d\u52a1\u5668\uff0c\u6240\u4ee5\u5c31\u6d8c\u73b0\u51fa\u4e86\u4e00\u4e9b\u5206\u5e03\u5f0f\uff0c\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2aELK, \u53ef\u4ee5\u5c06\u591a\u4e2a\u670d\u52a1\u5668\u7684\u65e5\u5fd7\u8fdb\u884c\u6536\u96c6,\u5b58\u50a8\u548c\u5c55\u793a</p> <ul> <li>logstash, \u662f\u505a\u65e5\u5fd7\u7684\u6536\u96c6\u8fc7\u6ee4\u548c\u4e0a\u62a5</li> <li>es\u662f\u505a\u5b58\u50a8\u548c\u641c\u7d22\u5f15\u64ce</li> <li>kibana \u662f\u505a\u8fd9\u4e2a\u65e5\u5fd7\u7684\u67e5\u8be2\u53ef\u89c6\u5316\u754c\u9762</li> </ul> <p>\u5f53\u7136\u73b0\u5728\u4e5f\u5f15\u5165\u4e86\u8fd9\u4e2afilebeat, \u6765\u66ff\u4ee3\u539f\u5148\u8fd9\u4e2alogstash, \u505a\u65e5\u5fd7\u6536\u96c6\u7684\u5de5\u4f5c</p> <p>filebeat\u6bd4\u8f83\u4e13\u4e1a\u4e13\u95e8\u505a\u6536\u96c6</p> <p>\u50cf\u5b9e\u65f6\u6253\u5370\u7684\u65e5\u5fd7, \u53ef\u4ee5\u76f4\u63a5\u50cf<code>tail-f</code>\u2014\u6837\u76d1\u542c\u5230,\u4e5f\u652f\u6301\u6d88\u606f\u961f\u5217\u7684\u63a5\u6536. \u53ef\u4ee5\u9762\u5bf9\u591a\u4e2a\u6570\u636e\u6e90</p> <p>\u53e6\u4e00\u65b9\u9762\u5462filebeat\u6bd4\u8f83\u8f7b\u91cf</p> <p>\u4e0d\u50cflogstash, \u8dd1\u5728Jvm\u91cc\u9762, \u5360\u7528\u7684\u8fd9\u4e2a\u8d44\u6e90\u6bd4\u8f83\u591a </p> <p>\u5f88\u591a\u573a\u5408\u5982\u679c\u4e0d\u505a\u6570\u636e\u6e05\u6d17, \u751a\u81f3\u76f4\u63a5\u53ef\u4ee5\u53bb\u6389logstash, \u53d8\u6210\u4e86EFK</p> <p>\u9700\u8981\u7528\u5230\u6b63\u5219\u8fc7\u6ee4, \u90a3\u4e48\u8fd8\u9700\u8981\u7528\u5230logstash, \u6765\u505a\u65e5\u5fd7\u6e05\u6d17\u7684\u4e2d\u95f4\u4ef6, \u90a3\u4e48\u5c31\u53ef\u4ee5\u52a0\u4e0a\u524d\u7f6e\u7684\u8fd9\u4e2afilebeat, \u4e5f\u5c31\u662f\u8fd9\u4e2aFELK, \u8fd9\u662f\u76ee\u524d\u6bd4\u8f83\u4e3b\u6d41\u7684\u65e5\u5fd7\u6846\u67b6</p> <p>\u5f53\u7136\u57fa\u4e8e\u8fd9\u4e2a\u65e5\u5fd7, \u4e5f\u53ef\u4ee5\u505a\u4e00\u4e9b\u94fe\u8def\u8ffd\u8e2a, \u6240\u8c13\u7684\u8c03\u7528\u94fe. \u53ea\u662f\u5728\u4e00\u6b21\u4e8b\u52a1\u8bf7\u6c42\u7684\u65f6\u5019, \u5728\u4e00\u5f00\u59cb</p> <p>\u7b2c\u4e00\u6b21\u7684\u65f6\u5019\u521d\u59cb\u5316traceID, \u7136\u540e\u6309\u7167\u8bf7\u6c42\u7684\u987a\u5e8f\u8fdb\u884c\u7f16\u53f7,\u90a3\u4e48\u5c31\u53ef\u4ee5\u628a\u6574\u4e2a\u7684\u94fe\u8def\u4e32\u8d77\u6765, \u8bbf\u95ee\u4e86\u54ea\u4e2a\u65b9\u6cd5, \u65b9\u6cd5\u91cc\u6709\u54ea\u4e9b\u5173\u952e\u8282\u70b9</p>"},{"location":"chap7/Arch_anws/#5_2","title":"5 \u76d8\u70b9\u7ebf\u4e0a\u5b9a\u4f4d\u95ee\u9898\u7684\u5de5\u5177","text":"<p>\u600e\u4e48\u5728\u7ebf\u4e0a\u5b9a\u4f4d\u548c\u6392\u67e5\u95ee\u9898\uff0c\u60f3\u67e5\u770b\u8fd9\u4e2aAPI\u7684\u8c03\u7528\u94fe\u8def\uff0c\u5404\u4e2a\u4e2d\u5fc3\u5404\u4e2a\u670d\u52a1\u4e4b\u95f4\u7684\u8c03\u7528\u94fe\uff0c\u5c31\u9700\u8981\u4f7f\u7528skywalking\uff0czipkin, ali\u7684\u9e70\u773c\u6216\u8005\u662f\u8fd9\u4e2a\u8001\u724c\u7684pinpoint</p> <p>\u67e5\u770b\u5404\u4e2a\u5e94\u7528\u4e4b\u95f4\u7684\u8c03\u7528\u5173\u7cfb\u7684, \u50cf\u4ec0\u4e48\u8bf7\u6c42\u5ef6\u8fdf\u9519\u8bef\u7387, tps\u541e\u5410\u91cf\u8fd9\u4e9b\u6307\u6807, \u90fd\u53ef\u4ee5\u901a\u8fc7\u53ef\u89c6\u5316\u7684\u8fd9\u4e2a\u754c\u9762\u6765\u67e5\u770b</p> <p>\u6216\u8005\u76f4\u63a5\u5728\u7ebf\u4e0a\u7684\u65b9\u6cd5\u52a0\u4e00\u884c\u4ee3\u7801\uff0c\u8981\u6253\u5370\u67d0\u4e2a\u53d8\u91cf\u7684\u8fd9\u4e2a\u72b6\u6001\u503c\uff0c\u6216\u8005\u62e6\u622a\u51fa\u53c2\u5165\u53c2\uff0c\u751a\u81f3\u52a0\u4e00\u6bb5\u4ee3\u7801\u903b\u8f91</p> <p>\u5c31\u53ef\u4ee5\u4f7f\u7528\uff0c\u50cf\u8fd9\u4e2abtrace\uff0c\u6216\u8005\u662farthas\uff0c\u53ef\u4ee5\u52a8\u6001\u7684\u6765\u4fee\u6539\u8fd9\u4e2a\u7ebf\u4e0a\u4ee3\u7801\uff0c \u8fd9\u5c31\u662f\u6240\u8c13\u7684\u70ed\u90e8\u7f72</p> <p>\u73b0\u5728\u6d41\u884c\u901a\u7528\u7684\u662farthas\uff0c\u4ed6\u7684\u64cd\u4f5c\u65b9\u5f0f\u8fd8\u6709\u70b9\u7c7b\u4f3c\u8fd9\u4e2aLinux\uff0c shell\u811a\u672c\uff0c \u76f4\u63a5\u6572\u547d\u4ee4\u5c31\u53ef\u4ee5\u89e3\u6c7a\u5b9a\u4f4d\u95ee\u9898\uff0c\u5b9e\u9645\u4e0a\u90fd\u7ed5\u4e0d\u5f00\u5b57\u8282\u7801\u63a2\u9488\uff0c \u4e0d\u7ba1\u662f\u94fe\u8def\u8c03\u7528\u8fd8\u662f\u4ee3\u7801\u7684\u8fd9\u4e2a\u62e6\u622a\u6ce8\u5165</p> <p>### 6 \u5982\u4f55\u5feb\u901f\u5220\u9664\u6d77\u91cf\u6570\u6398</p> <p>\u6bd4\u5982\u8bf4\u5bf9\u4e8e\u4e00\u4e9b\u8fc7\u671f\u7684\u64cd\u4f5c\u65e5\u5fd7, \u8fd9\u4e2a\u65e0\u6548\u7684\u7528\u6237\u6570\u636e\u5927\u6570\u636e\u5206\u6790\u7684\u4e34\u65f6\u5e93</p> <p>\u8fd9\u4e2a\u65e0\u6548\u7684\u7528\u6237\u6570\u636e\u5927\u6570\u636e\u5206\u6790\u7684\u4e34\u65f6\u5e93, \u5927\u6570\u636e\u5206\u6790\u7684\u4e34\u65f6\u5e93\u554a\u7b49\u7b49, \u90a3\u4e48\u4e3a\u4e86\u51cf\u5c11\u5b58\u50a8\u7a7a\u95f4\u63d0\u9ad8\u6027\u80fd\u6216\u8005\u662f\u4fdd\u8bc1\u6570\u636e\u7684\u4f20\u6388\u6548\u7387\u6216\u8005\u662f\u7cbe\u5ea6\u7b49\u7b49</p> <p>\u8fd9\u4e9b\u6570\u636e\u662f\u8981\u88ab\u5b9a\u65f6\u6e05\u6389, \u5176\u5b9e\u5bf9\u4e8e\u5c11\u91cf\u7684\u6570\u636e\u6765\u8bf4, \u6839\u672c\u4e0d\u4f1a\u51fa\u73b0\u4ec0\u4e48\u6027\u80fd\u95ee\u9898</p> <p>\u4f46\u662f\u4e00\u65e6\u91cf\u4e0a\u6765, \u8981\u5220\u9664\u51e0\u767e\u4e07\u7684\u6570\u636e,\u53ef\u80fd\u8981\u82b1\u8d39\u597d\u51e0\u4e2a\u5c0f\u65f6,\u4e3b\u8981\u539f\u56e0\u8fd8\u662f\u5728\u7d22\u5f15\u8fd9\u4e00\u5757. </p> <p>\u56e0\u4e3a\u4f60\u6bcf\u5220\u9664\u4e00\u6761\u8bb0\u5f55, \u5c31\u8981\u5728\u5bf9\u5e94\u7684\u7d22\u5f15\u6811\u91cc\u9762\u7684\u4e3b\u952e\u7d22\u5f15\u4e8c\u7ea7\u7d22\u5f15,\u90fd\u9700\u8981\u5220\u6389\u76f8\u5e94\u7684\u8282\u70b9\u7136\u540e\u91cd\u65b0\u6392\u5e8f. </p> <p>\u6bd4\u8f83\u5e38\u89c1\u7684\u64cd\u4f5c\u65b9\u5f0f\u5c31\u662f\u5148\u53bb\u6389\u8868\u7684\u7d22\u5f15, \u9664\u4e86\u5220\u9664\u6570\u636e\u9700\u8981\u7528\u5230\u7684\u7d22\u5f15\u4ee5\u5916, \u5176\u4ed6\u7684\u7d22\u5f15\u5168\u90e8\u5220\u6389, \u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u80fd\u8981\u82b1\u8d39\u597d\u51e0\u5206\u949f, \u8fd9\u6837\u53bb\u5220\u9664\u6570\u636e\u554a\u5c31\u4f1a\u5f88\u5feb</p> <p>\u5220\u5b8c\u6570\u636e\u4e4b\u540e, \u518d\u628a\u7d22\u5f15\u518d\u52a0\u56de\u53bb, \u5220\u9664\u6570\u636e\u4e4b\u540e\u8868\u7684\u6570\u636e\u6ca1\u90a3\u4e48\u591a\u4e86, \u52a0\u7d22\u5f15\u4e5f\u5c31\u5f88\u5feb. </p> <p>\u4e5f\u53ef\u4ee5\u76f4\u63a5\u53bb\u5efa\u4e34\u65f6\u8868\u5b58\u50a8\uff0c\u7136\u540e\u518dtruncat\u4f60\u7684\u539f\u8868\uff0c\u76f8\u5bf9\u524d\u4e00\u79cd\u5462\u4f1a\u66f4\u52a0\u7684\u5feb\uff0c\u5220\u9664\u4e86\u6d77\u91cf\u6570\u636e\u4e4b\u540e\uff0c\u53bb\u505a\u4e00\u4e0b\u8868\u7a7a\u95f4\u7684\u538b\u7f29\uff0c\u8fd9\u6837\u624d\u4e0d\u4f1a\u5f71\u54cd\u5230\u6570\u636e\u5e93\u7684\u67e5\u8be2</p>"},{"location":"chap7/Arch_anws/#7_3","title":"7 \u804a\u804a\u707e\u5907\u7684\u89e3\u6c7a\u65b9\u6848\uff1a\u4e24\u5730\u4e09\u4e2d\u5fc3","text":"<p>\u96c6\u7fa4\u5305\u542b\u5e94\u7528\u670d\u52a1\u7684\u96c6\u7fa4\uff0c\u6570\u636e\u5e93\u7684\u96c6\u7fa4\uff0c\u4e2d\u95f4\u4ef6\u7684\u96c6\u7fa4\uff0c\u8fd8\u8981\u914d\u5408\u5404\u79cd\u8d1f\u8f7d\u5747\u8861\u3002\u5728\u670d\u52a1\u4e4b\u95f4\u8981\u5c3d\u53ef\u80fd\u7684\u505a\u677e\u8026\u5408\uff0c\u8981\u505a\u597d\u4e1a\u52a1\u7684\u62c6\u5206\uff0c\u5f15\u5165\u5fae\u670d\u52a1\u7b49\u7b49</p> <p>\u90a3\u4e48\u4e00\u822c\u7cfb\u7edf\uff0c\u5728\u8f6f\u4ef6\u67b6\u6784\u5c42\u9762\u80fd\u505a\u5230\u8fd9\u4e00\u70b9\u5df2\u7ecf\u5c31\u591f\u4e86\uff0c\u4f46\u662f\u5bf9\u4e8e\u4e00\u4e2a\u89c4\u6a21\u6bd4\u8f83\u5927\uff0c\u7528\u6237\u91cf\u6bd4\u8f83\u5927\u76f8\u5e94\u8981\u6c42\u6bd4\u8f83\u9ad8\u7684\u7cfb\u7edf\u5e73\u53f0\u6765\u8bf4\uff0c\u8fd9\u4e9b\u8fd8\u8fdc\u8fdc\u4e0d\u591f\u3002</p> <p>\u8fd8\u9700\u8981\u53bb\u5efa\u707e\u5907\u4e2d\u5fc3\uff0c\u90a3\u4e48\u4e3b\u8981\u7684\u76ee\u7684\u5c31\u662f\u4e3a\u4e86\u9632\u6b62\u4e0d\u53ef\u9884\u89c1\u7684\u707e\u96be\u53d1\u751f\uff0c\u81ea\u7136\u707e\u5bb3\u6216\u8005\u4eba\u4e3a\u4e86\u8fd9\u4e2a\u539f\u56e0\u5bfc\u81f4\u7684\u6574\u4e2a\u4e2d\u5fc3\u6302\u4e86\uff0c\u90a3\u4e48\u5c31\u8981\u6709\u5197\u4f59\u7684\u5b9e\u4f8b\u6216\u8005\u505a\u5230\u65e0\u7f1d\u5207\u6362\u3002 </p> <p>\u5e38\u89c1\u7684\u707e\u5907\u65b9\u6848\uff0c\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2a\u540c\u57ce\u707e\u5907\uff0c\u540c\u57ce\u53cc\u6d3b\uff0c\u4e24\u5730\u4e09\u4e2d\u5fc3\uff0c\u5c31\u662f\u5728\u4e24\u4e2a\u5730\u65b9\u5efa\u4e09\u4e2a\u4e2d\u5fc3\uff0c\u5982\u679c\u540c\u57ce\u707e\u5907\u4e2d\u5fc3\u4e5f\u53d1\u751f\u4e86\u707e\u96be\uff0c\u90a3\u4e48\u5c31\u8ba9DNS\u6307\u5230\u5f02\u5730\u7684\u707e\u5907\u4e2d\u5fc3\u3002 </p> <p>\u90a3\u4e24\u5730\u4e09\u4e2d\u5fc3\u662f\u600e\u4e48\u5b9e\u73b0\u7684\u5462\uff0c\u5176\u5b9e\u8ddf\u6211\u4eec\u4f20\u7edf\u7684\u707e\u5907\u5176\u5b9e\u533a\u522b\u5e76\u4e0d\u662f\u5f88\u5927\u3002 \u5728\u670d\u52a1\u7684\u90e8\u7f72\u4e0a\uff0c\u6838\u5fc3\u7684\u539f\u5219\u5c31\u662f\u505a\u5197\u4f59\uff0c \u505a\u5907\u4efd\u3002</p> <p>\u5728\u540c\u57ce\u90e8\u7f72\u8fd8\u662f\u5728\u5f02\u5730\u90e8\u7f72\uff0c\u5176\u5b9e\u533a\u522b\u5e76\u4e0d\u662f\u5f88\u5927\uff0c\u8981\u7279\u522b\u6ce8\u610f\u7684\u5c31\u662f\u8fd9\u4e2a\u6570\u636e\u7684\u540c\u6b65\u3002</p> <p>\u5f02\u5730\u6570\u636e\u4e2d\u95f4\u540c\u6b65\uff0c \u90a3\u4e48\u540c\u57ce\u7684\u707e\u5907\uff0c\u4e00\u822c\u90fd\u662f\u91c7\u7528\u8fd9\u4e2a\u70ed\u5907\u3002</p> <p>\u5b83\u5c31\u662f\u5c06\u6574\u4e2a\u7684\u670d\u52a1\uff0c \u5305\u62ecweb\u670d\u52a1\u5305\uff0c\u62ec\u6570\u636e\u5e93\uff0c\u5f02\u5730\u6570\u636e\u4e2d\u95f4\u540c\u6b65\u3002</p> <p>\u90a3\u4e48\u540c\u57ce\u7684\u707e\u5907\u5462\uff0c\u90fd\u662f\u5b9e\u65f6\u8ddf\u6211\u4eec\u7684\u751f\u4ea7\u4e2d\u5fc3\u8fdb\u884c\u540c\u6b65\u7684\uff0c\u90a3\u4e48\u4e00\u822c\u4e5f\u90fd\u662f\u91c7\u7528\u8fd9\u4e2a\u5feb\u7167\u589e\u91cf\u7684\u65b9\u5f0f\uff0c\u518d\u52a0\u4e0a\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u8fd9\u4e2abinlog\uff0c\u6574\u4e2a\u7684\u540c\u6b65\u673a\u5236\u8fd8\u662f\u6bd4\u8f83\u6210\u719f\u7684\uff0c\u662f\u5904\u4e8e\u4e00\u4e2a\u70ed\u5907\u7684\u72b6\u6001\uff0c\u4e00\u65e6\u751f\u4ea7\u4e2d\u5fc3\u6302\u4e86\uff0c\u540c\u57ce\u7684\u707e\u5907\u5c31\u4f1a\u7acb\u5373\u6295\u5165\u4f7f\u7528\u3002\u90a3\u4e48\u5bf9\u4e8e\u5f02\u5730\u707e\u5907\uff0c \u4e00\u822c\u662f\u505a\u8fd9\u4e2a\u6e29\u5907\u6216\u8005\u51b7\u5907\u5c31\u53ef\u4ee5\u4e86\u3002</p>"},{"location":"chap7/int_anws/","title":"\u67b6\u6784\u5e08\u9762\u8bd5\u5408\u96c6","text":""},{"location":"chap7/int_anws/#redis","title":"Redis \u9762\u8bd5","text":""},{"location":"chap7/int_anws/#1","title":"1 \u6d41\u91cf\u6d2a\u5cf0\u77ed\u65f6\u95f4\u8bbf\u95ee\u91cf\u9661\u589e","text":"<ul> <li>\u670d\u52a1\u5668\u625b\u4e0d\u4f4f\uff0c\u670d\u52a1\u5668\u5c31\u5bb9\u6613\u51fa\u73b0\u8fd9\u4e2a\u6027\u80fd\u74f6\u9888\u6765\u4e0d\u53ca\u54cd\u5e94</li> </ul> <p>\u89e3\u51b3\u65b9\u6848</p> <ol> <li> <p>\u4e3a\u4e86\u4fdd\u969c\u6574\u4e2a\u670d\u52a1\u7684\u4e0d\u88ab\u6d41\u91cf\u6d2a\u5cf0\u6240\u51fb\u57ae\uff0c\u90a3\u6211\u4eec\u5728\u8fd9\u4e2a\u7f51\u5173\u5c42\u5462\u5c31\u5fc5\u987b\u505a\u4e00\u4e2a\u6d41\u91cf\u7684\u9650\u5236\u3002\u6b64\u5982\u8bf4\u8bbe\u7f6e\u547d\u724c\u7b52token bucket\u7684\u7b97\u6cd5\u5728\u89c4\u5b9a\u7684\u65f6\u95f4\u5185, \u5141\u8bb8\u4e00\u5b9a\u91cf\u7684\u8fd9\u4e2a\u6d41\u91cf\u7684\u6d8c\u5165\uff0c \u5269\u4f59\u7684\u8fd9\u4e2a\u8bf7\u6c42\u9700\u8981\u4f9d\u6b21\u6392\u961f\u3002</p> <ul> <li>\u5728\u7528\u6237\u624b\u673a\u7aef\u5462\u5c31\u662f\u7b49\u5f85\u8d85\u65f6\uff0c\u7a0d\u540e\u518d\u8bd5\u4e00\u4e9b\u63d0\u793a</li> <li>\u7b2c\u4e8c\u5c31\u662f\u5e94\u7528\u7684\u5d29\u6e83</li> </ul> </li> <li> <p>\u62b5\u6321\u4e0d\u4e86\u90a3\u4e48\u5927\u7684\u6d41\u91cf\u5e76\u53d1\uff0c\u5b9e\u9645\u7684\u5e76\u53d1\u91cf\u8fdc\u8fdc\u8d85\u8fc7\u7406\u8bba\u4e0a\u7684\u8fd9\u4e2a\u6700\u9ad8\u7684\u5e76\u53d1\u91cf\uff0c\u800c\u8fd0\u7ef4\u4eba\u5458\u7684\u6269\u5bb9\u662f\u9700\u8981\u65f6\u95f4\u54cd\u5e94\u6216\u8005\u5462\u6ca1\u6709\u4e0a\u4e91\u670d\u52a1\u7684\u5f39\u6027\u6269\u5bb9\u3002 \u6ca1\u6709\u529e\u6cd5\u6839\u636e\u6d41\u91cf\u6765\u52a8\u6001\u7684\u589e\u52a0\u76f8\u5e94\u7684\u673a\u5668\u6765\u4fdd\u969c\u670d\u52a1\uff0c\u5c31\u662f\u62b5\u6321\u4e0d\u4e86\u6d41\u91cf\u6d2a\u5cf0\uff0c\u5e94\u7528\u5d29\u6e83</p> </li> <li> <p>\u7b2c\u4e09\u70b9\u5c31\u662f\u6570\u636e\u5e93\u7684\u6027\u80fd\u74f6\u9888\uff0c\u6570\u636e\u5e93\u96c6\u7fa4\u7684\u8bfb\u5199\u5206\u79bb\u3002\u6ee1\u8db3\u4e0d\u4e86\u8db3\u591f\u591a\u7684\u6570\u636e\u8bf7\u6c42\u3002\u8981\u589e\u52a0\u4e00\u4e9b\u6570\u636e\u5e93\u7684\u670d\u52a1\u5668\u3002\u6bd4\u5982\u8bf4\u589e\u52a0\u7f13\u5b58\u670d\u52a1\u5668\uff0c\u5c31\u662f\u505a\u4e00\u4e9b\u63d0\u524d\u7684\u8ba1\u7b97\u3002</p> <ul> <li>\u7528\u6237\u53ea\u8981\u4e00\u4e00\u6709\u8bf7\u6c42\uff0c\u670d\u52a1\u5668\u5c31\u80fd\u591f\u7acb\u9a6c\u54cd\u5e94\u3002\u4ee5\u7a7a\u95f4\u6362\u65f6\u95f4\u7684\u8fd9\u4e48\u4e00\u4e2a\u505a\u6cd5</li> </ul> </li> <li>\u7b2c\u56db\u70b9\u5462\u5c31\u662f\u7b2c\u4e09\u65b9\u6570\u636e\u63a5\u53e3\u7684\u5d29\u6e83\u3002\u5065\u5eb7\u7801\u5173\u8054\u7684\u5f88\u591a\u7684\u6570\u636e\uff0c\u5173\u8054\u670d\u52a1\u7684\u8c03\u7528\u3002\u5982\u679c\u7b2c\u4e09\u65b9\u7684\u8fd9\u4e2a\u6570\u636e\u63a5\u53e3\u625b\u4e0d\u4f4f\u8fd9\u4e48\u5927\u7684\u8fd9\u4e2a\u5e76\u53d1\u8bf7\u6c42\u5c31\u4f1a\u5bfc\u81f4\u8c03\u7528\u7684\u8d85\u65f6\u670d\u52a1\u7684\u4e0d\u53ef\u7528</li> </ol>"},{"location":"chap7/int_anws/#2","title":"2 \u5fc5\u987b\u8981\u638c\u63e1\u7684\u6570\u636e\u5e93\u4f18\u5316\u6280\u5de7","text":"<p>\u8fd9\u4e09\u4e2a\u6570\u636e\u5e93\u8bbe\u8ba1\u7684\u8981\u70b9\u5fc5\u987b\u638c\u63e1, \u5206\u522b\u662f\u4e3b\u4ece\u590d\u5236,\u8bfb\u5199\u5206\u79bb, \u5206\u5e93\u5206\u8868, \u5c31\u9700\u8981\u53bb\u8003\u8651\u589e\u52a0\u6570\u636e\u5e93\u670d\u52a1\u5668\u3002</p> <p>\u4e00\u822c\u7684\u8fd9\u4e2a\u4e1a\u52a1\u7cfb\u7edf, \u90fd\u662f\u8bfb\u591a\u5199\u5c11\u3002 \u4e00\u822c\u90fd\u4f1a\u91c7\u7528\u4e00\u4e3b\u591a\u4ece\u7684\u6570\u636e\u5e93\u67b6\u6784\uff0c\u4e00\u4e2a\u4e3b\u5e93\u642d\u914d\u591a\u4e2a\u4ece\u5e93\uff0c\u90a3\u4e3b\u5e93\u8d1f\u8d23\u5199\uff0c\u4ece\u5e93\u8d1f\u8d23\u8bfb\u3002\u5728\u8bfb\u5199\u7684\u65f6\u5019\uff0c\u901a\u8fc7\u89e6\u53d1\u5668\u6765\u5224\u5b9a\u8bfb\u8fd8\u662f\u5199\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u5e38\u8bf4\u7684\u8bfb\u5199\u5206\u79bb</p> <p>\u8bfb\u5199\u5206\u79bb</p> <p>\u5c31\u53ef\u4ee5\u5927\u5927\u7684\u63d0\u9ad8\u4e86\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u67e5\u8be2\u6548\u7387\u53c8\u53ef\u4ee5\u964d\u4f4e\u5355\u5e93\u8bfb\u5199\u5e26\u6765\u7684\u8fd9\u4e2a\u5e76\u53d1\u6c96\u7a81. \u591a\u4e2a\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u6570\u636e\u540c\u6b65\u600e\u4e48\u529e? \u4e3b\u4ece\u540c\u6b65\u7684\u539f\u7406\u6570\u636e\u5e93\u707e\u96be\u7684\u6062\u590d\u7684\u539f\u7406\u662f\u4e00\u81f4\u7684. \u90fd\u662f\u901a\u8fc7\u65e5\u5fd7, \u5c06\u8bb0\u5f55\u7684\u6240\u6709\u7684\u8fd9\u4e2adml\u64cd\u4f5c\u91cd\u65b0\u6267\u884c\u2014\u904d. \u6bd4\u5982\u8bf4Mysql \u90a3\u4e3b\u5e93\u6240\u6709\u7684\u589e\u5220\u6539, \u90fd\u4f1a\u5b58\u50a8\u5728\u8fd9\u4e2abinlog \u4e2d. \u5c31\u53ef\u4ee5\u628a\u6240\u6709\u7684\u8fd9\u4e2a\u6570\u636e\u5e93\u64cd\u4f5c, \u4ece\u5e93\u4e0a\u9762\u5168\u90e8\u6267\u884c\u4e00\u904d, \u8fd9\u6837\u5c31\u4f1a\u8f7b\u677e\u7684\u89e3\u6c7a\u6570\u636e\u540c\u6b65\u7684\u95f4\u9898</p> <p>\u5206\u5e93</p> <p>\u5982\u4f55\u5b58\u50a8\u5e73\u53f0\u7684\u8fd9\u4e2a\u5927\u6570\u636e\u91cf,\u5355\u4e2a\u7684\u8fd9\u4e2a\u5173\u7cfb\u6570\u636e\u5e93\u7684\u5bb9\u91cf\u662f\u6709\u9650\u7684\u65e0\u6cd5\u5b58\u653e\u5168\u90e8\u7684\u6570\u636e, \u56e0\u6b64\u9700\u8981\u5206\u800c\u6cbb\u4e4b,  \u5c31\u662f\u5e38\u8bf4\u5206\u5e93\u5206\u8868.  \u6839\u636e\u6570\u636e\u7684\u79cd\u7c7b\u4e0d\u540c,\u53ef\u4ee5\u4ee5\u5efa\u7acb\u591a\u4ecb\u6570\u636e\u5e93, \u5355\u4e2a\u6570\u636e\u5e93\u5462\u4ec5\u5b58\u653e\u4e00\u79cd\u7c7b\u522b\u7684\u6570\u636e. \u5546\u54c1\u6570\u636e, \u7528\u6237\u6570\u636e, \u7269\u6d41\u6570\u636e\u7b49\u7b49\u90a3\u4e48\u5c31\u53ef\u4ee5\u5206\u522b\u521b\u5efa\u8fd9\u4e09\u4e2a\u6570\u636e\u5e93\uff0c\u6765\u5b58\u653e\u8fd9\u4e09\u7c7b\u6570\u636e</p> <p>\u5206\u8868</p> <p>\u5206\u8868\u5c31\u662f\u628a\u539f\u5148\u7684\u4e00\u5f20\u5927\u8868\uff0c\u6309\u7167\u6c34\u5e73\u62c6\u5206\u7684\u65b9\u5f0f\u4ea7\u751f\u591a\u4e2a\u6570\u636e\u8868\u3002\u53ef\u4ee5\u6309\u65f6\u95f4\u62c6\u5206\uff0c\u54c8\u897f\u62c6\u5206\uff0c\u53ef\u4ee5\u53d6\u4f59\u7684\u65b9\u5f0f\u62c6\u5206\u7b49\u7b49\u3002 </p> <p>\u8981\u6839\u636e\u5b9e\u9645\u7684\u8fd9\u4e2a\u4e1a\u52a1\uff0c\u6765\u505a\u4e00\u4e9b\u53d6\u820d\uff0c\u8fd9\u4e2a\u5206\u8868\u540e\u7684\u4e00\u4e2a\u5173\u8054\u67e5\u8be2\u7684\u95ee\u9898\u56e0\u4e3a\u6570\u636e\u5206\u6563\u5728\u591a\u4e2a\u8868\u4e2d\u3002\u8981\u63d0\u524d\u6309\u7167\u7b56\u8def\u627e\u5230\u6570\u636e\u6240\u5728\u7684\u8fd9\u4e2a\u6570\u636e\u8868\uff0c\u624d\u80fd\u8fdb\u884c\u540e\u7eed\u7684\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u64cd\u4f5c</p>"},{"location":"chap7/int_anws/#3-redis-keyvalue","title":"3 Redis \u70edkey\u548c\u5927value","text":"<p>redis \u7684\u70edkey\u548c\u5927value\u5982\u679c\u5904\u7406\u4e0d\u597d\u9020\u6210\u7684\u7ebf\u4e0a\u95ee\u9898\u3002\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u50cfredis\u96c6\u7fa4\u4e2d\uff0c\u6570\u636e\u90fd\u662f\u6bd4\u8f83\u5747\u52fb\u7684\uff0c\u5206\u5e03\u5728\u6bcf\u4e00\u4e2a\u8282\u70b9\u3002\u8bf7\u6c42\u4e5f\u4f1a\u5747\u52fb\u7684\u5206\u5e03\u5230\u6bcf\u4e00\u4e2a\u5206\u7247\u4e0a\uff0c \u4f46\u662f\u4e00\u4e9b\u7279\u6b8a\u7684\u573a\u666f\u4e2d\u3002\u6bd4\u5982\u8bf4\u5916\u90e8\u7684\u722c\u866b\uff0c \u653b\u51fb\u554a\u70ed\u70b9\u5546\u54c1\u7b49\u7b49\u554a\u3002</p> <p>\u90a3\u4e48\u8fd9\u79cd\u77ed\u65f6\u95f4\u5185\uff0c\u67d0\u4e9bkey\u8bbf\u95ee\u91cf\u8fc7\u5927\u7136\u540e\u8bf7\u6c42\u5230\u540c\u4e00\u53f0\u6570\u636e\u5206\u7247\u4e0a\uff0c\u6700\u7ec8\u5bfc\u81f4\u8be5\u5206\u7247\u4e0d\u582a\u91cd\u8d1f\uff0c\u6210\u4e3a\u74f6\u9888\uff0c\u6700\u7ec8\u5c06\u4f1a\u5bfc\u81f4\u7f13\u5b58\u96ea\u5d29</p> <p>\u90a3\u4e48\u600e\u4e48\u76d1\u6d4b\u70ed key</p> <p>\u5e38\u89c4\u5c31\u662f\u6839\u636e\u4e1a\u52a1\u4ee5\u5f80\u7684\u6570\u636e\u505a\u4e00\u4e2a\u5224\u5b9a\uff0c\u6bd4\u5982\u8bf4\u6211\u4eec\u7684\u4fc3\u9500\u6d3b\u52a8\uff0c\u6216\u8005\u5728\u8c03\u7528redis\u7684\u65f6\u5019\uff0c\u5199\u4e00\u4e2a\u65b9\u6cd5\u6765\u5224\u5b9a\u5982\u679c\u89c1\u5230\u5230\u67d0 1 key \u7684 qps \u5982\u679c\u8fbe\u5230\u4e86\u8fd9\u4ecb 1000 \u53ef\u80fd\u5c31\u662f\u4e00\u4e2a\u70ed key</p> <p>\u90a3\u4e48\u600e\u4e48\u89e3\u51b3\u70edkey</p> <p>\u53ef\u4ee5\u6269\u5bb9\uff0c\u589e\u52a0\u5206\u7247\u3002\u526f\u672c\u591a\u4e86\uff0c\u81ea\u7136\u538b\u529b\u5c31\u5206\u62c5\u4e86\u4e00\u4e9b\u3002\u9632\u6b62\u5355\u4e2a\u673a\u5668\u6253\u6302\u3002 </p> <p>\u8fd8\u6709\u4e00\u79cd\u5462\u5c31\u662f\u4f7f\u7528\u8fd9\u4e2a\u4e8c\u7ea7\u7f13\u5b58\uff0c \u628a\u70ed\u70b9\u6570\u636e\u5462\u653e\u5230 jvm \u7684\u672c\u5730\u7f13\u5b58\u4e2d\u3002 \u672c\u5730\u7f13\u5b58\u5462\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2acaffeine, guava. \u8fd9\u6837\u5c31\u76f4\u63a5\u8bfb\u5230\u4e86\u672c\u5730\u7f13\u5b58\u4e86, \u4e0d\u9700\u8981\u518d\u53bb\u8bf7\u6c42 redis. \u5c31\u7701\u53bb\u4e86\u4e00\u6b21\u8fd9\u4e2a\u8fdc\u7a0b\u7684io\u8c03\u7528, \u540c\u6837\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u6846\u67b6, jd-hotkey \u4f1a\u81ea\u52a8\u7684\u53bb\u76d1\u6d4b\u4f60\u7684\u71b1 key\u5e76\u4e14\u8f6c\u4e3aivm\u672c\u5730\u7f13\u5b58</p>"},{"location":"chap7/int_anws/#4-redistvalue","title":"4 redist\u7684\u5927value","text":"<p>\u6709\u65f6\u5019\u4f1a\u628a\u4e00\u4e2a\u5f88\u5927\u7684\u503c\u585e\u5230\u540c\u4e00\u4e2aKey\u4e2d\uff0c \u6bd4\u5982\u8bf4 string \u7c7b\u578b\u5c31\u4f1a\u585e \u4e00\u4ecb\u5f88\u5927\u7684\u5b87\u7b26\u4e32\u6587\u672c\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e9b\u8fd9\u4e2a\u96c6\u5408\u7c7b\u7684ist\uff0cset\u52a8\u4e0d\u52a8\u5c31\u4f1a\u585e\u4e2a\u51e0\u4e07\u6761\u7684\u6570\u636e\u3002 </p> <p>\u90a3\u4e48\u8fd9\u4e9b\u5927valure\uff0c \u5728\u9879\u76ee\u524d\u671f\u53ef\u80fd\u4e0d\u5bb9\u6613\u53d1\u73b0\uff0c\u4f46\u662f\u4e00\u65e6\u5e76\u53d1\u91cf\u5927\u4e86\u4e4b\u540e\uff0c\u5c31\u4f1a\u66b4\u9732\u5f88\u591a\u7684\u95ee\u9898\u4ece\u800c\u6210\u4e3a\u670d\u52a1\u5668\u7684\u6740\u624b\u3002</p> <p>\u6bd4\u5982\u8bf4\u6570\u636e\u503e\u659c\uff0c\u90a3\u4e48\u5927\u7684Value\u4f1a\u5bfc\u81f4\u96c6\u7fa4, \u4e0d\u540c\u7684\u8282\u70b9\u7684\u6570\u636e\u5206\u5e03\u4e0d\u5747\u5300.\u90a3\u4e48\u6709\u7684\u591a\u6709\u7684\u5c11, \u4f1a\u9020\u6210\u6570\u636e\u503e\u659c\u7684\u5411\u9898. \u5927\u91cf\u8bfb\u5199\u6bd4\u4f8b\u975e\u5e38\u9ad8\u7684\u8bf7\u6c42\uff0c\u5c31\u4f1a\u843d\u5230\u540c\u4e00\u4e2a\u8282\u70b9\u4e0a\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8303\u70b9\u7684\u8d1f\u8f7d\uff0c\u5c31\u4f1a\u4e25\u91cd\u7684\u5347\u9ad8\uff0c\u5bb9\u6613\u6253\u6302\u3002</p> <p>\u53e6\u5916\u5927value, \u5728\u67e5\u8be2\u7684\u65f6\u5019\u5462\u4f1a\u5360\u7528 redis server\u7684\u7f13\u5b58, \u5c31\u4f1a\u5bfc\u81f4redis \u670d\u52a1\u5668\u7684\u7f13\u51b2\u533a\u4e0d\u8db3 ,\u5927\u91cf\u7684\u8bf7\u6c42\u5c31\u4f1a\u51fa\u73b0\u8d85\u65f6\u7684\u73b0\u8c61. \u6570\u636e\u5e93\u5c42\u88ab\u51fb\u7a7f\u7684\u8fde\u9501\u53cd\u5e94</p> <p>\u600e\u4e48\u89e3\u6c7a\uff1a \u62c6</p> <p>\u628a\u4f60\u7684\u5927value, \u5927list\u62c6\u6210\u591a\u4e2akey-value. \u5c06\u64cd\u4f5c\u538b\u529b\uff0c\u5e73\u644a\u5230\u591a\u4e2a redis \u5b9e\u4f8b\u4e2d\uff0c\u964d\u4f4e\u5bf9\u5355\u4e2a\u8282\u70b9\u7684 IO\u5f71\u54cd. \u53ef\u4ee5\u4f7f\u7528\u54c8\u897f\u7b97\u6cd5\u53bb\u62c6, \u4f7f\u7528\u8fd9\u4e2a\u53d6\u6a21\u7684\u7b97\u6cd5\u53bb\u62c6\uff0c \u6838\u5fc3\u7684\u601d\u60f3\u662f\u5c06value\u6253\u6563\u3002\u6bcf\u6b21\u53eaget \u4f60\u9700\u8981\u7684\u6570\u636e\uff0c\u7c7b\u4f3c\u4e8e\u6570\u636e\u5e93\u4e2d\u7684\u5206\u5e93\u5206\u8868</p>"},{"location":"chap7/int_anws/#5-redis","title":"5 Redis \u7f13\u5b58\u96ea\u5d29","text":"<p>\u4ec0\u4e48\u662f\u7f13\u5b58\u96ea\u5d29</p> <p>\u5927\u91cf\u7684\u67e5\u8be2\u8bf7\u6c42\uff0c\u5728redis\u5c42\u627e\u4e0d\u5230\u6570\u636e\uff0c\u5c31\u4f1a\u6e17\u900f\u5230\u6570\u636e\u5e93\u5c42\uff0c\u90a3\u4e48\u6570\u636e\u5e93\u77ed\u65f6\u95ee\u5185\u538b\u529b\u5c71\u5927\u3002\u5927\u91cf\u7684\u8bf7\u6c42\u4f1a\u9020\u6210\u67e5\u8be2\u963b\u585e\uff0c\u628a\u6570\u636e\u5e93\u62d6\u6b7b\u4e86\u3002</p> <p>\u600e\u4e48\u5f15\u8d77\u7684\u7f13\u9707\u96ea\u5d29</p> <p>\u5927\u6279\u91cf\u7684\u70ed\u70b9\u6570\u636e\u7684\u8fc7\u671f\uff0c\u90a3\u4e48\u70ed\u70b9\u6570\u636e\u4e00\u65e6\u8fc7\u671f\uff0c\u81ea\u7136\u5728redis\u91cc\u9762\u5c31\u67e5\u4e0d\u5230\u6570\u636e\uff0c\u5c31\u4f1a\u56de\u6e90\u6570\u636e\u5e93\u3002\u90a3\u4e48\u5927\u4e95\u53d1\u91cf\u7684\u8bf7\u6c42\uff0c \u5728\u77ac\u95f4\u5c31\u4f1a\u538b\u5230\u6570\u636e\u5e93\u4e0a</p> <p>\u53e6\u4e00\u4e2a\u539f\u56e0</p> <p>\u5c31\u662fredis\u5b9e\u4f8b\u53d1\u751f\u4e86\u6545\u969c\uff0c\u90a3\u4e48\u65e0\u6cd5\u5904\u7406\u8bf7\u6c42\uff0c\u4ed6\u62d6\u6b7b\u4e86Redis\u7684\u8282\u70b9\uff0c\u90a3\u4e48\u4e5f\u4f1a\u5bfc\u81f4\u5927\u91cf\u7684\u8bf7\u6c42\u79ef\u538b\u5230\u6570\u636e\u5e93\u5c42\uff0c </p> <p>\u90a3\u4e48\u5bf9\u4e8e\u6570\u636e\u8fc7\u671f\uff0c\u53ef\u4ee5\u4f7f\u7528\u5dee\u5f02\u5316\u53bb\u5b9a\u4e49\u7f13\u5b58\u8fc7\u671f\u65f6\u95f4\uff0c\u90a3\u4e0d\u8981\u628a\u5927\u91cf\u7684key \u5728\u540c\u4e00\u4e2a\u65f6\u95f4\u5185\u8fc7\u671f\u3002 \u6bd4\u5982\u8bf4\u5728\u521d\u59cb\u5316\u7f13\u5b58\u7684\u540c\u65f6\uff0c \u7ed9\u8fd9\u4e9b\u6570\u636e\u8fc7\u671f\u65f6\u95f4\u589e\u52a0\u4e00\u4e2a\u6bd4\u8f83\u5c0f\u7684\u4e00\u4e2a\u968f\u673a\u6570\uff0c\u53ef\u4ee5\u907f\u514d\u4e86\u5927\u91cf\u7684\u6570\u636e\u540c\u65f6\u8fc7\u671f\u3002\u53c8\u80fd\u4fdd\u8bc1\u8fd9\u4e9b\u6570\u636e\u5728\u76f8\u8fd1\u7684\u65f6\u95f4\u5185\u5931\u6548</p> <p>\u540c\u65f6\u5462\u6211\u4eec\u4e5f\u53ef\u4ee5\u8ba9\u8fd9\u4e2a\u670d\u52a1\u964d\u7ea7\uff0c \u5141\u8bb8\u6838\u5fc3\u4e1a\u52a1\u8bbf\u95ee\u6570\u636e\u5e93\uff0c\u975e\u6838\u5fc3\u4e1a\u52a1\u76f4\u63a5\u8fd4\u56de\u4e8b\u5148\u5b9a\u4e49\u597d\u7684\u4fe1\u606f\u3002 \u90a3\u4e48\u9488\u5bf9 redis\u670d\u52a1\u5b95\u673a\uff0c\u53ef\u4ee5\u505a\u8fd9\u4e2a\u8bf7\u6c42\u9650\u6d41\u5bf9\u3002</p> <p>\u63a7\u5236\u6bcf\u79d2\u8fdb\u5165\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd9\u4e2a\u8bf7\u6c42\u6570\uff0c\u907f\u514d\u8fc7\u591a\u7684\u8bf7\u6c42\u538b\u5230\u6570\u636e\u5e93\u53ef\u4ee5\u505a\u670d\u52a1\u7194\u65ad\u3002</p> <p>\u6682\u505c\u4e1a\u52a1\u7684\u5e94\u7528\uff0c\u5bf9\u7f13\u5b58\u670d\u52a1\u7684\u8bbf\u95ee\uff0c\u5148\u8d70ivm\u7f13\u5b58\uff0c\u4ece\u800c\u964d\u4f4e\u5bf9\u6570\u636e\u5e93\u7684\u538b\u529b\u5f53\u7136\u8fd9\u4e9b\u90fd\u662f\u6743\u76ca\u4e4b\u8ba1\u8fd8\u662f\u8981\u4fdd\u8bc1redis\u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u90a3\u4e48\u4e3b\u8282\u70b9\u4e00\u65e6\u5b95\u673a\uff0c\u90a3\u4e48\u4ece\u8282\u70b9\u5c31\u53ef\u4ee5\u5feb\u901f\u7684\u5207\u6362\u5230\u4e3b\u8282\u70b9\u90a3\u4e48\u7ee7\u7eed\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1</p>"},{"location":"chap7/int_anws/#6-redis","title":"6 Redis\u7f13\u5b58\u7a7f\u900f","text":"<p>\u4ec0\u4e48\u662f\u7f13\u5b58\u7a7f\u900f\uff0c\u7b80\u5355\u6765\u8bb2\u5c31\u662f\u5728\u67e5\u627e\u8fd9\u4e2a key \u5728\u7f13\u5b58\u548c\u6570\u636e\u5e93\u4e2d\u90fd\u4e0d\u5b58\u5728\u3002\u5bfc\u81f4\u6bcf\u6b21\u8bf7\u6c42\u6570\u636e\uff0c \u4ece\u7f13\u5b58\u4e2d\u90fd\u83b7\u53d6\u4e0d\u5230\uff0c \u4ece\u800c\u5c06\u8fd9\u4e2a\u8bf7\u6c42\u6253\u5230\u6570\u636e\u5e93\u4e0a\uff0c\u4f46\u6570\u636e\u5e93\u4e2d\u4e5f\u6ca1\u6709\u5bf9\u5e94\u7684\u6570\u636e\u3002 \u5c31\u662f\u6bcf\u4e00\u6b21\u8bf7\u6c42\uff0c\u90fd\u76f4\u63a5\u6253\u5728\u6570\u636e\u5e93\u4e0a\u9762\u7f13\u5b58\u4e0d\u8d77\u4efb\u4f55\u7684\u4f5c\u7528\u3002 \u90a3\u4e48\u4e00\u65e6\u5e76\u53d1\u91cf\u4e0a\u6765\u4e4b\u540e\uff0c \u6570\u636e\u5e93\u538b\u529b\u5c31\u5927\u4e86</p> <p>\u7f13\u5b58\u7a7f\u900f\u662f\u600e\u4e48\u5f15\u8d77\u7684\uff0c \u5e38\u89c1\u5c31\u662f\u6570\u636e\u540c\u6b65\u7684\u95ee\u9898\u3002 \u5e93\u91cc\u7a81\u7136\u5220\u9664\u4e86\u67d0\u4e00\u4e2a\u5546\u54c1\u7684\u4fe1\u606f\uff0c\u53ef\u80fd\u662f\u8bef\u64cd\u4f5c\u3002\u90a3\u5fae\u670d\u52a1\u7684\u5176\u4ed6\u677f\u5757\u7684\u6570\u636e\u540c\u6b65\u7684\u6bd4\u8f83\u6162\u6216\u8005\u540c\u6b65\u5931\u8d25\u3002 \u90a3\u4e48\u5217\u8868\u4e2d\u8fd8\u6709\u8fd9\u6761\u6570\u636e\uff0c\u6070\u5de7\u8bbf\u95ee\u8fd9\u6761\u6570\u636e\u7684\u4eba\u5f88\u591a\u3002</p> <p>\u8bbf\u95eeredis\u6ca1\u6709\u6570\u636e\uff0c\u8bbf\u95ee\u6570\u636e\u5e93\u4e5f\u6ca1\u6709\u6570\u636e\uff0c\u8fd9\u4e2a\u5c31\u53d1\u751f\u4e86\u4e00\u6b21\u7a7f\u900f\uff0c\u90a3\u4e48\u8fd8\u6709\u4e00\u79cd\u53ef\u80fd\u5c31\u662f\u6076\u610f\u653b\u51fb\uff0c\u627e\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684 id\uff0c\u6bd4\u5982\u8bf4 id \u5c0f\u4e8e0\uff0c\u8fd9\u4e2a\u80af\u5b9a\u662f\u4e0d\u5b58\u5728\u7684\u3002 \u90a3\u4e48redis \u4e2d\u53c8\u6ca1\u6709\u9884\u70ed\uff0c \u6570\u636e\u5e93\u4e2d\u4e5f\u6ca1\u6709\uff0c\u5982\u679c\u518d\u52a0\u4e0a\u8fd9\u4e2a\u5e76\u53d1\u8bf7\u6c42\uff0c\u5c31\u53d8\u6210\u4e86\u6076\u610f\u653b\u51fb\u6570\u636e\u5e93\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u505a\u7279\u6b8a\u5904\u7406\uff0c\u77ac\u95f4\u5c31\u4f1a\u6253\u6ee1\u6570\u636e\u5e93\u7684 Cpu\uff0c\u90a3\u4e48\u6700\u7ec8\u7cfb\u7edf\u53ef\u80fd\u4f1a\u5d29\u6389\u3002</p> <p>\u600e\u4e48\u89e3\u6c7a\u7f13\u5b58\u7a7f\u900f\u3002</p> <p>\u90a3\u5982\u679c\u4e00\u4e2a\u67e5\u8be2\u8fd4\u56de\u7684\u6570\u636e\u4e3a\u7a7a\uff0c\u4e0d\u7ba1\u662f\u6570\u636e\u4e0d\u5b58\u5728\u8fd8\u662f\u7cfb\u7edf\u6545\u969c\uff0c\u6211\u4eec\u4ecd\u7136\u628a\u8fd9\u4e2a\u7a7a\u503c\u8fdb\u884c\u7f13\u5b58\uff0c \u4f46\u5b83\u7684\u8fc7\u671f\u65f6\u95f4\u5462\u53ef\u4ee5\u8bbe\u7f6e\u7684\u5f88\u77ed\uff0c\u6700\u957f\u4e0d\u8981\u8d85\u8fc75\u5206\u949f\u3002</p> <p>\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u8bbe\u7f6e\u8fc7\u957f\uff0c \u4e00\u4e2a\u662f\u5360\u6709\u7f13\u5b58\uff0c\u53e6\u4e00\u4e2a\u5982\u679c\u6709\u4e86\u65b0\u6570\u636e\u3002\u4f1a\u9020\u6210\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u60c5\u6cc1\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u65b9\u6cd5\u5462\u5c31\u662f\u4f7f\u7528\u5e03\u9686\u8fc7\u6ee4\u5668\uff0c\u5224\u65ad\u8bf7\u6c42\u5bf9\u5e94\u7684\u952e\uff0c\u662f\u5426\u5728\u8fd9\u4e2a\u8fc7\u6ee4\u5668\u4e2d\uff0c\u5982\u679c\u4e0d\u5728\u5c31\u76f4\u63a5\u8fd4\u56de\u3002\u4e0d\u53bb\u8bf7\u6c42\u6570\u636e\u5e93\u4e5f\u4e0d\u53bb\u7f13\u5b58\u7a7a\u503c\uff0c\u6781\u5c11\u7684\u7a7a\u95f4\u6765\u6807\u8bc6\u8d85\u5927\u91cf\u7684\u6570\u636e</p>"},{"location":"chap7/int_anws/#7-redis","title":"7 \u5982\u4f55\u4fdd\u969credis\u6302\u4e86\u4e4b\u540e: \u6570\u636e\u4e0d\u4e1f\u5931\uff1f","text":"<p>redis\u6570\u636e\u662f\u5168\u90e8\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u7684, \u90a3\u4e48\u5982\u679c\u673a\u5668\u7a81\u7136\u6302, \u90a3\u4e48\u6570\u636e\u5c31\u4f1a\u5168\u90e8\u4e22.\u6570\u636e\u4e0d\u4f1a\u56e0\u4e3aredis\u6302\u4e86\u800c\u4e22\u5931, \u5c31\u662fredis\u6240\u8c13\u7684\u7279\u4e45\u5316\u673a\u5236. </p> <p>\u6301\u4e45\u5316\u7684\u5b58\u50a8\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2a\u78c1\u76d8\u4e0a\u7684\u6587\u672c\u6587\u6863, \u65e5\u5fd7\u6587\u4ef6, \u8fd8\u6709\u6570\u636e\u5e93\u6587\u4ef6\u7b49\u7b49.  \u90fd\u662f\u5c5e\u4e8e\u8fd9\u4e2a\u6570\u636e\u7684\u6301\u4e45\u5316,  redis\u7684\u6301\u4e45\u5316\u5728\u78c1\u76d8\u4e0a\u627e\u4e00\u4e2a\u5730\u65b9\u6765\u5b58\u50a8\u3002 </p> <p>\u4e00\u79cd\u5462\u53eb<code>rdb</code>\uff0crdb\u5c31\u662f<code>redisdatabase</code>, \u5c31\u662f\u5e38\u8bf4\u7684\u8fd9\u4e2aredis\u6570\u636e\u5e93,\u53c9\u53eb\u5185\u5b58\u5b58\u5feb\u7167\u3002 \u53ef\u4ee5\u5b9a\u65f6\u7684\u53bb\u5907\u4efd\u7f13\u5b58\u4e2d\u7684\u6570\u636e\uff0c\u9694\u4e00\u6bb5\u65f6\u95f4\u5c31\u4f1a\u6267\u884c\u4e00\u6b21\u5907\u4efd\u3002 </p> <p>\u5c31\u8ddf\u5b9a\u671f\u5907\u4efd\u6570\u636e\u5e93\u6587\u4ef6\u4e00\u6837,\u90a3\u5982\u679credis\u6302\u4e86,\u518d\u6b21\u542f\u52a8\u7684\u65f6\u5019. \u5c31\u4f1a\u4ece\u6700\u65b0\u7684rdb\u6587\u4ef6\u4e2d\u52a0\u8f7d\u6570\u636e,  </p> <p>\u53e6\u4e00\u4e2a\u662faof\uff0c\u5168\u79f0\u662f<code>append only file</code>. \u662f\u5728\u4e00\u4e2a\u6587\u4ef6\u91cc\u9762\u53bb\u8ffd\u52a0\u4ed6\u7684\u547d\u4ee4\uff0c\u662f\u8bb0\u5f55redis\u7f13\u5b58\u4e2d\u6240\u6709\u7684\u4fee\u6539\u3002 </p> <p>\u65b0\u589e\u7684\u5220\u9664\u7684\u65e5\u5fd7\uff0c \u90fd\u4f1a\u4ee5\u547d\u4ee4\u7684\u65b9\u5f0f\uff0c \u4e00\u6761\u4e00\u6761\u7684\u5b58\u50a8\u5728\u65e5\u5fd7\u4e2d\uff0c \u6240\u4ee5\u4e00\u65e6redis\u6302\u4e86\uff0c\u91cd\u542fredis\u7684\u65f6\u5019\uff0c \u5c31\u4f1a\u6839\u636e\u65e5\u5fd7\u4e2d\u7684\u547d\u4ee4\u5f88\u8f7b\u677e\u7684\u6765\u6062\u590d\u6570\u636e\u3002 \u5c31\u8ddfmysql\u4e2d\u7684binlog\u975e\u5e38\u50cf\uff0c\u53ea\u5b58\u50a8\u547d\u4ee4\u3002 </p> <p>\u4e0d\u5b58\u50a8\u6570\u636e\u9700\u8981\u7684\u65f6\u5019\uff0c\u9700\u8981\u6062\u590d\u6570\u636e\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u547d\u4ee4\u5c31OK\u3002\u90a3\u4e48\u6709\u4e86aof\u673a\u5236\uff0c \u4e5f\u53ef\u4ee5\u5f80\u5176\u4ed6\u7684\u4e00\u4e9b\u4e2d\u95f4\u952e\uff0c\u90fd\u4f1a\u4ee5\u547d\u4ee4\u7684\u65b9\u5f0f\uff0c\u4e00\u6761\u4e00\u6761\u7684\u5b58\u50a8\u5728\u65e5\u5fd7\u4e2d\uff0c \u6240\u4ee5\u2014\u65e6redis\u6302\u4e86\uff0c \u91cd\u540eredis\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u6839\u636e\u65e5\u5fd7\u4e2d\u7684\u547d\u4ee4\u3002 \u6062\u590d\u6570\u636e\uff0c \u9700\u8981\u6062\u590d\u6570\u636e\u7684\u65f6\u5019\uff0c \u90a3\u4e48\u6709\u4e86aof\u673a\u5236\uff0c \u505a\u4e86\u4e00\u4e9b\u6570\u636e\u540c\u6b65\uff0c \u6bd4\u5982\u8bf4\u50cf\u641c\u7d22\u5f15\u64ceES\u3002</p>"},{"location":"chap7/int_anws/#8","title":"8 \u8bfb\u591a\u5199\u5c11\u7684\u573a\u666f \u8be5\u7528\u4ec0\u4e48\u7f13\u5b58\u8bfb\u5199\u7b56\u7565","text":"<p>\u6211\u4eec\u7528redis\u7f13\u5b58\u6700\u591a\u7684\u573a\u666f\u5c31\u662f\u8bfb\u591a\u5199\u5c11\uff0c 90%\u7684\u573a\u666f\u662f\u8bfb\uff0c10%\u7684\u573a\u666f\u662f\u5199\uff0c\u8be5\u600e\u4e48\u9009\u62e9\u7b56\u8def\u624d\u80fd\u591f\u8ba9\u7f13\u5b58\u8bfb\u8bfb\u5199\u7387\u6700\u9ad8\uff0c\u6027\u80fd\u6700\u597d\u3002\u6211\u4eec\u4e00\u822c\u4f1a\u9009\u62e9\u4e00\u79cd\u6700\u5e38\u7528\u7684\u7f13\u5b58\u8bfb\u5199\u7b56\u7565\uff0c\u53eb\u505a cache-aside\uff0c\u4e5f\u53eb\u65c1\u5165\u7f13\u5b58\u7b56\u7565</p> <p>\u573a\u666f\u4e2d\u7684\u6570\u636e\uff0c\u662f\u4ee5\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u4e3a\u6dee\u7684\uff0c\u90a3\u4e48\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u662f\u6309\u9700\u52a0\u8f7d\u7684\uff0c\u6709\u9700\u8981\u5c31\u52a0\u8f7d\uff0c\u4e0d\u9700\u8981\u5c31\u4e0d\u52a0\u8f7d\u3002</p> <p>\u4e5f\u5c31\u662fredis\u6240\u8c13\u7684\u60f0\u6027\u52a0\u8f7d\u673a\u5236\uff0c\u8bfb\u7b56\u7565\u5f88\u7b80\u5355\u3002 \u5148\u4ece\u7f13\u5b58\u4e2d\u53bb\u8bfb\u6570\u636e\uff0c\u5982\u679c\u7f13\u5b58\u547d\u4e2d\u5c31\u76f4\u63a5\u8fd4\u56de\u6570\u636e\uff0c\u5982\u679c\u7f13\u5b58\u547d\u4e2d\u5931\u8d25\uff0c\u4ece\u6570\u636e\u5e93\u4e2d\u67e5\u8be2\u6570\u636e\uff0c\u67e5\u8be2\u5230\u6570\u636e\u4e4b\u540e\u3002 \u5c06\u6570\u636e\u5199\u5165\u5230\u7f13\u5b58\u4e2d\u5e76\u4e14\u8fd4\u56de\u7ed9\u7528\u6237\uff0c\u8fd9\u4e2a\u5c31\u662f\u4ed6\u7684\u4e00\u4e2a\u8bfb\u7b56\u8def\u3002</p> <p>\u50cf\u793e\u4ea4\u5e73\u53f0\u7684\u7528\u6237\u4fe1\u606f\uff0c \u5c31\u975e\u5e38\u9002\u5408\u7528cache-aside\u7684\u7b56\u7565\u3002\u90a3\u4e48\u6709\u7684\u7528\u6237\u4e3b\u9875\u8bbf\u95ee\u91cf\u591a\uff0c \u6709\u7684\u7528\u6237\u5462\u8bbf\u95ee\u91cf\u5c11\uff0c\u5c31\u80fd\u591f\u5927\u5927\u7684\u6e1b\u5c11\u51b7\u6570\u636e\u5360\u7528\u7684\u5185\u5b58\u7a7a\u95f4  \u56e0\u4e3a\u5185\u5b58\u5bf9\u4e8e\u6211\u4eec\u662f\u975e\u5e38\u7684\u5b9d\u8d35\u7684\uff0c </p> <p>\u90a3\u4e48\u5bf9\u4e8e\u5199\u7b56\u7565\uff0c \u6b65\u9aa4\u975e\u5e38\u7b80\u5355\u3002 \u5148\u66f4\u65b0\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\uff0c \u7136\u540e\u518d\u5220\u9664\u7f13\u5b58\u8bb0\u5f55\u3002\u8fd9\u65f6\u5019\u5982\u679c\u6709\u65b0\u7684\u8bf7\u6c42\u8fdb\u6765\uff0c \u5c31\u4f1a\u5148\u8bfb\u6570\u636e\u5e93\uff0c\u518d\u628a\u6570\u636e\u5199\u5165\u5230\u7f13\u5b58\u4e2d\u3002 </p> <p>Cache aside\u7684\u5b58\u5728\u7684\u6700\u5927\u95ee\u9898</p> <p>\u5c31\u662f\u5f53\u5199\u5165\u7684\u6b64\u8f83\u9891\u7e41\u7684\u65f6\u5019\uff0c \u6309\u7167\u8fd9\u4e2a\u5199\u7b56\u8def\u3002\u7f13\u5b58\u4e2d\u7684\u8fd9\u4e2a\u6570\u636e\uff0c \u5c31\u4f1a\u88ab\u9891\u7e41\u7684\u6e05\u7406\u3002\u4e00\u65e6\u5927\u91cf\u7684\u8bf7\u6c42\u8fc7\u6765\uff0c\u5f88\u591a\u7f13\u5b58\u627e\u4e0d\u5230\uff0c\u5c31\u4f1a\u5bf9\u7f13\u5b58\u7684\u547d\u4e2d\u7387\uff0c\u6709\u4e00\u5b9a\u7684\u5f71\u54cd\u5c31\u4f1a\u5f71\u54cd\u5230\u6570\u636e\u5e93\u7684\u8bfb\u5199\u6027\u80fd\u3002 </p> <p>\u53e6\u5916\u5c31\u662f\u5728\u5e76\u53d1\u7f13\u5b58\u7684\u65f6\u5019\uff0c \u6709\u53ef\u80fd\u4f1a\u5e26\u6765\u7f13\u5b58\u548c\u6570\u636e\u5e93\u4e0d\u4e00\u81f4\u7684\u60c5\u6cc1\u3002 \u8981\u5728\u66f4\u65b0\u7f13\u5b58\u524d\uff0c\u6765\u589e\u52a0\u4e00\u4e2a\u5206\u5e03\u5f0f\u9501\u3002 \u56e0\u4e3a\u8fd9\u6837\u5728\u540c\u4e00\u65f6\u95f4\uff0c\u53ea\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u6765\u66f4\u65b0\u7f13\u5b58, \u5c31\u4e0d\u4f1a\u4ea7\u751f\u5e76\u53d1\u95ee\u9898. \u5bf9\u4e8e\u5199\u5165\u7684\u6027\u80fd\u4f1a\u6709\u4e00\u5b9a\u7684\u5f71\u54cd\uff0c\u4e00\u65e6\u591a\u4e86\u4e4b\u540e\uff0c\u6027\u80fd\u5c31\u4f1a\u5927\u6253\u6298\u6263</p>"},{"location":"chap7/int_anws/#9","title":"9 \u8bfb\u591a\u5199\u591a\u7684\u573a\u666f \u8be5\u600e\u4e48\u9009\u62e9\u7f13\u5b58\u7b56\u7565","text":"<p>\u5f02\u6b65\u7f13\u5b58\u5199\u5165\u7684\u8bfb\u5199\u7b56\u7565 , \u53c8\u53eb\u505a write behind caching\uff0c\u628a\u7f13\u5b58\u4f5c\u4e3a\u4e3b\u8981\u7684\u6570\u636e\u5b58\u50a8\uff0c\u6ce8\u610f\u662f\u4f5c\u4e3a\u4e3b\u8981\u7684\u6570\u636e\u5b58\u50a8\u3002 \u90a3\u4e48\u4e00\u65e6\u6709\u5199\u6570\u636e\u7684\u8bf7\u6c42\uff0c\u6211\u4eec\u5148\u66f4\u65b0\u7f13\u5b58\uff0c\u4e0d\u76f4\u63a5\u66f4\u65b0\u6570\u636e\u5e93\u3002</p> <p>\u4e0d\u7ba1\u662f\u8bfb\u64cd\u4f5c\u4e5f\u597d\u8fd8\u662f\u5199\u64cd\u4f5c\u4e5f\u597d\uff0c \u4f1a\u628a\u5168\u90e8\u538b\u529b\u653e\u5728redis\u7f13\u5b58\uff0c \u4e0d\u4f1a\u76f4\u63a5\u53bb\u64cd\u4f5c\u6570\u636e\u5e93\u3002 \u6027\u80fd\u5c31\u4f1a\u5927\u5927\u7684\u63d0\u5347\uff0c\u6bd5\u7adf\u8fd9\u4e2a\u5185\u5b58\u7684io\u8bfb\u5199\u7684\u6027\u80fd\uff0c \u5f02\u6b65\u66f4\u65b0\u6570\u636e\u5e93\u5462\u4e5f\u5f88\u5bb9\u6613\u3002 </p> <p>\u53ef\u4ee5\u4f7f\u7528\u6d88\u81ea\u5bf9\u961f\u5217\uff0c \u5728\u8fd9\u4e2a\u6570\u636e\u5e93\u4e0d\u5fd9\uff0c\u6765\u5f02\u6b65\u66f4\u65b0\u5b83\uff0c\u6027\u80fd\u5c31\u4f1a\u5927\u5927\u7684\u63d0\u5347\u554a </p> <p>\u5f02\u6b65\u66f4\u65b0\u6570\u636e\u5e93\u5f88\u5bb9\u6613\uff0c\u4f46\u662f\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5bf9\u6570\u636e\u5e93\u7684\u4e00\u81f4\u6027\uff0c\u4f1a\u5e26\u6765\u5f88\u5927\u7684\u6311\u6218</p>"},{"location":"chap7/int_anws/#10-redis","title":"10 redis\u7f13\u5b58\u8fc7\u671f\u7b56\u7565","text":"<p>\u521a\u8fc7\u671f\u7684\u7f13\u5b58\uff0c \u5927\u6982\u7387\u8fd8\u662f\u4f1a\u5b58\u5728\u5185\u5b58\u4e2d\u3002\u90a3\u4e48\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\uff0c \u5c31\u662fredis\u7684\u7f13\u5b58\u8fc7\u671f\u7b56\u7565\uff0credis\u7f13\u5b58\u8fc7\u671f\u7b56\u7565\uff0c\u4e3b\u8981\u662f\u4e24\u90e8\u5206\u7ec4\u6210</p> <ul> <li> <p>\u4e00\u4e2a\u662f\u5b9a\u671f\u5220\u9664, redis\u9ed8\u8ba4\u662f\u6bcf\u9694100\u6beb\u79d2, \u5c31\u4f1a\u4ece\u6240\u6709\u7684\u8fd9\u4e2akey\u4e2d,\u968f\u673a\u9009\u62e9\u4e00\u90e8\u5206key, \u6765\u68c0\u67e5\u8fc7\u6ca1\u8fc7\u671f, \u90a3\u4e48\u5982\u679c\u8fc7\u671f\u4e86, \u5c31\u6267\u884c\u5220\u9664\u64cd\u4f5c.</p> <ul> <li>\u6ce8\u610f: \u8fd9\u662f\u968f\u673a\u9009\u62e9\u4e00\u90e8\u5206key, \u4e0d\u662f\u68c0\u67e5\u6240\u6709\u7684, \u90a3\u4e48\u5982\u679c\u53bb\u8f6e\u8be2\u6240\u6709\u7684key\u8fc7\u6ca1\u8fc7\u671f, \u5f88\u6709\u53ef\u80fd\u4f1a\u5f15\u53d1\u6027\u80fd\u707e\u96be. \u800c\u5982\u679c\u6709\u51e0\u4e07\u51e0\u5341\u4e07\u4e2akey,\u90a3\u4e48CPU\u6709\u53ef\u80fd\u5403\u4e0d\u6d88, \u56e0\u4e3a\u95f4\u9694\u65f6\u95f4\u77ed. \u6bcf\u4e2a100\u6beb\u79d2\u5462\u5c31\u4f1a\u6267\u884c\u4e00\u6b21. \u90a3\u4e48\u65f6\u95f4\u7d27\u4efb\u52a1\u91cd, \u5168\u90e8\u68c0\u67e5\u80af\u5b9a\u662f\u4e0d\u53ef\u80fd\u7684. </li> <li>\u5b9a\u671f\u5220\u9664\u7b56\u7565\u5176\u5b9e\u5c31\u662f\uff0c\u968f\u673a\u9009\u62e9\u4e00\u90e8\u5206key\u6765\u505a\u68c0\u67e5\uff0c\u5982\u679c\u5230\u671f\u4e86\u5c31\u76f4\u63a5\u5220\u9664</li> <li>\u7b2c2\u4e2a\u8fc7\u671f\u7b56\u7565\u5462\u5c31\u662f\u60f0\u6027\u5220\u9664\u3002 \u4e4b\u524d\u8bf4\u8fc7\u5199\u5165\u7f13\u5b58\uff0c\u53ea\u6709\u8bbf\u95ee\u4e86\u67d0\u6761\u6570\u636e\uff0c \u628a\u4ed6\u7684\u52a0\u8f7d\u5230\u7684\u5185\u5b58\u4e2d\u3002 \u90a3\u4e48\u540c\u6837\u5bf9\u4e8e\u7f13\u5b58\u8fc7\u671f\uff0c \u4e5f\u6709\u7c7b\u4f3c\u7684\u7f13\u5b58\u60f0\u6027\u522a\u9664\uff0c\u5176\u5b9e\u5c31\u662f\u88ab\u52a8\u68c0\u67e5\u5220\u9664\uff0c\u5fc5\u987b\u6709\u4eba\u8bbf\u95ee\u4e86\u8fd9\u4e2akey\uff0c\u90a3\u4e48\u8bbf\u95ee\u7684\u540c\u65f6\u5462\uff0c\u5c31\u4f1a\u53bb\u68c0\u67e5\u8fd9\u4e2akey\u662f\u5426\u8fc7\u671f\uff0c\u5982\u679c\u8fc7\u671f\u4e86\u5c31\u6267\u884c\u5220\u9664\u3002 \u8fd9\u5c31\u662fredis\u6240\u8c13\u7684\u60f0\u6027\u5220\u9664\u673a\u5236\uff0c </li> </ul> </li> <li> <p>\u4e00\u4e9b\u8fc7\u671f\u7684\u51b7\u6570\u636e\uff0c \u4e0d\u7ecf\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u3002 \u4e5f\u6ca1\u6709\u88ab\u5b9a\u671f\u5220\u9664\uff0c \u968f\u673a\u5230\u7684\u8fd9\u4e2a\u6570\u636e\u5c31\u4f1a\u6210\u4e3a\u6f0f\u7f51\u4e4b\u9c7c Redis \u6dd8\u6c70\u7b56\u7565, \u5f53\u5185\u5b58\u6ee1\u4e86\u4e4b\u540e\u554a,\u4f1a\u4f18\u5148\u9009\u62e9\u4e00\u4e9b\u8fd9\u4e2a\u8fc7\u671f\u7684key, \u8bbf\u95ee\u91cf\u4f4e\u7684key\u8fdb\u884c\u5220\u9664. \u8fd9\u6837\u7684\u8bdd\u5462\u5c31\u5835\u4f4f\u4e86\u6240\u6709\u7684\u6f0f\u7f51\u4e4b\u9c7c</p> </li> </ul> <p>\u6240\u6709\u7684\u8fc7\u671fkey, \u4e00\u90e8\u5206\u88ab\u8fc7\u671f\u7b56\u8def\u7ed9\u5220\u9664\u6389\uff0c \u4e00\u90e8\u5206\u53c8\u88ab\u6dd8\u6c70\u7b56\u8def\u7ed9\u5220\u9664\u6389\u4e86\u3002 \u5c31\u80fd\u4fdd\u8bc1redis\u6709\u8db3\u591f\u7684\u7a7a\u95f4\uff0c\u6765\u5b58\u50a8\u65b0\u7684\u6570\u636e</p>"},{"location":"chap7/int_anws/#11-redis","title":"11 redis\u7f13\u5b58\u6dd8\u6c70\u7b56\u7565","text":"<p>\u5f53\u8fd9\u4e2aredis\u7684\u5185\u5b58\u6ee1\u4e86\uff0c \u8fd6\u5230\u4e86\u6700\u5927\u7684\u5185\u5b58\u7684\u65f6\u5019\uff0c\u90a3\u4e48redis\u5c31\u5fc5\u987b\u8fdb\u884c\u7f13\u5b58\u7684\u6dd8\u6c70\uff0c\u5426\u5219\u5c06\u4f1a\u4e25\u91cd\u7684\u5f71\u54cdredis\u7684\u8fd0\u884c\u3002\u4e5f\u65e0\u6cd5\u5199\u5165\u65b0\u7684\u6570\u636e\uff0c\u8bf7\u6c42\u91cf\u591a\u4e86\u5e76\u53d1\u5927\u4e86\u3002 \u5185\u5b58\u4e0d\u8db3\u7684\u8282\u70b9\uff0c \u8fd0\u884c\u6709\u53ef\u80fd\u4f1a\u4e25\u91cd\u7684\u7f13\u6162\uff0c \u751a\u81f3\u4f1a\u5f15\u8d77\u8282\u70b9\u7684\u5b95\u673a\uff0c</p> <p>Redis \u662f\u63d0\u4f9b\u4e86\u5f88\u591a\u7684\u8fd9\u4e2a\u7f13\u5b58\u6dd8\u6c70\u7b56\u7565, \u4ece\u6240\u6709\u7684\u952e\u503c\u5bf9\u4e2d\u53ef\u4ee5\u9009\u62e9, \u53ef\u4ee5\u9009\u62e9key\u8fdb\u884c\u5220\u9664. </p> <ul> <li>lru\u6dd8\u6c70\u7b56\u7565(least recently used) \u8fdb\u884c\u6dd8\u6c70\uff0c\u5224\u65ad\u6700\u8fd1\u88ab\u8bbf\u95ee\u7684\u8fd9\u4e2a\u65f6\u95f4\u3002 \u5982\u679c\u8ddd\u79bb\u76ee\u524d\u6700\u8fdc\uff0c\u8fd9\u4e2a\u6570\u636e\u4f1a\u4f18\u5148\u88ab\u6dd8\u6c70</li> <li>Ifu\u7b97\u6cd5\u6dd8\u6c70\u7b56\u7565\uff08least frequently used\uff09\uff0c\u6311\u9009\u6700\u5c11\u7ecf\u5e38\u4f7f\u7528\u7684\u6570\u636e\u8fdb\u884c\u6dd8\u6c70\u3002 <ul> <li>\u4e5f\u5c31\u662f\u6311\u9009\u51fa\u6700\u8fd1\u4f7f\u7528\u6b21\u6570\u6700\u5c11\u7684key\uff0c \u8fdb\u884c\u6570\u636e\u7684\u5220\u9664</li> </ul> </li> </ul> <p>\u6765\u9009\u62e9\u4e0d\u540c\u7684\u7b56\u8def\u53bb\u6dd8\u6c70\u6570\u636e\uff0c \u5f53\u7f13\u5b58\u6570\u636e\u6ca1\u6709\u660e\u663e\u7684\u51b7\u70ed\u4e4b\u5206\u7684\u65f6\u5019\uff0c \u4e5f\u5c31\u662f\u6570\u636e\u7684\u8bbf\u95ee\u9891\u7387\u5dee\u8ddd\u4e0d\u5927\uff0c \u5efa\u8bae\u8fd9\u4e2a\u968f\u673a\u7b56\u8def\uff0c\u8fdb\u884c\u6dd8\u6c70\u6570\u636e</p> <p>\u5f53\u6570\u636e\u6709\u660e\u663e\u7684\u51b7\u70ed\u4e4b\u5206\uff0c \u6bd4\u5982\u793e\u4ea4\u5e73\u53f0\uff0c \u4e5f\u5c31\u662fIru\u7b97\u6cd5\u6765\u6dd8\u6c70\u7f13\u5b58\uff0c\u5c06\u6700\u8fd1\u6700\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u7559\u5728\u7f13\u5b58\u4e2d\uff0c \u628a\u51b7\u6570\u636e\u8fdb\u884c\u6dd8\u6c70</p> <p>\u4e0d\u7ba1\u7528\u4ec0\u4e48\u6837\u7684\u6dd8\u6c70\u7b56\u7565\uff0c \u603b\u5f52\u662f\u6709\u4e00\u4e9b\u91cd\u8981\u7684\u6570\u636e\u3002 \u4f1a\u88ab\u7f13\u5b58\u6dd8\u6c70\u7b56\u7565\u8bef\u6740\u6389\uff0c \u5c31\u9700\u8981\u5728\u4ee3\u7801\u7684\u4e1a\u52a1\u5c42\uff0c \u6765\u505a\u597d\u5224\u5b9a\uff0c\u53ef\u4ee5\u901a\u8fc7\u8ba2\u9605redlis\u7684\u56de\u6536\u4e8b\u4ef6\uff0c \u53bb\u6355\u6349\u88ab\u6dd8\u6c70\u56de\u6536\u7684key\u7684\u4fe1\u606f\u3002 </p> <p>\u5982\u679ckey\u975e\u5e38\u91cd\u8981,  \u90a3\u4e48\u5c5e\u4e8e\u7684\u91cd\u8981\u6570\u636e, \u90a3\u4e48\u5c31\u4e0d\u8fdb\u884c\u7f13\u5b58\u7684\u6dd8\u6c70. \u867d\u7136\u4f7f\u7528\u8ba2\u9605redis\u6dd8\u6c70\u4e8b\u4ef6, \u4f1a\u6709\u4e00\u5b9a\u7684\u8fd9\u4e2a\u6027\u80fd\u635f\u8017\uff0c \u5374\u80fd\u591f\u907f\u514d\u4e00\u4e9b\u91cd\u8981\u7684\u7f13\u5b58\u6570\u636e\u3002 </p> <p>\u88ab\u5220\u6389\u6240\u4ee5\u5f88\u591a\u573a\u5408\u4e0b\u8fd8\u662f\u6709\u4e00\u4e9b\u975e\u5e38\u91cd\u8981\u7684\u6570\u636e\uff0c\u53bb\u505a\u8fd9\u4e2a\u7279\u6b8a\u4fdd\u62a4\u7684 \u3002\u6bd4\u5982\u8fd9\u4e2a\u4e1a\u52a1\u6570\u636e\u91cc\u9762\uff0c\u6bd4\u5982\u8bf4\u6709\u70b9\u8d5e\u6570\u636e\uff0c \u6d4f\u89c8\u91cf\u6570\u636e\u3002 \u867d\u7136\u6570\u636e\u4e0d\u662f\u7279\u522b\u91cd\u8981\uff0c\u4f46\u662f\u8fd8\u662f\u9700\u8981\uff0c\u8fd9\u4e2a\u6570\u636e\u5e93\u91cc\u9762\u53bb\u505a\u6301\u4e45\u5316\u7684\u5b58\u50a8\u7684\u5c31\u9700\u8981\u4e1a\u52a1\u5c42\u6765\u5199\u4ee3\u7801\u8fdb\u884c\u5e72\u9884</p>"},{"location":"chap7/int_anws/#12-redis","title":"12 redis \u5728\u793e\u4ea4\u5e73\u53f0\u4e0b\u7684\u5e94\u7528","text":"<p>\u53ef\u4ee5\u7528\u8fd9\u4e2aredis\u6765\u7f13\u5b58\u6570\u636e\uff0c \u90a3\u4e48\u9891\u7e41\u7684\u6570\u636e\u8bbf\u95ee\uff0c \u50cf\u4e2a\u4eba\u4fe1\u606f\u57fa\u672c\u7684\u6570\u636e\uff0c \u5c31\u53ef\u4ee5\u7f13\u5b58\u5728Redis\u4e2d\u3002</p> <p>\u90a3\u4e48\u8fd8\u6709\u4e00\u4e9b\u63a8\u8350\u7684feed\u6d41\uff0c\u6bd4\u5982\u597d\u53cb\u63a8\u8350\u3002 \u8fd9\u4e9b\u5e26\u6709\u4e2a\u6027\u5316\u7684\u63a8\u8350\u7684\u6570\u636e\uff0c\u53eb\u505a\u7a7a\u95f4\u6362\u65f6\u95f4\uff0c </p> <p>\u5728redis\u4e2d\u4e5f\u540c\u6837\u9002\u7528\u5c31\u662f\u6570\u636e\u7ed3\u6784\u65b9\u9762\u7684\u5e94\u7528\uff0c \u6bd4\u5982\u8bf4\u6211\u4eec\u5229\u7528zset\uff0c\u8f83\u5e38\u7528\u7684\u6570\u636e\u7ed3\u6784\u3002 \u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u6392\u5e8f\u3002\u53ef\u4ee5\u7528\u5b83\u6765\u505a\u8fd9\u4e2a\u4eba\u6c14\u6392\u884c\u699c\uff0c \u6839\u636e\u5b83\u7684\u8bbf\u95ee\u91cf\uff0c\u53ef\u4ee5\u76f4\u63a5\u505a\u4e2a\u6392\u5e8f\u3002\u6bd4\u8d77\u6211\u4eec\u4f20\u7edf\u7684\u5b58\u50a8\uff0c\u6b64\u5982\u8bf4mysql\u5148\u53bb\u6392\u5e8f\u518d\u53bb\u83b7\u53d6\uff0c\u5728\u67e5\u8be2\u4e0a\u7684\u6548\u7387\u4e5f\u66f4\u52a0\u7684\u9ad8\u6548\u3002</p> <p>\u53ef\u4ee5\u7528\u6765\u505a\u8fd9\u4e2a\u8ba1\u6570\u5668\uff0c\u6bd4\u5982\u50cf\u4e2a\u4eba\u4e3b\u9875\u6d4f\u89c8\u91cf\uff0c\u6d4f\u89c8\u6570\u4e00\u822c\u662f\u8981\u6c42\u5b9e\u65f6\u3002 redis\u7684\u5929\u7136\u662f\u652f\u6301\u8fd9\u4e2a\u57fa\u7840\u529f\u80fd</p> <p>\u90a3\u4e48\u7b2c4\u4e2a\u5e94\u7528\u53ef\u4ee5\u7528\u6765\u505a\u4e3b\u5e93\uff0c\u6bd4\u5982\u8bf4\u7528\u6237\u4e3b\u9875\u7684\u70b9\u8d5e\uff0c\u4f1a\u6d89\u53ca\u5230\u9891\u7e41\u7684\u8bfb\u5199\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u628a\u8fd9\u90e8\u5206\u6570\u636e\uff0c\u653e\u5728\u7f13\u5b58\u4e2d\u3002\u7136\u540e\u5728\u6570\u636e\u5e93\u4e0d\u5fd9\u7684\u65f6\u5019\uff0c \u901a\u8fc7\u5f02\u6b65\u7684\u65b9\u5f0f\uff0c \u518d\u628a\u8fd9\u4e2a\u6570\u636e\u5462\u5237\u5230\u6570\u636e\u5e93\u4e2d\u3002 \u80fd\u591f\u5927\u5927\u7684\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u6027\u80fd\uff0c \u8bfb\u591a\u5199\u591a\u7684\u8fd9\u6837\u7684\u4e00\u4e2a\u5e94\u7528\u573a\u666f</p>"},{"location":"chap7/int_anws/#13-redis","title":"13 redis\u6302\u4e86 \u7cfb\u7edf\u5982\u4f55\u8865\u6551","text":"<p>\u8c08\u8c08redis\u7684\u9ad8\u53ef\u7528</p> <p>\u600e\u4e48\u5b9e\u73b0relis\u7684\u9ad8\u53ef\u7528, \u4f46\u662f\u5728\u5927\u7684\u6d41\u91cf\u4e0b\u9762\u7684\u5e76\u53d1\uff0c \u6bd4\u5982\u8bf4\u673a\u5668\u6545\u969c\uff0c\u6bd4\u5982\u8bf4\u77ed\u65f6\u95f4\u5185\u8bbf\u95ee\u66b4\u589e\uff0c\u6765\u4e0d\u53ca\u54cd\u5e94\u3002\u6216\u8005\u662f\u585e\u5165\u7684key\u503c\u592a\u591a, \u5185\u5b58\u8fc7\u5927\u6765\u4e0d\u53ca\u56de\u6536,\u90fd\u4f1a\u5bfc\u81f4, redis\u53d1\u751f\u6545\u969c\u751a\u81f3\u5b95\u673a,\u505a\u597dredis\u7684\u9ad8\u53ef\u7528\u914d\u7f6e, redis\u5e38\u89c1\u67093\u4e2a\u9ad8\u53ef\u7528\u7684\u6a21\u5f0f</p> <ul> <li>\u7b2c\u4e00\u4e2a \u4e3b\u4ece\u6a21\u5f0f</li> </ul> <p>\u4e00\u4e3b\u4e00\u4ece\u6216\u8005\u4e00\u4e3b\u591a\u4ece\uff0c \u8ddf\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u9ad8\u53ef\u7528\u7c7b\u4f3c\uff0c\u591a\u4e2a\u8282\u70b9\u3002\u901a\u8fc7aof\u547d\u4ee4\u6765\u4fdd\u6301\u6570\u636e\u7684\u540c\u6b65\u3002 \u90a3\u4e48\u6709\u4e86\u591a\u8282\u70b9\uff0c \u5c31\u5927\u5927\u7684\u5206\u644a\u4e86\u8fd9\u4e2aredis\u7684\u8bbf\u95ee\u5e95\u529b.</p> <p>\u4e5f\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u573a\u666f, \u6765\u505a\u8bfb\u5199\u5206\u79bb, \u90a3\u4e48\u4e3b\u8282\u70b9\u7528\u6765\u5199, \u4ece\u8282\u70b9\u7528\u6765\u8bfb,\u5c31\u662f\u4e00\u65e6\u4e3b\u8282\u70b9\u6302\u4e86, \u5c31\u9700\u8981\u624b\u52a8\u53bb\u6307\u5b9a\u8fd9\u4e2a\u4e3b\u8282\u70b9, \u4e00\u822c\u5f88\u5c11\u7528\u8fd9\u79cd\u6a21\u5f0f. </p> <p>\u54e8\u5175\u6a21\u5f0f, \u4e00\u65e6\u4e3b\u8282\u70b9\u6302\uff0c\u53ef\u4ee5\u91cd\u65b0\u53bb\u9009\u62e9\u65b0\u7684\u4e3b\u8282\u70b9\uff0c\u6765\u4fdd\u969c\u7684\u4e1a\u52a1\u4e0d\u95f4\u65ad\uff0c\u5176\u5b9e\u662f\u4e3b\u4ece\u6a21\u5f0f\u7684\u5347\u7ea7\u7248\u3002\u52a0\u4e86\u8fd9\u4e2a\u5fc3\u8df3\u76d1\u6d4b\u5207\u6362\u7684\u529f\u80fd\u3002\u5c31\u53ef\u4ee5\u5927\u5927\u7684\u63d0\u9ad8\u4e86redis\u7684\u53ef\u7528</p> <p>\u54e8\u5175\u6a21\u5f0f\u5462\u4e5f\u6709\u4e00\u4e9b\u7f3a\u70b9\uff0c\u6b64\u5982\u8bf4\u8fd9\u4e2a\u4e3b\u8282\u70b9\u8ddf\u4ece\u8282\u70b9\u7684\u6570\u636e\u662f\u4e00\u6837\u7684\uff0c\u6d6a\u8d39\u6211\u4eec\u5b9d\u8d35\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u800c\u4e14\u4e00\u822c\u90fd\u662f\u4e3b\u8282\u70b9\u5728\u5199\u3002 \u5c31\u5bb9\u6613\u53d7\u5230\u5355\u8282\u70b9\u673a\u5668\u7684\u9650\u5236\uff0c\u6bd5\u7adf\u5355\u673a\u7684\u8fd9\u4e2a\u5185\u5b58\u662f\u6709\u9650\u7684\uff0c\u5f88\u5bb9\u6613\u9047\u5230\u5e76\u53d1\u8bbf\u95ee\u7684\u6027\u80fd\u74f6\u9888</p> <p>Redis 3.0\u4ee5\u540e\uff0c\u5c31\u6709\u4e86\u8fd9\u4e2acluster\u96c6\u7fa4\u6a21\u5f0f\uff0c\u591a\u4e3b\u591a\u4ece\uff0c\u5c06\u6570\u636e\u8fdb\u884c\u5206\u5e03\u5f0f\u7684\u5b58\u50a8\uff0c\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u7247\uff0c\u90a3\u4e48\u6bcf\u53f0redis\u8282\u70b9\u4e0a\u9762\uff0c \u5b58\u50a8\u4e0d\u540c\u7684\u5185\u5bb9\uff0c\u4e0d\u7ba1\u662f\u6570\u636e\u5b58\u50a8\u4e5f\u597d\u8bbf\u95ee\u4e5f\u59a4\uff0c \u90fd\u8fdb\u884c\u4e86\u538b\u529b\u7684\u5206\u644a\uff0c \u800c\u4e14Cluster\u7684\u6a21\u5f0f\uff0c \u6269\u5bb9\u4e5f\u975e\u5e38\u65b9\u4fbf\uff0c\u652f\u6301\u52a8\u6001\u6269\u5c55</p> <p>\u90a3\u4e48\u4e00\u65e6\u53d1\u73b0\u538b\u529b\u8fc7\u5927\uff0c \u53ef\u4ee5\u968f\u65f6\u589e\u52a0\u8282\u70b9\uff0ccluster\u7684\u6a21\u5f0f\uff0c\u5c31\u662f\u4e3a\u4e86\u8fd9\u4e2a\u6d77\u91cf\u6570\u636e\u7684\u5b58\u50a8\u9ad8\u5e76\u53d1\u9ad8\u53ef\u7528\u7684\u573a\u666f\u800c\u751f\u7684</p>"},{"location":"chap7/int_anws/#14-redis","title":"14 redis\u5230\u5e95\u662f\u5355\u7ebf\u7a0b\u8fd8\u662f\u591a\u7ebf\u7a0b\uff1f","text":"<p>redis6.0\u591a\u7ebf\u7a0b,\u662f\u9488\u5bf9\u7684\u5904\u7406\u7f51\u7edc\u8bf7\u6c42\u8fc7\u7a0b\u4e2d\u91c7\u7528\u4e86\u591a\u7ebf\u7a0b\u3002\u800c\u6570\u636e\u7684\u8bfb\u5199\u547d\u4ee4\uff0c\u591a\u7ebf\u7a0b\u53ea\u662f\u5728\u5904\u7406\u547d\u4ee4\u63a5\u6536\u548c\u7ed3\u679c\u7684\u53d1\u9001\u4e0a\u9762\uff0c\u4f46\u662f\u547d\u547d\u7684\u6267\u884c\uff0c\u8bfb\u6570\u636e/\u5199\u6570\u636e\u8fd8\u662f\u5355\u7ebf\u7a0b\u3002\u5c31\u662f\u80fd\u591f\u5927\u5927\u7684\u63d0\u5347io\u7684\u6027\u80fd\uff0c</p> <p>redis\u7684\u74f6\u9888\u4e0d\u5728CPU\uff0c \u800c\u5728\u4e8e\u5185\u5b58\u548c\u7f51\u7edc\uff0c\u5185\u5b58\u7684\u95ee\u9898\u52a0\u5185\u5b58\u5c31\u53ef\u4ee5\u641e\u5b9a\u3002 </p> <p>\u7f51\u7edcIO\u5c31\u4e0d\u4e00\u6837, redis\u5927\u90e8\u5206\u7684\u65f6\u95f4\u90fd\u82b1\u5728\u8fd9\u4e2a\u7f51\u7edc\u7684IO\u4e0a\u9762,\u901a\u8fc7\u591a\u7ebf\u7a0b\u7684\u65b9\u5f0f\u6765\u5904\u7406\u7f51\u7edcIO\u3002 </p> <p>\u5927\u5927\u7684\u63d0\u5347\u4e86\u7cfb\u7edf\u7684\u5e76\u53d1\u6570\uff0c\u6709\u4e86\u591a\u7ebf\u7a0b\uff0c\u4e5f\u4f1a\u8003\u8651\u5230\u6570\u636e\u7684\u5e76\u53d1\u5b89\u5168\uff0c\u4f9d\u7136\u4fdd\u7559\u4e86\u5bf9\u6267\u884c\u547d\u5206\u7684\u5355\u7ebf\u7a0b\uff0c\u4e0d\u50cf\u591a\u7ebf\u7a0b\uff0c\u9700\u8981\u53bb\u9891\u7e41\u7684\u521b\u5efa\u9500\u6bc1\u7ebf\u7a0b\uff0c\u907f\u514d\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u6ca1\u6709\u8fd9\u4e2a\u5e76\u53d1\u8d44\u6e90\u7ade\u4e89\u7684\u95ee\u9898\u3002\u901f\u5ea6\u4e0a\u9762\u4e5f\u6709\u4e86\u4fdd\u8bc1\uff0c\u5bf9\u4e8e\u8fd9\u4e2a6.0\u4ee5\u540e\uff0c\u9700\u8981\u5206\u573a\u666f\u6765\u8bf4\uff0c\u65e2\u6709\u4e86\u591a\u7ebf\u7a0b\u4e5f\u6709\u4e86\u5355\u7ebf\u7a0b\u554a</p>"},{"location":"chap7/int_anws/#15","title":"15 \u600e\u4e48\u4fdd\u8bc1 \u6570\u636e\u5e93\uff0e\u7f13\u5b58\u7684\u53cc\u5199\u4e00\u81f4\u6027","text":"<p>\u6570\u636e\u5e93\u5728\u5199\uff0c\u7f13\u5b58\u4e5f\u5728\u5199, \u4e24\u4e2a\u5b58\u50a8\u5355\u5143\uff0c \u5c31\u4e00\u5b9a\u4f1a\u6709\u6570\u636e\u4e00\u81f4\u6027\u7684\u95ee\u9898\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662f\u8bfb\u5230\u8001\u6570\u636e\u3002 </p> <p>\u5bf9\u4e8e\u4e00\u4e9b\u6bd4\u8f83\u91cd\u8981\u7684\u6570\u636e\uff0c\u6b64\u5982\u8bf4\u50cf\u4ea4\u6613\u7cfb\u7edf\u91cc\u7684\u8fd9\u4e2a\u5e93\u5b58\u91cf\uff0c\u5c31\u8981\u7279\u522b\u6ce8\u610f\u6570\u636e\u7684\u4e00\u81f4\u6027\u95ee\u9898\u3002</p>"},{"location":"chap7/int_anws/#1_1","title":"1 \u52a0\u9501","text":"<p>\u53ef\u4ee5\u4fdd\u8bc1\u8857\u66f4\u65b0\u6570\u636e\u5e93\u3001\u7f13\u5b58\u7684\u65f6\u5019\uff0c \u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u64cd\u4f5c\u3002 \u8fd9\u79cd\u5c31\u662f\u5f3a\u4e00\u81f4\u6027\u4e86\uff0c \u4e5f\u4e0d\u4f1a\u5b58\u5728\u4e0d\u4e00\u81f4\u7684\u95ee\u9898</p> <p>\u52a0\u9501\u4e5f\u662f\u6709\u7f3a\u70b9\u7684,  \u6027\u80fd\u4e0a\u9762\u5c31\u4f1a\u5927\u6253\u6298\u6263\uff0c\u4e0d\u592a\u9002\u5408\u5e76\u53d1\u91cf\u6b64\u8f83\u5927\u7684\u573a\u666f</p> <p>\u5927\u90e8\u5206\u573a\u666f\u8981\u4fdd\u8bc1\u6027\u80fd\uff0c\u4e5f\u5177\u80fd\u591f\u4fdd\u8bc1\u6700\u7ec8\u7684\u4e00\u81f4\u6027\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684cap\u7406\u8bba\u3002\u53ef\u7528\u6027\uff0c \u4e00\u81f4\u6027\uff0c\u5bb9\u9519\u6027\u5177\u80fd\u540c\u65f6\u4fdd\u8bc1\u4e24\u4e2a\uff0c\u65e0\u6cd5\u540c\u65f6\u6ee1\u8db33\u4e2a\u6761\u4ef6\uff0c\u6027\u80fd\u4e4b\u4e0b\u8981\u4fdd\u6301\u4e00\u81f4\u6027\u3002</p>"},{"location":"chap7/int_anws/#2_1","title":"2 \u5e38\u89c1\u7684\u89e3\u6c7a\u65b9\u6848\u5c31\u662f\uff0c\u5ef6\u8fdf\u53cc\u5220","text":"<p>\u5148\u5220\u7f13\u5b58\u518d\u66f4\u65b0\u6570\u636e\u5e93\uff0c \u7136\u540e\u5ef6\u9000\u51e0\u79d2\u949f\u518d\u5220\u4e00\u6b21\u7f13\u5b58\uff0c\u5ef6\u8fdf\u65f6\u95f4\u5462\u5c31\u662f\u8bfb\u4e1a\u52a1\u903b\u8f91\u6570\u636e\u8017\u65f6, \u52a0\u4e0a\u51e0\u767e\u6beb\u79d2\u7684\u968f\u673a\u6570\uff0c\u4e3b\u8981\u7684\u76ee\u7684\uff0c \u4e3a\u4e86\u786e\u4fdd\u8bfb\u8bf7\u6c42\u7ed3\u675f\u3002 </p> <p>\u5199\u8bf7\u6c42\u53ef\u4ee5\u5220\u9664\uff0c\u8bfb\u8bf7\u6c42\u53ef\u80fd\u5e26\u6765\u7684\u8fd9\u4e2a\u7f13\u5b58\u810f\u6570\u636e\uff0c\u8fd9\u79cd\u65b9\u6848\u5462\u8fd8\u7b97\u53ef\u4ee5\u3002\u4f11\u7720\u53ef\u80fd\u4f1a\u6709\u810f\u6570\u636e\uff0c\u4e00\u822c\u7684\u4e1a\u52a1\u90fd\u80fd\u591f\u63a5\u53d7\u3002</p> <p>\u5c5e\u4e8e\u5927\u5e76\u53d1\u4e0b\u9ad8\u6027\u80fd\u4e0b\uff0c\u5f53\u7136\u4e5f\u4e0d\u662f\u5b8c\u5168\u6ca1\u6709\u95ee\u9898\u3002</p> <p>\u6700\u5e38\u89c1\u7684\u5c31\u662f\u64cd\u4f5c\u6570\u636e\u5e93\u6216\u8005\u64cd\u4f5c\u7f13\u5b58\u5931\u8d25\u4e86\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e5f\u662f\u53ef\u80fd\u5b58\u5728\u7684\uff0c\u5bf9\u4e4e\u66f4\u65b0\u6570\u636e\u5e93\u5931\u8d25\u4e86\u3002\u5176\u5b9e\u6ca1\u6709\u592a\u5927\u5173\u7cfb\uff0c\u56e0\u4e3a\u6b64\u65f6\u7684\u6570\u636e\u5e93\u548c\u7f13\u5b58\u4e2d\u7684\uff0c\u8fd8\u90fd\u662f\u8001\u6570\u636e\uff0c\u4e0d\u5b58\u5728\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\u3002</p> <p>\u5047\u5982\u5220\u9664\u7f13\u5b58\u5931\u8d25\u90a3\u4e48\u95ee\u9898\u5c31\u5927\u4e86\uff0c\u8fd9\u6bb5\u65f6\u95f4\u8bfb\u7684\u7f13\u5b58\u90fd\u662f\u8001\u6570\u636e\u3002\u53ef\u4ee5\u8bbe\u7f6e\u7f13\u5b58\u8fc7\u671f\u65f6\u95f4\uff0c\u4f5c\u4e3a\u8fd9\u4e2a\u515c\u5e95\u7684\u65b9\u6848\u3002 \u4f46\u662f\u5462\u53ca\u65f6\u6027\u4e0d\u9ad8, \u5c31\u5fc5\u987b\u8003\u8651\u5bf9\u5220\u9664\u64cd\u4f5c\u8fdb\u884c\u91cd\u8bd5.   \u91cd\u8bd5\u673a\u5236\u6709\u5f88\u591a, \u53ef\u4ee5\u56f4\u6d88\u606f\u961f\u5217\u554a\u5b8c\u6b65\u5904\u7406\u5220\u9664,\u672c\u8eab\u4e5f\u5e26\u6709\u8fd9\u4e2a\u91cd\u8bd5\u673a\u5236. \u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u6570\u636e\u5e93\u7684binllog\u3002 </p> <p>\u53ea\u8981\u76d1\u6d4b\u5230\u6570\u636e\u5e93\u7684\u66f4\u65b0\uff0c\u90a3\u4e48\u5c31\u6267\u884c\u5220\u9664\u7f13\u5b58\u7684\u64cd\u4f5c\uff0c\u5220\u9664\u5931\u8d25\u5c31\u8bb0\u5f55\u4e0b\u6765\u7b49\u5f85\u91cd\u8bd5\u3002 </p> <ul> <li>\u5982\u679c\u5e76\u53d1\u91cf\u4e0d\u5927\uff0c \u76f4\u63a5\u7528\u9501\u554a\u4fdd\u6301\u5f3a\u4e00\u81f4\u6027\u5c31\u53ef\u4ee5\u4e86</li> <li>\u4f46\u662f\u5982\u679c\u5e76\u53d1\u91cf\u5f88\u5927\uff0c\u5efa\u8bae\u7f13\u5b58\u5ef6\u8fdf\u53cc\u5220\u7684\u7b56\u7565\uff0c \u6765\u4fdd\u8bc1\u6700\u7ec8\u7684\u4e00\u81f4\u6027</li> </ul>"},{"location":"chap7/int_anws/#16-redis","title":"16 redis\u5728\u96c6\u7fa4\u4e0b\u91cd\u8981\u5e94\u7528\u5206\u5e03\u5f0f\u9501","text":"<p>redis\u4fdd\u8bc1\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b, \u5728\u4fee\u6539\u5e93\u5b58\u6570\u636e. \u5426\u5219\u6570\u636e\u5e93\u5c31\u6539\u4e71\u4e86\u3002 \u4f20\u7edf\u7684\u5355\u4f53\u67b6\u6784\uff0c\u4e00\u53f0\u670d\u52a1\u5668\u4e00\u4e2aJVM\uff0c\u53ef\u4ee5\u7528jvm\u91cc\u9762\u7684\u4e00\u4e2a\u5185\u90e8\u9501\uff0c \u4f8b\u5982synchrionized, lock \u5c31\u53ef\u4ee5\u641e\u5b9a\u3002\u800c\u5bf9\u4e8e\u591a\u53f0\u670d\u52a1\u5668\u90a3\u4e48\u5206\u5e03\u5f0f\u67b6\u6784\u96c6\u7fa4\u67b6\u6784,Jvm\u9501. \u662f\u4fdd\u8bc1\u4e0d\u4e86\u6570\u636e\u7684\u8fd9\u4e2a\u6b63\u5e38\u6263\u51cf\u7684</p> <p>\u8fd9\u65f6\u5019\u5462\u5c31\u9700\u8981\u5f15\u5165\u5206\u5e03\u5f0f\u9501\uff0c\u5206\u5e03\u5f0f\u9501\u6709\u5f88\u591a\u3002\u5178\u578b\u57fa\u4e8e\u8fd9\u4e2a\u6570\u636e\u5e93\uff0c \u57fa\u4e8ezookeeper.  \u57fa\u4e8eredis, \u8fd8\u662f\u4f1a\u9009\u62e9redis\u6765\u4f5c\u4e3a\u4e00\u4e2a\u5206\u5e03\u5f0f\u9501\uff0c<code>setnx key valuext</code> , \u4e0d\u8981\u5fd8\u8bb0\u4e86\u52a0\u8fd9\u4e2a\u8fc7\u671f\u65f6\u95f4, </p> <p>\u6bd4\u5982\u8bf4\u50cf\u4e1a\u52a1\u7684bug. \u4f1a\u5bfc\u81f4\u8fd9\u4e2a\u89e3\u9501\u5931\u8d25. \u6240\u6709\u9700\u8981\u52a0\u9501\u7684\u7ebf\u7a0b , \u4f1a\u5168\u90e8\u963b\u585e, \u5e38\u8bf4\u7684\u6b7b\u9501,\u4e3a\u4e86\u9632\u6b62\u8fd9\u4e2a\u6b7b\u9501. \u52a0\u8fc7\u671f\u65f6\u95f4, </p> <p>\u4e00\u4e2a\u65b0\u7684\u95ee\u9898, \u4e07\u4e00\u8fd9\u4e2a\u65f6\u95f4\u5230\u4e86\u3002\u4e1a\u52a1\u903b\u8f91\u8fd8\u6ca1\u5904\u7406\u5b8c\u600e\u4e48\u529e\uff0c\u7528\u4e00\u4e2a\u5b88\u62a4\u7ebf\u7a0b\u53bb\u7eed\u547d\uff08watch dog)\u3002  \u6211\u4eec\u9700\u8981\u989d\u5916\u7684\u8d77\u4e00\u4e2a\u7ebf\u7a0b, \u53bb\u5b9a\u671f\u68c0\u67e5,\u5982\u679c\u8fd8\u6ca1\u6709\u5904\u7406\u5b8c, key\u7684\u8fd9\u4e2a\u8fc7\u671f\u65f6\u95f4\u505a\u4e00\u4e2a\u5ef6\u957f.</p> <p>\u5982\u679c\u60f3\u8d70\u6377\u5f84, \u53ef\u4ee5\u53bb\u96c6\u6210\u3002 \u4e00\u4e9b\u5206\u5e03\u5f0f\u9501\u7684\u8fd9\u4e2a\u7ec4\u4ef6redisson. \u4e5f\u662f\u57fa\u4e8eredis\u7684\u4e00\u4e2a\u5206\u5e03\u5f0f\u9501</p>"},{"location":"chap7/int_anws/#17-redis","title":"17 redis\u4e8b\u52a1","text":"<p>\u90a3\u4e48redis\u6240\u8bf4\u7684\u8fd9\u4e2a\u4e8b\u52a1\uff0c\u4e00\u7cfb\u5217\u547d\u5206\u7684\u96c6\u5408\u653e\u5728\u4e00\u8d77\u3002\u7136\u540e\u8fdb\u884c\u5e8f\u5217\u5316\u6309\u7167\u96c6\u5408\u4e2d\u7684\u547d\u4ee4\u7684\u987a\u5e8f\uff0c\u4e00\u4e2a\u4e00\u4e2a\u7684\u53bb\u6267\u884c\uff0c\u4e32\u884c\u5316\u3002\u5728\u547d\u4ee4\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u80fd\u53bb\u63d2\u5165\u7684\u53bb\u6267\u884c\uff0c\u662fredis\u6240\u8bf4\u7684\u4e8b\u52a1\u3002</p>"},{"location":"chap7/int_anws/#18-redis","title":"18 redis\u7684\u6570\u636e\u7ed3\u6784\u4ee5\u53ca\u5e94\u7528\u573a\u666f","text":"<p>string\u5e94\u7528\u573a\u666f</p> <p>\u7ed3\u6784\u7b80\u5355\uff0c <code>set key value</code>\uff0c\u7528\u6765\u5b58\u7b80\u5355\u7684\u5b57\u6bcd\u4e32\u3002\u53ef\u4ee5\u7528\u6765\u5b58json, XML, \u4e8c\u8fdb\u5236\u7684\u56fe\u7247, \u5b58\u50a8,\u4fdd\u5b58\u767b\u5f55\u7684token\u5bf9, spring oauth\u8fd9\u4e2a\u9274\u6743\u7ec4\u4ef6\uff0c string\u5b58\u50a8\u767b\u9646\u7684token. \u8fd8\u53ef\u4ee5\u7528string\u7c7b\u578b\u6765\u505a\u8ba1\u6570\u5668,</p> <p>\u5bf9\u8c61, \u793e\u4ea4\u7cfb\u7edf\u91cc\u7684\u8fd9\u4e2a\u7528\u6237\u4fe1\u606f. \u6709\u660e\u663e\u7684\u8fd9\u4e2a\u51b7\u70ed\u6570\u636e\u4e4b\u5206, \u53ef\u4ee5\u5c06\u8fd9\u4e2a\u5bf9\u8c61\u8f6c\u6210json\u5b57\u7b26\u4e32, \u90a3\u4e48\u8bbf\u95ee\u91cf\u8d8a\u9ad8\u7684\u6570\u636e. \u6709\u6548\u671f\u53ef\u4ee5\u8bbe\u7f6e\u7684\u76f8\u5e94\u7684\u957f\u4e00\u4e9b </p> <p>\u51b7\u6570\u636e\uff0c \u968f\u7740\u8fc7\u671f\u65f6\u95f4\u554a\uff0c\u5c31\u6162\u6162\u7684\u4ece\u8fd9\u4e2a\u7f13\u5b58\u4e2d\u6dd8\u6c70\u4e86\u3002\u9664\u4e86string\u7c7b\u578b\u5176\u4ed6\u7684\u90fd\u662f\u96c6\u5408\u4e86</p> <p>list</p> <p>\u5c31\u662f\u987a\u5e8f\uff0c\u4e00\u822c\u662f\u7528\u5b83\u6765\u505a\u6682\u5b58\uff0c\u6b64\u5982\u8bf4\u9891\u7e41\u64cd\u4f5c\u7684\u8fd9\u4e2a\u70b9\u8d5e\u3002 </p> <p>set\u96c6\u5408\u7684\u7279\u70b9\u5462\u5c31\u662f\u53bb\u91cd\u65e0\u5e8f\u5bf9\uff0c </p> <p>\u7edf\u8ba1\u5b58\u50a8\u7528\u6237\u7684ID\uff0cset\u8fd8\u63d0\u4f9b\u4e86\u6c42\u4ea4\u96c6\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u7528\u6765\u505a\u8fd9\u4e2a\u63a8\u8350\u554afeed\u6d41</p> <p>zset \u5c31\u662f\u52a0\u4e86\u8fd9\u4e2a\u6392\u5e8f </p> <p>\u5b83\u91cc\u9762\u6709\u4e00\u4e2adouble\u7c7b\u578b\u7684score\u53ef\u4ee5\u7528\u6765\u505a\u6392\u5e8f,\u5178\u578b\u7684\u5c31\u662f\u7528\u6765\u505a\u6392\u884c\u699c.\u6bd4\u5982\u8bf4\u70ed\u95e8\u7684\u8bfe\u7a0b\u6392\u884c. \u9605\u8bfb\u6392\u884c, \u70ed\u95e8\u7684\u8bdd\u9898\u6392\u884c, \u90fd\u53ef\u4ee5\u7528zset\u6765\u5904\u7406</p> <p>hash\u7c7b\u578b</p> <p>string\u7c7b\u578b\u7684key\u8ddfstring\u7c7b\u578b\u7684\u8fd9\u4e2avalue\u7ec4\u6210\u7684, \u6bd4\u8f83\u9002\u5408\u5bf9\u8c61\u5b58\u50a8, \u5c31\u662f\u7528\u6765\u5b58\u50a8\u8fd9\u4e2a\u5927\u5bb9\u91cf\u7684\u6570\u636e. \u5c31\u662fredis\u5728\u96c6\u5408\u91cc\u9762</p> <p>\u4e0d\u7ba1\u662fset\u8fd8\u662fzset, list \u8fd8\u662f hash, \u4e0d\u63d0\u4f9b\u8fc7\u671f\u65f6\u95f4\u7684\u8bbe\u7f6e, \u6240\u4ee5\u4f1a\u957f\u65f6\u95f4\u7684\u5b58\u50a8\u5728\u7f13\u5b58\u4e2d, \u6bd4\u8f83\u9002\u5408\u5b58\u50a8\u4e00\u4e9b\u8bbf\u95ee\u91cf\u5927, \u6bd4\u8f83\u56fa\u5316\u7684\u6570\u636e</p> <p>\u5982\u679c\u60f3\u6dfb\u52a0\u8fc7\u671f\u65f6\u95f4, \u9700\u8981\u81ea\u5df1\u53bb\u5b9e\u73b0. </p> <p>\u53e6\u5916\u4eceredis3.2\u5f00\u59cb, redis\u63d0\u4f9b\u4e86\u5730\u7406\u4f4d\u7f6e\u7684\u4fe1\u606f\u7684\u652f\u6301, \u5c31\u662f\u6dfb\u52a0\u4e86geo\u7684\u6570\u636e\u7c7b\u578b. \u53ef\u4ee5\u5c06\u4f4d\u7f6e\u4fe1\u606f, \u50cf\u8fd9\u4e2a\u7ef4\u5ea6, \u7ecf\u7eac\u5ea6\u6dfb\u52a0\u5230\u8fd9\u4e2akey\u4e2d\uff0c\u5f88\u5bb9\u6613\u5462\u8fdb\u884c\u8fd9\u4e2a\u5730\u7406\u4f4d\u7f6e\u7684\u68c0\u7d22\u3002 \u5185\u90e8\u91c7\u7528\u7684\u5c31\u662f\u6709\u5e8f\u96c6\u5408\u7684\u5b9e\u73b0\u3002\u90a3\u4e48\u9760\u7740\u8fd1\u7684\u5c31\u4f1a\u4f18\u5148\u63a8\u8350\uff0c\u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662f\u57fa\u4e8e\u5730\u7406\u4f4d\u7f6e\u7684\u641c\u7d22\uff0c\u6bd4\u5982\u8bf4\u9644\u8fd1\u7684\u4eba\uff0c\u9644\u8fd1\u7684\u5546\u5e97\uff0c\u52a0\u6cb9\u7ad9</p>"},{"location":"chap7/int_anws/#18-redis_1","title":"18 redis\u5206\u5e03\u5f0f\u9501\u5728\u4e3b\u4ece\u6a21\u5f0f\u4e0b\u7684\u5751","text":"<p>\u4e00\u822c\u505aredis\u9ad8\u53ef\u7528\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u7528redis cluster\u6a21\u5f0f\uff0c\u6bd4\u5982\u8bf4\u4e09\u4e3b\u4e09\u4ece\u3002</p> <p>\u4e3b\u5e93\u6309\u7167\u4e00\u5b9a\u7684\u903b\u8f91\u5b58\u50a8\u6570\u636e\uff0c\u65e2\u8d1f\u8d23\u8bfb\u4e5f\u8d1f\u8d23\u5199\uff0c\u4ece\u5e93\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u6253\u9171\u6cb9\u7684\u4e5f\u5c31\u540c\u6b65\u4e2a\u6570\u636e\uff0c\u5c31\u7b49\u4e3b\u5e93\u6302\u4e86\u6765\u505a\u66ff\u8865\uff0c\u8fd9\u79cdcluster\u7684\u4e3b\u4ece\u6a21\u5f0f\uff0c\u63d0\u5347\u4e86\u6574\u4f53\u7684\u6027\u80fd\u3002</p> <p>\u6570\u636e\u4e5f\u662f\u5206\u5e03\u5f0f\u5b58\u50a8\u7684\uff0c\u4e5f\u80fd\u591f\u7f13\u89e3\u8bbf\u95ee\u538b\u529b\u3002</p> <p>\u4f46\u662f\u63d0\u5347\u6027\u80fd\u7684\u540c\u65f6\uff0c\u4e5f\u5e26\u6765\u4e86\u4e00\u4e9b\u5176\u4ed6\u95ee\u9898\u3002 \u6bd4\u5982\u8bf4\u5bf9\u4e8eRedis\u7684\u5206\u5e03\u5f0f\u9501\uff0c\u5bf9\u4e8e<code>Redis cluster</code>\u6a21\u5f0f\u7684\u5206\u5e03\u5f0f\u9501\u3002</p> <p>\u5982\u679c\u60f3\u8981\u52a0\u9501,\u4e00\u822c\u90fd\u4f1a\u6839\u636e\u4e00\u5b9a\u7684\u8ba1\u7b97\u89c4\u5219\u627e\u5230\u4e00\u4e2amaster\u6765\u5199\u5165key, \u5728\u52a0\u9501\u6210\u529f\u4e4b\u540e, master\u8282\u70b9key\u5f02\u6b65\u590d\u5236\u7ed9\u5bf9\u5e94\u7684\u4ece\u8282\u70b9, \u4f46\u662f\u4e00\u65e6master\u8282\u70b9\u5f02\u5e38\u6545\u969c, \u5b95\u673a\uff0c\u4ece\u8282\u70b9\u590d\u5236\u5931\u8d25. \u90a3\u4e48\u4e3a\u4e86\u4fdd\u8bc1\u96c6\u7fa4\u7684\u53ef\u7528\u6027, \u5c31\u4f1a\u8fdb\u884c\u4e3b\u5907\u5207\u6362. Slave\u5c31\u4f1a\u53d8\u6210master\uff0c\u5982\u679c\u6709\u65b0\u7684\u7ebf\u7a0b\u8bbf\u95ee\u5c31\u4f1a\u628a\u9501\u52a0\u5230\u65b0\u7684\u8282\u70b9\u4e0a\u9762\uff0c </p> <p>\u8fd9\u6837\u4e00\u6765\u7cfb\u7edf\u91cc\u9762\u5c31\u4f1a\u51fa\u73b0\u4e24\u628a\u9501\uff0c\u540e\u679c\u53ef\u60f3\u800c\u77e5\uff0c\u5c31\u4f1a\u51fa\u73b0\u5404\u79cd\u810f\u6570\u636e\u3002</p> <p>\u76ee\u524d\u5462\u4e5f\u662f\u6709\u4e00\u4e9b\u89e3\u6c7a\u65b9\u6848\uff0c\u5e38\u89c1\u5c31\u662fredlock\u3002\u539f\u7406\u5c31\u662f\u9700\u8981\u90e8\u7f72\uff0credis\u7684\u5f88\u591a\u4e2a\u8282\u70b9\uff0c\u6bcf\u4e00\u4e2a\u8282\u70b9\u76f8\u5bf9\u72ec\u7acb\uff0c\u4e0d\u5b58\u5728\u4e3b\u4ece\u590d\u5236\u3002</p> <p>\u52a0\u9501\u7684\u65f6\u5019\uff0c\u5ba2\u6237\u7aef\u4f9d\u6b21\u5411\u8fd9\u51e0\u4e2aredis\u5b9e\u4f8b\u5462\u53d1\u8d77\u52a0\u9501\u8bf7\u6c42\uff0c\u53ef\u4ee5\u7528set\u547d\u4ee4\uff0c\u4e5f\u90fd\u4f1a\u8bbe\u7f6e\u4e00\u4e2a\u8d85\u65f6\u65f6\u95f4\u3002</p> <p>\u5982\u679c\u67d0\u4e00\u4e2a\u5b9e\u4f8b\u52a0\u901f\u5931\u8d25\uff0c\u6bd4\u5982\u8bf4\u7f51\u7edc\u8d85\u65f6\uff0c\u5c31\u4f1a\u7acb\u5373\u5411\u4e0b\u4e00\u4e2aredis\u5b9e\u4f8b\u7533\u8bf7\u52a0\u9501\u3002</p> <p>\u5982\u679c\u5ba2\u6237\u7aef\uff0c\u5927\u591a\u6570\u7684\u8fd9\u4e2a\u5b9e\u4f8b\u52a0\u9501\u6210\u529f\uff0c\u7ebf\u7a0b\u52a0\u9501\u6210\u529f\uff0c\u5426\u5219\u5c31\u4f1a\u8ba4\u4e3a\u52a0\u9501\u5931\u8d25\u3002 </p> <p>\u52a0\u9501\u6210\u529f\u5c31\u53ef\u4ee5\u64cd\u4f5c\u4e00\u4e9b\u5171\u4eab\u8d44\u6e90\uff0c\u6bd4\u5982\u8bf4MYSQL\u7684\u67d0\u4e00\u6761\u8bb0\u5f55\u3002 \u5982\u679c\u52a0\u9501\u5931\u8d25\u5c31\u53ef\u4ee5\u5411\u5168\u90e8\u8282\u70b9\u53d1\u8d77\u91ca\u653e\u9501\u7684\u8bf7\u6c42\u3002 </p> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2alua\u811a\u672c\uff0c \u6765\u91ca\u653e\u9501\u5b9e\u73b0\u8d77\u6765\u8fd8\u662f\u6bd4\u8f83\u590d\u6742\u7684\u3002\u8fd8\u662f\u4f7f\u7528\u8fd9\u4e2aRedison\u6765\u505a\u4e00\u4e9b\u5904\u7406\u3002</p> <p>\u5f53\u7136\u5982\u679c\u91cf\u4e0d\u662f\u5f88\u5927\uff0c\u5355\u673a\u7684\u8fd9\u4e2aredis\u5b9e\u4f8b\u5c31\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\u3002\u81ea\u7136\u5c31\u80fd\u591f\u907f\u5f00\u4e3b\u4ece\u6a21\u5f0f\u7684\u5751\uff0c\u5373\u4f7f\u4e0a\u4e86redis cluster\u6a21\u5f0f\uff0c redis\u6302\u4e86\u7684\u6982\u7387\u8fd8\u662f\u633a\u5c0f\u7684\uff0c \u5c3d\u91cf\u4fdd\u8bc1\u673a\u5668\u7684\u7a33\u5b9a\u6027\u5c31\u597d\u4e86\u3002 </p>"},{"location":"chap7/int_anws/#19-redis","title":"19 redis\u53ef\u4ee5\u505a\u4e3b\u5e93","text":"<p>\u6211\u4eec\u7684\u4e1a\u52a1\u6570\u636e\uff0c\u5148\u4e0d\u5f80\u5173\u7cfb\u578b\u6570\u636e\u5e93\u91cc\u9762\u53bb\u5199\uff0c\u800c\u662f\u5148\u628a\u6570\u636e\u5199\u5230redis\u91cc\u9762\uff0c\u7136\u540e\u518d\u6839\u636e\u9700\u8981\uff0c\u6309\u7167\u573a\u666f\u6765\u505a\u4e00\u4e9b\u8fd9\u4e2a\u6301\u4e45\u5316\u7684\u540c\u6b65</p> <p>\u5e38\u89c1\u7684redis\u7684\u573a\u666f,\u4e3b\u8981\u662f\u8bfb\u591a\u5199\u5c11, \u5229\u7528\u7f13\u5b58\u7684\u61d2\u52a0\u8f7d\u673a\u5236\u5c31\u53ef\u4ee5\u4e86, \u5148\u53bbredis\u91cc\u9762\u67e5, \u800c\u5982\u679c\u6ca1\u6709,\u5c31\u53bb\u5e93\u91cc\u9762\u53bb\u635e,\u7136\u540e\u628a\u6570\u636e\u5237\u5230\u7f13\u5b58\u91cc\u9762</p> <p>redis\u53ea\u662f\u4f5c\u4e3a\u4e00\u4e2a\u8f85\u52a9\u7684\u624b\u6bb5,\u6765\u63d0\u9ad8\u67e5\u8be2\u7684\u6548\u7387. </p> <ul> <li>\u70b9\u8d5e</li> <li>\u5b9e\u65f6\u7684\u8c03API</li> </ul> <p>\u53bb\u4fee\u6539\u6570\u636e\u5e93,\u5f80\u5e93\u91cc\u9762\u53bb\u589e\u52a0\u8bb0\u5f55,\u5305\u62ec\u4fee\u6539\u5b83\u7684\u4e00\u4e2a\u603b\u91cf, \u5c31\u662f\u5728redis\u91cc\u9762\u53bb\u7ef4\u62a4\u4e00\u4e2akey, \u6765\u5b58\u50a8\u5f53\u524d\u6587\u7ae0,  \u6027\u80fd\u5c31\u4f1a\u5927\u5927\u7684\u63d0\u5347, \u5b83\u7684\u6027\u80fd\u8981\u9ad8\u597d\u51e0\u4e2a\u6570\u91cf\u7ea7</p> <p>\u7136\u540e\u518d\u8bbe\u7f6e\u597d\u5b9a\u65f6\u4efb\u52a1, \u505a\u597dredis\u8ddf\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u4e2a\u540c\u6b65.  \u540c\u6837\u4e5f\u53ef\u4ee5\u91c7\u7528redis\u6765\u4f5c\u4e3a\u4e3b\u5e93, \u5c31\u662f\u4f1a\u6709\u9891\u7e41\u7684\u7528\u6237\u4ea4\u4e92. \u90fd\u5c5e\u4e8e\u8bfb\u591a\u5199\u591a\u7684\u573a\u666f</p> <p>\u5e38\u89c1\u7684\u8fd9\u4e2a\u6570\u636e\u7684\u4e00\u81f4\u6027\u95ee\u9898 , redis\u8ddfMysql, \u540c\u6b65\u662f\u6709\u65f6\u95f4\u5dee,\u600e\u4e48\u53bb\u4fdd\u8bc1\u4e00\u81f4\u6027 </p> <p>\u4ee5Redis\u505a\u4e3b\u5e93, \u6bd4\u8f83\u9002\u5408\u4e00\u4e9b\u4ea4\u4e92\u6027\u6bd4\u8f83\u9ad8\uff0c\u53c8\u5bf9\u4e00\u81f4\u6027\u8981\u6c42\u6ca1\u90a3\u4e48\u9ad8\u7684\u573a\u666f\uff0c\u6bd4\u5982\u8bf4\u5e38\u89c1\u7684\u6587\u7ae0\u6d4f\u89c8\u91cf</p>"},{"location":"chap7/int_anws/#20-redis-apcp","title":"20 Redis \u5230\u5e95\u662f AP\u8fd8\u662fCP","text":"<ul> <li>\u4f20\u7edf\u67b6\u6784\uff1a</li> </ul> <p>\u90a3\u4e48\u4e00\u65e6\u4e3b\u7ed3\u70b9\u6302\u4e86\uff0c\u90a3\u4e48\u54e8\u5175sentinel\u5bf9\u5c31\u4f1a\u628a\u4e3b\u8282\u70b9\u4e0b\u6389\uff0c \u867d\u7136\u4e3b\u4ece\u6a21\u5f0f\u4e5f\u6709\u591a\u4e2a\u670d\u52a1\u4e5f\u662f\u4e00\u4e2a\u96c6\u7fa4\u3002\u5b9e\u9645\u4e0a\u771f\u6b63\u5bf9\u5916\u670d\u52a1\uff0c\u53ea\u6709\u4e00\u53f0\u673a\u5668\uff0c\u6240\u4ee5\u5982\u679c\u516c\u53f8\u91c7\u7528\u4e86redis\u7684\u8fd9\u4e2a\u4e3b\u4ece\u6a21\u5f0f\uff0c\u6216\u8005\u8bf4\u662f\u54e8\u5175\u6a21\u5f0f\uff0credisn\u7b26\u5408CP</p> <ul> <li>Redis 3.0\u4ee5\u540e</li> </ul> <p>redis cluster \u6a21\u5f0f\uff0c\u53ef\u4ee5\u5b9e\u73b0\u6570\u636e\u5206\u7247\uff0c \u6bcf\u4e2a\u8282\u70b9\u5462\u5b58\u50a8\u4e00\u90e8\u5206\u6570\u636e\uff0c\u6bcf\u4e2a\u6570\u636e\u5206\u7247\u53c8\u6709\u591a\u4e2a\u526f\u672c\u3002 \u7136\u540e\u5206\u6563\u5728\u4e0d\u540c\u7684\u8282\u70b9\u4e2d\uff0c\u53ef\u4ee5\u540c\u65f6\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\uff0c \u53ef\u4ee5\u5b9e\u73b0\u6545\u969c\u7684\u8f6c\u79fb\uff0c\u8fd8\u6709\u5176\u4ed6\u8282\u70b9\u53ef\u4ee5\u7ee7\u7eed\u63d0\u4f9b\u670d\u52a1\uff0c\u4f46\u662f\u5f15\u5165\u4e86\u591a\u526f\u672c\u5230\u4e86\u6570\u636e\u7684\u540c\u6b65\u3002</p> <p>\u5f53\u67d0\u4e2a\u6570\u636e\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5c31\u4f1a\u628a\u8fd9\u4e2a\u4fee\u6539\u7684\u8fd9\u4e2a\u8282\u70b9\u4e0a\u7684\u6570\u636e\uff0c \u540c\u6b65\u5230\u5176\u4ed6\u7684\u8282\u70b9\uff0c\u4f46\u662f\u7531\u4e8e\u7f51\u7edc\u4f20\u8f93\uff0c\u5ef6\u8fdf\u554a\u7b49\u7b49\u539f\u56e0\u3002 \u4e0d\u4e00\u5b9a\u4f1a\u88ab\u5176\u4ed6\u8282\u70b9\u63a5\u6536\u5230\uff0c \u6240\u4ee5\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8282\u70b9\u4e4b\u95f4\u5b58\u5728\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u60c5\u6cc1\uff0c\u5f53\u7136\u4e86\u5982\u679c\u67d0\u4e00\u4e2a\u8282\u70b9\u53d1\u751f\u4e86\u6545\u969c</p> <p>\u77ac\u65f6\u4ea7\u751f\u7684\u8fd9\u4e2a\u6570\u636e\uff0c\u662f\u65e0\u6cd5\u540c\u6b65\u5230\u5176\u4ed6\u4ece\u8282\u70b9\u7684\uff0c\u6240\u4ee5\u5f53\u8fd9\u4e2a\u8282\u70b9\u6062\u590d\u4e4b\u540e\uff0c\u91cd\u65b0\u52a0\u5165\u5230\u96c6\u7fa4\uff0c\u90a3\u4e48\u4e4b\u524d\u6ca1\u6709\u540c\u6b65\u7684\u6570\u636e\u3002\u53ea\u4f1a\u5b58\u5728\u4e4b\u524d\u6545\u969c\u7684\u90a3\u4e2a\u8282\u70b9\u4e2d\uff0c\u5176\u4ed6\u8282\u70b9\u5c31\u6ca1\u6709\u8fd9\u90e8\u5206\u6570\u636e\u4e86\uff0c\u4e5f\u4f1a\u4ea7\u751f\u4e0d\u4e00\u81f4\u3002\u6240\u4ee5\u6211\u4eec\u8bf4cluster\u6a21\u5f0f\u5176\u5b9e\u662fAP</p> <p>\u5b83\u662f\u80fd\u591f\u4fdd\u8bc1\u53ef\u7528\u6027\u548c\u5bb9\u9519\u6027\u7684\uff0c\u5b83\u7684\u4e00\u81f4\u6027\u662f\u4fdd\u8bc1\u4e0d\u4e86\u7684\uff0c\u56e0\u4e3a\u5b83\u6d89\u53ca\u5230\u4e00\u4e2a\u6570\u636e\u540c\u6b65\u7684\u95ee\u9898\uff0c\u53ea\u80fd\u7b97\u662f\u6700\u7ec8\u7684\u4e00\u81f4\u6027</p>"},{"location":"chap7/int_anws/#21-redis","title":"21 \u5982\u4f55\u4fdd\u8bc1redis\u4e2d\u7684\u6570\u6398 \u90fd\u662f\u70ed\u70b9\u6570\u636e","text":"<p>\u4f18\u5148\u4fdd\u8bc1\u6240\u6709\u7684\u70ed\u70b9\u6570\u636e\u4e5f\u5c31\u662f\u7528\u6237\u8bbf\u95ee\u6b64\u8f83\u591a\u7684\u6570\u636e, \u653e\u5728\u7f13\u5b58\u91cc\u9762. </p> <p>\u6211\u4eec\u5728\u8bbe\u7f6e\u4e00\u4e2akey\u7684\u65f6\u5019, \u90fd\u4f1a\u7ed9\u8fd9\u4e2akey\u8bbe\u7f6e\u4e00\u4e2a\u8fc7\u671f\u65f6\u95f4, \u6bd4\u5982\u8bf4key\u7684\u8fc7\u671f\u65f6\u95f4\u4e3a\u4e00\u4e2a\u5c0f\u65f6,\u90a3\u4e48\u4e00\u4e2a\u5c0f\u65f6\u5230\u4e86. \u8fd9\u4e2akey\u5c31\u8fc7\u671f\u5b50\u8bbf\u95ee\u4e0d\u5230\u4e86.</p> <p>\u5982\u679c\u5728\u5230\u671f\u4e4b\u524d\u88ab\u8bbf\u95ee\u5230\u4e86, \u90a3\u4e48\u5c31\u4f1a\u589e\u52a0\u4e00\u5b9a\u7684\u8fd9\u4e2a\u8fc7\u671f\u65f6\u95f4. \u589e\u52a030\u79d2\u6216\u8005\u4e00\u5206\u949f,\u8bbf\u95ee\u8d8a\u591a\u8fc7\u53bb\u7684\u65f6\u95f4\u5462\u5c31\u4f1a\u8d8a\u957f, \u7559\u5728\u8fd9\u4e2aredis\u91cc\u9762\u7684. \u81ea\u7136\u5c31\u662f\u70ed\u70b9\u6570\u636e\u4e86. </p> <p>\u8fd9\u4e9b\u8fc7\u671f\u7684key,\u4e5f\u662f\u989d\u5916\u6709\u4e00\u4e2a\u5220\u9664\u7684\u7b56\u7565\uff0c\u53eb\u505a\u5b9a\u671f\u5220\u9664\u3002\u9ed8\u8ba4\u662f\u6bcf\u9694\u554a100\u6beb\u79d2\uff0c\u968f\u673a\u62bd\u53d6\u4e00\u4e9b\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684key\uff0c\u6765\u68c0\u67e5\u662f\u5426\u8fc7\u671f\u3002\u5982\u679c\u8fc7\u671f\u5c31\u76f4\u63a5\u5220\u9664\uff0c\u4f46\u662f\u5b83\u4e0d\u662f\u6bcf\u9694100\u6beb\u79d2\u5c31\u904d\u5386\u6240\u6709\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684key\uff0credis\u5b83\u662f\u6bcf\u9694100\u6beb\u79d2\uff0c\u968f\u673a\u62bd\u53d6\u4e00\u4e9b\u8fd9\u4e2akey\u7684\u68c0\u67e5\u6765\u5220\u9664\u7684</p> <p>\u5f53\u7136\u5b9a\u671f\u5220\u9664\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5f88\u591a\u7684\u8fc7\u671f\u7684key, \u5230\u4e86\u65f6\u95f4, \u5e76\u6ca1\u6709\u4eceredis\u91cc\u9762\u7ed9\u6e05\u6389, \u5c31\u9700\u8981\u505a\u8fd9\u4e2a\u60f0\u6027\u5220\u9664, \u5c31\u662f\u5728\u83b7\u53d6\u67d0\u4e2akey\u7684\u65f6\u5019, redis\u5b83\u4f1a\u68c0\u67e5, \u8fd9\u4e2akey\u5982\u679c\u8fc7\u671f, \u90a3\u4e48\u5c31\u4f1a\u76f4\u63a5\u4ece\u7684\u8fd9\u4e2aredis\u91cc\u9762\u7ed9\u5b83\u5220\u9664\u6389.</p> <p>\u5b9a\u671f\u5220\u9664\u3001\u60f0\u6027\u5220\u9664\u4e24\u8005\u7ed3\u5408\u8d77\u6765\u4f7f\u7528, \u5c31\u80fd\u591f\u4fdd\u8bc1key\u8fc7\u671f, \u76f8\u5e94\u7684\u5185\u5bb9\u4e5f\u80fd\u591f\u4eceredis\u91cc\u9762\u5220\u9664\u6389, \u7559\u5b58\u4e0b\u6765\u7684\u5c31\u662f\u6211\u4eec\u7684\u70ed\u70b9\u6570\u636e.</p> <p>\u4f46\u662f\u5982\u679c\u5b9a\u671f\u5220\u9664\u4e5f\u6f0f\u6389\uff0c\u5f88\u591a\u8fc7\u671f\u7684key\uff0c\u7136\u540e\u4e5f\u6ca1\u6709\u53ca\u65f6\u7684\u53bb\u505a\u67e5\u8be2\uff0c\u4e5f\u6ca1\u6709\u8d70\u60f0\u6027\u5220\u9664\uff0c\u53ef\u80fd\u5c31\u4f1a\u6709\u5927\u91cf\u7684\u8fc7\u671f\u7684key\u5806\u79ef\u5728\u5185\u5b58\u91cc\u9762\u5bfc\u81f4\u5185\u5b58\u7684\u8017\u5c3d\uff0c\u5c31\u53ef\u4ee5\u8d70\u8fd9\u4e2a\u5185\u5b58\u6dd8\u6c70\u673a\u5236\uff0810 redis\u7f13\u5b58\u8fc7\u671f\u7b56\u7565\uff09\u3002\u7528\u7684\u6bd4\u8f83\u591a\u7684\u5c31\u662flru\uff0c\u5c31\u662f\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\uff0c\u5c31\u662f\u6700\u8fd1\u672a\u4f7f\u7528\u7684\u6216\u8005\u4f7f\u7528\u6bd4\u8f83\u5c11\u7684key\uff0c\u4f1a\u76f4\u63a5\u901a\u8fc7\u6dd8\u6c70\u673a\u5236\u6765\u5220\u9664\u6389\uff0c\u4fdd\u6c5f\u6709\u5145\u8db3\u7684\u7a7a\u95f4\u7559\u7ed9\u70ed\u70b9\u6570\u636e</p> <p>**\u5f53\u7136\u9664\u4e86\u8fc7\u671f\u7684\u65f6\u95f4\u7b56\u7565\u4ee5\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u8089\u773c\u53ef\u89c1\u7684\u70ed\u70b9\u6570\u636e\u5c31\u4f1a\u76f4\u63a5\u5237\u5230\u5185\u5b58\u91cc\u9762\uff0c\u7136\u540e\u5b9a\u671f\u66f4\u65b0\uff0c\u4e0d\u9700\u8981\u518d\u4ece\u4e1a\u52a1\u6a21\u5757\u91cc\u9762\u554a **</p>"},{"location":"chap7/int_anws/#2_2","title":"2 \u5206\u5e03\u5f0f","text":""},{"location":"chap7/int_anws/#1_2","title":"1 \u8c08\u8c08\u4f60\u5bf9\u5206\u5e03\u5f0f\u7684\u7406\u89e3","text":"<p>\u5206\u5e03\u5f0f\u6846\u67b6\uff0c\u4e00\u4e2a\u662f\u963f\u91cc\u7684\u8fd9\u4e2adubbo\uff0c \u4e00\u4e2a\u662fspringcloud\u3002\u5b9e\u73b0\u7684\u539f\u7406\u90fd\u5927\u5dee\u4e0d\u5dee\uff0c \u6ce8\u518c\u4e2d\u5fc3\uff0c\u914d\u7f6e\u4e2d\u5fc3\uff0c\u8ba4\u8bc1\u4e2d\u5fc3, \u4e1a\u52a1\u4e2d\u5fc3\u7b49\u7b49</p> <p>\u5206\u5e03\u5f0f\u6846\u67b6\u5f15\u5165\u5f88\u65b9\u4fbf\uff0c\u4f46\u662f\u540c\u6837\u4e5f\u5e26\u6765\u4e86\u5f88\u591a\u7684\u95ee\u9898\u3002\u6bd4\u5982\u8bf4\u7cfb\u7edf\u4f1a\u53d8\u5f97\u8d8a\u6765\u8d8a\u590d\u6742\u3002 \u7cfb\u7edf\u7684\u7ef4\u62a4\u6210\u672c\u4e5f\u5f88\u9ad8\uff0c\u7248\u672c\u8fed\u4ee3\u53d1\u5e03\u7684\u4e5f\u53d8\u5f97\u8d8a\u6765\u8d8a\u590d\u6742\u3002\u8fd8\u6709\u6700\u5e38\u89c1\u7684\u5c31\u662fcap\u95ee\u9898, \u4e00\u81f4\u6027\u7684\u95ee\u9898\u7b49\u7b49, \u5b83\u4e0d\u662f\u7acb\u5373\u88ab\u5220\u9664\u7684</p>"},{"location":"chap7/int_anws/#2-rpc","title":"2 \u5206\u5e03\u5f0f\u5fae\u670d\u52a1\u7684\u7075\u9b42-rpc\u7684\u7406\u89e3","text":"<p>RPC\u5176\u5b9e\u5c31\u662f\u5206\u5e03\u5f0f\u5fae\u670d\u52a1\u6846\u67b6\u7684\u7075\u9b4f \u4ec0\u4e48\u662fRPC\uff0c\u53ef\u4ee5\u7b80\u5355\u7684\u7406\u89e3\u6210\u8de8\u6a21\u5757\u670d\u52a1\u8c03\u7528\u7684\u6846\u67b6\uff0c\u4f20\u7edf\u7684\u5355\u4f53\u67b6\u6784\uff0c\u8c03\u7528\u670d\u52a1\u53ef\u4ee5\u5f88\u7b80\u5355\uff0c\u76f4\u63a5\u662f\u5148\u5f15\u7528\u8fd9\u4e2aservice\u3002 \u7528service.\u65b9\u6cd5\u540d\u7684\u65b9\u5f0f\u5c31\u8c03\u7528\u6210\u529f\u4e86\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u670d\u52a1\uff0c\u90fd\u5199\u5728\u4e00\u4e2a\u5305\u91cc\u9762\uff0c \u53ef\u4ee5\u76f4\u63a5\u5728\u672c\u5730\u8c03\u7528\u3002</p> <p>\u4f46\u662f\u4e00\u65e6\u6539\u5199\u6210\u4e86\u8fd9\u4e2a\u5206\u5e03\u5f0f\u4e4b\u540e\uff0c \u5fae\u670d\u52a1\u4e4b\u540e\u5f88\u591a\u6a21\u5757\u3002 \u5206\u522b\u5728\u4e0d\u540c\u7684\u8fd9\u4e2a\u6a21\u5757\u4e2d\uff0c\u7528\u6237\u4e2d\u5fc3\uff0c\u5546\u54c1\u4e2d\u5fc3\uff0c\u8ba2\u5355\u4e2d\u5fc3\uff0c\u901a\u77e5\u4e2d\u5fc3\u7b49\u7b49\u5f7c\u6b64\u72ec\u7acb\u3002 </p> <p>\u6bd4\u5982\u8bf4\u6211\u8981\u8d2d\u4e70\u5546\u54c1\uff0c \u5c31\u6d89\u53ca\u5230\u5bf9\u7528\u6237\u4e2d\u5fc3\u7684\u8c03\u7528\uff0c \u6bd4\u5982\u8bf4\u9700\u8981\u53bb\u5224\u5b9a\u3002 \u8fd9\u4e2a\u7528\u6237\u6709\u6ca1\u6709\u767b\u5f55\uff0c \u8d26\u6237\u6709\u6ca1\u6709\u8fd9\u4e2a\u79ef\u5206\u53ef\u4ee5\u62b5\u6263\uff0c \u4f20\u7edf\u7684\u53ef\u80fd\u4f1a\u7528\u8fd9\u4e2ahttp\u63a5\u53e3\u7684\u65b9\u5f0f\uff0c \u6765\u8c03\u7528\uff0c \u4f20\u53c2\uff0c\u54cd\u5e94\uff0c\u8fd4\u53c2\uff0c\u90a3\u4e48\u5bf9\u4e8e\u7b80\u5355\u7684\u8fd9\u4e2a\u4e1a\u52a1\u6765\u8bf4\uff0c \u5176\u5b9e\u95ee\u9898\u4e5f\u4e0d\u5927</p> <p>\u4f46\u662f\u4e00\u65e6\u4e1a\u52a1\u91cf\u5927\u4e86\uff0c\u4e1a\u52a1\u590d\u6742\uff0chttp\u63a5\u53e3\u7684\u6548\u7387\u5c31\u4f1a\u5f88\u4f4e\uff0chttp\u67093\u6b21\u63e1\u624b\u3002\u7f51\u7edc\u5f00\u9500\u4e5f\u56e0\u6b64\u5462\u4f1a\u6709\u975e\u5e38\u5927\uff0c\u90a3\u4e48\u4e00\u65e6\u9891\u7e41\u4f7f\u7528\u7684\u6548\u7387\u4e0a\u8fd8\u662f\u4f1a\u6709\u4e00\u4e9b\u5f71\u54cd\u7684\u3002</p> <p>\u5c31\u5f97\u8003\u8651\u8fd9\u4e2arpc\u6846\u67b6\uff0c\u8ba9\u670d\u52a1\u8c03\u7528\u8ddf\u672c\u5730\u8c03\u7528\u4e00\u6837\uff0c\u9ad8\u6027\u80fd\u4f4e\u5ef6\u8fdf\u3002</p> <p>\u90a3\u4e48\u7528\u6237\u672c\u8eab\uff0c\u6839\u672c\u5c31\u611f\u53d7\u4e0d\u5230\u8fd9\u4e2a\u8fdc\u7a0b\u7684\u8fd9\u4e2a\u8c03\u7528\u3002\u5b9e\u73b0\u539f\u7406\u4e5f\u5f88\u7b80\u5355  \u6240\u6709\u7684\u670d\u52a1\u5148\u6ce8\u518c\u5230\u6ce8\u518c\u4e2d\u5fc3\uff0c\u90a3\u4e48\u6ce8\u518c\u4e2d\u5fc3\u5462\u5fc5\u987b\u8981\u6709\u7684\uff0c\u8d77\u5230\u4e86\u8fd9\u4e2a\u670d\u52a1\u8c03\u5ea6\uff0c\u76d1\u6d4b\u7684\u4e00\u4e2a\u529f\u80fd\uff0c\u80fd\u770b\u5230\u5404\u4e2a\u6a21\u5757\u7684\u670d\u52a1\u5305\u7684\u6ce8\u518c\uff0c\u5bf9\u5e94\u7684\u8fd9\u4e2aIP\u554a\u7aef\u53e3\uff0c \u6709\u51e0\u4e2a\u670d\u52a1\u5305\u5728\u7ebf\u7b49\u7b49\u3002 </p> <p>\u90a3\u4e48\u6bcf\u6b21\u8c03\u7528\u7684\u65f6\u5019\uff0c \u53ef\u4ee5\u5148\u628a\u8fd9\u4e2a\u8bf7\u6c42\u53d1\u9001\u5230\u6ce8\u518c\u4e2d\u5fc3\uff0c\u90a3\u4e48\u6ce8\u518c\u4e2d\u5fc3\u627e\u5230\u5bf9\u5e94\u7684\u670d\u52a1\u3002\u8fd4\u56de\u7ed9\u8fd9\u4e2a\u8c03\u7528\u7684\u6a21\u5757\uff0c\u5982\u679c\u662f\u96c6\u7fa4\u90e8\u7f72\uff0c\u90a3\u4e48\u5c31\u6309\u7167\u8fd9\u4e2a\u8f6e\u8be2\u7684\u7b56\u7565\u6216\u8005\u4e00\u4e9b\u7279\u6b8a\u7684\u7b56\u7565\u90fd\u53ef\u4ee5\u3002</p> <p>\u627e\u5230\u4e00\u4e2a\u53ef\u4ee5\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u5305\u5b8c\u6210\u8c03\u7528\uff0c\u7136\u540e\u8fd4\u56de\u7ed3\u679c\u3002\u539f\u7406\u57fa\u672c\u4e0a\u90fd\u662f\u8fd9\u6837\uff0c\u5e38\u89c1\u7684rpc\u6846\u67b6\u6709\u5f88\u591a\u3002 \u6b64\u8f83\u5e38\u89c1\u7684\u5c31\u662fdubbo\uff0c spring \u91cc\u7684 feign</p> <p>\u6ce8\u518c\u4e2d\u5fc3\uff0c\u4e00\u822c\u90fd\u662fzookeeper\uff0c \u90a3\u4e48Feignt, \u4e00\u822c\u90fd\u7528spring cloud\u91cc\u9762\u7684\u5168\u5bb6\u6876\uff0ceureca\u3002\u8fd8\u6709\u5176\u4ed6\u7684\u4e00\u4e9b\u6ce8\u518c\u4e2d\u5fc3</p>"},{"location":"chap7/int_anws/#3","title":"3 \u670d\u52a1\u6302\u4e86\u6ce8\u518c\u4e2d\u5fc3\u5982\u4f55\u611f\u77e5\u670d\u52a1\u4e0d\u53ef\u7528","text":"<p>\u901a\u5e38\u8bb2\u7684\u670d\u52a1\u4e0d\u53ef\u7528\uff0c\u670d\u52a1\u6389\u7ebf\u554a\u4e00\u822c\u662f\u6709\u4e24\u79cd\u60c5\u6cc1\uff0c\u4e00\u79cd\u662f\u5c5e\u4e8e\u8fd9\u4e2a\u4e3b\u52a8\u4e0b\u7ebf\u3002 \u4e00\u79cd\u662f\u5c5e\u4e8e\u8fd9\u4e2a\u5f02\u5e38\u4e0b\u7ebf\uff0c\u786c\u4ef6\u6545\u969c\u554a\u5b95\u673a\uff0c\u8d85\u65f6\u8c03\u7528\u7b49\u7b49\u5404\u79cd\u5f02\u5e38\u60c5\u6cc1\u3002</p> <p>\u90a3\u4e48\u4e3b\u52a8\u4e0b\u7ebf\uff0c \u4e00\u4e2a\u53ef\u63a7\u7684\u72b6\u6001\uff0c \u4e00\u822c\u662f\u5728\u53d1\u7248\u7684\u65f6\u5019\uff0c\u8fd9\u65f6\u5019\u4f1a\u5148\u505c\u6389\u8fd9\u4e2a\u670d\u52a1\uff0c\u5728\u505c\u6b62\u4e4b\u524d\u670d\u52a1\u5305\u4f1a\u901a\u77e5\u8fd9\u4e2a\u6ce8\u518c\u4e2d\u5fc3\uff0c \u6709\u6d41\u91cf\u8fdb\u6765\u7684\u5148\u4e0d\u8981\u5206\u7ed9\u6211\uff0c\u8ba9\u522b\u7684\u673a\u5668\u6765\u8fdb\u884c\u670d\u52a1\uff0c\u7b49\u91cd\u542f\u6210\u529f\u4e4b\u540e\u518d\u653e\u6d41\u91cf\u8fdb\u6765\u3002</p> <p>\u6216\u8005\u662f\u5728\u7ba1\u7406\u540e\u53f0\uff0c\u624b\u52a8\u53bb\u6458\u6389\u8fd9\u4e2a\u673a\u5668\u3002\u8fd9\u79cd\u60c5\u6cc1\u4e0b\u662f\u7531\u670d\u52a1\u5305\uff0c\u6765\u901a\u77e5\u8fd9\u4e2a\u6ce8\u518c\u4e2d\u5fc3\u3002 \u6ce8\u518c\u4e2d\u5fc3\u6536\u5230\u6d88\u606f\u4e4b\u540e\uff0c\u4f1a\u4e3b\u52a8\u5220\u9664\u8be5\u670d\u52a1\u7684\u8fd9\u4e2a\u5728\u7ebf\u72b6\u6001\uff0c \u8fd9\u6837\u5c31\u80fd\u591f\u907f\u514d\u6d41\u91cf\u8bbf\u95ee\u5230\u8fd9\u4e2a\u4e0b\u7ebf\u7684\u673a\u5668\u4e0a\u9762</p> <p>\u53e6\u5916\u4e00\u79cd\u662f\u8fd9\u4e2a\u5f02\u5e38\u4e0b\u7ebf\uff0c\u65ad\u7535\u65ad\u7f51\uff0c\u670d\u52a1\u5b95\u673a\u3002\u6ce8\u518c\u4e2d\u5fc3\u4e0d\u77e5\u9053\u8be5\u670d\u52a1\u5df2\u7ecf\u6389\u7ebf\u4e86\uff0c\u90a3\u4e48\u4e00\u65e6\u88ab\u5176\u4ed6\u7684\u8fd9\u4e2a\u6a21\u5757\u8c03\u7528\u4e86\u5c31\u4f1a\u5e26\u6765\u4e00\u4e9b\u4f55\u9898\u3002</p> <p>\u90a3\u4e48\u4e3a\u4e86\u907f\u514d\u51fa\u73b0\u8fd9\u6837\u7684\u60c5\u6cc1\uff0c\u6ce8\u518c\u4e2d\u5fc3\u589e\u52a0\u4e86\u4e00\u4e2a\u5fc3\u8df3\u68c0\u6d4b\u529f\u80fd\uff0c\u4f1a\u5bf9\u670d\u52a1\u7684\u63d0\u4f9b\u8005provider\uff0c\u8fdb\u884c\u8fd9\u4ecb\u5fc3\u8df3\u68c0\u6d4b\uff0c\u6bcf\u969430\u79d2\u5c31\u4f1a\u53d1\u9001\u4e00\u4e2a\u5fc3\u8df3\uff0c\u90a3\u4e48\u5982\u679c\u4e09\u6b21\u5fc3\u8df3\u90fd\u6ca1\u6709\u8fd4\u56de\u503c\uff0c\u8be5\u670d\u52a1\u5df2\u7ecf\u4e0b\u7ebf\uff0c\u7136\u540e\u8d76\u7d27\u901a\u77e5consumer\uff0c\u6d88\u8d39\u8005\u7aef\u6765\u66f4\u65b0\u7684\u8fd9\u4e2a\u670d\u52a1\u5217\u8868\uff0c\u544a\u8bc9\u8fd9\u4e2aconsumer\u7aef\u8c03\u7528\u522b\u7684\u673a\u5668</p>"},{"location":"chap7/int_anws/#4","title":"4 \u6ce8\u518c\u4e2d\u5fc3\u6302\u4e86\u670d\u52a1\u4e4b\u95ee\u8fd8\u80fd\u76f8\u4e92\u8c03\u7528\u5417","text":"<p>\u5982\u679c\u6ce8\u518c\u4e2d\u5fc3\u6302\u4e86\u670d\u52a1\u4e4b\u95f4\u8fd8\u80fd\u4e0d\u80fd\u76f8\u4e92\u8c03\u7528\uff1f</p> <p>\u80fd\u8c03\u7528\uff0c\u4e0d\u80fd\u8c03\u7528\u8981\u770b\u5177\u4f53\u7684\u573a\u666f </p> <p>\u6ce8\u518c\u4e2d\u5fc3\u6570\u636e\u5e93\u6302\u6389\u3002 \u5176\u5b9e\u4e5f\u65e0\u6240\u8c13, \u6ce8\u518c\u4e2d\u5fc3\u8fd8\u662f\u80fd\u591f\u7528\u7684, \u4e00\u822c\u90fd\u4f1a\u628a\u6ce8\u518c\u673a\u7684\u4fe1\u606f\u653e\u5728\u7684\u7f13\u5b58\u91cc\u9762\u3002 \u6ce8\u518c\u4e2d\u5fc3\u6570\u636e\u5e93\u6302\u6389\uff0c \u6211\u4eec\u4ece\u7f13\u5b58\u91cc\u9762\u635e\u6570\u636e\u5c31\u53ef\u4ee5\u4e86.</p> <p>\u5982\u679c\u7f13\u5b58\u4e5f\u6302\u4e86\u8bbf\u95ee\u4e0d\u4e86\u4e86,  \u5982\u679c\u4f60\u91c7\u7528\u7684\u662f\u96c6\u7fa4\u6a21\u5f0f, \u4e5f\u4e0d\u7528\u62c5\u5fc3. \u8fd8\u662f\u4f1a\u9009\u62e9\u5176\u4ed6\u7684\u8282\u70b9\u6765\u4f5c\u4e3a master \u7ee7\u7eed\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u7684. </p> <p>\u4f46\u662f\u5982\u679c\u6ce8\u518c\u4e2d\u5fc3\u96c6\u7fa4\u90fd\u6302\u4e86,  \u6570\u636e\u5e93\u7f13\u5b58\u4e5f\u8bbf\u95ee\u4e0d\u4e86, \u4e00\u70b9\u4e8b\u90fd\u6ca1\u6709.\u56e0\u4e3a\u8c03\u7528\u8005\u672c\u5730, \u4e5f\u4f1a\u7f13\u5b58\u4e00\u4efd\u8fd9\u4e2a\u670d\u52a1\u5217\u8868. \u5305\u62ecIP\u5730\u5740, \u7aef\u53e3, \u540d\u79f0\u7b49\u7b49. \u90fd\u4f1a\u4ece\u6ce8\u518c\u4e2d\u5fc3\u62c9\u53d6\u4e00\u4efd\uff0c \u5f53\u524d\u670d\u52a1\u5305\u6e05\u5355\u3002\u6240\u4ee5\u5728\u8c03\u7528\u8005\u672c\u5730\u90fd\u4f1a\u5b58\u6709\u4e00\u4efd\u8fd9\u4e2a\u670d\u52a1\u5217\u8868</p> <p>\u4e00\u65e6\u6ce8\u518c\u4e2d\u5fc3\u6302\u4e86\uff0c\u670d\u52a1\u5305\u4e4b\u95f4 consumer\u548cprovider\u4e4b\u95f4\u3002 \u5c31\u4f1a\u91c7\u7528\u8fd9\u4e2a\u76f4\u8054\u7684\u65b9\u5f0f\uff0c\u4e5f\u7701\u7565\u4e86\u548c\u6ce8\u518c\u4e2d\u5fc3\u7684\u4ea4\u4e92\u3002 \u670d\u52a1\u5305\u4e4b\u95f4\u4e5f\u80fd\u591f\u76f8\u4e92\u8c03\u7528\uff0c \u4e0d\u53d7\u5f71\u54cd\u3002\u8fd9\u4e9b\u7b56\u7565\u9700\u8981\u53bb\u505a\u4e00\u4e9b\u914d\u7f6e</p> <p>\u4e0d\u80fd\u8c03\u7528\u7684\u573a\u666f\uff0cprovider \u5c31\u662f\u8fd9\u4e2a\u670d\u52a1\u7684\u63d0\u4f9b\u8005\u7684IP\u5730\u5740, \u7aef\u53e3\u53d1\u751f\u4e86\u6539\u53d8. \u90a3\u4e48\u6b63\u5e38\u60c5\u6cc1\u4e0b, \u6ce8\u518c\u4e2d\u5fc3\u662f\u80fd\u591f\u611f\u77e5\u5230. \u5e76\u4e14\u5e7f\u64ad\u7ed9\u6240\u6709\u7684\u670d\u52a1\u5305. \u670d\u52a1\u5305\u63a5\u6536\u5230\u4e86\u66f4\u65b0\u4fe1\u606f\u4e4b\u540e, \u5c31\u4f1a\u7acb\u523b\u6539\u53d8\u672c\u5730\u7f13\u5b58, \u670d\u52a1\u6e05\u5355\u6570\u636e. \u4f46\u662f\u5728\u6ce8\u518c\u4e2d\u5fc3\u6302\u4e86\u7684\u60c5\u6cc1, \u5176\u4ed6\u7684\u670d\u52a1\u5305\u5c31\u65e0\u6cd5\u66f4\u65b0, \u6240\u4ee5\u5c31\u4f1a\u5bfc\u81f4\u8c03\u7528\u5931\u8d25</p>"},{"location":"chap7/int_anws/#5-cap","title":"5 \u5206\u5e03\u5f0f\u7ed5\u4e0d\u5f00\u7684\u9b54\u5492 cap\u5b9a\u5f8b","text":"<p>\u5206\u5e03\u5f0f\uff0c\u4e0d\u5f97\u4e0d\u63d0\u5230CAP\u5b9a\u7406 \u53ef\u7528\u6027\uff0c \u4e00\u81f4\u6027\uff0c\u5bb9\u9519\u6027\u53ea\u80fd\u540c\u65f6\u6ee1\u8db3\u4e24\u4e2a\u3002\u5728\u8ba8\u8bba\u4f18\u5316\u5206\u5e03\u5f0f\u67b6\u6784\u7684\u65f6\u5019\uff0c \u56f4\u7ed5\u8fd93\u4e2a\u70b9\u7684\u63d0\u5347\uff0c\u63d0\u5347\u8fd9\u4e2a\u7cfb\u7edf\u7684\u53ef\u7528\u6027\uff0c\u5c31\u4f1a\u589e\u52a0\u8fd9\u4e2a\u7f13\u5b58\uff0c\u589e\u52a0\u670d\u52a1\u5668\uff0c\u5f15\u5165\u6d88\u606f\u961f\u5217\u3002\u6765\u63d0\u5347\u8fd9\u4e2a\u7cfb\u7edf\u7684\u5e76\u53d1\u91cf</p> <p>\u63d0\u5347\u8fd9\u4e2a\u5bb9\u9519\u6027\uff0c\u53ef\u4ee5\u8fdb\u884c\u8fd9\u4e2a\u670d\u52a1\u5668\u7684\u96c6\u7fa4\u7684\u90e8\u7f72\u3002 \u90a3\u4e48\u4e00\u53f0\u6302\u6389, \u4e0d\u5f71\u54cd\u5176\u4ed6\u8fd9\u4e2a.  \u8282\u70b9\u6b63\u5e38\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1. \u6570\u636e\u5e93\uff0c\u7f13\u5b58\u90fd\u8fdb\u884c\u8fd9\u4e2a\u96c6\u7fa4\u7684\u90e8\u7f72. \u5305\u62ec\u8fd9\u4e2a\u5bb9\u707e\u5907\u4efd</p> <p>\u5206\u5e03\u5f0f\u6570\u636e\u5e93, \u5c31\u662f\u5178\u578b\u7684\u727a\u7272\u4e86\u4e00\u81f4\u6027, \u63d0\u5347\u4e86\u53ef\u7528\u6027, \u5bb9\u9519\u6027\u7684\u4e00\u4e2a\u7ecf\u5178\u7684\u6848\u4f8b</p>"},{"location":"chap7/int_anws/#6","title":"6 \u804a\u804a\u5206\u5e03\u5f0f\u4e0b\u7684 \u8d1f\u8f7d\u5747\ud85d\uddfe\u7b56\u54af","text":"<p>\u5206\u5e03\u5f0f\u4e0b\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c \u5728\u8fd9\u4e2a\u5206\u5e03\u5f0f\u5fae\u670d\u7684\u67b6\u6784\u4e2d\uff0c\u4e00\u4e2a\u670d\u52a1\u901a\u5e38\u90fd\u662f\u6709\u597d\u51e0\u4e2a\u76f8\u540c\u7684\u670d\u52a1\u5305\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u7684\u3002 \u6bd4\u5982\u8bf4\u8ba2\u5355\u4e2d\u5fc3\uff0c \u5c31\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u7684\u9700\u8981\u6765\u90e8\u7f72\u591a\u53f0\u670d\u52a1\u5668\uff0c \u6bcf\u53f0\u670d\u52a1\u5668\u4e0a\u90fd\u4f1a\u90e8\u7f72\u4e00\u4e2a\u8ba2\u5355\u4e2d\u5fc3\uff0c\u8ba2\u5355\u4e2d\u5fc3\u7684\u96c6\u7fa4\u7edf\u4e00\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u3002</p> <p>\u5982\u679c\u5927\u91cf\u7684\u8bbf\u95ee\u8fc7\u6765\uff0c\u600e\u4e48\u53bb\u5206\u914d\u8bf7\u6c42\u5230\u76f8\u5e94\u7684\u670d\u52a1\u5668\u4e0a\u53bb\u3002 \u5fae\u670d\u52a1\u67b6\u6784\u4e0b\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u4e0b\u7684\u8d1f\u8f7d\u5747\u8861\u3002 \u5fc5\u4e0d\u53ef\u5c11\u7684\u4e00\u4e2a\u7ec4\u4ef6\uff0cdouble\u6709, spring cloudt\u4e5f\u6709 </p> <p>spring cloud\u662f\u5f15\u7528\u7684\u5916\u5728\u7684\u7ec4\u4ef6\uff0cribbon\u3002 \u5e38\u89c1\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u6709\u5f88\u591a\uff0c\u8f6e\u8be2\u7b56\u7565\uff0c\u968f\u673a\u7b56\u7565\uff0c\u52a0\u6743\u7b56\u7565\u3002 \u6240\u6709\u7684\u8d1f\u8f7d\u5747\u8861\u5176\u5b9e\u90fd\u9700\u8981\u914d\u5408\u6ce8\u518c\u4e2d\u5fc3\u6765\u4f7f\u7528\uff0c\u56e0\u4e3a\u670d\u52a1\u5305\u90fd\u9700\u8981\u6ce8\u518c\u5728\u6ce8\u518c\u4e2d\u5fc3\uff0c\u8c03\u7528\u8005\u9996\u5148\u662f\u83b7\u53d6\u4e86\u670d\u52a1\u5305\u7684\u6ce8\u518c\u4fe1\u606f\u4e4b\u540e\uff0c\u80fd\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u7b56\u7565</p>"},{"location":"chap7/int_anws/#7","title":"7 \u6d41\u91cf\u7684\u5165\u53e3 \u7f51\u5173\u7ea7\u7684\u8d1f\u8f7d\u5747\u8861","text":"<p>\u5206\u5e03\u5f0f\u96c6\u7fa4\u6709\u5f88\u591a\u7684\u5e94\u7528\u8d1f\u8f7d\u5747\u8861\u7684\u573a\u666f.  \u7f51\u5173\u7ea7\u7684\u8fd9\u4e2a\u8d1f\u8f7d\u5747\u8861. \u8fd9\u4e2a\u5fae\u670d\u52a1\u7684\u5185\u90e8\u7684\u7f51\u5173\u5c42,  \u6b64\u5982\u50cfspincloud\u7684\u5f15\u5165\u4e86gateway, \u5f15\u5165zuul, \u6765\u4f5c\u4e3a\u5fae\u670d\u52a1\u7684\u7f51\u5173, \u53ef\u4ee5\u8d77\u5230\u9274\u6743\u9650\u6d41\u7194\u65ad\u7684\u4f5c\u7528. \u66f4\u91cd\u8981\u7684\u8fd8\u662f\u5f53\u8def\u7531\u6765\u7528. \u6bd4\u5982\u8bf4\u83b7\u53d6\u4e86\u7528\u6237\u4fe1\u606f, \u8bf7\u6c42\u7684\u662f\u7528\u6237\u4e2d\u5fc3. \u7f51\u5173\u4f1a\u628a\u76f8\u5e94\u7684\u8bf7\u6c42,\u5206\u914d\u7ed9\u8fd9\u4e2a\u7528\u6237\u4e2d\u5fc3\u96c6\u7fa4.</p> <p>\u8ba9\u7528\u6237\u4e2d\u5fc3\u96c6\u7fa4\u53bb\u5904\u7406\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u7684\u8bf7\u6c42, \u7136\u540e\u6309\u7167\u9ed8\u8ba4\u7b56\u7565\u3002\u6bd4\u5982\u8fd9\u4e2a\u8f6e\u8be2\u7b56\u8def\u6765\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\u3002 </p> <p>\u5728\u5fae\u670d\u52a1\u7684\u5916\u90e8\u540c\u6837\u4e5f\u6709\u8d1f\u8f7d\u5747\u8861\uff0c \u6bd4\u5982\u8bf4\u6211\u4eec\u5e38\u89c1\u7684nginx\u3002 \u5c31\u662f\u505a\u8fd9\u4e2a\u53cd\u5411\u4ee3\u7406\uff0c \u4ee3\u7406\u80cc\u540e\u4e00\u5806\u7684\u670d\u52a1\u5668\u3002\u7531\u8fd9\u4e2anginx\u7edf\u4e00\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\uff0c \u8bf7\u6c42\u5148\u8f6c\u53d1\u5230\u8fd9\u4e2anginx\u4e0a\u9762\uff0c\u90a3\u4e48nginx \u518d\u6839\u636e\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u3002 \u8fdb\u884c\u8bf7\u6c42\u8f6c\u53d1\uff0c\u652f\u6301\u9ad8\u4f38\u7f29\u6027\u7684\u96c6\u7fa4\u67b6\u6784\u3002</p> <p>\u6240\u4ee5\u4e00\u822c\u7684\uff0c\u4e91\u670d\u52a1\u7528\u7684\u8fd8\u662f\u6bd4\u8f83\u591a\u4e00\u4e9b\uff0c\u914d\u5408\u5f39\u6027\u8ba1\u7b97\u3002\u53ef\u4ee5\u5b9e\u73b0\u8fd9\u4e2a\u5f39\u6027\u6269\u5bb9\uff0c\u7075\u6d3b\u589e\u51cf\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u642d\u914dF5\uff0c\u786c\u4ef6\u8d1f\u8f7d\u5747\u8861\u5668</p>"},{"location":"chap7/int_anws/#8_1","title":"8 \u5982\u4f55\u63d0\u9ad8\u7cfb\u7d71\u53ef\u7528\u6027 \u7ed9\u6bcf\u4e2a\u670d\u52a1\u627e\u4e2a\u5907\u80ce","text":"<p>\u600e\u4e48\u53bb\u63d0\u9ad8\u7cfb\u7edf\u7684\u53ef\u7528\u6027\uff0c\u5c31\u662f\u5c3d\u91cf\u7ed9\u6bcf\u4e00\u4e2a\u670d\u52a1\u627e\u4e00\u4e2a\u5907\u80ce\u3002\u4f46\u662f\u5907\u80ce\uff0c \u4e0d\u662f\u96c6\u7fa4\u6982\u5ff5\u91cc\u7684\u4e00\u4e2a\u5907\u7528\u673a\u5668\u800c\u662f\u4e00\u79cd\u5907\u7528\u65b9\u6848\u3002 </p> <p>\u6bd4\u5982\u5982\u8bf4\u5e38\u8bf4\u7684\u8fd9\u4e2a\u964d\u7ea7\u5907\u6848\uff0c\u5c31\u662f\u4e00\u79cd\u8fd9\u4e2a\u5907\u80ce\u65b9\u6848\uff0c\u6bd4\u5982\u67e5\u8be2\u8fd9\u4e2a\u5546\u54c1\u4fe1\u606f\u3002 </p> <p>\u6bd4\u5982\u67e5\u7684\u8fd9\u4e2aredlis\u96c6\u7fa4\uff0c\u5982\u679c\u53d1\u751f\u4e86\u6545\u969c\uff0c\u96ea\u5d29\uff0c\u7a7f\u900f\u5404\u79cd\u6545\u969c\u4e32.  \u7a7f\u900f\u5404\u79cd\u6545\u969c\u4e32,  redls\u6240\u6709\u7684\u96c6\u7fa4\u5462\u90fd\u6302\u4e0d\u80fd\u7528\u4e86\u3002\u6bd4\u5982 elasticsearch \u67e5\u8be2\u901f\u5ea6\uff0c\u53ef\u80fd\u6ca1\u6709\u8fd9\u4e2aredls\u8fd9\u4e48\u5feb\uff0c\u4f46\u662f\u597d\u6b79\u5907\u80ce\u8fd8\u80fd\u7528\u3002</p> <p>\u6d41\u91cf\u63a7\u5236\uff0c\u4e5f\u5c31\u662f\u9650\u6d41\u3002 \u5305\u62ec\u5355\u673a\u9650\u6d41\u8ddf\u96c6\u7fa4\u9650\u6d41\uff0c\u6bd4\u5982\u8bf4\u8fd9\u4e2a\u7cfb\u7edfqps, \u6bd4\u5982\u8bf4\u63a7\u5236\u57282,000\uff0c\u7194\u65ad\u673a\u5236\u3002 \u5f53\u4e0b\u6e38\u670d\u52a1\u56e0\u4e3a\u8bbf\u95ee\u538b\u529b\u8fc7\u5927\uff0c\u90a3\u4e48\u4e0a\u6e38\u670d\u52a1\u4e3a\u4e86\u4fdd\u62a4\u81ea\u5df1\uff0c\u4ee5\u53ca\u7cfb\u7edf\u6574\u4f53\u7684\u8fd9\u4e2a\u53ef\u7528\u6027\uff0c\u53ef\u4ee5\u6682\u65f6\u5207\u65ad\u5bf9\u4e0b\u6e38\u670d\u52a1\u7684\u8c03\u7528\uff0c\u662f\u4e00\u79cd\u4e3a\u4e86\u4fdd\u62a4\u7cfb\u7edf\u6574\u4f53\u7684\u53ef\u7528\u6027\uff0c\u800c\u91c7\u7528\u7684\u8fd9\u4e2a\u5907\u80ce\u7b56\u7565</p> <p>\u9ad8\u53ef\u7528\u6027\u7684\u4e5f\u5c31\u8fd9\u4e48\u51e0\u79cd\u65b9\u6848\uff0c\u4e00\u4e2a\u662f\u964d\u7ea7\uff0c \u4e00\u4e2a\u662f\u9650\u6d41\uff0c \u4e00\u4e2a\u662f\u7194\u65ad</p>"},{"location":"chap7/int_anws/#9_1","title":"9 \u670d\u52a1\u7194\u65ad \u89e3\u6c7a\u707e\u96be\u6027\u96ea\u5d29\u6548\u5e94\u7684\u80b2\u6548\u5229\u5668","text":"<p>\u4e3a\u4e86\u4fdd\u62a4\u670d\u52a1\u4e0d\u88ab\u6d41\u91cf\u51b2\u57ae\uff0c \u8fbe\u5230\u4e00\u5b9a\u7684\u8fd9\u4e2a\u9608\u503c\u5c31\u4f1a\u76f4\u63a5\u6390\u65ad\u670d\u52a1\u3002\u7194\u65ad\u5668\u600e\u4e48\u77e5\u9053\u4ec0\u4e48\u65f6\u5019\u8be5\u7194\u65ad\u3002 \u4e00\u822c\u5bb9\u65ad\u5668\u90fd\u662f\u6839\u636e\u670d\u52a1\u8c03\u7528\u7684\u5931\u8d25\u7387\u6765\u5224\u65ad\uff0c\u6bd4\u5982\u8bf4\u4e00\u79d2\u5185100\u4e2a\u8bf7\u6c42\uff0c \u5982\u679c\u8bbe\u7f6e\u5931\u8d25\u7387\u4e3a50%\uff0c\u90a3\u4e48\u4e00\u65e6\u8fbe\u5230\u4e8650\u4e2a\u8bf7\u6c42\u5931\u8d25\u3002 \u8981\u4e48\u8d85\u65f6\uff0c\u8981\u4e48\u662f\u63a5\u53e3\u9519\u8bef\uff0c\u7194\u65ad\u5668\u4f1a\u542f\u52a8\u7194\u65ad\u6765\u65ad\u5f00\u670d\u52a1</p> <p>\u65ad\u5f00\u4e4b\u540e\u600e\u4e48\u6062\u590d\u539f\u6765\u7684\u670d\u52a1\uff0c\u5bb9\u65ad\u5668\u672c\u8eab\u90fd\u5e26\u6709\u91cd\u89c6\u673a\u5236\uff0c\u6bd4\u5982\u8bf45\u79d2\u949f\u3002 5\u79d2\u949f\u4e4b\u540e\u5c31\u4f1a\u53d1\u8d77\u91cd\u8bd5\uff0c\u5982\u679c\u5931\u8d25\u7387\u4e0b\u964d\uff0c\u90a3\u4e48\u5c31\u4f1a\u5173\u6389\u7194\u65ad\uff0c \u7ee7\u7eed\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u3002\u53e6\u5916\u7194\u65ad\u5462\u5f80\u5f80\u662f\u8ddf\u964d\u7ea7\u4e00\u8d77\u7528\u7684\uff0c \u4e00\u65e6\u53d1\u751f\u4e86\u7194\u65ad\uff0c\u5c31\u5c31\u4f1a\u8c03\u7528\u964d\u7ea7\u65b9\u6cd5\u3002</p> <p>\u5e38\u89c1\u7684\u6709getfallback\uff0c\u6bd4\u5982\u8bf4redis\u670d\u52a1\u3002\u5982\u679c\u538b\u529b\u8fc7\u5927\u51fa\u73b0\u4e86\u7194\u65ad\uff0c\u90a3\u4e48\u7194\u65ad\u5668\u5c31\u4f1a\u81ea\u52a8\u8c03\u7528\u9686\u7ea7\u65b9\u6cd5\u3002 \u7528\u5176\u4ed6\u7684\u8d44\u6e90\u6765\u4ee3\u66ffredis\u670d\u52a1\uff0c\u6bd4\u5982elasticsearch, \u6216\u8005\u8981\u7528\u672c\u5730\u7684\u7f13\u5b58\u50cfguava. \u8fd9\u6837\u7684\u597d\u5904\u5462\u5c31\u662f\u5728\u5bb9\u65ad\u4e4b\u540e,\u53ef\u4ee5\u4e0d\u95f4\u65ad\u7684\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1,\u6765\u4fdd\u8bc1\u9ad8\u53ef\u7528\u6027. </p> <p>\u5e38\u7528\u7684\u6709hystrix, sentinel.  hystrix spring cloud \u4e2d\u6bd4\u8f83\u5e38\u89c1\u3002 \u4f46\u662f\u5462\u8fd8\u662f\u63a8\u8350\u5927\u5bb6\u6765\u4f7f\u7528sentinel\uff0chystrix\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4</p>"},{"location":"chap7/int_anws/#10","title":"10 \u5206\u5e03\u5f0f\u4e0b\u7684\u7ebf\u7a0b\u9694\u79bb\u673a\u5236","text":"<p>\u7ebf\u7a0b\u9694\u79bb\u673a\u5236, \u5c06\u8fd9\u4e2a\u4e0b\u5355\u63a5\u53e3, \u67e5\u8be2\u63a5\u53e3, \u5206\u5f00\u9694\u79bb\u3002\u6bd4\u5982\u8bf4\u4e0b\u5355\u63a5\u53e3\u5141\u8bb820\u4e2a\u7ebf\u7a0b\uff0c\u67e5\u8be2\u63a5\u53e3\u5141\u8bb810\u4e2a\u7ebf\u7a0b\u3002\u90a3\u4e48\u8c03\u7528\u7684\u65f6\u5019\u4e92\u4e0d\u5f71\u54cd\u3002 \u8fd9\u6837\u5c31\u4e0d\u4f1a\u51fa\u73b0\u4e0b\u5355\u63a5\u53e3\u5360\u7528\u5168\u90e8\u5546\u57ce\u4e2d\u5fc3\u7684\u7ebf\u7a0b\uff0c\u4ece\u800c\u5bfc\u81f4\u5176\u4ed6\u7684\u63a5\u53e3\u4e0d\u53ef\u4ee5\u7528\u7684\u60c5\u51b5</p> <p>\u7ebf\u7a0b\u5982\u679c\u5360\u6ee1\u4e86\u600e\u4e48\u5904\u7406</p> <p>\u5e38\u89c1\u7684\u7ebf\u7a0b\u6c60\uff0c\u6bd4\u5982\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3002 \u89e3\u51b3\u65b9\u5f0f\u5c31\u662f\u8bf7\u6c42\u4e00\u76f4\u7b49\u5f85\u3002 \u4e00\u76f4\u7b49\u5230\u6709\u7a7a\u4f59\u7684\u67e5\u8be2\u7ebf\u7a0b\uff0c\u7136\u540e\u5b8c\u6210\u8fd9\u4e2a\u67e5\u8be2\u7684\u64cd\u4f5c\u3002 \u4f46\u662f\u5982\u679c\u7b49\u4e0d\u5230\uff0c\u8d85\u8fc7\u4e86\u8bbe\u7f6e\u7684\u7b49\u5f85\u65f6\u95f4\u3002 \u90a3\u4e48\u4e00\u822c\u5c31\u662f\u8fd4\u56de\u54cd\u5e94\u8d85\u65f6\u3002\u90a3\u4e48\u5927\u90e8\u5206\u573a\u666f\u90fd\u662f\u8fd9\u4e48\u505a\u7684</p> <p>\u9694\u79bb\u7ebf\u7a0b\uff0c\u8bf7\u6c42\u4e00\u65e6\u53d1\u73b0\u7ebf\u7a0b\u6c60\u9971\u548c\u4ed6\u4f1a\u76f4\u63a5\u7194\u65ad\uff0c \u76f4\u63a5\u62d2\u7edd\u670d\u52a1\u6bd4\u8f83\u5e72\u8106\uff0c\u51cf\u5c11\u4e86\u6392\u961f\u65f6\u95f4\uff0c\u4e0d\u4f1a\u51fa\u73b0\u5f88\u591a\u7684\u7ebf\u7a0b\u963b\u585e\uff0c\u867d\u7136\u4e00\u90e8\u5206\u7528\u6237\u4e0b\u5355\u5931\u8d25\uff0c \u5927\u4e0d\u4e86\u7a0d\u540e\u91cd\u8bd5\u3002\u51e0\u79d2\u949f\u7684\u65f6\u95f4\u5176\u5b9e\u4e5f\u65e0\u5173\u7d27\u8981\uff0c \u4e00\u65e6\u7194\u65ad\u4e86\u3002\u8bf7\u6c42\u5c31\u4f1a\u8d70\u8fd9\u4e2a\u964d\u7ea7\u7684\u65b9\u6cd5\uff0cgetfallback\uff0c\u53ef\u4ee5\u662f\u53cb\u597d\u8bbf\u95ee\u63d0\u793a\u3002</p> <p>\u4e1a\u52a1\u7e41\u5fd9\u8bf7\u7a0d\u540e\u518d\u8bd5\uff0c\u8981\u4e48\u662f\u8d70\u672c\u5730\u7684\u67e5\u8be2\uff0c \u8981\u4e48\u8d70\u5176\u4ed6\u7684\u4e00\u4e9b\u67e5\u8be2\u7b49\u7b49\uff0c\u53cd\u6b63\u5c31\u662f\u5feb\u901f\u5931\u8d25\uff0c\u53cd\u6b63\u5c31\u662f\u5feb\u901f\u5931\u8d25\u3002\u5982\u679c\u5360\u7528\u7ebf\u7a0b\u6c60\u7684\u7ebf\u7a0b\u4e00\u76f4\u4e0d\u91ca\u653e\uff0c\u4e00\u822c\u8981\u8bbe\u7f6e\u8fd9\u4e2a\u8fc7\u671f\u65f6\u95f4\uff0c \u6bd4\u5982\u8bf4\u8fd9\u4e2a100\u6beb\u79d2\uff0c \u8d85\u8fc7100\u6beb\u79d2\u5462\u8fd8\u4e0d\u91ca\u653e\uff0c\u90a3\u4e48\u5c31\u5f3a\u5236\u91ca\u653e\uff0c\u9632\u6b62\u4e00\u76f4\u5360\u7740\u5751\u3002</p> <p>\u90a3\u4e48\u7ebf\u7a0b\u9694\u79bb\u673a\u5236\uff0c\u4e3b\u8981\u5e94\u5bf9\u7684\u662f\u8fd9\u4e2a\u5177\u4f53\u7684\u65b9\u6cd5\uff0c \u8fd9\u4e2a\u7ebf\u7a0b\u63a7\u5236\uff0c\u4e3b\u8981\u7684\u529f\u80fd\u3002 \u5c31\u662f\u5c06\u4e0d\u540c\u7684\u8fd9\u4e2a\u65b9\u6cd5\uff0c \u7528\u7ebf\u7a0b\u6c60\u9694\u79bb\u5f00\u3002\u9632\u6b62\u6709\u4e00\u4e9b\u8fd9\u4e2a\u8bf7\u6c42\u91cf\u8fc7\u5927\u7684\u65b9\u6cd5\uff0c \u8017\u5c3d\u6574\u4e2a\u7cfb\u7edf\u8d44\u6e90\u6765\u62d6\u57ae\u6574\u4e2a\u670d\u52a1\u4e2d\u5fc3</p>"},{"location":"chap7/int_anws/#11","title":"11 \u4fe1\u53f7\u91cf\u9694\u79bb","text":"<p>\u9664\u4e86\u7ebf\u7a0b\u6c60\u9694\u79bb\uff0c\u8fd8\u6709\u4e00\u79cd\u5e38\u89c1\u7684\u9694\u79bb\u65b9\u5f0f\u53eb\u4fe1\u53f7\u91cf\u9694\u79bb\u3002 \u53ef\u4ee5\u5bf9\u65b9\u6cd5\u7ea7\u63a5\u53e3\u673a\u7ea7\u505a\u8fd9\u4e2a\u9694\u79bb\u7684\uff0c\u4fe1\u53f7\u91cf\u9694\u79bb\u5f88\u7b80\u5355\u3002\u5c31\u662f\u8bbe\u7f6e\u4e00\u4e2a\u91cf\uff0c\u6bd4\u5982\u8bf41,000\uff0c\u8bf7\u6c42\u8fc7\u6765\u4e4b\u540e\u5c31\u53d6\u4e00\u4e2a\u4fe1\u53f7\u3002 \u62ff\u5230\u4fe1\u53f7\u5462\u624d\u53ef\u4ee5\u8bbf\u95ee\u4e0b\u6e38\u7684\u670d\u52a1\uff0c\u8bf7\u6c42\u5b8c\u6210\u4e4b\u540e\u5462\u5c31\u91ca\u653e\u4fe1\u53f7\u3002</p> <p>\u5982\u679c1000\u4e2a\u4fe1\u53f7\u540c\u65f6\u5168\u90e8\u5360\u6ee1\u4e86\uff0c \u90a3\u4e48\u518d\u6b21\u8fdb\u6765\u7684\u8bf7\u6c42\u5c31\u4f1a\u88ab\u62d2\u4e4b\u95e8\u5916\uff0c\u670d\u52a1\u5305\u4f1a\u76f4\u63a5\u7194\u65ad\u3002 \u964d\u7ea7\u7684\u65b9\u6cd5\uff0cgetfallback\uff0c \u63d0\u793a\u4e1a\u52a1\u5e2e\u5fd9\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002</p> <p>\u4e0e\u7ebf\u7a0b\u9694\u79bb\u7684\u533a\u522b</p> <p>\u7ebf\u7a0b\u6c60\u9694\u79bb\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u91cd\u3002 \u5c5e\u4e8e\u5bf9\u8fd9\u4e2a\u5355\u4e2a\u7684\u65b9\u6cd5\uff0c\u4e13\u95e8\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u9694\u79bb\u7ebf\u7a0b\u6c60\u3002 \u5bf9\u4e00\u4e9b\u8fd9\u4e2a\u67e5\u8be2\u91cf\u6bd4\u8f83\u5927\uff0c\u8ba1\u7b97\u6bd4\u8f83\u590d\u6742\u7684\u65b9\u6cd5\u6765\u4f7f\u7528\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u6709\u5145\u8db3\u7684\u7ebf\u7a0b\uff0c\u6765\u4fdd\u969c\u4e1a\u52a1\u7684\u8fd0\u884c\u662f\u5c5e\u4e8e\u8fd9\u4e2a\u5f02\u6b65\u7684\u5904\u7406\u65b9\u5f0f\uff0c\u800c\u4e14\u8bbe\u6709\u8fd9\u4e2a\u8d85\u65f6\u65f6\u95f4\uff0c\u8fc7\u671f\u5c31\u76f4\u63a5\u91ca\u653e\u7ebf\u7a0b</p> <p>\u800c\u4fe1\u53f7\u91cf\u5c31\u4e0d\u7136\u4e86\uff0c \u5b83\u5c5e\u4e8e\u8fd9\u4e2a\u8f7b\u91cf\u7ea7\u7684\u8ba1\u6570\u5668\uff0c \u800c\u4e14\u662f\u540c\u6b65\u7684\u5904\u7406\u65b9\u5f0f\u3002 \u5982\u679c\u9488\u5bf9\u4e00\u4e9b\u8ba1\u7b97\u91cf\u6bd4\u8f83\u5927\uff0c \u67e5\u8be2\u91cf\u6bd4\u8f83\u5927\u7684\u8fd9\u4e2a\u65b9\u6cd5\uff0c \u6216\u8005\u8bf4\u6bd4\u8f83\u8017\u65f6\u7684\u4e00\u4e9b\u65b9\u6cd5\u3002 \u5c31\u4f1a\u6709\u5f88\u591a\u7684\u4fe1\u53f7\u91cf\u88ab\u5360\u7528\uff0c\u5c31\u4f1a\u5f88\u5feb\u53d1\u751f\u7194\u65ad\u3002 \u4e0d\u592a\u9002\u5408</p> <p>\u6240\u4ee5\u9488\u5bf9\u4fe1\u53f7\u91cf\u7684\u9694\u79bb\u4f7f\u7528\uff0c\u6bd4\u8f83\u9002\u5408\u4e00\u4e9b\u6bd4\u8f83\u8f7b\u91cf\u7684\u67e5\u8be2\u3002 \u6216\u8005\u63a5\u53e3\u8fd4\u56de\u6bd4\u8f83\u5feb\u7684\u63a5\u53e3\uff0c\u6bd4\u5982\u8bf4redis\u67e5\u8be2\uff0c \u6216\u8005\u5904\u7406\u4e00\u4e9b\u8ba1\u7b97\u91cf\u6bd4\u8f83\u5c0f\u7684\u4e1a\u52a1\uff0c\u80fd\u591f\u5feb\u901f\u7684\u91ca\u653e\u8fd9\u4e2a\u4fe1\u53f7\u91cf\uff0c\u8ba9\u66f4\u591a\u7684\u8bf7\u6c42\u8fdb\u6765\u554a\uff0c\u4e5f\u80fd\u591f\u7b26\u5408\u5927\u5e76\u53d1\u7684\u8fd9\u4e2a\u8981\u6c42\u3002 </p> <p>\u73b0\u5728\u6709\u5f88\u591a\u7684\u7ec4\u4ef6\uff0c\u5728\u9694\u79bb\u65b9\u9762\u90fd\u505a\u7684\u4e0d\u9519\u3002 \u5305\u62ecSpring cloud\u7684hystrix\uff0c sentinel, \u4e5f\u90fd\u652f\u6301\u4fe1\u53f7\u91cf\u7684\u9694\u79bb\u6216\u8005\u662f\u7ebf\u7a0b\u6c60\u7684\u9694\u79bb. \u53e6\u5916\u4fe1\u53f7\u91cf\u7684\u9694\u79bb\u673a\u5236\u9664\u4e86\u65b9\u6cd5\u7ea7\u4ee5\u5916, \u8fd8\u6709\u5728\u8fd9\u4e2a\u7f51\u5173\u5c42\u7528\u7684, zuul &amp; gateway\u7f51\u5173\u3002 \u5c31\u662f\u76f4\u63a5\u5728\u7f51\u5173\u5c42, \u5bf9\u8bf7\u6c42\u91cf\u505a\u4e86\u4fe1\u53f7\u91cf\u7684\u9694\u79bb. </p> <p>\u9488\u5bf9\u4e0d\u540c\u7684\u573a\u666f, \u9488\u5bf9\u4e0d\u540c\u7684\u8fd9\u4e2a\u670d\u52a1\u4e2d\u5fc3, \u6bd4\u5982\u7528\u6237\u4e2d\u5fc3\u5546\u57ce\u4e2d\u5fc3,\u8ba2\u5355\u4e2d\u5fc3, \u5c31\u53ef\u4ee5\u5206\u914d\u4e0d\u540c\u7684\u6570\u91cf\u7684\u8fd9\u4e2a\u4fe1\u53f7\u91cf</p>"},{"location":"chap7/int_anws/#12","title":"12 \u5982\u4f55\u5b9e\u73b0\u5206\u5e03\u5f0f\u4e8b\u52a1\uff1f","text":"<p>\u53ea\u8981\u6d89\u53ca\u5230\u4ea4\u6613\uff0c\u5c31\u9700\u8981\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u4fdd\u8bc1\u8981\u4e48\u5168\u90e8\u6210\u529f\uff0c\u8981\u4e48\u5168\u90e8\u5931\u8d25\uff0c\u6d89\u53ca\u5230\u591a\u4e2a\u5e93\uff0c\u90a3\u4e48\u5c31\u4e00\u5b9a\u7ed5\u4e0d\u5f00\u5206\u5e03\u5f0f\u4e8b\u52a1\u3002</p> <p>\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u4e3b\u6d41\u7684\u5b9e\u73b0\u65b9\u5f0f\u5176\u5b9e\u5c31\u4e24\u79cd</p> <ul> <li>\u4e00\u79cd\u662f\u57fa\u4e8exa\u534f\u8bae\uff0c xa\u534f\u8bae\u7684\u539f\u7406\u5176\u5b9e\u5c31\u662f\u4e24\u9636\u6bb5\u63d0\u4ea4\u3002\u800c\u4e14\u4f9d\u8d56\u6570\u636e\u5e93\u672c\u8eab\u7684\u4e8b\u52a1\uff0c\u5728\u4e8b\u52a1\u5f00\u59cb\u4e4b\u540e\uff0c\u4e8b\u52a1\u7ba1\u7406\u5668\u5148\u8be2\u95ee\u5404\u4e2a\u6570\u636e\u5e93\u51c6\u5907\u597d\u4e86\u5417\uff0c\u5982\u679c\u6bcf\u4e2a\u6570\u636e\u5e93\u90fd\u56de\u590dOK\uff0c\u90a3\u4e48\u5c31\u6b63\u5f0f\u63d0\u4ea4\u4e8b\u52a1\uff0c\u5728\u5404\u4e2a\u6570\u636e\u5e93\u4e0a\u9762\u6765\u6267\u884c\u64cd\u4f5c\uff0c\u5982\u679c\u6709\u4efb\u4f55\u4e00\u4e2a\u6570\u636e\u5e93\u56de\u7b54\u4e0dOK\uff0c\u90a3\u4e48\u5c31\u56de\u6eda\u4e8b\u52a1</li> <li>\u4e00\u79cd\u662f\u57fa\u4e8ettc\uff0ctcc\u5176\u5b9e\u8ddfxa\u534f\u8bae\u6bd4\u8f83\u5927\u7684\u533a\u522b\u3002\u5c31\u662f\u4e0d\u9700\u8981\u4f9d\u8d56\u6570\u636e\u5e93\u7684\u4e8b\u52a1\u91c7\u7528\u7684\u662f\u8865\u507f\u673a\u5236\u6765\u5904\u7406\u6570\u636e\u7684\u4e00\u81f4\u6027\u95ee\u9898\u3002<ul> <li>\u67093\u4e2a\u9636\u6bb5\uff0c\u4e00\u4e2a\u662ftry\uff0c\u4e00\u4e2aconfirm\uff0c\u4e00\u4e2a\u662fcancel</li> <li>try\u8fd9\u4e2a\u9636\u6bb5\uff0c\u5bf9\u4e8e\u4e1a\u52a1\u7cfb\u7edf\uff0c\u662f\u505a\u4e86\u68c0\u6d4b\u548c\u8d44\u6e90\u9884\u7559\u7684\u4f5c\u7528\uff0c\u6bd4\u5982\u5728\u4ea4\u6613\u7cfb\u7edf\u4e2d\u554a\u8981\u62b5\u6263\u7684\u79ef\u5206\uff0c\u5c31\u5148\u901a\u8fc7\u4e1a\u52a1\u4ee3\u7801\u5148\u51bb\u7ed3\u3002 \u7136\u540e\u5728confirm\u9636\u6bb5\uff0c\u4e3b\u8981\u5c31\u662f\u5bf9\u8fd9\u4e2a\u4e1a\u52a1\u7cfb\u7edf\u505a\u786e\u8ba4\u63d0\u4ea4</li> <li>\u90a3\u4e48\u5982\u679c\u9047\u5230\u9519\u8bef\uff0c\u5c31\u9700\u8981\u76f4\u63a5\u56de\u6eda\uff0c\u4e4b\u524d\u51bb\u7ed3\u7684\u79ef\u5206\u5c31\u76f4\u63a5\u91ca\u653e\u4e86</li> <li>tcc\u4ee3\u7801\u7684\u4fb5\u5165\u6027\u6bd4\u8f83\u5f3a\uff0c \u6bcf\u4e2a\u9636\u6bb5\u90fd\u9700\u8981\u4e1a\u52a1\u4ee3\u7801\u6765\u5b9e\u73b0\uff0c\u56e0\u4e3a\u4e0d\u4f9d\u8d56\u6570\u636e\u5e93\u7684\u4e8b\u52a1\uff0c\u56de\u6eda\u662f\u9700\u8981\u901a\u8fc7\u8865\u507f\u673a\u5236\u6765\u5b9e\u73b0\u7684\uff0c\u6bd4\u5982\u8bf4\u652f\u4ed8\u5931\u8d25\uff0c\u5c31\u9700\u8981\u8fd4\u8fd8\u4e4b\u524d\u6263\u9664\u7684\u79ef\u5206</li> <li>\u53d1\u9001\u8fd9\u4e2a\u6d88\u606f\u8fd9\u4e2a\u79ef\u5206\u4e2d\u5fc3\uff0c\u8ba9\u79ef\u5206\u4e2d\u5fc3\u901a\u8fc7\u4e1a\u52a1\u4ee3\u7801\u6765\u5904\u7406\u79ef\u5206\u7684\u8fd4\u8fd8\u3002</li> </ul> </li> </ul> <p>tcc\u5728\u5206\u5e03\u5f0f\u67b6\u6784\u4e0b\u7528\u7684\u66f4\u591a\u4e00\u4e9b\uff0c \u4e0d\u50cfxa\u90a3\u6837\u5360\u6709\u592a\u957f\u65f6\u95f4\u3002 \u8fd9\u4e2a\u6570\u636e\u5e93\u8d44\u6e90\uff0c \u6240\u4ee5\u5728\u6027\u80fd\u4e0a\u9762\u8981\u7a0d\u5fae\u4f18\u79c0\u4e00\u4e9b\u3002 </p> <p>\u5f53\u7136\u9664\u4e86xa, tcc\u8fd8\u6709\u5229\u7528\u8fd9\u4e2a\u6d88\u606f\u961f\u5217\u505a\u4e8b\u52a1. \u5148\u53d1\u8fd9\u4e2a\u534a\u6d88\u606f\u7136\u540e\u6267\u884c\u4e3b\u4e1a\u52a1. \u6210\u529f\u4e4b\u540e, \u534a\u6d88\u606f\u5c31\u8f6c\u6210\u6b63\u5e38\u6d88\u606f\u6765\u8fdb\u884c\u6d88\u8d39</p>"},{"location":"chap7/int_anws/#13","title":"13 \u5206\u5e03\u5f0f\u7cfb\u7d71\u4e0b \u5546\u57ce\u79d2\u6740\u7cfb\u7ed5\u7684\u8bbe\u8ba1\u601d\u8def","text":"<p>\u600e\u4e48\u8bbe\u8ba1\u4e00\u5957\u65e2\u80fd\u591f\u6ee1\u8db3\u65e5\u5e38\u7684\u4ea4\u6613\uff0c\u53c8\u80fd\u591f\u625b\u4f4f\u9ad8\u5e76\u53d1\u7684\u5999\u6740\u7cfb\u7edf\u3002</p> <p>\u90a3\u4e48\u5e76\u53d1\u91cf\u4e00\u65e6\u4e0a\u6765\uff0c\u63a5\u53e3\uff0c\u6570\u636e\u5e93\u53ef\u80fd\u5c31\u4f1a\u8fbe\u5230\u74f6\u9888\u3002</p> <ul> <li>\u5546\u57ce\u7684\u8be6\u60c5\u9875\u9762</li> </ul> <p>\u4e00\u5b9a\u8981\u505a\u4f18\u5316,  \u7f51\u9875\u7248\u7684\u8981\u5c3d\u91cf\u7684\u9759\u6001\u5316, \u521d\u59cb\u5316\u9875\u9762\u7684\u8fc7\u7a0b\u4e2d, \u5c3d\u91cf\u4e0d\u8981\u8c03\u63a5\u53e3, \u5982\u679c\u6ca1\u6cd5\u9759\u6001\u5316. \u9875\u9762\u4e5f\u8981\u505a\u597d\u7f13\u5b58.</p> <p>\u628a\u5546\u54c1\u7684\u8be6\u60c5, \u4ecb\u7ecd\u90fd\u7f13\u5b58\u5230 redis \u91cc\u9762.  \u6bd4\u8f83\u7a33\u59a5\u7684\u65b9\u5f0f, \u662f\u518d\u505a\u964d\u7ea7\u5904\u7406. \u9632\u6b62redis \u51fa\u73b0\u6545\u969c,  \u6bd4\u5982\u8bf4\u51fb\u7a7f,\u96ea\u5d29. \u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u8bfb\u53d6\u672c\u5730\u7f13\u5b58. </p> <p>\u53e6\u5916\u8be6\u60c5\u9875\u6d89\u53ca\u5230\u7684\u56fe\u7247, \u56fe\u7247\u53c8\u662f\u6bd4\u8f83\u8017\u8d44\u6e90\u7684. \u6240\u4ee5\u8981\u628a\u5b83\u6254\u5230\u72ec\u7acb\u7684\u8fd9\u4e2a\u6587\u4ef6\u670d\u52a1\u5668\u4e0a\u9762.  \u9632\u6b62\u8fd9\u4e9b\u56fe\u7247\u62c9\u53d6\uff0c\u5360\u6ee1\u5e26\u5bbd. \u4f1a\u5f71\u54cd\u5230\u9875\u9762\u7684\u8bbf\u95ee, \u4e00\u822c\u5462\u90fd\u662f\u6254\u5230\u8fd9\u4e2aCDN, \u8fb9\u7f18\u8ba1\u7b97</p> <ul> <li>\u79d2\u6740\u6a21\u5757</li> </ul> <p>\u9875\u9762\u7ea7\u7684\u9650\u6d41\uff0c \u6bd4\u5982\u8bf4\u9650\u5236\u6309\u94ae\u7684\u70b9\u51fb\u6b21\u6570\u3002 \u670d\u52a1\u5668\u7aef\u4e5f\u5fc5\u987b\u505a\u597d\u9650\u6d41\uff0c \u4e00\u822c\u5c31\u662f\u5728\u7f51\u5173\u5c42\uff0c \u91c7\u7528\u4e00\u4e9b\u9650\u6d41\u7b97\u6cd5, \u6bd4\u5982\u8bf4\u4ee4\u724c\u6876,\u6f0f\u6876.  \u90a3\u4e48\u89c4\u5b9a\u7684\u65f6\u95f4\u5468\u671f, \u653e\u4e00\u5b9a\u7684\u6d41\u91cf\u8fdb\u6765.</p> <p>\u5176\u4f59\u7684\u6d41\u91cf, \u76f4\u63a5\u8fd4\u56de\u7f51\u7edc\u7e41\u5fd9\u8bf7\u7a0d\u540e\u518d\u8bd5. \u7136\u540e\u5728\u5546\u57ce\u7684\u8d2d\u4e70\u63a5\u53e3\u4e0a\u9762,\u4e5f\u8981\u505a\u597d\u7194\u65ad. \u56e0\u4e3a\u6d41\u91cf\u5927, \u5c31\u4f1a\u51fa\u73b0\u5f88\u591a\u7684\u8bbf\u95ee\u5931\u8d25, \u5f53\u8bbf\u95ee\u6b21\u6570\u8fbe\u5230\u4e00\u5b9a\u7684\u570b\u503c. \u5c31\u8981\u5f00\u542f\u8fd9\u4e2a\u7194\u65ad\u673a\u5236, \u76f4\u63a5\u62d2\u7edd\u6240\u6709\u7684\u670d\u52a1</p> <p>\u7b49\u6062\u590d\uff0c\u6b63\u5e38\u4e4b\u540e. \u518d\u91cd\u65b0\u5f00\u542f\u4f1a\u5168\u90e8\u8d70\u8fd9\u4e2a\u964d\u7ea7\u65b9\u6cd5, \u8bf7\u7a0d\u540e\u518d\u8bd5.</p> <p>\u8fd9\u6837\u4e00\u6765\u5462\u5728\u670d\u52a1\u7aef\u7684\u53ef\u7528\u6027, \u5c31\u4e0d\u7528\u8fc7\u4e8e\u62c5\u5fc3\u4e86. \u7cfb\u7edf\u4e0d\u4f1a\u8f7b\u6613\u7684\u88ab\u6d41\u91cf\u51b2\u57ae</p> <ul> <li>\u5546\u54c1\u8d2d\u4e70</li> </ul> <p>\u6bd4\u8f83\u5bb9\u6613\u51fa\u4e8b\u6545\u5c31\u662f\u5e93\u5b58\u7684\u6263\u51cf, \u5c31\u8981\u505a\u597d\u6263\u51cf\u73af\u8282\u7684\u539f\u5b50\u6027, \u5e38\u89c1\u7684\u5c31\u662f\u91c7\u7528\u5206\u5e03\u5f0f\u9501,  \u57fa\u4e8eredis, zookeeper, \u4e5f\u53ef\u4ee5\u91c7\u7528\u4e00\u4e9b\u6570\u636e\u5e93\u7684\u89e6\u53d1\u5668. \u8d85\u8fc7\u4e86\u5e93\u5b58\u5462</p>"},{"location":"chap7/int_anws/#14-id","title":"14 \u804a\u804a\u5206\u5e03\u5f0fID\u751f\u6210\u65b9\u6848","text":"<p>\u5728\u591a\u5e93\u591a\u8868\u7684\u60c5\u51b5\u4e0b\u9762\uff0c\u7b80\u5355\u7684\u5229\u7528\u6570\u636e\u5e93\u7684\u81ea\u589e\uff0c\u4f1a\u51fa\u73b0\u5927\u9762\u79ef\u7684ID\u91cd\u590d\u3002 \u53ef\u4ee5\u57fa\u4e8e\u6570\u636e\u5e93\u7684\u81ea\u589eID\uff0c \u505a\u4e2a\u6539\u9020\u554a\uff0c\u6bd4\u5982\u8bf4a\u8868135\uff0cb\u8868246\uff0c\u9519\u5f00\u9012\u589e\u3002 \u8fd9\u4e2a\u65b9\u6848\u8fd8\u662f\u4f9d\u8d56\u6570\u636e\u5e93\u7684\u81ea\u589e\u5c5e\u6027\uff0c\u4e5f\u65e0\u9700\u989d\u5916\u7684\u4fb5\u5165\u4ee3\u7801\u3002\u4e0d\u8db3\u7684\u5730\u65b9\u5c31\u662f\u5728\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u52a0\u5165\u4e86\u65b0\u7684\u8868\uff0c\u81ea\u589eID\u9700\u8981\u91cd\u65b0\u5206\u914d\u3002 </p> <p>\u96ea\u82b1\u7b97\u6cd5</p> <p>\u6bd4\u8f83\u597d\u7684\u65b9\u5f0f\u5c31\u662f\u6839\u636e\u4e1a\u52a1\u91cf\u591a\u5efa\u8868\uff0c\u5176\u5b9e\u5206\u5e03\u5f0fID\u3002\u516c\u8ba4\u65b9\u6848\u662f\u91c7\u7528snowflake\u7684\u96ea\u82b1\u7b97\u6cd5. \u4ed6\u7684\u6838\u5fc3\u662f\u7531\u4e09\u90e8\u5206\u7ec4\u6210, \u4e00\u4e2a\u662f\u65f6\u95f4\u6233\u4ee3\u8868\u5f53\u524d\u7684\u65f6\u95f4, \u4e00\u4e2a\u662f\u673a\u5668\u7801\u4ee3\u8868\u751f\u6210ID\u7684\u673a\u5668, \u4e00\u4e2a\u662f\u5e8f\u5217\u53f7\uff0c\u9012\u589e\u4e86\u4e00\u4e32\u6570\u5b57. </p> <p>\u90a3\u4e48\u540c\u4e00\u4e2a\u673a\u5668\u540c\u4e00\u6beb\u79d2\u5e8f\u5217\u53f7\u662f\u8fde\u7eed\u7684,\u81ea\u589e\u7801\u653e\u5728\u5185\u5b58\u91cc\u9762. \u540c\u4e00\u6beb\u79d2\u6309\u90e8\u5c31\u73ed, \u90a3\u4e48\u4e0b\u4e00\u6beb\u79d2\u518d\u91cd\u65b0\u8ba1\u7b97\u554a</p> <p>\u96ea\u82b1\u7b97\u6cd5\u5462\u53ef\u80fd\u4f1a\u51fa\u95ee\u9898\u7684\u5730\u65b9: </p> <p>\u5c31\u662f\u8fd9\u4e2a\u65f6\u95f4\u6233\u7684\u95ee\u9898, \u56e0\u4e3a\u4f9d\u8d56\u65f6\u95f4\u6233. \u5c31\u6709\u53ef\u80fd\u751f\u6210\u91cd\u590d\u7684id, \u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u5e38\u8bf4\u7684\u65f6\u95f4\u56de\u62e8\u95ee\u9898,\u5f53\u7136\u8fd9\u79cd\u60c5\u6cc1\u5f88\u5c11. \u670d\u52a1\u5668\u7684\u65f6\u95f4\u4e00\u822c\u4e0d\u4f1a\u8f7b\u6613\u52a8, </p>"},{"location":"chap7/int_anws/#15_1","title":"15 \u804a\u804a\u5206\u5e03\u5f0f\u4e0b\u7684\u94fe\u8def\u8ffd\u8e2a\u7cfb\u7edf","text":"<p>\u5bf9\u4e8e\u5206\u5e03\u5f0f\u67b6\u6784\u4e0b\u9762, \u6d89\u53ca\u5230\u591a\u4e2a\u5fae\u670d\u52a1\u7684\u6a21\u5757. \u6bd4\u5982\u8bf4\u7528\u6237\u4e2d\u5fc3, \u5546\u57ce\u4e2d\u5fc3, \u8ba2\u5355\u4e2d\u5fc3\u7b49\u7b49. \u5f7c\u6b64\u4e4b\u95f4\u5462\u76f8\u4e92\u72ec\u7acb, \u53c8\u6709\u590d\u6742\u7684\u5173\u8054\u8c03\u7528, \u6bcf\u4e00\u4e2a\u6a21\u5757\u53c8\u6d89\u53ca\u5230\u4e86\u8d1f\u8f7d\u5747\u8861, \u5b9a\u4f4d\u5230\u5177\u4f53\u662f\u67d0\u4e00\u4e2a\u6a21\u5757\u51fa\u7684\u95ee\u9898. </p> <p>\u6574\u4e2a\u7684\u4e0b\u5355\u5c31\u6d89\u53ca\u5230\u4e86\u5546\u57ce\u4e2d\u5fc3, \u7528\u6237\u4e2d\u5fc3, \u79ef\u5206\u4e2d\u5fc3,\u8ba2\u5355\u4e2d\u5fc3, \u4ed3\u50a8\u4e2d\u5fc35\u4e2a\u6a21\u5757. \u6574\u4e2a\u4e0b\u5355\u63a5\u53e3, \u5c31\u6d89\u53ca\u5230\u4e86\u4e94\u4e2a\u6a21\u5757. \u5f88\u96be\u5c31\u53d1\u73b0\u5177\u4f53\u67d0\u4e00\u4e2a\u6a21\u5757\u51fa\u4e86\u95ee\u9898, \u56e0\u4e3a\u7ebf\u4e0a\u7684\u65e5\u5fd7\u4e0d\u505c\u7684\u5728\u5237, \u8981\u627e\u5230\u5177\u4f53\u7684\u67d0\u4e00\u4e2a\u65e5\u5fd7\u76f8\u5bf9\u6765\u8bb2\u8fd8\u662f\u6bd4\u8f83\u56f0\u96be\u7684.</p> <p>\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2aelk\u5206\u5e03\u5f0f\u7684\u65e5\u5fd7\u7cfb\u7edf\u6765\u6c47\u603b\u65e5\u5fd7, \u4e2d\u4e2d\u95f4\u8fd8\u5939\u6742\u4e86\u5f88\u591a\u5176\u4ed6\u63a5\u53e3\u7684\u65e5\u5fd7. \u5c31\u4e0d\u5f97\u4e0d\u5229\u7528\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0b\u7684\u94fe\u8def\u8ffd\u8e2a\u7cfb\u7edf\u6765\u89e3\u51b3\u8fd9\u4e9b\u75db\u70b9</p> <p>\u8fd9\u4e2a\u7cfb\u7edf\u7684\u4e3b\u8981\u4efb\u52a1\uff0c\u5c31\u662f\u6536\u96c6\u5404\u4e2a\u670d\u52a1\u7684\u65e5\u5fd7\u4e0a\u62a5\u65e5\u5fd7\u5206\u6790\u65e5\u5fd7\u4fdd\u5b58\u5c55\u793a\u3002 \u5173\u952e\u7684\u6838\u5fc3\u5c31\u5728\u4e8e\u8fd9\u4e2a\u8c03\u7528\uff0c\u4e3a\u6bcf\u4e00\u4e2a\u8bf7\u6c42\u751f\u6210\u4e86\u8fd9\u4e2a\u5168\u5c40\u7684ID\uff0ctraceId, \u5c06\u4e0d\u540c\u7cfb\u7edf\u539f\u5148\u662f\u5b64\u7acb\u7684\u72b6\u6001. \u628a\u5b83\u5b64\u7acb\u7684\u8fd9\u4e9b\u4fe1\u606f,\u8c03\u7528\u7684\u4fe1\u606f\u5173\u8054\u5728\u4e00\u8d77\u8fd8\u539f\u51fa\u66f4\u591a\u6709\u4ef7\u503c\u7684\u6570\u636e, \u5148\u8c03\u7528\u4e86\u5565\u540e\u8c03\u7528\u4e86\u5565, \u6bcf\u4e00\u4e2a\u6a21\u5757\u8c03\u7528\u82b1\u8d39\u4e86\u591a\u957f\u65f6\u95f4, \u6bcf\u4e00\u4e2a\u6a21\u5757\u8c03\u7528\u82b1\u8d39\u4e86\u591a\u957f\u65f6\u95f4, \u6210\u529f\u8fd8\u662f\u5931\u8d25,\u90fd\u53ef\u4ee5\u901a\u8fc7\u754c\u9762\u53ef\u89c6\u5316\u5c55\u793a\u51fa\u6765.  \u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662f\u50cf\u8fd9\u4e2azipkin</p>"},{"location":"chap7/int_anws/#16","title":"16 \u804a\u804a\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0b\u7684 \u9274\u6743\u8ba4\u8bc1\u65b9\u6848","text":"<p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0b\u9762\uff0c\u6574\u4e2a\u670d\u52a1\u5c31\u4f1a\u5206\u5272\u6210\u4e86\u5f88\u591a\u5c0f\u6a21\u5757\uff0c\u53c8\u53eb\u505a\u8fd9\u4e2a\u5fae\u670d\u52a1\u3002 \u90a3\u6bd4\u5982\u8bf4\u50cf\u7528\u6237\u4e2d\u5fc3\uff0c\u8bfe\u7a0b\u4e2d\u5fc3\uff0c\u5546\u57ce\u4e2d\u5fc3\uff0c\u901a\u77e5\u4e2d\u5fc3\uff0c\u7269\u6d41\u4e2d\u5fc3\u7b49\u7b49\u597d\u591a\u6a21\u5757\u3002 </p> <p>\u90a3\u4e48\u6bcf\u4e00\u4e2a\u6a21\u5757\uff0c\u53ef\u80fd\u90fd\u9700\u8981\u505a\u9274\u6743\uff0c\u90fd\u8981\u505a\u8ba4\u8bc1\u3002 \u6240\u4ee5\u5c31\u8feb\u5207\u9700\u8981\u6709\u4e00\u5957\u7edf\u4e00\u7684\u5bf9\u5916\u9274\u6743\u7684\u8ba4\u8bc1\u7684\u4e2d\u5fc3\u3002\u9700\u8981\u6ee1\u8db3\u4e00\u4e2a\u5730\u65b9\u767b\u5f55\uff0c\u7136\u540e\u6240\u6709\u7684\u5730\u65b9\u90fd\u80fd\u53bb\u540c\u6b65\u4f7f\u7528\uff0c \u6574\u4e2a\u670d\u52a1\u7aef\u7684\u5b58\u50a8\u65b9\u9762\u4e5f\u662f\u4e2a\u95ee\u9898\uff0c \u90fd\u662f\u57fa\u4e8e\u8fd9\u4e2atoken\u7684\u65b9\u5f0f\uff0c \u6765\u5bf9\u5916\u63d0\u4f9b\u8fd9\u4e2a\u9274\u6743\u548c\u8ba4\u8bc1\u670d\u52a1\u7684\u3002 </p> <p>\u90a3\u4e48\u5b9e\u73b0\u7684\u539f\u7406\u5176\u5b9e\u4e5f\u5f88\u7b80\u5355\uff0c \u7528\u6237\u767b\u5f55\u7684\u65f6\u5019\u3002 \u77ed\u4fe1\u9a8c\u8bc1\u7801\u6216\u8005\u662f\u8d26\u53f7\u5bc6\u7801\uff0c\u8ba4\u8bc1\u901a\u8fc7\u63a5\u53e3\u5c31\u4f1a\u751f\u6210\u4e00\u4e2atoken\uff0c\u90a3\u4e48\u5176\u5b9e\u5c31\u662f\u5b57\u7b26\u4e32\u5bf9\u3002\u7136\u540e\u670d\u52a1\u7aef\u8981\u628a\u8fd9\u4e2atoken\u5b58\u8d77\u6765\uff0c \u90a3\u4e48\u4e00\u822c\u4e5f\u90fd\u662f\u653e\u5728\u7684\u5206\u5e03\u5f0f\u7f13\u5b58redis, \u6709\u4e00\u5b9a\u7684\u8fd9\u4e2a\u6709\u6548\u671f. </p> <p>\u6709\u6548\u671f\u5185, \u6240\u6709\u7684\u8fd9\u4e2a\u6a21\u5757\u7684\u9274\u6743\u8bbf\u95ee, \u53ef\u4ee5\u4eceredis\u91cc\u9762\u6765\u83b7\u53d6\u5230token, \u5982\u679c\u5b58\u5728\u5c31\u8bf4\u660e\u8ba4\u8bc1\u6210\u529f. \u5982\u679c\u4e0d\u5b58\u5728\u5c31\u8bf4\u660e\u4ed6\u5df2\u7ecf\u5931\u6548\u4e86, \u662f\u4e00\u4e2a\u975e\u6cd5\u8bf7\u6c42, \u90a3\u4e48\u5bf9\u4e8e\u524d\u7aef\u9700\u8981\u628a\u8ba4\u8bc1\u8fd4\u56de\u7684token\u4fdd\u5b58\u5728\u672c\u5730. </p> <p>\u5176\u4ed6\u63a5\u53e3\u8bf7\u6c42\u7684\u65f6\u5019, \u4f1a\u5e26\u4e0a\u8fd9\u4e2atoken, \u5f53\u7136\u4e5f\u53ef\u4ee5\u585e\u5230header\u91cc\u9762, \u6548\u679c\u90fd\u662f\u4e00\u6837\u7684. \u90a3\u4e48\u57fa\u4e8etoken\u6a21\u5f0f, \u4e00\u822c\u4e5f\u90fd\u662f\u91c7\u7528\u8fd9\u4e2aspring oauth2\u7684\u9274\u6743\u65b9\u6848, \u90a3\u4e48\u9664\u4e86\u8d26\u6237\u5bc6\u7801\u8fd8\u6709\u9a8c\u8bc1\u7801\uff0c\u5fae\u4fe1\u4e00\u952e\u767b\u5f55\u3002 \u4e00\u4e2a\u4eba\u53ef\u80fd\u4f1a\u6709\u4e09\u56db\u79cd\u8fd9\u4e2a\u8ba4\u8bc1\u65b9\u5f0f\uff0c \u751f\u6210\u4e00\u4e2a\u5168\u5c40\u7684\u8fd9\u4e2atoken\uff0c\u53e6\u5916token\u7684\u751f\u4ea7\u65b9\u5f0f\u4e5f\u6709\u51e0\u79cd\u3002</p> <ul> <li>\u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662fJWT\uff0c json web token\uff0c\u91cc\u9762\u5b58\u50a8\u4e86\u4e00\u5927\u5806\u7684\u7528\u6237\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u52a0\u5bc6\u5b58\u50a8\uff0c \u597d\u5904\u662f\u4e0d\u9700\u8981\u518d\u53bb\u67e5\u6570\u636e\u5e93\u4e86\u3002 \u53ef\u4ee5\u76f4\u63a5\u4ece\u8fd9\u4e2a\uff0ctoken\u91cc\u9762\u5c31\u53ef\u80fd\u89e3\u6790\u51fa\u7528\u6237\u7684\u4fe1\u606f\uff0c\u4e0d\u597d\u7684\u5730\u65b9\u5c31\u662f\u8fd9\u4e2a\u5b57\u7b26\u4e32\u592a\u957f\u4e86\uff0c\u4f20\u6765\u4f20\u53bb\u4e5f\u5f71\u54cd\u6211\u4eec\u7684\u8fd9\u4e2a\u7f51\u7edcIO</li> <li>\u6211\u4eec\u4e00\u822c\u7528\u7684\u5176\u5b9e\u90fd\u662f\u91c7\u7528\u8fd9\u4e2auuid\u6765\u751f\u6210</li> </ul>"},{"location":"chap7/int_anws/#17","title":"17 \u5fae\u670d\u52a1\u7684\u62c6\u5206","text":"<ul> <li>\u4e00\u4e2a\u5c31\u662f\u57fa\u4e8e\u8fd9\u4e2a\u4e1a\u52a1\u7684\u5212\u5206\uff0c \u5c31\u6309\u7167\u63d0\u4f9b\u670d\u52a1\u5185\u5bb9\u7684\u4e0d\u540c\uff0c\u9ad8\u5185\u805a\u4f4e\u5076\u548c</li> <li>\u57fa\u4e8e\u8fd9\u4e2a\u8d44\u6e90\u9700\u6c42\u7684\u62c6\u5206\uff0c\u8fd9\u4e2a\u6a21\u5757\u8bbf\u95ee\u91cf\u5927\u4e0d\u5927\u3002 \u8bbf\u95ee\u91cf\u5927\u7684\u8981\u8ddf\u8bbf\u95ee\u91cf\u5c0f\u505a\u4e00\u4e2a\u533a\u5206\uff0c</li> <li>\u6f14\u8fdb\u5f0f\u7684\u62c6\u5206\uff0c\u5c31\u662f\u4e00\u5f00\u59cb\u62c6\u5206\u7684\u8fd9\u4e2a\u7c92\u5ea6\u4e0d\u7528\u592a\u5927\uff0c\u5148\u653e\u5728\u4e00\u8d77\uff0c\u8d70\u4e00\u6b65\u770b\u4e00\u6b65\uff0c\u91cf\u4e0a\u6765\u4e4b\u540e\u518d\u53bb\u505a\u62c6\u5206</li> </ul>"},{"location":"chap7/int_anws/#18","title":"18 \u5982\u4f55\u89e3\u6c7a\u5206\u5e03\u5f0f\u9501\u7684\u6b7b\u9501\u95ee\u9898","text":"<p>\u5206\u5e03\u5f0f\u6240\u9501\u76ee\u524d\u7528\u7684\u6bd4\u8f83\u591a\u3002\u53ea\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u6765\u8bbf\u95ee\u8d44\u6e90\uff0c\u53ea\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u6765\u8bbf\u95ee\u8d44\u6e90\u3002 </p> <p>\u5e26\u6765\u4e86\u5f88\u591a\u65b0\u7684\u95ee\u9898\uff0c\u6bd4\u5982\u8bf4\u8fd9\u4e2a\u6b7b\u9501\u95ee\u9898\u3002\u5e38\u89c1\u7684\u573a\u666f\u6bd4\u5982\u8bf4\u52a0\u9501\uff0c \u4f46\u662f\u6ca1\u6709\u7a0b\u5e8f\u53bb\u91ca\u653e\u9501\uff0c \u4e00\u76f4\u5360\u7528\u554a\u5c31\u4ea7\u751f\u4e86\u6b7b\u9501</p> <p>\u8fd8\u6709\u867d\u7136\u5199\u4e86\u7a0b\u5e8f\u662f\u91ca\u653e\u9501\uff0c\u4f46\u662f\u52a0\u9501\u4e4b\u540e\uff0c\u7a0b\u5e8f\u6302\u4e86\u554a\u4e5f\u4ea7\u751f\u4e86\u6b7b\u9501\u3002</p> <p>\u8fd8\u6709\u52a0\u9501\u7684\u65f6\u5019\u539f\u5b50\u6027\u7684\u95ee\u9898\uff0c\u867d\u7136\u52a0\u4e86\u9501\uff0c\u4f46\u662f\u8fc7\u671f\u65f6\u95f4\u6ca1\u6709\u52a0\u4e0a\u53bb\uff0c\u7a0b\u5e8f\u5c31\u6302\u4e86\u4e5f\u4f1a\u4ea7\u751f\u6b7b\u9501\u7b49\u7b49</p> <p>\u6b7b\u9501\u5927\u90e8\u5206\u4ea7\u751f\u7684\u573a\u666f\uff0c\u52a0\u4e86\u9501\u6ca1\u6709\u91ca\u653e\u3002\u7136\u540e\u5176\u4ed6\u7ebf\u7a0b\u62ff\u4e0d\u5230\u9501\uff0c\u5c31\u9020\u6210\u4e86\u5927\u9762\u79ef\u7684\u8bf7\u6c42\u5931\u8d25\u3002</p> <p>\u6240\u4ee5\u89e3\u6c7a\u95ee\u9898\u7684\u601d\u8def\u5c31\u662f\uff0c\u9996\u5148\u8981\u4fdd\u969c\u5206\u5e03\u5f0f\u9501\u80fd\u591f\u6b63\u5e38\u91ca\u653e</p> <p>\u91ca\u653e\u9501\u6709\u51e0\u79cd\u65b9\u5f0f</p> <ul> <li>\u76f4\u63a5\u5220\u6389\u9501\u7684key\u6216\u8005\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u4e00\u822c\u5c31\u8fd9\u4e24\u79cd\u91ca\u653e\u65b9\u5f0f</li> <li>\u5220\u9664\u9501\u7684key\u662f\u8981\u6ce8\u610f\uff0c<ul> <li>\u9996\u5148\u9700\u8981\u5224\u65ad\u9501\u662f\u5426\u88ab\u5360\u7528\uff0c\u5982\u679c\u5360\u7528\u624d\u5f00\u59cb\u6267\u884c\u5220\u9664\u3002\u8fd8\u9700\u8981\u5224\u65ad\u662f\u5426\u662f\u5f53\u524d\u7ebf\u7a0b\u52a0\u7684\u9501\uff0c\u4e0d\u80fd\u628a\u522b\u7684\u7ebf\u7a0b\u52a0\u7684\u9501\u7ed9\u91ca\u653e\u6389\uff0c\u540c\u65f6\u4e5f\u8981\u4fdd\u8bc1\u554a\u64cd\u4f5c\u7684\u539f\u5b50\u6027\uff0c\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2alua\u811a\u672c\u6765\u5b9e\u73b0\uff0c</li> </ul> </li> <li>\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u4e00\u822c\u5462\u662f\u5148<code>set nx</code>, \u5230\u671f\u4e86\u5c31\u76f4\u63a5\u91ca\u653e\uff0c\u4f46\u662f\u8fd9\u4e2a\u6b65\u9aa4\u4e0d\u662f\u539f\u5b50\u6027\u7684\uff0c\u6240\u4ee5\u4eceredis2.6\u5f00\u59cb\u5f15\u5165\u4e86set\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bbe\u7f6e\u9501\u7684\u540c\u65f6\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7lua\u811a\u672c\u6765\u6267\u884c\u8fd9\u4e2a<code>setnx</code>, <code>expire</code> \u9632\u6b62\u5220\u9664\u6240\u9501\u7684\u4ee3\u7801\u5931\u6548, \u53ef\u4ee5\u901a\u8fc7\u8fc7\u671f\u65f6\u95f4\u6765\u8865\u5200</li> </ul>"},{"location":"chap7/int_anws/#19","title":"19 \u91ca\u653e\u5206\u5e03\u5f0f\u9501\u8981\u6ce8\u610f\u54ea\u4e9b\u95ee\u9898","text":"<p>\u4e00\u822c\u91ca\u653e\u6709\u4e24\u4e2a\u9014\u5f84, \u4e00\u4e2a\u662f\u5199\u4ee3\u7801\uff0c\u76f4\u63a5\u5728\u4e1a\u52a1\u903b\u8f91\u5904\u7406\u5b8c\u6210\u4e4b\u540e\uff0c\u901a\u8fc7Redis\u6765\u628akey\u8fdb\u884c\u5220\u9664</p> <p>\u6216\u8005\u901a\u8fc7\u8fc7\u671f\u65f6\u95f4\uff0c\u8d85\u8fc7\u4e86\u8fc7\u671f\u65f6\u95f4\u4e4b\u540e\u5c31\u76f4\u63a5\u8fc7\u671f\u5220\u9664\u3002 \u5c31\u662f\u5206\u5e03\u5f0f\u9501\u8d85\u8fc7\u4e86\u8fc7\u671f\u65f6\u95f4\uff0c\u4e1a\u52a1\u8fd8\u6ca1\u6709\u5904\u7406\u5b8c\uff0c\u8fd9\u4e2a\u65f6\u5019\u7684\u9501\u5c31\u88ab\u91ca\u653e\u4e86\uff0c\u5c31\u4f1a\u88ab\u5176\u4ed6\u7684\u7ebf\u7a0b\u62ff\u8d70\uff0c\u9501\u4e5f\u5c31\u5931\u53bb\u4e86\u610f\u4e49</p> <p>\u90a3\u4e48\u4e24\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\u540c\u4e00\u4e2a\u6570\u636e\uff0c\u90a3\u4e48\u6570\u636e\u5c31\u5bb9\u6613\u51fa\u73b0\u4e00\u4e9b\u9519\u4e71\u3002 </p> <p>\u5c31\u662f\u8981\u589e\u52a0\u4e00\u4e2a\u5b88\u62a4\u7ebf\u7a0b\uff0c\u6bcf\u9694\u51e0\u79d2\u949f\u6765\u68c0\u67e5\u4e00\u6b21\uff0c\u5224\u65ad\u4e1a\u52a1\u5feb\u5230\u671f\u4e86\u6709\u6ca1\u6709\u5904\u7406\u5b8c\uff0c \u5982\u679c\u6ca1\u6709\u5904\u7406\u5b8c\uff0c\u5c31\u7ed9\u5f53\u524d\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u7eed\u547d\uff0c\u6bd4\u5982\u8bf4\u518d\u589e\u52a05\u79d2\uff0c\u5904\u7406\u5b8c\u4e86\uff0c\u5c31\u76f4\u63a5\u5173\u6389\u8fd9\u4e2a\u5b88\u62a4\u7ebf\u7a0b\uff08watch dog).\u8fd9\u4e2a\u662f\u5904\u7406\u9501\u7684\u4e00\u4e2a\u8fc7\u671f\u7eed\u547d</p> <p>\u90a3\u4e48\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\u5462\u5c31\u662f\u4ee3\u7801\u903b\u8f91\uff0c\u91ca\u653e\u9501\u7684\u65f6\u5019\u5462\u8981\u5224\u65ad\u662f\u4e0d\u662f\u81ea\u5df1\u7ebf\u7a0b\u52a0\u7684\u9501\uff0c\u522b\u628a\u522b\u7684\u7ebf\u7a0b\u52a0\u4e86\u9501\u7ed9\u91ca\u653e\u4e86\u3002</p> <p>\u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662fa\u7ebf\u7a0b\u5361\u6b7b\u9501\u8fc7\u671f\u4e86\u3002 \u8fd9\u4e2a\u65f6\u5019\uff0c\u88abb\u7ebf\u7a0b\u52a0\u4e86\u9501,\u8fd9\u4e2a\u65f6\u5019\u5462a\u7ebf\u7a0b\u53c8\u6062\u590d\u4e86, \u53c8\u628ab\u7ebf\u57ce\u7684\u8fd9\u4e2a\u9501\u7ed9\u91ca\u653e\u4e86.</p> <p>\u6240\u4ee5\u7279\u522b\u5f3a\u8c03, \u5728\u5220\u9664\u9501\u7684\u65f6\u5019. \u6bd4\u5982\u7ed9\u5206\u5e03\u5f0f\u9501. \u589e\u52a0\u8fd9\u4e2a\u5f53\u524d\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u6807\u8bb0. \u6bd4\u5982\u8bf4\u8fd9\u4e2athreadID, \u53ea\u6709\u81ea\u5df1\u52a0\u7684\u9501\u624d\u5141\u8bb8\u5220\u9664\uff0c \u5426\u5219\u662f\u4e0d\u6267\u884c\u5220\u9664</p>"},{"location":"chap7/int_anws/#20","title":"20 \u4e3a\u4ec0\u4e48\u8bf4\u53ef\u91cd\u5165\u9501\u662f\u4e2a\u7cdf\u7cd5\u7684\u8bbe\u8ba1","text":"<p>\u53ef\u91cd\u5165\u9501, \u4ecejvm\u91cc\u9762syntronized\u5230redis\u5206\u5e03\u5f0f\u9501, \u4e5f\u90fd\u652f\u6301\u53ef\u91cd\u5165\u7684\u8bbe\u8ba1, \u5c31\u662f\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u5230\u4e86\u9501, \u5982\u679c\u5f80\u4e0b\u8c03\u7528\u7684\u65b9\u6cd5\u4e5f\u6d89\u53ca\u5230\u4e86\u8d44\u6e90\u7684\u7ade\u4e89\u4e5f\u9700\u8981\u52a0\u9501. </p> <p>\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5462\u5982\u679c\u662f\u53ef\u91cd\u5165\u7684\u9501, \u5f80\u4e0b\u7684\u9501\u5c31\u4e0d\u9700\u8981\u518d\u52a0\u4e86\uff0c\u9501\u5c31\u4f1a\u76f4\u63a5\u52a0\u4e0a\uff0c\u53ef\u4ee5\u53cd\u590d\u52a0\u9501\uff0c\u90a3\u4e48\u5982\u679c\u73b0\u5728\u7684\u9501\u4e0d\u652f\u6301\u53ef\u91cd\u5165\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5728\u65b0\u7684\u5b50\u65b9\u6cd5\u4e0a\u9762\u6765\u52a0\u4e0a\u65b0\u7684\u9501</p> <p>\u52a0\u9501\u7684\u540c\u65f6\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u9501\u91cc\u6709\u9501\uff0c\u5728\u7b49\u5f85\u5f53\u524d\u9501\u7684\u91ca\u653e\u5c31\u4f1a\u5f88\u5bb9\u6613\u51fa\u73b0\u6b7b\u9501\uff0c\u90a3\u4e48\u53ef\u91cd\u5165\u9501\u5176\u5b9e\u5c31\u6ca1\u6709\u8fd9\u4e2a\u95ee\u9898\uff0c\u8fd9\u4e2a\u5c31\u662f\u53ef\u4f20\u5165\u9501\u7684\u8fd9\u4e2a\u8bbe\u8ba1\u521d\u8877</p> <p>\u90a3\u4e48\u5728\u5206\u5e03\u5f0f\u7684\u73af\u5883\u4e0b\u9762, \u7528\u7684\u6bd4\u8f83\u591a\u7684\u5c31\u662f\u57fa\u4e8eRedis\u7684\u5206\u5e03\u5f0f\u9501, \u6bd4\u5982\u8bf4\u50cfredison, \u5173\u952e\u70b9\u5c31\u4e24\u4e2a</p> <ul> <li>\u4e00\u4e2a\u662f\u8981\u5b58\u50a8\u5f53\u524d\u7ebf\u7a0b\u7684ID\uff0c\u90a3\u4e48\u7ebf\u7a0bID\u7684\u83b7\u53d6\uff0c\u8981\u6ce8\u610f\u5206\u5e03\u5f0f\u4e0b\u7684ID\u4e0d\u8981\u51fa\u73b0\u91cd\u590d\u7684\uff0c\u53ef\u4ee5\u7528\u8fdb\u7a0b\u7684ID\u7ebf\u7a0b\u7684ID\u7ec4\u5408\u6765\u4fdd\u969c\u4e0d\u91cd\u590d\uff0c </li> <li>\u4e00\u4e2a\u662f\u8981\u505a\u597d\u8ba1\u6570\uff0c\u5c31\u662f\u8981\u8bb0\u5f55\u91cd\u590d\u52a0\u9501\u7684\u6b21\u6570\uff0c\u7528redis\u7684\u8fd9\u4e2aincr\u51fd\u6570\uff0c\u90a3\u4e48\u5b58\u5728\u54c8\u897f\uff0c\u90a3\u4e48\u52a0\u4e86\u591a\u5c11\u6b21\u7684\u9501\uff0c\u90a3\u4e48\u5728\u76f8\u5e94\u91ca\u653e\u9501\u7684\u65f6\u5019\uff0c\u5c31\u9700\u8981\u51cf\u591a\u5c11\u6b21\u4e86\u91cd\u5165\u9501\u3002 </li> </ul> <p>\u4e0d\u662f\u4e00\u4e2a\u597d\u7684\u8bbe\u8ba1\uff0c\u7834\u574f\u4e86\u8fd9\u4e2a\u6240\u8c13\u7684\u4e0d\u53d8\u91cf\u589e\u52a0\u4e86\u590d\u6742\u5ea6\u5bb9\u6613\u4ea7\u751fbug</p>"},{"location":"chap7/int_anws/#21-id-","title":"21 \u804a\u804a\u5206\u5e03\u5f0f\u4e0bID\u751f\u6210\u65b9\u6848 - \u53f7\u6bb5\u6a21\u5f0f","text":"<p>\u5927\u540d\u9f0e\u9f0e\u7684\u96ea\u82b1\u7b97\u6cd5\u4e00\u76f4\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u9762\u88ab\u5e7f\u6cdb\u7684\u5e94\u7528\uff0c\u751f\u6210\u4e5f\u5f88\u7b80\u5355\uff0c\u9996\u5148\u65f6\u95f4\u6233\uff0c\u7136\u540e\u673a\u5668\u7801\u81ea\u589e\u6570\uff0c\u7136\u540e\u673a\u5668\u7801\u81ea\u589e\u6570</p> <p>\u8fd8\u6709\u4e00\u4e2aID\u751f\u5b58\u7684\u65b9\u6848\uff0c \u53eb\u505a\u8fd9\u4e2a\u53f7\u6bb5\u6a21\u5f0f\uff0c\u5c31\u662f\u8bf7\u6c42\u4e00\u4e0b\uff0c\u53ef\u4ee5\u751f\u6210\u4e86\u591a\u4e2a\u53f7\u53d8\u6210\u4e86\u4e00\u79cd\u53f7\u6bb5\u3002 </p> <p>\u6bd4\u5982\u8bf4\u8bf7\u6c42\u4e00\u4e0b\u5c31\u653e1000\u4e2a\u53f7\uff0c\u90a3\u4e48\u53f7\u7801\uff0c\u5176\u5b9e\u5c31\u662f\u76f8\u5f53\u4e8e\u751f\u6210\u7684\u8fd9\u4e2aID\uff0c\u90a3\u5176\u5b9e\u4ed6\u662f\u4f9d\u8d56\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\uff0c\u5f97\u6709\u4e2a\u5730\u65b9\u6765\u5b58\u50a8\uff0c\u53f7\u6bb5\u53d1\u653e\u7684\u8fdb\u5ea6\u3002</p> <p>\u591a\u4e2a\u5ba2\u6237\u7aef\u8bf7\u6c42\uff0c\u5c31\u77e5\u9053\u672c\u5730\u5e94\u8be5\u4ece\u54ea\u4e2a\u6570\u5f00\u59cb\u8ba1\u7b97\u4e86\u3002\u7136\u540e\u6709ID\u8bf7\u6c42\u8fdb\u6765\uff0c \u672c\u5730\u5c31\u52a01\u8fd4\u56de\uff0c \u76f4\u5230\u8017\u5c3d\u53f7\u6bb5\u7684\u8d44\u6e90\uff0c\u518d\u53bb\u8bf7\u6c42\u6570\u636e\u5e93\u6765\u83b7\u53d6\u65b0\u7684\u53f7\u6bb5</p>"},{"location":"chap7/int_anws/#22","title":"22 \u804a\u804a\u5206\u5e03\u5f0f\u4e0b\u7684\u996a\u52a1\u8c03\u5ea6\u6846\u67b6","text":"<p>\u5e38\u89c1\u7684\u8fd9\u4e2a\u4efb\u52a1\u4ea4\u6d41\u6846\u67b6\u4e5f\u5f88\u591a\uff0cquartz, xxl-job, elasticjob, \u548c schedulex</p> <p>quartz</p> <p>\u4f9d\u8d56\u6570\u636e\u5e93\uff0c\u652f\u6301cron\u8868\u8fbe\u5f0f\uff0c\u5c31\u662f\u6ca1\u6709\u8fd9\u4e2a\u56fe\u5f62\u5316\u7684\u754c\u9762</p> <p>xxl-job</p> <p>\u90fd\u662f\u57fa\u4e8ecron\u8868\u8fbe\u5f0f, \u90fd\u9700\u8981\u4f9d\u8d56\u6570\u636e\u5e93, \u5f53\u7136\u4e5f\u589e\u52a0\u4e86\u5f88\u591a\u7279\u6027.\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2a\u62a5\u8b66\u76d1\u63a7, \u51fa\u73b0\u95ee\u9898\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u90ae\u4ef6\u62a5\u8b66. \u8fd8\u6709\u4e30\u5bcc\u7684\u53ef\u89c6\u5316\u7684\u7ba1\u7406\u754c\u9762, xxl\u4e5f\u6bd4\u8f83\u5bb9\u6613\u96c6\u6210</p>"},{"location":"chap7/int_anws/#21","title":"21 \u804a\u804a\u5206\u5e03\u5f0f\u4e8b\u52a1\u4e0b\u7684\u4e8c\u9636\u6bb5\u63d0\u4ea4","text":"<p>\u5e38\u89c1\u7684XA\uff0cAT\u6a21\u5f0f,</p> <ul> <li>\u4e00\u9636\u6bb5\u662f\u51c6\u5907\u9636\u6bb5prepare</li> <li>\u4e00\u9636\u6bb5\u662f\u63d0\u4ea4\u9636\u6bb5commit</li> </ul> <p>\u90a3\u4e48\u5728\u51c6\u5907\u9636\u6bb5\u4e8b\u52a1\u534f\u8c03\u8005\uff0c\u53c8\u53eb\u4ed6\u4e8b\u52a1\u7ba1\u7406\u5668\uff0c\u6bd4\u5982\u8bf4\u5e38\u89c1\u7684seata\uff0c\u5c31\u4f1a\u7ed9\u6bcf\u4e00\u4e2a\u53c2\u4e0e\u8005\u53d1\u9001prepare\u6d88\u606f\u5c31\u662f\u7684\u5404\u4e2a\u670d\u52a1\u4e86\u3002</p> <p>\u6bcf\u4e00\u4e2a\u53c2\u4e0e\u8005\u8981\u4e48\u76f4\u63a5\u8fd4\u56de\u5931\u8d25\uff0c\u6bd4\u5982\u9047\u5230\u4e86\u4e00\u4e9b\u8fd9\u4e2a\u6743\u9650\u7684\u9a8c\u8bc1\u95ee\u9898\u6216\u8005\u662f\u4e00\u4e9b\u5e93\u5b58\u4e0d\u591f\u7684\u95ee\u9898\uff0c \u4e8b\u52a1\u5c31\u4f1a\u76f4\u63a5\u505c\u6b62\uff0c\u5728\u672c\u5730\u5c31\u6267\u884c\u4e8b\u52a1\u4e86\u3002\u5199\u672c\u5730\u7684\u4e00\u4e9bredo\uff0c ando\u65e5\u5fd7\u3002\u5b8c\u6210\u6240\u6709\u7684insert, update. </p> <p>\u4f46\u662f\u5982\u679c\u4e0d\u63d0\u4ea4\u6267\u884c\u5b8c\u6210, \u5c31\u62a5\u544a\u7ed9\u4e8b\u52a1\u7ba1\u7406\u5668seata\u3002 \u5df2\u5b8c\u6210\uff0c\u53ef\u4ee5\u63d0\u4ea4\u4e86\uff0c\u90a3\u4e48\u4e8b\u52a1\u7ba1\u7406\u5668\u5c31\u4f1a\u5728\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u6210\u529f\u4e4b\u540e\uff0c\u518d\u7ed9\u6bcf\u4e00\u4e2a\u8fd9\u4e2a\u5206\u652f\u53bb\u4e0b\u8fbe\u6267\u884ccommit\u7684\u547d\u4ee4\u3002 \u7136\u540e\u6bcf\u4e00\u4e2a\u53c2\u4e0e\u8005\u5206\u522b\u53bb\u63d0\u4ea4\uff0c\u8fd9\u4e2a\u65f6\u5019\u624d\u662f\u771f\u6b63\u7684\u63d0\u4ea4\uff0c</p> <p>\u4e8c\u9636\u6bb5\u6709\u4ec0\u4e48\u95ee\u9898</p> <ul> <li>\u5c31\u662f\u6027\u80fd\u95ee\u9898\uff0c\u5728\u4e8b\u52a1\u6ca1\u6709\u5b8c\u6210\u4e4b\u524d\uff0c\u5176\u5b9e\u6bcf\u4e00\u4e2a\u5206\u652f\u3002\u5b83\u90fd\u662f\u963b\u585e\u7684\u72b6\u6001\uff0c </li> <li>\u53e6\u5916\u4e00\u4e2a\u5e38\u89c1\u7684\u95ee\u9898\uff0c\u5c31\u662f\u53ef\u9ad8\u6027\u7684\u95ee\u9898\u4e86\uff0c\u6bd4\u5982\u8bf4\u5728\u63d0\u4ea4\u9636\uff0c\u6bb5\uff0c\u5206\u652f\u957f\u65f6\u95f4\u4e0d\u54cd\u5e94\uff0c\u53ef\u80fd\u662f\u5b95\u673a\u4e86\u3002 \u6216\u8005\u662f\u670d\u52a1\u5f02\u5e38\u7b49\u7b49\uff0c\u53cd\u6b63\u5c31\u662f\u4e0d\u54cd\u5e94\u3002</li> </ul> <p>\u5176\u4ed6\u7684\u7ebf\u7a0b\u90fd\u662f\u963b\u585e\u72b6\u6001\uff0c\u9700\u8981\u6709\u4e00\u4e2a\u673a\u5236\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u6bd4\u5982\u8bf4\u8d77\u4e00\u4e2a\u5b88\u62a4\u7ebf\u7a0b\uff0c\u5982\u679c\u957f\u65f6\u95f4\u4e0d\u54cd\u5e94\uff0c\u5c31\u76f4\u63a5\u5f53\u6210\u5931\u8d25\u6765\u5904\u7406\u3002 </p> <p>\u8ba9\u5176\u4ed6\u7684\u6a21\u5757\uff0c\u5168\u90e8\u56de\u6eda\u6389\u3002</p>"},{"location":"chap7/int_anws/#22_1","title":"22 \u804a\u804a\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u4e09\u9636\u6bb5\u63d0\u4ea4","text":"<p>\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u4e8c\u9636\u6bb5\uff0c\u63d0\u4ea4\u51c6\u5907\u9636\u6bb5\uff0c\u63d0\u4ea4\u9636\u6bb5</p> <p>\u4f46\u662f\u5b9e\u9645\u4e0a\uff0c\u5728\u9879\u76ee\u4e2d\u7528\u7684\u5e76\u4e0d\u591a\u3002\u4e3b\u8981\u539f\u56e0\u8fd8\u662f\u5728\u4e8e\u4ed6\u7684\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u6709\u5f88\u591a\u7684\u95ee\u9898\u3002</p> <p>\u6bd4\u5982\u8282\u70b9\u90fd\u5904\u4e8e\u963b\u585e\u72b6\u6001\uff0c\u90a3\u4e48\u5404\u4e2a\u6570\u636e\u5e93\u8282\u70b9\u90fd\u5360\u7528\u7740\u6570\u636e\u5e93\u7684\u8d44\u6e90\uff0c\u53ea\u6709\u5f53\u6240\u6709\u8282\u70b9\u51c6\u5907\u5b8c\u6bd5\u3002 </p> <p>\u4e8b\u52a1\u534f\u8c03\u8005\u624d\u4f1a\u901a\u77e5\u8fdb\u884c\u5168\u5c40\u63d0\u4ea4\uff0c\u53ea\u6709\u5404\u4e2a\u8282\u70b9\u90fd\u63d0\u4ea4\u4e4b\u540e\u624d\u4f1a\u91ca\u653e\u8d44\u6e90\u3002 </p> <p>\u8fd9\u6837\u7684\u8fc7\u7a0b\u5f80\u5f80\u4f1a\u6bd4\u8f83\u6f2b\u957f\uff0c\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u4e5f\u4f1a\u6bd4\u8f83\u5927\uff0c\u7136\u540e\u8fd8\u6709\u534f\u8c03\u8005\u5355\u70b9\u6545\u969c\u7684\u95ee\u9898\uff0c\u90a3\u4e48\u4e00\u65e6\u534f\u8c03\u8005\u6302\uff0c\u5206\u652f\u8282\u70b9\u6536\u4e0d\u5230\u901a\u77e5\uff0c\u5230\u5e95\u662f\u56de\u6eda\uff0c\u8fd8\u662f\u63d0\u4ea4\uff0c\u5c31\u4f1a\u4e00\u76f4\u5361\u6b7b\u5728\u90a3\u91cc\u3002</p> <p>\u7136\u540e\u8fd8\u6709\u8fd9\u4e2a\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\uff0c\u6bd4\u5982\u8bf4\u7f51\u7edc\u6296\u52a8\uff0c\u90a3\u4e48\u6709\u7684\u6536\u5230\u4e86\u8fd9\u4e2a\u63d0\u4ea4\u901a\u77e5\uff0c\u6709\u7684\u6ca1\u6536\u5230\u3002</p> <p>\u4e09\u9636\u6bb5\u63d0\u4ea43PC\uff0c\u5c31\u4ea7\u751f\u4e86\u7684\u8fdb\u7248\u672c\u3002CanCommit\uff0cpreCommit\uff0c doCommit\u3002\u5c31\u662f\u5728\u4e8c\u9636\u6bb5\u7684\u51c6\u5907\u9636\u6bb5\uff0c\u63d0\u4ea4\u9636\u6bb5\u4e2d\u95f4\uff0c\u589e\u52a0\u4e86pre commit\u7684\u9636\u6bb5\u3002 </p> <p>\u9884\u63d0\u4ea4\uff0c\u8fd9\u90e8\u5206\u5c31\u662f\u5728\u539f\u5148\u4e8c\u9636\u6bb5\u7684\u63d0\u4ea4\u9636\u6bb5\uff0c\u628a\u5de5\u4f5c\u505a\u4e86\u8fdb\u4e00\u6b65\u7684\u62c6\u5206\u3002 \u5148\u786e\u8ba4\u5404\u4e2a\u53c2\u4e0e\u8005\u51c6\u5907\u63d0\u4ea4\u7684\u72b6\u6001\u662f\u5426\u6b63\u5e38\uff0c\u907f\u514d\u5728\u63d0\u4ea4\u9636\u6bb5\u53d1\u751f\u5404\u79cd\u5404\u6837\u7684\u6545\u969c\uff0c\u90a3\u4e48\u5728\u6b63\u5f0f\u63d0\u4ea4\u4e4b\u524d\u3002 </p> <p>\u5148\u5c1d\u8bd5\u505a\u4e00\u4e0b\u63d0\u4ea4\uff0c\u5224\u65ad\u7684\u8ba2\u5355\u4e2d\u5fc3\u7b49\u6b63\u4e0d\u6b63\u5e38\u3002\u5c31\u80fd\u591f\u5c3d\u65e9\u7684\u53d1\u73b0\u4e00\u4e9b\u95ee\u9898\uff0c\u907f\u514d\u628a\u8fd9\u4e2a\u95ee\u9898\u90fd\u62d6\u5230\u63d0\u4ea4\u7684\u9636\u6bb5\u6765\u5904\u7406\u3002</p> <p>\u4e09\u9636\u6bb5\u63d0\u4ea4\u6bd4\u8f83\u91cd\u8981\u7684\u6539\u8fdb\u65b9\u5f0f\uff0c\u5c31\u662f\u5f15\u5165\u4e86\u8d85\u65f6\u673a\u5236\uff0c\u4e8c\u9636\u6bb5\u63d0\u4ea4\uff0c\u53ea\u6709\u4e8b\u52a1\u7684\u534f\u8c03\u8005\u624d\u6709\u8fd9\u4e2a\u8d85\u65f6\u673a\u5236\u672c\u8eab\u5404\u4e2a\u5206\u652f\u4e8b\u52a1\uff0c\u662f\u6ca1\u6709\u8d85\u65f6\u673a\u5236\u7684\u3002</p> <p>\u5982\u679c\u5206\u652f\u7684\u4e8b\u52a1\uff0c\u90a3\u4e48\u4e09\u519b\u4e71\u63d0\u4ea4\uff0c\u5c31\u4fee\u8865\u4e86\u8fd9\u6837\u7684\u4e00\u4e2a\u6f0f\u6d1e\u3002\u5982\u679c\u5206\u652f\u4e8b\u52a1\u957f\u65f6\u95f4\u65e0\u6cd5\u4e0e\u534f\u8c03\u8005\u554a\u901a\u8baf\uff0c\u90a3\u4e48\u53ef\u80fd\u662fseata\u6302\u4e86\u3002 </p> <p>\u90a3\u4e48\u53c2\u4e0e\u8005\uff0c\u5c31\u4f1a\u5728\u7b49\u5f85\u547d\u4ee4\u8d85\u65f6\u4e4b\u540e\uff0c\u6bd4\u5982\u8bf41\u79d2\u949f\u6216\u80052\u79d2\u949f\uff0c\u90a3\u4e48\u5c31\u4f1a\u81ea\u52a8\u8fdb\u5165\u672c\u5730\u7684commit\uff0c\u8fdb\u884c\u8d44\u6e90\u7684\u91ca\u653e\u3002</p> <p>\u8fd9\u6837\u7684\u8bdd\u5c31\u80fd\u591f\u907f\u514d\u56e0\u4e3a\u8fd9\u4e2a\u4e8b\u52a1\u957f\u65f6\u95f4\u963b\u585e\u4e86\u3002 \u56e0\u4e3a\u8fd9\u4e2a\u4e8b\u52a1\u957f\u65f6\u95f4\u963b\u585e\u4e86\u8fd8\u662f\u4e0d\u80fd\u591f\u89e3\u51b3\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\uff0c\u5148\u628a\u8fd9\u4e2a\u89e6\u53d1\u7684\u8fd9\u79cd\u5f02\u5e38\u60c5\u51b5\u7136\u540e\u518d\u53cd\u9988\u7ed9\u540e\u53f0\uff0c\u4eba\u5de5\u6765\u5e72\u9884\u5904\u7406</p>"},{"location":"chap7/int_anws/#23-tcc","title":"23 \u5206\u5e03\u5f0f\u4e8b\u52a1\u4e0b\u7684TCC\u6a21\u5f0f","text":"<p>\u5b9e\u9645\u4e0atcc\u662f\u4e8c\u9636\u6bb5, \u901a\u5e38\u8fd9\u4e2a\u4e8c\u9636\u6bb5\u6307\u7684\u662f. </p> <p>\u57fa\u4e8e\u8fd9\u4e2axa\u6a21\u5f0f, \u8981\u4f9d\u8d56\u6570\u636e\u5e93\u4e8b\u52a1\u7684\u8fd9\u4e48\u4e00\u79cd\u6a21\u5f0f, \u90a3\u4e48Tcc\u8fd9\u4e2a\u4e8c\u9636\u6bb5, \u5b83\u5176\u5b9e\u662f\u4f20\u7edf\u4e8c\u9636\u6bb5\u7684\u6539\u8fdb\u7248\u672c. \u540c\u6837\u4e5f\u662f\u5148\u5c1d\u8bd5\u53d1\u8d77\u4e8b\u52a1, \u5982\u679c\u90fd\u6b63\u5e38\u90a3\u4e48commit, \u5982\u679c\u5931\u8d25\u90a3\u5c31\u76f4\u63a5cancel. \u6709\u4e00\u4e2a\u5f88\u5927\u7684\u6539\u8fdb, \u5c31\u662f\u629b\u5f03\u4e86\u6570\u636e\u5e93\u7684\u4e8b\u52a1.</p> <p>\u6240\u6709\u7684\u4e8b\u52a1\u5904\u7406\u5305\u62ec\u5c1d\u8bd5\u5904\u7406, \u63d0\u4ea4\uff0c\u56de\u6eda. \u5168\u90fd\u8981\u4e0a\u5347\u5230\u4e1a\u52a1\u5c42\u6765\u5904\u7406, \u5c31\u662f\u624b\u5199\u903b\u8f91\u4ee3\u7801. \u5728\u4e1a\u52a1\u91cc\u9762, \u6bd4\u5982\u8bf4\u4e0b\u5355\u6263\u5e93\u5b58. </p> <p>\u5728\u51c6\u5907\u9636\u6bb5\uff0c\u5c31\u662ftry\u9636\u6bb5, \u8ba2\u5355\u7684\u72b6\u6001\u662f\u9884\u521b\u5efa\u7684\u4e00\u4e2a\u72b6\u6001\uff0c\u5e93\u5b58\u7684\u6263\u51cf\u4e5f\u662f\u5728\u9884\u6263\u9664\u7684\u72b6\u6001\u3002 \u5982\u679c\u9047\u5230\u5206\u6210\u5931\u8d25\u7684\u60c5\u51b5\uff0c\u8981\u5206\u9636\u6bb5\u6765\u8003\u8651\uff0c\u5982\u679c\u662f\u5728try\u9636\u6bb5\u5931\u8d25\uff0c \u90a3\u4e48\u76f4\u63a5rollback\u3002 \u4f46\u662f\u5982\u679c\u5728commit\u9636\u6bb5\u5931\u8d25\u4e86\u600e\u4e48\u529e\uff0c\u53ea\u80fd\u786c\u7740\u5934\u76ae\u4e0d\u505c\u7684\u91cd\u8bd5\u76f4\u5230\u6210\u529f\u4e3a\u6b62\uff0c \u8fd9\u4e2a\u91cd\u8bd5\u52a8\u4f5c\u4e5f\u662f\u4e8b\u52a1\u7ba1\u7406\u5668\u6765\u505a\u7684</p>"},{"location":"chap7/int_anws/#24","title":"24 \u5206\u5e03\u5f0f\u4e0b\u5982\u4f55\u5bf9\u670d\u52a1\u8fdb\u884c\u4f18\u96c5\u4e0b\u7ebf","text":"<ul> <li>kill -9 \u4e0d\u884c;</li> <li>kill -15 </li> </ul> <p>\u5e38\u89c1\u7684\u5f88\u591a\u547d\u4ee4\uff0c\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2aTomcat\u7684\u505c\u6b62\uff0c\u57fa\u672c\u4e5f\u90fd\u5305\u7684\u662f<code>kill -15</code>\u7684\u547d\u4ee4,\u6765\u7ed3\u675f\u6b63\u5728\u8dd1\u7684\u670d\u52a1</p> <p>\u5f53\u7136\u4e86\u5f88\u591a\u7684Java\u6846\u67b6\uff0c\u50cf\u8fd9spring\uff0c \u4e5f\u5185\u7f6e\u4e86shut down hook. \u6765\u54cd\u5e94 <code>kill -15</code>\u7684\u547d\u4ee4, \u9ed8\u8ba4\u7684\u90fd\u662f\u5148\u5904\u7406\u597d, \u5f53\u524d\u4e0a\u4e0b\u6587\u7684\u4efb\u52a1, \u5904\u7406\u5b8c\u4e86\u624d\u5141\u8bb8kill\u6389</p> <p>stop\u7684\u547d\u4ee4\u597d\u50cf\u4e0d\u662f\u7acb\u5373\u505c\u6b62, \u5b9e\u9645\u4e0a\u662f\u670d\u52a1\u5185\u90e8, \u53ef\u80fd\u662f\u5728\u5904\u7406\u4e00\u4e9b\u4e8b\u52a1, \u6240\u4ee5\u8981\u7b49\uff0c</p> <p>\u90a3\u4e48\u5bf9\u4e8e\u5206\u5e03\u5f0f\u4e0b\u5fae\u670d\u52a1\u600e\u4e48\u4e0b\u7ebf, \u4e00\u822c\u90fd\u662f\u5148\u4ece\u6ce8\u518c\u4e2d\u5fc3\u6458\u9664\u673a\u5668 \u6bd4\u5982\u8bf4\u50cfeureka\u6216\u8005\u662fNacos\uff0c \u8fd9\u65f6\u5019\u4e00\u822c\u90fd\u662f\u8d1f\u8f7d\u5747\u8861\uff0c \u6bd4\u5982\u8bf4\u7528\u6237\u4e2d\u5fc3\u53ef\u80fd\u6709\u597d\u591a\u4e2a\u3002 </p> <p>\u8fd9\u4e2a\u65f6\u5019\u5982\u679c\u4f60\u8981\u4e0b\u7ebf\uff0c\u67d0\u4e00\u4e2a\u7528\u6237\u4e2d\u5fc3\u3002\u90a3\u4e48\u5c31\u76f4\u63a5\u53d1\u6307\u4ee4\u7ed9eureka\u6216\u8005Nacos, \u628a\u8fd9\u4e2a\u670d\u52a1\u6458\u6389, \u540e\u7eed\u7684\u8bf7\u6c42\u5c31\u4e0d\u4f1a. \u53d1\u9001\u5230\u5f53\u524d\u7684\u670d\u52a1\u4e0a, \u8fd9\u4e2a\u65f6\u5019\u518d\u4f7f\u7528<code>kill -15</code>\u7684\u547d\u4ee4. \u7ed3\u675f\u670d\u52a1\u554a</p> <p>\u8fd8\u6709\u50cf\u7f51\u5173\u5c42\u7684\u4e0b\u7ebf, \u4e00\u822c\u90fd\u662f\u524d\u7f6e \u8fd9\u4e2aNginx, \u8fd9\u4e2a\u65f6\u5019\u5982\u679c\u8981\u5e72\u6389\u4e00\u4e2a\u670d\u52a1, \u5c31\u9700\u8981Nginx\u7684\u670d\u52a1\u5217\u8868\u91cc\u9762\u628a\u5b83\u8bbe\u7f6e\u6210\u4e0d\u53ef\u7528, \u7136\u540e\u518d\u5bf9\u670d\u52a1\u5c42\u8fdb\u884ckill\u7684\u4e0b\u7ebf\u5904\u7406</p>"},{"location":"chap7/int_anws/#24-rpc","title":"24 RPC\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u5b9e\u73b0\u50cf\u672c\u5730\u4e00\u6837\u8c03\u7528","text":"<p>\u4e3b\u6d41\u7684\u5fae\u670d\u52a1\u7684\u6846\u67b6\uff0c\u670d\u52a1\u4e0e\u670d\u52a1\u4e4b\u95f4\u7684\u8c03\u7528\uff0c\u90fd\u662f\u901a\u8fc7RPC\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u7684\u5b9e\u73b0\u65b9\u5f0f\u4e5f\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u901a\u8fc7\u8fdc\u7a0b\u670d\u52a1\u7c7b\uff0c\u7136\u540e\u901a\u8fc7\u65b9\u6cd5\u76f4\u63a5invoke\uff0c\u8c03\u7528\u7684\u901f\u5ea6\u4e5f\u5f88\u5feb\uff0c\u8ddf\u672c\u5730\u6ca1\u4ec0\u4e48\u533a\u522b</p> <p>\u4e24\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u5173\u952e\u70b9</p> <p>\u4e00\u4e2a\u7f51\u7edc\u901a\u4fe1</p> <p>dubbo\u7684\u901a\u4fe1\u65b9\u5f0f\uff0c\u662ftcp socket \u7684\u957f\u8fde\u63a5\uff0c\u6bcf\u6b21\u8c03\u7528\u4e0d\u9700\u8981\u91cd\u65b0\u5efa\u7acb\u8fde\u63a5\uff0c\u6709\u9700\u8981\u76f4\u63a5\u8c03\u7528\uff0c\u800c\u4e14\u670d\u52a1\u4e4b\u95f4\u4e00\u822c\u8d70\u7684\u662f\u5185\u7f51</p> <p>\u53e6\u4e00\u65b9\u9762\u662f\u4ee3\u7406</p> <p>\u5fae\u670d\u52a1\u7684\u6846\u67b6\uff0c\u90fd\u662f\u901a\u8fc7\u4ee3\u7406\u7684\u6a21\u5f0f\uff0c\u628a\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\u5c01\u88c5\u4e86\u8d77\u6765\uff0c\u5305\u62ec\u4e86\u5bf9\u51fa\u53c2\u5165\u53c2\u7684\u5e8f\u5217\u5316\uff0c\u7ebf\u7a0b\u6c60\u7684\u8c03\u7528\uff0c\u8fd8\u6709\u8d1f\u8f7d\u5747\u8861\u7684\u9009\u62e9\uff0c</p>"},{"location":"chap7/int_anws/#25","title":"25 \u804a\u804a\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0b\u7684\u5bb9\u9519\u673a\u5236","text":"<ul> <li>\u9996\u5148\uff1a \u5197\u4f59\u5907\u4efd</li> </ul> <p>\u5176\u5b9e\u4e0d\u7ba1\u662f\u7cfb\u7edf\u7684\u6570\u636e\u4e5f\u597d\uff0c\u8fd8\u662f\u529f\u80fd\u4e5f\u597d\uff0c\u90fd\u9700\u8981\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u9762\u8fdb\u884c\u5907\u4efd\uff0c\u4ee5\u9632\u6b62\u5355\u4e2a\u8282\u70b9\u7684\u6545\u969c\uff0c\u5bfc\u81f4\u6574\u4e2a\u7cfb\u7edf\u5d29\u6e83\uff0c \u4e00\u65e6\u67d0\u4e2a\u8282\u70b9\u51fa\u73b0\u4e86\u6545\u969c</p> <p>\u7cfb\u7edf\u53ef\u4ee5\u81ea\u52a8\u7684\u5207\u6362\u5230\u5907\u7528\u8282\u70b9\u4e0a\u9762\u6765\u7ee7\u7eed\u8fd0\u884c\uff0c\u6bd4\u5982\u5e94\u7528\u670d\u52a1\uff0c\u6ce8\u518c\u4e2d\u5fc3\uff0c\u8fd8\u6709\u4e00\u4e9b\u8fd9\u4e2a\u4e2d\u95f4\u952e\uff0c \u6bd4\u5982\u8bf4\u6d88\u606f\u961f\u5217\uff0credis\uff0c\u6570\u636e\u5e93\uff0c\u90fd\u9700\u8981\u505a\u597d\u5197\u4f59\u5907\u4efd\uff0c</p> <ul> <li>\u90a3\u4e48\u5197\u4f59\u5907\u4efd\u518d\u5347\u4e00\u7ea7\uff1a \u5bb9\u707e\u5907\u4efd</li> </ul> <p>\u9664\u4e86\u591a\u526f\u672c\u4ee5\u5916\uff0c \u8fd8\u9700\u8981\u5f3a\u8c03\u591a\u6570\u636e\u4e2d\u5fc3\uff0c\u591a\u5730\u7406\u4f4d\u7f6e\uff0c\u5176\u5b9e\u5c31\u662f\u5206\u6563\u5728\u4e0d\u540c\u7684\u5730\u65b9</p> <p>\u786e\u4fdd\u5728\u4e00\u4e2a\u533a\u57df\u53d1\u751f\u4e86\u707e\u96be\u6216\u8005\u6545\u969c\uff0c \u53ef\u4ee5\u901a\u8fc7\u5907\u4efd\u6570\u636e\u548c\u670d\u52a1\u6765\u6062\u590d\u7cfb\u7edf</p> <ul> <li>\u7136\u540e\uff1a \u5fc3\u8df3\u76d1\u6d4b</li> </ul> <p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u68c0\u6d4b\u6545\u969c\u7684\u91cd\u8981\u624b\u6bb5\u5e94\uff0c \u901a\u8fc7\u7cfb\u7edf\u5b9a\u671f\u5411\u8282\u70b9\u6765\u53d1\u9001\u5fc3\u8df3\u6d88\u606f\uff0c \u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u5982\u679c\u6ca1\u6709\u6536\u5230\u5fc3\u8df3\u56de\u590d\uff0c\u5c31\u4f1a\u8ba4\u4e3a\u8282\u70b9\u6545\u969c\u3002\u5c06\u5b83\u6807\u8bb0\u4e3a\u4e0d\u53ef\u7528\uff0c \u5c31\u4f1a\u5c06\u4efb\u52a1\u8f6c\u79fb\u5230\u5176\u4ed6\u53ef\u7528\u7684\u8282\u70b9\u4e0a\u9762\uff0c</p> <p>\u6709\u4e00\u4e2a\u6bd4\u8f83\u5178\u578b\u7684\u529f\u80fd\uff1a \u6709\u4e00\u4e2a\u6bd4\u8f83\u5178\u578b\u7684\u529f\u80fd\u6d4b\u5404\u4e2a\u673a\u5668\u6216\u8005\u5404\u4e2a\u670d\u52a1\u7684\u8fd0\u884c\u60c5\u51b5\uff0c\u50cfredis\u4e3b\u4ece\u8282\u70b9\u7684\u4e92\u76f8\u76d1\u542c\uff0c\u6ce8\u518c\u4e2d\u5fc3\u4e0e\u5e94\u7528\u670d\u52a1\u4e4b\u95f4\u7684\u76d1\u542c\uff0c\u90fd\u662f\u91c7\u7528\u4e86\u5fc3\u8df3\u68c0\u6d4b\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u7684</p> <ul> <li>\u8d1f\u8f7d\u5747\u8861\u662f\u5bb9\u9519\u673a\u5236\u4e2d\u5fc5\u4e0d\u53ef\u5c11\u7684\u4e00\u5458</li> </ul> <p>\u901a\u8fc7\u5c06\u8bf7\u6c42\u5206\u644a\u5230\u591a\u4e2a\u8282\u70b9\u4e0a\u9762\uff0c\u6765\u907f\u514d\u5355\u4e2a\u8282\u70b9\u7684\u8d1f\u8f7d\u8fc7\u5927,\u4ece\u800c\u63d0\u9ad8\u7cfb\u7edf\u7684\u6574\u4f53\u6027\u80fd\u548c\u53ef\u9760\u6027, </p> <p>\u50cf\u5fae\u670d\u52a1\u4e0b\u540c\u4e00\u4e2a\u5fae\u670d\u52a1, \u53ef\u80fd\u6709\u597d\u51e0\u4e2a\u76f8\u540c\u7684\u670d\u52a1\u5305\u6765\u5171\u540c\u7ec4\u6210\u4e86\u670d\u52a1\u5355\u5143, \u600e\u4e48\u8bbf\u95ee\u8fd9\u4e9b\u670d\u52a1\u5305? </p> <p>\u91c7\u7528\u4ec0\u4e48\u6837\u7684\u7b56\u7565, \u5c31\u9700\u8981\u7528\u5230\u8d1f\u8f7d\u5747\u8861\u6765\u505a\u7edf\u4e00\u7684\u5206\u914d</p> <ul> <li>\u8fd8\u6709\u5c31\u662f\u5206\u5e03\u5f0f\u4e8b\u52a1</li> </ul> <p>\u4e5f\u662f\u5bb9\u9519\u673a\u5236\u4e2d\u91cd\u8981\u7684\u7ec4\u6210\u90e8\u5206, \u7531\u4e8e\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u9762\u5404\u4e2a\u8282\u70b9\u4e4b\u95f4\u7684\u7f51\u7edc\u5ef6\u8fdf, \u6216\u8005\u4e0d\u53ef\u9760\u6027,\u5f88\u5bb9\u6613\u5c31\u51fa\u73b0\u4e86\u8fd9\u4e2a\u4e8b\u7269\u4e00\u81f4\u6027\u7684\u95ee\u9898,\u6bd4\u5982\u8bf4a\u6210\u529f\u4e86, b\u4e0d\u6210\u529f. </p> <p>\u5c31\u8981\u505a\u7edf\u4e00\u7684\u56de\u6eda, \u5c31\u9700\u8981\u4f7f\u7528\u5206\u5e03\u5f0f\u4e8b\u52a1,\u6765\u534f\u8c03\u5404\u4e2a\u8282\u70b9\u4e4b\u95f4\u7684\u4e8b\u52a1\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027</p> <p>\u5e38\u89c1\u7684\u89e3\u6c7a\u65b9\u6848, \u5c31\u662f\u4e8c\u9636\u6bb5\u4e09\u9636\u6bb5\u63d0\u4ea4\u4e86, \u50cf\u8fd9\u4e2aXA,TCC, at\u90fd\u662f\u6bd4\u8f83\u5e38\u89c1\u7684\u65b9\u6848, </p> <ul> <li>\u52a8\u6001\u4f38\u7f29\u6216\u8005\u5f39\u6027\u4f38\u7f29</li> </ul> <p>\u5f53\u6211\u4eec\u7684\u7cfb\u7edf\u8d1f\u8f7d\u8fc7\u5927, \u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0\u66f4\u591a\u7684\u8282\u70b9\u6765\u5206\u62c5\u8d1f\u8f7d, \u5f53\u8282\u70b9\u6545\u969c\u6216\u8005\u51fa\u73b0\u6027\u80fd\u95ee\u9898\u65f6, \u53ef\u4ee5\u52a8\u6001\u7684\u6765\u8c03\u6574\u7cfb\u7edf\u4e2d\u5404\u4e2a\u8282\u70b9\u7684\u914d\u7f6e,\u6765\u786e\u4fdd\u6574\u4e2a\u7cfb\u7edf\u7684\u7a33\u5b9a\u6027\u548c\u53ef\u9760\u6027, \u8fd9\u4e2a\u4e00\u822c\u8981\u642d\u914d\u4e91\u670d\u52a1\u6765\u505a</p>"},{"location":"chap7/int_anws/#26-rpo-rto","title":"26 \u707e\u5907\u8bbe\u8ba1\u4e0b\u7684 RPO. RTO","text":"<p>RPO RTO\u662f\u5728\u7cfb\u7edf\u9ad8\u53ef\u7528\u707e\u5907\u8bbe\u8ba1\u7684\u65f6\u5019\u3002 \u7ecf\u5e38\u4f1a\u8003\u8651\u7684\u4e24\u4e2a\u91cd\u8981\u7684\u6307\u6807</p> <ul> <li>RPO\u662f\u6062\u590d\u70b9\u6570\u636e\u7684\u6307\u6807\uff0c\u5c31\u662f\u8fd9\u4e2a\u7cfb\u7edf\u5982\u679c\u51fa\u73b0\u4e86\u6545\u969c\uff0c\u90a3\u4e48\u6700\u591a\u53ef\u80fd\u4e22\u5931\u591a\u957f\u65f6\u95f4\u7684\u6570\u636e</li> <li>RTO \u53e6\u5916\u4e00\u4e2a\u662f\u6062\u590d\u8fd0\u884c\uff0c\u8fd9\u4e2a\u65f6\u95f4\u7684\u6307\u6807\uff0c\u5c31\u662f\u4ece\u7cfb\u7edf\u6302\u4e86\u4e0d\u53ef\u7528\uff0c\u5230\u6062\u590d\u6b63\u5e38\u8fd0\u884c\u7684\u8fc7\u7a0b\u3002\u6bd4\u5982\u8bf4\u6bcf\u96946\u4e2a\u5c0f\u65f6\u6765\u5907\u4efd\u4e00\u6b21\u3002 RPO \u7684\u6700\u957f\u65f6\u95f46\u4e2a\u5c0f\u65f6</li> </ul> <p>\u53ef\u7528\u6027\u89d2\u5ea6\u6765\u8bf4RPO RTO\uff0c\u80af\u5b9a\u662f\u8d8a\u4f4e\u8d8a\u597d\u4e86\uff0c\u7cfb\u7edf\u7684\u53ef\u7528\u6027\u80af\u5b9a\u662f\u8d8a\u5f3a\u4e86</p>"},{"location":"chap7/int_anws/#27","title":"27 \u8de8\u4e2d\u5fc3\u67e5\u8be2\u5e36\u6765\u7684\u6027\u80fd\u95ee\u9898\u8be5\u5982\u4f55\u89e3\u6c7a\uff1f","text":"<p>\u8de8\u4e2d\u5fc3\u7ec4\u88c5\u6570\u636e\uff0c\u6bd4\u5982API.  \u9700\u8981\u540c\u65f6\u8c03\u7528\u4e24\u4e2a\u4ee5\u4e0a\u7684\u4e1a\u52a1\u4e2d\u5fc3, \u624d\u80fd\u591f\u62ff\u5230\u4f60\u60f3\u8981\u7684\u6570\u636e. </p> <p>\u6027\u80fd\u95ee\u9898\u7ecf\u5e38\u5c31\u4f1a\u51fa\u73b0\u5728, \u90a3\u600e\u4e48\u89e3\u6c7a\u8de8\u4e2d\u5fc3\u8c03\u7528\u7684\u6027\u80fd\u95ee\u9898.</p> <ul> <li>\u5c31\u662f\u5229\u7528\u6279\u5904\u7406, \u5c31\u662f\u5c06\u4f60\u7684\u8ba2\u5355\u6570\u636e\u6211\u4eec\u7684\u5185\u5b58\u4e2d\uff0c\u5b8c\u6210\u8fd9\u4e2a\u6570\u636e\u7684\u7ec4\u88c5\uff0c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u8fd9\u662f\u4e00\u79cd\u89e3\u6c7a\u65b9\u5f0f</li> <li>\u90a3\u4e48\u5982\u679c\u9047\u5230\u6570\u636e\u91cf\u5927\uff0c \u901a\u8fc7\u6279\u5904\u7406\u8fd8\u662f\u63a5\u53e3\u54cd\u5e94\u6162\u600e\u4e48\u529e<ul> <li>\u5c31\u53ef\u4ee5\u901a\u8fc7\u7f13\u5b58\u7684\u65b9\u5f0f\uff0c \u5728\u9996\u6b21\u8bfb\u53d6\u7684\u65f6\u5019\u3002 \u5c06\u8ba1\u7b97\u597d\u7684\u7ed3\u679c\u96c6\u7f13\u5b58\u5728redis\u91cc\u9762\uff0c \u5728\u4e0b\u6b21\u8bfb\u53d6\u7684\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u8bfb\u53d6\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u4e86</li> <li>redis\u8ddf\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u53cc\u5199\u4e00\u81f4\u6027\u3002 \u90a3\u4e48\u5728\u7528\u6237\u4e0b\u5355\u7684\u65f6\u5019\uff0c \u9700\u8981\u989d\u5916\u505a\u4e00\u4e2a\u6b65\u9aa4\uff0c\u5c31\u662f\u540c\u6b65\u597dredis\u91cc\u7684\u6570\u636e</li> <li>\u4e5f\u53ef\u4ee5\u5728\u5e93\u91cc\u9762\u6765\u5efa\u8fd9\u4e2a\u6c47\u603b\u8868\uff0c\u5c06\u7ed3\u679c\u96c6\u653e\u5728\u6c47\u603b\u8868\u91cc\u9762\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u6d88\u606f\u961f\u5217\uff0c\u6216\u8005\u5176\u4ed6\u4ec0\u4e48\u5f02\u6b65\u7684\u65b9\u5f0f\u6765\u540c\u6b65\uff0c\u66f4\u65b0\u6c47\u603b\u8868\u5c31\u53ef\u4ee5\u4e86\uff0c\u90a3\u4e48\u8fd9\u6837\u5728\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u67e5\u8be2\u6c47\u603b\u8868\uff0c\u800c\u4e0d\u662f\u518d\u53bb\u67e5\u5404\u4e2a\u4e2d\u5fc3\uff0c\u90fd\u662f\u5c5e\u4e8e\u8fd9\u4e2a\u5178\u578b\u7684\u7a7a\u95f4\u6362\u65f6\u95f4</li> </ul> </li> </ul>"},{"location":"chap7/int_anws/#3_1","title":"3 \u6d88\u606f\u961f\u5217","text":""},{"location":"chap7/int_anws/#1_3","title":"1 \u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528\u6d88\u606f\u961f\u5217","text":"<p>\u4e00\u6761\u4e00\u6761\u7684\u6d88\u606f\u5728\u6392\u961f\u7b49\u5f85\u6d88\u8d39,  \u7f51\u4e0a\u4e70\u4e1c\u897f\u4e5f\u8981\u6392\u961f\u3002 \u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662f\u5e94\u7528\u6d88\u606f\u961f\u5217\uff0c\u5c06\u76f8\u5173\u7684\u6307\u4ee4\u6765\u505a\u4e00\u4e2a\u6392\u961f\uff0c \u7b49\u5f85\u4e1a\u52a1\u65b9\u6162\u6162\u7684\u53bb\u5904\u7406\u3002 </p> <p>\u6d88\u606f\u53d1\u5e03\u8005\u53ea\u7ba1\u628a\u6d88\u606f\u53d1\u5e03\u5230mg\u4e2d\uff0c\u800c\u4e0d\u7528\u7ba1\u8c01\u6765\u53d6\uff0c\u90a3\u4e48\u6d88\u606f\u4f7f\u7528\u8005\u4e5f\u53ea\u7ba1\u4ecemq\u4e2d\u53d6\u6d88\u606f, \u800c\u4e0d\u7ba1\u662f\u8c01\u53d1\u5e03\u7684.</p> <p>\u4e0b\u5355\u6210\u529f, \u5c31\u53d1\u6d88\u606f\u7ed9\u79ef\u5206\u4e2d\u5fc3, \u518d\u53d1\u6d88\u606f\u7ed9\u901a\u77e5\u4e2d\u5fc3, \u6392\u961f\u5904\u7406\u652f\u4ed8\u6210\u529f\u901a\u77e5\u7684\u4e1a\u52a1. \u6392\u961f\u8bb0\u5f55\u7528\u6237\u7684\u91cd\u8981\u64cd\u4f5c, \u8fd9\u4e9b\u64cd\u4f5c\u54cd\u5e94\u4e0d\u7528\u5f88\u53ca\u65f6. \u6240\u6709\u6307\u4ee4\u8fdb\u884c\u6392\u961f, \u7b49\u5230\u4e5f\u6709\u4e0d\u5fd9\u7684\u65f6\u5019\u6765\u5904\u7406. \u8fd9\u79cd\u573a\u666f\u5462\u4e5f\u53eb\u6d41\u91cf\u524a\u5cf0</p> <p>\u6211\u4eec\u4e0d\u7528\u628a\u6240\u6709\u7684\u64cd\u4f5c, \u90fd\u6253\u5305\u5728\u4e00\u4e2a\u4e0b\u5355\u7684\u63a5\u53e3\u91cc\u9762. \u800c\u662f\u628a\u4e1a\u52a1\u505a\u4e86\u4e00\u4e9b\u62c6\u5206, \u6bd4\u5982\u79ef\u5206\u4e2d\u5fc3</p> <p>\u5e94\u7528\u6d88\u606f\u961f\u65e0\u5916\u4e4e\u5c31\u4e09\u4e2a\u65b9\u9762</p> <ul> <li>\u4e00\u4e2a\u662f\u5f02\u6b65\u5904\u7406</li> <li>\u4e00\u4e2a\u662f\u6d41\u91cf\u524a\u5cf0</li> <li>\u4e00\u4e2a\u662f\u5e94\u7528\u89e3\u8026</li> </ul>"},{"location":"chap7/int_anws/#2_3","title":"2 \u6d88\u606f\u961f\u5217 \u5e36\u6765\u4e86\u54ea\u4e9b\u95ee\u9898","text":"<p>\u6d88\u606f\u961f\u5217\u6240\u5e26\u6765\u7684\u4e00\u4e9b\u95ee\u9898\uff0c\u5305\u542b\u53ef\u7528\u6027\u95ee\u9898\uff0c\u4e00\u81f4\u6027\u95ee\u9898\uff0c\u590d\u6742\u6027\u95ee\u9898\u3002 </p> <p>\u7cfb\u7edf\u539f\u5148\u53ef\u80fd\u5904\u7406\u7684\u597d\u597d\u7684\uff0c \u786c\u751f\u751f\u7684\u52a0\u4e86\u4e00\u4e2aMQ\uff0c\u591a\u4e86\u4e00\u4e2a\u4e2d\u95f4\u4ef6\uff0c \u53ef\u80fd\u4f1a\u589e\u52a0\u7cfb\u7edf\u7684\u590d\u6742\u5ea6\u3002  \u600e\u4e48\u4fdd\u8bc1\u6d88\u606f\u6709\u6ca1\u6709\u91cd\u590d\u6d88\u8d39\uff0c \u600e\u4e48\u5904\u7406\u6d88\u606f\u4e22\u5931\u7684\u60c5\u51b5\uff0c \u600e\u4e48\u4fdd\u8bc1\u6d88\u606f\u4f20\u9012\u7684\u987a\u5e8f\u6027\u3002 </p> <p>\u5f15\u5165MQ\u6ca1\u6709\u592a\u591a\u7684\u5de5\u4f5c, \u53ef\u80fd\u5dee\u4e0d\u591a10%\u7684\u5de5\u4f5c\u91cf,  \u5904\u7406\u53ef\u80fd\u4f1a\u5e26\u6765\u5f88\u591a\u7684\u95ee\u9898. \u589e\u52a0\u7684\u590d\u6742\u5ea6\u53ef\u80fd\u8981\u7ffb\u4e00\u500d</p> <p>\u53ef\u7528\u6027</p> <p>\u7cfb\u7edf\u5f15\u5165\u4e86\u8fd9\u4e2a\u5916\u90e8\u7684\u4f9d\u8d56\u8d8a\u591a, \u8d8a\u5bb9\u6613\u6302\u3002 \u4f46\u662f\u5982\u679c\u5f15\u5165MQ\u591a\u4e86\u4e00\u4e2a\u4e2d\u95f4\u4ef6,  \u4e07\u4e00mq\u6302\u6389\u6574\u4e2a\u6a21\u5757\u5462\u53ef\u80fd\u90fd\u6302\u3002 </p> <p>\u5982\u679c\u4e2d\u95f4\u7684\u8fd9\u4e2a\u6d88\u606f\u961f\u5217\u6302\u6389, \u51fa\u73b0\u4e00\u4e9b\u4e00\u81f4\u6027\u7684\u95ee\u9898. \u6bd4\u5982\u8bf4\u5904\u7406\u8fd9\u4e2a\u8ba2\u5355\u6570\u636e, \u7136\u540e\u5982\u679c\u8981\u540c\u6b65\uff0c\u6765\u540c\u6b65\u5230\u591a\u4e2a\u7cfb\u7edf\u4e2d\u6216\u8005mq\u5f02\u5e38\u957f\u65f6\u95f4\u5f97\u4e0d\u5230\u54cd\u5e94\uff0c \u6570\u636e\u957f\u65f6\u95f4\u66f4\u65b0\u4e0d\u4e0a\u53bb\u3002 \u51fa\u73b0\u8fd9\u4e2a\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5</p> <p>\u5e94\u7528\u6d88\u606f\u961f\u5217\u7684\u95ee\u9898 </p> <ul> <li>\u53ef\u7528\u6027\u95ee\u9898</li> <li>\u4e00\u81f4\u6027\u95ee\u9898</li> <li>\u590d\u6742\u6027\u95ee\u9898</li> </ul>"},{"location":"chap7/int_anws/#3_2","title":"3 \u6d88\u606f\u961f\u5217 \u5982\u4f55\u89e3\u6c7a\u6d88\u606f\u91cd\u590d\u7684\u95ee\u9898","text":"<p>\u7528\u6237\u5728\u5546\u57ce\u4e2d\u5fc3\u4e0b\u5355\u6210\u529f\u4e86, \u7136\u540e\u901a\u8fc7\u6d88\u606f\u961f\u5217, \u53d1\u9001\u6d88\u606f\u7ed9\u8fd9\u4e2a\u79ef\u5206\u7cfb\u7edf\u53bb\u5956\u52b1\u79ef\u5206. \u5047\u5982\u51fa\u73b0\u4e86\u8fd9\u4e2a\u6d88\u606f\u91cd\u590d,  \u6bd4\u5982\u8bf4\u79ef\u5206\u7cfb\u7edf\u6536\u5230\u4e86\u540c\u4e00\u4e2a\u7528\u6237, \u540c\u4e00\u4e2a\u8ba2\u5355\u4e24\u6761\u76f8\u540c\u7684\u6d88\u606f\u4f1a\u600e\u4e48\u6837?  \u51fa\u73b0\u4e86\u91cd\u590d\u6d88\u606f\u7684\u53ef\u80fd\u6027\u6709\u5f88\u591a</p> <p>\u53d1\u9001\u65b9\u4e3a\u4e86\u9632\u6b62\u6d88\u606f\u4e1f\u5931\uff0c \u505a\u4e86\u6d88\u606f\u8865\u507f\uff0c \u8fd9\u79cd\u60c5\u51b5\u5f88\u591a\u554a\uff0c\u4e00\u822c\u90fd\u662f\u6d88\u8d39\u65b9\uff0c \u54cd\u5e94\u8d85\u65f6\u5f88\u6709\u53ef\u80fd\u662f\u7f51\u7edc\u6296\u52a8\u6216\u8005\u662fMQ\u6302\u4e86.  \u53cd\u6b63\u5c31\u662f\u53d1\u9001\u65b9\u957f\u65f6\u95f4\u6536\u4e0d\u5230\u6d88\u8d39\u6210\u529f\u7684\u6d88\u606f.  \u5c31\u4f1a\u518d\u6b21\u53d1\u9001\u4e00\u6761\u6d88\u606f\u8fdb\u884c\u8865\u507f</p> <p>\u5f53\u7136\u5982\u679c\u6d88\u8d39\u7aef\u8fd8\u662f\u54cd\u5e94\u4e0d\u53ca\u65f6, \u90a3\u4e48\u53ef\u80fd\u5c31\u4f1a\u591a\u6b21\u8865\u507f. \u4e0d\u505c\u7684\u5c1d\u8bd5\u91cd\u53d1\u6d88\u606f.  \u9700\u8981\u9488\u5bf9\u8fd9\u4e2a\u79ef\u5206\u7d2f\u79ef\u63a5\u53e3, \u505a\u5e42\u7b49\u8bbe\u8ba1\u3002 \u5c31\u53bb\u505a\u8fd9\u4e2a\u6d88\u606f\u53bb\u91cd\u5904\u7406\uff0c \u6bd4\u5982\u8bf4\u4e0b\u5355\u4e2d\u5fc3\uff0c\u7684\u786e\u4fdd\u53d1\u9001\u7684\u6d88\u606f\u53ea\u67091\u6761\uff0c\u4f46\u662f\u4e0d\u80fd\u76f8\u4fe1\u4ed6\u4f9d\u8d56\u4ed6\u3002 </p> <p>\u53ea\u6709\u5728\u79ef\u5206\u4e2d\u95f4\u505a\u4e86\u5e42\u7b49\u8bbe\u8ba1\uff0c \u624d\u6709\u53ef\u80fd\u5b8c\u5168\u907f\u514d\u8fd9\u79cd\u548c\u94b1\u76f8\u5173\u7684bug\u3002 \u6bd5\u7adf\u5982\u679c\u4f9d\u8d56\u4e0a\u771f\u6b63\u51fa\u4e86\u3002 </p> <p>\u79ef\u5206\u4e2d\u5fc3\u7684\u5bc6\u5e42\u7b49\u5904\u7406\u4e5f\u5f88\u7b80\u5355\uff0c \u6839\u636e\u7528\u6237\u8ba2\u5355\u53f7\u6216\u8005\u662f\u6d41\u6c34\u53f7\u505a\u5f3a\u5e42\u7b49\u3002 \u6bcf\u6210\u529f\u64cd\u4f5c1\u6761\u79ef\u5206\u5956\u52b1\uff0c \u5c31\u8bb0\u5f55\u4e0b\u6765\u3002 \u5373\u4f7f\u662f\u628a\u6d88\u606f\u91cd\u590d\u4e86\uff0c\u53ea\u8981\u5224\u65ad\u540c\u4e00\u4e2a\u8ba2\u5355\u53f7\uff0c\u90a3\u4e48\u5c31\u662f\u505a\u597d\u63a5\u53e3\u7684\u5e42\u7b49\u8bbe\u8ba1</p>"},{"location":"chap7/int_anws/#4_1","title":"4 \u5e94\u5bf9\u6d88\u606f\u91cd\u590d \u5e42\u7b49\u8bbe\u8ba1\u7684\u51e0\u79cd\u65b9\u6848","text":"<p>\u65b9\u6848\u4e00</p> <p>\u901a\u8fc7\u7ea8\u675f\u63a7\u5236\uff0c \u6bd4\u5982\u8bf4\u5229\u7528\u6570\u636e\u5e93\u7684unique\u7d20\u5f15\uff0c\u4e5f\u53ef\u4ee5\u5229\u7528redis\u7684setnx\u6765\u505a\u7ea6\u675f\u3002\u5982\u679crelis\u4e2d\u5b58\u5728\u554a\u5bf9\u5e94\u7684\u6807\u8bc6\uff0c\u90a3\u4e48\u5c31\u76f4\u63a5\u62d2\u7edd\u63d2\u5165\u3002 \u5229\u7528\u4e86\u6570\u636e\u5e93\u6216\u8005redis\u4e00\u4e2a\u7ea6\u675f\u63a7\u5236\u6765\u8fbe\u5230\u4e86\u6d88\u606f\u7684\u5e42\u7b49</p> <p>\u65b9\u68482</p> <p>\u8bbe\u7f6e\u524d\u7f6e\u6761\u4ef6</p> <p>\u6bd4\u5982\u8bf4\u5728\u6d88\u8d39\u7aef\u5904\u7406\u4e4b\u524d, \u67e5\u8be2\u4e00\u4e0b\u6570\u636e\u5e93.\u5224\u65ad\u8ba2\u5355\u53f7,\u5bf9\u5e94\u7684\u79ef\u5206\u5956\u52b1\u5230\u5e95\u6709\u6ca1\u6709\u53d1\u653e\u6210\u529f. \u5982\u679c\u53d1\u653e\u6210\u529f\u4e86,\u90a3\u4e48\u5c31\u4e0d\u518d\u8fdb\u884c\u91cd\u590d\u5956\u52b1. \u5f53\u7136\u8fd9\u4e2a\u67e5\u8be2\u8981\u52a0\u4e00\u4e2a\u5206\u5e03\u5f0f\u9501, \u9632\u6b62\u51fa\u73b0\u5e76\u53d1\u7684\u64cd\u4f5c. </p> <p>\u5229\u7528\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u67e5\u8be2\u5904\u7406, \u5e38\u8bf4\u7684\u6570\u636e\u5e93\u7248\u672c\u53f7.  \u7ed9\u5f53\u524d\u8981\u5904\u7406\u7684\u6570\u636e, \u8bbe\u7f6e\u4e00\u4e2a\u7248\u672c\u53f7\u5c5e\u6027.  \u5982\u679c\u5904\u7406\u8fc7\u4e86, \u7248\u672c\u53f7\u5c31\u52a0\u4e00.</p> <p>\u5728\u66f4\u65b0\u5904\u7406\u72b6\u6001\u7684\u65f6\u5019,  \u4f1a\u5bf9\u6bd4\u7248\u672c\u53f7.  \u5982\u679c\u4e0d\u4e00\u81f4\u8bf4\u660e\u5df2\u7ecf\u5904\u7406\u8fc7\u4e86. \u91cd\u590d\u7684\u6d88\u606f, \u5c31\u4e0d\u518d\u8fdb\u884c\u76f8\u5e94\u7684\u5904\u7406. \u4e5f\u662f\u6570\u636e\u5e93\u4e50\u89c2\u9501\u7684\u5b9e\u73b0\u65b9\u5f0f\u4e4b\u4e00</p> <p>\u65b9\u68483</p> <p>\u5229\u7528\u4e86\u6570\u636e\u7684\u7248\u672c\u53f7\uff0c\u5229\u7528\u7ed9\u6d88\u606f\u8bbe\u7f6e\u4e00\u4e2a\u5168\u5c40\u7684ID. \u5176\u4ed6\u7684\u91cd\u590d\u6d88\u606f\u5c31\u76f4\u63a5\u62d2\u7edd</p> <p>\u4e5f\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528\uff0c \u6bd4\u5982\u8bf4\u6570\u636e\u5e93\u7684\u8fd9\u4e2aunique\u7d20\u5f15\uff0c \u8ddf\u524d\u7f6e\u6761\u4ef6\u7684\u8fd9\u4e2a\u5224\u65ad\u3002 \u679c\u524d\u7f6e\u7684\u6761\u4ef6\u51fa\u73b0\u4e86\u4e00\u4e9b\u6f0f\u7f51\u4e4b\u9c7c\uff0c \u5728\u6570\u636e\u5e93\u5c42\u7684\u8fd9\u4e2aunique\u7d22\u5f15\u5462</p>"},{"location":"chap7/int_anws/#5","title":"5 \u6d88\u606f\u961f\u5217 \u5982\u4f55\u89e3\u51b3\u6d88\u606f\u4e22\u5931\u95ee\u9898","text":"<p>\u6d88\u606f\u4e22\u5931\uff0c\u5f88\u591a\u73b0\u5728\u4e3b\u6d41\u7684\u6d88\u606f\u961f\u5217\u3002\u7c7b\u4f3c\u4e8e rabbitmq, kafka, rocketmq\u4e5f\u90fd\u63d0\u4f9b\u4e86\u6bd4\u8f83\u5b8c\u5584\u7684\u8fd9\u4e2a\u6d88\u606f\u53ef\u9760\u7684\u4fdd\u969c\u673a\u5236\u3002 \u5b8c\u5168\u53ef\u4ee5\u505a\u5230\u5728\u6d88\u606f\u4f20\u9012\u7684\u8fc7\u7a0b\u4e2d\uff0c \u5982\u679c\u786c\u4ef6\u7684\u6545\u969c\uff0c \u7f51\u7edc\u4e2d\u65ad\u4e5f\u80fd\u786e\u4fdd\u6d88\u606f\u7684\u53ef\u9760\u4f20\u9012\u3002 </p> <p>\u4e3a\u4e86\u4e0d\u4e22\u6d88\u606f\uff0c\u867d\u7136\u4e0d\u540c\u7684\u6d88\u606f\u961f\u5217\u63d0\u4f9b\u7684API\u4e0d\u4e00\u6837, \u76f8\u5173\u7684\u914d\u7f6e\u9879\u4e5f\u4e0d\u4e00\u6837. \u4f46\u662f\u5b9e\u73b0\u7684\u539f\u7406\u57fa\u672c\u662f\u4e00\u81f4\u7684\u3002\u90fd\u662f\u901a\u8fc73\u4e2a\u9636\u6bb5\u6765\u4fdd\u969c</p> <ul> <li>\u4e00\u4e2a\u662f\u5728\u6d88\u606f\u7684\u751f\u4ea7\u9636\u6bb5<ul> <li>\u5728\u751f\u4ea7\u9636\u6bb5\uff0c\u6d88\u606f\u961f\u5217\u662f\u901a\u8fc7\u5e38\u7528\u7684\u8bf7\u6c42\u786e\u8ba4\u673a\u5236\u3002 \u6765\u4fdd\u969c\u6d88\u606f\u7684\u53ef\u9760\u4f20\u9012\u7684\u3002\u5f53\u4ee3\u7801\u8c03\u7528\u53d1\u6d88\u606f\u7684\u65b9\u6cd5\uff0c\u6d88\u606f\u961f\u5217\u5c31\u4f1a\u628a\u6d88\u606f\u53d1\u9001\u5230broker, \u90a3\u4e48broker\u6536\u5230\u6d88\u606f\u4e4b\u540e, \u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u786e\u8ba4\u54cd\u5e94. \u8868\u660e\u6d88\u606f\u5df2\u7ecf\u6536\u5230\u4e86 </li> <li>\u6709\u4e9b\u6d88\u606f\u961f\u5217, \u5728\u957f\u65f6\u95f4\u6ca1\u6536\u5230, \u8fd9\u4e2a\u786e\u8ba4\u54cd\u5e94\u4e4b\u540e. \u4f1a\u81ea\u52a8\u91cd\u8bd5\u6765\u505a\u4e00\u4e2a\u6d88\u606f\u8865\u507f, \u4ee5\u786e\u4fdd\u6d88\u606f\u80fd\u591f\u6b63\u5e38\u7684\u53d1\u9001\u5230\u7684broker\u4e2d. </li> </ul> </li> <li>\u4e00\u4e2a\u662f\u5728\u6d88\u606f\u7684\u5b58\u50a8\u9636\u6bb5<ul> <li>\u5728\u5b58\u50a8\u9636\u6bb5, \u5176\u5b9e\u4e00\u822c\u6d88\u606f\u4e0d\u4f1a\u4e1f. \u9664\u975e\u51fa\u73b0\u4e86\u4e00\u4e9b\u786c\u4ef6\u6545\u969c\u3002 \u6bd4\u5982\u8bf4\u8fdb\u7a0b\u6302\u6389\u4e86\u6216\u8005\u662f\u670d\u52a1\u5668\u5b95\u673a\u4e86\u3002\u90a3\u8fd9\u79cd\u60c5\u51b5\u5462\u53ef\u80fd\u662f\u4f1a\u4e1f\u6d88\u606f\u7684</li> <li>\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c \u505a\u4e00\u4e9b\u6301\u4e45\u5316\u7684\u5b58\u50a8\u3002 \u8fd9\u4e2a\u6d88\u606f\u961f\u5217\u4e5f\u4f1a\u63d0\u4f9b\u4e00\u4e9b\u76f8\u5e94\u7684\u5237\u5c4f\u914d\u7f6e\u3002 \u4e0d\u7528\u53bb\u624b\u5de5\u7684\u5199\u4ee3\u7801\u5904\u7406\uff0c\u5b58\u50a8\u7684braker\u6302\u6389\uff0c \u90a3\u4e48\u6d88\u606f\u5462\u4e5f\u4e0d\u4f1a\u4e1f\uff0c\u91cd\u542f\u4e4b\u540e\u53ef\u4ee5\u7ee7\u7eed\u5904\u7406\u6d88\u606f\u3002 </li> </ul> </li> <li>\u6d88\u606f\u7684\u6d88\u8d39\u9636\u6bb5\uff0c\u8ddf\u751f\u4ea7\u9636\u6bb5\u5176\u5b9e\u662f\u5dee\u4e0d\u591a\u3002 \u4e5f\u90fd\u662f\u901a\u8fc7ack\u7684\u786e\u8ba4\u673a\u5236\uff0c\u6765\u786e\u4fdd\u6d88\u606f\u7684\u53ef\u9760\u4f20\u9012\u3002 \u4ecebroker\u62c9\u53d6\u6d88\u606f\u4e4b\u540e, \u7136\u540e\u53d1\u9001\u5230\u6d88\u8d39\u7aef\u53bb\u5904\u7406 \u5904\u7406\u5b8c\u6210\u4e4b\u540e, \u5728\u7ed9\u4e2a\u56de\u8c03\uff0c\u544a\u77e5broker\u5df2\u7ecf\u6d88\u8d39\u5b8c\u6210<ul> <li>\u5982\u679cbroker\u6ca1\u6709\u6536\u5230\u6d88\u606f\u786e\u8ba4\u7684\u54cd\u5e94, \u4e5f\u4f1a\u8fdb\u884c\u6d88\u606f\u7684\u8865\u507f,\u8fd8\u4f1a\u53d1\u9001\u540c\u4e00\u6761\u6d88\u606f\u786e\u4fdd, \u6d88\u606f\u4e0d\u4f1a\u5728\u7f51\u7edc\u4f20\u8f93\u7684\u8fc7\u7a0b\u4e2d\u4e22\u5931</li> </ul> </li> </ul> <p>\u603b\u7ed3\u4e0b\u6765\u4fdd\u969c\u6d88\u606f\u4e0d\u4e1f\u5931\u7684\u7b56\u7565</p> <ul> <li>\u751f\u4ea7\u9636\u6bb5\uff0c\u6d88\u8d39\u9636\u6bb5\u7684Ack\u786e\u8ba4\u673a\u5236</li> <li>\u5b58\u50a8\u9636\u6bb5\u554a\u6301\u4e45\u5316\u5b58\u50a8\u7684\u914d\u7f6e</li> </ul>"},{"location":"chap7/int_anws/#6_1","title":"6 \u5982\u4f55\u68c0\u6d4b\u6d88\u606f\u4e22\u5931\u8c08\u8c08\u6d88\u606f\u4e22\u5931\u7684\u515c\u5e95\u65b9\u6848","text":"<p>\u53ef\u4ee5\u5229\u7528\u62e6\u622a\u5668\u7684\u673a\u5236\uff0c \u5728\u751f\u4ea7\u7aef\u9650\u53d1\u9001\u6d88\u606f\u4e4b\u524d\uff0c \u901a\u8fc7\u62e6\u622a\u5668\u5c06\u6d88\u606f\u7248\u672c\u53f7\u6ce8\u5165\u5230\u6d88\u606f\u4e2d\u3002 </p> <p>\u90a3\u7248\u672c\u53f7\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u8fde\u7eed\u9012\u589e\u7684ID\u751f\u6210\uff0c \u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u5206\u5e03\u5f0f\u7684\u5168\u533aID\uff0c\u5728\u6d88\u8d39\u7aef\u6536\u5230\u4e86\u6d88\u606f\u4e4b\u540e\uff0c \u518d\u901a\u8fc7\u62e6\u622a\u5668\u628a\u7248\u672c\u53f7\u8bb0\u5f55\u4e0b\u6765\uff0c\u518d\u901a\u8fc7\u62e6\u622a\u5668\u628a\u7248\u672c\u53f7\u8bb0\u5f55\u4e0b\u6765\u3002 </p> <p>\u5982\u679c\u68c0\u6d4b\u8fd9\u4e2a\u7248\u672c\u53f7\u8fde\u7eed\u6027\u6216\u8005\u4ed6\u7684\u6d88\u8d39\u72b6\u6001\uff0c\u6765\u5224\u65ad\u5230\u5e95\u6709\u6ca1\u6709\u4e22\u6d88\u606f\u3002 \u5982\u679c\u4e1f\u4e86\u6d88\u606f\uff0c\u90a3\u4e48\u53ef\u4ee5\u518d\u8fdb\u884c\u8fd9\u4e2a\u6d88\u606f\u7684\u8865\u507f\uff0c\u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662f\u5e38\u8bf4\u7684AOP\uff0c \u90a3\u4e48aop\u7684\u4f18\u52bf\uff0c\u4e0d\u7528\u4fb5\u5165\u5230\u5177\u4f53\u7684\u4e1a\u52a1\u4ee3\u7801\u4e2d\u3002 \u8026\u5408\u5ea6\u6bd4\u8f83\u4f4e\u3002</p> <p>\u53e6\u5916\u4e00\u4e2a\u65b9\u6848\u6bd4\u8f83\u7b80\u5355\uff0c \u6839\u636e\u72b6\u6001\uff0c\u6d88\u8d39\u9001\u79ef\u5206\u7684\u4f8b\u5b50\u3002\u5b9a\u671f\u53bb\u68c0\u67e5\u5230\u5e95\u6709\u6ca1\u6709\u6210\u529f\u6536\u5230\u79ef\u5206\u3002 \u770b\u8fd9\u4e2a\u72b6\u6001\u7801\u7684\u53d8\u5316\uff0c \u5982\u679c\u6ca1\u53d8\uff0c\u90a3\u5c31\u8bf4\u660e\u6211\u4eec\u6d88\u606f\u5904\u7406\u5931\u8d25\u4e86\u6216\u8005\u662f\u4e1f\u4e86\u6216\u8005\u5176\u4ed6\u4ec0\u4e48\u539f\u56e0\u3002 </p> <p>\u90a3\u5c31\u9700\u8981\u989d\u5916\u7684\u53bb\u5904\u7406\uff0c \u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u5b9a\u65f6\u4efb\u52a1\u3002\u90a3\u4e48\u6bcf\u9694\u51e0\u5206\u949f\uff0c\u53ef\u4ee5\u53bb\u5b9a\u671f\u7684\u68c0\u67e5\u9001\u79ef\u5206\u8fd9\u4e2a\u6d88\u8d39\u60c5\u6cc1\u3002 \u90a3\u4e48\u4e00\u6709\u5f02\u5e38\uff0c \u5c31\u53ef\u4ee5\u8fdb\u884c\u989d\u5916\u7684\u5904\u7406\uff0c\u7136\u540e\u53bb\u53d8\u66f4\u5904\u7406\u72c0\u6001.</p> <p>\u9632\u6b62\u6d88\u606f\u4e1f\u5931\u7684\u515c\u5e95\u65b9\u6848\uff0c\u4e24\u4e2a\u65b9\u9762</p> <ul> <li>\u4e00\u4e2a\u662f\u68c0\u6d4b\u6211\u4eec\u7684\u7248\u672c\u53f7\u7684\u8fde\u7eed\u6027, \u6709\u4e0d\u8fde\u7eed\u7684\u8bf4\u660e\u8fd9\u4e2a\u4e22\u4e86\u6d88\u606f</li> <li>\u53e6\u5916\u4e00\u4e2a\u5462\u662f\u6839\u636e\u8ba2\u5355\u7684\u72b6\u6001\u7801, \u5982\u679c\u6ca1\u6709\u53d8\u66f4, \u90a3\u5c31\u8bf4\u660e\u9700\u8981\u8fdb\u884c\u989d\u5916\u7684\u5904\u7406. \u6765\u4fdd\u969c\u6211\u4eec\u7684\u6b63\u5e38\u8fd0\u8f6c</li> </ul>"},{"location":"chap7/int_anws/#7_1","title":"7 \u6d88\u606f\u961f\u5217\u5982\u4f55\u4fdd\u8bc1\u987a\u5e8f\u6d88\u8d39","text":"<p>\u5206\u5e03\u5f0f\u67b6\u6784\uff0c\u6d88\u606f\u9700\u8981\u5206\u53d1\u7ed9\u591a\u4e2a\u6d88\u8d39\u8005\u9700\u8981\u540c\u65f6\u5904\u7406\u3002 </p> <p>\u6d88\u606f\u961f\u5217\u4e2d\u7684\u6d88\u606f\u5c31\u4e0d\u80fd\u4fdd\u8bc1\uff0c\u65e0\u6cd5\u4fdd\u8bc1\u6d88\u8d39\u7684\u987a\u5e8f\u6027\u3002 </p> <p>\u90a3\u600e\u4e48\u89e3\u6c7a\uff0c\u5173\u952e\u5462\u5c31\u5728\u4e8e\u5728\u6d88\u8d39\u8005\u6d88\u8d39\u4e4b\u524d\uff0c\u5c06\u6709\u76f8\u5173\u6027\u7684\u8fd9\u4e2a\u6570\u636e\uff0c\u987a\u5e8f\u7684\u5199\u5165\u5230\u540c\u4e00\u4e2a\u961f\u5217\u4e2d\u540c\u4e00\u4e2a\u8ba2\u5355\u7684\u79ef\u5206\u5904\u7406\u3002 </p> <p>\u77ed\u4fe1\u53d1\u9001\u5fc5\u987b\uff0c\u8fdb\u5165\u540c\u4e00\u4e2a\u961f\u5217\u4e2d\u3002 \u90a3\u4e48\u4e3a\u4e86\u5206\u538b\uff0c\u961f\u5217\u53ef\u4ee5\u5206\u6210\u597d\u51e0\u5341\u4e2a\uff0c Hash\uff0c\u53d6\u6a21\u3002 </p> <p>\u5148\u5206\u597d\u5bf9\u5217\u4fdd\u8bc1\u76f8\u5173\u7684\u6570\u636e\u8fdb\u5165\u5230\u540c\u4e00\u4e2a\u5bf9\u5217\u4e2d\u3002 \u7136\u540e\u5462\u5728\u6d88\u8d39\u7aef\uff0c \u4e00\u4e2aqueue\u5bf9\u5e94\u4e00\u4e2a\u6d88\u8d39\u7aef\u3002 </p> <p>\u6bd4\u5982\u8bf4\u961f\u5217\uff0c1-5 \u5bf9\u5e94\u6d88\u8d39\u7aefa\u7684\u8fd9\u4e2a5\u4e2a\u6d88\u8d39\u65b9\u6cd5\uff0c \u961f\u52176-10\u5bf9\u5e94\u6d88\u8d39\u7aefb\u7684\u4e94\u4e2a\u6d88\u8d39\u65b9\u6cd5\u3002</p> <p>\u53ef\u4ee5\u91c7\u7528\u591a\u4e2a\u8fd9\u4e2a\u5185\u5b58\u961f\u5217\uff0c\u6bd4\u5982\u8bf4\u8fd9\u4e2a\u540c\u4e00\u4e2a\u8ba2\u5355\u7684\u6d88\u606f\uff0c \u53ef\u4ee5\u8fdb\u5165\u540c\u4e00\u4e2a\u5185\u5b58\u5bf9\u5217\u4e2d\uff0c \u90a3\u4e48\u5904\u7406\u5b8c\u4e86\u5c31\u91ca\u653e\u8be5\u7ebf\u7a0b\uff0c\u90a3\u4e48\u4e5f\u80fd\u591f\u4fdd\u8bc1\u3002</p> <p>\u5728\u591a\u7ebf\u7a0b\u4e0b\u7684\u8fd9\u4e2a\u987a\u5e8f\u5904\u7406\uff0c\u8fd9\u4e2a\u6d88\u606f\u961f\u5217\u7684\u6570\u636e\u6d88\u8d39\u95ee\u9898\u3002 \u53ea\u8981\u4fdd\u8bc1\u4e00\u70b9\u5c31\u662f\u76f8\u5173\u6027\u7684\u6570\u636e\u9700\u8981\u6309\u987a\u5e8f\u3002 \u5199\u5165\u540c\u4e00\u4e2a\u961f\u5217\u4e2d\uff0c\u4fdd\u8bc1\u540c\u4e00\u4e2a\u6d88\u8d39\u7aef\u6d88\u8d39\u5c31\u53ef\u4ee5\u4e86</p>"},{"location":"chap7/int_anws/#8_2","title":"8 \u6d88\u606f\u961f\u5217\u987a\u5e8f\u6d88\u8d39\u7684 \u5e94\u7528\u573a\u666f\u53ca\u89e3\u51b3\u65b9\u6848","text":"<p>\u6570\u636e\u540c\u6b65\u7684\u8fc7\u7a0b\u4e2d, \u5c31\u4f1a\u53d1\u751f\u5148\u53d6\u6d88\u8ba2\u5355, \u7136\u540e\u518d\u4e0b\u5355\u7684\u573a\u666f. \u62c6\u5206\u591a\u4e2aqueue. \u6309\u7167\u8ba2\u5355\u53f7\u53d6\u6a21, Hash\u7684\u65b9\u5f0f\u5206\u6210\u591a\u4e2aqueue. </p> <p></p> <p>\u540c\u4e00\u4e2a\u8ba2\u5355\u53f7\u7684\u4e0b\u5355, \u53d6\u6d88\u8ba2\u5355\u7684\u6d88\u606f, \u8fdb\u5165\u540c\u4e00\u4e2aqueue\u4e2d. \u4e5f\u5c31\u662f\u591a\u4e86\u4e00\u4e9bqueue\u800c\u5df2, \u4e00\u4e2aqueue\u4e00\u4e2aconsumer\u3002</p> <p>queue\u4e2d\u7684\u6d88\u606f\u53c8\u662f\u987a\u5e8f\u7684\uff0c\u6d88\u8d39\u8005\u5c31\u4f1a\u5148\u53d6\u4e0b\u5355\u7684\u6d88\u606f\uff0c\u518d\u53d6\u8ba2\u5355\u53d6\u6d88\u7684\u6d88\u606f\uff0c\u8fd9\u6837\u7684\u8bdd\u5c31\u80fd\u4fdd\u8bc1\u6d88\u606f\u7684\u8fd9\u4e2a\u987a\u5e8f\u6d88\u8d39</p> <p>\u5728\u6d88\u606f\u961f\u5217\u4e2d\u591a\u6761\u8fd9\u4e2a\u77ed\u4fe1\u9a8c\u8bc1\u7801\u7684\u53d1\u9001\u8bf7\u6c42\uff0c \u90a3\u4e48\u4e3a\u4e86\u4fdd\u8bc1\u8fd9\u4e2a\u6821\u9a8c\u7684\u51c6\u786e\u6027\uff0c\u5c31\u5fc5\u987b\u4fdd\u8bc1\u540c\u4e00\u4e2a\u7528\u6237\u540c\u4e00\u4e2a\u573a\u666f\uff0c\u77ed\u4fe1\u9a8c\u8bc1\u7801\u7684\u987a\u5e8f\u6027\uff0c\u89e3\u51b3\u65b9\u6848\u4e5f\u8ddf\u8ba2\u5355\u7684\u573a\u666f\u7c7b\u4f3c \u5c31\u662f\u6309\u7167\u7528\u6237\u7684ID\u53d6\u6a21\uff0c\u6216\u8005Hash\u7684\u65b9\u5f0f\u53d6\u6a21\uff0c\u5206\u6210\u591a\u4e2aqueue.  \u90a3\u4e48\u540c\u4e00\u4e2a\u7528\u6237\u540c\u4e00\u4e2a\u573a\u666f\u53d1\u9001\u9a8c\u8bc1\u7801, \u8fdb\u5165\u540c\u4e00\u4e2aqueue\u4e2d\u3002 </p> <p>\u7136\u540e\u4e00\u4e2aqueue\uff0c \u4e00\u4e2aconsumer, \u8fd9\u6837\u7684\u8bdd\u4e5f\u5c31\u80fd\u4fdd\u8bc1\u6d88\u8d39\u7684\u8fd9\u4e2a\u987a\u5e8f\u6027\u3002 \u4fdd\u969c\u6d88\u606f\u987a\u5e8f\u6d88\u8d39\u7684\u4e5f\u5c31\u4e24\u4e2a\u6b65\u9aa4</p> <ul> <li>\u4e00\u4e2a\u662f\u9700\u8981\u987a\u5e8f\u6d88\u8d39\u7684\uff0c\u76f8\u5173\u6d88\u606f\u8fdb\u5165\u540c\u4e00\u4e2aqueue\u4e2d\uff0c\u90a3\u4e48\u4e3a\u4e86\u5206\u538b\uff0c \u53ef\u4ee5\u62c6\u5206\u6210\u591a\u4e2aqueue\u3002 \u90a3\u4e48\u5176\u5b9e\u5c31\u662f\u591a\u4e86\u4e00\u4e9bqueue\u800c\u5df1\uff0c </li> <li>\u800c\u662f\u8981\u4fdd\u8bc1\u4e00\u4e2aqueue \u4e00\u4e2a consumer</li> </ul>"},{"location":"chap7/int_anws/#9_2","title":"9 \u51fa\u73b0\u4e86\u6d88\u606f\u79ef\u538b\u8be5\u5982\u4f55\u89e3\u51b3","text":"<p>\u6d88\u606f\u961f\u5217\u4e2d\u7684\u6d88\u606f\u90fd\u662f\u5b58\u653e\u5728\u5185\u5b58\u4e2d\u3002 \u5982\u679c\u51fa\u73b0\u4e86\u8fd9\u8fc7\u91cf\u7684\u6d88\u606f\u79ef\u538b\uff0c \u5c31\u4f1a\u5f15\u8d77\u5185\u5b58\u6216\u8005\u78c1\u76d8\u7684\u544a\u8b66\uff0c\u4ece\u800c\u9020\u6210\u54cd\u5e94\u8d85\u65f6\u8fde\u63a5\u963b\u585e\uff0c \u7136\u540e\u8fd8\u4f1a\u5f71\u54cd\u5230\u5176\u4ed6\u961f\u5217\u7684\u4f7f\u7528\uff0c\u5bfc\u81f4\u6574\u4f53\u7684\u670d\u52a1\u4e0d\u53ef\u7528</p> <p>\u4e3a\u4ec0\u4e48\u4f1a\u51fa\u73b0\u6d88\u606f\u79ef\u538b\uff1f</p> <p>\u8fd9\u4e2a\u6d88\u606f\u961f\u5217\u6709\u751f\u4ea7\u7aef\u6709\u6d88\u8d39\u7aef\uff0c \u4e00\u4e2a\u8fdb\u4e00\u4e2a\u51fa\uff0c \u90a3\u4e48\u5982\u679c\u51fa\u73b0\u4e86\u79ef\u538b\u3002</p> <ul> <li>\u8981\u4e48\u5c31\u662f\u8fdb\u7684\u592a\u5feb\uff0c \u751f\u4ea7\u7aef\u4ea7\u751f\u7684\u6d88\u606f\u592a\u591a\u3002 </li> <li>\u8981\u4e48\u5c31\u662f\u51fa\u7684\u592a\u6162\uff0c \u6d88\u8d39\u7aef\u6765\u4e0d\u53ca\u6d88\u8d39\uff0c\u5c31\u4f1a\u4ea7\u751f\u8fc7\u591a\u7684\u6d88\u606f\u79ef\u538b\u5728\u961f\u5217\u4e2d</li> </ul> <p>\u89e3\u51b3\u65b9\u6848\uff0c \u4e5f\u5c31\u662f\u4ece\u8fd9\u4e24\u4e2a\u65b9\u9762\u5165\u624b\uff0c </p> <ul> <li>\u9650\u5236\u751f\u4ea7\u8005\u4ea7\u751f\u6d88\u606f</li> <li>\u52a0\u5feb\u6d88\u8d39\u7aef\u6d88\u8d39\u6d88\u606f</li> </ul> <p>\u52a0\u5feb\u6d88\u8d39\u7aef\u6d88\u8d39\u6d88\u606f\uff0c\u9650\u5236\u751f\u4ea7\u8005\u4ea7\u751f\u6d88\u606f\uff0c\u5176\u5b9e\u5c31\u662f\u7684\u9650\u6d41\u7194\u65ad\u548c\u964d\u7ea7</p> <ul> <li>\u4e00\u90e8\u5206\u6d41\u91cf\u901a\u8fc7\u9650\u6d41\u7b97\u6cd5\uff0c\u7194\u65ad\u7b56\u7565\uff0c\u6bd4\u5982\u8bf4\u5e38\u89c1\u7684\u8fd9\u4e2a\u4ee4\u724c\u6876\u7b97\u6cd5\u3002 \u5148\u8ba9\u4e00\u90e8\u5206\u7528\u6237\u8fdb\u6765\uff0c \u5176\u4ed6\u7684\u7528\u6237\u5728\u5916\u9762\u6392\u961f\uff0c\u7b49\u7cfb\u7edf\u53d1\u653e\u4e86\u4ee4\u724c\u518d\u8ba9\u4ed6\u8fdb\u6765\u3002\u8fd9\u4e2a\u662f\u9650\u6d41</li> <li>\u7194\u65ad\u5c31\u662f\u7cfb\u7edf\u538b\u529b\u8fc7\u5927\uff0c\u8bf7\u6c42\u51fa\u73b0\u4e86\u8d85\u65f6\u6216\u8005\u54cd\u5e94\u5931\u8d25\uff0c \u8fbe\u5230\u4e00\u5b9a\u7684\u6b21\u6570\uff0c\u5c31\u4f1a\u81ea\u52a8\u89e6\u53d1\u7194\u65ad\uff0c\u65ad\u5f00\u670d\u52a1\uff0c\u7136\u540e\u5bf9\u5916\u8fd4\u56de\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff0c \u8fd9\u662f\u751f\u4ea7\u7aef\u7684\u4e00\u4e9b\u4e3e\u63aa</li> </ul> <p>\u6838\u5fc3\u5c31\u662f\u964d\u4f4e\u6d41\u91cf\uff0c\u628a\u8fd9\u4e2a\u4e00\u90e8\u5206\u7528\u6237\u6321\u5728\u5916\u9762\u3002\u5c31\u5728\u6d88\u606f\u79ef\u538b\u7684\u6e90\u5934\u4e0a\u9762\u505a\u4e86\u9650\u5236\u3002 </p> <p>\u6d88\u8d39\u7aef</p> <p>\u6d88\u8d39\u7aef\u7684\u4f18\u5316\u7b56\u7565\u5c31\u662f\u52a0\u5feb\u6d88\u606f\u7684\u6d88\u8d39\u901f\u5ea6\uff0c </p> <ul> <li>\u9996\u5148\u6d88\u8d39\u7aef\u53ef\u4ee5\u505a\u6269\u5bb9\uff0c\u591a\u4e2a\u6d88\u8d39\u7aef\u540c\u65f6\u6765\u6d88\u8d39\u6d88\u606f\uff0c\u8fd9\u5c31\u76f8\u5f53\u4e8e\u505a\u4e86\u4e00\u4e2a\u6a2a\u5411\u6269\u5c55\u3002</li> <li>\u5982\u679c\u4e1a\u52a1\u4ee3\u7801\u5904\u7406\u6bd4\u8f83\u6162\u3002 \u53ef\u80fd\u662f\u9700\u8981\u53bb\u4f18\u5316\u4e00\u4e0b\u4ee3\u7801\u7684\u903b\u8f91\uff0c\u4ece\u4ee3\u7801\u5c42\u9762\u6765\u505a\u4e00\u4e9b\u4f18\u5316</li> <li>\u5982\u679c\u74f6\u9888\u51fa\u73b0\u5728\u6570\u636e\u5e93\uff0c \u5b58\u5e93\u6bd4\u8f83\u6162\u3002\u53ef\u4ee5\u5148\u5b58\u5728redis\u4e2d\uff0c\u7136\u540e\u7b49\u5230\u4e1a\u52a1\u4e0d\u5fd9\u7684\u65f6\u5019\uff0c\u518d\u4eceredis\u4e2d\u628a\u76f8\u5173\u7684\u8fd9\u4e2a\u6570\u636e\u6301\u4e45\u5316\u5230\u6211\u4eec\u7684\u6570\u636e\u5e93\u91cc\u9762</li> </ul> <p>\u603b\u7ed3\uff1a \u89e3\u6c7a\u6d88\u606f\u79ef\u538b\u65e0\u975e\u5c31\u4e24\u4e2a\u65b9\u6848</p> <ul> <li>\u4e00\u4e2a\u662f\u505a\u597d\u9650\u6d41\uff0c\u5728\u6e90\u5934\u4e0a\u9762\u9632\u6b62\u8fc7\u591a\u7684\u8bf7\u6c42\u8fdb\u6765\uff0c\u9020\u6210\u6d88\u606f\u79ef\u538b\uff0c\u8981\u4e48\u6269\u5bb9\uff0c\u8981\u4e48\u5c31\u4f18\u5316\u4ee3\u7801</li> <li>\u8981\u4e48\u5c31\u662f\u6539\u53d8\u6211\u4eec\u7684\u5b58\u50a8\u7b56\u7565\uff0c\u5728\u6d88\u8d39\u7aef\u7684\u74f6\u9888\u4e0a\u9762\u6765\u4e0b\u529f\u592b</li> </ul>"},{"location":"chap7/int_anws/#10_1","title":"10 \u6d88\u606f\u961f\u5217\u4e2d\u7684\u6b7b\u4fe1\u961f\u5217\u53ca\u5e94\u7528\u573a\u666f","text":"<p>\u4ec0\u4e48\u662f\u6b7b\u4fe1\u961f\u5217\uff0c\u5c31\u662f\u6d88\u606f\u961f\u5217\u4e2d\u65e0\u6cd5\u6d88\u8d39\u7684\u6d88\u606f\u3002 \u6bd4\u5982\u8bf4\u8fd9\u4e2a\u6d88\u606f\u8fc7\u671f\u4e86\uff0c\u5c31\u4f1a\u88ab\u8fd9\u4e2a\u6d88\u606f\u5bf9\u5217\u4ece\u539f\u6709\u7684\u5bf9\u5217\u4e2d\u5220\u9664\uff0c\u7136\u540e\u5c31\u8f6c\u5230\u4e86\u8fd9\u4e2a\u6b7b\u6027\u961f\u5217, \u518d\u901a\u8fc7\u6d88\u8d39\u7aef\u6765\u6d88\u8d39\u8fd9\u4e9b\u6b7b\u6389\u7684\u6d88\u606f</p> <p>\u8fd9\u5c31\u662f\u6b7b\u4fe1\u961f\u5217\u7684\u4e00\u4e2a\u539f\u7406, \u9488\u5bf9\u6d88\u606f\u79ef\u538b\u7684\u573a\u666f\u3002</p> <p>\u9996\u5148\u8981\u8bbe\u7f6e\u6d88\u606f\u7684\u8fc7\u671f\u65f6\u95f4\uff0c \u8fd9\u4e9b\u6d88\u606f\u5c31\u4f1a\u88ab\u81ea\u52a8\u7684\u8f6c\u79fb\u5230\u6b7b\u4fe1\u961f\u5217\uff0c\u4ed6\u4e0d\u4f1a\u957f\u65f6\u95f4\u7684\u5728\u8fd9\u4e2a\u4e1a\u52a1\u961f\u5217\u4e2d\u5b58\u5728\uff0c\u5c31\u80fd\u591f\u907f\u514d\u6d88\u606f\u957f\u65f6\u95f4\u7684\u5b58\u653e\u5728\u961f\u5217\u4e2d\uff0c\u4e5f\u5c31\u80fd\u591f\u907f\u514d\u8fd9\u4e2a\u6d88\u606f\u79ef\u538b\u800c\u4e14\u8fc7\u671f\u7684\u6d88\u606f\u4e5f\u6ca1\u6709\u4e22\uff0c\u8fdb\u5165\u4e86\u6b7b\u4fe1\u961f\u5217\u7ee7\u7eed\u6d88\u8d39\u3002</p> <p>\u76f8\u5f53\u4e8e\u591a\u4e86\u4e2a\u5206\u538b\u7684\u961f\u5217\uff0c\u6240\u4ee5\u914d\u7f6e\u6b7b\u4fe1\u5bf9\u5217\u4e5f\u662f\u53ef\u4ee5\u89e3\u6c7a\u8fd9\u4e2a\u6d88\u606f\u79ef\u538b\u7684\u95ee\u9898\u3002 </p> <p>\u8fd8\u53ef\u4ee5\u7528\u6765\u5904\u7406\u8fd9\u4e2a\u5ef6\u8fdf\u6d88\u606f\uff0c\u6682\u65f6\u5148\u4e0d\u60f3\u6d88\u8d39\u8fd9\u6761\u6d88\u606f\u3002 \u60f3\u7b495\u5206\u949f\u4e4b\u540e\u518d\u8ba9\u4ed6\u6d88\u8d39. </p> <p>\u4f8b\u5982\u5546\u57ce\u4e0b\u5355\uff0c\u53ef\u80fd\u6709\u4e9b\u7528\u6237\u6210\u529f\u4e0b\u5355\u4e86\uff0c \u4f46\u662f\u8fd9\u4e2a\u65f6\u5019\u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6b7b\u4fe1\u961f\u5217\u3002</p> <p>\u90a3\u4e48\u5728\u7528\u6237\u4e0b\u5355\u4e4b\u540e\uff0c \u53d1\u9001\u4e00\u6761\u9a8c\u8bc1\u6d88\u606f\uff0c\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u6bd4\u5982\u8bf415\u5206\u949f\u3002\u90a3\u4e48\u7b49\u5230\u65f6\u95f4\u8fc7\u4e86\u5c31\u81ea\u52a8\u7684\u8fdb\u5165\u6b7b\u4fe1\u961f\u5217\u3002 \u5728\u6d88\u8d39\u7aef\u53bb\u68c0\u67e5\u6709\u6ca1\u6709\u672a\u652f\u4ed8\u7684\u8ba2\u5355\uff0c\u8fd9\u4e2a\u4e5f\u662f\u5178\u578b\u7684\u901a\u8fc7\u6b7b\u4fe1\u961f\u5217\uff0c\u6765\u5b9e\u73b0\u8fd9\u4e2a\u5ef6\u8fdf\u6d88\u606f\u7684\u4f8b\u5b50\u3002</p>"},{"location":"chap7/int_anws/#11_1","title":"11 \u6d88\u606f\u961f\u5217\u8be5\u5982\u4f55\u9009\u578b\uff1f","text":"<ul> <li>\u53ef\u4e1a\u52a1\u91cf\u6bd4\u8f83\u5927\uff0c\u4f4e\u65f6\u5ef6\u7684\u8fd9\u4e2a\u573a\u666f\u8981\u6c42\u4e0b\u9762\uff0c\u5efa\u8bae\u662f\u9009\u7528racketmq</li> <li>\u9700\u8981\u5904\u7406\u5927\u6279\u91cf\u7684\u6570\u636e\u7684\u540c\u6b65, \u79bb\u7ebf\u8ba1\u7b97 ,\u5efa\u8bae\u9009\u62e9kafka</li> <li>\u4e00\u822c\u573a\u666f\u4e0b\u8003\u8651\u517c\u5bb9, \u96c6\u6210\u7684\u4fbf\u5229\u6027, \u5efa\u8bae\u8003\u8651rabbitmq</li> </ul>"},{"location":"chap7/int_anws/#12_1","title":"12 \u6d88\u606f\u961f\u5217\u4e2d\u7684\u4e8b\u52a1\u6d88\u606f\u5982\u4f55\u4fdd\u8bc1\u6570\u636e\u4e00\u81f4\u6027","text":"<p>\u540c\u6837\u5728\u6d88\u606f\u961f\u5217\u4e2d\u4e5f\u63d0\u4f9b\u4e86\u4e8b\u52a1\u7684\u529f\u80fd\uff0c\u540c\u6837\u4e5f\u662f\u4e3a\u4e86\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027</p> <p>\u5728\u4e0b\u5355\u7684\u4e1a\u52a1\u903b\u8f91\u4e4b\u524d\uff0c\u5148\u53d1\u9001\u4e00\u6761\u4e8b\u52a1\u6d88\u606f\u3002\u4f46\u662f\u8fd9\u4e2a\u6d88\u606f\u662f\u9690\u5f62\u7684\uff0c \u662f\u4e00\u79cd\u7279\u6b8a\u7684\u961f\u5217\uff0c\u7b49\u5230\u4ed6\u53d1\u9001\u6210\u529f\u4e4b\u540e\uff0c\u5c31\u4f1a\u901a\u77e5\u751f\u4ea7\u7aef\uff0c\u53ef\u4ee5\u5f00\u59cb\u4e0b\u5355\u7684\u4e1a\u52a1\u4e86\u3002</p> <p>\u8fd9\u4e2a\u65f6\u5019\u5982\u679c\u4e0b\u5355\u903b\u8f91\u5931\u8d25\u5c31\u5c31\u76f4\u63a5\u56de\u6eda\uff0c\u9690\u5f62\u6d88\u606f\u4e5f\u4f1a\u88ab\u5220\u9664. \u5982\u679c\u4e0b\u5355\u6210\u529f, \u90a3\u4e48\u5c31\u4f1a\u901a\u77e5\u6d88\u606f\u961f\u5217, \u5c06\u9690\u5f62\u7684\u6d88\u606f\u961f\u5217\u8f6c\u6210\u666e\u901a\u6d88\u606f\uff0c \u518d\u53d1\u7ed9\u8fd9\u4e2a\u6d88\u8d39\u7aef\u5b8c\u6210\u6d88\u8d39\u3002</p> <ul> <li>\u5c31\u662f\u5148\u8ba9\u6d88\u606f\u53d1\u9001\u51fa\u53bb\uff0c\u518d\u7b49\u5f85\u4e3b\u4f53\u4e1a\u52a1\u7684\u6267\u884c\u3002 \u5982\u679c\u5931\u8d25\u4e86\u5c31\u5168\u90e8rollback\u3002</li> <li>\u5982\u679c\u6210\u529f\uff0c \u6d88\u606f\u4e5f\u4e0d\u4f1a\u4e22\u5931\uff0c\u56e0\u4e3a\u4e3b\u4f53\u4e1a\u52a1\u5f00\u59cb\u4e4b\u524d\uff0c \u5df2\u7ecf\u53d1\u9001\u6210\u529f\u4e86\uff0c \u8fd9\u5c31\u662f\u4e00\u79cd\u7528\u4e8b\u52a1\u7684\u65b9\u5f0f\uff0c\u6765\u4fdd\u969c\u6d88\u606f\u4e0d\u4e22\u5931\u7684\u89e3\u51b3\u65b9\u6848</li> </ul> <p>ack\u7684\u4fdd\u969c\u673a\u5236\uff08\u9002\u5408\u5355\u4e00\u6d88\u606f\uff09</p> <p>\u53ef\u4ee5\u9632\u6b62\u6d88\u606f\u4e22\u5931\uff0c\u5728\u5927\u90e8\u5206\u7684\u573a\u666f\u4e0b\u3002\u5229\u7528\u6d88\u606f\u961f\u5217\u7684ack\u7406\u8bba\uff0c\u4e5f\u662f\u53ef\u4ee5\u4fdd\u8bc1\u6d88\u606f\u7684\u4e0d\u4e22\u5931\u3002\u4f46\u662f\u6d88\u606f\u961f\u5217\u5f15\u5165\u4e8b\u52a1\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u6d88\u606f\u4e00\u81f4\u6027\u65b9\u6848\u7684\u8865\u5145\u3002 </p> <p>\u5355\u4e00\u7684\u6d88\u606f\u53ef\u80fd\u770b\u4e0d\u51fa\u4ec0\u4e48\uff0c \u5982\u679c\u573a\u666f\u4e2d\u8981\u53d1\u9001\u591a\u6761\u6d88\u606f\u3002\u53ea\u6709\u901a\u8fc7\u4e8b\u52a1\u7684\u65b9\u5f0f\uff0c\u591a\u4e2a\u6d88\u606f\uff0c\u5982\u679c\u5176\u4e2d\u4e00\u4e2a\u6302\u4e86\u5c31\u4f1a\u5168\u90e8\u56de\u6eda\uff0c\u8981\u4e48\u5168\u90e8\u6210\u529f\u8981\u4e48\u5168\u90e8\u5931\u8d25\uff0c\u8fd9\u5c31\u662f\u4e8b\u52a1\u6bd4\u8f83\u597d\u7684\u65b9\u9762</p>"},{"location":"chap7/int_anws/#13_1","title":"13 \u5173\u4e8e\u6d88\u606f\u961f\u5217\u4e8b\u52a1\u4e00\u4e9b\u95ee\u9898\u7684\u89e3\u7b54","text":"<p>1 \u7531\u6d88\u606f\u961f\u5217\u53d1\u51fa\u7684\u8fd9\u4e2a\u9690\u85cf\u6d88\u606f\u662f\u4ec0\u4e48\u610f\u601d</p> <p>\u5176\u5b9e\u5f88\u591a\u7684\u6d88\u606f\u961f\u5217\u53c8\u53eb\u505a\u534a\u6d88\u606f, \u5c31\u662f\u6d88\u606f\u5462\u53ea\u6267\u884c\u4e86\u4e00\u534a\u7684\u529f\u80fd. \u5c31\u662f\u4ece\u8fd9\u4e2a\u751f\u4ea7\u7aef\u5230\u4e86\u6d88\u606f\u961f\u5217\u7684broker, \u8fd9\u4e2a\u65f6\u5019\u5462\u4e95\u4e0d\u662f\u4e00\u4e2a\u6b63\u5e38\u7684\u6d88\u606f, \u53ea\u662f\u5b58\u5728\u65e5\u5fd7\u4e2d\u7684\u4e00\u6761\u8bb0\u5f55\uff0c \u5728rocketmq\u91cc\u9762, \u8fd9\u4e2a\u65e5\u5fd7\u53eb\u505acommitlog.  \u90a3\u4e48\u7b49\u751f\u4ea7\u7aef\u7684\u4e1a\u52a1\u6267\u884c\u6210\u529f\u4e4b\u540e. \u518d\u4ece\u8fd9\u4e2acommitlog\u91cc\u9762\u628a\u8fd9\u4e2a\u76f8\u5173\u7684\u65e5\u5fd7\u8bb0\u5f55\u635e\u51fa\u6765</p> <p>\u90a3\u4e48\u6240\u8c13\u7684\u9690\u85cf\u6d88\u606f\u6216\u8005\u534a\u6d88\u606f\u5c31\u4f1a\u8f6c\u6210\u6b63\u5e38\u6d88\u606f, \u518d\u7531broker\u5462\u8f6c\u5230\u6d88\u8d39\u7aef\u8fdb\u884c\u6d88\u8d39,\u8fd9\u4e2a\u662f\u9690\u85cf\u6d88\u606f\u548c\u534a\u6d88\u606f\u7684\u89e3\u91ca.  \u5c31\u50cfrabbitmq, rocketmq, kafka\uff0c \u4e5f\u90fd\u652f\u6301\u4e86\u8fd9\u4e2a\u4e8b\u52a1\u7684\u529f\u80fd\uff0c</p> <p>\u6d88\u8d39\u7aef\u6d88\u8d39\u5931\u8d25\u4e86\u751f\u4ea7\u7aef\u600e\u4e48\u56de\u6eda</p> <p>\u5176\u5b9e\u6d88\u606f\u961f\u5217\u7684\u4e8b\u52a1\u53ea\u80fd\u4fdd\u8bc1\u4e3b\u4f53\u4e1a\u52a1\u5168\u90e8\u6210\u529f\u7684\u60c5\u51b5\u4e0b\uff0c\u6d88\u606f\u4e5f\u80fd\u591f\u4ece\u751f\u4ea7\u7aef\u6210\u529f\u7684\u53d1\u9001\u5230\u6d88\u606f\u961f\u5217\u7684broker\uff0c\u6240\u4ee5\u5982\u679c\u6d88\u8d39\u7aef\u5931\u8d25\u4e86\u8fd9\u4e2a\u662f\u4e8b\u52a1\u56de\u6eda\u4e0d\u4e86\u7684</p> <p>\u53ea\u80fd\u591f\u4fdd\u8bc1\u6d88\u606f\u5728\u751f\u4ea7\u9636\u6bb5\uff0c\u80fd\u591f\u51c6\u786e\u65e0\u8bef\u7684\u4f20\u9001\u5230\u8fd9\u4e2abroker\uff0c\u6d88\u8d39\u9636\u6bb5\u5b83\u662f\u65e0\u6cd5\u4fdd\u8bc1\u7684</p>"},{"location":"chap7/int_anws/#14","title":"14 \u6d88\u606f\u961f\u5217\u5230\u5e95\u662f \u63a8\u6a21\u5f0f\u8fd8\u662f\u62c9\u6a21\u5f0f","text":"<p>\u6d88\u606f\u961f\u5217\u5230\u5e95\u662f\u63a8\u6a21\u5f0f\u8fd8\u662f\u62c9\u6a21\u5f0f\uff0c\u8981\u5206\u751f\u4ea7\u7aef\u5230broker\uff0c\u4ee5\u53cabroker\u5230\u6d88\u8d39\u7aef\u3002 </p> <p>\u5148\u8bf4\u4e00\u8bf4\u751f\u4ea7\u7aef\u5230\u8fd9\u4e2abroker</p> <p>\u4e1a\u52a1\u7aef\u4ea7\u751f\u4e86\u6d88\u606f\uff0c\u662f\u901a\u8fc7\u63a8\u7684\u6a21\u5f0f\u4f20\u7ed9broker\u7684\u3002 \u4e0d\u7ba1\u662fRabbitMQ\u8fd8\u662fRocketMQ\u8fd8\u662fkafka\uff0c\u90fd\u662f\u63a8\u7684\u6a21\u5f0f\u3002\u5c31\u662f\u4e0d\u7528\u5728\u8fd9\u4e2a\u751f\u4ea7\u7aef\u5b58\u6d88\u606f\u4e86\uff0c \u5c31\u662f\u4e0d\u7528\u5728\u8fd9\u4e2a\u751f\u4ea7\u7aef\u5b58\u6d88\u606f\u4e86\uff0c\u7edf\u4e00\u7684\u6254\u7ed9broker\u6765\u5904\u7406\uff0cbroker\u53c8\u6709\u6301\u4e45\u5316\u7684\u673a\u5236\u3002 </p> <p>broker\u5230\u6d88\u8d39\u7aef</p> <ul> <li>\u50cfrocketMQ\uff0ckafka\u5c31\u662f\u62c9\u6a21\u5f0f\uff0c </li> <li>\u90a3\u4e48\u5bf9\u4e8eRabbitmq\u5c31\u662f\u63a8\u6a21\u5f0f. \u63a8\u6a21\u5f0f\u5c31\u662fbroker\u6709\u6d88\u606f\u4e86\u5c31\u76f4\u63a5\u5f80\u6d88\u8d39\u7aef\u63a8, \u6d88\u8d39\u8005\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2a\u7f13\u51b2\u533a\u6765\u7f13\u5b58\u8fd9\u4e9b\u6d88\u606f, \u6d88\u8d39\u8005\u76f4\u63a5\u53ef\u4ee5\u8fd9\u4e2a\u5185\u5b58\u91cc\u9762\u6765\u53d6\u6d88\u606f. </li> <li>\u4f18\u52bf: \u5b9e\u65f6\u6027\u9ad8\u5ef6\u8fdf\u5c0f</li> <li>\u52a3\u52bf: \u5c31\u662f\u7f13\u51b2\u533a\u5462\u53ef\u80fd\u4f1a\u6ea2\u51fa</li> </ul> <p>\u6240\u4ee5\u50cfrabbitmq\u6bd4\u8f83\u9002\u5408\uff0c\u6d88\u606f\u91cf\u4e0d\u5927</p> <p>\u5b9e\u65f6\u6027\u8981\u6c42\u6bd4\u8f83\u9ad8\u7684\u573a\u666f\uff0c\u90a3\u4e48\u5bf9\u4e8erocketmq, kafka, \u90fd\u662f\u91c7\u7528\u8fd9\u4e2a\u62c9\u6a21\u5f0f. \u6d88\u8d39\u7aef\u4e3b\u52a8\u8bf7\u6c42broker\u6765\u62c9\u53d6\u6d88\u606f, \u6bcf\u9694\u51e0\u79d2\u949f\u62c9\u4e00\u4e0b. \u5982\u679c\u6ca1\u6709\u6d88\u606f\u5462\u5c31\u5728\u90a3\u7b49\u7740, \u4e00\u76f4\u7b49\u5230\u8d85\u65f6\u91ca\u653e, \u53c8\u53eb\u505a\u957f\u8f6e\u8be2</p> <ul> <li>\u4f18\u52bf: \u5c31\u662f\u53ef\u4ee5\u6839\u636e\u6d88\u8d39\u8005\u7684\u81ea\u8eab\u60c5\u51b5, \u4e3b\u52a8\u53bb\u8bf7\u6c42. \u5982\u679c\u5f53\u524d\u6d88\u8d39\u8005\u89c9\u5f97\u81ea\u5df1\u8fd9\u4e2a\u6d88\u8d39\u4e0d\u8fc7\u6765, \u90a3\u4e48\u53ef\u4ee5\u6839\u636e\u4e00\u5b9a\u7684\u7b56\u7565\u6765\u505c\u6b62\u62c9\u53d6</li> <li>\u52a3\u52bf: \u5c31\u662f\u6709\u4e00\u5b9a\u7684\u8fd9\u4e2a\u65f6\u5ef6</li> <li>rocketmq \u5ef6\u8fdf\u5df2\u7ecf\u5f88\u5c0f\u4e86</li> </ul>"},{"location":"chap7/int_anws/#15_2","title":"15 \u600e\u4e48\u8bbe\u8ba1\u4e00\u4e2a\u6d88\u606f\u961f\u5217","text":"<ul> <li>\u751f\u4ea7\u8005</li> <li>\u6d88\u8d39\u8005</li> <li>\u6d88\u606f\u7c7b\u578b</li> <li>\u6d88\u606f\u7684\u5b58\u50a8</li> <li>\u8def\u7531\u5206\u53d1</li> <li>\u4fdd\u969c\u673a\u5236</li> </ul>"},{"location":"chap7/int_anws/#_2","title":"\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005","text":"<p>\u5e94\u8be5\u7b97\u662f\u6d88\u606f\u961f\u5217\u7684\u7075\u9b42\uff0c\u4e00\u4e2a\u8d1f\u8d23\u6d88\u8d39\u6d88\u606f\uff0c\u4e00\u4e2a\u8d1f\u8d23\u4ea7\u751f\u6d88\u606f\uff0c </p> <p>\u4e00\u4e2a\u63a5\u53e3\uff0c\u6765\u4f9b\u751f\u4ea7\u8005\u53d1\u5e03\u6d88\u606f\uff0c\u8981\u6ee1\u8db3\u8fd9\u4e2a\u5148\u8fdb\u5148\u51fa\uff0c\u53ef\u4ee5\u4f7f\u7528\u94fe\u8868\uff0c\u6570\u7ec4\u6216\u8005\u662f\u6570\u636e\u5e93\u6765\u5b9e\u73b0</p> <p>\u6570\u636e\u683c\u5f0f\uff0c\u4e00\u822c\u91c7\u7528\u8fd9\u4e2ajson\uff0c \u5bf9\u4e8e\u8fd9\u4e2a\u5e8f\u5217\u5316\uff0c\u53cd\u5e8f\u5217\u5316\u3002</p> <p>\u90a3\u6d88\u606f\u4ea7\u751f\u51fa\u6765\u4e4b\u540e\u5b58\u5728\u54ea\u91cc\uff0credis, \u5929\u751f\u5c31\u6709\u8fd9\u4e2a\u6301\u7eed\u5316\u7684\u673a\u5236. </p> <p>\u7136\u540e\u5c31\u662f\u8fd9\u4e2a\u6d88\u606f\u7684\u6d88\u8d39. \u5c31\u5f97\u6709\u4e00\u4e2aAP!\u6765\u63d0\u4f9b. \u6d88\u8d39\u8005\u4ece\u961f\u5217\u4e2d\u83b7\u53d6\u3001\u6d88\u8d39\u6d88\u606f\uff0c\u53ef\u4ee5\u4f7f\u7528Pull\uff08\u62c9\uff09\uff0c \u6216\u8005\u662fpush\uff08\u63a8\uff09\u6a21\u5f0f</p>"},{"location":"chap7/int_anws/#_3","title":"\u62c9\u53d6\u6a21\u5f0f","text":"<p>\u6d88\u8d39\u8005\u4e3b\u52a8\u4ece\u961f\u5217\u91cc\u9762\u6765\u83b7\u53d6\u6d88\u606f\uff0c </p>"},{"location":"chap7/int_anws/#push","title":"push\u6a21\u5f0f\u4e0b","text":"<p>\u961f\u5217\u9700\u8981\u5728\u8981\u4ea7\u751f\u4e86\u65b0\u6d88\u606f\u4e4b\u540e\uff0c\u4e3b\u52a8\u7ed9\u63a8\u9001\u5230\u6211\u4eec\uff0c</p> <p>\u600e\u4e48\u4fdd\u8bc1\u6d88\u606f\u4e0d\u4f1a\u91cd\u590d\u7684\u6d88\u8d39\uff0c \u8fd9\u91cc\u53ef\u80fd\u5c31\u8981\u4f7f\u7528\u5230\u9501\uff0c\u8fd9\u91cc\u53ef\u80fd\u5c31\u8981\u4f7f\u7528\u5230\u9501\u6216\u8005\u662f\u4fe1\u53f7\u91cf\u6765\u63a7\u5236\uff0c\u4e3a\u4e86\u786e\u4fdd\u6d88\u606f\u88ab\u6d88\u8d39\u8005\u63a5\u6536\u5904\u7406\u3002\u8fd8\u9700\u8981\u6709\u4e00\u4e2a\u8fd9\u4e2a\u786e\u8ba4\u673a\u5236\uff0c\u6838\u5fc3\u70b9\u5c31\u5728\u5b50\u6211\u4eec\u7684\u6d88\u8d39\u8005</p> <p>\u5728\u5904\u7406\u5b8c\u6d88\u606f\u540e\uff0c\u8981\u53d1\u9001\u786e\u8ba4\uff0c\u5c31\u662f\u5e38\u8bf4\u7684\u8fd9\u4e2aACK\uff0c\u90a3\u4e48\u961f\u5217\u5728\u63a5\u6536\u5230\u786e\u8ba4\u6d88\u606f\uff0c\u90a3\u4e48\u961f\u5217\u5728\u63a5\u6536\u5230\u786e\u8ba4\u6d88\u606f\uff0c\u6d88\u8d39\u4e4b\u540e\u5462\uff0c\u624d\u53ef\u4ee5\u5c06\u6211\u4eec\u961f\u5217\u4e2d\u7684\u6d88\u606f\u8fdb\u884c\u5220\u9664\uff0c </p> <p>\u5982\u679c\u51fa\u73b0\u5f02\u5e38\uff0c \u6d88\u8d39\u8005\u5728\u5904\u7406\u6d88\u606f\u65f6\u5d29\u6e83\uff0c\u90a3\u4e48\u6d88\u606f\u5c31\u4e0d\u5e94\u8be5\u88ab\u5220\u9664\uff0c\u800c\u662f\u5e94\u8be5\u5728\u6d88\u8d39\u8005\u6062\u590d\u540e\uff0c\u518d\u505a\u6d88\u606f\u7684\u8865\u507f\u53d1\u9001</p> <p>\u5f53\u7136\u8fd8\u6709\u961f\u5217\u987a\u5e8f\u6d88\u8d39\u7684\u95ee\u9898\uff0c\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\u5462\uff0c\u6d88\u606f\u7684\u987a\u5e8f\u662f\u5f88\u91cd\u8981\u7684</p> <p>\u5c31\u662f\u8fd9\u4e2a\u6d88\u606f\u8fc7\u671f\uff0c\u5bf9\u4e8e\u957f\u65f6\u95f4\u672b\u6d88\u8d39\u7684\u6d88\u606f\uff0c\u8981\u628a\u5b83\u8fc7\u671f\u6389\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u8fd9\u4e2a\u8fc7\u671f\u65f6\u95f4\uff0c\u8fc7\u671f\u540e\uff0c\u79fb\u81f3\u8fd9\u4e2a\u6b7b\u4fe1\u5bf9\u5217\uff0c\u8bbe\u8ba1\u4e00\u4e2a\u6b7b\u4fe1\u961f\u5217\u7684\u6d88\u8d39\u8005\uff0c\u6765\u4e13\u95e8\u5904\u7406\u8fd9\u4e9b\u5f02\u5e38\u6d88\u606f\u7684\u6d88\u8d39</p>"},{"location":"chap7/int_anws/#4_2","title":"4 \u6570\u636e\u5e93","text":""},{"location":"chap7/int_anws/#1_4","title":"1 \u4ec0\u4e48\u60c5\u51b5\u4e0b\u8981\u8fdb\u884c\u5206\u5e93\u5206\u8868\uff1f","text":"<p>\u5355\u8868\u6570\u636e\u5982\u679c\u8fbe\u5230\u4e861,000\u4e07\uff0c\u56e0\u4e3a\u8fbe\u5230\u8fd9\u4e2a\u91cf\u7ea7\u7684\u6570\u636e\u5e93\u4e0d\u7ba1\u662f\u67e5\u8be2\u4e5f\u597d\uff0c\u5199\u6570\u636e\u5e93\u4e5f\u597d\uff0c\u6548\u7387\u90fd\u5f88\u4f4e\u3002 </p> <p>\u67e5\u8be2\u5f88\u597d\u7406\u89e3\uff0c\u9700\u8981\u53bb\u904d\u5386\u6570\u636e\u8868\uff0c\u6570\u636e\u8868\u8d8a\u5927\uff0c\u67e5\u8be2\u80af\u5b9a\u5c31\u8d8a\u6162\u3002\u4f46\u662finsert\u5b8c\u6bd5\u4e4b\u540e\uff0c \u6570\u636e\u5e93\u5c31\u4f1a\u9488\u5bf9\u7528\u6237\u8868\u91cd\u65b0\u5efa\u7acb\u5bf9\u5e94\u7684\u7d20\u5f15\u3002 </p> <p>\u4e3a\u4e86\u67e5\u8be2\u7684\u6548\u7387\uff0c\u7d22\u5f15\u91c7\u7528\u7684\u662fb+\u6811\uff0c\u90a3\u4e48\u6709\u4e86\u65b0\u6570\u636e\u3002 \u5c31\u9700\u8981\u91cd\u65b0\u53bb\u6784\u5efa\u7d22\u5f15\u7684b+\u6811\uff0c \u90a3\u4e481,500w\u884c\u7684\u8fd9\u4e2a\u6570\u636e\uff0c\u5efa\u7acb\u8d77\u7d20\u5f15\u6765\u3002\u5728\u7cfb\u7edf\u7684\u5f00\u9500\u65b9\u9762\u8fd8\u662f\u4e0d\u5bb9\u5ffd\u89c6\u7684\uff0c \u6bd4\u8f83\u5f71\u54cd\u6570\u636e\u5e93\u7684\u6027\u80fd\u3002</p> <p>1.1 \u5206\u8868</p> <p>\u6bd4\u5982\u505a\u4e86\u5206\u8868\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982\u8bf4\u5206\u4e86\u4e94\u4e2a\u8868\uff0c\u5728\u5efa\u7acb\u7d22\u5f15\u65b9\u9762\u7684\u65f6\u95f4\u5c31\u4f1a\u4e0b\u964d\u5f88\u591a, \u4e5f\u5c31\u80fd\u591f\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u8fd0\u884c\u6548\u7387, \u8fdb\u800c\u4e5f\u80fd\u591f\u63d0\u9ad8\u7cfb\u7edf\u7684\u5e76\u53d1\u91cf</p> <p>\u5f53\u7136\u5206\u8868\u7684\u597d\u5904, \u9664\u4e86\u7d22\u5f15\u65b9\u9762\u8fd8\u6709\u5f88\u591a. \u6bd4\u5982\u8bf4\u53ef\u4ee5\u51cf\u5c11\u8fd9\u4e2a\u5199\u64cd\u4f5c\u9501\u7684\u8303\u56f4, \u5728\u5199\u6570\u636e\u7684\u65f6\u5019\uff0c\u4f1a\u5bf9\u6570\u636e\u8fdb\u884c\u52a0\u9501.  \u5982\u679c\u6570\u636e\u8868\u91cc\u7684\u6570\u636e\u5f88\u591a, \u90a3\u4e48\u5f88\u660e\u663e\u5c31\u4f1a\u589e\u52a0\u9501\u7684\u8303\u56f4. \u52a0\u9501\u8d8a\u591a, \u6548\u7387\u5c31\u81ea\u7136\u4f1a\u4f4e. </p> <p>\u5206\u8868\uff0c\u8bf4\u5230\u5e95\u5c31\u662f\u628a\u6570\u636e\u5206\u7247\u62c6\u5206\uff0c\u53c8\u53eb\u6c34\u5e73\u62c6\u5206\uff0c \u628a\u5355\u8868\u7684\u6570\u636e\u51cf\u5c11\uff0c\u81ea\u7136\u5c31\u80fd\u63d0\u9ad8\u7cfb\u7edf\u7684\u6027\u80fd\u3002</p> <p>1.2 \u5206\u5e93</p> <p>\u63d0\u9ad8\u8fd9\u4e2a\u67b6\u6784\u7684\u4e00\u4e2a\u53ef\u7528\u6027\uff0c \u51cf\u5c11\u5355\u70b9\u6545\u969c\u3002 \u80fd\u591f\u6709\u6548\u7684\u5206\u62c5\u4e00\u4e2a\u5e93\u7684\u538b\u529b\uff0c \u53ea\u5206\u5e93\u4e0d\u5206\u8868\u3002 </p> <p>\u5e38\u7528\u4e8e\u8fd9\u4e2a\u8bfb\u5199\u5206\u79bb\u7684\u573a\u666f\uff0c\u90a3\u4e48\u4e00\u4e3b\u591a\u4ece\u3002\u4e3b\u5e93\u8d1f\u8d23\u5199\u4ece\u5e93\u8d1f\u8d23\u8bfb\uff0c\u4ece\u5e93\u4ece\u4e3b\u5e93\u540c\u6b65\u66f4\u65b0\u6570\u636e\u6765\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c \u4e3b\u5e93\u540c\u6b65\u66f4\u65b0\u6570\u636e\u6765\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027</p>"},{"location":"chap7/int_anws/#2_4","title":"2 \u5206\u5e93\u5206\u8868\u7684\u51e0\u79cd\u7b56\u7565","text":"<p>\u7528\u7684\u6bd4\u8f83\u591a\u7684\u4e5f\u5c313\u4e2a\uff0c \u6309 ID\u53d6\u6a21\uff0c\u6309 \u65f6\u95f4\u70b9\u5206\u533a\uff0c\u91c7\u7528\u4e00\u81f4\u6027\u54c8\u897f</p> <ul> <li>\u6309\u7167\u65f6\u95f4\u70b9\u5206\u533a</li> </ul> <p>\u9002\u7528\u5e72\u8fd9\u4e2a\u8ba2\u5355\u6570\u636e\u62c6\u5206\u3002 \u6309\u5929\u5206\u8868\uff0c \u6309\u6708\u5206\u8868\u6309\u5e74\u5206\u8868\u3002\u90a3\u4e48\u65f6\u95f4\u8d8a\u4e45\u7684\u6570\u636e\uff0c \u88ab\u67e5\u8be2\u5230\u7684\u6982\u7387\u4e5f\u4f1a\u8d8a\u4f4e\u3002 \u7c7b\u4f3c\u51b7\u6267\u6570\u636e\u7684\u5206\u79bb\uff0c\u5e38\u89c1\u7684\u7535\u5546\u6216\u8005\u94f6\u884cAPP\uff0c\u5c31\u4f1a\u63d0\u4f9b\u6bd4\u5982\u8bf4\u8fd13\u4e2a\u6708\uff0c\u8fd16\u4e2a\u6708\u8ba2\u5355\u7684\u8fd9\u4e2a\u67e5\u8be2\u5feb\u6377\u952e\u3002</p> <p>\u5176\u5b9e\u5c31\u662f\u6309\u7167\u5929\uff0c\u6309\u7167\u6708\u6765\u505a\u4e86\u8fd9\u4e2a\u6570\u636e\u8868\u7684\u5206\u533a\u3002</p> <ul> <li>ID\u53d6\u6a21</li> </ul> <p>\u8fd8\u662f\u4ee5\u7528\u6236\u8868\u4e3a\u4f8b, \u6bd4\u5982\u8aaa\u7528\u6236\u88683,000\u4e07, \u8981\u62c6\u62106\u4e2a\u8868, \u6bcf\u4e2a\u8868500\u4e07\u3002\u5c07\u6570\u636e\u5206\u644a\u52306\u4e2a\u8868\u4e2d\uff0c\u67e5\u8be2\u4e5f\u7b80\u5355\uff0c\u5148\u901a\u8fc7ID\u53d6\u6a21\u627e\u5230\u6240\u5728\u7684\u8868\u3002\u518d\u53bb\u6267\u884csql\u8bed\u53e5</p> <p>\u4f46\u662f\u53d6\u6a21\u6cd5\u6709\u4e00\u4e2a\u7f3a\u70b9\uff0c\u5982\u679c\u6570\u636e\u91cf\u589e\u52a0\u3002 \u5c31\u8981\u6269\u5145\u6570\u636e\u8868, \u90a3\u4e48\u4e4b\u524d\u5df2\u7ecf\u8ba1\u7b97\u597d\u7684\u53d6\u6a21\u7684\u503c\u5c31\u4f1a\u6539\u53d8, \u5df2\u7ecf\u5b58\u5728\u76843.000\u4e07\u7684\u6570\u636e\u5462\u5c31\u8981\u91cd\u65b0\u5206\u7247\u4e86. </p> <ul> <li>\u4e00\u81f4\u6027\u54c8\u897f\u7b97\u6cd5</li> </ul> <p>\u8fd9\u4e2a\u9700\u8981\u9762\u4e34\u5927\u91cf\u7684,\u989d\u5916\u7684\u8fd9\u4e2a\u6570\u636e\u8fc1\u79fb\u7684\u5de5\u4f5c,  \u5176\u5b9e\u53ef\u4ee5\u8003\u8651\u4e00\u81f4\u6027\u54c8\u897f\u7b97\u6cd5\u6765\u89e3\u51b3\uff0c \u6574\u4e2a\u54c8\u897f\u503c\u7684\u7a7a\u95f4\uff0c\u7ec4\u7ec7\u6210\u4e00\u4e2a\u865b\u62df\u7684\u4e00\u4e2a\u5706\u73af\uff0c\u7136\u540e\u5404\u4e2a\u6570\u636e\u8868\u8fdb\u884c\u4e00\u4e2a\u54c8\u897f\uff0c \u53ef\u4ee5\u9009\u62e9\u7684\u8868\u7684\u7f16\u53f7\u6216\u8005\u540d\u79f0\uff0c \u4f5c\u4e3a\u4e00\u4e2a\u5173\u952e\u8bcd\u8fdb\u884c\u54c8\u897f\uff0c\u8fd9\u6837\u6bcf\u4e00\u4e2a\u6570\u636e\u8868\u5c31\u80fd\u591f\u786e\u5b9a\u5728\u54c8\u897f\u73af\u4e0a\u7684\u8fd9\u4e2a\u4f4d\u7f6e</p> <p>\u5b58\u50a8\u6570\u636e\u7684\u65f6\u5019\uff0c\u53ea\u8981\u5c06\u6570\u636ekey\u3002\u4f7f\u7528\u76f8\u540c\u7684\u8fd9\u4e2a\u51fd\u6570\u54c8\u897f\uff0c\u8ba1\u7b97\u51fa\u54c8\u897f\u503c\u3002\u5e76\u786e\u5b9a\u6b64\u6570\u636e\u5728\u8fd9\u4e2a\u73af\u4e0a\u7684\u4f4d\uff0c\u7136\u540e\u6309\u7167\u8fd9\u4e2a\u7b97\u6cd5\u627e\u5230\u9760\u8fd1\u7684\u8fd9\u4e2a\u6570\u636e\u8868\u3002</p> <p>\u7136\u540e\u8fdb\u884c\u76f8\u5173\u7684\u4e00\u4e9b\u6570\u636e\u64cd\u4f5c\uff0c\u5f53\u7136\u6570\u636e\u91cf\u589e\u5927\u3002 \u53bb\u65b0\u589e\u6570\u636e\u8868\u7684\u65f6\u5019\uff0c \u90a3\u4e48\u5206\u8868\u53d6\u6a21\uff0c \u8fd8\u662f\u6309\u7167ID\u53d6\u6a21\u7684\u5927\u5f0f\u6765\u505a\u66f4\u597d\u4e00\u4e9b\uff0c\u53ea\u8981\u4f30\u7b97\u5978\u6570\u636e\u7684\u589e\u91cf\u5408\u7406\u7684\u505a\u597d\u89c4\u5212</p>"},{"location":"chap7/int_anws/#3_3","title":"3 \u5206\u5e93\u5206\u8868\u7d2b\u6765\u4e86\u54ea\u4e9b\u95ee\u9898\uff1f","text":"<p>\u65e5\u5e38\u751f\u4ea7\u73af\u5883\u4e2d\uff0c \u6570\u636e\u5e93\u4e00\u65e6\u51fa\u73b0\u4e86\u6027\u80fd\u74f6\u9888\u7684\u65f6\u5019\uff0c \u5c31\u4f1a\u60f3\u5230\u4e86\u5206\u5e93\u5206\u8868\u3002   </p> <p>\u53ef\u4ee5\u6309\u7167\u53d6\u6a21\uff0c \u4e00\u81f4\u6027\u54c8\u897f\uff0c\u6309\u7167\u65f6\u95f4\u70b9\u6765\u5206\u533a\u64cd\u4f5c\u8d77\u6765\u8fd8\u662f\u6bd4\u8f83\u5bb9\u6613\uff0c\u5c24\u5176\u662f\u501f\u52a9\u4e86\u4e00\u4e9b\u4e2d\u95f4\u952e\u4ef6\uff0c \u6bd4\u5982mycat\u3002</p> <ul> <li>1 \u6bd4\u5982\u8bf4\u5206\u5e93\u5206\u8868\u4e4b\u540e\u600e\u4e48\u53bbJoin?</li> </ul> <p>\u90a3\u4e48\u4e00\u822c\u60c5\u51b5\u4e0b, \u5206\u5e93\u5206\u8868\u4e4b\u540e,  \u5c31\u4e0d\u5efa\u8bae\u518d\u8ddf\u8fd9\u4e2a\u5355\u5e93\u5355\u8868\u4e00\u6837\u8fdb\u884cJoin\u64cd\u4f5c, \u5e94\u8be5\u907f\u514d\u8fd9\u6837\u7684\u4e00\u4e2ajoin\u67e5\u8be2</p> <p>\u6bd4\u8f83\u5e38\u89c4\u7684\u505a\u6cd5, \u5176\u5b9e\u53ef\u4ee5\u91c7\u7528\u8fd9\u4e2a\u5b57\u6bb5\u7684\u5197\u4f59, \u6709\u4e9b\u5b57\u6bb5\u5c31\u4e0d\u7528\u518d\u53bbjoin\u53bb\u67e5\u8be2\u4e86</p> <ul> <li>2 \u5206\u5e03\u5f0fID\u7684\u95ee\u9898</li> </ul> <p>\u5728\u5206\u5e93\u5206\u8868\u4e4b\u540e,  \u5c31\u4e0d\u80fd\u518d\u50cf\u4ee5\u524d\u4e00\u6837\u4f7f\u7528mysql \u81ea\u589eid\u4e86\u3002 \u56e0\u4e3a\u5728\u63d2\u5165\u8bb0\u5f55\u7684\u65f6\u5019\uff0c \u4e0d\u540c\u7684\u5e93\u4e0d\u540c\u7684\u8868\u3002 </p> <p>\u751f\u6210\u7684\u8bb0\u5f55\u7684\u81ea\u589eID\u5c31\u4f1a\u51fa\u73b0\u51b2\u7a81\uff0c\u5c31\u9700\u8981\u6709\u4e00\u4e2a\u5168\u5c40\u7684ID\u751f\u6210\u5668\uff0c \u7cfb\u7edf\u9700\u8981\u989d\u5916\u7684\u4e00\u4e2a\u53ef\u9760\u7684\u5206\u5e03\u5f0fID\u7684\u751f\u6210\u5668\u7684\u4e00\u4e2a\u670d\u52a1</p> <p>\u800c\u4e14\u4e00\u5b9a\u8981\u53ef\u9760, \u5426\u5219\u52a8\u4e0d\u52a8\u5c31\u5b95\u673a\u8d85\u53ef\u80fd\u5c31\u4f1a\u53d8\u6210\u65b0\u7684\u6027\u80fd\u74f6\u9888</p> <p>\u6bd4\u8f83\u5e38\u89c1\u7684\u5206\u5e03\u5f0fID\u751f\u6210\u7b56\u7565</p> <ol> <li>uuid, \u770b\u8d77\u6765\u5c31\u662f\u4e00\u5806\u4e71\u7801</li> <li>\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5c31\u662f redis\u7684incr\u51fd\u6570, \u4f46\u662fredis\u8981\u786e\u4fdd\u53ef\u9760\u6027,\u4e00\u65e5\u51fa\u73b0\u4e86\u4e00\u4e9b\u6545\u969c, \u91cd\u542f\u4e4b\u540e\u6570\u636e\u5c31\u53ef\u80fd\u5c31\u4f1a\u4e22\u5931, \u53ef\u80fd\u5c31\u4f1a\u91cd\u65b0\u5f00\u59cb\u8ba1\u7b97,\u53ef\u80fd\u5c31\u4f1a\u51fa\u73b0\u91cd\u590d\u7684ID</li> <li>\u6bd4\u5982snowflake, \u96ea\u82b1\u7b97\u6cd5\u7b49\u7b49</li> <li> <p>leaf\u7b97\u6cd5</p> </li> <li> <p>3 \u5206\u5e93\u5206\u8868\u4e4b\u540e\u4f1a\u53ef\u80fd\u4f1a\u9047\u5230\u8fd9\u4e2a\u6269\u5145\u8868</p> </li> </ol> <p>\u4e00\u65e6\u8fd9\u4e2a\u6570\u636e\u8868\u4e0d\u591f\u7528\u4f60\u3001\u8981\u91cd\u65b0\u5206\u8868\u3002 \u5c06\u51e0\u5343\u4e07\uff0c \u751a\u81f3\u51e0\u4ebf\u7684\u8fd9\u4e2a\u6570\u636e\u91cd\u65b0\u5237\u76d8\u3002 </p> <p>\u6bd4\u8f83\u5934\u75bc\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\uff0c\u56e0\u4e3a\u6d89\u53ca\u5230\u4e86\u8fd9\u4e2a\u540c\u65f6\u8981\u66f4\u65b0\u591a\u4e2a\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u8868\uff0c\u5982\u4f55\u4fdd\u8bc1\u8981\u4e48\u540c\u65f6\u6210\u529f\uff0c \u8981\u4e48\u540c\u65f6\u5931\u8d25\uff0c\u5c31\u6210\u4e86\u4e00\u4e2a\u9700\u8981\u89e3\u6c7a\u7684\u95ee\u9898</p> <p>\u6bd4\u8f83\u5e38\u89c1\u7684\u4e5f\u5c31\u4e24\u79cd\u65b9\u6848</p> <ul> <li>xa : xa\u73b0\u5728\u5176\u5b9e\u7528\u7684\u4e0d\u591a</li> <li>tcc: \u4e3b\u6d41\u7684\u65b9\u6848\u5176\u5b9e\u8fd8\u662ftcc<ul> <li>\u5148try, \u9501\u5b9a\u8d44\u6e90\uff0c \u7136\u540econfirm, commit</li> <li>\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u5f00\u6e90\u7684\u6846\u67b6\uff0c seata\uff0c bytecc</li> </ul> </li> </ul>"},{"location":"chap7/int_anws/#_4","title":"\u5c3d\u91cf\u4e0d\u8981\u5c1d\u8bd5\u5206\u5e93\u5206\u8868","text":""},{"location":"chap7/int_anws/#4_3","title":"4 \u5206\u5e93\u5206\u8868\u4e4b\u540e\u5982\u4f55\u8fdb\u884c\u5206\u9875\u67e5\u8be2","text":"<p>\u6bd4\u5982\u8bf4\u5982\u679c\u6309\u7167\u8fd9\u4e2a\u65f6\u95f4\u70b9\u5206\u8868\uff0c\u6216\u8005ID\u7684\u8fd9\u4e2a\u8303\u56f4\u5206\u8868\u3002 </p> <ul> <li>\u53ef\u4ee5\u6839\u636e\u65f6\u95f4\u8303\u56f4\u7684\u6761\u4ef6\uff0c \u5148\u627e\u5230\u5bf9\u5e94\u7684\u8868\uff0c \u7136\u540e\u6309\u7167\u4f20\u7edf\u7684\u5355\u8868\u7684\u5206\u9875\u67e5\u8be2\u7684\u65b9\u6cd5\u5c31\u53ef\u4ee5\u4e86 \uff08\u65f6\u95f4\u7684\u8303\u56f4\u6216\u8005\u662fID\u7684\u8303\u56f4\u6765\u5206\u8868\uff09</li> <li>\u4f46\u662f\u5982\u679c\u662f\u53d6\u6a21\u7684\u573a\u666f\uff0c \u4e0d\u5177\u5907\u8fde\u7eed\u6027\uff0c\u6570\u636e\u5206\u6563\u7684\u5728\u5404\u4e2a\u8868\u4e2d<ul> <li>\u5206\u9875\u67e5\u627e\uff0c\u53ef\u4ee5\u6839\u636e\u4e0a\u4e00\u9875\u7684ID\uff0c\u589e\u52a0\u6548\u7387</li> </ul> </li> </ul>"},{"location":"chap7/int_anws/#5_1","title":"5 \u5206\u5e93\u5206\u8868\u4e4b\u67e5\u8be2\u4f18\u5316\u7b56\u7565","text":"<p>\u63d0\u5347\u6574\u4e2a\u7cfb\u7edf\u7684\u67e5\u8be2\u6027\u80fd\uff0c \u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e9b\u9759\u6001\u7684\u6216\u8005\u53d8\u52a8\u4e0d\u5927\u7684\u4e00\u4e9b\u6570\u636e\u3002 \u6bd4\u5982\u8bf4\u50cf\u5546\u54c1\u6570\u636e\uff0c \u5c31\u53ef\u4ee5\u76f4\u63a5\u6254\u5728redis\u91cc\u9762\uff0c \u8fd8\u6709\u70b9\u8d5e\uff0c\u6536\u85cf\u8fd9\u79cd\u64cd\u4f5c\u9891\u7e41\u7684\u6570\u636e\uff0c\u4e5f\u53ef\u4ee5\u6254\u5230redis \u56e0\u4e3a\u6570\u636e\u5462\u90fd\u662f\u57fa\u4e8e\u5185\u5b58</p> <p>\u5728\u67e5\u8be2\u7684\u6027\u8d28\u4e0a\u9762\u662f\u8981\u6bd4\u4f20\u7edf\u7684\u8fd9\u4e2a\u6570\u636e\u5e93\u67e5\u8be2\u8981\u9ad8\u597d\u51e0\u4e2a\u6570\u91cf\u7ea7</p> <p>\u57fa\u4e8e\u5185\u5b58\u5462\u8fd8\u6709es</p> <p>\u5206\u5e93\u5206\u8868\u4e4b\u540e\uff0c \u53ef\u4ee5\u5f02\u6784\u4e00\u4efd\u6570\u636e\u5230es\u4e2d\u3002 \u8fd9\u6837\u5c31\u4e0d\u7528\u8003\u8651\u590d\u6742\u7684\u5206\u9875\uff0c </p> <ul> <li>ES\u7684\u5012\u6392\u7d20\u5f15\uff0c\u6bcf\u4e00\u4e2a\u6570\u636e\u6bcf\u4e00\u4e2a\u5b57\u6bb5\u90fd\u8fdb\u884c\u4e86\u5206\u8bcd\u3002\u6bcf\u4e00\u4e2a\u5206\u8bcd\u90fd\u4f1a\u5efa\u7acb\u7d22\u5f15\u3002\u8fd9\u6837\u5728\u68c0\u7d22\u5173\u952e\u8bcd\u7684\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u5173\u952e\u8bcd\u76f4\u63a5\u627e\u5230\u5012\u6392\u7d20\u5f15\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u6309\u56fe\u7d22\u9aa5\uff0c\u5c31\u53ef\u4ee5\u627e\u5230\u76f8\u5e94\u7684\u6587\u6863</li> <li>ES\u662f\u57fa\u4e8e\u5185\u5b58\uff0c ES\u628a\u6570\u636e\u8ff8\u884c\u5904\u7406\u5efa\u7acb\u4e86\u7d22\u5f15\u4e4b\u540e\u3002 \u5c31\u4f1a\u5168\u90e8\u6254\u5230\u5185\u5b58\u91cc\u9762\uff0c \u8981\u4f18\u4e8emysql\u7684b+\u6811\u7684\u7ed3\u6784\u3002 \u5374\u80fd\u591f\u76f4\u63a5\u4ece\u5185\u5b58\u91cc\u9762\u627e\u5230\u76ee\u6807\u6587\u6863\uff0c \u53ef\u4ee5\u5927\u5927\u7684\u63d0\u5347\u67e5\u8be2\u6548\u7387</li> </ul>"},{"location":"chap7/int_anws/#6_2","title":"6 \u5982\u4f55\u5b9e\u73b0\u6570\u636e\u5e93\u7684\u8bfb\u5199\u5206\u79bb","text":"<p>\u57fa\u4e8e\u4e3b\u4ece\u590d\u5236\u7684\u67b6\u6784\uff0c\u7b80\u5355\u6765\u8bb2\u5c31\u662f\u641e\u4e00\u4e2a\u4e3b\u5e93\uff0c\u6302\u591a\u4e2a\u4ece\u5e93\u3002</p> <p>\u53ea\u662f\u5199\u4e3b\u5e93\u4e86\uff0c\u4fee\u6539\uff0c\u5220\u9664\u65b0\u589e\u90fd\u662f\u5728\u4e3b\u5e93\u4e0a\u9762\u8fdb\u884c\u64cd\u4f5c\u3002 </p> <p>\u7136\u540e\u4e3b\u5e93\u5c31\u4f1a\u81ea\u52a8\u7684\u628a\u6570\u636e\uff0c\u7ed9\u540c\u6b65\u5230\u4ece\u5e93\u4e0a\u53bb\u3002 \u4e3b\u5e93\u554a\u5c31\u8ddf\u5b58\u5e93\u4fdd\u8bc1\u4e86\u6570\u636e\u7edf\u4e00\uff0c\u4ece\u5e93\u6709\u591a\u4e2a\uff0c\u7edf\u4e00\u5bf9\u5916\u63d0\u4f9b\u67e5\u8be2\u670d\u52a1\u3002</p> <p>\u5728\u5b9e\u73b0\u5c42\u9762, \u6709\u4e24\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u70b9</p> <ul> <li>\u4e00\u4e2a\u662f\u6570\u636e\u7684\u540c\u6b65\u95ee\u9898, \u4e3b\u5e93\u600e\u4e48\u628a\u6570\u636e\u540c\u6b65\u5230\u4ece\u5e93\u4e0a\u9762</li> <li>\u4e00\u4e2a\u662f\u8bbf\u95ee\u7684\u7b56\u7565\u95ee\u9898, \u600e\u4e48\u77e5\u9053\u5f53\u524d\u7684sql\u8bed\u53e5</li> </ul> <p>\u8be5\u8bbf\u95ee\u54ea\u4e00\u4e2a\u5e93\u5f97\u6709\u76f8\u5173\u7684\u8def\u7531\u534f\u8bae,  \u6570\u636e\u7684\u540c\u6b65\u95ee\u9898\u4ee5mysql\u4e3a\u4f8b\u3002\u6838\u5fc3\u5c31\u662f\u4ed6\u7684\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\u53ebbinlog\uff0c</p> <p>\u90a3\u4e48\u4e3b\u5e93\uff0c\u6bcf\u6b21\u7684\u64cd\u4f5c\u3002 \u589e\u5220\u6539\u90fd\u4f1a\u628a\u65e5\u5fd7\u6254\u5230binlog\u4e2d\uff0c\u90a3\u4e48\u4ece\u5e93\u4f1a\u8ba2\u9605\u4e3b\u5e93\u7684binlog\uff0c\u5728\u8fde\u63a5\u4e0a\u4e3b\u5e93\u4e4b\u540e\u3002 </p> <p>\u5c31\u4f1a\u5b9e\u65f6\u7684\u53bb\u540c\u6b65binlog\u7684\u5185\u5bb9\uff0c \u89e3\u6790\u6210sql\u8bed\u53e5\uff0c\u7136\u540e\u5728\u4ece\u5e93\u7684\u672c\u5730\uff0c\u6267\u884csql\u8bed\u53e5\u3002  </p> <p>\u4ece\u5e93\u4e4b\u95f4\u7684\u6570\u636e\u540c\u6b65, \u5f53\u7136\u5982\u679c\u64cd\u4f5c\u5e76\u53d1\u91cf\u5927\u3002 binlog\u7684\u540c\u6b65\u6267\u884c\uff0c\u76f8\u5e94\u7684\u4e5f\u4f1a\u6162\u4e00\u4e9b\u3002\u51e0\u5341\u79d2\uff0c \u51e0\u767e\u6beb\u79d2\uff0c\u51e0\u79d2\u554a\u90fd\u662f\u6709\u53ef\u80fd\u7684\uff0c\u4e5f\u662f\u727a\u7272\u4e86\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c \u4fdd\u8bc1\u4e86\u53ef\u7528\u6027</p> <p>\u7136\u540e\u8bbf\u95ee\u7684\u7b56\u7565\u95ee\u9898\uff0c\u589e\u5220\u6539\u8981\u9009\u62e9\u4e3b\u5e93\u3002\u67e5\u8be2\u8981\u9009\u62e9\u4ece\u5e93\uff0c\u4ece\u5e93\u6709\u591a\u4e2a\u8fd8\u6d89\u53ca\u5230\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u5f53\u7136\u53ef\u4ee5\u5728\u4ee3\u7801\u91cc\u5b9e\u73b0\uff0c \u53ef\u4ee5\u914d\u7f6e\u591a\u4e2a\u6570\u636e\u6e90\u3002 </p> <p>\u6839\u636esql\u8bed\u53e5\u6765\u5224\u65ad\uff0c\u5e94\u8be5\u8bbf\u95ee\u54ea\u4e2a\u6570\u636e\u5e93\uff0c \u5199\u597d\u8def\u7531\u534f\u8bae\uff0c\u5c31\u4f1a\u628a\u4ee3\u7801\u8ddf\u6570\u636e\u5e93\uff0c\u7d27\u5bc6\u7684\u8026\u5408\u5728\u4e00\u8d77\u3002\u90a3\u4e00\u822c\u4e5f\u90fd\u4f1a\u8fed\u62e9\u4e2d\u95f4\u4ef6mycat\uff0c\u4e5f\u4e0d\u9700\u8981\u518d\u505a\u4e00\u4e9b\u4ec0\u4e48\u8def\u7531\u914d\u7f6e</p>"},{"location":"chap7/int_anws/#7-select","title":"7 \u4e3a\u5565\u8981\u7981\u7528<code>select *</code>","text":"<p>\u6570\u636e\u662f\u5b58\u50a8\u5728\u8fd9\u4e2a\u78c1\u76d8\u4e0a\u7684, \u53bb\u67e5\u6240\u6709\u7684\u5b57\u6bb5, \u80af\u5b9a\u5c31\u4f1a\u589e\u52a0\u78c1\u5bc6io\u7684\u5f00\u9500. </p> <p>\u5982\u679c\u8fd9\u4e9b\u5b57\u6bb5\u4e2d\u5305\u542b\u4e86\u4e00\u4e9b\u5927\u5b57\u6bb5, \u6bd4\u5982\u8bf4\u50cftext\uff0c\u6bd4\u5982\u8bf4\u50cfblob. \u90a3\u4e48\u8bfb\u53d6\u4e5f\u4f1a\u5f88\u6162, </p> <p>\u53e6\u5916\u4ece\u8fd9\u4e2a\u5e94\u7528\u670d\u52a1\u5668\u83b7\u53d6\u53d6\u6570\u636e\u5e93\u670d\u52a1\u5668\u7684\u6570\u636e, \u672c\u8eab\u4e5f\u4f1a\u6709\u4e00\u5b9a\u7684\u7f51\u7edc\u65f6\u5ef6. \u67e5\u7684\u8d8a\u591a\u901f\u5ea6\u80af\u5b9a\u5c31\u8d8a\u6162, \u67e5\u7684\u6162\uff0c\u7ebf\u7a0b\u91ca\u653e\u7684\u5c31\u6162, \u5c31\u4f1a\u5f71\u54cd\u5176\u4ed6\u7684\u67e5\u8be2\u7ebf\u7a0b.  \u6574\u4f53\u7684\u6027\u80fd\u5c31\u4f1a\u53d7\u5230\u5f71\u54cd</p> <p>\u7b2c\u4e8c\uff0c \u65e0\u6cd5\u4f7f\u7528\u8986\u76d6\u7d22\u5f15,  \u6bd4\u5982\u8bf4\u4f60\u8981\u67e5\u8be2\u7684\u5b57\u6bb5, \u78b0\u5de7\u8bbe\u7f6e\u4e86\u7d22\u5f15. \u5c31\u53ef\u4ee5\u76f4\u63a5\u4ece\u7d22\u5f15\u7684b+\u6811\u4e2d\u83b7\u53d6\u6570\u636e, \u57fa\u4e8eb+\u6811\u7684\u68c0\u7d22\u901f\u5ea6\u8fd8\u662f\u5f88\u5feb\u7684. </p> <p>\u7528\u4e86<code>select *</code>,  \u4e0d\u53ef\u80fd\u8bf4\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u5efa\u7d22\u5f15,  \u5c31\u6ca1\u6cd5\u76f4\u63a5\u4ece\u7d22\u5f15\u6811\u91cc\u9762\u53bb\u67e5\u627e\u6570\u636e. \u5c31\u5f97\u4ece\u78c1\u5bc6\u4e0a\u9762\u53bb\u67e5\u627e\u5b8c\u6574\u8bb0\u5f55,  \u5e38\u8bf4\u7684\u56de\u8868.  \u5728\u67e5\u8be2\u6027\u80fd\u4e0a\u9762\u5c31\u6253\u4e86\u6298\u6263\u4e86</p>"},{"location":"chap7/int_anws/#8_3","title":"8 \u804a\u804a\u6570\u636e\u5e93\u7684\u4e50\u89c2\u9501\uff0c\u60b2\u89c2\u9501","text":"<p>\u60b2\u89c2\u9501</p> <p>\u540c\u4e00\u65f6\u523b\u53ea\u5141\u8bb8\u4e00\u4e2a\u6570\u636e\u5e93\u7684\u4e8b\u52a1\u6765\u4fee\u6539\u8d44\u6e90\uff0c \u4f53\u73b0\u5728sql\u4e0a\u90a3\u5c31\u662f<code>select for update</code>. </p> <p>\u5148\u628a\u8fd9\u6761\u8bb0\u5f55\u9501\u4f4f, \u5176\u4ed6\u7684\u4e8b\u52a1\u8fc7\u6765\u5148\u7b49\u7740. \u53ea\u6709\u5f53\u524d\u7684\u4e8b\u52a1\u63d0\u4ea4\u4e86\u91ca\u653e\u4e86\u9501, \u5176\u4ed6\u4eba\u624d\u80fd\u591f\u83b7\u53d6\u5230\u9501\uff0c\u8fd9\u6837\u5176\u5b9e\u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e32\u884c\u7684\u64cd\u4f5c</p> <p>\u4e50\u89c2\u9501</p> <p>\u5c31\u662f\u6b64\u8f83\u4e50\u89c2\u7684\u8ba4\u4e3a\u6bcf\u4e00\u4e2a\u4e8b\u52a1\uff0c\u90fd\u662f\u4e0d\u66f4\u65b0\u6570\u636e\u6216\u8005\u5c11\u91cf\u7684\u66f4\u65b0\u6570\u636e\u3002\u7b80\u5355\u8bb2\u5c31\u662f\u67e5\u7684\u6bd4\u8f83\u591a\u6539\u7684\u6bd4\u8f83\u5c11\uff0c\u90a3\u5c31\u5bf9\u8d44\u6e90\u53ef\u4ee5\u5148\u4e0d\u7528\u52a0\u9501\u662f\u4e50\u89c2\u9501\u7684\u6838\u5fc3</p> <p>\u867d\u7136\u6ca1\u6709\u9501\uff0c\u4f46\u662f\u6709\u4e86\u4e00\u4e2a\u6982\u5ff5\u53eb\u7248\u672c\u53f7\uff0c\u4e00\u4e2a\u8bb0\u5f55\u5bf9\u5e94\u4e00\u4e2a\u7248\u672c\u53f7\u3002 \u5199\u7684\u65f6\u5019\uff0c\u518d\u628a\u5bf9\u5e94\u7684\u7248\u672c\u53f7\u4f5c\u4e3a\u6761\u4ef6\u5e26\u8fdb\u53bb\uff0c\u5728where\u6761\u4ef6\u91cc\u3002 \u90a3\u4e48\u66f4\u65b0\u7684\u5b8c\u4e86\u4e4b\u540e\uff0c\u628a\u7248\u672c\u53f7\u52a01\u3002 \u90a3\u4e48\u5982\u679c\u5199\u7684\u65f6\u5019\uff0c \u7248\u672c\u53f7\u8ddf\u4e4b\u524d\u7684\u4e0d\u4e00\u81f4\uff0c\u90a3\u5c31\u8bf4\u660e\u6211\u4eec\u7684\u8fd9\u4e2a\u6570\u636e\u88ab\u5176\u4ed6\u7684\u4e8b\u52a1\u4fee\u6539\u8fc7\u4e86\u3002</p> <p>\u6240\u4ee5\u8981\u629b\u51fa\u66f4\u65b0\u5931\u8d25\u7684\u5f02\u5e38\uff0c\u8ba9\u524d\u7aef\u4e1a\u52a1\u6765\u5904\u7406\uff0c\u4ed6\u4e0d\u50cf\u60b2\u89c2\u9501\u76f4\u63a5\u9501\u4f4f\u8d44\u6e90\u6765\u4e32\u884c\u5316\u3002 </p> <p>\u4e0d\u505a\u4efb\u4f55\u7684\u963b\u585e\u7528\u7248\u672c\u53f7\u6765\u63a7\u5236, \u76f8\u6bd4\u4e0b\u6765\u6548\u7387\u5c31\u4f1a\u9ad8\u5f88\u591a, \u5e76\u53d1\u81ea\u7136\u5c31\u80fd\u4e0a\u53bb\u4e86. \u9047\u5230\u4e86\u5e76\u53d1\u5927\u7684\u573a\u666f, \u5c31\u6bd4\u5982\u8bf4\u7535\u5546\u79d2\u6740\u4fc3\u9500, \u8fd9\u4e2a\u65f6\u5019\u5462\u4f1a\u9891\u7e41\u7684\u53bb\u6287\u51cf\u5e93\u5b58, \u4f46\u662f\u4e50\u89c2\u9501\u7248\u672c\u53f7\u7684\u673a\u5236\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u591f\u6709\u4e00\u4e2a\u6263\u51cf\u6210\u529f. </p> <p>\u5176\u4ed6\u7684\u5168\u90e8\u5931\u8d25, \u5176\u4ed6\u7684\u7ebf\u7a0b\u5c31\u9700\u8981\u518d\u6b21\u5c1d\u8bd5, \u91cd\u65b0\u5237\u65b0\u9875\u9762\u554a\u8bf7\u91cd\u65b0\u8bf7\u6c42. \u5c31\u4f1a\u8ba9\u7cfb\u7edf\u7684\u8bf7\u6c42\u538b\u529b\u6296\u589e, \u8fd9\u4e2a\u5c31\u662f\u6240\u8c13\u7684\u91cd\u8bd5\u5f00\u9500,\u8fd8\u4f1a\u62d6\u57ae\u6574\u4e2a\u4e1a\u52a1\u5e73\u53f0</p> <p>\u6240\u4ee5\u4e50\u89c2\u9501\u7684\u4f7f\u7528\u573a\u666f, \u4e00\u822c\u662f\u8bbf\u95ee\u91cf\u5927\u4f46\u662f\u4fee\u6539\u7684\u91cf\u5c11\u7684\u573a\u666f, \u65e2\u80fd\u591f\u625b\u4f4f\u9ad8\u5e76\u53d1\u53c8\u80fd\u591f\u9501\u5b9a\u8d44\u6e90, \u5982\u679c\u4f60\u7528\u4e50\u89c2\u9501\u5c31\u518d\u5408\u9002\u4e0d\u8fc7\u4e86,\u4e50\u89c2\u9501\u4e5f\u4f1a\u7528\u5728\u5e42\u7b49\u7684\u63a7\u5236\u4e0a\u9762</p>"},{"location":"chap7/int_anws/#9_3","title":"9 \u4e0d\u63a8\u8350\u7528\u60b2\u89c2\u9501","text":"<p>\u4ece\u6027\u80fd\u65b9\u9762\u6765</p> <p>\u6bcf\u6b21\u90fd\u5f97\u52a0\u9501\uff0c\u52a0\u9501\uff0c\u91ca\u653e\u9501\uff0c\u5f00\u9500\u5c31\u4e0a\u53bb\u4e86\u3002 </p> <p>\u8fd8\u6709\u9501\u7ade\u4e89\uff0c\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u6709\u4e00\u4e2a\u4e8b\u52a1\u5728\u4fee\u6539\u6570\u636e\uff0c \u90a3\u4e48\u5176\u4ed6\u7684\u6570\u636e\u90e8\u4e8b\u52a1\uff0c\u5168\u90e8\u662f\u963b\u585e\u7684\u72b6\u6001\u3002 \u5927\u5bb6\u90fd\u5728\u7b49\u5f85\u5f53\u524d\u7684\u4e8b\u52a1\u7ed3\u675f\uff0c\u5c31\u957f\u65f6\u95f4\u7684\u5360\u7528\u4e86\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u8fde\u63a5\u3002 \u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u6570\u91cf\u662f\u6709\u9650\u7684\uff0c\u957f\u65f6\u95f4\u5360\u7528\uff0c\u5176\u4ed6\u7684\u7ebf\u7a0b\u3002</p> <p>\u83b7\u53d6\u4e0d\u5230\u6570\u636e\u5e93\u7684\u8fde\u63a5\uff0c\u4e0a\u9762\u5e94\u7528\u5c42\u7684\u8fde\u63a5\u5c31\u4f1a\u8d85\u65f6\u3002\u6bd4\u5982\u8bf4\u50cf\u7f51\u5173\u5c42\u7684\u8fde\u63a5\uff0c\u8d1f\u8f7d\u5747\u8861\u7684\u8fde\u63a5\u90fd\u4f1a\u8d85\u65f6\uff0c \u5c31\u4f1a\u5f15\u8d77\u6240\u8c13\u7684\u60ca\u7fa4\u6548\u5e94\uff0c\u5bfc\u81f4\u6574\u4e2a\u5e73\u53f0\u5c31\u4f1a\u51fa\u73b0\u8d85\u65f6\u7684\u73b0\u8c61\uff0c \u7136\u540e\u6570\u636e\u5e93\u5e73\u53f0\u4e5f\u4f1a\u9891\u7e41\u7684\u62a5\u9519</p> <p>\u52a0\u9501</p> <p>\u5404\u79cd\u6162sql\u968f\u4e4b\u800c\u6765\uff0c\u77e5\u9053\u60b2\u89c2\u9501 \uff08\u9ed8\u8ba4\uff09 \u52a0\u7684\u662f\u884c\u9501\u3002\u57fa\u4e8e\u6570\u636e\u5e93\u7684\u7d22\u5f15\u6765\u52a0\u7684\u9501\uff0c\u5982\u679c\u9047\u5230\u7d22\u5f15\u5931\u6548\u3002 </p> <p>\u672c\u6765\u52a0\u4e86\u884c\u9501\uff0c\u53ef\u80fd\u5c31\u7acb\u9a6c\u5c31\u5347\u7ea7\u4e3a\u8868\u9501\uff0c\u9501\u4f4f\u4e86\u6574\u4e2a\u8868\uff0c\u5982\u679c\u6d89\u53ca\u5230\u4e86\u591a\u4e2a\u8868\u7684\u5173\u8054\u67e5\u8be2\uff0c\u5f88\u5bb9\u6613\u5c31\u4f1a\u53d8\u6210\u6b7b\u9501\u3002 \u5982\u679c\u6ca1\u6709\u5916\u754c\u7684\u5e72\u9884\uff0c\u5c31\u4f1a\u4e00\u76f4\u9501\u4e0b\u53bb\u5c24\u5176\u662f\u5e76\u53d1\u91cf\u5927\u7684\u573a\u666f\u3002 </p> <p>\u4e0d\u9002\u7528\u8bfb\u591a\u5199\u5c11\u7684\u573a\u666f\uff0c \u8fd9\u4e9b\u573a\u666f\u5982\u679c\u662f\u7528\u60b2\u89c2\u9501\u3002</p> <p>\u90a3\u4ec0\u4e48\u573a\u666f\u80fd\u7528</p> <p>\u4e00\u822c\u662f\u5728\u4e00\u4e9b\u8981\u6c42\u6570\u636e\u5f3a\u4e00\u81f4\u7684\u573a\u666f\uff0c\u5e76\u53d1\u91cf\u53c8\u4e0d\u9ad8\u7684\u573a\u666f\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\uff0c\u6bd4\u5982\u8bf4\u50cf\u91d1\u878d\u7c7b\u7684\u8fd9\u4e2a\u8d26\u6237\u5904\u7406\uff0c \u5e93\u5b58\u6263\u51cf\u7b49\u7b49</p>"},{"location":"chap7/int_anws/#10_2","title":"10 \u804a\u804a\u6570\u636e\u5e93\u7684\u8868\u9501\u3001\u884c\u9501","text":"<p>\u4e00\u822c\u9ed8\u8ba4\u90fd\u662f\u52a0\u7684\u662f\u884c\u9501\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u6b63\u5728\u66f4\u65b0\u7684\u64cd\u4f5c\u3002\u90a3\u4e48\u5176\u4ed6\u7684\u66f4\u65b0\u8bf7\u6c42\u662f\u8fdb\u4e0d\u6765\u7684\uff0c\u4e3b\u8981\u5c31\u662f\u4e3a\u4e86\u9632\u6b62\u4fee\u6539\u7684\u8fc7\u7a0b\u4e2d\u3002 \u6709\u5176\u4ed6\u7684\u4e8b\u52a1\u6765\u4fee\u6539\u540c\u4e00\u6761\u8bb0\u5f55\u9020\u6210\u810f\u6570\u636e\u3002</p> <p>\u8fd9\u4e2a\u65f6\u5019\u7528\u7684\u5c31\u662f\u884c\u9501\uff0c\u518d\u6bd4\u5982\u8bf4\u4fee\u6539\u8868\u7ed3\u6784\u3002\u4fee\u6539\u4e00\u4e2a\u5b57\u6bb5\uff0c\u540d\u79f0\u3002 \u6216\u8005\u662f\u4fee\u6539\u5b83\u7684\u7c7b\u578b\uff0c\u90a3\u4e48mysql\u5c31\u4f1a\u628a\u5f53\u524d\u7684\u8868\u9501\u4f4f\uff0c\u6240\u6709\u5173\u4e8e\u8fd9\u4e2a\u8868\u7684\u3002 </p> <p>\u53ea\u6709\u4fee\u6539\u5b8c\u6210\u4e4b\u540e\u91ca\u653e\u4e86\u8868\u9501\uff0c\u624d\u80fd\u8ba9\u4ed6\u8fdb\u3002\u8fd9\u4e2a\u65f6\u5019\u5c31\u662f\u628a\u6574\u4e2a\u8868\u9501\u4f4f\uff0c\u90a3\u4e48\u8868\u9501\u9501\u7684\u8303\u56f4\u6bd4\u8f83\u5e7f\u3002\u6bd4\u5982\u8bf4\u4fee\u6539\u4e86\u8868\u7684\u7ed3\u6784\uff0c\u5b57\u6bb5\u7684\u540d\u79f0\uff0c\u6216\u8005\u662f\u7c7b\u578b\u3002 \u5f80\u751f\u4ea7\u73af\u5883\u540c\u6b65\u7684\u65f6\u5019\uff0c \u6216\u8005\u8bf4\u662f\u9501\u7684\u8303\u56f4\u3002 </p> <p>\u884c\u9501\u76f8\u5bf9\u8868\u6240\u6765\u8bf4\uff0c\u5c31\u8981\u7a0d\u5fae\u590d\u6742\u4e00\u4e9b\uff0c\u5982\u679cwhere\u6761\u4ef6\u91cc\u9762\u5339\u914d\u7684\u662f\u7d22\u5f15\uff0c\u6bd4\u5982\u8bf4\u4e3b\u952eID\u7d22\u5f15\uff0cID\u7b49\u4e8e1\uff0c \u8fd9\u4e2a\u65f6\u5019\u5c31\u4f1a\u628aID\u7b49\u4e8e1\u7684\uff0c\u8fd9\u6761\u8bb0\u5f55\u52a0\u4e00\u4e2a\u9501\uff0c\u53eb\u8bb0\u5f55\u9501\uff0c\u5f53\u7136\u8fd9\u4e2a\u4e5f\u662f\u884c\u9501</p> <p>\u53ea\u662f\u9488\u5bf9\u5f53\u524d\u7684\u8bb0\u5f55\u52a0\u7684\u9501\uff0c\u90a3\u4e48\u5982\u679c\u67e5\u8be2\u7684\u6761\u4ef6\u662f\u6240\u6709\u7684\u8303\u56f4\u3002\u6bd4\u5982\u8bf4\u8fd9\u4e2aID\u57282-5\u4e4b\u95f4\uff0c\u90a3\u4e48\u52a0\u7684\u4e5f\u662f\u8bb0\u5f55\u9501\uff0c\u53ea\u662f\u5b83\u4e0d\u6b62\u4e00\u6761\uff0c\u662f\u597d\u51e0\u6761\uff0c\u5982\u679c\u6ca1\u6709\u8bb0\u5f55\u7684\u8bdd\uff0c \u7167\u6837\u4f1a\u52a0\u9501\uff0c\u4ed6\u53eb\u95f4\u9699\u9501\uff0c\u5c5e\u4e8e\u884c\u9501\u7684\u4e00\u79cd\uff0c\u5bf9\u4e00\u4e9b\u4e0d\u5b58\u5728\u7684\u8bb0\u5f55\u8fdb\u884c\u52a0\u9501\uff0c \u52a0\u9501\u7684\u76ee\u7684\u4e3b\u8981\u662f\u4e3a\u4e86\u9632\u6b62\u5e7b\u8bfb</p> <p>\u5e7b\u8bfb\uff1a</p> <p>\u5982\u679c\u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u91cc\u9762\uff0c \u4e00\u5f00\u59cb\u8bfb\u5230\u7684\u6570\u636e\u662f\u7a7a\u7684\uff0c \u5982\u679c\u4e0d\u52a0\u9501\u7684\u8bdd\u3002 \u5176\u4ed6\u7684\u4e8b\u7269\uff0c\u53c8\u628a\u8fd9\u4e2a\u7a7a\u9699\u589e\u52a0\u4e86\u4e00\u4e2a\u6570\u636e\u3002\u90a3\u4e48\u518d\u6b21\u8bfb\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u9020\u6210\u4e24\u4e2a\u7ed3\u679c\u4e0d\u4e00\u6837\uff0c\u8fd9\u4e2a\u5728\u6570\u636e\u5e93\u91cc\u9762\u53eb\u505a\u5e7b\u8bfb\u3002</p> <p>\u8fd9\u4e2a\u662finnodb\u4e0d\u5141\u8bb8\uff0c\u7136\u540e\u884c\u9501\u91cc\u9762\u8fd8\u6709\u8fd9\u4e2a\u4e34\u952e\u9501\uff0c\u662f\u8bb0\u5f55\u9501\u8ddf\u95f4\u9699\u9501\u7684\u7ec4\u5408\uff0c \u5982\u679c\u8303\u56f4\u67e5\u8be2\u91cc\u9762\u65e2\u6d89\u53ca\u5230\u4e86\u8fd9\u4e2a\u6709\u8bb0\u5f55\u7684ID\uff0c\u53c8\u6d89\u53ca\u5230\u4e86\u6ca1\u6709\u8bb0\u5f55\u7684ID\uff0c\u5c31\u662f\u8bb0\u5f55\u9501\u8ddf\u95f4\u9699\u9501\u7684\u7ec4\u5408\u62f3\uff0c\u4e24\u4e2a\u4e00\u8d77</p> <p>\u52a0\u884c\u9501\u4e5f\u5c31\u662f3\u79cd\uff0c\u8bb0\u5f55\u9501\uff0c\u95f4\u9699\u9501\uff0c\u4e34\u952e\u9501 </p> <p>\u5f53\u7136\u8fd9\u4e9b\u90fd\u662f\u8981\u57fa\u4e8e\u7d22\u5f15, \u5982\u679c\u4f60\u7684\u7d22\u5f15\u4e0d\u5b58\u5728,\u4f1a\u76f4\u63a5\u5347\u7ea7\u4e3a\u8868\u9501,\u9501\u4f4f\u6574\u4e2a\u8868.</p> <p>\u53ea\u8981\u6d89\u53ca\u5230\u8fd9\u4e2a\u8868\u7684\u4fee\u6539\u90fd\u4f1a\u88ab\u963b\u585e, \u4f1a\u4ea7\u751f\u5404\u79cd\u7684\u6162\u65e5\u5fd7,\u7136\u540e\u662f\u6570\u636e\u5e93\u8fde\u63a5\u8d85\u65f6,\u63a5\u53e3\u54cd\u5e94\u8d85\u65f6, \u7f51\u5173\u8d85\u65f6\u7b49\u7b49\u4e00\u7cfb\u5217\u7684\u53cd\u5e94</p>"},{"location":"chap7/int_anws/#11_2","title":"11 \u6570\u636e\u5e93\u7684\u4e3b\u952e\u7d22\u5f15\uff0e\u4e8c\u7ea7\u7d22\u5f15","text":"<p>\u7d20\u5f15\u5b58\u5728\u7684\u76ee\u7684\u4e5f\u5c31\u662f\u4e3a\u4e86\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u67e5\u8be2\u6548\u7387\uff0c \u4e0d\u7ba1\u8868\u6709\u6ca1\u6709\u4e3b\u52a8\u8bbe\u7f6e\u7d22\u5f15\uff0c\u5176\u5b9e\u90fd\u4f1a\u6709\u4e00\u4e2a\u9ed8\u8ba4\u7684\u7d22\u5f15\uff0c\u8fd9\u4e2a\u9ed8\u8ba4\u7684\u7d22\u5f15\uff0c\u5c31\u662f\u6570\u636e\u5e93\u91cc\u9762\u7684\u4e3b\u952e\u7d22\u5f15\uff0c\u53c8\u53eb\u805a\u7b77\u7d22\u5f15\uff0c\u4e3b\u952e\u7d22\u5f15\u91cc\u9762\u5b58\u50a8\u4e86\u8fd9\u6761\u8bb0\u5f55\u7684\u6240\u6709\u6570\u636e\uff0c\u53ea\u8981\u8fd9\u6761\u8bb0\u5f55\u5b58\u5728\uff0c \u90a3\u4e48\u5c31\u4f1a\u6709\u4e3b\u952e\u7d22\u5f15</p> <p>\u4e3b\u952e\u7d22\u5f15\uff0c\u6309\u7167b+\u6811\u7684\u89c4\u5219\u6392\u5217\u597d\u4e3b\u952eId, \u4ece\u5c0f\u5230\u5927\u6392\u5217, \u8fd9\u4e2a\u65f6\u5019\u5462\u5982\u679c\u8981\u63d2\u5165\u4e00\u6761\u8bb0\u5f55, \u5c31\u4f1a\u5148\u8ba1\u7b97ID\u5728b+\u6811\u4e0a\u7684\u4f4d\u7f6e,\u7136\u540e\u6267\u884c\u63d2\u5165</p> <p>\u4e8c\u7ea7\u7d22\u5f15,\u9664\u4e86\u4e3b\u952e\u7d22\u5f15\u4ee5\u5916, \u5176\u4ed6\u52a0\u7684\u6240\u6709\u7684\u7d20\u5f15\u90fd\u662f\u4e8c\u7ea7\u7d22\u5f15. \u4e3b\u952e\u7d22\u5f15\u91cc\u5b58\u7684\u662f\u8bb0\u5f55, \u4e8c\u7ea7\u7d22\u5f15\u91cc\u5b58\u7684\u662f\u4e3b\u952e\u7d20\u5f15</p> <p>\u4e8c\u7ea7\u7d22\u5f15\u5b58\u5728\u7684\u76ee\u7684\u5c31\u662f\u4e3a\u4e86\u627e\u5230\u4e3b\u952e\u7d22\u5f15, \u56e0\u4e3a\u6240\u6709\u7684\u6570\u636e\u90fd\u5728\u4e3b\u952e\u7d22\u5f15\u91cc\u9762</p>"},{"location":"chap7/int_anws/#12-no","title":"12 \u7d22\u5217\u52a0\u7684\u8d8a\u591a\u8d8a\u597d -  No","text":"<p>\u7d22\u5f15\u7528\u7684\u662fb+\u6811, \u6bcf\u52a0\u4e00\u4e2a\u7d22\u5f15, \u5176\u5b9e\u5c31\u4f1a\u589e\u52a0\u4e00\u68f5b\u52a0\u6811\uff0c\u6240\u4ee5\u7d22\u5f15\u8d8a\u591a\uff0c\u81ea\u7136\u8fd9\u4e2a\u6811\u7684\u68f5\u6570\u5c31\u4f1a\u8d8a\u591a\uff0c \u90a3\u4e48\u518d\u52a0\u4e0a\u8868\u7684\u6570\u636e\u6301\u7eed\u589e\u5927\uff0c\u90a3\u4e48\u6811\u4e0a\u7684\u53f6\u5b50\u5c31\u4f1a\u8d8a\u6765\u8d8a\u591a\uff0c\u5c31\u5360\u7684\u8fd9\u4e2a\u78c1\u76d8\u7a7a\u95f4\u4e5f\u5c31\u8d8a\u6765\u8d8a\u5927\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\u5462\u4ecesql\u6548\u7387</p> <p>\u7d22\u5f15\u591a\u4e86\uff0c\u67e5\u8be2\u4e0a\u80af\u5b9a\u662f\u6ca1\u95ee\u9898\u3002 \u67e5\u7684\u5feb\uff0c\u4f46\u662f\u5bf9\u4e8e\u8868\u7684\u64cd\u4f5c\uff0c\u50cf\u65b0\u589e\uff0c\u4fee\u6539\uff0c\u5220\u9664\u6548\u7387\u5c31\u4f1a\u53d8\u4f4e\u3002 \u6bcf\u64cd\u4f5c\u4e00\u56de\uff0c\u90fd\u5f97\u7ef4\u62a4\u4e00\u4e0b\u6240\u6709\u7684\u7d22\u5f15\u6811\uff0c \u5982\u679c\u65b0\u589e\u7684\u8bdd\uff0c\u8fd8\u8981\u53bb\u68c0\u7d22\u6dfb\u52a0\u7684\u4f4d\u7f6e\uff0c\u56e0\u4e3aB+\u6811\u662f\u4ece\u5c0f\u5230\u5927\u6392\u5217\uff0c\u589e\u52a0\u4e00\u4e2a\u5c31\u5f97\u91cd\u65b0\u6392\u5e8f\uff0c \u5f53\u7136\u5982\u679c\u5f53\u524d\u7684\u6570\u636e\u9875\u6ee1\u4e86\uff0c\u8fd8\u8981\u91cd\u65b0\u53bb\u521b\u5efa\u65b0\u7684\u6570\u636e\u9875\uff0c\u90a3\u4e48\u6574\u4e2a\u7684\u68c0\u7d22\u5440\u6392\u5e8f\uff0c\u521b\u5efa\uff0c\u63d2\u5165\uff0c\u5c31\u4f1a\u5927\u5927\u7684\u964d\u4f4e\u64cd\u4f5c\u7684\u6027\u80fd</p> <p>\u5bf9\u67e5\u8be2\u786e\u5b9e\u4e0d\u9519\uff0c\u4f46\u662f\u5bf9\u4e8e\u589e\u5220\u6539\u6ca1\u90a3\u4e48\u53cb\u597d\u4e86\uff0c\u5bf9\u4e8e\u7d22\u5f15\u7684\u6dfb\u52a0\uff0c\u516c\u53f8\u89c4\u5b9a\u4e0d\u662f\u90a3\u4e48\u968f\u4fbf\u52a0\u7684\u3002</p> <ul> <li>\u5355\u8868\u7d22\u5f15\u7684\u4e2a\u6570\u4e0d\u80fd\u8d85\u8fc73-5\u4e2a</li> <li>\u5bf9\u4e8e\u4e00\u4e9b\u9891\u7e41\u64cd\u4f5c\u7684\u4e00\u4e9b\u8868\uff0c\u5c3d\u91cf\u4e0d\u80fd\u5efa\u592a\u591a\u7684\u7d22\u5f15\uff0c\u8981\u5c3d\u91cf\u9009\u62e9\u4e00\u4e9b\u64cd\u4f5c\u91cf\u6bd4\u8f83\u5927\u7684\u5b57\u6bb5\u6216\u8005\u5173\u8054\u7684\u6570\u91cf\uff0c\u53bb \u5efa\u6bd4\u8f83\u5927\u7684\u5b57\u6bb5\u6765\u4f5c\u4e3a\u7d22\u5f15</li> </ul>"},{"location":"chap7/int_anws/#13_2","title":"13 \u9ad8\u5e76\u53d1\u4e0b\u4e00\u5b9a\u9002\u5408\u7528\u4e50\u89c2\u9501\u5417\uff1f","text":"<p>\u9009\u7528\u4e50\u89c2\u9501\u56e0\u4e3a\u4e0d\u5b58\u5728\u9501\u7ade\u4e89\uff0c\u6ca1\u6709\u90a3\u4e48\u591a\u7684\u51b2\u7a81\u3002</p> <p>\u9996\u5148\u540c\u4e00\u65f6\u523b\u9ad8\u5e76\u53d1\u4e0b\u8bfb\u53d6\u8d44\u6e90\u7684\u7ebf\u7a0b\u5c31\u6709\u5f88\u591a\uff0c\u4f46\u662f\u53ea\u80fd\u6709\u4e00\u4e2a\u80fd\u66f4\u65b0\u4e0a\u53bb\uff0c\u56e0\u4e3a\u4e50\u89c2\u9501\u7684\u673a\u5236\uff0c\u90a3\u4e48\u5176\u4ed6\u7684\u8bf7\u6c42\u5c31\u4f1a\u5927\u9762\u79ef\u7684\u5931\u8d25\uff0c\u56e0\u4e3a\u7248\u672c\u53f7\u4e0d\u4e00\u81f4\u3002\u90a3\u4e48\u4e00\u65e6\u66f4\u65b0\u5931\u8d25\uff0c \u524d\u7aef\u5c31\u4f1a\u6709\u8fd9\u4e2a\u91cd\u8bd5\u673a\u5236\uff0c\u5c31\u4f1a\u4e0d\u505c\u7684\u53bbget\u8fd9\u4e2a\u8d44\u6e90\uff0c\u5c31\u4f1a\u589e\u52a0\u67e5\u8be2\u63a5\u53e3\u7684\u538b\u529b</p> <p>\u5176\u6b21\u6211\u4eec\u4ece\u6570\u636e\u5e93\u7684\u89d2\u5ea6\uff0c\u540c\u6837\u4e5f\u4f1a\u5b58\u5728\u95ee\u9898\uff0c\u6bd4\u5982\u8bf4\u9501\u7ade\u4e89\uff0cupdate\u66f4\u65b0\u8bed\u53e5\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u7684\u4f7f\u7528\u7684\u662f\u884c\u9501\uff0c\u5373\u4f7f\u6ca1\u6709\u5f00\u542f\u624b\u52a8\u5f0f\uff0c \u6ca1\u6709\u7528for update, \u5b9e\u9645\u4e0a\u53bb\u66f4\u65b0\u4e00\u6761\u6570\u636e, \u540c\u6837\u4e5f\u4f1a\u6709\u9501\u4f4f\u8d44\u6e90,\u53ea\u662f\u901f\u5ea6\u6bd4\u8f83\u5feb\u4f60\u6ca1\u6709\u611f\u77e5</p> <p>\u5982\u679c\u5927\u6279\u91cf\u7684update\u7684\u8fc7\u6765\uff0c \u540c\u4e00\u65f6\u523bupdate\u5c31\u4f1a\u4e0d\u505c\u7684\u53bb\u4e89\u62a2\u884c\u9501\uff0c \u540c\u6837\u4f1a\u5b58\u5728\u9501\u7ade\u4e89\uff0c\u5982\u679c\u91cf\u4e00\u4e0a\u53bb\u6574\u4e2a\u6548\u7387\u5c31\u4f1a\u4e0b\u964d\uff0c\u540c\u6837\u4e5f\u4f1a\u5b58\u5728\u6027\u80fd\u95ee\u9898\u3002</p> <p>\u6240\u4ee5\u9ad8\u5e76\u53d1\u4e0b\uff0c\u6279\u91cf\u7684\u66f4\u65b0\u64cd\u4f5c\uff0c\u80af\u5b9a\u662f\u4e0d\u9002\u5408\u7684\uff0c\u5efa\u8bae\u4f7f\u7528\u8fd9\u4e2aRedis\u6765\u505a\u5e93\u5b58\u7684\u9884\u6263\u51cf\uff0c \u7136\u540e\u5b9a\u671f\u7684\u505a\u597dredis\uff0c\u8ddf\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u540c\u6b65</p> <p>\u90a3\u4e48\u4ec0\u4e48\u573a\u666f\u4e0b\u80fd\u7528\u4e50\u89c2\u9501\uff0c \u90a3\u5c31\u662f\u8bfb\u591a\u5199\u5c11\uff0c\u6709\u8d44\u6e90\u7ade\u4e89\u4f46\u662f\u4e0d\u591a\uff0c\u90a3\u4e48\u4e50\u89c2\u9501\u5c31\u518d\u5408\u9002\u4e0d\u8fc7\u4e86</p>"},{"location":"chap7/int_anws/#14_1","title":"14 \u5982\u4f55\u9632\u6b62\u6570\u636e\u5e93\u7684\u6b7b\u9501","text":"<p>\u90a3\u4e48\u6b7b\u9501\u600e\u4e48\u4ea7\u751f\uff0c\u603b\u7ed3\u4e0b\u6765\u5c31\u4e00\u6761\u5c31\u662f\u4e0d\u540c\u7684\u4e8b\u52a1\u4e4b\u95f4\u53d1\u751f\u4e86\u5faa\u73af\u4f9d\u8d56\uff0c\u6bd4\u5982\u8bf4\u4e8b\u7269a\u8ddf\u4e8b\u7269b\uff0c\u5206\u522b\u5360\u7528\u4e86\u8d44\u6e90x\u8ddf\u8d44\u6e90y\uff0c\u5f53a\u8bd5\u56fe\u8bf7\u6c42y\u7684\u65f6\u5019\uff0c\u4e8b\u7269b\u5374\u53c8\u5360\u7528\u4e86y\uff0c\u8fd9\u4e2a\u65f6\u5019\u5462a\u5c31\u4f1a\u88ab\u963b\u585e\uff0c\u540c\u6837\u7684\u5f53b\u8bd5\u56fe\u8bf7\u6c42x\uff0c\u800ca\u53c8\u5360\u7528\u4e86x\u7684\u65f6\u5019\uff0cb\u4e5f\u4f1a\u88ab\u963b\u585e\uff0c\u8fd9\u4e2a\u65f6\u5019\u5462a\u8ddfb\u90fd\u65e0\u6cd5\u7ee7\u7eed\u6267\u884c\uff0c\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u6b7b\u9501\u3002</p> <p>\u4e5f\u6709\u53ef\u80fd\u662f\u591a\u4e2a\u4e8b\u52a1\u4e4b\u95f4\uff0c\u53d8\u6210\u4e86\u4e00\u79cd\u5faa\u73af\u4f9d\u8d56\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u53d1\u751f\u4e86\u6570\u636e\u5e93\u7684\u6b7b\u9501\uff0c \u6bd4\u8f83\u5e38\u89c1\u7684\u573a\u666f\u5c31\u662f\u76f8\u4e92\u8f6c\u8d26\uff0c</p> <ul> <li>\u6bd4\u8f83\u5e38\u89c1\u7684\u89e3\u6c7a\u65b9\u6848\uff0c\u5c31\u662f\u52a0\u4e0a\u5206\u5e03\u5f0f\u9501\uff0c\u4fdd\u8bc1ab\u4e4b\u95f4\u7684\u8f6c\u8d26\u4e1a\u52a1\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u5904\u7406</li> <li>\u53e6\u5916\u4e00\u79cd\u5904\u7406\u65b9\u5f0f\uff0c\u5c31\u662f\u89c4\u5b9a\u7ebf\u7a0b\u52a0\u9501\u7684\u987a\u5e8f\u8981\u4e00\u81f4\uff0c \u6bd4\u5982\u8bf4\u5148\u9501\u5b9aa\u7684\u8d26\u6237\uff0c\u7136\u540e\u518d\u9501\u5b9ab\u7684\u8d26\u6237\uff0c\u8fd9\u6837\u7684\u8bdd\u6240\u6709\u7684\u8bf7\u6c42\u90fd\u4f1a\u5148\u6309\u7167\u5148a\u540eb\u7684\u987a\u5e8f\u8fdb\u884c\u52a0\u9501\uff0c\u81ea\u7136\u800c\u7136\u5c31\u6ca1\u6709\u6b7b\u9501\u7684\u53d1\u751f\u4e86\uff0c</li> <li>\u4f18\u5316SQL\u8bed\u53e5\u548c\u7d22\u5f15\uff0c \u4e5f\u53ef\u4ee5\u51cf\u5c11\u5bf9\u540c\u4e00\u6570\u636e\u884c\u7684\u7ade\u4e89\uff0c \u52a0\u9501\u5c3d\u91cf\u52a0\u5728\u884c\u7d22\u4e0a\uff0c\u5b83\u7684\u8303\u56f4\u5c31\u4f1a\u7f29\u51cf\u4e86\uff0c\u81ea\u7136\u5c31\u80fd\u591f\u964d\u4f4e\u6b7b\u9501\u7684\u6982\u7387\u4e86\u3002\u5927\u591a\u6570\u6570\u636e\u5e93\uff0c\u4e5f\u4f1a\u63d0\u4f9b\u6b7b\u9501\u7684\u68c0\u6d4b\u548c\u8d85\u65f6\u673a\u5236\uff0c \u5f53\u53d1\u73b0\u6b7b\u9501\u65f6\uff0c\u6570\u636e\u5e93\u4f1a\u81ea\u52a8\u56de\u6eda\u5176\u4e2d\u4e00\u4e2a\u4e8b\u52a1\u6765\u91ca\u653e\u8d44\u6e90,\u907f\u514d\u4e86\u6b7b\u9501\u7684\u8fdb\u4e00\u6b65\u6269\u5927</li> <li>\u8d85\u65f6\u673a\u5236, \u5219\u53ef\u4ee5\u5728\u4e00\u5b9a\u7684\u65f6\u95f4\u5185, \u4e3b\u52a8\u7ed3\u675f\u4e8b\u7269\u6765\u91ca\u653e\u8d44\u6e90, \u907f\u514d\u6b7b\u9501\u7684\u957f\u65f6\u95f4\u6301\u7eed,\u4e5f \u80fd\u591f\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u5e76\u53d1\u6027\u80fd</li> </ul>"},{"location":"chap7/int_anws/#15_3","title":"15 \u96c6\u5408\u6570\u636e\u7684\u66f4\u65b0\uff0c\u5148\u5220\u540e\u589e\u4f1a\u80b2\u4ec0\u4e48\u95ee\u9898\uff1f","text":"<p>\u5982\u679c\u9700\u8981\u66f4\u65b0\u7684\u6570\u636e\uff0c\u6570\u636e\u5e93\u73b0\u6709\u7684\u6570\u636e\u91cf\u4e0d\u4e00\u81f4\uff0c</p> <p>\u89e3\u51b3\u65b9\u6848\uff1a\u635e\u53d6\u5f53\u524d\u4e1a\u52a1\u573a\u666f\u4e2d\u5b58\u5728\u7684\u65e7\u6570\u636e\u7136\u540e\u6839\u636e\u8bf7\u6c42\u7684\u8fd9\u4e2a\u6570\u636e\u6765\u505a\u5bf9\u6bd4</p> <ul> <li>\u5982\u679c\u5728\u8001\u6570\u636e\u4e0d\u5b58\u5728\uff0c\u90a3\u5c31\u4ee3\u8868\u662f\u65b0\u589e\u7684\u6570\u636e\uff0c\u5c31\u8981\u6267\u884c\u8fd9\u4e2ainsert\u7684\u64cd\u4f5c</li> <li>\u5982\u679c\u5728\u8001\u6570\u636e\u4e2d\u5b58\u5728\uff0c\u5982\u679c\u5386\u53f2\u6570\u636e\u4e2d\u7684\u6570\u636e\u5728\u8bf7\u6c42\u7684\u5165\u53c2\u4e2d\u4e0d\u5b58\u5728\uff0c\u90a3\u5c31\u9700\u8981\u5220\u9664\u5386\u53f2\u6570\u636e</li> </ul> <p>\u4f46\u662f\u8fd9\u79cd\u5904\u7406\u65b9\u5f0f\u6bd4\u8f83\u8d39\u52b2\uff0c\u5c31\u4f1a\u91c7\u7528\u4e00\u4e9b\u6bd4\u8f83\u66b4\u529b\u7684\u8fd9\u4e2a\u505a\u6cd5\uff0c\u5c31\u662f\u5168\u90e8\u5e72\u6389\u6570\u636e\uff0c\u5148\u628a\u5168\u90e8\u7684\u6570\u636e\u5220\u6389\uff0c\u7136\u540e\u518d\u65b0\u589e\uff0c\u5f88\u591a\u516c\u53f8\u90fd\u660e\u4ee4\u7981\u6b62\u8fd9\u79cd\u505a\u6cd5</p> <ol> <li>\u4e3b\u952e\u7684\u65ad\u5c42\uff0c\u5982\u679c\u662f\u7269\u7406\u5220\u9664\uff0c\u5927\u91cf\u7684\u4e3b\u952eID\u7f3a\u5931\uff0c\u5c31\u4f1a\u51fa\u73b0\u65ad\u5c42\u7684\u73b0\u8c61\uff0c\u90a3\u4e48\u5927\u91cf\u7684ID\u7a7a\u95f4\u6d6a\u8d39\uff0c\u4e5f\u4f1a\u5bfc\u81f4\u7d22\u5f15\u7684\u5206\u88c2\u548c\u788e\u7247\u5316\uff0c\u81ea\u7136\u67e5\u8be2\u6548\u7387\u4e5f\u4f1a\u53d8\u4f4e\uff0c\u5305\u62ec\u540e\u7eed\u6570\u636e\u7684\u7ef4\u62a4\uff0c\u8fc1\u79fb\uff0c\u5206\u5e93\u5206\u8868</li> <li>\u4e3b\u952e\u65ad\u5c42\uff0c\u4e5f\u4f1a\u5bfc\u81f4\u8fd9\u4e2a\u6570\u636e\u4e0d\u5747\u5300\uff0c\u6570\u636e\u503e\u659c\uff0c\u6027\u80fd\u7684\u6d6a\u8d39</li> </ol> <p>\u6bd4\u5982\u53ea\u8981\u65b0\u589e\u4e00\u6761\u6570\u636e\uff0c\u672c\u4e0d\u5e94\u8be5\u5220\u9664\u7684\u6570\u636e\uff0c\u7136\u540e\u8981\u91cd\u65b0\u6dfb\u52a0\uff0c\u8fd9\u4e2a\u4e00\u5220\u4e00\u589e\u7684\u8fc7\u7a0b\uff0c\u5f88\u660e\u663e\u5c31\u4f1a\u6d6a\u8d39\u5f88\u5927\u7684\u6570\u636e\u5e93\u6027\u80fd</p> <p>\u6bd4\u8f83\u4e25\u8c28\u7684\u5904\u7406\u65b9\u5f0f\u8fd8\u662f\u5206\u522b\uff0c\u901a\u8fc7\u5224\u65ad\u6765\u53bb\u5904\u7406\u65b0\u589e\u4fee\u6539\u548c\u5220\u9664\uff0c\u5bf9\u4e8e\u6574\u4e2a\u4e1a\u52a1\u8fd8\u7b97\u7a33\u59a5</p> <p>\u5f53\u7136\u65b0\u589e\u548c\u4fee\u6539\uff0c\u53ef\u4ee5\u505a\u4e00\u4e9b\u4f18\u5316\u4e86\uff0c\u6bd4\u8f83\u5e38\u7528\u7684\u65b9\u5f0f\u5462\u5c31\u662f\u7528\u8fd9\u4e2a\u201cINSERT ON DUPLICATE KEY UPDATE\u201d\uff0c\u5728\u6267\u884c\u65f6\u4f1a\u68c0\u67e5\u662f\u5426\u5df2\u7ecf\u5b58\u5728\u4e00\u4e2aunique\u952e\u7684\u7ea6\u675f\u7684\u8bb0\u5f55\u3002</p> <p>\u5982\u679c\u5b58\u5728\u5c31\u6267\u884c\u66f4\u65b0\u7684\u64cd\u4f5c\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5c31\u6267\u884c\u63d2\u5165\u7684\u64cd\u4f5c\uff0c\u8fd9\u6837\u7684\u8bdd\u5c31\u76f8\u5f53\u4e8e\u5c11\u4e86\u4e00\u6b65\uff0c\u628a\u51b3\u5b9a\u65b0\u589e\u8fd8\u662f\u4fee\u6539\u632a\u5230\u6570\u636e\u5e93\u6765\u505a</p>"},{"location":"chap7/int_anws/#15-sql","title":"15 \u7ebf\u4e0a\u6162SQL\u7684\u539f\u56e0","text":"<p>\u7ebf\u4e0a\u6162SQL\u7684\u539f\u56e0\uff0c\u6bd4\u5982\u8bf4\u5e38\u89c1\u662f\u6ca1\u6709\u52a0\u7d22\u5f15\u6216\u8005\u662f\u7d22\u5f15\u672a\u547d\u4e2d\u3002 \u7d22\u5f15\u6ca1\u547d\u4e2d\uff0c\u6570\u636e\u5e93\u5c31\u8981\u6267\u884c\u5168\u8868\u626b\u63cf\u3002</p> <p>\u6240\u4ee5\u6709\u610f\u8bc6\u5730\u53bb\u52a0\u7d22\u5f15\uff0c\u5373\u4f7f\u52a0\u4e86\u7d22\u5f15\u4e5f\u8981\u53bb\u68c0\u67e5\u7d22\u5f15\u5230\u5e95\u6709\u6ca1\u6709\u5931\u6548\uff0c\u7d20\u5f15\u5931\u6548\u7684\u573a\u666f\u4e5f\u6709\u5f88\u591a\u3002\u6bd4\u5982\u8bf4\u7d22\u5f15\u5217\u7528\u4e86\u8ba1\u7b97\u51fd\u6570\uff0c \u8054\u5408\u7d22\u5f15\u4e0d\u7b26\u5408\u6700\u5de6\u5339\u914d\uff0c \u4e0d\u6021\u5f53\u7684\u6a21\u7cca\u641c\u7d22\uff0c \u8303\u56f4\u68c0\u7d22\u7b49\u7b49</p> <p>\u8fd8\u6709\u4e00\u4e2a\u6162sql\u7684\u573a\u666f\uff0c\u5c31\u662f\u591a\u8868\u5173\u8054\u3002\u5373\u4f7f\u8bf4\u90fd\u547d\u4e2d\u4e86\u7d22\u5f15\uff0c\u626b\u63cf\u7684\u884c\u6570\u4ecd\u7136\u662f\u5de8\u5927\u7684\uff08\u6570\u636e\u91cf\u5927\u65f6\uff09\u6267\u884c\u901f\u5ea6\u4ecd\u7136\u4f1a\u53d7\u5230\u5f88\u5927\u7684\u5f71\u54cd\u3002\u4e00\u822c\u8d85\u8fc73\u4e2a\u8868\uff0c\u5c3d\u91cf\u7684\u907f\u514d\u9700\u8981\u5c06\u5b83\u62c6\u6210\u591a\u4e2a\u67e5\u8be2\uff0c\u4e5f\u5c31\u662f\u5e38\u8bf4\u7684\u8fd9\u4e2a\u7a7a\u95f4\u6362\u65f6\u95f4</p> <p>\u53ef\u80fd\u4ea7\u751f\u6162sql\u7684\u56e0\u7d20\uff0c\u5c31\u662f\u9047\u5230\u4e86\u884c\u9501\u6216\u8005\u8868\u9501\u3002</p> <ul> <li>\u90a3\u8868\u9501\u5c31\u662f\u9501\u4f4f\u4e86\u6574\u4e2a\u8868\uff0c\u4e00\u65e6\u8868\u9501\u4f4f\uff0c\u90a3\u4e48\u5176\u4ed6\u7528\u6237\u9700\u8981\u7b49\u5f85\u9501\u91ca\u653e\uff0c\u624d\u80fd\u8fdb\u884c\u64cd\u4f5c\uff0c\u8fd9\u6837\u7684\u8bdd\u5c31\u4f1a\u5bfc\u81f4\u6027\u80fd\u6781\u5927\u7684\u4e00\u4e2a\u4e0b\u964d\u3002\u5982\u679c\u9501\u5b9a\u7684\u65f6\u95f4\u8fc7\u957f\uff0c\u53ef\u80fd\u8fd8\u4f1a\u5bfc\u81f4\u6574\u4e2a\u7cfb\u7edf\u7684\u5d29\u6e83\uff0c\u4e5f\u4f1a\u6709\u4e00\u4e9b\u8fd9\u4e2a\u76d1\u542c\u7684\u7a0b\u5e8f\uff0c\u6765\u9632\u6b62\u51fa\u73b0\u9501\u8868\u7684\u60c5\u51b5\u554a</li> <li>\u90a3\u4e48\u5bf9\u4e8e\u884c\u9501\uff0c \u4e00\u822c\u90fd\u662f\u4e8b\u52a1\u53d1\u751f\u963b\u585e\u3002\u5982\u679c\u4e00\u4e2a\u4e8b\u52a1\u9501\u4f4f\u4e86\u67d0\u6761\u8bb0\u5f55\uff0c\u90a3\u4e48\u53e6\u4e00\u4e2a\u4e8b\u52a1\uff0c\u5c31\u65e0\u6cd5\u5bf9\u5b83\u8fdb\u884c\u4fee\u6539\uff0c\u53ea\u80fd\u963b\u585e\u3002\u5982\u679c\u65e0\u6cd5\u5feb\u901f\u7684\u91ca\u653e\uff0c\u90a3\u4e48\u5f88\u5bb9\u6613\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a\u6162sql</li> </ul> <p>\u5f53\u7136\u5982\u679c\u547d\u4e2d\u4e86\uff0c\u7d22\u5f15\u4e5f\u6ca1\u6709\u51fa\u73b0\u591a\u8868\u7684\u5173\u8054\uff0c\u4e5f\u6ca1\u6709\u9047\u5230\u884c\u9501\u8868\u9501\uff0c\u67e5\u8be2\u8fd8\u662f\u6162\uff0c\u4e5f\u6ca1\u6709\u9047\u5230\u884c\u9501\u8868\u9501\uff0c\u67e5\u8be2\u8fd8\u662f\u6162\uff0c\u4e5f\u6ca1\u6709\u9047\u5230\u884c\u9501\u8868\u9501\uff0c\u67e5\u8be2\u8fd8\u662f\u6162\uff0c\u662f\u4e0d\u662f\u5404\u4e2a\u4e2d\u95f4\u4ef6\u6709\u7f51\u7edc\u5ef6\u8fdf\uff0c\u662f\u4e0d\u662f\u67e5\u8be2\u5185\u5bb9\u8fc7\u591a\uff0c\u662f\u4e0d\u662f\u6bcf\u6b21\u90fd\u8981\u56de\u8868\uff0c\u540c\u6837\u4e5f\u4f1a\u5f15\u8d77\u6162SQL\u7684\u4ea7\u751f</p>"},{"location":"chap7/int_anws/#16-sql","title":"16 SQL\u4f18\u5316 \u4e0d\u540c\u7684\u5b57\u7b26\u96c6\u5f15\u8d77\u7684\u7d22\u5f15\u5931\u6548","text":"<p>\u547d\u4e0d\u4e2d\u7d22\u5f15\uff0c\u8d70\u7684\u5168\u662f\u5168\u8868\u626b\u63cf \u90a3\u4e48\u6700\u540e\u5b9a\u4f4d\u4e0b\u6765\uff0c \u7adf\u7136\u662f\u4e24\u4e2a\u8868\u7684\u5b57\u7b26\u96c6\u4e0d\u4e00\u81f4\u3002</p> <p>\u4e00\u4e2a\u7528\u7684\u662fUTF8\uff0c\u4e00\u4e2a\u7528\u7684\u662fUTF8MB4\uff0c\u4f46\u662f\u4e24\u8005\u662f\u5c5e\u4e8e\u5b8c\u5168\u4e0d\u4e00\u6837\u7684\u5b87\u7b26\u96c6\uff0cUTF8MB4\u7684\u7279\u6b8a\u5b57\u7b26\u96c6UTF8\u5c31\u4e0d\u652f\u6301\u3002  \u6240\u4ee5\u5728\u5173\u8054\u67e5\u8be2\u7684\u65f6\u5019\uff0c \u5c31\u662f\u5c06\u8fd9\u4e2a\u5b57\u7b26\u7531UTF8\u8f6c\u6362\u6210UTF8MB4</p> <p></p> <p>\u8fd9\u4e2a\u5c31\u662f\u7d22\u5f15\u5931\u6548\u7684\u8fd9\u4e2a\u539f\u56e0\u6240\u5728\uff0c\u56e0\u4e3a\u4f7f\u7528\u4e86\u8fd9\u4e2aconvert\u51fd\u6570</p> <p>\u4e00\u822c\u53bb\u5206\u6790\u7d22\u5f15\u5931\u6ca1\u5931\u6548\uff0c\u90fd\u662f\u76f4\u63a5\u901a\u8fc7\u5728\u6267\u884c\u8bed\u5411\u524d\u9762\uff0c\u7528explain,\u6765\u770b\u7d22\u5f15\u6709\u6ca1\u6709\u547d\u4e2d,\u770b\u4e0d\u4e86\u592a\u591a\u7684\u5185\u5bb9\u554a</p> <p><code>explain format=json</code>,\u518d\u52a0\u4e0a\u4f60\u7684SQL</p>"},{"location":"chap7/int_anws/#17_1","title":"17 \u6570\u636e\u5e93\u4e2d\u4f7f\u7528\u4e34\u65f6\u8868\u4f1a\u5e26\u6765\u90a3\u4e9b\u95ee\u9898","text":"<p>\u5f53\u521d\u4f7f\u7528\u4e34\u65f6\u8868\u7684\u76ee\u7684\uff0c\u5c31\u662f\u4e3a\u4e86\u80fd\u591f\u50cf\u771f\u5b9e\u7684\u6570\u636e\u8868\u91cc\u4e00\u6837\uff0c\u53ef\u4ee5\u7528\u805a\u5408\uff0c\u5173\u8054\uff0c\u6392\u5e8f\uff0c\u53ef\u4ee5\u7701\u5199\u4e00\u5806\u4e1a\u52a1\u4ee3\u7801\u7684\u65f6\u95f4\u3002 </p> <p>\u4f7f\u7528\u4e34\u65f6\u8868\u76ee\u7684\uff0c\u5c31\u662f\u4e3a\u4e86\u7701\u4e8b\u3002\u53ea\u8981\u91cf\u4e0d\u5927\uff0c\u4e34\u65f6\u8868\u662f\u53ef\u4ee5\u5728\u5185\u5b58\u505a\u4e00\u4e9b\u5904\u7406\u7684\uff0c\u7d22\u5f15\u7684\u4f7f\u7528\u4e5f\u662f\u6709\u6548\u7684\u3002\u4f46\u662f\u4e00\u65e6\u91cf\u5927\u4e86\uff0c\u4ed6\u662f\u65e0\u6cd5\u5c06\u6570\u636e\u5168\u90e8\u5b58\u50a8\u5728\u5185\u5b58\u91cc\u7684\u3002 </p> <p>Mysql\u5c31\u4f1a\u5c06\u90e8\u5206\u7684\u6570\u636e\u5199\u5165\u5230\u78c1\u76d8, \u6765\u91ca\u653e\u8fd9\u4e2a\u5185\u5b58\u7684\u7a7a\u95f4. \u76f8\u6bd4\u4e8e\u5185\u5b58, \u78c1\u76d8\u7684\u8bbf\u95ee\u7684\u901f\u5ea6\u6162\u4e0b\u6765\u4e86. \u7d22\u5f15\u6548\u7387\u4e5f\u4f1a\u53d7\u5230\u9650\u5236,\u67e5\u8be2\u5927\u6982\u7387\u5462\u5bfc\u81f4\u5168\u8868\u626b\u63cf,\u901f\u5ea6\u4e5f\u5c31\u6162\u4e86. \u5176\u5b9e\u60f3\u8981\u9488\u5bf9\u8fd9\u4e2a\u5185\u5b58\u4e2d\u7684\u6570\u636e,\u505a\u4e00\u4e9b\u805a\u5408, \u5173\u8054\u8ba1\u7b97\u53ef\u4ee5\u4f7f\u7528.  \u50cf\u8fd9\u4e2ajava\u91cc\u9762\u7684\u8fd9\u4e2alambda\u8868\u8fbe\u5f0f, Java 8\u4ee5\u540e\u7684\u7248\u672c. \u4e5f\u90fd\u652f\u6301\u8fd9\u6837\u7684\u5904\u7406\u65b9\u5f0f. \u6ca1\u5fc5\u8981\u975e\u8981\u7528\u4e34\u65f6\u8868\u624d\u80fd\u5904\u7406.</p> <p>\u5982\u679c\u6570\u636e\u91cf\u6bd4\u8f83\u5927, \u90a3\u4e48\u4f60\u521b\u5efa\u67e5\u8be2\u554a\u4e34\u65f6\u8868,  \u8fd8\u4f1a\u5bfc\u81f4\u9891\u7e41\u7684\u8fd9\u4e2a\u78c1\u76d8IO, \u4f1a\u964d\u4f4e\u67e5\u8be2\u7684\u6027\u80fd, \u90a3\u4e48\u5982\u679cAPI\u53c8\u5b58\u5728\u8fd9\u4e2a\u5e76\u53d1\u64cd\u4f5c, \u90a3\u4e48\u9891\u7e41\u7684\u521b\u5efa\u9500\u6bc1.  \u53ef\u80fd\u4f1a\u5f15\u53d1\u66f4\u5927\u7684\u8fd9\u4e2a\u6027\u80fd\u95ee\u9898, \u4e34\u65f6\u8868\u65e0\u6cd5\u4f7f\u7528\u5206\u5e03\u5f0f\u4e8b\u52a1\u3002 </p> <p>\u53d1\u73b0Seata\u662f\u4e0d\u652f\u6301\u4e34\u65f6\u8868\uff0c\u4e34\u65f6\u8868\u521b\u5efa\u5b8c\uff0c\u4f1a\u7acb\u523b\u63d2\u5165\u6570\u636e\uff0cSeata\u53c8\u65e0\u6cd5\u7acb\u523b\u83b7\u53d6\u5230\u8868\u7684\u7ed3\u6784\uff0c\u5b83\u7684\u5143\u6570\u636e\u662f\u65e0\u6cd5\u83b7\u53d6\u7684\uff0c\u90a3\u4e48\u4e5f\u5c31\u65e0\u6cd5\u751f\u6210\u53cd\u5411\u7684sql\uff0c\u90a3\u4e48\u5728\u540e\u671f\u81ea\u7136\u4e5f\u5c31\u65e0\u6cd5\u56de\u6eda\u6570\u636e</p> <p>\u7ba1\u7406\u5668\u67e5\u4e0d\u5230\u4e34\u65f6\u8868\u7684\u5143\u6570\u636e\u4f1a\u76f4\u63a5\u62a5\u8868\u4e0d\u5b58\u5728\uff0c\u6240\u4ee5\u5728\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u573a\u666f\uff0c\u4e34\u65f6\u8868\u4e00\u822c\u4e5f\u662f\u7981\u6b62\u4f7f\u7528\u7684</p>"},{"location":"chap7/int_anws/#18_1","title":"18 \u6574\u636e\u5e93\u4e2d\u7684\u89c6\u56fe\u7684\u5229\u5f0a","text":"<ul> <li>Pros</li> </ul> <p>\u89c6\u56fe\u7684\u4e3b\u65e8\u662f\u4e3a\u4e86\u4f7f\u7528\u4e00\u4e2a\u865a\u62df\u8868\uff0c\u6765\u4ee3\u66ff\u590d\u6742\u7684\u67e5\u8be2sql\uff0c\u53ef\u4ee5\u628a\u5b83\u5f53\u6210\u4e00\u4e2a\u6570\u636e\u8868\u6765\u67e5\uff0c\u5b83\u662f\u7167\u6837\u6267\u884c\u4e86\u4e00\u5806sql\uff0c\u5c31\u662f\u628a\u67e5\u8be2\u7684\u8fc7\u7a0b\uff0c\u7ed3\u679c\u5b83\u662f\u505a\u4e86\u4e2a\u5305\u88c5\uff0c\u7528\u5173\u5fc3\u5185\u90e8\u600e\u4e48\u67e5\u7684\uff0c\u628a\u5b83\u5f53\u6210\u4e00\u4e2a\u771f\u5b9e\u7684\u6570\u636e\u8868\uff0c\u7b80\u5316\u4e86\u67e5\u8be2\u7684\u590d\u6742\u5ea6</p> <p>\u76f4\u63a5\u901a\u8fc7\u89c6\u56fe\uff0c\u5c31\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u8bbf\u95ee\u4e86, \u80fd\u591f\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u4e2a\u5b8c\u6574\u6027, \u5f53\u7136\u4e5f\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a, \u80fd\u591f\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u4e2a\u5b8c\u6574\u6027, \u4e00\u81f4\u6027, \u56e0\u4e3a\u53ea\u8981\u5e95\u5c42\u7684\u5143\u6570\u636e\u66f4\u65b0\u4e86\u6574\u4e2a\u89c6\u56fe\uff0c \u4e5f\u90fd\u662f\u5b9e\u65f6\u80fd\u591f\u67e5\u5230\u66f4\u65b0\u540e\u7684\u6570\u636e\uff0c\u4e0d\u7528\u50cf\u5b58\u50a8\u5728\u7edf\u8ba1\u8868\u6216\u8005\u662f\u7f13\u5b58\u91cc\u9762\u8fd8\u9700\u8981\u53bb\u5173\u6ce8\u6570\u636e\u7684\u4e00\u81f4\u6027\u3002 </p> <p>\u8fd8\u53ef\u4ee5\u7528\u6765\u9650\u5236\u7528\u6237\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u53ef\u4ee5\u76f4\u63a5\u5f00\u653e\u8bd5\u56fe\u7684\u67e5\u8be2\u7ed9\u7528\u6237\uff0c\u800c\u4e0d\u7528\u628a\u5143\u6570\u636e\u7684\u6743\u9650\u7ed9\u5f00\u653e\u51fa\u53bb, \u80fd\u591f\u4fdd\u8bc1\u6570\u636e\u7684\u7a33\u5b9a</p> <ul> <li> <p>Cons</p> </li> <li> <p>\u4ec5\u4ec5\u5229\u7528\u5b83\u53bb\u67e5\u8be2\u67d0\u4e00\u4e2a\u573a\u666f\u7684\u6570\u636e,  \u4f46\u662f\u76f4\u63a5\u5229\u7528\u6570\u636e\u5e93\u4e2d\u7684\u811a\u672c\u6765\u67e5\u3002</p> </li> <li>\u5c31\u662f\u6027\u80fd\u65b9\u9762\u7684\u5f00\u9500\uff0c \u5bf9\u6027\u80fd\u662f\u6709\u65b9\u9762\u7684\u5f71\u54cd\u3002 \u800c\u89c6\u56fe\u4ec5\u4ec5\u53ea\u662f\u67e5\u8be2\u7684\u8fc7\u7a0b\uff0c\u5b83\u662f\u6ca1\u6709\u529e\u6cd5\u4f7f\u7528\u7d22\u5f15\u7684\uff0c\u6240\u4ee5\u4e00\u65e6\u91cf\u6bd4\u8f83\u5927\uff0c\u6216\u8005\u8bf4\u662f\u4e0a\u5347\u5230\u4e00\u5b9a\u7684\u8fd9\u4e2a\u6570\u636e\u91cf\u67e5\u8be2\u4f1a\u8d8a\u6765\u8d8a\u6162</li> </ul>"},{"location":"chap7/int_anws/#19-acid","title":"19 ACID\u7684\u7406\u89e3","text":"<p>ACID\u539f\u5b50\u6027,\u4e00\u81f4\u6027,\u9694\u79bb\u6027, \u6301\u4e45\u6027</p> <ul> <li>\u539f\u5b50\u6027: \u6570\u636e\u5e93\u7684\u4e8b\u52a1\u6700\u5c0f\u5de5\u4f5c\u5355\u5143\uff0c\u8981\u4e48\u5168\u90e8\u6267\u884c\uff0c\u8981\u4e48\u5168\u90e8\u4e0d\u6267\u884c\uff0c\u65e9\u671f\u6ca1\u6709\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u60c5\u51b5\u4e0b\uff0c \u4e00\u822c\u90fd\u662f\u5229\u7528\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u4e8b\u52a1\uff0c\u6765\u4fdd\u8bc1\u64cd\u4f5c\u7684\u539f\u5b50\u6027\uff0c\u624b\u52a8\u5f00\u542f\u4e00\u4e2a\u4e8b\u52a1\u3002\u90a3\u4e48\u5355\u4f53\u67b6\u6784\u4e2d\u91c7\u7528\u50cf\u672c\u5730\u4e8b\u52a1\u8fd9\u4e2atransactional\uff0c\u4ed6\u7684\u6ce8\u89e3\u5176\u5b9e\u6620\u5c04\u5728\u6570\u636e\u5e93\u5c42\uff0c\u4e5f\u5c31\u662f\u7edf\u4e00\u7684\u8fd9\u4e2a\u4e8b\u52a1\u5904\u7406</li> <li>\u4e00\u81f4\u6027\uff1a\u662f\u4e00\u79cd\u89c4\u5219\u7684\u7ea6\u675f\uff0c \u5c31\u662f\u6574\u4e2a\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u4e8b\u52a1\u7684\u64cd\u4f5c\u662f\u7b26\u5408\u9884\u671f\u7684\uff0c\u6240\u6709\u7684\u6570\u636e\u7684\u72b6\u6001\u5fc5\u987b\u662f\u6709\u6548\u7684\u800c\u4e14\u662f\u6b63\u786e\u7684\uff0c\u5b83\u66f4\u591a\u7684\u662f\u4e00\u79cd\u89c4\u8303\u7684\u7ea6\u675f</li> <li>\u9694\u79bb\u6027\uff1a \u4e95\u53d1\u5c42\u9762\uff0c\u90a3\u4e48\u4e00\u822c\u9ed8\u8ba4\u90fd\u4f1a\u91c7\u7528\u8bfb\u5df2\u63d0\u4ea4\uff0c\u5c31\u662f\u5728\u522b\u7684\u4e8b\u52a1\u672b\u63d0\u4ea4\u4e4b\u524d\uff0c\u4f60\u8bbf\u95ee\u5230\u7684\u6240\u6709\u7684\u5176\u4ed6\u7ebf\u7a0b\u7684\u8fd9\u4e2a\u6570\u636e\u90fd\u662f\u8001\u6570\u636e\uff0c\u4e3b\u8981\u5c31\u662f\u4e3a\u4e86\u89e3\u51b3\u6570\u636e\u5e93\u4e00\u4e2a\u810f\u8bfb\u7684\u95ee\u9898</li> <li>\u6301\u4e45\u6027\uff1a \u5c31\u662f\u5f3a\u8c03\u6570\u636e\u4e0d\u4e22\u5931\u554a\uff0c\u5373\u4f7f\u53d1\u751f\u4e86\u786c\u4ef6\u7684\u6545\u969c\u6216\u8005\u662f\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u5d29\u6e83\uff0c\u90a3\u4e48\u5199\u5165\u7684\u4efb\u4f55\u6570\u636e\u4e5f\u4e0d\u4f1a\u4e22\u5931\uff0c\u53ea\u8981\u4f60\u7684\u4e8b\u52a1\u63d0\u4ea4\u4e86\u6570\u636e\u5c31\u80af\u5b9a\u4e0d\u4f1a\u4e1f</li> </ul>"},{"location":"chap7/int_anws/#20_1","title":"20 \u6570\u636e\u5e93\u4e2d\u7684\u89e6\u53d1\u5668","text":"<p>\u7528\u4f8b\uff1a \u5982\u679c\u5e93\u5b58\u6ca1\u4e86\uff0c\u90a3\u4e48\u5c31\u76f4\u63a5\u901a\u8fc7\u524d\u7f6e\u89e6\u53d1\u5668\u62cb\u51fa\u5f02\u5e38\uff0c\u6240\u4ee5return\u6389</p> <p>\u90a3\u4e48\u8fd9\u79cd\u505a\u6cd5\uff0c\u591a\u4e86\u4e00\u9053\u68c0\u67e5\uff0c\u5982\u679c\u5e93\u5b58\u4e3a0\uff0c\u5c31\u53d1\u73b0\u89e6\u53d1\u5668\uff0c\u66b4\u9732\u51fa\u6765\u7684\u95ee\u9898\u8d8a\u6765\u8d8a\u591a\u3002</p> <p>\u5f88\u591a\u65f6\u5019\u559c\u6b22\u628a\u4e1a\u52a1\u5199\u5230\u89e6\u53d1\u5668\u91cc\u9762\uff0c\u5728\u4ee3\u7801\u63a7\u5236\u903b\u8f91\u63a7\u5236\u4e0a\uff0c\u8d8a\u6765\u8d8a\u56f0\u96be\uff0c\u6bd4\u65b9\u8bf4\u7edf\u8ba1\u5546\u54c1\u6d4f\u89c8\u91cf\uff0c\u5c31\u559c\u6b22\u901a\u8fc7\u89e6\u53d1\u5668\u7684\u65b9\u5f0f\uff0c\u5728\u6dfb\u52a0\u6d4f\u89c8\u8bb0\u5f55\u4e4b\u540e\u3002</p> <p>\u8ba9\u89e6\u53d1\u5668\u76f4\u63a5\u6765\u505a\u52a0\u4e00\u7684\u52a8\u4f5c\uff0c\u4f46\u662f\u5bf9\u4e8e\u7edf\u8ba1\u6b21\u6570\u7684\u8fd9\u79cd\uff0c\u89c9\u5f97\u5c31\u6ca1\u6709\u5fc5\u8981\u53bb\u5360\u7528\uff0c\u6570\u636e\u5e93\u7684\u5b9e\u65f6\u5904\u7406\u7684\u8d44\u6e90\uff0c\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u5f02\u6b65\u7684\u65b9\u5f0f\uff0c\u6d88\u606f\u961f\u5217\u7684\u65b9\u5f0f\uff0c\u6765\u5904\u7406\u5c31\u53ef\u4ee5\u89e6\u53d1\u5668\u7684\u5b9e\u65f6\u5904\u7406\uff0c\u5f71\u54cd\u4e86\u6574\u4f53\u6570\u636e\u5e93\u7684\u6027\u80fd</p> <p>\u5728\u7ef4\u62a4\u5c42\u9762\uff0c\u8ddf\u5b58\u50a8\u8fc7\u7a0b\u4e00\u6837\uff0c\u811a\u672c\u5199\u5728\u6570\u636e\u5e93\u3002\u5b83\u5176\u5b9e\u662f\u5f88\u96be\u7406\u89e3\u548c\u7ef4\u62a4\u7684\uff0c\u800c\u4e14\u5bf9\u4e8e\u9519\u8bef\u7684\u6392\u67e5\u4e0a\u4e5f\u6bd4\u8f83\u56f0\u96be\u3002\u5982\u679c\u5904\u7406\u4e0d\u5f53\uff0c\u8fd8\u5bb9\u6613\u4ea7\u751f\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\u7b49\u7b49\uff0c\u89e6\u53d1\u5668\u8be5\u820d\u5f03\u5c31\u820d\u5f03\u3002</p>"},{"location":"chap7/int_anws/#21_1","title":"21 \u6570\u636e\u5e93\u4e2d \u810f\u8bfb\uff0c\u5e7b\u8bfb\uff0c\u4e0d\u53ef\u91cd\u590d\u590d\u8bfb","text":""},{"location":"chap7/int_anws/#_5","title":"\u810f\u8bfb","text":"<p>\u4e00\u4e2a\u4e8b\u52a1\u8bfb\u53d6\u4e86\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u672b\u63d0\u4ea4\u7684\u6570\u636e, \u6bd4\u5982\u8bf4\u5f53\u4e00\u4e2a\u4e8b\u52a1\u4fee\u6539\u4e86\u67d0\u884c\u6570\u636e, \u4f46\u662f\u8fd8\u672a\u63d0\u4ea4, \u90a3\u4e48\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u53c8\u8bfb\u53d6\u4e86\u8fd9\u4e2a\u672b\u63d0\u4ea4\u7684\u6570\u636e, \u5c31\u8ddf\u5b9e\u9645\u5728\u5e93\u91cc\u9762\u7684\u503c\u6709\u4e86\u51fa\u5165. </p> <p>\u5df2\u7ecf\u89e3\u51b3\u4e86\uff0c\u9ed8\u8ba4\u7684\u52a1\u9694\u79bb\u7ea7\u522b =\u300b \u5c31\u662f\u8fd9\u4e2a\u8bfb\u5df2\u63d0\u4ea4</p> <p>\u5c31\u662f\u8bf4\u4e00\u4e2a\u4e8b\u52a1\uff0c\u4ed6\u53ea\u80fd\u8bfb\u5230\u5df2\u7ecf\u63d0\u4ea4\u7684\u6570\u636e\u3002</p>"},{"location":"chap7/int_anws/#_6","title":"\u600e\u4e48\u89e3\u6c7a\u5e7b\u8bfb","text":"<p>\u5e7b\u8bfb\u6765\u8bb2\u901a\u5e38\u53d1\u751f\u5728\u4e00\u4e2a\u4e8b\u52a1\u5728\u8bfb\u53d6\u4e00\u4e2a\u8303\u56f4\u5185\u7684\u6570\u636e\u3002\u90a3\u4e48\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\uff0c\u5728\u8fd9\u4e2a\u8303\u56f4\u5185\u63d2\u5165\u4e86\u65b0\u7684\u6570\u636e\u6216\u8005\u5220\u9664\u4e86\u539f\u6765\u7684\u6570\u636e\u3002\u5c31\u5bfc\u81f4\u524d\u4e00\u4e2a\u4e8b\u52a1\u5462\uff0c\u5728\u540e\u7eed\u7684\u8bfb\u53d6\u4e2d\u770b\u5230\u4e86\uff0c\u5728\u4e8b\u52a1\u5f00\u59cb\u65f6\u4ece\u6765\u6ca1\u6709\u7684\u6570\u636e\uff0c\u6216\u8005\u8bf4\u7f3a\u5931\u4e86\u539f\u6709\u7684\u6570\u636e\u3002 \u76f8\u5f53\u4e8e\u524d\u4e00\u4e2a\u4e8b\u52a1\u4ea7\u751f\u4e00\u79cd\u9519\u89c9\uff0c\u6570\u636e\u88ab\u5176\u4ed6\u4e8b\u52a1\u4fee\u6539\u4e86\uff0c\u5bfc\u81f4\u4e86\u524d\u540e\u8bfb\u53d6\u4e0d\u4e00\u81f4\u7684\u95ee\u9898</p> <p>\u4e0d\u5b9e\u9645\u7684\u89e3\u51b3\u65b9\u6848\uff1a \u53ef\u4ee5\u91c7\u7528\u8fd9\u4e2a\u4e32\u884c\u5316\u7684\u9694\u79bb\u6a21\u5f0f\uff0c\u6240\u6709\u7684\u4e8b\u52a1\u5168\u662f\u6392\u961f\u6267\u884c\uff0c\u5b8c\u5168\u662f\u4e32\u884c\u5316\u7684\u5904\u7406\uff0c\u5c31\u53d8\u6210\u4e86\u591a\u4e2a\u4e8b\u52a1\u5728\u90a3\u6392\u961f</p> <p>\u6548\u7387\uff0c\u6027\u80fd\u5404\u4e2a\u65b9\u9762\uff0c\u90fd\u4f1a\u53d7\u5230\u5f88\u5927\u7684\u5f71\u54cd</p> <p>\u91c7\u7528\u8fd9\u4e2a\u4e50\u89c2\u9501\uff0c\u4e3a\u6570\u636e\u6765\u589e\u52a0\u7248\u672c\u53f7\u6216\u8005\u65f6\u95f4\u6233\uff0c\u90a3\u4e48\u5728\u4e8b\u52a1\u7ed3\u675f\u4e4b\u524d\uff0c\u53bb\u68c0\u67e5\u8bfb\u53d6\u7684\u8bb0\u5f55\uff0c\u662f\u5426\u53d1\u751f\u4e86\u53d8\u5316\u3002\u5982\u679c\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5c31\u53ef\u4ee5\u9009\u62e9\u56de\u6eda\u4e8b\u52a1\uff0c\u6216\u8005\u662f\u91cd\u65b0\u8bfb\u53d6\u6570\u636e\uff0c\u6765\u907f\u514d\u5e7b\u8bfb\u548c\u4e0d\u53ef\u91cd\u590d\u8bfb\u7684\u95ee\u9898</p> <p>\u5f53\u7136\u4e5f\u53ef\u4ee5\u91c7\u7528\u8fd9\u4e2a\u5206\u5e03\u5f0f\u9501\uff0c\u9501\u4f4f\u540c\u6837\u9700\u8981\u5904\u7406\u7684\u8d44\u6e90</p>"},{"location":"chap7/int_anws/#22-mvcc","title":"22 \u804a\u804a\u6574\u636e\u5e93\u4e2d\u7684MVCC","text":"<p>\u5728\u6570\u636e\u5e93\u9886\u57df\u8fd8\u6709\u4e00\u79cd\u65e0\u9501\u7684\u65b9\u6848\uff0c \u53ef\u4ee5\u6765\u89e3\u51b3\u5e76\u53d1\u63a7\u5236\u7684\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u4f20\u8bf4\u4e2d\u7684MVCC\u3002 \u4e0d\u662f\u4e1a\u52a1\u5c42\u9762\u7684\u8fd9\u4e2a\u5e76\u53d1\u63a7\u5236\uff0c\u8fd8\u6709\u6570\u636e\u5e93\u4e00\u81f4\u6027\u65b9\u9762\u7684\u95ee\u9898, \u5176\u5b9e\u4ece\u5b83\u7684\u5b9a\u4e49\u6765\u770b\u5c31\u662f\u591a\u7248\u672c\u7684\u5e76\u53d1\u63a7\u5236\uff0c\u5b83\u5f3a\u8c03\u7684\u662f\u591a\u7248\u672c\uff0cMultiversion\uff0c\u5176\u5b9e\u8fd9\u4e2a\u591a\u7248\u672c\uff0c\u9488\u5bf9\u7684\u662f\u4e00\u4e2a\u6570\u636e\u884c\uff0c \u53ea\u8981\u4e8b\u52a1\u5f00\u59cb\u4e86\u8fd9\u4e2a\u6570\u636e\u884c\uff0c\u57fa\u672c\u4e0a\u90fd\u4f1a\u751f\u6210\u4e00\u4e2a\u7248\u672c\uff0c\u53c8\u53eb\u505a\u5feb\u7167</p> <p>\u90a3\u4e48\u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e0b\u9762\uff0c\u65b0\u8bfb\u53d6\u7684\u6240\u6709\u7684\u6570\u636e\uff0c\u5b83\u90fd\u4f1a\u4ea7\u751f\u4e00\u4e2a\u5feb\u7167\uff0c\u90a3\u4e48\u5bf9\u4e8e\u53ef\u91cd\u590d\u8bfb\u7684\u8fd9\u4e2a\u9694\u79bb\u573a\u666f</p> <p>\u7b2c\u4e00\u6b21\u8bfb\u53d6\uff0c\u751f\u6210\u5feb\u7167\u4ee5\u540e\uff0c\u540e\u9762\u518d\u8bfb\u3002\u6bcf\u6b21\u67e5\u8be2\u90fd\u4f1a\u8fd4\u56de\u4e4b\u524d\u751f\u6210\u7684\u90a3\u4e2a\u5feb\u7167\uff0c \u5c31\u4e0d\u4f1a\u4ea7\u751f\u4e0d\u53ef\u91cd\u590d\u8bfb\u7684\u73b0\u8c61\u4e86\uff0c\u56e0\u4e3a\u524d\u540e\u90fd\u662f\u4e00\u81f4\u7684</p> <p>MVCC\u7684\u6838\u5fc3\u5c31\u662f\u8fd9\u4e2a\u5feb\u7167\uff0c\u90a3\u8fd9\u4e2a\u5feb\u7167\u5b58\u5728\u6570\u636e\u5e93\u54ea\u513f\uff0c\u5b58\u5728underdog \u8868\u91cc\u9762\uff08\u56de\u9000\u65e5\u5fd7\u8868\uff09\uff0c\u662f\u6570\u636e\u5e93\u4e8b\u52a1\u4e2d\u5fc5\u4e0d\u53ef\u5c11\u7684\u8868</p> <p>\u5728\u6574\u4e2a\u6570\u636e\u5e93\u4e8b\u7269\u7684\u573a\u666f\u4e2d\uff0c \u6240\u6709\u5173\u4e8e\u6570\u636e\u5e93\u7684\u64cd\u4f5c\u8bb0\u5f55\uff0c\u90fd\u4f1a\u5199\u5728\u7684undolog\u8868\u91cc\u9762\uff0c\u4e8b\u52a1\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u53d1\u751f\u4e86\u5f02\u5e38\u3002 \u90a3\u5c31\u4f1a\u6839\u636e\u7684\u8fd9\u4e2aundolog\u8868\uff0c\u53bb\u53d1\u751f\u56de\u6eda\u7684</p> <p>\u90a3\u4e48\u6211\u5c31\u4f1a\u5148\u5728undolog\u8868\u91cc\u9762\u53bb\u67e5\u627e\u770b\u770b\u6709\u6ca1\u6709\u8fd9\u4e2a\u5feb\u7167\u53ef\u4ee5\u76f4\u63a5\u8fd4\u56de\uff0c\u5982\u679c\u6709\u90a3\u4e48\u5c31\u76f4\u63a5\u8fd4\u56de\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u518d\u53bb\u67e5\u627e\u539f\u751f\u6570\u636e\u5e93\uff0cundolog\u8868\u91cc\u9762\uff0c\u5b83\u90fd\u4f1a\u8bb0\u5f55\u6570\u636e\u7684\u4e3b\u952e\u3002</p> <p>\u4e8b\u52a1\u7684ID\uff0c\u8fd8\u6709\u4e0a\u4e00\u4e2a\u5feb\u7167\u7684\u5730\u5740\uff0c\u5c31\u4f1a\u5f62\u6210\u4e00\u4e2a\u5feb\u7167\u94fe\u8868\uff0c\u518d\u6839\u636e\u4e8b\u52a1\u7684\u9694\u79bb\u7ea7\u522b\uff0c\u6839\u636e\u8fd9\u4e2a\u4e8b\u52a1\u63d0\u4ea4\u7684\u72b6\u6001\uff0c\u81ea\u7136\u5c31\u80fd\u5f88\u5feb\u7684\u627e\u5230\u4f60\u60f3\u8981\u7684\u5feb\u7167</p>"},{"location":"chap7/int_anws/#23-binlogo-redo-logo-undolog","title":"23 binlogo, redo logo. undolog \u7684\u7406\u89e3\u4ee5\u53ca\u5b9e\u9645\u5e94\u7528\u573a\u661c","text":"<p>binlog</p> <p>\u5b83\u662f\u7528\u6765\u8bb0\u5f55\u6570\u636e\u5e93\u6240\u6709\u7684\u53d8\u66f4\u64cd\u4f5c\uff0c\u50cf\u4ec0\u4e48\u6570\u636e\u7684\u65b0\u589e\uff0c\u4fee\u6539\uff0c\u5220\u9664\uff0c\u90fd\u4f1a\u5b9e\u65f6\u5199\u5165\u8fd9\u4e2abinlog\u91cc\u9762\u3002  \u50cf\u8fd9\u4e2a\u8bfb\u5199\u5206\u79bb\uff0c\u4e3b\u4ece\u590d\u5236\uff0c \u90fd\u4f1a\u6d89\u53ca\u5230\u5b83</p> <p>\u90a3\u4e48\u5bf9\u4e8e\u4e3b\u4ece\u6570\u636e\u5e93\u6765\u8bb2\uff0c\u4e00\u822c\u662f\u4e3b\u5e93\u8981\u8d1f\u8d23\u5199\uff0c\u4ece\u5e93\u8981\u8d1f\u8d23\u8bfb\uff0c\u90a3\u4e48\u4e3b\u5e93\u600e\u4e48\u5411\u4ece\u5e93\u540c\u6b65\u6570\u636e\uff0c\u5c31\u4f1a\u7528\u5230\u8fd9\u4e2abinlog\u3002 \u8ba9\u4ece\u5e93\u6765\u76d1\u542c\u4e3b\u5e93\u7684\u8fd9\u4e2abinlog\uff0c\u5f53binlog\u6709\u4e86\u53d8\u52a8\uff0c\u90a3\u4e48\u5c31\u4f1a\u76f4\u63a5\u5728\u4ece\u5e93\u4e2d\u6267\u884c\u4e00\u904d\u8fd9\u4e2a\u66f4\u65b0\u64cd\u4f5c\uff0c\u5c31\u80fd\u591f\u5b8c\u6210\u4e3b\u5e93\uff0c\u5230\u4ece\u5e93\u8fd9\u4e2a\u6570\u636e\u540c\u6b65</p> <p>undolog</p> <p>\u56de\u6eda\u65e5\u5fd7\uff0c\u4e3b\u8981\u662f\u7528\u4e8e\u5bf9\u4e8b\u52a1\u7684\u56de\u6eda\uff0c\u5f00\u542f\u4e00\u4e2a\u4e8b\u52a1\u4e4b\u540e\uff0c\u6240\u6709\u9488\u5bf9\u6570\u636e\u5e93\u7684\u64cd\u4f5c\uff0c\u90fd\u4f1a\u8bb0\u5f55\u5230\u8fd9\u4e2aundolog\u91cc\u9762\uff0c\u4e00\u65e6\u4e8b\u52a1\u8fc7\u7a0b\u4e2d\u53d1\u751f\u4e86\u5f02\u5e38\u3002\u90a3\u4e48\u6570\u636e\u5e93\uff0c\u5c31\u4f1a\u6839\u636e\u5f53\u524d\u4e8b\u52a1\u7684\u8fd9\u4e2aundolog\uff0c\u6765\u56de\u6eda\u6570\u636e\u5e93\u7684\u64cd\u4f5c</p> <p>redolog</p> <p>\u91cd\u505a\u65e5\u5fd7\uff0c\u5176\u5b9e\u5728\u4e8b\u52a1\u5c42\u9762</p> <p>\u5b83\u662f\u5728\u6570\u636e\u5e93\u53d1\u751f\u6545\u969c\u4ee5\u540e\uff0c\u7528\u4e8e\u6570\u636e\u7684\u8fd9\u4e2a\u6062\u590d\u6765\u7528\u7684\u3002\u540c\u6837\u4fdd\u5b58\u7684\uff0c\u4e5f\u662f\u9488\u5bf9\u6570\u636e\u5e93\u7684\u8fd9\u4e2a\u66f4\u6539\u64cd\u4f5c\uff0c\u53ea\u662f\u8fd9\u4e2a\u66f4\u6539\uff0c\u9488\u5bf9\u7684\u662f\u7269\u7406\u5c42\u9762\uff0c\u8bb0\u5f55\u7684\u662f\u78c1\u76d8\u6570\u636e\u9875\u4e0a\u7684\u53d8\u5316\uff0c\u90a3\u4e48\u5728MySql\u5d29\u6e83\u540e\uff0c \u8981\u53bb\u6062\u590d\u5b83\uff0c\u5c31\u662f\u8fd9\u4e2aredolog\u548cbinlog\uff0c\u6765\u5bf9\u8fd9\u4e2amysql\u8fdb\u884c\u6062\u590d\u7684,\u4fdd\u8bc1\u4e86\u6570\u636e\u7684\u5b8c\u6574\u6027\u548c\u4e00\u81f4\u6027</p>"},{"location":"chap7/int_anws/#24_1","title":"24 \u54ea\u4e9b\u60c5\u6cc1\u4e0b\u4e0d\u8981\u4f7f\u7528\u5356\u5f15","text":"<p>\u4ec0\u4e48\u4f1a\u6709\u8fd9\u79cd\u8003\u8651\uff0c\u5176\u5b9e\u8fd8\u662f\u8981\u53d6\u51b3\u4e8e\uff0c\u4f7f\u7528\u7d22\u5f15\u4f1a\u5e26\u6765\u591a\u5c11\u63d0\u6548\uff0c\u4f1a\u8017\u8d39\u591a\u5c11\u6210\u672c\uff0c\u90fd\u662f\u6765\u81ea\u4e8e\u7ef4\u62a4\u6570\u636e\u65f6</p> <p>\u6bd4\u5982\u8bf4\u6bcf\u6b21\u7684\u63d2\u5165\uff0c\u66f4\u65b0\u6216\u8005\u5220\u9664\uff0c\u90a3\u4e48\u9664\u4e86\u5bf9\u6570\u636e\u8868\u7684\u64cd\u4f5c\u4ee5\u5916\uff0c\u6570\u636e\u5e93\u8fd8\u9700\u8981\u66f4\u65b0\u7d22\u5f15\u6570\u636e\u7ed3\u6784\uff0c\u5c31\u4f1a\u5bfc\u81f4\u5bf9\u78c1\u5bc6\u7684\u4e00\u4e9b\u989d\u5916\u5199\u5165\u64cd\u4f5c\uff0c\u6b64\u5982\u8bf4\u589e\u52a0\u4e86\u8fd9\u4e2aIO\u6210\u672c\uff0c\u5f53\u7136\u8fd8\u6709\u7d22\u5f15\u7684\u8fd9\u4e2a\u5b58\u50a8\u6210\u672c\u4e86</p> <p>\u6211\u4eec\u8bc4\u5224\u8981\u4e0d\u8981\u4f7f\u7528\u7d22\u5f15\u7684\u6807\u51c6\uff0c\u5efa\u7acb\u7d22\u5f15\u80fd\u4e0d\u80fd\u5e26\u6765\u5f88\u5927\u7684\u6027\u80fd\u63d0\u5347</p> <p>\u5982\u679c\u6548\u679c\u4e0d\u5927\u6216\u8005\u8bf4\u5e26\u6765\u4e86\u8d1f\u63d0\u5347\uff0c\u90a3\u4e48\u6211\u5efa\u7acb\u8fd9\u4e2a\u7d22\u5f15\u662f\u6ca1\u6709\u610f\u4e49\u7684\uff0c\u4e0d\u592a\u9002\u5408\u4f7f\u7528\u7d22\u5f15\u7684\u573a\u666f</p>"},{"location":"chap7/int_anws/#1_5","title":"1\u3001\u5c0f\u8868","text":"<p>\u53ef\u80fd\u4e5f\u5c31\u51e0\u5341\u6761\uff0c\u4e0a\u767e\u6761\u7684\u8bb0\u5f55\uff0c\u5982\u679c\u8fd8\u8fdb\u4e86\u5f88\u591a\u7d22\u5f15\uff0c\u5176\u5b9e\u662f\u5c5e\u4e8e\u8d1f\u63d0\u6548\u3002\u53cd\u800c\u5728\u7ef4\u62a4\u7d22\u5f15\u7684\u65f6\u5019\uff0c\u4f1a\u589e\u78c1\u76d8\u7684IO\uff0c\u5f71\u54cd\u4e86\u6570\u636e\u5e93\u7684\u67e5\u8be2\u6027\u80fd\u3002</p>"},{"location":"chap7/int_anws/#2_5","title":"2\u3001 \u9891\u7e41\u66f4\u65b0\u7684\u8868","text":"<p>\u6216\u8005\u5b58\u5728\u5927\u89c4\u6a21\u7684\u6279\u91cf\u64cd\u4f5c\u7684\u8868\uff0c\u6bd4\u5982\u8bf4\u5927\u91cf\u7684\u6570\u636e\u7684\u63d2\u5165\uff0c\u5220\u9664\uff0c\u66f4\u65b0\u4e5f\u662f\u4e0d\u9002\u5408\u5efa\u7acb\u7d22\u5f15\u7684\u3002\u90a3\u4e48\u6bcf\u6b21\u66f4\u65b0\u64cd\u4f5c\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7d22\u5f15\uff0c\u91cd\u5efa\u6216\u8005\u66f4\u65b0\uff0c\u56e0\u4e3a\u9891\u7e41\u7684\u66f4\u65b0.  b+\u6811\u4e5f\u4f1a\u9891\u7e41\u7684\u66f4\u65b0, \u5e26\u6765\u7684\u8fd9\u4e2a\u7ef4\u62a4\u6210\u672c\u540c\u6837\u4e5f\u4f1a\u5f88\u5927, \u5c31\u662f\u5bf9\u4e8e\u5927\u91cf\u91cd\u590d\u7684\u6570\u636e\u7684\u8fd9\u4e2a\u5b57\u6bb5</p> <p>\u6bd4\u5982\u8bf4\u5e38\u89c1,\u7684\u5c31\u662f\u8fd9\u4e2a\u7528\u6237\u8868\u91cc\u9762\u7684\u6027\u522b.\u7d22\u5f15</p> <p>\u5728\u67e5\u8be2\u7684\u65f6\u5019\u4f1a\u5b9a\u4f4d\u5f88\u591a\u6570\u636e, \u67e5\u8be2\u4e0a\u4f1a\u6709\u4e00\u4e9b\u63d0\u5347, \u53ef\u80fd\u4f1a\u8d85\u8fc7\u7d22\u5f15\u5e26\u6765\u7684\u6027\u80fd\u7684\u6539\u8fdb, \u8fd8\u6709\u65e0\u5e8f\u7684\u5b57\u6bb5. \u6bd4\u5982\u8bf4\u50cf\u5e38\u89c1\u7684\u8fd9\u4e2a\u54c8\u897f, \u6216\u8005\u662fuuid, \u90a3\u4e48\u8fd9\u7c7b\u65b0\u63d2\u5165\u7684\u6570\u636e,\u4f1a\u5bfc\u81f4\u7d22\u5f15\u5185\u90e8\u7684\u4f4d\u7f6e\u53d8\u52a8\uff0c\u56e0\u4e3a\u5b83\u662f\u65e0\u5e8f\u7684\uff0c\u5c31\u4f1a\u89e6\u53d1\u7d22\u5f15\u9875\u7684\u8fd9\u4e2a\u5206\u88c2\uff0c\u4e00\u822c\u4e0d\u4f1a\u77ed\uff0c\u50cfuuid\u5462\u670932\u4f4d\uff0c\u7d22\u5f15\u7684\u989d\u5916\u5b58\u50a8\u6210\u672c\u52a0\u5927\uff0c\u8fd8\u662f\u9700\u8981\u8c28\u614e\u8003\u8651\u554a</p>"},{"location":"chap7/int_anws/#3_4","title":"3\u3001 \u4e0d\u7b49\u4e8e\u6216\u8005\u662f\u51fd\u6570","text":"<p>\u662f\u5426\u9700\u8981\u5efa\u7acb\u7d22\u5f15\uff0c\u8fd8\u6709\u4e00\u4e9b\u67e5\u8be2\u6761\u4ef6\u4e0a\u7684\u5b57\u6bb5\uff0c\u6b64\u5982\u8bf4\u7528\u5230\u4e86\u8fd9\u4e2a\u4e0d\u7b49\u4e8e\u6216\u8005\u662f\u51fd\u6570</p> <p>\u50cf\u4e0d\u7b49\u4e8e\u8fd9\u79cd\u6761\u4ef6\uff0c \u662f\u65e0\u6cd5\u4f7f\u7528\u6392\u5e8f\u597d\u7684\u7d22\u5f15\uff0c\u53ef\u80fd\u4f1a\u9009\u62e9\u8fdb\u884c\u5168\u8868\u626b\u63cf\uff0c\u6765\u83b7\u53d6\u7b26\u5408\u6761\u4ef6\u7684\u8bb0\u5f55\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u7d22\u5f15\uff0c\u51fd\u6570\u3002\u7528\u5230\u8ba1\u7b97\u80af\u5b9a\u4f1a\u8d70\u5168\u8868\u626b\u63cf</p>"},{"location":"chap7/int_anws/#25_1","title":"25 \u6559\u636e\u5e93\u4e2d\u7684\u4e3b\u952e\u8ddf\u7d22\u5f15\u6709\u4ec0\u4e48\u5173\u8054","text":"<p>\u5176\u5b9e\u5bf9\u4e8e\u4e3b\u952e\u6765\u8bb2, \u5b83\u7684\u4e3b\u8981\u76ee\u7684\u662f\u5355\u4e2a\u5b87\u6bb5\u6216\u8005\u662f\u591a\u4e2a\u5b57\u6bb5\u7684\u7ec4\u5408, \u5b83\u8981\u4fdd\u8bc1\u8868\u4e2d\u7684\u6bcf\u4e00\u6761\u8bb0\u5f55, \u90fd\u6709\u4e00\u4e2a\u72ec\u6709\u7684\u4e3b\u952e\u503c, \u800c\u4e14\u4e0d\u5141\u8bb8\u4e3a\u7a7a</p> <p>\u90a3\u4e48\u5bf9\u4e8e\u7d22\u5f15\u6765\u8bb2,  \u52a0\u5feb\u5bf9\u8868\u4e2d\u6570\u636e\u7684\u8fd9\u4e2a\u8bbf\u95ee\u901f\u5ea6, \u52a0\u5feb\u5bf9\u8868\u4e2d\u6570\u636e\u7684\u8fd9\u4e2a\u8bbf\u95ee\u901f\u5ea6\u3002</p> <p>\u7d22\u5f15\u53ef\u4ee5\u662f\u4e00\u4e2a\u5b57\u6bb5\uff0c\u6216\u8005\u662f\u591a\u4e2a\u5b57\u6bb5\u7684\u7ec4\u5408\uff0c\u5e76\u4e14\u901a\u8fc7\u7ef4\u62a4\u4e00\u79cd\u6570\u636e\u7ed3\u6784\uff0c \u5e38\u89c1\u7684\u50cf\u8fd9\u4e2ab+\u6811\u6216\u8005\u54c8\u5e0c\u8868\uff0c\u52a0\u901f\u5bf9\u8868\u7684\u8fd9\u4e2a\u8bb0\u5f55\u7684\u68c0\u7d22\uff0c\u6570\u636e\u5c31\u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\u3002 </p> <p>\u5f53\u5e94\u7528\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u6570\u636e\u5c31\u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\uff0c\u6b64\u8f83\u5feb\u6377\u7684\u5b9a\u4f4d\u5230\u7b26\u5408\u6761\u4ef6\u7684\u8bb0\u5f55\uff0c\u5c31\u4e0d\u9700\u8981\u626b\u63cf\u6574\u4e2a\u8868\u4e86\uff0c\u5728\u5927\u591a\u6570\u554a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\uff0c\u53ea\u8981\u4e3b\u952e\u5efa\u7acb\u6210\u529f\u4e86\uff0c\u90fd\u4f1a\u81ea\u52a8\u7684\u521b\u5efa\u4e00\u4e2a\u72ec\u6709\u7684\u7d22\u5f15\uff0c\u6765\u786e\u4fdd\u4e3b\u952e\u7684\u5feb\u901f\u8bbf\u95ee\uff0c\u6211\u4eec\u79f0\u8fd9\u4e9b\u7d22\u5f15\u505a\u4e3b\u952e\u7d22\u5f15</p> <p>\u5f53\u7136\u5176\u4ed6\u7684\u4e00\u4e9b\u975e\u4e3b\u952e\u7684\u5b57\u6bb5\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u521b\u5efa\u7d22\u5f15\uff0c\u6765\u63d0\u9ad8\u5bf9\u8fd9\u4e9b\u5b87\u6bb5\u7684\u8fd9\u4e2a\u67e5\u8be2\u6548\u7387\u3002\u5176\u4e2d\u4e5f\u5305\u62ec\u4e86\u8fd9\u4e2aunique\u7d22\u5f15\uff0c \u5b83\u6709\u70b9\u7c7b\u4f3c\u5c31\u662f\u4e3b\u952e\u5728\u5efa\u7acb\u7684\u540c\u65f6\uff0c\u4e5f\u5c31\u662f\u4e3b\u952e\u7d22\u5f15\u3002</p> <p>\u5168\u952e\u7d22\u5f15\u8ddf\u975e\u4e3b\u952e\u7d22\u5f15\uff0c\u4ed6\u4eec\u5728\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u4e5f\u4f1a\u6709\u4e9b\u5173\u8054\uff0c\u5728\u975e\u5168\u952e\u7d22\u5f15\u547d\u4e2d\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u7684\u5f15\u64ce\u9996\u5148\u5c31\u901a\u8fc7\u975e\u4e3b\u952e\u7d22\u5f15\u6765\u5b9a\u4f4d\uff0c\u8bb0\u5f55\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u901a\u8fc7\u8be5\u4f4d\u7f6e\u7684\u4e3b\u952e\u503c\uff0c\u518d\u6b21\u8bbf\u95ee\u4e3b\u8868\uff0c\u4e3b\u952e\u7d22\u5f15\u6765\u83b7\u53d6\u8fdb\u5165\u5230\u5176\u4ed6\u7684\u8fd9\u4e2a\u5217\u7684\u6570\u636e</p> <p>\u8fd9\u4e2a\u989d\u5916\u7684\u6b65\u9aa4\uff0c\u5c31\u662f\u6211\u4eec\u4f20\u8bf4\u4e2d\u7684\u8fd9\u4e2a\u56de\u8868\u4e86\uff0c\u5b83\u662f\u5b58\u5728\u4e8e\u4e3b\u952e\u7d22\u5f15\u6570\u636e\u9875\u91cc\uff0c\u5b83\u9700\u8981\u901a\u8fc7\u6211\u4eec\u7d22\u5f15\u5173\u8054\u8fc7\u53bb\uff0c\u7136\u540e\u518d\u628a\u6570\u636e\u8fd4\u56de\u67e5\u8be2\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u5f15\u64ce</p>"},{"location":"chap7/int_anws/#5-nginx","title":"5 Nginx","text":""},{"location":"chap7/int_anws/#1-nginx","title":"1 nginx\u7684\u9ad8\u53ef\u7528\u53ca\u96c6\u7fa4\u65b9\u6848","text":"<ul> <li>\u4f20\u7edf\u7684\u65b9\u6848\u662f\u91c7\u7528nginx\u52a0keepalive\uff0c\u4e00\u4e3b\u4e00\u4ece\uff0c\u5982\u679c\u4e3b\u670d\u6302\u6389\u4e86\uff0c\u90a3\u4e48keepalive\u5c31\u4f1a\u505c\u6389\u4e3b\u670d\u3002\u628a\u5907\u7528\u7684nginx\u9876\u4e0a\u6765\uff0c\u6765\u4f5c\u4e3a\u4e3b\u670d\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u3002 \u6216\u8005\u53cc\u4e3b\u4e5f\u53ef\u4ee5</li> </ul> <p>\u5982\u679c\u5355\u53f0nginx\u8fbe\u5230\u74f6\u9888\u4e86\uff0c\u5982\u679c\u4f60\u8981\u60f3\u8ba9\u66f4\u591a\u7684\u7528\u6237\u8fdb\u6765\uff0c\u5c31\u5fc5\u987b\u8fdb\u884c\u8fd9\u4e2a\u7f51\u5173\u7684\u6269\u5bb9\u3002\u53ef\u4ee5\u6269\u5c55\u52304\u52305\u53f0\uff0c\u8c01\u6765\u505a\u8fd9\u4e9bnginx\u7684\u8def\u7531\u8d1f\u8f7d\u3002 \u8bf7\u6c42\u5206\u53d1\uff0c\u6bd5\u7adf\u6269\u5bb9\u7684nginx\u662f\u76f8\u5bf9\u72ec\u7acb\u7684\u3002</p> <p>\u6bcf\u4e00\u4e2anginx\u5176\u5b9e\u90fd\u6709\u4e00\u4e2a\u72ec\u7acb\u7684IP\uff0c\u5e76\u53d1\u66f4\u9ad8\u7684\u8fd9\u4e2aLVS\uff0c\u5b83\u662f\u4e00\u4e2a\u865b\u62df\u7684\u8fd9\u4e2a\u670d\u52a1\u5668\u96c6\u7fa4\u7cfb\u7edf\u3002 \u56e0\u4e3a\u5b83\u5de5\u4f5c\u5728\u4f20\u8f93\u5c42\uff0c \u6240\u4ee5\u5b83\u7684\u8f6c\u6362\u6548\u7387\u8fd8\u662f\u6bd4\u8f83\u9ad8\uff0c \u53ef\u4ee5\u652f\u6301\u51e0\u5341\u4e07\u7684\u8fd9\u4e2a\u5e76\u53d1\u8bf7\u6c42\uff0c\u6240\u4ee5\u7528\u5b83\u6765\u4ee3\u7406nginx\u96c6\u7fa4\uff0c\u65b9\u5411\u4e0a\u9762\u662f\u53ef\u884c\u7684</p> <p>\u4e5f\u53ef\u4ee5\u7528\u4e91\u5382\u5546\u7684\u8d1f\u8f7d\u5747\u8861\uff0c \u5c31\u662f\u4e91\u670d\u52a1\u5668\u8c8c\u4f3c\u4e0d\u652f\u6301\u865a\u62dfIP\uff0c\u5982\u679c\u60f3\u8981\u901a\u8fc7keepalive\uff0c\u5728\u4e91\u670d\u52a1\u5668\u4e0a\u9762\u53bb\u5b9e\u73b0\u9ad8\u53ef\u7528\uff0c \u8981\u4f7f\u7528\u8fd9\u4e2a\u865a\u62dfIP\uff0c\u8fd9\u4e2a\u65b9\u6848\u53ef\u80fd\u4e0d\u5927\u73b0\u5b9e\u3002 \u5176\u5b9e\u53ef\u4ee5\u4e0a\u8fd9\u4e2a\u786c\u4ef6\u8d1f\u8f7dF5</p>"},{"location":"chap7/int_anws/#6_3","title":"6 \u8bbe\u8ba1\u6a21\u5f0f","text":""},{"location":"chap7/int_anws/#1_6","title":"1 \u65e5\u5e38\u642c\u7816\u4e2d\u7528\u5230\u7684\u8bbe\u8ba1\u6a21\u5f0f","text":"<p>\u7b56\u7565\u6a21\u5f0f\uff0c\u5c06\u4e0d\u540c\u7684\u652f\u4ed8\u65b9\u5f0f\u901a\u8fc7\u4e0d\u540c\u7684\u63a5\u53e3\u6765\u5b9e\u73b0\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570\u6765\u51b3\u5b9a\u5177\u4f53\u4f7f\u7528\u54ea\u79cd\u7b56\u7565\uff0c\u8fd9\u6837\u505a\u7684\u597d\u5904</p> <ul> <li>\u4e00\u662f\u7684\u4ee3\u7801\u6e05\u6670\uff0c\u65b9\u4fbf\u540e\u671f\u7684\u7ef4\u62a4\uff0c</li> <li>\u4e8c\u6765\u5982\u679c\u6709\u65b0\u589e\u7684\u652f\u4ed8\u65b9\u5f0f\uff0c\u53ea\u8981\u5b9e\u73b0\u652f\u4ed8\u7684\u63a5\u53e3\u5c31\u53ef\u4ee5\u4e86\uff0c\u4e0d\u9700\u8981\u4fee\u6539\u539f\u6709\u7684\u4ee3\u7801\u51cf\u5c11\u4e86\u98ce\u9669\uff0c \u4e0d\u9700\u8981\u4fee\u6539\u539f\u6709\u7684\u4ee3\u7801\u51cf\u5c11\u4e86\u98ce\u9669</li> </ul> <p>\u8fd9\u4e2a\u662f\u7b56\u7565\u6a21\u5f0f</p> <p>\u8fd8\u6709\u4e00\u4e9b\u975e\u4e3b\u6d41\u7a0b\u7684\u4e00\u4e9b\u529f\u80fd\uff0c \u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2a\u5173\u952e\u65e5\u5fd7\u7684\u6536\u96c6\uff0c\u90a3\u4e48\u5982\u679c\u5199\u5728\u4ee3\u7801\u91cc\u5c31\u5f88\u70e6\uff0c\u903b\u8f91\u90fd\u662f\u4e00\u6837\u7684\uff0c \u6bcf\u89c1\u4e00\u4e2a\u65b9\u6cd5\u90fd\u8981\u5199\u4e00\u4e2a\u6536\u96c6\uff0c\u6bd4\u8f83\u9ebb\u70e6</p> <p>\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u4f7f\u7528\u5207\u9762\uff0c \u4e5f\u5c31\u662f\u6211\u4eec\u5e38\u8bf4\u7684\u8fd9\u4e2aaop\uff0c\u901a\u8fc7\u5207\u7247\u7684\u65b9\u5f0f\u76f4\u63a5\u622a\u53d6\u53c2\u6570\uff0c\u7136\u540e\u4ea4\u7531\u4e13\u95e8\u7684\u65e5\u5fd7\u6536\u96c6\u7c7b\u6765\u5904\u7406\uff0c\u8fd9\u79cdAOP\u7684\u5207\u9762\u7684\u65b9\u5f0f\uff0c\u5e94\u8be5\u7b97\u662f\u6bd4\u8f83\u5e38\u89c1\u7684\uff0c\u4e5f\u7528\u5230\u4e86\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u53eb\u505a\u4ee3\u7406\u6a21\u5f0f</p> <p>\u5b9e\u9645\u7684\u8fd9\u4e2a\u65e5\u5fd7\u6536\u96c6\uff0c\u662f\u7531\u65e5\u5fd7\u6536\u96c6\u7c7b\u6765\u5b9e\u73b0\u7684\uff0c\u5b83\u662f\u65b9\u6cd5\u4e2d\u65e5\u5fd7\u6536\u96c6\u7684\u4ee3\u7406\uff0c\u6240\u4ee5\u53eb\u505a\u4ee3\u7406\u6a21\u5f0f</p> <p>\u5f53\u7136\u4ee3\u7406\u6a21\u5f0f\u8fdc\u4e0d\u6b62AOP\uff0c\u50cf\u5fae\u670d\u52a1\u4e4b\u95f4\u7684\u8c03\u7528\uff0c\u4e5f\u7528\u7684\u4ee3\u7406\u6a21\u5f0f\uff0c\u8c03\u7528\u8fdc\u7a0b\u7684\u670d\u52a1\uff0c\u53ef\u4ee5\u50cf\u672c\u5730\u4e00\u6837\u65b9\u4fbf</p> <p>\u90a3\u4e48\u9664\u4e86\u4ee3\u7406\u6a21\u5f0f\uff0c\u7b56\u7565\u6a21\u5f0f\u8fd8\u6709\u5f88\u591a\u5176\u4ed6\u7684\u8bbe\u8ba1\u6a21\u5f0f\uff0c \u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\uff0c\u5355\u4f8b\u6a21\u5f0f\u3001\u5efa\u9020\u8005\u6a21\u5f0f\u3001\u9002\u914d\u5668\u6a21\u5f0f\u7b49\u7b49</p>"},{"location":"chap7/int_anws/#2_6","title":"2 \u5de5\u5382\u6a21\u5f0f\u3001\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f","text":"<p>\u53ea\u8981\u4f60\u7684\u9879\u76ee\u91cc\u9762\u5b58\u5728interface\uff0c\u90a3\u57fa\u672c\u4e0a\u5c31\u4f1a\u7528\u5230\u5de5\u5382\u6a21\u5f0f\uff0cinterface\u8bf4\u5230\u5e95\u5b83\u5c31\u662f\u4e00\u4e2a\u5de5\u5382\uff0c\u63d0\u4f9b\u4e00\u4e2a\u6807\u51c6\u3002</p> <p>\u63a5\u53e3\u5b9e\u73b0\u7c7b\uff0c\u5b83\u5c31\u662f\u76f8\u5f53\u4e8e\u8fd9\u4e2a\u6807\u51c6\uff0c\u5bf9\u5e94\u7684\u4e0d\u540c\u7684\u5b9e\u73b0\u3002\u4e3e\u4e2a\u4f8b\u5b50\u6bd4\u5982\u8bf4\u4e0a\u4f20\u6587\u4ef6\uff0c\u5bf9\u5e94\u4e86\u597d\u51e0\u4e2a\u6587\u4ef6\u4e2d\u5fc3\uff0c\u5c31\u53ef\u4ee5\u5b9a\u4e00\u4e2a\u4e0a\u4f20\u7684\u63a5\u53e3\u5de5\u5382\u7c7b\uff0c\u91cc\u9762\u6709\u6587\u4ef6\u540d\u7684\u83b7\u53d6\uff0c\u6d41\u7684\u83b7\u53d6\uff0c\u5305\u62ec\u4e0a\u4f20\u5730\u5740\uff0c\u7aef\u53e3\uff0c\u4e0d\u540c\u7684\u5b9e\u73b0\u7c7b\u6765\u5b9e\u73b0\uff0c\u4e0d\u540c\u7684\u8fd9\u4e2a\u4e0a\u4f20\u65b9\u5f0f\uff0c\u4e0a\u4f20\u5904\u7406\u5c31\u6bd4\u8f83\u6e05\u6670\uff0c\u4e0d\u7528\u518d\u53bb\u901a\u8fc7if else \u6765\u505a\u591a\u5c42\u7ea7\u5d4c\u5957\u4e86</p> <p>\u5728\u6280\u672f\u6846\u67b6\u91cc\u9762\uff0c\u6bd4\u5982\u8bf4\u5728spring\u91cc\u9762\u6bd4\u8f83\u5e38\u7528\u7684bean, \u90a3\u4e48\u5f88\u591a\u7684\u57fa\u7840\u914d\u7f6e\u90fd\u653e\u5728bean\u91cc\u9762\u3002 \u5728spring MVC\u7684\u65f6\u4ee3\uff0c\u8fd8\u9700\u8981\u624b\u5199bean\u7684\u914d\u7f6e\u8981\u914d\u5728\u8fd9\u4e2axml\u91cc\u9762\uff0c \u73b0\u5728\u4e5f\u90fd\u662f\u7528\u7684\u6ce8\u89e3\uff0c\u90a3\u4e48\u914d\u7f6e\u5199\u597d\u4e86\uff0c\u5c31\u901a\u8fc7BeanFactory, \u6765\u521b\u5efabean\u7684\u5bf9\u8c61, \u8fd9\u6837\u6574\u4e2a\u9879\u76ee\u624d\u53ef\u4ee5\u8bbf\u95ee\u5230bean. </p> <p>\u6574\u4e2abean\u7684\u521b\u5efa\u8fc7\u7a0b, \u5176\u5b9e\u5c31\u662f\u7b80\u5355\u5de5\u5382\u6a21\u5f0f\u7684\u4e00\u4e2a\u4f53\u73b0, \u90a3\u4e48\u628a\u4e00\u4e2abean\u9700\u8981\u7684\u5185\u5bb9, \u65b9\u6cd5\u901a\u901a\u653e\u5230\u5de5\u5382\u91cc\u9762, \u5c31\u662f\u4e00\u4e2a\u6bd4\u8f83\u6807\u6dee\u7684\u5b9e\u4f53.</p> <p>\u5c31\u53ef\u4ee5\u8ba4\u4e3a\u5de5\u5382\u6a21\u5f0f\u5c31\u662f\u4e00\u79cd\u516c\u5171\u7684\u6807\u51c6, \u6240\u6709\u7684\u76f8\u5173\u7c7b\u522b\u7684\u5b9e\u73b0\u90fd\u9700\u8981\u901a\u8fc7\u8fd9\u4e2a\u5de5\u5382\u7684\u6807\u51c6\u624d\u80fd\u7528</p> <p>\u90a3\u4e48\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u5c31\u66f4\u52a0\u7b80\u5355\u4e86, \u5b83\u5c31\u662f\u5404\u4e2a\u5de5\u5382\u6a21\u5f0f\u7684\u4e00\u4e2a\u7ec4\u5408</p>"},{"location":"chap7/int_anws/#3_5","title":"3 \u8ba2\u5355\u8d85\u65f6\u5173\u95ed\u7684\u51e0\u79cd\u65b9\u6848","text":"<p>\u901a\u5e38\u4f1a\u51fa\u73b0\u4e00\u4e2a\u8ba2\u5355\u622a\u6b62\u65f6\u95f4\uff0c\u622a\u6b62\u65f6\u95f4\u5230\u4e86\uff0c\u5982\u679c\u8fd8\u6ca1\u6709\u652f\u4ed8\uff0c\u5c31\u9700\u8981\u7cfb\u7edf\u53bb\u53d6\u6d88\u5f53\u524d\u7684\u8ba2\u5355\u91ca\u653e\u5e93\u5b58</p> <p>\u9996\u5148\u662f\u5b9a\u65f6\u4efb\u52a1</p> <p>\u7cfb\u7edf\u6bcf\u9694\u51e0\u79d2\u949f\u67e5\u4e00\u4e0b\u5e93\uff0c\u5982\u679c\u8fc7\u671f\u4e86\u5c31\u76f4\u63a5\u53d6\u6d88\uff0c \u901a\u5e38\u4f1a\u7528\u5230xxl-job, quartz \u8fd9\u4e9b\u5b9a\u65f6\u4efb\u52a1\u7684\u7ec4\u4ef6, \u4e5f\u53ef\u4ee5\u4f7f\u7528Linux\u81ea\u5e26\u7684\u8fd9\u4e2acrontab, \u90fd\u662f\u5b9a\u671f\u6765\u8c03\u7528\u68c0\u67e5\u8ba2\u5355\u7684API</p> <p>\u4e00\u79cd\u662f\u88ab\u52a8\u53d6\u6d88 </p> <p>\u6bd4\u5982\u8bf4\u7528\u6237\u67e5\u770b\u8ba2\u5355\u7684\u65f6\u5019, \u987a\u4fbf\u68c0\u67e5. \u5f53\u524d\u8ba2\u5355\u6709\u6ca1\u6709\u8fc7\u671f, \u5982\u679c\u8fc7\u671f\u4e86\u5c31\u76f4\u63a5\u6e05\u6389, \u662f\u4f9d\u8d56\u4e8e\u5ba2\u6237\u7aef\u7528\u6237\u7684\u4e3b\u52a8\u8bf7\u6c42, \u662f\u4f9d\u8d56\u4e8e\u5ba2\u6237\u7aef\u7528\u6237\u7684\u4e3b\u52a8\u8bf7\u6c42, \u5982\u679c\u7528\u6237\u4e0d\u67e5\u770b</p> <p>\u5982\u679c\u8fc7\u671f\u4e86\u5c31\u76f4\u63a5\u6e05\u6389, \u662f\u4f9d\u8d56\u4e8e\u5ba2\u6237\u7aef\u7528\u6237\u7684\u4e3b\u52a8\u8bf7\u6c42, \u5982\u679c\u7528\u6237\u4e0d\u67e5\u770b\uff0c\u53ef\u80fd\u5c31\u4f1a\u4e00\u76f4\u6302\u7740\uff0c\u5355\u72ec\u4f7f\u7528\u4e0d\u592a\u53ef\u884c\uff0c\u8ddf\u8fd9\u4e2a\u5b9a\u65f6\u4efb\u52a1\u7684\u65b9\u6848\u7ed3\u5408\u8d77\u6765\uff0c\u5b9a\u65f6\u4efb\u52a1\u6765\u4f5c\u4e3a\u8fd9\u4e2a\u515c\u5e95\u65b9\u6848\u6765\u4f7f\u7528</p> <p>\u5904\u7406\u7684\u903b\u8f91\uff0c\u5c31\u6709\u70b9\u50cf\u8fd9\u4e2aredis\uff08\u8fc7\u671f\u56de\u6536\uff09\uff0c\u5148\u60f0\u6027\u5220\u9664\uff0c\u6e05\u9664\u4e0d\u6389\u7684\uff0c\u518d\u901a\u8fc7\u5b9a\u671f\u6e05\u7406\u7684\u65b9\u5f0f\u6765\u5904\u7406</p> <p>\u8fd8\u6709\u4e00\u79cd\u662f\u5229\u7528\u6d88\u606f\u5bf9\u5217\u7684\u8fd9\u4e2a\u5ef6\u8fdf\u5bf9\u5217\u4e0b\u8ba2\u5355\u7684\uff0c \u540c\u65f6\u53d1\u9001\u4e00\u6761\u5ef6\u8fdf\u5bf9\u5217\uff0c\u5230\u4e86\u65f6\u95f4\u53d1\u9001\u8fc7\u53bb\uff0c\u5173\u6389\u8ba2\u5355\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u4e00\u4e9b\u7279\u6b8a\u7684\u573a\u666f\u4e0b\u9762\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u8ba2\u5355\u8d85\u65f6\u5173\u4e0d\u6389\u7684\u60c5\u6cc1\uff0c\u6bd4\u5982\u8bf4\u8bf7\u6c42\u91cf\u5927\u6765\u4e0d\u53ca\u5916\u7406\uff0c\u6216\u8005\u662f\u8ba2\u5355\u5173\u95ed\u7684\u63a5\u53e3\u6302\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u8ba2\u5355\u867d\u7136\u8d85\u65f6\u4e86\uff0c\u8fd8\u662f\u53ef\u4ee5\u53d1\u8d77\u652f\u4ed8\u7684\uff0c\u6240\u4ee5\u8fd9\u4e2a\u65f6\u5019\u4e00\u5b9a\u8981\u9650\u5236\u4f4f\u3002\u5728\u8ba2\u5355\u5012\u8ba1\u65f6\u7ed3\u675f\u7684\u65f6\u5019\uff0c\u4e0d\u80fd\u8ba9\u4ed6\u518d\u6b21\u53d1\u8d77\u8ba2\u5355\u7684\u652f\u4ed8\uff0c\u524d\u7aef\u80af\u5b9a\u8981\u505a\u597d\u9650\u5236\uff0c\u540e\u7aef\u4e5f\u8981\u505a\u597d\u8ba2\u5355\u6709\u6548\u7684\u68c0\u9a8c\uff0c\u4fdd\u8bc1\u8ba2\u5355\u5728\u8d85\u503c\u5173\u95ed\u7684\u60c5\u51b5\u4e0b\u9762\uff0c\u7528\u6237\u53d1\u8d77\u4e0d\u4e86\u652f\u4ed8</p>"},{"location":"chap7/int_anws/#aop","title":"\u804aAOP\u7684\u5e94\u7528\u573a\u666f\u53ca\u6ce8\u610f\u4e8b\u9879","text":"<p>AOP\u51e0\u4e4e\u6bcf\u4e2a\u9879\u76ee\u90fd\u4f1a\u7528\u5230, \u9762\u5411\u5207\u9762\u7f16\u7a0b. </p> <p>\u5728\u65b9\u6cd5\u4e0a, \u901a\u8fc7\u4e00\u4e2a\u6ce8\u89e3\u5c31\u80fd\u62e6\u622a\u6570\u636e, \u7136\u540e\u518d\u505a\u4e00\u4e9b\u7279\u6b8a\u7684\u5904\u7406\u903b\u8f91, \u8ddf\u9762\u5411\u5bf9\u8c61\u662f\u5c5e\u4e8e\u4e24\u79cd\u4e0d\u540c\u7684\u7ef4\u5ea6</p> <p>\u4f20\u7edf\u7684\u9762\u5411\u5bf9\u8c61</p> <p>\u5c31\u662f\u628a\u6240\u6709\u7684\u4e1a\u52a1\u903b\u8f91\u653e\u5728\u4e00\u8d77, \u5206\u6563\u5728\u4e0d\u540c\u7684\u5bf9\u8c61\u91cc\u9762\u6709\u5404\u79cd\u5404\u6837\u7684\u65b9\u6cd5, \u6709\u5404\u79cd\u5404\u6837\u7684\u8fd9\u4e2a\u6210\u5458\u53d8\u91cf, \u90a3\u4e48\u6240\u6709\u7684\u6838\u5fc3\u903b\u8f91, \u90fd\u662f\u901a\u8fc7\u9762\u5411\u5bf9\u8c61\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u7684. </p> <p>\u968f\u7740\u7cfb\u7edf\u8d8a\u6765\u8d8a\u5927, \u5f88\u591a\u975e\u4e3b\u8981\u6d41\u7a0b\u7684\u5185\u5bb9\u4e5f\u52a0\u5165\u8fdb\u6765\u4e86, \u6bd4\u65b9\u8bf4\u65b9\u6cd5\u8bbf\u95ee\u65e5\u5fd7\u7684\u8bb0\u5f55\uff0c </p> <p>\u5982\u679c\u6309\u7167\u4f20\u7edf\u7684\u9762\u5411\u5bf9\u8c61\u7684\u65b9\u5f0f\uff0c \u53ef\u80fd\u5c31\u8981\u5728\u65b9\u6cd5\u7684\u5165\u53e3\u5904\u6765\u589e\u52a0log\uff0c \u4f46\u662flog\u672c\u8eab\u4e5f\u4e0d\u662f\u7279\u522b\u91cd\u8981\uff0c \u5c5e\u4e8e\u540e\u9762\u6392\u67e5\u95ee\u9898\u7edf\u8ba1\u7528\u7684\uff0c\u4f46\u662f\u5374\u4fb5\u5165\u4e86\u4e3b\u6d41\u7a0b\u7684\u4ee3\u7801\u4e2d\uff0c \u4f1a\u4ea7\u751f\u5f88\u591a\u7684\u4ee3\u7801\u5197\u4f59</p> <p>\u5982\u679c\u901a\u8fc7AOP\u5207\u9762\u7684\u65b9\u5f0f\u6765\u505a\u5c31\u6bd4\u8f83\u7b80\u5355\uff0c\u4e5f\u5c31\u662f\u5728\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u4e8e\u4e00\u4e2a\u6ce8\u89e3\uff0c\u6ce8\u89e3\u7684\u4f5c\u7528\u5462\u5176\u5b9e\u662f\u4e3a\u4e86\u62e6\u622a\uff0c\u62e6\u622a\u4e4b\u540e\u8be5\u5199\u76d8\u5199\u76d8\uff0c\u8be5\u843d\u5e93\u843d\u5e93\uff0c\u5b8c\u5168\u662f\u5f02\u6b65\u7684\u64cd\u4f5c\uff0c\u4e0d\u4f1a\u5f71\u54cd\u4e3b\u8981\u7684\u4e1a\u52a1\u6d41\u7a0b</p> <p>\u90a3\u4e48\u9664\u4e86\u65b9\u6cd5\u7684\u65e5\u5fd7\u4ee5\u5916\u8fd8\u6709\u5176\u4ed6\u7684\u4e00\u4e9b\u5e94\u7528\u573a\u666f\u4e86, \u6bd4\u65b9\u8bf4\u6743\u9650\u7684\u5224\u5b9a, \u8fd9\u4e2a\u65b9\u6cd5\u6709\u6ca1\u6709\u8bbf\u95ee\u6743\u9650\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5207\u9762\u7684\u65b9\u5f0f, \u53ea\u6709\u7279\u5b9a\u89d2\u8272\u6216\u8005\u6743\u9650\u7684\u7528\u6237, \u624d\u80fd\u8bbf\u95ee\u5230\u67d0\u4e9b\u654f\u611f\u7684\u64cd\u4f5c, \u90a3\u4e48\u8fd8\u53ef\u4ee5\u5229\u7528AOP\u505a\u5168\u5c40\u5f02\u5e38\u7684\u6355\u83b7\uff0c\u7136\u540e\u8fdb\u884c\u5904\u7406</p> <p>\u8fd8\u53ef\u4ee5\u7528\u4e8e\u5bf9\u7cfb\u7edf\u7684\u6027\u80fd\u8fdb\u884c\u76d1\u63a7\uff0c\u597d\u6bd4\u65b9\u8bf4\u67d0\u4e2a\u65b9\u6cd5\u6267\u884c\u524d\u540e\u7684\u65f6\u95f4\uff0c\u6216\u8005\u7edf\u8ba1\u67e5\u8be2\u6570\u636e\u5e93\u7684\u6b21\u6570</p> <p>\u90a3\u4e48AOP\u8fd8\u6709\u4e00\u70b9\u9700\u8981\u7279\u522b\u6ce8\u610f\uff0c\u5c31\u662f\u8981\u8003\u8651\u5931\u6548\u7684\u573a\u666f\uff0c\u6bd4\u65b9\u8bf4\u540c\u4e00\u4e2a\u7c7b\u4e2d\u7684\u65b9\u6cd5\u4e92\u76f8\u8c03\u7528, a\u65b9\u6cd5\u8c03\u7528b\u65b9\u6cd5, b\u65b9\u6cd5\u7684AOP\u7684\u6ce8\u89e3, AOP\u8981\u901a\u8fc7\u751f\u6210\u52a8\u6001\u4ee3\u7406\u7684\u65b9\u5f0f\u6765\u5904\u7406, AOP\u8981\u901a\u8fc7\u751f\u6210\u52a8\u6001\u4ee3\u7406\u7684\u65b9\u5f0f\u6765\u5904\u7406\u3002\u4f46\u662f\u5462\u4e00\u4e2a\u7c7b\u4e2d\u7684\u65b9\u6cd5\u4e92\u76f8\u8c03\u7528\uff0c\u662f\u4e0d\u9700\u8981\u7ecf\u8fc7\u4ee3\u7406\u7684\uff0c\u6240\u4ee5AOP\u5c31\u4f1a\u5931\u6548</p> <p>\u89e3\u6c7a\u65b9\u6848\u4e5f\u5f88\u7b80\u5355\uff0c\u8981\u4e48\u58f0\u660e\u4e00\u4e0b\u5f53\u524d\u7c7b\u7684\u670d\u52a1\uff0c \u7136\u540e\u901a\u8fc7\u4ee3\u7406\u7684\u65b9\u5f0f\u6765\u8fdb\u884c\u8c03\u7528\uff0c \u8981\u4e48\u5c31\u79fb\u51fa\u5f53\u524d\u7c7b\u5c31\u53ef\u4ee5\u4e86\u3002 </p> <p>\u8fd8\u6709\u65e0\u6cd5\u8ba9\u5207\u9762\u589e\u5f3a\u7684\u65b9\u5f0f\uff0c\u9759\u6001\u65b9\u6cd5static\uff0c \u8fd8\u6709final\u4fee\u9970\u8fc7\u7684\u8fd9\u4e2a\u65b9\u6cd5\uff0c \u4e5f\u65e0\u6cd5\u4f7f\u7528\u52a8\u6001\u4ee3\u7406\u7684\u65b9\u5f0f\u6765\u505a\uff0c \u540c\u6837\u4e5f\u4f1a\u4f7fAOP\u5931\u6548</p> <p>\u53e6\u5916\u8fd8\u6709\u4e00\u70b9\u9700\u8981\u7279\u522b\u6ce8\u610f\u662f\uff0c \u65b9\u6cd5\u4e2d\u7684\u4e8b\u52a1\uff0c \u5927\u90e8\u5206\u90fd\u662f\u57fa\u4e8eAOP\u7684\uff0c \u903b\u8f91\u6765\u5b9e\u73b0\u7684\u4e5f\u90fd\u662f\u4e3a\u4e86\u6355\u83b7\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u5f02\u5e38\uff0c \u7136\u540e\u8fdb\u884c\u56de\u6eda</p> <p>\u5982\u679c\u9047\u5230AOP\u5931\u6548\u7684\u573a\u666f\uff0c \u540c\u4e00\u4e2a\u7c7b\u4e2d\u7684\u65b9\u6cd5\u8c03\u7528\uff0c a\u65b9\u6cd5\u8c03b\u65b9\u6cd5\uff0cb\u65b9\u6cd5\u76f8\u5f53\u4e8e\u88ab\u62f7\u8d1d\u5230\u4e86a\u65b9\u6cd5\u91cc\u9762\uff0c \u90a3\u4e48b\u65b9\u6cd5\u4e2d\u7684AOP\u662f\u5931\u6548\u7684\uff0c \u90a3\u4e48b\u65b9\u6cd5\u7684\u4e8b\u52a1\uff0c \u81ea\u7136\u800c\u7136\u7684\u4e5f\u5c31\u8ddf\u7740\u5931\u6548\u4e86\uff0c\u5c31\u76f8\u5f53\u4e8e\u56e0\u4e3aAOP\u7684\u5931\u6548\u95f4\u63a5\u5f15\u53d1\u4e86\u4e8b\u52a1\u7684\u5931\u6548\u554a\uff0c\u8981\u7279\u522b\u7684\u6ce8\u610f\uff0c\u56e0\u4e3a\u4e8b\u52a1\u7684\u5931\u6548\uff0c\u4f1a\u5e26\u6765\u4e00\u4e9b\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898</p>"},{"location":"chap7/int_anws/#_7","title":"\u672c\u5730\u5f00\u53d1","text":""},{"location":"chap7/int_anws/#1_7","title":"1 \u804a\u804a\u670d\u52a1\u7aef\u7684\u672c\u5730\u7f13\u5b58","text":"<p>\u672c\u5730\u7f13\u5b58\u4e5f\u53eb\u505a\u8fd1\u7aef\u7f13\u5b58\uff0c\u90a3\u4e48\u4e00\u822c\u7684\u5904\u7406\u573a\u666f\uff0c\u5c31\u662f\u5148\u8bbf\u95ee\u672c\u5730\u7f13\u5b58\uff0c\u5982\u679c\u672c\u5730\u7f13\u5b58\u6ca1\u6709\uff0c\u518d\u53bb\u8bbf\u95ee\u8fdc\u7aef\u7684redis\uff0c\u8fdc\u7aefredis\u4e5f\u6ca1\u6709\uff0c\u90a3\u4e48\u76f4\u63a5\u8bbf\u95ee\u6570\u636e\u5e93</p> <p>\u90a3\u4e48\u4e00\u822c\u662f\u8fd9\u6837\u7684\u4e00\u4e2a\u6d41\u7a0b\uff0c\u90a3\u4e48\u5e38\u89c4\u7684\u5b9e\u73b0\u5c31\u662f\u4f7f\u7528\u4e00\u4e9b\u6846\u67b6\uff0c \u6bd4\u5982\u50cfcoffine, guava. </p> <p>\u5982\u679credis\u8bbf\u95ee\u5f02\u5e38\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u5c31\u53ef\u4ee5\u76f4\u63a5\u964d\u7ea7\u6765\u8bfb\u53d6\u672c\u5730\u7684\u7f13\u5b58\uff0c\u4e5f\u80fd\u591f\u51cf\u5c11\u7f13\u5b58\u51fb\u7a7f\u5e26\u6765\u7684\u98ce\u9669</p> <p>\u672c\u5730\u7f13\u5b58\u6bd4\u8f83\u5927\u7684\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\uff0c\u8ddfredis\uff0c\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u901a\u8fc7\u4e00\u4e9b\u540c\u6b65\u7b56\u7565\u6765\u7f13\u89e3\u8fd9\u4e2a\u4e00\u81f4\u6027\u7684\u95ee\u9898</p>"},{"location":"chap7/int_anws/#2_7","title":"2 \u65e5\u5e38\u5f00\u53d1\u4e2d\u7684\u6279\u5904\u7406","text":"<p>\u6279\u5904\u7406\u662f\u4e00\u4e2a\u6bd4\u8f83\u7b80\u5355\u5374\u6bd4\u8f83\u5b9e\u7528\u7684, \u80fd\u591f\u63d0\u9ad8\u6027\u80fd\u7684\u6709\u6548\u5229\u5668.</p> <p>\u524d\u7aef\u7684\u6279\u5904\u7406, \u6bd4\u5982\u8bf4\u5e38\u89c1\u7684\u50cf\u8fd9\u4e2a\u57cb\u70b9, \u7528\u6237\u6bcf\u70b9\u4e00\u4e0b\u5c31\u4f1a\u6709\u4e00\u4e2a\u8bb0\u5f55, \u8fd9\u79cd\u60c5\u51b5\u4e00\u822c\u90fd\u662f\u524d\u7aef\u6512\u7740, \u5148\u653e\u5728\u672c\u5730, \u6309\u7167\u4e00\u5b9a\u7684\u8fd9\u4e2a\u7b56\u7565\u6765\u8fdb\u884c\u4e0a\u62a5, \u6bd4\u5982\u8bf4\u6512\u591f\u4e8610\u6761\u6216\u8005\u662f\u6bcf\u9694\u4e00\u5206\u949f\u6279\u91cf\u4e0a\u62a5</p> <p>\u5bf9\u4e8e\u4e00\u4e9b\u9ad8\u5e76\u53d1\u4e0b\u7684\u573a\u666f, \u6765\u505a\u4e00\u4e9b\u964d\u7ea7, \u5982\u679c\u51fa\u73b0\u4e86\u4e00\u4e9b\u5999\u6740\u5927\u4fc3. \u90a3\u4e48\u5c31\u5148\u6682\u65f6\u4e0d\u4e0a\u62a5\u6216\u8005\u5ef6\u957f\u6279\u5904\u7406\u7684\u5468\u671f, \u8fd9\u6837\u5c31\u80fd\u591f\u5927\u5927\u7684\u51cf\u5c11\u4ea4\u4e92\u7684\u6b21\u6570,\u51cf\u5c11\u7f51\u7edc\u7684IO,\u8282\u7ea6\u8d44\u6e90\u90a3\u4e48\u5bf9\u4e8e\u670d\u52a1\u7aef, \u4e5f\u6709\u6d89\u53ca\u5230\u7684\u6279\u5904\u7406,\u6bd4\u5982\u8bf4\u6d89\u53ca\u5230\u4e86\u65e2\u6709\u7236\u7ea7\u6570\u7ec4, \u53c8\u6709\u5b50\u96c6\u6570\u7ec4\u7684\u8fd9\u6837\u7684\u4e00\u4e2a\u6279\u91cf\u63d2\u5165, \u5343\u4e07\u4e0d\u80fd\u5faa\u73af\u63d2\u5165</p> <p>\u5982\u679c\u4f60\u8981\u8ffd\u6c42\u6548\u7387\u8ffd\u6c42\u6027\u80fd,\u6279\u5904\u7406\u7684\u601d\u60f3\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684</p>"},{"location":"chap7/int_anws/#3_6","title":"3 \u7f13\u5b58\u7684\u547d\u4e2d\u7387","text":"<p>\u7f13\u5b58\u547d\u4e2d\u7387\u4ece\u67b6\u6784\u89d2\u5ea6\u6765\u8bf4\uff0c\u6bd5\u7adf\u7f13\u5b58\u8981\u9ad8\u4e8e\u6570\u636e\u5e93\u597d\u51e0\u4e2a\u6570\u91cf\u7ea7\uff0c\u6709\u4e86\u7f13\u5b58\u5c31\u8981\u7528\u597d\u5b83\uff0c\u90a3\u4e48\u5c31\u6709\u4e86\u7f13\u5b58\u547d\u4e2d\u7387\u8fd9\u4e2a\u6982\u5ff5\uff0c\u5b83\u662f\u8861\u91cf\u7cfb\u7edf\u6027\u80fd\u7684\u4e00\u4e2a\u91cd\u8981\u6307\u6807\uff0c\u8bf7\u6c42\u7684\u6570\u636e\u5728\u7f13\u5b58\u4e2d\u627e\u5230\u4e86\u547d\u4e2d\u4e86\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u7f13\u5b58\u6765\u83b7\u53d6\u60f3\u8981\u7684\u6570\u636e\u3002</p> <p>\u547d\u4e0d\u4e2d\u90a3\u4e48\u5c31\u9700\u8981\u53bb\u67e5\u6211\u4eec\u7684\u6570\u636e\u5e93\u4e86\uff0c\u547d\u4e2d\u7f13\u5b58\u7684\u8bf7\u6c42\u5360\u603b\u8bf7\u6c42\u7684\u6bd4\u7387\uff0c\u5c31\u662f\u6240\u8c13\u7684\u7f13\u5b58\u547d\u4e2d\u7387\uff0c\u547d\u4e2d\u7387\u8d8a\u9ad8\u5e94\u7528\u7684\u6027\u80fd\u5c31\u8d8a\u597d\uff0c\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u54cd\u5e94\u65f6\u95f4\u53d8\u77ed\u4e86\uff0c\u541e\u5410\u91cf\u53d8\u9ad8\u4e86\uff0cQPS\u63d0\u9ad8\u4e86\uff0c\u81ea\u7136\u5e76\u53d1\u91cf\u4e5f\u5c31\u4e0a\u53bb\u4e86</p> <p>\u90a3\u600e\u4e48\u63d0\u9ad8\u7f13\u5b58\u547d\u4e2d\u7387\u5462</p> <p>\u6311\u4e00\u90e8\u5206\u8bbf\u95ee\u91cf\u6bd4\u8f83\u9ad8\u7684\u6570\u636e\uff0c\u4e5f\u5c31\u662f\u6240\u8c13\u7684\u70ed\u70b9\u6570\u636e\u6765\u5237\u5230\u7f13\u5b58\u91cc\u9762\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u7cfb\u7edf\u57cb\u70b9\u6216\u8005\u901a\u8fc7\u8fd9\u4e2a\u6570\u636e\u76d1\u6d4b\uff0c\u6216\u8005\u901a\u8fc7\u4e00\u4e9b\u5f00\u6e90\u7684\u7ec4\u4ef6\uff0c\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2a\u554ajd-Hotkey\uff0c\u5bf9\u4e8e\u8fd9\u4e9b\u70ed\u70b9\u6570\u636e\uff0c\u662f\u53ef\u4ee5\u63d0\u524d\u5237\u5230\u7f13\u5b58\u91cc\u9762\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee\u91cf\u6765\u7ed9\u70edkey\u7eed\u547d\uff0c\u6bd4\u5982\u8bf4\u6bcf\u589e\u52a0\u4e00\u4e2a\u8bbf\u95ee\uff0c\u5c31\u5ef6\u957f\u4e00\u5b9a\u7684\u8fd9\u4e2a\u8fc7\u671f\u65f6\u95f4\uff0c\u70ed\u70b9\u6570\u636e\u5c31\u4f1a\u957f\u671f\u7684\u505c\u7559\u5728\u7f13\u5b58\u91cc\u9762\uff0c\u90a3\u4e48\u547d\u4e2d\u7387\u4e5f\u5c31\u81ea\u7136\u5c31\u9ad8\u4e86</p> <p>\u53e6\u5916\u8fd8\u6709\u4e00\u4e2a\u63d0\u5347\u547d\u4e2d\u7387\u7684\u65b9\u5f0f\uff0c\u5c31\u662f\u4f7f\u7528\u591a\u7ea7\u7f13\u5b58\uff0c\u8bf7\u6c42\u5148\u8fc7\u6765\u5148\u5728\u672c\u5730\u67e5\u770b\uff0c\u5982\u679c\u5728\u8fd1\u7aef\u7f13\u5b58\u91cc\u9762\u6709\u5c31\u76f4\u63a5\u8fd4\u56de\uff0c\u5982\u679c\u6ca1\u6709\u5c31\u518d\u53bbredis\u91cc\u9762\u53bb\u770b\uff0c\u8fd9\u6837\u4e00\u6765\u80fd\u591f\u63d0\u9ad8\u7f13\u5b58\u7684\u547d\u4e2d\u7387\uff0c\u4e8c\u6765\u4e5f\u80fd\u591f\u51cf\u5c11\u5bf9redis\u7684\u8bbf\u95ee\uff0c\u4fdd\u62a4\u4e86\u8fdc\u7aef\u7f13\u5b58</p> <p>\u53e6\u5916\u8fd8\u6709\u8fd9\u4e2a\u7f13\u5b58\u7684\u7c92\u5ea6\u8981\u6ce8\u610f\uff0c\u5c3d\u91cf\u8981\u5f80\u5c0f\u7684\u53bb\u8bbe\uff0c\u4e0d\u8981\u7b3c\u7edf\u7684\u653e\u5728\u4e00\u4e2a\u96c6\u5408\u91cc\u9762</p>"},{"location":"chap7/int_anws/#4_4","title":"4 \u5206\u5e03\u5f0f\u4e0b\u7684\u65e5\u5fd7\u7cfb\u7edf","text":"<p>\u5728\u9879\u76ee\u91cc\u4f1a\u5f15\u5165\u4e00\u4e9b\u65e5\u5fd7\u7684\u7ec4\u4ef6\uff0c\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2alog4j, self4\uff0c\u7136\u540e\u5728\u4e00\u4e9b\u6bd4\u8f83\u5173\u952e\u7684\u5730\u65b9\uff0c\u6765\u8bb0\u5f55\u65e5\u5fd7</p> <p>\u96c6\u7fa4\u67b6\u6784\u7684\u5206\u5e03\u5f0f\u67b6\u6784\uff0c\u65e5\u5fd7\u5206\u6563\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u9762\u5c24\u5176\u662f\u5fae\u670d\u52a1\u67b6\u6784\uff0c \u670d\u52a1\u4e0e\u670d\u52a1\u4e4b\u95f4\u7684\u4ea4\u53c9\u8c03\u7528</p> <p>\u8981\u67e5\u770b\u4e00\u4e2a\u4e8b\u52a1\u7684\u5168\u90e8\u65e5\u5fd7\uff0c\u53ef\u80fd\u8981\u767b\u5f55\u597d\u51e0\u53f0\u670d\u52a1\u5668\uff0c\u6240\u4ee5\u5c31\u6d8c\u73b0\u51fa\u4e86\u4e00\u4e9b\u5206\u5e03\u5f0f\uff0c\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2aELK, \u53ef\u4ee5\u5c06\u591a\u4e2a\u670d\u52a1\u5668\u7684\u65e5\u5fd7\u8fdb\u884c\u6536\u96c6,\u5b58\u50a8\u548c\u5c55\u793a</p> <ul> <li>logstash, \u662f\u505a\u65e5\u5fd7\u7684\u6536\u96c6\u8fc7\u6ee4\u548c\u4e0a\u62a5</li> <li>es\u662f\u505a\u5b58\u50a8\u548c\u641c\u7d22\u5f15\u64ce</li> <li>kibana \u662f\u505a\u8fd9\u4e2a\u65e5\u5fd7\u7684\u67e5\u8be2\u53ef\u89c6\u5316\u754c\u9762</li> </ul> <p>\u5f53\u7136\u73b0\u5728\u4e5f\u5f15\u5165\u4e86\u8fd9\u4e2afilebeat, \u6765\u66ff\u4ee3\u539f\u5148\u8fd9\u4e2alogstash, \u505a\u65e5\u5fd7\u6536\u96c6\u7684\u5de5\u4f5c</p> <p>filebeat\u6bd4\u8f83\u4e13\u4e1a\u4e13\u95e8\u505a\u6536\u96c6</p> <p>\u50cf\u5b9e\u65f6\u6253\u5370\u7684\u65e5\u5fd7, \u53ef\u4ee5\u76f4\u63a5\u50cf<code>tail-f</code>\u2014\u6837\u76d1\u542c\u5230,\u4e5f\u652f\u6301\u6d88\u606f\u961f\u5217\u7684\u63a5\u6536. \u53ef\u4ee5\u9762\u5bf9\u591a\u4e2a\u6570\u636e\u6e90</p> <p>\u53e6\u4e00\u65b9\u9762\u5462filebeat\u6bd4\u8f83\u8f7b\u91cf</p> <p>\u4e0d\u50cflogstash, \u8dd1\u5728Jvm\u91cc\u9762, \u5360\u7528\u7684\u8fd9\u4e2a\u8d44\u6e90\u6bd4\u8f83\u591a </p> <p>\u5f88\u591a\u573a\u5408\u5982\u679c\u4e0d\u505a\u6570\u636e\u6e05\u6d17, \u751a\u81f3\u76f4\u63a5\u53ef\u4ee5\u53bb\u6389logstash, \u53d8\u6210\u4e86EFK</p> <p>\u9700\u8981\u7528\u5230\u6b63\u5219\u8fc7\u6ee4, \u90a3\u4e48\u8fd8\u9700\u8981\u7528\u5230logstash, \u6765\u505a\u65e5\u5fd7\u6e05\u6d17\u7684\u4e2d\u95f4\u4ef6, \u90a3\u4e48\u5c31\u53ef\u4ee5\u52a0\u4e0a\u524d\u7f6e\u7684\u8fd9\u4e2afilebeat, \u4e5f\u5c31\u662f\u8fd9\u4e2aFELK, \u8fd9\u662f\u76ee\u524d\u6bd4\u8f83\u4e3b\u6d41\u7684\u65e5\u5fd7\u6846\u67b6</p> <p>\u5f53\u7136\u57fa\u4e8e\u8fd9\u4e2a\u65e5\u5fd7, \u4e5f\u53ef\u4ee5\u505a\u4e00\u4e9b\u94fe\u8def\u8ffd\u8e2a, \u6240\u8c13\u7684\u8c03\u7528\u94fe. \u53ea\u662f\u5728\u4e00\u6b21\u4e8b\u52a1\u8bf7\u6c42\u7684\u65f6\u5019, \u5728\u4e00\u5f00\u59cb</p> <p>\u7b2c\u4e00\u6b21\u7684\u65f6\u5019\u521d\u59cb\u5316traceID, \u7136\u540e\u6309\u7167\u8bf7\u6c42\u7684\u987a\u5e8f\u8fdb\u884c\u7f16\u53f7,\u90a3\u4e48\u5c31\u53ef\u4ee5\u628a\u6574\u4e2a\u7684\u94fe\u8def\u4e32\u8d77\u6765, \u8bbf\u95ee\u4e86\u54ea\u4e2a\u65b9\u6cd5, \u65b9\u6cd5\u91cc\u6709\u54ea\u4e9b\u5173\u952e\u8282\u70b9</p>"},{"location":"chap7/int_anws/#5_2","title":"5 \u76d8\u70b9\u7ebf\u4e0a\u5b9a\u4f4d\u95ee\u9898\u7684\u5de5\u5177","text":"<p>\u600e\u4e48\u5728\u7ebf\u4e0a\u5b9a\u4f4d\u548c\u6392\u67e5\u95ee\u9898\uff0c\u60f3\u67e5\u770b\u8fd9\u4e2aAPI\u7684\u8c03\u7528\u94fe\u8def\uff0c\u5404\u4e2a\u4e2d\u5fc3\u5404\u4e2a\u670d\u52a1\u4e4b\u95f4\u7684\u8c03\u7528\u94fe\uff0c\u5c31\u9700\u8981\u4f7f\u7528skywalking\uff0czipkin, ali\u7684\u9e70\u773c\u6216\u8005\u662f\u8fd9\u4e2a\u8001\u724c\u7684pinpoint</p> <p>\u67e5\u770b\u5404\u4e2a\u5e94\u7528\u4e4b\u95f4\u7684\u8c03\u7528\u5173\u7cfb\u7684, \u50cf\u4ec0\u4e48\u8bf7\u6c42\u5ef6\u8fdf\u9519\u8bef\u7387, tps\u541e\u5410\u91cf\u8fd9\u4e9b\u6307\u6807, \u90fd\u53ef\u4ee5\u901a\u8fc7\u53ef\u89c6\u5316\u7684\u8fd9\u4e2a\u754c\u9762\u6765\u67e5\u770b</p> <p>\u6216\u8005\u76f4\u63a5\u5728\u7ebf\u4e0a\u7684\u65b9\u6cd5\u52a0\u4e00\u884c\u4ee3\u7801\uff0c\u8981\u6253\u5370\u67d0\u4e2a\u53d8\u91cf\u7684\u8fd9\u4e2a\u72b6\u6001\u503c\uff0c\u6216\u8005\u62e6\u622a\u51fa\u53c2\u5165\u53c2\uff0c\u751a\u81f3\u52a0\u4e00\u6bb5\u4ee3\u7801\u903b\u8f91</p> <p>\u5c31\u53ef\u4ee5\u4f7f\u7528\uff0c\u50cf\u8fd9\u4e2abtrace\uff0c\u6216\u8005\u662farthas\uff0c\u53ef\u4ee5\u52a8\u6001\u7684\u6765\u4fee\u6539\u8fd9\u4e2a\u7ebf\u4e0a\u4ee3\u7801\uff0c \u8fd9\u5c31\u662f\u6240\u8c13\u7684\u70ed\u90e8\u7f72</p> <p>\u73b0\u5728\u6d41\u884c\u901a\u7528\u7684\u662farthas\uff0c\u4ed6\u7684\u64cd\u4f5c\u65b9\u5f0f\u8fd8\u6709\u70b9\u7c7b\u4f3c\u8fd9\u4e2aLinux\uff0c shell\u811a\u672c\uff0c \u76f4\u63a5\u6572\u547d\u4ee4\u5c31\u53ef\u4ee5\u89e3\u6c7a\u5b9a\u4f4d\u95ee\u9898\uff0c\u5b9e\u9645\u4e0a\u90fd\u7ed5\u4e0d\u5f00\u5b57\u8282\u7801\u63a2\u9488\uff0c \u4e0d\u7ba1\u662f\u94fe\u8def\u8c03\u7528\u8fd8\u662f\u4ee3\u7801\u7684\u8fd9\u4e2a\u62e6\u622a\u6ce8\u5165</p>"},{"location":"chap7/int_anws/#6_4","title":"6 \u5982\u4f55\u5feb\u901f\u5220\u9664\u6d77\u91cf\u6570\u6398","text":"<p>\u6bd4\u5982\u8bf4\u5bf9\u4e8e\u4e00\u4e9b\u8fc7\u671f\u7684\u64cd\u4f5c\u65e5\u5fd7, \u8fd9\u4e2a\u65e0\u6548\u7684\u7528\u6237\u6570\u636e\u5927\u6570\u636e\u5206\u6790\u7684\u4e34\u65f6\u5e93</p> <p>\u8fd9\u4e2a\u65e0\u6548\u7684\u7528\u6237\u6570\u636e\u5927\u6570\u636e\u5206\u6790\u7684\u4e34\u65f6\u5e93, \u5927\u6570\u636e\u5206\u6790\u7684\u4e34\u65f6\u5e93\u554a\u7b49\u7b49, \u90a3\u4e48\u4e3a\u4e86\u51cf\u5c11\u5b58\u50a8\u7a7a\u95f4\u63d0\u9ad8\u6027\u80fd\u6216\u8005\u662f\u4fdd\u8bc1\u6570\u636e\u7684\u4f20\u6388\u6548\u7387\u6216\u8005\u662f\u7cbe\u5ea6\u7b49\u7b49</p> <p>\u8fd9\u4e9b\u6570\u636e\u662f\u8981\u88ab\u5b9a\u65f6\u6e05\u6389, \u5176\u5b9e\u5bf9\u4e8e\u5c11\u91cf\u7684\u6570\u636e\u6765\u8bf4, \u6839\u672c\u4e0d\u4f1a\u51fa\u73b0\u4ec0\u4e48\u6027\u80fd\u95ee\u9898</p> <p>\u4f46\u662f\u4e00\u65e6\u91cf\u4e0a\u6765, \u8981\u5220\u9664\u51e0\u767e\u4e07\u7684\u6570\u636e,\u53ef\u80fd\u8981\u82b1\u8d39\u597d\u51e0\u4e2a\u5c0f\u65f6,\u4e3b\u8981\u539f\u56e0\u8fd8\u662f\u5728\u7d22\u5f15\u8fd9\u4e00\u5757. </p> <p>\u56e0\u4e3a\u4f60\u6bcf\u5220\u9664\u4e00\u6761\u8bb0\u5f55, \u5c31\u8981\u5728\u5bf9\u5e94\u7684\u7d22\u5f15\u6811\u91cc\u9762\u7684\u4e3b\u952e\u7d22\u5f15\u4e8c\u7ea7\u7d22\u5f15,\u90fd\u9700\u8981\u5220\u6389\u76f8\u5e94\u7684\u8282\u70b9\u7136\u540e\u91cd\u65b0\u6392\u5e8f. </p> <p>\u6bd4\u8f83\u5e38\u89c1\u7684\u64cd\u4f5c\u65b9\u5f0f\u5c31\u662f\u5148\u53bb\u6389\u8868\u7684\u7d22\u5f15, \u9664\u4e86\u5220\u9664\u6570\u636e\u9700\u8981\u7528\u5230\u7684\u7d22\u5f15\u4ee5\u5916, \u5176\u4ed6\u7684\u7d22\u5f15\u5168\u90e8\u5220\u6389, \u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u80fd\u8981\u82b1\u8d39\u597d\u51e0\u5206\u949f, \u8fd9\u6837\u53bb\u5220\u9664\u6570\u636e\u554a\u5c31\u4f1a\u5f88\u5feb</p> <p>\u5220\u5b8c\u6570\u636e\u4e4b\u540e, \u518d\u628a\u7d22\u5f15\u518d\u52a0\u56de\u53bb, \u5220\u9664\u6570\u636e\u4e4b\u540e\u8868\u7684\u6570\u636e\u6ca1\u90a3\u4e48\u591a\u4e86, \u52a0\u7d22\u5f15\u4e5f\u5c31\u5f88\u5feb. </p> <p>\u4e5f\u53ef\u4ee5\u76f4\u63a5\u53bb\u5efa\u4e34\u65f6\u8868\u5b58\u50a8\uff0c\u7136\u540e\u518dtruncat\u4f60\u7684\u539f\u8868\uff0c\u76f8\u5bf9\u524d\u4e00\u79cd\u5462\u4f1a\u66f4\u52a0\u7684\u5feb\uff0c\u5220\u9664\u4e86\u6d77\u91cf\u6570\u636e\u4e4b\u540e\uff0c\u53bb\u505a\u4e00\u4e0b\u8868\u7a7a\u95f4\u7684\u538b\u7f29\uff0c\u8fd9\u6837\u624d\u4e0d\u4f1a\u5f71\u54cd\u5230\u6570\u636e\u5e93\u7684\u67e5\u8be2</p>"},{"location":"chap7/int_anws/#7_2","title":"7 \u804a\u804a\u707e\u5907\u7684\u89e3\u6c7a\u65b9\u6848\uff1a\u4e24\u5730\u4e09\u4e2d\u5fc3","text":"<p>\u96c6\u7fa4\u5305\u542b\u5e94\u7528\u670d\u52a1\u7684\u96c6\u7fa4\uff0c\u6570\u636e\u5e93\u7684\u96c6\u7fa4\uff0c\u4e2d\u95f4\u4ef6\u7684\u96c6\u7fa4\uff0c\u8fd8\u8981\u914d\u5408\u5404\u79cd\u8d1f\u8f7d\u5747\u8861\u3002\u5728\u670d\u52a1\u4e4b\u95f4\u8981\u5c3d\u53ef\u80fd\u7684\u505a\u677e\u8026\u5408\uff0c\u8981\u505a\u597d\u4e1a\u52a1\u7684\u62c6\u5206\uff0c\u5f15\u5165\u5fae\u670d\u52a1\u7b49\u7b49</p> <p>\u90a3\u4e48\u4e00\u822c\u7cfb\u7edf\uff0c\u5728\u8f6f\u4ef6\u67b6\u6784\u5c42\u9762\u80fd\u505a\u5230\u8fd9\u4e00\u70b9\u5df2\u7ecf\u5c31\u591f\u4e86\uff0c\u4f46\u662f\u5bf9\u4e8e\u4e00\u4e2a\u89c4\u6a21\u6bd4\u8f83\u5927\uff0c\u7528\u6237\u91cf\u6bd4\u8f83\u5927\u76f8\u5e94\u8981\u6c42\u6bd4\u8f83\u9ad8\u7684\u7cfb\u7edf\u5e73\u53f0\u6765\u8bf4\uff0c\u8fd9\u4e9b\u8fd8\u8fdc\u8fdc\u4e0d\u591f\u3002</p> <p>\u8fd8\u9700\u8981\u53bb\u5efa\u707e\u5907\u4e2d\u5fc3\uff0c\u90a3\u4e48\u4e3b\u8981\u7684\u76ee\u7684\u5c31\u662f\u4e3a\u4e86\u9632\u6b62\u4e0d\u53ef\u9884\u89c1\u7684\u707e\u96be\u53d1\u751f\uff0c\u81ea\u7136\u707e\u5bb3\u6216\u8005\u4eba\u4e3a\u4e86\u8fd9\u4e2a\u539f\u56e0\u5bfc\u81f4\u7684\u6574\u4e2a\u4e2d\u5fc3\u6302\u4e86\uff0c\u90a3\u4e48\u5c31\u8981\u6709\u5197\u4f59\u7684\u5b9e\u4f8b\u6216\u8005\u505a\u5230\u65e0\u7f1d\u5207\u6362\u3002 </p> <p>\u5e38\u89c1\u7684\u707e\u5907\u65b9\u6848\uff0c\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2a\u540c\u57ce\u707e\u5907\uff0c\u540c\u57ce\u53cc\u6d3b\uff0c\u4e24\u5730\u4e09\u4e2d\u5fc3\uff0c\u5c31\u662f\u5728\u4e24\u4e2a\u5730\u65b9\u5efa\u4e09\u4e2a\u4e2d\u5fc3\uff0c\u5982\u679c\u540c\u57ce\u707e\u5907\u4e2d\u5fc3\u4e5f\u53d1\u751f\u4e86\u707e\u96be\uff0c\u90a3\u4e48\u5c31\u8ba9DNS\u6307\u5230\u5f02\u5730\u7684\u707e\u5907\u4e2d\u5fc3\u3002 </p> <p>\u90a3\u4e24\u5730\u4e09\u4e2d\u5fc3\u662f\u600e\u4e48\u5b9e\u73b0\u7684\u5462\uff0c\u5176\u5b9e\u8ddf\u6211\u4eec\u4f20\u7edf\u7684\u707e\u5907\u5176\u5b9e\u533a\u522b\u5e76\u4e0d\u662f\u5f88\u5927\u3002 \u5728\u670d\u52a1\u7684\u90e8\u7f72\u4e0a\uff0c\u6838\u5fc3\u7684\u539f\u5219\u5c31\u662f\u505a\u5197\u4f59\uff0c \u505a\u5907\u4efd\u3002</p> <p>\u5728\u540c\u57ce\u90e8\u7f72\u8fd8\u662f\u5728\u5f02\u5730\u90e8\u7f72\uff0c\u5176\u5b9e\u533a\u522b\u5e76\u4e0d\u662f\u5f88\u5927\uff0c\u8981\u7279\u522b\u6ce8\u610f\u7684\u5c31\u662f\u8fd9\u4e2a\u6570\u636e\u7684\u540c\u6b65\u3002</p> <p>\u5f02\u5730\u6570\u636e\u4e2d\u95f4\u540c\u6b65\uff0c \u90a3\u4e48\u540c\u57ce\u7684\u707e\u5907\uff0c\u4e00\u822c\u90fd\u662f\u91c7\u7528\u8fd9\u4e2a\u70ed\u5907\u3002</p> <p>\u5b83\u5c31\u662f\u5c06\u6574\u4e2a\u7684\u670d\u52a1\uff0c \u5305\u62ecweb\u670d\u52a1\u5305\uff0c\u62ec\u6570\u636e\u5e93\uff0c\u5f02\u5730\u6570\u636e\u4e2d\u95f4\u540c\u6b65\u3002</p> <p>\u90a3\u4e48\u540c\u57ce\u7684\u707e\u5907\u5462\uff0c\u90fd\u662f\u5b9e\u65f6\u8ddf\u6211\u4eec\u7684\u751f\u4ea7\u4e2d\u5fc3\u8fdb\u884c\u540c\u6b65\u7684\uff0c\u90a3\u4e48\u4e00\u822c\u4e5f\u90fd\u662f\u91c7\u7528\u8fd9\u4e2a\u5feb\u7167\u589e\u91cf\u7684\u65b9\u5f0f\uff0c\u518d\u52a0\u4e0a\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u8fd9\u4e2abinlog\uff0c\u6574\u4e2a\u7684\u540c\u6b65\u673a\u5236\u8fd8\u662f\u6bd4\u8f83\u6210\u719f\u7684\uff0c\u662f\u5904\u4e8e\u4e00\u4e2a\u70ed\u5907\u7684\u72b6\u6001\uff0c\u4e00\u65e6\u751f\u4ea7\u4e2d\u5fc3\u6302\u4e86\uff0c\u540c\u57ce\u7684\u707e\u5907\u5c31\u4f1a\u7acb\u5373\u6295\u5165\u4f7f\u7528\u3002\u90a3\u4e48\u5bf9\u4e8e\u5f02\u5730\u707e\u5907\uff0c \u4e00\u822c\u662f\u505a\u8fd9\u4e2a\u6e29\u5907\u6216\u8005\u51b7\u5907\u5c31\u53ef\u4ee5\u4e86\u3002</p>"},{"location":"chap7/int_anws/#8_4","title":"8 \u5982\u4f55\u89e3\u6c7a\u5927\u6570\u636e\u91cf\u4f20\u8f93\u7684\u9650\u5236\u95ee\u9898","text":"<p>\u89e3\u51b3\u65b9\u6848\uff1a \u6765\u538b\u7f29\u6211\u4eec\u5165\u53c2\u7684\u8fd9\u4e2a\u62a5\u6587\uff0c \u7136\u540e\u518d\u5728\u63a5\u6536\u7aef\u89e3\u538b\u7f29\uff0c\u8fd9\u6837\u53ef\u4ee5\u987a\u5229\u7684\u901a\u8fc7\u7f51\u5173\uff0c\u8fd9\u4ec5\u4ec5\u4e5f\u662f\u5c5e\u4e8e\u4e00\u4e2a\u4e2a\u4e34\u65f6\u65b9\u6848\u3002 \u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u540e\u7eed\u8bf7\u6c42\u5165\u53c2\u53d8\u591a\uff0c\u540c\u6837\u53ef\u80fd\u8d85\u8fc710\u5146\uff0c\u6240\u4ee5\u538b\u7f29\u7684\u65b9\u5f0f\u53ea\u80fd\u8bf4\u6682\u65f6\u89e3\u51b3\u95ee\u9898\uff0c\u4ed6\u89e3\u51b3\u4e0d\u4e86\u957f\u671f\u7684\u6570\u636e\u589e\u957f\u7684\u95ee\u9898</p> <p>\u6bd4\u8f83\u957f\u4e45\u7684\u65b9\u6848</p> <p>\u91c7\u7528\u5206\u7247\u5904\u7406\u5c06\u5165\u53c2\u7684\u8fd9\u4e2ajson\u5206\u6210\u591a\u4efd\u8fdb\u884c\u4f20\u8f93, \u7136\u540e\u5728\u540e\u7aef\u7edf\u4e00\u6765\u505a\u62fc\u63a5.  \u5c31\u662f\u628a\u5927\u7684\u5165\u53c2\u5206\u6210\u591a\u6b21\u6765\u8c03, \u8fd9\u79cd\u5c5e\u4e8e\u95f4\u63a5\u7684\u5904\u7406\u65b9\u5f0f</p> <p>cons</p> <p>\u8fdc\u8fdc\u6ca1\u6709\u538b\u7f29\u554a\u6539\u7f51\u5173\u6765\u7684\u90a3\u4e48\u5feb\uff0c\u5bf9\u4e8e\u53d1\u9001\u7aef\uff0c\u63a5\u6536\u7aef\u4e5f\u4f1a\u6709\u4e00\u5b9a\u7684\u5f71\u54cd\u3002 \u57fa\u4e8e\u73b0\u6709\u7684API\uff0c\u8fdb\u884c\u5206\u9875\u7684\u6539\u9020\u624d\u80fd\u591f\u5b9e\u73b0\u3002\u800c\u4e14\u591a\u6b21\u7684\u5206\u9875\u8c03\u7528\u5728\u6027\u80fd\u4e0a\u9762\u80af\u5b9a\u4f1a\u6709\u5f71\u54cd\u7684</p>"},{"location":"chap7/int_anws/#9_4","title":"9 \u63a5\u53e3\u7a81\u7136\u53d8\u6162\u53ef\u80fd\u7684\u539f\u56e0\u6709\u90a3\u54ea\u4e9b\uff1f","text":"<ul> <li>\u4e00\u662f\u786c\u4ef6\u65b9\u9762\u7684\u95ee\u9898</li> <li>\u4e8c\u662f\u7a0b\u5e8f\u65b9\u9762\u7684\u95ee\u9898</li> </ul>"},{"location":"chap7/int_anws/#_8","title":"\u786c\u4ef6\u65b9\u9762","text":"<p>\u6bd4\u8f83\u5e38\u89c1\u7684\u8fd9\u4e2a\u56e0\u7d20</p> <ul> <li>\u670d\u52a1\u5668\u8d1f\u8f7d\u4e0a\u5347\uff0c\u6ca1\u6709\u8db3\u591f\u7684\u8d44\u6e90\uff0c\u8bbf\u95ee\u7ebf\u7a0b\u5904\u4e8e\u963b\u585e\u7684\u72b6\u6001\uff0c\u81ea\u7136\u8bbf\u95ee\u5c31\u4f1a\u53d8\u6162</li> <li>\u7a81\u7136\u7684\u8fd9\u4e2a\u6d41\u91cf\u589e\u52a0\u6216\u8005\u5176\u4ed6\u7684\u4e00\u4e9b\u4ec0\u4e48\u5e94\u7528\u7a0b\u5e8f\uff0c \u5360\u7528\u4e86\u6b64\u8f83\u591a\u7684\u8fd9\u4e2a\u670d\u52a1\u8d44\u6e90\uff0c\u5f88\u6709\u53ef\u80fd\u5c31\u5bfc\u81f4\u4e86\u670d\u52a1\u5668\u7684\u8d44\u6e90\u5360\u7528\u8fc7\u9ad8\uff0c \u5bfc\u81f4\u8d1f\u8f7d\u8fc7\u5927</li> </ul> <p>\u5176\u4ed6\u7684\u786c\u4ef6\u56e0\u7d20</p> <ul> <li>DDOS\u653b\u51fb</li> <li>\u5e26\u5bbd</li> <li>\u7ebf\u7a0b</li> </ul> <p>\u53ef\u80fd\u4f1a\u88ab\u65e0\u6548\u7684\u8fd9\u4e2a\u8bf7\u6c42\u5360\u7528\u6b86\u5c3d\uff0c\u6b63\u5e38\u8bf7\u6c42\u8fdb\u4e0d\u6765\uff0c\u4e5f\u4f1a\u8bbf\u95ee\u53d8\u6162</p> <p>\u8fd8\u6709\u5c31\u662f\u786c\u4ef6\u672c\u8eab\u7684\u95ee\u9898</p> <ul> <li>\u6bd4\u5982\u8bf4\u50cf\u8fd9\u4e2a\u7f51\u7edc\u95ee\u9898\uff0c\u7a81\u53d1\u7684\u7f51\u7edc\u4e2d\u65ad\uff0c\u8def\u7531\u5668\u6545\u969c\u554a</li> <li>\u8fd8\u5c31\u662f\u50cfCPU\u8fc7\u70ed</li> <li>\u78c1\u76d8\u6545\u969c</li> <li>\u5185\u5b58\u6cc4\u6f0f</li> </ul>"},{"location":"chap7/int_anws/#_9","title":"\u7a0b\u5e8f\u65b9\u9762\u7684\u95ee\u9898","text":"<ul> <li>\u4ee3\u7801\u4e2d\u5b58\u5728\u7684\u8fd9\u4e2a\u6027\u80fd\u95ee\u9898\u4e86<ul> <li>\u8fd9\u4e2a\u591a\u5c42\u5faa\u73af\u5904\u7406\u903b\u8f91</li> <li>\u5faa\u73af\u8c03\u7528\u6570\u636e\u5e93</li> <li>\u5faa\u73af\u8c03\u7528\u8fd9\u4e2a\u5916\u90e8\u63a5\u53e3</li> <li>\u9012\u5f52</li> <li>\u51fa\u73b0\u4e86\u6b7b\u5faa\u73af</li> </ul> </li> </ul>"},{"location":"chap7/int_anws/#_10","title":"\u6570\u636e\u5e93\u65b9\u9762\u7684\u95ee\u9898","text":"<ul> <li>\u7d22\u5f15\u5931\u6548</li> <li>\u67e5\u8be2\u53d1\u751f\u4e86\u6b7b\u9501</li> <li>\u6216\u8005\u8bf4\u51fa\u73b0\u4e86\u8fd9\u4e2a\u5927\u91cf\u7684\u8ba1\u7b97</li> <li>\u5185\u5d4c\u67e5\u8be2\uff0c\u540c\u6837\u5462\u4f1a\u5bfc\u81f4\u6574\u4e2a\u7684\u67e5\u8be2\u63a5\u53e3\u53d8</li> </ul>"},{"location":"chap7/int_anws/#_11","title":"\u8c03\u7528\u4e86\u7b2c\u4e09\u65b9\u670d\u52a1","text":"<ul> <li>\u6bd4\u5982\u8bf4\u63a5\u53e3\uff0c\u6240\u4f9d\u8d56\u7684\u8fd9\u4e2a\u4e09\u65b9\u670d\u52a1\u6027\u80fd\u95ee\u9898</li> </ul>"},{"location":"chap7/my/","title":"My Interview","text":""},{"location":"chap7/my/#network","title":"\u7f51\u7edc / Network","text":""},{"location":"chap7/my/#state-the-difference-between-get-and-post","title":"State the difference between GET and POST.","text":"<p>GET and POST are two different HTTP request methods.</p> <p>GET</p> <ul> <li>This method is used to request data from a certain resource (via some API URL).</li> <li>If you use the GET method to send data, the data is added to the URL, and a URL can be up to 2048 characters in length. Therefore, it has restrictions on data length.</li> <li>In comparison to POST, GET is less secure since data issent as part of the URL. Passwords and other sensitive information should never be sent using GET.</li> <li>Everyone can see the data in the URL</li> </ul> <p>POST</p> <ul> <li>This method is used to send or write data to be processed to a specific resource (via some API URL).</li> <li>It does not impose such limitations</li> <li>It is a little safer to use POST than GET because the parameters are not saved in the browser history or the web server logs.</li> <li> <p>There is no data displayed in the URL</p> </li> <li> <p>\u4ece\u529f\u80fd\u4e0a\u8bb2\uff0cGET\u4e00\u822c\u7528\u6765\u4ece\u670d\u52a1\u5668\u4e0a\u83b7\u53d6\u8d44\u6e90\uff0cPOST\u4e00\u822c\u7528\u6765\u66f4\u65b0\u670d\u52a1\u5668\u4e0a\u7684\u8d44\u6e90\uff1b</p> </li> <li>\u4eceREST\u670d\u52a1\u89d2\u5ea6\u4e0a\u8bf4\uff0cGET\u662f\u5e42\u7b49\u7684\uff0c\u5373\u8bfb\u53d6\u540c\u4e00\u4e2a\u8d44\u6e90\uff0c\u603b\u662f\u5f97\u5230\u76f8\u540c\u7684\u6570\u636e\uff0c\u800cPOST\u4e0d\u662f\u5e42\u7b49\u7684\uff0c\u56e0\u4e3a\u6bcf\u6b21\u8bf7\u6c42\u5bf9\u8d44\u6e90\u7684\u6539\u53d8\u5e76\u4e0d\u662f\u76f8\u540c\u7684\uff1b\u8fdb\u4e00\u6b65\u5730\uff0cGET\u4e0d\u4f1a\u6539\u53d8\u670d\u52a1\u5668\u4e0a\u7684\u8d44\u6e90\uff0c\u800cPOST\u4f1a\u5bf9\u670d\u52a1\u5668\u8d44\u6e90\u8fdb\u884c\u6539\u53d8\uff1b</li> <li>\u4ece\u8bf7\u6c42\u53c2\u6570\u5f62\u5f0f\u4e0a\u770b\uff0cGET\u8bf7\u6c42\u7684\u6570\u636e\u4f1a\u9644\u5728URL\u4e4b\u540e\uff0c\u5373\u5c06\u8bf7\u6c42\u6570\u636e\u653e\u7f6e\u5728HTTP\u62a5\u6587\u7684 \u8bf7\u6c42\u5934\u4e2d\uff0c\u4ee5?\u5206\u5272URL\u548c\u4f20\u8f93\u6570\u636e\uff0c\u53c2\u6570\u4e4b\u95f4\u4ee5&amp;\u76f8\u8fde\u3002\u7279\u522b\u5730\uff0c\u5982\u679c\u6570\u636e\u662f\u82f1\u6587\u5b57\u6bcd/\u6570\u5b57\uff0c\u539f\u6837\u53d1\u9001\uff1b\u5426\u5219\uff0c\u4f1a\u5c06\u5176\u7f16\u7801\u4e3a <code>application/x-www-form-urlencoded</code> MIME \u5b87\u7b26\u4e32(\u5982\u679c\u662f\u7a7a\u683c\uff0c\u8f6c\u6362\u4e3a+\uff0c\u5982\u679c\u662f\u4e2d\u6587/\u5176\u4ed6\u5b87\u7b26\uff0c\u5219\u76f4\u63a5\u628a\u5b87\u7b26\u4e32\u7528BASE64\u52a0\u5bc6\uff0c\u5f97\u51fa\u5982\uff1a<code>%E4%BD%A0%E5%A5%BD</code>\uff0c\u5176\u4e2d%\u00d7\u00d7\u4e2d\u7684XX\u4e3a\u8be5\u7b26\u53f7\u4ee516\u8fdb\u5236\u8868\u793a\u7684ASCI)\uff1b\u800cPOST\u8bf7\u6c42\u4f1a\u628a\u63d0\u4ea4\u7684\u6570\u636e\u5219\u653e\u7f6e\u5728\u662fHTTP\u8bf7\u6c42\u62a5\u6587\u7684 \u8bf7\u5c31\u5b89\u5168\u6027\u800c\u8a00\uff0cPOST\u7684\u5b89\u5168\u6027\u8981\u6bd4GET\u7684\u5b89\u5168\u6027\u9ad8\uff0c\u56e0\u4e3aGET\u8bf7\u6c42\u63d0\u4ea4\u7684\u6570\u636e\u5c06\u660e\u6587\u51fa\u73b0\u5728URL\u4e0a\uff0c\u800cPOST\u8bf7\u6c42\u53c2\u6570\u5219\u88ab\u5305\u88c5\u5230\u8bf7\u6c42\u4f53\u4e2d\uff0c\u76f8\u5bf9\u66f4\u5b89\u5168</li> <li>\u4ece\u8bf7\u6c42\u7684\u5927\u5c0f\u770b\uff0cGET\u8bf7\u6c42\u7684\u957f\u5ea6\u53d7\u9650\u4e8e\u6d4f\u89c8\u5668\u6216\u670d\u52a1\u5668\u5bf9URL\u957f\u5ea6\u7684\u9650\u5236\uff0c\u5141\u8bb8\u53d1\u9001\u7684\u6570\u636e\u91cf\u6bd4\u8f83\u5c0f\uff0c \u800cPOST\u8bf7\u6c42\u5219\u662f\u6ca1\u6709\u5927\u5c0f\u9650\u5236\u7684</li> </ul>"},{"location":"chap7/my/#_1","title":"\u4e09\u6b21\u63e1\u624b\u4e0e\u56db\u6b21\u6325\u624b","text":"<ul> <li>\u7b2c\u4e00\u6b21\u63e1\u624b\uff1a\u5ba2\u6237\u7aef\u53d1\u9001syn\u5305(syn=j)\u5230\u670d\u52a1\u5668\uff0c\u5e76\u8fdb\u5165<code>SYN_SEND</code>\u72b6\u6001\uff0c\u7b49\u5f85\u670d\u52a1\u5668\u786e\u8ba4\uff1b</li> <li>\u7b2c\u4e8c\u6b21\u63e1\u624b\uff1a\u670d\u52a1\u5668\u6536\u5230syn\u5305\uff0c\u5fc5\u987b\u786e\u8ba4\u5ba2\u6237\u7684SYN\uff08ack=j+1\uff09\uff0c\u540c\u65f6\u81ea\u5df1\u4e5f\u53d1\u9001\u4e00\u4e2aSYN\u5305\uff08syn=k\uff09\uff0c\u5373SYN+ACK\u5305\uff0c\u6b64\u65f6\u670d\u52a1\u5668\u8fdb\u5165SYN_RECV\u72b6\u6001\uff1b</li> <li>\u7b2c\u4e09\u6b21\u63e1\u624b\uff1a\u5ba2\u6237\u7aef\u6536\u5230\u670d\u52a1\u5668\u7684SYN\uff0bACK\u5305\uff0c\u5411\u670d\u52a1\u5668\u53d1\u9001\u786e\u8ba4\u5305ACK(ack=k+1)\uff0c\u6b64\u5305\u53d1\u9001\u5b8c\u6bd5\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u8fdb\u5165ESTABLISHED\u72b6\u6001\uff0c\u5b8c\u6210\u4e09\u6b21\u63e1\u624b\u3002</li> </ul>"},{"location":"chap7/my/#httpshttp","title":"HTTPS\u548cHTTP\u7684\u533a\u522b","text":"<ul> <li>https\u534f\u8bae\u9700\u8981\u5230ca\u7533\u8bf7\u8bc1\u4e66\u6216\u81ea\u5236\u8bc1\u4e66\u3002</li> <li>http\u7684\u4fe1\u606f\u662f\u660e\u6587\u4f20\u8f93\uff0chttps\u5219\u662f\u5177\u6709\u5b89\u5168\u6027\u7684ssl\u52a0\u5bc6\u3002</li> <li>http\u662f\u76f4\u63a5\u4e0eTCP\u8fdb\u884c\u6570\u636e\u4f20\u8f93\uff0c\u800chttps\u662f\u7ecf\u8fc7\u4e00\u5c42SSL\uff08OSI\u8868\u793a\u5c42\uff09\uff0c\u7528\u7684\u7aef\u53e3\u4e5f\u4e0d\u4e00\u6837\uff0c\u524d\u8005\u662f80\uff08\u9700\u8981\u56fd\u5185\u5907\u6848\uff09\uff0c\u540e\u8005\u662f443\u3002</li> <li>http\u7684\u8fde\u63a5\u5f88\u7b80\u5355\uff0c\u662f\u65e0\u72b6\u6001\u7684\uff1bHTTPS\u534f\u8bae\u662f\u7531SSL+HTTP\u534f\u8bae\u6784\u5efa\u7684\u53ef\u8fdb\u884c\u52a0\u5bc6\u4f20\u8f93\u3001\u8eab\u4efd\u8ba4\u8bc1\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u6bd4http\u534f\u8bae\u5b89\u5168\u3002</li> </ul> <p>\u6ce8\u610fhttps\u52a0\u5bc6\u662f\u5728\u4f20\u8f93\u5c42</p> <p>https\u62a5\u6587\u5728\u88ab\u5305\u88c5\u6210tcp\u62a5\u6587\u7684\u65f6\u5019\u5b8c\u6210\u52a0\u5bc6\u7684\u8fc7\u7a0b\uff0c\u65e0\u8bba\u662fhttps\u7684header\u57df\u4e5f\u597d\uff0cbody\u57df\u4e5f\u7f62\u90fd\u662f\u4f1a\u88ab\u52a0\u5bc6\u7684\u3002</p>"},{"location":"chap7/my/#explain-the-restful-api-and-write-its-usage","title":"Explain the Restful API and write its usage.","text":"<p>APIs (Application Programming Interfaces) are sets of rules and protocols that define how software programs or devices can communicate with each other. APIs that conform to the design principles of REST, or representational state transfer, are known as REST APIs. REST APIs may also be referred to as RESTful APIs. Using RESTful APIs, developers can create requests and receive responses via an HTTP request. REST API can also be used for mapping data from a cloud platform to a data warehouse or vice versa.</p>"},{"location":"chap7/my/#linux","title":"Linux","text":""},{"location":"chap7/my/#difference-hardlink-and-symlink","title":"Difference hardlink and symlink","text":"<p>\u7cfb\u7edf\u662f\u901a\u8fc7link\u7684\u6570\u91cf\u6765\u63a7\u5236\u6587\u4ef6\u5220\u9664\u7684\uff0c\u53ea\u6709\u5f53\u4e00\u4e2a\u6587\u4ef6\u4e0d\u5b58\u5728\u4efb\u4f55link\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u6587\u4ef6\u624d\u4f1a\u88ab\u5220\u9664\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\u6bcf\u4e2a\u6587\u4ef6\u4e24\u4e2alink\u8ba1\u6570\u5668\u6765\u63a7\u5236\uff1a<code>i_count</code>\u548c<code>i_nlink</code>\u3002</p> <ul> <li>\u5f53\u4e00\u4e2a\u6587\u4ef6\u88ab\u4e00\u4e2a\u7a0b\u5e8f\u5360\u7528\u7684\u65f6\u5019<code>i_count</code>\u5c31\u52a01\u3002</li> <li>\u5f53\u6587\u4ef6\u7684\u786c\u94fe\u63a5\u591a\u4e00\u4e2a\u7684\u65f6\u5019<code>i_nlink</code>\u4e5f\u52a01\u3002</li> <li>\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\uff0c\u5c31\u662f\u8ba9\u8fd9\u4e2a\u6587\u4ef6\uff0c\u6ca1\u6709\u8fdb\u7a0b\u5360\u7528\uff0c\u540c\u65f6<code>i_link</code>\u6570\u91cf\u4e3a0\u3002</li> <li>\u9ed8\u8ba4\u4e0d\u5e26\u53c2\u6570\u7684\u60c5\u51b5\u4e0b\uff0cln\u521b\u5efa\u7684\u662f\u786c\u94fe\u63a5\uff0c\u5e26-s\u53c2\u6570\u7684ln\u547d\u4ee4\u521b\u5efa\u7684\u662f\u8f6f\u94fe\u63a5\u3002</li> <li>\u786c\u94fe\u63a5\u6587\u4ef6\u4e0e\u6e90\u6587\u4ef6\u7684inode\u8282\u70b9\u53f7\u76f8\u540c\uff0c\u800c\u8f6f\u94fe\u63a5\u6587\u4ef6\u7684inode\u8282\u70b9\u53f7\uff0c\u4e0e\u6e90\u6587\u4ef6\u4e0d\u540c</li> <li>ln\u547d\u4ee4\u4e0d\u80fd\u5bf9\u76ee\u5f55\u521b\u5efa\u786c\u94fe\u63a5\uff0c\u4f46\u53ef\u4ee5\u521b\u5efa\u8f6f\u94fe\u63a5\u3002\u5bf9\u76ee\u5f55\u7684\u8f6f\u94fe\u63a5\u4f1a\u7ecf\u5e38\u4f7f\u7528\u5230\u3002</li> <li>\u5220\u9664\u6587\u4ef6<ul> <li>\u5220\u9664\u8f6f\u94fe\u63a5\u6587\u4ef6\uff0c\u5bf9\u6e90\u6587\u4ef6\u548c\u786c\u94fe\u63a5\u6587\u4ef6\u65e0\u4efb\u4f55\u5f71\u54cd\u3002</li> <li>\u5220\u9664\u6587\u4ef6\u7684\u786c\u94fe\u63a5\u6587\u4ef6\uff0c\u5bf9\u6e90\u6587\u4ef6\u53ca\u8f6f\u94fe\u63a5\u6587\u4ef6\u65e0\u4efb\u4f55\u5f71\u54cd\u3002</li> <li>\u5220\u9664\u94fe\u63a5\u6587\u4ef6\u7684\u6e90\u6587\u4ef6\uff0c\u5bf9\u786c\u94fe\u63a5\u6587\u4ef6\u65e0\u5f71\u54cd\uff0c\u4f1a\u5bfc\u81f4\u5176\u8f6f\u94fe\u63a5\u5931\u6548\uff08\u7ea2\u5e95\u767d\u5b57\u95ea\u70c1\u72b6\uff09</li> <li>\u540c\u65f6\u5220\u9664\u6e90\u6587\u4ef6\u53ca\u5176\u786c\u94fe\u63a5\u6587\u4ef6\uff0c\u6574\u4e2a\u6587\u4ef6\u624d\u4f1a\u88ab\u771f\u6b63\u7684\u5220\u9664\u3002</li> </ul> </li> <li>\u5f88\u591a\u786c\u4ef6\u8bbe\u5907\u7684\u5feb\u7167\u529f\u80fd\uff0c\u4f7f\u7528\u7684\u5c31\u662f\u7c7b\u4f3c\u786c\u94fe\u63a5\u7684\u539f\u7406</li> </ul>"},{"location":"chap7/my/#linuxbuffercache","title":"linux\u7cfb\u7edf\u91cc\uff0cbuffer\u548ccache\u5982\u4f55\u533a\u5206\uff1f","text":"<p>buffer\u548ccache\u90fd\u662f\u5185\u5b58\u4e2d\u7684\u4e00\u5757\u533a\u57df\uff0c</p> <ul> <li>\u5f53CPU\u9700\u8981\u5199\u6570\u636e\u5230\u78c1\u76d8\u65f6\uff0c\u7531\u4e8e\u78c1\u76d8\u901f\u5ea6\u6bd4\u8f83\u6162\uff0c\u6240\u4ee5CPU\u5148\u628a\u6570\u636e\u5b58\u8fdbbuffer\uff0c</li> <li>\u5f53CPU\u9700\u8981\u4ece\u78c1\u76d8\u8bfb\u5165\u6570\u636e\u65f6\uff0c\u7531\u4e8e\u78c1\u76d8\u901f\u5ea6\u6bd4\u8f83\u6162\uff0c\u53ef\u4ee5\u628a\u5373\u5c06\u7528\u5230\u7684\u6570\u636e\u63d0\u524d\u5b58\u5165cache\uff0cCPU\u76f4\u63a5\u4eceCache\u4e2d\u62ff\u6570\u636e\u8981\u5feb\u7684\u591a\u3002</li> </ul>"},{"location":"chap7/my/#linux_1","title":"Linux \u6587\u4ef6\u7cfb\u7edf","text":"<p>\u6587\u4ef6\u7cfb\u7edf\u5305\u542b\u5143\u6570\u636e\uff08\u7d22\u5f15\u6570\u636e\uff09\u4ee5\u53ca\u6570\u636e\u5185\u5bb9\uff08\u6570\u636e\u5757\uff09</p> <p>inode\u5373\u4e3a\u5143\u6570\u636e\uff0cinode\u8bb0\u5f55\u6570\u636e\u5757\u7684\u4f4d\u7f6e\u53ca\u7d22\u5f15\u4fe1\u606f\uff08\u6587\u4ef6\u5c5e\u6027\uff0cctime\uff0catime\uff0cmtime\u7b49\uff09</p> <ul> <li>\u6587\u4ef6\u7684\u5b57\u8282\u6570\uff0c\u5757\u6570</li> <li>\u6587\u4ef6\u62e5\u6709\u8005\u7684User ID</li> <li>\u6587\u4ef6\u7684Group ID</li> <li>\u6587\u4ef6\u7684\u8bfb\u3001\u5199\u3001\u6267\u884c\u6743\u9650</li> <li>\u6587\u4ef6\u7684\u65f6\u95f4\u6233\uff0c\u5171\u6709\u4e09\u4e2a\uff1actime\u6307inode\u4e0a\u4e00\u6b21\u53d8\u52a8\u7684\u65f6\u95f4\uff0cmtime\u6307\u6587\u4ef6\u5185\u5bb9\u4e0a\u4e00\u6b21\u53d8\u52a8\u7684\u65f6\u95f4\uff0catime\u6307\u6587\u4ef6\u4e0a\u4e00\u6b21\u6253\u5f00\u7684\u65f6\u95f4\u3002</li> <li>\u94fe\u63a5\u6570\uff0c\u5373\u6709\u591a\u5c11\u6587\u4ef6\u540d\u6307\u5411\u8fd9\u4e2ainode</li> <li>\u6587\u4ef6\u6570\u636eblock\u7684\u4f4d\u7f6e</li> <li>inode\u7f16\u53f7</li> </ul>"},{"location":"chap7/my/#_2","title":"\u76d1\u542c\u7aef\u53e3","text":"<p>\u4fa6\u542c\u7aef\u53e3\u662f\u5e94\u7528\u7a0b\u5e8f\u6216\u8fdb\u7a0b\u5728\u5176\u4e0a\u4fa6\u542c\u7684\u7f51\u7edc\u7aef\u53e3\uff0c\u5145\u5f53\u901a\u4fe1\u7aef\u70b9\u3002</p> <p>\u6bcf\u4e2a\u76d1\u542c\u7aef\u53e3\u90fd\u53ef\u4ee5\u4f7f\u7528\u9632\u706b\u5899\u6253\u5f00\u6216\u5173\u95ed\uff08\u8fc7\u6ee4\uff09\u3002\u4e00\u822c\u800c\u8a00\uff0c\u5f00\u653e\u7aef\u53e3\u662f\u4e00\u4e2a\u7f51\u7edc\u7aef\u53e3\uff0c\u5b83\u63a5\u53d7\u6765\u81ea\u8fdc\u7a0b\u4f4d\u7f6e\u7684\u4f20\u5165\u6570\u636e\u5305\u3002</p> <pre><code>sudo netstat -tunlp\n</code></pre> <p>\u7b80\u8ff0 HTTPS \u7684\u52a0\u5bc6\u4e0e\u8ba4\u8bc1\u8fc7\u7a0b</p>"},{"location":"chap7/my/#git-flow","title":"Git flow","text":"<p>git cherry pick</p> <p>Git flow   /   github flow / giltab flow</p>"},{"location":"chap7/my/#others","title":"Others","text":""},{"location":"chap7/my/#in-the-past-what-was-the-best-implementation-or-debugging-you-did","title":"In the past, what was the best implementation or debugging you did?","text":"<p>By asking this question, the hiring manager will get an idea of the type and complexity of past projects you have completed. You should clearly state the problems you encountered and the steps you took to overcome them. In addition, you can talk about the lessons you learned from the issue.</p>"},{"location":"chap7/my/#database","title":"DataBase","text":"<ul> <li> <p>\u8bf7\u63cf\u8ff0MySQL \u4e2d \u51e0\u79cdjoin\u7684\u65b9\u5f0f\uff1f join \u4e0e left join \u7684\u533a\u522b\u662f\u4ec0\u4e48</p> <ul> <li>left join: </li> <li>join(inner join):</li> </ul> </li> </ul> <p>\u5982\u4f55\u663e\u793a\u524d50\u884c\uff1f</p> <p>\u5728Mysql\u4e2d\uff0c\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801\u67e5\u8be2\u663e\u793a\u524d50\u884c\uff1a</p> <p><code>SELECT * FROM LIMIT 0,50;</code></p> <p>\u5b9e\u8df5\u4e2d\u5982\u4f55\u4f18\u5316MySQL</p> <p>\u6700\u597d\u662f\u6309\u7167\u4ee5\u4e0b\u987a\u5e8f\u4f18\u5316\uff1a</p> <ul> <li>1.SQL\u8bed\u53e5\u53ca\u7d22\u5f15\u7684\u4f18\u5316</li> <li> <ol> <li>\u6570\u636e\u5e93\u8868\u7ed3\u6784\u7684\u4f18\u5316</li> </ol> </li> <li>3.\u7cfb\u7edf\u914d\u7f6e\u7684\u4f18\u5316</li> <li> <p>4.\u786c\u4ef6\u7684\u4f18\u5316</p> </li> <li> <p>\u805a\u7c07(cu)\u7d22\u5f15\u548c\u975e\u805a\u7c07(cu 4)\u7d22\u5f15\u6709\u4ec0\u4e48\u533a\u522b\uff1f</p> </li> </ul> <p>\u4e3b\u952e\u7d22\u5f15\u53eb\u505a\u201c\u805a\u96c6\u7d22\u5f15\u201d\uff0c\u5176\u4ed6\u7d22\u5f15\u53eb\u505a\u201c\u975e\u805a\u96c6\u7d22\u5f15\u201d\u3002\u540e\u8005\u901a\u8fc7\u7d22\u5f15\u8bb0\u5f55\u503c\u627e\u5230\u4e3b\u952e\uff0c\u968f\u540e\u518d\u901a\u8fc7\u805a\u96c6\u7d22\u5f15\u627e\u5230\u5bf9\u5e94\u7684\u8bb0\u5f55\u3002\u56e0\u6b64\u201c\u805a\u96c6\u7d22\u5f15\uff08\u4e3b\u952e\uff09\u662f\u901a\u5f80\u771f\u5b9e\u6570\u636e\u6240\u5728\u7684\u552f\u4e00\u8def\u5f84\u201d</p> <p>\u805a\u7c07\u7d22\u5f15\u4e0e\u975e\u805a\u7c07\u7d22\u5f15\u7684\u533a\u522b</p> <p>\u805a\u7c07\u7d22\u5f15\u662f\u5c06\u7d22\u5f15\u548c\u6574\u6761\u8bb0\u5f55\u5b58\u653e\u5728\u4e00\u8d77\uff0c\u627e\u5230\u7d22\u5f15\u5c31\u627e\u5230\u4e86\u8bb0\u5f55\uff1b \u975e\u805a\u7c07\u7d22\u5f15\u53ea\u5b58\u50a8\u7d22\u5f15\u5b57\u6bb5\u548c\u8bb0\u5f55\u6240\u5728\u7684\u4f4d\u7f6e\uff0c\u901a\u8fc7\u7d22\u5f15\u627e\u5230\u8bb0\u5f55\u6240\u5728\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u518d\u6839\u636e\u8bb0\u5f55\u6240\u5728\u4f4d\u7f6e\u53bb\u83b7\u53d6\u8bb0\u5f55\u3002</p> <p>\u4e00\u822c\u6765\u8bb2\u4e00\u5806\u6570\u636e\u8bb0\u5f55\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a\u805a\u7c07\u7d22\u5f15\uff0c\u4f46\u53ef\u4ee5\u6709\u5f88\u591a\u975e\u805a\u7c07\u7d22\u5f15\uff1b</p> <p>\u4e24\u8005\u7684\u4f18\u7f3a\u70b9\u5bf9\u6bd4</p> <ul> <li>\u805a\u7c07\u7d22\u5f15\u7684\u67e5\u627e\u8bb0\u5f55\u8981\u6bd4\u975e\u805a\u7c07\u7d22\u5f15\u5757\uff0c\u56e0\u4e3a\u805a\u7c07\u7d22\u5f15\u67e5\u627e\u5230\u7d22\u5f15\u5c31\u67e5\u627e\u5230\u4e86\u6570\u636e\u4f4d\u7f6e\uff0c\u800c\u975e\u805a\u7c07\u7d22\u5f15\u67e5\u627e\u5230\u7d22\u5f15\u4e4b\u540e\uff0c\u6839\u636e\u8bb0\u5f55\u7684\u6570\u636e\u5730\u5740\uff0c\u518d\u53bb\u67e5\u627e\u6570\u636e\uff1b</li> <li>\u4e00\u4e2a\u6570\u636e\u8868\u53ea\u80fd\u6709\u4e00\u4e2a\u805a\u7c07\u7d22\u5f15\uff0c\u4f46\u53ef\u4ee5\u6709\u591a\u4e2a\u975e\u805a\u7c07\u7d22\u5f15\uff1b</li> <li>\u805a\u7c07\u7d22\u5f15\u548c\u975e\u805a\u7c07\u7d22\u5f15\u90fd\u53ef\u4ee5\u52a0\u5feb\u67e5\u8be2\u901f\u5ea6\uff0c\u4f46\u540c\u65f6\u4e5f\u90fd\u5bf9\u5199\u5165\u901f\u5ea6\u4f1a\u6709\u5f71\u54cd\uff1b\u805a\u7c07\u7d22\u5f15\u5bf9\u5199\u5165\u7684\u901f\u5ea6\u5f71\u54cd\u66f4\u5927\u4e00\u4e9b\uff1b</li> </ul> <p>\u4e24\u8005\u4f7f\u7528\u573a\u666f</p> <p>InnoDB\u7684\u4e3b\u952e\u4f7f\u7528\u7684\u90fd\u662f\u805a\u7c07\u7d22\u5f15\uff0c\u800cMyASM\u65e0\u8bba\u662f\u4e3b\u952e\u7d22\u5f15\u8fd8\u662f\u4e8c\u7ea7\u7d22\u5f15\uff0c\u4f7f\u7528\u7684\u90fd\u662f\u975e\u805a\u7c07\u7d22\u5f15\u3002</p>"},{"location":"chap7/my/#_3","title":"\u6570\u636e\u5e93\u4e2d\u7684\u4e8b\u52a1\u662f\u4ec0\u4e48?","text":"<p>\u4e8b\u52a1\uff08transaction\uff09\u662f\u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u7684\u4e00\u7ec4\u6709\u5e8f\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u3002\u5982\u679c\u7ec4\u4e2d\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u6210\u529f\uff0c\u5219\u8ba4\u4e3a\u4e8b\u52a1\u6210\u529f\uff0c\u5373\u4f7f\u53ea\u6709\u4e00\u4e2a\u64cd\u4f5c\u5931\u8d25\uff0c\u4e8b\u52a1\u4e5f\u4e0d\u6210\u529f\u3002\u5982\u679c\u6240\u6709\u64cd\u4f5c\u5b8c\u6210\uff0c\u4e8b\u52a1\u5219\u63d0\u4ea4\uff0c\u5176\u4fee\u6539\u5c06\u4f5c\u7528\u4e8e\u6240\u6709\u5176\u4ed6\u6570\u636e\u5e93\u8fdb\u7a0b\u3002\u5982\u679c\u4e00\u4e2a\u64cd\u4f5c\u5931\u8d25\uff0c\u5219\u4e8b\u52a1\u5c06\u56de\u6eda\uff0c\u8be5\u4e8b\u52a1\u6240\u6709\u64cd\u4f5c\u7684\u5f71\u54cd\u90fd\u5c06\u53d6\u6d88\u3002</p> <p>\u4e8b\u52a1\u7279\u6027\uff1a</p> <ul> <li>\uff081\uff09\u539f\u5b50\u6027\uff1a\u5373\u4e0d\u53ef\u5206\u5272\u6027\uff0c\u4e8b\u52a1\u8981\u4e48\u5168\u90e8\u88ab\u6267\u884c\uff0c\u8981\u4e48\u5c31\u5168\u90e8\u4e0d\u88ab\u6267\u884c\u3002</li> <li>\uff082\uff09\u4e00\u81f4\u6027\u6216\u53ef\u4e32\u6027\u3002\u4e8b\u52a1\u7684\u6267\u884c\u4f7f\u5f97\u6570\u636e\u5e93\u4ece\u4e00\u79cd\u6b63\u786e\u72b6\u6001\u8f6c\u6362\u6210\u53e6\u4e00\u79cd\u6b63\u786e\u72b6\u6001</li> <li>\uff083\uff09\u9694\u79bb\u6027\u3002\u5728\u4e8b\u52a1\u6b63\u786e\u63d0\u4ea4\u4e4b\u524d\uff0c\u4e0d\u5141\u8bb8\u628a\u8be5\u4e8b\u52a1\u5bf9\u6570\u636e\u7684\u4efb\u4f55\u6539\u53d8\u63d0\u4f9b\u7ed9\u4efb\u4f55\u5176\u4ed6\u4e8b\u52a1\uff0c</li> <li>\uff084\uff09 \u6301\u4e45\u6027\u3002\u4e8b\u52a1\u6b63\u786e\u63d0\u4ea4\u540e\uff0c\u5176\u7ed3\u679c\u5c06\u6c38\u4e45\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u5373\u4f7f\u5728\u4e8b\u52a1\u63d0\u4ea4\u540e\u6709\u4e86\u5176\u4ed6\u6545\u969c\uff0c\u4e8b\u52a1\u7684\u5904\u7406\u7ed3\u679c\u4e5f\u4f1a\u5f97\u5230\u4fdd\u5b58\u3002</li> </ul> <p>SQL\u6ce8\u5165\u6f0f\u6d1e\u4ea7\u751f\u7684\u539f\u56e0\uff1f\u5982\u4f55\u9632\u6b62\uff1f</p> <p>SQL\u6ce8\u5165\u4ea7\u751f\u7684\u539f\u56e0\uff1a\u7a0b\u5e8f\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u4e0d\u6ce8\u610f\u89c4\u8303\u4e66\u5199sql\u8bed\u53e5\u548c\u5bf9\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7\u5168\u5c40\u53d8\u91cfPOST\u548cGET\u63d0\u4ea4\u4e00\u4e9bsql\u8bed\u53e5\u6b63\u5e38\u6267\u884c\u3002</p> <p>\u9632\u6b62SQL\u6ce8\u5165\u7684\u65b9\u5f0f\uff1a</p> <ul> <li>\u5f00\u542f\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684<code>magic_quotes_gpc</code> \u548c  <code>magic_quotes_runtime</code>\u8bbe\u7f6e</li> <li>\u6267\u884csql\u8bed\u53e5\u65f6\u4f7f\u7528addslashes\u8fdb\u884csql\u8bed\u53e5\u8f6c\u6362</li> <li>Sql\u8bed\u53e5\u4e66\u5199\u5c3d\u91cf\u4e0d\u8981\u7701\u7565\u53cc\u5f15\u53f7\u548c\u5355\u5f15\u53f7\u3002</li> <li>\u8fc7\u6ee4\u6389sql\u8bed\u53e5\u4e2d\u7684\u4e00\u4e9b\u5173\u952e\u8bcd\uff1aupdate\u3001insert\u3001delete\u3001select</li> </ul> <p>\u63d0\u9ad8\u6570\u636e\u5e93\u8868\u548c\u5b57\u6bb5\u7684\u547d\u540d\u6280\u5de7\uff0c\u5bf9\u4e00\u4e9b\u91cd\u8981\u7684\u5b57\u6bb5\u6839\u636e\u7a0b\u5e8f\u7684\u7279\u70b9\u547d\u540d\uff0c\u53d6\u4e0d\u6613\u88ab\u731c\u5230\u7684\u3002</p> <p>\u80fd\u4e0d\u80fd\u7b80\u8ff0\u4e00\u4e0b\u4ec0\u4e48\u662f\u884c\u7ea7\u9501\u548c\u8868\u7ea7\u9501\uff0c\u5404\u81ea\u6709\u4ec0\u4e48\u7279\u70b9\uff1f</p> <ul> <li>\u8868\u7ea7\u9501\uff1a\u5f00\u9500\u5c0f\uff0c\u52a0\u9501\u5feb\uff1b\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u5927\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u9ad8\uff0c\u5e76\u53d1\u5ea6\u6700\u4f4e\uff1b</li> <li>\u884c\u7ea7\u9501\uff1a\u5f00\u9500\u5927\uff0c\u52a0\u9501\u6162\uff1b\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u6700\u5c0f\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u4f4e\uff0c\u5e76\u53d1\u5ea6\u4e5f\u6700\u9ad8\uff1b    </li> </ul> <p>\u67e5\u770b\u4e8c\u8fdb\u5236\u65e5\u5fd7\u5de5\u4f5c\u6a21\u5f0f</p> <ul> <li>ROW: \u57fa\u4e8e\u884c\u7684\u590d\u5236</li> <li>Statement: \u57fa\u4e8esql\u8bed\u53e5\u7684\u590d\u5236</li> <li>mixed\u6a21\u5f0f \uff1arow \u4e0e statement \u7ed3\u5408</li> </ul>"},{"location":"chap7/my/#_4","title":"\u4ec0\u4e48\u60c5\u51b5\u4e0b\u4f1a\u9020\u6210\u6570\u636e\u5e93\u6b7b\u9501\uff1f","text":"<p>\u5f53\u591a\u4e2a\u4e8b\u52a1\u8bd5\u56fe\u4ee5\u4e0d\u540c\u7684\u987a\u5e8f\u9501\u5b9a\u8d44\u6e90\u65f6\uff0c\u5c31\u53ef\u80fd\u4f1a\u4ea7\u751f\u6b7b\u9501\u3002</p> <ul> <li>\u56fe\u4e00\u4e2d\uff0c\u6709\u4e24\u4e2a\u4e8b\u52a1A\u4e0eB\uff0c\u4e8b\u52a1A\u4e0eB\u540c\u65f6\u6267\u884csql1\uff0c\u5219\u4e8b\u52a1A\u4f1a\u9501\u4f4f\u8bb0\u5f55B\uff1b</li> <li>\u4e8b\u52a1B\u4f1a\u9501\u4f4f\u8bb0\u5f55A\uff0c\u4e24\u6761\u8bb0\u5f55\u540c\u65f6\u88ab\u9501\u4f4f\u3002\u63a5\u4e0b\u6765\u4e8b\u52a1A\u6267\u884csql2\uff0c\u53d1\u73b0\u8bb0\u5f55A\u88ab\u4e8b\u52a1B\u9501\u4f4f\uff0c\u4e8b\u52a1B\u6267\u884csql2\u53d1\u73b0\u8bb0\u5f55B\u88ab\u4e8b\u52a1A\u9501\u4f4f\uff0c\u9677\u5165\u6b7b\u5faa\u73af\uff0c\u4ea7\u751f\u6b7b\u9501\u3002</li> </ul> <p>PostgreSQL Interview Questions 2022</p>"},{"location":"chap8/0shell_cmd/","title":"0 Shell\u547d\u4ee4\u884c\u4e00\u4e9b\u5feb\u6377\u952e\u7ec4\u5408","text":"<p>\u4f5c\u4e3a\u4e00\u4e2a\u8fd0\u7ef4\u4eba\u5458\uff0c\u6bcf\u5929\u662f\u80af\u5b9a\u4f1a\u6572\u5f88\u591a\u547d\u4ee4\uff0c\u5076\u5c14\u4e5f\u4f1a\u4e0d\u53ef\u907f\u514d\u7684\u4f1a\u6572\u9519\uff0c\u5f97\u56de\u8fc7\u5934\u53bb\u4fee\u6539\uff0c\u5982\u4f55\u63d0\u9ad8\u4e0b\u4fee\u6539\u7684\u6548\u7387\u5462\uff0c\u5728Shell\u7ec8\u7aef\u547d\u4ee4\u884c\u6709\u4e00\u4e9bCtrl\u548c\u5b57\u6bcd\u7684\u7ec4\u5408\u952e\uff0c\u7f57\u5217\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u5982\u4e0b\uff1a</p> <ul> <li><code>Ctrl + U</code>  \u5220\u9664\u4ece\u5149\u6807\u81f3\u884c\u9996\u7684\u5185\u5bb9\uff0c\u8fd9\u4e2a\u6bd4\u8f83\u9002\u5408\u6211\u4eec\u5728shell\u73af\u5883\u8f93\u5165\u5bc6\u7801\u7684\u65f6\u5019\uff0c\u4e0d\u5c0f\u5fc3\u8f93\u5165\u9519\u8bef\uff0c\u53ef\u4ee5\u5220\u9664\u6574\u4e2a\u884c\uff0c\u7136\u540e\u91cd\u65b0\u8f93\u5165\u3002</li> <li><code>Ctrl + K</code>   \u5220\u9664\u4ece\u5149\u6807\u81f3\u884c\u5c3e\u7684\u5185\u5bb9\u3002</li> <li><code>Ctrl + A</code>   \u79fb\u52a8\u5149\u6807\u81f3\u884c\u9996\u3002\uff08\u952e\u76d8Home\u952e\u4e5f\u53ef\u4ee5\u540c\u6837\u6548\u679c\uff09</li> <li><code>Ctrl + E</code>   \u79fb\u52a8\u5149\u6807\u81f3\u884c\u5c3e\u3002\uff08\u952e\u76d8End\u952e\u4e5f\u53ef\u4ee5\u540c\u6837\u6548\u679c\uff09</li> <li><code>Ctrl + W</code>  \u5220\u9664\u5149\u6807\u524d\u4e00\u4e2a\u8bcd\u3002</li> <li><code>Ctrl + Y</code>   \u7c98\u8d34\u5df2\u5220\u9664\u7684\u6587\u672c\u3002\uff08\u4f8b\u5982\u7c98\u8d34Ctrl + U\u6240\u5220\u9664\u7684\u5185\u5bb9\uff09</li> <li><code>Ctrl + \u2190</code>  \u5f53\u524d\u5149\u6807\u5de6\u79fb\u4e00\u4e2a\u8bcd\u3002</li> <li><code>Ctrl + \u2192</code>  \u5149\u6807\u53f3\u79fb\u4e00\u4e2a\u8bcd\u3002</li> <li><code>\u2191</code>   \u67e5\u770b\u4e0a\u4e00\u4e2a\u547d\u4ee4\u3002</li> <li><code>\u2193</code>   \u67e5\u770b\u4e0b\u4e00\u4e2a\u547d\u4ee4\u3002</li> </ul>"},{"location":"chap8/0shell_linux/","title":"0 Linux\u5e38\u7528\u547d\u4ee4","text":""},{"location":"chap8/0shell_linux/#_1","title":"\u57fa\u672c\u64cd\u4f5c","text":"<p>Linux \u5173\u673a,\u91cd\u542f</p> <pre><code># \u5173\u673a\nshutdown -h now\n\n# \u91cd\u542f\nshutdown -r now\n</code></pre> <p>\u67e5\u770b\u7cfb\u7edf,CPU\u4fe1\u606f</p> <pre><code># \u67e5\u770b\u7cfb\u7edf\u5185\u6838\u4fe1\u606f\nuname -a\n\n# \u67e5\u770b\u7cfb\u7edf\u5185\u6838\u7248\u672c\ncat /proc/version\n\n# \u67e5\u770b\u5f53\u524d\u7528\u6237\u73af\u5883\u53d8\u91cf\nenv\n\n# \u67e5\u770b\u6709\u51e0\u4e2a\u903b\u8f91cpu, \u5305\u62eccpu\u578b\u53f7\ncat /proc/cpuinfo\n\ncat /proc/cpuinfo | grep name | cut -f2 -d: | uniq -c\n\n# \u67e5\u770b\u6709\u51e0\u9897cpu,\u6bcf\u9897\u5206\u522b\u662f\u51e0\u6838\ncat /proc/cpuinfo | grep physical | uniq -c\n\n# \u67e5\u770b\u5f53\u524dCPU\u8fd0\u884c\u572832bit\u8fd8\u662f64bit\u6a21\u5f0f\u4e0b, \u5982\u679c\u662f\u8fd0\u884c\u572832bit\u4e0b\u4e5f\u4e0d\u4ee3\u8868CPU\u4e0d\u652f\u630164bit\ngetconf LONG_BIT\n\n# \u7ed3\u679c\u5927\u4e8e0, \u8bf4\u660e\u652f\u630164bit\u8ba1\u7b97. lm\u6307long mode, \u652f\u6301lm\u5219\u662f64bit\ncat /proc/cpuinfo | grep flags | grep ' lm ' | wc -l\n</code></pre> <p>\u5efa\u7acb\u8f6f\u8fde\u63a5</p> <pre><code>ln -s /usr/local/jdk1.8/ jdk\n</code></pre> <p>rpm\u76f8\u5173</p> <pre><code># \u67e5\u770b\u662f\u5426\u901a\u8fc7rpm\u5b89\u88c5\u4e86\u8be5\u8f6f\u4ef6\nrpm -qa | grep \u8f6f\u4ef6\u540d\n</code></pre> <p>sshkey</p> <pre><code># \u521b\u5efasshkey\nssh-keygen -t rsa -C your_email@example.com\n\n#id_rsa.pub \u7684\u5185\u5bb9\u62f7\u8d1d\u5230\u8981\u63a7\u5236\u7684\u670d\u52a1\u5668\u7684 home/username/.ssh/authorized_keys \u4e2d,\u5982\u679c\u6ca1\u6709\u5219\u65b0\u5efa(.ssh\u6743\u9650\u4e3a700, authorized_keys\u6743\u9650\u4e3a600)\n</code></pre> <p>\u547d\u4ee4\u91cd\u547d\u540d</p> <pre><code># \u5728\u5404\u4e2a\u7528\u6237\u7684.bash_profile\u4e2d\u6dfb\u52a0\u91cd\u547d\u540d\u914d\u7f6e\nalias ll='ls -alF'\n</code></pre> <p>\u540c\u6b65\u670d\u52a1\u5668\u65f6\u95f4</p> <pre><code>sudo ntpdate -u ntp.api.bz\n</code></pre> <p>\u540e\u53f0\u8fd0\u884c\u547d\u4ee4</p> <pre><code># \u540e\u53f0\u8fd0\u884c,\u5e76\u4e14\u6709nohup.out\u8f93\u51fa\nnohup xxx &amp;\n\n# \u540e\u53f0\u8fd0\u884c, \u4e0d\u8f93\u51fa\u4efb\u4f55\u65e5\u5fd7\nnohup xxx &gt; /dev/null &amp;\n\n# \u540e\u53f0\u8fd0\u884c, \u5e76\u5c06\u9519\u8bef\u4fe1\u606f\u505a\u6807\u51c6\u8f93\u51fa\u5230\u65e5\u5fd7\u4e2d \nnohup xxx &gt;out.log 2&gt;&amp;1 &amp;\n</code></pre> <p>\u5f3a\u5236\u6d3b\u52a8\u7528\u6237\u9000\u51fa</p> <pre><code># \u547d\u4ee4\u6765\u5b8c\u6210\u5f3a\u5236\u6d3b\u52a8\u7528\u6237\u9000\u51fa.\u5176\u4e2dTTY\u8868\u793a\u7ec8\u7aef\u540d\u79f0\npkill -kill -t [TTY]\n</code></pre> <p>\u67e5\u770b\u547d\u4ee4\u8def\u5f84</p> <pre><code>which &lt;\u547d\u4ee4&gt;\n</code></pre> <p>\u67e5\u770b\u8fdb\u7a0b\u6240\u6709\u6253\u5f00\u6700\u5927fd\u6570</p> <pre><code>ulimit -n\n</code></pre> <p>\u914d\u7f6edns</p> <pre><code>vim /etc/resolv.conf\n</code></pre> <p>nslookup,\u67e5\u770b\u57df\u540d\u8def\u7531\u8868</p> <pre><code>nslookup google.com\n</code></pre> <p>last, \u6700\u8fd1\u767b\u5f55\u4fe1\u606f\u5217\u8868</p> <pre><code># \u6700\u8fd1\u767b\u5f55\u76845\u4e2a\u8d26\u53f7\nlast -n 5\n</code></pre> <p>\u8bbe\u7f6e\u56fa\u5b9aip</p> <pre><code>ifconfig em1  192.168.5.177 netmask 255.255.255.0\n</code></pre> <p>\u67e5\u770b\u8fdb\u7a0b\u5185\u52a0\u8f7d\u7684\u73af\u5883\u53d8\u91cf</p> <pre><code># \u4e5f\u53ef\u4ee5\u53bb cd /proc \u76ee\u5f55\u4e0b, \u67e5\u770b\u8fdb\u7a0b\u5185\u5b58\u4e2d\u52a0\u8f7d\u7684\u4e1c\u897f\nps eww -p  XXXXX(\u8fdb\u7a0b\u53f7)\n</code></pre> <p>\u67e5\u770b\u8fdb\u7a0b\u6811\u627e\u5230\u670d\u52a1\u5668\u8fdb\u7a0b</p> <pre><code>ps auwxf\n</code></pre> <p>\u67e5\u770b\u8fdb\u7a0b\u542f\u52a8\u8def\u5f84</p> <pre><code>cd /proc/xxx(\u8fdb\u7a0b\u53f7)\nls -all\n# cwd\u5bf9\u5e94\u7684\u662f\u542f\u52a8\u8def\u5f84\n</code></pre> <p>\u6dfb\u52a0\u7528\u6237, \u914d\u7f6esudo\u6743\u9650</p> <pre><code># \u65b0\u589e\u7528\u6237\nuseradd \u7528\u6237\u540d\npasswd \u7528\u6237\u540d\n\n#\u589e\u52a0sudo\u6743\u9650\nvim /etc/sudoers\n# \u4fee\u6539\u6587\u4ef6\u91cc\u9762\u7684\n# root    ALL=(ALL)       ALL\n# \u7528\u6237\u540d ALL=(ALL)       ALL\n</code></pre>"},{"location":"chap8/0shell_linux/#xxx","title":"\u5f3a\u5236\u5173\u95ed\u8fdb\u7a0b\u540d\u5305\u542bxxx\u7684\u6240\u6709\u8fdb\u7a0b","text":"<pre><code>ps aux|grep xxx | grep -v grep | awk '{print $2}' | xargs kill -9\n</code></pre>"},{"location":"chap8/0shell_linux/#_2","title":"\u78c1\u76d8,\u6587\u4ef6,\u76ee\u5f55\u76f8\u5173\u64cd\u4f5c","text":""},{"location":"chap8/0shell_linux/#vim","title":"vim\u64cd\u4f5c","text":"<pre><code>#normal\u6a21\u5f0f\u4e0b g\u8868\u793a\u5168\u5c40, x\u8868\u793a\u67e5\u627e\u7684\u5185\u5bb9, y\u8868\u793a\u66ff\u6362\u540e\u7684\u5185\u5bb9\n:%s/x/y/g\n\n#normal\u6a21\u5f0f\u4e0b\n0  # \u5149\u6807\u79fb\u5230\u884c\u9996(\u6570\u5b570)\n$  # \u5149\u6807\u79fb\u81f3\u884c\u5c3e\nshift + g # \u8df3\u5230\u6587\u4ef6\u6700\u540e\ngg # \u8df3\u5230\u6587\u4ef6\u5934\n\n# \u663e\u793a\u884c\u53f7\n:set nu\n\n# \u53bb\u9664\u884c\u53f7\n:set nonu\n\n# \u68c0\u7d22\n/xxx(\u68c0\u7d22\u5185\u5bb9)  # \u4ece\u5934\u68c0\u7d22, \u6309n\u67e5\u627e\u4e0b\u4e00\u4e2a\n?xxx(\u68c0\u7d22\u5185\u5bb9)  # \u4ece\u5c3e\u90e8\u68c0\u7d22\n</code></pre> <p>\u6253\u5f00\u53ea\u8bfb\u6587\u4ef6,\u4fee\u6539\u540e\u9700\u8981\u4fdd\u5b58\u65f6(\u4e0d\u7528\u5207\u6362\u7528\u6237\u5373\u53ef\u4fdd\u5b58\u7684\u65b9\u5f0f)</p> <pre><code># \u5728normal\u6a21\u5f0f\u4e0b\n:w !sudo tee %\n</code></pre> <p>\u67e5\u770b\u78c1\u76d8, \u6587\u4ef6\u76ee\u5f55\u57fa\u672c\u4fe1\u606f</p> <pre><code># \u67e5\u770b\u78c1\u76d8\u6302\u8f7d\u60c5\u51b5\nmount\n\n# \u67e5\u770b\u78c1\u76d8\u5206\u533a\u4fe1\u606f\ndf\n\n# \u67e5\u770b\u76ee\u5f55\u53ca\u5b50\u76ee\u5f55\u5927\u5c0f\ndu -H -h\n\n# \u67e5\u770b\u5f53\u524d\u76ee\u5f55\u4e0b\u5404\u4e2a\u6587\u4ef6, \u6587\u4ef6\u5939\u5360\u4e86\u591a\u5c11\u7a7a\u95f4, \u4e0d\u4f1a\u9012\u5f52\ndu -sh *\n</code></pre> <p>wc\u547d\u4ee4</p> <pre><code># \u67e5\u770b\u6587\u4ef6\u91cc\u6709\u591a\u5c11\u884c\nwc -l filename\n\n# \u770b\u6587\u4ef6\u91cc\u6709\u591a\u5c11\u4e2aword\nwc -w filename\n\n# \u6587\u4ef6\u91cc\u6700\u957f\u7684\u90a3\u4e00\u884c\u662f\u591a\u5c11\u4e2a\u5b57\nwc -L filename\n\n# \u7edf\u8ba1\u5b57\u8282\u6570\nwc -c\n</code></pre>"},{"location":"chap8/0shell_linux/#_3","title":"\u5e38\u7528\u538b\u7f29, \u89e3\u538b\u7f29\u547d\u4ee4","text":"<p>\u538b\u7f29\u547d\u4ee4</p> <pre><code>tar czvf xxx.tar \u538b\u7f29\u76ee\u5f55\n\nzip -r xxx.zip \u538b\u7f29\u76ee\u5f55\n</code></pre> <p>\u89e3\u538b\u7f29\u547d\u4ee4</p> <pre><code>tar zxvf xxx.tar\n\n# \u89e3\u538b\u5230\u6307\u5b9a\u6587\u4ef6\u5939\ntar zxvf xxx.tar -C /xxx/yyy/\n\nunzip xxx.zip\n</code></pre>"},{"location":"chap8/0shell_linux/#_4","title":"\u53d8\u66f4\u6587\u4ef6\u6240\u5c5e\u7528\u6237, \u7528\u6237\u7ec4","text":"<pre><code>chown eagleye.eagleye xxx.log\n</code></pre>"},{"location":"chap8/0shell_linux/#cp-scp-mkdir","title":"cp, scp, mkdir","text":"<pre><code>#\u590d\u5236\ncp xxx.log\n\n# \u590d\u5236\u5e76\u5f3a\u5236\u8986\u76d6\u540c\u540d\u6587\u4ef6\ncp -f xxx.log\n\n# \u590d\u5236\u6587\u4ef6\u5939\ncp -r xxx(\u6e90\u6587\u4ef6\u5939) yyy(\u76ee\u6807\u6587\u4ef6\u5939)\n\n# \u8fdc\u7a0b\u590d\u5236\nscp -P ssh\u7aef\u53e3 username@10.10.10.101:/home/username/xxx /home/xxx\n\n# \u7ea7\u8054\u521b\u5efa\u76ee\u5f55\nmkdir -p /xxx/yyy/zzz\n\n# \u6279\u91cf\u521b\u5efa\u6587\u4ef6\u5939, \u4f1a\u5728test,main\u4e0b\u90fd\u521b\u5efajava, resources\u6587\u4ef6\u5939\nmkdir -p src/{test,main}/{java,resources}\n</code></pre> <p>\u6bd4\u8f83\u4e24\u4e2a\u6587\u4ef6</p> <pre><code>diff -u 1.txt 2.txt\n</code></pre> <p>\u65e5\u5fd7\u8f93\u51fa\u7684\u5b57\u8282\u6570,\u53ef\u4ee5\u7528\u4f5c\u6027\u80fd\u6d4b\u8bd5</p> <pre><code># \u5982\u679c\u505a\u6027\u80fd\u6d4b\u8bd5, \u53ef\u4ee5\u6bcf\u6267\u884c\u4e00\u6b21, \u5f80\u65e5\u5fd7\u91cc\u9762\u8f93\u51fa \u201c.\u201d , \u8fd9\u6837\u65e5\u5fd7\u4e2d\u7684\u5b57\u8282\u6570\u5c31\u662f\u5b9e\u9645\u7684\u6027\u80fd\u6d4b\u8bd5\u8fd0\u884c\u7684\u6b21\u6570, \u8fd8\u53ef\u4ee5\u770b\u89c1\u5b9e\u65f6\u901f\u7387.\ntail -f xxx.log | pv -bt\n</code></pre> <p>\u67e5\u770b, \u53bb\u9664\u7279\u6b8a\u5b57\u7b26</p> <pre><code># \u67e5\u770b\u7279\u6b8a\u5b57\u7b26\ncat -v xxx.sh\n\n# \u53bb\u9664\u7279\u6b8a\u5b57\u7b26\nsed -i 's/^M//g\u2019 env.sh  \u53bb\u9664\u6587\u4ef6\u7684\u7279\u6b8a\u5b57\u7b26, \u6bd4\u5982^M:  \u9700\u8981\u8fd9\u6837\u8f93\u5165: ctrl+v+enter\n</code></pre> <p>\u5904\u7406\u56e0\u7cfb\u7edf\u539f\u56e0\u5f15\u8d77\u7684\u6587\u4ef6\u4e2d\u7279\u6b8a\u5b57\u7b26\u7684\u95ee\u9898</p> <pre><code># \u53ef\u4ee5\u8f6c\u6362\u4e3a\u8be5\u7cfb\u7edf\u4e0b\u7684\u6587\u4ef6\u683c\u5f0f\ncat file.sh &gt; file.sh_bak\n\n# \u5148\u5c06file.sh\u4e2d\u6587\u4ef6\u5185\u5bb9\u590d\u5236\u4e0b\u6765\u7136\u540e\u8fd0\u884c, \u7136\u540e\u7c98\u8d34\u5185\u5bb9, \u6700\u540ectrl + d \u4fdd\u5b58\u9000\u51fa\ncat &gt; file1.sh\n\n# \u5728vim\u4e2d\u901a\u8fc7\u5982\u4e0b\u8bbe\u7f6e\u6587\u4ef6\u7f16\u7801\u548c\u6587\u4ef6\u683c\u5f0f\n:set fileencodings=utf-8 \uff0c\u7136\u540e w \uff08\u5b58\u76d8\uff09\u4e00\u4e0b\u5373\u53ef\u8f6c\u5316\u4e3a utf8 \u683c\u5f0f\uff0c\n:set fileformat=unix\n\n# \u5728mac\u4e0b\u4f7f\u7528dos2unix\u8fdb\u884c\u6587\u4ef6\u683c\u5f0f\u5316\nfind . -name \"*.sh\" | xargs dos2unix\n</code></pre> <p>tee, \u91cd\u5b9a\u5411\u7684\u540c\u65f6\u8f93\u51fa\u5230\u5c4f\u5e55</p> <pre><code>awk \u2018{print $0}\u2019 xxx.log | tee test.log\n</code></pre>"},{"location":"chap8/0shell_linux/#_5","title":"\u68c0\u7d22\u76f8\u5173","text":"<p>grep</p> <pre><code># \u53cd\u5411\u5339\u914d, \u67e5\u627e\u4e0d\u5305\u542bxxx\u7684\u5185\u5bb9\ngrep -v xxx\n\n# \u6392\u9664\u6240\u6709\u7a7a\u884c\ngrep -v '^/pre&gt;\n\n# \u8fd4\u56de\u7ed3\u679c 2,\u5219\u8bf4\u660e\u7b2c\u4e8c\u884c\u662f\u7a7a\u884c\ngrep -n \u201c^$\u201d 111.txt    \n\n# \u67e5\u8be2\u4ee5abc\u5f00\u5934\u7684\u884c\ngrep -n \u201c^abc\u201d 111.txt \n\n# \u540c\u65f6\u5217\u51fa\u8be5\u8bcd\u8bed\u51fa\u73b0\u5728\u6587\u7ae0\u7684\u7b2c\u51e0\u884c\ngrep 'xxx' -n xxx.log\n\n# \u8ba1\u7b97\u4e00\u4e0b\u8be5\u5b57\u4e32\u51fa\u73b0\u7684\u6b21\u6570\ngrep 'xxx' -c xxx.log\n\n# \u6bd4\u5bf9\u7684\u65f6\u5019\uff0c\u4e0d\u8ba1\u8f83\u5927\u5c0f\u5199\u7684\u4e0d\u540c\ngrep 'xxx' -i xxx.log\n</code></pre> <p>awk</p> <pre><code># \u4ee5':' \u4e3a\u5206\u9694\u7b26,\u5982\u679c\u7b2c\u4e94\u57df\u6709user\u5219\u8f93\u51fa\u8be5\u884c\nawk -F ':' '{if ($5 ~ /user/) print $0}' /etc/passwd \n\n# \u7edf\u8ba1\u5355\u4e2a\u6587\u4ef6\u4e2d\u67d0\u4e2a\u5b57\u7b26\uff08\u4e32\uff09(\u4e2d\u6587\u65e0\u6548)\u51fa\u73b0\u7684\u6b21\u6570\nawk -v RS='character' 'END {print --NR}' xxx.txt\n</code></pre> <p>find\u68c0\u7d22\u547d\u4ee4</p> <pre><code># \u5728\u76ee\u5f55\u4e0b\u627e\u540e\u7f00\u662f.mysql\u7684\u6587\u4ef6\nfind /home/eagleye -name '*.mysql' -print\n\n# \u4f1a\u4ece /usr \u76ee\u5f55\u5f00\u59cb\u5f80\u4e0b\u627e\uff0c\u627e\u6700\u8fd13\u5929\u4e4b\u5185\u5b58\u53d6\u8fc7\u7684\u6587\u4ef6\u3002\nfind /usr -atime 3 \u2013print\n\n# \u4f1a\u4ece /usr \u76ee\u5f55\u5f00\u59cb\u5f80\u4e0b\u627e\uff0c\u627e\u6700\u8fd15\u5929\u4e4b\u5185\u4fee\u6539\u8fc7\u7684\u6587\u4ef6\u3002\nfind /usr -ctime 5 \u2013print\n\n# \u4f1a\u4ece /doc \u76ee\u5f55\u5f00\u59cb\u5f80\u4e0b\u627e\uff0c\u627ejacky \u7684\u3001\u6587\u4ef6\u540d\u5f00\u5934\u662f j\u7684\u6587\u4ef6\u3002  \nfind /doc -user jacky -name 'j*' \u2013print\n\n# \u4f1a\u4ece /doc \u76ee\u5f55\u5f00\u59cb\u5f80\u4e0b\u627e\uff0c\u627e\u5bfb\u6587\u4ef6\u540d\u662f ja \u5f00\u5934\u6216\u8005 ma\u5f00\u5934\u7684\u6587\u4ef6\u3002\nfind /doc \\( -name 'ja*' -o- -name 'ma*' \\) \u2013print\n\n#  \u4f1a\u4ece /doc \u76ee\u5f55\u5f00\u59cb\u5f80\u4e0b\u627e\uff0c\u627e\u5230\u51e1\u662f\u6587\u4ef6\u540d\u7ed3\u5c3e\u4e3a bak\u7684\u6587\u4ef6\uff0c\u628a\u5b83\u5220\u9664\u6389\u3002-exec \u9009\u9879\u662f\u6267\u884c\u7684\u610f\u601d\uff0crm \u662f\u5220\u9664\u547d\u4ee4\uff0c{ } \u8868\u793a\u6587\u4ef6\u540d\uff0c\u201c\\;\u201d\u662f\u89c4\u5b9a\u7684\u547d\u4ee4\u7ed3\u5c3e\u3002 \nfind /doc -name '*bak' -exec rm {} \\;\\\n</code></pre>"},{"location":"chap8/0shell_linux/#_6","title":"\u7f51\u7edc\u76f8\u5173","text":"<p>\u67e5\u770b\u4ec0\u4e48\u8fdb\u7a0b\u4f7f\u7528\u4e86\u8be5\u7aef\u53e3</p> <pre><code>lsof -i:por\n</code></pre> <p>\u83b7\u53d6\u672c\u673aip\u5730\u5740</p> <pre><code>/sbin/ifconfig -a|grep inet|grep -v 127.0.0.1|grep -v inet6|awk '{print $2}'|tr -d \"addr:\"\n</code></pre>"},{"location":"chap8/0shell_linux/#iptables","title":"iptables","text":"<pre><code># \u67e5\u770biptables\u72b6\u6001\nservice iptables status\n\n# \u8981\u5c01\u505c\u4e00\u4e2aip\niptables -I INPUT -s ***.***.***.*** -j DROP\n\n# \u8981\u89e3\u5c01\u4e00\u4e2aIP\uff0c\u4f7f\u7528\u4e0b\u9762\u8fd9\u6761\u547d\u4ee4\uff1a\niptables -D INPUT -s ***.***.***.*** -j DROP\n\n\u5907\u6ce8: \u53c2\u6570-I\u662f\u8868\u793aInsert\uff08\u6dfb\u52a0\uff09\uff0c-D\u8868\u793aDelete\uff08\u5220\u9664\uff09\u3002\u540e\u9762\u8ddf\u7684\u662f\u89c4\u5219\uff0cINPUT\u8868\u793a\u5165\u7ad9\uff0c***.***.***.***\u8868\u793a\u8981\u5c01\u505c\u7684IP\uff0cDROP\u8868\u793a\u653e\u5f03\u8fde\u63a5\u3002\n\n#\u5f00\u542f9090\u7aef\u53e3\u7684\u8bbf\u95ee\n/sbin/iptables -I INPUT -p tcp --dport 9090 -j ACCEPT \n\n# \u9632\u706b\u5899\u5f00\u542f\u3001\u5173\u95ed\u3001\u91cd\u542f\n/etc/init.d/iptables status\n/etc/init.d/iptables start\n/etc/init.d/iptables stop\n/etc/init.d/iptables restart\n</code></pre> <p>nc\u547d\u4ee4, tcp\u8c03\u8bd5\u5229\u5668</p> <pre><code>#\u7ed9\u67d0\u4e00\u4e2aendpoint\u53d1\u9001TCP\u8bf7\u6c42,\u5c31\u5c06data\u7684\u5185\u5bb9\u53d1\u9001\u5230\u5bf9\u7aef\nnc 192.168.0.11 8000 &lt; data.txt\n\n#nc\u53ef\u4ee5\u5f53\u505a\u670d\u52a1\u5668\uff0c\u76d1\u542c\u67d0\u4e2a\u7aef\u53e3\u53f7,\u628a\u67d0\u4e00\u6b21\u8bf7\u6c42\u7684\u5185\u5bb9\u5b58\u50a8\u5230received_data\u91cc\nnc -l 8000 &gt; received_data\n\n#\u4e0a\u8fb9\u53ea\u76d1\u542c\u4e00\u6b21\uff0c\u5982\u679c\u591a\u6b21\u53ef\u4ee5\u52a0\u4e0a-k\u53c2\u6570\nnc -lk 8000\n</code></pre>"},{"location":"chap8/0shell_linux/#tcpdump","title":"tcpdump","text":"<pre><code># dump\u51fa\u672c\u673a12301\u7aef\u53e3\u7684tcp\u5305\ntcpdump -i em1 tcp port 12301 -s 1500 -w abc.pcap\n</code></pre> <p>\u8ddf\u8e2a\u7f51\u7edc\u8def\u7531\u8def\u5f84</p> <pre><code># \u8ddf\u8e2a\u7f51\u7edc\u8def\u7531\u8def\u5f84\n# traceroute\u9ed8\u8ba4\u4f7f\u7528udp\u65b9\u5f0f, \u5982\u679c\u662f-I\u5219\u6539\u6210icmp\u65b9\u5f0f\ntraceroute -I www.163.com\n\n# \u4ecettl\u7b2c3\u8df3\u8ddf\u8e2a\ntraceroute -M 3 www.163.com  \n\n# \u52a0\u4e0a\u7aef\u53e3\u8ddf\u8e2a\ntraceroute -p 8080 192.168.10.11\nss\n# \u663e\u793a\u672c\u5730\u6253\u5f00\u7684\u6240\u6709\u7aef\u53e3\nss -l \n\n# \u663e\u793a\u6bcf\u4e2a\u8fdb\u7a0b\u5177\u4f53\u6253\u5f00\u7684socket\nss -pl \n\n# \u663e\u793a\u6240\u6709tcp socket\nss -t -a \n\n# \u663e\u793a\u6240\u6709\u7684UDP Socekt\nss -u -a \n\n# \u663e\u793a\u6240\u6709\u5df2\u5efa\u7acb\u7684SMTP\u8fde\u63a5\nss -o state established '( dport = :smtp or sport = :smtp )'  \n\n# \u663e\u793a\u6240\u6709\u5df2\u5efa\u7acb\u7684HTTP\u8fde\u63a5 \nss -o state established '( dport = :http or sport = :http )'  \n\n#\u627e\u51fa\u6240\u6709\u8fde\u63a5X\u670d\u52a1\u5668\u7684\u8fdb\u7a0b\nss -x src /tmp/.X11-unix/*  \n\n#\u5217\u51fa\u5f53\u524dsocket\u7edf\u8ba1\u4fe1\u606f\nss -s \n\n\u89e3\u91ca\uff1anetstat\u662f\u904d\u5386/proc\u4e0b\u9762\u6bcf\u4e2aPID\u76ee\u5f55\uff0css\u76f4\u63a5\u8bfb/proc/net\u4e0b\u9762\u7684\u7edf\u8ba1\u4fe1\u606f\u3002\u6240\u4ee5ss\u6267\u884c\u7684\u65f6\u5019\u6d88\u8017\u8d44\u6e90\u4ee5\u53ca\u6d88\u8017\u7684\u65f6\u95f4\u90fd\u6bd4netstat\u5c11\u5f88\u591a\n</code></pre> <p>netstat</p> <pre><code># \u8f93\u51fa\u6bcf\u4e2aip\u7684\u8fde\u63a5\u6570\uff0c\u4ee5\u53ca\u603b\u7684\u5404\u4e2a\u72b6\u6001\u7684\u8fde\u63a5\u6570\nnetstat -n | awk '/^tcp/ {n=split($(NF-1),array,\":\");if(n&lt;=2)++S[array[(1)]];else++S[array[(4)]];++s[$NF];++N} END {for(a in S){printf(\"%-20s %s\\n\", a, S[a]);++I}printf(\"%-20s %s\\n\",\"TOTAL_IP\",I);for(a in s) printf(\"%-20s %s\\n\",a, s[a]);printf(\"%-20s %s\\n\",\"TOTAL_LINK\",N);}'\n\n# \u7edf\u8ba1\u6240\u6709\u8fde\u63a5\u72b6\u6001, \n# CLOSED\uff1a\u65e0\u8fde\u63a5\u662f\u6d3b\u52a8\u7684\u6216\u6b63\u5728\u8fdb\u884c\n# LISTEN\uff1a\u670d\u52a1\u5668\u5728\u7b49\u5f85\u8fdb\u5165\u547c\u53eb\n# SYN_RECV\uff1a\u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42\u5df2\u7ecf\u5230\u8fbe\uff0c\u7b49\u5f85\u786e\u8ba4\n# SYN_SENT\uff1a\u5e94\u7528\u5df2\u7ecf\u5f00\u59cb\uff0c\u6253\u5f00\u4e00\u4e2a\u8fde\u63a5\n# ESTABLISHED\uff1a\u6b63\u5e38\u6570\u636e\u4f20\u8f93\u72b6\u6001\n# FIN_WAIT1\uff1a\u5e94\u7528\u8bf4\u5b83\u5df2\u7ecf\u5b8c\u6210\n# FIN_WAIT2\uff1a\u53e6\u4e00\u8fb9\u5df2\u540c\u610f\u91ca\u653e\n# ITMED_WAIT\uff1a\u7b49\u5f85\u6240\u6709\u5206\u7ec4\u6b7b\u6389\n# CLOSING\uff1a\u4e24\u8fb9\u540c\u65f6\u5c1d\u8bd5\u5173\u95ed\n# TIME_WAIT\uff1a\u4e3b\u52a8\u5173\u95ed\u8fde\u63a5\u4e00\u7aef\u8fd8\u6ca1\u6709\u7b49\u5230\u53e6\u4e00\u7aef\u53cd\u9988\u671f\u95f4\u7684\u72b6\u6001\n# LAST_ACK\uff1a\u7b49\u5f85\u6240\u6709\u5206\u7ec4\u6b7b\u6389\nnetstat -n | awk '/^tcp/ {++state[$NF]} END {for(key in state) print key,\"\\t\",state[key]}'\n\n# \u67e5\u627e\u8f83\u591atime_wait\u8fde\u63a5\nnetstat -n|grep TIME_WAIT|awk '{print $5}'|sort|uniq -c|sort -rn|head -n20\n</code></pre>"},{"location":"chap8/0shell_linux/#linux","title":"\u76d1\u63a7linux\u6027\u80fd\u547d\u4ee4","text":"<p>top</p> <p>\u6309\u5927\u5199\u7684 F \u6216 O \u952e\uff0c\u7136\u540e\u6309 a-z \u53ef\u4ee5\u5c06\u8fdb\u7a0b\u6309\u7167\u76f8\u5e94\u7684\u5217\u8fdb\u884c\u6392\u5e8f, \u7136\u540e\u56de\u8f66\u3002\u800c\u5927\u5199\u7684 R \u952e\u53ef\u4ee5\u5c06\u5f53\u524d\u7684\u6392\u5e8f\u5012\u8f6c\u3002</p> <pre><code>PID \u8fdb\u7a0bid\nPPID \u7236\u8fdb\u7a0bid\nRUSER Real user name\nUID \u8fdb\u7a0b\u6240\u6709\u8005\u7684\u7528\u6237id\nUSER \u8fdb\u7a0b\u6240\u6709\u8005\u7684\u7528\u6237\u540d\nGROUP \u8fdb\u7a0b\u6240\u6709\u8005\u7684\u7ec4\u540d\nTTY \u542f\u52a8\u8fdb\u7a0b\u7684\u7ec8\u7aef\u540d\u3002\u4e0d\u662f\u4ece\u7ec8\u7aef\u542f\u52a8\u7684\u8fdb\u7a0b\u5219\u663e\u793a\u4e3a ?\nPR \u4f18\u5148\u7ea7\nNI nice\u503c\u3002\u8d1f\u503c\u8868\u793a\u9ad8\u4f18\u5148\u7ea7\uff0c\u6b63\u503c\u8868\u793a\u4f4e\u4f18\u5148\u7ea7\nP \u6700\u540e\u4f7f\u7528\u7684CPU\uff0c\u4ec5\u5728\u591aCPU\u73af\u5883\u4e0b\u6709\u610f\u4e49\n%CPU \u4e0a\u6b21\u66f4\u65b0\u5230\u73b0\u5728\u7684CPU\u65f6\u95f4\u5360\u7528\u767e\u5206\u6bd4\nTIME \u8fdb\u7a0b\u4f7f\u7528\u7684CPU\u65f6\u95f4\u603b\u8ba1\uff0c\u5355\u4f4d\u79d2\nTIME+ \u8fdb\u7a0b\u4f7f\u7528\u7684CPU\u65f6\u95f4\u603b\u8ba1\uff0c\u5355\u4f4d1/100\u79d2\n%MEM \u8fdb\u7a0b\u4f7f\u7528\u7684\u7269\u7406\u5185\u5b58\u767e\u5206\u6bd4\nVIRT \u8fdb\u7a0b\u4f7f\u7528\u7684\u865a\u62df\u5185\u5b58\u603b\u91cf\uff0c\u5355\u4f4dkb\u3002VIRT=SWAP+RES\nSWAP \u8fdb\u7a0b\u4f7f\u7528\u7684\u865a\u62df\u5185\u5b58\u4e2d\uff0c\u88ab\u6362\u51fa\u7684\u5927\u5c0f\uff0c\u5355\u4f4dkb\u3002\nRES \u8fdb\u7a0b\u4f7f\u7528\u7684\u3001\u672a\u88ab\u6362\u51fa\u7684\u7269\u7406\u5185\u5b58\u5927\u5c0f\uff0c\u5355\u4f4dkb\u3002RES=CODE+DATA\nCODE \u53ef\u6267\u884c\u4ee3\u7801\u5360\u7528\u7684\u7269\u7406\u5185\u5b58\u5927\u5c0f\uff0c\u5355\u4f4dkb\nDATA \u53ef\u6267\u884c\u4ee3\u7801\u4ee5\u5916\u7684\u90e8\u5206(\u6570\u636e\u6bb5+\u6808)\u5360\u7528\u7684\u7269\u7406\u5185\u5b58\u5927\u5c0f\uff0c\u5355\u4f4dkb\nSHR \u5171\u4eab\u5185\u5b58\u5927\u5c0f\uff0c\u5355\u4f4dkb\nnFLT \u9875\u9762\u9519\u8bef\u6b21\u6570\nnDRT \u6700\u540e\u4e00\u6b21\u5199\u5165\u5230\u73b0\u5728\uff0c\u88ab\u4fee\u6539\u8fc7\u7684\u9875\u9762\u6570\u3002\nS \u8fdb\u7a0b\u72b6\u6001\u3002D=\u4e0d\u53ef\u4e2d\u65ad\u7684\u7761\u7720\u72b6\u6001,R=\u8fd0\u884c,S=\u7761\u7720,T=\u8ddf\u8e2a/\u505c\u6b62,Z=\u50f5\u5c38\u8fdb\u7a0b\nCOMMAND \u547d\u4ee4\u540d/\u547d\u4ee4\u884c\nWCHAN \u82e5\u8be5\u8fdb\u7a0b\u5728\u7761\u7720\uff0c\u5219\u663e\u793a\u7761\u7720\u4e2d\u7684\u7cfb\u7edf\u51fd\u6570\u540d\nFlags \u4efb\u52a1\u6807\u5fd7\uff0c\u53c2\u8003 sched.h\n</code></pre> <p>dmesg,\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7</p> <pre><code>dmesg\n</code></pre> <p>iostat,\u78c1\u76d8IO\u60c5\u51b5\u76d1\u63a7</p> <pre><code>iostat -xz 1\n\n# r/s, w/s, rkB/s, wkB/s\uff1a\u5206\u522b\u8868\u793a\u6bcf\u79d2\u8bfb\u5199\u6b21\u6570\u548c\u6bcf\u79d2\u8bfb\u5199\u6570\u636e\u91cf\uff08\u5343\u5b57\u8282\uff09\u3002\u8bfb\u5199\u91cf\u8fc7\u5927\uff0c\u53ef\u80fd\u4f1a\u5f15\u8d77\u6027\u80fd\u95ee\u9898\u3002\n# await\uff1aIO\u64cd\u4f5c\u7684\u5e73\u5747\u7b49\u5f85\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u6beb\u79d2\u3002\u8fd9\u662f\u5e94\u7528\u7a0b\u5e8f\u5728\u548c\u78c1\u76d8\u4ea4\u4e92\u65f6\uff0c\u9700\u8981\u6d88\u8017\u7684\u65f6\u95f4\uff0c\u5305\u62ecIO\u7b49\u5f85\u548c\u5b9e\u9645\u64cd\u4f5c\u7684\u8017\u65f6\u3002\u5982\u679c\u8fd9\u4e2a\u6570\u503c\u8fc7\u5927\uff0c\u53ef\u80fd\u662f\u786c\u4ef6\u8bbe\u5907\u9047\u5230\u4e86\u74f6\u9888\u6216\u8005\u51fa\u73b0\u6545\u969c\u3002\n# avgqu-sz\uff1a\u5411\u8bbe\u5907\u53d1\u51fa\u7684\u8bf7\u6c42\u5e73\u5747\u6570\u91cf\u3002\u5982\u679c\u8fd9\u4e2a\u6570\u503c\u5927\u4e8e1\uff0c\u53ef\u80fd\u662f\u786c\u4ef6\u8bbe\u5907\u5df2\u7ecf\u9971\u548c\uff08\u90e8\u5206\u524d\u7aef\u786c\u4ef6\u8bbe\u5907\u652f\u6301\u5e76\u884c\u5199\u5165\uff09\u3002\n# %util\uff1a\u8bbe\u5907\u5229\u7528\u7387\u3002\u8fd9\u4e2a\u6570\u503c\u8868\u793a\u8bbe\u5907\u7684\u7e41\u5fd9\u7a0b\u5ea6\uff0c\u7ecf\u9a8c\u503c\u662f\u5982\u679c\u8d85\u8fc760\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cdIO\u6027\u80fd\uff08\u53ef\u4ee5\u53c2\u7167IO\u64cd\u4f5c\u5e73\u5747\u7b49\u5f85\u65f6\u95f4\uff09\u3002\u5982\u679c\u5230\u8fbe100%\uff0c\u8bf4\u660e\u786c\u4ef6\u8bbe\u5907\u5df2\u7ecf\u9971\u548c\u3002\n# \u5982\u679c\u663e\u793a\u7684\u662f\u903b\u8f91\u8bbe\u5907\u7684\u6570\u636e\uff0c\u90a3\u4e48\u8bbe\u5907\u5229\u7528\u7387\u4e0d\u4ee3\u8868\u540e\u7aef\u5b9e\u9645\u7684\u786c\u4ef6\u8bbe\u5907\u5df2\u7ecf\u9971\u548c\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5373\u4f7fIO\u6027\u80fd\u4e0d\u7406\u60f3\uff0c\u4e5f\u4e0d\u4e00\u5b9a\u610f\u5473\u8fd9\u5e94\u7528\u7a0b\u5e8f\u6027\u80fd\u4f1a\u4e0d\u597d\uff0c\u53ef\u4ee5\u5229\u7528\u8bf8\u5982\u9884\u8bfb\u53d6\u3001\u5199\u7f13\u5b58\u7b49\u7b56\u7565\u63d0\u5347\u5e94\u7528\u6027\u80fd\u3002\n</code></pre>"},{"location":"chap8/0shell_linux/#free","title":"free,\u5185\u5b58\u4f7f\u7528\u60c5\u51b5","text":"<pre><code>free -m\n\neg:\n\n     total       used       free     shared    buffers     cached\nMem:          1002        769        232          0         62        421\n-/+ buffers/cache:          286        715\nSwap:          1153          0       1153\n</code></pre> <p>\u7b2c\u4e00\u90e8\u5206Mem\u884c:</p> <pre><code>total \u5185\u5b58\u603b\u6570: 1002M\nused \u5df2\u7ecf\u4f7f\u7528\u7684\u5185\u5b58\u6570: 769M\nfree \u7a7a\u95f2\u7684\u5185\u5b58\u6570: 232M\nshared \u5f53\u524d\u5df2\u7ecf\u5e9f\u5f03\u4e0d\u7528,\u603b\u662f0\nbuffers Buffer \u7f13\u5b58\u5185\u5b58\u6570: 62M\ncached Page \u7f13\u5b58\u5185\u5b58\u6570:421M\n</code></pre> <p>\u5173\u7cfb\uff1atotal(1002M) = used(769M) + free(232M)</p> <p>\u7b2c\u4e8c\u90e8\u5206<code>(-/+ buffers/cache)</code>:</p> <pre><code>(-buffers/cache) used\u5185\u5b58\u6570\uff1a286M (\u6307\u7684\u7b2c\u4e00\u90e8\u5206Mem\u884c\u4e2d\u7684used \u2013 buffers \u2013 cached)\n(+buffers/cache) free\u5185\u5b58\u6570: 715M (\u6307\u7684\u7b2c\u4e00\u90e8\u5206Mem\u884c\u4e2d\u7684free + buffers + cached)\n</code></pre> <p>\u53ef\u89c1<code>-buffers/cache</code>\u53cd\u6620\u7684\u662f\u88ab\u7a0b\u5e8f\u5b9e\u5b9e\u5728\u5728\u5403\u6389\u7684\u5185\u5b58,\u800c<code>+buffers/cache</code>\u53cd\u6620\u7684\u662f\u53ef\u4ee5\u632a\u7528\u7684\u5185\u5b58\u603b\u6570.</p> <p>\u7b2c\u4e09\u90e8\u5206\u662f\u6307\u4ea4\u6362\u5206\u533a</p> <p>sar,\u67e5\u770b\u7f51\u7edc\u541e\u5410\u72b6\u6001</p> <pre><code># sar\u547d\u4ee4\u5728\u8fd9\u91cc\u53ef\u4ee5\u67e5\u770b\u7f51\u7edc\u8bbe\u5907\u7684\u541e\u5410\u7387\u3002\u5728\u6392\u67e5\u6027\u80fd\u95ee\u9898\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbe\u5907\u7684\u541e\u5410\u91cf\uff0c\u5224\u65ad\u7f51\u7edc\u8bbe\u5907\u662f\u5426\u5df2\u7ecf\u9971\u548c\u3002\n\nsar -n DEV 1\n\n#\n# sar\u547d\u4ee4\u5728\u8fd9\u91cc\u7528\u4e8e\u67e5\u770bTCP\u8fde\u63a5\u72b6\u6001\uff0c\u5176\u4e2d\u5305\u62ec\uff1a\n# active/s\uff1a\u6bcf\u79d2\u672c\u5730\u53d1\u8d77\u7684TCP\u8fde\u63a5\u6570\uff0c\u65e2\u901a\u8fc7connect\u8c03\u7528\u521b\u5efa\u7684TCP\u8fde\u63a5\uff1b\n# passive/s\uff1a\u6bcf\u79d2\u8fdc\u7a0b\u53d1\u8d77\u7684TCP\u8fde\u63a5\u6570\uff0c\u5373\u901a\u8fc7accept\u8c03\u7528\u521b\u5efa\u7684TCP\u8fde\u63a5\uff1b\n# retrans/s\uff1a\u6bcf\u79d2TCP\u91cd\u4f20\u6570\u91cf\uff1b\n# TCP\u8fde\u63a5\u6570\u53ef\u4ee5\u7528\u6765\u5224\u65ad\u6027\u80fd\u95ee\u9898\u662f\u5426\u7531\u4e8e\u5efa\u7acb\u4e86\u8fc7\u591a\u7684\u8fde\u63a5\uff0c\u8fdb\u4e00\u6b65\u53ef\u4ee5\u5224\u65ad\u662f\u4e3b\u52a8\u53d1\u8d77\u7684\u8fde\u63a5\uff0c\u8fd8\u662f\u88ab\u52a8\u63a5\u53d7\u7684\u8fde\u63a5\u3002TCP\u91cd\u4f20\u53ef\u80fd\u662f\u56e0\u4e3a\u7f51\u7edc\u73af\u5883\u6076\u52a3\uff0c\u6216\u8005\u670d\u52a1\u5668\u538b\u529b\u8fc7\u5927\u5bfc\u81f4\u4e22\u5305\nsar -n TCP,ETCP 1\n</code></pre> <p>vmstat, \u7ed9\u5b9a\u65f6\u95f4\u76d1\u63a7CPU\u4f7f\u7528\u7387, \u5185\u5b58\u4f7f\u7528, \u865a\u62df\u5185\u5b58\u4ea4\u4e92, IO\u8bfb\u5199</p> <pre><code># 2\u8868\u793a\u6bcf2\u79d2\u91c7\u96c6\u4e00\u6b21\u72b6\u6001\u4fe1\u606f, 1\u8868\u793a\u53ea\u91c7\u96c6\u4e00\u6b21(\u5ffd\u7565\u65e2\u662f\u4e00\u76f4\u91c7\u96c6)\n\nvmstat 2 1\n\neg:\nr b swpd free buff cache si so bi bo in cs us sy id wa\n1 0 0 3499840 315836 3819660 0 0 0 1 2 0 0 0 100 0\n0 0 0 3499584 315836 3819660 0 0 0 0 88 158 0 0 100 0\n0 0 0 3499708 315836 3819660 0 0 0 2 86 162 0 0 100 0\n0 0 0 3499708 315836 3819660 0 0 0 10 81 151 0 0 100 0\n1 0 0 3499732 315836 3819660 0 0 0 2 83 154 0 0 100 0\n</code></pre> <ul> <li>r \u8868\u793a\u8fd0\u884c\u961f\u5217(\u5c31\u662f\u8bf4\u591a\u5c11\u4e2a\u8fdb\u7a0b\u771f\u7684\u5206\u914d\u5230CPU)\uff0c\u6211\u6d4b\u8bd5\u7684\u670d\u52a1\u5668\u76ee\u524dCPU\u6bd4\u8f83\u7a7a\u95f2\uff0c\u6ca1\u4ec0\u4e48\u7a0b\u5e8f\u5728\u8dd1\uff0c\u5f53\u8fd9\u4e2a\u503c\u8d85\u8fc7\u4e86CPU\u6570\u76ee\uff0c\u5c31\u4f1a\u51fa\u73b0CPU\u74f6\u9888\u4e86\u3002\u8fd9\u4e2a\u4e5f\u548ctop\u7684\u8d1f\u8f7d\u6709\u5173\u7cfb\uff0c\u4e00\u822c\u8d1f\u8f7d\u8d85\u8fc7\u4e863\u5c31\u6bd4\u8f83\u9ad8\uff0c\u8d85\u8fc7\u4e865\u5c31\u9ad8\uff0c\u8d85\u8fc7\u4e8610\u5c31\u4e0d\u6b63\u5e38\u4e86\uff0c\u670d\u52a1\u5668\u7684\u72b6\u6001\u5f88\u5371\u9669\u3002top\u7684\u8d1f\u8f7d\u7c7b\u4f3c\u6bcf\u79d2\u7684\u8fd0\u884c\u961f\u5217\u3002\u5982\u679c\u8fd0\u884c\u961f\u5217\u8fc7\u5927\uff0c\u8868\u793a\u4f60\u7684CPU\u5f88\u7e41\u5fd9\uff0c\u4e00\u822c\u4f1a\u9020\u6210CPU\u4f7f\u7528\u7387\u5f88\u9ad8\u3002</li> <li>b \u8868\u793a\u963b\u585e\u7684\u8fdb\u7a0b,\u8fd9\u4e2a\u4e0d\u591a\u8bf4\uff0c\u8fdb\u7a0b\u963b\u585e\uff0c\u5927\u5bb6\u61c2\u7684\u3002</li> <li>swpd \u865a\u62df\u5185\u5b58\u5df2\u4f7f\u7528\u7684\u5927\u5c0f\uff0c\u5982\u679c\u5927\u4e8e0\uff0c\u8868\u793a\u4f60\u7684\u673a\u5668\u7269\u7406\u5185\u5b58\u4e0d\u8db3\u4e86\uff0c\u5982\u679c\u4e0d\u662f\u7a0b\u5e8f\u5185\u5b58\u6cc4\u9732\u7684\u539f\u56e0\uff0c\u90a3\u4e48\u4f60\u8be5\u5347\u7ea7\u5185\u5b58\u4e86\u6216\u8005\u628a\u8017\u5185\u5b58\u7684\u4efb\u52a1\u8fc1\u79fb\u5230\u5176\u4ed6\u673a\u5668\u3002</li> <li>free \u7a7a\u95f2\u7684\u7269\u7406\u5185\u5b58\u7684\u5927\u5c0f\uff0c\u6211\u7684\u673a\u5668\u5185\u5b58\u603b\u51718G\uff0c\u5269\u4f593415M\u3002</li> <li>buff Linux/Unix\u7cfb\u7edf\u662f\u7528\u6765\u5b58\u50a8\uff0c\u76ee\u5f55\u91cc\u9762\u6709\u4ec0\u4e48\u5185\u5bb9\uff0c\u6743\u9650\u7b49\u7684\u7f13\u5b58\uff0c\u6211\u672c\u673a\u5927\u6982\u5360\u7528300\u591aM</li> <li>cache cache\u76f4\u63a5\u7528\u6765\u8bb0\u5fc6\u6211\u4eec\u6253\u5f00\u7684\u6587\u4ef6,\u7ed9\u6587\u4ef6\u505a\u7f13\u51b2\uff0c\u6211\u672c\u673a\u5927\u6982\u5360\u7528300\u591aM(\u8fd9\u91cc\u662fLinux/Unix\u7684\u806a\u660e\u4e4b\u5904\uff0c\u628a\u7a7a\u95f2\u7684\u7269\u7406\u5185\u5b58\u7684\u4e00\u90e8\u5206\u62ff\u6765\u505a\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u7f13\u5b58\uff0c\u662f\u4e3a\u4e86\u63d0\u9ad8 \u7a0b\u5e8f\u6267\u884c\u7684\u6027\u80fd\uff0c\u5f53\u7a0b\u5e8f\u4f7f\u7528\u5185\u5b58\u65f6\uff0cbuffer/cached\u4f1a\u5f88\u5feb\u5730\u88ab\u4f7f\u7528\u3002)</li> <li>si \u6bcf\u79d2\u4ece\u78c1\u76d8\u8bfb\u5165\u865a\u62df\u5185\u5b58\u7684\u5927\u5c0f\uff0c\u5982\u679c\u8fd9\u4e2a\u503c\u5927\u4e8e0\uff0c\u8868\u793a\u7269\u7406\u5185\u5b58\u4e0d\u591f\u7528\u6216\u8005\u5185\u5b58\u6cc4\u9732\u4e86\uff0c\u8981\u67e5\u627e\u8017\u5185\u5b58\u8fdb\u7a0b\u89e3\u51b3\u6389\u3002\u6211\u7684\u673a\u5668\u5185\u5b58\u5145\u88d5\uff0c\u4e00\u5207\u6b63\u5e38\u3002</li> <li>so \u6bcf\u79d2\u865a\u62df\u5185\u5b58\u5199\u5165\u78c1\u76d8\u7684\u5927\u5c0f\uff0c\u5982\u679c\u8fd9\u4e2a\u503c\u5927\u4e8e0\uff0c\u540c\u4e0a\u3002</li> <li>bi \u5757\u8bbe\u5907\u6bcf\u79d2\u63a5\u6536\u7684\u5757\u6570\u91cf\uff0c\u8fd9\u91cc\u7684\u5757\u8bbe\u5907\u662f\u6307\u7cfb\u7edf\u4e0a\u6240\u6709\u7684\u78c1\u76d8\u548c\u5176\u4ed6\u5757\u8bbe\u5907\uff0c\u9ed8\u8ba4\u5757\u5927\u5c0f\u662f1024byte\uff0c\u6211\u672c\u673a\u4e0a\u6ca1\u4ec0\u4e48IO\u64cd\u4f5c\uff0c\u6240\u4ee5\u4e00\u76f4\u662f0\uff0c\u4f46\u662f\u6211\u66fe\u5728\u5904\u7406\u62f7\u8d1d\u5927\u91cf\u6570\u636e(2-3T)\u7684\u673a\u5668\u4e0a\u770b\u8fc7\u53ef\u4ee5\u8fbe\u5230140000/s\uff0c\u78c1\u76d8\u5199\u5165\u901f\u5ea6\u5dee\u4e0d\u591a140M\u6bcf\u79d2</li> <li>bo \u5757\u8bbe\u5907\u6bcf\u79d2\u53d1\u9001\u7684\u5757\u6570\u91cf\uff0c\u4f8b\u5982\u6211\u4eec\u8bfb\u53d6\u6587\u4ef6\uff0cbo\u5c31\u8981\u5927\u4e8e0\u3002bi\u548cbo\u4e00\u822c\u90fd\u8981\u63a5\u8fd10\uff0c\u4e0d\u7136\u5c31\u662fIO\u8fc7\u4e8e\u9891\u7e41\uff0c\u9700\u8981\u8c03\u6574\u3002</li> <li>in \u6bcf\u79d2CPU\u7684\u4e2d\u65ad\u6b21\u6570\uff0c\u5305\u62ec\u65f6\u95f4\u4e2d\u65ad</li> <li>cs \u6bcf\u79d2\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\uff0c\u4f8b\u5982\u6211\u4eec\u8c03\u7528\u7cfb\u7edf\u51fd\u6570\uff0c\u5c31\u8981\u8fdb\u884c\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u7ebf\u7a0b\u7684\u5207\u6362\uff0c\u4e5f\u8981\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u8fd9\u4e2a\u503c\u8981\u8d8a\u5c0f\u8d8a\u597d\uff0c\u592a\u5927\u4e86\uff0c\u8981\u8003\u8651\u8c03\u4f4e\u7ebf\u7a0b\u6216\u8005\u8fdb\u7a0b\u7684\u6570\u76ee,\u4f8b\u5982\u5728apache\u548cnginx\u8fd9\u79cdweb\u670d\u52a1\u5668\u4e2d\uff0c\u6211\u4eec\u4e00\u822c\u505a\u6027\u80fd\u6d4b\u8bd5\u65f6\u4f1a\u8fdb\u884c\u51e0\u5343\u5e76\u53d1\u751a\u81f3\u51e0\u4e07\u5e76\u53d1\u7684\u6d4b\u8bd5\uff0c\u9009\u62e9web\u670d\u52a1\u5668\u7684\u8fdb\u7a0b\u53ef\u4ee5\u7531\u8fdb\u7a0b\u6216\u8005\u7ebf\u7a0b\u7684\u5cf0\u503c\u4e00\u76f4\u4e0b\u8c03\uff0c\u538b\u6d4b\uff0c\u76f4\u5230cs\u5230\u4e00\u4e2a\u6bd4\u8f83\u5c0f\u7684\u503c\uff0c\u8fd9\u4e2a\u8fdb\u7a0b\u548c\u7ebf\u7a0b\u6570\u5c31\u662f\u6bd4\u8f83\u5408\u9002\u7684\u503c\u4e86\u3002\u7cfb\u7edf\u8c03\u7528\u4e5f\u662f\uff0c\u6bcf\u6b21\u8c03\u7528\u7cfb\u7edf\u51fd\u6570\uff0c\u6211\u4eec\u7684\u4ee3\u7801\u5c31\u4f1a\u8fdb\u5165\u5185\u6838\u7a7a\u95f4\uff0c\u5bfc\u81f4\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u8fd9\u4e2a\u662f\u5f88\u8017\u8d44\u6e90\uff0c\u4e5f\u8981\u5c3d\u91cf\u907f\u514d\u9891\u7e41\u8c03\u7528\u7cfb\u7edf\u51fd\u6570\u3002\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\u8fc7\u591a\u8868\u793a\u4f60\u7684CPU\u5927\u90e8\u5206\u6d6a\u8d39\u5728\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u5bfc\u81f4CPU\u5e72\u6b63\u7ecf\u4e8b\u7684\u65f6\u95f4\u5c11\u4e86\uff0cCPU\u6ca1\u6709\u5145\u5206\u5229\u7528\uff0c\u662f\u4e0d\u53ef\u53d6\u7684\u3002</li> <li>us \u7528\u6237CPU\u65f6\u95f4\uff0c\u6211\u66fe\u7ecf\u5728\u4e00\u4e2a\u505a\u52a0\u5bc6\u89e3\u5bc6\u5f88\u9891\u7e41\u7684\u670d\u52a1\u5668\u4e0a\uff0c\u53ef\u4ee5\u770b\u5230us\u63a5\u8fd1100,r\u8fd0\u884c\u961f\u5217\u8fbe\u523080(\u673a\u5668\u5728\u505a\u538b\u529b\u6d4b\u8bd5\uff0c\u6027\u80fd\u8868\u73b0\u4e0d\u4f73)\u3002</li> <li>sy \u7cfb\u7edfCPU\u65f6\u95f4\uff0c\u5982\u679c\u592a\u9ad8\uff0c\u8868\u793a\u7cfb\u7edf\u8c03\u7528\u65f6\u95f4\u957f\uff0c\u4f8b\u5982\u662fIO\u64cd\u4f5c\u9891\u7e41\u3002</li> <li>id \u7a7a\u95f2 CPU\u65f6\u95f4\uff0c\u4e00\u822c\u6765\u8bf4\uff0cid + us + sy = 100,\u4e00\u822c\u6211\u8ba4\u4e3aid\u662f\u7a7a\u95f2CPU\u4f7f\u7528\u7387\uff0cus\u662f\u7528\u6237CPU\u4f7f\u7528\u7387\uff0csy\u662f\u7cfb\u7edfCPU\u4f7f\u7528\u7387\u3002</li> <li>wt \u7b49\u5f85IO CPU\u65f6\u95f4\u3002</li> </ul>"},{"location":"chap8/10linux_unlink/","title":"10 \u4f7f\u7528 unlink \u5220\u9664\u6587\u4ef6\u5417","text":"<p>\u5728 Linux \u4e2d\u5220\u9664\u6587\u4ef6\uff0c\u6211\u4eec\u901a\u5e38\u4f7f\u7528 rm \u547d\u4ee4\u3002\u9664\u6b64\u4ee5\u5916\uff0c\u8fd8\u6709\u53e6\u5916\u4e00\u4e2a\u547d\u4ee4\uff0c\u53ef\u4ee5\u7528\u4e8e\u5220\u9664\u6587\u4ef6\u548c\u94fe\u63a5\uff0c\u8fd9\u5c31\u662f unlink \u547d\u4ee4\u3002</p> <p>\u867d\u7136\u5b83\u542c\u8d77\u6765\u50cf\u662f\u53ea\u80fd\u5220\u9664 Linux \u7cfb\u7edf\u4e2d\u7684\u94fe\u63a5\uff0c\u4f46\u5b9e\u9645\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u5220\u9664\u6587\u4ef6\u3002</p> <p>Linux \u7cfb\u7edf\u4e2d\u5220\u9664\u6587\u4ef6\u7684\u8fc7\u7a0b\u662f\u975e\u5e38\u8fc5\u901f\u7684\uff0c\u53ea\u662f\u4e00\u77ac\u95f4\u3002</p> <p>\u5f53\u4f60\u5220\u9664\u6587\u4ef6\u65f6\uff0cLinux \u5185\u6838\u53d1\u73b0\u5b83\u5bf9\u5e94\u4e8e\u7d22\u5f15\u8282\u70b9\u7f16\u53f7 X\uff0c\u7cfb\u7edf\u4f1a\u5c06\u5176\u4ece\u76ee\u5f55\u5217\u8868\u4e2d\u5220\u9664\u6587\u4ef6\u6761\u76ee\uff0c\u5e76\u5c06\u7d22\u5f15\u8282\u70b9 X \u7684\u94fe\u63a5\u8ba1\u6570\u51cf\u5c111\uff0c</p> <p>\u8fd9\u65f6\u5019\uff0c\u7d22\u5f15\u8282\u70b9 X \u7684\u94fe\u63a5\u8ba1\u6570\u4e3a0\uff0c\u5185\u6838\u4f1a\u8ba4\u4e3a\u6ca1\u6709\u4eba\u94fe\u63a5\u5230\u6b64\u7d22\u5f15\u8282\u70b9\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u5b89\u5168\u7684\u5220\u9664\u7d22\u5f15\u8282\u70b9\uff0c\u5e76\u5220\u9664\u4e0e\u5176\u5173\u8054\u7684\u6570\u636e\u5757\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u5982\u4f55\u4f7f\u7528 unlink \u547d\u4ee4\u3002</p>"},{"location":"chap8/10linux_unlink/#unlink","title":"unlink \u547d\u4ee4","text":"<p>\u5982\u524d\u6587\u6240\u8ff0\uff0cunlink \u547d\u4ee4\u7528\u4e8e\u5220\u9664\u6587\u4ef6\u548c\u94fe\u63a5\uff0c\u5176\u4e2d\u94fe\u63a5\u5305\u62ec\u8f6f\u94fe\u63a5\u548c\u786c\u94fe\u63a5\u3002\u5b83\u662f\u6700\u7b80\u5355\u7684\u547d\u4ee4\u4e4b\u4e00\uff0c\u9664\u4e86 <code>--help</code> \u4ee5\u53ca <code>--version</code> \u4ee5\u5916\uff0c\u6ca1\u6709\u4efb\u4f55\u5176\u4ed6\u9009\u9879\u3002</p> <p>\u4f7f\u7528 unlink \u5220\u9664\u6587\u4ef6\uff0c\u53ef\u4ee5\u8fd9\u6837\uff1a</p> <pre><code>unlink filename\n</code></pre> <p>\u5220\u9664\u94fe\u63a5\uff0c\u53ef\u4ee5\u8fd9\u6837\u4f7f\u7528\uff1a</p> <pre><code>unlink link_name\n</code></pre> <p>\u5220\u9664\u6210\u529f\u540e\uff0c\u4e0d\u4f1a\u6709\u4efb\u4f55\u8f93\u51fa\uff1a</p> <p></p> <p>\u8fd9\u5c31\u662f unlink \u547d\u4ee4\u7684\u529f\u80fd\uff0c\u9664\u6b64\u4ee5\u5916\u4e0d\u505a\u4efb\u4f55\u5176\u4ed6\u4e8b\u60c5\u3002</p>"},{"location":"chap8/10linux_unlink/#unlink_1","title":"unlink \u4e0d\u80fd\u540c\u65f6\u5220\u9664\u591a\u4e2a\u6587\u4ef6\u548c\u94fe\u63a5","text":"<p><code>&lt;mark&gt;</code>rm \u547d\u4ee4\u53ef\u4ee5\u4e00\u6b21\u5220\u9664\u591a\u4e2a\u6587\u4ef6\u3002\u4f46\u662f unlink \u5374\u4e0d\u80fd\uff0c\u5b83\u4e00\u6b21\u53ea\u80fd\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\u6216\u8005\u94fe\u63a5\uff0c\u800c\u4e14\uff0c\u4e5f\u4e0d\u80fd\u4f7f\u7528\u5168\u5c40\u6a21\u5f0f\uff08<code>Globbing patterns</code>\uff09\u3002</p> <pre><code>$ unlink *.txt\n\nunlink: extra operand \u2018file2.txt\u2019\nTry 'unlink --help' for more information.\n</code></pre> <p>\u540c\u65f6\u5220\u9664\u591a\u4e2a\u94fe\u63a5\u4e5f\u4f1a\u5982\u6b64\u3002</p>"},{"location":"chap8/10linux_unlink/#unlink_2","title":"\u4f7f\u7528 unlink \u4e0d\u80fd\u5220\u9664\u76ee\u5f55","text":"<p>GNU \u5b9e\u73b0\u4e0b\u7684 unlink \u547d\u4ee4\u662f\u65e0\u6cd5\u5220\u9664\u76ee\u5f55\u7684\uff0c\u5982\u679c\u7ed9\u5b9a\u7684\u6587\u4ef6\u540d\u79f0\u662f\u4e00\u4e2a\u76ee\u5f55\uff0c\u5c31\u4f1a\u62a5\u9519\uff1a</p> <pre><code>$ unlink new_dir\nunlink: cannot unlink 'new_dir': Is a directory\n</code></pre>"},{"location":"chap8/10linux_unlink/#rm-unlink","title":"rm \u548c unlink \u7684\u533a\u522b","text":"<p>unlink \u547d\u4ee4\u4f7f\u7528 unlink \u7cfb\u7edf\u547d\u4ee4\uff0c\u800c rm \u547d\u4ee4\u4f7f\u7528 unlinkat \u7cfb\u7edf\u8c03\u7528\uff0c\u4e24\u4e2a\u7cfb\u7edf\u8c03\u7528\u51e0\u4e4e\u76f8\u540c\u3002\u4f46\u662f\u8fd9\u4e24\u4e2a\u547d\u4ee4\u4e4b\u95f4\u8fd8\u662f\u6709\u4e00\u4e9b\u660e\u663e\u7684\u5dee\u5f02\u3002</p> <p>\u5982\u524d\u6587\u6240\u8ff0\uff0c</p> <ul> <li>unlink \u547d\u4ee4\u5728\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\u6216\u94fe\u63a5\uff0c\u800c rm \u547d\u4ee4\u53ef\u4ee5\u5220\u9664\u591a\u4e2a\uff1b</li> <li>unlink \u547d\u4ee4\u4e0d\u80fd\u5220\u9664\u76ee\u5f55\uff0c\u800c rm \u547d\u4ee4\u80fd\u5220\u9664\u76ee\u5f55\u3002</li> </ul> <p>rm \u547d\u4ee4\u5728\u6267\u884c\u7684\u65f6\u5019\uff0c\u9996\u5148\u4f1a\u5b89\u5168\u68c0\u67e5\uff0c\u5982\u679c\u4f60\u6ca1\u6709\u6587\u4ef6\u7684\u5199\u6743\u9650\uff0c\u90a3\u4e48\u7cfb\u7edf\u4f1a\u8981\u6c42\u4f60\u7ed9\u51fa\u5199\u6743\u9650\uff08sudo\u6216\u8005\u5207\u6362\u81f3\u7ba1\u7406\u5458\u7528\u6237\uff09\uff0c\u6216\u8005\u4f7f\u7528\u5f3a\u5236\u5220\u9664\u9009\u9879 <code>-f</code>\uff1b</p> <p>\u800c unlink \u5219\u4e0d\u4f1a\u8fdb\u884c\u5b89\u5168\u68c0\u67e5\uff0c\u76f4\u63a5\u5220\u9664\u6587\u4ef6\u3002</p> <p></p> <p>\u53e6\u5916\uff0c\u4e0e rm \u4e0d\u540c\uff0cunlink \u6ca1\u6709\u5176\u4ed6\u9009\u9879\u3002</p> <p>\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u76f8\u6bd4\u4e8e rm\uff0c\u4f60\u53ef\u80fd\u66f4\u559c\u6b22\u4f7f\u7528 unlink\u3002\u6bd4\u5982\u4f60\u5e0c\u671b\u5f3a\u5236\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\uff0c\u800c\u4e0d\u8003\u8651\u5b89\u5168\u6216\u8005\u6743\u9650\u95ee\u9898\uff1b\u6216\u8005\u5982\u679c\u5220\u9664\u5931\u8d25\uff08\u6bd4\u5982\u6587\u4ef6\u4e0d\u5b58\u5728\uff09\u7684\u8bdd\u4f60\u5e0c\u671b\u80fd\u770b\u5230\u62a5\u9519\u4fe1\u606f\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5c31\u53ef\u4ee5\u4f7f\u7528 unlink\u3002</p> <p>\u56e0\u4e3a\u4f7f\u7528 <code>rm -f</code> \u5f3a\u5236\u5220\u9664\u6587\u4ef6\uff0c\u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\u7684\u8bdd\uff0c\u4e0d\u4f1a\u663e\u793a\u4efb\u4f55\u9519\u8bef\u4fe1\u606f\u3002</p>"},{"location":"chap8/11linux_ip_port/","title":"11 \u5982\u4f55\u5728 Linux \u4e0b\u9650\u5236\u7aef\u53e3\u4ec5\u5bf9\u6307\u5b9a IP \u5f00\u653e\u8bbf\u95ee","text":""},{"location":"chap8/11linux_ip_port/#_1","title":"\u4e3b\u673a\u670d\u52a1\u7aef\u53e3","text":"<pre><code>$ iptables -I INPUT -p tcp --dport 80 -j DROP\n\n$ iptables -I INPUT -p tcp -s 1.2.3.4 --dport 80 -j ACCEPT\n</code></pre> <p>\u8fd9\u91cc\u4ec5\u5141\u8bb8 1.2.3.4 \u8bbf\u95ee\u672c\u5730\u4e3b\u673a\u7684 80 \u7aef\u53e3\u3002</p>"},{"location":"chap8/11linux_ip_port/#docker","title":"Docker \u670d\u52a1\u7aef\u53e3","text":"<p>\u5bf9\u4e8e\u7c7b\u4f3c <code>docker run -d -p 80:80 shaowenchen/demo-whoami</code> \u8fd0\u884c\u7684\u670d\u52a1\uff0c\u4e0a\u9762\u7684\u65b9\u6cd5\u65e0\u6548\uff0c\u9700\u8981\u5728 DOCKER-USER \u94fe\u4e2d\u6dfb\u52a0\u89c4\u5219\u3002</p> <p>Docker \u4f1a\u5c06 iptables \u89c4\u5219\u6dfb\u52a0\u5230 DOCKER \u94fe\u4e2d\uff0c\u5982\u679c\u9700\u8981\u5728 Docker \u4e4b\u524d\u6dfb\u52a0\u89c4\u5219\u9700\u8981\u6dfb\u52a0\u5230 DOCKER-USER \u94fe\u4e2d</p> <pre><code>$ iptables -I DOCKER-USER -i ens192 ! -s 1.2.3.4 -p tcp --dport 80 -j DROP\n</code></pre> <p>ens192 \u662f\u672c\u5730\u7684\u7f51\u5361\uff0c\u8fd9\u91cc\u4ec5\u5141\u8bb8 1.2.3.4 \u8bbf\u95ee\u672c\u5730\u4e3b\u673a\u7684 80 \u7aef\u53e3\u3002</p>"},{"location":"chap8/11linux_ip_port/#_2","title":"\u6e05\u7406\u73af\u5883","text":"<pre><code>$ yum install -y iptables-services\n$ systemctl restart iptables.service\n</code></pre> <p>\u5982\u679c\u9700\u8981\u5728\u4e3b\u673a\u91cd\u542f\u4e4b\u540e iptables \u8bbe\u7f6e\uff0c\u4f9d\u7136\u6709\u6548\uff0c\u9700\u8981\u5b89\u88c5 iptables-services \u5e76\u4fdd\u5b58</p> <pre><code>$ yum install -y iptables-services\n$ service iptables save\n</code></pre>"},{"location":"chap8/12socat/","title":"12 Linux \u547d\u4ee4 socat - netcat","text":"<p>Socat\u6216SOcket CAT\u662f\u4e00\u4e2a\u57fa\u4e8e Linux \u547d\u4ee4\u884c/\u7ec8\u7aef\u7684\u5b9e\u7528\u7a0b\u5e8f\uff0c\u7528\u4e8e\u5728\u4e24\u4e2a\u53cc\u5411\u5b57\u8282\u6d41\u4e4b\u95f4\u5efa\u7acb\u548c\u4f20\u8f93\u6570\u636e\u3002</p> <p>socat\u547d\u4ee4\u53ef\u4ee5\u5728\u591a\u79cd\u573a\u666f\u4e0b\u5b9e\u73b0\uff0c\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\uff1a</p> <ul> <li>\u6570\u636e\u63a5\u6536\u5668\u548c\u6570\u636e\u6e90\uff1b\u4e0d\u540c\u7c7b\u578b\u5e76\u5b58\u5728\u4e8e\u4e00\u4e2a\u5927\u96c6\u5408\u4e2d\uff0c\u53ef\u7528\u4e8e\u6784\u9020\u6d41\u3002</li> <li>\u8fd9\u4e9b\u6784\u9020\u7684\u6d41\u53ef\u4ee5\u4e0e\u8bb8\u591a\u5730\u5740\u9009\u9879\u76f8\u5173\u8054\u3002</li> </ul> <p>socat\u547d\u4ee4\u53ef\u4ee5\u6bd4\u4f5c\u4e0eTCP\u548cUDP\u534f\u8bae\u7ed1\u5b9a\u7684netcat \u5b9e\u7528\u7a0b\u5e8f\u3002</p> <p>\u4f46\u662f\uff0csocat\u6bd4netcat\u5177\u6709\u5b89\u5168\u4f18\u52bf\uff08chrooting\uff09\uff0c\u5e76\u4e14\u8fd8\u652f\u6301\u8bbe\u5907\u3001\u7ba1\u9053\u3001\u6587\u4ef6\u3001SSL\u3001SOCKS4 \u5ba2\u6237\u7aef\u3001TCP \u5957\u63a5\u5b57\u3001\u4ee3\u7406 CONNECT\u3001UNIX \u5957\u63a5\u5b57\u7b49\u3002</p>"},{"location":"chap8/12socat/#socat","title":"Socat \u547d\u4ee4","text":"<p>\u4e3a\u4e86\u66f4\u719f\u6089\u8fd9\u4e2a Linux \u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff0c\u6211\u4eec\u9700\u8981\u5217\u51fa\u5b83\u7684\u4e00\u4e9b\u5b9e\u9645\u5e94\u7528\u3002\u4ee5\u4e0b\u8981\u70b9\u603b\u7ed3\u4e86\u4e00\u4e9b\u6d41\u884c\u7684 socat \u5b9e\u7528\u7a0b\u5e8f\u5e94\u7528\u7a0b\u5e8f\uff1a</p> <ul> <li>\u5b89\u5168\u6d4b\u8bd5\u548c\u7814\u7a76\u3002</li> <li>\u9762\u5411 TCP \u7684\u7a0b\u5e8f\u8fdb\u884c\u4e32\u884c\u7ebf\u8def\u91cd\u5b9a\u5411\u3002</li> <li>\u4f5c\u4e3a UNIX \u5957\u63a5\u5b57 shell \u63a5\u53e3\u3002</li> <li>\u5efa\u7acb su \u548c chroot \u5b89\u5168\u73af\u5883\u4ee5\u5728\u5171\u4eab\u7f51\u7edc\u8fde\u63a5\u4e0a\u6267\u884c\u670d\u52a1\u5668/\u5ba2\u6237\u7aef Shell \u811a\u672c\u3002</li> <li>\u4e0d\u540c\u8ba1\u7b97\u673a\u4e0a\u4e32\u884c\u7ebf\u8def\u7684\u903b\u8f91\u8fde\u63a5\u3002</li> <li>IP6 relay\u3002</li> <li>\u901a\u8fc7\u653b\u51fb\u5f31\u9632\u706b\u5899\u8fdb\u884c\u5b89\u5168\u6d4b\u8bd5\u3002</li> <li>TCP \u7aef\u53e3\u8f6c\u53d1\u3002</li> </ul>"},{"location":"chap8/12socat/#linux-socat","title":"\u5728 Linux \u4e2d\u5b89\u88c5 Socat \u5b9e\u7528\u7a0b\u5e8f","text":"<p>\u5982\u679c\u60a8\u7684 Linux \u64cd\u4f5c\u7cfb\u7edf\u53d1\u884c\u7248\u4e0a\u5c1a\u672a\u5b89\u88c5\u57fa\u4e8esocat Linux \u547d\u4ee4\u884c\u7684\u5b9e\u7528\u7a0b\u5e8f\uff0c\u8bf7\u53c2\u8003\u60a8\u6b63\u5728\u4f7f\u7528\u7684 Linux \u64cd\u4f5c\u7cfb\u7edf\u53d1\u884c\u7248\u53c2\u8003\u4ee5\u4e0b\u5b89\u88c5\u547d\u4ee4\u4e4b\u4e00\uff1a</p> <pre><code>$ sudo apt install socat         [\u5728 Debian, Ubuntu \u548c Mint \u4e0a]\n$ sudo yum install socat         [\u5728 RHEL/CentOS/Fedora \u548c Rocky Linux/AlmaLinux \u4e0a]\n$ sudo emerge -a net-misc/socat  [\u5728 Gentoo Linux \u4e0a]\n$ sudo pacman -S socat           [\u5728 Arch Linux \u4e0a]\n$ sudo zypper install socat      [\u5728  OpenSUSE \u4e0a]\n</code></pre> <p>\u6b63\u5982\u5df2\u7ecf\u8ba8\u8bba\u8fc7\u7684\uff0csocat\u662fnetcat\u5b9e\u7528\u7a0b\u5e8f\u7684\u51fa\u8272\u66ff\u4ee3\u54c1\uff0c\u56e0\u4e3a\u5b83\u5177\u6709\u5f3a\u5927\u548c\u9ad8\u7ea7\u7684\u529f\u80fd\u3002\u6211\u4eec\u73b0\u5728\u5e94\u8be5\u80fd\u591f\u901a\u8fc7 Linux \u547d\u4ee4\u884c\u73af\u5883\u770b\u5230\u4e00\u4e9b\u4f7f\u7528socat\u5b9e\u7528\u7a0b\u5e8f\u7684\u5b9e\u9645\u793a\u4f8b\u3002</p> <p>\u5176\u4f7f\u7528\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code># socat [options] &lt;address&gt; &lt;address&gt;\n</code></pre> <p>\u786e\u4fdd\u60a8\u5728 Linux \u673a\u5668\u4e0a\u62e5\u6709 sudoer/root \u7528\u6237\u6743\u9650\u3002</p> <p>1\u3001\u76d1\u542c\u7279\u5b9a\u7aef\u53e3</p> <p>\u6211\u4eec\u53ef\u4ee5\u6307\u793asocat\u901a\u8fc7TCP\u534f\u8bae\u76d1\u542c\u7279\u5b9a\u7aef\u53e3\uff0c\u4f8b\u598280 \uff0c\u5e76\u901a\u8fc7STDOUT\u6253\u5370\u51fa\u4efb\u4f55\u76f8\u5173\u7684\u53d1\u73b0\uff0c\u5982\u4e0b\u6240\u793a\u3002</p> <pre><code>$ sudo socat TCP4-LISTEN:80 STDOUT\n</code></pre> <p>TCP\u53ef\u4ee5\u5207\u6362\u5230\u5176\u4ed6\u4e0d\u540c\u7684\u503c\uff0c\u4f8b\u5982TCP6\u3001TCP6-LISTEN\u548cTCP4\u3002</p> <p>2. \u8fde\u63a5\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\u7684\u7aef\u53e3</p> <p>\u8981\u8fde\u63a5\u5230\u4e0e\u7aef\u53e3\u5173\u8054\u7684\u670d\u52a1\u5668\uff0c\u6211\u4eec\u5c06\u8fd0\u884c\uff1a</p> <pre><code>$ sudo socat \u2013 TCP4:linuxmi.com:80\n</code></pre> <p>3. TCP \u7aef\u53e3\u8f6c\u53d1\u5668</p> <p>\u5b83\u4e5f\u662f\u4e00\u4e2a\u6709\u6548\u7684TCP\u7aef\u53e3\u8f6c\u53d1\u5668\u3002\u4f8b\u5982\uff0c\u7aef\u53e381\u8fde\u63a5\u53ef\u4ee5\u8f6c\u53d1\u5230\u7aef\u53e380\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <p>\u5bf9\u4e8e\u5355\u4e2a\u8fde\u63a5\u3002</p> <pre><code>$ sudo socat TCP4-LISTEN:81 TCP4:192.168.122.1:80\n</code></pre> <p>\u5bf9\u4e8e\u591a\u4e2a\u8fde\u63a5\u3002</p> <pre><code>$ sudo socat TCP4-LISTEN:81,fork,reuseaddr TCP4:TCP4:192.168.122.1:80\n</code></pre> <p>\u60a8\u53ef\u4ee5\u4f7f\u7528\u952e\u76d8\u7ec4\u5408\u53d6\u6d88\u7aef\u53e3\u8f6c\u53d1[Ctrl]+c\u3002</p> <p>4.\u76d1\u542c\u672c\u5730\u7aef\u53e3</p> <p>\u76d1\u542c\u672c\u5730\u7aef\u53e3www\u3002</p> <pre><code>$ sudo socat TCP4-LISTEN:www TCP4:linuxmi.com:www\n</code></pre> <p>5. \u76d1\u542c\u8fdc\u7a0b\u5957\u63a5\u5b57\u4e0a\u7684\u7279\u5b9a\u7aef\u53e3</p> <p>\u5982\u679c\u6211\u4eec\u60f3\u76d1\u542c\u4e00\u4e2a\u7279\u5b9a\u7684\u7aef\u53e3\uff0c\u63a5\u53d7\u5b83\u7684\u8fde\u63a5\u5e76\u5c06\u5b83\u8f6c\u53d1\u5230\u4e00\u4e2a\u8fdc\u7a0b\u7684 Unix \u5957\u63a5\u5b57\uff0c\u4f8b\u5982 mysql.sock\uff0c\u6211\u4eec\u4f1a\u4ee5\u5982\u4e0b\u65b9\u5f0f\u5b9e\u73b0 socat \u547d\u4ee4\uff1a</p> <pre><code>$ sudo socat TCP-LISTEN:3309,reuseaddr,fork UNIX-CONNECT:/var/lib/mysql/mysql.sock\n</code></pre> <p>6. \u57fa\u4e8e\u7f51\u7edc\u7684\u6d88\u606f\u6536\u96c6\u5668</p> <p>\u8fd9\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u6f14\u793a\u4e86\u57fa\u4e8e\u7f51\u7edc\u7684\u6d88\u606f\u6536\u96c6\u5668\u7684\u5b9e\u73b0\u3002\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u7aef\u53e3 3354 \u6210\u529f\u540e\uff0c\u6587\u4ef6/tmp/testing.log\u901a\u8fc7\u65b0\u751f\u6210\u7684\u5b50\u8fdb\u7a0b\u9644\u52a0\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u6570\u636e\u3002\u5f53\u53d1\u73b0\u6b64\u6587\u4ef6\u4e0d\u5b58\u5728\u65f6\uff0c socat\u4f1a\u81ea\u52a8\u521b\u5efa\u6b64\u6587\u4ef6\u3002</p> <pre><code>$ sudo socat -u TCP4-LISTEN:3354,reuseaddr,fork OPEN:/tmp/testing.log,creat,append\n</code></pre> <pre><code>$man socat\n</code></pre>"},{"location":"chap8/13ping/","title":"ping \u547d\u4ee4\u8be6\u7ec6\u4f7f\u7528","text":""},{"location":"chap8/13ping/#ping_1","title":"\u4e00\u3001ping \u57fa\u672c\u4f7f\u7528\u8be6\u89e3","text":"<ul> <li>1\u3001\u7528\u6765\u68c0\u6d4b\u7f51\u7edc\u7684\u8fde\u901a\u60c5\u51b5\u548c\u5206\u6790\u7f51\u7edc\u901f\u5ea6</li> <li>2\u3001\u6839\u636e\u57df\u540d\u5f97\u5230\u670d\u52a1\u5668 IP</li> <li>3\u3001\u6839\u636e ping \u8fd4\u56de\u7684 TTL \u503c\u6765\u5224\u65ad\u5bf9\u65b9\u6240\u4f7f\u7528\u7684\u64cd\u4f5c\u7cfb\u7edf\u53ca\u6570\u636e\u5305\u7ecf\u8fc7\u8def\u7531\u5668\u6570\u91cf\u3002</li> </ul> <p>\u6211\u4eec\u901a\u5e38\u4f1a\u7528\u5b83\u6765\u76f4\u63a5 ping ip \u5730\u5740\uff0c\u6765\u6d4b\u8bd5\u7f51\u7edc\u7684\u8fde\u901a\u60c5\u51b5\u3002</p> <pre><code>$ ping 115.61.50.31\nPING 115.61.50.31 (115.61.50.31): 56 data bytes\n64 bytes from 115.61.50.31: icmp_seq=0 ttl=54 time=33.630 ms\n64 bytes from 115.61.50.31: icmp_seq=1 ttl=54 time=33.784 ms\n64 bytes from 115.61.50.31: icmp_seq=2 ttl=54 time=34.899 ms\n64 bytes from 115.61.50.31: icmp_seq=3 ttl=54 time=33.411 ms\n^C\n--- 115.61.50.31 ping statistics ---\n4 packets transmitted, 4 packets received, 0.0% packet loss\nround-trip min/avg/max/stddev = 33.411/33.931/34.899/0.574 ms\n</code></pre> <p>\u7c7b\u5982\u8fd9\u79cd\uff0c\u76f4\u63a5 ping ip \u5730\u5740\u6216\u7f51\u5173\uff0cping \u901a\u4f1a\u663e\u793a\u51fa\u4ee5\u4e0a\u6570\u636e\uff0c\u6709\u670b\u53cb\u53ef\u80fd\u4f1a\u95ee\uff0cbytes=64\uff1btime&lt;1ms\uff1bTTL=33 \u8fd9\u4e9b\u662f\u4ec0\u4e48\u610f\u601d\u3002</p> <ul> <li>bytes \u503c\uff1a\u6570\u636e\u5305\u5927\u5c0f\uff0c\u4e5f\u5c31\u662f\u5b57\u8282\u3002</li> <li>time \u503c\uff1a\u54cd\u5e94\u65f6\u95f4\uff0c\u8fd9\u4e2a\u65f6\u95f4\u8d8a\u5c0f\uff0c\u8bf4\u660e\u4f60\u8fde\u63a5\u8fd9\u4e2a\u5730\u5740\u901f\u5ea6\u8d8a\u5feb\u3002</li> </ul> <p>TTL \u503c\uff1aTime To Live, \u8868\u793a DNS \u8bb0\u5f55\u5728 DNS \u670d\u52a1\u5668\u4e0a\u5b58\u5728\u7684\u65f6\u95f4\uff0c\u5b83\u662f IP \u534f\u8bae\u5305\u7684\u4e00\u4e2a\u503c\uff0c\u544a\u8bc9\u8def\u7531\u5668\u8be5\u6570\u636e\u5305\u4f55\u65f6\u9700\u8981\u88ab\u4e22\u5f03\u3002\u53ef\u4ee5\u901a\u8fc7 Ping \u8fd4\u56de\u7684 TTL \u503c\u5927\u5c0f\uff0c\u7c97\u7565\u5730\u5224\u65ad\u76ee\u6807\u7cfb\u7edf\u7c7b\u578b\u662f Windows \u7cfb\u5217\u8fd8\u662f UNIX/Linux \u7cfb\u5217\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cLinux \u7cfb\u7edf\u7684 TTL \u503c\u4e3a 64 \u6216 255\uff0cWindowsNT/2000/XP \u7cfb\u7edf\u7684 TTL \u503c\u4e3a 128\uff0cWindows98 \u7cfb\u7edf\u7684 TTL \u503c\u4e3a 32\uff0cUNIX \u4e3b\u673a\u7684 TTL \u503c\u4e3a 255\u3002</p> <p>\u56e0\u6b64\u4e00\u822c TTL \u503c\uff1a</p> <ul> <li>100~130ms \u4e4b\u95f4\uff0cWindows \u7cfb\u7edf \uff1b</li> <li>240~255ms \u4e4b\u95f4\uff0cUNIX/Linux \u7cfb\u7edf\u3002</li> </ul> <p>\u5f53\u7136\uff0c\u6211\u4eec\u4eca\u5929\u4e3b\u8981\u4e86\u89e3\u5e76\u4e0d\u662f\u8fd9\u4e9b\uff0c\u800c\u662f ping \u7684\u5176\u5b83\u53c2\u8003\u3002</p> <p>ping \u547d\u4ee4\u9664\u4e86\u76f4\u63a5 ping \u7f51\u7edc\u7684 ip \u5730\u5740\uff0c\u9a8c\u8bc1\u7f51\u7edc\u7545\u901a\u548c\u901f\u5ea6\u4e4b\u5916\uff0c\u5b83\u8fd8\u6709\u8fd9\u4e9b\u7528\u6cd5\u3002</p> <pre><code> ping -a\nusage: ping [-AaDdfnoQqRrv] [-c count] [-G sweepmaxsize]\n            [-g sweepminsize] [-h sweepincrsize] [-i wait]\n            [-l preload] [-M mask | time] [-m ttl] [-p pattern]\n            [-S src_addr] [-s packetsize] [-t timeout][-W waittime]\n            [-z tos] host\n       ping [-AaDdfLnoQqRrv] [-c count] [-I iface] [-i wait]\n            [-l preload] [-M mask | time] [-m ttl] [-p pattern] [-S src_addr]\n            [-s packetsize] [-T ttl] [-t timeout] [-W waittime]\n            [-z tos] mcast-group\nApple specific options (to be specified before mcast-group or host like all options)\n            -b boundif           # bind the socket to the interface\n            -k traffic_class     # set traffic class socket option\n            -K net_service_type  # set traffic class socket options\n            --apple-connect       # call connect(2) in the socket\n            --apple-time          # display current time\n</code></pre>"},{"location":"chap8/13ping/#ping-t","title":"\u4e8c\u3001ping -t \u7684\u4f7f\u7528","text":"<p>\u4e0d\u95f4\u65ad\u5730 Ping \u6307\u5b9a\u8ba1\u7b97\u673a\uff0c\u76f4\u5230\u7ba1\u7406\u5458\u4e2d\u65ad\u3002</p> <p></p>"},{"location":"chap8/13ping/#ping-a","title":"\u4e09\u3001ping -a \u7684\u4f7f\u7528","text":"<p><code>ping-a</code> \u89e3\u6790\u8ba1\u7b97\u673a\u540d\u4e0e NetBios \u540d\u3002\u5c31\u662f\u53ef\u4ee5\u901a\u8fc7 ping \u5b83\u7684 ip \u5730\u5740\uff0c\u53ef\u4ee5\u89e3\u6790\u51fa\u4e3b\u673a\u540d\u3002</p>"},{"location":"chap8/14linux_shell/","title":"Linux shell \u811a\u672c\u8be6\u89e3\u5b66\u4e60 2023","text":"<p>Shell \u901a\u8fc7\u63d0\u793a\u60a8\u8f93\u5165\uff0c\u5411\u64cd\u4f5c\u7cfb\u7edf\u89e3\u91ca\u8be5\u8f93\u5165\uff0c\u7136\u540e\u5904\u7406\u6765\u81ea\u64cd\u4f5c\u7cfb\u7edf\u7684\u4efb\u4f55\u7ed3\u679c\u8f93\u51fa\uff0c\u7b80\u5355\u6765\u8bf4Shell\u5c31\u662f\u4e00\u4e2a\u7528\u6237\u8ddf\u64cd\u4f5c\u7cfb\u7edf\u4e4b\u95f4\u7684\u4e00\u4e2a\u547d\u4ee4\u89e3\u91ca\u5668\u3002</p> <p>\u5e38\u89c1\u7684shell \u6709\u54ea\u4e9b</p> <ul> <li><code>Bourne Shell\uff08/usr/bin/sh\u6216/bin/sh\uff09</code></li> <li><code>Bourne Again Shell\uff08/bin/bash\uff09</code></li> <li><code>C Shell\uff08/usr/bin/csh\uff09</code></li> <li><code>K Shell\uff08/usr/bin/ksh\uff09</code></li> <li><code>Shell for Root\uff08/sbin/sh\uff09</code></li> </ul>"},{"location":"chap8/14linux_shell/#12-shell","title":"1.2 shell \u7f16\u7a0b\u6ce8\u610f\u4e8b\u9879","text":"<ul> <li>shell \u7f16\u7a0b\u6709\u54ea\u4e9b\u6ce8\u610f\u4e8b\u9879</li> <li>shell \u547d\u540d\uff1aShell \u811a\u672c\u540d\u79f0\u547d\u540d\u4e00\u822c\u4e3a\u82f1\u6587\u3001\u5927\u5199\u3001\u5c0f\u5199\uff0c\u540e\u7f00\u4ee5. sh \u7ed3\u5c3e</li> <li>\u4e0d\u80fd\u4f7f\u7528\u7279\u6b8a\u7b26\u53f7\u3001\u7a7a\u683c</li> <li>\u89c1\u95fb\u4e4b\u610f\uff0c\u540d\u79f0\u8981\u5199\u7684\u4e00\u773c\u53ef\u4ee5\u770b\u51fa\u529f\u80fd</li> <li>shell \u7f16\u7a0b \u9996\u884c\u9700\u8981 <code>#!/bin/bash</code> \u5f00\u5934</li> <li>shell \u811a\u672c \u53d8\u91cf \u4e0d\u80fd\u4ee5 \u6570\u5b57\u3001\u7279\u6b8a\u7b26\u53f7\u5f00\u5934\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u5212\u7ebf<code>_</code>, \u4f46\u4e0d\u80fd \u7528\u7834\u6298\u53f7 <code>-</code></li> </ul>"},{"location":"chap8/14linux_shell/#13-shell-hello-world","title":"1.3 \u7b2c\u4e00\u4e2a shell \u811a\u672c hello world","text":"<p>\u521b\u5efa\u4e00\u4e2a\u4f1f\u5927\u7f16\u7a0b\u9879\u76ee \u2014Hello World</p> <pre><code># cat Helloword.sh \n\n#!/bin/bash\n# This is ower first shell\n# by author jacob 2023.09\necho \"hello world\"\n\n# \u8d4b\u4e88\u6267\u884c\u6743\u9650\n[root@aly_server01~]# chmod o+x Helloword.sh \n\n# \u8fd0\u884chelloword.sh \u811a\u672c\n[root@aly_server01~]# ./Helloword.sh \nhello world\n</code></pre>"},{"location":"chap8/14linux_shell/#shell","title":"\u4e8c\u3001shell \u73af\u5883\u53d8\u91cf\u8bb2\u89e3","text":""},{"location":"chap8/14linux_shell/#21-shell","title":"2.1 shell \u53d8\u91cf\u8be6\u89e3","text":"<p>\u73af\u5883\u53d8\u91cf\u4ecb\u7ecd</p> <p>\u5e38\u89c1\u76843\u79cd\u53d8\u91cf</p> <p>Shell\u7f16\u7a0b\u4e2d\u53d8\u91cf\u5206\u4e3a\u4e09\u79cd\uff0c\u5206\u522b\u662f\u7cfb\u7edf\u53d8\u91cf\u3001\u73af\u5883\u53d8\u91cf\u548c\u7528\u6237\u53d8\u91cf\uff0cShell\u53d8\u91cf\u540d\u5728\u5b9a\u4e49\u65f6\uff0c\u9996\u4e2a\u5b57\u7b26\u5fc5\u987b\u4e3a\u5b57\u6bcd\uff08a-z\uff0cA-Z\uff09\uff0c\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934\uff0c\u4e2d\u95f4\u4e0d\u80fd\u6709\u7a7a\u683c\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u5212\u7ebf\uff08_\uff09\uff0c\u4e0d\u80fd\u4f7f\u7528\uff08-\uff09\uff0c\u4e5f\u4e0d\u80fd\u4f7f\u7528\u6807\u70b9\u7b26\u53f7\u7b49</p> <pre><code># \u7b80\u5355\u7684\u53d8\u91cf\u4ecb\u7ecd\n[root@keeplived_server~]# a=18\n\n[root@keeplived_server~]# echo $a\n18\n</code></pre>"},{"location":"chap8/14linux_shell/#22-shell","title":"2.2 shell \u7cfb\u7edf\u53d8\u91cf \u4ecb\u7ecd","text":"<p>\u7cfb\u7edf\u53d8\u91cf</p> <pre><code># Shell\u5e38\u89c1\u7684\u53d8\u91cf\u4e4b\u4e00\u7cfb\u7edf\u53d8\u91cf\uff0c\u4e3b\u8981\u662f\u7528\u4e8e\u5bf9\u53c2\u6570\u5224\u65ad\u548c\u547d\u4ee4\u8fd4\u56de\u503c\u5224\u65ad\u65f6\u4f7f\u7528\uff0c\u7cfb\u7edf\u53d8\u91cf\u8be6\u89e3\u5982\u4e0b\uff1a\n\n$0   \u5f53\u524d\u811a\u672c\u7684\u540d\u79f0\uff1b\n$n   \u5f53\u524d\u811a\u672c\u7684\u7b2cn\u4e2a\u53c2\u6570,n=1,2,\u20269\uff1b\n$*   \u5f53\u524d\u811a\u672c\u7684\u6240\u6709\u53c2\u6570(\u4e0d\u5305\u62ec\u7a0b\u5e8f\u672c\u8eab)\uff1b\n$#   \u5f53\u524d\u811a\u672c\u7684\u53c2\u6570\u4e2a\u6570(\u4e0d\u5305\u62ec\u7a0b\u5e8f\u672c\u8eab)\uff1b\n$?   \u4ee4\u6216\u7a0b\u5e8f\u6267\u884c\u5b8c\u540e\u7684\u72b6\u6001\uff0c\u8fd4\u56de0\u8868\u793a\u6267\u884c\u6210\u529f\uff1b\n$$   \u7a0b\u5e8f\u672c\u8eab\u7684PID\u53f7\u3002\n</code></pre>"},{"location":"chap8/14linux_shell/#23-shell","title":"2.3 shell \u73af\u5883\u53d8\u91cf \u4ecb\u7ecd","text":"<p>2.3.1 \u5e38\u89c1\u7684\u7cfb\u7edf\u73af\u5883\u53d8\u91cf</p> <p>\u73af\u5883\u53d8\u91cf\u4ecb\u7ecd</p> <pre><code>#Shell\u5e38\u89c1\u7684\u53d8\u91cf\u4e4b\u4e8c\u73af\u5883\u53d8\u91cf\uff0c\u4e3b\u8981\u662f\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u9700\u8981\u8bbe\u7f6e\uff0c\u73af\u5883\u53d8\u91cf\u8be6\u89e3\u5982\u4e0b\uff1a\n\nPATH    \u547d\u4ee4\u6240\u793a\u8def\u5f84\uff0c\u4ee5\u5192\u53f7\u4e3a\u5206\u5272\uff1b\nHOME    \u6253\u5370\u7528\u6237\u5bb6\u76ee\u5f55\uff1b\nSHELL   \u663e\u793a\u5f53\u524dShell\u7c7b\u578b\uff1b\nUSER    \u6253\u5370\u5f53\u524d\u7528\u6237\u540d\uff1b\nID      \u6253\u5370\u5f53\u524d\u7528\u6237id\u4fe1\u606f\uff1b\nPWD     \u663e\u793a\u5f53\u524d\u6240\u5728\u8def\u5f84\uff1b\nTERM    \u6253\u5370\u5f53\u524d\u7ec8\u7aef\u7c7b\u578b\uff1b\nHOSTNAME    \u663e\u793a\u5f53\u524d\u4e3b\u673a\u540d\uff1b\nPS1         \u5b9a\u4e49\u4e3b\u673a\u547d\u4ee4\u63d0\u793a\u7b26\u7684\uff1b\nHISTSIZE    \u5386\u53f2\u547d\u4ee4\u5927\u5c0f\uff0c\u53ef\u901a\u8fc7 HISTTIMEFORMAT \u53d8\u91cf\u8bbe\u7f6e\u547d\u4ee4\u6267\u884c\u65f6\u95f4;\nRANDOM      \u968f\u673a\u751f\u6210\u4e00\u4e2a 0 \u81f3 32767 \u7684\u6574\u6570;\nHOSTNAME    \u4e3b\u673a\u540d\n</code></pre>"},{"location":"chap8/14linux_shell/#24-shell","title":"2.4 shell \u7528\u6237\u73af\u5883\u53d8\u91cf \u4ecb\u7ecd","text":"<p>\u81ea\u5b9a\u4e49 shell \u73af\u5883\u53d8\u91cf</p> <pre><code># \u5e38\u89c1\u7684\u53d8\u91cf\u4e4b\u4e09\u7528\u6237\u53d8\u91cf\uff0c\u7528\u6237\u53d8\u91cf\u53c8\u79f0\u4e3a\u5c40\u90e8\u53d8\u91cf\uff0c\u4e3b\u8981\u7528\u5728Shell\u811a\u672c\u5185\u90e8\u6216\u8005\u4e34\u65f6\u5c40\u90e8\u4f7f\u7528\uff0c\u7cfb\u7edf\u53d8\u91cf\u8be6\u89e3\u5982\u4e0b\uff1a\na=rivers            \u81ea\u5b9a\u4e49\u53d8\u91cfA\uff1b\nHttpd_sort=httpd-2.4.6-97.tar  \u81ea\u5b9a\u4e49\u53d8\u91cfN_SOFT\uff1b\nBACK_DIR=/data/backup/         \u81ea\u5b9a\u4e49\u53d8\u91cfBACK_DIR\uff1b\nIPaddress=10.0.0.1      \u81ea\u5b9a\u4e49\u53d8\u91cfIP1\uff1b\n</code></pre> <p>echo \u6253\u5370\u83dc\u5355\u680f</p> <p>\u4f7f\u7528 echo \u6253\u5370\u83dc\u5355\u680f\uff0c\u663e\u793a http-2.4 \u5b89\u88c5\u8fc7\u7a0b</p> <pre><code># echo \u6253\u5370httpd-2.4\u5b89\u88c5\u6b65\u9aa4\n[root@web-server01~]# touch httpd_2.4_install.sh\n\n\n# \u8d4b\u4e88\u6267\u884c\u6743\u9650\n[root@web-server01~]# chmod o+x httpd_2.4_install.sh\n[root@web-server01~]# ./httpd_2.4_install.sh\n</code></pre> <pre><code>[root@web-server@1~]# ./httpd 2.4 install.sh\necho \u6253\u5370\u83dc\u5355\u680f\nPlease Select Install Menu:\n1. \u5b98\u65b9\u4e0b\u8f7dHttpd\u6587\u4ef6\u5305\u3002\n2. \u89e3\u538bapache\u6e90\u7801\u5305\u3002\n3. \u7f16\u8bd1\u5b89\u88c5Httpd\u670d\u52a1\u5668.\n4.\u542f\u52a8httpd\u670d\u52a1\u3002\n5. quit\n</code></pre> <p>shell \u4e2d\u5f69\u8272\u8f93\u51fa helloworld</p> <p><code>echo -e</code> \u6269\u5c55</p> <pre><code>#!/bin/bash\n# This is echo color shell\n# by author jacob 2023.09\n# \u5b57\u4f53\u989c\u8272\nfor i in {31..37}; do\necho -e \"\\033[$i;40mHello world!\\033[0m\"\ndone\n# \u80cc\u666f\u989c\u8272\nfor i in {41..47}; do\necho -e \"\\033[47;${i}mHello world!\\033[0m\"\ndone\n# \u663e\u793a\u65b9\u5f0f\nfor i in {1..8}; do\necho -e \"\\033[$i;31;40mHello world!\\033[0m\"\ndone\n</code></pre> <p></p>"},{"location":"chap8/14linux_shell/#shell_1","title":"\u4e09\u3001shell \u7f16\u7a0b\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5","text":""},{"location":"chap8/14linux_shell/#31-if","title":"3.1 if \u6761\u4ef6\u8bed\u53e5\u4ecb\u7ecd","text":"<p>\u5e38\u7528\u7684\u5355 / \u53cc\u5206\u652f</p> <pre><code># If\u6761\u4ef6\u5224\u65ad\u8bed\u53e5\uff0c\u901a\u5e38\u4ee5if\u5f00\u5934\uff0cfi\u7ed3\u5c3e\u3002\u4e5f\u53ef\u52a0\u5165else\u6216\u8005elif\u8fdb\u884c\u591a\u6761\u4ef6\u7684\u5224\u65ad\n\n# \u5355\u5206\u652f\u8bed\u53e5 ---\u6bd4\u8f83\u5927\u5c0f\n if (\u6761\u4ef6\u8868\u8fbe\u5f0f);then\n  \u8bed\u53e51\n fi\n\n# \u53cc\u5206\u652fif \u8bed\u53e5\n if (\u8868\u8fbe\u5f0f)\n  \u8bed\u53e51\n else\n  \u8bed\u53e52\n fi\n\n# \u591a\u652f\u6761\u4ef6\u8bed\u53e5 ---\u5224\u65ad\u6210\u7ee9\n if (\u8868\u8fbe\u5f0f)\n  \u8bed\u53e51\n elif\n  \u8bed\u53e52\n elif\n  \u8bed\u53e52\n fi\n</code></pre> <ul> <li>if \u5e38\u89c1\u5224\u65ad\u903b\u8f91\u8fd0\u7b97\u7b26\u8be6\u89e3</li> </ul> <p>\u5e38\u89c1\u903b\u8f91\u5224\u65ad\u8fd0\u7b97\u7b26</p> <pre><code>-f   \u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728 eg: if [ -f filename ]\uff1b\n-d   \u5224\u65ad\u76ee\u5f55\u662f\u5426\u5b58\u5728 eg: if [ -d dir     ]\uff1b\n-eq  \u7b49\u4e8e\uff0c\u5e94\u7528\u4e8e\u6574\u578b\u6bd4\u8f83 equal\uff1b\n-ne  \u4e0d\u7b49\u4e8e\uff0c\u5e94\u7528\u4e8e\u6574\u578b\u6bd4\u8f83 not equal\uff1b\n-lt  \u5c0f\u4e8e\uff0c\u5e94\u7528\u4e8e\u6574\u578b\u6bd4\u8f83 letter\uff1b\n-gt  \u5927\u4e8e\uff0c\u5e94\u7528\u4e8e\u6574\u578b\u6bd4\u8f83 greater\uff1b\n-le  \u5c0f\u4e8e\u6216\u7b49\u4e8e\uff0c\u5e94\u7528\u4e8e\u6574\u578b\u6bd4\u8f83\uff1b\n-ge  \u5927\u4e8e\u6216\u7b49\u4e8e\uff0c\u5e94\u7528\u4e8e\u6574\u578b\u6bd4\u8f83\uff1b\n-a  \u53cc\u65b9\u90fd\u6210\u7acb\uff08and\uff09 \u903b\u8f91\u8868\u8fbe\u5f0f \u2013a \u903b\u8f91\u8868\u8fbe\u5f0f\uff1b\n-o  \u5355\u65b9\u6210\u7acb\uff08or\uff09 \u903b\u8f91\u8868\u8fbe\u5f0f \u2013o \u903b\u8f91\u8868\u8fbe\u5f0f\uff1b\n-z  \u7a7a\u5b57\u7b26\u4e32\uff1b\n-x      \u662f\u5426\u5177\u6709\u53ef\u6267\u884c\u6743\u9650\n||      \u5355\u65b9\u6210\u7acb\uff1b\n&amp;&amp;      \u53cc\u65b9\u90fd\u6210\u7acb\u8868\u8fbe\u5f0f\u3002\n</code></pre> <ul> <li>\u4f7f\u7528\u5355\u5206\u652f\u8bed\u53e5\u5224\u65ad crond \u8fdb\u7a0b\u662f\u5426\u5728\u8fd0\u884c\u2014\u6848\u4f8b</li> </ul> <p>\u5224\u65ad crond \u670d\u52a1\u662f\u5426\u8fd0\u884c</p> <pre><code>#!/bin/bash\n# this is check crond\n# by author jacob on 2023-9\n\n# \u5b9a\u4e49\u4e00\u4e2a\u53d8\u91cf\u540d\nname=crond\nnum=$(ps -ef|grep $name|grep -vc grep)\nif [ $num -eq 1 ];then\n    echo \"$num running!\"\nelse\n    echo \"$num is not running!\"\nfi\n</code></pre> <p>\u5224\u65ad\u7cfb\u7edf\u76ee\u5f55\u662f\u5426\u5b58\u5728 \u2014\u6848\u4f8b</p> <pre><code>#!/bin/bash\n# this is check directory \n\n if  [  !  -d  /data/rivers  -a  !  -d  /tmp/rivers  ]\uff1bthen\n mkdir  -p  /data/rivers  f\n i\n</code></pre> <ul> <li><code>-d \u5224\u65ad\u76ee\u5f55\u662f\u5426\u5b58\u5728 eg: if [ -d dir     ]\uff1b</code></li> <li><code>-a \u65b9\u90fd\u6210\u7acb\uff08and\uff09 \u903b\u8f91\u8868\u8fbe\u5f0f \u2013a \u903b\u8f91\u8868\u8fbe\u5f0f\uff1b</code></li> </ul> <p>\u591a\u4e2a\u6761\u4ef6\u5224\u65ad\u5b66\u751f\u5206\u6570\u7b49\u7ea7 \u2014 \u6848\u4f8b</p> <pre><code># if \u8bed\u53e5\u53ef\u4ee5\u76f4\u63a5\u5bf9\u547d\u4ee4\u72b6\u6001\u8fdb\u884c\u5224\u65ad\uff0c\u5c31\u7701\u53bb\u4e86\u83b7\u53d6$?\u8fd9\u4e00\u6b65\uff01\n  # \u5982\u679c\u7b2c\u4e00\u4e2a\u6761\u4ef6\u7b26\u5408\u5c31\u4e0d\u518d\u5411\u4e0b\u5339\u914d\n#!/bin/bash\n  # this check grade shell\n\n  grade=$1\n  if [ $grade -gt 90 ];then\n    echo \"Is's very good!\"\n  elif [ $grade -gt 70 ];then\n    echo \"Is's is good!\"\n\n  elif [ $grade -ge 60 ];then\n    echo \"pass\"\n\n  else\n    echo \"no pass\"\n  fi\n</code></pre> <p></p>"},{"location":"chap8/14linux_shell/#32-for","title":"3.2 for \u5faa\u73af\u8bed\u53e5\u4ecb\u7ecd","text":"<pre><code>#\u683c\u5f0f\uff1afor name [ [ in [ word ... ] ] ; ] do list ; done\n  for \u53d8\u91cf\u540d in \u53d6\u503c\u5217\u8868; do\n    \u8bed\u53e5 1\n  done\n</code></pre> <p>\u68c0\u67e5\u540c\u4e00\u5c40\u57df\u7f51 \u591a\u53f0\u4e3b\u673a\u662f\u5426\u5b58\u6d3b</p> <pre><code>#!/bin/bash\n# check hosts is on/Off\n\nNetwork=$1\nfor Host in $(seq 1 254)\ndo\nping -c 1 $Network.$Host &gt; /dev/null &amp;&amp; result=0 || result=1\n\nif [ \"$result\" == 0 ];then\n  echo -e \"\\033[32;1m$Network.$Host is up \\033[0m\"\n  echo \"$Network.$Host\" &gt;&gt; /tmp/up.txt\n\nelse\n  echo -e \"\\033[;31m$Network.$Host is down \\033[0m\"\n  echo \"$Network.$Host\" &gt;&gt; /tmp/down.txt\nfi\ndone\n</code></pre>"},{"location":"chap8/14linux_shell/#33-while","title":"3.3 while \u5faa\u73af\u8bed\u53e5\u4ecb\u7ecd","text":"<p>while \u5faa\u73af\u8bed\u53e5</p> <p>While\u5faa\u73af\u8bed\u53e5\u4e0efor\u5faa\u73af\u529f\u80fd\u7c7b\u4f3c\uff0c\u4e3b\u8981\u7528\u4e8e\u5bf9\u67d0\u4e2a\u6570\u636e\u57df\u8fdb\u884c\u5faa\u73af\u8bfb\u53d6\u3001\u5bf9\u6587\u4ef6\u8fdb\u884c\u904d\u5386\uff0c\u901a\u5e38\u7528\u4e8e\u9700\u8981\u5faa\u73af\u67d0\u4e2a\u6587\u4ef6\u6216\u8005\u5217\u8868\uff0c\u6ee1\u8db3\u5faa\u73af\u6761\u4ef6\u4f1a\u4e00\u76f4\u5faa\u73af\uff0c\u4e0d\u6ee1\u8db3\u5219\u9000\u51fa\u5faa\u73af\uff0c\u5176\u8bed\u6cd5\u683c\u5f0f\u4ee5while\u2026do\u5f00\u5934\uff0cdone\u7ed3\u5c3e\u4e0e </p> <p>while \u5173\u8054\u7684\u8fd8\u6709\u4e00\u4e2a until \u8bed\u53e5\uff0c\u5b83\u4e0e while \u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u662f\u5f53\u6761\u4ef6\u8868\u8fbe\u5f0f\u4e3a false \u65f6\u624d\u5faa\u73af\uff0c\u5b9e\u9645\u4f7f\u7528\u4e2d\u6bd4\u8f83\u5c11\uff0c\u8fd9\u91cc\u4e0d\u518d\u8bb2\u89e3\u3002</p> <pre><code>while  (\u8868\u8fbe\u5f0f)\ndo\n  \u8bed\u53e51\ndone\n</code></pre> <p>break \u548c continue \u8bed\u53e5</p> <pre><code># break \u548c continue \u8bed\u53e5\n  break \u662f\u7ec8\u6b62\u5faa\u73af\u3002\n  continue \u662f\u8df3\u51fa\u5f53\u524d\u5faa\u73af\u3002\n#\u793a\u4f8b 1\uff1a\u5728\u6b7b\u5faa\u73af\u4e2d\uff0c\u6ee1\u8db3\u6761\u4ef6\u7ec8\u6b62\u5faa\u73af\nwhile true; do\n  let N++\n  if [ $N -eq 5 ]; then\n    break\nfi\n  echo $N\ndone\n\u8f93\u51fa\uff1a1 2 3 4\n\n#\u793a\u4f8b 2\uff1a\u4e3e\u4f8b\u5b50\u8bf4\u660e continue \u7528\u6cd5\nN=0\nwhile [ $N -lt 5 ]; do\n  let N++\nif [ $N -eq 3 ]; then\n  continue\nfi\n  echo $N\ndone\n\n\u8f93\u51fa\uff1a1 2 4\n\n# \u6253\u5370 1-100 \u6570\u5b57\ni=0\nwhile ((i&lt;=100))\ndo\n        echo  $i\n        i=`expr $i + 1`\ndone\n</code></pre> <p>While \u5faa\u73af\u6c42 1-100 \u7684\u603b\u548c \u2014\u6848\u4f8b</p> <pre><code>\n#!/bin/bash\n\nj=0\ni=1\nwhile ((i&lt;=100))\ndo\n     j=`expr $i + $j`\n     ((i++))\ndone\necho $j\n</code></pre> <p></p> <p>\u6bcf 10 \u79d2\u5faa\u73af\u5224\u65ad\u4e00\u6b21 hbs \u7528\u6237\u662f\u5426\u767b\u5f55\u7cfb\u7edf \u2014\u6848\u4f8b</p> <pre><code> vim login.sh \n#!/bin/bash\n#Check File to change. \n\nUSERS=\"hbs\"\nwhile true\ndo\n        echo \"The Time is `date +%F-%T`\"\n        sleep 10\n        NUM=`who|grep \"$USERS\"|wc -l`\n        if [[ $NUM -ge 1 ]];then\n                echo \"The $USERS is login in system.\"\n        fi\ndone\n</code></pre> <p></p>"},{"location":"chap8/14linux_shell/#34-case","title":"3.4 case \u9009\u62e9\u8bed\u53e5\u4ecb\u7ecd","text":"<p>Case\u9009\u62e9\u8bed\u53e5\uff0c\u4e3b\u8981\u7528\u4e8e\u5bf9\u591a\u4e2a\u9009\u62e9\u6761\u4ef6\u8fdb\u884c\u5339\u914d\u8f93\u51fa\uff0c\u4e0eif elif\u8bed\u53e5\u7ed3\u6784\u7c7b\u4f3c\uff0c\u901a\u5e38\u7528\u4e8e\u811a\u672c\u4f20\u9012\u8f93\u5165\u53c2\u6570\uff0c\u6253\u5370\u51fa\u8f93\u51fa\u7ed3\u679c\u53ca\u5185\u5bb9\uff0c\u5176\u8bed\u6cd5\u683c\u5f0f\u4ee5Case\u2026in\u5f00\u5934\uff0cesac\u7ed3\u5c3e\u3002</p> <p>\u8bed\u6cd5\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>case \u6a21\u5f0f\u540d  in\n  \u6a21\u5f0f 1)\n    \u547d\u4ee4\n    ;;\n  \u6a21\u5f0f 2)\n    \u547d\u4ee4\n    ;;\n*)\n\u4e0d\u7b26\u5408\u4ee5\u4e0a\u6a21\u5f0f\u6267\u884c\u7684\u547d\u4ee4\nesac\n# \u6bcf\u4e2a\u6a21\u5f0f\u5fc5\u987b\u4ee5\u53f3\u62ec\u53f7\u7ed3\u675f\uff0c\u547d\u4ee4\u7ed3\u5c3e\u4ee5\u53cc\u5206\u53f7\u7ed3\u675f\u3002\n</code></pre> <p>\u4f7f\u7528 case \u7f16\u5199\u4e00\u4e2a httpd \u670d\u52a1\u542f\u52a8\u811a\u672c</p> <pre><code># vim httpd_start.sh \n# check http server start|stop|starus\n\nwhile true\ndo\n    echo -e \"\n    \\033[31m start \\033[0m\n    \\033[32m stop \\033[0m \n    \\033[33m status \\033[0m\n    \\033[34m quit \\033[0m \n\"\nread -p \"\u8bf7\u8f93\u5165\u4f60\u7684\u9009\u62e9start|stop|quit\uff1a\" char\ncase $char in\nstart)\n    systemctl start httpd &amp;&amp; echo \"httpd\u670d\u52a1\u5df2\u7ecf\u5f00\u542f\" || echo \"\u5f00\u542f\u5931\u8d25\"\n;;\nstop)\n    systemctl stop httpd &amp;&amp; echo \"httpd\u670d\u52a1\u5df2\u7ecf\u5173\u95ed\" || echo \"\u5173\u95ed\u5931\u8d25\"\n;;\nrestart)\n    systemctl restart httpd &amp;&amp; echo \"httpd\u670d\u52a1\u5df2\u7ecf\u91cd\u542f\" || echo \"\u91cd\u542f\u5931\u8d25\n\"\n;;\nstatus)\n    systemctl status httpd &amp;&amp; echo -e \"\n        httpd \u7684\u670d\u52a1\u72b6\u6001\n\n;;\nquit)\n</code></pre>"},{"location":"chap8/14linux_shell/#35-select","title":"3.5 select \u9009\u62e9\u8bed\u53e5\u4ecb\u7ecd","text":"<p>select \u662f\u4e00\u4e2a\u7c7b\u4f3c\u4e8e for \u5faa\u73af\u7684\u8bed\u53e5</p> <p>Select\u8bed\u53e5\u4e00\u822c\u7528\u4e8e\u9009\u62e9\uff0c\u5e38\u7528\u4e8e\u9009\u62e9\u83dc\u5355\u7684\u521b\u5efa\uff0c\u53ef\u4ee5\u914d\u5408PS3\u6765\u505a\u6253\u5370\u83dc\u5355\u7684\u8f93\u51fa\u4fe1\u606f\uff0c\u5176\u8bed\u6cd5\u683c\u5f0f\u4ee5select\u2026in do\u5f00\u5934\uff0cdone\u7ed3\u5c3e\uff1a</p> <pre><code>select i in \uff08\u8868\u8fbe\u5f0f\uff09 \ndo\n\u8bed\u53e5\ndone\n\n# \u9009\u62e9mysql \u7248\u672c\n#!/bin/bash\n\nPS3=\"Select a number: \"\nwhile true; do\nselect mysql_version in 5.1 5.6 quit;\n do\n  case $mysql_version in\n  5.1)\n    echo \"mysql 5.1\"\n      break\n      ;;\n  5.6)\n    echo \"mysql 5.6\"\n       break\n       ;;\n  quit)\n    exit\n    ;;\n  *)\n    echo \"Input error, Please enter again!\"\n      break\nesac\n done\ndone\n</code></pre> <p>\u4f7f\u7528 select \u6253\u5370 lnmp \u83dc\u5355\u680f \u2014\u6848\u4f8b</p> <p>\u6253\u5370 lnmp \u9009\u62e9\u83dc\u5355</p> <pre><code>#!/bin/bash\n\nPS3=\"Please enter you select install menu:\"\nselect i in http php mysql quit\ndo\ncase $i in\n        http)\n        echo -e \"\n                \\033[31m Test Httpd \\033[0m\" \n        ;;\n        php)\n        echo  -e \"\\033[32m Test PHP\\033[0m\"\n        ;;\n        mysql)\n        echo -e \"\\033[33m Test MySQL.\\033[0m\"\n        ;;\n        quit)\n        echo -e \"\\033[32m The System exit.\\033[0m\"\n        exit\nesac\ndone\n</code></pre> <p></p>"},{"location":"chap8/14linux_shell/#36-shell","title":"3.6 shell \u51fd\u6570\u3001\u6570\u7ec4 \u7f16\u7a0b \u5b9e\u6218","text":"<p>Shell\u5141\u8bb8\u5c06\u4e00\u7ec4\u547d\u4ee4\u96c6\u6216\u8bed\u53e5\u5f62\u6210\u4e00\u4e2a\u53ef\u7528\u5757\uff0c\u8fd9\u4e9b\u5757\u79f0\u4e3aShell\u51fd\u6570\uff0cShell\u51fd\u6570\u7684\u7528\u4e8e\u5728\u4e8e\u53ea\u9700\u5b9a\u4e49\u4e00\u6b21\uff0c\u540e\u671f\u968f\u65f6\u4f7f\u7528\u5373\u53ef\uff0c\u65e0\u9700\u5728Shell\u811a\u672c\u4e2d\u6dfb\u52a0\u91cd\u590d\u7684\u8bed\u53e5\u5757\uff0c\u5176\u8bed\u6cd5\u683c\u5f0f\u4ee5<code>function name\uff08\uff09{\u5f00\u5934\uff0c\u4ee5}\u7ed3\u5c3e</code>\u3002</p> <p>Shell\u7f16\u7a0b\u51fd\u6570\u9ed8\u8ba4\u4e0d\u80fd\u5c06\u53c2\u6570\u4f20\u5165\uff08\uff09\u5185\u90e8\uff0cShell\u51fd\u6570\u53c2\u6570\u4f20\u9012\u5728\u8c03\u7528\u51fd\u6570\u540d\u79f0\u4f20\u9012\uff0c\u4f8b\u5982<code>name args1 args2</code>\u3002</p> <pre><code># \u51fd\u6570\u8bed\u6cd5\nfunc() {\ncommand1\ncommand1\n\u2026\u2026\n}\n\nfun  # \u76f4\u63a5\u8c03\u7528\u51fd\u6570\u540d\n\n# Shell \u51fd\u6570\u5f88\u7b80\u5355\uff0c\u51fd\u6570\u540d\u540e\u8ddf\u53cc\u62ec\u53f7\uff0c\u518d\u8ddf\u53cc\u5927\u62ec\u53f7\u3002\u901a\u8fc7\u51fd\u6570\u540d\u76f4\u63a5\u8c03\u7528\uff0c\u4e0d\u52a0\u5c0f\u62ec\u53f7\u3002\n#!/bin/bash\nfunc() {\nVAR=$((1+1))\nreturn $VAR\necho \"This is a function.\"\n}\nfunc\necho $?\n\n# bash test.sh \n2\n</code></pre> <pre><code># \u6570\u7ec4\u662f\u76f8\u540c\u7c7b\u578b\u7684\u5143\u7d20\u6309\u4e00\u5b9a\u987a\u5e8f\u6392\u5217\u7684\u96c6\u5408\u3002\n\u683c\u5f0f\uff1aarray=(\u5143\u7d20 1 \u5143\u7d20 2 \u5143\u7d20 3 ...)\n\u7528\u5c0f\u62ec\u53f7\u521d\u59cb\u5316\u6570\u7ec4\uff0c\u5143\u7d20\u4e4b\u95f4\u7528\u7a7a\u683c\u5206\u9694\u3002\n \u5b9a\u4e49\u65b9\u6cd5 1\uff1a\u521d\u59cb\u5316\u6570\u7ec4 array=(a b c)\n \u5b9a\u4e49\u65b9\u6cd5 2\uff1a\u65b0\u5efa\u6570\u7ec4\u5e76\u6dfb\u52a0\u5143\u7d20 array[\u4e0b\u6807]=\u5143\u7d20\n \u5b9a\u4e49\u65b9\u6cd5 3\uff1a\u5c06\u547d\u4ee4\u8f93\u51fa\u4f5c\u4e3a\u6570\u7ec4\u5143\u7d20array=($(command))\n</code></pre> <p>\u5b9a\u4e49\u4e00\u4e2a httpd \u5b89\u88c5\u7684\u51fd\u6570 \u2014\u6848\u4f8b</p> <pre><code> vim xx.sh \n#!/bin/bash\n#auto install apache\n#By author rivers 2021-09-27 \n#Httpd define path variable\nFILES=httpd-2.2.31.tar.bz2\nLES_DIR=httpd-2.2.31\nURL=http://mirrors.cnnic.cn/apache/httpd/\nPREFIX=/usr/local/apache2/\nfunction Apache_install ()\n{\n#Install httpd web server \nif [[ \"$1\" -eq \"1\" ]];then\n        wget -c $URL/$FILES &amp;&amp;  tar -jxvf $FILES &amp;&amp; cd $FILES_DIR &amp;&amp;./configure\n        if [ $? -eq 0 ];then\n                make &amp;&amp; make install\n                echo -e \"\\n\\033[32m--------------------------------------------\n                echo -e \"\\033[32mThe $FILES_DIR Server Install Success !\\033[0m\n        else\n                echo -e \"\\033[32mThe $FILES_DIR Make or Make install ERROR,Plea\n                exit 0\n        fi\nfi\n}\nApache_install 1\n# \u8c03\u7528\u51fd\u6570\uff0c\u4f20\u53c2\u4e3a1\n</code></pre> <p>\u904d\u5386\u6570\u7ec4\u5143\u7d20 \u2014 \u6848\u4f8b</p> <pre><code>#\u65b9\u6cd5 1\uff1a\n#!/bin/bash\nIP=(10.0.0.1 10.0.0.2 10.0.0.3)\nfor ((i=0;i&lt;${#IP[*]};i++)); do\necho ${IP[$i]}\ndone\n# bash test.sh\n10.0.0.1\n10.0.0.2\n10.0.0.3\n\n#\u65b9\u6cd5 2\uff1a\n#!/bin/bash\nIP=(10.0.0.1 10.0.0.2 10.0.0.3)\nfor   IP   in ${IP[*]}; do\necho $IP\ndone\n</code></pre>"},{"location":"chap8/14linux_shell/#shell_2","title":"\u56db\u3001shell \u7f16\u7a0b\u5b9e\u6218 \u6848\u4f8b","text":""},{"location":"chap8/14linux_shell/#41-shell","title":"4.1 shell \u811a\u672c\u5b9e\u6218\u4e4b \u7cfb\u7edf\u5907\u4efd\u811a\u672c \u2014\u6848\u4f8b","text":"<p>Tar \u5de5\u5177\u5168\u5907\u3001\u589e\u91cf\u5907\u4efd\u7f51\u7ad9\uff0cShell \u811a\u672c\u5b9e\u73b0\u81ea\u52a8\u6253\u5305\u5907\u4efd</p> <pre><code>#!/bin/bash\n#Auto Backup Linux System Files\n#by author rivers on 2021-09-28\n\nSOURCE_DIR=(\n    $*\n)\nTARGET_DIR=/data/backup/\nYEAR=`date +%Y`\nMONTH=`date +%m`\nDAY=`date +%d`\nWEEK=`date +%u`\nA_NAME=`date +%H%M`\nFILES=system_backup.tgz\nCODE=$?\nif\n    [ -z \"$*\" ]\uff1bthen\n    echo -e \"\\033[32mUsage:\\nPlease Enter Your Backup Files or Directories\\n--------------------------------------------\\n\\nUsage: { $0 /boot /etc}\\033[0m\"\n    exit\nfi\n#Determine Whether the Target Directory Exists\nif\n    [ ! -d $TARGET_DIR/$YEAR/$MONTH/$DAY ]\uff1bthen\n    mkdir -p $TARGET_DIR/$YEAR/$MONTH/$DAY\n    echo -e \"\\033[32mThe $TARGET_DIR Created Successfully !\\033[0m\"\nfi\n#EXEC Full_Backup Function Command\nFull_Backup()\n{\nif\n    [ \"$WEEK\" -eq \"7\" ]\uff1bthen\n    rm -rf $TARGET_DIR/snapshot\n    cd $TARGET_DIR/$YEAR/$MONTH/$DAY \uff1btar -g $TARGET_DIR/snapshot -czvf $FILES ${SOURCE_DIR[@]}\n    [ \"$CODE\" == \"0\" ]&amp;&amp;echo -e  \"--------------------------------------------\\n\\033[32mThese Full_Backup System Files Backup Successfully !\\033[0m\"\nfi\n}\n#Perform incremental BACKUP Function Command\nAdd_Backup()\n{\n   if\n        [ $WEEK -ne \"7\" ]\uff1bthen\n        cd $TARGET_DIR/$YEAR/$MONTH/$DAY \uff1btar -g $TARGET_DIR/snapshot -czvf $A_NAME$FILES ${SOURCE_DIR[@]}\n        [ \"$CODE\" == \"0\" ]&amp;&amp;echo -e  \"-----------------------------------------\\n\\033[32mThese Add_Backup System Files $TARGET_DIR/$YEAR/$MONTH/$DAY/${YEAR}_$A_NAME$FILES Backup Successfully !\\033[0m\"\n   fi\n}\nsleep 3 \nFull_Backup\uff1bAdd_Backup\n</code></pre>"},{"location":"chap8/14linux_shell/#42-shell","title":"4.2 shell \u811a\u672c \u5b9e\u6218 \u4e4b\u6536\u96c6\u7cfb\u7edf\u4fe1\u606f \u2014\u6848\u4f8b","text":"<p>Shell \u811a\u672c\u5b9e\u73b0\u670d\u52a1\u5668\u4fe1\u606f\u81ea\u52a8\u6536\u96c6</p> <pre><code>cat &lt;&lt;EOF\n++++++++++++++++++++++++++++++++++++++++++++++\n++++++++Welcome to use system Collect+++++++++\n++++++++++++++++++++++++++++++++++++++++++++++\nEOF\nip_info=`ifconfig |grep \"Bcast\"|tail -1 |awk '{print $2}'|cut -d: -f 2`\ncpu_info1=`cat /proc/cpuinfo |grep 'model name'|tail -1 |awk -F: '{print $2}'|sed 's/^ //g'|awk '{print $1,$3,$4,$NF}'`\ncpu_info2=`cat /proc/cpuinfo |grep \"physical id\"|sort |uniq -c|wc -l`\nserv_info=`hostname |tail -1`\ndisk_info=`fdisk -l|grep \"Disk\"|grep -v \"identifier\"|awk '{print $2,$3,$4}'|sed 's/,//g'`\nmem_info=`free -m |grep \"Mem\"|awk '{print \"Total\",$1,$2\"M\"}'`\nload_info=`uptime |awk '{print \"Current Load: \"$(NF-2)}'|sed 's/\\,//g'`\nmark_info='BeiJing_IDC'\necho -e \"\\033[32m-------------------------------------------\\033[1m\"\necho IPADDR:${ip_info}\necho HOSTNAME:$serv_info\necho CPU_INFO:${cpu_info1} X${cpu_info2}\necho DISK_INFO:$disk_info\necho MEM_INFO:$mem_info\necho LOAD_INFO:$load_info\necho -e \"\\033[32m-------------------------------------------\\033[0m\"\necho -e -n \"\\033[36mYou want to write the data to the databases? \\033[1m\" \uff1bread ensure\n\nif      [ \"$ensure\" == \"yes\" -o \"$ensure\" == \"y\" -o \"$ensure\" == \"Y\" ];then\n        echo \"--------------------------------------------\"\n        echo -e  '\\033[31mmysql -uaudit -p123456 -D audit -e ''' \"insert into audit_system values('','${ip_info}','$serv_info','${\ncpu_info1} X${cpu_info2}','$disk_info','$mem_info','$load_info','$mark_info')\" ''' \\033[0m '\n        mysql -uroot -p123456 -D test -e \"insert into audit_system values('','${ip_info}','$serv_info','${cpu_info1} X${cpu_info2}\n','$disk_info','$mem_info','$load_info','$mark_info')\"\nelse\n        echo \"Please wait\uff0cexit......\"\n        exit\nfi\n</code></pre>"},{"location":"chap8/14linux_shell/#43-shell-lnmp","title":"4.3 shell \u811a\u672c\u5b9e\u6218 \u4e4b \u4e00\u952e\u90e8\u7f72 lnmp \u67b6\u6784 \u2014 \u6848\u4f8b","text":"<p>\u6279\u91cf\u90e8\u7f72 lnmp \u67b6\u6784</p> <pre><code>[root@web-server01~/script]# vim lnmp.sh \n#!/bin/bash\n#install lnmp\n#by author rivers on 2021-9-28\n\n# nginx \u73af\u5883\u51c6\u5907\nNginx_url=https://nginx.org/download/nginx-1.20.1.tar.gz\nNginx_prefix=/usr/local/nginx\n\n# mysql \u73af\u5883\u51c6\u5907\nMysql_version=mysql-5.5.20.tar.gz\nMysql_dir=mysql-5.5.20\nMysql_url=https://downloads.mysql.com/archives/get/p/23/file/mysql-5.5.20.tar.gz\nMysql_prefix=/usr/local/mysql/\n\n# php \u73af\u5883\u51c6\u5907\nPhp_version=php-7.2.10.tar.gz\nPhp_prefix=/usr/local/php-7.2.10/\n\n\nfunction nginx_install(){\n\nif [[ \"$1\" -eq \"1\" ]];then\n        if [ $? -eq 0 ];then\n                make &amp;&amp; make install\n        fi\n\nfi\n}\n\n\n\nfunction mysql_install(){\nif [[ \"$1\" -eq \"2\" ]];then\n-DMYSQL_UNIX_ADDR=/tmp/mysql.sock \\\n-DMYSQL_DATADIR=/data/mysql \\\n-DSYSCONFDIR=/etc \\\n-DMYSQL_USER=mysql \\\n-DMYSQL_TCP_PORT=3306 \\\n-DWITH_XTRADB_STORAGE_ENGINE=1 \\\n-DWITH_INNOBASE_STORAGE_ENGINE=1 \\\n-DWITH_PARTITION_STORAGE_ENGINE=1 \\\n-DWITH_BLACKHOLE_STORAGE_ENGINE=1 \\\n-DWITH_MYISAM_STORAGE_ENGINE=1 \\\n-DWITH_READLINE=1 \\\n-DENABLED_LOCAL_INFILE=1 \\\n-DWITH_EXTRA_CHARSETS=1 \\\n-DDEFAULT_CHARSET=utf8 \\\n-DDEFAULT_COLLATION=utf8_general_ci \\\n-DEXTRA_CHARSETS=all \\\n                echo -e \"\\033[32mThe $Mysql_dir Server Install Success !\\033[0m\"\n        else\n                echo -e \"\\033[32mThe $Mysql_dir Make or Make install ERROR,Please Check......\"\n                exit 0\nfi\n/bin/cp support-files/my-small.cnf  /etc/my.cnf\n/bin/cp support-files/mysql.server /etc/init.d/mysqld\nchmod +x /etc/init.d/mysqld\nchkconfig --add mysqld\nchkconfig mysqld on\nfi\n}\n\n\nfunction php_install(){\nif [[ \"$1\" -eq \"3\" ]];then\n        if [ $? -eq 0 ];then\n                make ZEND_EXTRA_LIBS='-liconv' &amp;&amp; make install\nif [[ \"$1\" -eq \"3\" ]];then\n wget $Php_url &amp;&amp; tar xf $Php_version &amp;&amp; cd $Php_dir &amp;&amp; yum install   bxml2* bzip2* libcurl*  libjpeg* libpng* freetype* gmp* libm\ncrypt* readline* libxslt* -y &amp;&amp; ./configure --prefix=$Php_prefix --disable-fileinfo --enable-fpm --with-config-file-path=/etc --wi\n  -config-file-scan-dir=/etc/php.d --with-openssl --with-zlib --with-curl --enable-ftp --with-gd --with-xmlrpc --with-jpeg-dir --w\nith-png-dir --with-freetype-dir --enable-gd-native-ttf --enable-mbstring --with-mcrypt=/usr/local/libmcrypt --enable-zip --enable-\nmysqlnd --with-mysqli=mysqlnd --with-pdo-mysql=mysqlnd --with-mysql-sock=/var/lib/mysql/mysql.sock --without-pear --enable-bcmath\n        if [ $? -eq 0 ];then\n                make ZEND_EXTRA_LIBS='-liconv' &amp;&amp; make install\n                echo -e \"\\n\\033[32m-----------------------------------------------\\033[0m\"\n                echo -e \"\\033[32mThe $Php_version Server Install Success !\\033[0m\"\n        else\n                echo -e \"\\033[32mThe $Php_version Make or Make install ERROR,Please Check......\"\n                exit 0\n        fi\nfi\n}\n\n\nPS3=\"Please enter you select install menu:\"\nselect i in nginx mysql php quit\ndo\n\"lnmp.sh\" 113L, 3516C written                                                                                   \n[root@web-server01~/script]# vim lnmp.sh \nchkconfig --add mysqld\nchkconfig mysqld on\nfi\n}\n\n\nfunction php_install(){\nif [[ \"$1\" -eq \"3\" ]];then\n        if [ $? -eq 0 ];then\n                make ZEND_EXTRA_LIBS='-liconv' &amp;&amp; make install\n                echo -e \"\\n\\033[32m-----------------------------------------------\\033[0m\"\n                echo -e \"\\033[32mThe $Php_version Server Install Success !\\033[0m\"\n        else\n                echo -e \"\\033[32mThe $Php_version Make or Make install ERROR,Please Check......\"\n                exit 0\n        fi\nfi\n}\n\n\nPS3=\"Please enter you select install menu:\"\nselect i in nginx mysql php quit\ndo\n\ncase $i in\n        nginx)\n        nginx_install 1\n        ;;\n        mysql)\n        mysql_install 2\n        ;;\n        php)\n        php_install 3\n        ;;\n        quit)\n        exit\nesac\ndone\n</code></pre>"},{"location":"chap8/15grep_learn/","title":"\u4f7f\u7528grep\u5206\u6790\u65e5\u5fd7","text":""},{"location":"chap8/15grep_learn/#grep_1","title":"grep\u548c\u65e5\u5fd7\u5206\u6790","text":""},{"location":"chap8/15grep_learn/#_1","title":"\u9694\u79bb\u9519\u8bef","text":"<p>\u8c03\u8bd5\u901a\u5e38\u4ece\u8bc6\u522b\u65e5\u5fd7\u4e2d\u7684\u9519\u8bef\u5f00\u59cb\u3002\u4e3a\u4e86\u4f7f\u7528 \u9694\u79bb\u9519\u8befgrep\uff0c\u6211\u4f7f\u7528\u4ee5\u4e0b\u6280\u672f\uff1a</p> <ul> <li>\u641c\u7d22\u9519\u8bef\u5173\u952e\u5b57\uff1a\u9996\u5148\u641c\u7d22\u5e38\u89c1\u9519\u8bef\u5173\u952e\u5b57\uff0c\u4f8b\u5982<code>\"error\"</code>\u3001<code>\"exception\"</code>\u6216\u3002\u4f7f\u7528\u5e26\u6709\u6807\u5fd7\u7684\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u641c\u7d22\uff0c\u4ee5\u786e\u4fdd\u6355\u83b7\u5927\u5c0f\u5199\u7684\u53d8\u5316\u3002<code>fail, invalid, -i</code></li> <li>\u591a\u4e2a\u6a21\u5f0f\u641c\u7d22\uff1a\u4f7f\u7528\u8be5<code>-e</code>\u6807\u5fd7\u540c\u65f6\u641c\u7d22\u591a\u4e2a\u6a21\u5f0f\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u641c\u7d22\"error\"\u548c\"warning\"\u6d88\u606f\u4ee5\u6db5\u76d6\u66f4\u5e7f\u6cdb\u7684\u6f5c\u5728\u95ee\u9898\u3002</li> <li>\u4e0a\u4e0b\u6587\u641c\u7d22\uff1a\u4f7f\u7528\u8be5<code>-C</code>\u6807\u5fd7\u5728\u6bcf\u4e2a\u5339\u914d\u9879\u5468\u56f4\u663e\u793a\u4e00\u5b9a\u6570\u91cf\u7684\u4e0a\u4e0b\u6587\u884c\u3002\u8fd9\u6709\u52a9\u4e8e\u60a8\u4e86\u89e3\u53d1\u751f\u9519\u8bef\u7684\u4e0a\u4e0b\u6587\u3002</li> </ul>"},{"location":"chap8/15grep_learn/#_2","title":"\u8ffd\u8e2a\u95ee\u9898","text":"<p>\u4e00\u65e6\u9694\u79bb\u4e86\u9519\u8bef\uff0c\u5c31\u53ef\u4ee5\u66f4\u6df1\u5165\u5730\u6316\u6398\u5e76\u8ffd\u8e2a\u95ee\u9898\u7684\u6839\u6e90\uff1a</p> <ol> <li>\u57fa\u4e8e\u65f6\u95f4\u6233\u7684\u641c\u7d22\uff1a\u5982\u679c\u60a8\u7684\u65e5\u5fd7\u5305\u542b\u65f6\u95f4\u6233\uff0c\u8bf7\u4f7f\u7528\u5b83\u4eec\u6765\u8ffd\u8e2a\u5bfc\u81f4\u95ee\u9898\u7684\u4e8b\u4ef6\u987a\u5e8f\u3002\u60a8\u53ef\u4ee5grep\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f\u4e00\u8d77\u4f7f\u7528\u6765\u5339\u914d\u7279\u5b9a\u7684\u65f6\u95f4\u8303\u56f4\u3002</li> <li>\u552f\u4e00\u6807\u8bc6\u7b26\uff1a\u5982\u679c\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u4e3a\u4e8b\u4ef6\u751f\u6210\u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u8bf7\u4f7f\u7528\u8fd9\u4e9b\u6807\u8bc6\u7b26\u6765\u8ddf\u8e2a\u65e5\u5fd7\u6761\u76ee\u4e2d\u7684\u4e8b\u4ef6\u6d41\u3002\u4f7f\u7528 \u641c\u7d22\u8fd9\u4e9b\u6807\u8bc6\u7b26grep\u3002</li> <li>\u4e0e\u5176\u4ed6\u5de5\u5177\u7ed3\u5408\uff1a<code>grep</code>\u4e0e\u5176\u4ed6\u547d\u4ee4\u884c\u5de5\u5177\uff08\u5982<code>sort</code> <code>uniq</code>\u548c \uff09\u7ed3\u5408<code>awk</code>\uff0c\u6839\u636e\u5404\u79cd\u6761\u4ef6\u805a\u5408\u548c\u5206\u6790\u65e5\u5fd7\u6761\u76ee\u3002</li> </ol>"},{"location":"chap8/15grep_learn/#_3","title":"\u8bc6\u522b\u6a21\u5f0f","text":"<p>\u65e5\u5fd7\u5206\u6790\u4e0d\u4ec5\u4ec5\u662f\u53d1\u73b0\u9519\u8bef\uff1b\u800c\u662f\u53d1\u73b0\u9519\u8bef\u3002\u5b83\u8fd8\u6d89\u53ca\u8bc6\u522b\u53ef\u80fd\u63d0\u4f9b\u6027\u80fd\u6216\u7528\u6237\u884c\u4e3a\u6d1e\u5bdf\u7684\u6a21\u5f0f\uff1a</p> <ul> <li>\u9891\u7387\u5206\u6790\uff1a\u7528\u4e8egrep\u8ba1\u7b97\u7279\u5b9a\u6a21\u5f0f\u7684\u51fa\u73b0\u6b21\u6570\u3002\u8fd9\u53ef\u4ee5\u5e2e\u52a9\u60a8\u8bc6\u522b\u7ecf\u5e38\u53d1\u751f\u7684\u4e8b\u4ef6\u6216\u9519\u8bef\u3002</li> <li>\u81ea\u5b9a\u4e49\u6a21\u5f0f\u5339\u914d\uff1a\u5229\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u6839\u636e\u5e94\u7528\u7a0b\u5e8f\u7684\u72ec\u7279\u65e5\u5fd7\u683c\u5f0f\u5b9a\u4e49\u81ea\u5b9a\u4e49\u6a21\u5f0f\u3002</li> <li>\u5f02\u5e38\u68c0\u6d4b\uff1a\u6b63\u5219\u8868\u8fbe\u5f0f\u8fd8\u53ef\u4ee5\u901a\u8fc7\u5b9a\u4e49\u201c\u6b63\u5e38\u201d\u65e5\u5fd7\u6761\u76ee\u7684\u5916\u89c2\u5e76\u641c\u7d22\u4e0e\u8be5\u6a21\u5f0f\u7684\u504f\u5dee\u6765\u5e2e\u52a9\u60a8\u68c0\u6d4b\u5f02\u5e38\u3002</li> </ul>"},{"location":"chap8/15grep_learn/#_4","title":"\u4f8b\u5b50","text":""},{"location":"chap8/15grep_learn/#_5","title":"\u9694\u79bb\u9519\u8bef","text":"<p>\u5728\u65e5\u5fd7\u6587\u4ef6\u4e2d\u641c\u7d22\u5305\u542b\u5355\u8bcd\u201cerror\u201d\u7684\u884c\uff1a</p> <pre><code>grep -i \"error\" application.log\n</code></pre> <p>\u5728\u65e5\u5fd7\u6587\u4ef6\u4e2d\u641c\u7d22\u5305\u542b\u201c\u9519\u8bef\u201d\u6216\u201c\u8b66\u544a\u201d\u7684\u884c\uff1a</p> <pre><code>grep -i -e \"error\" -e \"warning\" application.log\n</code></pre> <p>\u663e\u793a\u5305\u542b\u5355\u8bcd\u201cerror\u201d\u7684\u884c\u4ee5\u53ca\u524d\u540e\u4e24\u884c\u4e0a\u4e0b\u6587\uff1a</p> <pre><code>grep -C 2 \"error\" application.log\n</code></pre>"},{"location":"chap8/15grep_learn/#_6","title":"\u8ffd\u8e2a\u95ee\u9898","text":"<p>\u641c\u7d22\u7279\u5b9a\u65f6\u95f4\u8303\u56f4\u5185\u7684\u65e5\u5fd7\u6761\u76ee\uff08\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u8fdb\u884c\u65f6\u95f4\u6233\u5339\u914d\uff09\uff1a</p> <pre><code>grep \"^\\[2023-08-31 10:..:..]\" application.log\n</code></pre> <p>\u641c\u7d22\u4e0e\u7279\u5b9a\u4ea4\u6613 ID \u5173\u8054\u7684\u6761\u76ee\uff1a</p> <pre><code>grep \"TransactionID: 12345\" application.log\n</code></pre> <p>\u8ba1\u7b97\u7279\u5b9a\u9519\u8bef\u7684\u51fa\u73b0\u6b21\u6570\uff1a</p> <pre><code>grep -c \"Connection refused\" application.log\n</code></pre>"},{"location":"chap8/15grep_learn/#_7","title":"\u8bc6\u522b\u6a21\u5f0f","text":"<p>\u8ba1\u7b97\u65e5\u5fd7\u6587\u4ef6\u4e2d\u6bcf\u79cd\u7c7b\u578b\u9519\u8bef\u7684\u51fa\u73b0\u6b21\u6570\uff1a</p> <pre><code>grep -i -o \"error\" application.log | sort | uniq -c\n</code></pre> <p>\u641c\u7d22\u5305\u542b IP \u5730\u5740\u7684\u65e5\u5fd7\u6761\u76ee\uff1a</p> <pre><code>grep -E \"[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+\" application.log\n</code></pre> <p>\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u4f7f\u7528\u8d1f\u5411\u5148\u884c\u68c0\u6d4b\u5f02\u5e38\u6a21\u5f0f\uff1a</p> <pre><code>grep -E \"^(?!.*normal).*error\" application.log\n</code></pre>"},{"location":"chap8/16linux_ops/","title":"Linux \u5b9e\u7528\u8fd0\u7ef4\u547d\u4ee4 - Update","text":""},{"location":"chap8/16linux_ops/#1-xargs","title":"1\u3001\u5b9e\u7528\u7684 xargs \u547d\u4ee4","text":"<p>\u6bd4\u5982\u8bf4\u6211\u4eec\u60f3\u627e\u51fa\u67d0\u4e2a\u8def\u5f84\u4e0b\u4ee5 <code>.conf</code>\u7ed3\u5c3e\u7684\u6587\u4ef6\uff0c\u5e76\u5c06\u8fd9\u4e9b\u6587\u4ef6\u8fdb\u884c\u5206\u7c7b\uff0c\u90a3\u4e48\u666e\u901a\u7684\u505a\u6cd5\u5c31\u662f\u5148\u5c06\u4ee5 <code>.conf</code>\u7ed3\u5c3e\u7684\u6587\u4ef6\u5148\u627e\u51fa\u6765\uff0c\u7136\u540e\u8f93\u51fa\u5230\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u63a5\u7740cat\u8fd9\u4e2a\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528file\u6587\u4ef6\u5206\u7c7b\u547d\u4ee4\u53bb\u5bf9\u8f93\u51fa\u7684\u6587\u4ef6\u8fdb\u884c\u5206\u7c7b\u3002</p> <p>\u8fd9\u4e2a\u666e\u901a\u7684\u65b9\u6cd5\u8fd8\u7684\u786e\u662f\u7565\u663e\u9ebb\u70e6\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019xargs\u547d\u4ee4\u5c31\u6d3e\u4e0a\u7528\u573a\u4e86\u3002</p> <p>\u4f8b1\uff1a\u627e\u51fa / \u76ee\u5f55\u4e0b\u4ee5.conf \u7ed3\u5c3e\u7684\u6587\u4ef6\uff0c\u5e76\u8fdb\u884c\u6587\u4ef6\u5206\u7c7b</p> <pre><code># find / -name *.conf -type f -print | xargs file\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p>"},{"location":"chap8/16linux_ops/#2","title":"2\u3001\u547d\u4ee4\u6216\u811a\u672c\u540e\u53f0\u8fd0\u884c","text":"<p>\u6bd4\u5982\u8bf4\u6211\u4eec\u60f3\u628a\u6570\u636e\u5e93\u7684\u5bfc\u51fa\u64cd\u4f5c\u540e\u53f0\u8fd0\u884c\uff0c\u5e76\u4e14\u5c06\u547d\u4ee4\u7684\u64cd\u4f5c\u8f93\u51fa\u8bb0\u5f55\u5230\u6587\u4ef6\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u505a\uff1a</p> <pre><code>nohup mysqldump -uroot -pxxxxx --all-databases &gt; ./alldatabases.sql &amp;\uff08xxxxx\u662f\u5bc6\u7801\uff09\n</code></pre> <p>\u5f53\u7136\u5982\u679c\u4f60\u4e0d\u60f3\u5bc6\u7801\u660e\u6587\uff0c\u4f60\u8fd8\u53ef\u4ee5\u8fd9\u4e48\u505a\uff1a</p> <pre><code>nohup mysqldump -uroot -p --all-databases &gt; ./alldatabases.sql  \uff08\u540e\u9762\u4e0d\u52a0&amp;\u7b26\u53f7\uff09\n</code></pre> <p>\u6267\u884c\u4e86\u4e0a\u8ff0\u547d\u4ee4\u540e\uff0c\u4f1a\u63d0\u793a\u53eb\u4f60\u8f93\u5165\u5bc6\u7801\uff0c\u8f93\u5165\u5bc6\u7801\u540e\uff0c\u8be5\u547d\u4ee4\u8fd8\u5728\u524d\u53f0\u8fd0\u884c\uff0c\u4f46\u662f\u6211\u4eec\u7684\u76ee\u7684\u662f\u540e\u5929\u8fd0\u884c\u8be5\u547d\u4ee4\uff0c\u8fd9\u4e2a\u65f6\u5019\u4f60\u53ef\u4ee5\u6309\u4e0bCtrl+Z\uff0c\u7136\u540e\u5728\u8f93\u5165bg\u5c31\u53ef\u4ee5\u8fbe\u5230\u7b2c\u4e00\u4e2a\u547d\u4ee4\u7684\u6548\u679c\uff0c\u8ba9\u8be5\u547d\u4ee4\u540e\u53f0\u8fd0\u884c\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u8ba9\u5bc6\u7801\u9690\u853d\u8f93\u5165\u3002</p> <p>\u547d\u4ee4\u540e\u53f0\u6267\u884c\u7684\u7ed3\u679c\u4f1a\u5728\u547d\u4ee4\u6267\u884c\u7684\u5f53\u524d\u76ee\u5f55\u4e0b\u7559\u4e0b\u4e00\u4e2a nohup.out \u6587\u4ef6\uff0c\u67e5\u770b\u8fd9\u4e2a\u6587\u4ef6\u5c31\u77e5\u9053\u547d\u4ee4\u6709\u6ca1\u6709\u6267\u884c\u62a5\u9519\u7b49\u4fe1\u606f\u3002</p>"},{"location":"chap8/16linux_ops/#3","title":"3\u3001\u627e\u51fa\u5f53\u524d\u7cfb\u7edf\u5185\u5b58\u4f7f\u7528\u91cf\u8f83\u9ad8\u7684\u8fdb\u7a0b","text":"<p>\u547d\u4ee4\uff1a# <code>ps -aux | sort -rnk 4  | head -20</code></p> <p></p> <p>\u8f93\u51fa\u7684\u7b2c4\u5217\u5c31\u662f\u5185\u5b58\u7684\u8017\u7528\u767e\u5206\u6bd4\u3002\u6700\u540e\u4e00\u5217\u5c31\u662f\u76f8\u5bf9\u5e94\u7684\u8fdb\u7a0b\u3002</p>"},{"location":"chap8/16linux_ops/#4cpu","title":"4\u3001\u627e\u51fa\u5f53\u524d\u7cfb\u7edfCPU\u4f7f\u7528\u91cf\u8f83\u9ad8\u7684\u8fdb\u7a0b","text":"<p>\u5728\u5f88\u591a\u8fd0\u7ef4\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53d1\u73b0CPU\u8017\u7528\u8f83\u4e3a\u4e25\u91cd\uff0c\u90a3\u4e48\u600e\u4e48\u6837\u624d\u80fd\u627e\u51faCPU\u6d88\u8017\u7684\u8fdb\u7a0b\u6392\u5e8f\u5462\uff1f</p> <p>\u547d\u4ee4\uff1a# <code>ps -aux | sort -rnk 3  | head -20</code></p> <p></p>"},{"location":"chap8/16linux_ops/#5","title":"5\u3001\u540c\u65f6\u67e5\u770b\u591a\u4e2a\u65e5\u5fd7\u6216\u6570\u636e\u6587\u4ef6","text":"<p>\u5728\u65e5\u5e38\u5de5\u4f5c\u4e2d\uff0c\u6211\u4eec\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u65b9\u5f0f\u53ef\u80fd\u662f\u4f7f\u7528tail\u547d\u4ee4\u5728\u4e00\u4e2a\u4e2a\u7684\u7ec8\u7aef\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\uff0c\u4e00\u4e2a\u7ec8\u7aef\u5c31\u770b\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\u3002</p> <p>\u5305\u62ec\u6211\u5728\u5185\u4e5f\u662f\uff0c\u4f46\u662f\u6709\u65f6\u5019\u4e5f\u4f1a\u89c9\u5f97\u8fd9\u79cd\u65b9\u5f0f\u7565\u663e\u9ebb\u70e6\uff0c\u5176\u5b9e\u6709\u4e2a\u5de5\u5177\u53eb\u505a multitail \u53ef\u4ee5\u5728\u540c\u4e00\u4e2a\u7ec8\u7aef\u540c\u65f6\u67e5\u770b\u591a\u4e2a\u65e5\u5fd7\u6587\u4ef6\u3002</p> <p>\u9996\u5148\u5b89\u88c5 multitail\uff1a</p> <pre><code># wget ftp://ftp.is.co.za/mirror/ftp.rpmforge.net/redhat/el6/en/x86_64/dag/RPMS/multitail-5.2.9-1.el6.rf.x86_64.rpm\n# yum -y localinstall multitail-5.2.9-1.el6.rf.x86_64.rpm\n</code></pre> <p>multitail \u5de5\u5177\u652f\u6301\u6587\u672c\u7684\u9ad8\u4eae\u663e\u793a\uff0c\u5185\u5bb9\u8fc7\u6ee4\u4ee5\u53ca\u66f4\u591a\u4f60\u53ef\u80fd\u9700\u8981\u7684\u529f\u80fd\u3002</p> <p>\u5982\u4e0b\u5c31\u6765\u4e00\u4e2a\u6709\u7528\u7684\u4f8b\u5b50\uff1a</p> <p>\u6b64\u65f6\u6211\u4eec\u65e2\u60f3\u67e5\u770bsecure\u7684\u65e5\u5fd7\u6307\u5b9a\u8fc7\u6ee4\u5173\u952e\u5b57\u8f93\u51fa\uff0c\u53c8\u60f3\u67e5\u770b\u5b9e\u65f6\u7684\u7f51\u7edcping\u60c5\u51b5\uff1a</p> <p>\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code># multitail -e \"Accepted\" /var/log/secure  -l \"ping baidu.com\"\n</code></pre> <p></p>"},{"location":"chap8/16linux_ops/#6-ping","title":"6\u3001\u6301\u7eed ping \u5e76\u5c06\u7ed3\u679c\u8bb0\u5f55\u5230\u65e5\u5fd7","text":"<pre><code>ping api.jpush.cn  | awk '{ print $0\"\\t\" strftime(\"%Y-%m-%d %H:%M:%S\",systime()) } ' &gt;&gt; /tmp/ping.log &amp;`\n</code></pre> <p>\u8f93\u51fa\u7684\u7ed3\u679c\u4f1a\u8bb0\u5f55\u5230<code>/tmp/ping.log</code> \u4e2d\uff0c\u6bcf\u79d2\u949f\u65b0\u589e\u4e00\u6761ping\u8bb0\u5f55\uff0c\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"chap8/16linux_ops/#tcp","title":"\u67e5\u770btcp\u8fde\u63a5\u72b6\u6001","text":"<p>\u6307\u5b9a\u67e5\u770b80\u7aef\u53e3\u7684tcp\u8fde\u63a5\u72b6\u6001\uff0c\u6709\u5229\u4e8e\u5206\u6790\u8fde\u63a5\u662f\u5426\u91ca\u653e\uff0c\u6216\u8005\u653b\u51fb\u65f6\u8fdb\u884c\u72b6\u6001\u5206\u6790\u3002</p> <p>\u547d\u4ee4\uff1a<code># netstat -nat |awk '{print $6}'|sort|uniq -c|sort -rn</code></p>"},{"location":"chap8/16linux_ops/#88020ip","title":"8\u3001\u67e5\u627e80\u7aef\u53e3\u8bf7\u6c42\u6570\u6700\u9ad8\u7684\u524d20\u4e2aIP","text":"<p>\u6709\u65f6\u5019\u4e1a\u52a1\u7684\u8bf7\u6c42\u91cf\u7a81\u7136\u4e0a\u53bb\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u4e0b\u8bf7\u6c42\u6765\u6e90IP\u60c5\u51b5\uff0c\u5982\u679c\u662f\u96c6\u4e2d\u5728\u5c11\u6570IP\u4e0a\u7684\uff0c\u90a3\u4e48\u53ef\u80fd\u662f\u5b58\u5728\u653b\u51fb\u884c\u4e3a\uff0c\u6211\u4eec\u4f7f\u7528\u9632\u706b\u5899\u5c31\u53ef\u4ee5\u8fdb\u884c\u5c01\u7981\u3002\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code># netstat -anlp|grep 80|grep tcp|awk '{print $5}'|awk -F: '{print $1}'|sort|uniq -c|sort -nr|head -n20`\n</code></pre> <p></p>"},{"location":"chap8/16linux_ops/#9ssh","title":"9\u3001ssh\u5b9e\u73b0\u7aef\u53e3\u8f6c\u53d1","text":"<p>\u53ef\u80fd\u5f88\u591a\u7684\u670b\u53cb\u90fd\u542c\u8bf4\u8fc7ssh\u662flinux\u4e0b\u7684\u8fdc\u7a0b\u767b\u5f55\u5b89\u5168\u534f\u8bae\uff0c\u5c31\u662f\u901a\u4fd7\u7684\u8fdc\u7a0b\u767b\u5f55\u7ba1\u7406\u670d\u52a1\u5668\u3002\u4f46\u662f\u5e94\u8be5\u5f88\u5c11\u670b\u53cb\u4f1a\u542c\u8bf4\u8fc7ssh\u8fd8\u53ef\u4ee5\u505a\u7aef\u53e3\u8f6c\u53d1\u3002</p> <p>\u5176\u5b9essh\u7528\u6765\u505a\u7aef\u53e3\u8f6c\u53d1\u7684\u529f\u80fd\u8fd8\u662f\u5f88\u5f3a\u5927\u7684\uff0c\u4e0b\u9762\u5c31\u6765\u505a\u793a\u8303\u3002</p> <p>\u5b9e\u4f8b\u80cc\u666f\uff1a\u6211\u4eec\u516c\u53f8\u662f\u6709\u5821\u5792\u673a\u7684\uff0c\u4efb\u4f55\u64cd\u4f5c\u5747\u9700\u8981\u5728\u5821\u5792\u673a\u4e0a\u8fdb\u884c\uff0c\u6709\u5199\u5f00\u53d1\u4eba\u5458\u9700\u8981\u8bbf\u95eeELasticSearch\u7684head\u9762\u677f\u67e5\u770b\u96c6\u7fa4\u72b6\u6001\uff0c\u4f46\u662f\u6211\u4eec\u5e76\u4e0d\u60f3\u5c06ElasticSearch\u76849200\u7aef\u53e3\u6620\u5c04\u51fa\u53bb\uff0c\u4f9d\u7136\u60f3\u901a\u8fc7\u5821\u5792\u673a\u8fdb\u884c\u8bbf\u95ee\u3002</p> <p>\u6240\u4ee5\u624d\u4f1a\u5c06\u901a\u5f80\u5821\u5792\u673a\uff08192.168.1.15\uff09\u7684\u8bf7\u6c42\u8f6c\u53d1\u5230\u670d\u52a1\u5668ElasticSearch\uff08192.168.1.19\uff09\u76849200\u4e0a\u3002</p> <p>\u4f8b\u5b50\uff1a</p> <p>\u5c06\u53d1\u5f80\u672c\u673a\uff08192.168.1.15\uff09\u76849200\u7aef\u53e3\u8bbf\u95ee\u8f6c\u53d1\u5230192.168.1.19\u76849200\u7aef\u53e3</p> <pre><code>ssh -p 22 -C -f -N -g -L 9200:192.168.1.19:9200 ihavecar@192.168.1.19`\n</code></pre> <p>\u8bb0\u4f4f\uff1a\u524d\u63d0\u662f\u5148\u8fdb\u884c\u79d8\u94a5\u4f20\u8f93\u3002</p> <p>\u547d\u4ee4\u6267\u884c\u5b8c\u540e\uff0c\u8bbf\u95ee192.168.1.15:9200\u7aef\u53e3\u5219\u771f\u5b9e\u662f\u8bbf\u95ee192.168.1.19:9200\u7aef\u53e3\u3002</p>"},{"location":"chap8/17file_opt/","title":"Linux File Operation (df/du/rsync/\u6279\u91cf\u5220\u9664/\u5b9a\u65f6\u5907\u4efd)","text":""},{"location":"chap8/17file_opt/#linuxdfdu10","title":"Linux\u4e2ddf\u548cdu\u547d\u4ee4\u768410\u4e2a\u9ad8\u7ea7\u7528\u6cd5","text":"<p><code>df -i</code>- \u663e\u793a\u6587\u4ef6\u7cfb\u7edf\u7684inode\u4f7f\u7528\u60c5\u51b5\uff0c\u800c\u4e0d\u662f\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528\u60c5\u51b5\u3002</p> <pre><code>$ df -i\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <pre><code>Filesystem      Inodes  IUsed  IFree IUse% Mounted on\n/dev/sda1      2621440 200000 2421440    8% /\ntmpfs           102400      1 102399    1% /dev/shm\n/dev/sdb1      6553600  50000 6503600    1% /data\n</code></pre> <p><code>df -T</code> - \u663e\u793a\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\u3002</p> <pre><code>$ df -T\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <pre><code>Filesystem     Type     1K-blocks    Used Available Use% Mounted on\n/dev/sda1      ext4       20511360 9783776   9757632  51% /\ntmpfs          tmpfs       3983616       0   3983616   0% /dev/shm\n/dev/sdb1      ext4      102401280 50108800  52392304  50% /data\n</code></pre> <p><code>df -h</code> --total - \u663e\u793a\u603b\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528\u60c5\u51b5\uff0c\u5305\u62ec\u6240\u6709\u6587\u4ef6\u7cfb\u7edf\u3002</p> <pre><code>$ df -h --total\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <pre><code>Filesystem      Size  Used Avail Use% Mounted on\n/dev/sda1        20G   10G   10G  50% /\ntmpfs           3.8G     0  3.8G   0% /dev/shm\n/dev/sdb1       100G   48G   52G  48% /data\ntotal           123G   58G   62G  48%\n</code></pre> <p><code>df -m</code> - \u4ee5MB\u4e3a\u5355\u4f4d\u663e\u793a\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528\u60c5\u51b5\u3002</p> <pre><code>$ df -m\n</code></pre> <pre><code>Filesystem     1M-blocks  Used Available Use% Mounted on\n/dev/sda1           20079  9553      9489  51% /\ntmpfs                3894     0      3894   0% /dev/shm\n/dev/sdb1           99968 48977     50815  50% /data\n</code></pre> <p><code>df -x</code> - \u663e\u793a\u6307\u5b9a\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\u4e4b\u5916\u7684\u6587\u4ef6\u7cfb\u7edf\u3002</p> <pre><code>$ df -x tmpfs -x devtmpfs\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <pre><code>Filesystem     1K-blocks    Used Available Use% Mounted on\n/dev/sda1       20511360 9783776   9757632  51% /\n/dev/sdb1      102401280 50108800  52392304  50% /data\n</code></pre> <p><code>du -a</code> - \u663e\u793a\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u548c\u5b50\u76ee\u5f55\u7684\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\u3002</p> <pre><code>$ du -a /path/to/directory\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <pre><code>4       /path/to/directory/file1.txt\n8       /path/to/directory/file2.txt\n12      /path/to/directory/subdirectory\n24      /path/to/directory\n</code></pre> <p><code>du -h --max-depth=1</code> - \u4ee5\u4eba\u7c7b\u53ef\u8bfb\u7684\u683c\u5f0f\u663e\u793a\u76ee\u5f55\u4e0b\u4e00\u7ea7\u5b50\u76ee\u5f55\u7684\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\u3002</p> <pre><code>$ du -h --max-depth=1 /path/to/directory\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <pre><code>4.0K    /path/to/directory/file1.txt\n8.0K    /path/to/directory/file2.txt\n12K     /path/to/directory/subdirectory\n24K     /path/to/directory\n</code></pre> <p><code>du -shx</code> - \u663e\u793a\u6307\u5b9a\u76ee\u5f55\u7684\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\uff0c\u6392\u9664\u6302\u8f7d\u7684\u6587\u4ef6\u7cfb\u7edf\u3002</p> <pre><code>$ du -shx /path/to/directory\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <pre><code>24K     /path/to/directory\n</code></pre> <p><code>du -c</code> - \u663e\u793a\u591a\u4e2a\u76ee\u5f55\u7684\u603b\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\u3002</p> <pre><code>$ du -c /path/to/directory1 /path/to/directory2\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <pre><code>4       /path/to/directory1\n12      /path/to/directory2\n16      total\n</code></pre> <p><code>du -L</code> - \u8ddf\u8e2a\u7b26\u53f7\u94fe\u63a5\u6307\u5411\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\u3002</p> <pre><code>$ du -L /path/to/symlink\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <pre><code>8       /path/to/symlink/file.txt\n</code></pre> <p>\u8fd9\u4e9b\u9ad8\u7ea7\u7528\u6cd5\u53ef\u4ee5\u5e2e\u52a9\u60a8\u66f4\u5168\u9762\u5730\u4e86\u89e3\u78c1\u76d8\u7a7a\u95f4\u7684\u4f7f\u7528\u60c5\u51b5\uff0c\u4ece\u800c\u66f4\u597d\u5730\u7ba1\u7406\u548c\u4f18\u5316\u60a8\u7684\u7cfb\u7edf\u3002\u65e0\u8bba\u662f\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\u3001\u68c0\u67e5inode\u4f7f\u7528\u60c5\u51b5\u8fd8\u662f\u5b9a\u5236\u5316\u663e\u793a\u683c\u5f0f\uff0cdf\u548cdu\u547d\u4ee4\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u9009\u9879\u6765\u6ee1\u8db3\u60a8\u7684\u9700\u6c42\u3002</p>"},{"location":"chap8/17file_opt/#linuxcp10rsync","title":"Linux\u4e2d\u6bd4cp\u597d\u752810\u500d\u7684rsync","text":""},{"location":"chap8/17file_opt/#rsync","title":"\u4e00\u3001rsync\u547d\u4ee4\u6982\u8ff0","text":"<p>rsync\uff08remote sync\uff09\u662f\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u7684\u5f00\u6e90\u5de5\u5177\uff0c\u7528\u4e8e\u5728\u672c\u5730\u548c\u8fdc\u7a0b\u7cfb\u7edf\u4e4b\u95f4\u8fdb\u884c\u6587\u4ef6\u540c\u6b65\u548c\u5907\u4efd\u3002\u5176\u6700\u5927\u7684\u7279\u70b9\u662f\u80fd\u591f\u53ea\u4f20\u8f93\u53d1\u751f\u53d8\u5316\u7684\u90e8\u5206\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u6587\u4ef6\uff0c\u4ece\u800c\u5927\u5927\u63d0\u9ad8\u4e86\u4f20\u8f93\u6548\u7387\u3002</p> <p>\u6b64\u5916\uff0crsync\u8fd8\u652f\u6301\u538b\u7f29\u3001\u52a0\u5bc6\u7b49\u529f\u80fd\uff0c\u4f7f\u5f97\u6587\u4ef6\u540c\u6b65\u66f4\u52a0\u7075\u6d3b\u548c\u5b89\u5168\u3002</p>"},{"location":"chap8/17file_opt/#rsync_1","title":"rsync\u5b89\u88c5","text":"<p>\u5728\u5f00\u59cb\u4f7f\u7528rsync\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u5148\u786e\u4fdd\u7cfb\u7edf\u4e2d\u5df2\u7ecf\u5b89\u88c5\u4e86rsync\u3002\u5bf9\u4e8e\u5927\u591a\u6570Linux\u53d1\u884c\u7248\uff0crsync\u901a\u5e38\u5df2\u7ecf\u9884\u88c5\u6216\u8005\u53ef\u4ee5\u901a\u8fc7\u5305\u7ba1\u7406\u5668\u8fdb\u884c\u5b89\u88c5\u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662fMac\u7cfb\u7edf\uff0c\u53ef\u4ee5\u901a\u8fc7Homebrew\u6765\u8fdb\u884c\u5b89\u88c5\u3002\u4ee5\u4e0b\u662f\u5728Ubuntu\u7cfb\u7edf\u4e0a\u5b89\u88c5rsync\u7684\u547d\u4ee4\u793a\u4f8b\uff1a</p> <pre><code>$ sudo apt-get update\n$ sudo apt-get install rsync\n</code></pre>"},{"location":"chap8/17file_opt/#_1","title":"\u4e09\u3001\u57fa\u672c\u7528\u6cd5\u793a\u4f8b","text":"<p>3.1 \u672c\u5730\u6587\u4ef6\u540c\u6b65</p> <p>\u9996\u5148\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u5982\u4f55\u5728\u672c\u5730\u673a\u5668\u4e4b\u95f4\u8fdb\u884c\u6587\u4ef6\u540c\u6b65\u3002\u5047\u8bbe\u6211\u4eec\u6709\u4e24\u4e2a\u76ee\u5f55\uff1a\u6e90\u76ee\u5f55\uff08source\uff09\u548c\u76ee\u6807\u76ee\u5f55\uff08destination\uff09\u3002\u8981\u5c06\u6e90\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u540c\u6b65\u5230\u76ee\u6807\u76ee\u5f55\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ rsync -avh source/ destination/\n</code></pre> <p>\u5728\u4e0a\u8ff0\u547d\u4ee4\u4e2d\uff0c</p> <ul> <li><code>-a</code>\u53c2\u6570\u8868\u793a\u4ee5\u5f52\u6863\u6a21\u5f0f\u8fdb\u884c\u540c\u6b65\uff0c\u4fdd\u6301\u6587\u4ef6\u7684\u5c5e\u6027\u548c\u6743\u9650\u4e0d\u53d8\uff1b</li> <li><code>-v</code>\u53c2\u6570\u8868\u793a\u8f93\u51fa\u8be6\u7ec6\u7684\u540c\u6b65\u8fc7\u7a0b\u4fe1\u606f\uff1b</li> <li><code>-h</code>\u53c2\u6570\u8868\u793a\u4ee5\u4eba\u7c7b\u53ef\u8bfb\u7684\u65b9\u5f0f\u663e\u793a\u6587\u4ef6\u5927\u5c0f\u3002</li> </ul> <p>\u60a8\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u9700\u6c42\u8c03\u6574\u53c2\u6570\u3002</p> <p>3.2 \u8fdc\u7a0b\u6587\u4ef6\u540c\u6b65</p> <p>rsync\u4e5f\u652f\u6301\u5728\u672c\u5730\u673a\u5668\u548c\u8fdc\u7a0b\u673a\u5668\u4e4b\u95f4\u8fdb\u884c\u6587\u4ef6\u540c\u6b65\u3002\u5728\u8fdb\u884c\u8fdc\u7a0b\u540c\u6b65\u4e4b\u524d\uff0c\u9700\u8981\u786e\u4fdd\u8fdc\u7a0b\u673a\u5668\u4e0a\u5df2\u7ecf\u5b89\u88c5\u4e86rsync\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7SSH\u8fdb\u884c\u8bbf\u95ee\u3002</p> <p>\u8981\u5c06\u672c\u5730\u673a\u5668\u4e0a\u7684\u6587\u4ef6\u540c\u6b65\u5230\u8fdc\u7a0b\u673a\u5668\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ rsync -avh source/ user@remote:/path/to/destination/\n</code></pre> <p>\u5728\u4e0a\u8ff0\u547d\u4ee4\u4e2d\uff0cuser\u662f\u8fdc\u7a0b\u673a\u5668\u4e0a\u7684\u7528\u6237\u540d\uff0cremote\u662f\u8fdc\u7a0b\u673a\u5668\u7684\u5730\u5740\uff0c<code>/path/to/destination/</code>\u662f\u76ee\u6807\u76ee\u5f55\u7684\u8def\u5f84\u3002</p> <p>\u901a\u8fc7SSH\u8fde\u63a5\u5230\u8fdc\u7a0b\u673a\u5668\u65f6\uff0crsync\u4f1a\u8981\u6c42\u8f93\u5165\u5bc6\u7801\u6216\u8005\u4f7f\u7528SSH\u5bc6\u94a5\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002</p> <p>3.3 \u8fc7\u6ee4\u6587\u4ef6\u548c\u76ee\u5f55</p> <p>\u6709\u65f6\u5019\uff0c\u6211\u4eec\u5e0c\u671b\u5728\u6587\u4ef6\u540c\u6b65\u8fc7\u7a0b\u4e2d\u6392\u9664\u67d0\u4e9b\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u4ee5\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u590d\u5236\u3002rsync\u63d0\u4f9b\u4e86<code>--exclude</code>\u548c<code>--exclude-from</code>\u53c2\u6570\u6765\u5b9e\u73b0\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u8fc7\u6ee4\u3002</p> <p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u793a\u4f8b\uff0c\u6f14\u793a\u5982\u4f55\u4f7f\u7528--exclude\u53c2\u6570\u6765\u8fc7\u6ee4\u6587\u4ef6\uff1a</p> <pre><code>$ rsync -avh --exclude='*.txt' source/ destination/\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u4e2d\uff0c<code>--exclude='*.txt'</code>\u8868\u793a\u6392\u9664\u6240\u6709.txt\u6587\u4ef6\u3002\u60a8\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u9700\u6c42\u4fee\u6539\u8fc7\u6ee4\u89c4\u5219\u3002</p> <p>3.4 \u540c\u6b65\u5220\u9664</p> <p>\u5982\u679c\u6e90\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u5728\u76ee\u6807\u76ee\u5f55\u4e2d\u4e0d\u5b58\u5728\uff0crsync\u9ed8\u8ba4\u4e0d\u4f1a\u5220\u9664\u76ee\u6807\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002</p> <p>\u5982\u679c\u5e0c\u671b\u5728\u540c\u6b65\u8fc7\u7a0b\u4e2d\u5220\u9664\u76ee\u6807\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528<code>--delete</code>\u53c2\u6570\uff1a</p> <pre><code>$ rsync -avh --delete source/ destination/\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u4e2d\uff0c<code>--delete</code>\u53c2\u6570\u8868\u793a\u5728\u540c\u6b65\u8fc7\u7a0b\u4e2d\u5220\u9664\u76ee\u6807\u76ee\u5f55\u4e2d\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\u3002</p>"},{"location":"chap8/17file_opt/#_2","title":"\u56db\u3001\u9ad8\u7ea7\u529f\u80fd","text":"<p>\u9664\u4e86\u57fa\u672c\u7684\u6587\u4ef6\u540c\u6b65\u529f\u80fd\u5916\uff0crsync\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e9b\u9ad8\u7ea7\u529f\u80fd\uff0c\u4f7f\u5f97\u6587\u4ef6\u540c\u6b65\u66f4\u52a0\u7075\u6d3b\u548c\u53ef\u5b9a\u5236\u3002</p> <p>4.1 \u538b\u7f29\u4f20\u8f93</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0crsync\u4f1a\u5bf9\u4f20\u8f93\u7684\u6570\u636e\u8fdb\u884c\u538b\u7f29\uff0c\u4ee5\u51cf\u5c11\u7f51\u7edc\u5e26\u5bbd\u7684\u5360\u7528\u3002\u5982\u679c\u5e0c\u671b\u7981\u7528\u538b\u7f29\uff0c\u53ef\u4ee5\u4f7f\u7528<code>-z</code>\u53c2\u6570</p> <pre><code>$ rsync -avh -z source/ destination/\n</code></pre> <p>4.2 \u52a0\u5bc6\u4f20\u8f93</p> <p>\u4e3a\u4e86\u4fdd\u62a4\u6570\u636e\u7684\u5b89\u5168\u6027\uff0crsync\u652f\u6301\u901a\u8fc7SSH\u8fdb\u884c\u52a0\u5bc6\u4f20\u8f93\u3002\u5728\u8fdc\u7a0b\u540c\u6b65\u4e2d\uff0c\u53ea\u9700\u4f7f\u7528SSH\u8fde\u63a5\u8fdb\u884c\u4f20\u8f93\u5373\u53ef</p> <p>4.3 \u90e8\u5206\u6587\u4ef6\u4f20\u8f93</p> <p>rsync\u7684\u4e00\u4e2a\u91cd\u8981\u7279\u70b9\u662f\u53ea\u4f20\u8f93\u53d1\u751f\u53d8\u5316\u7684\u90e8\u5206\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u6587\u4ef6\u3002\u8fd9\u79cd\u589e\u91cf\u4f20\u8f93\u7684\u65b9\u5f0f\u5927\u5927\u63d0\u9ad8\u4e86\u4f20\u8f93\u6548\u7387\u3002rsync\u4f1a\u6839\u636e\u6587\u4ef6\u7684\u65f6\u95f4\u6233\u548c\u5185\u5bb9\u6765\u5224\u65ad\u6587\u4ef6\u662f\u5426\u53d1\u751f\u53d8\u5316\uff0c\u53ea\u4f20\u8f93\u53d1\u751f\u53d8\u5316\u7684\u90e8\u5206\u3002</p> <p>4.4 \u5e26\u5bbd\u9650\u5236</p> <p>\u5982\u679c\u60a8\u5e0c\u671b\u5728\u8fdb\u884c\u6587\u4ef6\u540c\u6b65\u65f6\u9650\u5236rsync\u4f7f\u7528\u7684\u5e26\u5bbd\uff0c\u53ef\u4ee5\u4f7f\u7528<code>--bwlimit</code>\u53c2\u6570\u3002\u4ee5\u4e0b\u662f\u4e00\u4e2a\u793a\u4f8b\uff1a</p> <pre><code>$ rsync -avh --bwlimit=1000 source/ destination/\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u4e2d\uff0c<code>--bwlimit=1000</code>\u8868\u793a\u9650\u5236\u5e26\u5bbd\u4e3a1000 KB/s\u3002</p>"},{"location":"chap8/17file_opt/#5","title":"5 \u5220\u9664\u6587\u4ef6","text":"<p>\u9996\u5148\u51c6\u5907\u597d\u4f60\u8981\u5220\u9664\u7684\u6587\u4ef6\u76ee\u5f55\u5230\u4e00\u4e2alist.txt\u4e2d</p> <p>\u4f8b\u5982\uff1a</p> <pre><code>ls -1 &gt; list.txt\n</code></pre> <p>\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u5c06\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u548c\u76ee\u5f55\u540d\uff08\u4e0d\u5305\u62ec\u5b50\u76ee\u5f55\uff09\u8f93\u51fa\u5230 <code>list.txt</code> \u6587\u4ef6\u4e2d\u3002</p> <ul> <li><code>ls</code> \u662f\u5217\u51fa\u76ee\u5f55\u5185\u5bb9\u7684\u547d\u4ee4\u3002</li> <li><code>-1</code> \u9009\u9879\u8ba9 ls \u6bcf\u884c\u53ea\u8f93\u51fa\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u8fd9\u4f7f\u5f97\u8f93\u51fa\u66f4\u9002\u5408\u88ab\u811a\u672c\u8bfb\u53d6\u3002</li> <li><code>&gt;</code> \u662f\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26\uff0c\u5b83\u4f1a\u5c06 ls \u7684\u8f93\u51fa\u5199\u5165\u5230 list.txt \u6587\u4ef6\u4e2d\u3002\u5982\u679c list.txt \u6587\u4ef6\u5df2\u7ecf\u5b58\u5728\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u4f1a\u8986\u76d6\u539f\u6709\u7684\u6587\u4ef6\u5185\u5bb9\u3002</li> </ul> <p>\u5982\u679c\u4f60\u53ea\u5e0c\u671b\u5217\u51fa\u6587\u4ef6\uff0c\u800c\u975e\u76ee\u5f55\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>ls -1p | grep -v /</code> \u547d\u4ee4\uff1a</p> <pre><code>ls -1p | grep -v / &gt; list.txt\n</code></pre> <ul> <li><code>ls -1p</code> \u547d\u4ee4\u4f1a\u5728\u76ee\u5f55\u540d\u540e\u6dfb\u52a0 <code>/</code>\u7b26\u53f7\u3002</li> <li><code>grep -v /</code> \u547d\u4ee4\u4f1a\u8fc7\u6ee4\u6389\u5305\u542b <code>/</code> \u7684\u884c\uff0c\u4e5f\u5c31\u662f\u76ee\u5f55\u540d\u3002</li> <li>\u6700\u540e\u7ed3\u679c\u91cd\u5b9a\u5411\u5230 <code>list.txt</code> \u6587\u4ef6\u4e2d\u3002</li> </ul> <p>\u7136\u540e\u4f60\u53ef\u4ee5\u4f7f\u7528 bash \u811a\u672c\u6765\u5b9e\u73b0\u5220\u9664\u6587\u4ef6\u3002\u4ee5\u4e0b\u662f\u4e00\u4e2a\u793a\u4f8b\u811a\u672c</p> <pre><code>#!/bin/bash\n\n# \u5047\u8bbe\u4f60\u7684 txt \u6587\u4ef6\u540d\u4e3a filelist.txt\nwhile IFS= read -r line\ndo\n    if [ -f \"$line\" ]; then\n        rm \"$line\"\n        echo \"$line \u6587\u4ef6\u5df2\u88ab\u5220\u9664\"\n    else\n        echo \"$line \u6587\u4ef6\u4e0d\u5b58\u5728\"\n    fi\ndone &lt; \"filelist.txt\"\n</code></pre> <p><code>IFS= read -r line</code> \u662f\u4e00\u79cd\u5b89\u5168\u7684\u8bfb\u53d6\u6587\u672c\u6587\u4ef6\u7684\u65b9\u5f0f\uff0c\u5b83\u53ef\u4ee5\u5904\u7406\u6587\u4ef6\u540d\u4e2d\u7684\u7279\u6b8a\u5b57\u7b26\u3002</p> <p><code>[ -f \"$line\" ]</code> \u4f1a\u68c0\u67e5\u4e00\u4e2a\u540d\u4e3a $line \u7684\u6587\u4ef6\u662f\u5426\u5b58\u5728\u3002</p> <p><code>rm \"$line\"</code>  \u4f1a\u5220\u9664\u6307\u5b9a\u7684\u6587\u4ef6\u3002</p> <p><code>echo \"$line \u6587\u4ef6\u5df2\u88ab\u5220\u9664\"</code> \u6216 <code>\"$line \u6587\u4ef6\u4e0d\u5b58\u5728\"</code> \u662f\u4e00\u4e2a\u7b80\u5355\u7684\u786e\u8ba4\u6d88\u606f\uff0c\u5b83\u4e0d\u662f\u5fc5\u9700\u7684\uff0c\u4f46\u6709\u52a9\u4e8e\u4f60\u77e5\u9053\u811a\u672c\u5728\u505a\u4ec0\u4e48\u3002</p> <p>\u53e6\u5916\uff0c\u5bf9\u4e8e\u6587\u4ef6\u5220\u9664\u64cd\u4f5c\uff0c\u4e00\u5b9a\u8981\u5c0f\u5fc3\uff0c\u56e0\u4e3a\u5220\u9664\u7684\u6587\u4ef6\u65e0\u6cd5\u6062\u590d\u3002\u5bf9\u4e8e\u9700\u8981\u5220\u9664\u7684\u6587\u4ef6\uff0c\u6700\u597d\u5148\u786e\u8ba4\u4e00\u4e0b\uff0c\u907f\u514d\u8bef\u5220\u3002</p> <p>\u90a3\u5982\u679c\u4f7f\u7528python\u5462\uff0c\u53ef\u4ee5\u4f7f\u7528 os \u6a21\u5757\uff0c\u5b83\u63d0\u4f9b\u4e86\u8bb8\u591a\u5904\u7406\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u529f\u80fd\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\u811a\u672c\uff1a</p> <pre><code>import os\n\n# \u5047\u8bbe\u4f60\u7684 txt \u6587\u4ef6\u540d\u4e3a filelist.txt\nwith open('filelist.txt', 'r') as f:\n    for line in f.readlines():\n        line = line.strip()  # \u79fb\u9664\u884c\u5c3e\u7684\u6362\u884c\u7b26\n        if os.path.isfile(line):\n            try:\n                os.remove(line)\n                print(f'\u6587\u4ef6 {line} \u5df2\u88ab\u5220\u9664')\n            except OSError as e:\n                print(f'\u5220\u9664\u6587\u4ef6 {line} \u53d1\u751f\u9519\u8bef: {e.strerror}')\n        else:\n            print(f'\u6587\u4ef6 {line} \u4e0d\u5b58\u5728')\n</code></pre> <p>\u8fd9\u4e2a\u811a\u672c\u4f7f\u7528\u4e86 os.path.isfile(line) \u6765\u68c0\u67e5\u4e00\u4e2a\u540d\u4e3a line \u7684\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff0cos.remove(line) \u6765\u5220\u9664\u6307\u5b9a\u7684\u6587\u4ef6\u3002</p> <p>\u4f7f\u7528 try/except \u7ed3\u6784\u662f\u4e3a\u4e86\u5904\u7406\u53ef\u80fd\u53d1\u751f\u7684\u9519\u8bef\uff0c\u4f8b\u5982\u6743\u9650\u95ee\u9898\u6216\u5176\u5b83\u6587\u4ef6\u7cfb\u7edf\u9519\u8bef\u3002\u5f53\u5220\u9664\u6587\u4ef6\u53d1\u751f\u9519\u8bef\u65f6\uff0c\u6211\u4eec\u6253\u5370\u51fa\u9519\u8bef\u4fe1\u606f\u3002\u5220\u9664\u6587\u4ef6\u64cd\u4f5c\u8981\u7279\u522b\u5c0f\u5fc3\uff0c\u5148\u5728\u4e00\u4e9b\u4e0d\u91cd\u8981\u7684\u6587\u4ef6\u4e0a\u6d4b\u8bd5\u3002\u786e\u8ba4\u6ca1\u6709\u95ee\u9898\u540e\uff0c\u518d\u5728\u4f60\u8981\u5220\u9664\u7684\u6587\u4ef6\u4e0a\u6267\u884c\u3002</p>"},{"location":"chap8/17file_opt/#_3","title":"\u5907\u4efd\u6587\u4ef6","text":"<p>\u7528python\u5907\u4efd\u53ef\u4ee5\u4f7f\u7528 shutil \u548c os \u5e93\u6765\u590d\u5236\u6587\u4ef6\u548c\u7ba1\u7406\u8def\u5f84\u3002\u4ee5\u4e0b\u662f\u4e00\u4e2a\u793a\u4f8b\u811a\u672c\uff1a</p> <pre><code>import os\nimport shutil\nfrom datetime import datetime\n\n# \u521b\u5efa\u4e00\u4e2a\u5e26\u65e5\u671f\u7684\u5907\u4efd\u76ee\u5f55\nbackup_dir = \"/path/to/your/backup/directory/backup_\" + datetime.now().strftime(\"%Y%m%d%H%M%S\")\nos.makedirs(backup_dir, exist_ok=True)\n\n# \u4ece list.txt \u8bfb\u53d6\u6587\u4ef6\u540d\nwith open('list.txt', 'r') as f:\n    for line in f.readlines():\n        line = line.strip()  # \u79fb\u9664\u884c\u5c3e\u7684\u6362\u884c\u7b26\n        if os.path.isfile(line):\n            # \u590d\u5236\u6587\u4ef6\u5230\u5907\u4efd\u76ee\u5f55\n            shutil.copy(line, backup_dir)\n</code></pre> <p>\u8fd9\u4e2a\u811a\u672c\u4f1a\u521b\u5efa\u4e00\u4e2a\u5e26\u65f6\u95f4\u6233\u7684\u5907\u4efd\u76ee\u5f55\uff0c\u5e76\u4ece list.txt \u4e2d\u8bfb\u53d6\u6587\u4ef6\u540d\uff0c\u5c06\u5b58\u5728\u7684\u6587\u4ef6\u590d\u5236\u5230\u5907\u4efd\u76ee\u5f55\u3002</p> <p>\u8981\u5b9a\u65f6\u6267\u884c\u8fd9\u4e2a\u811a\u672c\uff0c\u4f60\u4f9d\u7136\u9700\u8981\u4f7f\u7528 cron \u4efb\u52a1\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>crontab -e</code>\u547d\u4ee4\u6253\u5f00\u4f60\u7684\u7528\u6237\u7684 cron \u914d\u7f6e\uff0c\u5e76\u6dfb\u52a0\u7c7b\u4f3c\u5982\u4e0b\u7684\u914d\u7f6e\uff1a</p> <pre><code>0 0 * * * /usr/bin/python3 /path/to/your/script.py\n</code></pre> <p>\u8fd9\u884c\u914d\u7f6e\u8868\u793a\u6bcf\u5929\u5348\u591c\u6267\u884c\u811a\u672c <code>/path/to/your/script.py</code>\uff0c<code>/usr/bin/python3</code>\u662f Python 3 \u7684\u5e38\u89c1\u8def\u5f84\uff0c\u4f60\u9700\u8981\u6839\u636e\u4f60\u7684\u73af\u5883\u66ff\u6362\u4e3a\u6b63\u786e\u7684 Python \u8def\u5f84\u3002</p> <p>\u6ce8\u610f\uff1a\u5728\u7ed9\u5b9a\u7684\u8def\u5f84\u4e2d\uff0c<code>/path/to/your/backup/directory/</code> \u548c <code>/path/to/your/script.py</code> \u4f60\u9700\u8981\u66ff\u6362\u4e3a\u4f60\u81ea\u5df1\u7684\u8def\u5f84\u3002</p>"},{"location":"chap8/18linux_var/","title":"Shell script\u4e2d\u76848\u4e2a\u5e38\u7528\u7684\u7279\u6b8a\u53d8\u91cf","text":"<p>\u5f53\u7f16\u5199Shell\u811a\u672c\u65f6\uff0c\u4e86\u89e3\u548c\u4f7f\u7528\u7279\u6b8a\u53d8\u91cf\u662f\u975e\u5e38\u91cd\u8981\u7684\u3002\u7279\u6b8a\u53d8\u91cf\u662fShell\u63d0\u4f9b\u7684\u4e00\u4e9b\u7279\u5b9a\u7528\u9014\u7684\u53d8\u91cf\uff0c\u5b83\u4eec\u5305\u542b\u4e86\u6709\u5173\u811a\u672c\u548c\u5176\u73af\u5883\u7684\u91cd\u8981\u4fe1\u606f\u3002\u4e0b\u9762\u662fShell\u811a\u672c\u4e2d\u516b\u4e2a\u5e38\u7528\u7684\u7279\u6b8a\u53d8\u91cf\uff0c\u4ee5\u53ca\u5b83\u4eec\u7684\u4ee3\u7801\u548c\u8f93\u51fa\u793a\u4f8b\u3002</p> <ol> <li><code>$0</code> - \u5f53\u524d\u811a\u672c\u7684\u6587\u4ef6\u540d\u3002</li> </ol> <pre><code>#!/bin/bash\necho \"\u5f53\u524d\u811a\u672c\u7684\u6587\u4ef6\u540d\u662f\uff1a$0\"\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>\u5f53\u524d\u811a\u672c\u7684\u6587\u4ef6\u540d\u662f\uff1ascript.sh\n</code></pre> <p>2.<code>$1</code> \u5230 <code>$9</code> - \u7528\u4e8e\u8bbf\u95ee\u811a\u672c\u7684\u4f4d\u7f6e\u53c2\u6570\uff08\u547d\u4ee4\u884c\u53c2\u6570\uff09\u3002</p> <pre><code>#!/bin/bash\necho \"\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1a$1\"\necho \"\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1a$2\"\necho \"\u7b2c\u4e09\u4e2a\u53c2\u6570\uff1a$3\"\n</code></pre> <p>\u547d\u4ee4\u884c\u8f93\u5165\uff1a</p> <pre><code>./script.sh arg1 arg2 arg3\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1aarg1\n\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1aarg2\n\u7b2c\u4e09\u4e2a\u53c2\u6570\uff1aarg3\n</code></pre> <p>3.<code>$#</code> - \u4f20\u9012\u7ed9\u811a\u672c\u7684\u53c2\u6570\u4e2a\u6570\u3002</p> <pre><code>#!/bin/bash\necho \"\u4f20\u9012\u7ed9\u811a\u672c\u7684\u53c2\u6570\u4e2a\u6570\uff1a$#\"\n</code></pre> <p>\u547d\u4ee4\u884c\u8f93\u5165\uff1a</p> <pre><code>./script.sh arg1 arg2 arg3\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>\u4f20\u9012\u7ed9\u811a\u672c\u7684\u53c2\u6570\u4e2a\u6570\uff1a3\n</code></pre> <p>4.<code>$*</code>  - \u4ee5\u4e00\u4e2a\u5355\u5b57\u7b26\u4e32\u663e\u793a\u6240\u6709\u4f4d\u7f6e\u53c2\u6570\u3002</p> <pre><code>#!/bin/bash\necho \"\u6240\u6709\u4f4d\u7f6e\u53c2\u6570\uff1a$*\"\n</code></pre> <p>\u547d\u4ee4\u884c\u8f93\u5165\uff1a</p> <pre><code>./script.sh arg1 arg2 arg3\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>\u6240\u6709\u4f4d\u7f6e\u53c2\u6570\uff1aarg1 arg2 arg3\n</code></pre> <p>5. <code>$@</code> - \u4ee5\u4e00\u4e2a\u5b57\u7b26\u4e32\u5217\u8868\u663e\u793a\u6240\u6709\u4f4d\u7f6e\u53c2\u6570\u3002</p> <pre><code>#!/bin/bash\necho \"\u6240\u6709\u4f4d\u7f6e\u53c2\u6570\uff1a$@\"\n</code></pre> <p>\u547d\u4ee4\u884c\u8f93\u5165\uff1a</p> <pre><code>./script.sh arg1 arg2 arg3\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>\u6240\u6709\u4f4d\u7f6e\u53c2\u6570\uff1aarg1 arg2 arg3\n</code></pre> <p>6. <code>$?</code> - \u4e0a\u4e00\u4e2a\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u6216\u8fd4\u56de\u503c\u3002</p> <pre><code>#!/bin/bash\nls\necho \"\u4e0a\u4e00\u4e2a\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\uff1a$?\"\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>file1.txt  file2.txt\n\u4e0a\u4e00\u4e2a\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\uff1a0\n</code></pre> <p>7. <code>$$</code> - \u5f53\u524d\u811a\u672c\u7684\u8fdb\u7a0bID\u3002</p> <pre><code>#!/bin/bash\necho \"\u5f53\u524d\u811a\u672c\u7684\u8fdb\u7a0bID\uff1a$$\"\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>\u5f53\u524d\u811a\u672c\u7684\u8fdb\u7a0bID\uff1a12345\n</code></pre> <p>8 <code>$!</code> - \u540e\u53f0\u8fd0\u884c\u7684\u6700\u540e\u4e00\u4e2a\u8fdb\u7a0b\u7684\u8fdb\u7a0bID\u3002</p> <pre><code>#!/bin/bash\nsleep 10 &amp;\necho \"\u540e\u53f0\u8fdb\u7a0b\u7684\u8fdb\u7a0bID\uff1a$!\"\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>\u540e\u53f0\u8fdb\u7a0b\u7684\u8fdb\u7a0bID\uff1a67890\n</code></pre>"},{"location":"chap8/19curl/","title":"Curl\u768410\u4e2a\u9ad8\u7ea7\u7528\u6cd5","text":"<p>Curl \u662f\u4e00\u6b3e\u5f3a\u5927\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u4e8e\u4e0e\u5404\u79cd\u7f51\u7edc\u534f\u8bae\u8fdb\u884c\u901a\u4fe1\u3002\u5b83\u652f\u6301\u591a\u79cd\u9009\u9879\uff0c\u4f7f\u5f97\u6211\u4eec\u80fd\u591f\u4ee5\u591a\u79cd\u65b9\u5f0f\u5b9a\u5236\u548c\u63a7\u5236\u8bf7\u6c42\u3002</p>"},{"location":"chap8/19curl/#-x-request","title":"<code>-X/--request</code>","text":"<p>\u8fd9\u4e2a\u9009\u9879\u7528\u4e8e\u6307\u5b9a HTTP \u8bf7\u6c42\u7684\u65b9\u6cd5\u3002\u5e38\u89c1\u7684\u65b9\u6cd5\u6709 GET\u3001POST\u3001PUT \u548c DELETE\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f7f\u7528 POST \u65b9\u6cd5\u53d1\u9001 JSON \u6570\u636e\u7684\u793a\u4f8b\uff1a</p> <pre><code>curl -X POST -H \"Content-Type: application/json\" -d '{\"name\":\"John\",\"age\":30}' https://example.com/api/users\n</code></pre>"},{"location":"chap8/19curl/#-h-header","title":"<code>-H/--header</code>","text":"<p>\u901a\u8fc7\u6b64\u9009\u9879\uff0c\u60a8\u53ef\u4ee5\u6dfb\u52a0\u81ea\u5b9a\u4e49\u7684\u8bf7\u6c42\u5934\u3002\u4e0b\u9762\u7684\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u901a\u8fc7\u6dfb\u52a0\u81ea\u5b9a\u4e49\u7684 <code>User-Agent</code> \u5934\u4fe1\u606f\u53d1\u9001\u8bf7\u6c42\uff1a</p> <pre><code>curl -H \"User-Agent: MyCustomAgent\" https://example.com\n</code></pre>"},{"location":"chap8/19curl/#-d-data","title":"<code>-d/--data</code>","text":"<p>\u4f7f\u7528\u6b64\u9009\u9879\u53ef\u4ee5\u53d1\u9001 POST \u8bf7\u6c42\u65f6\u7684\u6570\u636e\u4f53\u3002\u4e0b\u9762\u7684\u793a\u4f8b\u5c55\u793a\u4e86\u5982\u4f55\u53d1\u9001\u8868\u5355\u6570\u636e\uff1a</p> <pre><code>curl -X POST -d \"username=admin&amp;password=123456\" https://example.com/login\n</code></pre>"},{"location":"chap8/19curl/#-f-form","title":"<code>-F/--form</code>","text":"<p>\u8fd9\u4e2a\u9009\u9879\u4e0e <code>-d/--data</code> \u7c7b\u4f3c\uff0c\u4f46\u7528\u4e8e\u53d1\u9001\u8868\u5355\u6570\u636e\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\uff0c\u6f14\u793a\u4e86\u5982\u4f55\u4e0a\u4f20\u6587\u4ef6\uff1a</p> <pre><code>curl -F \"file=@/path/to/file\" https://example.com/upload\n</code></pre>"},{"location":"chap8/19curl/#-o-output","title":"<code>-o/--output</code>","text":"<p>\u901a\u8fc7\u6b64\u9009\u9879\uff0c\u60a8\u53ef\u4ee5\u5c06\u54cd\u5e94\u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d\uff0c\u800c\u4e0d\u662f\u5728\u7ec8\u7aef\u4e0a\u663e\u793a\u3002\u4ee5\u4e0b\u793a\u4f8b\u5c06\u5c06\u54cd\u5e94\u4fdd\u5b58\u5230\u540d\u4e3a <code>\"response.txt\"</code> \u7684\u6587\u4ef6\u4e2d\uff1a</p> <pre><code>curl -o response.txt https://example.com/api/data\n</code></pre>"},{"location":"chap8/19curl/#-i-include","title":"<code>-i/--include</code>","text":"<p>\u4f7f\u7528\u6b64\u9009\u9879\u53ef\u4ee5\u5728\u8f93\u51fa\u7ed3\u679c\u4e2d\u5305\u542b\u54cd\u5e94\u7684\u5934\u4fe1\u606f\u3002\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u83b7\u53d6\u54cd\u5e94\u7684\u5934\u4fe1\u606f\u548c\u4e3b\u4f53\u5185\u5bb9\uff1a</p> <pre><code>curl -i https://example.com\n</code></pre>"},{"location":"chap8/19curl/#-l-location","title":"<code>-L/--location</code>","text":"<p>\u5982\u679c\u8bf7\u6c42\u8fd4\u56de\u4e86\u91cd\u5b9a\u5411\u54cd\u5e94\uff0c\u901a\u8fc7\u6b64\u9009\u9879\uff0cCurl \u5c06\u81ea\u52a8\u8ddf\u968f\u91cd\u5b9a\u5411\u3002\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u6b64\u9009\u9879\uff1a</p> <pre><code>curl -L https://example.com\n</code></pre>"},{"location":"chap8/19curl/#-c-cookie-b-cookie-jar","title":"<code>-c/--cookie</code> \u548c <code>-b/--cookie-jar</code>\uff1a","text":"<p>\u8fd9\u4e9b\u9009\u9879\u7528\u4e8e\u5904\u7406\u548c\u53d1\u9001 Cookie\u3002<code>-c</code> \u9009\u9879\u5c06\u4ece\u670d\u52a1\u5668\u63a5\u6536\u7684 Cookie \u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d\uff0c<code>-b</code> \u9009\u9879\u5c06\u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6 Cookie \u5e76\u53d1\u9001\u5230\u670d\u52a1\u5668\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u8fd9\u4e24\u4e2a\u9009\u9879\uff1a</p> <pre><code>curl -c cookies.txt https://example.com/login\ncurl -b cookies.txt https://example.com/user/dashboard\n</code></pre>"},{"location":"chap8/19curl/#-u-user","title":"<code>-u/--user</code>","text":"<p>\u901a\u8fc7\u6b64\u9009\u9879\uff0c\u60a8\u53ef\u4ee5\u6307\u5b9a\u7528\u4e8e\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\u53d1\u9001\u8bf7\u6c42\uff1a</p> <pre><code>curl -u username:password https://example.com/api/data\n</code></pre>"},{"location":"chap8/19curl/#-s-silent","title":"<code>-s/--silent</code>","text":"<p>\u4f7f\u7528\u6b64\u9009\u9879\u53ef\u4ee5\u4f7f Curl \u5728\u6267\u884c\u8bf7\u6c42\u65f6\u9759\u9ed8\u8fd0\u884c\uff0c\u4e0d\u663e\u793a\u8fdb\u5ea6\u6216\u9519\u8bef\u4fe1\u606f\u3002\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u6b64\u9009\u9879\uff1a</p> <pre><code>curl -s https://example.com\n</code></pre>"},{"location":"chap8/1log_man/","title":"1 Log\uff1a \u7528 awk + grep + sed\u641e\u5b9a\u65e5\u5fd7\u5904\u7406\u795e\u5668\u7ec4\u5408\u62f3","text":""},{"location":"chap8/1log_man/#1-linux","title":"1 Linux\u4e09\u5251\u5ba2\u7b80\u4ecb","text":"<p>grep\u504f\u5411\u4e8e\u6587\u672c\u641c\u7d22\uff0csed\u4e13\u6ce8\u4e8e\u6587\u672c\u7f16\u8f91\u64cd\u4f5c\uff0cawk\u5219\u63d0\u4f9b\u66f4\u7cbe\u7ec6\u7684\u8fc7\u6ee4\u5904\u7406\u529f\u80fd</p>"},{"location":"chap8/1log_man/#2-grep","title":"2 grep\uff1a\u641c\u7d22\u4e4b\u5251\u8be6\u89e3","text":""},{"location":"chap8/1log_man/#21-grep","title":"2.1 grep\u7b80\u4ecb","text":"<p>grep \u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u4e8e\u5728\u6587\u672c\u6587\u4ef6\u4e2d\u641c\u7d22\u6307\u5b9a\u7684\u6a21\u5f0f\u3002\u5b83\u80fd\u4f7f\u7528\u7279\u5b9a\u6a21\u5f0f\u5339\u914d\uff08\u5305\u62ec\u6b63\u5219\u8868\u8fbe\u5f0f\uff09\u641c\u7d22\u6587\u672c\uff0c\u5e76\u9ed8\u8ba4\u8f93\u51fa\u5339\u914d\u884c</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cgrep\u4f1a\u5c06\u5339\u914d\u5230\u7684\u6574\u884c\u8f93\u51fa\uff0c\u800cawk\u53ef\u4ee5\u6307\u5b9a\u67d0\u4e00\u884c\u67d0\u4e00\u5217\u8fdb\u884c\u8f93\u51fa\u3002</p> <p>\u4e3b\u8981\u5e94\u7528\u573a\u666f\u6709\uff1a\u65e5\u5fd7\u5206\u6790\u548c\u6587\u672c\u5904\u7406\uff0cgrep\u53ef\u4ee5\u4ece\u65e5\u5fd7\u6587\u4ef6\u4e2d\u627e\u51fa\u9519\u8bef\u4fe1\u606f\u6216\u7279\u5b9a\u4e8b\u4ef6\uff0c\u4e5f\u7528\u4e8e\u4ece\u5927\u91cf\u6587\u672c\u6587\u4ef6\u4e2d\u63d0\u53d6\u7279\u5b9a\u4fe1\u606f</p>"},{"location":"chap8/1log_man/#22","title":"2.2 \u5de5\u4f5c\u539f\u7406","text":"<p>grep\u8fdb\u884c\u6587\u672c\u641c\u7d22\u65f6\u4e3b\u8981\u8fdb\u884c\u4ee5\u4e0b\u4e09\u6b65\uff1a</p> <p>\uff081\uff09\u8f93\u5165\u5904\u7406\uff1agrep \u4ece\u6307\u5b9a\u7684\u6587\u4ef6\u6216\u6807\u51c6\u8f93\u5165\u4e2d\u9010\u884c\u8bfb\u53d6\u6570\u636e\uff0c\u68c0\u67e5\u6bcf\u884c\u662f\u5426\u4e0e\u7528\u6237\u63d0\u4f9b\u7684\u6a21\u5f0f\u5339\u914d\u3002</p> <p>\uff082\uff09\u6a21\u5f0f\u5339\u914d\uff1agrep \u91c7\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u8fdb\u884c\u6a21\u5f0f\u5339\u914d\uff0c\u6839\u636e\u89c4\u5219\u68c0\u67e5\u6bcf\u4e00\u884c\u662f\u5426\u7b26\u5408\u6761\u4ef6\u3002</p> <p>\uff083\uff09\u8f93\u51fa\u7ed3\u679c\uff1a\u5f53\u67d0\u884c\u5339\u914d\u6210\u529f\u65f6\uff0cgrep \u4f1a\u5c06\u8be5\u884c\u8f93\u51fa</p>"},{"location":"chap8/1log_man/#23","title":"2.3 \u8bed\u6cd5\u548c\u53ef\u9009\u9879","text":"<p>\uff081\uff09\u57fa\u672c\u8bed\u6cd5</p> <pre><code>grep [options] pattern [file...]\n</code></pre> <ul> <li>options\uff1a\u53ef\u9009\u53c2\u6570\uff0c\u7528\u6765\u63a7\u5236\u641c\u7d22\u7684\u65b9\u5f0f\u3001\u8f93\u51fa\u683c\u5f0f\u7b49\uff0c\u4e0b\u9762\u4f1a\u8fdb\u884c\u8be6\u7ec6\u8bb2\u89e3</li> <li>pattern\uff1a\u5fc5\u586b\u9879\uff0c\u662f\u8981\u641c\u7d22\u7684\u6a21\u5f0f\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u7528\u4e8e\u5339\u914d\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9</li> <li>file\uff1a \u662f\u8981\u641c\u7d22\u7684\u6587\u4ef6\u540d\u6216\u76ee\u5f55\uff0c\u53ef\u4ee5\u662f\u591a\u4e2a</li> </ul> <p>\uff082\uff09\u53ef\u9009\u9879\u53c2\u6570</p> <pre><code>-E\n\u4f7f\u7528\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f\uff0cgrep -E \u7b49\u540c\u4e8eegrep\n\n-i\n\u5ffd\u7565\u5927\u5c0f\u5199\n\n-r\n\u9012\u5f52\u641c\u7d22\u67d0\u4e2a\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\n\n-v\n\u53cd\u5411\u5339\u914d\uff0c\u8f93\u51fa\u4e0d\u5339\u914d\u7684\u884c\n\n-n\n\u663e\u793a\u884c\u53f7\n\n-c\n\u663e\u793a\u5339\u914d\u884c\u7684\u603b\u6570\uff0c\u800c\u4e0d\u662f\u6253\u5370\u5339\u914d\u884c\u3002\n\n-A n\n\u8f93\u51fa\u5339\u914d\u7684\u540en\u884c\n\n-B n\n\u8f93\u51fa\u5339\u914d\u7684\u524dn\u884c\n\n-C n\n\u6253\u5370\u5339\u914d\u524d\u540e\u7684n\u884c\n\n-L\n\u5217\u51fa\u672a\u5305\u542b\u5339\u914d\u9879\u7684\u6587\u4ef6\u540d\n\n-o\n\u53ea\u663e\u793a\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\u672c\u8eab\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u884c\n\n-w\n\u7cbe\u786e\u5339\u914d\u6574\u8bcd\uff0c\u9632\u6b62\u5339\u914d\u5230\u5305\u542b\u8be5\u5355\u8bcd\u7684\u90e8\u5206\u8bcd\u6c47\n</code></pre>"},{"location":"chap8/1log_man/#24","title":"2.4 \u5b9e\u6218\u64cd\u4f5c","text":"<p>\uff081\uff09-i\u9009\u9879\uff1a\u5ffd\u7565\u5927\u5c0f\u5199</p> <pre><code># \u6253\u5370\u5904\u65e5\u5fd7\u6587\u4ef6\u4e2d\u6240\u6709\u5305\u542berror\u5b57\u7b26\u7684\uff0c\u4e0d\u8bba\u5927\u5c0f\u5199\ngrep -i error /var/log/message\n</code></pre> <p>\uff082\uff09-r\u9009\u9879\uff1a\u9012\u5f52\u67e5\u8be2</p> <pre><code># \u8f93\u51fa/etc/nginx/conf.d\u76ee\u5f55\u6240\u6709\u5173\u4e8ewww\u5b57\u7b26\u7684\u884c\uff0c\u5e38\u7528\u67e5\u627e\u57df\u540d\u6216\u7aef\u53e3\u4fe1\u606f\ngrep -ir /etc/nginx/conf.d\n</code></pre> <p>\uff083\uff09-E\u9009\u9879\uff1a\u652f\u6301\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f \uff084\uff09-v\u9009\u9879\uff1a\u53cd\u5411\u5339\u914d</p> <pre><code># \u8fc7\u6ee4\u67d0\u4e2a\u6587\u4ef6\u7684\u6240\u6709\u7a7a\u884c\u548c\u5e26#\u53f7\u6ce8\u91ca\u7684\u884c\ngrep -Ev '^#|^$'  /etc/nginx.conf\n</code></pre> <p>\uff085\uff09-n\u9009\u9879\uff1a\u663e\u793a\u884c\u53f7</p> <pre><code># \u627e\u51fa\u5305\u542broot\u548cssh\u5b57\u7b26\u7684\u884c\u53f7\ngrep -En 'root|ssh' /etc/passwd\n</code></pre> <p>\uff086\uff09-l\u9009\u9879\uff1a\u67e5\u627e\u6587\u4ef6\u540d</p> <pre><code># \u67e5\u627e\u6587\u4ef6\u5305\u542broot\u5b57\u7b26\u7684\u6587\u4ef6\u540d\ngrep -l root * \n</code></pre> <ul> <li> <p>\uff087\uff09-A\u9009\u9879\uff1a\u67e5\u627e\u540e\u9762\u51e0\u4e2a\u5b57\u7b26</p> </li> <li> <p>\uff088\uff09-B\u9009\u7ebf\uff1a\u67e5\u627e\u524d\u9762\u51e0\u4e2a\u5b57\u7b26</p> </li> <li> <p>\uff089\uff09-C\u9009\u62e9\uff1a\u67e5\u627e\u524d\u540e\u51e0\u4e2a\u5b57\u7b26</p> </li> </ul> <pre><code># \u67e5\u627e\u6709\u9519\u8bef\u7684\u540e\u97623\u884c\u4fe1\u606f\ngrep -iA 3 error /var/log/messages\n# \u67e5\u627e\u6709\u9519\u8bef\u7684\u524d\u97623\u884c\u4fe1\u606f\ngrep -iB 3 error /var/log/messages\n# \u67e5\u627e\u6709\u9519\u8bef\u7684\u4e0a\u4e0b3\u884c\u4fe1\u606f\ngrep -iC 3 error /var/log/messages\n</code></pre>"},{"location":"chap8/1log_man/#3-sed","title":"3 sed\uff1a\u7f16\u8f91\u4e4b\u5251\u8be6\u89e3","text":"<p>sed\u662f\u7f16\u8f91\u4e4b\u5251\uff1a\u4e00\u4e2a\u6d41\u7f16\u8f91\u5668\uff0c\u5b83\u5141\u8bb8\u7528\u6237\u5728\u6587\u4ef6\u4e2d\u8fdb\u884c\u6587\u672c\u66ff\u6362\u3001\u5220\u9664\u3001\u6dfb\u52a0\u7b49\u64cd\u4f5c\u3002</p> <p>sed\u652f\u6301\u57fa\u7840\u548c\u6269\u5c55\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u5e76\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u6587\u672c\u5904\u7406\u529f\u80fd\uff0c\u5982\u66ff\u6362\u547d\u4ee4\u3001\u5730\u5740\u5b9a\u754c\u7b49\u3002sed\u7684\u5f3a\u5927\u4e4b\u5904\u5728\u4e8e\u5b83\u53ef\u4ee5\u975e\u4ea4\u4e92\u5f0f\u5730\u7f16\u8f91\u6587\u4ef6\u6216\u6807\u51c6\u8f93\u5165\uff0c\u4f7f\u5176\u6210\u4e3a\u81ea\u52a8\u5316\u6587\u672c\u5904\u7406\u7684\u7406\u60f3\u9009\u62e9\u3002</p> <p>\u5e94\u7528\u573a\u666f\u6709\uff1a\u6279\u91cf\u66ff\u6362\uff0c\u6587\u672c\u5904\u7406\uff0c\u901a\u8fc7sed\u547d\u4ee4\u53ef\u4ee5\u5feb\u901f\u66ff\u6362\u6587\u4ef6\u4e2d\u7684\u7279\u5b9a\u5b57\u7b26\u4e32\uff0c\u5982\u914d\u7f6e\u6587\u4ef6\u7684\u4fee\u6539\uff1b\u5728shell\u811a\u672c\u4e2d\u7ed3\u5408\u5176\u4ed6\u547d\u4ee4\u5982grep\u3001awk\u7b49\uff0c\u5b9e\u73b0\u590d\u6742\u7684\u6587\u672c\u5904\u7406\u4efb\u52a1</p>"},{"location":"chap8/1log_man/#32","title":"3.2 \u5de5\u4f5c\u539f\u7406","text":"<p>sed\u7684\u5de5\u4f5c\u6d41\u7a0b\u5305\u62ec\u8bfb\u53d6\u3001\u6267\u884c\u548c\u663e\u793a\u4e09\u4e2a\u4e3b\u8981\u8fc7\u7a0b\u3002</p> <p>\u5b83\u4f1a\u4ece\u8f93\u5165\u6d41\u4e2d\u8bfb\u53d6\u4e00\u884c\u5185\u5bb9\u5e76\u5b58\u50a8\u5230\u4e34\u65f6\u7f13\u51b2\u533a\uff08\u6a21\u5f0f\u7a7a\u95f4\uff09\uff0c\u7136\u540e\u6839\u636e\u8bbe\u5b9a\u7684\u547d\u4ee4\u5728\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u6267\u884c\u7f16\u8f91\u64cd\u4f5c\uff0c\u6700\u540e\u5c06\u5904\u7406\u540e\u7684\u5185\u5bb9\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa</p>"},{"location":"chap8/1log_man/#33","title":"3.3 \u8bed\u6cd5\u3001\u9009\u9879\u548c\u52a8\u4f5c\u4ecb\u7ecd","text":"<p>\uff081\uff09\u57fa\u672c\u8bed\u6cd5</p> <pre><code>sed [option] 'sed command' file\n</code></pre> <p>\uff082\uff09\u5e38\u7528\u9009\u9879</p> <pre><code>-n\n\u53ea\u6253\u5370\u5339\u914d\u5904\u7406\u7684\u884c\uff0c\u4e0d\u4fee\u6539\u6587\u4ef6\n\n-e\n\u5141\u8bb8\u591a\u4e2a\u7f16\u8f91\u547d\u4ee4\u540c\u65f6\u6267\u884c\n\n-f\n\u4ece\u811a\u672c\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5e76\u6267\u884csed\u547d\u4ee4\n\n-i\n\u76f4\u63a5\u4fee\u6539\u6587\u4ef6\u5185\u5bb9\n\n-r\n\u652f\u6301\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f\n</code></pre> <p>\uff083\uff09\u5e38\u7528\u52a8\u4f5c</p> <pre><code>p \u6253\u5370\u6a21\u5f0f\u7a7a\u95f4\u7684\u5185\u5bb9\na \u5728\u5f53\u524d\u884c\u540e\u8ffd\u52a0\u5185\u5bb9\ni \u5728\u5f53\u524d\u884c\u524d\u63d2\u5165\u5185\u5bb9\nc \u7528\u65b0\u6587\u672c\u66ff\u6362\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\nd \u5220\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\ns \u66ff\u6362\u5185\u5bb9\n</code></pre>"},{"location":"chap8/1log_man/#34","title":"3.4 \u5b9e\u6218\u64cd\u4f5c","text":"<p>sed\u53ef\u4ee5\u505a\u589e\u5220\u6539\u67e5\u64cd\u4f5c\uff0c\u63a5\u4e0b\u6765\u5206\u522b\u6f14\u793a\u3002</p> <p>\u590d\u5236/etc/passwd\u6587\u4ef6\u5230/opt\u4e0b\uff0c\u4ee5/opt/passwd\u6765\u505a\u6d4b\u8bd5\u64cd\u4f5c</p> <pre><code>cp /etc/passwd /opt/passwd\n</code></pre> <p>\uff081\uff09\u589e\u52a0\u64cd\u4f5c</p> <p>\u4e3b\u8981\u6709\u4e24\u4e2a\u52a8\u4f5c\u6307\u4ee4\uff1aa\u662f\u8ffd\u52a0\u5185\u5bb9\u5230\u6307\u5b9a\u884c\u540e\u9762\uff0ci\u662f\u63d2\u5165\u5185\u5bb9\u5230\u6307\u5b9a\u884c\u524d\u9762</p> <pre><code># \u5728\u7b2c2\u884c\u540e\u9762\u8ffd\u52a0\u5185\u5bb9\n# \u6ce8\u610f\uff1a\u8fd9\u6837\u53ea\u662f\u6253\u5370\u51fa\u6765\uff0c\u5e76\u6ca1\u6709\u4fee\u6539\u6587\u4ef6\u91cc\u9762\u7684\u5185\u5bb9\uff0c\u5982\u679c\u8981\u4fee\u6539\uff0c\u9700\u52a0-i\u53c2\u6570\nsed '1a 123' /opt/passwd \n\n# \u5728\u7b2c\u4e00\u884c\u524d\u9762\u63d2\u5165\u5185\u5bb9\uff0c\u52a0-i\u540e\u6587\u4ef6\u771f\u5b9e\u6539\u53d8\nsed -i '1i 456'  /opt/passwd\n\n# \u5728\u6700\u540e\u4e00\u884c\u540e\u9762\u8ffd\u52a0\u5185\u5bb9\nsed '$a 789' /opt/passwd\n</code></pre> <p>\uff082\uff09\u5220\u9664\u64cd\u4f5c</p> <pre><code># \u5220\u9664\u7b2c\u4e00\u884c\nsed '1d'  /opt/passwd \n\n# \u5220\u96642-4\u884c\nsed '2,4d'  /opt/passwd\n\n# \u5c06\u5339\u914d\u7684\u884c\u8fdb\u884c\u5220\u9664\nsed '/\\/bin\\/bash/d' /opt/passwd\n\n# \u5220\u9664\u4ee5root\u5f00\u5934\u7684\u884c\nsed '/^root/d' /opt/passwd\n\n# \u5220\u9664\u6587\u4e2d\u7684\u7a7a\u884c\u548c\u6ce8\u91ca\nsed -e '/^#/d' -e '/^$/d' /opt/passwd\n</code></pre> <p>\uff083\uff09\u66f4\u6539\u64cd\u4f5c</p> <p>s\u662f\u7528\u4e8e\u66ff\u6362\u64cd\u4f5c\u7684\uff0c\u65e5\u5e38\u4e2d\u6700\u4e3a\u5e38\u7528\uff0c\u914d\u5408g\u4f7f\u7528\uff0c\u53ef\u4ee5\u66ff\u6362\u5168\u90e8\u5339\u914d\u5230\u7684\u5185\u5bb9</p> <pre><code># \u66ff\u6362\u5e38\u7528\u6a21\u677f\uff0c\u4e5f\u53ef\u4ee5\u5c06#\u6539\u4e3a/\nsed -i 's#\u76ee\u6807\u5185\u5bb9#\u66ff\u6362\u5185\u5bb9#g' file\n\n# \u5e38\u7528\u4e8e\u4fee\u6539selinux\u7684\u547d\u4ee4\nsed -i 'sy#=enforcing#=disabled#g' /etc/selinux/config\n\n# \u5c06nologin\u66ff\u6362\u6210login\nsed 's/nologin/login/g' /opt/passwd\n\n# \u4ee5mail\u5f00\u5934\u7684\u884c\uff0c\u5c06\u8be5\u884c\u6240\u6709\u7684mail\u66ff\u6362\u4e3agmail\nsed '/^mail/{s#mail#gmail#g}' /opt/passwd \n</code></pre> <p>\uff084\uff09\u67e5\u627e\u64cd\u4f5c</p> <pre><code># \u53ea\u6253\u5370\u7b2c\u4e09\u884c\u5185\u5bb9\nsed -n '3p'  /opt/passwd\n</code></pre>"},{"location":"chap8/1log_man/#4-awk","title":"4 awk\uff1a\u8fc7\u6ee4\u4e4b\u5251","text":""},{"location":"chap8/1log_man/#41-awk","title":"4.1 awk\u7b80\u4ecb","text":"<p>awk\u662f\u4e00\u4e2a\u7f16\u7a0b\u8bed\u8a00\u5de5\u5177\uff0c\u4e3b\u8981\u7528\u4e8e\u5904\u7406\u6570\u636e\u548c\u751f\u6210\u62a5\u544a\u3002\u5b83\u80fd\u591f\u6309\u884c\u548c\u5217\u5206\u6790\u6587\u672c\u6587\u4ef6\uff0c\u5e76\u5bf9\u7b26\u5408\u6761\u4ef6\u7684\u6570\u636e\u6267\u884c\u64cd\u4f5c\uff0c\u6570\u636e\u53ef\u4ee5\u6765\u81ea\u6807\u51c6\u8f93\u5165\u4e5f\u53ef\u4ee5\u662f\u7ba1\u9053\u6216\u6587\u4ef6\u3002awk\u7279\u522b\u9002\u5408\u4e8e\u5904\u7406\u7ed3\u6784\u5316\u7684\u6587\u672c\u6570\u636e\uff0c\u5982\u65e5\u5fd7\u6587\u4ef6\u3001CSV\u6587\u4ef6\u7b49</p>"},{"location":"chap8/1log_man/#42","title":"4.2 \u5de5\u4f5c\u539f\u7406","text":"<p>awk\u7684\u5de5\u4f5c\u539f\u7406\u53ef\u4ee5\u5206\u4e3a\u4e09\u4e2a\u4e3b\u8981\u90e8\u5206\uff1aBEGIN\u5757\u3001\u4e3b\u5faa\u73af\u4f53\u548cEND\u5757\u3002</p> <p>BEGIN\u5757\u4e2d\u7684\u4ee3\u7801\u5728\u5904\u7406\u4efb\u4f55\u8f93\u5165\u884c\u4e4b\u524d\u6267\u884c\uff0c\u4e14\u53ea\u6267\u884c\u4e00\u6b21\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u521d\u59cb\u5316\u53d8\u91cf\u6216\u6253\u5370\u8868\u5934\u4fe1\u606f\uff1b</p> <p>\u4e3b\u5faa\u73af\u4f53\u662fawk\u7684\u6838\u5fc3\u90e8\u5206\uff0c\u9010\u884c\u8bfb\u53d6\u8f93\u5165\u6587\u4ef6\u5e76\u5bf9\u6bcf\u884c\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u5b83\u4f1a\u6309\u6307\u5b9a\u7684\u5206\u9694\u7b26\uff08\u9ed8\u8ba4\u4e3a\u7a7a\u683c\u6216\u5236\u8868\u7b26\uff09\u5c06\u6bcf\u884c\u5206\u5272\u6210\u5b57\u6bb5\uff0c\u5e76\u5b58\u5165\u5185\u5efa\u53d8\u91cf\u4e2d\uff1b</p> <p>END\u5757\u4e2d\u7684\u4ee3\u7801\u5728\u6240\u6709\u8f93\u5165\u884c\u5904\u7406\u5b8c\u6bd5\u540e\u6267\u884c\uff0c\u4e14\u53ea\u6267\u884c\u4e00\u6b21\u3002\u5e38\u7528\u4e8e\u8f93\u51fa\u6700\u7ec8\u7ed3\u679c\u6216\u603b\u7ed3\u4fe1\u606f</p> <p>\u6ce8\u610f\uff1a\u5728\u4f7f\u7528awk\u65f6\u4e0d\u4e00\u5b9a\u8981\u6bcf\u4e2a\u90e8\u5206\u90fd\u51fa\u73b0\uff0c\u6839\u636e\u5b9e\u9645\u5904\u7406\u9700\u6c42\u6765\u4f7f\u7528\u54ea\u4e2a\u90e8\u5206\u3002</p> <p>\u5177\u4f53\u7684\u5de5\u4f5c\u6d41\u7a0b\u5206\u4e3a\u4ee5\u4e0b\u4e09\u6b65\uff1a</p> <ul> <li>\u8bfb\uff08Read\uff09\uff1a\u4ece\u6587\u4ef6\u3001\u7ba1\u9053\u6216\u6807\u51c6\u8f93\u5165\u4e2d\u8bfb\u5165\u4e00\u884c\u7136\u540e\u628a\u5b83\u5b58\u653e\u5230\u5185\u5b58\u4e2d</li> <li>\u6267\u884c\uff08Execute\uff09\uff1a\u5bf9\u6bcf\u4e00\u884c\u6570\u636e\uff0c\u6839\u636e AWK \u547d\u4ee4\u6309\u987a\u5e8f\u6267\u884c\u3002\u9ed8\u8ba4\u60c5\u51b5\u662f\u5904\u7406\u6bcf\u4e00\u884c\u6570\u636e\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u6a21\u5f0f</li> <li>\u91cd\u590d\uff08Repeat\uff09\uff1a\u4e00\u76f4\u91cd\u590d\u4e0a\u8ff0\u4e24\u4e2a\u8fc7\u7a0b\u76f4\u5230\u6587\u4ef6\u7ed3\u675f</li> </ul>"},{"location":"chap8/1log_man/#43","title":"4.3 \u8bed\u6cd5\u53c2\u6570","text":"<p>\uff081\uff09\u57fa\u7840\u8bed\u6cd5 awk\u6307\u4ee4\u662f\u7531\u6a21\u5f0f\uff0c\u52a8\u4f5c\uff0c\u6216\u8005\u6a21\u5f0f\u548c\u52a8\u4f5c\u7684\u7ec4\u5408\u7ec4\u6210\u3002</p> <pre><code>awk [options] 'pattern {action}' file\n</code></pre> <pre><code>-F &lt;\u5206\u9694\u7b26&gt;\n\u7528\u4e8e\u6307\u5b9a\u8f93\u5165\u5b57\u6bb5\u7684\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u662f\u7a7a\u683c\uff0c\u53ef\u4ee5\u4f7f\u7528\u9017\u53f7\uff0c\u5192\u53f7\u7b49\n\n-v &lt;\u53d8\u91cf\u540d&gt;=&lt;\u503c&gt;\n\u7528\u4e8e\u5b9a\u4e49\u4e00\u4e2a\u53d8\u91cf\u5e76\u8d4b\u503c\n\n-f &lt;\u811a\u672c\u6587\u4ef6&gt;\n\u7528\u4e8e\u4ece\u6307\u5b9a\u7684\u811a\u672c\u6587\u4ef6\u4e2d\u8bfb\u53d6awk\u547d\u4ee4\uff0c\u9002\u7528\u4e8eawk\u6307\u4ee4\u8f83\u590d\u6742\u573a\u666f\n\n-r &lt;\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f&gt;\n\u7528\u4e8e\u542f\u7528\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u5339\u914d\u529f\u80fd\n\n-s\n\u7528\u4e8e\u7981\u7528\u81ea\u52a8\u6362\u884c\u529f\u80fd\uff0c\u4f7f\u5f97awk\u5728\u8f93\u51fa\u65f6\u4e0d\u4f1a\u81ea\u52a8\u6362\u884c\n\n-c &lt;\u547d\u4ee4&gt;\n\u7528\u4e8e\u6267\u884c\u5355\u4e2aawk\u547d\u4ee4\u800c\u4e0d\u662f\u4ece\u6587\u4ef6\u8bfb\u53d6\n</code></pre> <p>\uff083\uff09\u5185\u7f6e\u53d8\u91cf</p> <pre><code>NF\n\u8868\u793a\u5f53\u524d\u8bb0\u5f55\u7684\u5b57\u6bb5\u6570\u91cf\n\nNR\n\u8868\u793a\u5df2\u8bfb\u7684\u8bb0\u5f55\u6570\uff08\u5373\u884c\u53f7\uff09\n\nFS\n\u8868\u793a\u8f93\u5165\u5b57\u6bb5\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\u683c\u6216\u5236\u8868\u7b26\n\nOFS\n\u8868\u793a\u8f93\u51fa\u5b57\u6bb5\u5206\u9694\u7b26\n\nRS\n\u8868\u793a\u8f93\u5165\u8bb0\u5f55\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\u6362\u884c\u7b26\n\n$0\n\u5f53\u524d\u5904\u7406\u7684\u884c\u7684\u6574\u884c\u5185\u5bb9\n\n$n\n\u5f53\u524d\u5904\u7406\u884c\u7684\u7b2cn\u4e2a\u5b57\u6bb5\uff08\u7b2cn\u5217\uff09\n</code></pre>"},{"location":"chap8/1log_man/#44","title":"4.4 \u5b9e\u6218\u64cd\u4f5c","text":"<p>awk\u64cd\u4f5c\u4e5f\u662f\u7528/opt/passwd\u6587\u4ef6\u6f14\u793a</p> <p>\uff081\uff09\u8f93\u51fa\u5168\u6587\u5185\u5bb9\u5e76\u9644\u5e26\u884c\u53f7</p> <pre><code>awk '{print NR,$0}' /opt/passwd\n</code></pre> <p>\uff082\uff09\u53ea\u6253\u5370\u7b2c\u4e94\u884c</p> <pre><code>awk 'NR==2{print}'\n</code></pre> <p>\uff083\uff09\u4ee5\uff1a \u4e3a\u5206\u9694\u7b26\uff0c\u6253\u5370\u7b2c\u4e00\u5217</p> <pre><code>awk -F \":\" '{print $1}'  /opt/passwd\n</code></pre> <p>\uff084\uff09\u4ee5\uff1a \u4e3a\u5206\u9694\u7b26\uff0c\u6253\u5370\u7b2c2\u5217\u548c\u6700\u540e\u4e00\u5217</p> <pre><code>awk -F \":\" '{print $2,$NF}' /opt/passwd\n</code></pre> <p>\uff085\uff09\u6253\u5370\u4ee5\uff1a\u548c/ \u4e3a\u5206\u9694\u7b26\u4e14\u5305\u542broot\u7684\u884c\u7684\u5217\u6570</p> <pre><code>awk -F \":/\" '/root/{print NF}' /opt/passwd\n</code></pre> <p>\uff086\uff09\u6253\u5370\u4ee5\uff1a\u4e3a\u5206\u9694\u7b26\u5305\u542broot\u7684\u884c\u6570\u548c\u6574\u884c\u5185\u5bb9</p> <pre><code>awk -F \":/\" '/root/{print NR,$0}' /opt/passwd\n</code></pre> <p>\uff087\uff09\u683c\u5f0f\u5316\u5b9a\u5236</p> <pre><code>[root@localhost ~]# awk -F \":\" '{print \"\u7b2c\"NR\"\u884c\u6709\"NF\"\u5217\"}' /opt/passwd\n\u7b2c1\u884c\u67091\u5217\n\u7b2c2\u884c\u67097\u5217\n\u7b2c3\u884c\u67097\u5217\n\u7b2c4\u884c\u67097\u5217\n</code></pre>"},{"location":"chap8/1shell_logs/","title":"1 Shell \u5206\u6790\u670d\u52a1\u5668\u65e5\u5fd7\u547d\u4ee4","text":"<p>1\u3001\u67e5\u770b\u6709\u591a\u5c11\u4e2aIP\u8bbf\u95ee\uff1a</p> <pre><code>awk '{print $1}' log_file | sort | uniq |wc -l\n</code></pre> <ul> <li><code>awk '{print $1}' log_file</code>  output 1st col</li> </ul> <p>2\u3001\u67e5\u770b\u67d0\u4e00\u4e2a\u9875\u9762\u88ab\u8bbf\u95ee\u7684\u6b21\u6570\uff1a</p> <pre><code>grep \"/index.php\" log_file | wc -l\n</code></pre> <p>3\u3001\u67e5\u770b\u6bcf\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u591a\u5c11\u4e2a\u9875\u9762\uff1a</p> <pre><code>awk '{++S[$1]} END {for (a in S) print a,S[a]}' log_file &gt; log.txt\n\nsort -n -t ' ' -k 2 log.txt   \u914d\u5408sort\u8fdb\u4e00\u6b65\u6392\u5e8f\n</code></pre> <ul> <li><code>-n</code> Option: To sort a file numerically used <code>\u2013n</code> option</li> <li><code>-k</code> Option: Unix provides the feature of sorting a table on the basis of any column number by using <code>-k</code> option. <ul> <li>Use the <code>-k</code> option to sort on a certain column. For example, use <code>\u201c-k 2\u201d</code> to sort on the second column. </li> </ul> </li> <li><code>-t</code> separator <code>' '</code></li> </ul> <p>4\u3001\u5c06\u6bcf\u4e2aIP\u8bbf\u95ee\u7684\u9875\u9762\u6570\u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff1a</p> <pre><code>awk '{++S[$1]} END {for (a in S) print S[a],a}' log_file | sort -n\n</code></pre> <p>5\u3001\u67e5\u770b\u67d0\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u54ea\u4e9b\u9875\u9762\uff1a</p> <pre><code>grep ^111.111.111.111 log_file| awk '{print $1,$7}'\n</code></pre> <ul> <li>1th col to 7th col</li> </ul> <p>6\u3001\u53bb\u6389\u641c\u7d22\u5f15\u64ce\u7edf\u8ba1\u7684\u9875\u9762\uff1a</p> <pre><code>awk '{print $12,$1}' log_file | grep ^\\\"Mozilla | awk '{print $2}' | sort | uniq | wc -l\n</code></pre> <p>7\u3001\u67e5\u770b2015\u5e748\u670816\u65e514\u65f6\u8fd9\u4e00\u4e2a\u5c0f\u65f6\u5185\u6709\u591a\u5c11IP\u8bbf\u95ee:</p> <pre><code>awk '{print $4,$1}' log_file | grep 16/Aug/2015:14 | awk '{print $2}'| sort | uniq | wc -l\n</code></pre> <p>8\u3001\u67e5\u770b\u8bbf\u95ee\u524d\u5341\u4e2aip\u5730\u5740</p> <pre><code>awk '{print $1}' | sort |uniq -c |sort -nr | head -10 access_log\n</code></pre> <p><code>uniq -c</code> \u76f8\u5f53\u4e8e\u5206\u7ec4\u7edf\u8ba1\u5e76\u628a\u7edf\u8ba1\u6570\u653e\u5728\u6700\u524d\u9762</p> <pre><code>cat access.log|awk '{print $1}'|sort|uniq -c|sort -nr|head -10\n</code></pre> <pre><code>cat access.log|awk '{counts[$(11)]+=1}; END {for(url in counts) print counts[url], url}\n</code></pre> <p>9\u3001\u8bbf\u95ee\u6b21\u6570\u6700\u591a\u768410\u4e2a\u6587\u4ef6\u6216\u9875\u9762</p> <pre><code>cat log_file|awk '{print $11}'|sort|uniq -c|sort -nr | head -10\n\ncat log_file|awk '{print $11}'|sort|uniq -c|sort -nr|head -20\n\nawk '{print $1}' log_file |sort -n -r |uniq -c | sort -n -r | head -20\n</code></pre> <p>\u8bbf\u95ee\u91cf\u6700\u5927\u7684\u524d20\u4e2aip</p> <p>10\u3001\u901a\u8fc7\u5b50\u57df\u540d\u8bbf\u95ee\u6b21\u6570\uff0c\u4f9d\u636ereferer\u6765\u8ba1\u7b97\uff0c\u7a0d\u6709\u4e0d\u51c6</p> <pre><code>cat access.log | awk '{print $11}' | sed -e ' s/http:\\/\\///' -e ' s/\\/.*//' | sort | uniq -c | sort -rn | head -20\n</code></pre> <p>11\u3001\u5217\u51fa\u4f20\u8f93\u5927\u5c0f\u6700\u5927\u7684\u51e0\u4e2a\u6587\u4ef6</p> <pre><code>cat www.access.log | awk '($7~/\\.php/){print $10 \" \" $1 \" \" $4 \" \" $7}'| sort -nr |head -100\n</code></pre> <p>12\u3001\u5217\u51fa\u8f93\u51fa\u5927\u4e8e200000byte(\u7ea6200kb)\u7684\u9875\u9762\u4ee5\u53ca\u5bf9\u5e94\u9875\u9762\u53d1\u751f\u6b21\u6570</p> <pre><code>cat www.access.log |awk '($10 &gt; 200000 &amp;&amp; $7~/\\.php/){print $7}'|sort -n|uniq -c|sort -nr|head -100\n</code></pre> <p>13\u3001\u5982\u679c\u65e5\u5fd7\u6700\u540e\u4e00\u5217\u8bb0\u5f55\u7684\u662f\u9875\u9762\u6587\u4ef6\u4f20\u8f93\u65f6\u95f4\uff0c\u5219\u6709\u5217\u51fa\u5230\u5ba2\u6237\u7aef\u6700\u8017\u65f6\u7684\u9875\u9762</p> <pre><code>cat www.access.log |awk '($7~/\\.php/){print $NF \" \" $1 \" \" $4 \" \" $7}'|sort -nr|head -100\n</code></pre> <p>14\u3001\u5217\u51fa\u6700\u6700\u8017\u65f6\u7684\u9875\u9762(\u8d85\u8fc760\u79d2\u7684)\u7684\u4ee5\u53ca\u5bf9\u5e94\u9875\u9762\u53d1\u751f\u6b21\u6570</p> <pre><code>cat www.access.log |awk '($NF &gt; 60 &amp;&amp; $7~/\\.php/){print $7}'|sort -n|uniq -c|sort -nr|head -100\n</code></pre> <p>15\u3001\u5217\u51fa\u4f20\u8f93\u65f6\u95f4\u8d85\u8fc7 30 \u79d2\u7684\u6587\u4ef6</p> <pre><code>cat www.access.log |awk '($NF &gt; 30){print $7}'|sort -n|uniq -c|sort -nr|head -20\n</code></pre> <p>16\u3001\u5217\u51fa\u5f53\u524d\u670d\u52a1\u5668\u6bcf\u4e00\u8fdb\u7a0b\u8fd0\u884c\u7684\u6570\u91cf\uff0c\u5012\u5e8f\u6392\u5217</p> <pre><code>ps -ef | awk -F ' ' '{print $8 \" \" $9}' |sort | uniq -c |sort -nr |head -20\n</code></pre> <p>17\u3001\u67e5\u770bapache\u5f53\u524d\u5e76\u53d1\u8bbf\u95ee\u6570</p> <p>\u5bf9\u6bd4<code>httpd.conf</code>\u4e2d<code>MaxClients</code>\u7684\u6570\u5b57\u5dee\u8ddd\u591a\u5c11</p> <pre><code>netstat -an | grep ESTABLISHED | wc -l\n</code></pre> <p>18\u3001\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u53c2\u6570\u67e5\u770b\u6570\u636e</p> <pre><code>ps -ef|grep httpd|wc -l\n1388\n</code></pre> <p>\u7edf\u8ba1httpd\u8fdb\u7a0b\u6570\uff0c\u8fde\u4e2a\u8bf7\u6c42\u4f1a\u542f\u52a8\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u4f7f\u7528\u4e8eApache\u670d\u52a1\u5668\u3002</p> <p>\u8868\u793aApache\u80fd\u591f\u5904\u74061388\u4e2a\u5e76\u53d1\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u503cApache\u53ef\u6839\u636e\u8d1f\u8f7d\u60c5\u51b5\u81ea\u52a8\u8c03\u6574</p> <pre><code>netstat -nat |grep -i \"80\" |wc -l\n\n4341\n</code></pre> <ul> <li><code>netstat -an</code>\u4f1a\u6253\u5370\u7cfb\u7edf\u5f53\u524d\u7f51\u7edc\u94fe\u63a5\u72b6\u6001\uff0c\u800c<code>grep -i \u201c80\u201d</code>\u662f\u7528\u6765\u63d0\u53d6\u4e0e80\u7aef\u53e3\u6709\u5173\u7684\u8fde\u63a5\u7684\uff0c<code>wc -l</code>\u8fdb\u884c\u8fde\u63a5\u6570\u7edf\u8ba1\u3002</li> <li>\u6700\u7ec8\u8fd4\u56de\u7684\u6570\u5b57\u5c31\u662f\u5f53\u524d\u6240\u670980\u7aef\u53e3\u7684\u8bf7\u6c42\u603b\u6570</li> </ul> <pre><code>netstat -na|grep ESTABLISHED|wc -l\n\n376\n</code></pre> <p>netstat -an\u4f1a\u6253\u5370\u7cfb\u7edf\u5f53\u524d\u7f51\u7edc\u94fe\u63a5\u72b6\u6001\uff0c\u800cgrep ESTABLISHED \u63d0\u53d6\u51fa\u5df2\u5efa\u7acb\u8fde\u63a5\u7684\u4fe1\u606f\u3002\u7136\u540ewc -l\u7edf\u8ba1</p> <p>\u6700\u7ec8\u8fd4\u56de\u7684\u6570\u5b57\u5c31\u662f\u5f53\u524d\u6240\u670980\u7aef\u53e3\u7684\u5df2\u5efa\u7acb\u8fde\u63a5\u7684\u603b\u6570\u3002</p> <pre><code>netstat -nat||grep ESTABLISHED|wc\n</code></pre> <p>\u53ef\u67e5\u770b\u6240\u6709\u5efa\u7acb\u8fde\u63a5\u7684\u8be6\u7ec6\u8bb0\u5f55</p> <p>19\u3001\u8f93\u51fa\u6bcf\u4e2aip\u7684\u8fde\u63a5\u6570\uff0c\u4ee5\u53ca\u603b\u7684\u5404\u4e2a\u72b6\u6001\u7684\u8fde\u63a5\u6570</p> <pre><code>netstat -n | awk '/^tcp/ {n=split($(NF-1),array,\":\");if(n&lt;=2)++S[array[(1)]];else++S[array[(4)]];++s[$NF];++N} END {for(a in S){printf(\"%-20s %s\\n\", a, S[a]);++I}printf(\"%-20s %s\\n\",\"TOTAL_IP\",I);for(a in s) printf(\"%-20s %s\\n\",a, s[a]);printf(\"%-20s %s\\n\",\"TOTAL_LINK\",N);}'\n</code></pre> <p>20\u3001\u5176\u4ed6\u7684\u6536\u96c6</p> <p>\u5206\u6790\u65e5\u5fd7\u6587\u4ef6\u4e0b 2012-05-04 \u8bbf\u95ee\u9875\u9762\u6700\u9ad8 \u7684\u524d20\u4e2a URL \u5e76\u6392\u5e8f</p> <pre><code>cat access.log |grep '04/May/2012'| awk '{print $11}'|sort|uniq -c|sort -nr|head -20\n</code></pre> <p>\u67e5\u8be2\u53d7\u8bbf\u95ee\u9875\u9762\u7684URL\u5730\u5740\u4e2d \u542b\u6709 www.abc.com \u7f51\u5740\u7684 IP \u5730\u5740</p> <pre><code>cat access_log | awk '($11~/\\www.abc.com/){print $1}'|sort|uniq -c|sort -nr\n</code></pre> <p>\u83b7\u53d6\u8bbf\u95ee\u6700\u9ad8\u768410\u4e2aIP\u5730\u5740 \u540c\u65f6\u4e5f\u53ef\u4ee5\u6309\u65f6\u95f4\u6765\u67e5\u8be2</p> <pre><code>cat linewow-access.log|awk '{print $1}'|sort|uniq -c|sort -nr|head -10\n</code></pre> <p>\u65f6\u95f4\u6bb5\u67e5\u8be2\u65e5\u5fd7\u65f6\u95f4\u6bb5\u7684\u60c5\u51b5</p> <pre><code>cat log_file | egrep '15/Aug/2015|16/Aug/2015' |awk '{print $1}'|sort|uniq -c|sort -nr|head -10\n</code></pre> <p>\u5206\u6790 2015/8/15 \u5230 2015/8/16 \u8bbf\u95ee<code>\u201d/index.php?g=Member&amp;m=Public&amp;a=sendValidCode\u201d</code>\u7684IP\u5012\u5e8f\u6392\u5217</p> <pre><code>cat log_file | egrep '15/Aug/2015|16/Aug/2015' | awk '{if($7 == \"/index.php?g=Member&amp;m=Public&amp;a=sendValidCode\") print $1,$7}'|sort|uniq -c|sort -nr\n</code></pre> <p>($7~/.php/) $7\u91cc\u9762\u5305\u542b.php\u7684\u5c31\u8f93\u51fa,\u672c\u53e5\u7684\u610f\u601d\u662f\u6700\u8017\u65f6\u7684\u4e00\u767e\u4e2aPHP\u9875\u9762</p> <pre><code>cat log_file |awk '($7~/\\.php/){print $NF \" \" $1 \" \" $4 \" \" $7}'|sort -nr|head -100\n</code></pre> <p>\u5217\u51fa\u6700\u6700\u8017\u65f6\u7684\u9875\u9762(\u8d85\u8fc760\u79d2\u7684)\u7684\u4ee5\u53ca\u5bf9\u5e94\u9875\u9762\u53d1\u751f\u6b21\u6570</p> <pre><code>cat access.log |awk '($NF &gt; 60 &amp;&amp; $7~/\\.php/){print $7}'|sort -n|uniq -c|sort -nr|head -100\n</code></pre> <p>\u7edf\u8ba1\u7f51\u7ad9\u6d41\u91cf\uff08G)</p> <pre><code>cat access.log |awk '{sum+=$10} END {print sum/1024/1024/1024}'\n</code></pre> <p>\u7edf\u8ba1404\u7684\u8fde\u63a5</p> <pre><code>awk '($9 ~/404/)' access.log | awk '{print $9,$7}' | sort\n</code></pre> <p>\u7edf\u8ba1http status</p> <pre><code>cat access.log |awk '{counts[$(9)]+=1}; END {for(code in counts) print code, counts[code]}'\ncat access.log |awk '{print $9}'|sort|uniq -c|sort -rn\n</code></pre> <p>\u6bcf\u79d2\u5e76\u53d1</p> <pre><code>watch \"awk '{if($9~/200|30|404/)COUNT[$4]++}END{for( a in COUNT) print a,COUNT[a]}' log_file|sort -k 2 -nr|head -n10\"\n</code></pre> <p>\u5e26\u5bbd\u7edf\u8ba1</p> <pre><code>cat apache.log |awk '{if($7~/GET/) count++}END{print \"client_request=\"count}'\n</code></pre> <p>\u627e\u51fa\u67d0\u5929\u8bbf\u95ee\u6b21\u6570\u6700\u591a\u768410\u4e2aIP</p> <pre><code>cat /tmp/access.log | grep \"20/Mar/2011\" |awk '{print $3}'|sort |uniq -c|sort -nr|head\n</code></pre> <p>\u5f53\u5929ip\u8fde\u63a5\u6570\u6700\u9ad8\u7684ip\u90fd\u5728\u5e72\u4e9b\u4ec0\u4e48</p> <pre><code>cat access.log | grep \"10.0.21.17\" | awk '{print $8}' | sort | uniq -c | sort -nr | head -n 10\n</code></pre> <p>\u5c0f\u65f6\u5355\u4f4d\u91ccip\u8fde\u63a5\u6570\u6700\u591a\u768410\u4e2a\u65f6\u6bb5</p> <pre><code>awk -vFS=\"[:]\" '{gsub(\"-.*\",\"\",$1);num[$2\" \"$1]++}END{for(i in num)print i,num[i]}' log_file | sort -n -k 3 -r | head -10\n</code></pre> <p>\u627e\u51fa\u8bbf\u95ee\u6b21\u6570\u6700\u591a\u7684\u51e0\u4e2a\u5206\u949f</p> <pre><code>awk '{print $1}' access.log | grep \"20/Mar/2011\" |cut -c 14-18|sort|uniq -c|sort -nr|head\n</code></pre> <p>\u53d65\u5206\u949f\u65e5\u5fd7</p> <p><code>if [ $DATE_MINUTE != $DATE_END_MINUTE ] ;then</code> # \u5219\u5224\u65ad\u5f00\u59cb\u65f6\u95f4\u6233\u4e0e\u7ed3\u675f\u65f6\u95f4\u6233\u662f\u5426\u76f8\u7b49</p> <p><code>START_LINE=sed -n \"/$DATE_MINUTE/=\" $APACHE_LOG|head -n1</code> #\u5982\u679c\u4e0d\u76f8\u7b49\uff0c\u5219\u53d6\u51fa\u5f00\u59cb\u65f6\u95f4\u6233\u7684\u884c\u53f7\uff0c\u4e0e\u7ed3\u675f\u65f6\u95f4\u6233\u7684\u884c\u53f7</p> <p>\u67e5\u770btcp\u7684\u94fe\u63a5\u72b6\u6001</p> <pre><code>netstat -nat |awk '{print $6}'|sort|uniq -c|sort -rn \n\nnetstat -n | awk '/^tcp/ {++S[$NF]};END {for(a in S) print a, S[a]}' \n\nnetstat -n | awk '/^tcp/ {++state[$NF]}; END {for(key in state) print key,\"\\t\",state[key]}' \n\nnetstat -n | awk '/^tcp/ {++arr[$NF]};END {for(k in arr) print k,\"\\t\",arr[k]}' \n\nnetstat -n |awk '/^tcp/ {print $NF}'|sort|uniq -c|sort -rn \n\nnetstat -ant | awk '{print $NF}' | grep -v '[a-z]' | sort | uniq -c\nnetstat -ant|awk '/ip:80/{split($5,ip,\":\");++S[ip[1]]}END{for (a in S) print S[a],a}' |sort -n \n\nnetstat -ant|awk '/:80/{split($5,ip,\":\");++S[ip[1]]}END{for (a in S) print S[a],a}' |sort -rn|head -n 10 \n\nawk 'BEGIN{printf (\"http_code\\tcount_num\\n\")}{COUNT[$10]++}END{for (a in COUNT) printf a\"\\t\\t\"COUNT[a]\"\\n\"}'\n</code></pre> <p>\u67e5\u627e\u8bf7\u6c42\u6570\u524d20\u4e2aIP\uff08\u5e38\u7528\u4e8e\u67e5\u627e\u653b\u6765\u6e90\uff09\uff1a</p> <pre><code>netstat -anlp|grep 80|grep tcp|awk '{print $5}'|awk -F: '{print $1}'|sort|uniq -c|sort -nr|head -n20 \nnetstat -ant |awk '/:80/{split($5,ip,\":\");++A[ip[1]]}END{for(i in A) print A[i],i}' |sort -rn|head -n20\n</code></pre> <p>\u7528tcpdump\u55c5\u63a280\u7aef\u53e3\u7684\u8bbf\u95ee\u770b\u770b\u8c01\u6700\u9ad8</p> <pre><code>tcpdump -i eth0 -tnn dst port 80 -c 1000 | awk -F\".\" '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq -c | sort -nr |head -20\n</code></pre> <p>\u67e5\u627e\u8f83\u591a<code>time_wait</code>\u8fde\u63a5</p> <pre><code>netstat -n|grep TIME_WAIT|awk '{print $5}'|sort|uniq -c|sort -rn|head -n20\n</code></pre> <p>\u627e\u67e5\u8f83\u591a\u7684SYN\u8fde\u63a5</p> <pre><code>netstat -an | grep SYN | awk '{print $5}' | awk -F: '{print $1}' | sort | uniq -c | sort -nr | more\n</code></pre> <p>\u6839\u636e\u7aef\u53e3\u5217\u8fdb\u7a0b</p> <pre><code>netstat -ntlp | grep 80 | awk '{print $7}' | cut -d/ -f1\n</code></pre> <p>\u67e5\u770b\u4e86\u8fde\u63a5\u6570\u548c\u5f53\u524d\u7684\u8fde\u63a5\u6570</p> <pre><code>netstat -ant | grep $ip:80 | wc -l \nnetstat -ant | grep $ip:80 | grep EST | wc -l\n</code></pre> <p>\u67e5\u770bIP\u8bbf\u95ee\u6b21\u6570</p> <pre><code>netstat -nat|grep \":80\"|awk '{print $5}' |awk -F: '{print $1}' | sort| uniq -c|sort -n\n</code></pre> <p>Linux\u547d\u4ee4\u5206\u6790\u5f53\u524d\u7684\u94fe\u63a5\u72b6\u51b5</p> <pre><code>netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}'\n</code></pre> <pre><code>watch \"netstat -n | awk '/^tcp/ {++S[\\$NF]} END {for(a in S) print a, S[a]}'\" # \u901a\u8fc7watch\u53ef\u4ee5\u4e00\u76f4\u76d1\u63a7\n</code></pre> <p><code>LAST_ACK 5</code> #\u5173\u95ed\u4e00\u4e2aTCP\u8fde\u63a5\u9700\u8981\u4ece\u4e24\u4e2a\u65b9\u5411\u4e0a\u5206\u522b\u8fdb\u884c\u5173\u95ed\uff0c\u53cc\u65b9\u90fd\u662f\u901a\u8fc7\u53d1\u9001FIN\u6765\u8868\u793a\u5355\u65b9\u5411\u6570\u636e\u7684\u5173\u95ed\uff0c\u5f53\u901a\u4fe1\u53cc\u65b9\u53d1\u9001\u4e86\u6700\u540e\u4e00\u4e2aFIN\u7684\u65f6\u5019\uff0c\u53d1\u9001\u65b9\u6b64\u65f6\u5904\u4e8eLAST_ACK\u72b6\u6001\uff0c\u5f53\u53d1\u9001\u65b9\u6536\u5230\u5bf9\u65b9\u7684\u786e\u8ba4\uff08Fin\u7684Ack\u786e\u8ba4\uff09\u540e\u624d\u771f\u6b63\u5173\u95ed\u6574\u4e2aTCP\u8fde\u63a5\uff1b</p> <p><code>SYN_RECV 30</code> # \u8868\u793a\u6b63\u5728\u7b49\u5f85\u5904\u7406\u7684\u8bf7\u6c42\u6570\uff1b</p> <p><code>ESTABLISHED 1597</code> # \u8868\u793a\u6b63\u5e38\u6570\u636e\u4f20\u8f93\u72b6\u6001\uff1b</p> <p><code>FIN_WAIT1 51</code> # \u8868\u793aserver\u7aef\u4e3b\u52a8\u8981\u6c42\u5173\u95edtcp\u8fde\u63a5\uff1b</p> <p><code>FIN_WAIT2 504</code> # \u8868\u793a\u5ba2\u6237\u7aef\u4e2d\u65ad\u8fde\u63a5\uff1b</p> <p><code>TIME_WAIT 1057</code> # \u8868\u793a\u5904\u7406\u5b8c\u6bd5\uff0c\u7b49\u5f85\u8d85\u65f6\u7ed3\u675f\u7684\u8bf7\u6c42\u6570\uff1b</p>"},{"location":"chap8/20shell_dir/","title":"Shell\u811a\u672c\u6267\u884c\u4e0d\u518d\u53d7\u9650\uff0c\u4e0d\u8fdb\u5165\u6240\u5728\u76ee\u5f55\u4e5f\u80fd\u6210\u529f\u8fd0\u884c","text":"<p>\u901a\u8fc7\u4f7f\u7528dirname\u547d\u4ee4\u83b7\u53d6\u811a\u672c\u6267\u884c\u65f6\u7684\u6587\u4ef6\u8def\u5f84\uff0c\u5e76\u5728\u811a\u672c\u4e2d\u8fdb\u5165\u8be5\u76ee\u5f55\uff0c\u4f60\u53ef\u4ee5\u786e\u4fdd\u65e0\u8bba\u811a\u672c\u5728\u54ea\u91cc\u6267\u884c\uff0c\u90fd\u80fd\u591f\u627e\u5230\u6240\u9700\u7684\u6587\u4ef6\u3002</p> <p>\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5e94\u7528\u4e8e\u8c03\u7528\u540c\u76ee\u5f55\u4e0b\u7684\u5176\u4ed6Shell\u811a\u672c\u6216\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u8bbf\u95ee\u5176\u4ed6\u6587\u4ef6\u7684\u60c5\u51b5</p> <p>\u4e0b\u9762\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\u6765\u6f14\u793a\u8fd9\u79cd\u65b9\u6cd5\u3002\u5047\u8bbe\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\uff0c\u6709\u4e00\u4e2a\u4f4d\u4e8ebin\u76ee\u5f55\u7684\u540d\u4e3a<code>start.sh</code>\u7684\u811a\u672c\uff0c\u5b83\u9700\u8981\u8c03\u7528\u540c\u6837\u4f4d\u4e8ebin\u76ee\u5f55\u7684\u540d\u4e3aother.sh\u7684\u811a\u672c\u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801</p> <pre><code># \u8fdb\u5165\u811a\u672c\u6240\u5728\u7684\u76ee\u5f55\ncd $(dirname $0)\n# \u8c03\u7528\u5176\u5b83\u811a\u672c\n./other.sh\n</code></pre> <p>\u4e0a\u8ff0\u4ee3\u7801\u7247\u6bb5\u4e2d\uff0c<code>$0</code>\u8868\u793a\u5f53\u524d\u811a\u672c\u88ab\u6267\u884c\u65f6\u7684\u540d\u79f0\uff0c<code>dirname</code>\u547d\u4ee4\u4ece\u8be5\u540d\u79f0\u4e2d\u83b7\u53d6\u811a\u672c\u6240\u5728\u76ee\u5f55\uff0c<code>$()</code>\u8868\u793a\u6267\u884c\u62ec\u53f7\u5185\u7684\u547d\u4ee4\u5e76\u4e14\u83b7\u5f97\u547d\u4ee4\u7684\u8fd4\u56de\u7ed3\u679c\u3002<code>$(dirname $0)</code>\u5c06\u5f97\u5230\u8be5\u811a\u672c\u76f8\u5bf9\u4e8e\u5f53\u524d\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84\u3002</p> <p>\u56e0\u6b64\uff0c\u65e0\u8bba\u662f\u5728\u5f53\u524d\u76ee\u5f55\u6267\u884c\u201c<code>bin/start.sh</code>\u201d\uff0c\u8fd8\u662f\u8fdb\u5165<code>bin</code>\u76ee\u5f55\u540e\u6267\u884c\u201c<code>./start.sh</code>\u201d\uff0c\u811a\u672c\u90fd\u80fd\u6b63\u5e38\u8c03\u7528\u5230<code>other.sh</code>\u3002</p> <p>\u8fd8\u53ef\u4ee5\u8fdb\u4e00\u6b65\u4f18\u5316\u8be5\u65b9\u6848\u3002\u5982\u679c\u5728\u5176\u5b83\u8def\u5f84\u521b\u5efa\u4e86<code>start.sh</code>\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u6b64\u65f6\u5c31\u9700\u8981\u83b7\u53d6\u8be5\u7b26\u53f7\u94fe\u63a5\u7684\u76ee\u6807\u6587\u4ef6\u5730\u5740\u3002\u53ef\u4ee5\u4f7f\u7528readlink\u547d\u4ee4\u6765\u5b9e\u73b0\u3002\u4ee5\u4e0b\u662f\u4f18\u5316\u540e\u7684\u4ee3\u7801</p> <pre><code># \u5224\u65ad\u662f\u5426\u4e3a\u7b26\u53f7\u94fe\u63a5\nftype=$(ls -l $0|cut -c 1)\nif [[ $ftype == l ]];then\n  # \u5982\u679c\u662f\u7b26\u53f7\u94fe\u63a5\uff0c\u83b7\u53d6\u5176\u76ee\u6807\u6587\u4ef6\u5730\u5740\n  path=$(readlink $0)\nelse\n  # \u5426\u5219\u76f4\u63a5\u4f7f\u7528\u5f53\u524d\u6587\u4ef6\u8def\u5f84\n  path=$0\nfi\n# \u8fdb\u5165\u811a\u672c\u6240\u5728\u7684\u76ee\u5f55\ncd $(dirname $path)\n</code></pre> <p>\u4e0d\u8fc7\u8fd8\u6709\u4e00\u70b9\u9700\u8981\u6ce8\u610f\uff0creadlink\u53ea\u662f\u83b7\u53d6\u5b83\u63a5\u53d7\u7684\u53c2\u6570\u6307\u5b9a\u7684\u7b26\u53f7\u94fe\u63a5\u7684\u76ee\u6807\u6587\u4ef6\uff0c\u5982\u679c\u8be5\u76ee\u6807\u6587\u4ef6\u4ecd\u7136\u662f\u4e00\u4e2a\u7b26\u53f7\u94fe\u63a5\uff0c\u5219\u9700\u8981\u7ee7\u7eed\u4f7f\u7528readlink\u83b7\u53d6\u76ee\u6807\u6587\u4ef6\u3002</p> <p>\u53ef\u4ee5\u5c06\u8fd9\u90e8\u5206\u5c01\u88c5\u6210\u4e00\u4e2a\u51fd\u6570\u5e76\u9012\u5f52\u8c03\u7528\uff0c\u4ee5\u4e0b\u662f\u8be5\u51fd\u6570\u793a\u4f8b\uff1a</p> <pre><code># \u9012\u5f52\u8c03\u7528readlink\u83b7\u53d6\u7b26\u53f7\u94fe\u63a5\u7684\u6700\u7ec8\u76ee\u6807\u6587\u4ef6\nrrl() {\n  ftype=$(ls -l $1|cut -c 1)\n  if [[ $ftype == l ]];then\n    # \u5982\u679c\u662f\u7b26\u53f7\u94fe\u63a5\uff0c\u9012\u5f52\u83b7\u53d6\u5176\u76ee\u6807\u6587\u4ef6\u5730\u5740\n    echo $(rrl $(readlink $1))\n  else\n    # \u5426\u5219\u76f4\u63a5\u4f7f\u7528\u5f53\u524d\u6587\u4ef6\u8def\u5f84\n    echo $1\n  fi\n}\n# \u8fdb\u5165\u811a\u672c\u6240\u5728\u7684\u76ee\u5f55\ncd $(dirname $(rrl $0))\n</code></pre> <p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u53ef\u4ee5\u786e\u4fdd\u65e0\u8bba\u662f\u5728\u5f53\u524d\u76ee\u5f55\u6267\u884c\u8fd8\u662f\u901a\u8fc7\u7b26\u53f7\u94fe\u63a5\u6267\u884c\uff0c\u811a\u672c\u90fd\u80fd\u6b63\u5e38\u8fd0\u884c\u5e76\u6210\u529f\u8c03\u7528\u6216\u8bbf\u95ee\u9884\u671f\u7684\u6587\u4ef6</p>"},{"location":"chap8/21shell_eva/","title":"Bash\u811a\u672c\u591a\u51fd\u6570\u4f7f\u7528eval\u63d0\u9ad8\u811a\u672c\u7f16\u5199\u6548\u7387\uff01","text":"<p>\u6267\u884c\u5982\u4e0b\uff1a</p> <p></p> <p>\u8fd9\u6837\u5728\u51fd\u6570\u591a\u7684\u60c5\u51b5\u4e0b\u9700\u8981\u5199\u5f88\u591a\u5224\u65ad\uff0c\u6548\u7387\u4f4e\u4e0b\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>eval</code>\u547d\u4ee4\u6765\u8fdb\u884c\u6267\u884c\uff0c\u5982\uff1a</p> <p></p> <p>\u6267\u884c\u6548\u679c\u4e0e\u4e0a\u9762\u4e00\u81f4\uff1a</p> <p></p> <p>\u4f46\u662f\u8fd9\u6837\u4f1a\u5e26\u6765\u4e00\u4e2a\u5b89\u5168\u7684\u95ee\u9898\uff0c\u5982\u679c\u7528\u6237\u8f93\u5165\u7684\u662f\u4e00\u6761\u547d\u4ee4\u7684\u8bdd...</p> <p></p> <p>\u6211\u60f3\u5230\u4e86\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u90a3\u5c31\u662f\u52a0\u4e2a\u81ea\u5b9a\u524d\u7f00\uff0c\u6bd4\u5982\u6211\u6bcf\u4e2a\u65b9\u6cd5\u90fd\u52a0\u4e0a\u4e86</p> <p><code>function_</code>\u5b57\u6bb5\uff0c\u5728\u6267\u884c\u7684\u65f6\u5019\u76f4\u63a5\u8f93\u5165<code>function_</code>\u540e\u9762\u4e00\u4e32\u5b57\u7b26\u5373\u53ef\uff08\u4f46\u662f\u8fd9\u4e2a\u8981\u548c\u522b\u4eba\u534f\u5546\u597d\uff0c\u5199\u597dreadme\uff09\u3002</p> <p></p> <p>\u4fee\u6539\u540e\u6267\u884c\u6548\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u8f93\u5165\u5176\u5b83\u5982\u547d\u4ee4\u7b49\u53c2\u6570\uff1a</p> <p></p>"},{"location":"chap8/22find/","title":"\u4f7f\u7528find\u547d\u4ee4\u8f7b\u677e\u67e5\u627e\u6587\u4ef6","text":""},{"location":"chap8/22find/#1","title":"1\u3001\u57fa\u672c\u7528\u6cd5","text":"<p>find\u547d\u4ee4\u7684\u57fa\u672c\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>find [-H] [-L] [-P] [\u8def\u5f84] [\u8868\u8fbe\u5f0f]\n</code></pre> <p>\u5176\u4e2d\uff0c[\u8def\u5f84]\u662f\u5e0c\u671b\u5f00\u59cb\u641c\u7d22\u7684\u76ee\u5f55\u8def\u5f84\uff0c\u5982\u672a\u6307\u5b9a\uff0c\u5219\u4ece\u5f53\u524d\u76ee\u5f55\u5f00\u59cb\u641c\u7d22\uff0c[\u8868\u8fbe\u5f0f]\u5219\u662f\u641c\u7d22\u6761\u4ef6\u3002</p> <p>\u53e6\u6709\u4ee5\u4e0b\u4e0d\u5e38\u7528\u7684\u9009\u9879\uff1a</p> <ul> <li><code>-P</code>\uff1a\u4e0d\u8ddf\u968f\u7b26\u53f7\u94fe\u63a5\uff0c\u8fd9\u662f\u9ed8\u8ba4\u884c\u4e3a\u3002</li> <li><code>-L</code>\uff1a\u8ddf\u968f\u7b26\u53f7\u94fe\u63a5\u3002</li> <li><code>-H</code>\uff1a\u9664\u4e86\u5904\u7406\u547d\u4ee4\u884c\u53c2\u6570\u5916\uff0c\u4e0d\u8ddf\u968f\u7b26\u53f7\u94fe\u63a5\u3002\u5982\uff1a<code>-newer</code>\u9009\u9879\u7684\u53c2\u6570\u662f\u4e00\u4e2a\u7b26\u53f7\u94fe\u63a5\uff0c\u6b64\u65f6\u4f1a\u8ddf\u968f\u7b26\u53f7\u94fe\u63a5\u3002</li> </ul> <p>\u5f53find\u68c0\u67e5\u6216\u6253\u5370\u6587\u4ef6\u4fe1\u606f\u65f6\uff0c\u6240\u4f7f\u7528\u7684\u4fe1\u606f\u5e94\u6765\u81ea\u7b26\u53f7\u94fe\u63a5\u672c\u8eab\u7684\u5c5e\u6027\u3002\u8fd9\u79cd\u884c\u4e3a\u7684\u552f\u4e00\u4f8b\u5916\u662f\u5f53\u547d\u4ee4\u884c\u4e0a\u6307\u5b9a\u7684\u6587\u4ef6\u662f\u7b26\u53f7\u94fe\u63a5\uff0c\u5e76\u4e14\u53ef\u4ee5\u89e3\u6790\u94fe\u63a5\u65f6\u3002</p> <p>\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u6240\u4f7f\u7528\u7684\u4fe1\u606f\u6765\u81ea\u94fe\u63a5\u6307\u5411\u7684\u4efb\u4f55\u5185\u5bb9\uff08\u5373\uff0c\u94fe\u63a5\u88ab\u8ddf\u968f\uff09\u3002\u5982\u679c\u7b26\u53f7\u94fe\u63a5\u6307\u5411\u7684\u6587\u4ef6\u65e0\u6cd5\u68c0\u67e5\uff0c\u5219\u4f7f\u7528\u94fe\u63a5\u672c\u8eab\u7684\u4fe1\u606f\u4f5c\u4e3a\u540e\u5907\u3002\u5982\u679c<code>-H</code>\u6709\u6548\uff0c\u5e76\u4e14\u547d\u4ee4\u884c\u4e0a\u6307\u5b9a\u7684\u8def\u5f84\u4e4b\u4e00\u662f\u76ee\u5f55\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u5219\u5c06\u68c0\u67e5\u8be5\u76ee\u5f55\u7684\u5185\u5bb9\uff08\u5f53\u7136\uff0c<code>-maxdepth 0</code> \u5c06\u963b\u6b62\u8fd9\u79cd\u60c5\u51b5\uff09\u3002</p>"},{"location":"chap8/22find/#2","title":"2\u3001\u641c\u7d22\u6761\u4ef6","text":"<p>\u6709\u4e9b\u641c\u7d22\u9009\u9879\u540e\u9762\u53ef\u4ee5\u6307\u5b9a\u6570\u5b57\u53c2\u6570\uff0c\u683c\u5f0f\u4e3a\uff1a<code>[+|-]</code>n\u3002</p> <p>+n\u8868\u793a\u5927\u4e8en\uff0c-n\u8868\u793a\u5c0f\u4e8en\uff0c\u65e0\u7b26\u53f7\u8868\u793a\u7b49\u4e8en</p>"},{"location":"chap8/22find/#1_1","title":"1. \u6309\u6587\u4ef6\u540d\u79f0\u67e5\u627e","text":"<p>\u5982\u679c\u77e5\u9053\u8981\u67e5\u627e\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u8be5\u540d\u79f0\u8fdb\u884c\u641c\u7d22\u3002\u4f8b\u5982\uff0c\u8981\u67e5\u627e\u540d\u4e3anginx\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>find /path/to/search -name nginx\n</code></pre> <p>\u4e3a\u4e86\u63d0\u9ad8\u67e5\u627e\u6548\u7387\uff0c\u5e94\u5c3d\u91cf\u7f29\u5c0f\u641c\u7d22\u8303\u56f4\uff0c\u5e76\u6307\u5b9a\u5c3d\u53ef\u80fd\u660e\u786e\u7684\u8def\u5f84\u3002</p>"},{"location":"chap8/22find/#2_1","title":"2. \u6309\u6587\u4ef6\u7c7b\u578b\u67e5\u627e","text":"<p>\u4e0a\u8ff0\u67e5\u627e\u4e5f\u4f1a\u627e\u5230\u540d\u79f0\u4e3anginx\u7684\u76ee\u5f55\uff0c\u53ef\u4ee5\u4f7f\u7528-type\u9009\u9879\u53ea\u67e5\u627e\u6587\u4ef6\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4</p> <pre><code>find /path/to/search -type f -name nginx\n</code></pre> <p><code>-type</code>\u9009\u9879\u6709\u4ee5\u4e0b\u6587\u4ef6\u7c7b\u578b\u53c2\u6570\u503c\uff1a</p> <ul> <li>b\uff1a\u5757\u8bbe\u5907\u7279\u6b8a\u6587\u4ef6</li> <li>c\uff1a\u5b57\u7b26\u8bbe\u5907\u7279\u6b8a\u6587\u4ef6</li> <li>d\uff1a\u76ee\u5f55</li> <li>p\uff1a\u547d\u540d\u7ba1\u9053\uff08FIFO\uff09</li> <li>f\uff1a\u666e\u901a\u6587\u4ef6</li> <li>l\uff1a\u7b26\u53f7\u94fe\u63a5\uff08\u5b57\u6bcdL\u7684\u5c0f\u5199\uff09</li> </ul> <p>\u5982\u679c-L\u9009\u9879\u6709\u6548\uff0c\u9664\u975e\u7b26\u53f7\u94fe\u63a5\u65ad\u5f00\uff0c\u5426\u5219\u8fd9\u79cd\u60c5\u51b5\u6c38\u8fdc\u4e0d\u4f1a\u53d1\u751f\u3002</p> <p>\u5982\u679c\u8981\u641c\u7d22\u5bf9\u4e8e<code>-L</code>\u6709\u6548\u65f6\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u8bf7\u4f7f\u7528<code>-xtype</code>\u3002</p> <ul> <li>s\uff1a\u5957\u63a5\u5b57</li> </ul>"},{"location":"chap8/22find/#3","title":"3. \u6309\u6587\u4ef6\u65e5\u671f\u67e5\u627e","text":"<p>\u4f7f\u7528<code>-mtime</code>\u9009\u9879\uff0c\u53ef\u4ee5\u67e5\u627e\u5728\u7279\u5b9a\u5929\u6570\u4e4b\u524d\u4fee\u6539\u8fc7\u7684\u6587\u4ef6\u3002\u4f8b\u5982\uff0c\u8981\u67e5\u627e\u521a\u597d\u572830\u5929\u524d\u4fee\u6539\u8fc7\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>find /path/to/search -mtime 30\n</code></pre> <p>\u6ce8\u610f\uff0c-mtime\u540e\u9762\u7684\u53c2\u6570\uff0c30\u8868\u793a\u521a\u597d\u572830\u5929\u524d\uff0c+30\u8868\u793a\u8d85\u8fc730\u5929\uff0c-30\u8868\u793a30\u5929\u4e4b\u5185\u3002</p> <p>\u5f53find\u8ba1\u7b97\u51fa\u6587\u4ef6\u6700\u540e\u4e00\u6b21\u88ab\u4fee\u6539\u7684n\u5929\u524d\u7684\u65f6\u95f4\u6bb5\u65f6\uff0c\u4efb\u4f55\u5c0f\u6570\u90e8\u5206\u90fd\u4f1a\u88ab\u5ffd\u7565\uff0c\u56e0\u6b64\u4e3a\u4e86\u5339\u914d<code>-mtime +1</code>\uff0c\u6587\u4ef6\u5fc5\u987b\u81f3\u5c11\u5728\u4e24\u5929\u524d\u88ab\u4fee\u6539\u8fc7\u3002</p> <p>\u5176\u5b83\u6309\u65f6\u95f4\u67e5\u627e\u7684\u9009\u9879\uff1a</p> <ul> <li><code>-atime</code>\uff1a\u67e5\u627e\u5728\u7279\u5b9a\u5929\u6570\u4e4b\u524d\u8bbf\u95ee\u8fc7\u7684\u6587\u4ef6\u3002</li> <li><code>-ctime</code>\uff1a\u67e5\u627e\u5728\u7279\u5b9a\u5929\u6570\u4e4b\u524d\u66f4\u6539\u8fc7\u72b6\u6001\uff08\u5982\uff1a\u4fee\u6539\u6743\u9650\uff09\u7684\u6587\u4ef6\u3002</li> <li><code>-amin</code>\u3001-cmin\u3001-mmin\uff1a\u4e0e-atime\u3001-ctime\u3001-mtime\u9009\u9879\u7c7b\u4f3c\uff0c\u533a\u522b\u662f\u65f6\u95f4\u5355\u4f4d\u4e3a\u5206\u949f\u3002</li> <li><code>-newer reference_file</code>\uff1a\u67e5\u627e\u4fee\u6539\u65f6\u95f4\u6bd4\u53c2\u8003\u6587\u4ef6\u6700\u540e\u4fee\u6539\u65f6\u95f4\u665a\u7684\u6587\u4ef6\u3002\u5982\u679c\u53c2\u8003\u6587\u4ef6\u662f\u4e00\u4e2a\u7b26\u53f7\u94fe\u63a5\uff0c\u5e76\u4e14<code>-H</code>\u9009\u9879\u6216<code>-L</code>\u9009\u9879\u6709\u6548\uff0c\u5219\u59cb\u7ec8\u4f7f\u7528\u5b83\u6240\u6307\u5411\u7684\u6587\u4ef6\u7684\u6700\u540e\u4e00\u6b21\u6570\u636e\u4fee\u6539\u65f6\u95f4\u3002</li> </ul>"},{"location":"chap8/22find/#4","title":"4. \u6309\u6587\u4ef6\u5927\u5c0f\u67e5\u627e","text":"<p>\u4f7f\u7528-size\u9009\u9879\uff0c\u53ef\u4ee5\u67e5\u627e\u5927\u4e8e\u6216\u7b49\u4e8e\u7279\u5b9a\u5927\u5c0f\u7684\u6587\u4ef6\u3002\u4f8b\u5982\uff0c\u8981\u67e5\u627e\u5927\u4e8e10M\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>find /path/to/search -size +10M\n</code></pre> <p>+\u8868\u793a\u5927\u4e8e\uff0c-\u8868\u793a\u5c0f\u4e8e\uff0c\u53c2\u6570\u503c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u540e\u7f00\u8868\u793a\u6587\u4ef6\u5927\u5c0f\u5355\u4f4d\uff1a</p> <ul> <li>b\uff1a\u8868\u793a512\u5b57\u8282\u5757\uff08\u5982\u679c\u4e0d\u4f7f\u7528\u540e\u7f00\uff0c\u5219\u4e3a\u9ed8\u8ba4\u503c\uff09</li> <li>c\uff1a\u8868\u793a\u5b57\u8282</li> <li>w\uff1a\u8868\u793a\u4e24\u4e2a\u5b57\u8282\u7684\u5355\u8bcd</li> <li>k\uff1a\u8868\u793a\u5343\u5b57\u8282</li> <li>M\uff1a\u8868\u793a\u5146\u5b57\u8282</li> <li>G\uff1a\u8868\u793a\u5409\u5b57\u8282</li> </ul>"},{"location":"chap8/22find/#5","title":"5. \u6309\u5176\u5b83\u6761\u4ef6\u67e5\u627e","text":"<pre><code>man find\n</code></pre>"},{"location":"chap8/22find/#_1","title":"\u4e09\u3001\u65e5\u5e38\u5e94\u7528\u573a\u666f","text":""},{"location":"chap8/22find/#1_2","title":"1. \u67e5\u627e\u5e76\u6e05\u7406\u8fc7\u65f6\u6587\u4ef6","text":"<p>\u5728\u8bb8\u591a\u7cfb\u7edf\u4e2d\uff0c\u4e34\u65f6\u6587\u4ef6\u901a\u5e38\u4fdd\u5b58\u5728<code>/tmp</code>\u76ee\u5f55\u4e0b\uff0c\u6211\u4eec\u81ea\u5df1\u4e5f\u53ef\u4ee5\u6709\u4e13\u7528\u4e8e\u4e34\u65f6\u5de5\u4f5c\u7684\u76ee\u5f55<code>~/tmp</code>\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528find\u547d\u4ee4\u6765\u67e5\u627e\u8fd9\u4e9b\u4e34\u65f6\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528<code>-delete</code>\u9009\u9879\u6765\u5220\u9664\u5b83\u4eec\u3002\u4f8b\u5982\uff0c\u8981\u67e5\u627e30\u5929\u4e4b\u524d\u7684\u4e34\u65f6\u6587\u4ef6\u5e76\u5220\u9664\u5b83\u4eec\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4</p> <pre><code>find ~/tmp -type f -mtime +30 -delete\n</code></pre> <p>\u53ef\u4ee5\u6839\u636e\u5927\u6982\u65e5\u671f\u67e5\u627e\u6587\u4ef6\u3002\u4f8b\u5982\uff0c\u8981\u67e5\u627e\u8fc7\u53bb20~30\u5929\u8bbf\u95ee\u8fc7\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>find ~/tmp -type f -mtime +20 -mtime -30\n</code></pre>"},{"location":"chap8/22find/#2_2","title":"2. \u67e5\u627e\u5927\u6587\u4ef6\u5e76\u6e05\u7406","text":"<p>\u6709\u65f6\u5019\uff0c\u7cfb\u7edf\u4e2d\u53ef\u80fd\u4f1a\u6709\u4e00\u4e9b\u5927\u800c\u65e0\u7528\u7684\u6587\u4ef6\u3002\u53ef\u4ee5\u4f7f\u7528find\u547d\u4ee4\u6765\u67e5\u627e\u8fd9\u4e9b\u5927\u6587\u4ef6\uff0c\u5e76\u5220\u9664\u5b83\u4eec\u4ee5\u91ca\u653e\u7a7a\u95f4\u3002\u4f8b\u5982\uff0c\u8981\u67e5\u627e\u4e0b\u8f7d\u76ee\u5f55\u4e2d\u5927\u4e8e500MB\u7684\u6587\u4ef6\u5e76\u5220\u9664\u5b83\u4eec\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>find ~/Downloads -size +500M -delete\n</code></pre>"},{"location":"chap8/23shell_logical/","title":"22 \u4f7f\u7528Shell\u903b\u8f91\u8868\u8fbe\u5f0f\uff0c\u6ee1\u8db3\u5404\u79cd\u6761\u4ef6\u68c0\u6d4b","text":"<p>\u5728Shell\u811a\u672c\u4e2d\uff0c\u903b\u8f91\u8fd0\u7b97\u7b26\u7528\u4e8e\u63a7\u5236\u7a0b\u5e8f\u7684\u6d41\u7a0b\u548c\u6761\u4ef6\u5224\u65ad\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528test\u547d\u4ee4\u6d4b\u8bd5\u903b\u8f91\u8868\u8fbe\u5f0f\u3002\u4f8b\u5982\uff1a</p> <pre><code>if test logical_expression; then\n  echo true\nelse\n  echo false\nfi\n</code></pre> <p>\u4e3a\u65b9\u4fbf\u5728\u547d\u4ee4\u884c\u8fdb\u884c\u6d4b\u8bd5\uff0c\u4e0a\u8ff0\u8bed\u53e5\u53ef\u4ee5\u5408\u5e76\u4e3a\u4e00\u884c\uff0c\u8bed\u53e5\u540e\u9762\u6dfb\u52a0\u534a\u89d2\u5206\u53f7\u5373\u53ef\uff1a</p> <pre><code>if test logical_expression; then echo true; else echo false; fi\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u4e0d\u4f7f\u7528test\u547d\u4ee4\uff0c\u5c06\u903b\u8f91\u8868\u8fbe\u5f0f\u653e\u5728\u4e2d\u62ec\u53f7[]\u4e2d\uff0c\u8fbe\u5230\u6d4b\u8bd5\u903b\u8f91\u8868\u8fbe\u5f0f\u7684\u6548\u679c\u3002\u4f8b\u5982\uff1a</p> <pre><code>if [ logical_expression ]; then echo true; else echo false; fi\n</code></pre> <p>\u6ce8\u610f\uff1a\u903b\u8f91\u8868\u8fbe\u5f0f\u4e0e[]\u4e4b\u95f4\u8981\u6709\u7a7a\u683c\u3002</p> <p>\u4ee5\u4e0b\u662fShell\u4e2d\u5e38\u7528\u7684\u903b\u8f91\u8fd0\u7b97\u7b26\u53ca\u5176\u8bf4\u660e\uff1a</p> <ul> <li>\u6587\u4ef6\u548c\u76ee\u5f55\u68c0\u6d4b</li> </ul> <p>-f\uff1a\u68c0\u6d4b\u6587\u4ef6\u662f\u5426\u5b58\u5728\u3002</p> <p>-d\uff1a\u68c0\u6d4b\u76ee\u5f55\u662f\u5426\u5b58\u5728\u3002</p> <p>-b\uff1a\u68c0\u6d4b\u662f\u5426\u4e3a\u5757\u8bbe\u5907\u6587\u4ef6\u3002</p> <p>-c\uff1a\u68c0\u6d4b\u662f\u5426\u4e3a\u5b57\u7b26\u8bbe\u5907\u6587\u4ef6\u3002</p> <p>-S\uff1a\u68c0\u6d4b\u662f\u5426\u4e3a\u5957\u63a5\u5b57\u6587\u4ef6\u3002</p> <p>-L\uff1a\u68c0\u6d4b\u662f\u5426\u4e3a\u7b26\u53f7\u94fe\u63a5\u6587\u4ef6\u3002</p> <p>-e\uff1a\u68c0\u6d4b\u67d0\u4e2a\u4e1c\u897f\uff08\u6587\u4ef6\u3001\u76ee\u5f55\u7b49\uff09\u662f\u5426\u5b58\u5728\u3002</p> <ul> <li>\u7a0b\u5e8f\u6240\u6709\u6743\u68c0\u6d4b</li> </ul> <p>-G\uff1a\u68c0\u6d4b\u662f\u5426\u7531GID\uff08\u7ec4ID\uff09\u6240\u6267\u884c\u7684\u7a0b\u5e8f\u6240\u62e5\u6709\u3002</p> <p>-O\uff1a\u68c0\u6d4b\u662f\u5426\u7531UID\uff08\u7528\u6237ID\uff09\u6240\u6267\u884c\u7684\u7a0b\u5e8f\u6240\u62e5\u6709\u3002</p> <p>-p\uff1a\u68c0\u6d4b\u662f\u5426\u4e3a\u7a0b\u5e8f\u95f4\u4f20\u9001\u4fe1\u606f\u7684\u547d\u540d\u7ba1\u9053\uff08FIFO\uff09\u6216\u547d\u540d\u7ba1\u9053\uff08FIFO\uff09\u3002</p> <ul> <li>\u6587\u4ef6\u5c5e\u6027\u68c0\u6d4b</li> </ul> <p>-r\uff1a\u68c0\u6d4b\u6587\u4ef6\u5b58\u5728\u4e14\u6388\u4e88\u8bfb\u53d6\u6743\u9650\u3002</p> <p>-w\uff1a\u68c0\u6d4b\u6587\u4ef6\u5b58\u5728\u4e14\u6388\u4e88\u5b9a\u7a3f\u6743\u9650\u3002</p> <p>-x\uff1a\u68c0\u6d4b\u6587\u4ef6\u5b58\u5728\u4e14\u6388\u4e88\u6267\u884c\u6743\u9650\u3002</p> <p>-s\uff1a\u68c0\u6d4b\u6587\u4ef6\u5b58\u5728\u4e14\u5927\u5c0f\u5927\u4e8e\u96f6\u3002</p> <p>-u\uff1a\u68c0\u6d4b\u6587\u4ef6\u5b58\u5728\u4e14\u5176SUID\u4f4d\u5df2\u8bbe\u7f6e\u3002</p> <p>SUID\u662fSet User ID\u7684\u7f29\u5199\uff0c\u5b83\u4f1a\u51fa\u73b0\u5728\u6587\u4ef6\u62e5\u6709\u8005\u6743\u9650\u7684\u6267\u884c\u4f4d\u4e0a\uff0c\u6709\u8bbe\u7f6e\u8be5\u4f4d\u7684\u6587\u4ef6\u4f1a\u5728\u5176\u6267\u884c\u65f6\uff0c\u4f7f\u8c03\u7528\u8005\u6682\u65f6\u83b7\u5f97\u8be5\u6587\u4ef6\u62e5\u6709\u8005\u7684\u6743\u9650\u3002</p> <p>-g\uff1a\u68c0\u6d4b\u6587\u4ef6\u5b58\u5728\u4e14\u5176SGID\u4f4d\u5df2\u8bbe\u7f6e\u3002</p> <p>SGID\u5373Set Group ID\u7684\u7f29\u5199\uff0c\u5b83\u51fa\u73b0\u5728\u6587\u4ef6\u6240\u5c5e\u7ec4\u6743\u9650\u7684\u6267\u884c\u4f4d\u4e0a\u9762\uff0c\u5b83\u5bf9\u666e\u901a\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u76ee\u5f55\u90fd\u6709\u6548\uff0c\u5f53\u5b83\u4f5c\u7528\u4e8e\u666e\u901a\u6587\u4ef6\u65f6\uff0c\u548cSUID\u7c7b\u4f3c\uff0c\u5728\u6267\u884c\u8be5\u6587\u4ef6\u65f6\uff0c\u7528\u6237\u5c06\u83b7\u5f97\u8be5\u6587\u4ef6\u6240\u5c5e\u7ec4\u7684\u6743\u9650\u3002</p> <p>-k\uff1a\u68c0\u6d4b\u6587\u4ef6\u5b58\u5728\u4e14\u5177\u6709\u7c98\u6ede\u4f4d\u5c5e\u6027\u3002</p> <p>\u7c98\u6ede\u4f4d\uff08Stickybit\uff09\uff0c\u6216\u7c98\u7740\u4f4d\uff0c\u662fUnix/Linux\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u7684\u4e00\u4e2a\u65d7\u6807\u3002\u6700\u5e38\u89c1\u7684\u7528\u6cd5\u5728\u76ee\u5f55\u4e0a\u8bbe\u7f6e\u7c98\u6ede\u4f4d\uff0c\u5982\u6b64\u4ee5\u6765\uff0c\u53ea\u6709\u76ee\u5f55\u5185\u6587\u4ef6\u7684\u6240\u6709\u8005\u6216\u8005root\u624d\u53ef\u4ee5\u5220\u9664\u6216\u79fb\u52a8\u8be5\u6587\u4ef6\u3002\u5982\u679c\u4e0d\u4e3a\u76ee\u5f55\u8bbe\u7f6e\u7c98\u6ede\u4f4d\uff0c\u4efb\u4f55\u5177\u6709\u8be5\u76ee\u5f55\u5199\u548c\u6267\u884c\u6743\u9650\u7684\u7528\u6237\u90fd\u53ef\u4ee5\u5220\u9664\u548c\u79fb\u52a8\u5176\u4e2d\u7684\u6587\u4ef6\u3002\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u7c98\u6ede\u4f4d\u4e00\u822c\u7528\u4e8e/tmp\u76ee\u5f55\uff0c\u4ee5\u9632\u6b62\u666e\u901a\u7528\u6237\u5220\u9664\u6216\u79fb\u52a8\u5176\u4ed6\u7528\u6237\u7684\u6587\u4ef6\u3002</p> <ul> <li>\u6587\u4ef6\u6bd4\u8f83</li> </ul> <p>-nt\uff1a\u7b2c\u4e00\u4e2a\u6587\u4ef6\u6bd4\u7b2c\u4e8c\u4e2a\u6587\u4ef6\u65b0\u3002</p> <p>-ot\uff1a\u7b2c\u4e00\u4e2a\u6587\u4ef6\u6bd4\u7b2c\u4e8c\u4e2a\u6587\u4ef6\u65e7\u3002</p> <p>-ef\uff1a\u7b2c\u4e00\u4e2a\u6587\u4ef6\u4e0e\u7b2c\u4e8c\u4e2a\u6587\u4ef6\u4e3a\u540c\u4e00\u4e2a\u6587\u4ef6\uff08\u4f8b\u5982\uff0c\u786c\u94fe\u63a5\uff09\u3002</p> <ul> <li>\u903b\u8f91\u8fd0\u7b97\u7b26</li> </ul> <p>-a\uff1a\u903b\u8f91\u4e0e\u3002</p> <p>-o\uff1a\u903b\u8f91\u6216\u3002</p> <p>!\uff1a\u903b\u8f91\u975e\u3002</p> <p>\u5728Bash\u4e2d\uff0c\u53ef\u4ee5\u5728\u53cc\u4e2d\u62ec\u53f7<code>[[]]</code>\u4e2d\u4f7f\u7528<code>&amp;&amp;</code>\u8868\u793a\u903b\u8f91\u4e0e\uff0c<code>||</code>\u8868\u793a\u903b\u8f91\u6216\u3002</p> <ul> <li>\u6570\u503c\u6bd4\u8f83</li> </ul> <p>-eq\uff1a\u7b49\u4e8e\u3002</p> <p>-ne\uff1a\u4e0d\u7b49\u4e8e\u3002</p> <p>-lt\uff1a\u5c0f\u4e8e\u3002</p> <p>-le\uff1a\u5c0f\u4e8e\u7b49\u4e8e\u3002</p> <p>-gt\uff1a\u5927\u4e8e\u3002</p> <p>-ge\uff1a\u5927\u4e8e\u7b49\u4e8e\u3002</p> <ul> <li>\u5b57\u7b26\u4e32\u5224\u65ad</li> </ul> <p>=\uff1a\u7b49\u4e8e\u3002</p> <p>!=\uff1a\u4e0d\u7b49\u4e8e\u3002</p> <p>-z\uff1a\u7a7a\u5b57\u7b26\u4e32\u3002</p> <p>-n\uff1a\u975e\u7a7a\u5b57\u7b26\u4e32\u3002 </p>"},{"location":"chap8/24xargs/","title":"xargs\u547d\u4ee4\u7684\u4f7f\u7528\u6280\u5de7","text":"<p>\u901a\u8fc7\u4f7f\u7528xargs\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u9ad8\u6548\u5730\u5728\u547d\u4ee4\u884c\u4e2d\u5904\u7406\u6587\u4ef6\u548c\u6570\u636e\u3002\u672c\u6587\u5c06\u8be6\u7ec6\u4ecb\u7ecdxargs\u547d\u4ee4\u7684\u7528\u6cd5\uff0c\u5e76\u901a\u8fc7\u5b9e\u4f8b\u8bf4\u660e\u5176\u5e94\u7528\u573a\u666f</p>"},{"location":"chap8/24xargs/#xargs_1","title":"\u4e00\u3001xargs\u547d\u4ee4\u7b80\u4ecb","text":"<p>xargs\u547d\u4ee4\u7684\u4f5c\u7528\u662f\u4ece\u6807\u51c6\u8f93\u5165\u6784\u5efa\u548c\u6267\u884c\u547d\u4ee4\u884c\uff0c\u5b83\u53ef\u4ee5\u4ece\u6807\u51c6\u8f93\u5165\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u547d\u4ee4\u884c\u53c2\u6570\u4f20\u9012\u7ed9\u5176\u4ed6\u547d\u4ee4\u3002\u5b83\u53ef\u4ee5\u5904\u7406\u6587\u4ef6\u3001\u5b57\u7b26\u4e32\u5217\u8868\u6216\u5176\u4ed6\u6570\u636e\u6e90\uff0c\u5e76\u5c06\u5176\u8f6c\u6362\u4e3a\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ece\u800c\u5b9e\u73b0\u66f4\u7075\u6d3b\u548c\u9ad8\u6548\u7684\u5de5\u4f5c\u6d41\u3002</p>"},{"location":"chap8/24xargs/#xargs_2","title":"\u4e8c\u3001xargs\u547d\u4ee4\u7684\u57fa\u672c\u7528\u6cd5","text":"<p>xargs\u547d\u4ee4\u7684\u57fa\u672c\u7528\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>xargs [options] [command [initial-arguments]]\n</code></pre> <p>\u5176\u4e2d\uff0c</p> <ul> <li>[options]\u662f\u53ef\u9009\u7684xargs\u9009\u9879\uff0c</li> <li>[command]\u662f\u53ef\u9009\u7684\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c</li> <li>[initial-arguments]\u662f\u53ef\u9009\u7684\u547d\u4ee4\u521d\u59cb\u53c2\u6570\uff0c\u672a\u6307\u5b9a\u547d\u4ee4\u65f6\uff0c\u4f1a\u5c06\u53c2\u6570\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\u3002</li> <li>xargs\u4f1a\u5c06\u6807\u51c6\u8f93\u5165\u6570\u636e\u8f6c\u6362\u4e3a\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u5e76\u4f20\u9012\u7ed9[command]\u6267\u884c\u3002[command]\u6536\u5230\u7684\u53c2\u6570\uff0c\u5c06\u662f[initial-arguments]\u548cxargs\u4f20\u9012\u7684\u53c2\u6570\u7684\u5e76\u96c6\u3002</li> </ul>"},{"location":"chap8/24xargs/#xargs_3","title":"\u4e09\u3001xargs\u547d\u4ee4\u7684\u5e38\u7528\u9009\u9879","text":"<ul> <li>-0\uff1a\u5904\u7406\u7a7a\u5b57\u7b26\u800c\u975e\u7a7a\u683c\u4f5c\u4e3a\u53c2\u6570\u5206\u9694\u7b26\u3002</li> <li>-a\uff1a\u4ece\u6587\u4ef6\u8bfb\u53d6\u53c2\u6570\uff0c\u800c\u975e\u6807\u51c6\u8f93\u5165\u3002</li> <li>-d\uff1a\u6307\u5b9a\u5206\u9694\u7b26\uff0c\u7f3a\u7701\u4e3a\u7a7a\u767d\u7b26\uff1a\u7a7a\u683c\u3001\u6362\u884c\u7b49\u3002</li> <li>-E\uff1a\u8bbe\u7f6e\u201c\u6587\u4ef6\u7ed3\u675f\u7b26\u201d\u3002\u5728\u5904\u7406\u6807\u51c6\u8f93\u5165\u65f6\uff0c\u5982\u679c\u9047\u5230\u201c\u6587\u4ef6\u7ed3\u675f\u7b26\u201d\uff0c\u5219\u5176\u540e\u7684\u6240\u6709\u8f93\u5165\u90fd\u5c06\u88ab\u5ffd\u7565\u3002</li> <li>-i\uff1a\u53c2\u6570\u66ff\u6362\uff0c\u7528\u4ece\u6807\u51c6\u8f93\u5165\u8bfb\u53d6\u7684\u53c2\u6570\u66ff\u6362initial-arguments\u4e2d\u7684\u5185\u5bb9{}\uff1b\u5982\u679c\u9700\u8981\u6307\u5b9a\u975e{}\uff0c\u5219\u4f7f\u7528-I\uff08i\u7684\u5927\u5199\uff09\u9009\u9879\u6307\u5b9a\u3002</li> <li>-n\uff1a\u6307\u5b9a\u6bcf\u4e2a\u547d\u4ee4\u884c\u53c2\u6570\u7684\u4e2a\u6570\u3002</li> <li>-P\uff1a\u6307\u5b9a\u5e76\u884c\u6267\u884c\u7684\u6700\u5927\u8fdb\u7a0b\u6570\u3002</li> <li>-p\uff1a\u6267\u884c\u547d\u4ee4\u524d\u63d0\u793a\u7528\u6237\u786e\u8ba4\u3002</li> <li>-r\uff1a\u5ffd\u7565\u65e0\u6cd5\u6267\u884c\u7684\u547d\u4ee4\u3002</li> <li>-s\uff1a\u9650\u5236\u547d\u4ee4\u53ca\u53c2\u6570\u603b\u5b57\u7b26\u6570\u3002</li> <li>-t\uff1a\u5728\u6267\u884c\u547d\u4ee4\u4e4b\u524d\u5148\u6253\u5370\u547d\u4ee4\u3002</li> <li>-x\uff1a\u7528\u4e8e\u786e\u4fddxargs\u5728\u547d\u4ee4\u884c\u957f\u5ea6\uff08-s\u9009\u9879\u6307\u5b9a\uff09\u8d85\u51fa\u9650\u5236\u65f6\u505c\u6b62\u6267\u884c\u3002</li> </ul>"},{"location":"chap8/24xargs/#xargs_4","title":"\u56db\u3001xargs\u547d\u4ee4\u793a\u4f8b","text":""},{"location":"chap8/24xargs/#1","title":"1. \u5206\u6bb5\u4f20\u9012\u53c2\u6570\u5217\u8868","text":"<p>xargs\u6700\u663e\u8457\u7684\u4f5c\u7528\u662f\u5c06\u53c2\u6570\u5217\u8868\u8f6c\u6362\u6210\u5c0f\u5757\u5206\u6bb5\u4f20\u9012\u7ed9\u540e\u7eed\u547d\u4ee4\uff0c\u4ee5\u907f\u514d\u53c2\u6570\u5217\u8868\u8fc7\u957f\u7684\u95ee\u9898\u3002\u5148\u770b\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\uff1a</p> <pre><code>~$ echo {1..10}|xargs\n1 2 3 4 5 6 7 8 9 10\n</code></pre> <p>\u4e0a\u4f8b\u4e2dxargs\u672a\u4f7f\u7528\u4efb\u4f55\u9009\u9879\u548c\u547d\u4ee4\uff0c\u5bf9\u4e8e\u5c11\u91cf\u53c2\u6570\uff0c\u53ef\u4e00\u6b21\u6027\u8f93\u51fa\u3002</p> <p>\u4f46\u5982\u679c\u53c2\u6570\u6570\u91cf\u8db3\u591f\u591a\uff0c\u53ef\u80fd\u8d85\u8fc7\u547d\u4ee4\u884c\u5141\u8bb8\u7684\u6700\u5927\u957f\u5ea6\uff0cxargs\u7684\u4f5c\u7528\u5c31\u663e\u793a\u51fa\u6765\u4e86\u3002\u5982\u4e0b\u547d\u4ee4\u4f7f\u7528<code>{1..50000}</code>\u751f\u6210\u4ece1\u523050000\u7684\u6570\u5b57\u5e8f\u5217\u6765\u6a21\u62df5\u4e07\u4e2a\u53c2\u6570\uff0c\u7ecfxargs\u5904\u7406\u540e\uff0c\u4f7f\u7528wc\u547d\u4ee4\u7edf\u8ba1\u53c2\u6570\u884c\u6570\uff0c\u4e4b\u540e\u4f7f\u7528cut\u547d\u4ee4\u622a\u53d6\u6bcf\u884c\u53c2\u6570\u67e5\u770b\u524d\u51e0\u4e2a\u53c2\u6570\u7684\u5185\u5bb9\uff1a</p> <pre><code>\n~$ echo {1..50000}|xargs|wc -l \n3\n\n\n~$ echo {1..50000}|xargs|cut -c 1-20\n1 2 3 4 5 6 7 8 9 10\n23696 23697 23698 23\n45540 45541 45542 45\n</code></pre> <p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u53c2\u6570\u5df2\u7ecf\u5206\u6210\u4e863\u5757\u8fdb\u884c\u4f20\u9012\uff0c\u56e0\u6b64\u7ed3\u679c\u67093\u884c\u3002</p> <p>\u4e86\u89e3xargs\u7684\u4f5c\u7528\u540e\uff0c\u5c31\u53ef\u4ee5\u5e94\u7528\u5230\u5b9e\u9645\u64cd\u4f5c\u4e2d\u3002</p> <p>\u4f8b\u5982\uff0c\u5220\u9664\u67d0\u4e2a\u76ee\u5f55\u4e0b\u6240\u6709\u540d\u79f0\u4ee5.tmp\u7ed3\u5c3e\u7684\u6587\u4ef6\uff0c\u5982\u679c\u6587\u4ef6\u6570\u91cf\u8fc7\u591a\uff0c\u4f7f\u7528rm *.tmp\u4f1a\u6536\u5230\u201cArguments list too long\u201d\u7684\u9519\u8bef\u63d0\u793a\u3002</p> <p>\u6b64\u65f6\u53ef\u4ee5\u4f7f\u7528find\u547d\u4ee4\u627e\u51fa\u9700\u8981\u5220\u9664\u7684\u6587\u4ef6\uff0c\u7136\u540e\u4f7f\u7528xargs\u5c06\u6587\u4ef6\u5217\u8868\u5206\u6bb5\u4f20\u9012\u7ed9rm\u547d\u4ee4\uff1a</p> <pre><code>find . -name *.tmp | xargs rm -rf\n</code></pre> <p>\u6b64\u79cd\u60c5\u51b5\u53ef\u4ee5\u7528\u4e00\u4e2a\u5b89\u5168\u7b80\u5355\u7684\u65b9\u6cd5\u8fdb\u884c\u6a21\u62df\uff1a</p> <p>\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55tmp\uff0c\u8be5\u76ee\u5f55\u4e0b\u4ec5\u4e00\u4e2a\u540d\u79f0\u4e3a1\u7684\u6587\u4ef6\u3002\u4f7f\u7528<code>{1..1000000}</code>\u4ea7\u751f\u5e8f\u5217\u6a21\u62df\u540d\u79f0\u4e3a\u4ece1\u52301000000\u7684\u6587\u4ef6\u540d\uff0c\u7136\u540e\u6267\u884c\u547d\u4ee4\u8fdb\u884c\u6a21\u62df\u5e76\u67e5\u770b\u7ed3\u679c\uff1a</p> <pre><code>\n~$ cd tmp\n\n~/tmp$ ls\n1\n~/tmp$ ls {1..2}\nls: cannot access '2': No such file or directory\n1\n\n~/tmp$ ls {1..1000000}\n-bash: /usr/bin/ls: Argument list too long\n\n~/tmp$ echo {1..2}|xargs ls\nls: cannot access '2': No such file or directory\n1\n~/tmp$ echo {1..1000000}|xargs ls 2&gt;/dev/null\n1\n</code></pre> <p>\u4e0a\u8ff0\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\uff0c\u4e3a\u907f\u514d\u51fa\u73b0\u5927\u91cf\u201cNo such file or directory\u201d\u63d0\u793a\uff0c\u4f7f\u7528\u201c2&gt;/dev/null\u201d\u5c06\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u5230\u7a7a\u8bbe\u5907/dev/null\u3002</p>"},{"location":"chap8/24xargs/#2","title":"2. \u9650\u5b9a\u53c2\u6570\u5217\u8868\u5927\u5c0f","text":"<p>xargs\u4f1a\u6839\u636e\u540e\u7eed\u547d\u4ee4\u6240\u9700\u7684\u53c2\u6570\uff0c\u6309\u9700\u5bf9\u53c2\u6570\u5217\u8868\u5206\u5757\uff0c\u4ee5\u5339\u914d\u547d\u4ee4\u6240\u9700\u7684\u53c2\u6570\u5217\u8868\u3002\u4f8b\u5982\u4ee5\u4e0b\u547d\u4ee4\uff0c\u4f7f\u7528printf\u6bcf\u884c\u8f93\u51fa2\u4e2a\u683c\u5f0f\u5316\u540e\u7684\u6570\u503c\uff0c\u6839\u636e\u683c\u5f0f\u5b57\u7b26\u4e32\u4e2d\u5360\u4f4d\u7b26\u7684\u6570\u91cf\uff0c\u6bcf\u4e2aprintf\u9700\u8981\u63a5\u65362\u4e2a\u6570\u5b57\u53c2\u6570\uff1a</p> <pre><code>\n~$ echo {1..3}|xargs printf \"%02d %02d\\n\"\n01 02\n03 00\n</code></pre> <p>\u867d\u7136\u53c2\u6570\u5217\u8868\u5339\u914d\u6b63\u786e\uff0c\u4f46\u5bf9\u4e8e\u6e90\u53c2\u6570\u4e2a\u6570\u4e0d\u662f2\uff08printf\u683c\u5f0f\u4e32\u4e2d\u5360\u4f4d\u7b26\u4e2a\u6570\uff09\u7684\u6574\u6570\u500d\u65f6\uff0c\u8f93\u51fa\u7ed3\u679c\u4e0d\u7b26\u5408\u9884\u671f\u3002</p> <p>\u6216\u8005\u5047\u8bbe\u6bcf\u884c\u9700\u8981\u8f93\u51fa\u66f4\u591a\u6570\u503c\u65f6\uff0c\u4e0d\u5e0c\u671b\u7f16\u5199\u5f88\u957f\u7684\u683c\u5f0f\u4e32\u3002\u53ef\u4ee5\u5148\u5bf9\u5355\u4e2a\u6570\u503c\u8fdb\u884c\u683c\u5f0f\u5316\uff0c\u6700\u540e\u4f7f\u7528-n\u9009\u9879\u9650\u5b9a\u6bcf\u884c\u8f93\u51fa\u7684\u6570\u503c\u4e2a\u6570\u3002\u4f8b\u5982\uff0c\u6bcf\u884c\u8f93\u51fa10\u4e2a\u6570\u503c\uff1a</p> <pre><code>\n~$ echo {1..21}|xargs printf \"%02d\\n\"|xargs -n 10\n01 02 03 04 05 06 07 08 09 10\n11 12 13 14 15 16 17 18 19 20\n21\n</code></pre>"},{"location":"chap8/24xargs/#3","title":"3. \u53c2\u6570\u66ff\u6362","text":"<p>\u524d\u9762\u7684\u793a\u4f8b\u4e2d\uff0cxargs\u540e\u9762\u7684\u547d\u4ee4\uff0c\u53c2\u6570\u4f4d\u7f6e\u90fd\u662f\u5728\u547d\u4ee4\u7684\u6700\u540e\u3002\u4f46\u5982\u679c\u53c2\u6570\u5728\u547d\u4ee4\u7684\u4e2d\u95f4\u67d0\u4e2a\u4f4d\u7f6e\uff0c\u6216\u8005\u9700\u8981\u7528\u53c2\u6570\u503c\u66ff\u6362\u547d\u4ee4\u4e2d\u7684\u6307\u5b9a\u5185\u5bb9\u65f6\uff0c\u5c31\u9700\u8981\u4f7f\u7528\u53c2\u6570\u66ff\u6362\u3002</p> <p>\u4f8b\u5982\uff0c\u5c06\u67d0\u4e2a\u76ee\u5f55\u4e2d30\u5929\u4ee5\u524d\u7684\u6587\u4ef6\u79fb\u52a8\u5230\u5907\u4efd\u76ee\u5f55\u3002mv\u6307\u4ee4\uff08\u79fb\u52a8\u6216\u91cd\u547d\u540d\u6587\u4ef6\uff09\u7684\u7b80\u5355\u8bed\u6cd5\u4e3a\uff1a</p> <pre><code>mv SOURCE DEST\n</code></pre> <p>\u88ab\u79fb\u52a8\u7684\u6587\u4ef6\u540d\u9700\u8981\u653e\u5728SOURCE\u7684\u4f4d\u7f6e\uff0c\u53ef\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>find /path/to/dir -type f -mtime +30|xargs -i mv {} /path/to/bak\n</code></pre> <ul> <li>\u5176\u4e2d<code>-type f</code>\u8868\u793a\u67e5\u8be2\u7684\u76ee\u6807\u4e3a\u6587\u4ef6\uff0c<code>-mtime +30</code>\u8868\u793a\u4fee\u6539\u65e5\u671f\u572830\u5929\u4ee5\u524d\uff1b</li> <li><code>{}</code>\u4f1a\u5728\u6267\u884c\u65f6\u66ff\u6362\u4e3a\u5177\u4f53\u7684\u53c2\u6570\u503c\uff0c\u4e00\u4e2a<code>{}</code>\u4ec5\u4f7f\u7528\u4e00\u4e2a\u53c2\u6570\u503c\u8fdb\u884c\u66ff\u6362\u3002</li> </ul>"},{"location":"chap8/25shell_script/","title":"\u5feb\u901f\u63d0\u5347Shell\u811a\u672c\u80fd\u529b","text":""},{"location":"chap8/25shell_script/#shell_1","title":"Shell \u811a\u672c","text":"<p>Shell \u811a\u672c\u662f\u8fd0\u884c\u5728 shell \u73af\u5883\u4e2d\u7684\u811a\u672c\u8bed\u8a00\uff0c\u7528\u4e8e\u81ea\u52a8\u6267\u884c\u91cd\u590d\u6027\u4efb\u52a1\u3001\u7ba1\u7406\u7cfb\u7edf\u914d\u7f6e\u3001\u4ee5\u53ca\u901a\u8fc7\u7f16\u5199\u811a\u672c\u548c\u8fd0\u884c\u811a\u672c\u6765\u6267\u884c\u4e00\u7cfb\u5217\u547d\u4ee4\u3002</p> <p>shell \u811a\u672c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5b8c\u6210\u7cfb\u7edf\u7ba1\u7406\u3001\u8f6f\u4ef6\u5b89\u88c5\u3001\u6587\u4ef6\u64cd\u4f5c\u7b49\u9700\u6c42\u3002</p> <p>Shell \u811a\u672c\u6587\u4ef6\u4ee5 .sh \u4f5c\u4e3a\u6269\u5c55\u540d\uff0c\u57fa\u672c\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>#!/bin/bash\n\n# This is a note\n\necho \"The first line of the script is 'shebang'\"\n</code></pre>"},{"location":"chap8/25shell_script/#shebang","title":"Shebang","text":"<p>shell \u811a\u672c\u7684\u7b2c\u4e00\u884c\u662f shebang\uff0c<code>#!/bin/bash</code>\uff0c\u5b83\u6307\u5b9a\u4e86\u6267\u884c\u811a\u672c\u7684\u89e3\u91ca\u5668\uff0c\u901a\u5e38\u662f bash\u3002\u6267\u884c\u811a\u672c\u65f6\uff0c\u5185\u6838\u4f1a\u8bfb\u53d6 shebang\uff0c\u5e76\u4f7f\u7528\u8be5\u89e3\u91ca\u5668\u6267\u884c\u811a\u672c\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u7cfb\u7edf\u4f7f\u7528\u3001\u652f\u6301\u7684 shell\uff1a</p> <ul> <li><code>echo $SHELL</code>\uff1a\u663e\u793a\u5f53\u524d\u4f7f\u7528\u7684 shell \u7c7b\u578b</li> <li><code>cat /etc/shells</code>\uff1a\u663e\u793a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u53ef\u7528\u7684 shell \u7c7b\u578b</li> </ul>"},{"location":"chap8/25shell_script/#shell_2","title":"\u6267\u884c Shell \u811a\u672c","text":"<p>\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u4f7f\u7528 shebang \u6307\u5b9a\u7684 shell \u6267\u884c\u811a\u672c\uff1a</p> <p>\u7b2c\u4e00\u79cd\u65b9\u5f0f\uff0c\u4f7f\u7528 sh \u547d\u4ee4\uff1a</p> <pre><code>sh script_file.sh\n</code></pre> <p>\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff0c\u901a\u8fc7\u76f8\u5bf9\u8def\u5f84\u6216\u7edd\u5bf9\u8def\u5f84\uff1a</p> <ul> <li>\u9996\u5148\u4e3a\u811a\u672c\u6587\u4ef6\u6dfb\u52a0\u53ef\u6267\u884c\u6743\u9650</li> </ul> <pre><code>chmod +x script_file.sh\n</code></pre> <ul> <li>\u901a\u8fc7\u76f8\u5bf9\u6216\u7edd\u5bf9\u8def\u5f84\uff0c\u4ece\u7ec8\u7aef\u6267\u884c\u811a\u672c\uff1a</li> </ul> <pre><code>./script_file.sh\n</code></pre> <p>\u63a5\u4e0b\u6765\u8ba8\u8bba Shell \u811a\u672c\u4e2d\u7684\u6982\u5ff5\u3002</p>"},{"location":"chap8/25shell_script/#_1","title":"\u8bfb\u53d6\u7528\u6237\u8f93\u5165","text":"<p>read \u547d\u4ee4\u53ef\u4ee5\u4ece\u6807\u51c6\u8f93\u5165\uff08stdin\uff09\u8bfb\u53d6\u7528\u6237\u8f93\u5165\u7684\u5185\u5bb9\u3002\u6bd4\u5982\u8f93\u5165\u7528\u6237\u540d weiwendi \u4e3a shell \u811a\u672c\u4e2d jacob \u53d8\u91cf\u8d4b\u503c\uff1a</p> <pre><code>\n#!/bin/bash\n\n# displays the prompt message\n# -p stand for prompt\n# reads user input and assigns it to the newusername variable\nread -p \"Enter the username: \" username\necho $username\n</code></pre> <p>\u8f93\u5165\u7684\u5185\u5bb9\u5c06\u4ee5\u660e\u6587\u663e\u793a\u5728\u5c4f\u5e55\u4e0a\uff0c\u5982\u679c\u4e0d\u5e0c\u671b\u663e\u793a\u8f93\u5165\u7684\u5185\u5bb9\uff0c\u6bd4\u5982\u5bc6\u7801\u4e4b\u7c7b\u9700\u8981\u4fdd\u5bc6\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>read -sp</code>\uff1a</p> <pre><code>\n# reads input from the user &amp; hides the text from echoing in the terminal\n# -s stand for silent\nread -sp \"Enter Password: \" password\necho \"\"\necho $password\n</code></pre> <p>\u5982\u679c\u4e0d\u60f3\u6307\u5b9a\u53d8\u91cf\u540d\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>$REPLY</code> \u663e\u793a\u8f93\u5165\u7684\u5185\u5bb9\uff1a</p> <pre><code>\n#!/bin/bash\n\necho \"Enter the username: \"\nread\necho \"Read without variable name assignment: \"$REPLY\n</code></pre>"},{"location":"chap8/25shell_script/#_2","title":"\u547d\u4ee4\u66ff\u6362","text":"<p>\u901a\u8fc7\u547d\u4ee4\u66ff\u6362\u7684\u5f62\u5f0f\u53ef\u4ee5\u5c06\u547d\u4ee4\u7684\u8f93\u51fa\u8d4b\u503c\u7ed9\u53d8\u91cf\u3002\u547d\u4ee4\u66ff\u6362\u6709\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li>\u4f7f\u7528\u4e00\u5bf9\u53cd\u6487\u53f7 ``</li> <li>\u4f7f\u7528 <code>$()</code></li> </ul> <p>\u4f8b\u5982\uff0c\u5c06 pwd \u7684\u8f93\u51fa\u8d4b\u503c\u7ed9 <code>working_dir</code> \u53d8\u91cf\uff1a</p> <pre><code>\n#!/bin/bash\n\necho \"Method 1 - Using backticks\"\nworking_dir1=`pwd`\necho $working_dir1\n\necho \"Method 2 - Using $()\"\nworking_dir2=$(pwd)\necho $working_dir2\n</code></pre>"},{"location":"chap8/25shell_script/#_3","title":"\u53c2\u6570\u4f20\u9012","text":"<p>\u53ef\u4ee5\u901a\u8fc7\u4f20\u9012\u53c2\u6570\u7684\u5f62\u5f0f\uff0c\u4e3a\u811a\u672c\u63d0\u4f9b\u8fd0\u884c\u65f6\u6240\u9700\u7684\u53c2\u6570\u3002\u811a\u672c\u53ef\u4ee5\u4f7f\u7528\u7279\u6b8a\u53d8\u91cf\u5982 1\u30012\u3001<code>$3</code> \u7b49\u8bbf\u95ee\u8fd9\u4e9b\u53c2\u6570\u3002</p> <ul> <li><code>$0</code>\uff1a\u8fd4\u56de\u6267\u884c\u811a\u672c\u7684\u6587\u4ef6\u540d</li> <li><code>$@</code>\uff1a\u8fd4\u56de\u4ece CLI \u4f20\u9012\u7684\u6240\u6709\u53c2\u6570</li> <li><code>$#</code>\uff1a\u8fd4\u56de\u4ece CLI \u4f20\u9012\u7684\u53c2\u6570\u6570\u91cf</li> </ul> <p>\u5047\u8bbe\u6709\u4e00\u4e2a\u540d\u4e3a<code>argument_passing.sh</code> \u7684\u811a\u672c\u6587\u4ef6\uff0c\u6211\u4eec\u5411\u5b83\u4f20\u9012\u4e24\u4e2a\u53c2\u6570\u3002</p> <pre><code>sh argument_passing.sh \"Jacob\" \"DevOps Engineer\"\n</code></pre> <pre><code>\n#!/bin/bash\n\n# get script file name\necho \"FileName: \" $0 # argument_passing.sh\n\n# provide the first argument\necho \"First Argument: \"$1 # weiwendi\n\n# provide the second argument\necho \"Second Argument: \"$2 # DevOps Engineer\n\n# displays all arguments provided\necho \"All Arguments: \"$@ # Jacob DevOps Engineer\n\n# displays number of arguments provided\necho \"Arguments Number: \"$# # 2\n</code></pre>"},{"location":"chap8/25shell_script/#_4","title":"\u7b97\u672f\u8fd0\u7b97","text":"<p>\u4f7f\u7528\u53cc\u62ec\u53f7 <code>(())</code> \u53ef\u4ee5\u5728 shell \u811a\u672c\u4e2d\u6267\u884c\u7b97\u672f\u8fd0\u7b97\u3002<code>(())</code> \u4e5f\u79f0\u4e3a\u4e00\u5143\u8fd0\u7b97\u7b26\u3002</p> <pre><code>\n#!/bin/bash\n\nn1=10\nn2=5\n\necho \"Sum of two numbers: \"$(($n1+$n2)) # Addition\necho \"Sub of two numbers: \"$(($n1-$n2)) # Substraction\necho \"Mul of two numbers: \"$(($n1*$n2)) # Mulitplication\necho \"Div of two numbers: \"$(($n1/$n2)) # Division\necho \"Modulus of two numbers: \"$(($n1%$n2)) # Modulus\n</code></pre>"},{"location":"chap8/25shell_script/#_5","title":"\u6761\u4ef6\u8868\u8fbe\u5f0f","text":"<p>\u5728 shell \u811a\u672c\u4e2d\uff0c<code>[[ ]]</code> \u6216 <code>test</code> \u547d\u4ee4\u53ef\u7528\u4e8e\u8bc4\u4f30\u6761\u4ef6\u8868\u8fbe\u5f0f\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u7528\u4e8e\u6d4b\u8bd5\u6761\u4ef6\u7684\u4e00\u5143\u8fd0\u7b97\u7b26\u3002</p> <ul> <li><code>[[ -z String ]]</code>\uff1a\u5224\u65ad\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u7a7a\u3002\u5b57\u7b26\u4e32\u4e3a\u7a7a\uff0c\u7ed3\u679c\u4e3a true\u3002</li> <li><code>[[ -n String ]]</code>\uff1a\u5224\u65ad\u5b57\u7b26\u4e32\u662f\u5426\u4e0d\u4e3a\u7a7a\u3002\u5b57\u7b26\u4e32\u4e0d\u4e3a\u7a7a\uff0c\u7ed3\u679c\u4e3a true\u3002</li> <li><code>[[ String1 == String2 ]]</code>\uff1a\u5224\u65ad\u4e24\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u76f8\u540c\u3002</li> <li><code>[[ String1 != String2 ]]</code>\uff1a\u5224\u65ad\u4e24\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u4e0d\u76f8\u540c\u3002</li> <li><code>[[ num1 -eq num2 ]]</code>\uff1a\u5224\u65ad\u4e24\u4e2a\u6570\u5b57\u662f\u5426\u76f8\u7b49\u3002</li> <li><code>[[ num1 -ne num2 ]]</code>\uff1a\u5224\u65ad\u4e24\u4e2a\u6570\u5b57\u662f\u5426\u4e0d\u76f8\u7b49\u3002</li> <li><code>[[ num1 -lt num2 ]]</code>\uff1anum1 \u662f\u5426\u5c0f\u4e8e num2\u3002</li> <li><code>[[ num1 -le num2 ]]</code>\uff1anum1 \u5c0f\u4e8e\u6216\u7b49\u4e8e num2\u3002</li> <li><code>[[ num1 -gt num2 ]]</code>\uff1anum1 \u5927\u4e8enum2\u3002</li> <li><code>[[ num1 -ge num2 ]]</code>\uff1anum1 \u5927\u4e8e\u6216\u7b49\u4e8e num2\u3002</li> </ul> <p>\u5728 Linux \u4e2d\uff0c\u5927\u591a\u6570\u5bf9\u8c61\u4ee5\u6587\u4ef6\u7684\u5f62\u5f0f\u5b58\u5728\uff0c\u56e0\u6b64\uff0cLinux \u4e5f\u63d0\u4f9b\u4e86\u5bf9\u6587\u4ef6\u7684\u6761\u4ef6\u5224\u65ad\uff1a</p> <ul> <li><code>[[ -e fileName ]]</code>\uff1a\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728</li> <li><code>[[ -r fileName ]]</code>\uff1a\u5bf9\u6587\u4ef6\u662f\u5426\u6709\u8bfb\u6743\u9650</li> <li><code>[[ -h fileName ]]</code>\uff1a\u6587\u4ef6\u662f\u5426\u4e3a\u7b26\u53f7\u94fe\u63a5</li> <li><code>[[ -d fileName ]]</code>\uff1a\u662f\u5426\u4e3a\u76ee\u5f55</li> <li><code>[[ -w fileName ]]</code>\uff1a\u5bf9\u6587\u4ef6\u662f\u5426\u6709\u5199\u6743\u9650</li> <li><code>[[ -s fileName ]]</code>\uff1a\u6587\u4ef6\u662f\u5426\u5927\u4e8e 0 \u5b57\u8282</li> <li><code>[[ -x fileName ]]</code>\uff1a\u5bf9\u6587\u4ef6\u662f\u5426\u6709\u6267\u884c\u6743\u9650</li> </ul>"},{"location":"chap8/25shell_script/#if-else","title":"if else","text":"<p>if else \u662f\u6761\u4ef6\u8bed\u53e5\uff0c\u53ef\u4ee5\u6839\u636e\u6761\u4ef6\u7684 true \u6216 false \u6267\u884c\u4e0d\u540c\u7684\u547d\u4ee4\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a <code>ifelse.sh</code> \u7684\u6587\u4ef6\uff0c\u4ee3\u7801\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>#!/bin/bash\n\n# -e stands for exists\n# use brackets to determine whether the file exists\nif [[ -e ./ifelse.sh ]]\nthen\n    echo \"File exist\"\nelse\n    echo \"File does not exist\"\nfi\n\n# run the test command to check whether the file exists\nif test -e \"./ifelse.sh\"\nthen\n    echo \"File exist\"\nelse\n    echo \"File does not exist\"\nfi\n</code></pre>"},{"location":"chap8/25shell_script/#elif","title":"elif","text":"<p>elif \u662f else \u548c if \u7684\u7ec4\u5408\uff0c\u7528\u4e8e\u521b\u5efa\u591a\u4e2a\u6761\u4ef6\u8bed\u53e5\uff0c\u5fc5\u987b\u4e0e if else \u8bed\u53e5\u7ed3\u5408\u4f7f\u7528</p> <pre><code>#!/bin/bash\n\nread -p \"Enter the number between 1 to 3: \" number\n\nif [[ $number -eq 1 ]]\nthen\n    echo \"The number entered is 1\"\nelif [[ $number -eq 2 ]]\nthen\n    echo \"The number entered is 2\"\nelif [[ $number -eq 3 ]]\nthen\n    echo \"The number entered is 3\"\nelse\n    echo \"Invalid Number\"\nfi\n</code></pre>"},{"location":"chap8/25shell_script/#_6","title":"\u5faa\u73af","text":"<p>\u5728 shell \u7f16\u7a0b\u4e2d\uff0c\u9664\u4e86\u6761\u4ef6\u5224\u65ad\u5916\uff0c\u5bf9\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\u9700\u8981\u8fdb\u884c\u5faa\u73af\u64cd\u4f5c\u3002</p>"},{"location":"chap8/25shell_script/#for","title":"for","text":"<p>for \u5faa\u73af\u7528\u4e8e\u904d\u5386\u5217\u8868\uff0c\u5728\u8fdb\u5165 shell \u5faa\u73af\u524d\u77e5\u9053\u8fed\u4ee3\u6b21\u6570\u65f6\uff0c\u901a\u5e38\u4f7f\u7528 for \u5faa\u73af\u3002\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>\n#!/bin/bash\n\nfor i in {1..10}\ndo\n    echo \"Var: $i\"\ndone\n</code></pre>"},{"location":"chap8/25shell_script/#while","title":"while","text":"<p>while \u5faa\u73af\u7528\u4e8e\u5728\u7279\u5b9a\u6761\u4ef6\u4e3a\u771f\u65f6\u91cd\u590d\u6267\u884c\u4e00\u7ec4\u547d\u4ee4\uff0c\u5faa\u73af\u4e00\u76f4\u6301\u7eed\u5230\u6761\u4ef6\u4e3a\u5047\u65f6\u7ec8\u6b62\u3002</p> <pre><code>#!/bin/bash\n\ncount=0\n\nwhile [ $count -lt 5 ]\ndo\n    echo $count\n    count=$(($count+1))\ndone\n</code></pre>"},{"location":"chap8/25shell_script/#until","title":"until","text":"<pre><code>#!/bin/bash\n\ncount=1\n\nuntil [ $count -gt 5 ]\ndo\n    echo $count\n    let count++\ndone\n</code></pre>"},{"location":"chap8/25shell_script/#break","title":"Break \u8bed\u53e5","text":"<p>break \u5173\u952e\u5b57\u662f\u4e00\u4e2a\u63a7\u5236\u8bed\u53e5\uff0c\u7528\u4e8e\u5728\u6ee1\u8db3\u7279\u5b9a\u6761\u4ef6\u65f6\u9000\u51fa\u5faa\u73af\uff08for\u3001while \u6216 until\uff09\u3002break \u4ec5\u9000\u51fa\u5faa\u73af\uff0c\u811a\u672c\u5c06\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\u3002</p> <pre><code>\n#!/bin/bash\n\ncount=1\n\nwhile true\ndo\n    echo \"Count is $count\"\n    count=$(($count+1))\n    if test $count -gt 5; then\n        echo \"Break statement reached\"\n        break\n    fi\ndone\n\necho \"Jump out of the sequence and continue to execute the following code.\"\n</code></pre>"},{"location":"chap8/25shell_script/#continue","title":"Continue \u8bed\u53e5","text":"<p>continue \u662f\u5faa\u73af\uff08\u5982 for\u3001while \u548c until\uff09\u4e2d\u4f7f\u7528\u7684\u5173\u952e\u5b57\uff0c\u7528\u4e8e\u8df3\u8fc7\u5faa\u73af\u7684\u5f53\u524d\u8fed\u4ee3\uff0c\u8fdb\u5165\u4e0b\u4e00\u6b21\u8fed\u4ee3\u3002</p> <pre><code>\n#!/bin/bash\n\nfor i in {1..10}\ndo\n    if [ $i -eq 5 ]\n    then\n        continue\n    fi\n    echo $i\ndone\n</code></pre>"},{"location":"chap8/25shell_script/#_7","title":"\u6570\u7ec4","text":"<p>\u6570\u7ec4\u4e2d\u53ef\u4ee5\u5b58\u50a8\u591a\u4e2a\u503c\uff0cBash shell \u652f\u6301\u4e00\u7ef4\u6570\u7ec4\u3002\u5728\u811a\u672c\u4e2d\uff0c\u901a\u5e38\u628a\u6570\u7ec4\u4f5c\u4e3a\u53d8\u91cf\u7684\u503c\u3002</p> <ul> <li><code>${arrayVarName[@]}</code>\uff1a\u663e\u793a\u6570\u7ec4\u53d8\u91cf\u4e2d\u7684\u6240\u6709\u503c</li> <li><code>${#arrayVarName[@]}</code>\uff1a\u663e\u793a\u6570\u7ec4\u7684\u957f\u5ea6</li> <li><code>${arrayVarName[0]}</code>\uff1a\u663e\u793a\u6570\u7ec4\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20</li> <li><code>${arrayVarName[-1]}</code>\uff1a\u663e\u793a\u6570\u7ec4\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20</li> <li><code>unset arrayVarName[2]</code>\uff1a\u5220\u9664\u7b2c\u4e09\u4e2a\u5143\u7d20\uff0c\u7d22\u5f15\u4ece 0 \u5f00\u59cb\u3002</li> </ul>"},{"location":"chap8/25shell_script/#_8","title":"\u51fd\u6570","text":"<p>\u51fd\u6570\u662f\u4e00\u4e2a\u4ee3\u7801\u5757\uff0c\u53ef\u4ee5\u91cd\u590d\u4f7f\u7528\u6765\u5b8c\u6210\u7279\u5b9a\u4efb\u52a1\uff0c\u4ece\u800c\u63d0\u4f9b\u4e86\u4ee3\u7801\u7684\u53ef\u91cd\u7528\u6027\u3002</p> <p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u51fd\u6570\u793a\u4f8b\uff1a</p> <pre><code>\n#!/bin/bash\n\nsum() {\n    echo \"The numbers are: ${n1} ${n2}\"\n    sum_val=$((${n1}+${n2}))\n    echo \"Sum: $sum_val\"\n}\n\nn1=$1\nn2=$2\nsum\n</code></pre>"},{"location":"chap8/25shell_script/#_9","title":"\u5e26\u6709\u8fd4\u56de\u503c\u7684\u51fd\u6570","text":"<p>\u51fd\u6570\u662f\u53ef\u4ee5\u6709\u8fd4\u56de\u503c\u7684\u3002\u8981\u8bbf\u95ee\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u9700\u8981\u4f7f\u7528<code>$?</code></p> <pre><code>\n#!/bin/bash\n\nsum(){\n        echo \"The numbers are: $n1 $n2\"\n        sum_val=$(($n1+$n2))\n        return $sum_val\n}\n\nn1=$1\nn2=$2\nsum\n\necho \"Retuned value from function is $?\"\n</code></pre>"},{"location":"chap8/25shell_script/#_10","title":"\u53d8\u91cf","text":"<p>\u53d8\u91cf\u662f\u4e00\u4e2a\u5360\u4f4d\u7b26\uff0c\u7528\u4e8e\u4fdd\u5b58\u4e00\u4e2a\u503c\uff0c\u4ee5\u540e\u53ef\u4ee5\u4f7f\u7528\u8be5\u540d\u79f0\u8bbf\u95ee\u8be5\u503c\u3002\u53d8\u91cf\u6709\u4e24\u79cd\u7c7b\u578b\uff1a</p> <ul> <li>\u5168\u5c40\u53d8\u91cf\uff1a\u5728\u51fd\u6570\u5916\u90e8\u5b9a\u4e49\u7684\u53d8\u91cf\uff0c\u53ef\u5728\u6574\u4e2a\u811a\u672c\u4e2d\u8bbf\u95ee</li> <li>\u5c40\u90e8\u53d8\u91cf\uff1a\u5b9a\u4e49\u5728\u51fd\u6570\u5185\u90e8\u7684\u53d8\u91cf\uff0c\u53ea\u80fd\u5728\u51fd\u6570\u5185\u90e8\u8bbf\u95ee</li> </ul> <pre><code>\n#!/bin/bash\n\n# x &amp; y are global variables\nx=10\ny=20\n\nsum() {\n    sum=$(($x+$y))\n    echo \"Global Variable Addition: $sum\"\n}\n\nsum\n\nsub() {\n    # a &amp; b are local variables\n    local a=20\n    local b=10\n    local sub=$(($a-$b))\n    echo \"Local Variable Substraction: $sub\"\n}\n\nsub\n</code></pre>"},{"location":"chap8/25shell_script/#_11","title":"\u5b57\u5178","text":"<p>\u5728 shell \u811a\u672c\u4e2d\uff0c\u5b57\u5178\u662f\u4f7f\u7528\u5173\u8054\u6570\u7ec4\u5b9e\u73b0\u7684\u3002\u5173\u8054\u6570\u7ec4\u662f\u4f7f\u7528\u5b57\u7b26\u4e32\u800c\u4e0d\u662f\u6574\u6570\u4f5c\u4e3a\u7d22\u5f15\u7684\u6570\u7ec4\u3002<code>declare -A</code> \u547d\u4ee4\u7528\u6765\u5b9a\u4e49\u5b57\u5178\uff1a</p> <pre><code>!/bin/bash\n\n# \u5b9a\u4e49\u4e00\u4e2a\u5b57\u5178\uff0c\u5e76\u5728\u5b9a\u4e49\u540e\u8d4b\u503c\ndeclare -A dic1\ndic1[name]=Curry\ndic1[no]=30\n\n# \u6839\u636e key \u6253\u5370 value\necho \"the name's: ${dic1[name]}\"\necho \"the jersey number's: ${dic1[no]}\"\n\n# \u5b9a\u4e49\u5b57\u5178\u5e76\u540c\u65f6\u8d4b\u503c\ndeclare -A dic2=([name]=Wiggins [no]=22)\n\n# \u6253\u5370\u5b57\u5178\u4e2d\u7684\u6240\u6709 key\necho \"print all keys in the dic2: ${!dic2[@]}\"\n# \u6253\u5370\u5b57\u5178\u4e2d\u7684\u6240\u6709 value\necho \"print all values in the dic2: ${dic2[@]}\"\n\n# \u6253\u5370\u952e\u503c\u5bf9\nfor i in ${!dic2[@]}\ndo\n    echo $i: ${dic2[$i]}\ndone\n</code></pre>"},{"location":"chap8/25shell_script/#set","title":"Set \u9009\u9879","text":"<p>set \u547d\u4ee4\u53ef\u4ee5\u4fee\u6539\u6216\u663e\u793a shell \u9009\u9879\u7684\u503c\u3002\u5982\u679c\u4e0d\u5e26\u4efb\u4f55\u53c2\u6570\uff0c\u5c06\u5217\u51fa\u6240\u6709 shell \u53d8\u91cf\u53ca\u503c\u3002</p> <p><code>set -x</code>\u7c7b\u4f3c\u4e8e\u8c03\u8bd5\u6a21\u5f0f\uff0c\u5148\u6253\u5370\u6b63\u5728\u6267\u884c\u7684\u547d\u4ee4\uff0c\u7136\u540e\u663e\u793a\u547d\u4ee4\u7684\u8f93\u51fa\u7ed3\u679c\u3002</p> <p><code>set -e</code> \u5f53\u51fa\u73b0\u975e\u96f6\u9000\u51fa\u4ee3\u7801\u65f6\uff0c\u7acb\u5373\u9000\u51fa\u811a\u672c\u3002</p> <p>\u5728\u4f7f\u7528\u7ba1\u9053\u547d\u4ee4\u65f6\uff0c\u4f8b\u5982 <code>sdfdsf | echo 'vish'</code>\u3002\u7531\u4e8e\u8be5\u884c\u6267\u884c\u7684\u6700\u540e\u4e00\u6761\u547d\u4ee4\u662f echo\uff0c\u800c echo \u8fd4\u56de\u7684\u9000\u51fa\u4ee3\u7801\u4e3a\u96f6\uff0c\u56e0\u6b64\u6574\u884c\u547d\u4ee4\u88ab\u8ba4\u4e3a\u662f\u6210\u529f\u7684\uff0c\u4f46\u4e4b\u524d\u7684\u547d\u4ee4 sdsds \u5c06\u8fd4\u56de\u975e\u96f6\u4ee3\u7801\uff0c\u8fd9\u662f\u9519\u8bef\u7684\u3002\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u8bbe\u7f6e\u9009\u9879\u3002</p> <p><code>set -o pipefail</code> \u4e3a\u4e86\u514b\u670d\u4e0a\u8ff0\u7ba1\u9053\u547d\u4ee4\u9519\u8bef\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>set -o pipefail</code> \u9009\u9879\uff0c\u5b83\u4f1a\u6355\u83b7\u5e76\u7acb\u5373\u505c\u6b62\u811a\u672c\u3002\u56e0\u6b64\uff0c\u6bcf\u6761\u547d\u4ee4\u90fd\u5e94\u8fd4\u56de\u96f6\u9000\u51fa\u4ee3\u7801\u3002\u5426\u5219\uff0c\u811a\u672c\u5c06\u5931\u8d25\u3002</p>"},{"location":"chap8/26linux_zombie/","title":"\u5982\u4f55\u6e05\u7406 Linux \u50f5\u5c38\u8fdb\u7a0b\uff1f","text":""},{"location":"chap8/26linux_zombie/#1","title":"1. \u4ec0\u4e48\u662f\u50f5\u5c38\u8fdb\u7a0b\uff1f","text":"<p>Linux \u4e2d\u7684\u50f5\u5c38\u8fdb\u7a0b\uff08Zombie processes\uff09\u6709\u65f6\u4e5f\u88ab\u79f0\u4e3a\u5931\u6548\u6216\u6b7b\u4ea1\u8fdb\u7a0b\u3002\u5b83\u4eec\u662f\u5df2\u6267\u884c\u5b8c\u6bd5\u7684\u8fdb\u7a0b\uff0c\u4f46\u5176\u6761\u76ee\u5e76\u672a\u4ece\u8fdb\u7a0b\u8868\u4e2d\u5220\u9664\u3002</p>"},{"location":"chap8/26linux_zombie/#21","title":"2.1 \u8fdb\u7a0b\u72b6\u6001","text":"<p>Linux \u4f1a\u7ef4\u62a4\u4e00\u4e2a\u8fdb\u7a0b\u8868\uff0c\u5176\u4e2d\u5305\u542b\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\u53ca\u5176\u72b6\u6001\u3002\u4e0b\u9762\u7b80\u8981\u4ecb\u7ecd\u4e00\u4e0b\u5404\u79cd\u8fdb\u7a0b\u72b6\u6001\uff1a </p> <ul> <li> <p>\uff081\uff09Running (R): \u8868\u793a\u8fd9\u4e9b\u8fdb\u7a0b\u76ee\u524d\u6b63\u5728\u8fd0\u884c\u6216\u53ef\u8fd0\u884c\uff0c\u7528\u5b57\u6bcd R \u8868\u793a\u3002\u9700\u8981\u8bf4\u660e\uff1a\u8fdb\u7a0b\u662f R \u72b6\u6001\uff0c\u4e0d\u4ee3\u8868\u6b63\u5728\u8fd0\u884c\uff0c\u4ee3\u8868\u53ef\u88ab\u8c03\u5ea6\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u8fdb\u7a0b\u53ea\u6709\u662f R \u72b6\u6001\u624d\u53ef\u88ab\u8c03\u5ea6\uff0c\u5176\u4ed6\u72b6\u6001\u8981\u5148\u8f6c\u4e3a R \u72b6\u6001\uff0c\u624d\u80fd\u88ab OS \u8c03\u5ea6\uff1b</p> </li> <li> <p>\uff082\uff09Waiting (S/D): \u8868\u793a\u8fd9\u4e9b\u8fdb\u7a0b\u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6\u5b8c\u6210\u6216\u67d0\u79cd\u8d44\u6e90\u5c31\u7eea\uff0c\u7528\u5b57\u6bcd S/D \u8868\u793a\uff0c\u7b49\u5f85\u53ef\u4ee5\u662f\u53ef\u4e2d\u65ad\u4f11\u7720 S(interruptible sleep) \u6216\u4e0d\u4e2d\u65ad\u4f11\u7720 D (uninterruptible sleep)\uff1b</p> </li> <li> <p>\uff083\uff09Stopped (T):  \u53ef\u4ee5\u901a\u8fc7\u53d1\u9001 SIGSTOP \u4fe1\u53f7\u7ed9\u8fdb\u7a0b\u6765\u505c\u6b62\uff08T\uff09\u8fdb\u7a0b\u3002\u8fd9\u4e2a\u88ab\u6682\u505c\u7684\u8fdb\u7a0b\u53ef\u4ee5\u901a\u8fc7\u53d1\u9001 SIGCONT \u4fe1\u53f7\u8ba9\u8fdb\u7a0b\u7ee7\u7eed\u8fd0\u884c\u3002</p> </li> <li> <p>\uff084\uff09Zombie (Z): \u4e00\u4e2a\u6bd4\u8f83\u7279\u6b8a\u7684\u72b6\u6001\u3002\u5f53\u5b50\u8fdb\u7a0b\u9000\u51fa\u5e76\u4e14\u7236\u8fdb\u7a0b\u6ca1\u6709\u8bfb\u53d6\u5230\u5b50\u8fdb\u7a0b\u9000\u51fa\u7684\u8fd4\u56de\u4ee3\u7801\u65f6\uff0c\u5c31\u4f1a\u4ea7\u751f\u50f5\u6b7b(\u5c38)\u8fdb\u7a0b\u3002</p> <ul> <li>\u50f5\u6b7b\u8fdb\u7a0b\u4f1a\u4ee5\u7ec8\u6b62\u72b6\u6001\u4fdd\u6301\u5728\u8fdb\u7a0b\u8868\u4e2d\uff0c\u5e76\u4e14\u4f1a\u4e00\u76f4\u5728\u7b49\u5f85\u7236\u8fdb\u7a0b\u8bfb\u53d6\u9000\u51fa\u72b6\u6001\u4ee3\u7801\u3002\u6240\u4ee5\uff0c\u53ea\u8981\u5b50\u8fdb\u7a0b\u9000\u51fa\uff0c\u7236\u8fdb\u7a0b\u8fd8\u5728\u8fd0\u884c\uff0c\u4f46\u7236\u8fdb\u7a0b\u6ca1\u6709\u8bfb\u53d6\u5b50\u8fdb\u7a0b\u72b6\u6001\uff0c\u5b50\u8fdb\u7a0b\u8fdb\u5165 Z \u72b6\u6001\u3002</li> </ul> </li> </ul>"},{"location":"chap8/26linux_zombie/#_1","title":"\u50f5\u5c38\u8fdb\u7a0b\u662f\u5982\u4f55\u4ea7\u751f\u7684\uff1f","text":"<p>\u5f53\u4e00\u4e2a\u8fdb\u7a0b\u5b8c\u6210\u5176\u5de5\u4f5c\u65f6\uff0cLinux \u5185\u6838\u4f1a\u901a\u8fc7\u53d1\u9001 SIGCHLD \u4fe1\u53f7\u901a\u77e5\u5176\u7236\u8fdb\u7a0b\u3002</p> <p>\u7136\u540e\uff0c\u7236\u8fdb\u7a0b\u6267\u884c <code>wait()</code> \u7cfb\u7edf\u8c03\u7528\uff0c\u8bfb\u53d6\u5b50\u8fdb\u7a0b\u7684\u72b6\u6001\u5e76\u8bfb\u53d6\u5176\u9000\u51fa\u4ee3\u7801\u3002\u8fd9\u4f1a\u6e05\u9664\u8fdb\u7a0b\u8868\u4e2d\u5b50\u8fdb\u7a0b\u6761\u76ee\uff0c\u4ece\u800c\u7ed3\u675f\u8fdb\u7a0b\u3002</p> <p>\u4f46\u662f\uff0c\u5982\u679c\u7236\u8fdb\u7a0b\u6ca1\u6709\u5728\u521b\u5efa\u5b50\u8fdb\u7a0b\u65f6\u6267\u884c <code>wait()</code> \u7cfb\u7edf\u8c03\u7528\uff0c\u5c31\u4e0d\u4f1a\u8fdb\u884c\u9002\u5f53\u7684\u6e05\u7406\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7236\u8fdb\u7a0b\u65e0\u6cd5\u76d1\u63a7\u5b50\u8fdb\u7a0b\u7684\u72b6\u6001\u53d8\u5316\uff0c\u6700\u7ec8\u4f1a\u5ffd\u7565 SIGCHLD \u4fe1\u53f7\u3002\u8fd9\u5c06\u5bfc\u81f4\u5df2\u5b8c\u6210\u8fdb\u7a0b\u7684\u50f5\u5c38\u72b6\u6001\u7559\u5728\u8fdb\u7a0b\u8868\u4e2d\uff0c\u4ece\u800c\u4f7f\u5176\u4f5c\u4e3a\u50f5\u5c38\u8fdb\u7a0b\u51fa\u73b0\u5728\u8fdb\u7a0b\u5217\u8868\u4e2d\u3002</p>"},{"location":"chap8/26linux_zombie/#_2","title":"\u641c\u7d22\u50f5\u5c38\u8fdb\u7a0b","text":"<p>\u4f7f\u7528 ps \u547d\u4ee4\u6765\u68c0\u7d22\u50f5\u5c38\u8fdb\u7a0b\u5217\u8868\uff1a</p> <pre><code>ps ux\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nshubh        9  0.0  0.0  16916  2760 tty1     S    Dec19   0:00 /bin/bash --login\nshubh      108  0.0  0.0      0     0 tty1     Z    16:25   0:00 [zombie] &lt;defunct&gt; \nshubh      109  0.0  0.0  17384  1928 tty2     R    16:25   0:00 ps ux\n</code></pre> <p>\u4ece\u8f93\u51fa\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0cSTAT \u5217\u4e2d\u7684 Z \u5373\u4e3a\u50f5\u5c38\u8fdb\u7a0b\u72b6\u6001\uff0c\u6216\u8005\u4f7f\u7528 awk \u547d\u4ee4\u6839\u636e Z \u8fdb\u7a0b\u72b6\u6001\u8fdb\u4e00\u6b65\u8fc7\u6ee4\u8f93\u51fa\uff1a</p> <pre><code>ps ux | awk '{if($8==\"Z\") print}'\nshubh       108  0.0  0.0      0     0 tty1     Z    16:25   0:00 [zombie] &lt;defunct&gt;\n</code></pre> <p>\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u4f7f\u7528 top \u547d\u4ee4\uff1a</p> <pre><code>top\nTasks:   8 total,   1 running,   6 sleeping,   0 stopped,   1 zombie\n%Cpu(s):  0.7 us,  1.6 sy,  0.0 ni, 96.5 id,  0.0 wa,  1.2 hi,  0.0 si,  0.0 st\nKiB Mem :  8269412 total,  3161228 free,  4878832 used,   229352 buff/cache\nKiB Swap: 15483260 total, 14830144 free,   653116 used.  3256848 avail Mem\n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND\n    1 root      20   0    8936    192    148 S   0.0  0.0   0:00.17 init\n    8 root      20   0    8936     96     56 S   0.0  0.0   0:00.00 init\n    9 shubh     20   0   16916   2748   2640 S   0.0  0.0   0:00.43 bash\n   76 root      20   0    8936    224    184 S   0.0  0.0   0:00.00 init\n   77 shubh     20   0   16784   3432   3332 S   0.0  0.0   0:00.35 bash\n  161 shubh     20   0       0      0      0 Z   0.0  0.0   0:00.00 zombie\n  162 shubh     20   0   17624   2084   1508 R   0.0  0.0   0:00.00 top\n</code></pre> <p>top \u9664\u4e86\u8f93\u51fa\u5176\u4ed6\u8be6\u7ec6\u4fe1\u606f\u5916\uff0c\u8fd8\u53ef\u4ee5\u5728\u8f93\u51fa\u9876\u90e8\u7684\u6458\u8981\u4e2d\u770b\u5230\u50f5\u5c38\u8fdb\u7a0b\u7684\u6570\u91cf\u3002</p>"},{"location":"chap8/26linux_zombie/#_3","title":"\u6e05\u7406\u50f5\u5c38\u8fdb\u7a0b","text":"<p>\u6211\u4eec\u65e0\u6cd5\u771f\u6b63\u6740\u6b7b\u50f5\u5c38\u8fdb\u7a0b\uff0c\u56e0\u4e3a\u672c\u8eab\u5b83\u5df2\u7ecf\u7ed3\u675f\u4e86\u3002\u4f46\u662f\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u65b9\u6cd5\u6765\u6e05\u7406\u50f5\u5c38\u8fdb\u7a0b\u3002</p>"},{"location":"chap8/26linux_zombie/#sigchld","title":"\u4f7f\u7528 SIGCHLD \u4fe1\u53f7","text":"<p>\u53ef\u4ee5\u624b\u52a8\u5411\u50f5\u5c38\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\u53d1\u9001 SIGCHLD \u4fe1\u53f7\u3002\u8fd9\u6837\uff0c\u7236\u8fdb\u7a0b\u5c31\u4f1a\u4e3b\u52a8\u89e6\u53d1 <code>wait()</code> \u7cfb\u7edf\u8c03\u7528\uff0c\u4ece\u800c\u4ece\u8fdb\u7a0b\u8868\u4e2d\u6e05\u9664\u5df2\u5931\u6548\u7684\u5b50\u8fdb\u7a0b\u3002</p> <p>\u627e\u5230\u50f5\u5c38\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b PID\uff1a </p> <pre><code>ps -A -ostat,pid,ppid | grep -e '[zZ]'\nZ      108   103\n</code></pre> <p>\u4e0d\u8fc7\uff0c\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u5411\u7236\u8fdb\u7a0b\u53d1\u9001 SIGCHLD \u4fe1\u53f7\u5c31\u80fd\u6740\u6b7b\u50f5\u5c38\u8fdb\u7a0b\u3002\u53ea\u6709\u5728\u7236\u8fdb\u7a0b\u53ef\u4ee5\u5904\u7406 SIGCHLD \u4fe1\u53f7\u7684\u60c5\u51b5\u4e0b\uff0c\u5b83\u624d\u4f1a\u8d77\u4f5c\u7528\u3002</p>"},{"location":"chap8/26linux_zombie/#kill","title":"kill \u7236\u8fc7\u7a0b","text":"<p>\u5982\u679c\u4e0a\u4e00\u8282\u7684\u65b9\u6cd5\u65e0\u6cd5\u6e05\u9664\u5931\u6548\u8fdb\u7a0b\uff0c\u5c31\u9700\u8981\u8003\u8651\u6740\u6b7b\u5176\u7236\u8fdb\u7a0b\uff1a</p> <pre><code>kill -9 103\n</code></pre> <p>\u4f46\u662f\uff0c\u6740\u6b7b\u7236\u8fdb\u7a0b\u4f1a\u5f71\u54cd\u5176\u6240\u6709\u5b50\u8fdb\u7a0b\u3002\u56e0\u6b64\uff0c\u5e94\u8be5\u683c\u5916\u8c28\u614e\uff0c\u5728\u6740\u6b7b\u7236\u8fdb\u7a0b\u4e4b\u524d\u5fc5\u987b\u786e\u5b9a\u5176\u5f71\u54cd\u3002</p> <p>\u5982\u679c\u5b58\u5728\u5927\u91cf\u50f5\u5c38\u8fdb\u7a0b\uff0c\u6216\u8005\u50f5\u5c38\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\u662f init \u8fdb\u7a0b\uff08pid=1\uff09\uff0c\u53ef\u4ee5\u8003\u8651\u91cd\u542f\u7cfb\u7edf\u6765\u6e05\u9664\u5931\u6548\u8fdb\u7a0b\u3002</p>"},{"location":"chap8/27Inode/","title":"Linux inode \u4ecb\u7ecd\u4e0e\u6e05\u7406","text":""},{"location":"chap8/27Inode/#1-inode","title":"1 \u4ec0\u4e48\u662f inode\uff1f","text":"<p>inode \u662f\u4e00\u79cd\u6587\u4ef6\u6570\u636e\u7ed3\u6784\uff0c\u7528\u4e8e\u5b58\u50a8\u9664\u6587\u4ef6\u540d\u548c\u6570\u636e\u4e4b\u5916\u7684\u4efb\u4f55 Linux \u6587\u4ef6\u7684\u4fe1\u606f\u3002</p> <p> </p> <p>\u793a\u4f8b\uff1astat \u67e5\u770b inode\uff1a</p> <pre><code>root@dev:~# stat domain.txt\n--------------------------------------------------------------------------------------\n  File: domain.txt\n  Size: 30          Blocks: 8          IO Block: 4096   regular file\nDevice: fc01h/64513d    Inode: 6362        Links: 1\nAccess: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)\nAccess: 2024-01-05 01:21:46.196735160 +0800\nModify: 2023-12-29 00:11:28.349067755 +0800\nChange: 2023-12-29 00:11:28.349067755 +0800\n Birth: -\n</code></pre>"},{"location":"chap8/27Inode/#2-inode","title":"2. inode \u662f\u7528\u6765\u505a\u4ec0\u4e48\u7684\uff1f","text":"<p>Linux \u4e2d\uff0c\u6570\u636e\u4ee5\u56fa\u5b9a\u5927\u5c0f\u7684\u5757\u5f62\u5f0f\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u3002\u5982\u679c\u4f60\u4fdd\u5b58\u7684\u6587\u4ef6\u8d85\u8fc7\u4e86\u4e00\u4e2a\u6807\u51c6\u5757\u7684\u5927\u5c0f\uff0c\u7cfb\u7edf\u5c31\u4f1a\u67e5\u627e\u4e0b\u4e00\u4e2a\u53ef\u7528\u533a\u6bb5\u6765\u5b58\u50a8\u6587\u4ef6\u7684\u5176\u4f59\u90e8\u5206\u3002\u4e45\u800c\u4e45\u4e4b\uff0c\u5c31\u4f1a\u53d8\u5f97\u975e\u5e38\u6df7\u4e71\uff0c\u8fd9\u65f6\u5019\u5c31\u9700\u8981 inode \u4e86\u3002</p> <p>inode \u867d\u7136\u4e0d\u5305\u542b\u6587\u4ef6\u7684\u4efb\u4f55\u5b9e\u9645\u6570\u636e\uff0c\u4f46\u5374\u5b58\u50a8\u7740\u6587\u4ef6\u7684\u5143\u6570\u636e\uff0c\u5305\u62ec\u53ef\u4ee5\u627e\u5230\u6587\u4ef6\u6570\u636e\u7684\u6240\u6709\u5b58\u50a8\u5757\u3002</p> <p>inode \u4e2d\u5305\u542b\u7684\u4fe1\u606f\uff1a</p> <ul> <li>\u6587\u4ef6\u5927\u5c0f\uff1b</li> <li>\u5b58\u50a8\u6587\u4ef6\u7684\u8bbe\u5907\uff1b</li> <li>\u4e0e\u6587\u4ef6\u76f8\u5173\u7684\u7528\u6237\u548c\u7ec4 ID\uff1b</li> <li>\u8bbf\u95ee\u6587\u4ef6\u6240\u9700\u7684\u6743\u9650\uff1b</li> <li>\u521b\u5efa\u3001\u8bfb\u53d6\u548c\u5199\u5165\u65f6\u95f4\u6233\uff1b</li> <li>\u6570\u636e\u4f4d\u7f6e\uff08\u4f46\u4e0d\u5305\u62ec\u6587\u4ef6\u8def\u5f84\uff09\uff1b</li> </ul> <p>inode \u4e0e\u6587\u4ef6\u540d\u65e0\u5173\uff0c\u8fd9\u610f\u5473\u7740\u53ef\u4ee5\u590d\u5236\u4e00\u4e2a\u6587\u4ef6\uff0c\u91cd\u65b0\u547d\u540d\u540e\uff0c\u5b83\u4ecd\u7136\u6307\u5411\u4e0e\u539f\u59cb\u6587\u4ef6\u76f8\u540c\u7684 inode\u3002</p>"},{"location":"chap8/27Inode/#3-inode","title":"3. inode \u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff1f","text":"<p>\u521b\u5efa\u65b0\u6587\u4ef6\u65f6\uff0c\u4f1a\u5206\u914d\u4e00\u4e2a inode \u7f16\u53f7\u548c\u4e00\u4e2a\u6587\u4ef6\u540d\uff0cinode \u7f16\u53f7\u662f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u552f\u4e00\u7684\u7f16\u53f7\uff0c\u6587\u4ef6\u540d\u548c inode \u7f16\u53f7\u90fd\u4f5c\u4e3a\u6761\u76ee\u5b58\u50a8\u5728\u76ee\u5f55\u4e2d\u3002 </p> <p>\u5f53\u8fd0\u884c ls \u547d\u4ee4\uff0c\u5982 \"ls -li /\"\u65f6\uff0c\u6587\u4ef6\u540d\u548c inode \u7f16\u53f7\u662f\u5b58\u50a8\u5728 / \u76ee\u5f55\u4e2d\u7684\u5185\u5bb9\u3002</p> <p>\u5176\u4f59\u7684\u7528\u6237\u3001\u7ec4\u3001\u6587\u4ef6\u6743\u9650\u3001\u5927\u5c0f\u7b49\u4fe1\u606f\u662f\u4f7f\u7528 inode \u7f16\u53f7\u4ece inode \u8868\u4e2d\u83b7\u53d6\u7684\u3002</p> <p>\u5728 Linux \u4e2d\u4f7f\u7528 df \u547d\u4ee4\u53ef\u4ee5\u5217\u51fa\u6bcf\u4e2a\u6587\u4ef6\u7cfb\u7edf\u7684 inode \u4fe1\u606f\uff1a<code>df -hi</code>\u3002</p>"},{"location":"chap8/27Inode/#4inode","title":"4.inode &amp; \u8f6f/\u786c \u94fe\u63a5","text":"<p>Linux \u4e2d\u521b\u5efa\u7b26\u53f7\u94fe\u63a5\u65f6\uff0cinode \u4f1a\u53d1\u751f\u4ec0\u4e48\u53d8\u5316\uff1f</p> <p>\u793a\u4f8b\u76ee\u5f55\uff1a\u521b\u5efa\u8f6f\u8fde\u63a5\u547d\u4ee4 <code>ln -s ../file1 slink</code></p> <pre><code>root@dev:~/linux/inode# tree\n--------------------------------------------------------------------------------------\n.\n\u251c\u2500\u2500 dir\n\u2502   \u2514\u2500\u2500 slink -&gt; ../file1\n\u2514\u2500\u2500 file1\n</code></pre> <p>\u9012\u5f52\u5217\u51fa\u5e76\u663e\u793a inode \u4fe1\u606f\uff1a</p> <pre><code>root@dev:~/linux/inode# ls -liR\n--------------------------------------------------------------------------------------\n.:\ntotal 4\n161992 drwxr-xr-x 2 root root 4096 Feb  1 00:08 dir\n  6108 -rw-r--r-- 1 root root    0 Feb  1 00:04 file1\n\n./dir:\ntotal 0\n6247 lrwxrwxrwx 1 root root 8 Feb  1 00:08 slink -&gt; ../file1\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0cdir \u548c file1 \u7684 inode \u7f16\u53f7\u4e0d\u540c\uff0c\u8f6f\u94fe\u63a5\u4e5f\u4e00\u6837\u3002\u521b\u5efa\u8f6f\u94fe\u63a5\u65f6\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u6587\u4ef6\uff0c\u5728\u5143\u6570\u636e\u4e2d\uff0c\u5b83\u6307\u5411\u76ee\u6807\u6587\u4ef6\uff0c\u6bcf\u521b\u5efa\u4e00\u4e2a\u8f6f\u94fe\u63a5\uff0c\u5c31\u4f7f\u7528\u4e00\u4e2a inode\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u770b\u4e0b\u786c\u94fe\u63a5\u3002</p> <p>\u4f7f\u7528 ln \u547d\u4ee4\u5728 dir1 \u4e2d\u521b\u5efa\u786c\u94fe\u63a5\uff1a<code>ln ../file1 hlink1</code></p> <p>\u663e\u793a inode\uff1a</p> <pre><code>root@dev:~/linux/inode# ls -liR\n--------------------------------------------------------------------------------------\n.:\ntotal 4\n161992 drwxr-xr-x 2 root root 4096 Feb  1 00:14 dir\n  6108 -rw-r--r-- 2 root root    0 Feb  1 00:04 file1\n\n./dir:\ntotal 0\n6108 -rw-r--r-- 2 root root 0 Feb  1 00:04 hlink\n6247 lrwxrwxrwx 1 root root 8 Feb  1 00:08 slink -&gt; ../file1\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\"file1\u2033 \u548c \"hlink\"\u7684 inode \u7f16\u53f7\u76f8\u540c\u3002\u4e4b\u6240\u4ee5\u76f8\u540c\u662f\u56e0\u4e3a\uff1a\u786c\u94fe\u63a5\u4e0d\u4f1a\u521b\u5efa\u65b0\u6587\u4ef6\uff0c\u5b83\u53ea\u662f\u4e3a\u76f8\u540c\u7684\u6570\u636e\u63d0\u4f9b\u4e86\u4e00\u4e2a\u65b0\u540d\u79f0\u3002</p> <p>inode \u5de5\u4f5c\u65b9\u5f0f\u51b3\u5b9a\u4e86\u65e0\u6cd5\u5728\u4e0d\u540c\u6587\u4ef6\u7cfb\u7edf\u4e4b\u95f4\u521b\u5efa\u786c\u94fe\u63a5\u3002\u5982\u679c\u5141\u8bb8\u8fd9\u6837\u505a\uff0c\u5c31\u6709\u53ef\u80fd\u51fa\u73b0\u8282\u70b9\u7f16\u53f7\u51b2\u7a81\u7684\u60c5\u51b5\u3002\u800c\u8f6f\u94fe\u63a5\u5219\u53ef\u4ee5\u5728\u4e0d\u540c\u6587\u4ef6\u7cfb\u7edf\u4e4b\u95f4\u521b\u5efa\u3002</p> <p>\u7531\u4e8e\u786c\u94fe\u63a5\u7684 inode \u53f7\u4e0e\u539f\u59cb\u6587\u4ef6\u7684 inode \u53f7\u76f8\u540c\uff0c\u56e0\u6b64\u53ef\u4ee5\u5220\u9664\u539f\u59cb\u6587\u4ef6\uff0c\u4f46\u6570\u636e\u4ecd\u53ef\u901a\u8fc7\u786c\u94fe\u63a5\u4f7f\u7528\uff08\u5982\u4e0a\u793a\u4f8b\uff0c\u5220\u9664\u539f\u59cb\u6587\u4ef6 file1 \u60c5\u51b5\u4e0b\uff0chlink \u4f9d\u65e7\u53ef\u4ee5\u8bbf\u95ee\uff09\u3002</p> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f60\u6240\u505a\u7684\u5c31\u662f\u5220\u9664\u6307\u5411\u8be5 inode \u7f16\u53f7\u7684\u5176\u4e2d\u4e00\u4e2a\u540d\u79f0\u3002\u94fe\u63a5\u5230\u8be5 inode \u7f16\u53f7\u7684\u6570\u636e\u4ecd\u53ef\u4f7f\u7528\uff0c\u76f4\u5230\u4e0e\u4e4b\u76f8\u5173\u7684\u6240\u6709\u540d\u79f0\u90fd\u88ab\u5220\u9664\u3002</p> <p>inode \u4e5f\u662f Linux \u7cfb\u7edf\u65e0\u9700\u91cd\u542f\u5373\u53ef\u66f4\u65b0\u7684\u4e00\u4e2a\u91cd\u8981\u539f\u56e0\u3002</p> <p>\u8fd9\u662f\u56e0\u4e3a\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u5e93\u6587\u4ef6\uff0c\u800c\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u7528\u65b0\u7248\u672c\u66ff\u6362\u8be5\u6587\u4ef6\u3002\u56e0\u6b64\uff0c\u8981\u4e3a\u65b0\u6587\u4ef6\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 inode\u3002\u5df2\u7ecf\u8fd0\u884c\u7684\u8fdb\u7a0b\u5c06\u7ee7\u7eed\u4f7f\u7528\u65e7\u6587\u4ef6\uff0c\u800c\u5bf9\u5b83\u7684\u6bcf\u6b21\u65b0\u8c03\u7528\u90fd\u5c06\u4f7f\u7528\u65b0\u7248\u672c\u3002</p>"},{"location":"chap8/27Inode/#5-inode","title":"5. \u5143\u6570\u636e\u8d85\u8fc7 inode \u5927\u5c0f","text":"<p>\u4e0e\u56fa\u5b9a\u5927\u5c0f\u7684\u6570\u636e\u5757\u4e00\u6837\uff0cinode \u4e5f\u662f\u7edf\u4e00\u7684\u3002\u4f60\u6709\u53ef\u80fd\u62e5\u6709\u4e00\u4e2a\u8d85\u8fc7\u4f60\u7684 inode \u5927\u5c0f\u7684\u6587\u4ef6\u3002</p> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f60\u7684\u539f\u59cb inode \u5fc5\u987b\u6307\u5411\u53e6\u4e00\u4e2a inode\uff0c\u624d\u80fd\u5b8c\u5168\u5305\u542b\u6587\u4ef6\u7684\u5143\u6570\u636e\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684\u95f4\u63a5\u6307\u9488\u3002</p> <p> </p> <p>\u6b64\u5916\uff0c\u78c1\u76d8\u4e0a\u7684 inode \u6570\u91cf\u662f\u9759\u6001\u7684\u3002</p> <p>\u8fd9\u610f\u5473\u7740\uff0c\u5982\u679c\u4f60\u6709\u8db3\u591f\u591a\u7684\u6587\u4ef6\uff0c\u4f60\u53ef\u80fd\u4f1a\u5728\u78c1\u76d8\u7a7a\u95f4\u7528\u5b8c\u4e4b\u524d\u7528\u5b8c inode\u3002\u5982\u679c\u4f60\u7684 inode \u7528\u5b8c\u4e86\uff0c\u5373\u4f7f\u7ed9\u5b9a\u5206\u533a\u4e0a\u8fd8\u6709\u5269\u4f59\u7a7a\u95f4\uff0c\u4e5f\u65e0\u6cd5\u521b\u5efa\u65b0\u6587\u4ef6\u3002</p>"},{"location":"chap8/27Inode/#6-linux-inode","title":"6. Linux \u5e38\u7528 inode \u76f8\u5173\u547d\u4ee4","text":""},{"location":"chap8/27Inode/#61-inode","title":"6.1 \u663e\u793a\u6587\u4ef6\u7cfb\u7edf inode \u4fe1\u606f","text":"<p>\u4f7f\u7528 df -i \u547d\u4ee4\u67e5\u770b\u6709\u5173 inode \u4f7f\u7528\u60c5\u51b5\uff0c\u5305\u62ec\u5b58\u50a8 inode \u7684\u6587\u4ef6\u7cfb\u7edf\u3001\u603b inode \u6570\u91cf\u3001\u4f7f\u7528\u4e2d\u7684\u6570\u91cf\uff08\u6570\u91cf\u548c\u767e\u5206\u6bd4\uff09\u4ee5\u53ca\u5269\u4f59\u6570\u91cf</p> <pre><code>root@dev:~# df -i\n--------------------------------------------------------------------------------------\nFilesystem       Inodes   IUsed    IFree IUse% Mounted on\nudev            2043274     438  2042836    1% /dev\ntmpfs           2047671    1008  2046663    1% /run\n/dev/vda1      12902400 1437018 11465382   12% /\ntmpfs           2047671       1  2047670    1% /dev/shm\ntmpfs           2047671       3  2047668    1% /run/lock\ntmpfs           2047671      18  2047653    1% /sys/fs/cgroup\n/dev/loop0          815     815        0  100% /snap/lxd/24061\n/dev/loop1        12041   12041        0  100% /snap/core20/2105\n/dev/loop3          658     658        0  100% /snap/snapd/20671\n/dev/loop2          658     658        0  100% /snap/snapd/20290\n/dev/loop4        11991   11991        0  100% /snap/core20/2015\n/dev/vda15            0       0        0     - /boot/efi\n</code></pre> <p>\u6216\u8005\uff1a<code>root@dev:~# df -i /dev/vda1</code></p>"},{"location":"chap8/27Inode/#62-inode-stat","title":"6.2 \u663e\u793a\u6307\u5b9a\u6587\u4ef6 inode \u4fe1\u606f stat","text":"<p>\u901a\u8fc7 stat \u547d\u4ee4\u663e\u793a\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u7684 inode \u4fe1\u606f\uff1a</p> <pre><code>root@dev:~# stat domain.txt\n--------------------------------------------------------------------------------------\n  File: domain.txt\n  Size: 30          Blocks: 8          IO Block: 4096   regular file\nDevice: fc01h/64513d    Inode: 6362        Links: 1\nAccess: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)\nAccess: 2024-01-05 01:21:46.196735160 +0800\nModify: 2023-12-29 00:11:28.349067755 +0800\nChange: 2023-12-29 00:11:28.349067755 +0800\n Birth: -\n</code></pre> <ul> <li>Size\uff1a\u6587\u4ef6\u7684\u5b57\u8282\u6570</li> <li>type\uff1a\u6587\u4ef6\u7c7b\u578b\uff0c\u666e\u901a\u6587\u4ef6\uff0c\u76ee\u5f55\uff0c\u7ba1\u9053\u7b49\u7b49</li> <li>Inode\uff1ainode number</li> <li>Links\uff1a\u94fe\u63a5\u6570\uff0c\u94fe\u63a5\u5230\u8be5 inode \u7684\u786c\u94fe\u63a5\u6570</li> <li>Access\uff1a\u8bfb\u3001\u5199\u3001\u6267\u884c\u6743\u9650</li> <li>Uid\uff1a\u6587\u4ef6\u6240\u6709\u8005 User ID</li> <li>Gid\uff1a\u6240\u6709\u8005\u7ec4 Group ID</li> <li>Access\uff1a\u65f6\u95f4\u6233\uff0c\u6700\u8fd1\u4e00\u6b21\u8bbf\u95ee\u7684\u65f6\u95f4</li> <li>Modify\uff1a\u65f6\u95f4\u6233\uff0c\u6700\u8fd1\u4e00\u6b21\u4fee\u6539\u6587\u4ef6\u5185\u5bb9\u7684\u65f6\u95f4</li> <li>Change\uff1a\u65f6\u95f4\u6233\uff0c\u6700\u8fd1\u4e00\u6b21\u66f4\u6539\u6587\u4ef6\u7684\u65f6\u95f4\uff08\u5982\u6267\u884c chmod\u3001chown \u7b49\u547d\u4ee4\uff09</li> </ul> <p>\u53ea\u5217\u51fa\u6587\u4ef6 inode number:</p> <pre><code>root@dev:~# stat --format=%i domain.txt\n--------------------------------------------------------------------------------------\n6362\n</code></pre>"},{"location":"chap8/27Inode/#63-inode-number","title":"6.3 \u663e\u793a\u6587\u4ef6 inode number","text":"<p>ls \u547d\u4ee4\u7528\u4e8e\u5217\u51fa\u76ee\u5f55\u7684\u5185\u5bb9\uff0c\u914d\u5408 -i \u53c2\u6570\u53ef\u7528\u4e8e\u663e\u793a\u6bcf\u4e2a\u6587\u4ef6\u7684 inode number\uff1a</p> <pre><code>root@dev:~# ls -i\n--------------------------------------------------------------------------------------\n   2710 README.md     \n</code></pre> <p>\u4f7f\u7528 -i num \u67e5\u627e\u4e0e\u7279\u5b9a inode \u76f8\u5173\u7684\u6587\u4ef6</p> <pre><code>\nroot@dev:~/linux/test# find ./ -inum 2547\n--------------------------------------------------------------------------------------\n./test.txt\n</code></pre>"},{"location":"chap8/27Inode/#64-inode","title":"6.4 \u67e5\u770b\u6bcf\u4e2ainode\u8282\u70b9\u7684\u5927\u5c0f","text":"<pre><code>root@dev:~/linux/test# dumpe2fs -h /dev/vda1 | grep -i \"inode size\"\n--------------------------------------------------------------------------------------\ndumpe2fs 1.45.5 (07-Jan-2020)\nInode size:           256\n</code></pre>"},{"location":"chap8/27Inode/#7-linux-inode","title":"7 \u5982\u4f55\u91ca\u653eLinux inode\uff1f","text":""},{"location":"chap8/27Inode/#71-inode","title":"7.1. \u4e3a\u4ec0\u4e48\u8981\u9650\u5236 inode\uff1f","text":"<p>\u6bcf\u4e2a inode \u5305\u542b\u6587\u4ef6\u7684\u5173\u952e\u4fe1\u606f\uff0c\u5982\u6587\u4ef6\u5927\u5c0f\u3001\u8bbf\u95ee\u6743\u9650\u4ee5\u53ca\u6240\u5b58\u50a8\u78c1\u76d8\u5757\u7684\u4f4d\u7f6e\u7b49\u3002\u8fd9\u4e9b\u6570\u636e\u662f\u7cfb\u7edf\u4f7f\u7528\u6587\u4ef6\u7684\u5fc5\u8981\u6761\u4ef6\u3002\u5728 ext\uff08ext\u3001ext2\u3001ext3\u3001ext4\uff09\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0cinode \u4fdd\u5b58\u5728\u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684\u8868\u4e2d\u3002\u8be5\u8868\u7684\u5927\u5c0f\u5728\u521b\u5efa\u5206\u533a\u65f6\u5c31\u5df2\u51b3\u5b9a\uff0c\u4ee5\u540e\u65e0\u6cd5\u66f4\u6539\u3002</p> <p>\u5176\u4ed6\u6587\u4ef6\u7cfb\u7edf\uff08\u4f8b\u5982 macOS \u4e0a\u4f7f\u7528\u7684 APFS\uff09\u4e0d\u4f7f\u7528\u56fa\u5b9a\u5927\u5c0f\u7684\u8868\uff0c\u800c\u662f\u4f7f\u7528 B-trees \u7b49\u5176\u4ed6\u6570\u636e\u7ed3\u6784\u3002\u56e0\u6b64\uff0cinode \u6570\u91cf\u8981\u7075\u6d3b\u5f97\u591a\u3002</p>"},{"location":"chap8/27Inode/#72-inode","title":"7.2 \u8bbe\u7f6e inode \u9650\u5236","text":"<p>inode \u9650\u5236\u662f\u5728\u521b\u5efa\u5206\u533a\u65f6\u8bbe\u7f6e\u7684\u3002</p> <p>\u9ed8\u8ba4\u7cfb\u7edf\u63d0\u4f9b\u5408\u7406\u7684\u914d\u7f6e\u53c2\u6570\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u62c5\u5fc3\u8fd9\u4e2a\u95ee\u9898\u3002\u4e0d\u8fc7\uff0c\u5982\u679c\u6211\u4eec\u77e5\u9053\u7cfb\u7edf\u5c06\u5b58\u50a8\u5927\u91cf\u7684\u5c0f\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u8986\u76d6\u8fd9\u4e9b\u9ed8\u8ba4\u503c\uff0c\u8bbe\u7f6e\u5408\u7406\u7684 inode \u6570\u91cf\u3002</p> <p>\u4f8b\u5982\uff0c\u9884\u8ba1\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6\u5e73\u5747\u5927\u5c0f\u53ea\u6709 1 kB\u3002\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a ext4 \u5206\u533a\uff0c\u6bcf 1000 \u5b57\u8282\u4e3a\u4e00\u4e2a inode\uff1a</p> <pre><code>$ sudo mkfs.ext4 -i 1000 /dev/sdev\n</code></pre> <p>\u6216\u8005\uff0c\u4e5f\u53ef\u4ee5\u9009\u62e9\u5176\u4ed6\u6587\u4ef6\u7cfb\u7edf\uff0c\u6bd4\u5982 Btrfs\uff0c\u5b83\u5c31\u4e0d\u4f1a\u6709\u9650\u5236 inode \u7684\u95ee\u9898\u3002</p>"},{"location":"chap8/27Inode/#73-inode","title":"7.3 \u68c0\u67e5\u5e76\u91ca\u653e inode","text":"<p>\u53ef\u4ee5\u4f7f\u7528 df \u547d\u4ee4\u68c0\u67e5\u53ef\u7528\u7684 inode\uff1a</p> <pre><code>root@dev:~/linux/dir1# df -i\n------------------------------------------------------------------------------------\nFilesystem       Inodes   IUsed    IFree IUse% Mounted on\nudev            2043274     438  2042836    1% /dev\ntmpfs           2047671    1008  2046663    1% /run\n/dev/vda1      12902400 1437038 11465362   12% /\ntmpfs           2047671       1  2047670    1% /dev/shm\n</code></pre> <p>\"IUsed\" \u5217\u663e\u793a\u5df2\u4f7f\u7528\u7684 inode \u6570\u91cf\uff0c\"IFree\" \u5217\u663e\u793a\u7a7a\u95f2 inode \u6570\u91cf\uff0c\"IUse%\" \u5217\u663e\u793a\u5df2\u4f7f\u7528 inode \u7684\u767e\u5206\u6bd4\u3002</p> <p>\u9664\u4e86\u5220\u9664\u6211\u4eec\u4e0d\u9700\u8981\u7684\u6587\u4ef6\u5916\uff0c\u76ee\u524d\u6ca1\u6709\u5176\u4ed6\u529e\u6cd5\u91ca\u653e inode\u3002\u95ee\u9898\u662f\uff0c\u6211\u4eec\u6709\u65f6\u53ef\u80fd\u4e0d\u77e5\u9053\u8be5\u53bb\u54ea\u91cc\u627e\u8017\u5c3d inode \u9650\u5236\u7684\u6587\u4ef6\u3002</p> <p>\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u65b9\u6cd5\u662f\u6839\u636e\u76ee\u5f55\u4e2d\u6587\u4ef6\u7684\u6570\u91cf\u8fdb\u884c\u6392\u5e8f\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u627e\u5230\u6709\u95ee\u9898\u7684\u76ee\u5f55\u3002</p> <p>\u5982\uff0c\u5217\u51fa\u6240\u6709\u6587\u4ef6\uff1a</p> <pre><code>sudo find . -xdev -type f | cut -d \"/\" -f 2 | sort | uniq -c | sort -n\n...\n1585 Documents\n6979 Downloads\n7168 Pictures\n113659 .nvm\n669666 Library\n980996 Projects\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\"Projects\" \u76ee\u5f55\u4e2d\u5b58\u50a8\u7684\u6587\u4ef6\u6570\u91cf\u6700\u591a\u3002\u6b64\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u5224\u65ad\u6587\u4ef6\u91cd\u8981\u6027\u91c7\u53d6\u4e00\u4e9b\u63aa\u65bd\uff0c\u5982\uff1a\u5220\u9664\u6587\u4ef6\u6216\u5c06\u8be5\u76ee\u5f55\u79fb\u52a8\u5230\u5176\u4ed6\u7a7a\u95f2 inode \u7684\u5b58\u50a8\u9a71\u52a8\u5668\u3002</p> <p>\u5e38\u7528\u6e05\u7406\u547d\u4ee4\uff1a</p> <p>(1)\u3001\u67e5\u770b\u5e76\u5220\u9664\u4e34\u65f6\u6587\u4ef6\uff1a</p> <p>\u793a\u4f8b\u547d\u4ee4\uff1a</p> <pre><code>ls -lt /tmp | wc -l\nfind /tmp -type f -exec rm {} \\;\n</code></pre> <p>(2)\u3001\u5220\u96640\u5b57\u8282\u7684\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4e5f\u4f1a\u5360\u7528inode\uff1a</p> <p>\u793a\u4f8b\u547d\u4ee4\uff1a</p> <pre><code>find /home -type f -size 0 -exec rm {} \\;\n</code></pre> <p>(3)\u3001\u6216\u8005\u5c06\u76ee\u5f55\u6587\u6863\u5f52\u6863\uff0c\u7136\u540e\u5220\u9664\u6587\u4ef6\uff1a</p> <p>\u793a\u4f8b\u547d\u4ee4\uff1a</p> <pre><code>tar czvf /linux/backup.tar.gz /home/test\nrm /home/test\n</code></pre>"},{"location":"chap8/28vim/","title":"Vim \u6280\u5de7","text":""},{"location":"chap8/28vim/#1-","title":"1. \u5feb\u901f\u79fb\u52a8 - \u544a\u522b\u9010\u884c\u6572\u51fb","text":"<p>\u5f88\u591a\u4eba\u7528Vim\u65f6\u4e60\u60ef\u7528j\u3001k\u4e00\u884c\u884c\u79fb\u52a8\uff0c\u975e\u5e38\u4f4e\u6548\u3002\u8fd9\u4e9b\u79fb\u52a8\u547d\u4ee4\u53ef\u4ee5\u5e2e\u4f60\u5feb\u901f\u5b9a\u4f4d\uff1a</p> <pre><code>gg               # \u8df3\u8f6c\u5230\u6587\u4ef6\u5f00\u5934\nG                # \u8df3\u8f6c\u5230\u6587\u4ef6\u672b\u5c3e\n:\u884c\u53f7            # \u8df3\u8f6c\u5230\u6307\u5b9a\u884c\nw                # \u5411\u524d\u8df3\u8f6c\u4e00\u4e2a\u5355\u8bcd\nb                # \u5411\u540e\u8df3\u8f6c\u4e00\u4e2a\u5355\u8bcd\n0                # \u8df3\u8f6c\u5230\u884c\u9996\n$                # \u8df3\u8f6c\u5230\u884c\u5c3e\n</code></pre>"},{"location":"chap8/28vim/#2-","title":"2. \u641c\u7d22\u4e0e\u66ff\u6362 - \u4e00\u952e\u5b9a\u4f4d\u4fee\u6539","text":"<pre><code>/keyword         # \u5411\u4e0b\u641c\u7d22\u5173\u952e\u8bcd\n?keyword         # \u5411\u4e0a\u641c\u7d22\u5173\u952e\u8bcd\nn                # \u7ee7\u7eed\u67e5\u627e\u4e0b\u4e00\u4e2a\nN                # \u67e5\u627e\u4e0a\u4e00\u4e2a\n:%s/old/new/g    # \u5168\u6587\u66ff\u6362\u6240\u6709\u5339\u914d\n:s/old/new/g     # \u5f53\u524d\u884c\u66ff\u6362\u6240\u6709\u5339\u914d\n</code></pre>"},{"location":"chap8/28vim/#3-","title":"3. \u590d\u5236\u7c98\u8d34 - \u9ad8\u6548\u6587\u672c\u5904\u7406","text":"<p>\u4e0d\u53ea\u662f\u7b80\u5355\u7684yy\u548cp\uff0c\u8fd9\u4e9b\u6280\u5de7\u8ba9\u590d\u5236\u7c98\u8d34\u66f4\u9ad8\u6548\uff1a</p> <pre><code>yy               # \u590d\u5236\u5f53\u524d\u884c\ny$               # \u590d\u5236\u5230\u884c\u5c3e\nyw               # \u590d\u5236\u4e00\u4e2a\u5355\u8bcd\ndd               # \u526a\u5207\u5f53\u524d\u884c\np                # \u5728\u5149\u6807\u540e\u7c98\u8d34\nP                # \u5728\u5149\u6807\u524d\u7c98\u8d34\n\"+y              # \u590d\u5236\u5230\u7cfb\u7edf\u526a\u8d34\u677f\n</code></pre>"},{"location":"chap8/28vim/#4-","title":"4. \u5feb\u901f\u7f16\u8f91 - \u4e00\u952e\u5b8c\u6210\u5e38\u89c1\u64cd\u4f5c","text":"<p>\u8fd9\u4e9b\u547d\u4ee4\u53ef\u4ee5\u8ba9\u4f60\u4e00\u6b65\u5b8c\u6210\u5e38\u89c1\u7684\u7f16\u8f91\u64cd\u4f5c\uff1a</p> <pre><code>x                # \u5220\u9664\u5f53\u524d\u5b57\u7b26\nr                # \u66ff\u6362\u5f53\u524d\u5b57\u7b26\ncw               # \u4fee\u6539\u5f53\u524d\u5355\u8bcd\ncc               # \u4fee\u6539\u6574\u884c\no                # \u5728\u4e0b\u65b9\u63d2\u5165\u65b0\u884c\nO                # \u5728\u4e0a\u65b9\u63d2\u5165\u65b0\u884c\nu                # \u64a4\u9500\nCtrl+r           # \u91cd\u505a\n</code></pre>"},{"location":"chap8/28vim/#5-","title":"5. \u91cd\u590d\u64cd\u4f5c - \u544a\u522b\u91cd\u590d\u52b3\u52a8","text":"<pre><code>.                # \u91cd\u590d\u4e0a\u4e00\u6b21\u7f16\u8f91\u64cd\u4f5c\n\u6570\u5b57+\u547d\u4ee4         # \u91cd\u590d\u6267\u884c\u547d\u4ee4\uff0c\u59825dd\u5220\u96645\u884c\nqa...q           # \u8bb0\u5f55\u5b8f\u5230\u5bc4\u5b58\u5668a\n@a               # \u6267\u884c\u5bc4\u5b58\u5668a\u4e2d\u7684\u5b8f\n@@               # \u91cd\u590d\u4e0a\u6b21\u6267\u884c\u7684\u5b8f\n</code></pre>"},{"location":"chap8/28vim/#6-","title":"6 \u5206\u5c4f\u64cd\u4f5c - \u591a\u4efb\u52a1\u5904\u7406","text":"<p>\u540c\u65f6\u67e5\u770b\u6216\u7f16\u8f91\u591a\u4e2a\u6587\u4ef6\uff0c\u5927\u5927\u63d0\u9ad8\u5de5\u4f5c\u6548\u7387\uff1a</p> <pre><code>:sp \u6587\u4ef6\u540d        # \u6c34\u5e73\u5206\u5272\u7a97\u53e3\n:vsp \u6587\u4ef6\u540d       # \u5782\u76f4\u5206\u5272\u7a97\u53e3\nCtrl+w h/j/k/l   # \u5728\u7a97\u53e3\u95f4\u79fb\u52a8\u5149\u6807\nCtrl+w =         # \u5747\u5206\u7a97\u53e3\u5927\u5c0f\nCtrl+w _         # \u6700\u5927\u5316\u5f53\u524d\u7a97\u53e3\u9ad8\u5ea6\nCtrl+w |         # \u6700\u5927\u5316\u5f53\u524d\u7a97\u53e3\u5bbd\u5ea6\n</code></pre>"},{"location":"chap8/28vim/#7-","title":"7. \u4ee3\u7801\u7f29\u8fdb - \u683c\u5f0f\u5316\u6587\u672c","text":"<p>\u5feb\u901f\u8c03\u6574\u4ee3\u7801\u7f29\u8fdb\uff0c\u8ba9\u683c\u5f0f\u6574\u9f50\u7f8e\u89c2\uff1a</p> <pre><code>\n&gt;&gt;               # \u5411\u53f3\u7f29\u8fdb\u5f53\u524d\u884c\n&lt;&lt;               # \u5411\u5de6\u7f29\u8fdb\u5f53\u524d\u884c\n&gt;G               # \u4ece\u5f53\u524d\u884c\u5230\u6587\u4ef6\u672b\u5c3e\u90fd\u5411\u53f3\u7f29\u8fdb\n=G               # \u4ece\u5f53\u524d\u884c\u5230\u6587\u4ef6\u672b\u5c3e\u81ea\u52a8\u7f29\u8fdb\ngg=G             # \u81ea\u52a8\u7f29\u8fdb\u6574\u4e2a\u6587\u4ef6\n</code></pre>"},{"location":"chap8/28vim/#8-","title":"8. \u53ef\u89c6\u5316\u9009\u62e9 - \u76f4\u89c2\u64cd\u4f5c","text":"<p>\u4e0d\u7528\u6570\u884c\u6570\uff0c\u76f4\u63a5\u770b\u7740\u9009\u5c31\u5b8c\u4e8b\u4e86\uff1a</p> <pre><code>v                # \u5b57\u7b26\u9009\u62e9\u6a21\u5f0f\nV                # \u884c\u9009\u62e9\u6a21\u5f0f\nCtrl+v           # \u5757\u9009\u62e9\u6a21\u5f0f\uff08\u53ef\u9009\u62e9\u77e9\u5f62\u533a\u57df\uff09\ngv               # \u91cd\u65b0\u9009\u62e9\u4e0a\u6b21\u7684\u533a\u57df\n</code></pre>"},{"location":"chap8/28vim/#9-","title":"9. \u81ea\u52a8\u8865\u5168 - \u63d0\u9ad8\u8f93\u5165\u901f\u5ea6","text":"<p>\u4e3a\u4ec0\u4e48\u8981\u628a\u6bcf\u4e2a\u5355\u8bcd\u90fd\u6572\u5b8c\uff1f\u4f7f\u7528\u81ea\u52a8\u8865\u5168\uff1a</p> <pre><code>Ctrl+n           # \u5411\u540e\u67e5\u627e\u5e76\u81ea\u52a8\u8865\u5168\nCtrl+p           # \u5411\u524d\u67e5\u627e\u5e76\u81ea\u52a8\u8865\u5168\nCtrl+x Ctrl+f    # \u6587\u4ef6\u540d\u8865\u5168\nCtrl+x Ctrl+l    # \u6574\u884c\u8865\u5168\n</code></pre>"},{"location":"chap8/28vim/#10-","title":"10. \u4fdd\u5b58\u9000\u51fa - \u9ad8\u6548\u7684\u6587\u4ef6\u64cd\u4f5c","text":"<pre><code>:w               # \u4fdd\u5b58\n:w \u6587\u4ef6\u540d         # \u53e6\u5b58\u4e3a\n:wa              # \u4fdd\u5b58\u6240\u6709\u6253\u5f00\u7684\u6587\u4ef6\n:wq              # \u4fdd\u5b58\u5e76\u9000\u51fa\n:x               # \u4fdd\u5b58\u5e76\u9000\u51fa\uff08\u5982\u6709\u4fee\u6539\u624d\u5199\u5165\uff09\nZZ               # \u5feb\u6377\u952e\uff0c\u76f8\u5f53\u4e8e:x\n</code></pre>"},{"location":"chap8/28vim/#vim_1","title":"Vim \u8df3\u8f6c\u6280\u5de7","text":""},{"location":"chap8/28vim/#_1","title":"\u8df3\u8f6c","text":"<ul> <li>\u57fa\u672c\u8df3\u8f6c</li> </ul> <pre><code>:n\n</code></pre> <pre><code>-5\n</code></pre> <p>\u6700\u57fa\u672c\u7684\u8df3\u8f6c\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528:n\u547d\u4ee4\uff0c\u5176\u4e2dn\u662f\u8981\u8df3\u8f6c\u5230\u7684\u884c\u53f7\u3002\u4f8b\u5982\uff0c\u8981\u8df3\u8f6c\u5230\u7b2c20\u884c\uff0c\u53ef\u4ee5\u5728\u547d\u4ee4\u6a21\u5f0f\u4e0b\u8f93\u5165<code>:20</code>\uff0c\u7136\u540e\u6309\u4e0b\u56de\u8f66\u952e\u5373\u53ef</p> <ul> <li>\u76f8\u5bf9\u8df3\u8f6c </li> </ul> <pre><code>:[num]\n</code></pre> <pre><code>+5\n</code></pre> <p>\u76f8\u5bf9\u8df3\u8f6c\u7528\u4e8e\u5728\u5f53\u524d\u884c\u7684\u57fa\u7840\u4e0a\u5411\u4e0a\u6216\u5411\u4e0b\u8df3\u8f6c\u4e00\u5b9a\u7684\u884c\u6570\u3002\u53ef\u4ee5\u5728\u547d\u4ee4\u6a21\u5f0f\u4e0b\u8f93\u5165:num\u547d\u4ee4\uff0c\u5176\u4e2dnum\u53ef\u4ee5\u662f\u6b63\u6570\u3001\u8d1f\u6570\u3002\u4f8b\u5982\uff0c\u8981\u5411\u4e0a\u8df3\u8f6c5\u884c\uff0c\u53ef\u4ee5\u5728\u547d\u4ee4\u6a21\u5f0f\u4e0b\u8f93\u5165:+5\uff0c\u7136\u540e\u6309\u4e0b\u56de\u8f66\u952e\u5373\u53ef\u3002\u540c\u6837\uff0c\u8981\u5411\u4e0b\u8df3\u8f6c5\u884c\uff0c\u5219\u53ef\u4ee5\u8f93\u51655\u3002</p> <ul> <li>\u6807\u7b7e\u8df3\u8f6c</li> </ul> <pre><code>ma\n</code></pre> <p>\u6807\u7b7e\u8df3\u8f6c\u662fvim\u4e2d\u6bd4\u8f83\u9ad8\u7ea7\u7684\u8df3\u8f6c\u65b9\u5f0f\uff0c\u9700\u8981\u4e8b\u5148\u8bbe\u7f6e\u6807\u7b7e\u3002\u53ef\u4ee5\u5728\u4efb\u610f\u4e00\u4e2a\u4f4d\u7f6e\u4f7f\u7528m\u52a0\u4e00\u4e2a\u5c0f\u5199\u5b57\u6bcd\u6765\u8bbe\u7f6e\u4e00\u4e2a\u6807\u7b7e\u3002\u4f8b\u5982\uff0c\u5728\u547d\u4ee4\u6a21\u5f0f\u4e0b\u8f93\u5165:ma\uff0c\u5176\u4e2da\u662f\u6807\u7b7e\u540d\u79f0\u3002\u8bbe\u7f6e\u6807\u7b7e\u4e4b\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528`a\u547d\u4ee4\u8df3\u8f6c\u5230\u8be5\u6807\u7b7e\u6240\u5728\u7684\u4f4d\u7f6e\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6807\u7b7e\u540d\u79f0\u53ea\u80fd\u4f7f\u7528\u5c0f\u5199\u5b57\u6bcd\uff0c\u800c\u4e14\u8981\u4fdd\u8bc1\u4e0d\u4e0evim\u7684\u547d\u4ee4\u91cd\u540d\u3002</p> <ul> <li>\u641c\u7d22\u8df3\u8f6c</li> </ul> <pre><code>/[word]\n</code></pre> <p>\u53ef\u4ee5\u5728\u547d\u4ee4\u6a21\u5f0f\u4e0b\u8f93\u5165/[word]\u547d\u4ee4\uff0c\u5176\u4e2d[word]\u662f\u8981\u641c\u7d22\u7684\u5355\u8bcd\u6216\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u6309\u4e0b\u56de\u8f66\u952e\u5373\u53ef\u3002    </p> <p>\u5982\u679c\u627e\u5230\u4e86\u5339\u914d\u7684\u5355\u8bcd\u6216\u5b57\u7b26\u4e32\uff0cvim\u4f1a\u8df3\u8f6c\u5230\u5176\u7b2c\u4e00\u4e2a\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002\u6b64\u5916\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528n\u547d\u4ee4\u5728\u5f53\u524d\u884c\u7684\u4e0b\u4e00\u884c\u7ee7\u7eed\u641c\u7d22\u5339\u914d\u7684\u5355\u8bcd\u6216\u5b57\u7b26\u4e32\u3002</p> <ul> <li>\u6587\u4ef6\u5185\u8df3\u8f6c</li> </ul> <pre><code>gf\n</code></pre> <p>\u53ef\u4ee5\u4f7f\u7528gf\u547d\u4ee4\u8df3\u8f6c\u5230\u5149\u6807\u4e0b\u7684\u5355\u8bcd\u6240\u5bf9\u5e94\u7684\u6587\u4ef6\u6216\u8def\u5f84\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8be5\u6587\u4ef6\u6216\u8def\u5f84\u5fc5\u987b\u5b58\u5728\u4e8e\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u5e76\u4e14\u8981\u4fdd\u8bc1vim\u53ef\u4ee5\u8bbf\u95ee\u5230\u3002\u8fd4\u56de\u5219\u662fCtrl+6\u3002</p> <ul> <li>\u5feb\u901f\u8df3\u8f6c</li> </ul> <pre><code>Ctrl+]\u6216gd\n</code></pre> <p>\u53ef\u4ee5\u5feb\u901f\u8df3\u8f6c\u5230\u5149\u6807\u4e0b\u7684\u5355\u8bcd\u6240\u5bf9\u5e94\u7684\u5b9a\u4e49\u6216\u58f0\u660e\u5904\u3002\u53ef\u4ee5\u4f7f\u7528Ctrl+]\u6216gd\u5feb\u6377\u952e\u6765\u8fdb\u884c\u5feb\u901f\u8df3\u8f6c\u3002</p> <ul> <li>\u5206\u5c4f\u8df3\u8f6c</li> </ul> <pre><code>Ctrl+w + h/j/k/l\n</code></pre> <p>\u5206\u5c4f\u8df3\u8f6c\u662fvim\u4e2d\u6700\u7075\u6d3b\u7684\u4e00\u4e2a\u8df3\u8f6c\u65b9\u5f0f\u4e4b\u4e00\uff0c\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u5c4f\u5e55\u4e4b\u95f4\u81ea\u7531\u8df3\u8f6c\u3002\u53ef\u4ee5\u4f7f\u7528<code>Ctrl+w+h/j/k/l</code>\u5feb\u6377\u952e\u6765\u8fdb\u884c\u5206\u5c4f\u8df3\u8f6c\u3002\u5176\u4e2dCtrl+w\u662fvim\u4e2d\u7684\u5206\u5c4f\u547d\u4ee4\u524d\u7f00\uff0ch/j/k/l\u5206\u522b\u4ee3\u8868\u5411\u5de6/\u4e0b/\u4e0a/\u53f3\u8df3\u8f6c\u3002</p>"},{"location":"chap8/29awk/","title":"Linux AWK \u6587\u672c\u5904\u7406","text":""},{"location":"chap8/29awk/#8","title":"8\u4e2a\u7ecf\u5178\u6848\u4f8b","text":""},{"location":"chap8/29awk/#nginx","title":"\u6848\u4f8b\u4e00\uff1a\u5206\u6790Nginx\u8bbf\u95ee\u65e5\u5fd7","text":"<pre><code>\u7edf\u8ba1\u8bbf\u95eeIP\u6b21\u6570\uff1a\nawk '{a[$1]++}END{for(v in a)print v,a[v]}' access.log\n\n\u7edf\u8ba1\u8bbf\u95eeIP\u6b21\u6570\uff1a\nawk '{a[$1]++}END{for(v in a)print v,a[v]}' access.log\n\n\u7edf\u8ba1\u8bbf\u95ee\u8bbf\u95ee\u5927\u4e8e100\u6b21\u7684IP\uff1a\nawk '{a[$1]++}END{for(v in a){if(a[v]&gt;100)print v,a[v]}}' access.log\n\n\u7edf\u8ba1\u8bbf\u95eeIP\u6b21\u6570\u5e76\u6392\u5e8f\u53d6\u524d10\uff1a\nawk '{a[$1]++}END{for(v in a)print v,a[v]|\"sort -k2 -nr |head -10\"}' access.log\n\n\u7edf\u8ba1\u65f6\u95f4\u6bb5\u8bbf\u95ee\u6700\u591a\u7684IP\uff1a\nawk '$4&gt;=\"[02/Jan/2017:00:02:00\" &amp;&amp; $4&lt;=\"[02/Jan/2017:00:03:00\"{a[$1]++}END{for(v in a)print v,a[v]}' access.log\n\n\u7edf\u8ba1\u4e0a\u4e00\u5206\u949f\u8bbf\u95ee\u91cf\uff1a\ndate=$(date -d '-1 minute' +%d/%d/%Y:%H:%M)\nawk -vdate=$date '$4~date{c++}END{print c}' access.log\n\n\u7edf\u8ba1\u8bbf\u95ee\u6700\u591a\u768410\u4e2a\u9875\u9762\uff1a\nawk '{a[$7]++}END{for(v in a)print v,a[v]|\"sort -k1 -nr|head -n10\"}' access.log\n\n\u7edf\u8ba1\u6bcf\u4e2aURL\u6570\u91cf\u548c\u8fd4\u56de\u5185\u5bb9\u603b\u5927\u5c0f:\nawk '{a[$7]++;size[$7]+=$10}END{for(v in a)print a[v],v,size[v]}' access.log\n\n\u7edf\u8ba1\u6bcf\u4e2aIP\u8bbf\u95ee\u72b6\u6001\u7801\u6570\u91cf\uff1a\nawk '{a[$1\" \"$9]++}END{for(v in a)print v,a[v]}' access.log\n\n\u7edf\u8ba1\u8bbf\u95eeIP\u662f404\u72b6\u6001\u6b21\u6570\uff1a\nawk '{if($9~/404/)a[$1\" \"$9]++}END{for(i in a)print v,a[v]}' access.log\n</code></pre>"},{"location":"chap8/29awk/#_1","title":"\u6848\u4f8b\u4e8c\uff1a\u4e24\u4e2a\u6587\u4ef6\u5dee\u5f02\u5bf9\u6bd4","text":"<p>\u751f\u6210a\u548cb\u4e24\u4e2a\u6587\u4ef6\uff0c\u7528\u4e8e\u6d4b\u8bd5\uff1a</p> <pre><code>$ seq 1 5 &gt; a\n$ seq 3 7 &gt; b\n</code></pre> <p>\u627e\u51fab\u6587\u4ef6\u5728a\u6587\u4ef6\u76f8\u540c\u8bb0\u5f55\uff1a</p> <pre><code>\u65b9\u6cd51\uff1a\nawk 'FNR==NR{a[$0];next}{if($0 in a)print $0}' a b\n3\n4\n5\nawk 'FNR==NR{a[$0];next}{if($0 in a)print FILENAME,$0}' a b\nb 3\nb 4\nb 5\nawk 'FNR==NR{a[$0]}NR&gt;FNR{if($0 ina)print $0}' a b\n3\n4\n5\nawk 'FNR==NR{a[$0]=1;next}(a[$0]==1)' a b  # a[$0]\u662f\u901a\u8fc7b\u6587\u4ef6\u6bcf\u884c\u83b7\u53d6\u503c\uff0c\u5982\u679c\u662f1\u8bf4\u660e\u6709\nawk 'FNR==NR{a[$0]=1;next}{if(a[$0]==1)print}' a b\n3\n4\n5\n\n\u65b9\u6cd52\uff1a\nawk 'FILENAME==\"a\"{a[$0]}FILENAME==\"b\"{if($0 in a)print $0}' a b\n3\n4\n5\n4\n5\n\n\u65b9\u6cd53\uff1a\nawk 'ARGIND==1{a[$0]=1}ARGIND==2 &amp;&amp; a[$0]==1' a b\n3\n4\n5\n</code></pre> <p>\u627e\u51fab\u6587\u4ef6\u5728a\u6587\u4ef6\u4e0d\u540c\u8bb0\u5f55\uff1a</p> <pre><code>\u65b9\u6cd51\uff1a\nawk 'FNR==NR{a[$0];next}!($0 in a)' a b\n6\n7\nawk 'FNR==NR{a[$0]=1;next}(a[$0]!=1)' a b\n\u6216\nawk 'FNR==NR{a[$0]=1;next}{if(a[$0]!=1)print}' a b\n6\n7\n\n\u65b9\u6cd52\uff1a\nawk 'FILENAME==\"a\"{a[$0]=1}FILENAME==\"b\" &amp;&amp; a[$0]!=1' a b\n\n\u65b9\u6cd53\uff1a\nawk 'ARGIND==1{a[$0]=1}ARGIND==2 &amp;&amp; a[$0]!=1' a b\n</code></pre>"},{"location":"chap8/29awk/#_2","title":"\u6848\u4f8b\u4e09\uff1a\u5408\u5e76\u4e24\u4e2a\u6587\u4ef6","text":"<p>\u751f\u6210a\u548cb\u4e24\u4e2a\u6587\u4ef6\uff0c\u7528\u4e8e\u6d4b\u8bd5\uff1a</p> <pre><code>$ cat a\nzhangsan 20\nlisi 23\nwangwu 29\n$ cat b\nzhangsan man\nlisi woman\nwangwu ma\n</code></pre> <p>\u5c06a\u6587\u4ef6\u5408\u5e76\u5230b\u6587\u4ef6\uff1a</p> <pre><code>\u65b9\u6cd51\uff1a\nawk 'FNR==NR{a[$1]=$0;next}{print a[$1],$2}' a b\nzhangsan 20 man\nlisi 23 woman\nwangwu 29 man\n\u65b9\u6cd52\uff1a\n\nawk 'FNR==NR{a[$1]=$0}NR&gt;FNR{print a[$1],$2}' a b\nzhangsan 20 man\nlisi 23 woman\nwangwu 29 man\n</code></pre> <p>\u5c06a\u6587\u4ef6\u76f8\u540cIP\u7684\u670d\u52a1\u540d\u5408\u5e76\uff1a</p> <pre><code>$ cat a\n192.168.1.1: httpd\n192.168.1.1: tomcat\n192.168.1.2: httpd\n192.168.1.2: postfix\n192.168.1.3: mysqld\n192.168.1.4: httpd\n\nawk 'BEGIN{FS=\":\";OFS=\":\"}{a[$1]=a[$1] $2}END{for(v in a)print v,a[v]}' a\n192.168.1.4: httpd\n192.168.1.1: httpd tomcat\n192.168.1.2: httpd postfix\n192.168.1.3: mysql\n</code></pre> <p>\u89e3\u8bfb\uff1a</p> <p>\u6570\u7ec4a\u5b58\u50a8\u662f$1=a[$1] $2\uff0c\u7b2c\u4e00\u4e2aa[$1]\u662f\u4ee5\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u4e3a\u4e0b\u6807\uff0c\u503c\u662fa[$1] $2\uff0c\u4e5f\u5c31\u662f$1=a[$1] $2\uff0c\u503c\u7684a[$1]\u662f\u7528\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u4e3a\u4e0b\u6807\u83b7\u53d6\u5bf9\u5e94\u7684\u503c\uff0c\u4f46\u7b2c\u4e00\u6b21\u6570\u7ec4a\u8fd8\u6ca1\u6709\u5143\u7d20\uff0c\u90a3\u4e48a[$1]\u662f\u7a7a\u503c\uff0c\u6b64\u65f6\u6570\u7ec4\u5b58\u50a8\u662f192.168.1.1=httpd\uff0c\u518d\u9047\u5230192.168.1.1\u65f6\uff0ca[$1]\u901a\u8fc7\u7b2c\u4e00\u5b57\u6bb5\u4e0b\u6807\u83b7\u5f97\u4e0a\u6b21\u6570\u7ec4\u7684httpd\uff0c\u628a\u5f53\u524d\u5904\u7406\u7684\u884c\u7b2c\u4e8c\u4e2a\u5b57\u6bb5\u653e\u5230\u4e0a\u4e00\u6b21\u540c\u4e0b\u6807\u7684\u503c\u540e\u9762\uff0c\u4f5c\u4e3a\u4e0b\u6807192.168.1.1\u7684\u65b0\u503c\u3002\u6b64\u65f6\u6570\u7ec4\u5b58\u50a8\u662f192.168.1.1=httpd tomcat\u3002\u6bcf\u6b21\u9047\u5230\u76f8\u540c\u7684\u4e0b\u6807\uff08\u7b2c\u4e00\u4e2a\u5b57\u6bb5\uff09\u5c31\u4f1a\u83b7\u53d6\u4e0a\u6b21\u8fd9\u4e2a\u4e0b\u6807\u5bf9\u5e94\u7684\u503c\u4e0e\u5f53\u524d\u5b57\u6bb5\u5e76\u4f5c\u4e3a\u6b64\u4e0b\u6807\u7684\u65b0\u503c\u3002</p>"},{"location":"chap8/29awk/#_3","title":"\u6848\u4f8b\u56db\uff1a\u5c06\u7b2c\u4e00\u5217\u5408\u5e76\u5230\u4e00\u884c","text":"<pre><code>$ cat file\n1 2 3\n4 5 6\n7 8 9\n\nawk '{for(i=1;i&lt;=NF;i++)a[i]=a[i]$i\" \"}END{for(vin a)print a[v]}' file\n1 4 7\n2 5 8\n3 6 \n</code></pre> <pre><code>\u89e3\u8bfb\uff1a\n\nfor\u5faa\u73af\u662f\u904d\u5386\u6bcf\u884c\u7684\u5b57\u6bb5\uff0cNF\u7b49\u4e8e3\uff0c\u5faa\u73af3\u6b21\u3002\n\n\n\n\u8bfb\u53d6\u7b2c\u4e00\u884c\u65f6\uff1a\n\n\u7b2c\u4e00\u4e2a\u5b57\u6bb5\uff1aa[1]=a[1]1\" \"  \u503ca[1]\u8fd8\u672a\u5b9a\u4e49\u6570\u7ec4\uff0c\u4e0b\u6807\u4e5f\u83b7\u53d6\u4e0d\u5230\u5bf9\u5e94\u7684\u503c\uff0c\u6240\u4ee5\u4e3a\u7a7a\uff0c\u56e0\u6b64a[1]=1 \u3002\n\n\u7b2c\u4e8c\u4e2a\u5b57\u6bb5\uff1aa[2]=a[2]2\" \"  \u503ca[2]\u6570\u7ec4a\u5df2\u7ecf\u5b9a\u4e49\uff0c\u4f46\u6ca1\u67092\u8fd9\u4e2a\u4e0b\u6807\uff0c\u4e5f\u83b7\u53d6\u4e0d\u5230\u5bf9\u5e94\u7684\u503c\uff0c\u4e3a\u7a7a\uff0c\u56e0\u6b64a[2]=2 \u3002\n\n\u7b2c\u4e09\u4e2a\u5b57\u6bb5\uff1aa[3]=a[3]3\" \"  \u503ca[2]\u4e0e\u4e0a\u9762\u4e00\u6837\uff0c\u4e3a\u7a7a,a[3]=3 \u3002\n\n\u8bfb\u53d6\u7b2c\u4e8c\u884c\u65f6\uff1a\n\n\u7b2c\u4e00\u4e2a\u5b57\u6bb5\uff1aa[1]=a[1]4\" \"  \u503ca[2]\u83b7\u53d6\u6570\u7ec4a\u76842\u4e3a\u4e0b\u6807\u5bf9\u5e94\u7684\u503c\uff0c\u4e0a\u9762\u5df2\u7ecf\u6709\u8fd9\u4e2a\u4e0b\u6807\u4e86\uff0c\u5bf9\u5e94\u7684\u503c\u662f1\uff0c\u56e0\u6b64a[1]=1 4\n\n\u7b2c\u4e8c\u4e2a\u5b57\u6bb5\uff1aa[2]=a[2]5\" \"  \u540c\u4e0a\uff0ca[2]=2 5\n\n\u7b2c\u4e09\u4e2a\u5b57\u6bb5\uff1aa[3]=a[3]6\" \"  \u540c\u4e0a\uff0ca[2]=3 6\n\n\u8bfb\u53d6\u7b2c\u4e09\u884c\u65f6\u5904\u7406\u65b9\u5f0f\u540c\u4e0a\uff0c\u6570\u7ec4\u6700\u540e\u8fd8\u662f\u4e09\u4e2a\u4e0b\u6807\uff0c\u5206\u522b\u662f1=1 4 7\uff0c2=2 5 8\uff0c3=36 9\u3002\u6700\u540efor\u5faa\u73af\u8f93\u51fa\u6240\u6709\u4e0b\u6807\u503c\u3002\n</code></pre>"},{"location":"chap8/29awk/#_4","title":"\u6848\u4f8b\u4e94\uff1a\u5b57\u7b26\u4e32\u62c6\u5206","text":"<pre><code>\n\u65b9\u6cd51\uff1a\necho \"hello\" |awk -F '''{for(i=1;i&lt;=NF;i++)print $i}'\nh\ne\nl\nl\no\n\n\u65b9\u6cd52\uff1a\necho \"hello\" |awk '{split($0,a,\"''\");for(v in a)print a[v]}'\nl\no\nh\ne\nl\n</code></pre>"},{"location":"chap8/29awk/#_5","title":"\u6848\u4f8b\u516d\uff1a\u7edf\u8ba1\u51fa\u73b0\u7684\u6b21\u6570","text":"<p>\u7edf\u8ba1\u5b57\u7b26\u4e32\u4e2d\u6bcf\u4e2a\u5b57\u6bcd\u51fa\u73b0\u7684\u6b21\u6570\uff1a</p> <pre><code>echo \"a.b.c,c.d.e\" |awk -F'[.,]' '{for(i=1;i&lt;=NF;i++)a[$i]++}END{for(v in a)print v,a[v]}'\na 1\nb 1\nc 2\nd 1\ne 1\n</code></pre>"},{"location":"chap8/29awk/#_6","title":"\u6848\u4f8b\u4e03\uff1a\u83b7\u53d6\u67d0\u5217\u6570\u5b57\u6700\u5927\u6570","text":"<pre><code>$ cat a\na b 1\nc d 2\ne f 3\ng h 3\ni j 2\n\n\u83b7\u53d6\u7b2c\u4e09\u5b57\u6bb5\u6700\u5927\u503c\uff1a\nawk 'BEGIN{max=0}{if($3&gt;max)max=$3}END{print max}' a\n3\n\u6253\u5370\u7b2c\u4e09\u5b57\u6bb5\u6700\u5927\u884c\uff1a\nawk 'BEGIN{max=0}{a[$0]=$3;if($3&gt;max)max=$3}END{for(v in a)if(a[v]==max)print v}'a\ng h 3\ne f 3\n</code></pre>"},{"location":"chap8/29awk/#_7","title":"\u6848\u4f8b\u516b\uff1a\u53bb\u9664\u6587\u672c\u7b2c\u4e00\u884c\u548c\u6700\u540e\u4e00\u884c","text":"<pre><code>seq 5 |awk 'NR&gt;2{print s}{s=$0}'\n2\n3\n4\n</code></pre> <p>\u89e3\u8bfb\uff1a</p> <p>\u8bfb\u53d6\u7b2c\u4e00\u884c\uff0cNR=1\uff0c\u4e0d\u6267\u884cprint s\uff0cs=1</p> <p>\u8bfb\u53d6\u7b2c\u4e8c\u884c\uff0cNR=2\uff0c\u4e0d\u6267\u884cprint s\uff0cs=2 \uff08\u5927\u4e8e\u4e3a\u771f\uff09</p> <p>\u8bfb\u53d6\u7b2c\u4e09\u884c\uff0cNR=3\uff0c\u6267\u884cprint s\uff0c\u6b64\u65f6s\u662f\u4e0a\u4e00\u6b21p\u8d4b\u503c\u5185\u5bb92\uff0cs=3</p> <p>\u6700\u540e\u4e00\u884c\uff0c\u6267\u884cprint s\uff0c\u6253\u5370\u5012\u6570\u7b2c\u4e8c\u884c\uff0cs=\u6700\u540e\u4e00\u884c\u3002</p>"},{"location":"chap8/2linux_locate/","title":"2 Linux \u7cfb\u7edf\u4e0b\u67e5\u627e\u6587\u4ef6\u547d\u4ee4\u603b\u7ed3","text":""},{"location":"chap8/2linux_locate/#_1","title":"\u67e5\u547d\u4ee4\u7edd\u5bf9\u8def\u5f84","text":"<p>which\u7528\u4e8e\u67e5\u627e\u5e76\u663e\u793a\u7ed9\u5b9a\u547d\u4ee4\u7684\u7edd\u5bf9\u8def\u5f84,\u73af\u5883\u53d8\u91cf\u4e2dPATH\u53c2\u6570\u4e5f\u53ef\u4ee5\u88ab\u67e5\u51fa\u6765\u3002</p> <pre><code>[root@localhost ~]# which bash\n/usr/bin/bash\n\n[root@localhost ~]# which ls\nalias ls='ls --color=auto'\n    /usr/bin/ls\n</code></pre>"},{"location":"chap8/2linux_locate/#find","title":"find\u547d\u4ee4","text":"<p>\u4ece\u6307\u5b9a\u7684\u8d77\u59cb\u76ee\u5f55\u5f00\u59cb\uff0c\u9012\u5f52\u67e5\u627e\u5176\u5404\u4e2a\u5b50\u76ee\u5f55\uff0c\u67e5\u627e\u6ee1\u8db3\u6761\u4ef6\u7684\u6587\u4ef6\u5e76\u5bf9\u5176\u6267\u884c\u76f8\u5173\u7684\u64cd\u4f5c\u3002</p> <pre><code>[root@localhost ~] find /path/to/search -name \"filename\"\n</code></pre> <p>find\u547d\u4ee4\u7684\u4e00\u822c\u7528\u6cd5\u9664\u4e86\u6839\u636e\u540d\u79f0\u6765\u67e5\u627e\u6587\u4ef6\u5916\uff0c\u8fd8\u53ef\u4ee5\u6839\u636e\u6587\u4ef6\u5927\u5c0f\u548c\u65f6\u95f4\u6765\u67e5\u627e\u3002</p>"},{"location":"chap8/2linux_locate/#_2","title":"\u5bfb\u627e\u7279\u5b9a\u6587\u4ef6","text":"<p>whereis\u547d\u4ee4\u7528\u6765\u5b9a\u4f4d\u6307\u4ee4\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u3001\u6e90\u4ee3\u7801\u6587\u4ef6\u548cman\u624b\u518c\u9875\u7b49\u76f8\u5173\u6587\u4ef6\u7684\u8def\u5f84,\u8be5\u547d\u4ee4\u53ea\u80fd\u7528\u4e8e\u7a0b\u5e8f\u540d\u7684\u641c\u7d22</p> <pre><code>[root@localhost ~]# whereis --help\n\n\u8bed\u6cd5\u683c\u5f0f\uff1a[ whereis [\u9009\u9879] \u6587\u4ef6\u540d ]\n\n        -b              #\u53ea\u627e\u4e8c\u8fdb\u5236\u6587\u4ef6\n        -m              #\u53ea\u627eman\u6587\u6863\n        -s              #\u53ea\u627e\u6e90\u4ee3\u7801\n</code></pre> <p>\u4f7f\u7528 whereis -b \u547d\u4ee4\u627e\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0e\u5e2e\u52a9\u624b\u518c\u3002</p> <pre><code>[root@localhost ~]# whereis -b ifconfig\nifconfig: /usr/sbin/ifconfig\n\n[root@localhost ~]# whereis -m ifconfig\nifconfig: /usr/share/man/man8/ifconfig.8.gz\n</code></pre>"},{"location":"chap8/2linux_locate/#_3","title":"\u7f13\u5b58\u67e5\u627e\u6587\u4ef6","text":"<p>locate \u641c\u7d22\u4e00\u4e2a\u6570\u636e\u5e93<code>/var/lib/mlocatedb</code>,\u8fd9\u4e2a\u6570\u636e\u5e93\u4e2d\u542b\u6709\u672c\u5730\u6240\u6709\u6587\u4ef6\u4fe1\u606f,</p> <p>Linux\u7cfb\u7edf\u81ea\u52a8\u521b\u5efa\u8fd9\u4e2a\u6570\u636e\u5e93,\u5e76\u4e14\u6bcf\u5929\u81ea\u52a8\u66f4\u65b0\u4e00\u6b21,\u6240\u4ee5\u4f7f\u7528<code>locate</code>\u547d\u4ee4\u67e5\u4e0d\u5230\u6700\u65b0\u53d8\u52a8\u8fc7\u7684\u6587\u4ef6,\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5,\u53ef\u4ee5\u5728\u4f7f\u7528locate\u4e4b\u524d,\u5148\u4f7f\u7528<code>updatedb</code>\u547d\u4ee4,\u624b\u52a8\u66f4\u65b0\u6570\u636e\u5e93,<code>updatedb</code>\u547d\u4ee4\u4f1a\u6839\u636e<code>/etc/updatedb.conf</code>\u6765\u66f4\u65b0\u6587\u4ef6.</p> <pre><code>[root@localhost ~]# yum install -y mlocate\n[root@localhost ~]# locate --help\n\n\u8bed\u6cd5\u683c\u5f0f\uff1a[ locate [\u9009\u9879] \u6587\u4ef6\u540d ]\n\n        -d \u76ee\u5f55        #\u6307\u5b9a\u6570\u636e\u5e93\u6240\u5728\u7684\u76ee\u5f55\n        -i             #\u5ffd\u7565\u5927\u5c0f\u5199\u5dee\u5f02\n        -r             #\u540e\u9762\u63a5\u6b63\u5219\u8868\u8fbe\u5f0f\n</code></pre> <p>\u4f7f\u7528 locate \u547d\u4ee4\u67e5\u8be2\u4e00\u4e2a\u6587\u4ef6.</p> <pre><code>[root@localhost ~]# updatedb \n[root@localhost ~]# locate /etc/passwd\n/etc/passwd\n/etc/passwd-\n</code></pre>"},{"location":"chap8/2linux_locate/#_4","title":"\u904d\u5386\u6587\u4ef6\u67e5\u627e:","text":"<p>find \u547d\u4ee4\u53ef\u4ee5\u8bf4\u662f\u6700\u91cd\u8981\u7684\u67e5\u627e\u547d\u4ee4\u4e86\uff0c\u8be5\u547d\u4ee4\u53c2\u6570\u8f83\u591a\u3002</p> <pre><code>[root@localhost ~]# find --help\n\n\u8bed\u6cd5\u683c\u5f0f\uff1a[ find [\u76ee\u5f55] [\u5c5e\u6027] \u6587\u4ef6\u540d ]\n\n        -name         #\u6309\u6587\u4ef6\u540d\u67e5\u627e\n        -size         #\u6839\u636e\u5927\u5c0f\u67e5\u627e\n        -user         #\u6839\u636e\u5c5e\u4e3b\u67e5\u627e\n        -perm         #\u6839\u636e\u6743\u9650\u67e5\u627e\n        -type         #\u6839\u636e\u7c7b\u578b\u67e5\u627e\n        -time         #\u6309\u65f6\u95f4\u67e5\u627e\n        -inum         #\u6839\u636ei\u8282\u70b9\u67e5\u8be2\n        -exec         #\u67e5\u627e\u540e\u6267\u884c\u547d\u4ee4\n</code></pre>"},{"location":"chap8/2linux_locate/#-name","title":"<code>-name</code> \u6309\u6587\u4ef6\u540d\u67e5\u627e\uff1a","text":"<p>\u5e38\u7528\u67e5\u8be2\u901a\u914d\u7b26</p> <pre><code>\\*     #\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u6216\u591a\u4e2a\u5b57\u7b26\n\uff1f     #\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\n[]     #\u6307\u5b9a\u8303\u56f4,\u5916\u4fa7\u52a0\u5f15\u53f7\n</code></pre> <p>\u67e5\u627e<code>/var/</code>\u76ee\u5f55\u4e0b,\u4ee5<code>.log</code>\u7ed3\u5c3e\u7684\u6587\u4ef6.</p> <pre><code>[root@localhost ~]# find /var/ -name \"*.log\"\n/var/log/tuned/tuned.log\n/var/log/audit/audit.log\n/var/log/anaconda/X.log\n/var/log/anaconda/program.log\n....\u7701\u7565....\n</code></pre> <p>\u67e5\u627e<code>/root/</code>\u76ee\u5f55\u4e0b,\u4ee5<code>[1-3\u4e4b\u95f4],</code>\u7ed3\u5c3e\u662f<code>.txt</code>\u7684\u6587\u4ef6</p> <pre><code>[root@localhost ~]# ls\n1.txt  2.txt  3.txt  Catalog  File\n\n[root@localhost ~]# find /root/ -name \"[1-3].txt\"\n/root/1.txt\n/root/2.txt\n/root/3.txt\n</code></pre> <p>\u67e5\u627e<code>/etc</code>/\u76ee\u5f55\u4e0b,\u5f00\u5934\u662f6\u4e2a\u4efb\u610f\u5b57\u7b26\u7684\u6587\u4ef6</p> <pre><code>[root@localhost ~]# find /etc/ -name \"??????\"\n/etc/grub.d\n/etc/grub.d/README\n/etc/shells\n/etc/init.d\n....\u7701\u7565....\n</code></pre>"},{"location":"chap8/2linux_locate/#-size","title":"<code>-size</code> \u6839\u636e\u5927\u5c0f\u67e5\u627e","text":"<pre><code>\u5355\u4f4d\u662f block \u6570\u636e\u5757  \u4e00\u5757\u662f512\u5b57\u8282\n1M -&gt; 1024k -&gt; 2048 \u5757  (1\u5757\u662f0.5k \u4e5f\u5c31\u662f512\u5b57\u8282)\n100M -&gt; 102400k -&gt; 204800\u5757\n</code></pre> <p>\u67e5\u627e<code>/etc/</code>\u76ee\u5f55\u4e0b,\u5c0f\u4e8e10k\u7684\u6587\u4ef6</p> <pre><code>root@localhost ~]# find /etc/ -size -10k\n/etc/crypttab\n/etc/.pwd.lock\n/etc/environment\n....\u7701\u7565....\n</code></pre> <p>\u67e5\u627e<code>/etc/</code>\u76ee\u5f55\u4e0b,\u5927\u4e8e1M\u7684\u6587\u4ef6</p> <pre><code>[root@localhost ~]# find /etc/ -size +1M   #\u67e5\u8be2\u5927\u4e8e1M\u7684\u6587\u4ef6\n/etc/udev/hwdb.bin\n/etc/selinux/targeted/active/policy.kern\n/etc/selinux/targeted/contexts/files/file_contexts.bin\n/etc/selinux/targeted/policy/policy.31\n....\u7701\u7565....\n\n#\u6ce8\u610f\uff1a+-\u53f7\u5982\u679c\u6ca1\u6709,\u662f\u7cbe\u786e\u5230\u8fd9\u4e48\u5927,\u901a\u5e38\u90fd\u4f1a\u5e26\u4e0a+\u6216-\u53f7\u8868\u793a\u4e00\u4e2a\u8303\u56f4.\n</code></pre>"},{"location":"chap8/2linux_locate/#-user","title":"<code>-user</code> \u6839\u636e\u5c5e\u4e3b\u4e0e\u6743\u9650\u67e5\u627e","text":"<p>\u5728<code>/root</code>\u76ee\u5f55\u4e2d\u67e5\u627e\u5c5e\u4e8ewang\u7528\u6237\u7684\u6587\u4ef6</p> <pre><code>[root@localhost ~]# find /root/ -user wang\n/root/1.txt\n/root/2.txt\n/root/3.txt\n#\u6ce8\u610f\uff1a\u7cfb\u7edf\u4e2d\u8981\u5b58\u5728\u8be5\u7528\u6237,\u5426\u5219\u4f1a\u62a5\u9519\u8bef.\n</code></pre> <p>\u67e5\u627e<code>/boot/</code>\u76ee\u5f55\u4e2d\u6743\u9650\u662f644\u7684\u6587\u4ef6</p> <pre><code>[root@localhost ~]# find /boot/ -perm 0644\n/boot/grub2/device.map\n/boot/grub2/i386-pc/gcry_rmd160.mod\n/boot/grub2/i386-pc/acpi.mod\n/boot/grub2/i386-pc/gcry_rsa.mod\n....\u7701\u7565....\n</code></pre>"},{"location":"chap8/2linux_locate/#-type","title":"<code>-type</code> \u6839\u636e\u7c7b\u578b\u67e5\u627e","text":"<pre><code>-type f \u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u666e\u901a\u6587\u4ef6\uff09\n-type l \u8f6f\u94fe\u63a5\u6587\u4ef6\n-type d \u76ee\u5f55\n</code></pre> <p>\u67e5\u627e<code>/usr/bin/</code>\u76ee\u5f55\u4e0b,\u7c7b\u578b\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6.</p> <pre><code>[root@localhost ~]# find /usr/bin/ -type f\n/usr/bin/cp\n/usr/bin/gzip\n/usr/bin/alias\n/usr/bin/csplit\n/usr/bin/bash\n....\u7701\u7565....\n</code></pre>"},{"location":"chap8/2linux_locate/#-time","title":"<code>-time</code> \u6309\u65f6\u95f4\u67e5\u627e","text":"<pre><code>\u6309\u5929\u6570   ctime  atime  mtime\n\u6309\u5206\u949f   cmin   amin     mmin\n\n  c  change   #\u8868\u793a\u5c5e\u6027\u88ab\u4fee\u6539\u8fc7\uff1a\u6240\u6709\u8005\u3001\u6240\u5c5e\u7ec4\u3001\u6743\u9650\n  a  access   #\u88ab\u8bbf\u95ee\u8fc7(\u88ab\u67e5\u770b\u8fc7)\n  m  modify   #\u8868\u793a\u5185\u5bb9\u88ab\u4fee\u6539\u8fc7\n</code></pre> <p>\u67e5\u627e<code>/etc/</code>\u76ee\u5f55\u4e0b,\u5728120\u5206\u949f\u4ee5\u5185,\u5185\u5bb9\u88ab\u4fee\u6539\u8fc7\u7684\u6587\u4ef6</p> <pre><code>[root@localhost ~]# find /etc/ -mmin -120\n/etc/\n/etc/resolv.conf\n/etc/group-\n/etc/gshadow-\n/etc/group\n/etc/gshadow\n....\u7701\u7565....\n</code></pre> <p>\u67e5\u627e<code>/etc/</code>\u76ee\u5f55\u4e0b,\u57287\u5929\u4e4b\u524d,\u5c5e\u6027\u88ab\u4fee\u6539\u8fc7\u7684\u6587\u4ef6</p> <pre><code>[root@localhost ~]# find /etc/ -ctime +7\n/etc/resolv.conf\n/etc/group-\n/etc/gshadow-\n....\u7701\u7565....\n</code></pre>"},{"location":"chap8/2linux_locate/#-inum-i","title":"<code>-inum</code> \u6839\u636ei\u8282\u70b9\u67e5\u8be2","text":"<p>\u6709\u4e00\u4e9b\u6587\u4ef6\u7684\u786c\u94fe\u63a5\u6570\u91cf\u5f88\u591a\uff0c\u6709\u76f8\u540c\u7684i\u8282\u70b9\uff0c\u67e5\u627e\u5176\u4e2d\u4e00\u4e2a\u6587\u4ef6\u7684i\u8282\u70b9\u53f7\uff0c\u4e00\u6b21\u6027\u5220\u9664\u3002</p> <pre><code>[root@localhost ~]# find ./ -inum 1024 -exec rm{} \\;   #\u5220\u9664\u76f8\u540cI\u8282\u70b9\u7684\u6570\u636e\n</code></pre>"},{"location":"chap8/2linux_locate/#-and-or","title":"<code>-and or</code>\u903b\u8f91\u8fde\u63a5\u7b26","text":"<pre><code>-a    \uff08and \u903b\u8f91\u4e0e\uff09     \n-o    \uff08or  \u903b\u8f91\u6216)\n</code></pre> <p>\u5728/etc/\u76ee\u5f55\u4e0b,\u67e5\u627e\u5927\u4e8e1k,\u5e76\u4e14\u5c0f\u4e8e10k\u7684\u6587\u4ef6</p> <pre><code>[root@localhost ~]# find /etc/ -size +1k -a -size -10k\n/etc/\n/etc/grub.d/00_header\n/etc/grub.d/20_ppc_terminfo\n/etc/grub.d/00_tuned\n/etc/rc.d/init.d/README\n/etc/rc.d/init.d/netconsole\n/etc/rc.d/init.d/network\n/etc/pam.d\n....\u7701\u7565....\n</code></pre>"},{"location":"chap8/2linux_locate/#-exec","title":"<code>-exec</code> \u547d\u4ee4\u6267\u884c\u8fde\u63a5\u7b26","text":"<pre><code>[\u67e5\u8be2\u683c\u5f0f] find  ...  -exec \u547d\u4ee4 {}  \\;\n\n{}        #\u8868\u793afind\u67e5\u8be2\u7684\u7ed3\u679c\u96c6\n\\         #\u662f\u8f6c\u4e49\u7b26,\u4e0d\u4f7f\u7528\u547d\u4ee4\u522b\u540d,\u76f4\u63a5\u4f7f\u7528\u547d\u4ee4\u672c\u8eab\n;         #\u5206\u53f7\u662f\u8868\u793a\u8bed\u53e5\u7684\u7ed3\u675f.\n\n#\u6ce8\u610f\uff1a\u56fa\u5b9a\u683c\u5f0f,\u53ea\u80fd\u8fd9\u6837\u5199.\u6ce8\u610f\u4e2d\u95f4\u7684\u7a7a\u683c.\n\uff08\u516c\u4f17\u53f7\uff1a\u7f51\u7edc\u5de5\u7a0b\u5e08\u963f\u9f99\uff09-----------------------------------------------------------------\n\u8bf4\u660e\uff1a \u8f6c\u4e49\u7b26\u7684\u4f5c\u7528\u662f\u4ec0\u4e48\uff1f\n\n\u5728linux\u4e2d\u6709\u4e00\u4e2a\u522b\u540d\u673a\u5236\uff0c\u5982rm\u5220\u9664\u6587\u4ef6\uff0c\u6267\u884c\u7684\u5374\u662frm -i(\u7528which rm \u53ef\u4ee5\u67e5\u770b\u547d\u4ee4\u522b\u540d)\uff0c\n\u4f7f\u7528rm\u5220\u9664\u6587\u4ef6\u524d\u4f1a\u63d0\u793a\uff0c\u5c31\u662f\u56e0\u4e3arm -i\u8fd9\u4e2a\u53c2\u6570\u3002\u5982\u679c\u60f3\u4f7f\u7528\u547d\u4ee4\u539f\u610f\uff0c\u53ef\u4ee5\u5728\u52a0\\\u8f6c\u4e49\uff0c\n\u5982\uff1a\\rm test.txt   \u5219\u4e0d\u4f1a\u63d0\u793a\uff0c\u76f4\u63a5\u5220\u9664\n</code></pre> <p>\u67e5\u627e<code>/var/log/</code>\u76ee\u5f55\u4e0b\u540d\u5b57\u4ee5.log\u7ed3\u5c3e\u7684\u6587\u4ef6,\u627e\u5230\u540e\u6267\u884c <code>ls -l</code>\u663e\u793a\u8be6\u7ec6\u4fe1\u606f.</p> <pre><code>[root@localhost ~]# find /var/log/ *.log -exec ls -l {} \\;\ntotal 1176\ndrwxr-xr-x. 2 root   root      204 Sep 18 09:12 anaconda\ndrwx------. 2 root   root       23 Sep 18 09:12 audit\n-rw-------. 1 root   root    53001 Sep 19 00:57 boot.log\n-rw-------. 1 root   utmp      384 Sep 18 09:22 btmp\ndrwxr-xr-x. 2 chrony chrony      6 Apr 12 13:37 chrony\n-rw-------. 1 root   root     3523 Sep 19 01:01 cron\n-rw-r--r--  1 root   root   119414 Sep 19 00:57 dmesg\n-rw-r--r--  1 root   root   119599 Sep 18 23:35 dmesg.old\n-rw-r--r--. 1 root   root     1320 Sep 19 00:23 firewalld\n-rw-r--r--. 1 root   root      193 Sep 18 09:05 grubby_prune_debug\n....\n</code></pre> <p>\u67e5\u627e<code>/etc/</code>\u76ee\u5f55\u4e0b\u540d\u5b57\u4ee5<code>\"init*\"</code>\u5f00\u5934\u7684\u6587\u4ef6,\u627e\u5230\u540e,\u53ea\u5217\u51fa\u6587\u4ef6,\u8fc7\u6ee4\u6389\u76ee\u5f55,\u5e76\u6267\u884c <code>ls -l</code> \u663e\u793a\u8be6\u7ec6\u4fe1\u606f.</p> <pre><code>[root@localhost ~]# find /etc/ -name \"init*\" -a -type f -exec ls -l {} \\;\n\n-rw-r--r--. 1 root root 511 Apr 11 01:09 /etc/inittab\n-rw-r--r--. 1 root root 798 Apr 11 01:09 /etc/sysconfig/init\n-rwxr-xr-x. 1 root root 5419 Jan  2  2018 /etc/sysconfig/network-scripts/init.ipv6-global\n-rw-r--r--. 1 root root 30 Apr 11 14:12 /etc/selinux/targeted/contexts/initrc_context\n</code></pre> <p>\u67e5\u627e/tmp/\u4e0b,\u7684<code>yum.log</code>\u6587\u4ef6,\u627e\u5230\u540e\u76f4\u63a5\u5220\u9664.</p> <pre><code>[root@localhost tmp]# find /tmp/ -name yum.log -exec rm {} \\;\n[root@localhost tmp]#\n</code></pre> <p>\u67e5\u627e\u6839\u4e0b,\u627e\u5173\u4e8elyshark\u7528\u6237\u7684\u6240\u6709\u6587\u4ef6,\u627e\u5230\u540e\u76f4\u63a5\u5220\u9664.</p> <pre><code>[root@localhost ~]# find / -user lyshark -exec rm -r {} \\;\n\nfind: \u2018/proc/1465/task/1465/fd/6\u2019: No such file or directory\nfind: \u2018/proc/1465/task/1465/fdinfo/6\u2019: No such file or directory\nfind: \u2018/proc/1465/fd/5\u2019: No such file or directory\nfind: \u2018/proc/1465/fdinfo/5\u2019: No such file or directory\nfind: \u2018/root/Catalog\u2019: No such file or directory\nfind: \u2018/home/lyshark\u2019: No such file or directory\n#rm -r \u8fde\u5e26\u76ee\u5f55\u4e00\u8d77\u5220\u9664.\u62a5\u9519\u539f\u56e0\uff1a-exec \u4e0d\u9002\u5408\u5927\u91cf\u4f20\u8f93,\u901f\u7387\u6162\u5bfc\u81f4.\n</code></pre> <p>\u5728\u6839\u4e0b,\u67e5\u627elyshark\u7528\u6237\u7684\u6587\u4ef6,\u627e\u5230\u540e\u5220\u9664,\u5220\u9664\u524d\u4f1a\u63d0\u793a\u662f\u5426\u5220\u9664.</p> <pre><code>[root@localhost ~]# find / -user lyshark -ok rm -r {} \\;\nfind: \u2018/proc/1777/task/1777/fd/6\u2019: No such file or directory\nfind: \u2018/proc/1777/task/1777/fdinfo/6\u2019: No such file or directory\n\n&lt; rm ... /root/LyShark &gt; ? y\n# -ok\u7684\u4f7f\u7528\u548c-exec\u662f\u4e00\u6837\u7684,\u533a\u522b\u662f-ok,\u6267\u884c\u65f6\u4f1a\u63d0\u793a\u4f60\u662f\u5426\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c.\n</code></pre>"},{"location":"chap8/30nohup/","title":"nohup\u547d\u4ee4\uff1a\u5728Linux\u4e2d\u8f7b\u677e\u5b9e\u73b0\u540e\u53f0\u8fd0\u884c\u548c\u5b88\u62a4\u8fdb\u7a0b","text":"<p>\u5728Linux\u73af\u5883\u4e2d\uff0c\u6709\u65f6\u5019\u6211\u4eec\u9700\u8981\u8ba9\u67d0\u4e9b\u547d\u4ee4\u5728\u540e\u53f0\u6301\u7eed\u8fd0\u884c\uff0c\u5373\u4f7f\u6211\u4eec\u5173\u95ed\u4e86\u7ec8\u7aef\u6216\u8005SSH\u8fde\u63a5\u3002</p> <p>\u8fd9\u65f6\u5019\uff0cnohup\u547d\u4ee4\u5c31\u6d3e\u4e0a\u4e86\u7528\u573a\u3002nohup\u662f\"no hang up\"\u7684\u7f29\u5199\uff0c\u610f\u4e3a\"\u4e0d\u6302\u8d77\"\uff0c\u5b83\u662fLinux\u548cUnix\u7cfb\u7edf\u4e2d\u7684\u4e00\u4e2a\u547d\u4ee4\uff0c\u7528\u4e8e\u5728\u9000\u51fa\u7ec8\u7aef\u6216\u65ad\u5f00SSH\u4e4b\u540e\u7ee7\u7eed\u8fd0\u884c\u547d\u4ee4\u3002</p>"},{"location":"chap8/30nohup/#nohup","title":"\u4e00\u3001nohup\u547d\u4ee4\u7684\u57fa\u672c\u7528\u6cd5","text":"<p>nohup\u547d\u4ee4\u7684\u57fa\u672c\u7528\u6cd5\u662f\uff1a</p> <pre><code>nohup COMMAND &amp;\n</code></pre> <p>\u5176\u4e2d\uff0cCOMMAND\u662f\u60f3\u8981\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u6700\u540e\u7684&amp;\u8868\u793a\u5728\u540e\u53f0\u8fd0\u884c\u3002</p> <p>\u4f8b\u5982\uff0c\u60f3\u8981\u5728\u540e\u53f0\u8fd0\u884c\u4e00\u4e2a\u540d\u4e3a\"task01.sh\"\u7684\u811a\u672c\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>nohup ./task01.sh &amp;\n</code></pre> <p>\u8fd0\u884c\u4e0a\u8ff0\u547d\u4ee4\u540e\uff0c\u7ec8\u7aef\u4e0d\u4f1a\u7b49\u5f85task01.sh\u811a\u672c\u7684\u6267\u884c\u5b8c\u6210\uff0c\u800c\u662f\u7acb\u5373\u8fd4\u56de\u547d\u4ee4\u63d0\u793a\u7b26\u3002\u811a\u672c\u5c06\u5728\u540e\u53f0\u7ee7\u7eed\u8fd0\u884c\uff0c\u4e0d\u53d7\u7ec8\u7aef\u5173\u95ed\u6216SSH\u8fde\u63a5\u65ad\u5f00\u7684\u5f71\u54cd\u3002</p>"},{"location":"chap8/30nohup/#nohup_1","title":"\u4e8c\u3001nohup\u547d\u4ee4\u7684\u8f93\u51fa\u91cd\u5b9a\u5411","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cnohup\u547d\u4ee4\u5c06\u8f93\u51fa\u5199\u5165\u540d\u4e3anohup.out\u7684\u6587\u4ef6\u4e2d\u3002\u5982\u679c\u5e0c\u671b\u5c06\u8f93\u51fa\u5199\u5165\u5176\u4ed6\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u8f93\u51fa\u91cd\u5b9a\u5411\u529f\u80fd\u3002\u4f8b\u5982\uff1a</p> <pre><code>nohup ./task01.sh &gt; task01.log &amp;\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u5c06task01.sh\u7684\u6807\u51c6\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u540d\u4e3atask01.log\u7684\u6587\u4ef6\u4e2d\u3002\u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5b83\u5c06\u88ab\u521b\u5efa\uff1b</p> <p>\u5982\u679c\u6587\u4ef6\u5df2\u7ecf\u5b58\u5728\uff0c\u5b83\u7684\u5185\u5bb9\u5c06\u88ab\u8986\u76d6\u3002\u53ef\u4ee5\u4f7f\u7528\"&gt;&gt;\"\u800c\u4e0d\u662f\"&gt;\"\uff0c\u5c06\u8f93\u51fa\u8ffd\u52a0\u5230\u73b0\u6709\u6587\u4ef6\u4e2d\u3002</p> <p>\u4e3a\u4e86\u4e0d\u4e22\u5931\u51fa\u9519\u4fe1\u606f\uff0c\u53ef\u4ee5\u4f7f\u7528\"2&gt;&amp;1\"\u5c06\u9519\u8bef\u65e5\u5fd7\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa\u3002\u53ef\u4ee5\u5c06\u4e0a\u8ff0\u547d\u4ee4\u6539\u4e3a\u8fd9\u6837\uff1a</p> <pre><code>nohup ./task01.sh &gt; task01.log 2&gt;&amp;1 &amp;\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u5c06task01.sh\u7684\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u5168\u90e8\u8f93\u51fa\u5230task01.log\u6587\u4ef6\u4e2d\u3002</p>"},{"location":"chap8/30nohup/#nohup_2","title":"\u4e09\u3001nohup\u547d\u4ee4\u7684\u539f\u7406","text":"<p>nohup\u547d\u4ee4\u7684\u5de5\u4f5c\u539f\u7406\u5176\u5b9e\u5e76\u4e0d\u590d\u6742\u3002\u5f53\u901a\u8fc7nohup\u8fd0\u884c\u4e00\u4e2a\u547d\u4ee4\u65f6\uff0c\u5b83\u901a\u8fc7\u963b\u6b62\u8fdb\u7a0b\u63a5\u6536SIGHUP\uff08\u6302\u8d77\u4fe1\u53f7\uff09\uff0c\u4ece\u800c\u4f7f\u8fdb\u7a0b\u5728\u9000\u51fa\u7ec8\u7aef\u6216\u4f1a\u8bdd\u540e\u80fd\u591f\u7ee7\u7eed\u8fd0\u884c\u3002</p> <p>\u5e76\u4e14nohup\u5141\u8bb8\u5c06\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\uff0c\u4ee5\u4fbf\u540e\u7eed\u5206\u6790\u6216\u4f7f\u7528\u3002</p>"},{"location":"chap8/30nohup/#nohup_3","title":"\u56db\u3001nohup\u547d\u4ee4\u7684\u4f7f\u7528\u573a\u666f","text":"<ol> <li> <p>\u540e\u53f0\u4efb\u52a1\u7ba1\u7406\uff1a\u5f53\u9700\u8981\u5728\u540e\u53f0\u8fd0\u884c\u4e00\u4e9b\u5468\u671f\u6027\u4efb\u52a1\u6216\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u4efb\u52a1\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528nohup\u547d\u4ee4\u3002\u8fd9\u6837\u5373\u4f7f\u5173\u95ed\u7ec8\u7aef\u6216\u65ad\u5f00SSH\u8fde\u63a5\uff0c\u4efb\u52a1\u4ecd\u5c06\u7ee7\u7eed\u6267\u884c\u3002</p> </li> <li> <p>\u5b88\u62a4\u8fdb\u7a0b\uff1a\u5982\u679c\u60f3\u8ba9\u67d0\u4e2a\u811a\u672c\u4f5c\u4e3a\u5b88\u62a4\u8fdb\u7a0b\u8fd0\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528nohup\u547d\u4ee4\u3002\u5b88\u62a4\u8fdb\u7a0b\u662f\u5728\u540e\u53f0\u8fd0\u884c\u7684\u8fdb\u7a0b\uff0c\u5b83\u72ec\u7acb\u4e8e\u7ec8\u7aef\uff0c\u5e76\u6301\u7eed\u8fd0\u884c\u76f4\u5230\u88ab\u663e\u5f0f\u505c\u6b62\u3002</p> </li> <li> <p>\u6279\u5904\u7406\u4f5c\u4e1a\uff1a\u5982\u679c\u9700\u8981\u540c\u65f6\u8fd0\u884c\u4e00\u4e9b\u4f5c\u4e1a\uff0c\u53ef\u4ee5\u4f7f\u7528nohup\u547d\u4ee4\u3002</p> </li> </ol>"},{"location":"chap8/30nohup/#_1","title":"\u603b\u7ed3","text":"<p>nohup\u547d\u4ee4\u662f\u4e00\u4e2a\u975e\u5e38\u5b9e\u7528\u7684\u5de5\u5177\uff0c\u5b83\u5141\u8bb8\u6211\u4eec\u5728Linux\u73af\u5883\u4e2d\u8f7b\u677e\u5730\u5728\u540e\u53f0\u8fd0\u884c\u547d\u4ee4\u6216\u811a\u672c\u3002\u65e0\u8bba\u4f60\u662f\u4e00\u540d\u7cfb\u7edf\u7ba1\u7406\u5458\u8fd8\u662f\u4e00\u540d\u666e\u901a\u7528\u6237\uff0c\u638c\u63e1nohup\u547d\u4ee4\u5c06\u4f7f\u4f60\u5728Linux\u73af\u5883\u4e2d\u66f4\u52a0\u9ad8\u6548\u5730\u5de5\u4f5c\u3002</p>"},{"location":"chap8/31ln/","title":"\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u201c\u5206\u8eab\u672f\u201dln\u547d\u4ee4","text":"<p>\u5728\u65e5\u5e38\u7684Linux\u7cfb\u7edf\u64cd\u4f5c\u4e2d\uff0cln\u547d\u4ee4\u662f\u6211\u4eec\u7ecf\u5e38\u7528\u5230\u7684\u4e00\u4e2a\u5de5\u5177\uff0c\u5b83\u5141\u8bb8\u6211\u4eec\u4e3a\u6587\u4ef6\u6216\u76ee\u5f55\u521b\u5efa\u94fe\u63a5\u3002</p> <p>\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0cln\u547d\u4ee4\u7684\u4f5c\u7528\u5c31\u50cf\u662f\u4e3a\u6587\u4ef6\u6216\u76ee\u5f55\u65bd\u5c55\u4e86\u201c\u5206\u8eab\u672f\u201d\uff0c\u8ba9\u6211\u4eec\u80fd\u591f\u5728\u591a\u4e2a\u4f4d\u7f6e\u8bbf\u95ee\u540c\u4e00\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u800c\u65e0\u9700\u590d\u5236\u5176\u5185\u5bb9\u3002</p>"},{"location":"chap8/31ln/#ln_1","title":"\u4e00\u3001ln\u547d\u4ee4\u7684\u7528\u6cd5","text":""},{"location":"chap8/31ln/#1","title":"1. \u57fa\u672c\u8bed\u6cd5","text":"<pre><code>ln [OPTION]... TARGET [LINK_NAME]\nln [OPTION]... TARGET... DIRECTORY\nln [OPTION]... -t DIRECTORY TARGET...\n</code></pre> <p>\u5e38\u7528\u7684\u9009\u9879\u6709\uff1a</p> <ul> <li><code>-t</code>\uff1a\u6307\u5b9a\u8981\u5728\u5176\u4e2d\u521b\u5efa\u94fe\u63a5\u7684\u76ee\u5f55\u3002</li> <li><code>-s</code>\uff1a\u521b\u5efa\u7b26\u53f7\u94fe\u63a5\uff08\u4e5f\u79f0\u4e3a\u8f6f\u94fe\u63a5\uff09\u3002</li> <li><code>-P</code>\uff1a\u521b\u5efa\u786c\u94fe\u63a5\u3002</li> <li><code>-f</code>\uff1a\u5982\u679c\u76ee\u6807\u6587\u4ef6\u5df2\u5b58\u5728\uff0c\u5219\u5f3a\u5236\u8986\u76d6\u5b83\u3002</li> </ul>"},{"location":"chap8/31ln/#2","title":"2. \u4f7f\u7528\u793a\u4f8b","text":"<p>\u4e3a\u6587\u4ef6\u521b\u5efa\u786c\u94fe\u63a5\uff1a</p> <p>\u00b7\u00b7\u00b7 ln -P /app/app1/bin/start.sh /app/app2/bin/start.sh \u00b7\u00b7\u00b7</p> <p>\u8fd9\u4f1a\u5728<code>/app/app2/bin/</code>\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3astart.sh\u7684\u786c\u94fe\u63a5\uff0c\u5b83\u6307\u5411<code>/app/app1/bin/start.sh</code>\u3002\u786c\u94fe\u63a5\u548c\u539f\u6587\u4ef6\u6307\u5411\u540c\u4e00\u4e2ainode\uff08\u7d22\u5f15\u8282\u70b9\uff09\uff0c\u5220\u9664\u5176\u4e2d\u4e00\u4e2a\u4e0d\u4f1a\u5f71\u54cd\u53e6\u4e00\u4e2a\u3002</p> <p>\u4f7f\u7528\u547d\u4ee4<code>ls -l</code>\u67e5\u770b<code>start.sh</code>\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u7b2c\u4e8c\u5217\u94fe\u63a5\u8ba1\u6570\uff08\u5373\uff1a\u6307\u5411\u8be5inode\u7684\u786c\u94fe\u63a5\u6570\u91cf\uff09\u663e\u793a\u4e3a<code>2</code>\uff0c\u8868\u793a\u6709\u4e24\u4e2a\u6587\u4ef6\u540d\u6307\u5411<code>start.sh</code>\u6587\u4ef6\uff0c\u666e\u901a\u6587\u4ef6\u8be5\u503c\u4e3a1\uff1a</p> <pre><code>~$ ls -l /app/app*/bin/start.sh\n-rwxr-xr-x 2 root root 3862 Dec 20 9:42 /app/app1/bin/start.sh\n-rwxr-xr-x 2 root root 3862 Dec 20 9:42 /app/app2/bin/start.sh\n</code></pre> <p>\u4e3a\u76ee\u5f55\u521b\u5efa\u7b26\u53f7\u94fe\u63a5\uff1a</p> <pre><code>ln -s redis-7.2.4 redis\n</code></pre> <p>\u8fd9\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aredis\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u5b83\u6307\u5411\u76ee\u5f55redis-7.2.4\u3002</p>"},{"location":"chap8/31ln/#_1","title":"\u4e8c\u3001\u786c\u94fe\u63a5\u4e0e\u7b26\u53f7\u94fe\u63a5\u7684\u533a\u522b","text":""},{"location":"chap8/31ln/#1_1","title":"1. \u786c\u94fe\u63a5","text":"<p>\u786c\u94fe\u63a5\u662f\u6307\u5411\u6587\u4ef6\u6570\u636e\u5757\uff08inode\uff09\u7684\u94fe\u63a5\uff0c\u5b83\u548c\u539f\u6587\u4ef6\u6709\u76f8\u540c\u7684inode\u548c\u6587\u4ef6\u6570\u636e\u5757\u3002</p> <p>\u5220\u9664\u4e00\u4e2a\u786c\u94fe\u63a5\u4e0d\u4f1a\u5f71\u54cd\u5230\u6587\u4ef6\u6570\u636e\uff0c\u53ea\u6709\u5f53\u6240\u6709\u7684\u786c\u94fe\u63a5\u90fd\u88ab\u5220\u9664\u540e\uff0c\u6587\u4ef6\u6570\u636e\u624d\u4f1a\u88ab\u91ca\u653e\u3002</p> <p>\u9002\u7528\u573a\u666f\uff1a\u5e0c\u671b\u591a\u4e2a\u8def\u5f84\u6307\u5411\u540c\u4e00\u4e2a\u6587\u4ef6\uff0c\u5e76\u4e14\u5e0c\u671b\u5176\u4e2d\u4e00\u4e2a\u8def\u5f84\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u5176\u4ed6\u8def\u5f84\u4ecd\u7136\u6709\u6548\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u786c\u94fe\u63a5\u3002</p> <p>\u5982\u793a\u4f8b1\u4e2d\uff0capp1\u548capp2\u5c06\u4f7f\u7528\u540c\u4e00\u4e2a\u542f\u52a8\u811a\u672cstart.sh\uff0c\u5982\u679c\u4fee\u6539\u542f\u52a8\u811a\u672c\uff0c\u5219\u8be5\u4fee\u6539\u5bf9app1\u548capp2\u540c\u65f6\u751f\u6548\u3002</p>"},{"location":"chap8/31ln/#2_1","title":"2. \u7b26\u53f7\u94fe\u63a5","text":"<p>\u7b26\u53f7\u94fe\u63a5\u662f\u4e00\u4e2a\u7279\u6b8a\u7c7b\u578b\u7684\u6587\u4ef6\uff0c\u5b83\u5305\u542b\u4e86\u5bf9\u53e6\u4e00\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6587\u672c\u5f15\u7528\u3002\u5220\u9664\u7b26\u53f7\u94fe\u63a5\u53ea\u4f1a\u5220\u9664\u8fd9\u4e2a\u5f15\u7528\uff0c\u800c\u4e0d\u4f1a\u5f71\u54cd\u5230\u88ab\u5f15\u7528\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u3002</p> <p>\u9002\u7528\u573a\u666f\uff1a\u8f6f\u94fe\u63a5\u901a\u5e38\u7528\u4e8e\u94fe\u63a5\u5230\u4e0d\u540c\u6587\u4ef6\u7cfb\u7edf\u6216\u4e0d\u540c\u5206\u533a\u7684\u6587\u4ef6\u3002\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u8f6f\u94fe\u63a5\uff0c\u6307\u5411\u53e6\u4e00\u4f4d\u7f6e\u7684\u67d0\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u50cf\u64cd\u4f5c\u5f53\u524d\u76ee\u5f55\u7684\u6587\u4ef6/\u76ee\u5f55\u4e00\u6837\uff0c\u6765\u8bbf\u95ee\u8fd9\u4e9b\u6587\u4ef6/\u76ee\u5f55\u3002</p> <p>\u5982\u793a\u4f8b2\u4e2d\uff0c\u4e3a\u76ee\u5f55redis-7.2.4\u521b\u5efa\u540d\u4e3aredis\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u5f53\u8bbf\u95eeredis\u65f6\uff0c\u5c06\u8bbf\u95eeredis-7.2.4\u76ee\u5f55\uff0c\u8fbe\u5230\u7b80\u5316\u76ee\u5f55\u540d\u3001\u65b9\u4fbf\u8fdb\u884c\u5e94\u7528\u7248\u672c\u63a7\u5236\u7684\u76ee\u7684\u3002</p>"},{"location":"chap8/31ln/#_2","title":"\u4e09\u3001\u6ce8\u610f\u4e8b\u9879","text":"<p>\u5728\u4f7f\u7528ln\u547d\u4ee4\u65f6\uff0c\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9\uff1a</p> <p>\u4e0d\u80fd\u5bf9\u76ee\u5f55\u521b\u5efa\u786c\u94fe\u63a5\uff0c\u53ea\u80fd\u5bf9\u6587\u4ef6\u521b\u5efa\u786c\u94fe\u63a5\u3002</p> <p>\u7b26\u53f7\u94fe\u63a5\u53ef\u4ee5\u8de8\u6587\u4ef6\u7cfb\u7edf\uff0c\u800c\u786c\u94fe\u63a5\u53ea\u80fd\u5728\u540c\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u5185\u521b\u5efa\u3002</p> <p>\u521b\u5efa\u94fe\u63a5\u65f6\u8981\u786e\u4fdd\u76ee\u6807\u4f4d\u7f6e\u6ca1\u6709\u540c\u540d\u6587\u4ef6\u6216\u94fe\u63a5\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u8986\u76d6\u539f\u6709\u6587\u4ef6\u6216\u94fe\u63a5\u3002</p>"},{"location":"chap8/32Linux_logs/","title":"Linux \u7cfb\u7edf\u65e5\u5fd7\u4e4b\u6df1\u5165\u89e3\u6790","text":""},{"location":"chap8/32Linux_logs/#1","title":"1\u3001\u7cfb\u7edf\u9ed8\u8ba4\u65e5\u5fd7","text":"<p>\u5728Linux\u4e2d\uff0c\u7cfb\u7edf\u9ed8\u8ba4\u65e5\u5fd7\u7684\u4f4d\u7f6e\u901a\u5e38\u4f4d\u4e8e/var/log\u76ee\u5f55\u4e0b\u3002\u8fd9\u4e2a\u76ee\u5f55\u5305\u542b\u4e86\u5404\u79cd\u65e5\u5fd7\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u90fd\u8bb0\u5f55\u4e86\u4e0d\u540c\u7c7b\u578b\u7684\u4fe1\u606f\u3002\u4ee5\u4e0b\u662f/var/log\u76ee\u5f55\u4e0b\u4e00\u4e9b\u91cd\u8981\u7684\u65e5\u5fd7\u6587\u4ef6\u53ca\u5176\u7b80\u8981\u63cf\u8ff0\uff1a</p>"},{"location":"chap8/32Linux_logs/#11","title":"1.1 \u6587\u4ef6","text":"<ul> <li>message \u6587\u4ef6\u5b58\u50a8\u4e86\u7cfb\u7edf\u542f\u52a8\u548c\u5173\u95ed\u7684\u4e8b\u4ef6\u3001\u786c\u4ef6\u548c\u8bbe\u5907\u7684\u72b6\u6001\u53d8\u5316\u3001\u7f51\u7edc\u4e8b\u4ef6\u3001\u7cfb\u7edf\u9519\u8bef\u548c\u8b66\u544a\u7b49\u3002ubuntu\u5728\u7cfb\u7edf\u914d\u7f6e\u4e2d\u9ed8\u8ba4\u5173\u95ed\u4e86message\u7684\u663e\u793a\uff0c\u5982\u679c\u9700\u8981\u7684\u8bdd\u53ef\u4ee5\u5220\u9664<code>/etc/rsyslog.d/50-default.conf</code>\u6587\u4ef6\u5185\u5173\u4e8emessages\u7684\u6ce8\u91ca\u540e\u91cd\u542f\u65e5\u5fd7\u670d\u52a1\uff0c\u6062\u590d\u663e\u793a</li> <li><code>alternatives.log</code> \u6587\u4ef6\u8bb0\u5f55\u4e86\u4f7f\u7528\u7cfb\u7edf\u4e2d\u7ba1\u7406\u591a\u4e2a\u8f6f\u4ef6\u7248\u672c\u5de5\u5177\u65f6\u4ea7\u751f\u7684\u65e5\u5fd7</li> <li><code>auth.log</code> \u6587\u4ef6\u8bb0\u5f55\u4e86\u7cfb\u7edf\u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\u76f8\u5173\u6d3b\u52a8\u7684\u65e5\u5fd7\u6587\u4ef6</li> <li>btmp \u6587\u4ef6\u8bb0\u5f55\u4e86\u6240\u6709\u5931\u8d25\u7684\u767b\u5f55\u5c1d\u8bd5\u4fe1\u606f</li> <li>dmesg \u6587\u4ef6\u8bb0\u5f55\u4e86\u7cfb\u7edf\u5f00\u673a\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4f7f\u7528dmesg\u547d\u4ee4\u67e5\u770b</li> <li><code>kern.log</code> \u6587\u4ef6\u8bb0\u5f55\u4e86\u5185\u6838\u4ea7\u751f\u7684\u65e5\u5fd7\uff0c\u6709\u52a9\u4e8e\u5728\u5b9a\u5236\u5185\u6838\u65f6\u89e3\u51b3\u95ee\u9898\u3002</li> <li>lastlog \u6587\u4ef6\u8bb0\u5f55\u4e86\u6bcf\u4e2a\u7528\u6237\u6700\u8fd1\u7684\u767b\u5f55\u4e8b\u4ef6</li> <li>syslog \u6587\u4ef6\u901a\u5e38\u4f1a\u8bb0\u5f55\u542f\u52a8\u548c\u5173\u95ed\u4e8b\u4ef6\u3001\u7cfb\u7edf\u9519\u8bef\u3001\u5b89\u5168\u4e8b\u4ef6\u3001\u7f51\u7edc\u6d3b\u52a8\u3001\u5185\u6838\u6d88\u606f\u7b49\u3002\u5b83\u662f\u901a\u8fc7\u7cfb\u7edf\u65e5\u5fd7\u5b88\u62a4\u8fdb\u7a0b\uff08rsyslog \u6216 syslog-ng\uff09\u6536\u96c6\u548c\u7ba1\u7406\u7684\u3002</li> <li>ubuntu-advantage-timer.log \u6587\u4ef6\u8bb0\u5f55\u4e86\u4e0e\u5546\u4e1aUbuntu Advantage \u670d\u52a1\u5b9a\u65f6\u4efb\u52a1\uff08timer\uff09\u76f8\u5173\u7684\u65e5\u5fd7\u4fe1\u606f</li> <li>wtmp \u6587\u4ef6\u8bb0\u5f55\u4e86\u767b\u5f55\u6ce8\u9500\u4ee5\u53ca\u5173\u673a\u4fe1\u606f\u7684\u65e5\u5fd7\uff08\u540c\u6837\u4e0d\u80fd\u7528vim\u67e5\u770b\uff0c\u4f7f\u7528last\u547d\u4ee4\uff09</li> <li>bootstrap.log \u6587\u4ef6\u8bb0\u5f55\u4e86\u7cfb\u7edf\u5f15\u5bfc\uff08bootstrap\uff09\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e9b\u5173\u952e\u4fe1\u606f\u3002\u8fd9\u4e2a\u6587\u4ef6\u901a\u5e38\u5305\u542b\u4e86\u7cfb\u7edf\u542f\u52a8\u65f6\u7684\u65e5\u5fd7\uff0c\u4f8b\u5982\u5185\u6838\u52a0\u8f7d\u3001\u521d\u59cb\u5316\u8fdb\u7a0b\u3001\u786c\u4ef6\u68c0\u6d4b\u7b49\u3002</li> <li><code>cloud-init.log</code> \u6587\u4ef6\u8bb0\u5f55\u4e86 cloud-init\u670d\u52a1\u5728\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u7684\u6240\u6709\u6d3b\u52a8\u3002\u8fd9\u5305\u62ec\u5b83\u8bfb\u53d6\u7684\u6570\u636e\u6e90\u3001\u5e94\u7528\u7684\u914d\u7f6e\u3001\u6267\u884c\u7684\u547d\u4ee4\u7b49\u3002\u5982\u679c\u4f60\u9047\u5230\u4e91\u5b9e\u4f8b\u542f\u52a8\u95ee\u9898\u6216\u914d\u7f6e\u95ee\u9898\uff0c\u67e5\u770b\u6b64\u65e5\u5fd7\u6587\u4ef6\u901a\u5e38\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u8d77\u70b9\u3002</li> <li><code>dpkg.log</code> \u6587\u4ef6\u8bb0\u5f55\u4e86\u5b89\u88c5\u6216dpkg\u547d\u4ee4\u6e05\u9664\u8f6f\u4ef6\u5305\u7684\u65e5\u5fd7\u3002</li> <li>faillog \u6587\u4ef6\u8bb0\u5f55\u4e86\u7528\u6237\u767b\u5f55\u5931\u8d25\u4fe1\u606f\u3002\u6b64\u5916\uff0c\u9519\u8bef\u767b\u5f55\u547d\u4ee4\u4e5f\u4f1a\u8bb0\u5f55\u5728\u672c\u6587\u4ef6\u4e2d\u3002</li> <li>ubuntu-advantage.log \u6587\u4ef6\u8bb0\u5f55\u4e86\u662f\u5546\u4e1aUbuntu Advantage\u670d\u52a1\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u9488\u5bf9Ubuntu\u7cfb\u7edf\u7684\u589e\u503c\u529f\u80fd\uff0c\u5982\u57fa\u7840\u8bbe\u65bd\u652f\u6301\u3001\u5b89\u5168\u66f4\u65b0\u3001\u5408\u89c4\u6027\u4fdd\u8bc1\u7b49</li> </ul>"},{"location":"chap8/32Linux_logs/#2","title":"2 \u65e5\u5fd7\u7ea7\u522b","text":"<p>\u6839\u636e\u65e5\u5fd7\u4fe1\u606f\u7684\u91cd\u8981\u7a0b\u5ea6\u4e0d\u540c\uff0c\u5206\u4e3a\u4e0d\u540c\u7684\u7ea7\u522b \u6570\u5b57\u7ea7\u522b\u8d8a\u5c0f\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u6d88\u606f\u8d8a\u91cd\u8981</p> <p>\u7ea7\u522b \u82f1\u6587\u8868\u793a \u610f\u4e49</p> <ul> <li>0 EMERG\uff08\u7d27\u6025\uff09 \u5bfc\u81f4\u4e3b\u673a\u7cfb\u7edf\u4e0d\u53ef\u7528\u7684\u60c5\u51b5</li> <li>1 ALERT\uff08\u8b66\u544a\uff09 \u5fc5\u987b\u9a6c\u4e0a\u91c7\u53d6\u89e3\u51b3\u63aa\u65bd</li> <li>2 CRIT \u4e25\u91cd \u6bd4\u8f83\u4e25\u91cd\u7684\u60c5\u51b5</li> <li>3 ERR \u9519\u8bef \u8fd0\u884c\u51fa\u73b0\u9519\u8bef</li> <li>4 WARNING \u63d0\u9192 \u63d0\u9192\u7528\u6237\u7684\u91cd\u8981\u4e8b\u4ef6</li> <li>5 NOTICE \u6ce8\u610f \u4e0d\u4f1a\u513f\u5f71\u54cd\u7cfb\u7edf\uff0c\u63d0\u9192\u7528\u6237</li> <li>6 INFO \u4fe1\u606f \u4e00\u822c\u4fe1\u606f</li> <li>7 DEBUG \u8c03\u5f0f \u7a0b\u5e8f\u8c03\u5f0f</li> <li>8 None \u6ca1\u6709 \u4e0d\u505a\u8bb0\u5f55</li> </ul>"},{"location":"chap8/32Linux_logs/#3","title":"3 \u67e5\u770b\u548c\u89e3\u6790\u65e5\u5fd7\u6587\u4ef6\uff1a","text":"<p>\u5f53\u6211\u4eec\u67e5\u770b\u548c\u89e3\u6790Ubuntu\u4e2d\u7684\u65e5\u5fd7\u6587\u4ef6\u65f6\uff0c\u901a\u5e38\u4f1a\u4f7f\u7528\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5982cat\u3001tail\u3001grep\u7b49\u5de5\u5177\u3002</p> <p>\u8fd9\u4e9b\u5de5\u5177\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5feb\u901f\u5b9a\u4f4d\u548c\u5206\u6790\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\u5173\u952e\u4fe1\u606f</p> <p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u793a\u4f8b\uff0c\u5c55\u793a\u5982\u4f55\u4f7f\u7528\u8fd9\u4e9b\u5de5\u5177\u6765\u67e5\u770b\u548c\u89e3\u6790<code>/var/log/syslog</code>\u6587\u4ef6\uff1a</p>"},{"location":"chap8/32Linux_logs/#31","title":"3.1\u3001\u67e5\u770b\u6574\u4e2a\u65e5\u5fd7\u6587\u4ef6","text":"<pre><code>#\u4f7f\u7528cat\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u6574\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u5185\u5bb9\uff1a\ncat /var/log/syslog\n</code></pre>"},{"location":"chap8/32Linux_logs/#32","title":"3.2\u3001\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u6700\u540e\u51e0\u884c","text":"<p>\u4f7f\u7528tail\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u6700\u540e\u51e0\u884c\uff0c\u901a\u5e38\u7528\u4e8e\u76d1\u89c6\u5b9e\u65f6\u65e5\u5fd7\uff1a</p> <pre><code># \u67e5\u770b\u6700\u540e100\u884c  \ntail -n 100 /var/log/syslog  \n\n# \u5b9e\u65f6\u67e5\u770b\u65b0\u6dfb\u52a0\u7684\u65e5\u5fd7\ntail -f /var/log/syslog \n</code></pre>"},{"location":"chap8/32Linux_logs/#33","title":"3.3\u3001\u641c\u7d22\u7279\u5b9a\u7684\u65e5\u5fd7\u6761\u76ee","text":"<p>\u4f7f\u7528<code>grep</code>\u547d\u4ee4\u53ef\u4ee5\u641c\u7d22\u5305\u542b\u7279\u5b9a\u5173\u952e\u8bcd\u7684\u65e5\u5fd7\u6761\u76ee\uff1a</p> <pre><code># \u641c\u7d22\u5305\u542b\"error\"\u7684\u65e5\u5fd7\u6761\u76ee\ngrep \"error\" /var/log/syslog  \n</code></pre>"},{"location":"chap8/32Linux_logs/#34tailgrep","title":"3.4\u3001\u7ed3\u5408\u4f7f\u7528tail\u548cgrep","text":"<p>\u4f60\u53ef\u4ee5\u5c06tail\u548cgrep\u547d\u4ee4\u7ed3\u5408\u8d77\u6765\uff0c\u5b9e\u65f6\u641c\u7d22\u65b0\u6dfb\u52a0\u7684\u65e5\u5fd7\u4e2d\u7684\u7279\u5b9a\u6761\u76ee\uff1a</p> <pre><code>tail -f /var/log/syslog | grep \"error\"  # \u5b9e\u65f6\u641c\u7d22\u5305\u542b\"error\"\u7684\u65b0\u65e5\u5fd7\u6761\u76ee\n</code></pre>"},{"location":"chap8/32Linux_logs/#35less","title":"3.5\u3001\u4f7f\u7528less\u6d4f\u89c8\u5927\u578b\u65e5\u5fd7\u6587\u4ef6","text":"<p>\u5bf9\u4e8e\u975e\u5e38\u5927\u7684\u65e5\u5fd7\u6587\u4ef6\uff0cless\u547d\u4ee4\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5206\u9875\u67e5\u770b\u7684\u65b9\u5f0f\u3002</p> <p>\u5728less\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4e0a\u4e0b\u7bad\u5934\u952e\u6d4f\u89c8\u6587\u4ef6\uff0c\u6309<code>/</code>\u952e\u540e\u8f93\u5165\u5173\u952e\u8bcd\u8fdb\u884c\u641c\u7d22\uff0c\u6309q\u952e\u9000\u51fa\u67e5\u770b</p> <pre><code>less /var/log/syslog\n</code></pre>"},{"location":"chap8/32Linux_logs/#36","title":"3.6\u3001 \u67e5\u770b\u7279\u5b9a\u65f6\u95f4\u6bb5\u7684\u65e5\u5fd7","text":"<p>\u5982\u679c\u4f60\u77e5\u9053\u9519\u8bef\u53d1\u751f\u7684\u5927\u81f4\u65f6\u95f4\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528awk\u6765\u67e5\u770b\u7279\u5b9a\u65f6\u95f4\u6bb5\u7684\u65e5\u5fd7\uff1a</p> <pre><code># \u67e5\u770b3\u670827\u65e510\u70b9\u523011\u70b9\u7684\u65e5\u5fd7\nawk '/Mar 27 10:00:00/,/Mar 27 11:00:00/' /var/log/syslog  \n</code></pre> <p>\u4ee5\u4e0a\u793a\u4f8b\u5c55\u793a\u4e86\u57fa\u672c\u7684\u67e5\u770b\u548c\u89e3\u6790\u65e5\u5fd7\u6587\u4ef6\u7684\u65b9\u6cd5\u3002\u6839\u636e\u4f60\u7684\u5177\u4f53\u9700\u6c42\uff0c\u4f60\u53ef\u80fd\u8fd8\u9700\u8981\u4f7f\u7528\u66f4\u590d\u6742\u7684\u8fc7\u6ee4\u548c\u641c\u7d22\u6280\u672f\uff0c\u6216\u8005\u7ed3\u5408\u591a\u4e2a\u5de5\u5177\u6765\u5b9e\u73b0\u66f4\u7cbe\u786e\u7684\u5206\u6790\u3002</p> <p>\u540c\u65f6\uff0c\u5bf9\u4e8e\u7279\u5b9a\u7684\u65e5\u5fd7\u6587\u4ef6\uff08\u5982/var/log/auth.log\u3001/var/log/kern.log\u7b49\uff09\uff0c\u53ef\u80fd\u9700\u8981\u6839\u636e\u4e0d\u540c\u7684\u60c5\u51b5\uff0c\u8c03\u6574\u547d\u4ee4\u4ee5\u9002\u5e94\u4e0d\u540c\u7684\u683c\u5f0f\u548c\u5185\u5bb9\u3002</p>"},{"location":"chap8/32Linux_logs/#_1","title":"\u56db\u3001\u65e5\u5fd7\u7ba1\u7406","text":"<p>\u65e5\u5fd7\u7ba1\u7406\u901a\u5e38\u6d89\u53ca\u5230\u6536\u96c6\u3001\u5b58\u50a8\u3001\u5206\u6790\u548c\u76d1\u63a7\u65e5\u5fd7\u6587\u4ef6\u3002\u4e0b\u6587\u6574\u7406\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u65e5\u5fd7\u7ba1\u7406\u5de5\u5177\u548c\u65b9\u6cd5\uff1a</p>"},{"location":"chap8/32Linux_logs/#41rsyslogsyslog-ng","title":"4.1\u3001\u4f7f\u7528rsyslog\u6216syslog-ng\u6536\u96c6\u65e5\u5fd7","text":"<p>rsyslog\u548csyslog-ng\u662f\u5e38\u7528\u7684\u7cfb\u7edf\u65e5\u5fd7\u5b88\u62a4\u7a0b\u5e8f\uff0c\u7528\u4e8e\u6536\u96c6\u3001\u5904\u7406\u548c\u8f6c\u53d1\u7cfb\u7edf\u65e5\u5fd7\u3002\u6211\u4eec\u53ef\u4ee5\u914d\u7f6e\u5b83\u4eec\u6765\u5c06\u65e5\u5fd7\u53d1\u9001\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\u6216\u672c\u5730\u6587\u4ef6</p>"},{"location":"chap8/32Linux_logs/#42logwatch","title":"4.2\u3001\u4f7f\u7528logwatch\u5206\u6790\u65e5\u5fd7","text":"<p>logwatch\u662f\u4e00\u4e2a\u65e5\u5fd7\u5206\u6790\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u751f\u6210\u65e5\u5fd7\u62a5\u544a\u7684\u6458\u8981\uff0c\u5e2e\u52a9\u4f60\u5feb\u901f\u8bc6\u522b\u6f5c\u5728\u7684\u95ee\u9898\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6elogwatch\u6765\u5b9a\u671f\u53d1\u9001\u8fd9\u4e9b\u62a5\u544a</p>"},{"location":"chap8/32Linux_logs/#43elk","title":"4.3\u3001\u4f7f\u7528ELK\u8fdb\u884c\u65e5\u5fd7\u96c6\u4e2d\u7ba1\u7406","text":"<p>ELK\uff08Elasticsearch\u3001Logstash\u548cKibana\uff09\u662f\u4e00\u4e2a\u73b0\u5982\u4eca\u6bd4\u8f83\u6d41\u884c\u7684\u65e5\u5fd7\u96c6\u4e2d\u7ba1\u7406\u89e3\u51b3\u65b9\u6848\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528Logstash\u6765\u6536\u96c6\u3001\u89e3\u6790\u548c\u8f6c\u6362\u65e5\u5fd7\uff0c\u7136\u540e\u4f7f\u7528Elasticsearch\u8fdb\u884c\u5b58\u50a8\u548c\u641c\u7d22\uff0c\u6700\u540e\u901a\u8fc7Kibana\u8fdb\u884c\u53ef\u89c6\u5316\u548c\u5206\u6790</p>"},{"location":"chap8/32Linux_logs/#44journalctlsystemd","title":"4.4\u3001\u4f7f\u7528journalctl\u67e5\u770bsystemd\u65e5\u5fd7","text":"<p>Ubuntu\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6bd4\u8f83\u5f3a\u5927\u7684systemd\u65e5\u5fd7\u5de5\u5177journalctl\uff0c\u65b9\u4fbf\u6211\u4eec\u67e5\u770b\u548c\u7ba1\u7406systemd\u7cfb\u7edf\u7684\u65e5\u5fd7\u3002</p> <pre><code>journalctl            # \u67e5\u770b\u6240\u6709\u65e5\u5fd7  \njournalctl -u nginx   # \u67e5\u770bnginx\u670d\u52a1\u7684\u65e5\u5fd7  \njournalctl -b         # \u67e5\u770b\u81ea\u672c\u6b21\u542f\u52a8\u4ee5\u6765\u7684\u65e5\u5fd7\n</code></pre> <p>\u4ee5\u4e0a\u793a\u4f8b\u6db5\u76d6\u4e86\u65e5\u5fd7\u7ba1\u7406\u7684\u4e00\u4e9b\u57fa\u7840\u65b9\u9762\u3002\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u65e5\u5fd7\u7ba1\u7406\u53ef\u80fd\u6839\u636e\u673a\u5236\u66f4\u52a0\u7e41\u6742\uff0c\u4e0e\u9700\u6c42\u548c\u73af\u5883\u78e8\u5408\u548c\u4f18\u5316\u3002</p>"},{"location":"chap8/33bash/","title":"Linux \u4e2d <code>.bashrc</code>\u3001<code>.bash-profile</code> \u548c <code>.profile</code> \u4e4b\u95f4\u7684\u533a\u522b","text":""},{"location":"chap8/33bash/#2-shell","title":"2. \u4ea4\u4e92\u5f0f \u548c \u975e\u4ea4\u4e92\u5f0f Shell","text":""},{"location":"chap8/33bash/#21-shellinteractive-shell","title":"2.1 \u4ea4\u4e92\u5f0f Shell\uff08Interactive Shell\uff09","text":"<p>\u6307\u901a\u8fc7\u7ec8\u7aef\u8f93\u5165\u547d\u4ee4\u5e76\u83b7\u5f97\u6267\u884c\u7ed3\u679c\u7684 shell\uff0c\u5176\u63d0\u4f9b\u4e24\u79cd\u6a21\u5f0f\uff1a\u4ea4\u4e92\u5f0f\u767b\u5f55\u548c\u4ea4\u4e92\u5f0f\u975e\u767b\u5f55 shell\u3002</p> <p>Bash \u8c03\u7528\u65f6\uff0c\u4f1a\u4ece\u4e00\u7ec4\u542f\u52a8\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5e76\u6267\u884c\u547d\u4ee4,\u8bfb\u53d6\u54ea\u4e9b\u6587\u4ef6\u53d6\u51b3\u4e8e shell \u662f\u4f5c\u4e3a\u4ea4\u4e92\u5f0f\u767b\u5f55\u8fd8\u662f\u975e\u767b\u5f55 shell \u8c03\u7528\u3002</p> <p>\u4ea4\u4e92\u5f0f\u767b\u5f55 Shell\uff1a</p> <p>\u6307\u9700\u8981\u7528\u6237\u540d\u3001\u5bc6\u7801\u767b\u5f55\u540e\u624d\u80fd\u8fdb\u5165\u7684 shell\uff0c\u4f8b\u5982\uff1a\u901a\u8fc7 ssh \u6216\u672c\u5730\u8fdc\u7a0b\u767b\u5f55\u5230\u7ec8\u7aef\uff0c\u8fd8\u6709\u5c31\u662f\u4f7f\u7528 <code>--login</code> \u9009\u9879\u542f\u52a8 <code>Bash</code>\uff1b</p> <p>\u5f53 Bash \u4f5c\u4e3a\u4ea4\u4e92\u5f0f\u767b\u5f55 shell \u8c03\u7528\u65f6\uff0c\u5b83\u5c06\u67e5\u627e <code>/etc/profile</code> \u6587\u4ef6\uff0c\u5982\u679c\u8be5\u6587\u4ef6\u5b58\u5728\uff0c\u5b83\u5c06\u8fd0\u884c\u6587\u4ef6\u4e2d\u5217\u51fa\u7684\u547d\u4ee4\uff0c\u7136\u540e Bash \u5c06\u6309\u4ee5\u4e0b\u7684\u987a\u5e8f\u641c\u7d22 <code>~/.bash_profile</code>\u3001<code>~/.bash_login</code> \u548c <code>~/.profile</code> \u6587\u4ef6\uff0c\u5e76\u5728\u7b2c\u4e00\u4e2a\u627e\u5230\u7684\u6587\u4ef6\u4e2d\u6267\u884c\u547d\u4ee4\u3002</p> <p>Bash \u542f\u52a8\u6587\u4ef6\u641c\u7d22\u6267\u884c\u987a\u5e8f\uff1a</p> <ul> <li><code>/etc/profile</code>\uff1a\u8bbe\u7f6e\u7cfb\u7edf\u7ea7\u7684\u73af\u5883\u53d8\u91cf\u548c\u542f\u52a8\u7a0b\u5e8f\uff0c\u5bf9\u5168\u5c40\u7528\u6237\u751f\u6548\uff1b</li> <li><code>/etc/profile.d</code>\uff1a\u5b58\u653e\u5e94\u7528\u7a0b\u5e8f\u6240\u9700\u7684\u542f\u52a8\u811a\u672c\uff0c\u5176\u4e2d\u5305\u62ec\u4e86\u989c\u8272\u3001\u8bed\u8a00\u3001less\u3001vim \u53ca which \u7b49\u547d\u4ee4\u7684\u4e00\u4e9b\u9644\u52a0\u8bbe\u7f6e\uff0c\u8fd9\u4e9b\u811a\u672c\u6587\u4ef6\u4e4b\u6240\u4ee5\u80fd\u591f\u88ab\u81ea\u52a8\u6267\u884c\uff0c\u662f\u56e0\u4e3a\u5728 <code>/etc/profile</code> \u4e2d\u4f7f\u7528\u4e00\u4e2a for \u5faa\u73af\u8bed\u53e5\u6765\u8c03\u7528\u8fd9\u4e9b\u811a\u672c;</li> </ul> <pre><code>if [ -d /etc/profile.d ]; then\nfor i in /etc/profile.d/*.sh; do\nif [ -r $i ]; then\n  . $i\nfi\ndone\nunset i\nfi\n</code></pre> <ul> <li><code>~/.bash_profile</code>\uff1a \u5f53\u524d\u7528\u6237\u4e2a\u4eba\u914d\u7f6e\u811a\u672c\uff0c\u5982\u679c\u8be5\u811a\u672c\u5b58\u5728\uff0c\u5219\u6267\u884c\u5b8c\u5c31\u4e0d\u518d\u5f80\u4e0b\u641c\u7d22\u6267\u884c\uff1b</li> <li><code>~/.bash_login</code>\uff1a\u5982\u679c <code>~/.bash_profile</code> \u6ca1\u627e\u5230\uff0c\u8be5\u811a\u672c\u5b58\u5728\u5219\u5c1d\u8bd5\u6267\u884c\u8fd9\u4e2a\u811a\u672c\uff0c\u6267\u884c\u5b8c\u5c31\u4e0d\u518d\u5f80\u4e0b\u641c\u7d22\u6267\u884c\uff1b</li> <li>\uff08Ubuntu\uff09<code>~/.profile</code>\uff08\u6216\u8005 <code>~/.bash_profile</code>\uff09\uff1a\u5982\u679c <code>~/.bash_profile</code> \u548c <code>~/.bash_login</code> \u90fd\u6ca1\u627e\u5230\uff0c\u5219\u5c1d\u8bd5\u8bfb\u53d6\u8fd9\u4e2a\u811a\u672c\uff1b</li> </ul> <p>\u6ce8\u610f\uff1a</p> <p>Linux \u53d1\u884c\u7248\u66f4\u65b0\u7684\u65f6\u5019\uff0c\u4f1a\u66f4\u65b0 <code>/etc</code> \u91cc\u9762\u7684\u6587\u4ef6\uff0c\u6bd4\u5982 <code>/etc/profile</code>\uff0c\u56e0\u6b64\u5efa\u8bae\u4e0d\u8981\u76f4\u63a5\u4fee\u6539\u8fd9\u4e2a\u6587\u4ef6\u3002\u5982\u679c\u60f3\u4fee\u6539\u6240\u6709\u7528\u6237\u7684\u73af\u5883\u53c2\u6570\uff0c\u5efa\u8bae\u5728 <code>/etc/profile.d</code> \u76ee\u5f55\u91cc\u9762\u65b0\u5efa <code>.sh</code> \u811a\u672c\uff0c\u5982\u679c\u60f3\u4fee\u6539\u4e2a\u4eba\u767b\u5f55\u73af\u5883\uff0c\u4e00\u822c\u662f\u5199\u5728 <code>~/.bash_profile</code> \u91cc\u9762\u3002</p>"},{"location":"chap8/33bash/#shell","title":"\u4ea4\u4e92\u5f0f\u975e\u767b\u5f55 shell\uff1a","text":"<p>\u6307\u4e0d\u9700\u8981\u7528\u6237\u540d\u548c\u5bc6\u7801\u5373\u53ef\u6253\u5f00\u7684 shell\uff0c\u4f8b\u5982\uff1a\u76f4\u63a5\u547d\u4ee4 \u201cbash\u201d \u5c31\u662f\u6253\u5f00\u4e00\u4e2a\u65b0\u7684\u975e\u767b\u5f55 shell\uff0c\u6216\u8005\u5728 Linux Gnome \u684c\u9762\u73af\u5883\u6253\u5f00\u4e00\u4e2a\u201c\u7ec8\u7aef\uff08terminal\uff09\u201d\u7a97\u53e3\u4e5f\u662f\u4e00\u4e2a\u975e\u767b\u5f55 shell\u3002</p> <p>Bash \u542f\u52a8\u6587\u4ef6\u641c\u7d22\u6267\u884c\u987a\u5e8f\uff1a</p> <ul> <li>\uff08Ubuntu\uff09<code>/etc/bash.bashrc</code>\uff08\u6216\u8005/etc/bashrc\uff09\uff1a \u5bf9\u5168\u5c40\u7528\u6237\u751f\u6548\uff1b</li> <li><code>~/.bashrc</code>\uff1a \u4ec5\u5bf9\u5f53\u524d\u7528\u6237\u6709\u6548\uff1b</li> </ul>"},{"location":"chap8/33bash/#shell-non-interactive-shell","title":"\u975e\u4ea4\u4e92\u5f0f Shell (Non-Interactive Shell)","text":"<p>\u6307\u4e0d\u4e0e\u7ec8\u7aef\u5173\u8054\uff0c\u4e00\u822c\u662f\u6267\u884c\u4e00\u4e2a\u547d\u4ee4\u3001\u4e00\u4e2a\u811a\u672c\u7684 shell \uff0c\u901a\u5e38\u4e0d\u9700\u8981\u4eba\u5de5\u5e72\u9884\uff0c\u4f8b\u5982\u7cfb\u7edf\u7ef4\u62a4\u811a\u672c\u3001\u540e\u53f0\u811a\u672c\u7b49\u3002</p> <p>\u8be5\u7c7b\u578b shell \u4e0d\u6267\u884c\u4efb\u4f55\u542f\u52a8\u6587\u4ef6\uff0c\u5b83\u4ece\u521b\u5efa\u5b83\u7684 shell \u7ee7\u627f\u73af\u5883\u53d8\u91cf\u3002</p>"},{"location":"chap8/33bash/#3-bash","title":"3. Bash \u542f\u52a8\u6587\u4ef6","text":""},{"location":"chap8/33bash/#31-etcprofile","title":"3.1 /etc/profile","text":"<p>\u7528\u4e8e\u8bbe\u7f6e\u7cfb\u7edf\u7ea7\u7684\u73af\u5883\u53d8\u91cf\u548c\u542f\u52a8\u7a0b\u5e8f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u4f1a\u5bf9\u6240\u6709\u7528\u6237\u751f\u6548\u3002\u4e00\u822c\u4e0d\u5efa\u8bae\u5728 <code>/etc/profile</code> \u6587\u4ef6\u4e2d\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\uff0c\u56e0\u4e3a\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u6dfb\u52a0\u7684\u8bbe\u7f6e\u4f1a\u5bf9\u6240\u6709\u7528\u6237\u8d77\u4f5c\u7528\u3002\u5f53\u5fc5\u987b\u6dfb\u52a0\u65f6\uff0c\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u6dfb\u52a0\uff1a</p> <p>\u793a\u4f8b\uff1a\u6dfb\u52a0\u4e00\u4e2a <code>\u201cTEST_BASH\u201d</code> \u503c\u4e3a \u201clinux\u201d \u7684\u73af\u5883\u53d8\u91cf\uff1a</p> <p>vi /etc/profile</p> <pre><code>...\nTEST_BASH=linux\n</code></pre> <p>\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\u540e\uff0c\u9700\u8981\u91cd\u65b0\u767b\u5f55\u624d\u80fd\u751f\u6548\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 source \u547d\u4ee4\u5f3a\u5236\u7acb\u5373\u751f\u6548\uff1a</p> <pre><code>echo $TEST_BASH\nlinux\n</code></pre> <p>\u6216\u8005 <code>/etc/profile.d</code> \u76ee\u5f55\u91cc\u9762\u65b0\u5efa <code>.sh</code> \u811a\u672c\uff1a</p> <p>vi /etc/profile.d/test.sh</p> <pre><code>TEST_BASH=linux\n</code></pre> <p>\u4fdd\u5b58\uff0c\u9a8c\u8bc1\u53ef\u8fbe\u5230\u540c\u6837\u6548\u679c\uff1b</p>"},{"location":"chap8/33bash/#32-bash_profile","title":"3.2. <code>.bash_profile</code>","text":"<p><code>.bash_profile</code> \u7528\u6237\u7ea7\u7684\u8bbe\u7f6e\uff0c\u53ea\u5bf9\u5355\u4e00\u7528\u6237\u6709\u6548\uff0c\u6587\u4ef6\u5b58\u50a8\u4e8e <code>~/.bash_profile</code>\uff0c\u548c profile \u6587\u4ef6\u7c7b\u4f3c\uff0c<code>bash_profile</code> \u4e5f\u4f1a\u5728\u7528\u6237\u767b\u5f55\uff08login\uff09\u65f6\u751f\u6548\uff0c\u4f46\u4e0e profile \u4e0d\u540c\u7684\u662f <code>bash_profile</code> \u53ea\u4f1a\u5bf9\u5f53\u524d\u7528\u6237\u751f\u6548\u3002</p> <p>\u793a\u4f8b\uff1a\u8bbe\u7f6e\u548c\u5bfc\u51faPATH\u53d8\u91cf</p> <p><code>vi ~/.bash_profile</code></p> <pre><code>echo \"Bash_profile execution starts..\"  \nPATH=$PATH:$HOME/bin; \nexport PATH; \necho \"Bash_profile execution stops..\"\n</code></pre> <p>\u4ee5\u4ea4\u4e92\u5f0f\u767b\u5f55 shell \u6253\u5f00\uff1a\u53ef\u4ee5\u770b\u5230\u547d\u4ee4\u63d0\u793a\u7b26\u524d\u81ea\u5b9a\u4e49\u7684\u8f93\u51fa\uff1a</p> <pre><code>Last login: Mon Apr  1 17:46:37 2024 from 10.40.2.83\nBash_profile execution starts..\nBash_profile execution stops..\n</code></pre>"},{"location":"chap8/33bash/#33-bashrc","title":"3.3. <code>.bashrc</code>","text":"<p>bashrc \u6587\u4ef6\u7528\u4e8e\u914d\u7f6e\u51fd\u6570\u6216\u522b\u540d\uff0c\u6709\u4e24\u79cd\u7ea7\u522b\uff1a</p> <p>\u7cfb\u7edf\u7ea7:\u7cfb\u7edf\u7ea7\u7684\u4f4d\u4e8e <code>/etc/bashrc</code>\uff0c\u5bf9\u6240\u6709\u7528\u6237\u751f\u6548;</p> <p>\u7528\u6237\u7ea7:\u7528\u6237\u7ea7\u7684\u4f4d\u4e8e<code>~/.bashrc</code>\uff0c\u4ec5\u5bf9\u5f53\u524d\u7528\u6237\u751f\u6548;</p> <p>bashrc \u6587\u4ef6\u53ea\u4f1a\u5bf9\u6307\u5b9a\u7684 shell \u7c7b\u578b\u8d77\u4f5c\u7528\uff0cbashrc \u53ea\u4f1a\u88ab bash shell \u8c03\u7528\u3002</p> <p>\u793a\u4f8b .bashrc \u6587\u4ef6\uff1a</p> <p><code>vi ~/.bashrc</code></p> <pre><code>echo \"Bashrc execution starts..\" \nalias elui='top -c -u $USER' \nalias ll='ls -lrt' \necho \"Bashrc execution stops..\"\n</code></pre> <p>\u4ea4\u4e92\u5f0f\u975e\u767b\u5f55 shell \u6267\u884c\uff0c\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u4e4b\u524d\u770b\u5230\u4ee5\u4e0b\u8f93\u51fa\uff1a</p> <pre><code>$ bash\nBashrc execution starts..\nBashrc execution stops..\n</code></pre>"},{"location":"chap8/33bash/#34-bash_logout","title":"3.4 <code>.bash_logout</code>","text":"<p>~/.bash_logout \u6bcf\u6b21\u9000\u51fa shell \u65f6\u6267\u884c\uff0c\u901a\u5e38\u7528\u6765\u505a\u4e00\u4e9b\u6e05\u7406\u5de5\u4f5c\u548c\u8bb0\u5f55\u5de5\u4f5c\uff0c\u6bd4\u5982\u5220\u9664\u4e34\u65f6\u6587\u4ef6,\u5982\u679c\u6ca1\u6709\u9000\u51fa\u65f6\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u53ef\u4ee5\u4e0d\u5b58\u5728\u3002</p>"},{"location":"chap8/33bash/#4-bashrc-bash_profile","title":"4. .bashrc \u548c .bash_profile \u4e4b\u95f4\u7684\u533a\u522b","text":"<p><code>.bash_profile</code>\uff1a\u4ea4\u4e92\u5f0f\u767b\u5f55 shell \u8c03\u7528\u65f6\u8bfb\u53d6\u548c\u6267\u884c\uff0c\u7528\u4e8e\u53ea\u8fd0\u884c\u4e00\u6b21\u7684\u547d\u4ee4\uff0c\u4f8b\u5982\u81ea\u5b9a\u4e49\u73af\u5883\u53d8\u91cf\u3002</p> <p>.bashrc\uff1a\u4ea4\u4e92\u5f0f\u975e\u767b\u5f55 shell \u8c03\u7528\u65f6\u8bfb\u53d6\u548c\u6267\u884c\uff0c\u6bcf\u6b21\u542f\u52a8\u65b0 shell \u65f6\u5e94\u8fd0\u884c\u7684\u547d\u4ee4\u653e\u5165\u8be5\u6587\u4ef6\u4e2d\uff0c\u5305\u62ec\u522b\u540d\u548c\u51fd\u6570\u3001\u81ea\u5b9a\u4e49\u63d0\u793a\u3001\u5386\u53f2\u8bb0\u5f55\u7b49\u3002</p> <p>\u901a\u5e38\uff0c\u73af\u5883\u53d8\u91cf\u653e\u5728 <code>.bash_profile</code>\u4e2d\uff0c\u7531\u4e8e\u4ea4\u4e92\u5f0f\u767b\u5f55 shell \u662f\u7b2c\u4e00\u4e2ashell\uff0c\u56e0\u6b64\u73af\u5883\u8bbe\u7f6e\u6240\u9700\u7684\u6240\u6709\u9ed8\u8ba4\u8bbe\u7f6e\u90fd\u653e\u5728<code>.bash_profile</code>\u4e2d\uff0c\u5b83\u4eec\u53ea\u88ab\u8bbe\u7f6e\u4e00\u6b21\uff0c\u6240\u6709\u5b50 shell \u5c06\u88ab\u7ee7\u627f\u3002</p> <p>\u540c\u6837\uff0c\u522b\u540d\u548c\u51fd\u6570\u653e\u5728 <code>.bashrc</code> \u4e2d\uff0c\u786e\u4fdd\u6bcf\u6b21\u4ece\u73b0\u6709\u73af\u5883\u4e2d\u542f\u52a8 shell \u65f6\u90fd\u52a0\u8f7d\u5b83\u4eec\uff0c\u540c\u65f6\u4e3a\u4e86\u907f\u514d\u767b\u5f55\u548c\u975e\u767b\u5f55\u4ea4\u4e92 shell \u8bbe\u7f6e\u7684\u5dee\u5f02\uff0c\u5c06\u4e0b\u9762\u7684\u4ee3\u7801\u7247\u6bb5\u63d2\u5165\u5230 <code>.bash_profile</code> \u4e2d\uff0c\u5b9e\u73b0 <code>.bash_profile</code> \u8c03\u7528 .bashrc\uff0c\u8fd9\u6837\u5728\u6bcf\u4e2a\u4ea4\u4e92\u5f0f\u767b\u5f55 shell\u4e2d\uff0c<code>.bashrc</code> \u4e5f\u4f1a\u5728\u540c\u4e00\u4e2a shell \u4e2d\u6267\u884c:</p> <pre><code>if [ -f ~/.bashrc ];\nthen \n    .  ~/.bashrc; \nfi \nPATH=$PATH:$HOME/bin export PATH\n</code></pre>"},{"location":"chap8/34linux_6logs/","title":"6\u5927Linux\u547d\u4ee4\u7ebf\u4e0a\u65e5\u5fd7\u6392\u67e5","text":"<ol> <li>tail\u547d\u4ee4</li> <li>cat\u547d\u4ee4</li> <li>grep\u547d\u4ee4</li> <li>split\u547d\u4ee4</li> <li>sed\u547d\u4ee4</li> <li>head\u547d\u4ee4</li> </ol>"},{"location":"chap8/34linux_6logs/#1tail","title":"1\u3001tail\u547d\u4ee4","text":"<p>1\u3001\u67e5\u770b\u5b9e\u65f6\u65e5\u5fd7</p> <pre><code>tail -f info.log\n</code></pre> <p>2\u3001\u5206\u9875\u67e5\u770b\u524d1000\u884c\u65e5\u5fd7</p> <p>\u6267\u884c\u547d\u4ee4\u540e\uff0c\u5c06\u9010\u9875\u770b\u5230<code>\"info.log\"</code>\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u6309\u4e0b\u7a7a\u683c\u952e\u53ef\u4ee5\u5411\u4e0b\u7ffb\u9875\uff0c\u6309\u4e0b\"q\"\u952e\u53ef\u4ee5\u9000\u51fa\u5206\u9875\u67e5</p> <pre><code>tail -n 1000 info.log |more\n</code></pre> <p>3\u3001\u663e\u793ainfo.log\u6700\u540e20\u884c</p> <pre><code>tail -n 20 info.log\n</code></pre> <p>4\u3001\u5012\u5e8f\u663e\u793ainfo.log\u6700\u540e10\u884c</p> <pre><code>tail -r -n 10 info.log\n</code></pre>"},{"location":"chap8/34linux_6logs/#2cat","title":"2\u3001cat\u547d\u4ee4","text":""},{"location":"chap8/34linux_6logs/#1","title":"1\u3001\u5206\u9875\u67e5\u770b\u6240\u6709\u65e5\u5fd7","text":"<p>\u5c06\u540d\u4e3a\"info.log\"\u7684\u6587\u4ef6\u7684\u5185\u5bb9\u8f93\u51fa\u5230\u7ec8\u7aef\uff0c\u5e76\u4f7f\u7528\u5206\u9875\u5668\"more\"\u8fdb\u884c\u5206\u9875\u663e\u793a\u3002\u8fd9\u6837\u53ef\u4ee5\u9010\u9875\u67e5\u770b\u6587\u4ef6\u7684\u5185\u5bb9\u3002</p> <p>\u6267\u884c\u547d\u4ee4\u540e\uff0c\u5c06\u9010\u9875\u770b\u5230\"info.log\"\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u6309\u4e0b\u7a7a\u683c\u952e\u53ef\u4ee5\u5411\u4e0b\u7ffb\u9875\uff0c\u6309\u4e0b\"q\"\u952e\u53ef\u4ee5\u9000\u51fa\u5206\u9875\u67e5\u770b\u6a21\u5f0f\u3002</p> <pre><code>cat info.log | more\n</code></pre> <p>2 \u5b83\u7684\u4f5c\u7528\u662f\u5728\u540d\u4e3a\"info.log\"\u7684\u6587\u4ef6\u4e2d\u641c\u7d22\u5305\u542b\"\u5173\u952e\u5b57\"\u7684\u884c\uff0c\u5e76\u663e\u793a\u5305\u542b\u5173\u952e\u5b57\u7684\u884c\u548c\u4e4b\u524d\u768410\u884c\u4ee5\u53ca\u4e4b\u540e\u768410\u884c\u3002</p> <pre><code>cat info.log | grep -n -B10 -A10 \"\u5173\u952e\u5b57\"\n</code></pre> <p>3\u3001\u67e5\u770b\u65e5\u5fd7\uff0c\u4ece\u7b2c1000\u884c\u5f00\u59cb\uff0c\u663e\u793a500\u884c</p> <pre><code>cat info.log |tail -n +1000|head -n 500\n</code></pre> <p>4\u3001\u67e5\u770b\u65e5\u5fd7\uff0c\u663e\u793a1350\u884c\u52301400\u884c</p> <pre><code>cat info.log | head -n 1400| tail -n +1350\n</code></pre>"},{"location":"chap8/34linux_6logs/#3grep","title":"3\u3001grep\u547d\u4ee4","text":"<p>1\u3001\u5728\u540d\u4e3a\"info.log\"\u7684\u65e5\u5fd7\u4e2d\u641c\u7d22\u5305\u542b\"parttern\"\u5173\u952e\u5b57\u7684\u884c\uff0c\u5e76\u663e\u793a\u5339\u914d\u884c\u4ee5\u53ca\u6bcf\u4e2a\u5339\u914d\u884c\u524d\u540e5\u884c\u5185\u5bb9</p> <pre><code>grep -5 \u2018parttern\u2019 info.log\n</code></pre> <p>2\u3001\u5728\u540d\u4e3a\"info.log\"\u7684\u65e5\u5fd7\u4e2d\u641c\u7d22\u5305\u542b\"parttern\"\u5173\u952e\u5b57\u7684\u884c\uff0c\u5e76\u663e\u793a\u5339\u914d\u884c\u4ee5\u53ca\u6bcf\u4e2a\u5339\u914d\u884c\u524d\u540e\u54045\u884c\u7684\u5185\u5bb9\uff08\u63d0\u4f9b\u4e86\u5339\u914d\u884c\u524d\u540e\u7684\u66f4\u591a\u4e0a\u4e0b\u6587\u4fe1\u606f\uff09</p> <pre><code>grep -C 5 \u2018parttern\u2019 info.log\n</code></pre> <p>3\u3001\u5728\u540d\u4e3a\"info.log\"\u7684\u65e5\u5fd7\u4e2d\u641c\u7d22\u5305\u542b\"parttern\"\u5173\u952e\u5b57\u7684\u884c\uff0c\u5e76\u663e\u793a\u5339\u914d\u884c\u4ee5\u53ca\u6bcf\u4e2a\u5339\u914d\u884c\u4e4b\u540e\u76845\u884c\u7684\u5185\u5bb9</p> <pre><code>grep -A 5 \u2018parttern\u2019 info.log\n</code></pre> <p>4\u3001\u5728\u540d\u4e3a\"info.log\"\u7684\u65e5\u5fd7\u4e2d\u641c\u7d22\u5305\u542b\"parttern\"\u5173\u952e\u5b57\u7684\u884c\uff0c\u5e76\u663e\u793a\u5339\u914d\u884c\u4ee5\u53ca\u6bcf\u4e2a\u5339\u914d\u884c\u4e4b\u524d\u76845\u884c\u7684\u5185\u5bb9</p> <pre><code>grep -B 5 \u2018parttern\u2019 info.log\n</code></pre> <p>5\u3001\u5173\u952e\u5b57\u52a0\u989c\u8272\u663e\u793a</p> <p>\u6b64\u547d\u4ee4\u5c06\u641c\u7d22'pattern'\u5e76\u663e\u793a\u5339\u914d\u884c\u53ca\u5176\u524d\u540e\u54045\u884c\u7684\u5185\u5bb9\uff0c\u5e76\u4f7f\u7528\u989c\u8272\u7a81\u51fa\u663e\u793a\u5173\u952e\u5b57</p> <pre><code>rep --color -C 5 'pattern' info.log\n</code></pre>"},{"location":"chap8/34linux_6logs/#4split","title":"4\u3001split\u547d\u4ee4","text":"<p>1\u3001\u65e5\u5fd7\u6587\u4ef6\u592a\u5927\uff0c\u5bf9\u65e5\u5fd7\u6587\u4ef6\u6309\u884c\u6570\u5207\u5272\u67e5\u770b</p> <pre><code>split -l 50000 info.log newfile_ --verbose\n</code></pre> <p>\u6267\u884c\u8be5\u547d\u4ee4\u540e\uff0c\u4f1a\u5c06<code>info.log</code>\u6587\u4ef6\u62c6\u5206\u4e3a\u591a\u4e2a\u65b0\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5305\u542b<code>50000</code>\u884c\uff0c\u5e76\u663e\u793a\u62c6\u5206\u8fc7\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u65b0\u6587\u4ef6\u7684\u547d\u540d\u89c4\u5219\u4e3a<code>newfile_</code>\u540e\u63a5\u4e00\u4e2a\u540e\u7f00\u5e8f\u53f7\uff0c\u4f8b\u5982<code>newfile_aa</code>\u3001<code>newfile_ab</code>\u3001<code>newfile_ac</code>\u7b49\u3002</p> <ul> <li>split: split\u547d\u4ee4\u7528\u4e8e\u62c6\u5206\u6587\u4ef6\u3002</li> <li><code>-l 50000</code>: \u4f7f\u7528-l\u9009\u9879\u6307\u5b9a\u6bcf\u4e2a\u62c6\u5206\u6587\u4ef6\u5305\u542b\u7684\u884c\u6570\u4e3a50000\u884c\u3002</li> <li><code>info.log:</code> \u8981\u62c6\u5206\u7684\u539f\u59cb\u6587\u4ef6\u540d\u3002</li> <li><code>newfile_</code>: \u62c6\u5206\u540e\u7684\u65b0\u6587\u4ef6\u7684\u524d\u7f00\u540d\u3002\u6bcf\u4e2a\u65b0\u6587\u4ef6\u5c06\u4ee5\u8be5\u524d\u7f00\u540d\u5f00\u5934\uff0c\u5e76\u5728\u672b\u5c3e\u6dfb\u52a0\u4e00\u4e2a\u540e\u7f00\u5e8f\u53f7\u3002</li> <li><code>--verbose</code>: \u4f7f\u7528<code>--verbose</code>\u9009\u9879\u663e\u793a\u62c6\u5206\u8fc7\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u62c6\u5206\u540e\u7684\u6587\u4ef6\u540d\u548c\u5927\u5c0f\u7b49\u3002</li> </ul> <p>2\u3001\u65e5\u5fd7\u6587\u4ef6\u592a\u5927\uff0c\u5bf9\u65e5\u5fd7\u6587\u4ef6\u6309\u5927\u5c0f\u5207\u5272\u67e5\u770b</p> <pre><code>split -b 40m info.log -d newfile_ --verbose\n</code></pre> <p>\u6267\u884c\u8be5\u547d\u4ee4\u540e\uff0c\u4f1a\u5c06info.log\u6587\u4ef6\u62c6\u5206\u4e3a\u591a\u4e2a\u65b0\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5927\u5c0f\u4e3a40m</p>"},{"location":"chap8/34linux_6logs/#5sed","title":"5\u3001sed\u547d\u4ee4","text":"<p>1\u3001\u5220\u9664info.log\u65e5\u5fd7\u6587\u4ef6\u5185\u5305\u62ec\u201c\u5173\u952e\u8bcd\u201d\u7684\u884c</p> <pre><code>sed -i '/\u5173\u952e\u8bcd/d' info.log\n</code></pre> <p>2\u3001\u622a\u53d6\u65e5\u5fd7\u4e00\u4e2a\u65f6\u95f4\u6bb5\u5185\u7684\u65e5\u5fd7\u5230\u4e34\u65f6\u6587\u4ef6\u5185</p> <pre><code>sed -n '/2024-04-24 18:47/,/2024-04-24 18:50/p' info.log &gt; tmp.log\n</code></pre> <ul> <li>sed: sed\u547d\u4ee4\u7528\u4e8e\u5bf9\u6587\u672c\u8fdb\u884c\u5904\u7406\u548c\u8f6c\u6362\u3002</li> <li><code>-n</code>: \u4f7f\u7528-n\u9009\u9879\u8868\u793a\u53ea\u8f93\u51fa\u7ecf\u8fc7\u7279\u5b9a\u5904\u7406\u7684\u7ed3\u679c\uff0c\u4e0d\u8fdb\u884c\u9ed8\u8ba4\u7684\u884c\u8f93\u51fa\u3002</li> <li><code>'/2024-04-24 18:47/,/2024-04-24 18:50/p':</code> \u8fd9\u662fsed\u7684\u5730\u5740\u8303\u56f4\u8868\u8fbe\u5f0f\uff0c\u8868\u793a\u9009\u62e9\u4ece\u5339\u914d\"2024-04-24 18:47\"\u5f00\u59cb\u5230\u5339\u914d\"2024-04-24 18:50\"\u7ed3\u675f\u4e4b\u95f4\u7684\u884c\u3002</li> <li>info.log: \u8981\u5904\u7406\u7684\u539f\u59cb\u6587\u4ef6\u540d\u3002</li> <li><code>&gt; tmp.log</code>: \u4f7f\u7528\u91cd\u5b9a\u5411\u7b26\u53f7\u5c06\u5904\u7406\u7ed3\u679c\u8f93\u51fa\u5230tmp.log\u6587\u4ef6\u4e2d\u3002</li> </ul> <p>\u6267\u884c\u8be5\u547d\u4ee4\u540e\uff0c\u4f1a\u4eceinfo.log\u6587\u4ef6\u4e2d\u63d0\u53d6\u51fa\u65f6\u95f4\u8303\u56f4\u4e3a2024-04-24 18:47\u52302024-04-24 18:50\u4e4b\u95f4\u7684\u884c\uff0c\u5e76\u5c06\u7ed3\u679c\u4fdd\u5b58\u5230tmp.log\u6587\u4ef6\u4e2d</p>"},{"location":"chap8/34linux_6logs/#6head","title":"6\u3001head\u547d\u4ee4","text":"<p>1\u3001\u67e5\u8be2\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\u593410\u884c\u65e5\u5fd7</p> <pre><code>head -n 10 info.log\n</code></pre> <p>2\u3001\u67e5\u8be2\u65e5\u5fd7\u6587\u4ef6\u9664\u4e86\u6700\u540e10\u884c\u7684\u5176\u4ed6\u6240\u6709\u65e5\u5fd7</p> <pre><code>head -n -10 info.log`\n</code></pre>"},{"location":"chap8/35port_detect/","title":"\u672a\u5b89\u88c5telnet \u548c nc \u7b49\u5de5\u5177\uff0c\u5982\u4f55\u6d4b\u8bd5\u7aef\u53e3\u662f\u5426\u5f00\u653e\uff1f","text":"<p>\u5728Unix/Linux\u73af\u5883\u4e0b\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528echo\u547d\u4ee4\u7ed3\u5408\u7279\u6b8a\u7684\u8bbe\u5907\u6587\u4ef6/dev/tcp/hostname/port \u6765\u95f4\u63a5\u6d4b\u8bd5\u4e00\u4e2a\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u7684\u6307\u5b9a\u7aef\u53e3\u662f\u5426\u5f00\u653e\u3002</p> <p>\u8fd9\u79cd\u65b9\u5f0f\u5229\u7528\u4e86Bash shell\u7684\u4e00\u4e9b\u7279\u6027\uff0c\u5c1d\u8bd5\u901a\u8fc7TCP\u8fde\u63a5\u6765\u68c0\u6d4b\u7aef\u53e3\u72b6\u6001\u3002\u547d\u4ee4\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>Bash\necho &gt; /dev/tcp/\u76ee\u6807\u4e3b\u673a\u5730\u5740/\u7aef\u53e3\u53f7\n</code></pre> <p>\u4f8b\u5982\uff0c\u60f3\u8981\u6d4b\u8bd5\u670d\u52a1\u5668example.com\u768480\u7aef\u53e3\u662f\u5426\u5f00\u653e\uff0c\u4f60\u53ef\u4ee5\u8fd0\u884c</p> <pre><code>Bash\necho &gt; /dev/tcp/example.com/80\n</code></pre> <p>\u5f53\u547d\u4ee4\u6267\u884c\u540e\uff0c\u82e5\u7aef\u53e3\u662f\u5f00\u653e\u7684\uff0c\u547d\u4ee4\u4e0d\u4f1a\u6709\u4efb\u4f55\u8f93\u51fa\u5e76\u4e14\u4f1a\u7acb\u5373\u8fd4\u56de\u547d\u4ee4\u63d0\u793a\u7b26\uff1b</p> <p>\u82e5\u7aef\u53e3\u672a\u5f00\u653e\u6216\u8fde\u63a5\u5931\u8d25\uff0c\u5219\u53ef\u80fd\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u3001\u9632\u706b\u5899\u9650\u5236\u7b49\u539f\u56e0\u5bfc\u81f4\u547d\u4ee4\u6267\u884c\u5931\u8d25\uff0c\u901a\u5e38\u4f1a\u663e\u793a\u9519\u8bef\u4fe1\u606f\uff0c\u6bd4\u5982\u201cPermission denied\u201d\u3001\u201cConnection refused\u201d\u6216\u201cNetwork is unreachable\u201d\u3002</p> <p>\u4e0d\u8fc7\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u79cd\u65b9\u6cd5\u53ea\u9002\u7528\u4e8e\u90a3\u4e9b\u652f\u6301\u6b64\u7279\u6027\u7684Bash\u73af\u5883\uff0c\u4e0d\u5177\u6709\u666e\u904d\u6027\uff0c\u800c\u4e14\u5b83\u5e76\u4e0d\u4f1a\u50cf\u4e13\u95e8\u7684\u7f51\u7edc\u5de5\u5177\uff08\u5982telnet\u3001nc\u6216netcat\uff09\u90a3\u6837\u63d0\u4f9b\u8be6\u7ec6\u7684\u8fde\u63a5\u72b6\u6001\u4fe1\u606f\u3002\u5728Windows\u7cfb\u7edf\u4e0b\uff0c\u4f60\u9700\u8981\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u6216\u547d\u4ee4\u6765\u6d4b\u8bd5\u7aef\u53e3\u3002</p>"},{"location":"chap8/35port_detect/#script","title":"Script","text":"<pre><code>for port in {1..65535}; do\n  echo &gt;/dev/tcp/google.com/$port &amp;&amp;\n    echo \"port $port is open\" ||\n    echo \"port $port is closed\"\ndone\n</code></pre> <p>This code loops over ports 1-65535 and tries to open google.com:$port. However, this doesn't work that well because if the port is closed, it takes bash like 2 minutes to realize that.</p> <p>To solve this I needed something like <code>alarm(2)</code> system call to interrupt bash. </p> <p>Bash doesn't have a built-in alarm function, so I had to write a helper program in Perl to handle SIGALRM.</p> <pre><code>alarm() {\n  perl -e '\n    eval {\n      $SIG{ALRM} = sub { die };\n      alarm shift;\n      system(@ARGV);\n    };\n    if ($@) { exit 1 }\n  ' \"$@\";\n}\n</code></pre> <p>This alarm function takes two args \u2013 seconds for the alarm call and the code to execute. If the code doesn't execute in the given time, the function fails.</p> <p>Once I had this, I could take my earlier code and just call it through alarm:</p> <pre><code>for port in {1..65535}; do\n  alarm 1 \"echo &gt;/dev/tcp/google.com/$port\" &amp;&amp;\n    echo \"port $port is open\" ||\n    echo \"port $port is closed\"\ndone\n</code></pre> <p>This is working! Now if bash freezes because of a closed port, alarm 1 will kill the probe in 1 second and the script will move to the next port.</p> <p>I went ahead and turned this into a proper scan function:</p> <pre><code>scan() {\n  if [[ -z $1 || -z $2 ]]; then\n    echo \"Usage: $0 &lt;host&gt; &lt;port, ports, or port-range&gt;\"\n    return\n  fi\n\n  local host=$1\n  local ports=()\n  case $2 in\n    *-*)\n      IFS=- read start end &lt;&lt;&lt; \"$2\"\n      for ((port=start; port &lt;= end; port++)); do\n        ports+=($port)\n      done\n      ;;\n    *,*)\n      IFS=, read -ra ports &lt;&lt;&lt; \"$2\"\n      ;;\n    *)\n      ports+=($2)\n      ;;\n  esac\n\n  for port in \"${ports[@]}\"; do\n    alarm 1 \"echo &gt;/dev/tcp/$host/$port\" &amp;&amp;\n      echo \"port $port is open\" ||\n      echo \"port $port is closed\"\n  done\n}\n</code></pre> <p>ou can run the scan function from your shell. It takes two arguments \u2013 the host to scan and a list of ports to scan (such as 22,80,443), or a range of ports to scan (such as 1-1024), or an individual port to scan (such as 80).</p> <p>Here is what happens when I run scan google.com 78-82.</p> <pre><code>$ scan google.com 78-82 \nport 78 is closed\nport 79 is closed\nport 80 is open\nport 81 is closed\nport 82 is closed\n</code></pre> <p>Similarly you can write an udp port scanner. Just replace /dev/tcp/ with /dev/udp/.</p>"},{"location":"chap8/35port_detect/#timeout","title":"timeout","text":"<pre><code>$ timeout 1 bash -c \"echo &gt;/dev/tcp/$host/$port\" &amp;&amp;\n    echo \"port $port is open\" ||\n    echo \"port $port is closed\"\n</code></pre>"},{"location":"chap8/36dudf/","title":"36 df\u547d\u4ee4\u663e\u793a\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\u800cdu\u547d\u4ee4\u663e\u793a\u8fd8\u6709\u5f88\u591a\u7a7a\u95f2\u7a7a\u95f4","text":"<p>\u4f7f\u7528df\u547d\u4ee4\u53ef\u4ee5\u770b\u5230\u78c1\u76d8\u4f7f\u7528\u7387\u5f88\u9ad8\uff0c\u672c\u60f3\u4f7f\u7528du\u547d\u4ee4\u627e\u51fa\u5927\u6587\u4ef6\u5e76\u8fdb\u884c\u5220\u9664\u65f6\uff0c\u4f46\u53d1\u73b0\u5404\u4e2a\u76ee\u5f55\u6587\u4ef6\u7684\u5927\u5c0f\u76f8\u52a0\uff0c\u5e76\u6ca1\u6709\u5360\u6ee1\u78c1\u76d8\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <pre><code>df -Th\ndu -sh / --exclude=\"proc\"\n</code></pre> <p></p> <p>\u4f7f\u7528df\u547d\u4ee4\u67e5\u770b\u5230\u6839(/)\u76ee\u5f55\u4f7f\u7528\u523033G\uff0c\u800cdu\u547d\u4ee4\u663e\u793a\u53ea\u4f7f\u7528\u4e862.5G\u3002</p>"},{"location":"chap8/36dudf/#1-dfdu","title":"1. \u5173\u4e8edf\u4e0edu\u547d\u4ee4","text":"<p>\u9996\u5148\u4e86\u89e3\u4e00\u4e0b\u4e24\u4e2a\u547d\u4ee4\u7684\u4e0d\u540c\u4e4b\u5904\uff0c</p> <p>df\u4e3b\u8981\u7528\u4e8e\u67e5\u770b\u6574\u4e2a\u6587\u4ef6\u7cfb\u7edf\u7684\u78c1\u76d8\u7a7a\u95f4\u5360\u7528\u60c5\u51b5\uff0c\u800cdu\u5219\u7528\u4e8e\u67e5\u770b\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u78c1\u76d8\u4f7f\u7528\u7a7a\u95f4\u3002</p> <p>df\u547d\u4ee4\uff1a\u663e\u793a\u7684\u662f\u6587\u4ef6\u7cfb\u7edf\u7ea7\u522b\u7684\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528\u60c5\u51b5\uff0c\u5305\u62ec\u5df2\u7528\u7a7a\u95f4\u3001\u53ef\u7528\u7a7a\u95f4\u4ee5\u53ca\u6302\u8f7d\u70b9\u7b49\u4fe1\u606f\u3002</p> <p>\u901a\u8fc7df\u547d\u4ee4\uff0c\u53ef\u4ee5\u5f97\u77e5\u5404\u4e2a\u5206\u533a\u7684\u603b\u7a7a\u95f4\u3001\u5df2\u7528\u7a7a\u95f4\u548c\u5269\u4f59\u7a7a\u95f4\uff0c\u4ece\u800c\u4e86\u89e3\u78c1\u76d8\u7684\u4f7f\u7528\u72b6\u51b5\u3002</p> <p>du\u547d\u4ee4\uff1adu\u66f4\u4fa7\u91cd\u4e8e\u5c55\u793a\u6587\u4ef6\u548c\u76ee\u5f55\u7ea7\u522b\u7684\u78c1\u76d8\u5360\u7528\u60c5\u51b5\uff0c\u53ea\u8ba1\u7b97\u6587\u4ef6\u6216\u76ee\u5f55\u5360\u7528\u7684\u78c1\u76d8\u7a7a\u95f4\u3002\u8fd9\u4e2a\u547d\u4ee4\u901a\u5e38\u7528\u6765\u67e5\u627e\u5360\u7528\u7a7a\u95f4\u5927\u7684\u6587\u4ef6\u6216\u8005\u76ee\u5f55\uff0c\u5e2e\u52a9\u6211\u4eec\u5b9a\u4f4d\u53ef\u80fd\u7684\u78c1\u76d8\u7a7a\u95f4\u6d6a\u8d39\u95ee\u9898\u3002</p>"},{"location":"chap8/36dudf/#2","title":"2. \u95ee\u9898\u539f\u56e0","text":"<p>\u56e0\u4e3a\u867d\u7136\u6587\u4ef6\u5df2\u88ab\u5220\u9664\uff0c\u4f7f\u7528ls\u547d\u4ee4\u65e0\u6cd5\u627e\u5230\uff0c\u4f46\u662f\u5982\u679c\u6709\u8fdb\u7a0b\u5360\u7528\u8be5\u6587\u4ef6\u65f6\uff0c\u78c1\u76d8\u7a7a\u95f4\u5e76\u4e0d\u4f1a\u5f97\u5230\u91ca\u653e\u3002\u6b63\u56e0\u4e3a\u5982\u6b64\uff0c\u4f7f\u7528df\u547d\u4ee4\u67e5\u770b\u78c1\u76d8\u4f7f\u7528\u7387\u65f6\uff0c\u8fd9\u4e9b\u5df2\u5220\u9664\u672a\u91ca\u653e\u7684\u6587\u4ef6\u4f1a\u88ab\u7edf\u8ba1\u5230\uff0c\u800cdu\u53ea\u7edf\u8ba1\u672a\u5220\u9664\u7684\u6587\u4ef6\uff0c\u4ece\u800c\u5bfc\u81f4\u4e24\u8005\u7684\u7ed3\u679c\u76f8\u5173\u8f83\u5927</p>"},{"location":"chap8/36dudf/#3","title":"3. \u5904\u7406\u65b9\u6cd5","text":"<p>\u4f7f\u7528 lsof \u547d\u4ee4\u53ef\u4ee5\u663e\u793a\u5df2\u5220\u9664\u7684\u6587\u4ef6\uff0c\u5c06\u6709\u95ee\u9898\u7684\u8fdb\u7a0b/\u670d\u52a1\u91cd\u542f\uff0c\u78c1\u76d8\u7a7a\u95f4\u5c31\u4f1a\u5f97\u5230\u91ca\u653e\u3002</p> <p>\u5982\u679c\u6ca1\u6709lsof\u547d\u4ee4\uff0c\u5219\u8fdb\u884c\u5b89\u88c5\u3002</p> <pre><code>yum install lsof -y\n</code></pre>"},{"location":"chap8/36dudf/#31","title":"3.1 \u67e5\u770b\u5df2\u5220\u9664\u4f46\u672a\u91ca\u653e\u7684\u6587\u4ef6","text":"<pre><code>lsof | grep delete\n</code></pre> <p>\u6b64\u65f6\u53ef\u4ee5\u770b\u5230<code>/var/log/test.log</code>\u6587\u4ef6\u5df2\u7ecf\u5220\u9664\uff0c\u4f46\u8fd8\u5728\u88abtail\u547d\u4ee4\u5360\u7528\uff0c\u5360\u7528\u6587\u4ef6\u7684\u8fdb\u7a0bID\u53ef\u4ee5\u770b\u5230\u662f4163\uff1b</p> <p>\u5728\u4f7f\u7528ls\u547d\u4ee4\u65f6\uff0c\u5df2\u7ecf\u67e5\u770b\u4e0d\u5230\u8be5\u6587\u4ef6\u4e86\uff1a</p> <pre><code>ls -l /var/log/test.log\n</code></pre> <p></p> <p>\u6839\u636e\u8fdb\u7a0bID\u4e5f\u53ef\u4ee5\u770b\u5230\u8be5\u6587\u4ef6\uff1a</p> <pre><code>lsof -p 4163\n</code></pre> <p></p>"},{"location":"chap8/36dudf/#32","title":"3.2 \u5173\u95ed\u8fdb\u7a0b\u5e76\u9a8c\u8bc1","text":"<pre><code>kill 4163\n</code></pre> <p>\u5c06\u5f02\u5e38\u8fdb\u7a0b\u5173\u95ed\u540e\uff0c\u4f7f\u7528df\u547d\u4ee4\u67e5\u770b\u78c1\u76d8\u7a7a\u95f4\u65f6\u663e\u793a\u7ed3\u679c\u6b63\u5e38\u3002</p> <p>\u6ce8\u610f\uff1a\u8fd9\u91cc\u9700\u8981\u81ea\u884c\u5224\u65ad\u662f\u5426\u4e3a\u5f02\u5e38\u8fdb\u7a0b\uff0c\u4ee5\u53ca\u4e86\u89e3\u8fdb\u7a0b\u88ab\u5173\u95ed\u540e\u5982\u4f55\u542f\u52a8\u3002</p>"},{"location":"chap8/36dudf/#findxargs","title":"\u7528find\u548cxargs\u5220\u9664\u5de8\u91cf\u6587\u4ef6\uff0c\u89e3\u51b3\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\u6545\u969c","text":"<p>\u624b\u52a8\u6267\u884c\u7a0b\u5e8f\u62a5\u9519\u8bf4\u4e0d\u80fd\u521b\u5efa\u65e5\u5fd7\u6587\u4ef6\uff0c\u624b\u52a8\u521b\u5efa\u6587\u4ef6\u8bf4\u662f\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\uff0c\u7528<code>df -h</code>\u663e\u793a\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528\u7387\u4e0d\u523050\uff05\uff0c\u7528<code>df -i</code>\u663e\u793a\u78c1\u76d8inode\u4f7f\u7528\u7387100\uff05\uff0c\u663e\u7136\u662f\u65e5\u5fd7\u6587\u4ef6\u592a\u591a\u4e86\u3002</p> <p>\u624b\u52a8\u6267\u884c\u547d\u4ee4<code>rm *.log</code>\u5220\u9664\u65e5\u5fd7\u6587\u4ef6\uff0c\u62a5\u9519\uff0c\u63d0\u793a\u53c2\u6570\u592a\u591atoo many parameter\u3002</p> <p>\u5c1d\u8bd5\u7528find\u547d\u4ee4\u67e5\u627e\u90e8\u5206\u65e5\u5fd7\u9010\u6b65\u5220\u9664\u3002\u7528find\u547d\u4ee4\u67e5\u627e2000\u5929\u4e4b\u524d\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u7136\u540e\u9010\u4e00\u5220\u9664\uff0c\u7ec4\u5408\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>$ find /opt/app/log -name *.log -a -mtime +2000 -exec rm -v  {} \\;\n</code></pre> <p>\u8fd9\u91cc\u4f7f\u7528<code>-exec</code>\u8fd8\u662f\u51fa\u73b0\u53c2\u6570\u592a\u591a\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a<code>-exec</code>\u4f1a\u628a<code>find</code>\u8f93\u51fa\u7684\u6574\u4e2a\u6587\u4ef6\u5217\u8868\u4e00\u8d77\u4f5c\u4e3a\u5220\u9664\u53c2\u6570\uff0c\u51e0\u767e\u4e07\u6761\u65e5\u5fd7\u6587\u4ef6\u663e\u7136\u592a\u591a\u4e86\u3002</p> <p>\u770b\u6765\u8fd9\u65e5\u5fd7\u6587\u4ef6\u81f3\u5c11\u51e0\u5343\u4e07\u6761\uff0c\u8fd9\u79cd\u60c5\u51b5\u5c31\u8f6e\u5230xargs\u767b\u573a\u4e86:</p> <pre><code>$ find /opt/app/log -name *.log -a -mtime +2000 | xargs rm -v  {} \\;\n</code></pre> <p>\u4e0a\u9762\u7684\u53c2\u6570\u8bf4\u660e</p> <ul> <li><code>-a</code> \u8868\u793a\u540c\u65f6\u6ee1\u8db3\u5176\u524d\u540e\u7684\u6761\u4ef6\uff0c\u8fd9\u91cc\u5c31\u662f\u524d\u9762\u7684\u6587\u4ef6\u540d\u4e3a*.log\uff0c\u548c\u540e\u9762\u7684\u4fee\u6539\u65f6\u95f4\u4e3a1500\u4ee5\u524d\u3002\u7c7b\u4f3c\u7684-o\u8868\u793a\u524d\u540e\u4efb\u4e00\u6761\u4ef6\u6ee1\u8db3\u5373\u53ef\u3002\u8fd8\u6709\u4e2a<code>-not</code>\u8868\u793a\u5426\u51b3\u6ee1\u8db3\u6761\u4ef6\u9879\uff0c\u8fd9\u4e09\u4e2a\u53c2\u6570\u7ec4\u6210find\u547d\u4ee4\u7684\u4e0e\u6216\u975e\u4e09\u79cd\u57fa\u672c\u7684\u903b\u8f91\u8fd0\u7b97\u3002</li> <li><code>-mtime</code> \u8868\u793a\u6700\u8fd1\u7684\u4fee\u6539\u65f6\u95f4\uff0c\u6b64\u5916find\u547d\u4ee4\u8fd8\u53ef\u4ee5\u4f7f\u7528\u6700\u8fd1\u7684\u6587\u4ef6\u72b6\u6001\u6539\u53d8\u65f6\u95f4ctime\u548c\u6700\u8fd1\u7684\u8bbf\u95ee\u65f6\u95f4atime\u3002\u8fd9\u91cc\u7684mtime\u548cctime\u5bb9\u6613\u8bef\u4f1a\uff0c\u53ef\u4ee5\u5927\u81f4\u8ba4\u4e3a\u524d\u8005\u662f\u6587\u4ef6\u5185\u5bb9\uff0c\u540e\u8005\u662f\u6587\u4ef6\u7684\u5143\u6570\u636e\u3002</li> <li>+1500 \u8868\u793a1500\u5929\u4ee5\u524d\uff0c\u76f8\u5bf9\u7684-1500\u8868\u793a1500\u5929\u4ee5\u5185\u3002</li> </ul> <p>find\u9ed8\u8ba4\u65f6\u95f4\u662f\u5929\u6570\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5c0f\u65f6\u548c\u5206\u949f\u3002</p> <p>\u63a5\u4e0b\u6765\u9010\u6b65\u7f29\u5c0f\u65f6\u95f4\uff0c\u4ece1500\u5929\u5230500\u5929\uff0c\u76f4\u5230100\u5929\uff0c\u6700\u7ec8\u78c1\u76d8inode\u4f7f\u7528\u7387\u4f4e\u4e8e10%\uff0c\u670d\u52a1\u6b63\u5e38\u542f\u52a8\u3002</p> <p>\u4f7f\u7528xargs\u4e00\u4e2a\u4e2a\u5220\u9664\u6587\u4ef6\u867d\u7136\u770b\u8d77\u6765\u5f88\u6162\uff0c\u4f46\u662f\u80fd\u591f\u7a33\u6b65\u6267\u884c\uff0c\u6700\u7ec8\u5b8c\u6210\u4fee\u7406\u4efb\u52a1\u3002\u53ea\u8981\u4e00\u76f4\u671d\u7740\u76ee\u6807\u524d\u8fdb\uff0c\u6162\u4e5f\u662f\u4e00\u79cd\u5feb\u3002</p>"},{"location":"chap8/37linux_cond/","title":"Shell\u811a\u672c\u7684\u6d41\u7a0b\u63a7\u5236\u77e5\u8bc6\u70b9\u6c47\u603b(2024)","text":"<ul> <li>\u6761\u4ef6\u5224\u65ad\uff1aif\u8bed\u53e5\u548ccase\u8bed\u53e5</li> <li>\u5faa\u73af\u63a7\u5236\uff1afor\uff0cwhile\u548cuntil\u5faa\u73af</li> <li>\u8df3\u51fa\u5faa\u73af\uff1abreak\u548ccontinue</li> <li>\u9519\u8bef\u5904\u7406\u4e0e\u8c03\u8bd5</li> </ul>"},{"location":"chap8/37linux_cond/#1-if","title":"1. if\u8bed\u53e5","text":""},{"location":"chap8/37linux_cond/#_1","title":"\u57fa\u672c\u683c\u5f0f","text":"<pre><code>if [ \u6761\u4ef61 ]; then\n    # \u547d\u4ee41\uff0c\u5982\u679c\u7b26\u5408\u6761\u4ef61\u5219\u6267\u884c\u547d\u4ee41\nelif [ \u6761\u4ef62 ]; then\n    # \u547d\u4ee42\uff0c\u5982\u679c\u7b26\u5408\u6761\u4ef62\u5219\u6267\u884c\u547d\u4ee42\nelse\n    # \u547d\u4ee43\uff0c\u5982\u679c\u4ee5\u4e0a\u6761\u4ef6\u90fd\u4e0d\u7b26\u5408\u5219\u6267\u884c\u547d\u4ee43\nfi\n</code></pre> <p>\u793a\u4f8b\uff1a\u68c0\u67e5\u670d\u52a1\u72b6\u6001\u5e76\u91cd\u542f</p> <pre><code>\n#!/bin/bash\nSERVICE=\"nginx\"  # \u5b9a\u4e49\u8981\u68c0\u67e5\u7684\u670d\u52a1\n\nif systemctl is-active --quiet $SERVICE; then\n    echo \"$SERVICE is running\"\nelse\n    echo \"$SERVICE is not running\"\n    systemctl start $SERVICE\nfi\n</code></pre>"},{"location":"chap8/37linux_cond/#12-case","title":"1.2 case\u8bed\u53e5","text":"<p>case \u8bed\u53e5\u662f\u591a\u5206\u652f\u6761\u4ef6\u5224\u65ad\u7684\u7b80\u6d01\u5f62\u5f0f\uff0c\u7279\u522b\u9002\u5408\u5904\u7406\u591a\u4e2a\u5206\u652f\u60c5\u51b5</p> <pre><code>case \"\u53d8\u91cf\" in\n    \u503c1\uff09\n        \u6307\u4ee41\n        ;;\n    \u503c2\uff09\n        \u6307\u4ee42\n        ;;\n    *\uff09\n        \u6307\u4ee43 # \u524d\u9762\u90fd\u4e0d\u7b26\u5408\u5c31\u6267\u884c\u6307\u4ee43\nesac\n</code></pre> <p>\u793a\u4f8b\uff1a\u83dc\u5355\u9009\u62e9</p> <pre><code>#!/bin/bash\nwhile true; do\n    echo \"1. \u542f\u52a8\u670d\u52a1\"\n    echo \"2. \u505c\u6b62\u670d\u52a1\"\n    echo \"3. \u68c0\u67e5\u670d\u52a1\"\n    echo \"4. \u9000\u51fa\"\n    read -p \"Choose an option: \" choice\n\n    case $choice in\n        1)\n            echo \"\u542f\u52a8\u670d\u52a1...\"\n            systemctl start nginx\n            ;;\n        2)\n            echo \"\u505c\u6b62\u670d\u52a1...\"\n            systemctl stop nginx\n            ;;\n        3)\n            echo \"\u670d\u52a1\u72b6\u6001:\"\n            systemctl status nginx\n            ;;\n        4)\n            echo \"\u9000\u51fa...\"\n            break\n            ;;\n        *)\n            echo \"\u65e0\u6548\u503c. \u8bf7\u518d\u6b21\u8f93\u5165.\"\n            ;;\n    esac\ndone\n</code></pre>"},{"location":"chap8/37linux_cond/#13","title":"1.3 \u6761\u4ef6\u5224\u65ad\u8bed\u6cd5\u6269\u5c55","text":"<p>\u8be6\u7ec6\u7684\u53ef\u4ee5\u53c2\u8003\uff1aShell\u811a\u672c\u57fa\u7840\u77e5\u8bc6\u70b9\u6c47\u603b</p> <p>\u5e38\u7528\u6761\u4ef6\uff1a</p> <ul> <li><code>-e file</code>\uff1a\u6587\u4ef6\u5b58\u5728</li> <li><code>-f file</code>\uff1a\u666e\u901a\u6587\u4ef6</li> <li><code>-d file</code>\uff1a\u76ee\u5f55</li> <li><code>-L file</code>\uff1a\u7b26\u53f7\u94fe\u63a5</li> <li><code>-s file</code>\uff1a\u6587\u4ef6\u975e\u7a7a</li> </ul> <p>\u6743\u9650\u76f8\u5173\uff1a</p> <ul> <li><code>-r file</code>\uff1a\u53ef\u8bfb</li> <li><code>-w file</code>\uff1a\u53ef\u5199</li> <li><code>-x file</code>\uff1a\u53ef\u6267\u884c</li> </ul> <p>\u5b57\u7b26\u4e32\u6bd4\u8f83\uff1a</p> <ul> <li><code>=</code>\uff1a\u5b57\u7b26\u4e32\u76f8\u7b49</li> <li><code>!=</code>\uff1a\u5b57\u7b26\u4e32\u4e0d\u7b49</li> <li><code>-z str</code>\uff1a\u5b57\u7b26\u4e32\u4e3a\u7a7a</li> <li><code>-n str</code>\uff1a\u5b57\u7b26\u4e32\u975e\u7a7a</li> </ul> <p>\u6574\u6570\u6bd4\u8f83\uff1a</p> <ul> <li><code>-eq</code>\uff1a\u7b49\u4e8e</li> <li><code>-ne</code>\uff1a\u4e0d\u7b49</li> <li><code>-lt</code>\uff1a\u5c0f\u4e8e</li> <li><code>-le</code>\uff1a\u5c0f\u4e8e\u7b49\u4e8e</li> <li><code>-gt</code>\uff1a\u5927\u4e8e</li> <li><code>-ge</code>\uff1a\u5927\u4e8e\u7b49\u4e8e</li> </ul> <p>\u590d\u5408\u5224\u65ad\uff1a</p> <ul> <li><code>&amp;&amp;</code>\uff1a\u903b\u8f91\u4e0e</li> <li><code>||</code>\uff1a\u903b\u8f91\u6216</li> </ul> <pre><code>if [ $num1 -gt 10 ] &amp;&amp; [ $num2 -lt 20 ]; then\n    echo \"Both conditions are true.\"\nfi\n</code></pre>"},{"location":"chap8/37linux_cond/#2","title":"2. \u5faa\u73af\u63a7\u5236","text":""},{"location":"chap8/37linux_cond/#21-for","title":"2.1 for \u5faa\u73af","text":"<p>\u904d\u5386\u5217\u8868</p> <pre><code>for item in item1 item2 item3; do\n    echo \"Processing $item\"\ndone\n</code></pre> <p>\u904d\u5386\u6587\u4ef6</p> <pre><code>for file in /var/log/*.log; do\n    echo \"Log file: $file\"\ndone\n</code></pre> <p>\u793a\u4f8b\uff1a\u6279\u91cf\u538b\u7f29\u65e5\u5fd7\u6587\u4ef6</p> <pre><code>#!/bin/bash\nLOG_DIR=\"/var/log/myapp\"  # \u5b9a\u4e49\u5e94\u7528\u6240\u5728\u7684\u76ee\u5f55\nBACKUP_DIR=\"/backup/logs\"  # \u5907\u4efd\u7684\u76ee\u5f55\n\nfor log in $LOG_DIR/*.log; do\n    gzip -c \"$log\" &gt; \"$BACKUP_DIR/$(basename $log).gz\"\n    echo \"Compressed $log\"\ndone\n</code></pre>"},{"location":"chap8/37linux_cond/#22-while","title":"2.2 while \u5faa\u73af","text":"<p>\u57fa\u672c\u683c\u5f0f</p> <pre><code>while [ condition ]; do\n    # commands\ndone\n</code></pre> <p>\u793a\u4f8b\uff1a\u76d1\u63a7\u78c1\u76d8\u7a7a\u95f4</p> <pre><code>#!/bin/bash\nTHRESHOLD=80\n\nwhile true; do\n    USAGE=$(df / | grep '/' | awk '{print $5}' | sed 's/%//')\n    if [ $USAGE -gt $THRESHOLD ]; then\n        echo \"Disk usage is above $THRESHOLD%. Clearing logs.\"\n        rm -f /var/log/myapp/*.log\n    fi\n    sleep 60\ndone\n</code></pre>"},{"location":"chap8/37linux_cond/#23-until","title":"2.3 until \u5faa\u73af","text":"<pre><code>until [ condition ]; do\n    # commands\ndone\n</code></pre> <p>\u751f\u4ea7\u793a\u4f8b\uff1a\u7b49\u5f85\u670d\u52a1\u542f\u52a8</p> <pre><code>#!/bin/bash\nSERVICE=\"nginx\"\n\nuntil systemctl is-active --quiet $SERVICE; do\n    echo \"Waiting for $SERVICE to start...\"\n    sleep 5\ndone\necho \"$SERVICE is now running.\"\n</code></pre>"},{"location":"chap8/37linux_cond/#3","title":"3. \u8df3\u51fa\u5faa\u73af","text":""},{"location":"chap8/37linux_cond/#31-break","title":"3.1 break","text":"<p>\u7acb\u5373\u8df3\u51fa\u5f53\u524d\u5faa\u73af\u3002</p> <pre><code>for i in {1..10}; do\n    if [ $i -eq 5 ]; then\n        break\n    fi\n    echo \"Number: $i\"\ndone\n</code></pre>"},{"location":"chap8/37linux_cond/#32-continue","title":"3.2 continue","text":"<p>\u8df3\u8fc7\u5f53\u524d\u8fed\u4ee3\uff0c\u5f00\u59cb\u4e0b\u4e00\u6b21\u5faa\u73af\u3002</p> <pre><code>for i in {1..10}; do\n    if [ $i -eq 5 ]; then\n        continue\n    fi\n    echo \"Number: $i\"\ndone\n</code></pre> <p>\u793a\u4f8b\uff1a\u6279\u91cf\u6587\u4ef6\u64cd\u4f5c\uff0c\u8df3\u8fc7\u7279\u5b9a\u6587\u4ef6</p> <pre><code>#!/bin/bash\nfor file in /data/*; do\n    if [[ \"$file\" == *\".tmp\" ]]; then\n        echo \"Skipping temporary file: $file\"\n        continue\n    fi\n    echo \"Processing $file\"\n    mv \"$file\" /backup/\ndone\n</code></pre>"},{"location":"chap8/37linux_cond/#4","title":"4. \u51fd\u6570","text":""},{"location":"chap8/37linux_cond/#41","title":"4.1 \u57fa\u672c\u683c\u5f0f","text":"<pre><code>my_function() {\n    # commands\n}\n</code></pre>"},{"location":"chap8/37linux_cond/#42","title":"4.2 \u53c2\u6570\u5904\u7406","text":"<ul> <li><code>1, 2,</code> ...\uff1a\u51fd\u6570\u53c2\u6570</li> <li><code>$@</code>\uff1a\u6240\u6709\u53c2\u6570</li> <li><code>$#</code>\uff1a\u53c2\u6570\u4e2a\u6570</li> </ul> <p>\u793a\u4f8b\uff1a\u68c0\u67e5\u76ee\u5f55\u662f\u5426\u5b58\u5728</p> <pre><code>#!/bin/bash\n\ncheck_directory() {\n    if [ ! -d \"$1\" ]; then\n        echo \"Directory $1 does not exist. Creating...\"\n        mkdir -p \"$1\"\n    else\n        echo \"Directory $1 exists.\"\n    fi\n}\n\ncheck_directory \"/var/log/myapp\"\ncheck_directory \"/backup/logs\"\n</code></pre> <ul> <li><code>set -e</code>\uff1a\u811a\u672c\u9047\u5230\u9519\u8bef\u5373\u9000\u51fa</li> <li><code>set -u</code>\uff1a\u4f7f\u7528\u672a\u5b9a\u4e49\u53d8\u91cf\u65f6\u62a5\u9519</li> <li><code>set -o pipefai</code>l\uff1a\u7ba1\u9053\u547d\u4ee4\u4e2d\u4efb\u4f55\u547d\u4ee4\u5931\u8d25\u5373\u9000\u51fa</li> </ul> <p>\u793a\u4f8b\uff1a\u786e\u4fdd\u811a\u672c\u5b89\u5168\u6267\u884c</p> <pre><code>#!/bin/bash\nset -euo pipefail\n\nif [ -z \"$1\" ]; then\n    echo \"Usage: $0 &lt;filename&gt;\"\n    exit 1\nfi\n\necho \"Processing file $1...\"\n</code></pre>"},{"location":"chap8/37linux_cond/#52","title":"5.2 \u8c03\u8bd5\u6a21\u5f0f","text":"<p><code>set -x</code>\uff1a\u663e\u793a\u547d\u4ee4\u6267\u884c\u8fc7\u7a0b </p> <p><code>set +x</code>\uff1a\u5173\u95ed\u8c03\u8bd5\u6a21\u5f0f</p> <p>\u793a\u4f8b\uff1a\u8c03\u8bd5\u811a\u672c</p>"},{"location":"chap8/37linux_cond/#6","title":"6. \u751f\u4ea7\u6848\u4f8b","text":""},{"location":"chap8/37linux_cond/#61","title":"6.1 \u5b9a\u671f\u6e05\u7406\u8fc7\u671f\u6587\u4ef6","text":"<p>\u6e05\u7406\u67d0\u4e2a\u76ee\u5f557\u5929\u524d\u7684\u6587\u4ef6</p> <pre><code>#!/bin/bash\nTARGET_DIR=\"/tmp\"  # \u9700\u8981\u6e05\u7406\u7684\u76ee\u5f55\nDAYS=7    # \u65f6\u95f4\n\nfind \"$TARGET_DIR\" -type f -mtime +$DAYS -exec rm -f {} \\;\necho \"Cleaned files older than $DAYS days in $TARGET_DIR.\"\n</code></pre>"},{"location":"chap8/37linux_cond/#62","title":"6.2 \u81ea\u52a8\u5907\u4efd\u6570\u636e\u5e93","text":"<pre><code>#!/bin/bash\nDB_NAME=\"mydb\"  # \u6570\u636e\u5e93\u540d\u79f0\nBACKUP_DIR=\"/backup/db\"   # \u5907\u4efd\u76ee\u5f55\nTIMESTAMP=$(date +%Y%m%d%H%M)\n\nmysqldump -u root -p\"$DB_PASS\" \"$DB_NAME\" &gt; \"$BACKUP_DIR/$DB_NAME-$TIMESTAMP.sql\"\necho \"Backup of $DB_NAME completed at $BACKUP_DIR/$DB_NAME-$TIMESTAMP.sql\"\n</code></pre>"},{"location":"chap8/37linux_cond/#63","title":"6.3 \u6279\u91cf\u5904\u7406\u6587\u4ef6","text":"<pre><code>#!/bin/bash\nINPUT_DIR=\"/data/input\"\nOUTPUT_DIR=\"/data/output\"\n\nfor file in $INPUT_DIR/*; do\n    echo \"Processing $(basename $file)...\"\n    cp \"$file\" \"$OUTPUT_DIR/$(basename $file)\"\ndone\n</code></pre>"},{"location":"chap8/3devops_shell/","title":"3 Basic Shell Scripting for Devops","text":""},{"location":"chap8/3devops_shell/#1-shell-scripting-exercises","title":"1 Shell Scripting Exercises","text":""},{"location":"chap8/3devops_shell/#hello-world","title":"Hello World","text":"<p>Objectives</p> <ul> <li>Define a variable with the string 'Hello World'</li> <li>Print the value of the variable you've defined and redirect the output to the file \"<code>amazing_output.txt</code>\"</li> </ul> <p>Solution</p> <pre><code>#!/usr/bin/env bash\n\nHW_STR=\"Hello World\"\necho $HW_STR &gt; amazing_output.txt\n</code></pre>"},{"location":"chap8/3devops_shell/#basic-date","title":"Basic Date","text":"<p>Objectives</p> <ul> <li>Write a script that will put the current date in a file called <code>\"the_date.txt\"</code></li> </ul> <p>Solution</p> <pre><code>#!/usr/bin/env bash\n\necho $(date) &gt; the_date.txt\n</code></pre>"},{"location":"chap8/3devops_shell/#great-day","title":"Great Day","text":"<p>Objectives</p> <p>Write a script that will print \"Today is a great day!\" unless it's given a day name and then it should print \"Today is \"</p> <p>Note: no need to check whether the given argument is actually a valid day</p> <pre><code>#!/usr/bin/env bash\n\necho \"Today is ${1:-a great day!}\"\n</code></pre> <pre><code>$ bash greatDay.sh \nToday is a great day!\n\n$ bash greatDay.sh 2\nToday is 2\n</code></pre>"},{"location":"chap8/3devops_shell/#shell-scripting-factors","title":"Shell Scripting - Factors","text":"<p>Objectives</p> <p>Write a script that when given a number, will:</p> <ul> <li>Check if the number has 2 as factor, if yes it will print \"one factor\"</li> <li>Check if the number has 3 as factor, if yes it will print \"one factor...actually two!\"</li> <li>If none of them (2 and 3) is a factor, print the number itself</li> </ul> <p>Solution</p> <pre><code>#!/usr/bin/env bash\n\n(( $1 % 2 )) || res=\"one factor\"\n(( $1 % 3 )) || res+=\"...actually two!\"\n\necho ${res:-$1}\n</code></pre>"},{"location":"chap8/3devops_shell/#argument-check","title":"Argument Check","text":"<p>Objectives</p> <p>Note: assume the script is executed with an argument</p> <ul> <li>Write a script that will check if a given argument is the string \"pizza\"</li> <li>If it's the string \"pizza\" print \"with pineapple?\"</li> <li>If it's not the string \"pizza\" print \"I want pizza!\"</li> </ul> <p>Solution</p> <pre><code>/usr/bin/env bash\n\narg_value=${1:-default}\n\nif [ $arg_value = \"pizza\" ]; then\n    echo \"with pineapple?\"\nelse\n    echo \"I want pizza!\"\nfi\n</code></pre>"},{"location":"chap8/3devops_shell/#files-size","title":"Files Size","text":"<p>Objectives</p> <ul> <li>Print the name and size of every file and directory in current path</li> </ul> <p>Note: use at least one for loop!</p> <p>Solution</p> <pre><code>#!/usr/bin/env bash\n\nfor i in $(ls -S1); do\n    echo $i: $(du -sh \"$i\" | cut -f1)\ndone \n</code></pre>"},{"location":"chap8/3devops_shell/#count-chars","title":"Count Chars","text":"<p>Objectives</p> <ul> <li>Read input from the user until you get empty string</li> <li>For each of the lines you read, count the number of characters and print it</li> </ul> <p>Constraints</p> <ul> <li>You must use a while loop</li> <li>Assume at least three lines of input</li> </ul> <p>Solution</p> <pre><code>#!/usr/bin/env bash\n\necho -n \"Please insert your input: \"\n\nwhile read line; do\n    echo -n \"$line\" | wc -c\n    echo -n \"Please insert your input: \"\ndone\n</code></pre>"},{"location":"chap8/3devops_shell/#sum","title":"Sum","text":"<p>Objectives</p> <ul> <li>Write a script that gets two numbers and prints their sum</li> <li>Make sure the input is valid (= you got two numbers from the user)</li> <li>Test the script by running and passing it two numbers as arguments</li> </ul> <p>Constraints</p> <p>Use functions</p> <p>Solution</p> <pre><code>#!/usr/bin/env bash\n\nre='^[0-9]+$'\n\nif ! [[ $1 =~ $re &amp;&amp; $2 =~ $re ]]; then\n    echo \"Oh no...I need two numbers\"\n    exit 2\nfi\n\nfunction sum {\n    echo $(( $1 + $2 ))\n}\n\nsum $1 $2\n</code></pre>"},{"location":"chap8/3devops_shell/#number-of-arguments","title":"Number of Arguments","text":"<p>Objectives</p> <ul> <li>Write a script that will print \"Got it: \" in case of one argument</li> <li>In case no arguments were provided, it will print \"Usage: ./ \"</li> <li>In case of more than one argument, print \"hey hey...too many!\"</li> </ul> <p>Solution</p> <pre><code>#!/usr/bin/env bash\n\nset -eu\n\nmain() {\n  case $# in\n    0) printf \"%s\" \"Usage: ./&lt;program name&gt; &lt;argument&gt;\"; return 1 ;;\n    1) printf \"%s\" \"Got it: $1\"; return 0 ;;\n    *) return 1 ;;\n  esac\n}\n\nmain \"$@\"\n</code></pre>"},{"location":"chap8/3devops_shell/#empty-files","title":"Empty Files","text":"<p>Objectives</p> <ul> <li>Write a script to remove all the empty files in a given directory (including nested directories)</li> </ul> <p>Solution</p> <pre><code>#! /bin/bash\nfor x in *\ndo\n    if [ -s $x ]\n    then\n        continue\n    else\n        rm -rf $x\n    fi\ndone\n</code></pre>"},{"location":"chap8/3devops_shell/#its-alive","title":"It's Alive!","text":"<p>Objectives</p> <p>Write a script to determine whether a given host is down or up</p> <p>Solution</p> <pre><code>#!/usr/bin/env bash\nSERVERIP=&lt;IP Address&gt;\nNOTIFYEMAIL=test@example.com\n\nping -c 3 $SERVERIP &gt; /dev/null 2&gt;&amp;1\nif [ $? -ne 0 ]\nthen\n   # Use mailer here:\n   mailx -s \"Server $SERVERIP is down\" -t \"$NOTIFYEMAIL\" &lt; /dev/null\nfi\n</code></pre>"},{"location":"chap8/4Basic_shell/","title":"4 \u57fa\u672c shell \u811a\u672c \u7cfb\u7edf+\u6587\u4ef6+\u5377+\u65f6\u95f4","text":""},{"location":"chap8/4Basic_shell/#1-hello-world","title":"1 \u7f16\u5199hello world\u811a\u672c","text":"<pre><code>#!/bin/bash\n\n# \u7f16\u5199hello world\u811a\u672c\n\necho \"Hello World!\"\n</code></pre>"},{"location":"chap8/4Basic_shell/#2-linux","title":"2\u3001\u901a\u8fc7\u4f4d\u7f6e\u53d8\u91cf\u521b\u5efa Linux \u7cfb\u7edf\u8d26\u6237\u53ca\u5bc6\u7801","text":"<pre><code>#!/bin/bash\n\n# \u901a\u8fc7\u4f4d\u7f6e\u53d8\u91cf\u521b\u5efa Linux \u7cfb\u7edf\u8d26\u6237\u53ca\u5bc6\u7801\n\n#$1 \u662f\u6267\u884c\u811a\u672c\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570,$2 \u662f\u6267\u884c\u811a\u672c\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\nuseradd    \"$1\" \necho \"$2\"  |  passwd  \u2010\u2010stdin  \"$1\"\n</code></pre>"},{"location":"chap8/4Basic_shell/#3","title":"3\u3001\u5907\u4efd\u65e5\u5fd7","text":"<pre><code>#!/bin/bash\n# \u6bcf\u5468 5 \u4f7f\u7528 tar \u547d\u4ee4\u5907\u4efd/var/log \u4e0b\u7684\u6240\u6709\u65e5\u5fd7\u6587\u4ef6\n# vim  /root/logbak.sh\n# \u7f16\u5199\u5907\u4efd\u811a\u672c,\u5907\u4efd\u540e\u7684\u6587\u4ef6\u540d\u5305\u542b\u65e5\u671f\u6807\u7b7e,\u9632\u6b62\u540e\u9762\u7684\u5907\u4efd\u5c06\u524d\u9762\u7684\u5907\u4efd\u6570\u636e\u8986\u76d6\n# \u6ce8\u610f date \u547d\u4ee4\u9700\u8981\u4f7f\u7528\u53cd\u5f15\u53f7\u62ec\u8d77\u6765,\u53cd\u5f15\u53f7\u5728\u952e\u76d8&lt;tab&gt;\u952e\u4e0a\u9762\ntar  -czf  log-`date +%Y%m%d`.tar.gz  /var/log \n\n# crontab \u2010e  #\u7f16\u5199\u8ba1\u5212\u4efb\u52a1,\u6267\u884c\u5907\u4efd\u811a\u672c\n00  03  *  *  5  /root/logbak.sh\n</code></pre>"},{"location":"chap8/4Basic_shell/#4","title":"4 \u731c\u6570\u5b57\u6e38\u620f","text":"<pre><code>#!/bin/bash\n\n# \u811a\u672c\u751f\u6210\u4e00\u4e2a 100 \u4ee5\u5185\u7684\u968f\u673a\u6570,\u63d0\u793a\u7528\u6237\u731c\u6570\u5b57,\u6839\u636e\u7528\u6237\u7684\u8f93\u5165,\u63d0\u793a\u7528\u6237\u731c\u5bf9\u4e86,\n# \u731c\u5c0f\u4e86\u6216\u731c\u5927\u4e86,\u76f4\u81f3\u7528\u6237\u731c\u5bf9\u811a\u672c\u7ed3\u675f\u3002\n\n# RANDOM \u4e3a\u7cfb\u7edf\u81ea\u5e26\u7684\u7cfb\u7edf\u53d8\u91cf,\u503c\u4e3a 0\u201032767\u7684\u968f\u673a\u6570\n# \u4f7f\u7528\u53d6\u4f59\u7b97\u6cd5\u5c06\u968f\u673a\u6570\u53d8\u4e3a 1\u2010100 \u7684\u968f\u673a\u6570\nnum=$[RANDOM%100+1]\necho \"$num\"\n\n# \u4f7f\u7528 read \u63d0\u793a\u7528\u6237\u731c\u6570\u5b57\n# \u4f7f\u7528 if \u5224\u65ad\u7528\u6237\u731c\u6570\u5b57\u7684\u5927\u5c0f\u5173\u7cfb:\u2010eq(\u7b49\u4e8e),\u2010ne(\u4e0d\u7b49\u4e8e),\u2010gt(\u5927\u4e8e),\u2010ge(\u5927\u4e8e\u7b49\u4e8e),\n# \u2010lt(\u5c0f\u4e8e),\u2010le(\u5c0f\u4e8e\u7b49\u4e8e)\nwhile  :\ndo\n  read -p \"\u8ba1\u7b97\u673a\u751f\u6210\u4e86\u4e00\u4e2a 1\u2010100 \u7684\u968f\u673a\u6570,\u4f60\u731c: \" cai\n    if [ $cai -eq $num ]\n    then\n         echo \"\u606d\u559c,\u731c\u5bf9\u4e86\"\n         exit\n      elif [ $cai -gt $num ]\n      then\n             echo \"Oops,\u731c\u5927\u4e86\"\n        else\n             echo \"Oops,\u731c\u5c0f\u4e86\"\n   fi\ndone\n</code></pre>"},{"location":"chap8/4Basic_shell/#5-123456","title":"5 \u7f16\u5199\u811a\u672c:\u63d0\u793a\u7528\u6237\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801,\u811a\u672c\u81ea\u52a8\u521b\u5efa\u76f8\u5e94\u7684\u8d26\u6237\u53ca\u914d\u7f6e\u5bc6\u7801\u3002\u5982\u679c\u7528\u6237\u4e0d\u8f93\u5165\u8d26\u6237\u540d,\u5219\u63d0\u793a\u5fc5\u987b\u8f93\u5165\u8d26\u6237\u540d\u5e76\u9000\u51fa\u811a\u672c;\u5982\u679c\u7528\u6237\u4e0d\u8f93\u5165\u5bc6\u7801,\u5219\u7edf\u4e00\u4f7f\u7528\u9ed8\u8ba4\u7684 123456 \u4f5c\u4e3a\u9ed8\u8ba4\u5bc6\u7801\u3002","text":"<pre><code>#!/bin/bash\n\n# \u7f16\u5199\u811a\u672c:\u63d0\u793a\u7528\u6237\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801,\u811a\u672c\u81ea\u52a8\u521b\u5efa\u76f8\u5e94\u7684\u8d26\u6237\u53ca\u914d\u7f6e\u5bc6\u7801\u3002\u5982\u679c\u7528\u6237\n# \u4e0d\u8f93\u5165\u8d26\u6237\u540d,\u5219\u63d0\u793a\u5fc5\u987b\u8f93\u5165\u8d26\u6237\u540d\u5e76\u9000\u51fa\u811a\u672c;\u5982\u679c\u7528\u6237\u4e0d\u8f93\u5165\u5bc6\u7801,\u5219\u7edf\u4e00\u4f7f\u7528\u9ed8\n# \u8ba4\u7684 123456 \u4f5c\u4e3a\u9ed8\u8ba4\u5bc6\u7801\u3002\n\nread -p \"\u8bf7\u8f93\u5165\u7528\u6237\u540d: \" user\n#\u4f7f\u7528\u2010z \u53ef\u4ee5\u5224\u65ad\u4e00\u4e2a\u53d8\u91cf\u662f\u5426\u4e3a\u7a7a,\u5982\u679c\u4e3a\u7a7a,\u63d0\u793a\u7528\u6237\u5fc5\u987b\u8f93\u5165\u8d26\u6237\u540d,\u5e76\u9000\u51fa\u811a\u672c,\u9000\u51fa\u7801\u4e3a 2\n#\u6ca1\u6709\u8f93\u5165\u7528\u6237\u540d\u811a\u672c\u9000\u51fa\u540e,\u4f7f\u7528$?\u67e5\u770b\u7684\u8fd4\u56de\u7801\u4e3a 2\nif [ -z $user ];then\n     echo \"\u60a8\u4e0d\u9700\u8f93\u5165\u8d26\u6237\u540d\"\n   exit 2\nfi\n#\u4f7f\u7528 stty \u2010echo \u5173\u95ed shell \u7684\u56de\u663e\u529f\u80fd\n#\u4f7f\u7528 stty  echo \u6253\u5f00 shell \u7684\u56de\u663e\u529f\u80fd\nstty -echo\nread -p \"\u8bf7\u8f93\u5165\u5bc6\u7801: \" pass\nstty echo\npass=${pass:\u2010123456}\nuseradd \"$user\"\necho \"$pass\" | passwd \u2010\u2010stdin \"$user\"\n</code></pre>"},{"location":"chap8/4Basic_shell/#6","title":"6 \u8f93\u5165\u4e09\u4e2a\u6570\u5e76\u8fdb\u884c\u5347\u5e8f\u6392\u5e8f","text":"<pre><code>#!/bin/bash\n\n# \u4f9d\u6b21\u63d0\u793a\u7528\u6237\u8f93\u5165 3 \u4e2a\u6574\u6570,\u811a\u672c\u6839\u636e\u6570\u5b57\u5927\u5c0f\u4f9d\u6b21\u6392\u5e8f\u8f93\u51fa 3 \u4e2a\u6570\u5b57\nread -p \"\u8bf7\u8f93\u5165\u4e00\u4e2a\u6574\u6570:\" num1\nread -p \"\u8bf7\u8f93\u5165\u4e00\u4e2a\u6574\u6570:\" num2\nread -p \"\u8bf7\u8f93\u5165\u4e00\u4e2a\u6574\u6570:\" num3\n# \u4e0d\u7ba1\u8c01\u5927\u8c01\u5c0f,\u6700\u540e\u90fd\u6253\u5370 echo \"$num1,$num2,$num3\"\n# num1 \u4e2d\u6c38\u8fdc\u5b58\u6700\u5c0f\u7684\u503c,num2 \u4e2d\u6c38\u8fdc\u5b58\u4e2d\u95f4\u503c,num3 \u6c38\u8fdc\u5b58\u6700\u5927\u503c\n# \u5982\u679c\u8f93\u5165\u7684\u4e0d\u662f\u8fd9\u6837\u7684\u987a\u5e8f,\u5219\u6539\u53d8\u6570\u7684\u5b58\u50a8\u987a\u5e8f,\u5982:\u53ef\u4ee5\u5c06 num1 \u548c num2 \u7684\u503c\u5bf9\u8c03\ntmp=0\n# \u5982\u679c num1 \u5927\u4e8e num2,\u5c31\u628a num1 \u548c\u548c num2 \u7684\u503c\u5bf9\u8c03,\u786e\u4fdd num1 \u53d8\u91cf\u4e2d\u5b58\u7684\u662f\u6700\u5c0f\u503c\nif [ $num1 -gt $num2 ];then   \n  tmp=$num1\n  num1=$num2\n  num2=$tmp\nfi\n# \u5982\u679c num1 \u5927\u4e8e num3,\u5c31\u628a num1 \u548c num3 \u5bf9\u8c03,\u786e\u4fdd num1 \u53d8\u91cf\u4e2d\u5b58\u7684\u662f\u6700\u5c0f\u503c\nif [ $num1 -gt $num3 ];then   \n    tmp=$num1\n    num1=$num3\n    num3=$tmp\nfi\n# \u5982\u679c num2 \u5927\u4e8e num3,\u5c31\u628a num2 \u548c num3 \u5bf9\u6807,\u786e\u4fdd num2 \u53d8\u91cf\u4e2d\u5b58\u7684\u662f\u5c0f\u4e00\u70b9\u7684\u503c\nif [ $num2 -gt $num3 ];then\n    tmp=$num2\n    num2=$num3\n    num3=$tmp\nfi\necho \"\u6392\u5e8f\u540e\u6570\u636e(\u4ece\u5c0f\u5230\u5927)\u4e3a:$num1,$num2,$num3\"\n</code></pre>"},{"location":"chap8/4Basic_shell/#7","title":"7 \u77f3\u5934\u3001\u526a\u5200\u3001\u5e03\u6e38\u620f","text":"<pre><code>#!/bin/bash\n\n# \u7f16\u5199\u811a\u672c,\u5b9e\u73b0\u4eba\u673a&lt;\u77f3\u5934,\u526a\u5200,\u5e03&gt;\u6e38\u620f\ngame=(\u77f3\u5934 \u526a\u5200 \u5e03)\nnum=$[RANDOM%3]\ncomputer=${game[$num]}\n# \u901a\u8fc7\u968f\u673a\u6570\u83b7\u53d6\u8ba1\u7b97\u673a\u7684\u51fa\u62f3\n# \u51fa\u62f3\u7684\u53ef\u80fd\u6027\u4fdd\u5b58\u5728\u4e00\u4e2a\u6570\u7ec4\u4e2d,game[0],game[1],game[2]\u5206\u522b\u662f 3 \u4e2d\u4e0d\u540c\u7684\u53ef\u80fd\n\necho \"\u8bf7\u6839\u636e\u4e0b\u5217\u63d0\u793a\u9009\u62e9\u60a8\u7684\u51fa\u62f3\u624b\u52bf\"\necho \"1.\u77f3\u5934\"\necho \"2.\u526a\u5200\"\necho \"3.\u5e03\"\n\nread -p \"\u8bf7\u9009\u62e9 1\u20103:\" person\ncase  $person  in\n1)\n  if [ $num -eq 0 ]\n  then\n    echo \"\u5e73\u5c40\"\n    elif [ $num -eq 1 ]\n    then\n      echo \"\u4f60\u8d62\"\n  else\n    echo \"\u8ba1\u7b97\u673a\u8d62\"\n  fi;;\n2)   \n  if [ $num -eq 0 ]\n  then\n    echo \"\u8ba1\u7b97\u673a\u8d62\"\n    elif [ $num -eq 1 ]\n    then\n      echo \"\u5e73\u5c40\"\n  else\n    echo \"\u4f60\u8d62\"\n  fi;;\n3)\n  if [ $num -eq 0 ]\n  then\n    echo \"\u4f60\u8d62\"\n    elif [ $num -eq 1 ]\n    then\n      echo \"\u8ba1\u7b97\u673a\u8d62\"\n  else\n    echo \"\u5e73\u5c40\"\n  fi;;\n*)\n  echo \"\u5fc5\u987b\u8f93\u5165 1\u20103 \u7684\u6570\u5b57\"\nesac\n</code></pre>"},{"location":"chap8/4Basic_shell/#8","title":"8 \u7f16\u5199\u811a\u672c,\u663e\u793a\u8fdb\u5ea6\u6761","text":"<pre><code>\n#!/bin/bash\n\n# \u7f16\u5199\u811a\u672c,\u663e\u793a\u8fdb\u5ea6\u6761\njindu(){\nwhile :\ndo\n     echo -n '#'\n     sleep 0.2\ndone\n}\njindu &amp;\ncp -a $1 $2\nkillall $0\necho \"\u62f7\u8d1d\u5b8c\u6210\"\n</code></pre>"},{"location":"chap8/4Basic_shell/#9","title":"9\u3001\u8fdb\u5ea6\u6761,\u52a8\u6001\u65f6\u9488\u7248\u672c\uff1b\u5b9a\u4e49\u4e00\u4e2a\u663e\u793a\u8fdb\u5ea6\u7684\u51fd\u6570,\u5c4f\u5e55\u5feb\u901f\u663e\u793a<code>|  / \u2010 \\</code>","text":"<pre><code>#!/bin/bash\n\n# \u8fdb\u5ea6\u6761,\u52a8\u6001\u65f6\u9488\u7248\u672c\n# \u5b9a\u4e49\u4e00\u4e2a\u663e\u793a\u8fdb\u5ea6\u7684\u51fd\u6570,\u5c4f\u5e55\u5feb\u901f\u663e\u793a|  / \u2010 \\\nrotate_line(){\nINTERVAL=0.5  #\u8bbe\u7f6e\u95f4\u9694\u65f6\u95f4\nCOUNT=\"0\"     #\u8bbe\u7f6e4\u4e2a\u5f62\u72b6\u7684\u7f16\u53f7,\u9ed8\u8ba4\u7f16\u53f7\u4e3a 0(\u4e0d\u4ee3\u8868\u4efb\u4f55\u56fe\u50cf)\nwhile :\ndo\n  COUNT=`expr $COUNT + 1` #\u6267\u884c\u5faa\u73af,COUNT \u6bcf\u6b21\u5faa\u73af\u52a0 1,(\u5206\u522b\u4ee3\u88684\u79cd\u4e0d\u540c\u7684\u5f62\u72b6)\n  case $COUNT in          #\u5224\u65ad COUNT \u7684\u503c,\u503c\u4e0d\u4e00\u6837\u663e\u793a\u7684\u5f62\u72b6\u5c31\u4e0d\u4e00\u6837\n  \"1\")                    #\u503c\u4e3a 1 \u663e\u793a\u2010\n          echo -e '\u2010'\"\\b\\c\"\n          sleep $INTERVAL\n          ;;\n    \"2\")                  #\u503c\u4e3a 2 \u663e\u793a\\\\,\u7b2c\u4e00\u4e2a\\\u662f\u8f6c\u4e49\n          echo -e '\\\\'\"\\b\\c\"\n          sleep $INTERVAL\n          ;;\n    \"3\")                  #\u503c\u4e3a 3 \u663e\u793a|\n          echo -e \"|\\b\\c\"\n          sleep $INTERVAL\n          ;;\n   \"4\")                   #\u503c\u4e3a 4 \u663e\u793a/\n          echo -e \"/\\b\\c\"\n          sleep $INTERVAL\n          ;;\n    *)                    #\u503c\u4e3a\u5176\u4ed6\u65f6,\u5c06 COUNT \u91cd\u7f6e\u4e3a 0\n          COUNT=\"0\";;\n    esac\ndone\n}\nrotate_line\n</code></pre>"},{"location":"chap8/4Basic_shell/#10-99","title":"10 <code>9*9</code> \u4e58\u6cd5\u8868","text":"<pre><code>#!/bin/bash\n\n# 9*9 \u4e58\u6cd5\u8868(\u7f16\u5199 shell \u811a\u672c,\u6253\u5370 9*9 \u4e58\u6cd5\u8868) \nfor i in `seq 9`\ndo\n    for j in `seq $i`\n     do\n         echo -n \"$j*$i=$[i*j]  \"\n     done\n    echo\ndone\n</code></pre>"},{"location":"chap8/4Basic_shell/#11-usertxt-usertxt","title":"11\u3001\u4f7f\u7528 user.txt \u6587\u4ef6\u4e2d\u7684\u4eba\u5458\u540d\u5355,\u5728\u8ba1\u7b97\u673a\u4e2d\u81ea\u52a8\u521b\u5efa\u5bf9\u5e94\u7684\u8d26\u6237\u5e76\u914d\u7f6e\u521d\u59cb\u5bc6\u7801\u672c\u811a\u672c\u6267\u884c,\u9700\u8981\u63d0\u524d\u51c6\u5907\u4e00\u4e2a user.txt \u6587\u4ef6,\u8be5\u6587\u4ef6\u4e2d\u5305\u542b\u6709\u82e5\u5e72\u7528\u6237\u540d\u4fe1\u606f","text":"<pre><code>\n#!/bin/bash\n\n# \u4f7f\u7528 user.txt \u6587\u4ef6\u4e2d\u7684\u4eba\u5458\u540d\u5355,\u5728\u8ba1\u7b97\u673a\u4e2d\u81ea\u52a8\u521b\u5efa\u5bf9\u5e94\u7684\u8d26\u6237\u5e76\u914d\u7f6e\u521d\u59cb\u5bc6\u7801\n# \u672c\u811a\u672c\u6267\u884c,\u9700\u8981\u63d0\u524d\u51c6\u5907\u4e00\u4e2a user.txt \u6587\u4ef6,\u8be5\u6587\u4ef6\u4e2d\u5305\u542b\u6709\u82e5\u5e72\u7528\u6237\u540d\u4fe1\u606f\nfor i in `cat user.txt`\ndo\n     useradd  $i\n     echo \"123456\" | passwd \u2010\u2010stdin $i\ndone\n</code></pre>"},{"location":"chap8/4Basic_shell/#12","title":"12\u3001\u7f16\u5199\u6279\u91cf\u4fee\u6539\u6269\u5c55\u540d\u811a\u672c","text":"<pre><code>#!/bin/bash\n\n# \u7f16\u5199\u6279\u91cf\u4fee\u6539\u6269\u5c55\u540d\u811a\u672c,\u5982\u6279\u91cf\u5c06 txt \u6587\u4ef6\u4fee\u6539\u4e3a doc \u6587\u4ef6 \n# \u6267\u884c\u811a\u672c\u65f6,\u9700\u8981\u7ed9\u811a\u672c\u6dfb\u52a0\u4f4d\u7f6e\u53c2\u6570\n# \u811a\u672c\u540d  txt  doc(\u53ef\u4ee5\u5c06 txt \u7684\u6269\u5c55\u540d\u4fee\u6539\u4e3a doc)\n# \u811a\u672c\u540d  doc  jpg(\u53ef\u4ee5\u5c06 doc \u7684\u6269\u5c55\u540d\u4fee\u6539\u4e3a jpg)\n\nfor i in `ls *.$1`\ndo\n     mv $i ${i%.*}.$2\ndone\n</code></pre>"},{"location":"chap8/4Basic_shell/#13","title":"13\u3001\u70b9\u540d\u5668\u811a\u672c","text":"<pre><code>#!/bin/bash\n\n# \u7f16\u5199\u4e00\u4e2a\u70b9\u540d\u5668\u811a\u672c\n\n# \u8be5\u811a\u672c,\u9700\u8981\u63d0\u524d\u51c6\u5907\u4e00\u4e2a user.txt \u6587\u4ef6\n# \u8be5\u6587\u4ef6\u4e2d\u9700\u8981\u5305\u542b\u6240\u6709\u59d3\u540d\u7684\u4fe1\u606f,\u4e00\u884c\u4e00\u4e2a\u59d3\u540d,\u811a\u672c\u6bcf\u6b21\u968f\u673a\u663e\u793a\u4e00\u4e2a\u59d3\u540d\nwhile :\ndo\n#\u7edf\u8ba1 user \u6587\u4ef6\u4e2d\u6709\u591a\u5c11\u7528\u6237\nline=`cat user.txt |wc \u2010l`\nnum=$[RANDOM%line+1]\nsed -n \"${num}p\"  user.txt\nsleep 0.2\nclear\ndone\n</code></pre>"},{"location":"chap8/4Basic_shell/#14-100-1234100","title":"14 \u5bf9 100 \u4ee5\u5185\u7684\u6240\u6709\u6b63\u6574\u6570\u76f8\u52a0\u6c42\u548c(1+2+3+4...+100)","text":"<pre><code>\n#!/bin/bash\n\n# \u5bf9 100 \u4ee5\u5185\u7684\u6240\u6709\u6b63\u6574\u6570\u76f8\u52a0\u6c42\u548c(1+2+3+4...+100)\n\n#seq 100 \u53ef\u4ee5\u5feb\u901f\u81ea\u52a8\u751f\u6210 100 \u4e2a\u6574\u6570\nsum=0\nfor i in `seq 100`\ndo\n    sum=$[sum+i]\ndone\necho \"\u603b\u548c\u662f:$sum\"\n</code></pre>"},{"location":"chap8/4Basic_shell/#15","title":"15 \u6253\u5370\u56fd\u9645\u8c61\u68cb\u68cb\u76d8","text":"<pre><code>\n#!/bin/bash\n\n# \u6253\u5370\u56fd\u9645\u8c61\u68cb\u68cb\u76d8\n# \u8bbe\u7f6e\u4e24\u4e2a\u53d8\u91cf,i \u548c j,\u4e00\u4e2a\u4ee3\u8868\u884c,\u4e00\u4e2a\u4ee3\u8868\u5217,\u56fd\u9645\u8c61\u68cb\u4e3a 8*8 \u68cb\u76d8\n# i=1 \u662f\u4ee3\u8868\u51c6\u5907\u6253\u5370\u7b2c\u4e00\u884c\u68cb\u76d8,\u7b2c 1 \u884c\u68cb\u76d8\u6709\u7070\u8272\u548c\u84dd\u8272\u95f4\u9694\u8f93\u51fa,\u603b\u5171\u4e3a 8 \u5217\n# i=1,j=1 \u4ee3\u8868\u7b2c 1 \u884c\u7684\u7b2c 1 \u5217;i=2,j=3 \u4ee3\u8868\u7b2c 2 \u884c\u7684\u7b2c 3 \u5217\n# \u68cb\u76d8\u7684\u89c4\u5f8b\u662f i+j \u5982\u679c\u662f\u5076\u6570,\u5c31\u6253\u5370\u84dd\u8272\u8272\u5757,\u5982\u679c\u662f\u5947\u6570\u5c31\u6253\u5370\u7070\u8272\u8272\u5757\n# \u4f7f\u7528 echo \u2010ne \u6253\u5370\u8272\u5757,\u5e76\u4e14\u6253\u5370\u5b8c\u6210\u8272\u5757\u540e\u4e0d\u81ea\u52a8\u6362\u884c,\u5728\u540c\u4e00\u884c\u7ee7\u7eed\u8f93\u51fa\u5176\u4ed6\u8272\u5757\nfor i in {1..8}\ndo\n    for j in {1..8}\n    do\n      sum=$[i+j]\n    if [  $[sum%2] -eq 0 ];then\n       echo -ne \"\\033[46m  \\033[0m\"\n    else\n      echo -ne \"\\033[47m  \\033[0m\"\n    fi\n    done\n    echo\ndone\n</code></pre>"},{"location":"chap8/4Basic_shell/#16-linux","title":"16 \u7edf\u8ba1\u5f53\u524d Linux \u7cfb\u7edf\u4e2d\u53ef\u4ee5\u767b\u5f55\u8ba1\u7b97\u673a\u7684\u8d26\u6237\u6709\u591a\u5c11\u4e2a","text":"<pre><code>\n#!/bin/bash\n\n# \u7edf\u8ba1\u5f53\u524d Linux \u7cfb\u7edf\u4e2d\u53ef\u4ee5\u767b\u5f55\u8ba1\u7b97\u673a\u7684\u8d26\u6237\u6709\u591a\u5c11\u4e2a\n#\u65b9\u6cd5 1:\ngrep \"bash$\" /etc/passwd | wc -l\n#\u65b9\u6cd5 2:\nawk -f: '/bash$/{x++}end{print x}'  /etc/passwd\n</code></pre>"},{"location":"chap8/4Basic_shell/#17-varlog","title":"17 \u7edf\u8ba1<code>/var/log</code> \u6709\u591a\u5c11\u4e2a\u6587\u4ef6,\u5e76\u663e\u793a\u8fd9\u4e9b\u6587\u4ef6\u540d","text":"<pre><code>#!/bin/bash\n\n# \u7edf\u8ba1/var/log \u6709\u591a\u5c11\u4e2a\u6587\u4ef6,\u5e76\u663e\u793a\u8fd9\u4e9b\u6587\u4ef6\u540d \n# \u4f7f\u7528 ls \u9012\u5f52\u663e\u793a\u6240\u6709,\u518d\u5224\u65ad\u662f\u5426\u4e3a\u6587\u4ef6,\u5982\u679c\u662f\u6587\u4ef6\u5219\u8ba1\u6570\u5668\u52a0 1\ncd  /var/log\nsum=0\nfor i in `ls -r *`\ndo\n   if [ -f $i ];then\n       let sum++\n         echo \"\u6587\u4ef6\u540d:$i\"\n     fi\ndone\necho \"\u603b\u6587\u4ef6\u6570\u91cf\u4e3a:$sum\"\n</code></pre>"},{"location":"chap8/4Basic_shell/#18","title":"18 \u81ea\u52a8\u4e3a\u5176\u4ed6\u811a\u672c\u6dfb\u52a0\u89e3\u91ca\u5668\u4fe1\u606f","text":"<pre><code>#!/bin/bash\n\n# \u81ea\u52a8\u4e3a\u5176\u4ed6\u811a\u672c\u6dfb\u52a0\u89e3\u91ca\u5668\u4fe1\u606f#!/bin/bash,\u5982\u811a\u672c\u540d\u4e3a test.sh \u5219\u6548\u679c\u5982\u4e0b: \n# ./test.sh  abc.sh  \u81ea\u52a8\u4e3a abc.sh \u6dfb\u52a0\u89e3\u91ca\u5668\u4fe1\u606f\n# ./test.sh  user.sh  \u81ea\u52a8\u4e3a user.sh \u6dfb\u52a0\u89e3\u91ca\u5668\u4fe1\u606f\n\n# \u5148\u4f7f\u7528 grep \u5224\u65ad\u5bf9\u8c61\u811a\u672c\u662f\u5426\u5df2\u7ecf\u6709\u89e3\u91ca\u5668\u4fe1\u606f,\u5982\u679c\u6ca1\u6709\u5219\u4f7f\u7528 sed \u6dfb\u52a0\u89e3\u91ca\u5668\u4ee5\u53ca\u63cf\u8ff0\u4fe1\u606f\nif  !  grep  -q  \"^#!\"  $1; then\nsed  '1i #!/bin/bash'  $1\nsed  '2i #Description: '\nfi\n# \u56e0\u4e3a\u6bcf\u4e2a\u811a\u672c\u7684\u529f\u80fd\u4e0d\u540c,\u4f5c\u7528\u4e0d\u540c,\u6240\u4ee5\u5728\u7ed9\u5bf9\u8c61\u811a\u672c\u6dfb\u52a0\u5b8c\u89e3\u91ca\u5668\u4fe1\u606f,\u4ee5\u53ca Description \u540e\u8fd8\u5e0c\u671b\n# \u7ee7\u7eed\u7f16\u8f91\u5177\u4f53\u7684\u811a\u672c\u529f\u80fd\u7684\u63cf\u8ff0\u4fe1\u606f,\u8fd9\u91cc\u76f4\u63a5\u4f7f\u7528 vim \u628a\u5bf9\u8c61\u811a\u672c\u6253\u5f00,\u5e76\u4e14\u5149\u6807\u8df3\u8f6c\u5230\u8be5\u6587\u4ef6\u7684\u7b2c 2 \u884c\nvim +2 $1\n</code></pre>"},{"location":"chap8/4Basic_shell/#19","title":"19 \u81ea\u52a8\u5bf9\u78c1\u76d8\u5206\u533a\u3001\u683c\u5f0f\u5316\u3001\u6302\u8f7d","text":"<pre><code> #!/bin/bash\n\n# \u81ea\u52a8\u5bf9\u78c1\u76d8\u5206\u533a\u3001\u683c\u5f0f\u5316\u3001\u6302\u8f7d\n# \u5bf9\u865a\u62df\u673a\u7684 vdb \u78c1\u76d8\u8fdb\u884c\u5206\u533a\u683c\u5f0f\u5316,\u4f7f\u7528&lt;&lt;\u5c06\u9700\u8981\u7684\u5206\u533a\u6307\u4ee4\u5bfc\u5165\u7ed9\u7a0b\u5e8f fdisk\n# n(\u65b0\u5efa\u5206\u533a),p(\u521b\u5efa\u4e3b\u5206\u533a),1(\u5206\u533a\u7f16\u53f7\u4e3a 1),\u4e24\u4e2a\u7a7a\u767d\u884c(\u4e24\u4e2a\u56de\u8f66,\u76f8\u5f53\u4e8e\u5c06\u6574\u4e2a\u78c1\u76d8\u5206\u4e00\u4e2a\u533a)\n# \u6ce8\u610f:1 \u540e\u9762\u7684\u4e24\u4e2a\u56de\u8f66(\u7a7a\u767d\u884c)\u662f\u5fc5\u987b\u7684!\nfdisk /dev/vdb &lt;&lt; EOF\nn\np\n1\n\n\nwq\nEOF\n\n#\u683c\u5f0f\u5316\u521a\u521a\u521b\u5efa\u597d\u7684\u5206\u533a\nmkfs.xfs   /dev/vdb1\n\n#\u521b\u5efa\u6302\u8f7d\u70b9\u76ee\u5f55\nif [ -e /data ]; then\nexit\nfi\nmkdir /data\n\n#\u81ea\u52a8\u6302\u8f7d\u521a\u521a\u521b\u5efa\u7684\u5206\u533a,\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u52a8\u6302\u8f7d\u8be5\u5206\u533a\necho '/dev/vdb1     /data    xfs    defaults        1 2'  &gt;&gt; /etc/fstab\nmount -a\n</code></pre>"},{"location":"chap8/4Basic_shell/#20-linux","title":"20 \u81ea\u52a8\u4f18\u5316 Linux \u5185\u6838\u53c2\u6570","text":"<pre><code>#!/bin/bash\n\n# \u81ea\u52a8\u4f18\u5316 Linux \u5185\u6838\u53c2\u6570\n\n#\u811a\u672c\u9488\u5bf9 RHEL7\ncat &gt;&gt; /usr/lib/sysctl.d/00\u2010system.conf &lt;&lt;EOF\nfs.file\u2010max=65535\nnet.ipv4.tcp_timestamps = 0\nnet.ipv4.tcp_synack_retries = 5\nnet.ipv4.tcp_syn_retries = 5\nnet.ipv4.tcp_tw_recycle = 1\nnet.ipv4.tcp_tw_reuse = 1\nnet.ipv4.tcp_fin_timeout = 30\n#net.ipv4.tcp_keepalive_time = 120\nnet.ipv4.ip_local_port_range = 1024  65535\nkernel.shmall = 2097152\nkernel.shmmax = 2147483648\nkernel.shmmni = 4096\nkernel.sem = 5010 641280 5010 128\nnet.core.wmem_default=262144\nnet.core.wmem_max=262144\nnet.core.rmem_default=4194304\nnet.core.rmem_max=4194304\nnet.ipv4.tcp_fin_timeout = 10\nnet.ipv4.tcp_keepalive_time = 30\nnet.ipv4.tcp_window_scaling = 0\nnet.ipv4.tcp_sack = 0\nEOF\n\nsysctl \u2013p\n</code></pre>"},{"location":"chap8/4Basic_shell/#21","title":"21 \u5c06\u6587\u4ef6\u4e2d\u6240\u6709\u7684\u5c0f\u5199\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5927\u5199\u5b57\u6bcd","text":"<pre><code>\n#!/bin/bash\n\n# \u5c06\u6587\u4ef6\u4e2d\u6240\u6709\u7684\u5c0f\u5199\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5927\u5199\u5b57\u6bcd \n\n# $1\u662f\u4f4d\u7f6e\u53c2\u6570,\u662f\u4f60\u9700\u8981\u8f6c\u6362\u5927\u5c0f\u5199\u5b57\u6bcd\u7684\u6587\u4ef6\u540d\u79f0\n# \u6267\u884c\u811a\u672c,\u7ed9\u5b9a\u4e00\u4e2a\u6587\u4ef6\u540d\u4f5c\u4e3a\u53c2\u6570,\u811a\u672c\u5c31\u4f1a\u5c06\u8be5\u6587\u4ef6\u4e2d\u6240\u6709\u7684\u5c0f\u5199\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5927\u5199\u5b57\u6bcd\ntr \"[a\u2010z]\" \"[A\u2010Z]\" &lt; $1\n</code></pre>"},{"location":"chap8/4Basic_shell/#22","title":"22 \u4f7f\u7528\u811a\u672c\u81ea\u52a8\u521b\u5efa\u903b\u8f91\u5377","text":"<pre><code>\n#!/bin/bash\n\n# \u4f7f\u7528\u811a\u672c\u81ea\u52a8\u521b\u5efa\u903b\u8f91\u5377 \n\n# \u6e05\u5c4f,\u663e\u793a\u8b66\u544a\u4fe1\u606f,\u521b\u5efa\u5c06\u78c1\u76d8\u8f6c\u6362\u4e3a\u903b\u8f91\u5377\u4f1a\u5220\u9664\u6570\u636e\nclear\necho -e \"\\033[32m           !!!!!!\u8b66\u544a(Warning)!!!!!!\\033[0m\"\necho\necho \"+++++++++++++++++++++++++++++++++++++++++++++++++\"\necho \"\u811a\u672c\u4f1a\u5c06\u6574\u4e2a\u78c1\u76d8\u8f6c\u6362\u4e3a PV,\u5e76\u5220\u9664\u78c1\u76d8\u4e0a\u6240\u6709\u6570\u636e!!!\"\necho \"This Script will destroy all data on the Disk\"\necho \"+++++++++++++++++++++++++++++++++++++++++++++++++\"\necho\nread -p \"\u8bf7\u95ee\u662f\u5426\u7ee7\u7eed y/n?:\" sure\n\n# \u6d4b\u8bd5\u7528\u6237\u8f93\u5165\u7684\u662f\u5426\u4e3a y,\u5982\u679c\u4e0d\u662f\u5219\u9000\u51fa\u811a\u672c\n[ $sure != y ] &amp;&amp; exit\n\n# \u63d0\u793a\u7528\u6237\u8f93\u5165\u76f8\u5173\u53c2\u6570(\u78c1\u76d8\u3001\u5377\u7ec4\u540d\u79f0\u7b49\u6570\u636e),\u5e76\u6d4b\u8bd5\u7528\u6237\u662f\u5426\u8f93\u5165\u4e86\u8fd9\u4e9b\u503c,\u5982\u679c\u6ca1\u6709\u8f93\u5165,\u5219\u811a\u672c\u9000\u51fa\nread -p \"\u8bf7\u8f93\u5165\u78c1\u76d8\u540d\u79f0,\u5982/dev/vdb:\" disk\n[ -z $disk ] &amp;&amp; echo \"\u6ca1\u6709\u8f93\u5165\u78c1\u76d8\u540d\u79f0\" &amp;&amp; exit\nread -p \"\u8bf7\u8f93\u5165\u5377\u7ec4\u540d\u79f0:\" vg_name\n[ -z $vg_name ] &amp;&amp; echo \"\u6ca1\u6709\u8f93\u5165\u5377\u7ec4\u540d\u79f0\" &amp;&amp; exit\nread -p \"\u8bf7\u8f93\u5165\u903b\u8f91\u5377\u540d\u79f0:\" lv_name\n[ -z $lv_name ] &amp;&amp; echo \"\u6ca1\u6709\u8f93\u5165\u903b\u8f91\u5377\u540d\u79f0\" &amp;&amp; exit\nread -p \"\u8bf7\u8f93\u5165\u903b\u8f91\u5377\u5927\u5c0f:\" lv_size\n[ -z $lv_size ] &amp;&amp; echo \"\u6ca1\u6709\u8f93\u5165\u903b\u8f91\u5377\u5927\u5c0f\" &amp;&amp; exit\n\n# \u4f7f\u7528\u547d\u4ee4\u521b\u5efa\u903b\u8f91\u5377\npvcreate $disk\nvgcreate $vg_name $disk\nlvcreate -L ${lv_size}M -n ${lv_name}  ${vg_name}\n</code></pre>"},{"location":"chap8/4Basic_shell/#23-cpu","title":"23 \u663e\u793a CPU \u5382\u5546\u4fe1\u606f","text":"<pre><code>#!/bin/bash\n\n# \u663e\u793a CPU \u5382\u5546\u4fe1\u606f \nawk '/vendor_id/{print $3}' /proc/cpuinfo | uniq\n</code></pre>"},{"location":"chap8/4Basic_shell/#24-0","title":"24 \u5220\u9664\u67d0\u4e2a\u76ee\u5f55\u4e0b\u5927\u5c0f\u4e3a 0 \u7684\u6587\u4ef6","text":"<pre><code>\n#!/bin/bash\n\n# \u5220\u9664\u67d0\u4e2a\u76ee\u5f55\u4e0b\u5927\u5c0f\u4e3a 0 \u7684\u6587\u4ef6\n\n#/var/www/html \u4e3a\u6d4b\u8bd5\u76ee\u5f55,\u811a\u672c\u4f1a\u6e05\u7a7a\u8be5\u76ee\u5f55\u4e0b\u6240\u6709 0 \u5b57\u8282\u7684\u6587\u4ef6\ndir=\"/var/www/html\"\nfind $dir -type f -size 0 -exec rm -rf {} \\;\n</code></pre>"},{"location":"chap8/4Basic_shell/#25-linux","title":"25 \u67e5\u627e Linux \u7cfb\u7edf\u4e2d\u7684\u50f5\u5c38\u8fdb\u7a0b","text":"<pre><code>#!/bin/bash\n\n# \u67e5\u627e Linux \u7cfb\u7edf\u4e2d\u7684\u50f5\u5c38\u8fdb\u7a0b\n\n# awk \u5224\u65ad ps \u547d\u4ee4\u8f93\u51fa\u7684\u7b2c 8 \u5217\u4e3a Z \u662f,\u663e\u793a\u8be5\u8fdb\u7a0b\u7684 PID \u548c\u8fdb\u7a0b\u547d\u4ee4\nps aux | awk '{if($8 == \"Z\"){print $2,$11}}'\n</code></pre>"},{"location":"chap8/4Basic_shell/#26","title":"26 \u63d0\u793a\u7528\u6237\u8f93\u5165\u5e74\u4efd\u540e\u5224\u65ad\u8be5\u5e74\u662f\u5426\u4e3a\u95f0\u5e74","text":"<pre><code>\n#!/bin/bash\n\n# \u63d0\u793a\u7528\u6237\u8f93\u5165\u5e74\u4efd\u540e\u5224\u65ad\u8be5\u5e74\u662f\u5426\u4e3a\u95f0\u5e74\n\n# \u80fd\u88ab4\u6574\u9664\u5e76\u4e14\u5e76\u4e0d\u80fd\u88ab100\u6574\u9664\u7684\u5e74\u4efd\u662f\u95f0\u5e74\n# \u80fd\u88ab400\u6574\u9664\u7684\u5e74\u4efd\u4e5f\u662f\u95f0\u5e74\nread -p \"\u8bf7\u8f93\u5165\u4e00\u4e2a\u5e74\u4efd:\" year\n\nif [ \"$year\" = \"\" ];then\n    echo \"\u6ca1\u6709\u8f93\u5165\u5e74\u4efd\"\n    exit\nfi\n#\u4f7f\u7528\u6b63\u5219\u6d4b\u8bd5\u53d8\u91cf year \u4e2d\u662f\u5426\u5305\u542b\u5927\u5c0f\u5199\u5b57\u6bcd\nif [[ \"$year\" =~ [a\u2010Z] ]];then\n    echo \"\u4f60\u8f93\u5165\u7684\u4e0d\u662f\u6570\u5b57\"\n    exit\nfi\n# \u5224\u65ad\u662f\u5426\u4e3a\u95f0\u5e74\nif [ $[year % 4] -eq 0 ] &amp;&amp; [ $[year % 100] -ne 0 ];then\n    echo \"$year\u5e74\u662f\u95f0\u5e74\"  \nelif [ $[year % 400] -eq 0 ];then\n    echo \"$year\u5e74\u662f\u95f0\u5e74\"\nelse\n    echo \"$year\u5e74\u4e0d\u662f\u95f0\u5e74\"\nfi\n</code></pre>"},{"location":"chap8/4Basic_shell/#27-shell-fork","title":"27 Shell \u811a\u672c\u7684 fork \u70b8\u5f39","text":"<pre><code>\n#!/bin/bash\n\n# Shell \u811a\u672c\u7684 fork \u70b8\u5f39 \n\n# \u5feb\u901f\u6d88\u8017\u8ba1\u7b97\u673a\u8d44\u6e90,\u81f4\u4f7f\u8ba1\u7b97\u673a\u6b7b\u673a\n# \u5b9a\u4e49\u51fd\u6570\u540d\u4e3a.(\u70b9), \u51fd\u6570\u4e2d\u9012\u5f52\u8c03\u7528\u81ea\u5df1\u5e76\u653e\u5165\u540e\u53f0\u6267\u884c\n.() { .|.&amp; };.\n</code></pre>"},{"location":"chap8/4Basic_shell/#28","title":"28 \u663e\u793a\u5f53\u524d\u8ba1\u7b97\u673a\u4e2d\u6240\u6709\u8d26\u6237\u7684\u7528\u6237\u540d\u79f0","text":"<pre><code>\n #!/bin/bash\n\n# \u663e\u793a\u5f53\u524d\u8ba1\u7b97\u673a\u4e2d\u6240\u6709\u8d26\u6237\u7684\u7528\u6237\u540d\u79f0\n\n# \u4e0b\u9762\u4f7f\u75283\u79cd\u4e0d\u540c\u7684\u65b9\u5f0f\u5217\u51fa\u8ba1\u7b97\u673a\u4e2d\u6240\u6709\u8d26\u6237\u7684\u7528\u6237\u540d\n# \u6307\u5b9a\u4ee5:\u4e3a\u5206\u9694\u7b26,\u6253\u5370/etc/passwd \u6587\u4ef6\u7684\u7b2c 1 \u5217\nawk -F: '{print $1}' /etc/passwd\n\n# \u6307\u5b9a\u4ee5:\u4e3a\u5206\u9694\u7b26,\u6253\u5370/etc/passwd \u6587\u4ef6\u7684\u7b2c 1 \u5217\ncut -d: -f1 /etc/passwd\n\n# \u4f7f\u7528 sed \u7684\u66ff\u6362\u529f\u80fd,\u5c06/etc/passwd \u6587\u4ef6\u4e2d:\u540e\u9762\u7684\u6240\u6709\u5185\u5bb9\u66ff\u6362\u4e3a\u7a7a(\u4ec5\u663e\u793a\u7528\u6237\u540d)\nsed 's/:.*//' /etc/passwd\n</code></pre>"},{"location":"chap8/4Basic_shell/#29-tar-data","title":"29 \u5236\u5b9a\u76ee\u5f55\u8def\u5f84,\u811a\u672c\u81ea\u52a8\u5c06\u8be5\u76ee\u5f55\u4f7f\u7528 tar \u547d\u4ee4\u6253\u5305\u5907\u4efd\u5230<code>/data</code>\u76ee\u5f55","text":"<pre><code>#!/bin/bash\n\n# \u5236\u5b9a\u76ee\u5f55\u8def\u5f84,\u811a\u672c\u81ea\u52a8\u5c06\u8be5\u76ee\u5f55\u4f7f\u7528 tar \u547d\u4ee4\u6253\u5305\u5907\u4efd\u5230/data\u76ee\u5f55 \n\n[ ! -d /data ] &amp;&amp; mkdir /data\n[ -z $1 ] &amp;&amp; exit\nif [ -d $1 ];then\n  tar -czf /data/$1.-`date +%Y%m%d`.tar.gz $1\nelse\n    echo \"\u8be5\u76ee\u5f55\u4e0d\u5b58\u5728\"\nfi\n</code></pre>"},{"location":"chap8/4Basic_shell/#30","title":"30 \u663e\u793a\u8fdb\u5ea6\u6761(\u56de\u65cb\u9556\u7248)","text":"<pre><code>#!/bin/bash\n\n# \u663e\u793a\u8fdb\u5ea6\u6761(\u56de\u65cb\u9556\u7248)\n\nwhile :\ndo\n  clear\n  for i in {1..20}\n  do\n    echo \u2010e \"\\033[3;${i}H*\"\n    sleep 0.1\n    done\n    clear\n    for i in {20..1}\n    do\n    echo \u2010e \"\\033[3;${i}H*\"\n    sleep 0.1\n    done\n    clear\ndone\n</code></pre>"},{"location":"chap8/4Basic_shell/#31-linux","title":"31 \u4fee\u6539 Linux \u7cfb\u7edf\u7684\u6700\u5927\u6253\u5f00\u6587\u4ef6\u6570\u91cf","text":"<pre><code>\n#!/bin/bash\n\n# \u4fee\u6539 Linux \u7cfb\u7edf\u7684\u6700\u5927\u6253\u5f00\u6587\u4ef6\u6570\u91cf \n\n# \u5f80/etc/security/limits.conf \u6587\u4ef6\u7684\u672b\u5c3e\u8ffd\u52a0\u4e24\u884c\u914d\u7f6e\u53c2\u6570,\u4fee\u6539\u6700\u5927\u6253\u5f00\u6587\u4ef6\u6570\u91cf\u4e3a 65536\ncat &gt;&gt; /etc/security/limits.conf &lt;&lt;EOF\n* soft nofile  65536\n* hard nofile  65536\nEOF\n</code></pre>"},{"location":"chap8/4Basic_shell/#32","title":"32 \u81ea\u52a8\u4fee\u6539\u8ba1\u5212\u4efb\u52a1\u914d\u7f6e\u6587\u4ef6","text":"<pre><code>#!/bin/bash\n\n# \u81ea\u52a8\u4fee\u6539\u8ba1\u5212\u4efb\u52a1\u914d\u7f6e\u6587\u4ef6 \n\nread -p \"\u8bf7\u8f93\u5165\u5206\u949f\u4fe1\u606f(00\u201059):\" min\nread -p \"\u8bf7\u8f93\u5165\u5c0f\u65f6\u4fe1\u606f(00\u201024):\" hour\nread -p \"\u8bf7\u8f93\u5165\u65e5\u671f\u4fe1\u606f(01\u201031):\" date\nread -p \"\u8bf7\u8f93\u5165\u6708\u4efd\u4fe1\u606f(01\u201012):\" month\nread -p \"\u8bf7\u8f93\u5165\u661f\u671f\u4fe1\u606f(00\u201006):\" weak\nread -p \"\u8bf7\u8f93\u5165\u8ba1\u5212\u4efb\u52a1\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\u6216\u811a\u672c:\" program\necho \"$min $hour $date $month $weak $program\" &gt;&gt; /etc/crontab\n</code></pre>"},{"location":"chap8/4Basic_shell/#33-111-999","title":"33 \u4f7f\u7528\u811a\u672c\u5faa\u73af\u521b\u5efa\u4e09\u4f4d\u6570\u5b57\u7684\u6587\u672c\u6587\u4ef6(111-999 \u7684\u6587\u4ef6)","text":"<pre><code>\n#!/bin/bash\n\n# \u4f7f\u7528\u811a\u672c\u5faa\u73af\u521b\u5efa\u4e09\u4f4d\u6570\u5b57\u7684\u6587\u672c\u6587\u4ef6(111-999 \u7684\u6587\u4ef6) \n\nfor i in {1..9}\ndo\n  for j in {1..9}\n  do\n    for k in {1..9}\n    do\n      touch /tmp/$i$j$k.txt\n    done\n    done\ndone\n</code></pre>"},{"location":"chap8/4Basic_shell/#34-linux","title":"34\u3001\u7edf\u8ba1 Linux \u8fdb\u7a0b\u76f8\u5173\u6570\u91cf\u4fe1\u606f","text":"<pre><code>#!/bin/bash\n\n# \u7edf\u8ba1 Linux \u8fdb\u7a0b\u76f8\u5173\u6570\u91cf\u4fe1\u606f \n\nrunning=0\nsleeping=0\nstoped=0\nzombie=0\n# \u5728 proc \u76ee\u5f55\u4e0b\u6240\u6709\u4ee5\u6570\u5b57\u5f00\u59cb\u7684\u90fd\u662f\u5f53\u524d\u8ba1\u7b97\u673a\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\u7684\u8fdb\u7a0b PID\n# \u6bcf\u4e2a PID \u7f16\u53f7\u7684\u76ee\u5f55\u4e0b\u8bb0\u5f55\u6709\u8be5\u8fdb\u7a0b\u76f8\u5173\u7684\u4fe1\u606f\nfor pid in /proc/[1\u20109]*\ndo\n  procs=$[procs+1]\n  stat=$(awk '{print $3}' $pid/stat)\n# \u6bcf\u4e2a pid \u76ee\u5f55\u4e0b\u90fd\u6709\u4e00\u4e2a stat \u6587\u4ef6,\u8be5\u6587\u4ef6\u7684\u7b2c 3 \u5217\u662f\u8be5\u8fdb\u7a0b\u7684\u72b6\u6001\u4fe1\u606f\n    case $stat in\n    R)\n    running=$[running+1]\n    ;;\n    T)\n    stoped=$[stoped+1]\n    ;;\n    S)\n    sleeping=$[sleeping+1]\n    ;;\n    Z)\n     zombie=$[zombie+1]\n     ;;\n    esac\ndone\necho \"\u8fdb\u7a0b\u7edf\u8ba1\u4fe1\u606f\u5982\u4e0b\"\necho \"\u603b\u8fdb\u7a0b\u6570\u91cf\u4e3a:$procs\"\necho \"Running \u8fdb\u7a0b\u6570\u4e3a:$running\"\necho \"Stoped \u8fdb\u7a0b\u6570\u4e3a:$stoped\"\necho \"Sleeping \u8fdb\u7a0b\u6570\u4e3a:$sleeping\"\necho \"Zombie \u8fdb\u7a0b\u6570\u4e3a:$zombie\"\n</code></pre>"},{"location":"chap8/4Basic_shell/#35","title":"35 \u4ece\u952e\u76d8\u8bfb\u53d6\u4e00\u4e2a\u8bba\u575b\u79ef\u5206,\u5224\u65ad\u8bba\u575b\u7528\u6237\u7b49\u7ea7","text":"<pre><code>#!/bin/bash\n\n# \u4ece\u952e\u76d8\u8bfb\u53d6\u4e00\u4e2a\u8bba\u575b\u79ef\u5206,\u5224\u65ad\u8bba\u575b\u7528\u6237\u7b49\u7ea7\n\n#\u7b49\u7ea7\u5206\u7c7b\u5982\u4e0b:\n#  \u5927\u4e8e\u7b49\u4e8e 90        \u795e\u529f\u7edd\u4e16\n#  \u5927\u4e8e\u7b49\u4e8e 80,\u5c0f\u4e8e 90       \u767b\u5cf0\u9020\u6781\n#  \u5927\u4e8e\u7b49\u4e8e 70,\u5c0f\u4e8e 80       \u7089\u706b\u7eaf\u9752\n#  \u5927\u4e8e\u7b49\u4e8e 60,\u5c0f\u4e8e 70       \u7565\u6709\u5c0f\u6210\n#  \u5c0f\u4e8e 60               \u521d\u5b66\u4e4d\u7ec3\nread -p \"\u8bf7\u8f93\u5165\u79ef\u5206(0\u2010100):\" JF\nif [ $JF -ge 90 ] ; then\n  echo \"$JF \u5206,\u795e\u529f\u7edd\u4e16\"\nelif [ $JF -ge 80 ] ; then\n    echo \"$JF \u5206,\u767b\u5cf0\u9020\u6781\"\nelif [ $JF -ge 70 ] ; then\n    echo \"$JF \u5206,\u7089\u706b\u7eaf\u9752\"\nelif [ $JF -lt 60 ] ; then\n    echo \"$JF \u5206,\u7565\u6709\u5c0f\u6210\"\nelse\n    echo \"$JF \u5206,\u521d\u5b66\u4e4d\u7ec3\"\nfi\n</code></pre>"},{"location":"chap8/4Basic_shell/#36","title":"36 \u5224\u65ad\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\u7c7b\u578b(\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u5176\u4ed6)","text":"<pre><code>#!/bin/bash\n\n# \u5224\u65ad\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\u7c7b\u578b(\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u5176\u4ed6) \nread -p \"\u8bf7\u8f93\u5165\u4e00\u4e2a\u5b57\u7b26:\" KEY\ncase \"$KEY\" in\n  [a\u2010z]|[A\u2010Z])\n    echo \"\u5b57\u6bcd\" \n    ;;\n  [0\u20109])\n    echo \"\u6570\u5b57\" \n    ;;\n  *)\n    echo \"\u7a7a\u683c\u3001\u529f\u80fd\u952e\u6216\u5176\u4ed6\u63a7\u5236\u5b57\u7b26\"\nesac\n</code></pre>"},{"location":"chap8/4Basic_shell/#37","title":"37 \u663e\u793a\u8fdb\u5ea6\u6761(\u6570\u5b57\u7248)","text":"<pre><code>\n#!/bin/bash\n\n# \u663e\u793a\u8fdb\u5ea6\u6761(\u6570\u5b57\u7248) \n# echo \u4f7f\u7528\u2010e \u9009\u9879\u540e,\u5728\u6253\u5370\u53c2\u6570\u4e2d\u53ef\u4ee5\u6307\u5b9a H,\u8bbe\u7f6e\u9700\u8981\u6253\u5370\u5185\u5bb9\u7684 x,y \u8f74\u7684\u5b9a\u4f4d\u5750\u6807\n# \u8bbe\u7f6e\u9700\u8981\u6253\u5370\u5185\u5bb9\u5728\u7b2c\u51e0\u884c,\u7b2c\u51e0\u5217\nfor i in {1..100}\ndo\n    echo -e \"\\033[6;8H[\"\n    echo -e \"\\033[6;9H$i%\"\n    echo -e \"\\033[6;13H]\"\n    sleep 0.1\ndone\n</code></pre>"},{"location":"chap8/4Basic_shell/#38","title":"38 \u6253\u5370\u6590\u6ce2\u90a3\u5951\u6570\u5217","text":"<pre><code>\n#!/bin/bash\n\n# \u6253\u5370\u6590\u6ce2\u90a3\u5951\u6570\u5217(\u8be5\u6570\u5217\u7684\u7279\u70b9\u662f\u540e\u4e00\u4e2a\u6570\u5b57,\u6c38\u8fdc\u90fd\u662f\u524d 2 \u4e2a\u6570\u5b57\u4e4b\u548c) \n\n# \u6590\u6ce2\u90a3\u5951\u6570\u5217\u540e\u4e00\u4e2a\u6570\u5b57\u6c38\u8fdc\u662f\u524d 2 \u4e2a\u6570\u5b57\u4e4b\u548c\n# \u5982:0  1  1  2  3  5  8  13 ... ...\nlist=(0 1)\nfor i in `seq 2 11`\ndo\n  list[$i]=`expr ${list[\u20101]} + ${list[\u20102]}`\ndone\necho ${list[@]}\n</code></pre>"},{"location":"chap8/4Basic_shell/#39-yes-no","title":"39 \u5224\u65ad\u7528\u6237\u8f93\u5165\u7684\u662f Yes \u6216 NO","text":"<pre><code>#!/bin/bash\n\n# \u5224\u65ad\u7528\u6237\u8f93\u5165\u7684\u662f Yes \u6216 NO \n\nread -p  \"Are you sure?[y/n]:\"  sure\ncase  $sure  in\n  y|Y|Yes|YES)  \n    echo \"you enter $a\"\n    ;;\n    n|N|NO|no)\n     echo \"you enter $a\"\n     ;;\n    *)\n     echo \"error\";;\nesac\n</code></pre>"},{"location":"chap8/4Basic_shell/#40-linux-uid-1000","title":"40 \u5c06 Linux \u7cfb\u7edf\u4e2d UID \u5927\u4e8e\u7b49\u4e8e 1000 \u7684\u666e\u901a\u7528\u6237\u90fd\u5220\u9664","text":"<pre><code>#!/bin/bash\n\n# \u5c06 Linux \u7cfb\u7edf\u4e2d UID \u5927\u4e8e\u7b49\u4e8e 1000 \u7684\u666e\u901a\u7528\u6237\u90fd\u5220\u9664 \n\n# \u5148\u7528 awk \u63d0\u53d6\u6240\u6709 uid \u5927\u4e8e\u7b49\u4e8e 1000 \u7684\u666e\u901a\u7528\u6237\u540d\u79f0\n# \u518d\u4f7f\u7528 for \u5faa\u73af\u9010\u4e2a\u5c06\u6bcf\u4e2a\u7528\u6237\u5220\u9664\u5373\u53ef\nuser=$(awk -F: '$3&gt;=1000{print $1}' /etc/passwd)\nfor i in $user\ndo\n     userdel -r $i\ndone\n</code></pre>"},{"location":"chap8/4Basic_shell/#41","title":"41 \u4f7f\u7528\u811a\u672c\u5f00\u542f\u5173\u95ed\u865a\u62df\u673a","text":"<pre><code>#!/bin/bash\n\n# \u4f7f\u7528\u811a\u672c\u5f00\u542f\u5173\u95ed\u865a\u62df\u673a \n\n# \u811a\u672c\u901a\u8fc7\u8c03\u7528virsh\u547d\u4ee4\u5b9e\u73b0\u5bf9\u865a\u62df\u673a\u7684\u7ba1\u7406,\u5982\u679c\u6ca1\u6709\u8be5\u547d\u4ee4,\u9700\u8981\u5b89\u88c5 libvirt\u2010client \u8f6f\u4ef6\u5305\n# $1\u662f\u811a\u672c\u7684\u7b2c1\u4e2a\u53c2\u6570,$2\u662f\u811a\u672c\u7684\u7b2c2\u4e2a\u53c2\u6570\n# \u7b2c1\u4e2a\u53c2\u6570\u662f\u4f60\u5e0c\u671b\u5bf9\u865a\u62df\u673a\u8fdb\u884c\u7684\u64cd\u4f5c\u6307\u4ee4,\u7b2c2\u4e2a\u53c2\u6570\u662f\u865a\u62df\u673a\u540d\u79f0\ncase $1 in\n  list)\n    virsh list --all\n    ;;\n  start)\n    virsh start $2\n    ;;\n  stop)\n    virsh destroy $2\n    ;;\n  enable)\n    virsh autostart $2\n    ;;\n  disable)\n    virsh autostart --disable $2\n    ;;\n  *)\n    echo \"Usage:$0 list\"\n    echo \"Usage:$0 [start|stop|enable|disable]  VM_name\"\n    cat &lt;&lt; EOF\n    #list      \u663e\u793a\u865a\u62df\u673a\u5217\u8868\n    #start     \u542f\u52a8\u865a\u62df\u673a\n    #stop      \u5173\u95ed\u865a\u62df\u673a\n    #enable    \u8bbe\u7f6e\u865a\u62df\u673a\u4e3a\u5f00\u673a\u81ea\u542f\n    #disable   \u5173\u95ed\u865a\u62df\u673a\u5f00\u673a\u81ea\u542f\u529f\u80fd\n    EOF\n    ;;\nesac\n</code></pre>"},{"location":"chap8/4Basic_shell/#42-shell","title":"42 \u8c03\u6574\u865a\u62df\u673a\u5185\u5b58\u53c2\u6570\u7684 shell \u811a\u672c","text":"<pre><code>#!/bin/bash\n\n# \u8c03\u6574\u865a\u62df\u673a\u5185\u5b58\u53c2\u6570\u7684 shell \u811a\u672c \n\n# \u811a\u672c\u901a\u8fc7\u8c03\u7528 virsh \u547d\u4ee4\u5b9e\u73b0\u5bf9\u865a\u62df\u673a\u7684\u7ba1\u7406,\u5982\u679c\u6ca1\u6709\u8be5\u547d\u4ee4,\u9700\u8981\u5b89\u88c5 libvirt\u2010client \u8f6f\u4ef6\u5305\ncat &lt;&lt; EOF\n1.\u8c03\u6574\u865a\u62df\u673a\u6700\u5927\u5185\u5b58\u6570\u503c\n2.\u8c03\u6574\u5b9e\u9645\u5206\u914d\u7ed9\u865a\u62df\u673a\u7684\u5185\u5b58\u6570\u503c\nEOF\nread -p \"\u8bf7\u9009\u62e9[1\u20102]:\" select\ncase $select in\n  1)\n      read -p \"\u8bf7\u8f93\u5165\u865a\u62df\u673a\u540d\u79f0\" name\n      read -p \"\u8bf7\u8f93\u5165\u6700\u5927\u5185\u5b58\u6570\u503c(\u5355\u4f4d:k):\" size\n      virsh setmaxmem $name --size $size --config\n      ;;\n  2)\n      read -p \"\u8bf7\u8f93\u5165\u865a\u62df\u673a\u540d\u79f0\" name\n      read -p \"\u8bf7\u8f93\u5165\u5b9e\u9645\u5206\u914d\u5185\u5b58\u6570\u503c(\u5355\u4f4d:k):\" size\n      virsh setmem $name $size\n      ;;\n  *)\n      echo \"Error\"\n      ;;\nesac\n</code></pre>"},{"location":"chap8/4Basic_shell/#43","title":"43 \u7834\u89e3\u865a\u62df\u673a\u5bc6\u7801,\u65e0\u5bc6\u7801\u767b\u9646\u865a\u62df\u673a\u7cfb\u7edf","text":"<pre><code>#!/bin/bash\n\n# \u7834\u89e3\u865a\u62df\u673a\u5bc6\u7801,\u65e0\u5bc6\u7801\u767b\u9646\u865a\u62df\u673a\u7cfb\u7edf \n\n# \u8be5\u811a\u672c\u4f7f\u7528 guestmount \u5de5\u5177,Centos7.2 \u4e2d\u5b89\u88c5 libguestfs\u2010tools\u2010c \u53ef\u4ee5\u83b7\u5f97 guestmount \u5de5\u5177\n\nread -p \"\u8bf7\u8f93\u5165\u865a\u62df\u673a\u540d\u79f0:\" name\nif virsh domstate $name | grep -q running ;then\n  echo \"\u7834\u89e3,\u9700\u8981\u5173\u95ed\u865a\u62df\u673a\"\n  virsh destroy $name\nfi\nmountpoint=\"/media/virtimage\"\n[ ! -d $mountpoint ] &amp;&amp; mkdir $mountpoint\necho \"\u8bf7\u7a0d\u540e...\"\nif mount | grep -q \"$mountpoint\" ;then\n  umount $mountpoint\nfi\nguestmount -d $name -i $mountpoint\n# \u5c06 passwd \u4e2d\u5bc6\u7801\u5360\u4f4d\u7b26\u53f7 x \u5220\u9664,\u8be5\u8d26\u6237\u5373\u53ef\u5b9e\u73b0\u65e0\u5bc6\u7801\u767b\u9646\u7cfb\u7edf\nsed -i \"/^root/s/x//\" $mountpoint/etc/passwd\n</code></pre>"},{"location":"chap8/4Basic_shell/#44-shell-ctrlc","title":"44 Shell \u811a\u672c\u5bf9\u4fe1\u53f7\u7684\u5904\u7406,\u6267\u884c\u811a\u672c\u540e,\u6309\u952e\u76d8 Ctrl+C \u65e0\u6cd5\u7ec8\u6b62\u7684\u811a\u672c","text":"<pre><code>#!/bin/bash\n\n# Shell \u811a\u672c\u5bf9\u4fe1\u53f7\u7684\u5904\u7406,\u6267\u884c\u811a\u672c\u540e,\u6309\u952e\u76d8 Ctrl+C \u65e0\u6cd5\u7ec8\u6b62\u7684\u811a\u672c \n\n# \u4f7f\u7528 trap \u547d\u4ee4\u53ef\u4ee5\u62e6\u622a\u7528\u6237\u901a\u8fc7\u952e\u76d8\u6216 kill \u547d\u4ee4\u53d1\u9001\u8fc7\u6765\u7684\u4fe1\u53f7\n# \u4f7f\u7528 kill \u2010l \u53ef\u4ee5\u67e5\u770b Linux \u7cfb\u7edf\u4e2d\u6240\u6709\u7684\u4fe1\u53f7\u5217\u8868,\u5176\u4e2d 2 \u4ee3\u8868 Ctrl+C\n# trap \u5f53\u53d1\u73b0\u6709\u7528\u6237 ctrl+C \u5e0c\u671b\u7ec8\u7aef\u811a\u672c\u65f6,\u5c31\u6267\u884c echo \"\u6682\u505c 10s\";sleep 10 \u8fd9\u4e24\u6761\u547d\u4ee4\n# \u53e6\u5916\u7528\u6237\u4f7f\u7528\u547d\u4ee4:[ kill \u20102 \u811a\u672c\u7684 PID ] \u4e5f\u53ef\u4ee5\u4e2d\u65ad\u811a\u672c\u548c Ctrl+C \u4e00\u6837\u7684\u6548\u679c,\u90fd\u4f1a\u88ab trap \u62e6\u622a\ntrap 'echo \"\u6682\u505c 10s\";sleep 10' 2\nwhile :\ndo\n  echo \"go go go\"\ndone\n</code></pre>"},{"location":"chap8/4Basic_shell/#45-vnc","title":"45 \u4e00\u952e\u914d\u7f6e VNC \u8fdc\u7a0b\u684c\u9762\u670d\u52a1\u5668(\u65e0\u5bc6\u7801\u7248\u672c)","text":"<pre><code>#!/bin/bash\n\n# \u4e00\u952e\u914d\u7f6e VNC \u8fdc\u7a0b\u684c\u9762\u670d\u52a1\u5668(\u65e0\u5bc6\u7801\u7248\u672c)\n\n# \u811a\u672c\u914d\u7f6e\u7684 VNC \u670d\u52a1\u5668,\u5ba2\u6237\u7aef\u65e0\u9700\u5bc6\u7801\u5373\u53ef\u8fde\u63a5\n# \u5ba2\u6237\u7aef\u4ec5\u6709\u67e5\u770b\u8fdc\u7a0b\u684c\u9762\u7684\u6743\u9650,\u6ca1\u6709\u9f20\u6807\u548c\u952e\u76d8\u7684\u64cd\u4f5c\u6743\u9650\n\nrpm --quiet -q tigervnc\u2010server\nif [  $? -ne  0 ];then\n  yum  -y  tigervnc\u2010server\nfi\nx0vncserver AcceptKeyEvents=0 AlwaysShared=1 \\\nAcceptPointerEvents=0 SecurityTypes=None  rfbport=5908\n</code></pre>"},{"location":"chap8/4Basic_shell/#46-selinux","title":"46 \u5173\u95ed SELinux","text":"<pre><code>#!/bin/bash\n\n# \u5173\u95ed SELinux \n\nsed -i  '/^SELINUX/s/=.*/=disabled/' /etc/selinux/config\nsetenforce 0\n</code></pre>"},{"location":"chap8/4Basic_shell/#47-cpu","title":"47 \u67e5\u770b\u6240\u6709\u865a\u62df\u673a\u78c1\u76d8\u4f7f\u7528\u91cf\u4ee5\u53caCPU\u4f7f\u7528\u91cf\u4fe1\u606f","text":"<pre><code>#!/bin/bash\n\n# \u67e5\u770b\u6240\u6709\u865a\u62df\u673a\u78c1\u76d8\u4f7f\u7528\u91cf\u4ee5\u53caCPU\u4f7f\u7528\u91cf\u4fe1\u606f \n\nvirt\u2010df\nread -n1 \"\u6309\u4efb\u610f\u952e\u7ee7\u7eed\" key\nvirt\u2010top\n</code></pre>"},{"location":"chap8/4Basic_shell/#48-shell","title":"48 \u4f7f\u7528 shell \u811a\u672c\u6253\u5370\u56fe\u5f62","text":"<pre><code>\n#!/bin/bash\n\n# \u4f7f\u7528 shell \u811a\u672c\u6253\u5370\u5982\u4e0b\u56fe\u5f62: \n\n# \u6253\u5370\u7b2c\u4e00\u7ec4\u56fe\u7247\n# for(())\u4e3a\u7c7b C \u8bed\u8a00\u7684\u8bed\u6cd5\u683c\u5f0f,\u4e5f\u53ef\u4ee5\u4f7f\u7528 for i  in;do  ;done \u7684\u683c\u5f0f\u66ff\u6362\n# for((i=1;i&lt;=9;i++))\u5faa\u73af\u4f1a\u6267\u884c 9 \u6b21,i \u4ece 1 \u5f00\u59cb\u5230 9,\u6bcf\u5faa\u73af\u4e00\u6b21 i \u81ea\u52a0 1\nclear\nfor (( i=1; i&lt;=9; i++ ))\ndo\n  for (( j=1; j&lt;=i; j++ ))\n  do\n    echo -n \"$i\"\n  done\n  echo \"\"\ndone\nread  -n1  \"\u6309\u4efb\u610f\u952e\u7ee7\u7eed\"  key\n#\u6253\u5370\u7b2c\u4e8c\u7ec4\u56fe\u7247\nclear\nfor (( i=1; i&lt;=5; i++ )) \ndo\n  for (( j=1; j&lt;=i; j++ ))\n  do\n    echo -n \" |\"\n  done\n  echo \"_ \"\ndone\nread  -n1  \"\u6309\u4efb\u610f\u952e\u7ee7\u7eed\"  key\n#\u6253\u5370\u7b2c\u4e09\u7ec4\u56fe\u7247\nclear\nfor (( i=1; i&lt;=5; i++ ))\ndo\n  for (( j=1; j&lt;=i; j++ ))\n  do\n    echo -n \" *\"\n  done\n  echo \"\"\ndone\nfor (( i=5; i&gt;=1; i\u2010\u2010 ))\ndo\n  for (( j=1; j&lt;=i; j++ ))\n  do\n    echo -n \" *\"\n  done\n  echo \"\"\ndone\n</code></pre>"},{"location":"chap8/4Basic_shell/#49","title":"49 \u6839\u636e\u8ba1\u7b97\u673a\u5f53\u524d\u65f6\u95f4,\u8fd4\u56de\u95ee\u5019\u8bed,\u53ef\u4ee5\u5c06\u8be5\u811a\u672c\u8bbe\u7f6e\u4e3a\u5f00\u673a\u542f\u52a8","text":"<pre><code>\n#!/bin/bash\n\n# \u6839\u636e\u8ba1\u7b97\u673a\u5f53\u524d\u65f6\u95f4,\u8fd4\u56de\u95ee\u5019\u8bed,\u53ef\u4ee5\u5c06\u8be5\u811a\u672c\u8bbe\u7f6e\u4e3a\u5f00\u673a\u542f\u52a8 \n\n# 00\u201012 \u70b9\u4e3a\u65e9\u6668,12\u201018 \u70b9\u4e3a\u4e0b\u5348,18\u201024 \u70b9\u4e3a\u665a\u4e0a\n# \u4f7f\u7528 date \u547d\u4ee4\u83b7\u53d6\u65f6\u95f4\u540e,if \u5224\u65ad\u65f6\u95f4\u7684\u533a\u95f4,\u786e\u5b9a\u95ee\u5019\u8bed\u5185\u5bb9\ntm=$(date +%H)\nif [ $tm -le 12 ];then\n  msg=\"Good Morning $USER\"\nelif [ $tm -gt 12 -a $tm -le 18 ];then\n    msg=\"Good Afternoon $USER\"\nelse\n    msg=\"Good Night $USER\"\nfi\necho \"\u5f53\u524d\u65f6\u95f4\u662f:$(date +\"%Y\u2010%m\u2010%d %H:%M:%S\")\"\necho -e \"\\033[34m$msg\\033[0m\"\n</code></pre>"},{"location":"chap8/4Basic_shell/#50","title":"50 \u8bfb\u53d6\u7528\u6237\u8f93\u5165\u7684\u8d26\u6237\u540d\u79f0,\u5c06\u8d26\u6237\u540d\u5199\u5165\u5230\u6570\u7ec4\u4fdd\u5b58","text":"<pre><code>\n#!/bin/bash\n\n# \u8bfb\u53d6\u7528\u6237\u8f93\u5165\u7684\u8d26\u6237\u540d\u79f0,\u5c06\u8d26\u6237\u540d\u5199\u5165\u5230\u6570\u7ec4\u4fdd\u5b58 \n\n# \u5b9a\u4e49\u6570\u7ec4\u540d\u79f0\u4e3a name,\u6570\u7ec4\u7684\u4e0b\u6807\u4e3a i,\u5c0f\u6807\u4ece 0 \u5f00\u59cb,\u6bcf\u8f93\u5165\u4e00\u4e2a\u8d26\u6237\u540d,\u4e0b\u6807\u52a0 1,\u7ee7\u7eed\u5b58\u4e0b\u4e00\u4e2a\u8d26\u6237\n# \u6700\u540e,\u8f93\u5165 over,\u811a\u672c\u8f93\u51fa\u603b\u7ed3\u6027\u4fe1\u606f\u540e\u811a\u672c\u9000\u51fa\ni=0\nwhile :\ndo\n  read -p \"\u8bf7\u8f93\u5165\u8d26\u6237\u540d,\u8f93\u5165 over \u7ed3\u675f:\" key\n  if [ $key == \"over\" ];then \n    break\n    else\n    name[$i]=$key\n    let i++\n    fi\ndone\necho \"\u603b\u8d26\u6237\u540d\u6570\u91cf:${#name[*]}\"\necho \"${name[@]}\"\n</code></pre>"},{"location":"chap8/4Basic_shell/#51","title":"51 \u5224\u65ad\u6587\u4ef6\u6216\u76ee\u5f55\u662f\u5426\u5b58\u5728","text":"<pre><code>#!/bin/bash\n\n# \u5224\u65ad\u6587\u4ef6\u6216\u76ee\u5f55\u662f\u5426\u5b58\u5728 \n\nif [ $# -eq 0 ] ;then\necho \"\u672a\u8f93\u5165\u4efb\u4f55\u53c2\u6570,\u8bf7\u8f93\u5165\u53c2\u6570\"\necho \"\u7528\u6cd5:$0 [\u6587\u4ef6\u540d|\u76ee\u5f55\u540d]\"\nfi\nif [ -f $1 ];then\n  echo \"\u8be5\u6587\u4ef6,\u5b58\u5728\"\n  ls -l $1\nelse\n  echo \"\u6ca1\u6709\u8be5\u6587\u4ef6\"\nfi\nif [ -d  $1 ];then\n     echo \"\u8be5\u76ee\u5f55,\u5b58\u5728\"\n     ls -ld  $2\nelse\n     echo \"\u6ca1\u6709\u8be5\u76ee\u5f55\"\nfi\n</code></pre>"},{"location":"chap8/4Basic_shell/#52","title":"52 \u6253\u5370\u5404\u79cd\u683c\u5f0f\u7684\u65f6\u95f4","text":"<pre><code>!/bin/bash\n\n# \u6253\u5370\u5404\u79cd\u65f6\u95f4\u683c\u5f0f \n\necho \"\u663e\u793a\u661f\u671f\u7b80\u79f0(\u5982:Sun)\"\ndate +%a\necho \"\u663e\u793a\u661f\u671f\u5168\u79f0(\u5982:Sunday)\"\ndate +%A\necho \"\u663e\u793a\u6708\u4efd\u7b80\u79f0(\u5982:Jan)\"\ndate +%b\necho \"\u663e\u793a\u6708\u4efd\u5168\u79f0(\u5982:January)\"\ndate +%B\necho \"\u663e\u793a\u6570\u5b57\u6708\u4efd(\u5982:12)\"\ndate +%m\necho \"\u663e\u793a\u6570\u5b57\u65e5\u671f(\u5982:01 \u53f7)\"\ndate +%d\necho \"\u663e\u793a\u6570\u5b57\u5e74(\u5982:01 \u53f7)\"\ndate +%Y echo \"\u663e\u793a\u5e74\u2010\u6708\u2010\u65e5\"\ndate +%F\necho \"\u663e\u793a\u5c0f\u65f6(24 \u5c0f\u65f6\u5236)\"\ndate +%H\necho \"\u663e\u793a\u5206\u949f(00..59)\"\ndate +%M\necho \"\u663e\u793a\u79d2\"\ndate +%S\necho \"\u663e\u793a\u7eb3\u79d2\"\ndate +%N\necho \"\u7ec4\u5408\u663e\u793a\"\ndate +\"%Y%m%d %H:%M:%S\"\n</code></pre>"},{"location":"chap8/4Basic_shell/#53-egrep-mac","title":"53 \u4f7f\u7528 egrep \u8fc7\u6ee4 MAC \u5730\u5740","text":"<pre><code>\n#!/bin/bash\n\n# \u4f7f\u7528 egrep \u8fc7\u6ee4 MAC \u5730\u5740 \n\n# MAC \u5730\u5740\u7531 16 \u8fdb\u5236\u7ec4\u6210,\u5982 AA:BB:CC:DD:EE:FF\n# [0\u20109a\u2010fA\u2010F]{2}\u8868\u793a\u4e00\u6bb5\u5341\u516d\u8fdb\u5236\u6570\u503c,{5}\u8868\u793a\u8fde\u7eed\u51fa\u73b05\u7ec4\u524d\u7f6e:\u7684\u5341\u516d\u8fdb\u5236\negrep \"[0\u20109a\u2010fA\u2010F]{2}(:[0\u20109a\u2010fA\u2010F]{2}){5}\" $1\n</code></pre>"},{"location":"chap8/4Basic_shell/#54","title":"54 \u7edf\u8ba1\u53cc\u8272\u7403\u5404\u4e2a\u6570\u5b57\u7684\u4e2d\u5956\u6982\u7387","text":"<pre><code>#!/bin/bash\n\n# \u7edf\u8ba1\u53cc\u8272\u7403\u5404\u4e2a\u6570\u5b57\u7684\u4e2d\u5956\u6982\u7387 \n\n# \u5f80\u671f\u53cc\u8272\u7403\u4e2d\u5956\u53f7\u7801\u5982\u4e0b:\n# 01 04 11 28 31 32  16\n# 04 07 08 18 23 24  02\n# 02 05 06 16 28 29  04\n# 04 19 22 27 30 33  01\n# 05 10 18 19 30 31  03\n# 02 06 11 12 19 29  06\n# \u7edf\u8ba1\u7bee\u7403\u548c\u7ea2\u7403\u6570\u636e\u51fa\u73b0\u7684\u6982\u7387\u6b21\u6570(\u7bee\u7403\u4e0d\u5206\u987a\u5e8f,\u7edf\u8ba1\u6240\u6709\u7bee\u7403\u6df7\u5408\u5728\u4e00\u8d77\u7684\u6982\u7387)\nawk '{print $1\"\\n\"$2\"\\n\"$3\"\\n\"$4\"\\n\"$5\"\\n\"$6}' 1.txt | sort | uniq -c | sort\nawk '{print $7}' 1.txt | sort | uniq -c | sort\n</code></pre>"},{"location":"chap8/4Basic_shell/#55-awkwc","title":"55 \u4f7f\u7528awk\u7f16\u5199\u7684wc\u7a0b\u5e8f","text":"<pre><code>#!/bin/bash\n\n# \u4f7f\u7528awk\u7f16\u5199\u7684wc\u7a0b\u5e8f \n\n# \u81ea\u5b9a\u4e49\u53d8\u91cf chars \u53d8\u91cf\u5b58\u50a8\u5b57\u7b26\u4e2a\u6570,\u81ea\u5b9a\u4e49\u53d8\u91cf words \u53d8\u91cf\u5b58\u50a8\u5355\u8bcd\u4e2a\u6570\n# awk \u5185\u7f6e\u53d8\u91cf NR \u5b58\u50a8\u884c\u6570\n# length()\u4e3a awk \u5185\u7f6e\u51fd\u6570,\u7528\u6765\u7edf\u8ba1\u6bcf\u884c\u7684\u5b57\u7b26\u6570\u91cf,\u56e0\u4e3a\u6bcf\u884c\u90fd\u4f1a\u6709\u4e00\u4e2a\u9690\u85cf\u7684$,\u6240\u4ee5\u6bcf\u6b21\u7edf\u8ba1\u540e\u90fd+1\n# wc \u7a0b\u5e8f\u4f1a\u628a\u6587\u4ef6\u7ed3\u5c3e\u7b26$\u4e5f\u7edf\u8ba1\u5728\u5185,\u53ef\u4ee5\u4f7f\u7528 cat \u2010A \u6587\u4ef6\u540d,\u67e5\u770b\u8be5\u9690\u85cf\u5b57\u7b26\nawk '{chars+=length($0)+1;words+=NF} END{print NR,words,chars}' $1\n</code></pre>"},{"location":"chap8/5install_shell/","title":"5 Shell Package \u5b89\u88c5+\u914d\u7f6e\u811a\u672c","text":""},{"location":"chap8/5install_shell/#1-lnmprpm","title":"1\u3001\u4e00\u952e\u90e8\u7f72 LNMP(RPM \u5305\u7248\u672c)","text":"<pre><code>#!/bin/bash\n# \u4e00\u952e\u90e8\u7f72 LNMP(RPM \u5305\u7248\u672c)\n# \u4f7f\u7528 yum \u5b89\u88c5\u90e8\u7f72 LNMP,\u9700\u8981\u63d0\u524d\u914d\u7f6e\u597d yum \u6e90,\u5426\u5219\u8be5\u811a\u672c\u4f1a\u5931\u8d25\n# \u672c\u811a\u672c\u4f7f\u7528\u4e8e centos7.2 \u6216 RHEL7.2\nyum \u2010y install httpd\nyum \u2010y install mariadb mariadb\u2010devel mariadb\u2010server\nyum \u2010y install php  php\u2010mysql\n\nsystemctl start httpd mariadb\nsystemctl enable httpd mariadb\n</code></pre>"},{"location":"chap8/5install_shell/#2-yum-vsftpd","title":"2 \u68c0\u6d4b\u672c\u673a\u5f53\u524d\u7528\u6237\u662f\u5426\u4e3a\u8d85\u7ea7\u7ba1\u7406\u5458,\u5982\u679c\u662f\u7ba1\u7406\u5458,\u5219\u4f7f\u7528 yum \u5b89\u88c5 vsftpd,\u5982\u679c\u4e0d\u662f,\u5219\u63d0\u793a\u60a8\u975e\u7ba1\u7406\u5458(\u4f7f\u7528\u5b57\u4e32\u5bf9\u6bd4\u7248\u672c)","text":"<p><code>$USER == \"root\"</code></p> <pre><code>\n#!/bin/bash\n\n# \u68c0\u6d4b\u672c\u673a\u5f53\u524d\u7528\u6237\u662f\u5426\u4e3a\u8d85\u7ea7\u7ba1\u7406\u5458,\u5982\u679c\u662f\u7ba1\u7406\u5458,\u5219\u4f7f\u7528 yum \u5b89\u88c5 vsftpd,\u5982\u679c\u4e0d\n# \u662f,\u5219\u63d0\u793a\u60a8\u975e\u7ba1\u7406\u5458(\u4f7f\u7528\u5b57\u4e32\u5bf9\u6bd4\u7248\u672c) \nif [ $USER == \"root\" ]\nthen\n  yum \u2010y install vsftpd\nelse\n    echo \"\u60a8\u4e0d\u662f\u7ba1\u7406\u5458,\u6ca1\u6709\u6743\u9650\u5b89\u88c5\u8f6f\u4ef6\"\nfi\n</code></pre>"},{"location":"chap8/5install_shell/#3-yum-vsftpd-uid","title":"3\u3001\u68c0\u6d4b\u672c\u673a\u5f53\u524d\u7528\u6237\u662f\u5426\u4e3a\u8d85\u7ea7\u7ba1\u7406\u5458,\u5982\u679c\u662f\u7ba1\u7406\u5458,\u5219\u4f7f\u7528 yum \u5b89\u88c5 vsftpd,\u5982\u679c\u4e0d\u662f,\u5219\u63d0\u793a\u60a8\u975e\u7ba1\u7406\u5458(\u4f7f\u7528 UID \u6570\u5b57\u5bf9\u6bd4\u7248\u672c)","text":"<p><code>$UID -eq 0</code></p> <pre><code>#!/bin/bash\n\n# \u68c0\u6d4b\u672c\u673a\u5f53\u524d\u7528\u6237\u662f\u5426\u4e3a\u8d85\u7ea7\u7ba1\u7406\u5458,\u5982\u679c\u662f\u7ba1\u7406\u5458,\u5219\u4f7f\u7528 yum \u5b89\u88c5 vsftpd,\u5982\u679c\u4e0d\n# \u662f,\u5219\u63d0\u793a\u60a8\u975e\u7ba1\u7406\u5458(\u4f7f\u7528 UID \u6570\u5b57\u5bf9\u6bd4\u7248\u672c)\nif [ $UID -eq 0 ];then\n    yum \u2010y install vsftpd\nelse\n    echo \"\u60a8\u4e0d\u662f\u7ba1\u7406\u5458,\u6ca1\u6709\u6743\u9650\u5b89\u88c5\u8f6f\u4ef6\"\nfi\n</code></pre>"},{"location":"chap8/5install_shell/#4-expect-httpd","title":"4 \u4f7f\u7528 expect \u5de5\u5177\u81ea\u52a8\u4ea4\u4e92\u5bc6\u7801\u8fdc\u7a0b\u5176\u4ed6\u4e3b\u673a\u5b89\u88c5 httpd \u8f6f\u4ef6","text":"<pre><code>#!/bin/bash\n\n# \u4f7f\u7528 expect \u5de5\u5177\u81ea\u52a8\u4ea4\u4e92\u5bc6\u7801\u8fdc\u7a0b\u5176\u4ed6\u4e3b\u673a\u5b89\u88c5 httpd \u8f6f\u4ef6 \n\n# \u5220\u9664~/.ssh/known_hosts \u540e,ssh \u8fdc\u7a0b\u4efb\u4f55\u4e3b\u673a\u90fd\u4f1a\u8be2\u95ee\u662f\u5426\u786e\u8ba4\u8981\u8fde\u63a5\u8be5\u4e3b\u673a\nrm  \u2010rf  ~/.ssh/known_hosts\nexpect &lt;&lt;EOF\nspawn ssh 192.168.4.254\nexpect \"yes/no\" {send \"yes\\r\"}\n# \u6839\u636e\u81ea\u5df1\u7684\u5b9e\u9645\u60c5\u51b5\u5c06\u5bc6\u7801\u4fee\u6539\u4e3a\u771f\u5b9e\u7684\u5bc6\u7801\u5b57\u4e32\nexpect \"password\" {send  \"\u5bc6\u7801\\r\"}\nexpect \"#\" {send  \"yum \u2010y install httpd\\r\"}\nexpect \"#\" {send  \"exit\\r\"}\nEOF\n</code></pre>"},{"location":"chap8/5install_shell/#5-lnmp","title":"5\u3001\u4e00\u952e\u90e8\u7f72 LNMP(\u6e90\u7801\u5b89\u88c5\u7248\u672c)","text":"<pre><code>\n#!/bin/bash\n\n# \u4e00\u952e\u90e8\u7f72 LNMP(\u6e90\u7801\u5b89\u88c5\u7248\u672c)\nmenu()\n{\nclear\necho \"  ##############\u2010\u2010\u2010\u2010Menu\u2010\u2010\u2010\u2010##############\"\necho \"# 1. Install Nginx\"\necho \"# 2. Install MySQL\"\necho \"# 3. Install PHP\"\necho \"# 4. Exit Program\"\necho \"  ########################################\"\n}\n\nchoice()\n{\n  read -p \"Please choice a menu[1\u20109]:\" select\n}\n\ninstall_nginx()\n{\n  id nginx &amp;&gt;/dev/null\n  if [ $? -ne 0 ];then\n    useradd -s /sbin/nologin nginx\n  fi\n  if [ -f nginx\u20101.8.0.tar.gz ];then\n    tar -xf nginx\u20101.8.0.tar.gz\n    cd nginx\u20101.8.0\n    yum -y install  gcc pcre\u2010devel openssl\u2010devel zlib\u2010devel make\n    ./configure \u2010\u2010prefix=/usr/local/nginx \u2010\u2010with\u2010http_ssl_module\n    make\n    make install\n    ln -s /usr/local/nginx/sbin/nginx /usr/sbin/\n    cd ..\n  else\n    echo \"\u6ca1\u6709 Nginx \u6e90\u7801\u5305\"\n  fi\n}\n\ninstall_mysql()\n{\n  yum -y install gcc gcc\u2010c++ cmake ncurses\u2010devel perl\n  id mysql &amp;&gt;/dev/null\n  if [ $? -ne 0 ];then\n    useradd -s /sbin/nologin mysql\n  fi\n  if [ -f mysql\u20105.6.25.tar.gz ];then\n    tar -xf mysql\u20105.6.25.tar.gz\n    cd mysql\u20105.6.25\n    cmake .\n    make\n    make install\n    /usr/local/mysql/scripts/mysql_install_db \u2010\u2010user=mysql \u2010\u2010datadir=/usr/local/mysql/data/\n\u2010\u2010basedir=/usr/local/mysql/\n    chown -R root.mysql /usr/local/mysql\n    chown -R mysql /usr/local/mysql/data\n    /bin/cp -f /usr/local/mysql/support\u2010files/mysql.server /etc/init.d/mysqld\n    chmod +x /etc/init.d/mysqld\n    /bin/cp -f /usr/local/mysql/support\u2010files/my\u2010default.cnf /etc/my.cnf\n    echo \"/usr/local/mysql/lib/\" &gt;&gt; /etc/ld.so.conf\n    ldconfig\n    echo 'PATH=\\$PATH:/usr/local/mysql/bin/' &gt;&gt; /etc/profile\n    export PATH\n  else\n    echo  \"\u6ca1\u6709 mysql \u6e90\u7801\u5305\"\n    exit\n  fi\n}\n\ninstall_php()\n{\n#\u5b89\u88c5 php \u65f6\u6ca1\u6709\u6307\u5b9a\u542f\u52a8\u54ea\u4e9b\u6a21\u5757\u529f\u80fd,\u5982\u679c\u7684\u7528\u6237\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u81ea\u884c\u6dfb\u52a0\u989d\u5916\u529f\u80fd\u5982\u2010\u2010with\u2010gd \u7b49\nyum  -y  install  gcc  libxml2\u2010devel\nif [ -f mhash\u20100.9.9.9.tar.gz ];then\n  tar -xf mhash\u20100.9.9.9.tar.gz\n  cd mhash\u20100.9.9.9\n  ./configure\n  make\n  make install\n  cd ..\nif [ ! \u2010f /usr/lib/libmhash.so ];then\n  ln -s /usr/local/lib/libmhash.so /usr/lib/\nfi\nldconfig\nelse\n  echo \"\u6ca1\u6709 mhash \u6e90\u7801\u5305\u6587\u4ef6\"\n  exit\nfi\nif [ -f libmcrypt\u20102.5.8.tar.gz ];then\n  tar -xf libmcrypt\u20102.5.8.tar.gz\n  cd libmcrypt\u20102.5.8\n  ./configure\n  make\n  make install\n  cd ..\n  if [ ! -f /usr/lib/libmcrypt.so ];then  \n    ln -s /usr/local/lib/libmcrypt.so /usr/lib/\n  fi\n  ldconfig\nelse\n  echo \"\u6ca1\u6709 libmcrypt \u6e90\u7801\u5305\u6587\u4ef6\"\n  exit\nfi\nif [ -f php\u20105.4.24.tar.gz ];then\n  tar -xf php\u20105.4.24.tar.gz\n  cd php\u20105.4.24\n  ./configure  \u2010\u2010prefix=/usr/local/php5  \u2010\u2010with\u2010mysql=/usr/local/mysql  \u2010\u2010enable\u2010fpm    \u2010\u2010\n  enable\u2010mbstring  \u2010\u2010with\u2010mcrypt  \u2010\u2010with\u2010mhash  \u2010\u2010with\u2010config\u2010file\u2010path=/usr/local/php5/etc  \u2010\u2010with\u2010\n  mysqli=/usr/local/mysql/bin/mysql_config\n  make &amp;&amp; make install\n  /bin/cp -f php.ini\u2010production /usr/local/php5/etc/php.ini\n  /bin/cp -f /usr/local/php5/etc/php\u2010fpm.conf.default /usr/local/php5/etc/php\u2010fpm.conf\n  cd ..\nelse\n  echo \"\u6ca1\u6709 php \u6e90\u7801\u5305\u6587\u4ef6\"\n  exit\nfi \n}\n\nwhile :\ndo\n  menu\n  choice\n  case $select in\n  1)\n    install_nginx\n    ;;\n  2)\n    install_mysql\n    ;;\n  3)\n    install_php\n    ;;\n  4)\n    exit\n    ;;\n  *)\n    echo Sorry!\n  esac\ndone\n</code></pre>"},{"location":"chap8/5install_shell/#5-kvm","title":"5\u3001\u7f16\u5199\u811a\u672c\u5feb\u901f\u514b\u9686 KVM \u865a\u62df\u673a","text":"<pre><code>!/bin/bash\n\n# \u7f16\u5199\u811a\u672c\u5feb\u901f\u514b\u9686 KVM \u865a\u62df\u673a\n\n# \u672c\u811a\u672c\u9488\u5bf9 RHEL7.2 \u6216 Centos7.2\n# \u672c\u811a\u672c\u9700\u8981\u63d0\u524d\u51c6\u5907\u4e00\u4e2a qcow2 \u683c\u5f0f\u7684\u865a\u62df\u673a\u6a21\u677f,\n# \u540d\u79f0\u4e3a/var/lib/libvirt/images  /.rh7_template \u7684\u865a\u62df\u673a\u6a21\u677f\n# \u8be5\u811a\u672c\u4f7f\u7528 qemu\u2010img \u547d\u4ee4\u5feb\u901f\u521b\u5efa\u5feb\u7167\u865a\u62df\u673a\n# \u811a\u672c\u4f7f\u7528 sed \u4fee\u6539\u6a21\u677f\u865a\u62df\u673a\u7684\u914d\u7f6e\u6587\u4ef6,\u5c06\u865a\u62df\u673a\u540d\u79f0\u3001UUID\u3001\u78c1\u76d8\u6587\u4ef6\u540d\u3001MAC \u5730\u5740\n# exit code:  \n#    65 \u2010&gt; user input nothing\n#    66 \u2010&gt; user input is not a number\n#    67 \u2010&gt; user input out of range\n#    68 \u2010&gt; vm disk image exists\n\nIMG_DIR=/var/lib/libvirt/images\nBASEVM=rh7_template\nread -p \"Enter VM number: \" VMNUM\nif [ $VMNUM -le 9 ];then\nVMNUM=0$VMNUM\nfi\n\nif [ -z \"${VMNUM}\" ]; then\n    echo \"You must input a number.\"\n    exit 65\nelif [[  ${VMNUM} =~ [a\u2010z]  ]; then\n    echo \"You must input a number.\"\n    exit 66\nelif [ ${VMNUM} -lt 1 -o ${VMNUM} -gt 99 ]; then\n    echo \"Input out of range\"\n    exit 67\nfi\n\nNEWVM=rh7_node${VMNUM}\n\nif [ -e $IMG_DIR/${NEWVM}.img ]; then\n    echo \"File exists.\"\n    exit 68\nfi\n\necho -en \"Creating Virtual Machine disk image......\\t\"\nqemu\u2010img create -f qcow2 \u2010b $IMG_DIR/.${BASEVM}.img $IMG_DIR/${NEWVM}.img &amp;&gt; /dev/null\n\necho -e \"\\e[32;1m[OK]\\e[0m\"\n\n#virsh dumpxml ${BASEVM} &gt; /tmp/myvm.xml\ncat /var/lib/libvirt/images/.rhel7.xml &gt; /tmp/myvm.xml\nsed -i \"/&lt;name&gt;${BASEVM}/s/${BASEVM}/${NEWVM}/\" /tmp/myvm.xml\nsed -i \"/uuid/s/&lt;uuid&gt;.*&lt;\\/uuid&gt;/&lt;uuid&gt;$(uuidgen)&lt;\\/uuid&gt;/\" /tmp/myvm.xml\nsed -i \"/${BASEVM}\\.img/s/${BASEVM}/${NEWVM}/\" /tmp/myvm.xml\n\n# \u4fee\u6539 MAC \u5730\u5740,\u672c\u4f8b\u4f7f\u7528\u7684\u662f\u5e38\u91cf,\u6bcf\u4f4d\u4f7f\u7528\u8be5\u811a\u672c\u7684\u7528\u6237\u9700\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\u8fd9\u4e9b\u503c \n# \u6700\u597d\u8fd9\u91cc\u53ef\u4ee5\u4f7f\u7528\u4fbf\u5229,\u8fd9\u6837\u66f4\u9002\u5408\u4e8e\u6279\u91cf\u64cd\u4f5c,\u53ef\u4ee5\u514b\u9686\u66f4\u591a\u865a\u62df\u673a \nsed -i \"/mac /s/a1/0c/\" /tmp/myvm.xml\n\necho -en \"Defining new virtual machine......\\t\\t\"\nvirsh define /tmp/myvm.xml &amp;&gt; /dev/null\necho -e \"\\e[32;1m[OK]\\e[0m\"\n</code></pre>"},{"location":"chap8/5install_shell/#6-varnish","title":"6 \u81ea\u52a8\u5316\u90e8\u7f72 varnish \u6e90\u7801\u5305\u8f6f\u4ef6","text":"<pre><code>#!/bin/bash\n\n# \u81ea\u52a8\u5316\u90e8\u7f72 varnish \u6e90\u7801\u5305\u8f6f\u4ef6 \n# \u672c\u811a\u672c\u9700\u8981\u63d0\u524d\u4e0b\u8f7d varnish\u20103.0.6.tar.gz \u8fd9\u6837\u4e00\u4e2a\u6e90\u7801\u5305\u8f6f\u4ef6,\u8be5\u811a\u672c\u5373\u53ef\u7528\u81ea\u52a8\u6e90\u7801\u5b89\u88c5\u90e8\u7f72\u8f6f\u4ef6\n\nyum -y install gcc readline\u2010devel pcre\u2010devel\nuseradd -s /sbin/nologin varnish\ntar -xf varnish\u20103.0.6.tar.gz\ncd varnish\u20103.0.6\n\n# \u4f7f\u7528 configure,make,make install \u6e90\u7801\u5b89\u88c5\u8f6f\u4ef6\u5305\n./configure \u2010\u2010prefix=/usr/local/varnish\nmake &amp;&amp; make install\n\n# \u5728\u6e90\u7801\u5305\u76ee\u5f55\u4e0b,\u5c06\u76f8\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\u62f7\u8d1d\u5230 Linux \u7cfb\u7edf\u6587\u4ef6\u7cfb\u7edf\u4e2d\n# \u9ed8\u8ba4\u5b89\u88c5\u5b8c\u6210\u540e,\u4e0d\u4f1a\u81ea\u52a8\u62f7\u8d1d\u6216\u5b89\u88c5\u914d\u7f6e\u6587\u4ef6\u5230 Linux \u7cfb\u7edf,\u6240\u4ee5\u9700\u8981\u624b\u52a8 cp \u590d\u5236\u914d\u7f6e\u6587\u4ef6\n# \u5e76\u4f7f\u7528 uuidgen \u751f\u6210\u4e00\u4e2a\u968f\u673a\u5bc6\u94a5\u7684\u914d\u7f6e\u6587\u4ef6\n\ncp redhat/varnish.initrc /etc/init.d/varnish\ncp redhat/varnish.sysconfig /etc/sysconfig/varnish\ncp redhat/varnish_reload_vcl /usr/bin/\nln -s /usr/local/varnish/sbin/varnishd /usr/sbin/\nln -s /usr/local/varnish/bin/* /usr/bin\nmkdir /etc/varnish\ncp /usr/local/varnish/etc/varnish/default.vcl /etc/varnish/\nuuidgen &gt; /etc/varnish/secret\n</code></pre>"},{"location":"chap8/5install_shell/#7-nginx","title":"7 \u7f16\u5199 nginx \u542f\u52a8\u811a\u672c","text":"<pre><code>#!/bin/bash\n\n# \u7f16\u5199 nginx \u542f\u52a8\u811a\u672c \n# \u672c\u811a\u672c\u7f16\u5199\u5b8c\u6210\u540e,\u653e\u7f6e\u5728/etc/init.d/\u76ee\u5f55\u4e0b,\u5c31\u53ef\u4ee5\u88ab Linux \u7cfb\u7edf\u81ea\u52a8\u8bc6\u522b\u5230\u8be5\u811a\u672c\n# \u5982\u679c\u672c\u811a\u672c\u540d\u4e3a/etc/init.d/nginx,\u5219 service nginx start \u5c31\u53ef\u4ee5\u542f\u52a8\u8be5\u670d\u52a1\n# service nginx stop \u5c31\u53ef\u4ee5\u5173\u95ed\u670d\u52a1\n# service nginx restart \u53ef\u4ee5\u91cd\u542f\u670d\u52a1\n# service nginx status \u53ef\u4ee5\u67e5\u770b\u670d\u52a1\u72b6\u6001\n\nprogram=/usr/local/nginx/sbin/nginx\npid=/usr/local/nginx/logs/nginx.pid\nstart(){\nif [ -f $pid ];then\n  echo  \"nginx \u670d\u52a1\u5df2\u7ecf\u5904\u4e8e\u5f00\u542f\u72b6\u6001\"\nelse\n  $program\nfi\nstop(){\nif [ -! -f $pid ];then\n  echo \"nginx \u670d\u52a1\u5df2\u7ecf\u5173\u95ed\"\nelse\n  $program -s stop\n  echo \"\u5173\u95ed\u670d\u52a1 ok\"\nfi\n}\nstatus(){\nif [ -f $pid ];then\n  echo \"\u670d\u52a1\u6b63\u5728\u8fd0\u884c...\"\nelse\n  echo \"\u670d\u52a1\u5df2\u7ecf\u5173\u95ed\"\nfi\n}\n\ncase $1 in\nstart)\n  start;;\nstop)\n  stop;;\nrestart)\n  stop\n  sleep 1\n  start;;\nstatus)\n  status;;\n*)\n  echo  \"\u4f60\u8f93\u5165\u7684\u8bed\u6cd5\u683c\u5f0f\u9519\u8bef\"\nesac\n</code></pre>"},{"location":"chap8/5install_shell/#9-nginx","title":"9 \u5207\u5272 Nginx \u65e5\u5fd7\u6587\u4ef6(\u9632\u6b62\u5355\u4e2a\u6587\u4ef6\u8fc7\u5927,\u540e\u671f\u5904\u7406\u5f88\u56f0\u96be)","text":"<pre><code>#mkdir  /data/scripts\n#vim   /data/scripts/nginx_log.sh  \n#!/bin/bash\n\n# \u5207\u5272 Nginx \u65e5\u5fd7\u6587\u4ef6(\u9632\u6b62\u5355\u4e2a\u6587\u4ef6\u8fc7\u5927,\u540e\u671f\u5904\u7406\u5f88\u56f0\u96be) \nlogs_path=\"/usr/local/nginx/logs/\"\nmv ${logs_path}access.log ${logs_path}access_$(date -d \"yesterday\" +\"%Y%m%d\").log\nkill -USR1  `cat /usr/local/nginx/logs/nginx.pid`\n\n# chmod +x  /data/scripts/nginx_log.sh\n# crontab  \u2010e                    #\u811a\u672c\u5199\u5b8c\u540e,\u5c06\u811a\u672c\u653e\u5165\u8ba1\u5212\u4efb\u52a1\u6bcf\u5929\u6267\u884c\u4e00\u6b21\u811a\u672c\n0  1  *  *   *   /data/scripts/nginx_log.sh\n</code></pre>"},{"location":"chap8/5install_shell/#10","title":"10 \u68c0\u67e5\u7279\u5b9a\u7684\u8f6f\u4ef6\u5305\u662f\u5426\u5df2\u7ecf\u5b89\u88c5","text":"<pre><code>\n#!/bin/bash\n\n# \u68c0\u67e5\u7279\u5b9a\u7684\u8f6f\u4ef6\u5305\u662f\u5426\u5df2\u7ecf\u5b89\u88c5 \nif [ $# -eq 0 ];then\n  echo \"\u4f60\u9700\u8981\u5236\u5b9a\u4e00\u4e2a\u8f6f\u4ef6\u5305\u540d\u79f0\u4f5c\u4e3a\u811a\u672c\u53c2\u6570\"\n  echo \"\u7528\u6cd5:$0 \u8f6f\u4ef6\u5305\u540d\u79f0 ...\"\nfi\n# $@\u63d0\u53d6\u6240\u6709\u7684\u4f4d\u7f6e\u53d8\u91cf\u7684\u503c,\u76f8\u5f53\u4e8e$*\nfor package in \"$@\"\ndo\n    if rpm -q ${package} &amp;&gt;/dev/null ;then\n    echo -e \"${package}\\033[32m \u5df2\u7ecf\u5b89\u88c5\\033[0m\"\n    else\n    echo -e \"${package}\\033[34;1m \u672a\u5b89\u88c5\\033[0m\"\n    fi\ndone\n</code></pre>"},{"location":"chap8/5install_shell/#11-lamp-yum","title":"11 \u5b89\u88c5 LAMP \u73af\u5883(yum \u7248\u672c)","text":"<pre><code>#!/bin/bash\n\n# \u5b89\u88c5 LAMP \u73af\u5883(yum \u7248\u672c) \n\n# \u672c\u811a\u672c\u9002\u7528\u4e8e RHEL7(RHEL6 \u4e2d\u6570\u636e\u5e93\u4e3a mysql)\nyum makecache &amp;&gt;/dev/null\nnum=$(yum repolist | awk '/repolist/{print $2}' | sed 's/,//')\nif [ $num -lt 0 ];then\n  yum -y install httpd\n  yum -y install mariadb mariadb-server mariadb-devel\n  yum -y install php php-mysql\nelse\n  echo \"\u672a\u914d\u7f6e yum \u6e90...\"\nfi\n</code></pre>"},{"location":"chap8/5install_shell/#12-rsynd-rsyncdconf","title":"12 \u81ea\u52a8\u914d\u7f6e rsynd \u670d\u52a1\u5668\u7684\u914d\u7f6e\u6587\u4ef6 rsyncd.conf","text":"<pre><code>\n#!/bin/bash\n\n# \u81ea\u52a8\u914d\u7f6e rsynd \u670d\u52a1\u5668\u7684\u914d\u7f6e\u6587\u4ef6 rsyncd.conf\n\n# See rsyncd.conf man page for more options.\n\n[ ! -d /home/ftp ] &amp;&amp; mkdir /home/ftp\necho 'uid = nobody\ngid = nobody\nuse chroot = yes\nmax connections = 4\npid file = /var/run/rsyncd.pid\nexclude = lost+found/\ntransfer logging = yes\ntimeout = 900\nignore nonreadable = yes\ndont compress   = *.gz *.tgz *.zip *.z *.Z *.rpm *.deb *.bz2\n[ftp]\n    path = /home/ftp\n    comment = share' &gt; /etc/rsyncd.conf\n</code></pre>"},{"location":"chap8/5install_shell/#13-python","title":"13 \u8bbe\u7f6e Python \u652f\u6301\u81ea\u52a8\u547d\u4ee4\u8865\u9f50\u529f\u80fd","text":"<pre><code>\n#!/bin/bash\n\n# \u8bbe\u7f6e Python \u652f\u6301\u81ea\u52a8\u547d\u4ee4\u8865\u9f50\u529f\u80fd \n\n# Summary:Enable tab complete for python\n# Description:\n\nNeeds import readline and rlcompleter module\n#\nimport readline\n#\nimport rlcompleter\n#\nhelp(rlcompleter) display detail: readline.parse_and_bind('tab: complete')\n#\nman python display detail: PYTHONSTARTUP variable\n\nif  [ ! -f /usr/bin/tab.py ];then\n  cat &gt;&gt; /usr/bin/tab.py &lt;&lt;EOF\nimport readline\nimport rlcompleter\nreadline.parse_and_bind('tab: complete')\nEOF\nfi\nsed  -i '$a export PYTHONSTARTUP=/usr/bin/tab.py' /etc/profile\nsource /etc/profile\n</code></pre>"},{"location":"chap8/5install_shell/#14-memcached","title":"14 \u4e00\u952e\u90e8\u7f72 memcached","text":"<pre><code>\n#!/bin/bash\n\n# \u4e00\u952e\u90e8\u7f72 memcached \n\n# \u811a\u672c\u7528\u6e90\u7801\u6765\u5b89\u88c5 memcached \u670d\u52a1\u5668\n# \u6ce8\u610f:\u5982\u679c\u8f6f\u4ef6\u7684\u4e0b\u8f7d\u94fe\u63a5\u8fc7\u671f\u4e86,\u8bf7\u66f4\u65b0 memcached \u7684\u4e0b\u8f7d\u94fe\u63a5\nwget http://www.memcached.org/files/memcached-1.5.1.tar.gz\nyum -y install gcc\ntar -xf  memcached\u20101.5.1.tar.gz\ncd memcached\u20101.5.1\n./configure\nmake\nmake install\n</code></pre>"},{"location":"chap8/6mon_shell/","title":"6 \u76d1\u63a7 Shell \u811a\u672c","text":""},{"location":"chap8/6mon_shell/#1","title":"1 \u76d1\u63a7\u5185\u5b58\u548c\u78c1\u76d8\u5bb9\u91cf\uff0c\u5c0f\u4e8e\u7ed9\u5b9a\u503c\u65f6\u62a5\u8b66","text":"<pre><code>#!/bin/bash\n\n# \u5b9e\u65f6\u76d1\u63a7\u672c\u673a\u5185\u5b58\u548c\u786c\u76d8\u5269\u4f59\u7a7a\u95f4,\u5269\u4f59\u5185\u5b58\u5c0f\u4e8e500M\u3001\u6839\u5206\u533a\u5269\u4f59\u7a7a\u95f4\u5c0f\u4e8e1000M\u65f6,\u53d1\u9001\u62a5\u8b66\u90ae\u4ef6\u7ed9root\u7ba1\u7406\u5458\n\n# \u63d0\u53d6\u6839\u5206\u533a\u5269\u4f59\u7a7a\u95f4\ndisk_size=$(df / | awk '/\\//{print $4}')\n\n# \u63d0\u53d6\u5185\u5b58\u5269\u4f59\u7a7a\u95f4\nmem_size=$(free | awk '/Mem/{print $4}')\nwhile :\ndo\n# \u6ce8\u610f\u5185\u5b58\u548c\u78c1\u76d8\u63d0\u53d6\u7684\u7a7a\u95f4\u5927\u5c0f\u90fd\u662f\u4ee5 Kb \u4e3a\u5355\u4f4d\nif  [  $disk_size -le 512000 -a $mem_size -le 1024000  ]\nthen\n    mail  \u2010s  \"Warning\"  root  &lt;&lt;EOF\n  Insufficient resources,\u8d44\u6e90\u4e0d\u8db3\nEOF\nfi\ndone\n</code></pre>"},{"location":"chap8/7net_shell/","title":"7 \u7f51\u7edc+\u6570\u636e\u5e93 Shell \u811a\u672c","text":""},{"location":"chap8/7net_shell/#1-1921684024-for","title":"1\u3001 \u7f16\u5199\u811a\u672c\u6d4b\u8bd5 192.168.4.0/24 \u6574\u4e2a\u7f51\u6bb5\u4e2d\u54ea\u4e9b\u4e3b\u673a\u5904\u4e8e\u5f00\u673a\u72b6\u6001,\u54ea\u4e9b\u4e3b\u673a\u5904\u4e8e\u5173\u673a\u72b6\u6001(for \u7248\u672c)","text":"<pre><code>#!/bin/bash\n\n# \u7f16\u5199\u811a\u672c\u6d4b\u8bd5 192.168.4.0/24 \u6574\u4e2a\u7f51\u6bb5\u4e2d\u54ea\u4e9b\u4e3b\u673a\u5904\u4e8e\u5f00\u673a\u72b6\u6001,\u54ea\u4e9b\u4e3b\u673a\u5904\u4e8e\u5173\u673a\n# \u72b6\u6001(for \u7248\u672c)\nfor i in {1..254}\ndo\n  # \u6bcf\u96940.3\u79d2ping\u4e00\u6b21\uff0c\u4e00\u5171ping2\u6b21\uff0c\u5e76\u4ee51\u6beb\u79d2\u4e3a\u5355\u4f4d\u8bbe\u7f6eping\u7684\u8d85\u65f6\u65f6\u95f4\n     ping \u2010c 2 \u2010i 0.3 \u2010W 1 192.168.4.$i  &amp;&gt;/dev/null\n    if  [ $? -eq 0 ];then\n         echo \"192.168.4.$i is up\"\n     else\n         echo  \"192.168.4.$i is down\"\n     fi\ndone\n</code></pre>"},{"location":"chap8/7net_shell/#2-1921684024-while","title":"2\u3001\u7f16\u5199\u811a\u672c\u6d4b\u8bd5 192.168.4.0/24 \u6574\u4e2a\u7f51\u6bb5\u4e2d\u54ea\u4e9b\u4e3b\u673a\u5904\u4e8e\u5f00\u673a\u72b6\u6001,\u54ea\u4e9b\u4e3b\u673a\u5904\u4e8e\u5173\u673a\u72b6\u6001(while \u7248\u672c)","text":"<pre><code>#!/bin/bash\n\n# \u7f16\u5199\u811a\u672c\u6d4b\u8bd5 192.168.4.0/24 \u6574\u4e2a\u7f51\u6bb5\u4e2d\u54ea\u4e9b\u4e3b\u673a\u5904\u4e8e\u5f00\u673a\u72b6\u6001,\u54ea\u4e9b\u4e3b\u673a\u5904\u4e8e\u5173\u673a\n# \u72b6\u6001(while \u7248\u672c) \ni=1\nwhile [ $i -le 254 ]\ndo\n     ping \u2010c 2 \u2010i 0.3 \u2010W 1 192.168.4.$i  &amp;&gt;/dev/null\n     if  [ $? -eq 0 ];then\n         echo \"192.168.4.$i is up\"\n    else\n         echo  \"192.168.4.$i is down\"\n     fi\n     let i++\ndone\n</code></pre>"},{"location":"chap8/7net_shell/#3-1921684024","title":"3 \u7f16\u5199\u811a\u672c\u6d4b\u8bd5 192.168.4.0/24 \u6574\u4e2a\u7f51\u6bb5\u4e2d\u54ea\u4e9b\u4e3b\u673a\u5904\u4e8e\u5f00\u673a\u72b6\u6001,\u54ea\u4e9b\u4e3b\u673a\u5904\u4e8e\u5173\u673a\u72b6\u6001(\u591a\u8fdb\u7a0b\u7248)","text":"<pre><code>#!/bin/bash\n\n# \u7f16\u5199\u811a\u672c\u6d4b\u8bd5 192.168.4.0/24 \u6574\u4e2a\u7f51\u6bb5\u4e2d\u54ea\u4e9b\u4e3b\u673a\u5904\u4e8e\u5f00\u673a\u72b6\u6001,\u54ea\u4e9b\u4e3b\u673a\u5904\u4e8e\u5173\u673a\n# \u72b6\u6001(\u591a\u8fdb\u7a0b\u7248)\n\n#\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570,ping \u67d0\u4e00\u53f0\u4e3b\u673a,\u5e76\u68c0\u6d4b\u4e3b\u673a\u7684\u5b58\u6d3b\u72b6\u6001\nmyping(){\nping \u2010c 2 \u2010i 0.3 \u2010W 1 $1  &amp;&gt;/dev/null\nif  [ $? -eq 0 ];then\n  echo \"$1 is up\"\nelse\n  echo \"$1 is down\"\nfi\n}\nfor i in {1..254}\ndo\n     myping 192.168.4.$i &amp;\ndone\n# \u4f7f\u7528&amp;\u7b26\u53f7,\u5c06\u6267\u884c\u7684\u51fd\u6570\u653e\u5165\u540e\u53f0\u6267\u884c\n# \u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\u4e0d\u9700\u8981\u7b49\u5f85ping\u7b2c\u4e00\u53f0\u4e3b\u673a\u7684\u56de\u5e94,\u5c31\u53ef\u4ee5\u7ee7\u7eed\u5e76\u53d1ping\u7b2c\u4e8c\u53f0\u4e3b\u673a,\u4f9d\u6b21\u7c7b\u63a8\u3002\n</code></pre>"},{"location":"chap8/7net_shell/#4-eth0","title":"4\u3001\u4f7f\u7528\u6b7b\u5faa\u73af\u5b9e\u65f6\u663e\u793a eth0 \u7f51\u5361\u53d1\u9001\u7684\u6570\u636e\u5305\u6d41\u91cf","text":"<pre><code>#!/bin/bash\n\n# \u4f7f\u7528\u6b7b\u5faa\u73af\u5b9e\u65f6\u663e\u793a eth0 \u7f51\u5361\u53d1\u9001\u7684\u6570\u636e\u5305\u6d41\u91cf \n\nwhile :\ndo\n   echo  '\u672c\u5730\u7f51\u5361 eth0 \u6d41\u91cf\u4fe1\u606f\u5982\u4e0b: '\n    ifconfig eth0 | grep \"RX pack\" | awk '{print $5}'\n    ifconfig eth0 | grep \"TX pack\" | awk '{print $5}'\n     sleep 1\ndone\n</code></pre>"},{"location":"chap8/7net_shell/#5-ip","title":"5 \u67e5\u770b\u6709\u591a\u5c11\u8fdc\u7a0b\u7684 IP \u5728\u8fde\u63a5\u672c\u673a","text":"<pre><code>#!/bin/bash\n\n# \u67e5\u770b\u6709\u591a\u5c11\u8fdc\u7a0b\u7684 IP \u5728\u8fde\u63a5\u672c\u673a(\u4e0d\u7ba1\u662f\u901a\u8fc7 ssh \u8fd8\u662f web \u8fd8\u662f ftp \u90fd\u7edf\u8ba1) \n\n# \u4f7f\u7528 netstat \u2010atn \u53ef\u4ee5\u67e5\u770b\u672c\u673a\u6240\u6709\u8fde\u63a5\u7684\u72b6\u6001,\u2010a \u67e5\u770b\u6240\u6709,\n# -t\u4ec5\u663e\u793a tcp \u8fde\u63a5\u7684\u4fe1\u606f,\u2010n \u6570\u5b57\u683c\u5f0f\u663e\u793a\n# Local Address(\u7b2c\u56db\u5217\u662f\u672c\u673a\u7684 IP \u548c\u7aef\u53e3\u4fe1\u606f)\n# Foreign Address(\u7b2c\u4e94\u5217\u662f\u8fdc\u7a0b\u4e3b\u673a\u7684 IP \u548c\u7aef\u53e3\u4fe1\u606f)\n# \u4f7f\u7528 awk \u547d\u4ee4\u4ec5\u663e\u793a\u7b2c 5 \u5217\u6570\u636e,\u518d\u663e\u793a\u7b2c 1 \u5217 IP \u5730\u5740\u7684\u4fe1\u606f\n# sort \u53ef\u4ee5\u6309\u6570\u5b57\u5927\u5c0f\u6392\u5e8f,\u6700\u540e\u4f7f\u7528 uniq \u5c06\u591a\u4f59\u91cd\u590d\u7684\u5220\u9664,\u5e76\u7edf\u8ba1\u91cd\u590d\u7684\u6b21\u6570\nnetstat -atn  |  awk  '{print $5}'  | awk  '{print $1}' | sort -nr  |  uniq -c\n</code></pre>"},{"location":"chap8/7net_shell/#6-1330-1430-apache","title":"6 \u7edf\u8ba1 13:30 \u5230 14:30 \u6240\u6709\u8bbf\u95ee apache \u670d\u52a1\u5668\u7684\u8bf7\u6c42\u6709\u591a\u5c11\u4e2a","text":"<pre><code>#!/bin/bash\n\n# \u7edf\u8ba1 13:30 \u5230 14:30 \u6240\u6709\u8bbf\u95ee apache \u670d\u52a1\u5668\u7684\u8bf7\u6c42\u6709\u591a\u5c11\u4e2a\n\n# awk \u4f7f\u7528\u2010F \u9009\u9879\u6307\u5b9a\u6587\u4ef6\u5185\u5bb9\u7684\u5206\u9694\u7b26\u662f/\u6216\u8005:\n# \u6761\u4ef6\u5224\u65ad$7:$8 \u5927\u4e8e\u7b49\u4e8e 13:30,\u5e76\u4e14\u8981\u6c42,$7:$8 \u5c0f\u4e8e\u7b49\u4e8e 14:30\n# \u6700\u540e\u4f7f\u7528 wc \u2010l \u7edf\u8ba1\u8fd9\u6837\u7684\u6570\u636e\u6709\u591a\u5c11\u884c,\u5373\u591a\u5c11\u4e2a\nawk -F \"[ /:]\" '$7\":\"$8&gt;=\"13:30\" &amp;&amp; $7\":\"$8&lt;=\"14:30\"' /var/log/httpd/access_log |wc -l\n</code></pre>"},{"location":"chap8/7net_shell/#7-1330-1430-aapche-ip","title":"7 \u7edf\u8ba1 13:30 \u5230 14:30 \u6240\u6709\u8bbf\u95ee\u672c\u673a Aapche \u670d\u52a1\u5668\u7684\u8fdc\u7a0b IP \u5730\u5740\u662f\u4ec0\u4e48","text":"<pre><code>#!/bin/bash\n\n# \u7edf\u8ba1 13:30 \u5230 14:30 \u6240\u6709\u8bbf\u95ee\u672c\u673a Aapche \u670d\u52a1\u5668\u7684\u8fdc\u7a0b IP \u5730\u5740\u662f\u4ec0\u4e48 \n# awk \u4f7f\u7528\u2010F \u9009\u9879\u6307\u5b9a\u6587\u4ef6\u5185\u5bb9\u7684\u5206\u9694\u7b26\u662f/\u6216\u8005:\n# \u6761\u4ef6\u5224\u65ad$7:$8 \u5927\u4e8e\u7b49\u4e8e 13:30,\u5e76\u4e14\u8981\u6c42,$7:$8 \u5c0f\u4e8e\u7b49\u4e8e 14:30\n# \u65e5\u5fd7\u6587\u6863\u5185\u5bb9\u91cc\u9762,\u7b2c 1 \u5217\u662f\u8fdc\u7a0b\u4e3b\u673a\u7684 IP \u5730\u5740,\u4f7f\u7528 awk \u5355\u72ec\u663e\u793a\u7b2c 1 \u5217\u5373\u53ef\nawk -F \"[ /:]\" '$7\":\"$8&gt;=\"13:30\" &amp;&amp; $7\":\"$8&lt;=\"14:30\"{print $1}' /var/log/httpd/access_log\n</code></pre>"},{"location":"chap8/7net_shell/#8-ip-apache","title":"8 \u7edf\u8ba1\u6bcf\u4e2a\u8fdc\u7a0b IP \u8bbf\u95ee\u4e86\u672c\u673a apache \u51e0\u6b21?","text":"<pre><code>#!/bin/bash\n\n# \u7edf\u8ba1\u6bcf\u4e2a\u8fdc\u7a0b IP \u8bbf\u95ee\u4e86\u672c\u673a apache \u51e0\u6b21? \nawk  '{ip[$1]++}END{for(i in ip){print ip[i],i}}'  /var/log/httpd/access_log\n</code></pre>"},{"location":"chap8/7net_shell/#9-mysql","title":"9 \u68c0\u6d4b MySQL \u6570\u636e\u5e93\u8fde\u63a5\u6570\u91cf","text":"<pre><code>#!/bin/bash\n\n# \u68c0\u6d4b MySQL \u6570\u636e\u5e93\u8fde\u63a5\u6570\u91cf \n\n# \u672c\u811a\u672c\u6bcf 2 \u79d2\u68c0\u6d4b\u4e00\u6b21 MySQL \u5e76\u53d1\u8fde\u63a5\u6570,\u53ef\u4ee5\u5c06\u672c\u811a\u672c\u8bbe\u7f6e\u4e3a\u5f00\u673a\u542f\u52a8\u811a\u672c,\u6216\u5728\u7279\u5b9a\u65f6\u95f4\u6bb5\u6267\u884c\n# \u4ee5\u6ee1\u8db3\u5bf9 MySQL \u6570\u636e\u5e93\u7684\u76d1\u63a7\u9700\u6c42,\u67e5\u770b MySQL \u8fde\u63a5\u662f\u5426\u6b63\u5e38\n# \u672c\u6848\u4f8b\u4e2d\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u9700\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\u540e\u65b9\u53ef\u4f7f\u7528\nlog_file=/var/log/mysql_count.log\nuser=root\npasswd=123456\nwhile :\ndo\n    sleep 2\n    count=`mysqladmin  -u  \"$user\"  -p  \"$passwd\"   status |  awk '{print $4}'`\n    echo \"`date +%Y\u2010%m\u2010%d` \u5e76\u53d1\u8fde\u63a5\u6570\u4e3a:$count\" &gt;&gt; $log_file\ndone\n</code></pre>"},{"location":"chap8/7net_shell/#10-mysql","title":"10 \u68c0\u6d4b MySQL \u670d\u52a1\u662f\u5426\u5b58\u6d3b","text":"<pre><code>#!/bin/bash\n\n# \u68c0\u6d4b MySQL \u670d\u52a1\u662f\u5426\u5b58\u6d3b \n\n# host \u4e3a\u4f60\u9700\u8981\u68c0\u6d4b\u7684 MySQL \u4e3b\u673a\u7684 IP \u5730\u5740,user \u4e3a MySQL \u8d26\u6237\u540d,passwd \u4e3a\u5bc6\u7801\n# \u8fd9\u4e9b\u4fe1\u606f\u9700\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\u540e\u65b9\u53ef\u4f7f\u7528\nhost=192.168.51.198\nuser=root\npasswd=123456\nmysqladmin -h '$host' -u '$user' -p'$passwd' ping &amp;&gt;/dev/null\nif [ $? -eq 0 ]\nthen\n        echo \"MySQL is UP\"\nelse\n        echo \"MySQL is down\"\nfi\n</code></pre>"},{"location":"chap8/7net_shell/#11-mysql-shell-mysqldump","title":"11 \u5907\u4efd MySQL \u7684 shell \u811a\u672c(mysqldump\u7248\u672c)","text":"<pre><code>\n#!/bin/bash\n\n# \u5907\u4efd MySQL \u7684 shell \u811a\u672c(mysqldump\u7248\u672c) \n\n# \u5b9a\u4e49\u53d8\u91cf user(\u6570\u636e\u5e93\u7528\u6237\u540d),passwd(\u6570\u636e\u5e93\u5bc6\u7801),date(\u5907\u4efd\u7684\u65f6\u95f4\u6807\u7b7e)\n# dbname(\u9700\u8981\u5907\u4efd\u7684\u6570\u636e\u5e93\u540d\u79f0,\u6839\u636e\u5b9e\u9645\u9700\u6c42\u9700\u8981\u4fee\u6539\u8be5\u53d8\u91cf\u7684\u503c,\u9ed8\u8ba4\u5907\u4efd mysql \u6570\u636e\u5e93)\n\nuser=root\npasswd=123456\ndbname=mysql\ndate=$(date +%Y%m%d)\n\n# \u6d4b\u8bd5\u5907\u4efd\u76ee\u5f55\u662f\u5426\u5b58\u5728,\u4e0d\u5b58\u5728\u5219\u81ea\u52a8\u521b\u5efa\u8be5\u76ee\u5f55\n[ ! -d /mysqlbackup ] &amp;&amp; mkdir /mysqlbackup\n# \u4f7f\u7528 mysqldump \u547d\u4ee4\u5907\u4efd\u6570\u636e\u5e93\nmysqldump -u \"$user\" -p \"$passwd\" \"$dbname\" &gt; /mysqlbackup/\"$dbname\"-${date}.sql\n</code></pre>"},{"location":"chap8/7net_shell/#12-http","title":"12 \u76d1\u63a7 HTTP \u670d\u52a1\u5668\u7684\u72b6\u6001(\u6d4b\u8bd5\u8fd4\u56de\u7801)","text":"<pre><code>#!/bin/bash\n\n# \u76d1\u63a7 HTTP \u670d\u52a1\u5668\u7684\u72b6\u6001(\u6d4b\u8bd5\u8fd4\u56de\u7801)\n\n# \u8bbe\u7f6e\u53d8\u91cf,url\u4e3a\u4f60\u9700\u8981\u68c0\u6d4b\u7684\u76ee\u6807\u7f51\u7ad9\u7684\u7f51\u5740(IP \u6216\u57df\u540d),\u6bd4\u5982\u767e\u5ea6\nurl=http://http://183.232.231.172/index.html\n\n# \u5b9a\u4e49\u51fd\u6570 check_http:\n# \u4f7f\u7528 curl \u547d\u4ee4\u68c0\u67e5 http \u670d\u52a1\u5668\u7684\u72b6\u6001\n# \u2010m \u8bbe\u7f6ecurl\u4e0d\u7ba1\u8bbf\u95ee\u6210\u529f\u6216\u5931\u8d25,\u6700\u5927\u6d88\u8017\u7684\u65f6\u95f4\u4e3a 5 \u79d2,5 \u79d2\u8fde\u63a5\u670d\u52a1\u4e3a\u76f8\u5e94\u5219\u89c6\u4e3a\u65e0\u6cd5\u8fde\u63a5\n# \u2010s \u8bbe\u7f6e\u9759\u9ed8\u8fde\u63a5,\u4e0d\u663e\u793a\u8fde\u63a5\u65f6\u7684\u8fde\u63a5\u901f\u5ea6\u3001\u65f6\u95f4\u6d88\u8017\u7b49\u4fe1\u606f\n# \u2010o \u5c06 curl \u4e0b\u8f7d\u7684\u9875\u9762\u5185\u5bb9\u5bfc\u51fa\u5230/dev/null(\u9ed8\u8ba4\u4f1a\u5728\u5c4f\u5e55\u663e\u793a\u9875\u9762\u5185\u5bb9)\n# \u2010w \u8bbe\u7f6ecurl\u547d\u4ee4\u9700\u8981\u663e\u793a\u7684\u5185\u5bb9%{http_code},\u6307\u5b9acurl\u8fd4\u56de\u670d\u52a1\u5668\u7684\u72b6\u6001\u7801\ncheck_http()\n{\n        status_code=$(curl -m 5 -s -o /dev/null -w %{http_code} $url)\n}\n\nwhile :\ndo\n        check_http\n        date=$(date +%Y%m%d\u2010%H:%M:%S)\n\n# \u751f\u6210\u62a5\u8b66\u90ae\u4ef6\u7684\u5185\u5bb9\n        echo \"\u5f53\u524d\u65f6\u95f4\u4e3a:$date\n        $url \u670d\u52a1\u5668\u5f02\u5e38,\u72b6\u6001\u7801\u4e3a${status_code}.\n        \u8bf7\u5c3d\u5feb\u6392\u67e5\u5f02\u5e38.\" &gt; /tmp/http$$.pid\n\n# \u6307\u5b9a\u6d4b\u8bd5\u670d\u52a1\u5668\u72b6\u6001\u7684\u51fd\u6570,\u5e76\u6839\u636e\u8fd4\u56de\u7801\u51b3\u5b9a\u662f\u53d1\u9001\u90ae\u4ef6\u62a5\u8b66\u8fd8\u662f\u5c06\u6b63\u5e38\u4fe1\u606f\u5199\u5165\u65e5\u5fd7\n        if [ $status_code -ne 200 ];then\n                mail -s Warning root &lt; /tmp/http$$.pid\n        else\n                echo \"$url \u8fde\u63a5\u6b63\u5e38\" &gt;&gt; /var/log/http.log\n        fi\n        sleep 5\ndone\n</code></pre>"},{"location":"chap8/7net_shell/#13-rhel7","title":"13 \u81ea\u52a8\u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219,\u5f00\u542f\u67d0\u4e9b\u670d\u52a1\u6216\u7aef\u53e3(\u9002\u7528\u4e8e RHEL7)","text":"<pre><code>#!/bin/bash\n\n# \u81ea\u52a8\u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219,\u5f00\u542f\u67d0\u4e9b\u670d\u52a1\u6216\u7aef\u53e3(\u9002\u7528\u4e8e RHEL7)\n# \n# \u8bbe\u7f6e\u53d8\u91cf\u5b9a\u4e49\u9700\u8981\u6dfb\u52a0\u5230\u9632\u706b\u5899\u89c4\u5219\u7684\u670d\u52a1\u548c\u7aef\u53e3\u53f7\n# \u4f7f\u7528 firewall\u2010cmd \u2010\u2010get\u2010services \u53ef\u4ee5\u67e5\u770b firewall \u652f\u6301\u54ea\u4e9b\u670d\u52a1\nservice=\"nfs http ssh\"\nport=\"80 22 8080\"\n\n# \u5faa\u73af\u5c06\u6bcf\u4e2a\u670d\u52a1\u6dfb\u52a0\u5230\u9632\u706b\u5899\u89c4\u5219\u4e2d\nfor i in $service\ndo\n    echo \"Adding $i service to firewall\"\n    firewall\u2010cmd  --add-service=${i}\ndone\n\n#\u5faa\u73af\u5c06\u6bcf\u4e2a\u7aef\u53e3\u6dfb\u52a0\u5230\u9632\u706b\u5899\u89c4\u5219\u4e2d\nfor i in $port\ndo\n    echo \"Adding $i Port to firewall\"\n    firewall\u2010cmd --add-port=${i}/tcp\ndone\n#\u5c06\u4ee5\u4e0a\u8bbe\u7f6e\u7684\u4e34\u65f6\u9632\u706b\u5899\u89c4\u5219,\u8f6c\u6362\u4e3a\u6c38\u4e45\u6709\u6548\u7684\u89c4\u5219(\u786e\u4fdd\u91cd\u542f\u540e\u6709\u6548)\nfirewall\u2010cmd  --runtime-to-permanent\n</code></pre>"},{"location":"chap8/7net_shell/#14-pdf","title":"14 \u6279\u91cf\u4e0b\u8f7d\u6709\u5e8f\u6587\u4ef6(pdf\u3001\u56fe\u7247\u3001\u89c6\u9891\u7b49\u7b49)","text":"<pre><code>\n#!/bin/bash\n\n# \u6279\u91cf\u4e0b\u8f7d\u6709\u5e8f\u6587\u4ef6(pdf\u3001\u56fe\u7247\u3001\u89c6\u9891\u7b49\u7b49)\n\n# \u672c\u811a\u672c\u51c6\u5907\u6709\u5e8f\u7684\u7f51\u7edc\u8d44\u6599\u8fdb\u884c\u6279\u91cf\u4e0b\u8f7d\u64cd\u4f5c(\u5982 01.jpg,02.jpg,03.jpg)\n# \u8bbe\u7f6e\u8d44\u6e90\u6765\u6e90\u7684\u57df\u540d\u8fde\u63a5\nurl=\"http://www.baidu.com/\"\necho  \"\u5f00\u59cb\u4e0b\u8f7d...\"\nsleep 2\ntype=jpg\nfor i in `seq 100`\n     echo \"\u6b63\u5728\u4e0b\u8f7d$i.$type\"\n  curl $url/$i.$type -o /tmp/${i}$type\n     sleep 1\ndone\n#curl \u4f7f\u7528-o \u9009\u9879\u6307\u5b9a\u4e0b\u8f7d\u6587\u4ef6\u53e6\u5b58\u5230\u54ea\u91cc.\n</code></pre>"},{"location":"chap8/7net_shell/#15","title":"15 \u5faa\u73af\u5173\u95ed\u5c40\u57df\u7f51\u4e2d\u6240\u6709\u4e3b\u673a","text":"<pre><code>#!/bin/bash\n\n# \u5faa\u73af\u5173\u95ed\u5c40\u57df\u7f51\u4e2d\u6240\u6709\u4e3b\u673a \n\n# \u5047\u8bbe\u672c\u673a\u4e3a 192.168.4.100,\u7f16\u5199\u811a\u672c\u5173\u95ed\u9664\u81ea\u5df1\u5916\u7684\u5176\u4ed6\u6240\u6709\u4e3b\u673a\n# \u811a\u672c\u6267\u884c,\u9700\u8981\u63d0\u524d\u7ed9\u6240\u6709\u5176\u4ed6\u4e3b\u673a\u4f20\u9012 ssh \u5bc6\u94a5,\u6ee1\u8db3\u65e0\u5bc6\u7801\u8fde\u63a5\nfor i in {1..254}\ndo\n  [ $i -eq 100 ] &amp;&amp; continue\n  echo \"\u6b63\u5728\u5173\u95ed 192.168.4.$i...\"\n  ssh 192.168.4.$i poweroff\ndone\n</code></pre>"},{"location":"chap8/7net_shell/#16-mac","title":"16 \u83b7\u53d6\u672c\u673a MAC \u5730\u5740","text":"<pre><code>#!/bin/bash\n\n# \u83b7\u53d6\u672c\u673a MAC \u5730\u5740\nip a s | awk 'BEGIN{print  \" \u672c \u673a MAC \u5730 \u5740 \u4fe1 \u606f \u5982 \u4e0b :\"}/^[0\u20109]/{print $2;getline;if($0~/link\\/ether/){print $2}}' | grep -v lo:\n\n# awk \u8bfb\u53d6 ip \u547d\u4ee4\u7684\u8f93\u51fa,\u8f93\u51fa\u7ed3\u679c\u4e2d\u5982\u679c\u6709\u4ee5\u6570\u5b57\u5f00\u59cb\u7684\u884c,\u5148\u663e\u793a\u8be5\u884c\u7684\u5730 2 \u5217(\u7f51\u5361\u540d\u79f0),\n# \u63a5\u7740\u4f7f\u7528 getline \u518d\u8bfb\u53d6\u5b83\u7684\u4e0b\u4e00\u884c\u6570\u636e,\u5224\u65ad\u662f\u5426\u5305\u542b link/ether\n# \u5982\u679c\u4fdd\u62a4\u8be5\u5173\u952e\u8bcd,\u5c31\u663e\u793a\u8be5\u884c\u7684\u7b2c 2 \u5217(MAC \u5730\u5740)\n# lo \u56de\u73af\u8bbe\u5907\u6ca1\u6709 MAC,\u56e0\u6b64\u5c06\u5176\u5c4f\u853d,\u4e0d\u663e\u793a\n</code></pre>"},{"location":"chap8/7net_shell/#17-linux","title":"17 \u663e\u793a\u672c\u673a Linux \u7cfb\u7edf\u4e0a\u6240\u6709\u5f00\u653e\u7684\u7aef\u53e3\u5217\u8868","text":"<pre><code>\n#!/bin/bash\n\n# \u663e\u793a\u672c\u673a Linux \u7cfb\u7edf\u4e0a\u6240\u6709\u5f00\u653e\u7684\u7aef\u53e3\u5217\u8868 \n\n# \u4ece\u7aef\u53e3\u5217\u8868\u4e2d\u89c2\u6d4b\u6709\u6ca1\u6709\u6ca1\u7528\u7684\u7aef\u53e3,\u6709\u7684\u8bdd\u53ef\u4ee5\u5c06\u8be5\u7aef\u53e3\u5bf9\u5e94\u7684\u670d\u52a1\u5173\u95ed,\u9632\u6b62\u610f\u5916\u7684\u653b\u51fb\u53ef\u80fd\u6027\nss -nutlp | awk '{print $1,$5}' | awk -F\"[: ]\" '{print \"\u534f\u8bae:\"$1,\"\u7aef\u53e3\u53f7:\"$NF}' | grep \"[0\u20109]\" | uniq\n</code></pre>"},{"location":"chap8/7net_shell/#18-kvm","title":"18 \u67e5\u770b KVM \u865a\u62df\u673a\u4e2d\u7684\u7f51\u5361\u4fe1\u606f(\u4e0d\u9700\u8981\u8fdb\u5165\u542f\u52a8\u6216\u8fdb\u5165\u865a\u62df\u673a)","text":"<pre><code>#!/bin/bash\n\n# \u67e5\u770b KVM \u865a\u62df\u673a\u4e2d\u7684\u7f51\u5361\u4fe1\u606f(\u4e0d\u9700\u8981\u8fdb\u5165\u542f\u52a8\u6216\u8fdb\u5165\u865a\u62df\u673a) \n\n# \u8be5\u811a\u672c\u4f7f\u7528 guestmount \u5de5\u5177,\u53ef\u4ee5\u5c06\u865a\u62df\u673a\u7684\u78c1\u76d8\u7cfb\u7edf\u6302\u8f7d\u5230\u771f\u5b9e\u673a\u6587\u4ef6\u7cfb\u7edf\u4e2d\n# Centos7.2 \u4e2d\u5b89\u88c5 libguestfs\u2010tools\u2010c \u53ef\u4ee5\u83b7\u5f97 guestmount \u5de5\u5177\n# \u865a\u62df\u673a\u53ef\u4ee5\u542f\u52a8\u6216\u8005\u4e0d\u542f\u52a8\u90fd\u4e0d\u5f71\u54cd\u8be5\u811a\u672c\u7684\u4f7f\u7528\n# \u5c06\u865a\u62df\u673a\u78c1\u76d8\u6587\u4ef6\u6302\u8f7d\u5230\u6587\u4ef6\u7cfb\u7edf\u540e,\u5c31\u53ef\u4ee5\u76f4\u63a5\u8bfb\u53d6\u78c1\u76d8\u6587\u4ef6\u4e2d\u7684\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u6570\u636e\nclear\nmountpoint=\"/media/virtimage\"\n[ ! -d $mountpoint ] &amp;&amp; mkdir $mountpoint\nread -p \"\u8f93\u5165\u865a\u62df\u673a\u540d\u79f0:\" name\necho \"\u8bf7\u7a0d\u540e...\"\n# \u5982\u679c\u6709\u8bbe\u5907\u6302\u8f7d\u5230\u8be5\u6302\u8f7d\u70b9,\u5219\u5148 umount \u5378\u8f7d\nif mount | grep -q \"$mountpoint\" ;then\n  umount $mountpoint\nfi\n# \u53ea\u8bfb\u7684\u65b9\u5f0f,\u5c06\u865a\u62df\u673a\u7684\u78c1\u76d8\u6587\u4ef6\u6302\u8f7d\u5230\u7279\u5b9a\u7684\u76ee\u5f55\u4e0b,\u8fd9\u91cc\u662f/media/virtimage \u76ee\u5f55\nguestmount -r -d $name -i $mountpoint\necho\necho \"\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\"\necho -e \"\\033[32m$name \u865a\u62df\u673a\u4e2d\u7f51\u5361\u5217\u8868\u5982\u4e0b:\\033[0m\"\ndev=$(ls /media/virtimage/etc/sysconfig/network\u2010scripts/ifcfg-* |awk -F\"[/\u2010]\" '{print $9}')\necho $dev\necho \"\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\u2010\"\necho\necho\necho \"+++++++++++++++++++++++++++++++++++++++++++\"\necho -e \"\\033[32m \u7f51\u5361 IP \u5730\u5740\u4fe1\u606f\u5982\u4e0b:\\033[0m\"\nfor i in $dev\ndo\n  echo -n \"$i:\"\n  grep -q \"IPADDR\" /media/virtimage/etc/sysconfig/network\u2010scripts/ifcfg-$i || echo \"\u672a\u914d\u7f6e IP\u5730\u5740\"\n  awk -F= '/IPADDR/{print $2}' /media/virtimage/etc/sysconfig/network-scripts/ifcfg-$i\ndone\necho \"+++++++++++++++++++++++++++++++++++++++++++\"\n</code></pre>"},{"location":"chap8/7net_shell/#19-ip","title":"19 \u4e0d\u767b\u9646\u865a\u62df\u673a,\u4fee\u6539\u865a\u62df\u673a\u7f51\u5361 IP \u5730\u5740","text":"<pre><code>#!/bin/bash\n\n# \u4e0d\u767b\u9646\u865a\u62df\u673a,\u4fee\u6539\u865a\u62df\u673a\u7f51\u5361 IP \u5730\u5740 \n\n# \u8be5\u811a\u672c\u4f7f\u7528 guestmount \u5de5\u5177,Centos7.2 \u4e2d\u5b89\u88c5 libguestfs\u2010tools\u2010c \u53ef\u4ee5\u83b7\u5f97 guestmount \u5de5\u5177\n# \u811a\u672c\u5728\u4e0d\u767b\u9646\u865a\u62df\u673a\u7684\u60c5\u51b5\u4e0b,\u4fee\u6539\u865a\u62df\u673a\u7684 IP \u5730\u5740\u4fe1\u606f\n# \u5728\u67d0\u4e9b\u73af\u5883\u4e0b,\u865a\u62df\u673a\u6ca1\u6709 IP \u6216 IP \u5730\u5740\u4e0e\u771f\u5b9e\u4e3b\u673a\u4e0d\u5728\u4e00\u4e2a\u7f51\u6bb5\n# \u771f\u5b9e\u4e3b\u673a\u5728\u6ca1\u6709 virt\u2010manger \u56fe\u5f62\u7684\u60c5\u51b5\u4e0b,\u8fdc\u7a0b\u8fde\u63a5\u865a\u62df\u673a\u5f88\u9ebb\u70e6\n# \u8be5\u811a\u672c\u53ef\u4ee5\u89e3\u51b3\u7c7b\u4f3c\u7684\u95ee\u9898\nread -p \"\u8bf7\u8f93\u5165\u865a\u62df\u673a\u540d\u79f0:\" name\nif virsh domstate $name | grep -q running ;then\n  echo \"\u4fee\u6539\u865a\u62df\u673a\u7f51\u5361\u6570\u636e,\u9700\u8981\u5173\u95ed\u865a\u62df\u673a\"\n  virsh destroy $name\nfi\nmountpoint=\"/media/virtimage\"\n[ ! -d $mountpoint ] &amp;&amp; mkdir $mountpoint\necho \"\u8bf7\u7a0d\u540e...\"\nif mount | grep -q \"$mountpoint\" ;then\n  umount $mountpoint\nfi\nguestmount  -d $name -i $mountpoint\nread -p \"\u8bf7\u8f93\u5165\u9700\u8981\u4fee\u6539\u7684\u7f51\u5361\u540d\u79f0:\" dev\nread -p \"\u8bf7\u8f93\u5165 IP \u5730\u5740:\" addr\n# \u5224\u65ad\u539f\u672c\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\u4e2d\u662f\u5426\u6709 IP \u5730\u5740,\u6709\u5c31\u4fee\u6539\u8be5 IP,\u6ca1\u6709\u5c31\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684 IP \u5730\u5740\nif grep -q \"IPADDR\"  $mountpoint/etc/sysconfig/network\u2010scripts/ifcfg\u2010$dev ;then\n  sed -i \"/IPADDR/s/=.*/=$addr/\"  $mountpoint/etc/sysconfig/network\u2010scripts/ifcfg\u2010$dev\nelse\n  echo \"IPADDR=$addr\" &gt;&gt; $mountpoint/etc/sysconfig/network\u2010scripts/ifcfg\u2010$dev\nfi\n# \u5982\u679c\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\u4e2d\u6709\u5ba2\u6237\u914d\u7f6e\u7684 IP \u5730\u5740,\u5219\u811a\u672c\u63d0\u793a\u4fee\u6539 IP \u5b8c\u6210\nawk -F= -v x=$addr '$2==x{print \"\u5b8c\u6210...\"}'  $mountpoint/etc/sysconfig/network\u2010scripts/ifcfg-$dev\n</code></pre>"},{"location":"chap8/8secret_shell/","title":"8 Secret shell \u811a\u672c","text":""},{"location":"chap8/8secret_shell/#1-md5","title":"1 \u6839\u636e md5 \u6821\u9a8c\u7801,\u68c0\u6d4b\u6587\u4ef6\u662f\u5426\u88ab\u4fee\u6539","text":"<pre><code>#!/bin/bash\n\n# \u6839\u636e md5 \u6821\u9a8c\u7801,\u68c0\u6d4b\u6587\u4ef6\u662f\u5426\u88ab\u4fee\u6539 \n# \u672c\u793a\u4f8b\u811a\u672c\u68c0\u6d4b\u7684\u662f/etc \u76ee\u5f55\u4e0b\u6240\u6709\u7684 conf \u7ed3\u5c3e\u7684\u6587\u4ef6,\u6839\u636e\u5b9e\u9645\u60c5\u51b5,\u60a8\u53ef\u4ee5\u4fee\u6539\u4e3a\u5176\u4ed6\u76ee\u5f55\u6216\u6587\u4ef6\n# \u672c\u811a\u672c\u5728\u76ee\u6807\u6570\u636e\u6ca1\u6709\u88ab\u4fee\u6539\u65f6\u6267\u884c\u4e00\u6b21,\u5f53\u6000\u7591\u6570\u636e\u88ab\u4eba\u7be1\u6539,\u518d\u6267\u884c\u4e00\u6b21\n# \u5c06\u4e24\u6b21\u6267\u884c\u7684\u7ed3\u679c\u505a\u5bf9\u6bd4,MD5 \u7801\u53d1\u751f\u6539\u53d8\u7684\u6587\u4ef6,\u5c31\u662f\u88ab\u4eba\u7be1\u6539\u7684\u6587\u4ef6\nfor i in $(ls /etc/*.conf)\ndo\n  md5sum \"$i\" &gt;&gt; /var/log/conf_file.log\ndone\n</code></pre>"},{"location":"chap8/8secret_shell/#2-ssh","title":"2 \u975e\u4ea4\u4e92\u81ea\u52a8\u751f\u6210 SSH \u5bc6\u94a5\u6587\u4ef6","text":"<pre><code>#!/bin/bash\n\n# \u975e\u4ea4\u4e92\u81ea\u52a8\u751f\u6210 SSH \u5bc6\u94a5\u6587\u4ef6 \n\n# \u2010t \u6307\u5b9a SSH \u5bc6\u94a5\u7684\u7b97\u6cd5\u4e3a RSA \u7b97\u6cd5;\u2010N \u8bbe\u7f6e\u5bc6\u94a5\u7684\u5bc6\u7801\u4e3a\u7a7a;\u2010f \u6307\u5b9a\u751f\u6210\u7684\u5bc6\u94a5\u6587\u4ef6&gt;\u5b58\u653e\u5728\u54ea\u91cc\nrm  -rf  ~/.ssh/{known_hosts,id_rsa*}\nssh\u2010keygen -t RSA -N '' -f ~/.ssh/id_rsa\n</code></pre>"},{"location":"chap8/8secret_shell/#3-urandom","title":"3 \u751f\u6210\u968f\u673a\u5bc6\u7801(urandom \u7248\u672c)","text":"<pre><code>#!/bin/bash\n\n# \u751f\u6210\u968f\u673a\u5bc6\u7801(urandom \u7248\u672c) \n\n# /dev/urandom \u6587\u4ef6\u662f Linux \u5185\u7f6e\u7684\u968f\u673a\u8bbe\u5907\u6587\u4ef6\n# cat /dev/urandom \u53ef\u4ee5\u770b\u770b\u91cc\u9762\u7684\u5185\u5bb9,ctrl+c \u9000\u51fa\u67e5\u770b\n# \u67e5\u770b\u8be5\u6587\u4ef6\u5185\u5bb9\u540e,\u53d1\u73b0\u5185\u5bb9\u6709\u4e9b\u592a\u968f\u673a,\u5305\u62ec\u5f88\u591a\u7279\u6b8a\u7b26\u53f7,\u6211\u4eec\u9700\u8981\u7684\u5bc6\u7801\u4e0d\u5e0c\u671b\u4f7f\u7528\u8fd9\u4e9b\u7b26\u53f7\n# tr \u2010dc '_A\u2010Za\u2010z0\u20109' &lt; /dev/urandom\n# \u8be5\u547d\u4ee4\u53ef\u4ee5\u5c06\u968f\u673a\u6587\u4ef6\u4e2d\u5176\u4ed6\u7684\u5b57\u7b26\u5220\u9664,\u4ec5\u4fdd\u7559\u5927\u5c0f\u5199\u5b57\u6bcd,\u6570\u5b57,\u4e0b\u5212\u7ebf,\u4f46\u662f\u5185\u5bb9\u8fd8\u662f\u592a\u591a\n# \u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u5c06\u4f18\u5316\u597d\u7684\u5185\u5bb9\u901a\u8fc7\u7ba1\u9053\u4f20\u9012\u7ed9 head \u547d\u4ee4,\u5728\u5927\u91cf\u6570\u636e\u4e2d\u4ec5\u663e\u793a\u5934 10 \u4e2a\u5b57\u8282\n# \u6ce8\u610f A \u524d\u9762\u6709\u4e2a\u4e0b\u5212\u7ebf\ntr -dc '_A\u2010Za\u2010z0\u20109' &lt;/dev/urandom | head -c 10\n</code></pre>"},{"location":"chap8/8secret_shell/#4","title":"4 \u751f\u6210\u968f\u673a\u5bc6\u7801(\u5b57\u4e32\u622a\u53d6\u7248\u672c)","text":"<pre><code>\n#!/bin/bash\n\n# \u751f\u6210\u968f\u673a\u5bc6\u7801(\u5b57\u4e32\u622a\u53d6\u7248\u672c) \n\n# \u8bbe\u7f6e\u53d8\u91cf key,\u5b58\u50a8\u5bc6\u7801\u7684\u6240\u6709\u53ef\u80fd\u6027(\u5bc6\u7801\u5e93),\u5982\u679c\u8fd8\u9700\u8981\u5176\u4ed6\u5b57\u7b26\u8bf7\u81ea\u884c\u6dfb\u52a0\u5176\u4ed6\u5bc6\u7801\u5b57\u7b26\n# \u4f7f\u7528$#\u7edf\u8ba1\u5bc6\u7801\u5e93\u7684\u957f\u5ea6\nkey=\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nnum=${#key}\n# \u8bbe\u7f6e\u521d\u59cb\u5bc6\u7801\u4e3a\u7a7a\npass=''\n# \u5faa\u73af 8 \u6b21,\u751f\u6210\u968f\u673a\u5bc6\u7801\n# \u6bcf\u6b21\u90fd\u662f\u968f\u673a\u6570\u5bf9\u5bc6\u7801\u5e93\u7684\u957f\u5ea6\u53d6\u4f59,\u786e\u4fdd\u63d0\u53d6\u7684\u5bc6\u7801\u5b57\u7b26\u4e0d\u8d85\u8fc7\u5bc6\u7801\u5e93\u7684\u957f\u5ea6\n# \u6bcf\u6b21\u5faa\u73af\u63d0\u53d6\u4e00\u4f4d\u968f\u673a\u5bc6\u7801,\u5e76\u5c06\u8be5\u968f\u673a\u5bc6\u7801\u8ffd\u52a0\u5230 pass \u53d8\u91cf\u7684\u6700\u540e\nfor i in {1..8}\ndo  \n  index=$[RANDOM%num]\n  pass=$pass${key:$index:1}\ndone\necho $pass\n</code></pre>"},{"location":"chap8/8secret_shell/#5-uuid-16","title":"5 \u751f\u6210\u968f\u673a\u5bc6\u7801(UUID \u7248\u672c,16 \u8fdb\u5236\u5bc6\u7801)","text":"<pre><code>#!/bin/bash\n\n# \u751f\u6210\u968f\u673a\u5bc6\u7801(UUID \u7248\u672c,16 \u8fdb\u5236\u5bc6\u7801) \nuuidgen\n</code></pre>"},{"location":"chap8/8secret_shell/#6-id","title":"6\u3001\u751f\u6210\u968f\u673a\u5bc6\u7801(\u8fdb\u7a0b ID \u7248\u672c,\u6570\u5b57\u5bc6\u7801)","text":"<pre><code>#!/bin/bash\n\n# \u751f\u6210\u968f\u673a\u5bc6\u7801(\u8fdb\u7a0b ID \u7248\u672c,\u6570\u5b57\u5bc6\u7801)\necho $$\n</code></pre>"},{"location":"chap8/8secret_shell/#7","title":"7\u3001\u6d4b\u8bd5\u7528\u6237\u540d\u4e0e\u5bc6\u7801\u662f\u5426\u6b63\u786e","text":"<pre><code>#!/bin/bash\n\n# \u6d4b\u8bd5\u7528\u6237\u540d\u4e0e\u5bc6\u7801\u662f\u5426\u6b63\u786e\n\n#\u7528\u6237\u540d\u4e3a tom \u5e76\u4e14\u5bc6\u7801\u4e3a 123456,\u5219\u63d0\u793a\u767b\u5f55\u6210\u529f,\u5426\u5219\u63d0\u793a\u767b\u5f55\u5931\u8d25\nread -p \"\u8bf7\u8f93\u5165\u7528\u6237\u540d:\"  user\nread -p \"\u8bf7\u8f93\u5165\u5bc6\u7801:\"    pass\nif [ \"$user\" == 'tom' -a \"$pass\" == '123456' ];then\n  echo \"Login successful\"\nelse\n  echo \"Login Failed\"\nfi\n</code></pre>"},{"location":"chap8/8secret_shell/#8","title":"8\u3001\u5faa\u73af\u6d4b\u8bd5\u7528\u6237\u540d\u4e0e\u5bc6\u7801\u662f\u5426\u6b63\u786e","text":"<pre><code>#!/bin/bash\n\n# \u5faa\u73af\u6d4b\u8bd5\u7528\u6237\u540d\u4e0e\u5bc6\u7801\u662f\u5426\u6b63\u786e \n\n# \u5faa\u73af\u6d4b\u8bd5\u7528\u6237\u7684\u8d26\u6237\u540d\u548c\u5bc6\u7801,\u6700\u5927\u6d4b\u8bd5 3 \u6b21,\u8f93\u5165\u6b63\u786e\u63d0\u793a\u767b\u5f55\u6210\u529f,\u5426\u5219\u63d0\u793a\u767b\u5f55\u5931\u8d25\n# \u7528\u6237\u540d\u4e3a tom \u5e76\u4e14\u5bc6\u7801\u4e3a 123456  \nfor i in {1..3}\ndo\n  read -p \"\u8bf7\u8f93\u5165\u7528\u6237\u540d:\" user\n  read -p \"\u8bf7\u8f93\u5165\u5bc6\u7801:\"   pass\nif [ \"$user\" == 'tom' -a \"$pass\" == '123456' ];then\n    echo \"Login successful\"\n     exit\nfi\ndone\necho \"Login Failed\"\n</code></pre>"},{"location":"chap8/8secret_shell/#9etcpasswd-etcshadow","title":"9\u3001\u627e\u51fa<code>/etc/passwd</code> \u4e2d\u80fd\u767b\u5f55\u7684\u7528\u6237,\u5e76\u5c06\u5bf9\u5e94\u5728<code>/etc/shadow</code> \u4e2d\u7b2c\u4e8c\u5217\u5bc6\u7801\u63d0\u51fa\u5904\u7406","text":"<pre><code>#!/bin/bash\n\n# \u627e\u51fa/etc/passwd \u4e2d\u80fd\u767b\u5f55\u7684\u7528\u6237,\u5e76\u5c06\u5bf9\u5e94\u5728/etc/shadow \u4e2d\u7b2c\u4e8c\u5217\u5bc6\u7801\u63d0\u51fa\u5904\u7406\n\nuser=$(awk -F: '/bash$/{print $1}' /etc/passwd)\nfor i in $user\ndo\n  awk -F: -v x=$i '$1==x{print $1,$2}' /etc/shadow\ndone\n</code></pre>"},{"location":"chap8/8secret_shell/#10etcpasswd-root","title":"10\u3001\u7edf\u8ba1<code>/etc/passwd</code> \u4e2d root \u51fa\u73b0\u7684\u6b21\u6570","text":"<pre><code>!/bin/bash\n\n# \u7edf\u8ba1/etc/passwd \u4e2d root \u51fa\u73b0\u7684\u6b21\u6570 \n\n#\u6bcf\u8bfb\u53d6\u4e00\u884c\u6587\u4ef6\u5185\u5bb9,\u5373\u4ece\u7b2c 1 \u5217\u5faa\u73af\u5230\u6700\u540e 1 \u5217,\u4f9d\u6b21\u5224\u65ad\u662f\u5426\u5305\u542b root \u5173\u952e\u8bcd,\u5982\u679c\u5305\u542b\u5219 x++\nawk -F: '{i=1;while(i&lt;=NF){if($i~/root/){x++};i++}} END{print \"root \u51fa\u73b0\u6b21\u6570\u4e3a\"x}' /etc/passwd\n</code></pre>"},{"location":"chap8/8secret_shell/#11","title":"11 \u751f\u6210\u7b7e\u540d\u79c1\u94a5\u548c\u8bc1\u4e66","text":"<pre><code>#!/bin/bash\n\n# \u751f\u6210\u7b7e\u540d\u79c1\u94a5\u548c\u8bc1\u4e66 \n\nread -p \"\u8bf7\u8f93\u5165\u5b58\u653e\u8bc1\u4e66\u7684\u76ee\u5f55:\" dir\nif [ ! -d $dir ];then\n  echo \"\u8be5\u76ee\u5f55\u4e0d\u5b58\u5728\"\n  exit\nfi\nread -p \"\u8bf7\u8f93\u5165\u5bc6\u94a5\u540d\u79f0:\" name\n# \u4f7f\u7528 openssl \u751f\u6210\u79c1\u94a5\nopenssl genrsa -out ${dir}/${name}.key\n# \u4f7f\u7528 openssl \u751f\u6210\u8bc1\u4e66 #subj \u9009\u9879\u53ef\u4ee5\u5728\u751f\u6210\u8bc1\u4e66\u65f6,\u975e\u4ea4\u4e92\u81ea\u52a8\u586b\u5199 Common Name \u4fe1\u606f\nopenssl req -new -x509 -key ${dir}/${name}.key -subj \"/CN=common\" -out ${dir}/${name}.crt\n</code></pre>"},{"location":"chap8/9script_shell/","title":"Linux script \u5f55\u64ad","text":""},{"location":"chap8/9script_shell/#_1","title":"\u5f55\u64ad\u5c4f\u5e55\u64cd\u4f5c","text":"<p>\u5f55\u5236</p> <pre><code>script -t 2&gt;time.file -a scriptfile\n</code></pre> <p>\u6267\u884c\u5b8c\u8fd9\u4e2a\u547d\u4ee4\uff0c\u63a5\u4e0b\u6765\u7684\u4efb\u4f55\u64cd\u4f5c\u90fd\u4f1a\u88ab\u8bb0\u5f55\u3002 \u5176\u4e2d\u7684<code>time.file</code>\u662f\u65f6\u5e8f\u8bb0\u5f55\u6587\u4ef6\uff0c\u8bb0\u5f55\u4e86\u51e0\u79d2\u6267\u884c\u7684\u547d\u4ee4\uff1b</p> <p><code>scriptfile</code>\u662f\u547d\u4ee4\u6267\u884c\u8bb0\u5f55\u6587\u4ef6\uff0c\u8bb0\u5f55\u4e0b\u6267\u884c\u662f\u54ea\u4e9b\u547d\u4ee4\uff0c\u8fd9\u4e24\u4e2a\u6587\u4ef6\u540d\u79f0\u90fd\u53ef\u4ee5\u81ea\u5b9a\u4e49\u3002</p> <p>\u52a0\u4e0a<code>-q,</code> <code>--quiet</code> \u53c2\u6570\u53ef\u4ee5\u4f7fscript\u547d\u4ee4\u4ee5\u9759\u9ed8\u6a21\u5f0f\u8fd0\u884c\uff0c\u4e0d\u663e\u793ascript\u542f\u52a8\u548cexit\u7684\u547d\u4ee4\uff0c\u7528\u6237\u53ef\u4ee5\u5b8c\u5168\u5bdf\u89c9\u4e0d\u5230\u5728\u5f55\u5c4f\u3002</p> <pre><code>script -q -t 2&gt;time.file -a scriptfile\n</code></pre> <p>\u8981\u505c\u4e0b\u6765\uff0c\u53ea\u7528\u6309\u4e0b\u6309\u4e0b\u7ec4\u5408\u952e Ctrl+D \u7ed3\u675f\u5f55\u5236\uff0c\u6267\u884cexit\u547d\u4ee4\u4e5f\u884c\u3002</p> <pre><code>$ exit\n</code></pre> <p>\u6709\u5f55\u5236\u5c31\u6709\u64ad\u653e\uff0c\u5c31\u50cf\u5f55\u89c6\u9891\u4e00\u6837\uff0c\u6267\u884c\u4e0b\u9762\u8fd9\u4e2a\u547d\u4ee4\u5373\u53ef\uff0c\u65f6\u5e8f\u6587\u4ef6\u5728\u524d\uff0c\u547d\u4ee4\u6587\u4ef6\u5728\u540e</p> <pre><code>scriptreplay time.file scriptfile\n</code></pre> <p>\u6dfb\u52a0\u8fd9\u4e2a\u53c2\u6570<code>-d</code>, <code>\u2013divisor number</code>\u53ef\u4ee5\u8c03\u6574\u64ad\u653e\u901f\u5ea6\u7684\u500d\u6570\uff08\u53ef\u4ee5\u662f\u5c0f\u6570\uff1a\u653e\u6162\uff09\u3002</p> <p><code>scriptfile</code> \u6587\u4ef6\u8bb0\u5f55\u4e86\u6211\u6bcf\u95f4\u96941\u79d2\u6267\u884c\u4e00\u4e2adate\u547d\u4ee4\u7684\u64cd\u4f5c\uff0c\u73b0\u5728\u52a0\u901f10\u500d\u6765\u64ad\u653e\u770b\u770b\u6548\u679c\uff08\u53ef\u60dc\u6709\u7684\u7248\u672c<code>scriptreplay</code>\u547d\u4ee4\u6ca1\u6709<code>-d</code>\u8fd9\u4e2a\u53c2\u6570\uff09\uff1a</p> <p></p>"},{"location":"chap8/9script_shell/#_2","title":"\u540c\u6b65\u6f14\u793a","text":"<p><code>-f,</code> <code>--flush</code> \u6bcf\u6b21\u64cd\u4f5c\u540e\u90fd\u7acb\u5373\u5237\u65b0\u7f13\u5b58\u3002 \u5982\u679c\u4e0d\u8bbe\u7f6e\u8fd9\u4e2a\u9009\u9879\uff0c\u5219\u4e0d\u4f1a\u5b9e\u65f6\u5199\u5165\u6587\u4ef6\uff0c\u8fd9\u4e2a\u529f\u80fd</p> <p>\u4f7f\u7528\u7aef:</p> <pre><code>script -f demo\n</code></pre> <p>\u6f14\u793a\u7aef\uff1a</p> <pre><code>scriptreplay -f demo\n</code></pre> <p></p>"},{"location":"chap8/9script_shell/#_3","title":"\u5f55\u5236\u811a\u672c\u6267\u884c\u8fc7\u7a0b","text":"<p>\u53c2\u6570<code>-c</code>, <code>- -command</code> \u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u547d\u4ee4\uff0c\u800c\u975e\u662f\u4ea4\u4e92\u5f0f\u7684shell\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f20\u5165\u4e00\u4e2a\u811a\u672c\uff0c\u50cf\u8fd9\u6837\uff1a</p> <pre><code>$ script -qa \"file.out\" -c \"/root/hello.sh\" \n123\n234\n345\n$ cat file.out \nScript started on Fri 28 Jun 2019 07:38:55 PM CST\n123\n234\n345\n</code></pre>"},{"location":"chap8/9script_shell/#_4","title":"\u81ea\u52a8\u89e6\u53d1\u76d1\u63a7\u7528\u6237\u767b\u9646\u7684\u64cd\u4f5c\u4e0e\u5b9e\u65f6\u76d1\u63a7","text":"<p>\u6709\u65f6\u5019\u67d0\u4e2a\u4eba\u5077\u5077\u8fdc\u7a0b\u8bbf\u95ee\u4e86\u4f60\u7684\u7cfb\u7edf\uff0c\u6216\u8005\u8fd0\u7ef4\u4eba\u5458\u8fdc\u7a0b\u64cd\u4f5c\u4e86\u4e00\u4e9b\u4e1c\u897f\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u81ea\u52a8\u8bb0\u5f55\u4e0b\u8fd9\u4e2a\u4eba\u5728\u7cfb\u7edf\u4e0a\u505a\u4e86\u4ec0\u4e48\u4e8b\u60c5</p> <p>\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ea\u8981\u8ba9script\u547d\u4ee4\u5728\u767b\u5f55\u65f6\u81ea\u52a8\u8fd0\u884c\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u6dfb\u52a0\u8fdbshell\u73af\u5883\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002</p> <p>\u8fd9\u6837\u5728\u51fa\u73b0\u4ec0\u4e48\u8bef\u64cd\u4f5c\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5728\u6392\u67e5\u7684\u65f6\u5019\u67e5\u5230\u5386\u53f2\u8bb0\u5f55\u3002</p> <pre><code>mkdir -p /var/log/user_record\nvi /etc/profile\n</code></pre> <p>\u5728\u6587\u4ef6\u672b\u5c3e\u8ffd\u52a0</p> <pre><code># \u6dfb\u52a0\u767b\u9646\u65f6\u81ea\u52a8\u8bb0\u5f55\nscript -t -f -q 2&gt;/var/log/user_record/$USER-$UID-`date +%Y%m%d%H%M%S`.time -a /var/log/user_record/$USER-$UID-`date +%Y%m%d%H%M%S`.his\nif [ \"$SHLVL\" = 1 ]; then\n   exit\nfi\n</code></pre> <p>\u5728\u8fd9\u91cc\u6211\u5df2\u7ecf\u63d0\u524d\u6dfb\u52a0\u5230\u811a\u672c\u91cc\u4e86\uff0c\u540e\u8fb9\u662f\u76d1\u63a7\u7aef\uff0c\u89c1\u6f14\u793a</p> <p></p>"},{"location":"chap9/1bash_prom/","title":"1 \u7b80\u6d01\u7684 Bash Programming \u6280\u5de7","text":""},{"location":"chap9/1bash_prom/#1","title":"1. \u68c0\u67e5\u547d\u4ee4\u6267\u884c\u662f\u5426\u6210\u529f","text":"<p>\u7b2c\u4e00\u79cd\u5199\u6cd5\uff0c\u6bd4\u8f83\u5e38\u89c1\uff1a</p> <pre><code>echo abcdee | grep -q abcd\n\nif [ $? -eq 0 ]; then\n    echo \"Found\"\nelse\n    echo \"Not found\"\nfi\n</code></pre> <p>\u7b80\u6d01\u7684\u5199\u6cd5\uff1a</p> <pre><code>if echo abcdee | grep -q abc; then\n    echo \"Found\"\nelse\n    echo \"Not found\"\nfi\n</code></pre> <p>\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u4e0d\u8981if/else,\u4e0d\u8fc7\u8fd9\u6837\u53ef\u8bfb\u6027\u6bd4\u8f83\u5dee:</p> <pre><code>$ echo abcdee | grep -q abc &amp;&amp; echo \"Found\" || echo \"Not found\"\nFound\n</code></pre>"},{"location":"chap9/1bash_prom/#2-devnull","title":"2. \u5c06\u6807\u51c6\u8f93\u51fa\u4e0e\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230<code>/dev/null</code>","text":"<p>\u7b2c\u4e00\u79cd\u5199\u6cd5\uff0c\u6bd4\u8f83\u5e38\u89c1\uff1a</p> <pre><code>grep \"abc\" test.txt 1&gt;/dev/null 2&gt;&amp;1\n</code></pre> <p>\u5e38\u89c1\u7684\u9519\u8bef\u5199\u6cd5\uff1a</p> <pre><code>grep \"abc\" test.txt 2&gt;&amp;1 1&gt;/dev/null\n</code></pre> <p>\u7b80\u6d01\u7684\u5199\u6cd5\uff1a</p> <pre><code>grep \"abc\" test.txt &amp;&gt; /dev/null\n</code></pre>"},{"location":"chap9/1bash_prom/#3-awk","title":"3. awk\u7684\u4f7f\u7528","text":"<p>\u4e3e\u4e00\u4e2a\u5b9e\u9645\u7684\u4f8b\u5b50\uff0c\u83b7\u53d6Xen DomU\u7684id\u3002</p> <p>\u5e38\u89c1\u7684\u5199\u6cd5\uff1a</p> <pre><code>sudo xm li | grep vm_name | awk '{print $2}'\n</code></pre> <p>\u7b80\u6d01\u7684\u5199\u6cd5\uff1a</p> <pre><code>sudo xm li | awk '/vm_name/{print $2}'\n</code></pre>"},{"location":"chap9/1bash_prom/#4","title":"4. \u5c06\u4e00\u4e2a\u6587\u672c\u7684\u6240\u6709\u884c\u7528\u9017\u53f7\u8fde\u63a5\u8d77\u6765","text":"<p>\u5047\u8bbe\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\u6240\u793a:</p> <pre><code>$ cat /tmp/test.txt \n1\n2\n3\n</code></pre> <p>\u4f7f\u7528Sed\u547d\u4ee4\uff1a</p> <pre><code>$ sed ':a;$!N;s/\\n/,/;ta' /tmp/test.txt \n1,2,3\n</code></pre> <p>\u7b80\u6d01\u7684\u5199\u6cd5\uff1a</p> <pre><code>$ paste -sd, /tmp/test.txt \n1,2,3\n</code></pre>"},{"location":"chap9/1bash_prom/#5","title":"5. \u8fc7\u6ee4\u91cd\u590d\u884c","text":"<p>\u5047\u8bbe\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>$ sort /tmp/test.txt \n1\n1\n2\n3\n</code></pre> <p>\u5e38\u7528\u7684\u65b9\u6cd5\uff1a</p> <pre><code>$ sort /tmp/test.txt | uniq\n1\n2\n3\n</code></pre>"},{"location":"chap9/1bash_prom/#6-grep","title":"6. grep\u67e5\u627e\u5355\u8bcd","text":"<p>\u5047\u8bbe\u4e00\u4e2a\u6587\u672c\u7684\u6bcf\u4e00\u884c\u662f\u4e00\u4e2aip\u5730\u5740\uff0c\u4f8b\u5982</p> <pre><code>$ cat /tmp/ip.list \n10.0.0.1\n10.0.0.12\n10.0.0.123\n</code></pre> <p>\u4f7f\u7528grep\u67e5\u627e\u662f\u5426\u5305\u62ec<code>10.0.0.1</code>\u8fd9\u4e2aip\u5730\u5740\u3002\u5e38\u89c1\u7684\u5199\u6cd5\uff1a</p> <pre><code>$ grep '10.0.0.1\\&gt;' /tmp/ip.list \n10.0.0.1\n</code></pre> <p>\u7b80\u5355\u7684\u65b9\u6cd5\uff08\u5176\u5b9e\u8fd9\u65b9\u6cd5\u4e0d\u89c1\u5f97\u7b80\u5355\uff0c\u53ea\u662f\u4e3a\u4e86\u8bf4\u660e-w\u8fd9\u4e2a\u53c2\u6570\u8fd8\u662f\u5f88\u6709\u7528\u7684)</p> <pre><code>$ grep -w '10.0.0.1' /tmp/ip.list \n10.0.0.1\n</code></pre> <p>\u987a\u4fbfgrep\u7684<code>-n/-H/-v/-f/-c</code>\u8fd9\u51e0\u53c2\u6570\u90fd\u5f88\u6709\u7528\u3002</p>"},{"location":"chap9/1bash_prom/#7","title":"7. \u4e34\u65f6\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf","text":"<p>\u5e38\u89c1\u7684\u5199\u6cd5\uff1a</p> <pre><code>$ export LC_ALL=zh_CN.UTF-8 \n\n\n$ date\n2012\u5e74 11\u6708 03\u65e5 \u661f\u671f\u516d 22:26:55 CST\n</code></pre> <p>\u7b80\u6d01\u7684\u5199\u6cd5:</p> <pre><code>$ unset LC_ALL\n\n$ LC_ALL=zh_CN.UTF-8 date \n2012\u5e74 11\u6708 03\u65e5 \u661f\u671f\u516d 22:27:43 CST\n</code></pre> <p>\u5728\u547d\u4ee4\u4e4b\u524d\u52a0\u4e0a\u73af\u5883\u53d8\u66f4\u7684\u8bbe\u7f6e\uff0c\u53ea\u662f\u4e34\u65f6\u6539\u53d8\u5f53\u524d\u6267\u884c\u547d\u4ee4\u7684\u73af\u5883\u3002</p>"},{"location":"chap9/1bash_prom/#8-12","title":"8. <code>$1,$2</code>...\u7b49\u4f4d\u7f6e\u53c2\u6570\u7684\u4f7f\u7528","text":"<p>\u5047\u8bbe\u53ea\u60f3\u4f7f\u7528<code>$2,$3</code>..\u8fd9\u51e0\u4e2a\u53c2\u6570\uff0c\u5e38\u89c1\u7684\u505a\u6cd5\u662f:</p> <pre><code>shift\necho \"$@\"\n</code></pre> <p>\u4e3a\u4ec0\u4e48\u4e0d\u8fd9\u6837\u5199\u5462\uff1f</p> <pre><code>echo \"${@:2}\"\n</code></pre>"},{"location":"chap9/1bash_prom/#9","title":"9. \u9000\u800c\u6c42\u5176\u6b21\u7684\u5199\u6cd5","text":"<p>\u76f8\u4fe1\u5927\u5bb6\u4f1a\u6709\u8fd9\u79cd\u9700\u6c42\uff0c\u5f53\u4e00\u4e2a\u53c2\u6570\u503c\u6ca1\u6709\u63d0\u4f9b\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u9ed8\u8ba4\u503c\u3002\u5e38\u89c1\u7684\u5199\u6cd5\u662f\uff1a</p> <pre><code>arg=$1\n\nif [ -z \"$arg\" ]; then\n   arg=0\nfi\n</code></pre> <p>\u7b80\u6d01\u7684\u5199\u6cd5\u662f\u8fd9\u6837\u7684:</p> <pre><code>arg=${1:-0}\n</code></pre>"},{"location":"chap9/1bash_prom/#10-bash-","title":"10. bash\u7279\u6b8a\u53c2\u6570--\u7684\u7528\u6cd5","text":"<p>\u5047\u8bbe\u8981\u7528grep\u67e5\u627e\u5b57\u7b26\u4e32\u4e2d\u662f\u5426\u5305\u542b<code>-i</code>\uff0c\u6211\u4eec\u4f1a\u8fd9\u6837\u5c1d\u8bd5\uff1a</p> <pre><code>$ echo 'abc-i' | grep \"-i\"\nUsage: grep [OPTION]... PATTERN [FILE]...\nTry 'grep --help' for more information.\n\n$ echo 'abc-i' | grep \"\\-i\"\nabc-i\n</code></pre> <p>\u7b80\u6d01\u7684\u65b9\u6cd5\u662f\uff1a</p> <pre><code>$ echo 'abc-i' | grep -- -i\nabc-i\n</code></pre> <p>bash\u4e2d--\u540e\u9762\u7684\u53c2\u6570\u4e0d\u4f1a\u88ab\u5f53\u4f5c\u9009\u9879\u89e3\u6790\u3002</p>"},{"location":"chap9/1bash_prom/#11","title":"11. \u51fd\u6570\u7684\u8fd4\u56de\u503c\u9ed8\u8ba4\u662f\u6700\u540e\u4e00\u884c\u8bed\u53e5\u7684\u8fd4\u56de\u503c","text":"<pre><code># Check whether an item is a function\n# $1: the function name\n# Return: 0(yes) or 1(no)\nfunction is_function()\n{\n    local func_name=$1\n    test \"`type -t $1 2&gt;/dev/null`\" = \"function\"\n}\n</code></pre> <p>\u4e0d\u8981\u753b\u86c7\u6dfb\u8db3\u518d\u5728\u540e\u9762\u52a0\u4e00\u884c<code>return $?</code>\u4e86\u3002</p>"},{"location":"chap9/1bash_prom/#12-printf","title":"12. \u5c06printf\u683c\u5f0f\u5316\u7684\u7ed3\u679c\u8d4b\u503c\u7ed9\u53d8\u91cf","text":"<p>\u4f8b\u5982\u5c06\u6570\u5b57\u8f6c\u6362\u6210\u5176\u5341\u516d\u8fdb\u5236\u5f62\u5f0f\uff0c\u5e38\u89c1\u7684\u5199\u6cd5\u662f\uff1a</p> <pre><code>$ var=$(printf '%%%02x' 111)\n</code></pre> <p>\u7b80\u5355\u7684\u5199\u6cd5\u662f\uff1a</p> <pre><code>$ printf -v var '%%%02x' 111 \n</code></pre> <p>\u770b\u770bprintf\u7684help\uff1a</p> <pre><code>$ help printf | grep -A 1 -B 1 -- -v\nprintf: printf [-v var] format [arguments]\n    Formats and prints ARGUMENTS under control of the FORMAT.\n--\n    Options:\n      -v var    assign the output to shell variable VAR rather than\n            display it on the standard output\n</code></pre>"},{"location":"chap9/1bash_prom/#13","title":"13. \u6253\u5370\u6587\u4ef6\u884c","text":"<p>\u6253\u5370\u6587\u4ef6\u7684\u7b2c\u4e00\u884c\uff1a</p> <pre><code>head -1 test.txt\n</code></pre> <p>\u6253\u5370\u6587\u4ef6\u7684\u7b2c2\u884c\uff1a</p> <pre><code>sed -n '2p' test.txt\n</code></pre> <p>\u6253\u5370\u6587\u4ef6\u7684\u7b2c2\u52305\u884c\uff1a</p> <pre><code>sed -n '2,5p' test.txt\n</code></pre> <p>\u6253\u5370\u6587\u4ef6\u7684\u7b2c2\u884c\u59cb\uff08\u5305\u62ec\u7b2c2\u884c\u5728\u5185\uff095\u884c\u7684\u5185\u5bb9\uff1a</p> <pre><code>sed -n '2,+4p' test.txt\n</code></pre> <p>\u6253\u5370\u5012\u6570\u7b2c\u4e8c\u884c\uff1a</p> <pre><code>$ tail -2 test.txt | head -1\n$ tac test.txt | sed -n '2p'\n</code></pre>"},{"location":"chap9/1bash_prom/#14let","title":"14.\u5584\u7528let\u6216\u8005(())\u547d\u4ee4\u505a\u7b97\u672f\u8fd0\u7b97","text":"<p>\u5982\u4f55\u5bf9\u4e00\u4e2a\u6570\u5b57\u505a++\u8fd0\u7b97\uff0c\u53ef\u80fd\u4f60\u4f1a\u8fd9\u6837\u7528\uff1a</p> <pre><code>a=1\na=`expr a + 1`\n</code></pre> <p>\u4e3a\u4f55\u4e0d\u7528\u4f60\u719f\u6089\u7684:</p> <pre><code>a=1\nlet a++\nlet a+=2\n</code></pre>"},{"location":"chap9/1bash_prom/#15","title":"15. \u83b7\u53d6\u8f6f\u8fde\u63a5\u6307\u5b9a\u7684\u771f\u5b9e\u6587\u4ef6\u540d","text":"<p>\u5982\u679c\u4f60\u4e0d\u77e5\u9053\uff0c\u4f60\u53ef\u80fd\u4f1a\u8fd9\u6837\u83b7\u53d6\uff1a</p> <pre><code>$ ls -l /usr/bin/python | awk -F'-&gt;' '{print $2}' | tr -d ' '\n/usr/bin/python2\n</code></pre> <p>\u5982\u679c\u4f60\u77e5\u9053\u6709\u4e00\u4e2a\u53ebreadlink\u7684\u547d\u4ee4\uff0c\u90a3\u4e48\uff1a</p> <pre><code>$ readlink /usr/bin/python\n/usr/bin/python2\n</code></pre>"},{"location":"chap9/1bash_prom/#16-ascii","title":"16. \u83b7\u53d6\u4e00\u4e2a\u5b57\u7b26\u7684ASCII\u7801","text":"<pre><code>$ printf '%02x' \"'+\"\n2b\n\n$ echo -n '+' | od -tx1 -An | tr -d ' '\n2b\n</code></pre>"},{"location":"chap9/1bash_prom/#17","title":"17. \u6e05\u7a7a\u4e00\u4e2a\u6587\u4ef6","text":"<p>\u5e38\u89c1\u7684\u7528\u6cd5:</p> <pre><code>echo \"\" &gt; test.txt\n</code></pre> <p>\u7b80\u5355\u7684\u5199\u6cd5\uff1a</p> <pre><code>&gt; test.txt\n</code></pre>"},{"location":"chap9/1bash_prom/#18-here-document","title":"18 \u4e0d\u8981\u5fd8\u8bb0\u6709here document","text":"<p>\u4e0b\u9762\u4e00\u6bb5\u4ee3\u7801\uff1a</p> <pre><code>grep -v 1 /tmp/test.txt | while read line; do\n    let a++\n    echo --$line--\ndone\n\necho a:$a\n</code></pre> <p>\u6267\u884c\u540e\u6709\u4ec0\u4e48\u95ee\u9898\u5417\uff1f</p> <pre><code>$ sh test.sh \n--2--\n--3--\na:\n</code></pre> <p>\u53d1\u73b0a\u8fd9\u4e2a\u53d8\u91cf\u6ca1\u6709\u88ab\u8d4b\u503c\uff0c\u4e3a\u4ec0\u4e48\u5462\uff1f\u56e0\u4e3a\u7ba1\u9053\u540e\u9762\u7684\u4ee3\u7801\u662f\u5728\u5728\u4e00\u4e2a\u5b50shell\u4e2d\u6267\u884c\u7684\uff0c\u6240\u505a\u7684\u4efb\u4f55\u66f4\u6539\u90fd\u4e0d\u4f1a\u5bf9\u5f53\u524dshell\u6709\u5f71\u54cd\uff0c\u81ea\u7136a\u8fd9\u4e2a\u53d8\u91cf\u5c31\u4e0d\u4f1a\u6709\u8d4b\u503c\u4e86\u3002</p> <p>\u6362\u4e00\u79cd\u601d\u8def\uff0c\u53ef\u4ee5\u8fd9\u6837\u505a\uff1a</p> <pre><code>grep -v 1 /tmp/test.txt &gt; /tmp/test.tmp\n\nwhile read line; do\n    let a++\n    echo --$line--\ndone &lt; /tmp/test.tmp\n\necho a:$a\nrm -f /tmp/test.tmp\n</code></pre> <p>\u4e0d\u8fc7\u591a\u4e86\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6\uff0c\u6700\u540e\u8fd8\u8981\u5220\u9664\u3002\u8fd9\u91cc\u5176\u5b9e\u53ef\u4ee5\u7528\u5230here document\uff1a</p> <pre><code>while read line2; do\n    let b++\n    echo ??$line2??\ndone &lt;&lt; EOF\n`grep -v 1 /tmp/test.txt`\nEOF\n\necho b: $b\n</code></pre> <p>here document\u5f80\u5f80\u7528\u4e8e\u9700\u8981\u8f93\u51fa\u4e00\u5927\u6bb5\u6587\u672c\u7684\u5730\u65b9\uff0c\u4f8b\u5982\u811a\u672c\u7684help\u51fd\u6570\u3002</p>"},{"location":"chap9/1bash_prom/#19","title":"19.\u5220\u9664\u5b57\u7b26\u4e32\u4e2d\u7684\u7b2c\u4e00\u4e2a\u6216\u8005\u6700\u540e\u4e00\u4e2a\u5b57\u7b26","text":"<p>\u5047\u8bbe\u5b57\u7b26\u4e32\u4e3a\uff1a</p> <pre><code>$ str=\"aremoveb\"\n</code></pre> <p>\u53ef\u80fd\u4f60\u7b2c\u4e00\u4e2a\u60f3\u6cd5\u662f\u901a\u8fc7sed\u6216\u8005\u5176\u5b83\u547d\u4ee4\u6765\u5b8c\u6210\u8fd9\u4e2a\u529f\u80fd\uff0c\u4f46\u662f\u5176\u5b9e\u6709\u5f88\u7b80\u5355\u7684\u65b9\u6cd5\uff1a</p> <pre><code>$ echo \"${str#?}\"\nremoveb\n\n$ echo \"${str%?}\"\naremove\n</code></pre> <p>\u7c7b\u4f3c\u5730\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5220\u96642\u4e2a\u30013\u4e2a\u30014\u4e2a\u2026\u2026</p> <p>\u6709\u6ca1\u6709\u4e00\u6b21\u6027\u5220\u9664\u7b2c\u4e00\u4e2a\u548c\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u7684\u65b9\u6cd5\u5462\uff1f\u7b54\u6848\u5f53\u7136\u662f\u80af\u5b9a\u7684\uff1a</p> <pre><code>$ echo \"${str:1:-1}\"\nremove\n</code></pre>"},{"location":"chap9/1bash_prom/#20-join","title":"20. \u4f7f\u7528\u9017\u53f7join\u6570\u7ec4\u5143\u7d20","text":"<p>\u5047\u8bbe\u6570\u7ec4\u5143\u7d20\u6ca1\u6709\u7a7a\u683c\uff0c\u53ef\u4ee5\u7528\u8fd9\u79cd\u65b9\u6cd5\uff1a</p> <pre><code>$ a=(1 2 3) \n$ b=\"${a[*]}\"\n\n$ echo ${b// /,}\n1,2,3\n</code></pre> <p>\u6ce8\u610f\uff1a\u5f53\u8be5\u6570\u7ec4\u7684\u957f\u5ea6\u975e\u5e38\u957f\u65f6\uff0c\u4f7f\u7528\u8fd9\u79cd\u66ff\u6362\u7684\u65f6\u95f4\u5f00\u9500\u5f88\u9ad8\uff0c\u6027\u80fd\u5f88\u5dee\uff0c\u63a8\u8350\u7528sed\u3002</p> <p>\u5047\u8bbe\u6570\u7ec4\u5143\u7d20\u5305\u542b\u6709\u7a7a\u683c\uff0c\u53ef\u4ee5\u501f\u7528printf\u547d\u4ee4\u6765\u8fbe\u5230\uff1a</p> <pre><code>$ a=(1 \"2 3\" 4)\n\n$ printf \",%s\" \"${a[@]}\" | cut -c2-   \n1,2 3,4\n</code></pre>"},{"location":"chap9/1bash_prom/#21-shell","title":"21. Shell\u4e2d\u7684\u591a\u8fdb\u7a0b","text":"<p>\u5728\u547d\u4ee4\u884c\u4e0b\uff0c\u6211\u4eec\u4f1a\u5728\u547d\u4ee4\u884c\u540e\u9762\u52a0\u4e0a&amp;\u7b26\u53f7\u6765\u8ba9\u8be5\u547d\u4ee4\u5728\u540e\u53f0\u6267\u884c\uff0c\u5728shell\u811a\u672c\u4e2d\uff0c\u4f7f\u7528\"(cmd)\"\u53ef\u4ee5\u8ba9fork\u4e00\u4e2a\u5b50shell\u6765\u6267\u884c\u8be5\u547d\u4ee4\u3002\u5229\u7528\u8fd9\u4e24\u70b9\uff0c\u53ef\u4ee5\u5b9e\u73b0shell\u7684\u591a\u7ebf\u7a0b\uff1a</p> <pre><code>job_num=10\n\nfunction do_work()\n{\n    echo \"Do work..\"\n}\n\nfor ((i=0; i &lt; job_num ;i++)); do\n    echo \"Fork job $i\"\n    (do_work) &amp;\ndone\n\nwait   # wait for all job done\necho \"All job have been done!\"\n</code></pre> <p>\u6ce8\u610f\u6700\u540e\u7684wait\u547d\u4ee4\uff0c\u4f5c\u7528\u662f\u7b49\u5f85\u6240\u6709\u5b50\u8fdb\u7a0b\u7ed3\u675f\u3002</p> <p>\u9644\u51e0\u5219\u5c0f\u6280\u5de7\uff1a</p> <pre><code>1\uff09sudo iptables -L -n | vim -\n2\uff09grep -v xxx | vim -\n3\uff09echo $'\\''\n4\uff09set -- 1 2 3; echo \"$@\"\n5\uff09\u641c\u7d22stackoverflow/superuser\u7b49\u7ad9\u70b9\n6\uff09VIM\u7f16\u8f91\u8fdc\u7a0b\u6587\u4ef6 vim scp://xxx//etc/vimrc\n7\uff09\u8fdc\u7a0b\u6267\u884c\u811a\u672c ssh xxx bash &lt; xxx.sh\n</code></pre>"},{"location":"chap9/2bash_skill/","title":"2 \u7b80\u6d01\u7684 Bash Programming \u6280\u5de7\u7eed\u7bc7","text":""},{"location":"chap9/2bash_skill/#1-bashalias","title":"1. bash\u4e2dalias\u7684\u4f7f\u7528","text":"<p>alias\u5176\u5b9e\u662f\u7ed9\u5e38\u7528\u7684\u547d\u4ee4\u5b9a\u4e00\u4e2a\u522b\u540d\uff0c\u6bd4\u5982\u5f88\u591a\u4eba\u4f1a\u5b9a\u4e49\u4e00\u4e0b\u7684\u4e00\u4e2a\u522b\u540d\uff1a</p> <pre><code>alias ll='ls -l'\n</code></pre> <p>\u4ee5\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528ll\uff0c\u5b9e\u9645\u5c55\u5f00\u540e\u6267\u884c\u7684\u662f<code>ls -l</code>\u3002\u73b0\u5728\u5f88\u591a\u53d1\u884c\u7248\u90fd\u4f1a\u5e26\u51e0\u4e2a\u9ed8\u8ba4\u7684\u522b\u540d\uff0c\u6bd4\u5982\uff1a</p> <pre><code>alias grep='grep --color=auto'  # \u5e26\u989c\u8272\u663e\u793a\n\nalias ls='ls --color=auto' # \u540c\u4e0a\n\nalias rm='rm -i'  # \u5220\u9664\u6587\u4ef6\u9700\u8981\u786e\u8ba4\n</code></pre> <p>\u90a3\u4e48\u5982\u4f55\u4e0d\u8981\u5c55\u5f00alias\uff0c\u800c\u662f\u7528\u672c\u6765\u7684\u610f\u601d\u5462\uff1f\u7b54\u6848\u662f\u4f7f\u7528\u8f6c\u4e49\uff1a</p> <pre><code>\\ls\n\\grep\n</code></pre> <p>\u5728\u547d\u4ee4\u524d\u9762\u52a0\u4e00\u4e2a\u53cd\u659c\u6760\u540e\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u8fd9\u91cc\u8981\u63d2\u4e00\u6bb5\u6545\u4e8b\uff0c\u524d\u4e24\u5929\u6211\u5728shell\u811a\u672c\u4e2d\u5b9a\u4e49\u4e86\u4e0b\u9762\u7684\u4e00\u4e2aalias\uff0c\u5047\u8bbe\u4f4d\u4e8e\u6587\u4ef6<code>util.sh</code>\uff1a</p> <pre><code>#!/bin/bash\n...\nalias ssh='ssh -o StrictHostKeyChecking=no -o LogLevel=quiet -o BatchMode=yes'\n...\n</code></pre> <p>\u540e\u9762\u8fd9\u4e32ssh\u9009\u9879\u662f\u4e3a\u4e86\u53bb\u6389\u4e00\u4e9bwarning\u7684\u4fe1\u606f\uff0c\u4e0d\u63d0\u793a\u8f93\u5165\u5bc6\u7801\u7b49\u7b49\u3002</p> <p>\u5177\u4f53\u53ef\u4ee5\u770bssh\u7684\u6587\u6863\u8bf4\u660e\u3002\u6211\u81ea\u5df1\u6d4b\u8bd5\u7684\u65f6\u5019\u597d\u597d\u7684\uff0c\u5f53\u65f6\u6211\u540c\u4e8b\u8dd1\u5f97\u65f6\u5019\u5374\u4f9d\u7136\u6709\u62a5Warning\u3002\u6211\u5bf9\u6bd4\u4e86\u4e0b\u6211\u4eec\u4e24\u4e2a\u4eba\u7684\u7528\u6cd5\uff1a</p> <pre><code>sh util.sh  # \u6211\u7684\n./util.sh   # \u4ed6\u7684\n</code></pre> <p>\u4fee\u6539\u4e0butil.sh\uff0c\u6253\u5f00\u8fd9\u4e2a\u9009\u9879\u5c31Ok\u4e86\uff1a</p> <pre><code>#!/bin/bash\n...\n# Expand aliases in script\nshopt -s expand_aliases\nalias ssh='ssh -o StrictHostKeyChecking=no -o LogLevel=quiet -o BatchMode=yes'\n...\n</code></pre>"},{"location":"chap9/2bash_skill/#2-awk","title":"2. awk\u6253\u5370\u9664\u7b2c\u4e00\u5217\u4e4b\u5916\u7684\u5176\u4ed6\u5217","text":"<p>awk\u7528\u6765\u622a\u53d6\u8f93\u5165\u884c\u4e2d\u7684\u67d0\u51e0\u5217\u5f88\u6709\u7528\uff0c\u5f53\u65f6\u5982\u679c\u8981\u6392\u9664\u67d0\u51e0\u5217\u5462\uff1f</p> <p>\u4f8b\u5982\u6709\u5982\u4e0b\u7684\u4e00\u4e2a\u6587\u4ef6\uff1a</p> <pre><code>$ cat /tmp/test.txt\n1 2 3 4 5\n\n10 20 30 40 50\n</code></pre> <p>\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u4ee3\u7801\u89e3\u51b3\uff08\u6765\u6e90\uff09\uff1a</p> <pre><code>$ awk '{$1=\"\";print $0}' /tmp/test.txt\n\n 2 3 4 5\n 20 30 40 50\n</code></pre> <p>\u4f46\u662f\u524d\u9762\u591a\u4e86\u4e00\u4e2a\u7a7a\u683c\uff0c\u53ef\u4ee5\u7528cut\u547d\u4ee4\u7a0d\u5fae\u8c03\u6574\u4e0b\uff1a</p> <pre><code>$ awk '{$1=\"\";print $0}' /tmp/test.txt | cut -c2-\n2 3 4 5\n20 30 40 50\n</code></pre>"},{"location":"chap9/2bash_skill/#3-bash","title":"3. \u5de7\u7528bash\u7684\u547d\u4ee4\u5c55\u5f00\u529f\u80fd\u5907\u4efd\u6587\u4ef6","text":"<p>\u5047\u8bbe\u8981\u5907\u4efd\u6587\u4ef6<code>/your/path/to/file.list</code> \u4e3a <code>/your/path/to/file.list.20121106</code>\uff0c\u5e38\u89c4\u7684\u65b9\u6cd5\u662f\uff1a</p> <pre><code>cp /your/path/to/file.list /your/path/to/file.list.20121106\n</code></pre> <p>\u8fd9\u6837\u91cd\u590d\u5199\u4e0a\u4e00\u957f\u4e32\u7684\u8def\u5f84\uff0c\u662f\u4e0d\u662f\u5f88\u9ebb\u70e6\uff0c\u8fd9\u91cc\u5229\u7528bash\u7684\u5c55\u5f00\u7279\u6027\u53ef\u4ee5\u8fd9\u6837\u505a\uff1a</p> <pre><code>cp /your/path/to/file.list{,.20121106}\n</code></pre> <p><code>/your/path/to/file.list{,.20121106}</code> \u8fd9\u4e00\u90e8\u5206\u4f1a\u5c55\u5f00\u4e3a <code>/your/path/to/file.list</code> <code>/your/path/to/file.list.20121106</code> , \u518d\u5c06\u6b64\u4f20\u7ed9cp\u547d\u4ee4\uff0c\u5c31\u8fbe\u5230\u4e86\u4e0e\u524d\u9762\u540c\u6837\u7684\u6548\u679c\u3002\uff08\u601d\u8def\u540cls *\uff09\u3002\u5177\u4f53\u53ef\u4ee5man bash\u4e2d\u7684Brace Expansion\u8fd9\u4e00\u6bb5\u3002</p>"},{"location":"chap9/2bash_skill/#4-sed","title":"4. \u4f60\u77e5\u9053sed\u7684\u8fd9\u4e2a\u7279\u6027\u5417\uff1f","text":"<p>\u5047\u8bbe\u4e00\u4e2a\u6587\u4ef6\u7684\u6bcf\u4e00\u884c\u4e3a\u4e00\u4e2a\u8def\u5f84\uff1a</p> <pre><code>$ cat /tmp/test.txt\n/home/kodango/hello\n/home/kodango/hello/world\n/home/kodango/good\n/home/kodango/good/bye\n</code></pre> <p>\u73b0\u5728\u8981\u628a<code>/home/kodango/good</code>\u66ff\u6362\u6210/<code>home/kodango/bad</code>\uff0c\u666e\u901a\u7684\u4f5c\u6cd5\u662f\uff1a</p> <pre><code>$ sed -n 's/\\/home\\/kodango\\/good/\\/home\\/kodango\\/bye/p' /tmp/test.txt \n/home/kodango/bye\n/home/kodango/bye/bye\n</code></pre> <p>\u56e0\u4e3a\u8def\u5f84\u4e2d\u7684\u5206\u9694\u7b26\u4e0esed\u7684\u66ff\u6362\u547d\u4ee4\u7684\u5206\u9694\u7b26\u90fd\u662f'/'\uff0c\u6240\u4ee5\u9700\u8981\u8f6c\u4e49\uff0c\u975e\u5e38\u9ebb\u70e6\u3002\u5e78\u8fd0\u7684\u662f\uff0csed\u53ef\u4ee5\u66f4\u6539\u5206\u9694\u7b26\uff0c\u4f8b\u5982\u4f7f\u7528<code>#</code>\uff1a</p> <pre><code>$ sed -n 's#/home/kodango/good#/home/kodango/bad#p' /tmp/test.txt \n/home/kodango/bad\n/home/kodango/bad/bye\n</code></pre> <p>\u8865\u5145\uff0c\u5982\u679c\u662f\u5728\u5730\u5740\u5bf9\u4e2d\u4f7f\u7528\uff0c\u9996\u4e2a\u5206\u9694\u7b26\u524d\u9762\u8981\u52a0\u53cd\u659c\u6760\uff1a</p> <pre><code>$ sed -n '\\#/home/kodango/#p' /tmp/test.txt \n/home/kodango/hello\n/home/kodango/hello/world\n/home/kodango/good\n/home/kodango/good/bye\n</code></pre>"},{"location":"chap9/2bash_skill/#5-squeeze","title":"5 \u5408\u5e76\u8fde\u7eed\u91cd\u590d\u7684\u5b57\u7b26\uff08\u5373squeeze\u64cd\u4f5c\uff09","text":"<p>\u4f8b\u5982\u8981\u5408\u5e76\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\u8fde\u7eed\u7684\u591a\u4e2a\u7a7a\u683c\uff0c\u5047\u8bbe\u5b57\u7b26\u4e32\u4e3a'print hello, world'\u3002</p> <p>\u7b2c\u4e00\u79cd\u65b9\u6cd5\uff0c\u4f7f\u7528sed\u547d\u4ee4\uff0c\u626b\u63cf\u6574\u4e2a\u5b57\u7b26\u4e32\uff0c\u66ff\u63622\u4e2a\u4ee5\u4e0a\u7684\u7a7a\u683c\u4e3a1\u683c\uff1a</p> <pre><code>$ echo 'print  hello,   world  ' | sed -r 's/ {2,}/ /g'\nprint hello, world \n</code></pre> <p>\u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff0c\u4f7f\u7528tr\u547d\u4ee4\u7684-s\u9009\u9879\uff0c\u4e13\u95e8\u5c31\u662f\u4e3a\u4e86\u5408\u5e76\u8fde\u7eed\u91cd\u590d\u7684\u5b57\u7b26\uff1a</p> <pre><code>$ echo 'print  hello,   world  ' | tr -s ' '\nprint hello, world \n</code></pre> <p>\u7b2c\u4e09\u79cd\u65b9\u6cd5\uff0c\u4f7f\u7528awk\u7684\u57df\u8d4b\u503c\u6765\u5b8c\u6210\u8be5\u76ee\u7684\uff1a</p> <pre><code>$ echo 'print  hello,   world  ' | awk '$1=$1'\nprint hello, world\n</code></pre> <p>\u5bf9\u5df2\u7ecf\u5b58\u5728\u7684\u57df\u4f8b\u5982<code>$1,$2.</code>.\u8fdb\u884c\u8d4b\u503c\uff0c\u4f1a\u5bfc\u81f4awk\u91cd\u65b0\u4f7f\u7528OFS\u8f93\u51fa\u5206\u9694\u7b26\u91cd\u7ec4<code>$0</code>\uff0c</p>"},{"location":"chap9/2bash_skill/#6","title":"6. \u5c06\u6587\u672c\u4e2d\u67d0\u5217\u76f8\u540c\u7684\u884c\u8f93\u51fa\u5230\u4e0d\u540c\u7684\u6587\u4ef6\u4e2d","text":"<p>\u6807\u9898\u6709\u70b9\u7ed5\u53e3\uff0c\u6211\u4eec\u4ee5\u5b9e\u9645\u4f8b\u5b50\u6765\u8bb2\u89e3\uff0c\u5047\u8bbe\u6211\u4eec\u6709\u4ee5\u4e0b\u7684\u4e00\u4e2a\u6587\u4ef6\uff1a</p> <pre><code>$ cat /tmp/test.txt\na char\n1 int\n2 int\nb char\nabc string\n</code></pre> <p>\u6211\u4eec\u7684\u76ee\u6807\u662f\u5c06\u8be5\u6587\u672c\u4e2d\u7684\u884c\u6309\u7b2c\u4e8c\u5217\u7684\u503c\u5f52\u7c7b\uff0c\u5e76\u4e14\u8f93\u51fa\u5230\u76f8\u5e94\u7684\u6587\u4ef6\u4e2d\uff0c\u6587\u4ef6\u540d\u4e3a\u7b2c\u4e8c\u5217\u7684\u540d\u79f0\u3002\u4f8b\u5982\u7b2c2\u884c\u3001\u7b2c3\u884c\u4f1a\u8f93\u51fa\u5230int.txt\u6587\u4ef6\u4e2d\uff0c\u800c\u7b2c1\u884c\u3001\u7b2c4\u884c\u5219\u8f93\u51fa\u5230char.txt\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</p> <p>\u6211\u6ca1\u6709\u627e\u5230\u5176\u5b83\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u53ea\u627e\u5230\u4e00\u79cd\u7528awk\u6765\u5904\u7406\u7684\u65b9\u6cd5\uff1a</p> <pre><code>$ awk '{print $1 &gt; $2 \".txt\"}' /tmp/test.txt\n</code></pre> <p>\u6211\u4eec\u6765\u68c0\u67e5\u7ed3\u679c\uff1a</p> <pre><code>$ grep -nH . *\nchar.txt:1:a\nchar.txt:2:b\nint.txt:1:1\nint.txt:2:2\nstring.txt:1:abc\n</code></pre>"},{"location":"chap9/2bash_skill/#7-exec","title":"7. \u7528exec\u547d\u4ee4\u6765\u5b8c\u6210\u91cd\u5b9a\u5411","text":"<p>\u4ee5\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u5f00\u59cb\uff0c\u73b0\u5728\u9700\u8981\u4e00\u4e2a\u811a\u672c\uff0c\u5b83\u53ef\u4ee5\u63a5\u53d7\u4e00\u4e2a\u6587\u4ef6\u540d\u4f5c\u4e3a\u53c2\u6570\uff0c\u7136\u540e\u6309\u884c\u8bfb\u53d6\u8be5\u6587\u4ef6\u7684\u5185\u5bb9\u5e76\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\u3002\u5982\u679c\u4e0d\u6307\u5b9a\u6587\u4ef6\u540d\uff0c\u5219\u9ed8\u8ba4\u4ece\u6807\u51c6\u8f93\u5165\u8bfb\u3002\u9996\u5148\u6309\u4e0a\u9762\u7684\u529f\u80fd\u9700\u6c42\u5199\u51fa\u4e00\u4e2a\u53ef\u4ee5\u5b8c\u6210\u529f\u80fd\u7684\u811a\u672c\uff1a</p> <pre><code>$ cat test.sh \n\nfilename=$1\n\nif [ -z \"$filename\" ]; then\n    while read line; do\n        echo $line\n    done\nelse\n    while read line; do\n        echo $line\n    done &lt; $filename\nfi\n</code></pre> <p>\u5982\u679c\u6362exec\u6765\u5b9e\u73b0\u91cd\u5b9a\u5411\uff0c\u53ef\u4ee5\u628a\u811a\u672c\u5199\u5f97\u66f4\u4f18\u96c5\uff1a</p> <pre><code>$ cat test1.sh \n\nfilename=$1\n\nif [ -n \"$filename\" ]; then\n    exec 0&lt; $filename\nfi\n\nwhile read line; do\n    echo $line\ndone\n</code></pre> <p>\u8fd9\u91cc\u7684\u5173\u952e\u5728\u7b2c5\u884c\u4ee3\u7801\uff0cexec\u547d\u4ee4\u4e0d\u4ec5\u53ef\u4ee5\u7528\u4e8e\u6267\u884c\u547d\u4ee4\uff0c\u8fd8\u53ef\u4ee5\u7528\u4e8e\u6253\u5f00\u3001\u5173\u95ed\u6216\u8005\u590d\u5236\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u8fd9\u91cc\u5c31\u662f\u5229\u7528exec\u5c06\u6307\u5b9a\u7684\u6587\u4ef6\u540d\u6253\u5f00\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u5165\u3002\u7c7b\u4f3c\u5730\u53ef\u4ee5\u7528<code>exec &gt;$filename</code>\u5c06\u6587\u4ef6\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa\u3002\u6211\u4eec\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u4e0a\u505a\u4e00\u4e2a\u8bd5\u9a8c\uff1a</p> <pre><code>$ exec 3&gt;&amp;1                   # \u9996\u5148\u5c06fd 3\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u4f5c\u4e3a\u6807\u51c6\u8f93\u51fa\u7684\u4e00\u4e2a\u5907\u4efd\n\n$ ls /proc/629/fd/{1,3} -l    # \u73b0\u5728fd 3\u548cfd 1\u6307\u5411\u540c\u4e00\u4e2a\u8bbe\u5907\u6587\u4ef6\nlrwx------ 1 kodango kodango 64 Nov 10 00:26 /proc/629/fd/1 -&gt; /dev/pts/1\nlrwx------ 1 kodango kodango 64 Nov 10 00:26 /proc/629/fd/3 -&gt; /dev/pts/1\n\n$ exec &gt;stdout               # \u73b0\u5728\u628a\u6807\u51c6\u8f93\u51fa\u91cd\u5b9a\u5411\u5230stdout\u8fd9\u4e2a\u6587\u4ef6\u4e2d\n\n$ ls /proc/629/fd/1 -l        # \u5982\u679c\u4f60\u6b64\u523b\u5728\u540c\u4e00\u4e2a\u7ec8\u7aef\u4e0b\u6267\u884c\u672c\u547d\u4ee4\u662f\u6ca1\u6709\u8fd4\u56de\u7684\n\n$ ls /proc/629/fd/1 -l        # \u73b0\u5728\u91cd\u65b0\u6253\u5f00\u4e00\u4e2a\u7ec8\u7aef\u770b\u770b\uff0c\u786e\u5b9e\u5df2\u7ecf\u91cd\u5b9a\u5411\u5230stdout\u8fd9\u4e2a\u6587\u4ef6\nl-wx------ 1 kodango kodango 64 Nov 10 00:26 /proc/629/fd/1 -&gt; /home/kodango/stdout\n\n$ exec 1&gt;&amp;3                   # \u73b0\u5728\u91cd\u65b0\u628a\u6807\u51c6\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e4b\u524d\u5907\u4efd\u7684fd 3\u4e0a\n$ ls /proc/629/fd/{1,3} -l  # \u73b0\u5728\u5c4f\u5e55\u53ef\u4ee5\u770b\u5230\u8f93\u51fa\u4e86\uff0c\u4f46\u662ffd 3\u8fd9\u4e2a\u63cf\u8ff0\u7b26\u8fd8\u6253\u5f00\uff0c\u9700\u8981\u5173\u95ed\nlrwx------ 1 kodango kodango 64 Nov 10 00:26 /proc/629/fd/1 -&gt; /dev/pts/1\nlrwx------ 1 kodango kodango 64 Nov 10 00:26 /proc/629/fd/3 -&gt; /dev/pts/1\n\n$ exec 3&gt;&amp;-                   # \u5173\u95edfd 3\n$ ls /proc/629/fd/3 -l\nls: cannot access /proc/629/fd/3: No such file or directory\n\n$ cat stdout                  # \u68c0\u67e5stdout\u6587\u4ef6\uff0c\u786e\u5b9e\u6709\u4e4b\u524d\u88ab\u5403\u6389\u7684\u8f93\u51fa\nl-wx------ 1 kodango kodango 64 Nov 10 00:26 /proc/629/fd/1 -&gt; /home/kodango/stdout\n</code></pre> <p>\u5173\u4e8eI/O\u91cd\u5b9a\u5411\u7684\u66f4\u8be6\u7ec6\u7684\u8bf4\u660e\uff0c\u53ef\u4ee5\u770bI/O Redirection\uff0c\u8fd9\u91cc\u6709\u5f88\u591a\u4f8b\u5b50\u8bb2\u89e3\u4e86\u5404\u79cdI/O\u91cd\u5b9a\u5411\u7684\u7528\u6cd5\uff0c\u5305\u62ecexec\u6765\u6539\u53d8\u91cd\u5b9a\u5411\u3002</p> <p>\u8fd9\u4e00\u70b9\u5728<code>while read; do xxx; done &lt; file</code>\u5185\u90e8\u4ecd\u9700\u8981\u4ece\u6807\u51c6\u8f93\u5165\u8bfb\u53d6\u5185\u5bb9\u65f6\u975e\u5e38\u6709\u7528\uff0c\u6b64\u65f6\u5fc5\u987b\u8981\u5c06\u5faa\u73af\u5916\u90e8\u7684\u91cd\u5b9a\u5411\u548c\u5185\u90e8\u7684\u5265\u79bb\u5f00\u6765\u3002</p>"},{"location":"chap9/2bash_skill/#8","title":"8 \u5f15\u53f7\u4e4b\u95f4\u7684\u533a\u522b","text":"<p>Shell\u4e2d\u6bd4\u8f83\u8ba9\u4eba\u6293\u72c2\u7684\u662f\u5404\u79cd\u5f15\u53f7\u7684\u5904\u7406\uff0c\u5176\u4e2d\uff0c\u53cd\u5f15\u53f7(<code>cmd</code>)\u662f\u6700\u5bb9\u6613\u638c\u63e1\u7684\uff0c\u5b83\u5176\u5b9e\u548c<code>$(cmd)</code>\u662f\u5dee\u4e0d\u591a\u7684\u3002</p> <p>\u5f15\u53f7\u7684\u4f5c\u7528\u6709\u51e0\u70b9\uff0c\u4e00\u4e2a\u662f\u4e3a\u4e86\u5c06\u591a\u4e2a\u56e0\u4e3a\u7a7a\u683c\u6216\u8005\u56de\u8f66\u7b49\u5206\u9694\u7b26\u9694\u5f00\u7684\u5b57\u7b26\u4e32\u5408\u5728\u4e00\u8d77\uff0c\u907f\u514d\u88ab\u547d\u4ee4\u884c\u89e3\u6790\u5206\u5f00\uff0c\u4f8b\u5982<code>\"one two three\"</code>\u5c31\u662f\u4e00\u6574\u4e2a\u5b57\u7b26\u4e32\uff0c\u800c\u4e0d\u662f\u50cfone two three\u4f1a\u88ab\u89e3\u6790\u6210\u4e09\u4e2a\u5355\u72ec\u7684\u5b57\u7b26\u4e32\uff1b</p> <p>\u53e6\u5916\u4e00\u65b9\u9762\uff0c\u5f15\u53f7\u53ef\u4ee5\u8ba9\u4e00\u4e9b\u7279\u6b8a\u7b26\u53f7\u4fdd\u6301\u539f\u4e49\u3002</p> <p>\u5176\u4e2d\uff0c\u5355\u5f15\u53f7\u7684\u5904\u7406\u662f\u6bd4\u8f83\u7b80\u5355\u7684\uff0c\u88ab\u5355\u5f15\u53f7\u5305\u62ec\u7684\u6240\u6709\u5b57\u7b26\u90fd\u4fdd\u7559\u539f\u6709\u7684\u610f\u601d\uff0c\u4f8b\u5982<code>'$a'</code>\u4e0d\u4f1a\u88ab\u5c55\u5f00, '<code>cmd</code>'\u4e5f\u4e0d\u4f1a\u6267\u884c\u547d\u4ee4\uff1b\u800c\u53cc\u5f15\u53f7\uff0c\u5219\u76f8\u5bf9\u6bd4\u8f83\u677e\uff0c\u5728\u53cc\u5f15\u53f7\u4e2d\uff0c\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u7b26<code>$</code>, <code>, \\</code>\u4f9d\u7136\u6709\u5176\u7279\u6b8a\u7684\u542b\u4e49\uff0c\u6bd4\u5982<code>$</code>\u53ef\u4ee5\u7528\u4e8e\u53d8\u91cf\u5c55\u5f00, \u53cd\u5f15\u53f7<code>``\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\uff0c\u53cd\u659c\u6760</code>`\u53ef\u4ee5\u7528\u4e8e\u8f6c\u4e49\u3002</p> <p>\u4f46\u662f\uff0c\u5728\u53cc\u5f15\u53f7\u5305\u56f4\u7684\u5b57\u7b26\u4e32\u91cc\uff0c\u53cd\u659c\u6760\u7684\u8f6c\u4e49\u4e5f\u662f\u6709\u9650\u7684\uff0c\u5b83\u53ea\u80fd\u8f6c\u4e49<code>$</code>, `, \", \\\u6216\u8005newline\uff08\u56de\u8f66\uff09\u8fd9\u51e0\u4e2a\u5b57\u7b26\uff0c\u540e\u9762\u5982\u679c\u8ddf\u7740\u7684\u4e0d\u662f\u8fd9\u51e0\u4e2a\u5b57\u7b26\uff0c\u53ea\u4e0d\u4f1a\u88ab\u9ed1\u5e95\uff0c\u53cd\u659c\u6760\u4f1a\u88ab\u4fdd\u7559\uff0c\u4f8b\u5982\uff1a</p> <pre><code>$ echo \"\\$,\\\",\\`,\\',\\t\"\n$,\",`,\\',\\t\n</code></pre> <p>\u53cc\u5f15\u53f7\u5185\u53ef\u4ee5\u76f4\u63a5\u5305\u542b\u5355\u5f15\u53f7\uff0c\u800c\u4e14\u5355\u5f15\u53f7\u4e5f\u6ca1\u6709\u5982\u4e0a\u636e\u8bf4\u7684\u7279\u6b8a\u542b\u4e49\uff0c\u6240\u4ee5\u50cf</p> <pre><code>\"var='$var'\"\n</code></pre> <p>\u4e2d<code>$var</code>\u8fd8\u662f\u4f1a\u88ab\u5c55\u5f00\u7684\uff0c\u800c\u4e0d\u8981\u4ee5\u4e3a\u7b80\u5355\u5730\u8ba4\u4e3a\u5728\u5355\u5f15\u53f7\u5185\u90e8\u5c31\u4e0d\u4f1a\u5c55\u5f00\u4e86\u3002\u5982\u679c\u53cc\u5f15\u53f7\u5185\u90e8\u5305\u542b\u611f\u53f9\u53f7\uff01\u5c31\u6bd4\u8f83\u5934\u75db\u4e86\uff0c\u611f\u53f9\u53f7\u662f\u7528\u4e8e\u547d\u4ee4\u884c\u5386\u53f2\u5c55\u5f00\uff0c\u4f8b\u5982!!\u5c55\u5f00\u4e3a\u4e0a\u4e00\u6b21\u6267\u884c\u7684\u547d\u4ee4\u3002\u4f60\u53ef\u4ee5\u8bd5\u8bd5\u53cc\u5f15\u53f7\u4e2d\u5305\u542b<code>!</code>\uff1a</p> <pre><code>$ echo \"!\"\n-bash: !: event not found\n$ echo \"\\!\"\n\\!\n</code></pre> <p>\u53ef\u89c1\uff0c\u5373\u4f7f\u4f60\u7528\u53cd\u659c\u6760\u4e5f\u6ca1\u529e\u6cd5\u8f6c\u4e49\uff0c\u9664\u975e\u4f60\u628a\u5386\u53f2\u5c55\u5f00\u529f\u80fd\u5173\u95ed\uff08\u5728\u811a\u672c\u91cc\u9762\u662f\u6ca1\u6709\u95ee\u9898\u7684\uff0c\u9ed8\u8ba4\u662f\u5173\u95ed\u7684\uff09\u3002</p> <pre><code>$ set +o histexpand \n\n$ echo \"!\"\n!\n</code></pre> <p>\u5f53\u7136\uff0c\u611f\u53f9\u53f7\u53ef\u4ee5\u7528\u5728\u5355\u5f15\u53f7\u91cc\u9762\u3002</p> <pre><code>$ set -o histexpand\n\n\n$ echo '!'\n!\n</code></pre> <p>\u5230\u6b64\u4e3a\u6b62\uff0c\u5176\u5b9e\u53cc\u5f15\u53f7\u548c\u5355\u5f15\u53f7\u7684\u533a\u522b\u5df2\u7ecf\u8bf4\u5f97\u5dee\u4e0d\u591a\u4e86\u3002\u4e0d\u8fc7\u8fd8\u53ef\u4ee5\u518d\u8bf4\u51e0\u4e2a\u7279\u6b8a\u7684\u7528\u6cd5\uff0c\u524d\u9762\u8bf4\u8fc7\u53ef\u4ee5\u5728\u53cc\u5f15\u53f7\u5185\u90e8\u4f7f\u7528\u5355\u5f15\u53f7\uff0c\u4f60\u6709\u60f3\u8fc7\u5728\u5355\u5f15\u53f7\u91cc\u9762\u4f7f\u7528\u5355\u5f15\u53f7\u5417\uff1f</p> <pre><code>$ echo '\\''\n&gt; \n</code></pre> <p>\u662f\u4e0d\u662f\u53d1\u73b0\u4e0d\u80fd\u7528\uff0c\u56e0\u4e3a\u5355\u5f15\u53f7\u4e2d\u53cd\u659c\u6760\u662f\u6ca1\u6709\u8f6c\u4e49\u7684\u6548\u679c\u7684\uff0c\u4efb\u4f55\u5b57\u7b26\u90fd\u6ca1\u6709\u7279\u6b8a\u7684\u542b\u4e49\u3002\u90a3\u5c31\u6ca1\u6709\u529e\u6cd5\u4e86\u5417\uff1f\u65b9\u6cd5\u603b\u662f\u6709\u7684\uff0c\u53ef\u4ee5\u5728\u7b2c\u4e00\u4e2a\u5355\u5f15\u53f7\u524d\u9762\u52a0\u4e2a<code>$</code>\u7b26\u53f7\uff1a</p> <pre><code>$ echo $'\\''\n'\n</code></pre>"},{"location":"chap9/2bash_skill/#9-string","title":"9 \u7279\u6b8a\u7528\u6cd5<code>$'string'</code>","text":"<p>\u524d\u9762\u4e00\u70b9\u4e2d\u5df2\u7ecf\u4ecb\u7ecd\u4e86 $'string'\u8fd9\u79cd\u7528\u6cd5\uff0c\u6bd4\u5982 $'\\''\uff0c\u4e4b\u6240\u4ee5\u53ef\u4ee5\u8fd9\u6837\u7528\uff0c\u901a\u4fd7\u5730\u8bb2\uff0c\u5c31\u662f\u5728\u8fd9\u79cd\u8bed\u6cd5\u91cc\u4e00\u4e9b\u8f6c\u4e49\u5b57\u7b26\u4e32\u662f\u88ab\u8ba4\u53ef\u7684\uff0c\u4e8b\u5b9e\u4e0a\u6709\u6548\u5730\u7684\u8f6c\u4e49\u5e95\u5b57\u7b26\u4e32\u5217\u8868\u53ef\u4ee5\u770b\u8fd9\u91cc\uff0c\u4f8b\u5982\\b\uff0c\\',\\n,\\f,\\nnn,\\xhh\u7b49\u7b49\uff0c\u662f\u4e0d\u662f\u5f88\u719f\u6089\u3002</p> <p>$'string'\u7684\u8fd9\u4e2a\u7279\u6027\uff0c\u5176\u5b9e\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u79cd\u5f88\u6709\u7528\u7684\u6280\u5de7\uff1a</p> <pre><code>$ echo $'\\x41'\nA\n</code></pre>"},{"location":"chap9/2bash_skill/#10","title":"10. \u7528\u53cc\u5f15\u53f7\u6bd4\u4e0d\u7528\u66f4\u52a0\u5b89\u5168","text":"<p>\u53cc\u5f15\u53f7\u9664\u4e86\u524d\u9762\u8bb2\u5230\u7684\u53bb\u9664\u7279\u6b8a\u6db5\u4e49\u7684\u4f5c\u7528\u5916\uff0c\u8fd8\u53ef\u4ee5\u907f\u514d\u5b57\u7b26\u4e32\u88ab\u5206\u9694\u89e3\u6790\uff0c\u4f8b\u5982\uff1a</p> <pre><code>$ echo `ls -l`\ntotal 4.0K -rw-r--r-- 1 kodango kodango 4 Nov 10 20:09 1 -rw-r--r-- 1 kodango kodango 0 Nov 10 20:09 2\n$ echo \"`ls -l`\"\ntotal 4.0K\n-rw-r--r-- 1 kodango kodango 4 Nov 10 20:09 1\n-rw-r--r-- 1 kodango kodango 0 Nov 10 20:09 2\n</code></pre> <p>\u524d\u8005\u6ca1\u6709\u52a0\u53cc\u5f15\u53f7\uff0cls -l\u8f93\u51fa\u884c\u4e4b\u95f4\u7684\u56de\u8f66\u5c31\u88ab\u5403\u6389\u4e86\u3002\u539f\u56e0\u662f\uff0c\u5f53ls -l\u8fd4\u56de\u7684\u7ed3\u679c\u4f20\u9012\u7ed9echo\u4e4b\u524d\uff0c\u4f1a\u5148\u88abshell\u8fdb\u884c\u53c2\u6570\u89e3\u6790\uff0c\u800cshell\u662f\u7528IFS\u5b9a\u4e49\u7684\u5206\u9694\u7b26\u6765\u5206\u9694\u5b57\u7b26\u4e32\u7684\uff0c\u4e00\u822c\u5305\u62ec\\n\uff0c\u6240\u4ee5\u5b83\u628a\u89e3\u6790\u540e\u7684\u7ed3\u679c\u518d\u4f20\u9012\u7ed9echo\uff0c\u5c31\u6210\u4e3aecho \"line 1....\" \"line 2...\"\u8fd9\u79cd\u5f62\u5f0f\u4e86\uff0c\u7ed3\u679c\u5c31\u50cf\u4e0a\u9762\u4e00\u6837\u3002</p> <p>\u800c\u7528\u53cc\u5f15\u53f7\u5305\u62ec\u8d77\u6765\u53ef\u4ee5\u907f\u5f00\u5b57\u7b26\u4e32\u88ab\u62c6\u5f00\u89e3\u6790\uff0c\u56e0\u4e3ashell\u8ba4\u4e3a\u5b83\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u5b57\u7b26\u4e32\u3002\u6240\u4ee5\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u591a\u7528\u5f15\u53f7\u5305\u62ec\u53d8\u91cf\u662f\u597d\u7684\uff0c<code>\"$var\"</code>\u6bd4<code>$var</code>\u66f4\u5b89\u5168\u3002</p>"},{"location":"chap9/3bash_skill/","title":"3 Bash Pitfalls: \u7f16\u7a0b\u6613\u72af\u7684\u9519\u8bef\uff08\u4e00\uff09","text":""},{"location":"chap9/3bash_skill/#1-for-i-in-ls-mp3","title":"1. <code>for i in $(ls *.mp3)</code>","text":"<p>Bash\u5199\u5faa\u73af\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u786e\u5b9e\u6bd4\u8f83\u5bb9\u6613\u72af\u4e0b\u9762\u7684\u9519\u8bef\uff1a</p> <pre><code>for i in $(ls *.mp3); do    # \u9519\u8bef!\n    some command $i         # \u9519\u8bef!\ndone\n\nfor i in $(ls)              # \u9519\u8bef!\nfor i in `ls`               # \u9519\u8bef!\n\nfor i in $(find . -type f)  # \u9519\u8bef!\nfor i in `find . -type f`   # \u9519\u8bef!\n\nfiles=($(find . -type f))   # \u9519\u8bef!\nfor i in ${files[@]}        # \u9519\u8bef!\n</code></pre> <p>\u8fd9\u91cc\u4e3b\u8981\u4e24\u4e2a\u95ee\u9898\uff1a</p> <ul> <li>\u4f7f\u7528\u547d\u4ee4\u5c55\u5f00\u65f6\u4e0d\u5e26\u5f15\u53f7\uff0c\u5176\u6267\u884c\u7ed3\u679c\u4f1a\u4f7f\u7528IFS\u4f5c\u4e3a\u5206\u9694\u7b26\uff0c\u62c6\u5206\u6210\u53c2\u6570\u4f20\u9012\u7ed9for\u5faa\u73af\u5904\u7406\uff1b</li> <li>\u4e0d\u5e94\u8be5\u8ba9\u811a\u672c\u53bb\u89e3\u6790ls\u547d\u4ee4\u7684\u7ed3\u679c\uff1b</li> </ul> <pre><code>$ for i in $(ls *.mp3); do echo $i; done\n01\n-\nDon't\nEat\nthe\nYellow\nSnow.mp3\n</code></pre> <p>\u6bd4\u8fd9\u66f4\u5dee\u7684\u60c5\u51b5\u662f\uff0c\u4e0a\u9762\u547d\u4ee4\u5c55\u5f00\u7684\u7ed3\u679c\u53ef\u80fd\u88abShell\u8fdb\u4e00\u6b65\u5904\u7406\uff0c\u6bd4\u5982\u6587\u4ef6\u540d\u5c55\u5f00\u3002\u6bd4\u5982\uff0cls\u6267\u884c\u7684\u7ed3\u679c\u4e2d\u5305\u542b<code>*</code>\u53f7\uff0c\u6309\u7167\u901a\u914d\u7b26\u7684\u89c4\u5219, <code>*</code>\u53f7\u4f1a\u88ab\u5c55\u5f00\u6210\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6:</p> <pre><code>$ touch \"1*.mp3\" \"1.mp3\" \"11.mp3\" \"12.mp3\"\n\n$ for i in $(ls *.mp3); do echo $i; done\n1*.mp3 1.mp3 11.mp3 12.mp3\n1.mp3\n11.mp3\n12.mp3\n1.mp3\n11.mp3\n12.mp3\n</code></pre>"},{"location":"chap9/4bash_python/","title":"4 \u5728Python\u4e2d\u6267\u884cLinux Shell\u811a\u672c","text":""},{"location":"chap9/4bash_python/#pythonshell","title":"\u4e3a\u4ec0\u4e48\u5728Python\u4e2d\u6267\u884cShell\u811a\u672c\uff1f","text":"<p>Python \u4e0d\u4ec5\u4ec5\u662f\u4e00\u79cd\u5f3a\u5927\u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u800c\u4e14\u5b83\u7684\u6613\u7528\u6027\u548c\u7075\u6d3b\u6027\u4e5f\u4f7f\u5f97\u5b83\u6210\u4e3a\u81ea\u52a8\u5316\u4efb\u52a1\u7684\u7406\u60f3\u9009\u62e9\u3002\u5728 Python \u4e2d\u6267\u884c shell \u811a\u672c\uff0c\u6709\u4ee5\u4e0b\u597d\u5904\uff1a</p> <ul> <li>\u4f7f\u5f97\u590d\u6742\u7684 shell \u811a\u672c\u66f4\u5bb9\u6613\u7406\u89e3\u548c\u7ef4\u62a4\uff1b</li> <li>\u652f\u6301\u66f4\u5f3a\u5927\u7684\u7f16\u7a0b\u7ed3\u6784\uff1b</li> <li>\u53ef\u4ee5\u5b8c\u7f8e\u5730\u4e0e Python \u7a0b\u5e8f\u96c6\u6210</li> </ul>"},{"location":"chap9/4bash_python/#pythonshell_1","title":"\u5982\u4f55\u5728Python\u4e2d\u6267\u884cShell\u811a\u672c\uff1f","text":"<p>\u5728 Python \u4e2d\u6267\u884c Shell \u811a\u672c\u7684\u4e00\u79cd\u7b80\u5355\u65b9\u6cd5\u662f\u4f7f\u7528 os \u6a21\u5757\u7684 <code>system()</code> \u51fd\u6570\u3002</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>import os\nos.system('bash shell_script.sh')\n</code></pre> <p><code>os.system()</code> \u51fd\u6570\u4f1a\u5c06\u8fd4\u56de\u503c\u8bbe\u7f6e\u4e3a\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\u7801\uff0c\u6210\u529f\u6267\u884c\u4e3a0\uff0c\u6ca1\u6210\u529f\u5219\u4e3a\u5176\u4ed6\u503c\u3002</p>"},{"location":"chap9/4bash_python/#subprocess-shell","title":"\u4f7f\u7528 subprocess \u6a21\u5757\u6267\u884c Shell \u811a\u672c","text":"<p>\u76f8\u6bd4os\u6a21\u5757\uff0csubprocess\u6a21\u5757\u63d0\u4f9b\u4e86\u66f4\u591a\u7684\u529f\u80fd\u548c\u7075\u6d3b\u6027\uff0c\u662fPython\u6807\u51c6\u5e93\u4e2d\u63a8\u8350\u7528\u6765\u6267\u884cshell\u547d\u4ee4\u7684\u6a21\u5757\u3002</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>import subprocess\n\nsubprocess.run(['bash', 'shell_script.sh'])\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c<code>subprocess.run()</code> \u5c06\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8fdb\u7a0b\uff0c\u8fd0\u884c shell \u811a\u672c\uff0c\u7b49\u5f85\u5176\u5b8c\u6210\uff0c\u7136\u540e\u8fd4\u56de\u4e00\u4e2a <code>CompletedProcess</code> \u5b9e\u4f8b\u3002</p>"},{"location":"chap9/4bash_python/#shell","title":"\u83b7\u53d6 Shell \u811a\u672c\u7684\u8f93\u51fa","text":"<p>\u4f7f\u7528 subprocess\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u6355\u83b7\u548c\u83b7\u53d6 shell \u811a\u672c\u7684\u8f93\u51fa\u3002\u8fd9\u662f\u901a\u8fc7\u4f7f\u7528 <code>run()</code> \u51fd\u6570\u7684 <code>capture_output</code> \u53c2\u6570\u5b9e\u73b0\u7684\u3002</p> <pre><code>import subprocess\n\ncompleted_proc = subprocess.run(['bash', 'shell_script.sh'], capture_output=True, text=True)\n\nprint(completed_proc.stdout)\n</code></pre> <p>\u793a\u4f8b\u4e2d\uff0c\u901a\u8fc7\u8bbe\u7f6e<code>capture_output=True</code>\u548c<code>text=True</code>\uff0c\u53ef\u4ee5\u6355\u83b7\u547d\u4ee4\u7684\u8f93\u51fa\uff0c\u5e76\u5c06\u8f93\u51fa\u7684\u5b57\u8282\u7c7b\u578b\u81ea\u52a8\u8f6c\u6210\u5b57\u7b26\u4e32\u3002</p>"}]}